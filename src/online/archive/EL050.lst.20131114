* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   3
* EL050.cbl
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER   PIC X(32) VALUE '********************************'.
    54 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    55 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    56
    57 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    58 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    59                                   USAGE POINTER.
    60 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    61 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    63                                   USAGE IS POINTER.
    64 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    65 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    66                                   USAGE IS POINTER.
    67 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    69                                   USAGE IS POINTER.
    70
    71 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    73                                   USAGE IS POINTER.
    74
    75*    COPY ELC50WS.
    76*****************************************************************
    77*                                                               *
    78*                            ELC50WS.                           *
    79*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    80*                            VMOD=2.061.                        *
    81*                                                               *
    82*   THIS IS THE WORKING STORAGE FOR EL050                       *
    83*                                   EL517                       *
    84*****************************************************************
    85******************************************************************
    86*                   C H A N G E   L O G
    87*
    88* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    89*-----------------------------------------------------------------
    90*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    91* EFFECTIVE    NUMBER
    92*-----------------------------------------------------------------
    93* 123102                   PEMA  ADD DCC PROCESSING
    94* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    95* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    96* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    97* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    98* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    99* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   100* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   101* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   102* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   103* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   104* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   105* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   107* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   4
* EL050.cbl
   108* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   109* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   110* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   111* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   112* 030309  CR2009021700001  PEMA  ADD ER-2883
   113* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   114* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   115* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   116* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   117* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   118* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   119* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   120* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   121* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   122* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   123* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   124* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   125* 061412  CR2011022800001  AJRA  NAPERSOFT
   126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   127* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   128* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   129*-----------------------------------------------------------------
   130
   131 01  WORK-AREAS.
   132
   133*****************************************************************
   134*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   135*****************************************************************
   136
   137     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   138     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-NAME-EDIT-WORK-AREA.
   141         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   142         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   143             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   144         16  WS-WORK-NAME.
   145             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   146             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   147             20  FILLER           PIC X(10)     VALUE SPACES.
   148         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   149             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   150
   151*****************************************************************
   152*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   153*****************************************************************
   154
   155     12  WS-ERRESC-KEY.
   156         16 WS-ERRESC-SEARCH-KEY.
   157             20  WS-ERRESC-COMPANY-CD PIC  X.
   158             20  WS-ERRESC-CARRIER    PIC  X.
   159             20  WS-ERRESC-GROUP      PIC X(6).
   160             20  WS-ERRESC-STATE      PIC XX.
   161             20  WS-ERRESC-ACCOUNT    PIC X(10).
   162         16 WS-ERRESC-RESIDUAL-KEY.
   163             20  WS-ERRESC-AGENT      PIC X(10).
   164             20  WS-ERRESC-RES-STATE  PIC XX.
   165             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   5
* EL050.cbl
   166*                                          YYYYMMDD
   167     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   168     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   169
   170*RESIDENT STATE TAX MASTER(ERRESS)
   171*
   172     12  WS-ERRESS-KEY.
   173         16  WS-ERRESS-COMPANY-CD      PIC  X.
   174         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   175         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   176         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178
   179     12  WS-CONTRACT-DATE              PIC 9(8).
   180*                                          YYYYMMDD
   181     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   182     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   183         16 WS-YEAR-YY                 PIC   9999.
   184         16 FILLER                     PIC 9(4).
   185*                                          YYYYMMDD
   186     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   187     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   188     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   189     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   190
   191     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   192         88  DPRB-1ST-TIME                      VALUE ' '.
   193
   194*****************************************************************
   195*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   196*****************************************************************
   197
   198     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   199     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   200     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   201     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   204     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   205     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   206     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   208         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   209         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   210     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   211         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   212         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   213     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   214
   215     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   216     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   217
   218     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   219     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   220     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   6
* EL050.cbl
   224     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   232     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   233     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   254     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   255     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   256     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   257     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   266     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   267     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   268     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   269     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   270     12  WS-2671-SW               PIC X         VALUE SPACE.
   271     12  WS-2672-SW               PIC X         VALUE SPACE.
   272     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   273         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   274     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   275         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   276     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   277
   278     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   279         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   280         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   281         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   7
* EL050.cbl
   282         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   283
   284     12  WS-CREDIT-EDIT-CONTROLS.
   285         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   286         16  WS-MIN-AGE           PIC 99                VALUE  0.
   287         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   288         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   289         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   291
   292     12  WS-AGE-FIELDS.
   293         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   294         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   296         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   297
   298     12  WS-SAVE-ALLOWABLE-BENEFIT.
   299         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   300         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   301         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   302         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   303         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   304         16  FILLER                      PIC XX.
   305
   306     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   307     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   308     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   309     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   310     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   311     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   312     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   314     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   315     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316
   317     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   318     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   319     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   320     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   321     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   322     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   323     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   324     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   325         88  WS-REDUCING              VALUE 'R'.
   326         88  WS-LEVEL                 VALUE 'L' 'P'.
   327     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   328
   329     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   333     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   334     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   335     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   336     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   337     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   338
   339     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   8
* EL050.cbl
   340     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   341     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   342     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   343     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   344     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   345     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   346     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   347     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   348     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   349     12  WS-ACCT-SIG-SW.
   350         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   351         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   352     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   353     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-INITIALS.
   361         16  WS-INIT-1            PIC X         VALUE SPACES.
   362         16  WS-INIT-2            PIC X         VALUE SPACES.
   363
   364     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   365     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   366     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   367     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   369*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   370     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   371     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   377     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   378     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   386     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392******** FLA
   393     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   394     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   397     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page   9
* EL050.cbl
   398********
   399     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   400     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   403     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   404     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   405     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   406     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   407     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   408     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   409
   410     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   411         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   412                                         '0' THRU '9'.
   413
   414     12  NUMBER-OF-MONTHS.
   415         16  SK-MO OCCURS 12 TIMES PIC X.
   416
   417     12  WS-WORK-DATE.
   418         16  WS-YEAR            PIC 99    VALUE 00.
   419         16  WS-MONTH           PIC 99    VALUE 00.
   420         16  WS-DAY             PIC 99    VALUE 00.
   421
   422     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   423     12  WS-WORK-CRIT-DEV       REDEFINES
   424         WS-WORK-LF-CRIT-PER    PIC X(03).
   425
   426     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   427     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   428
   429     12  WS-WORK-DATE-FROM.
   430         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   431         16  FILLER             PIC X  VALUE SPACE.
   432         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   433         16  FILLER             PIC X         VALUE SPACE.
   434         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   435
   436     12  WS-WORK-DATE-THRU.
   437         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   438         16  FILLER             PIC X         VALUE SPACE.
   439         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   440         16  FILLER             PIC X         VALUE SPACE.
   441         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   442
   443     12  WS-LF-INPUT-CD.
   444         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   445         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   446
   447     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   448     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   449         16  WS-AH-INPUT-CD-1   PIC X.
   450         16  WS-AH-INPUT-CD-2-3 PIC XX.
   451
   452     12  WS-SWITCHES.
   453         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   454         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   455             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  10
* EL050.cbl
   456         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   457             88  BANK-ACCT-FOUND          VALUE 'Y'.
   458         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   459             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   460         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   461             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   462         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   463             88  COMP-MASTER-FOUND        VALUE 'Y'.
   464         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   465             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   466         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   467             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   468         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   469             88  STAT-MASTER-FOUND        VALUE 'Y'.
   470         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   471             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   472         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   473             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   474         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   475             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   476         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   477             88  FORM-MASTER-FOUND        VALUE 'Y'.
   478         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   479             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   480         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   481             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   482         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   483             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   484         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   485             88  NO-BENEFIT-FOUND         VALUE 'N'.
   486         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   487             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   488         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   489             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   490         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   491             88  AH-BENEFIT-FOUND         VALUE ' '.
   492             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   493         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   494             88  LF-BENEFIT-FOUND         VALUE ' '.
   495             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   496         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   497             88  NO-STATE-RECORD          VALUE '1'.
   498         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   499             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   500         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   501             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   502         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   503             88  CERT-WAS-FOUND           VALUE ' '.
   504             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   505         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   506             88  BROWSE-STARTED           VALUE 'Y'.
   507         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   508             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   509         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   510             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   511         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   512             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   513         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  11
* EL050.cbl
   514             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   515         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   516             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   517         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   518             88  APP-CERT-USED            VALUE 'Y' 'A'.
   519         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   520             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   521             88  FIRST-TIME-THROUGH       VALUE '1'.
   522             88  CTBL-NOT-FOUND           VALUE '2'.
   523
   524         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   525             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   526
   527         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   528             88  DLO-ERROR-FOUND          VALUE 'Y'.
   529
   530********FLA
   531     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   532     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   533********
   534     12  RC-SW-1                  PIC X           VALUE '0'.
   535     12  RC-SW-2                  PIC X           VALUE '0'.
   536     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   537     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   539     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   546     12  LIT-SPACES               PIC X           VALUE SPACES.
   547     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   548     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   549     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   550     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   551     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   552     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   554         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   555         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   556     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   557         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   558
   559 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   560     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   561     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   562 01  WS-CRI-SSN-WORK-AREA.
   563     05  WS-CRI-SOC-SEC-NO.
   564         10  WS-SS-REPT-CD       PIC X(5).
   565         10  WS-SS-LAST-NAME     PIC X(5).
   566         10  WS-SS-INITIAL       PIC X.
   567
   568     05  WS-CRI-REPORT-CODE.
   569         10  FILLER              PIC X(5).
   570         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   571
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  12
* EL050.cbl
   572     05  WS-CRI-LAST-NAME.
   573         10  WS-CRI-NAME-MOVE    PIC X(5).
   574         10  FILLER              PIC X(10).
   575
   576 01  WS-NUM-TABLE                PIC X(26)  VALUE
   577     '12345678012345070923456789'.
   578 01  FILLER REDEFINES WS-NUM-TABLE.
   579     05  WS-NUM OCCURS 26        PIC 9.
   580 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   581 01  V1                          PIC S999 COMP-3.
   582 01  V2                          PIC S999 COMP-3.
   583 01  V3                          PIC S999 COMP-3.
   584 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   585 01  FILLER REDEFINES WS-WORK-VIN.
   586     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   587 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   588 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   589 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   590 01  WS-HEX-WORK.
   591     05  FILLER                  PIC X  VALUE LOW-VALUES.
   592     05  WS-HEX-BYTE             PIC X.
   593 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   594 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   595 01  WS-WORK-HIN-ROW-B.
   596     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   597
   598 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   599 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   600     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   601 01  WS-ROW-D-TABLE.
   602     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   603
   604 01  WS-HIN-TABLE-B.
   605     05  F                       PIC XX VALUE 'A2'.
   606     05  F                       PIC XX VALUE 'B3'.
   607     05  F                       PIC XX VALUE 'C4'.
   608     05  F                       PIC XX VALUE 'D5'.
   609     05  F                       PIC XX VALUE 'E6'.
   610     05  F                       PIC XX VALUE 'F7'.
   611     05  F                       PIC XX VALUE 'G8'.
   612     05  F                       PIC XX VALUE 'H9'.
   613     05  F                       PIC XX VALUE 'I1'.
   614     05  F                       PIC XX VALUE 'J2'.
   615     05  F                       PIC XX VALUE 'K3'.
   616     05  F                       PIC XX VALUE 'L4'.
   617     05  F                       PIC XX VALUE 'M5'.
   618     05  F                       PIC XX VALUE 'N6'.
   619     05  F                       PIC XX VALUE 'O0'.
   620     05  F                       PIC XX VALUE 'P7'.
   621     05  F                       PIC XX VALUE 'Q0'.
   622     05  F                       PIC XX VALUE 'R8'.
   623     05  F                       PIC XX VALUE 'S9'.
   624     05  F                       PIC XX VALUE 'T2'.
   625     05  F                       PIC XX VALUE 'U3'.
   626     05  F                       PIC XX VALUE 'V4'.
   627     05  F                       PIC XX VALUE 'W5'.
   628     05  F                       PIC XX VALUE 'X6'.
   629     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  13
* EL050.cbl
   630     05  F                       PIC XX VALUE 'Z8'.
   631 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   632     05  WS-VAL-IN               PIC X.
   633     05  WS-VAL-OUT              PIC 9.
   634 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   635 01  WS-COMPARE-BINARY-DATES.
   636     05  WS-971231                PIC XX VALUE X'92FF'.
   637     05  WS-931231                PIC XX VALUE X'8CFF'.
   638     05  WS-791231                PIC XX VALUE X'77FF'.
   639     05  WS-771001                PIC XX VALUE X'74A1'.
   640     05  WS-820301                PIC XX VALUE X'7B41'.
   641     05  WS-831031                PIC XX VALUE X'7DBF'.
   642     05  WS-831231                PIC XX VALUE X'7DFF'.
   643     05  WS-810831                PIC XX VALUE X'7A7F'.
   644     05  WS-830901                PIC XX VALUE X'7D81'.
   645
   646 01  FILE-ACCESS-IDS.
   647     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   648     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   649     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   650     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   651     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   652     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   653     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   654     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   655     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   656     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   657     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   658     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   659     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   660     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   661     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   662     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   663     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   664 01  DD-IU-SW                    PIC X   VALUE ' '.
   665     88  DD-IU-PRESENT                 VALUE 'Y'.
   666
   667 01  ACCESS-KEYS.
   668     12  ELMSTR-KEY.
   669         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   670         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   671     12  W-CLAIM-KEY.
   672         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   673         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   674
   675     12  ELCNTL-KEY.
   676         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   677         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   678         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   679         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   680
   681     12  ELCERT-KEY.
   682         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   683         16  CERT-CARRIER         PIC X       VALUE SPACE.
   684         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   685         16  CERT-STATE           PIC XX      VALUE SPACES.
   686         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   687         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  14
* EL050.cbl
   688         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   689
   690     12  ELCERT2-KEY.
   691         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   692         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   693
   694     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   695
   696     12  ELCERT-SAVE.
   697         16  FILLER                      PIC XX    VALUE SPACES.
   698
   699         16  WCS-CONTROL-PRIMARY.
   700             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   701             20  WCS-CARRIER             PIC X     VALUE SPACE.
   702             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   703             20  WCS-STATE               PIC XX    VALUE SPACES.
   704             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   705             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   706             20  WCS-CERT-NO.
   707                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   708                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   709
   710         16  CS-CONTROL-BY-NAME.
   711             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   712             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   713             20  CS-INSURED-INITIALS.
   714                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   715                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-SSN.
   718             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   719             20  CS-SOC-SEC-NO.
   720                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   721                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   722                 24  CS-SSN-LN3.
   723                     28 CS-INSURED-INITIALS-A2   PIC XX
   724                                     VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A2     PIC X
   726                                     VALUE SPACE.
   727
   728         16  CS-CONTROL-BY-CERT-NO.
   729             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   730             20  CS-CERT-NO-A4           PIC X(11)
   731                                     VALUE SPACES.
   732
   733         16  CS-CONTROL-BY-MEMB.
   734             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   735             20  CS-MEMBER-NO.
   736                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   737                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   738                 24  CS-MEMB-LN4.
   739                     28 CS-INSURED-INITIALS-A5   PIC XX
   740                                      VALUE SPACES.
   741                     28 CS-PART-LAST-NAME-A5     PIC XX
   742                                      VALUE SPACES.
   743
   744         16  FILLER              PIC X(360) VALUE SPACES.
   745
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  15
* EL050.cbl
   746     12  ERACCT-KEY.
   747         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   749         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   750         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   751         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   753
   754     12  ERCOMP-KEY.
   755         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   756         16  COMP-CARRIER         PIC X     VALUE SPACES.
   757         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   758         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   759         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   760         16  COMP-TYPE            PIC X     VALUE SPACES.
   761
   762     12  ERLOFC-KEY.
   763         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   764         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   765         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   766         16  LOFC-STATE           PIC XX    VALUE SPACES.
   767         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   768         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   769
   770     12  WS-ELCRTT-KEY.
   771         16  WS-ELCRTT-PRIMARY       PIC X(33).
   772         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   773
   774     12  ERBXRF-KEY.
   775         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   776         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   777         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   778         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   779
   780     12  ERAGTC-KEY.
   781         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   783         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   784         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   785         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   786         16  AGTC-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERPLAN-KEY.
   789         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   790         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   791         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   792         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   793         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   795         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   796         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   797
   798     12  ERFORM-KEY.
   799         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   800         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   801         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   802         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   803
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  16
* EL050.cbl
   804     12  ERREIN-KEY.
   805         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  REIN-TYPE            PIC X     VALUE SPACES.
   807         16  REIN-TABLE-CO.
   808             20  REIN-CODE-1      PIC X     VALUE SPACE.
   809             20  REIN-CODE-2      PIC X     VALUE SPACE.
   810             20  REIN-CODE-3      PIC X     VALUE SPACE.
   811         16  FILLER               PIC X(3)  VALUE SPACES.
   812
   813     12  ERCTBL-KEY.
   814         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   815         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   816         16  CTBL-CNTRL-2.
   817             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   818             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   819
   820     12  ELCRTO-KEY.
   821         16  ELCRTO-COMPANY-CD       PIC X.
   822         16  ELCRTO-CARRIER          PIC X.
   823         16  ELCRTO-GROUPING         PIC X(6).
   824         16  ELCRTO-STATE            PIC XX.
   825         16  ELCRTO-ACCOUNT          PIC X(10).
   826         16  ELCRTO-CERT-EFF-DT      PIC XX.
   827         16  ELCRTO-CERT-NO.
   828             20  ELCRTO-CERT-PRIME   PIC X(10).
   829             20  ELCRTO-CERT-SFX     PIC X.
   830         16  ELCRTO-RECORD-TYPE      PIC X.
   831         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   832
   833
   834     12  WS-ACCESS.
   835         16  FILLER               PIC XX    VALUE SPACES.
   836         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   837
   838     12  WS-CARR-ACCESS.
   839         16  FILLER               PIC X(3)  VALUE SPACES.
   840         16  WS-CARR              PIC X     VALUE SPACE.
   841*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   842*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   843     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   844         88  WS-DMD-LF-RATING   VALUE 'Y'.
   845         88  WS-DMD-AH-RATING   VALUE 'Y'.
   846         88  WS-DMD-NO-RATING   VALUE 'N'.
   847
   848     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   849         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   850                                         'NJ' 'NL'
   851                                         'PJ' 'PL'
   852                                         'SJ' 'SL'.
   853     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   854         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   855                                         'NI' 'NJ' 'NL' 'NU'
   856                                         'PJ' 'PL' 'PI' 'PU'
   857                                         'SI' 'SJ' 'SL' 'SU'
   858                                         'MX' 'MY' 'MZ'.
   859 01  ERPDEF-KEY-SAVE             PIC X(18).
   860 01  ERPDEF-KEY.
   861     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  17
* EL050.cbl
   862     12  ERPDEF-STATE            PIC XX.
   863     12  ERPDEF-PROD-CD          PIC XXX.
   864     12  F                       PIC X(7).
   865     12  ERPDEF-BEN-TYPE         PIC X.
   866     12  ERPDEF-BEN-CODE         PIC XX.
   867     12  ERPDEF-EXP-DT           PIC XX.
   868
   869 01  ELSTAT-KEY-SAVE             PIC X(20).
   870 01  ELSTAT-KEY.
   871     12  ELSTAT-COMPANY-ID       PIC XXX.
   872     12  ELSTAT-CARRIER          PIC X.
   873     12  ELSTAT-GROUP            PIC X(6).
   874     12  ELSTAT-STATE            PIC XX.
   875     12  ELSTAT-EXP-DT           PIC 9(8).
   876 01  WS-ERROR-VALUES.
   877     12  ER-1570                     PIC S9(4)   VALUE +1570.
   878     12  ER-1571                     PIC S9(4)   VALUE +1571.
   879     12  ER-1575                     PIC S9(4)   VALUE +1575.
   880     12  ER-1891                     PIC S9(4)   VALUE +1891.
   881     12  ER-1892                     PIC S9(4)   VALUE +1892.
   882     12  ER-1893                     PIC S9(4)   VALUE +1893.
   883     12  ER-1894                     PIC S9(4)   VALUE +1894.
   884     12  ER-1895                     PIC S9(4)   VALUE +1895.
   885     12  ER-1896                     PIC S9(4)   VALUE +1896.
   886     12  ER-1897                     PIC S9(4)   VALUE +1897.
   887     12  ER-1898                     PIC S9(4)   VALUE +1898.
   888     12  ER-1899                     PIC S9(4)   VALUE +1899.
   889     12  ER-1900                     PIC S9(4)   VALUE +1900.
   890     12  ER-1901                     PIC S9(4)   VALUE +1901.
   891     12  ER-1902                     PIC S9(4)   VALUE +1902.
   892     12  ER-1903                     PIC S9(4)   VALUE +1903.
   893     12  ER-1904                     PIC S9(4)   VALUE +1904.
   894     12  ER-1905                     PIC S9(4)   VALUE +1905.
   895     12  ER-1906                     PIC S9(4)   VALUE +1906.
   896     12  ER-1907                     PIC S9(4)   VALUE +1907.
   897     12  ER-1909                     PIC S9(4)   VALUE +1909.
   898     12  ER-1910                     PIC S9(4)   VALUE +1910.
   899     12  ER-1911                     PIC S9(4)   VALUE +1911.
   900     12  ER-1912                     PIC S9(4)   VALUE +1912.
   901     12  ER-1913                     PIC S9(4)   VALUE +1913.
   902     12  ER-1914                     PIC S9(4)   VALUE +1914.
   903     12  ER-1915                     PIC S9(4)   VALUE +1915.
   904     12  ER-1916                     PIC S9(4)   VALUE +1916.
   905     12  ER-1917                     PIC S9(4)   VALUE +1917.
   906     12  ER-1918                     PIC S9(4)   VALUE +1918.
   907     12  ER-1919                     PIC S9(4)   VALUE +1919.
   908     12  ER-1920                     PIC S9(4)   VALUE +1920.
   909     12  ER-1921                     PIC S9(4)   VALUE +1921.
   910     12  ER-1922                     PIC S9(4)   VALUE +1922.
   911     12  ER-1923                     PIC S9(4)   VALUE +1923.
   912     12  ER-1924                     PIC S9(4)   VALUE +1924.
   913     12  ER-1925                     PIC S9(4)   VALUE +1925.
   914     12  ER-1926                     PIC S9(4)   VALUE +1926.
   915     12  ER-1927                     PIC S9(4)   VALUE +1927.
   916     12  ER-2393                     PIC S9(4)   VALUE +2393.
   917     12  ER-2600                     PIC S9(4)   VALUE +2600.
   918     12  ER-2601                     PIC S9(4)   VALUE +2601.
   919     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  18
* EL050.cbl
   920     12  ER-2603                     PIC S9(4)   VALUE +2603.
   921     12  ER-2604                     PIC S9(4)   VALUE +2604.
   922     12  ER-2605                     PIC S9(4)   VALUE +2605.
   923     12  ER-2606                     PIC S9(4)   VALUE +2606.
   924     12  ER-2607                     PIC S9(4)   VALUE +2607.
   925     12  ER-2608                     PIC S9(4)   VALUE +2608.
   926     12  ER-2609                     PIC S9(4)   VALUE +2609.
   927     12  ER-2610                     PIC S9(4)   VALUE +2610.
   928     12  ER-2611                     PIC S9(4)   VALUE +2611.
   929     12  ER-2612                     PIC S9(4)   VALUE +2612.
   930     12  ER-2613                     PIC S9(4)   VALUE +2613.
   931     12  ER-2614                     PIC S9(4)   VALUE +2614.
   932     12  ER-2615                     PIC S9(4)   VALUE +2615.
   933     12  ER-2616                     PIC S9(4)   VALUE +2616.
   934     12  ER-2617                     PIC S9(4)   VALUE +2617.
   935     12  ER-2618                     PIC S9(4)   VALUE +2618.
   936     12  ER-2619                     PIC S9(4)   VALUE +2619.
   937     12  ER-2620                     PIC S9(4)   VALUE +2620.
   938     12  ER-2621                     PIC S9(4)   VALUE +2621.
   939     12  ER-2622                     PIC S9(4)   VALUE +2622.
   940     12  ER-2623                     PIC S9(4)   VALUE +2623.
   941     12  ER-2624                     PIC S9(4)   VALUE +2624.
   942     12  ER-2625                     PIC S9(4)   VALUE +2625.
   943     12  ER-2626                     PIC S9(4)   VALUE +2626.
   944     12  ER-2627                     PIC S9(4)   VALUE +2627.
   945     12  ER-2628                     PIC S9(4)   VALUE +2628.
   946     12  ER-2629                     PIC S9(4)   VALUE +2629.
   947     12  ER-2630                     PIC S9(4)   VALUE +2630.
   948     12  ER-2631                     PIC S9(4)   VALUE +2631.
   949     12  ER-2632                     PIC S9(4)   VALUE +2632.
   950     12  ER-2633                     PIC S9(4)   VALUE +2633.
   951     12  ER-2634                     PIC S9(4)   VALUE +2634.
   952     12  ER-2635                     PIC S9(4)   VALUE +2635.
   953     12  ER-2636                     PIC S9(4)   VALUE +2636.
   954     12  ER-2637                     PIC S9(4)   VALUE +2637.
   955     12  ER-2638                     PIC S9(4)   VALUE +2638.
   956     12  ER-2639                     PIC S9(4)   VALUE +2639.
   957     12  ER-2640                     PIC S9(4)   VALUE +2640.
   958     12  ER-2641                     PIC S9(4)   VALUE +2641.
   959     12  ER-2642                     PIC S9(4)   VALUE +2642.
   960     12  ER-2643                     PIC S9(4)   VALUE +2643.
   961     12  ER-2644                     PIC S9(4)   VALUE +2644.
   962     12  ER-2645                     PIC S9(4)   VALUE +2645.
   963     12  ER-2646                     PIC S9(4)   VALUE +2646.
   964     12  ER-2647                     PIC S9(4)   VALUE +2647.
   965     12  ER-2648                     PIC S9(4)   VALUE +2648.
   966     12  ER-2649                     PIC S9(4)   VALUE +2649.
   967     12  ER-2650                     PIC S9(4)   VALUE +2650.
   968     12  ER-2651                     PIC S9(4)   VALUE +2651.
   969     12  ER-2652                     PIC S9(4)   VALUE +2652.
   970     12  ER-2653                     PIC S9(4)   VALUE +2653.
   971     12  ER-2654                     PIC S9(4)   VALUE +2654.
   972     12  ER-2655                     PIC S9(4)   VALUE +2655.
   973     12  ER-2656                     PIC S9(4)   VALUE +2656.
   974     12  ER-2657                     PIC S9(4)   VALUE +2657.
   975     12  ER-2658                     PIC S9(4)   VALUE +2658.
   976     12  ER-2659                     PIC S9(4)   VALUE +2659.
   977     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  19
* EL050.cbl
   978     12  ER-2661                     PIC S9(4)   VALUE +2661.
   979     12  ER-2662                     PIC S9(4)   VALUE +2662.
   980     12  ER-2663                     PIC S9(4)   VALUE +2663.
   981     12  ER-2664                     PIC S9(4)   VALUE +2664.
   982     12  ER-2665                     PIC S9(4)   VALUE +2665.
   983     12  ER-2666                     PIC S9(4)   VALUE +2666.
   984     12  ER-2667                     PIC S9(4)   VALUE +2667.
   985     12  ER-2668                     PIC S9(4)   VALUE +2668.
   986     12  ER-2669                     PIC S9(4)   VALUE +2669.
   987     12  ER-2670                     PIC S9(4)   VALUE +2670.
   988     12  ER-2671                     PIC S9(4)   VALUE +2671.
   989     12  ER-2672                     PIC S9(4)   VALUE +2672.
   990     12  ER-2673                     PIC S9(4)   VALUE +2673.
   991     12  ER-2674                     PIC S9(4)   VALUE +2674.
   992     12  ER-2675                     PIC S9(4)   VALUE +2675.
   993     12  ER-2676                     PIC S9(4)   VALUE +2676.
   994     12  ER-2677                     PIC S9(4)   VALUE +2677.
   995     12  ER-2678                     PIC S9(4)   VALUE +2678.
   996     12  ER-2679                     PIC S9(4)   VALUE +2679.
   997     12  ER-2680                     PIC S9(4)   VALUE +2680.
   998     12  ER-2681                     PIC S9(4)   VALUE +2681.
   999     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1000     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1001     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1002     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1003     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1004     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1005     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1006     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1007     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1008     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1009     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1010     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1011     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1012     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1013     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1014     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1015     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1016     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1017     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1018     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1019     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1020     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1021     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1022     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1023     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1024     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1025     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1026     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1027     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1028     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1029     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1030     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1031     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1032     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1033     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1034     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1035     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  20
* EL050.cbl
  1036     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1037     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1038     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1039     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1040     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1041     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1042     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1043     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1044     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1045     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1046     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1047     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1048     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1049     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1050     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1051     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1052     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1053     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1054     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1055     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1056     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1057     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1058     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1059     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1060     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1061     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1062     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1063     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1064     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1065     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1066     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1067     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1068     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1069     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1070     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1071     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1072     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1073     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1074     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1075     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1076     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1077     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1078     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1079     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1080     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1081     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1082     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1083     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1084     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1085     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1086     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1087     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1088     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1089     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1090     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1091     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1092     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1093     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  21
* EL050.cbl
  1094     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1095     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1096     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1097     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1098     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1099     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1100     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1101     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1102     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1103     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1104     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1105     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1106     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1107     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1108     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1109     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1110     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1111     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1112     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1113     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1114     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1115     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1116     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1117     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1118     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1119     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1120     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1121     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1122     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1123     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1124     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1125     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1126     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1127     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1128     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1129     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1130     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1131     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1132     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1133     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1134     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1135     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1136     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1137     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1138     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1139     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1140     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1141     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1142     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1143     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1144     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1145     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1146     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1147     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1148     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1149     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1150     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1151     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  22
* EL050.cbl
  1152     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1153     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1154     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1155     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1156     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1157     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1158     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1159     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1160     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1161     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1162     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1163     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1164     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1165     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1166     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1167     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1168     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1169     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1170     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1171     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1172     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1173     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1174     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1175     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1176     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1177     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1178     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1179     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1180     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1181     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1182     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1183     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1184     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1185     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1186     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1187     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1188     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1189     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1190     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1191     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1192     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1193     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1194     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1195     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1196     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1197     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1198     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1199     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1200     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1201     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1202     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1203     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1204     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1205     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1206     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1207     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1208     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1209     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  23
* EL050.cbl
  1210     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1211     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1212     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1213     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1214     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1215     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1216     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1217     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1218     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1219******************************************************************
  1220***************   END OF ELC50WS     ****************************
  1221******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  24
* EL050.cbl
  1224 01  WORKING-STORAGE-WORK-AREAS.
  1225     12  WS-RESPONSE             PIC S9(8)  COMP.
  1226         88  WS-RESP-NORMAL           VALUE +00.
  1227         88  WS-RESP-ERROR            VALUE +01.
  1228         88  WS-RESP-NOTFND           VALUE +13.
  1229         88  WS-RESP-DUPREC           VALUE +14.
  1230         88  WS-RESP-ENDFILE          VALUE +20.
  1231     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1232     12  WORK-AREAS.
  1233         16  WK-CONV-GREG.
  1234             24  WCG-CENT             PIC XX.
  1235             24  WCG-REST             PIC X(4).
  1236         16  WORK-GREGORIAN-DATE.
  1237             24  WK-GREG-CENT         PIC XX.
  1238             24  WK-GREG-DATE-YYMMDD.
  1239                 28  WK-GREG-YYMM     PIC X(4).
  1240                 28  WK-GREG-DD       PIC XX.
  1241
  1242         16  WORK-SELECT-DATE.
  1243             24  WK-SELECT-CENT            PIC XX.
  1244             24  WK-SELECT-DATE-YYMMDD.
  1245                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1246                 28  FILLER                PIC XX.
  1247
  1248         16  WK-FORM-NO.
  1249             24  WK-FORM-BANK-ID       PIC X(5).
  1250             24  WK-FORM-UNDRWRTR      PIC X(1).
  1251             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1252
  1253         16  WK-MEMBER-NO.
  1254             24  WK-MEMBER-1-6        PIC X(6).
  1255             24  WK-MEMBER-7-12       PIC X(6).
  1256
  1257         16  WK-FULL-CERT-NO.
  1258             24  WK-CERT-POS-1-2      PIC X(2).
  1259             24  WK-CERT-POS-3        PIC X(1).
  1260             24  WK-CERT-POS-4        PIC X(1).
  1261             24  WK-CERT-POS-5-6      PIC X(2).
  1262             24  WK-CERT-POS-7        PIC X(1).
  1263             24  WK-CERT-POS-8-11     PIC X(4).
  1264
  1265         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1266             88  VALID-RATE-CODE        VALUE 'Y'.
  1267             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1268
  1269         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1270         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1273         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1274         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1275         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1276         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1277         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1278         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1279
  1280* DLO001
  1281 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  25
* EL050.cbl
  1282     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1283     12  DMPF-RETURN-CODE          PIC XX.
  1284         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1285         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1286         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1287         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1288         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1289         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1290
  1291* DLO002
  1292 01  WS-DLO-INTERNAL-POLICY-FORM.
  1293     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1294     12  DIPF-RETURN-CODE          PIC XX.
  1295         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1296         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1297         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1298         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1299         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1300         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1301
  1302* DLO003
  1303 01  WS-DLO-VALID-BANK-ID.
  1304     12  DVBI-BANK-ID              PIC X(5).
  1305     12  DVBI-BANK-ID-TYPE         PIC X.
  1306         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1307         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1308         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1309         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1310         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1311     12  DVBI-RETURN-CODE          PIC XX.
  1312         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1313         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1314         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1315         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1316         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1317         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1318         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1319         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1320         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1321
  1322* DLO007
  1323 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1324     12  DCUA-RES-STATE            PIC XX.
  1325     12  DCUA-BEN-TYPE             PIC XX.
  1326     12  DCUA-SYS-IDENT            PIC X.
  1327         88  DCUA-CLAIM                        VALUE 'C'.
  1328         88  DCUA-PREMIUM                      VALUE 'P'.
  1329     12  DCUA-COVERAGE-RULE        PIC X.
  1330     12  DCUA-CLIENT-ID            PIC X(10).
  1331     12  DCUA-EFF-DATE             PIC X(8).
  1332     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1333     12  DCUA-RETURN-CODE          PIC XX.
  1334         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1335     12  DCUA-CERT-NUMBER          PIC X(11).
  1336     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1337     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1338
  1339* DLO011
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  26
* EL050.cbl
  1340 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1341     12  DPRB-RATE-CODE            PIC X(4).
  1342     12  DPRB-COVERAGE-CATEG       PIC X.
  1343     12  DPRB-RETURN-CODE          PIC XX.
  1344         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1345         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1346         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1347         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1348         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1349         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1350         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1351         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1352         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1353     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1354     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1355     12  DPRB-BEN-TYPE             PIC XX.
  1356
  1357* DLO017
  1358 01  WS-DLO-VALID-RATE-CODE.
  1359     12  DVRC-RATE-CODE            PIC X(4).
  1360     12  DVRC-RETURN-CODE          PIC XX.
  1361         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1363         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1364         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1365         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1366         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO019
  1369 01  WS-DLO-ORIG-COV-CAT.
  1370     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1371     12  DOCC-RETURN-CODE          PIC XX.
  1372     12  DOCC-ORIG-COV-CAT         PIC X.
  1373     12  DOCC-UNDERWITER           PIC XX.
  1374     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1375     12  DOCC-FILLER               PIC X(6).
  1376
  1377* DLO021
  1378 01  WS-DLO-VALID-LOAN-OFFICER.
  1379     12  DVLO-LOAN-OFFICER.
  1380         16  DVLO-BILL-TYPE        PIC X.
  1381         16  DVLO-BILL-SOURCE      PIC X.
  1382         16  DVLO-BATCH-TYPE       PIC X.
  1383     12  DVLO-RETURN-CODE          PIC XX.
  1384         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1385         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1386         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1387         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1388         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1389         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1390
  1391* DLO022
  1392 01  WS-DLO-VALID-STATE-CODE.
  1393     12  DVSC-STATE-CODE           PIC XX.
  1394     12  DVSC-RETURN-CODE          PIC XX.
  1395         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1396
  1397* DLO023
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  27
* EL050.cbl
  1398 01  WS-DLO-VALID-CODE-VALUES.
  1399     12  DVCV-SYSTEM-ID            PIC XX.
  1400         88  DVCV-CLAIMS                       VALUE 'CL'.
  1401         88  DVCV-CREDIT                       VALUE 'CR'.
  1402     12  DVCV-RECORD-TYPE          PIC XX.
  1403         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1404         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1405         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1406         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1407         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1408         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1409         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1410         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1411     12  DVCV-RECORD-KEY           PIC X(6).
  1412     12  DVCV-RETURN-CODE          PIC XX.
  1413         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1414         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1415         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1416         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1417         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1418         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1419         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1420     12  DVCV-CODE-DESC            PIC X(60).
  1421     12  DVCV-GEN-DESC-1           PIC X(20).
  1422     12  DVCV-GEN-DESC-2           PIC X(20).
  1423     12  DVCV-GEN-DESC-3           PIC X(20).
  1424
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  28
* EL050.cbl
  1426*    COPY ERCBXRF.
  1427******************************************************************
  1428*                                                                *
  1429*                                                                *
  1430*                            ERCBXRF                             *
  1431*                                                                *
  1432*   ONLINE CREDIT SYSTEM                                         *
  1433*                                                                *
  1434*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1435*                                                                *
  1436*   FILE TYPE = VSAM,KSDS                                        *
  1437*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1438*                                                                *
  1439*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1440*       ALTERNATE PATH = NONE                                    *
  1441*                                                                *
  1442*   LOG = NO                                                     *
  1443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1444*                                                                *
  1445******************************************************************
  1446
  1447 01  BANK-CROSS-REFERENCE.
  1448     12  BK-RECORD-ID                PIC XX.
  1449         88  VALID-BK-ID             VALUE 'BK'.
  1450
  1451     12  BK-CONTROL-PRIMARY.
  1452         16  BK-COMPANY-CD           PIC X.
  1453         16  BK-CARRIER              PIC X.
  1454         16  BK-GROUPING             PIC X(6).
  1455         16  BK-BANK-NO              PIC X(10).
  1456
  1457     12  BK-MAINT-INFORMATION.
  1458         16  BK-LAST-MAINT-DT        PIC XX.
  1459         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1460         16  BK-LAST-MAINT-USER      PIC X(4).
  1461         16  FILLER                  PIC X(9).
  1462
  1463     12  FILLER                      PIC X(37).
  1464
  1465     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1466
  1467     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1468                            DEPENDING ON BK-BANK-POINTER-CNT.
  1469         16  BK-AM-ACCOUNT           PIC X(10).
  1470         16  BK-AM-EXP-DT            PIC XX.
  1471         16  BK-AM-EFF-DT            PIC XX.
  1472         16  BK-AM-STATE             PIC XX.
  1473         16  FILLER                  PIC X(20).
  1474
  1475******************************************************************
  1476
  1477*    COPY ERCCOMP.
  1478******************************************************************
  1479*                                                                *
  1480*                                                                *
  1481*                            ERCCOMP                             *
  1482*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1483*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  29
* EL050.cbl
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499*                   C H A N G E   L O G
  1500*
  1501* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1502*-----------------------------------------------------------------
  1503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1504* EFFECTIVE    NUMBER
  1505*-----------------------------------------------------------------
  1506* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1507* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1508* 092205    2005050300006  PEMA  ADD LEASE FEE
  1509* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1510* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1511* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1513* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1514* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1515******************************************************************
  1516
  1517 01  COMPENSATION-MASTER.
  1518     12  CO-RECORD-ID                          PIC XX.
  1519         88  VALID-CO-ID                          VALUE 'CO'.
  1520
  1521     12  CO-CONTROL-PRIMARY.
  1522         16  CO-COMPANY-CD                     PIC X.
  1523         16  CO-CONTROL.
  1524             20  CO-CTL-1.
  1525                 24  CO-CARR-GROUP.
  1526                     28  CO-CARRIER            PIC X.
  1527                     28  CO-GROUPING.
  1528                         32  CO-GROUP-PREFIX   PIC XXX.
  1529                         32  CO-GROUP-PRIME    PIC XXX.
  1530                 24  CO-RESP-NO.
  1531                     28  CO-RESP-PREFIX        PIC X(4).
  1532                     28  CO-RESP-PRIME         PIC X(6).
  1533             20  CO-CTL-2.
  1534                 24  CO-ACCOUNT.
  1535                     28  CO-ACCT-PREFIX        PIC X(4).
  1536                     28  CO-ACCT-PRIME         PIC X(6).
  1537         16  CO-TYPE                           PIC X.
  1538             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1539             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1540             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1541
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  30
* EL050.cbl
  1542     12  CO-MAINT-INFORMATION.
  1543         16  CO-LAST-MAINT-DT                  PIC XX.
  1544         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1545         16  CO-LAST-MAINT-USER                PIC X(4).
  1546     12  FILLER                                PIC XX.
  1547     12  CO-STMT-TYPE                          PIC XXX.
  1548     12  CO-COMP-TYPE                          PIC X.
  1549         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1550     12  CO-STMT-OWNER                         PIC X(4).
  1551     12  CO-BALANCE-CONTROL                    PIC X.
  1552         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1553         88  CO-NO-BALANCE                        VALUE 'N'.
  1554
  1555     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1556         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1557         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1558         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1559
  1560     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1561         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1562         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1563
  1564     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1565     12  CO-GA-DIRECT-DEP                      PIC X.
  1566     12  CO-FUTURE-SPACE                       PIC X.
  1567         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1568
  1569     12  CO-ACCT-NAME                          PIC X(30).
  1570     12  CO-MAIL-NAME                          PIC X(30).
  1571     12  CO-ADDR-1                             PIC X(30).
  1572     12  CO-ADDR-2                             PIC X(30).
  1573     12  CO-ADDR-3.
  1574         16  CO-ADDR-CITY                      PIC X(27).
  1575         16  CO-ADDR-STATE                     PIC XX.
  1576     12  CO-CSO-1099                           PIC X.
  1577     12  CO-ZIP.
  1578         16  CO-ZIP-PRIME.
  1579             20  CO-ZIP-PRI-1ST                PIC X.
  1580                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1581             20  FILLER                        PIC X(4).
  1582         16  CO-ZIP-PLUS4                      PIC X(4).
  1583     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1584         16  CO-CAN-POSTAL-1                   PIC XXX.
  1585         16  CO-CAN-POSTAL-2                   PIC XXX.
  1586         16  FILLER                            PIC XXX.
  1587     12  CO-SOC-SEC                            PIC X(13).
  1588     12  CO-TELEPHONE.
  1589         16  CO-AREA-CODE                      PIC XXX.
  1590         16  CO-PREFIX                         PIC XXX.
  1591         16  CO-PHONE                          PIC X(4).
  1592
  1593     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1594
  1595     12  CO-AR-BAL-LEVEL                       PIC X.
  1596         88  CO-AR-REF-LVL                        VALUE '1'.
  1597         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1598         88  CO-AR-BILL-LVL                       VALUE '2'.
  1599         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  31
* EL050.cbl
  1600         88  CO-AR-FR-LVL                         VALUE '4'.
  1601
  1602     12  CO-AR-NORMAL-PRINT                    PIC X.
  1603         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1604         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1605
  1606     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1607
  1608     12  CO-AR-REPORTING                       PIC X.
  1609         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1610         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1611
  1612     12  CO-AR-PULL-CHECK                      PIC X.
  1613         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1614         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1615
  1616     12  CO-AR-BALANCE-PRINT                   PIC X.
  1617         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1618
  1619     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1620         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1621         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1622         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1623
  1624     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1625
  1626     12  CO-USER-CODE                          PIC X.
  1627     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1628
  1629******************************************************************
  1630*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1631*    THE LAST MONTH END RUN.
  1632******************************************************************
  1633
  1634     12  CO-LAST-ACTIVITY-DATE.
  1635         16  CO-ACT-YEAR                       PIC 99.
  1636         16  CO-ACT-MONTH                      PIC 99.
  1637         16  CO-ACT-DAY                        PIC 99.
  1638
  1639     12  CO-LAST-STMT-DT.
  1640         16  CO-LAST-STMT-YEAR                 PIC 99.
  1641         16  CO-LAST-STMT-MONTH                PIC 99.
  1642         16  CO-LAST-STMT-DAY                  PIC 99.
  1643
  1644     12  CO-MO-END-TOTALS.
  1645         16  CO-MONTHLY-TOTALS.
  1646             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1647             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1650             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1651
  1652         16  CO-AGING-TOTALS.
  1653             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1654             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1655             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1657
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  32
* EL050.cbl
  1658         16  CO-YTD-TOTALS.
  1659             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1660             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-OVER-UNDER-TOTALS.
  1663             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1664             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-MISCELLANEOUS-TOTALS.
  1667         16  CO-FICA-TOTALS.
  1668             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-CLAIM-TOTALS.
  1672             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1673             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674
  1675******************************************************************
  1676*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1677*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1678******************************************************************
  1679
  1680     12  CO-CURRENT-TOTALS.
  1681         16  CO-CURRENT-LAST-STMT-DT.
  1682             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1683             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1685
  1686         16  CO-CURRENT-MONTHLY-TOTALS.
  1687             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1692
  1693         16  CO-CURRENT-AGING-TOTALS.
  1694             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1695             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-CURRENT-YTD-TOTALS.
  1700             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1701             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1702
  1703     12  CO-PAID-COMM-TOTALS.
  1704         16  CO-YTD-PAID-COMMS.
  1705             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1706             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1707
  1708     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1709         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1710         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1711
  1712     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1713         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1714         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1715         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  33
* EL050.cbl
  1716         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1717         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1718         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1719         88  CO-FINAL-LETTER                  VALUE 'F'.
  1720         88  CO-RECONCILING                   VALUE 'R'.
  1721         88  CO-PHONE-CALL                    VALUE 'P'.
  1722         88  CO-LEGAL                         VALUE 'L'.
  1723         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1724         88  CO-WRITE-OFF                     VALUE 'W'.
  1725         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1726
  1727     12  CO-CSR-CODE                       PIC X(4).
  1728
  1729     12  CO-GA-STATUS-INFO.
  1730         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1731         16  CO-GA-TERMINATION-DT          PIC XX.
  1732         16  CO-GA-STATUS-CODE             PIC X.
  1733             88  CO-GA-ACTIVE                 VALUE 'A'.
  1734             88  CO-GA-INACTIVE               VALUE 'I'.
  1735             88  CO-GA-PENDING                VALUE 'P'.
  1736         16  CO-GA-COMMENTS.
  1737             20  CO-GA-COMMENT-1           PIC X(40).
  1738             20  CO-GA-COMMENT-2           PIC X(40).
  1739             20  CO-GA-COMMENT-3           PIC X(40).
  1740             20  CO-GA-COMMENT-4           PIC X(40).
  1741
  1742     12  CO-RPTCD2                         PIC X(10).
  1743     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1744         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1745         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1746
  1747     12  CO-TYPE-AGENT                     PIC X(01).
  1748         88  CO-CORPORATION                   VALUE 'C'.
  1749         88  CO-PARTNERSHIP                   VALUE 'P'.
  1750         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1751         88  CO-TRUST                         VALUE 'T'.
  1752         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1753
  1754     12  CO-FAXNO.
  1755         16  CO-FAX-AREA-CODE                  PIC XXX.
  1756         16  CO-FAX-PREFIX                     PIC XXX.
  1757         16  CO-FAX-PHONE                      PIC X(4).
  1758
  1759     12  CO-BANK-INFORMATION.
  1760         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1761         16  CO-BANK-TRANSIT-NON REDEFINES
  1762             CO-BANK-TRANSIT-NO                PIC 9(8).
  1763
  1764         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1765     12  CO-MISC-DEDUCT-INFO REDEFINES
  1766                  CO-BANK-INFORMATION.
  1767         16  CO-MD-GL-ACCT                     PIC X(10).
  1768         16  CO-MD-DIV                         PIC XX.
  1769         16  CO-MD-CENTER                      PIC X(4).
  1770         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1771         16  CO-CREATE-AP-CHECK                PIC X.
  1772         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1773         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  34
* EL050.cbl
  1774     12  CO-ACH-STATUS                         PIC X.
  1775         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1776         88  CO-ACH-PENDING                        VALUE 'P'.
  1777
  1778     12  CO-BILL-SW                            PIC X.
  1779     12  CO-CONTROL-NAME                       PIC X(30).
  1780     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1781     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1782     12  CO-CLP-STATE                          PIC XX.
  1783     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1784     12  CO-SPP-REFUND-EDIT                    PIC X.
  1785
  1786******************************************************************
  1787
  1788*    COPY ERCAGTC.
  1789******************************************************************
  1790*                                                                *
  1791*                                                                *
  1792*                            ERCAGTC                             *
  1793*                            VMOD=2.001                          *
  1794*                                                                *
  1795*   ONLINE CREDIT SYSTEM                                         *
  1796*                                                                *
  1797*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1798*                                                                *
  1799*   FILE TYPE = VSAM,KSDS                                        *
  1800*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1801*                                                                *
  1802*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1803*       ALTERNATE PATH = NONE                                    *
  1804*                                                                *
  1805*   LOG = NO                                                     *
  1806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1807*                                                                *
  1808******************************************************************
  1809*                   C H A N G E   L O G
  1810*
  1811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1812*-----------------------------------------------------------------
  1813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1814* EFFECTIVE    NUMBER
  1815*-----------------------------------------------------------------
  1816* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1817* 111004                         NEW FILE AND COPYBOOK
  1818* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1819******************************************************************
  1820 01  AGENT-COMMISSIONS.
  1821     12  AG-RECORD-ID                          PIC XX.
  1822         88  VALID-CO-ID                          VALUE 'AG'.
  1823     12  AG-CONTROL-PRIMARY.
  1824         16  AG-COMPANY-CD                     PIC X.
  1825         16  AG-CONTROL.
  1826             20  AG-CTL-1.
  1827                 24  AG-CARR-GROUP.
  1828                     28  AG-CARRIER            PIC X.
  1829                     28  AG-GROUPING           PIC X(6).
  1830                 24  AG-BANK                   PIC X(10).
  1831             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  35
* EL050.cbl
  1832                 24  AG-EXP-DT                 PIC XX.
  1833         16  AG-TYPE                           PIC X.
  1834             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1835             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1836     12  AG-MAINT-INFORMATION.
  1837         16  AG-LAST-MAINT-DT                  PIC XX.
  1838         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1839         16  AG-LAST-MAINT-USER                PIC X(4).
  1840         16  FILLER                            PIC X(10).
  1841     12  AG-EFF-DT                             PIC XX.
  1842     12  AG-COMM-STRUCTURE.
  1843         16  AG-AGT-COMMS OCCURS 10.
  1844             20  AG-AGT                PIC X(10).
  1845             20  AG-COM-TYP            PIC X.
  1846             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1847             20  AG-RECALC-LV-INDIC    PIC X.
  1848             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1849             20  AG-LRCALC-LV-INDIC    PIC X.
  1850             20  FILLER                PIC X(05).
  1851     12  FILLER                  PIC X(145).
  1852******************************************************************
  1853*    COPY ERCRESS.
  1854******************************************************************
  1855*                                                                *
  1856*                            ERCRESS                             *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.002                          *
  1859*                                                                *
  1860*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1861*                                                                *
  1862*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1863*   VSAM RESIDENT STATE TAX MASTER                              *
  1864*                                                                *
  1865*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1866*                                                                *
  1867*   FILE TYPE = VSAM,KSDS                                        *
  1868*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1869*                                                                *
  1870*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1871*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1872*                                                                *
  1873*   LOG = NO                                                     *
  1874*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1875*                                                                *
  1876*                                                                *
  1877******************************************************************
  1878
  1879 01  RESIDENT-STATE-TAX-MASTER.
  1880
  1881     10  ERRESS-PRIMARY-KEY.
  1882         15  RES-COMPANY-CD        PIC X.
  1883         15  RES-RESIDENT-STATE    PIC XX.
  1884         15  RES-COVERAGE-CATEGORY PIC X.
  1885         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1886*                                      YYYYMMDD
  1887*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1888
  1889     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  36
* EL050.cbl
  1890
  1891         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1892         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1893         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1894         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1895
  1896     10 RES-RECALC-SW              PIC   X.
  1897         88 RECALC                VALUE 'Y'.
  1898         88 NO-RECALC             VALUE 'N'.
  1899     10  RES-MAINT-BY              PIC X(4).
  1900     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1901     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1902*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  37
* EL050.cbl
  1904*    COPY ERCRESC.
  1905******************************************************************
  1906*                                                                *
  1907*                            ERCRESC                             *
  1908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1909*                            VMOD=2.003                          *
  1910*                                                                *
  1911*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1912*                                                                *
  1913*   FILE TYPE = VSAM,KSDS                                        *
  1914*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1915*                                                                *
  1916*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1917*       ALTERNATE PATH1 = NONE                                   *
  1918*                                                                *
  1919*   LOG = NO                                                     *
  1920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1921*                                                                *
  1922******************************************************************
  1923
  1924 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1925
  1926     10  ERRESC-RECORD-KEY.
  1927         15  RESC-COMPANY-CD           PIC   X.
  1928         15  RESC-CARRIER              PIC   X.
  1929         15  RESC-GROUP                PIC   X(6).
  1930         15  RESC-STATE                PIC   XX.
  1931         15  RESC-ACCOUNT              PIC   X(10).
  1932         15  RESC-AGENT                PIC   X(10).
  1933         15  RESC-RESIDENT-STATE       PIC   XX.
  1934         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1935*                                           YYYYMMDD
  1936     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1937
  1938     10  RESC-COMM-RECORD-DATA.
  1939         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1940             20 RESC-COVERAGE-CAT      PIC    X.
  1941             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1942             20 RESC-COMMISSION-TAB REDEFINES
  1943                RESC-COMMISSION-PER    PIC  XXX.
  1944
  1945     10  RESC-MAINT-BY                 PIC X(4).
  1946     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1947     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1948*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  38
* EL050.cbl
  1950*    COPY ERCPLAN.
  1951******************************************************************
  1952*                                                                *
  1953*                                                                *
  1954*                            ERCPLAN                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1959*                                                                *
  1960*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1961*   PLAN MASTER                                                  *
  1962*                                                                *
  1963*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 420   RECFORM = FIX                            *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1969*       ALTERNATE PATH1 = N/A                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  PLAN-MASTER.
  1978     12  PL-RECORD-ID                      PIC XX.
  1979         88  VALID-PL-ID                      VALUE 'PL'.
  1980
  1981     12  PL-CONTROL-PRIMARY.
  1982         16  PL-COMPANY-CD                 PIC X.
  1983         16  PL-MSTR-CNTRL.
  1984             20  PL-CONTROL-A.
  1985                 24  PL-CARRIER            PIC X.
  1986                 24  PL-GROUPING           PIC X(6).
  1987                 24  PL-STATE              PIC XX.
  1988                 24  PL-ACCOUNT            PIC X(10).
  1989             20  PL-BENEFIT-TYPE           PIC X.
  1990             20  PL-BENEFIT-CODE           PIC XX.
  1991             20  PL-REVISION-NO            PIC X(3).
  1992
  1993     12  PL-CONTROL-BY-VAR-GRP.
  1994         16  PL-COMPANY-CD-A1              PIC X.
  1995         16  PL-VG-CARRIER                 PIC X.
  1996         16  PL-VG-GROUPING                PIC X(6).
  1997         16  PL-VG-STATE                   PIC XX.
  1998         16  PL-VG-ACCOUNT                 PIC X(10).
  1999         16  PL-BENEFIT-TYPE-A1            PIC X.
  2000         16  PL-BENEFIT-CODE-A1            PIC XX.
  2001         16  PL-REVISION-NO-A1             PIC 999.
  2002
  2003     12  PL-MAINT-INFORMATION.
  2004         16  PL-LAST-MAINT-DT              PIC XX.
  2005         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2006         16  PL-LAST-MAINT-USER            PIC X(4).
  2007         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  39
* EL050.cbl
  2008
  2009     12  PL-LIABILITY-LIMITS.
  2010         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2011         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2012             20  PL-LM-AGE                 PIC S99        COMP-3.
  2013             20  PL-LM-DUR                 PIC S999       COMP-3.
  2014             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2015             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2016
  2017     12  FILLER                            PIC X(30).
  2018
  2019     12  PL-GL-ACCOUNT-NOS.
  2020         16  PL-PREMIUM-GL                 PIC X(8).
  2021         16  PL-COMM-GL                    PIC X(8).
  2022         16  PL-CLAIM-GL                   PIC X(8).
  2023     12  FILLER                            PIC X(24).
  2024     12  PL-TOLERANCES.
  2025         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2026         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2027         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2029         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2030         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2031     12  PL-OVER-SHORT.
  2032         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2033         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2034     12  FILLER                            PIC X(24).
  2035     12  PLAN-MISC.
  2036         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2037         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2038         16  PL-IG                         PIC X.
  2039         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2040         16  PL-POLICY-FORM                PIC X(12).
  2041         16  PL-EDIT-FOR-FORM              PIC X(01).
  2042         16  PL-DEV-CODE                   PIC XXX.
  2043         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2044         16  PL-CALC-METHOD                PIC X.
  2045         16  PL-BENEFIT-GROUP              PIC X(05).
  2046         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2047
  2048         16  FILLER                        PIC X(99).
  2049******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  40
* EL050.cbl
  2051*    COPY ELCCERT.
  2052******************************************************************
  2053*                                                                *
  2054*                            ELCCERT.                            *
  2055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2056*                            VMOD=2.013                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2059*                                                                *
  2060*   FILE TYPE = VSAM,KSDS                                        *
  2061*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2062*                                                                *
  2063*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2064*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2065*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2066*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2067*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2068*                                                                *
  2069*   LOG = YES                                                    *
  2070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2071******************************************************************
  2072*                   C H A N G E   L O G
  2073*
  2074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2075*-----------------------------------------------------------------
  2076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2077* EFFECTIVE    NUMBER
  2078*-----------------------------------------------------------------
  2079* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2080* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2081* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2082* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2083* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2084* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2085* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2086* 032612  CR2011110200001  PEMA  AHL CHANGES
  2087******************************************************************
  2088
  2089 01  CERTIFICATE-MASTER.
  2090     12  CM-RECORD-ID                      PIC XX.
  2091         88  VALID-CM-ID                      VALUE 'CM'.
  2092
  2093     12  CM-CONTROL-PRIMARY.
  2094         16  CM-COMPANY-CD                 PIC X.
  2095         16  CM-CARRIER                    PIC X.
  2096         16  CM-GROUPING.
  2097             20  CM-GROUPING-PREFIX        PIC X(3).
  2098             20  CM-GROUPING-PRIME         PIC X(3).
  2099         16  CM-STATE                      PIC XX.
  2100         16  CM-ACCOUNT.
  2101             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2102             20  CM-ACCOUNT-PRIME          PIC X(6).
  2103         16  CM-CERT-EFF-DT                PIC XX.
  2104         16  CM-CERT-NO.
  2105             20  CM-CERT-PRIME             PIC X(10).
  2106             20  CM-CERT-SFX               PIC X.
  2107
  2108     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  41
* EL050.cbl
  2109         16  CM-COMPANY-CD-A1              PIC X.
  2110         16  CM-INSURED-LAST-NAME          PIC X(15).
  2111         16  CM-INSURED-INITIALS.
  2112             20  CM-INSURED-INITIAL1       PIC X.
  2113             20  CM-INSURED-INITIAL2       PIC X.
  2114
  2115     12  CM-CONTROL-BY-SSN.
  2116         16  CM-COMPANY-CD-A2              PIC X.
  2117         16  CM-SOC-SEC-NO.
  2118             20  CM-SSN-STATE              PIC XX.
  2119             20  CM-SSN-ACCOUNT            PIC X(6).
  2120             20  CM-SSN-LN3.
  2121                 25  CM-INSURED-INITIALS-A2.
  2122                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2123                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2124                 25 CM-PART-LAST-NAME-A2         PIC X.
  2125
  2126     12  CM-CONTROL-BY-CERT-NO.
  2127         16  CM-COMPANY-CD-A4              PIC X.
  2128         16  CM-CERT-NO-A4                 PIC X(11).
  2129
  2130     12  CM-CONTROL-BY-MEMB.
  2131         16  CM-COMPANY-CD-A5              PIC X.
  2132         16  CM-MEMBER-NO.
  2133             20  CM-MEMB-STATE             PIC XX.
  2134             20  CM-MEMB-ACCOUNT           PIC X(6).
  2135             20  CM-MEMB-LN4.
  2136                 25  CM-INSURED-INITIALS-A5.
  2137                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2138                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2139                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2140
  2141     12  CM-INSURED-PROFILE-DATA.
  2142         16  CM-INSURED-FIRST-NAME.
  2143             20  CM-INSURED-1ST-INIT       PIC X.
  2144             20  FILLER                    PIC X(9).
  2145         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2146         16  CM-INSURED-SEX                PIC X.
  2147             88  CM-SEX-MALE                  VALUE 'M'.
  2148             88  CM-SEX-FEMAL                 VALUE 'F'.
  2149         16  CM-INSURED-JOINT-AGE          PIC 99.
  2150         16  CM-JOINT-INSURED-NAME.
  2151             20  CM-JT-LAST-NAME           PIC X(15).
  2152             20  CM-JT-FIRST-NAME.
  2153                 24  CM-JT-1ST-INIT        PIC X.
  2154                 24  FILLER                PIC X(9).
  2155             20  CM-JT-INITIAL             PIC X.
  2156
  2157     12  CM-LIFE-DATA.
  2158         16  CM-LF-BENEFIT-CD              PIC XX.
  2159         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2160         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2161         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2162         16  CM-LF-DEV-CODE                PIC XXX.
  2163         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2164         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2165         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2166         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  42
* EL050.cbl
  2167         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2168         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2170         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2171         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2172         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2173         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2174         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2175         16  FILLER                        PIC XX.
  2176
  2177     12  CM-AH-DATA.
  2178         16  CM-AH-BENEFIT-CD              PIC XX.
  2179         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2180         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2181         16  CM-AH-DEV-CODE                PIC XXX.
  2182         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2184         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2189         16  CM-AH-PAID-THRU-DT            PIC XX.
  2190             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2191         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2194         16  FILLER                        PIC X.
  2195
  2196     12  CM-LOAN-INFORMATION.
  2197         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2198         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2199                                           PIC S9(5)V99  COMP-3.
  2200         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2201         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2202         16  CM-PAY-FREQUENCY              PIC S99.
  2203         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2204         16  CM-RATE-CLASS                 PIC XX.
  2205         16  CM-BENEFICIARY                PIC X(25).
  2206         16  CM-POLICY-FORM-NO             PIC X(12).
  2207         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2208         16  CM-LAST-ADD-ON-DT             PIC XX.
  2209         16  CM-DEDUCTIBLE-AMOUNTS.
  2210             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2211             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2212         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2213             20  CM-RESIDENT-STATE         PIC XX.
  2214             20  CM-RATE-CODE              PIC X(4).
  2215             20  FILLER                    PIC XX.
  2216         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2217             20  CM-LOAN-OFFICER           PIC X(5).
  2218             20  FILLER                    PIC XXX.
  2219         16  CM-CSR-CODE                   PIC XXX.
  2220         16  CM-UNDERWRITING-CODE          PIC X.
  2221             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2222         16  CM-POST-CARD-IND              PIC X.
  2223         16  CM-NH-INTERFACE-SW            PIC X.
  2224         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  43
* EL050.cbl
  2225             88  CM-SING-PRM                  VALUE '1'.
  2226             88  CM-O-B-COVERAGE              VALUE '2'.
  2227             88  CM-OPEN-END                  VALUE '3'.
  2228         16  CM-IND-GRP-TYPE               PIC X.
  2229             88  CM-INDIVIDUAL                VALUE 'I'.
  2230             88  CM-GROUP                     VALUE 'G'.
  2231         16  CM-SKIP-CODE                  PIC X.
  2232             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2233             88  SKIP-JULY                    VALUE '1'.
  2234             88  SKIP-AUGUST                  VALUE '2'.
  2235             88  SKIP-SEPTEMBER               VALUE '3'.
  2236             88  SKIP-JULY-AUG                VALUE '4'.
  2237             88  SKIP-AUG-SEPT                VALUE '5'.
  2238             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2239             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2240             88  SKIP-JUNE                    VALUE '8'.
  2241             88  SKIP-JUNE-JULY               VALUE '9'.
  2242             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2243             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2244         16  CM-PAYMENT-MODE               PIC X.
  2245             88  PAY-MONTHLY                  VALUE SPACE.
  2246             88  PAY-WEEKLY                   VALUE '1'.
  2247             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2248             88  PAY-BI-WEEKLY                VALUE '3'.
  2249             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2250         16  CM-LOAN-NUMBER                PIC X(8).
  2251         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2252         16  CM-OLD-LOF                    PIC XXX.
  2253*        16  CM-LOAN-OFFICER               PIC XXX.
  2254         16  CM-REIN-TABLE                 PIC XXX.
  2255         16  CM-SPECIAL-REIN-CODE          PIC X.
  2256         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2257         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2259
  2260     12  CM-STATUS-DATA.
  2261         16  CM-ENTRY-STATUS               PIC X.
  2262         16  CM-ENTRY-DT                   PIC XX.
  2263
  2264         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2265         16  CM-LF-CANCEL-DT               PIC XX.
  2266         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2267
  2268         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2269         16  CM-LF-DEATH-DT                PIC XX.
  2270         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2271
  2272         16  CM-LF-CURRENT-STATUS          PIC X.
  2273             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2274                                                'M' '4' '5' '9'.
  2275             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2276             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2277             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2278             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2279             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2280             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2281             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2282             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  44
* EL050.cbl
  2283             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2284             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2285             88  CM-LF-DECLINED               VALUE 'D'.
  2286             88  CM-LF-VOIDED                 VALUE 'V'.
  2287
  2288         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2289         16  CM-AH-CANCEL-DT               PIC XX.
  2290         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2291
  2292         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2293         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2294         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2295
  2296         16  CM-AH-CURRENT-STATUS          PIC X.
  2297             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2298                                                'M' '4' '5' '9'.
  2299             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2300             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2301             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2302             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2303             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2304             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2305             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2306             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2307             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2308             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2309             88  CM-AH-DECLINED               VALUE 'D'.
  2310             88  CM-AH-VOIDED                 VALUE 'V'.
  2311
  2312         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2313             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2314             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2315             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2316         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2317
  2318         16  CM-ENTRY-BATCH                PIC X(6).
  2319         16  CM-LF-EXIT-BATCH              PIC X(6).
  2320         16  CM-AH-EXIT-BATCH              PIC X(6).
  2321         16  CM-LAST-MONTH-END             PIC XX.
  2322
  2323     12  CM-NOTE-SW                        PIC X.
  2324         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2325         88  CERT-NOTES-PRESENT               VALUE '1'.
  2326         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2327         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2328         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2329         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2330         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2331         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2332     12  CM-COMP-EXCP-SW                   PIC X.
  2333         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2334         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2335     12  CM-INSURED-ADDRESS-SW             PIC X.
  2336         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2337         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2338
  2339*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2340     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  45
* EL050.cbl
  2341     12  FILLER                            PIC X.
  2342
  2343*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2344     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2345     12  FILLER                            PIC X.
  2346*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2347     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2348
  2349     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2350         88  CERT-ADDED-BATCH                 VALUE ' '.
  2351         88  CERT-ADDED-ONLINE                VALUE '1'.
  2352         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2353         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2354         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2355     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2356         88  CERT-AS-LOADED                   VALUE ' '.
  2357         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2358         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2359         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2360         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2361         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2362         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2363         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2364
  2365     12  CM-ACCOUNT-COMM-PCTS.
  2366         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2367         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2368
  2369     12  CM-USER-FIELD                     PIC X.
  2370     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2371     12  CM-CLP-STATE                      PIC XX.
  2372     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2373     12  CM-USER-RESERVED                  PIC XXX.
  2374     12  FILLER REDEFINES CM-USER-RESERVED.
  2375         16  CM-AH-CLASS-CD                PIC XX.
  2376         16  F                             PIC X.
  2377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  46
* EL050.cbl
  2379*    COPY ERCMAIL.
  2380******************************************************************
  2381*                                                                *
  2382*                                                                *
  2383*                            ERCMAIL                             *
  2384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2385*                            VMOD=2.003                          *
  2386*                                                                *
  2387*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2388*                                                                *
  2389*   FILE TYPE = VSAM,KSDS                                        *
  2390*   RECORD SIZE = 374   RECFORM = FIX                            *
  2391*                                                                *
  2392*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2393*   ALTERNATE PATH    = NOT USED                                 *
  2394*                                                                *
  2395*   LOG = YES                                                    *
  2396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2397******************************************************************
  2398*                   C H A N G E   L O G
  2399*
  2400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2401*-----------------------------------------------------------------
  2402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2403* EFFECTIVE    NUMBER
  2404*-----------------------------------------------------------------
  2405* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2406* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2407* 111108                   PEMA  ADD CRED BENE ADDR2
  2408******************************************************************
  2409
  2410 01  MAILING-DATA.
  2411     12  MA-RECORD-ID                      PIC XX.
  2412         88  VALID-MA-ID                       VALUE 'MA'.
  2413
  2414     12  MA-CONTROL-PRIMARY.
  2415         16  MA-COMPANY-CD                 PIC X.
  2416         16  MA-CARRIER                    PIC X.
  2417         16  MA-GROUPING.
  2418             20  MA-GROUPING-PREFIX        PIC XXX.
  2419             20  MA-GROUPING-PRIME         PIC XXX.
  2420         16  MA-STATE                      PIC XX.
  2421         16  MA-ACCOUNT.
  2422             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2423             20  MA-ACCOUNT-PRIME          PIC X(6).
  2424         16  MA-CERT-EFF-DT                PIC XX.
  2425         16  MA-CERT-NO.
  2426             20  MA-CERT-PRIME             PIC X(10).
  2427             20  MA-CERT-SFX               PIC X.
  2428
  2429     12  FILLER                            PIC XX.
  2430
  2431     12  MA-ACCESS-CONTROL.
  2432         16  MA-SOURCE-SYSTEM              PIC XX.
  2433             88  MA-FROM-CREDIT                VALUE 'CR'.
  2434             88  MA-FROM-VSI                   VALUE 'VS'.
  2435             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2436             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  47
* EL050.cbl
  2437         16  MA-RECORD-ADD-DT              PIC XX.
  2438         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2439         16  MA-LAST-MAINT-DT              PIC XX.
  2440         16  MA-LAST-MAINT-BY              PIC XXXX.
  2441         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2442
  2443     12  MA-PROFILE-INFO.
  2444         16  MA-QUALIFY-CODE-1             PIC XX.
  2445         16  MA-QUALIFY-CODE-2             PIC XX.
  2446         16  MA-QUALIFY-CODE-3             PIC XX.
  2447         16  MA-QUALIFY-CODE-4             PIC XX.
  2448         16  MA-QUALIFY-CODE-5             PIC XX.
  2449
  2450         16  MA-INSURED-LAST-NAME          PIC X(15).
  2451         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2452         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2453         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2454         16  MA-INSURED-BIRTH-DT           PIC XX.
  2455         16  MA-INSURED-SEX                PIC X.
  2456             88  MA-SEX-MALE                   VALUE 'M'.
  2457             88  MA-SEX-FEMALE                 VALUE 'F'.
  2458         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2459
  2460         16  MA-ADDRESS-CORRECTED          PIC X.
  2461         16  MA-JOINT-BIRTH-DT             PIC XX.
  2462*        16  FILLER                        PIC X(12).
  2463
  2464         16  MA-ADDRESS-LINE-1             PIC X(30).
  2465         16  MA-ADDRESS-LINE-2             PIC X(30).
  2466         16  MA-CITY-STATE.
  2467             20  MA-CITY                   PIC X(28).
  2468             20  MA-ADDR-STATE             PIC XX.
  2469         16  MA-ZIP.
  2470             20  MA-ZIP-CODE.
  2471                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2472                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2473                 24  FILLER                PIC X(4).
  2474             20  MA-ZIP-PLUS4              PIC X(4).
  2475         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2476             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2477             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2478             20  FILLER                    PIC X(3).
  2479
  2480         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2481
  2482         16  FILLER                        PIC XXX.
  2483*        16  FILLER                        PIC X(10).
  2484
  2485     12  MA-CRED-BENE-INFO.
  2486         16  MA-CRED-BENE-NAME                 PIC X(25).
  2487         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2488         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2489         16  MA-CRED-BENE-CTYST.
  2490             20  MA-CRED-BENE-CITY             PIC X(28).
  2491             20  MA-CRED-BENE-STATE            PIC XX.
  2492         16  MA-CRED-BENE-ZIP.
  2493             20  MA-CB-ZIP-CODE.
  2494                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  48
* EL050.cbl
  2495                     88  MA-CB-CANADIAN-POST-CODE
  2496                                           VALUE 'A' THRU 'Z'.
  2497                 24  FILLER                    PIC X(4).
  2498             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2499         16  MA-CB-CANADIAN-POSTAL-CODE
  2500                            REDEFINES MA-CRED-BENE-ZIP.
  2501             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2502             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2503             20  FILLER                        PIC X(3).
  2504     12  MA-POST-CARD-MAIL-DATA.
  2505         16  MA-MAIL-DATA OCCURS 7.
  2506             20  MA-MAIL-TYPE              PIC X.
  2507                 88  MA-12MO-MAILING           VALUE '1'.
  2508                 88  MA-EXP-MAILING            VALUE '2'.
  2509             20  MA-MAIL-STATUS            PIC X.
  2510                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2511                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2512                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2513             20  MA-MAIL-DATE              PIC XX.
  2514     12  FILLER                            PIC XX.
  2515     12  FILLER                            PIC XX.
  2516*    12  FILLER                            PIC X(30).
  2517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  49
* EL050.cbl
  2519*    COPY ERCPNDM.
  2520******************************************************************
  2521*                                                                *
  2522*                                                                *
  2523*                            ERCPNDM                             *
  2524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2525*                            VMOD=2.003                          *
  2526*                                                                *
  2527*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2528*                                                                *
  2529*   FILE TYPE = VSAM,KSDS                                        *
  2530*   RECORD SIZE = 374   RECFORM = FIX                            *
  2531*                                                                *
  2532*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2533*   ALTERNATE PATH    = NOT USED                                 *
  2534*                                                                *
  2535*   LOG = YES                                                    *
  2536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2537******************************************************************
  2538*                   C H A N G E   L O G
  2539*
  2540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2541*-----------------------------------------------------------------
  2542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2543* EFFECTIVE    NUMBER
  2544*-----------------------------------------------------------------
  2545* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2546* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2547* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2548******************************************************************
  2549
  2550 01  PENDING-MAILING-DATA.
  2551     12  PM-RECORD-ID                      PIC XX.
  2552         88  VALID-MA-ID                       VALUE 'PM'.
  2553
  2554     12  PM-CONTROL-PRIMARY.
  2555         16  PM-COMPANY-CD                 PIC X.
  2556         16  PM-ENTRY-BATCH                PIC X(6).
  2557         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2558         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2559
  2560     12  FILLER                            PIC X(14).
  2561
  2562     12  PM-ACCESS-CONTROL.
  2563         16  PM-SOURCE-SYSTEM              PIC XX.
  2564             88  PM-FROM-CREDIT                VALUE 'CR'.
  2565             88  PM-FROM-VSI                   VALUE 'VS'.
  2566             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2567             88  PM-FROM-OTHER                 VALUE 'OT'.
  2568         16  PM-RECORD-ADD-DT              PIC XX.
  2569         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2570         16  PM-LAST-MAINT-DT              PIC XX.
  2571         16  PM-LAST-MAINT-BY              PIC XXXX.
  2572         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2573
  2574     12  PM-PROFILE-INFO.
  2575         16  PM-QUALIFY-CODE-1             PIC XX.
  2576         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  50
* EL050.cbl
  2577         16  PM-QUALIFY-CODE-3             PIC XX.
  2578         16  PM-QUALIFY-CODE-4             PIC XX.
  2579         16  PM-QUALIFY-CODE-5             PIC XX.
  2580
  2581         16  PM-INSURED-LAST-NAME          PIC X(15).
  2582         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2583         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2584         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2585         16  PM-INSURED-BIRTH-DT           PIC XX.
  2586         16  PM-INSURED-SEX                PIC X.
  2587             88  PM-SEX-MALE                   VALUE 'M'.
  2588             88  PM-SEX-FEMALE                 VALUE 'F'.
  2589         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2590
  2591         16  PM-ADDRESS-CORRECTED          PIC X.
  2592         16  PM-JOINT-BIRTH-DT             PIC XX.
  2593*        16  FILLER                        PIC X(12).
  2594
  2595         16  PM-ADDRESS-LINE-1             PIC X(30).
  2596         16  PM-ADDRESS-LINE-2             PIC X(30).
  2597         16  PM-CITY-STATE.
  2598             20  PM-CITY                   PIC X(28).
  2599             20  PM-STATE                  PIC XX.
  2600         16  PM-ZIP.
  2601             20  PM-ZIP-CODE.
  2602                 24  PM-ZIP-1              PIC X.
  2603                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2604                 24  FILLER                PIC X(4).
  2605             20  PM-ZIP-PLUS4              PIC X(4).
  2606         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2607             20  PM-CAN-POST1              PIC XXX.
  2608             20  PM-CAN-POST2              PIC XXX.
  2609             20  FILLER                    PIC XXX.
  2610
  2611         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2612
  2613         16  FILLER                        PIC X(03).
  2614
  2615     12  PM-CRED-BENE-INFO.
  2616         16  PM-CRED-BENE-NAME             PIC X(25).
  2617         16  PM-CRED-BENE-ADDR             PIC X(30).
  2618         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2619         16  PM-CRED-BENE-CTYST.
  2620             20  PM-CRED-BENE-CITY         PIC X(28).
  2621             20  PM-CRED-BENE-STATE        PIC XX.
  2622         16  PM-CRED-BENE-ZIP.
  2623             20  PM-CB-ZIP-CODE.
  2624                 24  PM-CB-ZIP-1           PIC X.
  2625                     88  PM-CB-CANADIAN-POST-CODE
  2626                                  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                PIC X(4).
  2628             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2629         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2630             20  PM-CB-CAN-POST1           PIC XXX.
  2631             20  PM-CB-CAN-POST2           PIC XXX.
  2632             20  FILLER                    PIC XXX.
  2633     12  PM-POST-CARD-MAIL-DATA.
  2634         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  51
* EL050.cbl
  2635             20  PM-MAIL-TYPE              PIC X.
  2636                 88  PM-12MO-MAILING           VALUE '1'.
  2637                 88  PM-EXP-MAILING            VALUE '2'.
  2638             20  PM-MAIL-STATUS            PIC X.
  2639                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2640                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2641                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2642             20  PM-MAIL-DATE              PIC XX.
  2643     12  FILLER                            PIC XX.
  2644     12  FILLER                            PIC X(12).
  2645*    12  FILLER                            PIC X(30).
  2646
  2647******************************************************************
  2648*                                COPY ERCLOFC.
  2649******************************************************************
  2650*                                                                *
  2651*                                                                *
  2652*                            ERCLOFC                             *
  2653*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2654*                            VMOD=2.003                          *
  2655*                                                                *
  2656*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2657*                                                                *
  2658*   FILE TYPE = VSAM,KSDS                                        *
  2659*   RECORD SIZE = 670   RECFORM = FIX                            *
  2660*                                                                *
  2661*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2662*                                                                *
  2663*   LOG = YES                                                    *
  2664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2665*                                                                *
  2666******************************************************************
  2667
  2668 01  LOAN-OFFICER-MASTER.
  2669     12  LO-RECORD-ID                PIC XX.
  2670         88  VALID-LO-ID                VALUE 'LO'.
  2671
  2672     12  LO-CONTROL-PRIMARY.
  2673         16  LO-COMPANY-CD           PIC X.
  2674         16  LO-CARRIER              PIC X.
  2675         16  LO-GROUPING.
  2676             20  LO-GROUPING-PREFIX  PIC XXX.
  2677             20  LO-GROUPING-PRIME   PIC XXX.
  2678         16  LO-STATE                PIC XX.
  2679         16  LO-ACCOUNT.
  2680             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2681             20  LO-ACCOUNT-PRIME    PIC X(6).
  2682         16  LO-OFFICER-CODE         PIC X(5).
  2683
  2684     12  LO-OFFICER-NAME             PIC X(30).
  2685
  2686     12  LO-LAST-MAINT-DT            PIC XX.
  2687     12  LO-LAST-USER                PIC X(4).
  2688     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2689
  2690     12  LO-COMP-CONTROL             PIC X.
  2691             88  LO-SHOW-COMP           VALUE 'Y'.
  2692             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  52
* EL050.cbl
  2693     12  LO-DETAIL-CONTROL           PIC X.
  2694             88  LO-PRINT-DETAIL        VALUE 'D'.
  2695             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2696
  2697     12  LO-SV-CARRIER               PIC X.
  2698     12  LO-SV-GROUPING              PIC X(6).
  2699     12  LO-SV-STATE                 PIC XX.
  2700
  2701     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2702     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2703
  2704     12  LO-OFFICER-INFO.
  2705         16  FILLER OCCURS 12 TIMES.
  2706             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2707             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2708             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2709             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2710             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2711             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2712             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2713             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2714     12  FILLER                      PIC X(198).
  2715******************************************************************
  2716*                                COPY ERCPDEF.
  2717******************************************************************
  2718*                                                                *
  2719*                                                                *
  2720*                            ERCPDEF.                            *
  2721*                                                                *
  2722*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2723*                                                                *
  2724*    FILE TYPE = VSAM,KSDS                                       *
  2725*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2726*                                                                *
  2727*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2728*                                                                *
  2729*    LOG = YES                                                   *
  2730*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2731******************************************************************
  2732 01  PRODUCT-MASTER.
  2733    12  PD-RECORD-ID                 PIC X(02).
  2734        88  VALID-PD-ID                  VALUE 'PD'.
  2735    12  PD-CONTROL-PRIMARY.
  2736        16  PD-COMPANY-CD            PIC X.
  2737        16  PD-STATE                 PIC XX.
  2738        16  PD-PRODUCT-CD            PIC XXX.
  2739        16  PD-FILLER                PIC X(7).
  2740        16  PD-BEN-TYPE              PIC X.
  2741        16  PD-BEN-CODE              PIC XX.
  2742        16  PD-PROD-EXP-DT           PIC XX.
  2743    12  FILLER                       PIC X(50).
  2744    12  PD-PRODUCT-DATA OCCURS 8.
  2745        16  PD-PROD-CODE             PIC X.
  2746            88  PD-PROD-LIFE           VALUE 'L'.
  2747            88  PD-PROD-PROP           VALUE 'P'.
  2748            88  PD-PROD-AH             VALUE 'A'.
  2749            88  PD-PROD-IU             VALUE 'I'.
  2750            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  53
* EL050.cbl
  2751        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2752        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2753        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-TERM              PIC S999        COMP-3.
  2755        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2756        16  FILLER                   PIC X.
  2757        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2758        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2759        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2760        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2761        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2762        16  PD-REC-CRIT-PERIOD       PIC X.
  2763        16  PD-RTW-MOS               PIC 99.
  2764        16  FILLER                   PIC X(5).
  2765    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2766    12  PD-TERM-LIMITS OCCURS 15.
  2767        16  PD-LOW-TERM              PIC S999        COMP-3.
  2768        16  PD-HI-TERM               PIC S999        COMP-3.
  2769*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2770    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2771        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2772        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2773    12  PD-EARN-FACTORS.
  2774        16  FILLER OCCURS 15.
  2775            20  FILLER OCCURS 15.
  2776                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2777    12  PD-PRODUCT-DESC              PIC X(80).
  2778    12  PD-TRUNCATED                 PIC X.
  2779    12  FILLER                       PIC X(59).
  2780    12  PD-MAINT-INFORMATION.
  2781        16  PD-LAST-MAINT-DT         PIC X(02).
  2782        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2783        16  PD-LAST-MAINT-BY         PIC X(04).
  2784*                                COPY ELCSTATE.
  2785******************************************************************
  2786*                                                                *
  2787*                                                                *
  2788*                            ELCSTATE.                           *
  2789*                                                                *
  2790*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2791*                                                                *
  2792*   FILE TYPE = VSAM,KSDS                                        *
  2793*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2794*                                                                *
  2795*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2796*       ALTERNATE INDEX = NONE                                   *
  2797*                                                                *
  2798*   LOG = YES                                                    *
  2799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2800******************************************************************
  2801*                   C H A N G E   L O G
  2802*
  2803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2804*-----------------------------------------------------------------
  2805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2806* EFFECTIVE    NUMBER
  2807*-----------------------------------------------------------------
  2808* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  54
* EL050.cbl
  2809******************************************************************
  2810*
  2811 01  STATE-FILE.
  2812     12  SF-RECORD-ID                       PIC XX.
  2813         88  VALID-CF-ID                        VALUE 'SF'.
  2814     12  SF-CONTROL-PRIMARY.
  2815         16  SF-COMPANY-ID                  PIC XXX.
  2816         16  SF-CARRIER-CODE                PIC X.
  2817         16  SF-GROUPING                    PIC X(6).
  2818         16  SF-STATE-CODE                  PIC XX.
  2819         16  SF-EXPIRE-DATE                 PIC 9(8).
  2820****************************************************************
  2821*             STATE CONTROLS
  2822****************************************************************
  2823     12  SF-LAST-MAINT-DT                   PIC XX.
  2824     12  SF-LAST-MAINT-BY                   PIC X(4).
  2825     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2826     12  SF-STATE-RT-CONTROLS.
  2827         16  SF-ST-RT-CALC                  PIC X.
  2828     12  SF-ST-TAX-CONTROLS.
  2829         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2830         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2832     12  SF-ST-REFUND-OPTIONS.
  2833         16  SF-ST-RF-LR-CALC               PIC X.
  2834         16  SF-ST-RF-LL-CALC               PIC X.
  2835         16  SF-ST-RF-LN-CALC               PIC X.
  2836         16  SF-ST-RF-AH-CALC               PIC X.
  2837         16  SF-ST-RF-CP-CALC               PIC X.
  2838     12  SF-ST-UNEARN-PREM-OPTIONS.
  2839         16  SF-ST-LUEP-R78                 PIC X.
  2840         16  SF-ST-LUEP-PRO                 PIC X.
  2841         16  SF-ST-LUEP-ST                  PIC X.
  2842         16  SF-ST-LUEP-DOM                 PIC X.
  2843         16  SF-ST-AUEP-R78                 PIC X.
  2844         16  SF-ST-AUEP-PRO                 PIC X.
  2845         16  SF-ST-AUEP-ST                  PIC X.
  2846         16  SF-ST-AUEP-DOM                 PIC X.
  2847         16  SF-ST-CUEP-R78                 PIC X.
  2848         16  SF-ST-CUEP-PRO                 PIC X.
  2849         16  SF-ST-CUEP-ST                  PIC X.
  2850         16  SF-ST-CUEP-DOM                 PIC X.
  2851     12  SF-ST-EARN-PREM-OPTIONS.
  2852         16  SF-ST-LEP-R78                  PIC X.
  2853         16  SF-ST-LEP-PRO                  PIC X.
  2854         16  SF-ST-LEP-ST                   PIC X.
  2855         16  SF-ST-LEP-DOM                  PIC X.
  2856         16  SF-ST-AEP-R78                  PIC X.
  2857         16  SF-ST-AEP-PRO                  PIC X.
  2858         16  SF-ST-AEP-ST                   PIC X.
  2859         16  SF-ST-AEP-DOM                  PIC X.
  2860         16  SF-ST-CEP-R78                  PIC X.
  2861         16  SF-ST-CEP-PRO                  PIC X.
  2862         16  SF-ST-CEP-ST                   PIC X.
  2863         16  SF-ST-CEP-DOM                  PIC X.
  2864     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  55
* EL050.cbl
  2866*    COPY ELCCRTT.
  2867******************************************************************
  2868*                                                                *
  2869*                            ELCCRTT.                            *
  2870*                                                                *
  2871*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2872*                                                                *
  2873*   FILE TYPE = VSAM,KSDS                                        *
  2874*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2875*                                                                *
  2876*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2877*                                                                *
  2878*   LOG = YES                                                    *
  2879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2889* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2890* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2891* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2892* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2893******************************************************************
  2894
  2895 01  CERTIFICATE-TRAILERS.
  2896     12  CS-RECORD-ID                      PIC XX.
  2897         88  VALID-CS-ID                      VALUE 'CS'.
  2898
  2899     12  CS-CONTROL-PRIMARY.
  2900         16  CS-COMPANY-CD                 PIC X.
  2901         16  CS-CARRIER                    PIC X.
  2902         16  CS-GROUPING                   PIC X(6).
  2903         16  CS-STATE                      PIC XX.
  2904         16  CS-ACCOUNT                    PIC X(10).
  2905         16  CS-CERT-EFF-DT                PIC XX.
  2906         16  CS-CERT-NO.
  2907             20  CS-CERT-PRIME             PIC X(10).
  2908             20  CS-CERT-SFX               PIC X.
  2909         16  CS-TRAILER-TYPE               PIC X.
  2910             88  COMM-TRLR           VALUE 'A'.
  2911             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2912             88  CERT-DATA-TRLR      VALUE 'C'.
  2913
  2914     12  CS-DATA-AREA                      PIC X(516).
  2915
  2916     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2917         16  CS-BANK-COMMISSION-AREA.
  2918             20  CS-BANK-COMMS       OCCURS 10.
  2919                 24  CS-AGT                PIC X(10).
  2920                 24  CS-COM-TYP            PIC X.
  2921                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2922                 24  CS-RECALC-LV-INDIC    PIC X.
  2923                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  56
* EL050.cbl
  2924         16  FILLER                        PIC X(256).
  2925
  2926     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2927****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2928****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2929         16  CS-MB-CLAIM-DATA OCCURS 2.
  2930             20  FILLER OCCURS 10.
  2931                 24  CS-CLAIM-TYPE         PIC X.
  2932                     88  CS-AH-CLM           VALUE 'A'.
  2933                     88  CS-IU-CLM           VALUE 'I'.
  2934                     88  CS-GP-CLM           VALUE 'G'.
  2935                     88  CS-LF-CLM           VALUE 'L'.
  2936                     88  CS-PR-CLM           VALUE 'P'.
  2937                 24  CS-BANK               PIC S999 COMP-3.
  2938                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2939                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2940                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2941         16  FILLER                        PIC X(216).
  2942     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2943         16  CS-VIN-NUMBER                 PIC X(17).
  2944         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2945         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2946         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2947         16  FILLER                        PIC X(496).
  2948******************************************************************
  2949*    COPY ELCCRTO.
  2950******************************************************************
  2951*                                                                *
  2952*                            ELCCRTO.                            *
  2953*                                                                *
  2954*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2955*                                                                *
  2956*   FILE TYPE = VSAM,KSDS                                        *
  2957*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2958*                                                                *
  2959*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2960*                                                                *
  2961*   LOG = YES                                                    *
  2962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2963******************************************************************
  2964*                   C H A N G E   L O G
  2965*
  2966* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2967*-----------------------------------------------------------------
  2968*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2969* EFFECTIVE    NUMBER
  2970*-----------------------------------------------------------------
  2971* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2972* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2973* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2974* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2975* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2976******************************************************************
  2977 01  ORIGINAL-CERTIFICATE.
  2978     12  OC-RECORD-ID                      PIC XX.
  2979         88  VALID-OC-ID                      VALUE 'OC'.
  2980     12  OC-CONTROL-PRIMARY.
  2981         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  57
* EL050.cbl
  2982         16  OC-CARRIER                    PIC X.
  2983         16  OC-GROUPING                   PIC X(6).
  2984         16  OC-STATE                      PIC XX.
  2985         16  OC-ACCOUNT                    PIC X(10).
  2986         16  OC-CERT-EFF-DT                PIC XX.
  2987         16  OC-CERT-NO.
  2988             20  OC-CERT-PRIME             PIC X(10).
  2989             20  OC-CERT-SFX               PIC X.
  2990         16  OC-RECORD-TYPE                PIC X.
  2991         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2992     12  OC-LAST-MAINT-DT                  PIC XX.
  2993     12  OC-LAST-MAINT-BY                  PIC X(4).
  2994     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2995     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2996     12  FILLER                            PIC X(49).
  2997     12  OC-ORIG-REC.
  2998         16  OC-INS-LAST-NAME              PIC X(15).
  2999         16  OC-INS-FIRST-NAME             PIC X(10).
  3000         16  OC-INS-MIDDLE-INIT            PIC X.
  3001         16  OC-INS-AGE                    PIC S999     COMP-3.
  3002         16  OC-JNT-LAST-NAME              PIC X(15).
  3003         16  OC-JNT-FIRST-NAME             PIC X(10).
  3004         16  OC-JNT-MIDDLE-INIT            PIC X.
  3005         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3006         16  OC-LF-BENCD                   PIC XX.
  3007         16  OC-LF-TERM                    PIC S999      COMP-3.
  3008         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3009         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3010         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3011         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3012         16  OC-LF-EXP-DT                  PIC XX.
  3013         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3014         16  OC-LF-CANCEL-DT               PIC XX.
  3015         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3016         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3017         16  OC-AH-BENCD                   PIC XX.
  3018         16  OC-AH-TERM                    PIC S999      COMP-3.
  3019         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3020         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3021         16  OC-AH-EXP-DT                  PIC XX.
  3022         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3023         16  OC-AH-CP                      PIC 99.
  3024         16  OC-AH-CANCEL-DT               PIC XX.
  3025         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3026         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3027         16  OC-CRED-BENE-NAME             PIC X(25).
  3028         16  OC-1ST-PMT-DT                 PIC XX.
  3029         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3030         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3031         16  OC-ISSUE-TRAN-IND             PIC X.
  3032         16  OC-CANCEL-TRAN-IND            PIC X.
  3033         16  FILLER                        PIC X(211).
  3034
  3035     12  FILLER                            PIC X(50).
  3036******************************************************************
  3037
  3038*    COPY ELCDATE.
  3039******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  58
* EL050.cbl
  3040*                                                                *
  3041*                                                                *
  3042*                            ELCDATE.                            *
  3043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3044*                            VMOD=2.003
  3045*                                                                *
  3046*                                                                *
  3047*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3048*                 LENGTH = 200                                   *
  3049******************************************************************
  3050
  3051 01  DATE-CONVERSION-DATA.
  3052     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3053     12  DC-OPTION-CODE                PIC X.
  3054         88  BIN-TO-GREG                VALUE ' '.
  3055         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3056         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3057         88  YMD-GREG-TO-BIN            VALUE '3'.
  3058         88  MDY-GREG-TO-BIN            VALUE '4'.
  3059         88  JULIAN-TO-BIN              VALUE '5'.
  3060         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3061         88  FIND-CENTURY               VALUE '7'.
  3062         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3063         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3064         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3065         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3066         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3067         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3068         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3069         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3070         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3071         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3072         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3073         88  BIN-3-TO-GREG              VALUE 'I'.
  3074         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3075         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3076         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3077         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3078         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3079         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3080         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3081         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3082         88  THREE-CHARACTER-BIN
  3083                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3084         88  GREGORIAN-TO-BIN
  3085                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3086         88  BIN-TO-GREGORIAN
  3087                  VALUES ' ' '1' 'I' '8' 'G'.
  3088         88  JULIAN-TO-BINARY
  3089                  VALUES '5' 'C' 'E' 'F'.
  3090     12  DC-ERROR-CODE                 PIC X.
  3091         88  NO-CONVERSION-ERROR        VALUE ' '.
  3092         88  DATE-CONVERSION-ERROR
  3093                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3094         88  DATE-IS-ZERO               VALUE '1'.
  3095         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3096         88  DATE-IS-INVALID            VALUE '3'.
  3097         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  59
* EL050.cbl
  3098         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3099         88  DATE-INVALID-OPTION        VALUE '9'.
  3100         88  INVALID-CENTURY            VALUE 'A'.
  3101         88  ONLY-CENTURY               VALUE 'B'.
  3102         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3103         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3104     12  DC-END-OF-MONTH               PIC X.
  3105         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3106     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3107         88  USE-NORMAL-PROCESS         VALUE ' '.
  3108         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3109         88  ADJUST-UP-100-YRS          VALUE '2'.
  3110     12  FILLER                        PIC X.
  3111     12  DC-CONVERSION-DATES.
  3112         16  DC-BIN-DATE-1             PIC XX.
  3113         16  DC-BIN-DATE-2             PIC XX.
  3114         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3115         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3116                       DC-GREG-DATE-1-EDIT.
  3117             20  DC-EDIT1-MONTH        PIC 99.
  3118             20  SLASH1-1              PIC X.
  3119             20  DC-EDIT1-DAY          PIC 99.
  3120             20  SLASH1-2              PIC X.
  3121             20  DC-EDIT1-YEAR         PIC 99.
  3122         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3123         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3124                     DC-GREG-DATE-2-EDIT.
  3125             20  DC-EDIT2-MONTH        PIC 99.
  3126             20  SLASH2-1              PIC X.
  3127             20  DC-EDIT2-DAY          PIC 99.
  3128             20  SLASH2-2              PIC X.
  3129             20  DC-EDIT2-YEAR         PIC 99.
  3130         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3131         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3132                     DC-GREG-DATE-1-YMD.
  3133             20  DC-YMD-YEAR           PIC 99.
  3134             20  DC-YMD-MONTH          PIC 99.
  3135             20  DC-YMD-DAY            PIC 99.
  3136         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3137         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3138                      DC-GREG-DATE-1-MDY.
  3139             20  DC-MDY-MONTH          PIC 99.
  3140             20  DC-MDY-DAY            PIC 99.
  3141             20  DC-MDY-YEAR           PIC 99.
  3142         16  DC-GREG-DATE-1-ALPHA.
  3143             20  DC-ALPHA-MONTH        PIC X(10).
  3144             20  DC-ALPHA-DAY          PIC 99.
  3145             20  FILLER                PIC XX.
  3146             20  DC-ALPHA-CENTURY.
  3147                 24 DC-ALPHA-CEN-N     PIC 99.
  3148             20  DC-ALPHA-YEAR         PIC 99.
  3149         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3150         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3151         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3152         16  DC-JULIAN-DATE            PIC 9(05).
  3153         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3154                                       PIC 9(05).
  3155         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  60
* EL050.cbl
  3156             20  DC-JULIAN-YEAR        PIC 99.
  3157             20  DC-JULIAN-DAYS        PIC 999.
  3158         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3159         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3160         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3161     12  DATE-CONVERSION-VARIBLES.
  3162         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3163         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3164             20  FILLER                PIC 9(3).
  3165             20  HOLD-CEN-1-CCYY.
  3166                 24  HOLD-CEN-1-CC     PIC 99.
  3167                 24  HOLD-CEN-1-YY     PIC 99.
  3168             20  HOLD-CEN-1-MO         PIC 99.
  3169             20  HOLD-CEN-1-DA         PIC 99.
  3170         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3171             20  HOLD-CEN-1-R-MO       PIC 99.
  3172             20  HOLD-CEN-1-R-DA       PIC 99.
  3173             20  HOLD-CEN-1-R-CCYY.
  3174                 24  HOLD-CEN-1-R-CC   PIC 99.
  3175                 24  HOLD-CEN-1-R-YY   PIC 99.
  3176             20  FILLER                PIC 9(3).
  3177         16  HOLD-CENTURY-1-X.
  3178             20  FILLER                PIC X(3)  VALUE SPACES.
  3179             20  HOLD-CEN-1-X-CCYY.
  3180                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3181                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3182             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3183             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3184         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3185             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3186             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3187             20  HOLD-CEN-1-R-X-CCYY.
  3188                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3189                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3190             20  FILLER                PIC XXX.
  3191         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3192         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3193         16  DC-JULIAN-DATE-1          PIC 9(07).
  3194         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3195             20  DC-JULIAN-1-CCYY.
  3196                 24  DC-JULIAN-1-CC    PIC 99.
  3197                 24  DC-JULIAN-1-YR    PIC 99.
  3198             20  DC-JULIAN-DA-1        PIC 999.
  3199         16  DC-JULIAN-DATE-2          PIC 9(07).
  3200         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3201             20  DC-JULIAN-2-CCYY.
  3202                 24  DC-JULIAN-2-CC    PIC 99.
  3203                 24  DC-JULIAN-2-YR    PIC 99.
  3204             20  DC-JULIAN-DA-2        PIC 999.
  3205         16  DC-GREG-DATE-A-EDIT.
  3206             20  DC-EDITA-MONTH        PIC 99.
  3207             20  SLASHA-1              PIC X VALUE '/'.
  3208             20  DC-EDITA-DAY          PIC 99.
  3209             20  SLASHA-2              PIC X VALUE '/'.
  3210             20  DC-EDITA-CCYY.
  3211                 24  DC-EDITA-CENT     PIC 99.
  3212                 24  DC-EDITA-YEAR     PIC 99.
  3213         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  61
* EL050.cbl
  3214             20  DC-EDITB-MONTH        PIC 99.
  3215             20  SLASHB-1              PIC X VALUE '/'.
  3216             20  DC-EDITB-DAY          PIC 99.
  3217             20  SLASHB-2              PIC X VALUE '/'.
  3218             20  DC-EDITB-CCYY.
  3219                 24  DC-EDITB-CENT     PIC 99.
  3220                 24  DC-EDITB-YEAR     PIC 99.
  3221         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3222         16  DC-GREG-DATE-CYMD-R REDEFINES
  3223                              DC-GREG-DATE-CYMD.
  3224             20  DC-CYMD-CEN           PIC 99.
  3225             20  DC-CYMD-YEAR          PIC 99.
  3226             20  DC-CYMD-MONTH         PIC 99.
  3227             20  DC-CYMD-DAY           PIC 99.
  3228         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3229         16  DC-GREG-DATE-MDCY-R REDEFINES
  3230                              DC-GREG-DATE-MDCY.
  3231             20  DC-MDCY-MONTH         PIC 99.
  3232             20  DC-MDCY-DAY           PIC 99.
  3233             20  DC-MDCY-CEN           PIC 99.
  3234             20  DC-MDCY-YEAR          PIC 99.
  3235    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3236        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3237    12  DC-EL310-DATE                  PIC X(21).
  3238    12  FILLER                         PIC X(28).
  3239
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  62
* EL050.cbl
  3241*    COPY ELCCALC.
  3242******************************************************************
  3243*                                                                *
  3244*                           ELCCALC.                            *
  3245*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3246*                            VMOD=2.025                          *
  3247*                                                                *
  3248*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3249*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3250*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3251*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3252*                                                                *
  3253*  PASSED TO ELRTRM                                              *
  3254*  -----------------                                             *
  3255*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3256*  ORIGINAL TERM                                                 *
  3257*  BEGINNING DATE                                                *
  3258*  ENDING DATE                                                   *
  3259*  COMPANY I.D.                                                  *
  3260*  ACCOUNT MASTER USER FIELD                                     *
  3261*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3262*  FREE LOOK DAYS                                                *
  3263*                                                                *
  3264*  RETURNED FROM ELRTRM                                          *
  3265*  ---------------------                                         *
  3266*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3267*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3268*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3269*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3270*----------------------------------------------------------------*
  3271*  PASSED TO ELRAMT                                              *
  3272*  ----------------                                              *
  3273*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3274*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3275*  ORIGINAL AMOUNT                                               *
  3276*  ALTERNATE BENEFIT (BALLON)                                    *
  3277*  A.P.R. - NET PAY ONLY                                         *
  3278*  METHOD
  3279*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3280*  COMPANY I.D.                                                  *
  3281*  BENEFIT TYPE                                                  *
  3282*                                                                *
  3283*  RETURNED FROM ELRAMT                                          *
  3284*  --------------------                                          *
  3285*  REMAINING AMOUNT 1 - CURRENT                                  *
  3286*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3287*  REMAINING AMOUNT FACTOR
  3288*----------------------------------------------------------------*
  3289*  PASSED TO ELRESV                                              *
  3290*  -----------------                                             *
  3291*  CERTIFICATE EFFECTIVE DATE                                    *
  3292*  VALUATION DATE                                                *
  3293*  PAID THRU DATE                                                *
  3294*  BENEFIT                                                       *
  3295*  INCURRED DATE                                                 *
  3296*  REPORTED DATE                                                 *
  3297*  ISSUE AGE                                                     *
  3298*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  63
* EL050.cbl
  3299*  CDT PERCENT                                                   *
  3300*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3301* *CLAIM TYPE (LIFE, A/H)                                        *
  3302* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3303* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3304*                                                                *
  3305*  RETURNED FROM ELRESV                                          *
  3306*  --------------------                                          *
  3307*  CDT TABLE USED                                                *
  3308*  CDT FACTOR USED                                               *
  3309*  PAY TO CURRENT RESERVE                                        *
  3310*  I.B.N.R. - A/H ONLY                                           *
  3311*  FUTURE (ACCRUED) AH ONLY                                      *
  3312*----------------------------------------------------------------*
  3313*  PASSED TO ELRATE                                              *
  3314*  ----------------                                              *
  3315*  CERT ISSUE DATE                                               *
  3316*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3317*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3318*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3319*  STATE CODE (CLIENT DEFINED)                                   *
  3320*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3321*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3322*  DEVIATION CODE                                                *
  3323*  ISSUE AGE                                                     *
  3324*  ORIGINAL BENEFIT AMOUNT                                       *
  3325*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3326*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3327*  BENEFIT KIND (LIFE OR A/H)                                    *
  3328*  A.P.R.                                                        *
  3329*  METHOD
  3330*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3331*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3332*  COMPANY I.D. (3 CHARACTER)                                    *
  3333*  BENEFIT CODE                                                  *
  3334*  BENEFIT OVERRIDE CODE                                         *
  3335*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3336*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3337*  JOINT INDICATOR (CSL ONLY)                                    *
  3338*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3339*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3340*                                                                *
  3341*  RETURNED FROM ELRATE                                          *
  3342*  --------------------                                          *
  3343*  CALCULATED PREMIUM                                            *
  3344*  PREMIUM RATE                                                  *
  3345*  MORTALITY CODE                                                *
  3346*  MAX ATTAINED AGE                                              *
  3347*  MAX AGE                                                       *
  3348*  MAX TERM                                                      *
  3349*  MAX MONTHLY BENEFIT                                           *
  3350*  MAX TOTAL BENIFIT                                             *
  3351*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3352*----------------------------------------------------------------*
  3353*  PASSED TO ELRFND                                              *
  3354*  ----------------                                              *
  3355*  CERT ISSUE DATE                                               *
  3356*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  64
* EL050.cbl
  3357*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3358*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3359*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3360*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3361*  STATE CODE (CLIENT DEFINED)                                   *
  3362*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3363*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3364*  DEVIATION CODE                                                *
  3365*  ISSUE AGE                                                     *
  3366*  ORIGINAL BENEFIT AMOUNT                                       *
  3367*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3368*  PROCESS TYPE (CANCEL)                                         *
  3369*  BENEFIT KIND (LIFE OR A/H)                                    *
  3370*  A.P.R.                                                        *
  3371*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3372*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3373*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3374*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3375*  COMPANY I.D. (3 CHARACTER)                                    *
  3376*  BENEFIT CODE                                                  *
  3377*  BENEFIT OVERRIDE CODE                                         *
  3378*                                                                *
  3379*  RETURNED FROM ELRFND                                          *
  3380*  --------------------                                          *
  3381*  CALCULATED REFUND                                             *
  3382*----------------------------------------------------------------*
  3383*  PASSED TO ELEARN                                              *
  3384*  ----------------                                              *
  3385*  CERT ISSUE DATE                                               *
  3386*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3387*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3388*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3389*  STATE CODE (CLIENT DEFINED)                                   *
  3390*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3391*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3392*  DEVIATION CODE                                                *
  3393*  ISSUE AGE                                                     *
  3394*  ORIGINAL BENEFIT AMOUNT                                       *
  3395*  BENEFIT KIND (LIFE OR A/H)                                    *
  3396*  A.P.R.                                                        *
  3397*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3398*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3399*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3400*  COMPANY I.D. (3 CHARACTER)                                    *
  3401*  BENEFIT CODE                                                  *
  3402*  BENEFIT OVERRIDE CODE                                         *
  3403*                                                                *
  3404*  RETURNED FROM ELEARN                                          *
  3405*  --------------------                                          *
  3406*  INDICATED  EARNINGS                                           *
  3407*----------------------------------------------------------------*
  3408*                 LENGTH = 450                                   *
  3409*                                                                *
  3410******************************************************************
  3411******************************************************************
  3412*                   C H A N G E   L O G
  3413*
  3414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  65
* EL050.cbl
  3415*-----------------------------------------------------------------
  3416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3417* EFFECTIVE    NUMBER
  3418*-----------------------------------------------------------------
  3419* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3421* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3422* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3423* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3424* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3425* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3426* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3427* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3428******************************************************************
  3429
  3430 01  CALCULATION-PASS-AREA.
  3431     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3432                                     COMP.
  3433
  3434     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3435       88  NO-CP-ERROR                             VALUE ZERO.
  3436       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3437                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3438       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3439       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3440       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3441       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3442       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3443       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3444       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3445       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3446       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3447       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3448       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3449       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3450       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3451       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3452       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3453       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3454       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3455
  3456     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3457       88  NO-CP-ERROR-2                           VALUE ZERO.
  3458***********************  INPUT AREAS ****************************
  3459
  3460     12  CP-CALCULATION-AREA.
  3461         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3462         16  CP-CERT-EFF-DT        PIC XX.
  3463         16  CP-VALUATION-DT       PIC XX.
  3464         16  CP-PAID-THRU-DT       PIC XX.
  3465         16  CP-BENEFIT-TYPE       PIC X.
  3466           88  CP-AH                               VALUE 'A' 'D'
  3467                                                   'I' 'U'.
  3468           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3469           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3470         16  CP-INCURRED-DT        PIC XX.
  3471         16  CP-REPORTED-DT        PIC XX.
  3472         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  66
* EL050.cbl
  3473         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3474         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3475                                     COMP-3.
  3476         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3477                                     COMP-3.
  3478         16  CP-CDT-METHOD         PIC X.
  3479           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3480           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3481           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3482         16  CP-CLAIM-TYPE         PIC X.
  3483           88  CP-AH-CLAIM                         VALUE 'A'.
  3484           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3485         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3488                                     COMP-3.
  3489         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3490                                     COMP-3.
  3491         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3496                                     COMP-3.
  3497         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-REM-TERM-METHOD    PIC X.
  3500           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3501           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3502           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3503           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3504           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3505           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3506           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3507         16  CP-EARNING-METHOD     PIC X.
  3508           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3509           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3510           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3511           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3512           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3513           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3514           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3515           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3516           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3517           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3518           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3519           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3520           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3521           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3522         16  CP-PROCESS-TYPE       PIC X.
  3523           88  CP-CLAIM                            VALUE '1'.
  3524           88  CP-CANCEL                           VALUE '2'.
  3525           88  CP-ISSUE                            VALUE '3'.
  3526         16  CP-SPECIAL-CALC-CD    PIC X.
  3527           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3528           88  CP-1-MTH-INTEREST               VALUE ' '.
  3529           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3530           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  67
* EL050.cbl
  3531           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3532           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3533           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3534           88  CP-FARM-PLAN                    VALUE 'F'.
  3535           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3536           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3537           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3538           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3539           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3540           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3541           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3542           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3543           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3544           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3545                                                     'W' 'X'.
  3546           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3547           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3548           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3549           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3550           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3551           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3552           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3553           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3554           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3555           88  CP-CSL-METH-1                   VALUE '5'.
  3556           88  CP-CSL-METH-2                   VALUE '6'.
  3557           88  CP-CSL-METH-3                   VALUE '7'.
  3558           88  CP-CSL-METH-4                   VALUE '8'.
  3559
  3560         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3563         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3564         16  CP-STATE              PIC XX          VALUE SPACE.
  3565         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3566         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3567           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3568               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3569         16  CP-R78-OPTION         PIC X.
  3570           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3571           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3572
  3573         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3574         16  CP-IBNR-RESERVE-SW    PIC X.
  3575         16  CP-CLAIM-STATUS       PIC X.
  3576         16  CP-RATE-FILE          PIC X.
  3577         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3578                                     COMP-3.
  3579
  3580         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3581         16  CP-AH-OVERRIDE-CODE   PIC X.
  3582
  3583         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3586                                   PIC S9(5)V99 COMP-3.
  3587         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  68
* EL050.cbl
  3589         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3594                                  PIC S9(7)V99 COMP-3.
  3595
  3596         16  CP-PAID-FROM-DATE     PIC X(02).
  3597         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3598         16  CP-EXT-DAYS-CALC      PIC X.
  3599           88  CP-EXT-NO-CHG                   VALUE ' '.
  3600           88  CP-EXT-CHG-LF                   VALUE '1'.
  3601           88  CP-EXT-CHG-AH                   VALUE '2'.
  3602           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3603         16  CP-DOMICILE-STATE     PIC XX.
  3604         16  CP-CARRIER            PIC X.
  3605         16  CP-REIN-FLAG          PIC X.
  3606         16  CP-REM-TRM-CALC-OPTION PIC X.
  3607           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3608                      '2' '3' '4' '5'.
  3609           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3610           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3611           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3612           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3613           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3614           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3615           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3616           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3617         16  CP-SIG-SWITCH         PIC X.
  3618         16  CP-RATING-METHOD      PIC X.
  3619           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3620           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3621           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3622           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3623           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3624           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3625           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3626           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3627           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3628         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3629                                     COMP-3.
  3630         16  CP-BEN-CATEGORY       PIC X.
  3631         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3632         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3633                                   PIC S99V9(5) COMP-3.
  3634         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3635         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3636                                   PIC S99V9(5) COMP-3.
  3637         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3638         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3639         16  CP-EXPIRE-DT          PIC XX.
  3640         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3641         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3642         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3643         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3644         16  CP-DDF-SPEC-CALC      PIC X.
  3645             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3646             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  69
* EL050.cbl
  3647         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3648         16  CP-CANCEL-REASON      PIC X.
  3649         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3650         16  CP-PMT-MODE           PIC X.
  3651         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3652         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3653         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3655         16  FILLER                PIC X.
  3656
  3657***************    OUTPUT FROM ELRESV   ************************
  3658
  3659         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3660
  3661         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3662                                     COMP-3.
  3663         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3664                                     COMP-3.
  3665         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  FILLER                PIC X(09).
  3670***************    OUTPUT FROM ELRTRM   *************************
  3671
  3672         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3673                                     COMP-3.
  3674         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3675                                     COMP-3.
  3676         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3677                                     COMP-3.
  3678         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3679                                     COMP-3.
  3680         16  FILLER                PIC X(12).
  3681
  3682***************    OUTPUT FROM ELRAMT   *************************
  3683
  3684         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3685                                     COMP-3.
  3686         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3687                                     COMP-3.
  3688         16  FILLER                PIC X(12).
  3689
  3690***************    OUTPUT FROM ELRATE   *************************
  3691
  3692         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3693                                     COMP-3.
  3694         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-MORTALITY-CODE     PIC X(4).
  3697         16  CP-RATE-EDIT-FLAG     PIC X.
  3698             88  CP-RATES-NEED-APR                  VALUE '1'.
  3699         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3702         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3703         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3704                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  70
* EL050.cbl
  3705         16  FILLER                PIC X(07).
  3706
  3707***************    OUTPUT FROM ELRFND   *************************
  3708
  3709         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3710                                     COMP-3.
  3711         16  CP-REFUND-TYPE-USED   PIC X.
  3712           88  CP-R-AS-R78                         VALUE '1'.
  3713           88  CP-R-AS-PRORATA                     VALUE '2'.
  3714           88  CP-R-AS-CALIF                       VALUE '3'.
  3715           88  CP-R-AS-TEXAS                       VALUE '4'.
  3716           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3717           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3718           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3719           88  CP-R-AS-MEAN                        VALUE '8'.
  3720           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3721           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3722           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3723           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3724           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3725           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELEARN   *************************
  3729
  3730         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3737                                     COMP-3.
  3738         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3739                                     COMP-3.
  3740         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3741                                     COMP-3.
  3742         16  CP-EARNING-TYPE-USED  PIC X.
  3743           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3744           88  CP-E-AS-R78                         VALUE '1'.
  3745           88  CP-E-AS-PRORATA                     VALUE '2'.
  3746           88  CP-E-AS-TEXAS                       VALUE '4'.
  3747           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3748           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3749           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3750           88  CP-E-AS-MEAN                        VALUE '8'.
  3751           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3752         16  FILLER                PIC X(12).
  3753
  3754***************    OUTPUT FROM ELPMNT   *************************
  3755
  3756         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3757                                     COMP-3.
  3758         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3759                                     COMP-3.
  3760         16  FILLER                PIC X(12).
  3761
  3762***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  71
* EL050.cbl
  3763         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3764                                     COMP-3.
  3765         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3774                                     COMP-3.
  3775         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3776             88  OPEN-RATE-FILE                   VALUE 'O'.
  3777             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3778             88  IO-ERROR                         VALUE 'E'.
  3779
  3780         16  CP-FIRST-PAY-DATE     PIC XX.
  3781
  3782         16  CP-JOINT-INDICATOR    PIC X.
  3783
  3784         16  CP-RESERVE-REMAINING-TERM
  3785                                   PIC S9(4)V9    VALUE ZERO
  3786                                     COMP-3.
  3787
  3788         16  CP-INSURED-BIRTH-DT   PIC XX.
  3789
  3790         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3791                                     COMP-3.
  3792
  3793         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3806                                     COMP-3.
  3807
  3808         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3809                                     COMP-3.
  3810
  3811         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3812             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3813
  3814         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3815                                     COMP-3.
  3816         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3819         16  FILLER                PIC X(15).
  3820******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  72
* EL050.cbl
  3822******************************************************************
  3823*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3824*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3825*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3826*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3827*** MODIFICATION.                                              ***
  3828*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3829*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3830******************************************************************
  3831*    COPY ERCPNDB.
  3832******************************************************************
  3833*                                                                *
  3834*                                                                *
  3835*                            ERCPNDB.                            *
  3836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3837*                            VMOD=2.025                          *
  3838*                                                                *
  3839*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3840*                                                                *
  3841******************************************************************
  3842*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3843*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3844******************************************************************
  3845*                                                                *
  3846*                                                                *
  3847*   FILE TYPE = VSAM,KSDS                                        *
  3848*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3849*                                                                *
  3850*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3851*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3852*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3853*                                                 RKP=13,LEN=36  *
  3854*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3855*                                      AND CHG-SEQ.)             *
  3856*                                                RKP=49,LEN=11   *
  3857*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3858*                                      AND CHG-SEQ.)             *
  3859*                                                RKP=60,LEN=15   *
  3860*                                                                *
  3861*   LOG = NO                                                     *
  3862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3863******************************************************************
  3864******************************************************************
  3865*                   C H A N G E   L O G
  3866*
  3867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3868*-----------------------------------------------------------------
  3869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3870* EFFECTIVE    NUMBER
  3871*-----------------------------------------------------------------
  3872* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3873* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3874* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3875* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3876* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3877* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3878* 032306                   PEMA  ADD BOW LOAN NUMBER
  3879* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  73
* EL050.cbl
  3880* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3881* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3882* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3883* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3884* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3885* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3886* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3887******************************************************************
  3888
  3889 01  PENDING-BUSINESS.
  3890     12  PB-RECORD-ID                     PIC XX.
  3891         88  VALID-PB-ID                        VALUE 'PB'.
  3892
  3893     12  PB-CONTROL-PRIMARY.
  3894         16  PB-COMPANY-CD                PIC X.
  3895         16  PB-ENTRY-BATCH               PIC X(6).
  3896         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3897         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3898
  3899     12  PB-CONTROL-BY-ACCOUNT.
  3900         16  PB-COMPANY-CD-A1             PIC X.
  3901         16  PB-CARRIER                   PIC X.
  3902         16  PB-GROUPING.
  3903             20  PB-GROUPING-PREFIX       PIC XXX.
  3904             20  PB-GROUPING-PRIME        PIC XXX.
  3905         16  PB-STATE                     PIC XX.
  3906         16  PB-ACCOUNT.
  3907             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3908             20  PB-ACCOUNT-PRIME         PIC X(6).
  3909         16  PB-CERT-EFF-DT               PIC XX.
  3910         16  PB-CERT-NO.
  3911             20  PB-CERT-PRIME            PIC X(10).
  3912             20  PB-CERT-SFX              PIC X.
  3913         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3914
  3915         16  PB-RECORD-TYPE               PIC X.
  3916             88  PB-MAILING-DATA                VALUE '0'.
  3917             88  PB-ISSUE                       VALUE '1'.
  3918             88  PB-CANCELLATION                VALUE '2'.
  3919             88  PB-BATCH-TRAILER               VALUE '9'.
  3920
  3921     12  PB-CONTROL-BY-ORIG-BATCH.
  3922         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3923         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3924         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3925         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3926
  3927     12  PB-CONTROL-BY-CSR.
  3928         16  PB-CSR-COMPANY-CD            PIC X.
  3929         16  PB-CSR-ID                    PIC X(4).
  3930         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3931         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3932         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3933******************************************************************
  3934*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3935******************************************************************
  3936
  3937     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  74
* EL050.cbl
  3938     12  PB-LAST-MAINT-BY                 PIC X(4).
  3939     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3940
  3941     12  PB-RECORD-BODY                   PIC X(375).
  3942
  3943     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3944         16  PB-CERT-ORIGIN               PIC X.
  3945             88  CLASIC-CREATED-CERT         VALUE '1'.
  3946         16  PB-I-NAME.
  3947             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3948             20  PB-I-INSURED-FIRST-NAME.
  3949                 24  PB-I-INSURED-1ST-INIT PIC X.
  3950                 24  FILLER                PIC X(9).
  3951             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3952         16  PB-I-AGE                     PIC S99   COMP-3.
  3953         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3954         16  PB-I-BIRTHDAY                PIC XX.
  3955         16  PB-I-INSURED-SEX             PIC X.
  3956             88  PB-SEX-MALE     VALUE 'M'.
  3957             88  PB-SEX-FEMALE   VALUE 'F'.
  3958
  3959         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3960         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3961         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3962         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3963         16  PB-I-SKIP-CODE               PIC X.
  3964             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3965             88  PB-SKIP-JULY              VALUE '1'.
  3966             88  PB-SKIP-AUGUST            VALUE '2'.
  3967             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3968             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3969             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3970             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3971             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3972             88  PB-SKIP-JUNE              VALUE '8'.
  3973             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3974             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3975             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3976         16  PB-I-TERM-TYPE               PIC X.
  3977             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3978             88  PB-PAID-WEEKLY            VALUE 'W'.
  3979             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3980             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3981             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3982         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3983         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3984         16  PB-I-DATA-ENTRY-SW           PIC X.
  3985             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3986             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3987             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3988             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3989         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3990         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3991*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3992         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3993         16  FILLER                       PIC X.
  3994
  3995         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  75
* EL050.cbl
  3996             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3997             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3998                                                   '90' THRU '99'.
  3999         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4000                                          PIC XX.
  4001         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4002         16  PB-I-AMOUNT-FINANCED REDEFINES
  4003                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4004         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4005         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4006                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4007         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4008         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4009         16  PB-I-CLP-AMOUNT REDEFINES
  4010                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4011         16  PB-I-LF-CALC-FLAG            PIC X.
  4012             88 PB-COMP-LF-PREM               VALUE '?'.
  4013         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4014         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4015         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4016         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4017         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4018         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4019         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4020         16  PB-I-LF-ABBR                 PIC XXX.
  4021         16  PB-I-LF-INPUT-CD             PIC XX.
  4022
  4023         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4024             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4025             88  PB-INVALID-AH               VALUE '  ' '00'
  4026                                                   '90' THRU '99'.
  4027         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4028         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4029         16  PB-I-AH-CALC-FLAG            PIC X.
  4030             88 PB-COMP-AH-PREM                  VALUE '?'.
  4031         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4032         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4033         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4034         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4035         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4036         16  PB-I-AH-ABBR                 PIC XXX.
  4037         16  PB-I-AH-INPUT-CD             PIC XXX.
  4038
  4039         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4040         16  PB-I-REIN-TABLE              PIC XXX.
  4041         16  PB-I-BUSINESS-TYPE           PIC 99.
  4042         16  PB-I-INDV-GRP-CD             PIC X.
  4043         16  PB-I-MORT-CODE.
  4044             20  PB-I-TABLE               PIC X.
  4045             20  PB-I-INTEREST            PIC XX.
  4046             20  PB-I-MORT-TYP            PIC X.
  4047         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4048         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4049         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4050         16  PB-I-INDV-GRP-OVRD           PIC X.
  4051         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4052         16  PB-I-SIG-SW                  PIC X.
  4053             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  76
* EL050.cbl
  4054         16  PB-I-RATE-CLASS              PIC XX.
  4055         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4056         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4057         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4058         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4059         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4060         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4061         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4062         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4063         16  PB-I-OB-FLAG                 PIC X.
  4064             88  PB-I-OB                      VALUE 'B'.
  4065             88  PB-I-SUMMARY                 VALUE 'Z'.
  4066         16  PB-I-ENTRY-STATUS            PIC X.
  4067             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4068                                              'M' '5' '9' '2'.
  4069             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4070             88  PB-I-POLICY-PENDING          VALUE '2'.
  4071             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4072             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4073             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4074             88  PB-I-REIN-ONLY               VALUE '9'.
  4075             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4076             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4077             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4078             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4079         16  PB-I-INT-CODE                PIC X.
  4080             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4081             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4082         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4083         16  PB-I-SOC-SEC-NO              PIC X(11).
  4084         16  PB-I-MEMBER-NO               PIC X(12).
  4085         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4086*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4087         16  PB-I-OLD-LOF                 PIC XXX.
  4088         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4089         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4090         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4091         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4092         16  PB-I-LIFE-INDICATOR          PIC X.
  4093             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4094         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4095         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4096                                          PIC S9(5)V99    COMP-3.
  4097         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4098             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4099             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4100         16  PB-I-1ST-PMT-DT              PIC XX.
  4101         16  PB-I-JOINT-INSURED.
  4102             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4103             20 PB-I-JOINT-FIRST-NAME.
  4104                24  PB-I-JOINT-FIRST-INIT PIC X.
  4105                24  FILLER                PIC X(9).
  4106             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4107*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4108         16  PB-I-BENEFICIARY-NAME.
  4109             20  PB-I-BANK-NUMBER         PIC X(10).
  4110             20  FILLER                   PIC X(15).
  4111         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  77
* EL050.cbl
  4112         16  PB-I-REFERENCE               PIC X(12).
  4113         16  FILLER REDEFINES PB-I-REFERENCE.
  4114             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4115             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4116             20  PB-I-CLP-STATE           PIC XX.
  4117         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4118             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4119             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4120             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4121         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4122         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4123         16  PB-I-RESIDENT-STATE          PIC XX.
  4124         16  PB-I-RATE-CODE               PIC X(4).
  4125         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4126         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4127         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4128         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4129         16  PB-I-BANK-NOCHRGB            PIC 99.
  4130         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4131         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4132
  4133     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4134         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4135             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4136         16  PB-C-CANCEL-ORIGIN           PIC X.
  4137             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4138         16  PB-C-LF-CANCEL-DT            PIC XX.
  4139         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4140         16  PB-C-LF-CALC-REQ             PIC X.
  4141             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4142         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4143         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4144         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4145             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4146         16  PB-C-AH-CANCEL-DT            PIC XX.
  4147         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4148         16  PB-C-AH-CALC-REQ             PIC X.
  4149             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4150         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4151         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4152         16  PB-C-LAST-NAME               PIC X(15).
  4153         16  PB-C-REFUND-SW               PIC X.
  4154             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4155             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4156         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4157         16  PB-C-PAYEE-CODE              PIC X(6).
  4158         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4159         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4160         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4161         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4162         16  PB-C-REFERENCE               PIC X(12).
  4163         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4164         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-C-POST-CARD-IND           PIC X.
  4166         16  PB-C-CANCEL-REASON           PIC X.
  4167         16  PB-C-REF-INTERFACE-SW        PIC X.
  4168         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4169         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  78
* EL050.cbl
  4170         16  FILLER                       PIC X(01).
  4171*        16  FILLER                       PIC X(18).
  4172         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4173*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4174         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4175         16  PB-CANCELED-CERT-DATA.
  4176             20  PB-CI-INSURED-NAME.
  4177                 24  PB-CI-LAST-NAME      PIC X(15).
  4178                 24  PB-CI-INITIALS       PIC XX.
  4179             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4180             20  PB-CI-INSURED-SEX        PIC X.
  4181             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4182             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4183             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4184             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4185             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4186             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4187             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4188             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4189             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4190             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4191             20  PB-CI-RATE-CLASS         PIC XX.
  4192             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4193             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4194             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4195             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4196             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4197             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4198             20  PB-CI-LF-ABBR            PIC X(3).
  4199             20  PB-CI-AH-ABBR            PIC X(3).
  4200             20  PB-CI-OB-FLAG            PIC X.
  4201                 88  PB-CI-OB                VALUE 'B'.
  4202             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4203                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4204                                           'M' '4' '5' '9' '2'.
  4205                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4206                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4207                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4208                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4209                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4210                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4211                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4212                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4213                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4214                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4215                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4216                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4217             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4218                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4219                                           'M' '4' '5' '9' '2'.
  4220                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4221                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4222                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4223                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4224                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4225                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4226                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4227                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  79
* EL050.cbl
  4228                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4229                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4230                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4231                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4232             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4233             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4234             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4235             20  PB-CI-MEMBER-NO          PIC X(12).
  4236             20  PB-CI-INT-CODE           PIC X.
  4237                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4238                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4239             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4240             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4241             20  PB-CI-COMP-EXCP-SW       PIC X.
  4242                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4243                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4244             20  PB-CI-ENTRY-STATUS       PIC X.
  4245             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4246             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4247             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4248             20  PB-CI-DEATH-DT           PIC XX.
  4249             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4250             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4251             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4252             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4253             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4254             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4255             20  PB-CI-ENTRY-DT              PIC XX.
  4256             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4257             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4258             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4259             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4260             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4261             20  PB-CI-OLD-LOF               PIC XXX.
  4262*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4263             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4264             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4265             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4266             20  PB-CI-INDV-GRP-CD           PIC X.
  4267             20  PB-CI-BENEFICIARY-NAME.
  4268                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4269                 24  FILLER                  PIC X(15).
  4270             20  PB-CI-NOTE-SW               PIC X.
  4271             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4272             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4273             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4274             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4275             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4276             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4277             20  PB-CI-FIRST-NAME            PIC X(10).
  4278             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4279
  4280         16  FILLER                       PIC X(13).
  4281*032306  16  FILLER                       PIC X(27).
  4282*        16  FILLER                       PIC X(46).
  4283
  4284     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4285         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  80
* EL050.cbl
  4286         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4287         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4288         16  PB-M-INSURED-MID-INIT        PIC X.
  4289         16  PB-M-INSURED-AGE             PIC 99.
  4290         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4291         16  PB-M-INSURED-SEX             PIC X.
  4292         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4293         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4294         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4295         16  PB-M-INSURED-CITY-STATE.
  4296             20  PB-M-INSURED-CITY        PIC X(28).
  4297             20  PB-M-INSURED-STATE       PIC XX.
  4298         16  PB-M-INSURED-ZIP-CODE.
  4299             20  PB-M-INSURED-ZIP-PRIME.
  4300                 24  PB-M-INSURED-ZIP-1   PIC X.
  4301                     88  PB-M-CANADIAN-POST-CODE
  4302                                             VALUE 'A' THRU 'Z'.
  4303                 24  FILLER               PIC X(4).
  4304             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4305         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4306                                        PB-M-INSURED-ZIP-CODE.
  4307             20  PM-M-INS-CAN-POST1       PIC XXX.
  4308             20  PM-M-INS-CAN-POST2       PIC XXX.
  4309             20  FILLER                   PIC XXX.
  4310         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4311         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4312         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4313         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4314         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4315         16  PB-M-CRED-BENE-CITYST.
  4316             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4317             20  PB-M-CRED-BENE-STATE     PIC XX.
  4318         16  FILLER                       PIC X(92).
  4319
  4320     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4321         16  FILLER                       PIC X(10).
  4322         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4323         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4324         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4325         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4326         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4327         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4328         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4330         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4331         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4333         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4334         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4335         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4336         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4337         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4338         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4339         16  PB-ACCOUNT-NAME              PIC X(30).
  4340         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4341         16  PB-REFERENCE                 PIC X(12).
  4342         16  PB-B-RECEIVED-DT             PIC XX.
  4343         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  81
* EL050.cbl
  4344
  4345     12  PB-RECORD-STATUS.
  4346         16  PB-CREDIT-SELECT-DT          PIC XX.
  4347         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4348         16  PB-BILLED-DT                 PIC XX.
  4349         16  PB-BILLING-STATUS            PIC X.
  4350             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4351             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4352             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4353         16  PB-RECORD-BILL               PIC X.
  4354             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4355             88  PB-RECORD-RETURNED           VALUE 'R'.
  4356             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4357             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4358             88  PB-OVERRIDE-AH               VALUE 'A'.
  4359             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4360         16  PB-BATCH-ENTRY               PIC X.
  4361             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4362             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4363             88  PB-REISSUED-CERT             VALUE 'E'.
  4364             88  PB-MONTHLY-CERT              VALUE 'M'.
  4365             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4366             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4367             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4368         16  PB-FORCE-CODE                PIC X.
  4369             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4370             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4371             88  PB-CANCEL-FORCE              VALUE '8'.
  4372             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4373             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4374             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4375             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4376             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4377             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4378             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4379         16  PB-FATAL-FLAG                PIC X.
  4380             88  PB-FATAL-ERRORS              VALUE 'X'.
  4381         16  PB-FORCE-ER-CD               PIC X.
  4382             88  PB-FORCE-ERRORS              VALUE 'F'.
  4383             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4384         16  PB-WARN-ER-CD                PIC X.
  4385             88  PB-WARNING-ERRORS            VALUE 'W'.
  4386         16  FILLER                       PIC X.
  4387         16  PB-OUT-BAL-CD                PIC X.
  4388             88  PB-OUT-OF-BAL                VALUE 'O'.
  4389         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4390         16  PB-AH-OVERRIDE-L1            PIC X.
  4391         16  PB-INPUT-DT                  PIC XX.
  4392         16  PB-INPUT-BY                  PIC X(4).
  4393         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4394         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4395         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4396         16  PB-LF-EARNING-METHOD         PIC X.
  4397         16  PB-AH-EARNING-METHOD         PIC X.
  4398         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4399         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4400         16  PB-REIN-CD                   PIC XXX.
  4401         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  82
* EL050.cbl
  4402         16  PB-AH-REFUND-TYPE            PIC X.
  4403         16  PB-ACCT-EFF-DT               PIC XX.
  4404         16  PB-ACCT-EXP-DT               PIC XX.
  4405         16  PB-COMPANY-ID                PIC X(3).
  4406         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4407         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4408         16  PB-SV-CARRIER                PIC X.
  4409         16  PB-SV-GROUPING               PIC X(6).
  4410         16  PB-SV-STATE                  PIC XX.
  4411         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4412         16  PB-GA-BILLING-INFO.
  4413             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4414                                          PIC XX.
  4415         16  PB-SV-REMIT-TO  REDEFINES
  4416             PB-GA-BILLING-INFO           PIC X(10).
  4417         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4418         16  PB-I-LOAN-OFFICER            PIC X(5).
  4419         16  PB-I-VIN                     PIC X(17).
  4420
  4421         16  FILLER                       PIC X(04).
  4422         16  IMNET-BYPASS-SW              PIC X.
  4423
  4424******************************************************************
  4425*                COMMON EDIT ERRORS                              *
  4426******************************************************************
  4427
  4428     12  PB-COMMON-ERRORS.
  4429         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4430                                           PIC S9(4)     COMP.
  4431
  4432******************************************************************
  4433
  4434* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4435*    COPY ELC50W1.
  4436******************************************************************
  4437*                                                                *
  4438*                                                                *
  4439*                             ELC50W1                            *
  4440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4441*                            VMOD=2.004                          *
  4442*                                                                *
  4443*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4444*                                                                *
  4445*                                                                *
  4446******************************************************************
  4447
  4448     12  WK-WORK-AREA.
  4449         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4450         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4451         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4452         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4453         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4454         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4455         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4456         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4457         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4458         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4459         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  83
* EL050.cbl
  4460         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4461         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4462         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4463         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4464         16  WK-CREDIT-EDIT-CONTROLS.
  4465             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4466             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4467             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4468             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4469             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4470             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4471         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4472         16  WK-SAVE-REIN-DATA.
  4473             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4474             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4475             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4476         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4477             88  ENTRY-FROM-EL6311       VALUE '6'.
  4478         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4479         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4480     12  WK-RECORD-ADDRESSES.
  4481         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4482         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4483         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4484         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4485         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4486         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4487         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4489     12  WK-OVER-SHORT-AREA.
  4490         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4491         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4492         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4493             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4494         16  FILLER                   PIC X(5) VALUE SPACES.
  4495
  4496*    COPY ELCEDITC.
  4497******************************************************************
  4498*                                                                *
  4499*                                                                *
  4500*                            ELCEDITC                            *
  4501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4502*                            VMOD=2.012                          *
  4503*                                                                *
  4504*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4505*                     EL6313, EL050 AND EL517.                   *
  4506*                                                                *
  4507******************************************************************
  4508******************************************************************
  4509*                   C H A N G E   L O G
  4510*
  4511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4512*-----------------------------------------------------------------
  4513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4514* EFFECTIVE    NUMBER
  4515*-----------------------------------------------------------------
  4516* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  84
* EL050.cbl
  4518
  4519     12  EDIT-CRITERIA-DATA.
  4520         16  EC-CO-MONTH-END-DT       PIC XX.
  4521         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4522         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4523         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4524         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4525         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4526         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4527         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4528         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4529         16  EC-CO-REM-TERM-CALC      PIC X.
  4530               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4531               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4532               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4533               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4534
  4535         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4536               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4537               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4538               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4539               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4540               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4541               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4542               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4543               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4544               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4545               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4546
  4547         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4548               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4549               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4550               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4551               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4552               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4553               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4554               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4555               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4556
  4557         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4558                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4559                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4560
  4561         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4562                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4563                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4564                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4565                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4566                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4567                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4568                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4569                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4570
  4571         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4572               88  EC-BR-REDUCING                   VALUE 'R'.
  4573               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4574
  4575         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  85
* EL050.cbl
  4576         16  EC-BR-LF-DESC             PIC X(10).
  4577         16  EC-BR-AH-DESC             PIC X(10).
  4578         16  EC-BR-LF-COMMENT          PIC X(10).
  4579         16  EC-BR-AH-COMMENT          PIC X(10).
  4580
  4581         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4582               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4583               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4584               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4585               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4586
  4587         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4588               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4589               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4590               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4591               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4592
  4593         16  EC-BR-LF-REFUND-CALC      PIC X.
  4594                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4595                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4596                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4597                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4598                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4599                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4600                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4601
  4602         16  EC-BR-AH-REFUND-CALC      PIC X.
  4603                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4604                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4605                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4606                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4607                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4608                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4609                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4610                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4611
  4612         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4613                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4614                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4615                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4616
  4617         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4618                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4619                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4620                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4621
  4622         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4623         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4624         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4625         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4626
  4627         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4628         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4629                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4630                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4631                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4632                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4633
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  86
* EL050.cbl
  4634         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4635               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4636               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4637               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4638               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4639               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4640
  4641         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4642               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4643               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4644               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4645               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4646               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4647
  4648         16  EC-ST-LF-REFUND-CALC      PIC X.
  4649                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4650                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4651                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4652                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4653                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4654                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4655                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4656                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4657
  4658         16  EC-ST-AH-REFUND-CALC      PIC X.
  4659                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4660                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4661                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4662                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4663                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4664                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4665                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4666                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4667
  4668         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4669         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4670         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4671         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4672         16  EC-AM-EXPIRATION-DT       PIC XX.
  4673         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4674         16  EC-AM-CLASS-CD            PIC XX.
  4675         16  EC-AM-LF-DEVIATION        PIC XXX.
  4676         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4677         16  EC-AM-AH-DEVIATION        PIC XXX.
  4678         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4679         16  EC-AM-PHONE-NO            PIC X(10).
  4680
  4681         16  EC-AM-LF-REFUND-CALC      PIC X.
  4682                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4683                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4684                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4685                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4686                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4687                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4688                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4689
  4690         16  EC-AM-AH-REFUND-CALC      PIC X.
  4691                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  87
* EL050.cbl
  4692                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4694                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4695                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4696                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4697                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4698
  4699         16  EC-AM-BEN-I-G-CD          PIC X.
  4700                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4701                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4702                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4703
  4704         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4705         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4706         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4707         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4708         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4709         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4710         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4711         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4712         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4713
  4714         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4715         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4716         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4717         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4718         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4719         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4720         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4721         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4722         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4723         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4724         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4725         16  EC-RT-LF-NSP-ST           PIC XX.
  4726         16  EC-RT-AH-NSP-ST           PIC XX.
  4727         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4728         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4729
  4730         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4731             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4732                                             'M' '5' '9' '2'.
  4733             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4734             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4735             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4736             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4737             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4738             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4739             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4740             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4741             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4742             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4743
  4744         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4745             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4746                                             'M' '5' '9' '2'.
  4747             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4748             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4749             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  88
* EL050.cbl
  4750             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4751             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4752             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4753             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4754             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4755             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4756             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4757
  4758         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4759         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4760         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4761         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4762         16  EC-CM-DEATH-DT            PIC XX.
  4763
  4764*DMD CUSTOM CODING FIELDS BELOW
  4765*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4766         16  EC-BR-DMD-RATING-SW       PIC X.
  4767                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4768                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4769                 88  NO-DMD-RATING               VALUE 'N'.
  4770
  4771         16  EC-NEW-CERT               PIC X(11).
  4772         16  EC-NEW-STATE              PIC XX.
  4773         16  FILLER                    PIC X.
  4774*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4775         16  OVER-SHORT-EDIT-FIELDS.
  4776             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4777             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4778             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4779             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4780             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4781             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4782             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4783             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4784             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4785         16  FILLER                    PIC X(71).
  4786******************************************************************
  4787
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  89
* EL050.cbl
  4789*    COPY ELCDIFRD.
  4790******************************************************************
  4791*                                                                *
  4792*                                                                *
  4793*                            ELCDIFRD.                           *
  4794*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4795*                            VMOD=2.004                          *
  4796*                                                                *
  4797*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4798*                                                                *
  4799******************************************************************
  4800*
  4801  01  WS-DIFFERENCE-CALCULATION.
  4802        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4803        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4804        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4805        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4806        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4807        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4808        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4809        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4810        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4811        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4812        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4813
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  90
* EL050.cbl
  4815****************************************************************
  4816*
  4817* Copyright (c) 2007 by Clerity Solutions, Inc.
  4818* All rights reserved.
  4819*
  4820****************************************************************
  4821 01  DFHEIV.
  4822   02  DFHEIV0               PIC X(35).
  4823   02  DFHEIV1               PIC X(08).
  4824   02  DFHEIV2               PIC X(08).
  4825   02  DFHEIV3               PIC X(08).
  4826   02  DFHEIV4               PIC X(06).
  4827   02  DFHEIV5               PIC X(04).
  4828   02  DFHEIV6               PIC X(04).
  4829   02  DFHEIV7               PIC X(02).
  4830   02  DFHEIV8               PIC X(02).
  4831   02  DFHEIV9               PIC X(01).
  4832   02  DFHEIV10              PIC S9(7) COMP-3.
  4833   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4834   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4835   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4836   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4837   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4838   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4839   02  DFHEIV17              PIC X(04).
  4840   02  DFHEIV18              PIC X(04).
  4841   02  DFHEIV19              PIC X(04).
  4842   02  DFHEIV20              USAGE IS POINTER.
  4843   02  DFHEIV21              USAGE IS POINTER.
  4844   02  DFHEIV22              USAGE IS POINTER.
  4845   02  DFHEIV23              USAGE IS POINTER.
  4846   02  DFHEIV24              USAGE IS POINTER.
  4847   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4848   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4850   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4851   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4852   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4853   02  FILLER                PIC X(02).
  4854   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4855   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4856   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4857   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4858   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4859 LINKAGE  SECTION.
  4860*****************************************************************
  4861*                                                               *
  4862* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4863* All rights reserved.                                          *
  4864*                                                               *
  4865*****************************************************************
  4866 01  dfheiblk.
  4867     02  eibtime          pic s9(7) comp-3.
  4868     02  eibdate          pic s9(7) comp-3.
  4869     02  eibtrnid         pic x(4).
  4870     02  eibtaskn         pic s9(7) comp-3.
  4871     02  eibtrmid         pic x(4).
  4872     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  91
* EL050.cbl
  4873     02  eibcposn         pic s9(4) comp.
  4874     02  eibcalen         pic s9(4) comp.
  4875     02  eibaid           pic x(1).
  4876     02  eibfiller1       pic x(1).
  4877     02  eibfn            pic x(2).
  4878     02  eibfiller2       pic x(2).
  4879     02  eibrcode         pic x(6).
  4880     02  eibfiller3       pic x(2).
  4881     02  eibds            pic x(8).
  4882     02  eibreqid         pic x(8).
  4883     02  eibrsrce         pic x(8).
  4884     02  eibsync          pic x(1).
  4885     02  eibfree          pic x(1).
  4886     02  eibrecv          pic x(1).
  4887     02  eibsend          pic x(1).
  4888     02  eibatt           pic x(1).
  4889     02  eibeoc           pic x(1).
  4890     02  eibfmh           pic x(1).
  4891     02  eibcompl         pic x(1).
  4892     02  eibsig           pic x(1).
  4893     02  eibconf          pic x(1).
  4894     02  eiberr           pic x(1).
  4895     02  eibrldbk         pic x(1).
  4896     02  eiberrcd         pic x(4).
  4897     02  eibsynrb         pic x(1).
  4898     02  eibnodat         pic x(1).
  4899     02  eibfiller5       pic x(2).
  4900     02  eibresp          pic 9(09) comp.
  4901     02  eibresp2         pic 9(09) comp.
  4902     02  dfheigdj         pic s9(4) comp.
  4903     02  dfheigdk         pic s9(4) comp.
  4904
  4905 01  DFHCOMMAREA                   PIC X(1036).
  4906
  4907*01 PARMLIST .
  4908*    02  FILLER                    PIC S9(8)   COMP.
  4909*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4910*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4911*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4912*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4913*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4914*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4915*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4916
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  92
* EL050.cbl
  4918*    COPY ELCCNTL.
  4919******************************************************************
  4920*                                                                *
  4921*                                                                *
  4922*                            ELCCNTL.                            *
  4923*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4924*                            VMOD=2.059                          *
  4925*                                                                *
  4926*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4927*                                                                *
  4928*   FILE TYPE = VSAM,KSDS                                        *
  4929*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4930*                                                                *
  4931*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4932*       ALTERNATE INDEX = NONE                                   *
  4933*                                                                *
  4934*   LOG = YES                                                    *
  4935*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4936******************************************************************
  4937*                   C H A N G E   L O G
  4938*
  4939* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4940*-----------------------------------------------------------------
  4941*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4942* EFFECTIVE    NUMBER
  4943*-----------------------------------------------------------------
  4944* 082503                   PEMA  ADD BENEFIT GROUP
  4945* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4946* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4947* 092705    2005050300006  PEMA  ADD SPP LEASES
  4948* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4949* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4950* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4951* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4952* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4953* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4954* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4955* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4956* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4957******************************************************************
  4958*
  4959 01  CONTROL-FILE.
  4960     12  CF-RECORD-ID                       PIC XX.
  4961         88  VALID-CF-ID                        VALUE 'CF'.
  4962
  4963     12  CF-CONTROL-PRIMARY.
  4964         16  CF-COMPANY-ID                  PIC XXX.
  4965         16  CF-RECORD-TYPE                 PIC X.
  4966             88  CF-COMPANY-MASTER              VALUE '1'.
  4967             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4968             88  CF-STATE-MASTER                VALUE '3'.
  4969             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4970             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4971             88  CF-CARRIER-MASTER              VALUE '6'.
  4972             88  CF-MORTALITY-MASTER            VALUE '7'.
  4973             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4974             88  CF-TERMINAL-MASTER             VALUE '9'.
  4975             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  93
* EL050.cbl
  4976             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4977             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4978             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4979             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4980             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4981             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4982             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4983             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4984         16  CF-ACCESS-CD-GENL              PIC X(4).
  4985         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4986             20  CF-PROCESSOR               PIC X(4).
  4987         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4988             20  CF-STATE-CODE              PIC XX.
  4989             20  FILLER                     PIC XX.
  4990         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4991             20  FILLER                     PIC XX.
  4992             20  CF-HI-BEN-IN-REC           PIC XX.
  4993         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4994             20  FILLER                     PIC XXX.
  4995             20  CF-CARRIER-CNTL            PIC X.
  4996         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4997             20  FILLER                     PIC XX.
  4998             20  CF-HI-TYPE-IN-REC          PIC 99.
  4999         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5000             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5001                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5002             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5003             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5004         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5005             20  FILLER                     PIC X.
  5006             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5007         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5008             20  FILLER                     PIC XX.
  5009             20  CF-MORTGAGE-PLAN           PIC XX.
  5010         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5011
  5012     12  CF-LAST-MAINT-DT                   PIC XX.
  5013     12  CF-LAST-MAINT-BY                   PIC X(4).
  5014     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5015
  5016     12  CF-RECORD-BODY                     PIC X(728).
  5017
  5018
  5019****************************************************************
  5020*             COMPANY MASTER RECORD                            *
  5021****************************************************************
  5022
  5023     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5024         16  CF-COMPANY-ADDRESS.
  5025             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5026             20  CF-CL-IN-CARE-OF           PIC X(30).
  5027             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5028             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5029             20  CF-CL-CITY-STATE           PIC X(30).
  5030             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5031             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5032         16  CF-COMPANY-CD                  PIC X.
  5033         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  94
* EL050.cbl
  5034         16  CF-SECURITY-OPTION             PIC X.
  5035             88  ALL-SECURITY                   VALUE '1'.
  5036             88  COMPANY-VERIFY                 VALUE '2'.
  5037             88  PROCESSOR-VERIFY               VALUE '3'.
  5038             88  NO-SECURITY                    VALUE '4'.
  5039             88  ALL-BUT-TERM                   VALUE '5'.
  5040         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5041             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5042         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5043             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5044         16  CF-INFORCE-LOCATION            PIC X.
  5045             88  CERTS-ARE-ONLINE               VALUE '1'.
  5046             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5047             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5048         16  CF-LOWER-CASE-LETTERS          PIC X.
  5049         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5050             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5051             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5052             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5053             88  CF-ACCNT-CNTL                  VALUE '3'.
  5054             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5055
  5056         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5057         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5058
  5059         16  CF-LGX-CREDIT-USER             PIC X.
  5060             88  CO-IS-NOT-USER                 VALUE 'N'.
  5061             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5062
  5063         16 CF-CREDIT-CALC-CODES.
  5064             20  CF-CR-REM-TERM-CALC PIC X.
  5065               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5066               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5067               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5068               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5069               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5070               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5071               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5072             20  CF-CR-R78-METHOD           PIC X.
  5073               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5074               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5075
  5076         16  CF-CLAIM-CONTROL-COUNTS.
  5077             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5078                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5079
  5080             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5081                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5082
  5083             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5084                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5085
  5086             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5087                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5088
  5089         16  CF-CURRENT-MONTH-END           PIC XX.
  5090
  5091         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  95
* EL050.cbl
  5092             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5093             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5094             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5095             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5096                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5097                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5098             20  CF-CO-PREM-REJECT-SW       PIC X.
  5099                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5100                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5101             20  CF-CO-REF-REJECT-SW        PIC X.
  5102                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5103                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5104
  5105         16  CF-CO-REPORTING-DT             PIC XX.
  5106         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5107         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5108           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5109           88  CF-CO-MONTH-END                  VALUE '1'.
  5110
  5111         16  CF-LGX-CLAIM-USER              PIC X.
  5112             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5113             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5114
  5115         16  CF-CREDIT-EDIT-CONTROLS.
  5116             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5117             20  CF-MIN-AGE                 PIC 99.
  5118             20  CF-DEFAULT-AGE             PIC 99.
  5119             20  CF-MIN-TERM                PIC S999      COMP-3.
  5120             20  CF-MAX-TERM                PIC S999      COMP-3.
  5121             20  CF-DEFAULT-SEX             PIC X.
  5122             20  CF-JOINT-AGE-INPUT         PIC X.
  5123                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5124             20  CF-BIRTH-DATE-INPUT        PIC X.
  5125                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5126             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5127                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5128                 88  CF-ZERO-CARRIER            VALUE '1'.
  5129                 88  CF-ZERO-GROUPING           VALUE '2'.
  5130                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5131             20  CF-EDIT-SW                 PIC X.
  5132                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5133             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5134             20  CF-CR-PR-METHOD            PIC X.
  5135               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5136               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5137             20  FILLER                     PIC X.
  5138
  5139         16  CF-CREDIT-MISC-CONTROLS.
  5140             20  CF-REIN-TABLE-SW           PIC X.
  5141                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5142             20  CF-COMP-TABLE-SW           PIC X.
  5143                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5144             20  CF-EXPERIENCE-RETENTION-AGE
  5145                                            PIC S9        COMP-3.
  5146             20  CF-CONVERSION-DT           PIC XX.
  5147             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5148             20  CF-RUN-FREQUENCY-SW        PIC X.
  5149                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  96
* EL050.cbl
  5150                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5151
  5152             20  CF-CR-CHECK-NO-CONTROL.
  5153                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5154                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5155                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5156                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5157                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5158                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5159
  5160                 24  CF-CR-CHECK-COUNT       REDEFINES
  5161                     CF-CR-CHECK-COUNTER      PIC X(4).
  5162
  5163                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5164                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5165
  5166                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5167                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5168                 24  CF-MAIL-PROCESSING       PIC X.
  5169                     88  MAIL-PROCESSING          VALUE 'Y'.
  5170
  5171         16  CF-MISC-SYSTEM-CONTROL.
  5172             20  CF-SYSTEM-C                 PIC X.
  5173                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5174             20  CF-SYSTEM-D                 PIC X.
  5175                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5176             20  CF-SOC-SEC-NO-SW            PIC X.
  5177                 88  SOC-SEC-NO-USED             VALUE '1'.
  5178             20  CF-MEMBER-NO-SW             PIC X.
  5179                 88  MEMBER-NO-USED              VALUE '1'.
  5180             20  CF-TAX-ID-NUMBER            PIC X(11).
  5181             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5182             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5183                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5184                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5185                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5186                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5187             20  CF-SYSTEM-E                 PIC X.
  5188                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5189
  5190         16  CF-LGX-LIFE-USER               PIC X.
  5191             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5192             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5193
  5194         16  CF-CR-MONTH-END-DT             PIC XX.
  5195
  5196         16  CF-FILE-MAINT-DATES.
  5197             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5198                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5199             20  CF-LAST-BATCH       REDEFINES
  5200                 CF-LAST-BATCH-NO               PIC X(4).
  5201             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5202             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5203             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5204             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5205             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5206             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5207             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  97
* EL050.cbl
  5208             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5209             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5210             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5211
  5212         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5213         16  FILLER                         PIC X.
  5214
  5215         16  CF-ALT-MORT-CODE               PIC X(4).
  5216         16  CF-MEMBER-CAPTION              PIC X(10).
  5217
  5218         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5219             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5220             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5221             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5222             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5223             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5224
  5225         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5226
  5227         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5228         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5229         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5230         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5231
  5232         16  CF-AH-OVERRIDE-L1              PIC X.
  5233         16  CF-AH-OVERRIDE-L2              PIC XX.
  5234         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5235         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5236
  5237         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5238         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5239
  5240         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5241         16  CF-AR-LAST-EL860-DT            PIC XX.
  5242         16  CF-MP-MONTH-END-DT             PIC XX.
  5243
  5244         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5245         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5246             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5247
  5248         16  CF-AR-MONTH-END-DT             PIC XX.
  5249
  5250         16  CF-CRDTCRD-USER                PIC X.
  5251             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5252             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5253
  5254         16  CF-CC-MONTH-END-DT             PIC XX.
  5255
  5256         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5257
  5258         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5259             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5260             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5261             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5262         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5263         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5264         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5265         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  98
* EL050.cbl
  5266             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5267             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5268         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5269         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5270         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5271             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5272         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5273
  5274         16  CF-CL-ZIP-CODE.
  5275             20  CF-CL-ZIP-PRIME.
  5276                 24  CF-CL-ZIP-1ST          PIC X.
  5277                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5278                 24  FILLER                 PIC X(4).
  5279             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5280         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5281             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5282             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5283             20  FILLER                     PIC XXX.
  5284
  5285         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5286         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5287         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5288         16  CF-CO-OPTION-START-DATE        PIC XX.
  5289         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5290           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5291                                                      '3' '4'.
  5292           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5293           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5294           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5295           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5296           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5297           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5298
  5299         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5300
  5301         16  CF-PAYMENT-APPROVAL-LEVELS.
  5302             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5303             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5304             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5305             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5306             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5307             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5308
  5309         16  CF-END-USER-REPORTING-USER     PIC X.
  5310             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5311             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5312
  5313         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5314             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5315             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5316
  5317         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5318
  5319         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5320         16  FILLER                         PIC X.
  5321
  5322         16  CF-CREDIT-ARCHIVE-CNTL.
  5323             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page  99
* EL050.cbl
  5324             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5325             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5326
  5327         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5328
  5329         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5330             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5331             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5332
  5333         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5334             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5335             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5336
  5337         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5338
  5339         16  CF-CO-ACH-ID-CODE              PIC  X.
  5340             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5341             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5342             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5343         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5344         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5345         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5346         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5347         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5348         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5349         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5350         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5351         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5352                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5353         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5354                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5355
  5356         16  CF-CO-OVER-SHORT.
  5357             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5358             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5359
  5360*         16  FILLER                         PIC X(102).
  5361         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5362             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5363             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5364
  5365         16  CF-AH-APPROVAL-DAYS.
  5366             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5367             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5368             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5369             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5370
  5371         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5372
  5373         16  CF-APPROV-LEV-5.
  5374             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5375             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5376             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5377
  5378         16  FILLER                         PIC X(68).
  5379****************************************************************
  5380*             PROCESSOR/USER RECORD                            *
  5381****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 100
* EL050.cbl
  5382
  5383     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5384         16  CF-PROCESSOR-NAME              PIC X(30).
  5385         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5386         16  CF-PROCESSOR-TITLE             PIC X(26).
  5387         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5388                 88  MESSAGE-YES                VALUE 'Y'.
  5389                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5390
  5391*****************************************************
  5392****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5393****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5394****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5395****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5396*****************************************************
  5397
  5398         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5399             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5400             20  CF-APPLICATION-FORCE       PIC X.
  5401             20  CF-INDIVIDUAL-APP.
  5402                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5403                     28  CF-BROWSE-APP      PIC X.
  5404                     28  CF-UPDATE-APP      PIC X.
  5405
  5406         16  CF-CURRENT-TERM-ON             PIC X(4).
  5407         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5408             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5409             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5410             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5411             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5412             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5413             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5414             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5415         16  CF-PROCESSOR-CARRIER           PIC X.
  5416             88  NO-CARRIER-SECURITY            VALUE ' '.
  5417         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5418             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5419         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5420             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5421         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5422             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5423
  5424         16  CF-PROC-SYS-ACCESS-SW.
  5425             20  CF-PROC-CREDIT-CLAIMS-SW.
  5426                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5427                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5428                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5429                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5430             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5431                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5432                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5433             20  CF-PROC-LIFE-GNRLDGR-SW.
  5434                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5435                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5436                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5437                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5438             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5439                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 101
* EL050.cbl
  5440                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5441         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5442             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5443             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5444         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5445
  5446         16  CF-APPROVAL-LEVEL                  PIC X.
  5447             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5448             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5449             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5450             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5451             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5452
  5453         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5454
  5455         16  CF-LANGUAGE-TYPE                   PIC X.
  5456             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5457             88  CF-LANG-IS-FR                      VALUE 'F'.
  5458
  5459         16  CF-CSR-IND                         PIC X.
  5460         16  FILLER                             PIC X(239).
  5461
  5462****************************************************************
  5463*             PROCESSOR/REMINDERS RECORD                       *
  5464****************************************************************
  5465
  5466     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5467         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5468             20  CF-START-REMIND-DT         PIC XX.
  5469             20  CF-END-REMIND-DT           PIC XX.
  5470             20  CF-REMINDER-TEXT           PIC X(50).
  5471         16  FILLER                         PIC X(296).
  5472
  5473
  5474****************************************************************
  5475*             STATE MASTER RECORD                              *
  5476****************************************************************
  5477
  5478     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5479         16  CF-STATE-ABBREVIATION          PIC XX.
  5480         16  CF-STATE-NAME                  PIC X(25).
  5481         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5482         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5483             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5484             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5485             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5486             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5487                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5488                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5489             20  CF-ST-PREM-REJECT-SW       PIC X.
  5490                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5491                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5492             20  CF-ST-REF-REJECT-SW        PIC X.
  5493                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5494                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5495         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5496         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5497         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 102
* EL050.cbl
  5498             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5499             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5500             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5501         16  CF-ST-FST-PMT-EXTENSION.
  5502             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5503             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5504                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5505                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5506                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5507                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5508         16  CF-ST-STATE-CALL.
  5509             20  CF-ST-CALL-UNEARNED        PIC X.
  5510             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5511             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5512         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5513             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5514             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5515         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5516         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5517         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5518         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5519         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5520         16  FILLER                         PIC X.
  5521         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5522             20  CF-ST-BENEFIT-CD           PIC XX.
  5523             20  CF-ST-BENEFIT-KIND         PIC X.
  5524                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5525                 88  CF-ST-AH-KIND              VALUE 'A'.
  5526             20  CF-ST-REM-TERM-CALC        PIC X.
  5527                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5528                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5529                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5530                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5531                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5532                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5533                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5534                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5535
  5536             20  CF-ST-REFUND-CALC          PIC X.
  5537                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5538                 88  ST-REFD-BY-R78             VALUE '1'.
  5539                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5540                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5541                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5542                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5543                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5544                 88  ST-REFD-UTAH               VALUE '7'.
  5545                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5546                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5547                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5548
  5549             20  CF-ST-EARNING-CALC         PIC X.
  5550                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5551                 88  ST-EARN-BY-R78             VALUE '1'.
  5552                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5553                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5554                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5555                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 103
* EL050.cbl
  5556                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5557                 88  ST-EARN-MEAN               VALUE '8'.
  5558                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5559
  5560             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5561                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5562                 88  ST-OVRD-BY-R78             VALUE '1'.
  5563                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5564                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5565                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5566                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5567                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5568                 88  ST-OVRD-MEAN               VALUE '8'.
  5569                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5570             20  FILLER                     PIC X.
  5571
  5572         16  CF-ST-COMMISSION-CAPS.
  5573             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5574             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5575             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5576             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5577         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5578                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5579
  5580         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5581
  5582         16  CF-ST-STATUTORY-INTEREST.
  5583             20  CF-ST-STAT-DATE-FROM       PIC X.
  5584                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5585                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5586             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5587             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5588             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5589             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5590             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5591
  5592         16  CF-ST-OVER-SHORT.
  5593             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5594             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5595
  5596         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5597
  5598         16  CF-ST-RT-CALC                  PIC X.
  5599
  5600         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5601         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5602         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5603         16  CF-ST-RF-LR-CALC               PIC X.
  5604         16  CF-ST-RF-LL-CALC               PIC X.
  5605         16  CF-ST-RF-LN-CALC               PIC X.
  5606         16  CF-ST-RF-AH-CALC               PIC X.
  5607         16  CF-ST-RF-CP-CALC               PIC X.
  5608*        16  FILLER                         PIC X(206).
  5609*CIDMOD         16  FILLER                         PIC X(192).
  5610         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5611             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5612         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5613         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 104
* EL050.cbl
  5614         16  CF-ST-CAUSAL-STATE             PIC X.
  5615         16  FILLER                         PIC X(185).
  5616
  5617****************************************************************
  5618*             BENEFIT MASTER RECORD                            *
  5619****************************************************************
  5620
  5621     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5622         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5623             20  CF-BENEFIT-CODE            PIC XX.
  5624             20  CF-BENEFIT-NUMERIC  REDEFINES
  5625                 CF-BENEFIT-CODE            PIC XX.
  5626             20  CF-BENEFIT-ALPHA           PIC XXX.
  5627             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5628             20  CF-BENEFIT-COMMENT         PIC X(10).
  5629
  5630             20  CF-LF-COVERAGE-TYPE        PIC X.
  5631                 88  CF-REDUCING                VALUE 'R'.
  5632                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5633
  5634             20  CF-SPECIAL-CALC-CD         PIC X.
  5635                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5636                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5637                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5638                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5639                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5640                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5641                 88  CF-FARM-PLAN               VALUE 'F'.
  5642                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5643                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5644                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5645                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5646                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5647                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5648                 88  CF-PRUDENTIAL              VALUE 'P'.
  5649                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5650                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5651                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5652                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5653                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5654                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5655
  5656             20  CF-JOINT-INDICATOR         PIC X.
  5657                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5658
  5659*            20  FILLER                     PIC X(12).
  5660             20  FILLER                     PIC X(11).
  5661             20  CF-BENEFIT-CATEGORY        PIC X.
  5662             20  CF-LOAN-TYPE               PIC X(8).
  5663
  5664             20  CF-CO-REM-TERM-CALC        PIC X.
  5665                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5666                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5667                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5668                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5669                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5670
  5671             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 105
* EL050.cbl
  5672                 88  CO-EARN-BY-R78             VALUE '1'.
  5673                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5674                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5675                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5676                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5677                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5678                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5679                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5680
  5681             20  CF-CO-REFUND-CALC          PIC X.
  5682                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5683                 88  CO-REFD-BY-R78             VALUE '1'.
  5684                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5685                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5686                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5687                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5688                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5689                 88  CO-REFD-MEAN               VALUE '8'.
  5690                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5691                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5692                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5693
  5694             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5695                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5696                 88  CO-OVRD-BY-R78             VALUE '1'.
  5697                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5698                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5699                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5700                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5701                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5702                 88  CO-OVRD-MEAN               VALUE '8'.
  5703                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5704
  5705             20  CF-CO-BEN-I-G-CD           PIC X.
  5706                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5707                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5708                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5709
  5710         16  FILLER                         PIC X(304).
  5711
  5712
  5713****************************************************************
  5714*             CARRIER MASTER RECORD                            *
  5715****************************************************************
  5716
  5717     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5718         16  CF-ADDRESS-DATA.
  5719             20  CF-MAIL-TO-NAME            PIC X(30).
  5720             20  CF-IN-CARE-OF              PIC X(30).
  5721             20  CF-ADDRESS-LINE-1          PIC X(30).
  5722             20  CF-ADDRESS-LINE-2          PIC X(30).
  5723             20  CF-CITY-STATE              PIC X(30).
  5724             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5725             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5726
  5727         16  CF-CLAIM-NO-CONTROL.
  5728             20  CF-CLAIM-NO-METHOD         PIC X.
  5729                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 106
* EL050.cbl
  5730                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5731                 88  CLAIM-NO-SEQ               VALUE '3'.
  5732                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5733             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5734                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5735                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5736                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5737
  5738         16  CF-CHECK-NO-CONTROL.
  5739             20  CF-CHECK-NO-METHOD         PIC X.
  5740                 88  CHECK-NO-MANUAL            VALUE '1'.
  5741                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5742                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5743                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5744             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5745                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5746
  5747         16  CF-DOMICILE-STATE              PIC XX.
  5748
  5749         16  CF-EXPENSE-CONTROLS.
  5750             20  CF-EXPENSE-METHOD          PIC X.
  5751                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5752                 88  DOLLARS-PER-PMT            VALUE '2'.
  5753                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5754                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5755             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5756             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5757
  5758         16  CF-CORRESPONDENCE-CONTROL.
  5759             20  CF-LETTER-RESEND-OPT       PIC X.
  5760                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5761                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5762             20  FILLER                     PIC X(4).
  5763
  5764         16  CF-RESERVE-CONTROLS.
  5765             20  CF-MANUAL-SW               PIC X.
  5766                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5767             20  CF-FUTURE-SW               PIC X.
  5768                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5769             20  CF-PTC-SW                  PIC X.
  5770                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5771             20  CF-IBNR-SW                 PIC X.
  5772                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5773             20  CF-PTC-LF-SW               PIC X.
  5774                 88  CF-LF-PTC-USED             VALUE '1'.
  5775             20  CF-CDT-ACCESS-METHOD       PIC X.
  5776                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5777                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5778                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5779             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5780
  5781         16  CF-CLAIM-CALC-METHOD           PIC X.
  5782             88  360-PLUS-MONTHS                VALUE '1'.
  5783             88  365-PLUS-MONTHS                VALUE '2'.
  5784             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5785             88  360-DAILY                      VALUE '4'.
  5786             88  365-DAILY                      VALUE '5'.
  5787
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 107
* EL050.cbl
  5788         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5789         16  FILLER                         PIC X(11).
  5790
  5791         16  CF-LIMIT-AMOUNTS.
  5792             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5793             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5794             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5795             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5796             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5797             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5798             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5799             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5800             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5801             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5802
  5803         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5804         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5805         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5806
  5807         16  CF-ZIP-CODE.
  5808             20  CF-ZIP-PRIME.
  5809                 24  CF-ZIP-1ST             PIC X.
  5810                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5811                 24  FILLER                 PIC X(4).
  5812             20  CF-ZIP-PLUS4               PIC X(4).
  5813         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5814             20  CF-CAN-POSTAL-1            PIC XXX.
  5815             20  CF-CAN-POSTAL-2            PIC XXX.
  5816             20  FILLER                     PIC XXX.
  5817
  5818         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5819         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5820         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5821
  5822         16  CF-RATING-SWITCH               PIC X.
  5823             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5824             88  CF-NO-RATING                   VALUE 'N'.
  5825
  5826         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5827
  5828         16  CF-CARRIER-OVER-SHORT.
  5829             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5830             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5831
  5832         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5833         16  CF-SECPAY-SWITCH               PIC X.
  5834             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5835             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5836         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5837         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5838         16  FILLER                         PIC X(444).
  5839*        16  FILLER                         PIC X(452).
  5840
  5841
  5842****************************************************************
  5843*             MORTALITY MASTER RECORD                          *
  5844****************************************************************
  5845
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 108
* EL050.cbl
  5846     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5847         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5848                                INDEXED BY CF-MORT-NDX.
  5849             20  CF-MORT-TABLE              PIC X(5).
  5850             20  CF-MORT-TABLE-TYPE         PIC X.
  5851                 88  CF-MORT-JOINT              VALUE 'J'.
  5852                 88  CF-MORT-SINGLE             VALUE 'S'.
  5853                 88  CF-MORT-COMBINED           VALUE 'C'.
  5854                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5855                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5856             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5857             20  CF-MORT-AGE-METHOD         PIC XX.
  5858                 88  CF-AGE-LAST                VALUE 'AL'.
  5859                 88  CF-AGE-NEAR                VALUE 'AN'.
  5860             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5861             20  CF-MORT-ADJUSTMENT-DIRECTION
  5862                                            PIC X.
  5863                 88  CF-MINUS                   VALUE '-'.
  5864                 88  CF-PLUS                    VALUE '+'.
  5865             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5866             20  CF-MORT-JOINT-CODE         PIC X.
  5867                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5868             20  CF-MORT-PC-Q               PIC X.
  5869                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5870             20  CF-MORT-TABLE-CODE         PIC X(4).
  5871             20  CF-MORT-COMMENTS           PIC X(15).
  5872             20  FILLER                     PIC X(14).
  5873
  5874         16  FILLER                         PIC X(251).
  5875
  5876
  5877****************************************************************
  5878*             BUSSINESS TYPE MASTER RECORD                     *
  5879****************************************************************
  5880
  5881     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5882* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5883* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5884* AND RECORD 05 IS TYPES 81-99
  5885         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5886             20  CF-BUSINESS-TITLE          PIC  X(19).
  5887             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5888                                            PIC S9V9(4) COMP-3.
  5889             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5890             20  FILLER                     PIC  X.
  5891         16  FILLER                         PIC  X(248).
  5892
  5893
  5894****************************************************************
  5895*             TERMINAL MASTER RECORD                           *
  5896****************************************************************
  5897
  5898     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5899
  5900         16  CF-COMPANY-TERMINALS.
  5901             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5902                                  PIC X(4).
  5903         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 109
* EL050.cbl
  5904
  5905
  5906****************************************************************
  5907*             LIFE EDIT MASTER RECORD                          *
  5908****************************************************************
  5909
  5910     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5911         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5912             20  CF-LIFE-CODE-IN            PIC XX.
  5913             20  CF-LIFE-CODE-OUT           PIC XX.
  5914         16  FILLER                         PIC X(248).
  5915
  5916
  5917****************************************************************
  5918*             AH EDIT MASTER RECORD                            *
  5919****************************************************************
  5920
  5921     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5922         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5923             20  CF-AH-CODE-IN              PIC XXX.
  5924             20  CF-AH-CODE-OUT             PIC XX.
  5925         16  FILLER                         PIC X(248).
  5926
  5927
  5928****************************************************************
  5929*             CREDIBILITY TABLES                               *
  5930****************************************************************
  5931
  5932     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5933         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5934                             INDEXED BY CF-CRDB-NDX.
  5935             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5936             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5937             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5938         16  FILLER                         PIC  X(332).
  5939
  5940
  5941****************************************************************
  5942*             REPORT CUSTOMIZATION RECORD                      *
  5943****************************************************************
  5944
  5945     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5946         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5947             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5948             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5949             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5950**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5951****       A T-TRANSFER.                                   ****
  5952             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5953
  5954         16  FILLER                         PIC XX.
  5955
  5956         16  CF-CARRIER-CNTL-OPT.
  5957             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5958                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5959                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5960             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5961                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 110
* EL050.cbl
  5962         16  CF-GROUP-CNTL-OPT.
  5963             20  CF-GROUP-OPT-SEQ           PIC 9.
  5964                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5965                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5966             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5967                                            PIC X(6).
  5968         16  CF-STATE-CNTL-OPT.
  5969             20  CF-STATE-OPT-SEQ           PIC 9.
  5970                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5971                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5972             20  CF-STATE-SELECT OCCURS 3 TIMES
  5973                                            PIC XX.
  5974         16  CF-ACCOUNT-CNTL-OPT.
  5975             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5976                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5977                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5978             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5979                                            PIC X(10).
  5980         16  CF-BUS-TYP-CNTL-OPT.
  5981             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5982                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5983                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5984             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5985                                            PIC XX.
  5986         16  CF-LF-TYP-CNTL-OPT.
  5987             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5988                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5989                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5990             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5991                                            PIC XX.
  5992         16  CF-AH-TYP-CNTL-OPT.
  5993             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5994                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5995                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5996             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5997                                            PIC XX.
  5998         16  CF-REPTCD1-CNTL-OPT.
  5999             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6000                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6001                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6002             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6003                                            PIC X(10).
  6004         16  CF-REPTCD2-CNTL-OPT.
  6005             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6006                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6007                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6008             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6009                                            PIC X(10).
  6010         16  CF-USER1-CNTL-OPT.
  6011             20  CF-USER1-OPT-SEQ           PIC 9.
  6012                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6013                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6014             20  CF-USER1-SELECT OCCURS 3 TIMES
  6015                                            PIC X(10).
  6016         16  CF-USER2-CNTL-OPT.
  6017             20  CF-USER2-OPT-SEQ           PIC 9.
  6018                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6019                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 111
* EL050.cbl
  6020             20  CF-USER2-SELECT OCCURS 3 TIMES
  6021                                            PIC X(10).
  6022         16  CF-USER3-CNTL-OPT.
  6023             20  CF-USER3-OPT-SEQ           PIC 9.
  6024                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6025                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6026             20  CF-USER3-SELECT OCCURS 3 TIMES
  6027                                            PIC X(10).
  6028         16  CF-USER4-CNTL-OPT.
  6029             20  CF-USER4-OPT-SEQ           PIC 9.
  6030                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6031                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6032             20  CF-USER4-SELECT OCCURS 3 TIMES
  6033                                            PIC X(10).
  6034         16  CF-USER5-CNTL-OPT.
  6035             20  CF-USER5-OPT-SEQ           PIC 9.
  6036                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6037                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6038             20  CF-USER5-SELECT OCCURS 3 TIMES
  6039                                            PIC X(10).
  6040         16  CF-REINS-CNTL-OPT.
  6041             20  CF-REINS-OPT-SEQ           PIC 9.
  6042                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6043                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6044             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6045                 24  CF-REINS-PRIME         PIC XXX.
  6046                 24  CF-REINS-SUB           PIC XXX.
  6047
  6048         16  CF-AGENT-CNTL-OPT.
  6049             20  CF-AGENT-OPT-SEQ           PIC 9.
  6050                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6051                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6052             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6053                                            PIC X(10).
  6054
  6055         16  FILLER                         PIC X(43).
  6056
  6057         16  CF-LOSS-RATIO-SELECT.
  6058             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6059             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6060         16  CF-ENTRY-DATE-SELECT.
  6061             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6062             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6063         16  CF-EFFECTIVE-DATE-SELECT.
  6064             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6065             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6066
  6067         16  CF-EXCEPTION-LIST-IND          PIC X.
  6068             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6069
  6070         16  FILLER                         PIC X(318).
  6071
  6072****************************************************************
  6073*                  EXCEPTION REPORTING RECORD                  *
  6074****************************************************************
  6075
  6076     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6077         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 112
* EL050.cbl
  6078             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6079
  6080         16  CF-COMBINED-LIFE-AH-OPT.
  6081             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6082             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6083             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6084             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6085
  6086         16  CF-LIFE-OPT.
  6087             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6088             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6089             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6090             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6091             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6092             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6093             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6094             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6095             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6096             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6097
  6098         16  CF-AH-OPT.
  6099             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6100             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6101             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6102             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6103             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6104             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6105             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6106             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6107             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6108             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6109
  6110         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6111             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6112             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6113             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6114
  6115         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6116
  6117         16  FILLER                         PIC X(673).
  6118
  6119
  6120****************************************************************
  6121*             MORTGAGE SYSTEM PLAN RECORD                      *
  6122****************************************************************
  6123
  6124     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6125         16  CF-PLAN-TYPE                   PIC X.
  6126             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6127             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6128             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6129         16  CF-PLAN-ABBREV                 PIC XXX.
  6130         16  CF-PLAN-DESCRIPT               PIC X(10).
  6131         16  CF-PLAN-NOTES                  PIC X(20).
  6132         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6133         16  CF-PLAN-UNDERWRITING.
  6134             20  CF-PLAN-TERM-DATA.
  6135                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 113
* EL050.cbl
  6136                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6137             20  CF-PLAN-AGE-DATA.
  6138                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6139                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6140                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6141             20  CF-PLAN-BENEFIT-DATA.
  6142                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6143                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6144                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6145                                            PIC S9(7)V99  COMP-3.
  6146         16  CF-PLAN-POLICY-FORMS.
  6147             20  CF-POLICY-FORM             PIC X(12).
  6148             20  CF-MASTER-APPLICATION      PIC X(12).
  6149             20  CF-MASTER-POLICY           PIC X(12).
  6150         16  CF-PLAN-RATING.
  6151             20  CF-RATE-CODE               PIC X(5).
  6152             20  CF-SEX-RATING              PIC X.
  6153                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6154                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6155             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6156             20  CF-SUB-STD-TYPE            PIC X.
  6157                 88  CF-PCT-OF-PREM            VALUE '1'.
  6158                 88  CF-PCT-OF-BENE            VALUE '2'.
  6159         16  CF-PLAN-PREM-TOLERANCES.
  6160             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6161             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6162         16  CF-PLAN-PYMT-TOLERANCES.
  6163             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6164             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6165         16  CF-PLAN-MISC-DATA.
  6166             20  FILLER                     PIC X.
  6167             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6168             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6169         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6170         16  CF-PLAN-IND-GRP                PIC X.
  6171             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6172                                                     '1'.
  6173             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6174                                                     '2'.
  6175         16  CF-MIB-SEARCH-SW               PIC X.
  6176             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6177             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6178             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6179             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6180         16  CF-ALPHA-SEARCH-SW             PIC X.
  6181             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6182             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6183             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6184             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6185             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6186             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6187             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6188             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6189             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6190             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6191                                                     'A' 'B' 'C'
  6192                                                     'X' 'Y' 'Z'.
  6193         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 114
* EL050.cbl
  6194             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6195             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6196             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6197             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6198             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6199         16  FILLER                         PIC X(4).
  6200         16  CF-HEALTH-QUESTIONS            PIC X.
  6201             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6202         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6203         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6204         16  CF-PLAN-SNGL-JNT               PIC X.
  6205             88  CF-COMBINED-PLAN              VALUE 'C'.
  6206             88  CF-JNT-PLAN                   VALUE 'J'.
  6207             88  CF-SNGL-PLAN                  VALUE 'S'.
  6208         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6209         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6210         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6211         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6212         16  CF-RERATE-CNTL                 PIC  X.
  6213             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6214             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6215             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6216             88  CF-AUTO-RECALC                 VALUE '4'.
  6217         16  CF-BENEFIT-TYPE                PIC  X.
  6218             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6219             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6220         16  CF-POLICY-FEE                  PIC S999V99
  6221                                                    COMP-3.
  6222         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6223         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6224         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6225         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6226         16  FILLER                         PIC  X(32).
  6227         16  CF-TERMINATION-FORM            PIC  X(04).
  6228         16  FILLER                         PIC  X(08).
  6229         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6230                                                       COMP-3.
  6231         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6232         16  CF-ISSUE-LETTER                PIC  X(4).
  6233         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6234         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6235             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6236             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6237         16  CF-MP-REFUND-CALC              PIC X.
  6238             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6239             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6240             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6241             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6242             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6243             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6244             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6245             88  CF-MP-REFD-MEAN                VALUE '8'.
  6246         16  CF-ALT-RATE-CODE               PIC  X(5).
  6247
  6248
  6249         16  FILLER                         PIC X(498).
  6250****************************************************************
  6251*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 115
* EL050.cbl
  6252****************************************************************
  6253
  6254     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6255         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6256         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6257             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6258             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6259             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6260             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6261             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6262
  6263         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6264         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6265         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6266         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6267         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6268
  6269         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6270             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6271         16  CF-MP-RECON-USE-IND            PIC X(1).
  6272             88  CF-MP-USE-RECON             VALUE 'Y'.
  6273         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6274             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6275         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6276             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6277             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6278         16  FILLER                         PIC X(1).
  6279         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6280             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6281         16  CF-MORTG-MIB-VERSION           PIC X.
  6282             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6283             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6284             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6285         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6286             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6287                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6288             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6289                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6290             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6291                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6292             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6293                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6294             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6295                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6296             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6297                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6298         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6299         16  FILLER                         PIC X(7).
  6300         16  CF-MORTG-DESTINATION-SYMBOL.
  6301             20  CF-MORTG-MIB-COMM          PIC X(5).
  6302             20  CF-MORTG-MIB-TERM          PIC X(5).
  6303         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6304             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6305         16  FILLER                         PIC X(03).
  6306         16  CF-MP-CHECK-NO-CONTROL.
  6307             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6308                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6309                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 116
* EL050.cbl
  6310                                                ' ' LOW-VALUES.
  6311                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6312                                               VALUE '3'.
  6313         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6314         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6315         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6316             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6317                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6318             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6319                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6320             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6321                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6322             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6323                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6324             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6325                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6326             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6327                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6328         16  CF-MORTG-BILLING-AREA.
  6329             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6330                                            PIC X.
  6331         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6332         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6333         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6334         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6335             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6336             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6337         16  FILLER                         PIC X.
  6338         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6339             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6340             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6341         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6342         16  FILLER                         PIC X(8).
  6343         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6344         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6345         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6346         16  CF-ACH-COMPANY-ID.
  6347             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6348                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6349                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6350                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6351             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6352         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6353             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6354         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6355             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6356             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6357         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6358         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6359         16  FILLER                         PIC X(536).
  6360
  6361****************************************************************
  6362*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6363****************************************************************
  6364
  6365     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6366         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6367             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 117
* EL050.cbl
  6368                 24  CF-FEMALE-FT           PIC 99.
  6369                 24  CF-FEMALE-IN           PIC 99.
  6370             20  CF-FEMALE-MIN-WT           PIC 999.
  6371             20  CF-FEMALE-MAX-WT           PIC 999.
  6372         16  FILLER                         PIC X(428).
  6373
  6374     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6375         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6376             20  CF-MALE-HEIGHT.
  6377                 24  CF-MALE-FT             PIC 99.
  6378                 24  CF-MALE-IN             PIC 99.
  6379             20  CF-MALE-MIN-WT             PIC 999.
  6380             20  CF-MALE-MAX-WT             PIC 999.
  6381         16  FILLER                         PIC X(428).
  6382******************************************************************
  6383*             AUTOMATIC ACTIVITY RECORD                          *
  6384******************************************************************
  6385     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6386         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6387             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6388             20  CF-SYS-LETTER-ID           PIC X(04).
  6389             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6390             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6391             20  CF-SYS-RESET-SW            PIC X(01).
  6392             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6393             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6394
  6395         16  FILLER                         PIC X(50).
  6396
  6397         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6398             20  CF-USER-ACTIVE-SW          PIC X(01).
  6399             20  CF-USER-LETTER-ID          PIC X(04).
  6400             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6401             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6402             20  CF-USER-RESET-SW           PIC X(01).
  6403             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6404             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6405             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6406
  6407         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 118
* EL050.cbl
  6409*    COPY ERCACCT.
  6410******************************************************************
  6411*                                                                *
  6412*                                                                *
  6413*                            ERCACCT                             *
  6414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6415*                            VMOD=2.031                          *
  6416*                                                                *
  6417*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6418*                                                                *
  6419*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6420*   VSAM ACCOUNT MASTER FILES.                                   *
  6421*                                                                *
  6422*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6423*                                                                *
  6424*   FILE TYPE = VSAM,KSDS                                        *
  6425*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6426*                                                                *
  6427*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6428*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6429*                                                                *
  6430*   LOG = NO                                                     *
  6431*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6432*                                                                *
  6433*                                                                *
  6434******************************************************************
  6435*                   C H A N G E   L O G
  6436*
  6437* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6438*-----------------------------------------------------------------
  6439*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6440* EFFECTIVE    NUMBER
  6441*-----------------------------------------------------------------
  6442* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6443* 092705    2005050300006  PEMA  ADD SPP LEASES
  6444* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6445* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6446* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6447* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6448* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6449******************************************************************
  6450
  6451 01  ACCOUNT-MASTER.
  6452     12  AM-RECORD-ID                      PIC XX.
  6453         88  VALID-AM-ID                      VALUE 'AM'.
  6454
  6455     12  AM-CONTROL-PRIMARY.
  6456         16  AM-COMPANY-CD                 PIC X.
  6457         16  AM-MSTR-CNTRL.
  6458             20  AM-CONTROL-A.
  6459                 24  AM-CARRIER            PIC X.
  6460                 24  AM-GROUPING.
  6461                     28 AM-GROUPING-PREFIX PIC XXX.
  6462                     28 AM-GROUPING-PRIME  PIC XXX.
  6463                 24  AM-STATE              PIC XX.
  6464                 24  AM-ACCOUNT.
  6465                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6466                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 119
* EL050.cbl
  6467             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6468                                           PIC X(19).
  6469             20  AM-CNTRL-B.
  6470                 24  AM-EXPIRATION-DT      PIC XX.
  6471                 24  FILLER                PIC X(4).
  6472             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6473                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6474
  6475     12  AM-CONTROL-BY-VAR-GRP.
  6476         16  AM-COMPANY-CD-A1              PIC X.
  6477         16  AM-VG-CARRIER                 PIC X.
  6478         16  AM-VG-GROUPING                PIC X(6).
  6479         16  AM-VG-STATE                   PIC XX.
  6480         16  AM-VG-ACCOUNT                 PIC X(10).
  6481         16  AM-VG-DATE.
  6482             20  AM-VG-EXPIRATION-DT       PIC XX.
  6483             20  FILLER                    PIC X(4).
  6484         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6485                                           PIC 9(11)      COMP-3.
  6486     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6487         16  FILLER                        PIC X(10).
  6488         16  AM-VG-KEY3.
  6489             20  AM-VG3-ACCOUNT            PIC X(10).
  6490             20  AM-VG3-EXP-DT             PIC XX.
  6491         16  FILLER                        PIC X(4).
  6492     12  AM-MAINT-INFORMATION.
  6493         16  AM-LAST-MAINT-DT              PIC XX.
  6494         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6495         16  AM-LAST-MAINT-USER            PIC X(4).
  6496         16  FILLER                        PIC XX.
  6497
  6498     12  AM-EFFECTIVE-DT                   PIC XX.
  6499     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6500
  6501     12  AM-PREV-DATES  COMP-3.
  6502         16  AM-PREV-EXP-DT                PIC 9(11).
  6503         16  AM-PREV-EFF-DT                PIC 9(11).
  6504
  6505     12  AM-REPORT-CODE-1                  PIC X(10).
  6506     12  AM-REPORT-CODE-2                  PIC X(10).
  6507
  6508     12  AM-CITY-CODE                      PIC X(4).
  6509     12  AM-COUNTY-PARISH                  PIC X(6).
  6510
  6511     12  AM-NAME                           PIC X(30).
  6512     12  AM-PERSON                         PIC X(30).
  6513     12  AM-ADDRS                          PIC X(30).
  6514     12  AM-CITY.
  6515         16  AM-ADDR-CITY                  PIC X(28).
  6516         16  AM-ADDR-STATE                 PIC XX.
  6517     12  AM-ZIP.
  6518         16  AM-ZIP-PRIME.
  6519             20  AM-ZIP-PRI-1ST            PIC X.
  6520                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6521             20  FILLER                    PIC X(4).
  6522         16  AM-ZIP-PLUS4                  PIC X(4).
  6523     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6524         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 120
* EL050.cbl
  6525         16  AM-CAN-POSTAL-2               PIC XXX.
  6526         16  FILLER                        PIC XXX.
  6527     12  AM-TEL-NO.
  6528         16  AM-AREA-CODE                  PIC 999.
  6529         16  AM-TEL-PRE                    PIC 999.
  6530         16  AM-TEL-NBR                    PIC 9(4).
  6531     12  AM-TEL-LOC                        PIC X.
  6532         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6533         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6534
  6535     12  AM-COMM-STRUCTURE.
  6536         16  AM-DEFN-1.
  6537             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6538                 24  AM-AGT.
  6539                     28  AM-AGT-PREFIX     PIC X(4).
  6540                     28  AM-AGT-PRIME      PIC X(6).
  6541                 24  AM-COM-TYP            PIC X.
  6542                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6543                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6544                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6545                 24  AM-RECALC-LV-INDIC    PIC X.
  6546                 24  AM-RETRO-LV-INDIC     PIC X.
  6547                 24  AM-GL-CODES           PIC X.
  6548                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6549                 24  FILLER                PIC X(01).
  6550         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6551             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6552                 24  FILLER                PIC X(11).
  6553                 24  AM-L-COMA             PIC XXX.
  6554                 24  AM-J-COMA             PIC XXX.
  6555                 24  AM-A-COMA             PIC XXX.
  6556                 24  FILLER                PIC X(6).
  6557
  6558     12  AM-COMM-CHANGE-STATUS             PIC X.
  6559         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6560
  6561     12  AM-CSR-CODE                       PIC X(4).
  6562
  6563     12  AM-BILLING-STATUS                 PIC X.
  6564         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6565         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6566     12  AM-AUTO-REFUND-SW                 PIC X.
  6567         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6568         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6569     12  AM-GPCD                           PIC 99.
  6570     12  AM-IG                             PIC X.
  6571         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6572         88  AM-HAS-GROUP                     VALUE '2'.
  6573     12  AM-STATUS                         PIC X.
  6574         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6575         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6576         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6577         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6578         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6579         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6580     12  AM-REMIT-TO                       PIC 99.
  6581     12  AM-ID-NO                          PIC X(11).
  6582
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 121
* EL050.cbl
  6583     12  AM-CAL-TABLE                      PIC XX.
  6584     12  AM-LF-DEVIATION                   PIC XXX.
  6585     12  AM-AH-DEVIATION                   PIC XXX.
  6586     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6587     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6588     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6589     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6590     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6591     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6592
  6593     12  AM-USER-FIELDS.
  6594         16  AM-FLD-1                      PIC XX.
  6595         16  AM-FLD-2                      PIC XX.
  6596         16  AM-FLD-3                      PIC XX.
  6597         16  AM-FLD-4                      PIC XX.
  6598         16  AM-FLD-5                      PIC XX.
  6599
  6600     12  AM-1ST-PROD-DATE.
  6601         16  AM-1ST-PROD-YR                PIC XX.
  6602         16  AM-1ST-PROD-MO                PIC XX.
  6603         16  AM-1ST-PROD-DA                PIC XX.
  6604     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6605     12  AM-CERTS-PURGED-DATE.
  6606         16  AM-PUR-YR                     PIC XX.
  6607         16  AM-PUR-MO                     PIC XX.
  6608         16  AM-PUR-DA                     PIC XX.
  6609     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6610     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6611     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6612     12  AM-INACTIVE-DATE.
  6613         16  AM-INA-MO                     PIC 99.
  6614         16  AM-INA-DA                     PIC 99.
  6615         16  AM-INA-YR                     PIC 99.
  6616     12  AM-AR-HI-CERT-DATE                PIC XX.
  6617
  6618     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6619     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6620
  6621     12  AM-OB-PAYMENT-MODE                PIC X.
  6622         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6623         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6624         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6625         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6626
  6627     12  AM-AH-ONLY-INDICATOR              PIC X.
  6628         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6629         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6630
  6631     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6632
  6633     12  AM-OVER-SHORT.
  6634         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6635         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6636
  6637     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6638     12  AM-DCC-CLP-STATE                  PIC XX.
  6639
  6640     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 122
* EL050.cbl
  6641     12  AM-RECALC-REIN                    PIC X.
  6642
  6643     12  AM-REI-TABLE                      PIC XXX.
  6644     12  AM-REI-ET-LF                      PIC X.
  6645     12  AM-REI-ET-AH                      PIC X.
  6646     12  AM-REI-PE-LF                      PIC X.
  6647     12  AM-REI-PE-AH                      PIC X.
  6648     12  AM-REI-PRT-ST                     PIC X.
  6649     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6650     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6651     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6652     12  AM-REI-GROUP-A                    PIC X(6).
  6653     12  AM-REI-MORT                       PIC X(4).
  6654     12  AM-REI-PRT-OW                     PIC X.
  6655     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6656     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-GROUP-B                    PIC X(6).
  6659
  6660     12  AM-TRUST-TYPE                     PIC X(2).
  6661
  6662     12  AM-EMPLOYER-STMT-USED             PIC X.
  6663     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6664
  6665     12  AM-STD-AH-TYPE                    PIC XX.
  6666     12  AM-EARN-METHODS.
  6667         16  AM-EARN-METHOD-R              PIC X.
  6668             88 AM-REF-RL-R78                 VALUE 'R'.
  6669             88 AM-REF-RL-PR                  VALUE 'P'.
  6670             88 AM-REF-RL-MEAN                VALUE 'M'.
  6671             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6672         16  AM-EARN-METHOD-L              PIC X.
  6673             88 AM-REF-LL-R78                 VALUE 'R'.
  6674             88 AM-REF-LL-PR                  VALUE 'P'.
  6675             88 AM-REF-LL-MEAN                VALUE 'M'.
  6676             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6677         16  AM-EARN-METHOD-A              PIC X.
  6678             88 AM-REF-AH-R78                 VALUE 'R'.
  6679             88 AM-REF-AH-PR                  VALUE 'P'.
  6680             88 AM-REF-AH-MEAN                VALUE 'M'.
  6681             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6682             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6683             88 AM-REF-AH-NET                 VALUE 'N'.
  6684
  6685     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6686     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6687     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6688
  6689     12  AM-RET-Y-N                        PIC X.
  6690     12  AM-RET-P-E                        PIC X.
  6691     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6692     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6693     12  AM-RET-GRP                        PIC X(6).
  6694     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6695         16  AM-POOL-PRIME                 PIC XXX.
  6696         16  AM-POOL-SUB                   PIC XXX.
  6697     12  AM-RETRO-EARNINGS.
  6698         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 123
* EL050.cbl
  6699         16  AM-RET-EARN-L                 PIC X.
  6700         16  AM-RET-EARN-A                 PIC X.
  6701     12  AM-RET-ST-TAX-USE                 PIC X.
  6702         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6703         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6704     12  AM-RETRO-BEG-EARNINGS.
  6705         16  AM-RET-BEG-EARN-R             PIC X.
  6706         16  AM-RET-BEG-EARN-L             PIC X.
  6707         16  AM-RET-BEG-EARN-A             PIC X.
  6708     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6709     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6710
  6711     12  AM-USER-SELECT-OPTIONS.
  6712         16  AM-USER-SELECT-1              PIC X(10).
  6713         16  AM-USER-SELECT-2              PIC X(10).
  6714         16  AM-USER-SELECT-3              PIC X(10).
  6715         16  AM-USER-SELECT-4              PIC X(10).
  6716         16  AM-USER-SELECT-5              PIC X(10).
  6717
  6718     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6719
  6720     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6721
  6722     12  AM-RPT045A-SWITCH                 PIC X.
  6723         88  RPT045A-OFF                   VALUE 'N'.
  6724
  6725     12  AM-INSURANCE-LIMITS.
  6726         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6727         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6728
  6729     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6730         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6731
  6732     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6733         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6734         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6735
  6736     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6737
  6738     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6739     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6740     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6741     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6742     12  AM-DCC-UEF-STATE                  PIC XX.
  6743     12  FILLER                            PIC XXX.
  6744     12  AM-REPORT-CODE-3                  PIC X(10).
  6745*    12  FILLER                            PIC X(22).
  6746
  6747     12  AM-RESERVE-DATE.
  6748         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6749         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6750         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6751
  6752     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6753     12  AM-NOTIFICATION-TYPES.
  6754         16  AM-NOTIF-OF-LETTERS           PIC X.
  6755         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6756         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 124
* EL050.cbl
  6757         16  AM-NOTIF-OF-STATUS            PIC X.
  6758
  6759     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6760         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6761         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6762         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6763         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6764
  6765     12  AM-BENEFIT-CONTROLS.
  6766         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6767             20  AM-BENEFIT-CODE           PIC XX.
  6768             20  AM-BENEFIT-TYPE           PIC X.
  6769             20  AM-BENEFIT-REVISION       PIC XXX.
  6770             20  AM-BENEFIT-REM-TERM       PIC X.
  6771             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6772             20  FILLER                    PIC XX.
  6773         16  FILLER                        PIC X(80).
  6774
  6775     12  AM-TRANSFER-DATA.
  6776         16  AM-TRANSFERRED-FROM.
  6777             20  AM-TRNFROM-CARRIER        PIC X.
  6778             20  AM-TRNFROM-GROUPING.
  6779                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6780                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6781             20  AM-TRNFROM-STATE          PIC XX.
  6782             20  AM-TRNFROM-ACCOUNT.
  6783                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6784                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6785             20  AM-TRNFROM-DTE            PIC XX.
  6786         16  AM-TRANSFERRED-TO.
  6787             20  AM-TRNTO-CARRIER          PIC X.
  6788             20  AM-TRNTO-GROUPING.
  6789                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6790                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6791             20  AM-TRNTO-STATE            PIC XX.
  6792             20  AM-TRNTO-ACCOUNT.
  6793                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6794                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6795             20  AM-TRNTO-DTE              PIC XX.
  6796         16  FILLER                        PIC X(10).
  6797
  6798     12  AM-SAVED-REMIT-TO                 PIC 99.
  6799
  6800     12  AM-COMM-STRUCTURE-SAVED.
  6801         16  AM-DEFN-1-SAVED.
  6802             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6803                 24  AM-AGT-SV             PIC X(10).
  6804                 24  AM-COM-TYP-SV         PIC X.
  6805                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6806                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6807                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6808                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6809                 24  FILLER                PIC X.
  6810                 24  AM-GL-CODES-SV        PIC X.
  6811                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6812                 24  FILLER                PIC X.
  6813         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6814             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 125
* EL050.cbl
  6815                 24  FILLER                PIC X(11).
  6816                 24  AM-L-COMA-SV          PIC XXX.
  6817                 24  AM-J-COMA-SV          PIC XXX.
  6818                 24  AM-A-COMA-SV          PIC XXX.
  6819                 24  FILLER                PIC X(6).
  6820
  6821     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6822         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6823            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6824            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6825            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6826
  6827     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6828     12  FILLER                            PIC X(120).
  6829
  6830     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6831         16  AM-CONTROL-NAME               PIC X(30).
  6832         16  AM-EXECUTIVE-ONE.
  6833             20  AM-EXEC1-NAME             PIC X(15).
  6834             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6835                                                          COMP-3.
  6836             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6837                                                          COMP-3.
  6838         16  AM-EXECUTIVE-TWO.
  6839             20  AM-EXEC2-NAME             PIC X(15).
  6840             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6841                                                          COMP-3.
  6842             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6843                                                          COMP-3.
  6844
  6845     12  AM-RETRO-ADDITIONAL-DATA.
  6846         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6847         16  AM-RETRO-PREM-P-E             PIC X.
  6848         16  AM-RETRO-CLMS-P-I             PIC X.
  6849         16  AM-RETRO-RET-BRACKET-LF.
  6850             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6851                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6852                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6853             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6854                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6855                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6856             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6857                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6858                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6859         16  AM-RETRO-RET-BRACKET-AH.
  6860             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6861                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6862                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6863                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6864             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6865                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6866                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6867             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6868                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6869                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6870
  6871     12  AM-COMMENTS.
  6872         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 126
* EL050.cbl
  6873
  6874     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6875         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6876         16  AM-FLI-BILLING-CODE           PIC X.
  6877         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6878         16  AM-FLI-UNITED-IDENT           PIC X.
  6879         16  AM-FLI-INTEREST-LOST-DATA.
  6880             20  AM-FLI-BANK-NO            PIC X(5).
  6881             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6882             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6883             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6884         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6885             20  AM-FLI-AGT                PIC X(9).
  6886             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6887             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6888         16  FILLER                        PIC X(102).
  6889
  6890     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6891         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6892             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6893             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6894             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6895             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6896             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6897         16  FILLER                          PIC X(10).
  6898******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 127
* EL050.cbl
  6900*    COPY ERCREIN.
  6901******************************************************************
  6902*                                                                *
  6903*                            ERCREIN                             *
  6904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6905*                            VMOD=2.010                          *
  6906*                                                                *
  6907*   ONLINE CREDIT SYSTEM                                         *
  6908*                                                                *
  6909*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6910*                                                                *
  6911*   FILE TYPE = VSAM,KSDS                                        *
  6912*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6913*                                                                *
  6914*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6915*       ALTERNATE PATH = NONE                                    *
  6916*                                                                *
  6917*   LOG = NO                                                     *
  6918*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6919*                                                                *
  6920******************************************************************
  6921*                   C H A N G E   L O G
  6922*
  6923* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6924*-----------------------------------------------------------------
  6925*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6926* EFFECTIVE    NUMBER
  6927*-----------------------------------------------------------------
  6928* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6929* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6930******************************************************************
  6931 01  REINSURANCE-RECORD.
  6932     12  RE-RECORD-ID                      PIC XX.
  6933         88  VALID-RE-ID                      VALUE 'RE'.
  6934
  6935     12  RE-CONTROL-PRIMARY.
  6936         16  RE-COMPANY-CD                 PIC X.
  6937         16  RE-KEY.
  6938             20  RE-CODE                   PIC X.
  6939                 88  RE-TABLE-RECORD          VALUE 'A'.
  6940                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6941             20  RE-TABLE                  PIC XXX.
  6942             20  FILLER                    PIC XXX.
  6943         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6944             20  FILLER                    PIC X.
  6945             20  RE-COMPANY.
  6946                 24  RE-COMP-PRIME         PIC XXX.
  6947                 24  RE-COMP-SUB           PIC XXX.
  6948
  6949     12  RE-MAINT-INFORMATION.
  6950         16  RE-LAST-MAINT-DT              PIC XX.
  6951         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6952         16  RE-LAST-MAINT-USER            PIC X(4).
  6953         16  FILLER                        PIC X(10).
  6954
  6955     12  RE-TABLE-DATA.
  6956         16  RE-100-COMP                   PIC 99.
  6957
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 128
* EL050.cbl
  6958         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6959             20  RE-REI-COMP-NO.
  6960                 24  RE-REI-COMP           PIC XXX.
  6961                 24  RE-REI-COMP-SUB       PIC XXX.
  6962             20  RE-LF-QC                  PIC X.
  6963             20  RE-AH-QC                  PIC X.
  6964             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6965             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6966             20  RE-LFAGE-LO               PIC 99.
  6967             20  RE-LFAGE-HI               PIC 99.
  6968             20  RE-AHAGE-LO               PIC 99.
  6969             20  RE-AHAGE-HI               PIC 99.
  6970             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6971             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6972             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6973             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6974             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6975             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6976             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6977             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6978             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6979             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6980             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6981             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6982             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6983             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6984             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6985             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6986             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6987             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6988             20  RE-LF-BEN-CODE            PIC X.
  6989             20  RE-AH-BEN-CODE            PIC X.
  6990             20  RE-INTERACTIVE            PIC X.
  6991             20  RE-REMAINING              PIC X.
  6992             20  RE-LF-RUNOFF-SW           PIC X.
  6993             20  RE-AH-RUNOFF-SW           PIC X.
  6994             20  FILLER                    PIC X(19).
  6995
  6996         16  RE-COMP-INFO-END              PIC X(6).
  6997         16  RE-NSP-ST-CD-LF               PIC XX.
  6998         16  RE-NSP-ST-CD-AH               PIC XX.
  6999         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7000             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7001
  7002         16  FILLER                        PIC X(27).
  7003
  7004     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7005         16  RE-NAME                       PIC X(30).
  7006         16  RE-LF-PE                      PIC X.
  7007         16  RE-AH-PE                      PIC X.
  7008         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7009         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7010         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7011         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7012         16  RE-PRT-ST                     PIC X.
  7013         16  RE-PRT-OW                     PIC X.
  7014         16  RE-MORT-CODE                  PIC X(4).
  7015         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 129
* EL050.cbl
  7016         16  RE-ZERO-LF-FEE                PIC X.
  7017         16  RE-ZERO-AH-FEE                PIC X.
  7018         16  RE-CEDE-NAME                  PIC X(30).
  7019         16  RE-LF-COMM                    PIC X.
  7020         16  RE-AH-COMM                    PIC X.
  7021         16  RE-LF-TAX                     PIC X.
  7022         16  RE-AH-TAX                     PIC X.
  7023         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7024         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7025         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7026
  7027         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7028             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7029
  7030         16  RE-LF-CEDING-FEE-BRACKETS.
  7031             20  RE-LF-FEE-METHOD          PIC X.
  7032                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7033                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7034                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7035                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7036             20  RE-LF-FEE-BASIS           PIC X.
  7037                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7038                 88  RE-LF-NET-CEDED               VALUE '2'.
  7039                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7040                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7041                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7042                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7043                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7044                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7045             20  FILLER                    PIC XXX.
  7046             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7047                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7048                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7049
  7050         16  RE-AH-CEDING-FEE-BRACKETS.
  7051             20  RE-AH-FEE-METHOD          PIC X.
  7052                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7053                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7054                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7055                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7056             20  RE-AH-FEE-BASIS           PIC X.
  7057                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7058                 88  RE-AH-NET-CEDED               VALUE '2'.
  7059                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7060                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7061                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7062                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7063                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7064                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7065             20  FILLER                    PIC XXX.
  7066             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7067                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7068                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7069
  7070         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7071
  7072         16  RE-OLD-CEDING-STMT            PIC X.
  7073
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 130
* EL050.cbl
  7074         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7075         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7076         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7077         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7078         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7079         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7080         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7081         16  RE-MORT-SW                    PIC X.
  7082         16  RE-CEDING-TYPE-FLAG           PIC X.
  7083             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7084             88  RE-CEDED                          VALUE 'C'.
  7085             88  RE-ASSUMED                        VALUE 'A'.
  7086             88  RE-PHANTOM                        VALUE 'P'.
  7087
  7088         16  RE-CEDING-STMT-OPT-A          PIC X.
  7089             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7090         16  RE-CEDING-STMT-OPT-B          PIC X.
  7091             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7092         16  RE-CEDING-STMT-OPT-C          PIC X.
  7093             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7094         16  RE-CEDING-STMT-OPT-D          PIC X.
  7095             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7096         16  RE-CEDING-STMT-OPT-E          PIC X.
  7097             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7098
  7099         16  RE-PRT-CRSV                   PIC X.
  7100
  7101         16  RE-GL-CENTER                  PIC X(4).
  7102
  7103         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7104
  7105         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7106
  7107         16  RE-EARN-STOP-CODE             PIC X.
  7108             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7109             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7110
  7111         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7112             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7113
  7114         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7115         16  FILLER                        PIC X(2281).
  7116
  7117         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7118
  7119******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 131
* EL050.cbl
  7121*    COPY ERCCTBL.
  7122******************************************************************
  7123*                                                                *
  7124*                                                                *
  7125*                            ERCCTBL                             *
  7126*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7127*                            VMOD=2.003
  7128*                                                                *
  7129*   ONLINE CREDIT SYSTEM                                         *
  7130*                                                                *
  7131*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7132*                                                                *
  7133*   FILE TYPE = VSAM,KSDS                                        *
  7134*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7135*                                                                *
  7136*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7137*       ALTERNATE PATH = NONE                                    *
  7138*                                                                *
  7139*   LOG = NO                                                     *
  7140*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7141*                                                                *
  7142*                                                                *
  7143******************************************************************
  7144
  7145 01  COMM-TABLE-RECORD.
  7146     12  CT-RECORD-ID                      PIC XX.
  7147         88  VALID-CT-ID                      VALUE 'CT'.
  7148
  7149     12  CT-CONTROL-PRIMARY.
  7150         16  CT-COMPANY-CD                 PIC X.
  7151         16  CT-TABLE                      PIC XXX.
  7152         16  CT-CNTRL-2.
  7153             20  CT-BEN-TYPE               PIC X.
  7154             20  CT-BEN-CODE               PIC XX.
  7155
  7156     12  CT-MAINT-INFORMATION.
  7157         16  CT-LAST-MAINT-DT              PIC XX.
  7158         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7159         16  CT-LAST-MAINT-USER            PIC X(4).
  7160         16  FILLER                        PIC X(31).
  7161
  7162     12  CT-LIMITS.
  7163         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7164
  7165         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7166
  7167         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7168
  7169     12  CT-RATES.
  7170         16  CT-RTX          OCCURS 27 TIMES.
  7171             20  CT-RT                     PIC SV9(5)     COMP-3.
  7172             20  CT-RT-R   REDEFINES
  7173                 CT-RT                     PIC XXX.
  7174
  7175     12  FILLER                            PIC  X(42).
  7176
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 132
* EL050.cbl
  7179*    COPY ERCFORM.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCFORM.                            *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.003                          *
  7186*                                                                *
  7187*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7188*                                                                *
  7189*    FILE TYPE = VSAM,KSDS                                       *
  7190*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7191*                                                                *
  7192*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7193*                                                                *
  7194*    LOG = YES                                                   *
  7195*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7196******************************************************************
  7197 01  FORM-MASTER.
  7198    12  FO-RECORD-ID                 PIC X(02).
  7199        88  VALID-FO-ID                  VALUE 'FO'.
  7200
  7201    12  FO-CONTROL-PRIMARY.
  7202        16  FO-COMPANY-CD            PIC X(01).
  7203        16  FO-STATE                 PIC X(02).
  7204        16  FO-FORM-ID               PIC X(12).
  7205        16  FO-FORM-EXP-DT           PIC X(02).
  7206
  7207    12  FO-POLICY-FORM-DATA.
  7208        16  FO-IND-GRP-CD            PIC X(01).
  7209        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7210        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7211        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7212        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7213        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7214        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7215        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7216        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7217        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7218        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7219        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7220        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7221        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7222        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7223        16  FO-APP-CERT-USE-CD       PIC X(01).
  7224
  7225    12  FILLER                       PIC X(29).
  7226
  7227    12  FO-FORM-PLAN-TABLE.
  7228        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7229            20  FO-PLAN-TYPE         PIC X(01).
  7230            20  FO-PLAN-ID           PIC X(02).
  7231            20  FO-PLAN-TERM         PIC 9(03).
  7232            20  FO-PLAN-REFUND-METHOD
  7233                                     PIC X.
  7234
  7235    12  FILLER                       PIC X(30).
  7236
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 133
* EL050.cbl
  7237    12  FO-COMMENTS-AREA.
  7238        16  FO-COMMENT-LINE-1        PIC X(78).
  7239
  7240    12  FILLER                       PIC X(20).
  7241
  7242    12  FO-MAINT-INFORMATION.
  7243        16  FO-LAST-MAINT-DT         PIC X(02).
  7244        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7245        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 134
* EL050.cbl
  7247*    COPY ELCMSTR.
  7248******************************************************************
  7249*                                                                *
  7250*                            ELCMSTR.                            *
  7251*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7252*                            VMOD=2.012                          *
  7253*                                                                *
  7254*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7255*                                                                *
  7256*   FILE TYPE = VSAM,KSDS                                        *
  7257*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7258*                                                                *
  7259*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7260*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7261*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7262*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7263*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7264*                                                 RKP=75,LEN=21  *
  7265*                                                                *
  7266*   **** NOTE ****                                               *
  7267*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7268*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7269*                                                                *
  7270*   LOG = YES                                                    *
  7271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7272******************************************************************
  7273*                   C H A N G E   L O G
  7274*
  7275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7276*-----------------------------------------------------------------
  7277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7278* EFFECTIVE    NUMBER
  7279*-----------------------------------------------------------------
  7280* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7281* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7282* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7283******************************************************************
  7284 01  CLAIM-MASTER.
  7285     12  CL-RECORD-ID                PIC XX.
  7286         88  VALID-CL-ID         VALUE 'CL'.
  7287
  7288     12  CL-CONTROL-PRIMARY.
  7289         16  CL-COMPANY-CD           PIC X.
  7290         16  CL-CARRIER              PIC X.
  7291         16  CL-CLAIM-NO             PIC X(7).
  7292         16  CL-CERT-NO.
  7293             20  CL-CERT-PRIME       PIC X(10).
  7294             20  CL-CERT-SFX         PIC X.
  7295
  7296     12  CL-CONTROL-BY-NAME.
  7297         16  CL-COMPANY-CD-A1        PIC X.
  7298         16  CL-INSURED-LAST-NAME    PIC X(15).
  7299         16  CL-INSURED-NAME.
  7300             20  CL-INSURED-1ST-NAME PIC X(12).
  7301             20  CL-INSURED-MID-INIT PIC X.
  7302
  7303     12  CL-CONTROL-BY-SSN.
  7304         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 135
* EL050.cbl
  7305         16  CL-SOC-SEC-NO.
  7306             20  CL-SSN-STATE        PIC XX.
  7307             20  CL-SSN-ACCOUNT      PIC X(6).
  7308             20  CL-SSN-LN3          PIC X(3).
  7309
  7310     12  CL-CONTROL-BY-CERT-NO.
  7311         16  CL-COMPANY-CD-A4        PIC X.
  7312         16  CL-CERT-NO-A4.
  7313             20  CL-CERT-A4-PRIME    PIC X(10).
  7314             20  CL-CERT-A4-SFX      PIC X.
  7315
  7316     12  CL-CONTROL-BY-CCN.
  7317         16  CL-COMPANY-CD-A5        PIC X.
  7318         16  CL-CCN-A5.
  7319             20  CL-CCN.
  7320                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7321                 24  CL-CCN-PRIME-A5 PIC X(12).
  7322             20  CL-CCN-FILLER-A5    PIC X(4).
  7323
  7324     12  CL-INSURED-PROFILE-DATA.
  7325         16  CL-INSURED-BIRTH-DT     PIC XX.
  7326         16  CL-INSURED-SEX-CD       PIC X.
  7327             88  INSURED-IS-MALE        VALUE 'M'.
  7328             88  INSURED-IS-FEMALE      VALUE 'F'.
  7329             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7330         16  CL-INSURED-OCC-CD       PIC X(6).
  7331         16  FILLER                  PIC X(5).
  7332
  7333     12  CL-PROCESSING-INFO.
  7334         16  CL-PROCESSOR-ID         PIC X(4).
  7335         16  CL-CLAIM-STATUS         PIC X.
  7336             88  CLAIM-IS-OPEN          VALUE 'O'.
  7337             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7338         16  CL-CLAIM-TYPE           PIC X.
  7339*            88  AH-CLAIM               VALUE 'A'.
  7340*            88  LIFE-CLAIM             VALUE 'L'.
  7341*            88  PROPERTY-CLAIM         VALUE 'P'.
  7342*            88  IUI-CLAIM              VALUE 'I'.
  7343*            88  GAP-CLAIM              VALUE 'G'.
  7344         16  CL-CLAIM-PREM-TYPE      PIC X.
  7345             88  SINGLE-PREMIUM         VALUE '1'.
  7346             88  O-B-COVERAGE           VALUE '2'.
  7347             88  OPEN-END-COVERAGE      VALUE '3'.
  7348         16  CL-INCURRED-DT          PIC XX.
  7349         16  CL-REPORTED-DT          PIC XX.
  7350         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7351         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7352         16  CL-LAST-PMT-DT          PIC XX.
  7353         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7354         16  CL-PAID-THRU-DT         PIC XX.
  7355         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7356         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7357         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7358         16  CL-PMT-CALC-METHOD      PIC X.
  7359             88  CL-360-DAY-YR          VALUE '1'.
  7360             88  CL-365-DAY-YR          VALUE '2'.
  7361             88  CL-FULL-MONTHS         VALUE '3'.
  7362         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 136
* EL050.cbl
  7363
  7364         16  CL-PRIME-CERT-NO.
  7365             20  CL-PRIME-CERT-PRIME PIC X(10).
  7366             20  CL-PRIME-CERT-SFX   PIC X.
  7367
  7368         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7369             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7370             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7371
  7372         16  CL-MICROFILM-NO         PIC X(10).
  7373         16  CL-PROG-FORM-TYPE       PIC X.
  7374         16  CL-LAST-ADD-ON-DT       PIC XX.
  7375
  7376         16  CL-LAST-REOPEN-DT       PIC XX.
  7377         16  CL-LAST-CLOSE-DT        PIC XX.
  7378         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7379             88  FINAL-PAID             VALUE '1'.
  7380             88  CLAIM-DENIED           VALUE '2'.
  7381             88  AUTO-CLOSE             VALUE '3'.
  7382             88  MANUAL-CLOSE           VALUE '4'.
  7383             88  BENEFITS-CHANGED       VALUE 'C'.
  7384             88  SETUP-ERRORS           VALUE 'E'.
  7385         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7386         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7387         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7388             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7389         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7390         16  FILLER                  PIC X.
  7391
  7392     12  CL-CERTIFICATE-DATA.
  7393         16  CL-CERT-ORIGIN          PIC X.
  7394             88  CERT-WAS-ONLINE        VALUE '1'.
  7395             88  CERT-WAS-CREATED       VALUE '2'.
  7396             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7397         16  CL-CERT-KEY-DATA.
  7398             20  CL-CERT-CARRIER     PIC X.
  7399             20  CL-CERT-GROUPING    PIC X(6).
  7400             20  CL-CERT-STATE       PIC XX.
  7401             20  CL-CERT-ACCOUNT.
  7402                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7403                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7404             20  CL-CERT-EFF-DT      PIC XX.
  7405
  7406     12  CL-STATUS-CONTROLS.
  7407         16  CL-PRIORITY-CD          PIC X.
  7408             88  CONFIDENTIAL-DATA      VALUE '8'.
  7409             88  HIGHEST-PRIORITY       VALUE '9'.
  7410         16  CL-SUPV-ATTN-CD         PIC X.
  7411             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7412             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7413         16  CL-PURGED-DT            PIC XX.
  7414         16  CL-RESTORED-DT          PIC XX.
  7415         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7416         16  CL-NEXT-RESEND-DT       PIC XX.
  7417         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7418         16  CL-CRITICAL-PERIOD      PIC 99.
  7419*        16  FILLER                  PIC XX.
  7420         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 137
* EL050.cbl
  7421         16  CL-LAST-MAINT-USER      PIC X(4).
  7422         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7423         16  CL-LAST-MAINT-TYPE      PIC X.
  7424             88  CLAIM-SET-UP           VALUE ' '.
  7425             88  PAYMENT-MADE           VALUE '1'.
  7426             88  LETTER-SENT            VALUE '2'.
  7427             88  MASTER-WAS-ALTERED     VALUE '3'.
  7428             88  MASTER-WAS-RESTORED    VALUE '4'.
  7429             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7430             88  FILE-CONVERTED         VALUE '6'.
  7431             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7432             88  ERROR-CORRECTION       VALUE 'E'.
  7433         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7434         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7435         16  CL-BENEFICIARY          PIC X(10).
  7436         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7437         16  CL-DENIAL-TYPE          PIC X.
  7438             88  CL-TYPE-DENIAL          VALUE '1'.
  7439             88  CL-TYPE-RESCISSION      VALUE '2'.
  7440             88  CL-TYPE-REFORMATION     VALUE '3'.
  7441             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7442             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7443         16  CL-CRIT-PER-RECURRENT   PIC X.
  7444         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7445         16  CL-RTW-DT               PIC XX.
  7446
  7447     12  CL-TRAILER-CONTROLS.
  7448         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7449             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7450             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7451             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7452         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7453         16  FILLER                  PIC XX.
  7454         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7455         16  CL-ADDRESS-TRAILER-CNT.
  7456             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7457                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7458             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7459                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7460             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7461                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7462             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7463                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7464             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7465                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7466             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7467                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7468             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7469                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7470
  7471     12  CL-CV-REFERENCE-NO.
  7472         16  CL-CV-REFNO-PRIME       PIC X(18).
  7473         16  CL-CV-REFNO-SFX         PIC XX.
  7474
  7475     12  CL-FILE-LOCATION            PIC X(4).
  7476
  7477     12  CL-PROCESS-ERRORS.
  7478         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 138
* EL050.cbl
  7479             88  NO-FATAL-ERRORS        VALUE ZERO.
  7480         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7481             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7482
  7483     12  CL-PRODUCT-CD               PIC X.
  7484
  7485     12  CL-CURRENT-KEY-DATA.
  7486         16  CL-CURRENT-CARRIER      PIC X.
  7487         16  CL-CURRENT-GROUPING     PIC X(6).
  7488         16  CL-CURRENT-STATE        PIC XX.
  7489         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7490
  7491     12  CL-ASSOCIATES               PIC X.
  7492         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7493         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7494         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7495         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7496
  7497     12  CL-ACTIVITY-CODE            PIC 99.
  7498     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7499     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7500
  7501     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7502     12  CL-LAG-REPORT-CODE          PIC 9.
  7503     12  CL-LOAN-TYPE                PIC XX.
  7504     12  CL-LEGAL-STATE              PIC XX.
  7505
  7506     12  CL-YESNOSW                  PIC X.
  7507     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7508         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7509         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7510         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7511     12  cl-insured-claim            pic x.
  7512         88  cl-claim-on-primary         value 'P'.
  7513         88  cl-claim-on-secondary       value 'S'.
  7514     12  cl-benefit-expiration-dt    PIC XX.
  7515
  7516 01  PLAN-RECORDS.
  7517     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7518     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7519
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 139
* EL050.cbl
  7521 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7522                          ACCOUNT-MASTER REINSURANCE-RECORD
  7523                          COMM-TABLE-RECORD FORM-MASTER
  7524                          CLAIM-MASTER PLAN-RECORDS.
  7525 0000-DFHEXIT SECTION.
  7526     MOVE '9#                    $   ' TO DFHEIV0.
  7527     MOVE 'EL050' TO DFHEIV1.
  7528     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7529
  7530     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7531
  7532
  7533* EXEC CICS  HANDLE CONDITION
  7534*           ERROR    (9300-ABEND)
  7535*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7536*    END-EXEC.
  7537*    MOVE '"$.J                  ! " #00007528' TO DFHEIV0
  7538     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7540     MOVE X'2220233030303037353238' TO DFHEIV0(25:11)
  7541     CALL 'kxdfhei1' USING DFHEIV0
  7542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7543
  7544
  7545 0000-COPY-PROCEDURE-DIV.
  7546*                          COPY ELC50PD.
  7547******************************************************************
  7548*                                                                *
  7549*                            ELC50PD                             *
  7550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7551*                            VMOD=2.188                          *
  7552*                                                                *
  7553******************************************************************
  7554*                   C H A N G E   L O G
  7555*
  7556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7557*-----------------------------------------------------------------
  7558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7559* EFFECTIVE    NUMBER
  7560*-----------------------------------------------------------------
  7561* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7562* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7563* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7564*                             2709 AND 2718
  7565* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7566* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7567* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7568* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7569* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7570*                                IS OPEN OR CNC DT < PD THRU
  7571* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7572* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7573* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7574* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7575* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7576* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7577* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7578* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 140
* EL050.cbl
  7579* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7580* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7581* 020906                   PEMA  EXPAND LOAN OFFICER
  7582* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7583* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7584* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7585* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7586* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7587* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7588* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7589* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7590* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7591* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7592* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7593* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7594* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7595* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7596* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7597* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7598* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7599* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7600* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7601* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7602* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7603* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7604* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7605* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7606* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7607*                                UPDATE VIN ON CERT TRAILER
  7608* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7609* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7610* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7611* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7612* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7613* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7614* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7615* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7616* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7617* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7618* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7619* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7620* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7621* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7622* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7623* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7624* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7625* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7626* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7627* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7628* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7629* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7630* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7631* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7632* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7633* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7634* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7635* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7636* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 141
* EL050.cbl
  7637* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7638* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7639* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7640* 032912  CR2011110200001  PEMA  AHL CHANGES
  7641* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7642* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7643* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7644* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7645* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7646* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7647* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7648* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7649* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7650* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7651* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7652* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7653* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7654* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7655* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7656******************************************************************
  7657************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7658******************************************************************
  7659
  7660     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7661
  7662     MOVE SPACES                 TO PB-FATAL-FLAG
  7663                                    PB-FORCE-ER-CD
  7664                                    PB-WARN-ER-CD
  7665                                    PB-OUT-BAL-CD.
  7666
  7667     MOVE SPACE                  TO WS-IG-OVRD-AH
  7668                                    WS-IG-OVRD-LF
  7669                                    WS-IG-OVRD-AM
  7670                                    WS-IG-OVRD
  7671                                    WS-IG-OVRD-AH-PL
  7672                                    WS-IG-OVRD-LF-PL
  7673                                    WS-IG-OVRD-AH-BEN
  7674                                    WS-IG-OVRD-LF-BEN.
  7675
  7676******************************************************************
  7677*************       INITIALIZE COMMON ERRORS       ***************
  7678******************************************************************
  7679
  7680     MOVE +0                     TO PB-NO-OF-ERRORS.
  7681     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7682
  7683******************************************************************
  7684
  7685     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7686     SET JULIAN-TO-BIN           TO TRUE.
  7687*    MOVE 5                      TO DC-OPTION-CODE.
  7688     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7689     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7690
  7691     MOVE ZERO                   TO  SUB4.
  7692
  7693 0040-INITIALIZE-GA-BILL-DT.
  7694
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 142
* EL050.cbl
  7695     ADD +1                      TO  SUB4.
  7696
  7697     IF  SUB4 GREATER THAN +5
  7698         GO TO 0050-CHECK-CNTL-FOUND.
  7699
  7700     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7701         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7702
  7703     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7704
  7705 0050-CHECK-CNTL-FOUND.
  7706
  7707     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7708        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7709                                         WS-AH-REM-TERM-CALC
  7710                                         EC-CO-REM-TERM-CALC
  7711        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7712        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7713        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7714                                         WS-TOL-AH-CLAIM
  7715        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7716                                         WS-TOL-AH-PREM
  7717                                         EC-CO-TOL-PREM
  7718        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7719                                         WS-TOL-AH-REFUND
  7720                                         EC-CO-TOL-REFUND
  7721        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7722                                         WS-AH-REFUND-OVS-AMT
  7723                                         EC-CO-OVR-SHT-AMT
  7724        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7725                                         WS-TOL-AH-PREM-PCT
  7726                                         EC-CO-TOL-PREM-PCT
  7727        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7728                                         WS-TOL-AH-REFUND-PCT
  7729                                         EC-CO-TOL-REFUND-PCT
  7730        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7731                                         WS-AH-REFUND-OVS-PCT
  7732                                         EC-CO-OVR-SHT-PCT
  7733        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7734        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7735        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7736        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7737        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7738        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7739        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7740        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7741        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7742        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7743        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7744        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7745                                         EC-CO-MONTH-END-DT
  7746        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7747          GO TO 0100-READ-ACCT.
  7748
  7749     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7750     MOVE SPACES                 TO CNTL-ACCESS.
  7751     MOVE '1'                    TO CNTL-REC-TYPE.
  7752     MOVE +0                     TO CNTL-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 143
* EL050.cbl
  7753
  7754     MOVE '1' TO RC-SW-1.
  7755     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7756     IF NOT CF-COMPANY-MASTER
  7757         MOVE ZEROS             TO WK-CO-TOL-PREM
  7758                                   WK-CO-TOL-CLAIM
  7759                                   WK-CO-TOL-REFUND
  7760                                   WK-REFUND-OVS-AMT
  7761                                   WK-REFUND-OVS-PCT
  7762                                   WK-CO-TOL-PREM-PCT
  7763                                   WK-CO-TOL-REFUND-PCT
  7764                                   WK-DEFAULT-APR
  7765                                   WK-CO-MAX-CAP
  7766        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7767                                   WK-CR-R78-METHOD
  7768                                   WK-CO-REF-REJECT-SW
  7769                                   WK-CO-PREM-REJECT-SW
  7770                                   WK-REM-TRM-CALC-OPTION
  7771                                   WK-BIRTH-DATE-INPUT
  7772                                   WK-JOINT-AGE-INPUT
  7773        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7774        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7775        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7776        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7777          GO TO 0099-COMPANY-NOT-FOUND.
  7778
  7779     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7780        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7781     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7782        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7783     IF CF-CO-TOL-CAP NOT NUMERIC
  7784        MOVE +0                    TO CF-CO-TOL-CAP.
  7785     IF CF-DEFAULT-APR NOT NUMERIC
  7786        MOVE +0                    TO CF-DEFAULT-APR.
  7787
  7788     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7789     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7790     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7791     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7792     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7793     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7794     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7795     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7796     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7797     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7798     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7799     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7800
  7801     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7802          CF-CO-OVR-SHT-AMT > +0
  7803        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7804
  7805     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7806          CF-CO-OVR-SHT-PCT > +0
  7807        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7808
  7809     IF CF-VALID-REM-TRM-OPTION
  7810         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 144
* EL050.cbl
  7811     ELSE
  7812         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7813
  7814     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7815     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7816     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7817     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7818
  7819     GO TO 0050-CHECK-CNTL-FOUND.
  7820
  7821 0099-COMPANY-NOT-FOUND.
  7822
  7823     MOVE ER-2616                TO WS-ERROR.
  7824     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7825
  7826 0100-READ-ACCT.
  7827
  7828     MOVE SPACES                 TO DATE-RANGE-SW.
  7829
  7830     IF WK-ACCT-ADDR = ZEROS
  7831        GO TO 0102-ACCT-GETMAIN.
  7832
  7833     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7834     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7835     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7836
  7837     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7838        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7839        GO TO 0105-READ-ACCT
  7840     END-IF
  7841
  7842     IF PB-CARRIER NOT = SPACES
  7843        IF PB-CARRIER NOT = AM-VG-CARRIER
  7844           GO TO 0105-READ-ACCT.
  7845
  7846     IF PB-STATE NOT = SPACES
  7847        IF PB-STATE NOT = AM-VG-STATE
  7848           GO TO 0105-READ-ACCT.
  7849
  7850     IF PB-GROUPING NOT = SPACES
  7851        IF PB-GROUPING NOT = AM-VG-GROUPING
  7852           GO TO 0105-READ-ACCT.
  7853
  7854     MOVE 'X'                 TO DATE-RANGE-SW.
  7855
  7856     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7857        MOVE 'X'                 TO DATE-RANGE-SW
  7858        GO TO 0105-READ-ACCT.
  7859
  7860     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7861        GO TO 0105-READ-ACCT.
  7862
  7863     GO TO 0180-ACCOUNT-FOUND.
  7864
  7865 0102-ACCT-GETMAIN.
  7866     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7867     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7868
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 145
* EL050.cbl
  7869 0105-READ-ACCT.
  7870     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7871     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7872     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7873     MOVE PB-STATE               TO ACCT-STATE.
  7874     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7875     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7876
  7877     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7878
  7879     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7880
  7881 0110-FIND-ACCT-TOLERANCES-LOOP.
  7882     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7883
  7884     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7885        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7886        GO TO 0199-ACCT-NOT-FOUND
  7887     END-IF
  7888     IF PB-CARRIER NOT = SPACES
  7889        IF PB-CARRIER NOT = AM-VG-CARRIER
  7890           GO TO 0199-ACCT-NOT-FOUND.
  7891
  7892     IF PB-STATE NOT = SPACES
  7893        IF PB-STATE NOT = AM-VG-STATE
  7894           GO TO 0199-ACCT-NOT-FOUND.
  7895
  7896     IF PB-GROUPING NOT = SPACES
  7897        IF PB-GROUPING NOT = AM-VG-GROUPING
  7898           GO TO 0199-ACCT-NOT-FOUND.
  7899
  7900     MOVE 'X'                    TO DATE-RANGE-SW.
  7901
  7902     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7903        MOVE 'X'                 TO DATE-RANGE-SW
  7904        GO TO 0199-ACCT-NOT-FOUND.
  7905
  7906     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7907        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7908
  7909 0180-ACCOUNT-FOUND.
  7910     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7911     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7912     MOVE AM-STATE               TO PB-SV-STATE.
  7913     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7914
  7915     IF AM-CANCEL-FEE  NOT NUMERIC
  7916        MOVE ZEROS TO AM-CANCEL-FEE.
  7917
  7918     IF AM-MAX-MON-BEN NOT NUMERIC
  7919        MOVE ZEROS TO AM-MAX-MON-BEN.
  7920
  7921     IF AM-MAX-TOT-BEN NOT NUMERIC
  7922        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7923
  7924     IF AM-CLP-TOL-PCT NOT NUMERIC
  7925        MOVE +0                  TO AM-CLP-TOL-PCT
  7926     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 146
* EL050.cbl
  7927     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7928        MOVE +0                  TO AM-SPP-LEASE-COMM
  7929     END-IF
  7930     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7931        MOVE ER-2611             TO   WS-ERROR
  7932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7933
  7934     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7935        MOVE ER-2621             TO   WS-ERROR
  7936        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7937
  7938     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7939        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7940        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7941        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7942         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7943
  7944     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7945     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7946     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7947     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7948     IF AM-CLP-TOL-PCT NOT = ZEROS
  7949        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7950     END-IF
  7951     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7952        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7953     END-IF
  7954*    IF PB-COMPANY-ID = 'DCC'
  7955*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7956*                                   WS-ADMIN-FEES
  7957*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7958*          (SUB5 > +10)
  7959*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7960*             AND (AM-A-COM (SUB5) NUMERIC)
  7961*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7962*                + (AM-A-COM (SUB5) * 1000)
  7963*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7964*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7965*                + (AM-A-COM (SUB5) * 1000)
  7966*             END-IF
  7967*             IF AM-COM-TYP (SUB5) = 'N'
  7968*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7969*                + (AM-A-COM (SUB5) * 1000)
  7970*             END-IF
  7971*          END-IF
  7972*       END-PERFORM
  7973*    END-IF
  7974     IF (PB-COMPANY-ID = 'DCC')
  7975        AND (PB-ISSUE)
  7976        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7977        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7978           (SUB5 > +10)
  7979           MOVE +0 TO WS-WK-RATE
  7980           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7981              IF (AM-A-COM (SUB5) NUMERIC)
  7982                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7983                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7984              ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 147
* EL050.cbl
  7985                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7986                 IF PB-ISSUE
  7987                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7988                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7989                 ELSE
  7990                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7991                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7992                 END-IF
  7993                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7994                 MOVE ZEROS             TO WS-SUB1
  7995                                           WS-COMMISSION
  7996                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7997                 MOVE '0530'               TO CTBL-SW
  7998                 MOVE ' '                  TO WS-CTBL-READ-SW
  7999                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8000                 IF FIRST-TIME-THROUGH
  8001                    MOVE 'AA'              TO CTBL-BEN-CODE
  8002                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8003                 END-IF
  8004                 IF CTBL-TABLE-FOUND
  8005                    IF PB-ISSUE
  8006                       COMPUTE WS-COMM-CK-AMT =
  8007                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8008                    ELSE
  8009                       COMPUTE WS-COMM-CK-AMT =
  8010                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8011                    END-IF
  8012                    PERFORM 8800-GET-COMP-RATE
  8013                              THRU 8800-EXIT
  8014                 END-IF
  8015              END-IF
  8016              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8017                + (WS-WK-RATE * 1000)
  8018           END-IF
  8019        END-PERFORM
  8020     END-IF
  8021     IF PB-COMPANY-ID EQUAL 'CRI'
  8022         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8023
  8024     IF PB-COMPANY-ID EQUAL 'NCL'
  8025         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8026     END-IF
  8027
  8028     GO TO 0200-READ-CERT.
  8029
  8030 0199-ACCT-NOT-FOUND.
  8031
  8032     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8033
  8034     IF DATE-RANGE-SW NOT = SPACES
  8035        MOVE ER-2601             TO WS-ERROR
  8036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8037     ELSE
  8038        MOVE ER-2619             TO WS-ERROR
  8039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8040
  8041     GO TO 9990-RETURN.
  8042
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 148
* EL050.cbl
  8043 0200-READ-CERT.
  8044
  8045     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8046     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8047     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8048     MOVE PB-SV-STATE            TO CERT-STATE.
  8049     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8050     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8051     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8052
  8053     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8054
  8055     IF CERT-WAS-NOT-FOUND
  8056        GO TO 0299-CERT-NOT-FOUND.
  8057
  8058     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8059        MOVE ER-2759             TO WS-ERROR
  8060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8061        GO TO 0298-UNLOCK-RETURN.
  8062
  8063     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8064         MOVE ER-2758            TO WS-ERROR
  8065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8066         GO TO 0298-UNLOCK-RETURN.
  8067
  8068     IF PB-ISSUE
  8069        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8070           IF CERT-WAS-CREATED-FOR-CLAIM
  8071              NEXT SENTENCE
  8072            ELSE
  8073              MOVE ER-2626       TO WS-ERROR
  8074              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8075              GO TO 0298-UNLOCK-RETURN.
  8076
  8077     IF NOT PB-CANCELLATION
  8078        GO TO 0300-CONTINUE-EDIT.
  8079
  8080     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8081     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8082     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8083     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8084     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8085     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8086
  8087     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8088     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8089     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8090     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8091     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8092     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8093     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8094     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8095     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8096
  8097     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8098     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8099     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8100     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 149
* EL050.cbl
  8101     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8102     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8103     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8104
  8105     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8106     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8107
  8108     MOVE CM-CREDIT-INTERFACE-SW-1
  8109                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8110     MOVE CM-CREDIT-INTERFACE-SW-2
  8111                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8112
  8113     IF CM-O-B-COVERAGE
  8114         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8115
  8116     IF CM-LIVES NOT NUMERIC
  8117         MOVE ZERO                TO CM-LIVES.
  8118
  8119     IF CM-BILLED NOT NUMERIC
  8120         MOVE ZERO                TO CM-BILLED.
  8121
  8122     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8123         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8124         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8125         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8126         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8127         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8128         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8129         MOVE CM-LIVES             TO PB-CI-LIVES
  8130*The next line causes a problem with my change  I dont think it is
  8131*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8132
  8133     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8134     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8135     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8136     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8137     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8138     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8139
  8140     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8141     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8142     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8143     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8144
  8145     IF CM-LIFE-COMM-PCT NUMERIC
  8146         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8147     ELSE
  8148         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8149
  8150     IF CM-AH-COMM-PCT NUMERIC
  8151         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8152     ELSE
  8153         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8154
  8155     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8156
  8157     IF CM-LOAN-APR       NOT NUMERIC
  8158           MOVE ZERO               TO CM-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 150
* EL050.cbl
  8159
  8160     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8161           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8162
  8163     IF CM-LOAN-TERM      NOT NUMERIC
  8164           MOVE ZERO               TO CM-LOAN-TERM.
  8165
  8166     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8167           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8168
  8169     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8170           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8171
  8172     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8173     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8174     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8175     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8176     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8177     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8178     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8179     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8180     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8181     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8182     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8183     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8184
  8185     IF CM-STATE = CM-SSN-STATE
  8186         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8187
  8188     IF CM-STATE NOT = CM-MEMB-STATE
  8189         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8190
  8191     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8192
  8193     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8194        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8195        IF CM-ADDL-CLP NOT NUMERIC
  8196           MOVE +0               TO CM-ADDL-CLP
  8197        END-IF
  8198        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8199        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8200           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8201        END-IF
  8202     END-IF
  8203     IF PB-COMPANY-ID = 'DCC'
  8204        MOVE +0                  TO WS-ADMIN-FEES
  8205                                    WS-CSO-ADMIN-FEE
  8206                                    WS-COMM-AND-MFEE
  8207                                    WS-1ST-YR-ALLOW
  8208        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8209           (SUB5 > +10)
  8210           MOVE +0 TO WS-WK-RATE
  8211           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8212              IF (AM-A-COM (SUB5) NUMERIC)
  8213                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8214                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8215              ELSE
  8216                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 151
* EL050.cbl
  8217                 IF PB-ISSUE
  8218                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8219                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8220                 ELSE
  8221                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8222                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8223                 END-IF
  8224                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8225                 MOVE ZEROS             TO WS-SUB1
  8226                                           WS-COMMISSION
  8227                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8228                 MOVE '0530'               TO CTBL-SW
  8229                 MOVE ' '                  TO WS-CTBL-READ-SW
  8230                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8231                 IF FIRST-TIME-THROUGH
  8232                    MOVE 'AA'              TO CTBL-BEN-CODE
  8233                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8234                 END-IF
  8235                 IF CTBL-TABLE-FOUND
  8236                    IF PB-ISSUE
  8237                       COMPUTE WS-COMM-CK-AMT =
  8238                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8239                    ELSE
  8240                       COMPUTE WS-COMM-CK-AMT =
  8241                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8242                    END-IF
  8243                    PERFORM 8800-GET-COMP-RATE
  8244                              THRU 8800-EXIT
  8245                 END-IF
  8246              END-IF
  8247              IF AM-COM-TYP (SUB5) = 'I'
  8248                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8249                   + (WS-WK-RATE * 1000)
  8250              END-IF
  8251              IF AM-COM-TYP (SUB5) = 'N'
  8252                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8253                   + (WS-WK-RATE * 1000)
  8254              END-IF
  8255              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8256                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8257                   + (WS-WK-RATE * 1000)
  8258              END-IF
  8259              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8260                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8261                   + (WS-WK-RATE * 1000)
  8262              END-IF
  8263           END-IF
  8264        END-PERFORM
  8265     END-IF
  8266     GO TO 0300-CONTINUE-EDIT.
  8267
  8268 0298-UNLOCK-RETURN.
  8269      PERFORM 9250-UNLOCK-RETURN
  8270      GO TO 9990-RETURN.
  8271
  8272 0299-CERT-NOT-FOUND.
  8273
  8274     MOVE '1'                     TO CERT-STATUS-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 152
* EL050.cbl
  8275
  8276     IF PB-COMPANY-ID = 'UCL'
  8277         IF WS-ERROR = ER-2799
  8278             GO TO 3000-CONTINUE-EDIT.
  8279
  8280     IF NOT PB-CANCELLATION
  8281         GO TO 0300-CONTINUE-EDIT.
  8282
  8283     MOVE ER-2726                  TO  WS-ERROR.
  8284     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8285     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8286     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8287                                    PB-CI-LF-TERM
  8288                                    PB-C-LF-REM-TERM
  8289                                    PB-CI-AH-TERM
  8290                                    PB-C-AH-REM-TERM
  8291                                    PB-CI-LF-BENEFIT-CD
  8292                                    PB-CI-LF-BENEFIT-AMT
  8293                                    PB-CI-LF-ALT-BENEFIT-AMT
  8294                                    PB-CI-LF-PREMIUM-AMT
  8295                                    PB-CI-LF-ALT-PREMIUM-AMT
  8296                                    PB-CI-AH-BENEFIT-CD
  8297                                    PB-CI-AH-BENEFIT-AMT
  8298                                    PB-CI-AH-PREMIUM-AMT
  8299                                    PB-CI-PAY-FREQUENCY
  8300                                    PB-CI-LOAN-APR
  8301                                    PB-CI-LOAN-TERM
  8302                                    PB-CI-LIFE-COMMISSION
  8303                                    PB-CI-AH-COMMISSION
  8304                                    PB-CI-CURR-SEQ
  8305                                    PB-CI-AH-CANCEL-AMT
  8306                                    PB-CI-LF-CANCEL-AMT
  8307                                    PB-CI-RATE-DEV-PCT-LF
  8308                                    PB-CI-RATE-DEV-PCT-AH
  8309                                    PB-CI-EXTENTION-DAYS
  8310                                    PB-CI-TERM-IN-DAYS
  8311                                    PB-CI-LIVES
  8312                                    PB-CI-LF-CRIT-PER
  8313                                    PB-CI-AH-CRIT-PER
  8314                                    PB-CI-ADDL-CLP
  8315                                    PB-CI-DDF-IU-RATE-UP.
  8316
  8317     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8318                                    PB-CI-AH-SETTLEMENT-DT
  8319                                    PB-CI-DEATH-DT
  8320                                    PB-CI-LF-PRIOR-CANCEL-DT
  8321                                    PB-CI-AH-PRIOR-CANCEL-DT
  8322                                    PB-CI-ENTRY-DT
  8323                                    PB-CI-LF-EXPIRE-DT
  8324                                    PB-CI-AH-EXPIRE-DT
  8325                                    PB-CI-LOAN-1ST-PMT-DT.
  8326
  8327     IF ACCOUNT-MAST-FOUND
  8328        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8329        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8330
  8331     GO TO 3000-CONTINUE-EDIT.
  8332
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 153
* EL050.cbl
  8334
  8335 0300-CONTINUE-EDIT.
  8336
  8337     IF PB-ISSUE
  8338        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8339            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8340
  8341     IF PB-ISSUE
  8342        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8343            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8344
  8345     IF PB-ISSUE
  8346       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8347          (AM-NO-AH-ONLY)
  8348           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8349               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8350                   MOVE ER-2679 TO WS-ERROR
  8351                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8352
  8353     IF PB-ISSUE
  8354        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8355        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8356        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8357     ELSE
  8358        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8359        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8360        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8361
  8362     MOVE 'N'                    TO PLAN-MASTER-SW
  8363                                    PLAN-MASTER-LIFE-SW
  8364                                    FORM-MASTER-SW
  8365                                    WS-APP-CERT-SW.
  8366
  8367     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8368                                    WS-PL-TOL-LF-REFUND
  8369                                    WS-PL-REF-OVS-AMT
  8370                                    WS-PL-TOL-LF-PREM-PCT
  8371                                    WS-PL-TOL-LF-REFUND-PCT
  8372                                    WS-PL-REF-OVS-PCT
  8373                                    WS-PL-TOL-LF-CLAIM.
  8374
  8375     IF PB-COMPANY-ID = 'NCL'
  8376       IF PB-ISSUE
  8377         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8378             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8379             IF FORM-MASTER-FOUND
  8380                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8381
  8382     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8383        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8384
  8385********************** MON CODE **********************
  8386     IF PB-COMPANY-ID = 'MON'
  8387     IF PB-ISSUE
  8388     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8389        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8390             PB-I-LOAN-APR = ZERO)
  8391               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 154
* EL050.cbl
  8392******************************************************
  8393
  8394     IF PB-COMPANY-ID = 'NCL'
  8395       IF PB-ISSUE
  8396           IF FORM-MASTER-FOUND
  8397             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8398                AM-DISMBR-COVERAGE
  8399                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8400                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8401                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8402                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8403                                           PB-I-LIFE-BENEFIT-CD.
  8404
  8405     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8406
  8407     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8408         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8409         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8410         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8411         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8412         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8413           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8414             GO TO 0301-LIFE-BENEFIT-SEARCH
  8415         ELSE
  8416             NEXT SENTENCE
  8417     ELSE
  8418         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8419
  8420     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8421     MOVE '4'                    TO CNTL-REC-TYPE.
  8422     MOVE +0                     TO CNTL-SEQ-NO.
  8423     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8424
  8425     MOVE '1' TO RC-SW-2.
  8426     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8427
  8428     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8429        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8430         GO TO 0305-BENEFIT-NOT-FOUND.
  8431
  8432     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8433
  8434 0301-LIFE-BENEFIT-SEARCH.
  8435
  8436     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8437
  8438     IF NO-BENEFIT-FOUND
  8439        GO TO 0305-BENEFIT-NOT-FOUND.
  8440
  8441     IF WS-BEN-CD = '99'
  8442        GO TO 0305-BENEFIT-NOT-FOUND.
  8443
  8444     IF PB-COMPANY-ID = 'NCL'
  8445         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8446             GO TO 0304-LIFE-BENEFIT-FOUND.
  8447
  8448     MOVE +1                     TO SUB5.
  8449     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 155
* EL050.cbl
  8450
  8451* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8452* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8453     IF PB-COMPANY-ID = 'DMD'
  8454         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8455
  8456 0302-EDIT-ACCT-LF-BENEFITS.
  8457
  8458     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8459        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8460           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8461                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8462           GO TO 03XX-GET-LIFE-ERPLAN.
  8463
  8464     IF SUB5 LESS THAN +20
  8465        ADD +1                   TO SUB5
  8466        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8467
  8468     MOVE +1                     TO SUB5.
  8469
  8470     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8471        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8472
  8473 0303-EDIT-DMD-EXTRA-BENEFITS.
  8474
  8475     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8476        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8477           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8478                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8479           GO TO 03XX-GET-LIFE-ERPLAN.
  8480
  8481     IF SUB5 LESS THAN +30
  8482        ADD +1                   TO SUB5
  8483        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8484
  8485     MOVE +1                     TO SUB5.
  8486
  8487 03XX-EDIT-FOR-NINETY-LF.
  8488
  8489***************************************************************
  8490*                                                             *
  8491*    NINETY BENEFIT PLAN TYPES:                               *
  8492*                                                             *
  8493*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8494*      92 = ALL GROUP REDUCING BENEFITS                       *
  8495*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8496*      94 = ALL GROUP LEVEL BENEFITS                          *
  8497*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8498*           BENEFIT CONTROLS.                                 *
  8499*      99 = ALL BENEFITS                                      *
  8500*                                                             *
  8501***************************************************************
  8502
  8503     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8504                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8505
  8506     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8507       AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 156
* EL050.cbl
  8508        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8509        GO TO 03XX-GET-LIFE-ERPLAN.
  8510
  8511     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8512       AND
  8513        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8514        IF CF-REDUCING (SUB3)
  8515           IF (PB-I-INDV-GRP-OVRD = 'I')
  8516              OR
  8517           ((AM-IG = '1') AND
  8518           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8519              OR
  8520           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8521           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8522           (AM-IG NOT = '2'))
  8523              GO TO 03XX-GET-LIFE-ERPLAN.
  8524
  8525     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8526       AND
  8527        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8528        IF CF-REDUCING (SUB3)
  8529           IF (PB-I-INDV-GRP-OVRD = 'G')
  8530              OR
  8531           ((AM-IG = '2') AND
  8532           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8533              OR
  8534           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8535           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8536           (AM-IG NOT = '1'))
  8537              GO TO 03XX-GET-LIFE-ERPLAN.
  8538
  8539     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8540       AND
  8541        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8542        IF CF-LEVEL    (SUB3)
  8543           IF (PB-I-INDV-GRP-OVRD = 'I')
  8544              OR
  8545           ((AM-IG = '1') AND
  8546           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8547              OR
  8548           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8549           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8550            (AM-IG NOT = '2'))
  8551              GO TO 03XX-GET-LIFE-ERPLAN.
  8552
  8553     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8554       AND
  8555        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8556        IF CF-LEVEL    (SUB3)
  8557           IF (PB-I-INDV-GRP-OVRD = 'G')
  8558              OR
  8559           ((AM-IG = '2') AND
  8560           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8561              OR
  8562           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8563           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8564           (AM-IG NOT = '1'))
  8565              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 157
* EL050.cbl
  8566
  8567     IF SUB5 LESS THAN +20
  8568        ADD +1                   TO SUB5
  8569        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8570
  8571     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8572
  8573     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8574        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8575
  8576     MOVE +1                     TO SUB5.
  8577
  8578 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8579
  8580     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8581                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8582
  8583     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8584       AND
  8585        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8586        GO TO 03XX-GET-LIFE-ERPLAN.
  8587
  8588     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8589       AND
  8590        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8591        IF CF-REDUCING (SUB3)
  8592           IF (PB-I-INDV-GRP-OVRD = 'I')
  8593              OR
  8594           ((AM-IG = '1') AND
  8595           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8596              OR
  8597           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8598           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8599           (AM-IG NOT = '2'))
  8600              GO TO 03XX-GET-LIFE-ERPLAN.
  8601
  8602     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8603       AND
  8604        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8605        IF CF-REDUCING (SUB3)
  8606           IF (PB-I-INDV-GRP-OVRD = 'G')
  8607              OR
  8608           ((AM-IG = '2') AND
  8609           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8610              OR
  8611           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8612           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8613           (AM-IG NOT = '1'))
  8614              GO TO 03XX-GET-LIFE-ERPLAN.
  8615
  8616     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8617       AND
  8618        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8619        IF CF-LEVEL    (SUB3)
  8620           IF (PB-I-INDV-GRP-OVRD = 'I')
  8621              OR
  8622           ((AM-IG = '1') AND
  8623           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 158
* EL050.cbl
  8624              OR
  8625           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8626           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8627            (AM-IG NOT = '2'))
  8628              GO TO 03XX-GET-LIFE-ERPLAN.
  8629
  8630     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8631       AND
  8632        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8633        IF CF-LEVEL    (SUB3)
  8634           IF (PB-I-INDV-GRP-OVRD = 'G')
  8635              OR
  8636           ((AM-IG = '2') AND
  8637           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8638              OR
  8639           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8640           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8641           (AM-IG NOT = '1'))
  8642              GO TO 03XX-GET-LIFE-ERPLAN.
  8643
  8644     IF SUB5 LESS THAN +30
  8645        ADD +1                   TO SUB5
  8646        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8647
  8648     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8649
  8650 03XX-EDIT-FOR-NINETY-LF-CONT.
  8651
  8652     MOVE +99                    TO SUB5.
  8653
  8654     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8655        IF PB-ISSUE
  8656           MOVE ER-1924          TO  WS-ERROR
  8657           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8658
  8659     GO TO 0304-LIFE-BENEFIT-FOUND.
  8660
  8661 03XX-GET-LIFE-ERPLAN.
  8662
  8663     IF WK-PLAN-ADDR EQUAL +0
  8664        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8665
  8666     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8667     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8668     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8669     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8670     MOVE 'Y'                    TO PLAN-MASTER-SW
  8671                                    PLAN-MASTER-LIFE-SW.
  8672     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8673
  8674 03XX-ERPLAN-LIFE-GETMAIN.
  8675
  8676     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8677     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8678
  8679 03XX-ERPLAN-LIFE-READ.
  8680
  8681     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 159
* EL050.cbl
  8682     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8683     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8684     MOVE PB-SV-STATE            TO PLAN-STATE.
  8685     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8686     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8687     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8688     MOVE WS-SAVE-BENEFIT-REVISION
  8689                                 TO PLAN-REVISION-NO.
  8690
  8691     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8692     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8693
  8694     IF PB-COMPANY-ID = 'NCL'
  8695       IF NOT LF-PLAN-MASTER-FOUND
  8696         IF NOT PB-POLICY-IS-DECLINED  AND
  8697            NOT PB-POLICY-IS-VOIDED
  8698             MOVE  ER-1921         TO  WS-ERROR
  8699             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8700             GO TO 0304-LIFE-BENEFIT-FOUND.
  8701
  8702     IF NOT LF-PLAN-MASTER-FOUND
  8703        GO TO 0304-LIFE-BENEFIT-FOUND.
  8704
  8705 XXXX-CHECK-LF-PLAN-KEY.
  8706
  8707     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8708        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8709        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8710        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8711        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8712        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8713        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8714        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8715        MOVE 'N'                 TO PLAN-MASTER-SW
  8716          GO TO 03XX-ERPLAN-LIFE-READ.
  8717
  8718     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8719
  8720     IF  PB-CANCELLATION
  8721         GO TO  0303-LF-ACCT-BEN-FOUND.
  8722
  8723     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8724        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8725           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8726           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8727              MOVE ER-2644             TO WS-ERROR
  8728              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8729           ELSE
  8730              NEXT SENTENCE
  8731        ELSE
  8732           IF PB-COMPANY-ID NOT = 'NCL'
  8733              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8734                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8735
  8736 0303-LF-ACCT-BEN-FOUND.
  8737
  8738     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8739
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 160
* EL050.cbl
  8740     IF PL-DEV-CODE NOT = SPACES
  8741        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8742
  8743     IF PL-DEV-PCT NUMERIC AND
  8744        PL-DEV-PCT NOT = ZEROS
  8745        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8746
  8747     IF PL-TOL-PREM-AMT GREATER THAN +0
  8748        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8749
  8750     IF PL-TOL-REF-AMT GREATER THAN +0
  8751        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8752
  8753     IF PL-TOL-PREM-PCT GREATER THAN +0
  8754        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8755
  8756     IF PL-TOL-REF-PCT GREATER THAN +0
  8757        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8758
  8759     IF PL-TOL-CLM-AMT GREATER THAN +0
  8760        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8761
  8762     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8763                          PL-OVER-SHORT-AMT > +0
  8764        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8765
  8766     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8767                          PL-OVER-SHORT-PCT > +0
  8768        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8769
  8770     IF PL-SALES-TAX NUMERIC AND
  8771                          PL-SALES-TAX > +0
  8772         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8773
  8774     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8775        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8776                                    WS-IG-OVRD-AM.
  8777
  8778 0304-LIFE-BENEFIT-FOUND.
  8779
  8780     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8781
  8782     IF PB-ISSUE
  8783        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8784     ELSE
  8785        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8786
  8787     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8788     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8789     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8790     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8791     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8792                                         WS-LF-REFUND-CALC.
  8793
  8794     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8795        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8796
  8797     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 161
* EL050.cbl
  8798        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8799     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8800
  8801     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8802     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8803     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8804     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8805     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8806     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8807
  8808     IF PB-COMPANY-ID = 'NCL'  AND
  8809        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8810         NEXT SENTENCE
  8811     ELSE
  8812         IF SUB5 NOT GREATER THAN +20
  8813            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8814               MOVE WS-SAVE-BENEFIT-REM-TERM
  8815                                      TO WS-AM-LF-BENE-REM-TERM
  8816                                         EC-BR-LF-REM-TERM-CALC.
  8817
  8818     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8819     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8820
  8821     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8822
  8823 0305-BENEFIT-NOT-FOUND.
  8824
  8825     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8826     MOVE ER-2604                TO WS-ERROR.
  8827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8828
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 162
* EL050.cbl
  8830
  8831 0310-FIND-AH-BENEFIT-RECORD.
  8832
  8833     MOVE 'N'                    TO PLAN-MASTER-SW
  8834                                    PLAN-MASTER-AH-SW.
  8835
  8836     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8837                                    WS-PL-TOL-AH-REFUND
  8838                                    WS-AH-PL-REF-OVS-AMT
  8839                                    WS-PL-TOL-AH-PREM-PCT
  8840                                    WS-PL-TOL-AH-REFUND-PCT
  8841                                    WS-AH-PL-REF-OVS-PCT
  8842                                    WS-PL-TOL-AH-CLAIM.
  8843     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8844
  8845
  8846     if pb-issue
  8847        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8848           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8849        end-if
  8850        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8851           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8852           GO TO 0399-BENEFIT-NOT-FOUND
  8853        end-if
  8854     end-if
  8855
  8856     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8857        GO TO 0400-FIND-CARRIER.
  8858
  8859     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8860
  8861     IF WK-AH-BEN-ADDR NOT = ZEROS
  8862         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8863         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8864         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8865         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8866           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8867             GO TO 0311-AH-BENEFIT-SEARCH
  8868         ELSE
  8869             NEXT SENTENCE
  8870     ELSE
  8871         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8872
  8873     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8874     MOVE '5'                    TO CNTL-REC-TYPE.
  8875     MOVE +0                     TO CNTL-SEQ-NO.
  8876     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8877
  8878     MOVE '2' TO RC-SW-2.
  8879     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8880
  8881     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8882        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8883          GO TO 0399-BENEFIT-NOT-FOUND.
  8884
  8885     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8886
  8887 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 163
* EL050.cbl
  8888
  8889     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8890
  8891     IF NO-BENEFIT-FOUND
  8892         GO TO 0399-BENEFIT-NOT-FOUND.
  8893
  8894     IF WS-BEN-CD = '99'
  8895        GO TO 0399-BENEFIT-NOT-FOUND.
  8896
  8897     IF PB-COMPANY-ID  =  'NCL'
  8898         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8899             GO TO 0314-A-H-BENEFIT-FOUND.
  8900
  8901     MOVE +1                     TO SUB5.
  8902     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8903
  8904* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8905* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8906     IF PB-COMPANY-ID = 'DMD'
  8907         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8908
  8909 0312-EDIT-ACCT-AH-BENEFITS.
  8910
  8911     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8912        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8913           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8914                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8915           GO TO 03XX-GET-AH-ERPLAN.
  8916
  8917     IF SUB5 LESS THAN +20
  8918        ADD +1                   TO SUB5
  8919        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8920
  8921     MOVE +1                     TO SUB5.
  8922
  8923     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8924        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8925
  8926 0313-EDIT-DMD-EXTRA-BENEFITS.
  8927
  8928     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8929        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8930           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8931                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8932           GO TO 03XX-GET-AH-ERPLAN.
  8933
  8934     IF SUB5 LESS THAN +30
  8935        ADD +1                   TO SUB5
  8936        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8937
  8938     MOVE +1                     TO SUB5.
  8939
  8940 03XX-EDIT-FOR-NINETY-AH.
  8941
  8942***************************************************************
  8943*                                                             *
  8944*    NINETY BENEFIT PLAN TYPES:                               *
  8945*                                                             *
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 164
* EL050.cbl
  8946*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8947*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8948*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8949*           BENEFIT CONTROLS.                                 *
  8950*      99 = ALL BENEFITS.                                     *
  8951*                                                             *
  8952***************************************************************
  8953
  8954     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8955                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8956
  8957     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8958       AND
  8959        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8960        GO TO 03XX-GET-AH-ERPLAN.
  8961
  8962     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8963       AND
  8964        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8965           IF (PB-I-INDV-GRP-OVRD = 'I')
  8966              OR
  8967           ((AM-IG = '1') AND
  8968           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8969              OR
  8970           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8971           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8972           (AM-IG NOT = '2'))
  8973              GO TO 03XX-GET-AH-ERPLAN.
  8974
  8975     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8976       AND
  8977        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8978           IF (PB-I-INDV-GRP-OVRD = 'G')
  8979              OR
  8980           ((AM-IG = '2') AND
  8981           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8982              OR
  8983           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8984           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8985           (AM-IG NOT = '1'))
  8986              GO TO 03XX-GET-AH-ERPLAN.
  8987
  8988     IF SUB5 LESS THAN +20
  8989        ADD +1                   TO SUB5
  8990        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8991
  8992     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8993        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8994
  8995     MOVE +1                    TO SUB5.
  8996
  8997 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8998
  8999     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9000                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9001
  9002     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9003       AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 165
* EL050.cbl
  9004        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9005        GO TO 03XX-GET-AH-ERPLAN.
  9006
  9007     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9008       AND
  9009        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9010           IF (PB-I-INDV-GRP-OVRD = 'I')
  9011              OR
  9012           ((AM-IG = '1') AND
  9013           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9014              OR
  9015           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9016           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9017           (AM-IG NOT = '2'))
  9018              GO TO 03XX-GET-AH-ERPLAN.
  9019
  9020     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9021       AND
  9022        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9023           IF (PB-I-INDV-GRP-OVRD = 'G')
  9024              OR
  9025           ((AM-IG = '2') AND
  9026           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9027              OR
  9028           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9029           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9030           (AM-IG NOT = '1'))
  9031              GO TO 03XX-GET-AH-ERPLAN.
  9032
  9033     IF SUB5 LESS THAN +30
  9034        ADD +1                   TO SUB5
  9035        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9036
  9037 03XX-EDIT-FOR-NINETY-AH-CONT.
  9038
  9039     MOVE +99                    TO SUB5.
  9040
  9041     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9042
  9043     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9044        IF PB-ISSUE
  9045           MOVE ER-1925          TO  WS-ERROR
  9046           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9047
  9048     GO TO 0314-A-H-BENEFIT-FOUND.
  9049
  9050 03XX-GET-AH-ERPLAN.
  9051
  9052     IF WK-PLAN-ADDR EQUAL +0
  9053         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9054
  9055     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9056     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9057     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9058     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9059     MOVE 'Y'                    TO PLAN-MASTER-SW
  9060                                    PLAN-MASTER-AH-SW.
  9061*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 166
* EL050.cbl
  9062     GO TO 03XX-ERPLAN-AH-READ.
  9063
  9064 03XX-ERPLAN-AH-GETMAIN.
  9065
  9066     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9067     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9068
  9069 03XX-ERPLAN-AH-READ.
  9070
  9071     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9072     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9073     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9074     MOVE PB-SV-STATE            TO PLAN-STATE.
  9075     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9076     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9077     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9078     MOVE WS-SAVE-BENEFIT-REVISION
  9079                                 TO PLAN-REVISION-NO.
  9080
  9081     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9082     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9083
  9084     IF PB-COMPANY-ID = 'NCL'
  9085       IF NOT AH-PLAN-MASTER-FOUND
  9086         IF NOT PB-POLICY-IS-DECLINED  AND
  9087            NOT PB-POLICY-IS-VOIDED
  9088             MOVE  ER-1922         TO  WS-ERROR
  9089             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9090             GO TO 0314-A-H-BENEFIT-FOUND.
  9091
  9092     IF NOT AH-PLAN-MASTER-FOUND
  9093        GO TO 0314-A-H-BENEFIT-FOUND.
  9094
  9095 XXXX-CHECK-AH-PLAN-KEY.
  9096
  9097     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9098        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9099        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9100        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9101        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9102        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9103        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9104        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9105        MOVE 'N'                 TO PLAN-MASTER-SW
  9106          GO TO 03XX-ERPLAN-AH-READ.
  9107
  9108     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9109
  9110     IF  PB-CANCELLATION
  9111         GO TO  0313-AH-ACCT-BEN-FOUND.
  9112
  9113     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9114       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9115          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9116          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9117             MOVE ER-2644             TO WS-ERROR
  9118             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9119          ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 167
* EL050.cbl
  9120             NEXT SENTENCE
  9121       ELSE
  9122          IF PB-COMPANY-ID NOT = 'NCL'
  9123             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9124                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9125
  9126 0313-AH-ACCT-BEN-FOUND.
  9127
  9128     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9129
  9130     IF PL-DEV-CODE NOT = SPACES
  9131        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9132
  9133     IF PL-DEV-PCT NUMERIC AND
  9134        PL-DEV-PCT NOT = ZEROS
  9135        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9136
  9137     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9138        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9139
  9140     IF PL-TOL-REF-AMT NOT EQUAL +0
  9141        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9142
  9143     IF PL-TOL-PREM-PCT GREATER THAN +0
  9144        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9145
  9146     IF PL-TOL-REF-PCT GREATER THAN +0
  9147        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9148
  9149     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9150        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9151
  9152     IF PL-OVER-SHORT-AMT NUMERIC AND
  9153                          PL-OVER-SHORT-AMT > +0
  9154        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9155
  9156     IF PL-OVER-SHORT-PCT NUMERIC AND
  9157                          PL-OVER-SHORT-PCT > +0
  9158        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9159
  9160     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9161        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9162        IF WS-IG-OVRD-AM EQUAL SPACES
  9163            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9164
  9165 0314-A-H-BENEFIT-FOUND.
  9166
  9167     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9168
  9169     IF PB-ISSUE
  9170        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9171       ELSE
  9172        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9173
  9174     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9175     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9176     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9177     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 168
* EL050.cbl
  9178                                         WS-AH-REFUND-CALC.
  9179
  9180     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9181        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9182
  9183     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9184        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9185     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9186
  9187     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9188     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9189     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9190     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9191     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9192     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9193
  9194     IF PB-COMPANY-ID = 'NCL'  AND
  9195        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9196         NEXT SENTENCE
  9197     ELSE
  9198         IF SUB5 NOT GREATER THAN +20
  9199            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9200                MOVE WS-SAVE-BENEFIT-REM-TERM
  9201                                      TO WS-AM-AH-BENE-REM-TERM
  9202                                         EC-BR-AH-REM-TERM-CALC.
  9203
  9204     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9205     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9206
  9207     GO TO 0400-FIND-CARRIER.
  9208
  9209 0399-BENEFIT-NOT-FOUND.
  9210
  9211     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9212     MOVE ER-2605                TO WS-ERROR.
  9213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9214
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 169
* EL050.cbl
  9216
  9217 0400-FIND-CARRIER.
  9218
  9219     MOVE PB-SV-CARRIER          TO WS-CARR.
  9220
  9221     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9222     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9223     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9224     MOVE '6'                    TO CNTL-REC-TYPE.
  9225
  9226*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9227     MOVE SPACE                  TO WS-DMD-RATING-SW
  9228                                    EC-BR-DMD-RATING-SW.
  9229
  9230     MOVE '2'                    TO RC-SW-1.
  9231     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9232
  9233     IF NOT CF-CARRIER-MASTER
  9234        GO TO 0400-CARRIER-NOT-FOUND.
  9235
  9236 0400-BUILD-CARR-TOL.
  9237
  9238     IF CF-CR-TOL-PREM NUMERIC AND
  9239        CF-CR-TOL-PREM GREATER THAN +0
  9240        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9241                                    WS-TOL-AH-PREM.
  9242
  9243     IF CF-CR-TOL-REFUND NUMERIC AND
  9244        CF-CR-TOL-REFUND GREATER THAN +0
  9245        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9246                                    WS-TOL-AH-REFUND.
  9247
  9248     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9249        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9250        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9251                                    WS-AH-REFUND-OVS-AMT.
  9252
  9253     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9254        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9255        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9256                                    WS-AH-REFUND-OVS-PCT.
  9257
  9258     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9259        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9260        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9261                                    WS-TOL-AH-PREM-PCT.
  9262
  9263     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9264        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9265        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9266                                     WS-TOL-AH-REFUND-PCT.
  9267
  9268     IF CF-COMPANY-ID EQUAL 'DMD'
  9269         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9270                                    EC-BR-DMD-RATING-SW.
  9271
  9272     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9273     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 170
* EL050.cbl
  9274        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9275     END-IF
  9276     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9277        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9278     END-IF
  9279     IF WS-TOL-CLP-PCT = ZEROS
  9280        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9281     END-IF
  9282
  9283     IF WS-SPP-LEASE-COMM = ZEROS
  9284        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9285     END-IF
  9286     GO TO 0400-FIND-ERPDEF.
  9287
  9288 0400-CARRIER-NOT-FOUND.
  9289
  9290     MOVE ER-2602                TO WS-ERROR.
  9291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9292
  9293 0400-FIND-ERPDEF.
  9294     IF PB-COMPANY-ID = 'DCC'
  9295        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9296        CONTINUE
  9297     ELSE
  9298        GO TO 0400-FIND-ERCOMP
  9299     END-IF
  9300     MOVE ' '                    TO PDEF-MASTER-SW
  9301     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9302     MOVE PB-STATE               TO ERPDEF-STATE
  9303     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9304     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9305     IF PB-ISSUE
  9306        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9307     ELSE
  9308        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9309     END-IF
  9310     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9311     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9312     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9313     IF PDEF-MASTER-FOUND
  9314        MOVE 'N'                 TO PDEF-MASTER-SW
  9315        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9316        IF PDEF-MASTER-FOUND
  9317           IF (ERPDEF-KEY-SAVE (1:16) =
  9318                        PD-CONTROL-PRIMARY (1:16))
  9319              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9320              CONTINUE
  9321           ELSE
  9322              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9323              IF (ERPDEF-KEY-SAVE (1:16) =
  9324                        PD-CONTROL-PRIMARY (1:16))
  9325                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9326                 CONTINUE
  9327              ELSE
  9328                 MOVE 'N'        TO PDEF-MASTER-SW
  9329              END-IF
  9330           END-IF
  9331        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 171
* EL050.cbl
  9332        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9333     END-IF
  9334     IF PDEF-MASTER-FOUND
  9335        IF PD-TRUNCATED = 'Y'
  9336           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9337        END-IF
  9338     END-IF
  9339     .
  9340 0400-FIND-ERCOMP.
  9341     IF PB-COMPANY-ID = 'DCC'
  9342        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9343           (WS-SUB1 > +10)
  9344           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9345                 OR 'A' OR 'N'
  9346              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9347              MOVE PB-CARRIER    TO COMP-CARRIER
  9348              MOVE PB-GROUPING   TO COMP-GROUPING
  9349              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9350              MOVE AM-AGT (WS-SUB1)
  9351                                 TO COMP-FIN-RESP
  9352              MOVE 'G'           TO COMP-TYPE
  9353              PERFORM 8582-READ-COMPENSATION-MASTER
  9354                                 THRU 8582-EXIT
  9355              IF COMP-MASTER-FOUND
  9356                 IF CO-GA-INACTIVE
  9357                    MOVE ER-2763 TO WS-ERROR
  9358                    PERFORM 9900-ERROR-FORMAT
  9359                                 THRU 9900-EXIT
  9360                    MOVE +11     TO WS-SUB1
  9361                 END-IF
  9362                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9363                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9364                    MOVE ER-2788 TO WS-ERROR
  9365                    PERFORM 9900-ERROR-FORMAT
  9366                                 THRU 9900-EXIT
  9367                    MOVE +11     TO WS-SUB1
  9368                 END-IF
  9369              END-IF
  9370           END-IF
  9371        END-PERFORM
  9372     END-IF
  9373     IF PB-COMPANY-ID = 'DCC'
  9374        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9375           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9376                                    WS-CLP-STATE
  9377        ELSE
  9378           MOVE SPACES           TO PB-I-CLP-STATE
  9379                                    WS-CLP-STATE
  9380        END-IF
  9381     END-IF
  9382
  9383     IF (PB-COMPANY-ID = 'DCC')
  9384        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9385        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9386        CONTINUE
  9387     ELSE
  9388        GO TO 0400-FIND-STATE-RECORD
  9389     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 172
* EL050.cbl
  9390     MOVE SPACES                 TO WS-CLP-STATE
  9391     MOVE +0                     TO WS-BANK-FEE
  9392                                    WS-BANK-LFEE
  9393                                    WS-BANK-NOCHRGB
  9394
  9395     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9396     IF (PB-ISSUE)
  9397        AND (PB-I-BANK-NUMBER NOT =
  9398            SPACES AND ZEROS AND LOW-VALUES)
  9399        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9400     ELSE
  9401        IF (PB-CANCELLATION)
  9402           AND (PB-CI-BANK-NUMBER NOT =
  9403                SPACES AND ZEROS AND LOW-VALUES)
  9404           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9405        END-IF
  9406     END-IF
  9407     IF COMP-FIN-RESP NOT = LOW-VALUES
  9408        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9409        MOVE PB-CARRIER          TO COMP-CARRIER
  9410        MOVE PB-GROUPING         TO COMP-GROUPING
  9411        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9412        MOVE 'B'                 TO COMP-TYPE
  9413        PERFORM 8582-READ-COMPENSATION-MASTER
  9414                                 THRU 8582-EXIT
  9415        IF COMP-MASTER-FOUND
  9416           IF CO-MAX-BANK-FEE NOT NUMERIC
  9417              MOVE +0            TO CO-MAX-BANK-FEE
  9418           END-IF
  9419           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9420              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9421           END-IF
  9422           IF CO-GA-INACTIVE
  9423              MOVE ER-2763       TO WS-ERROR
  9424              PERFORM 9900-ERROR-FORMAT
  9425                                 THRU 9900-EXIT
  9426           END-IF
  9427           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9428              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9429              MOVE ER-2788 TO WS-ERROR
  9430              PERFORM 9900-ERROR-FORMAT
  9431                                 THRU 9900-EXIT
  9432              MOVE +11     TO WS-SUB1
  9433           END-IF
  9434           IF WS-AH-BEN-CATEGORY = 'G'
  9435              MOVE CO-MAX-BANK-FEE
  9436                                 TO WS-BANK-FEE
  9437                                    PB-I-BANK-FEE
  9438           ELSE
  9439              MOVE CO-MAX-BANK-FEE-LEASE
  9440                                 TO WS-BANK-LFEE
  9441                                    PB-I-BANK-FEE
  9442           END-IF
  9443           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9444              AND (WS-AH-REFUND-CALC = 'G'))
  9445                        OR
  9446              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9447              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 173
* EL050.cbl
  9448              CONTINUE
  9449           ELSE
  9450              MOVE ER-2789 TO WS-ERROR
  9451              PERFORM 9900-ERROR-FORMAT
  9452                                 THRU 9900-EXIT
  9453           END-IF
  9454           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9455                                    PB-I-CLP-STATE
  9456           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9457           MOVE CO-CARRIER       TO BXRF-CARRIER
  9458           MOVE CO-GROUPING      TO BXRF-GROUPING
  9459           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9460           MOVE BXRF-MAX-REC-LENGTH
  9461                                 TO BXRF-REC-LENGTH
  9462           PERFORM 8584-READ-BANK-CROSS-REF
  9463                                 THRU 8584-EXIT
  9464           IF BXRF-MASTER-FOUND
  9465              MOVE ' '           TO BANK-ACCT-SW
  9466              MOVE BK-BANK-POINTER-CNT
  9467                                 TO BK-BANK-POINTER-CNT
  9468              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9469                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9470                 OR (BANK-ACCT-FOUND)
  9471                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9472                    AND (BK-AM-EXP-DT (WS-SUB1)
  9473                                 > PB-CERT-EFF-DT)
  9474                    AND (BK-AM-EFF-DT (WS-SUB1)
  9475                                 NOT > PB-CERT-EFF-DT)
  9476                    SET BANK-ACCT-FOUND TO TRUE
  9477                 END-IF
  9478              END-PERFORM
  9479              IF NOT BANK-ACCT-FOUND
  9480                 MOVE ZEROS      TO WS-BANK-FEE
  9481                                    WS-BANK-LFEE
  9482                 MOVE ER-2869    TO WS-ERROR
  9483                 PERFORM 9900-ERROR-FORMAT
  9484                                 THRU 9900-EXIT
  9485              ELSE
  9486                 PERFORM 5000-PROCESS-REPS
  9487                                 THRU 5000-EXIT
  9488                 IF AGENT-MASTER-FOUND
  9489                    MOVE +0      TO WS-BANK-FEE
  9490                                    WS-BANK-LFEE
  9491*                   MOVE AG-SPP-FEES (1)
  9492*                                TO PB-I-BANK-FEE
  9493*                                   WS-BANK-FEE
  9494                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9495                       (WS-SUB1 > +10)
  9496                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9497                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9498                       END-IF
  9499                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9500                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9501                       END-IF
  9502                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9503                          AG-SPP-FEES (WS-SUB1)
  9504                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9505                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 174
* EL050.cbl
  9506                    END-PERFORM
  9507                    IF WS-AH-BEN-CATEGORY = 'G'
  9508                       MOVE WS-BANK-FEE
  9509                                 TO PB-I-BANK-FEE
  9510                    ELSE
  9511                       MOVE WS-BANK-LFEE
  9512                                 TO PB-I-BANK-FEE
  9513                    END-IF
  9514                 END-IF
  9515              END-IF
  9516           END-IF
  9517        ELSE
  9518           MOVE ER-2879          TO WS-ERROR
  9519           PERFORM 9900-ERROR-FORMAT
  9520                                 THRU 9900-EXIT
  9521        END-IF
  9522     ELSE
  9523        MOVE ER-2879             TO WS-ERROR
  9524        PERFORM 9900-ERROR-FORMAT
  9525                                 THRU 9900-EXIT
  9526     END-IF
  9527     IF WS-AH-BEN-CATEGORY = 'G'
  9528        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9529        + WS-BANK-FEE
  9530     ELSE
  9531        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9532        + WS-BANK-LFEE
  9533     END-IF
  9534     .
  9535 0400-FIND-STATE-RECORD.
  9536
  9537     IF WK-STATE-ADDR NOT = ZEROS
  9538         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9539         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9540         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9541         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9542         IF PB-SV-STATE = CF-STATE-CODE
  9543             GO TO 0405-CONTINUE-EDIT
  9544         ELSE
  9545             NEXT SENTENCE
  9546     ELSE
  9547         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9548
  9549     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9550     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9551     MOVE '3'                    TO CNTL-REC-TYPE.
  9552     MOVE +0                     TO CNTL-SEQ-NO.
  9553
  9554     MOVE '3'                    TO RC-SW-2.
  9555     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9556
  9557     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9558        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9559        PB-SV-STATE   NOT = CF-STATE-CODE)
  9560        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9561                                    WS-TOL-AH-CLAIM
  9562                                    WS-MINIMUM-REFUND
  9563                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 175
* EL050.cbl
  9564                                    WS-TOL-AH-PREM
  9565                                    WS-TOL-LF-REFUND
  9566                                    WS-TOL-AH-REFUND
  9567                                    EC-ST-TOL-PREM-PCT
  9568                                    WS-TOL-LF-PREM-PCT
  9569                                    WS-TOL-AH-PREM-PCT
  9570                                    EC-ST-TOL-REFUND-PCT
  9571                                    WS-TOL-LF-REFUND-PCT
  9572                                    WS-TOL-AH-REFUND-PCT
  9573                                    EC-ST-TOL-PREM
  9574                                    EC-ST-TOL-REFUND
  9575                                    EC-ST-FST-PMT-DAYS-MAX
  9576                                    WS-FREE-LOOK-PERIOD
  9577                                    WS-ST-LF-PREM-TAX
  9578                                    WS-ST-AH-PREM-TAX-I
  9579                                    WS-ST-AH-PREM-TAX-G
  9580                                    WS-BANK-FEE
  9581                                    WS-BANK-LFEE
  9582                                    WS-TOL-CLP-PCT
  9583                                    WS-SPP-LEASE-COMM
  9584        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9585                                    EC-ST-FST-PMT-DAYS-CHG
  9586                                    WS-LF-REM-TERM-CALC
  9587                                    WS-LF-REFUND-CALC
  9588                                    EC-ST-LF-REM-TERM-CALC
  9589                                    EC-ST-LF-REFUND-CALC
  9590                                    WS-AH-REM-TERM-CALC
  9591                                    WS-AH-REFUND-CALC
  9592                                    WS-LF-BEN-CATEGORY
  9593                                    WS-AH-BEN-CATEGORY
  9594                                    WS-CLP-STATE
  9595                                    WS-ST-REFUND-CLAIM-FLAG
  9596                                    EC-ST-AH-REM-TERM-CALC
  9597                                    EC-ST-AH-REFUND-CALC
  9598          GO TO 0499-STATE-NOT-FOUND.
  9599
  9600     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9601
  9602 0405-CONTINUE-EDIT.
  9603
  9604     if pb-company-id = 'AHL'
  9605        continue
  9606     else
  9607        IF PB-CERT-PRIME NOT NUMERIC
  9608           MOVE ER-2722          TO WS-ERROR
  9609           PERFORM 9900-ERROR-FORMAT
  9610                                 THRU 9900-EXIT
  9611        end-if
  9612     END-IF
  9613*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9614*       MOVE +0                  TO SUB3
  9615*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9616*       IF SUB3 > +0
  9617*          MOVE ER-2722          TO WS-ERROR
  9618*          PERFORM 9900-ERROR-FORMAT
  9619*                                THRU 9900-EXIT
  9620*       END-IF
  9621*    END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 176
* EL050.cbl
  9622*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9623*       IF PB-CERT-PRIME NOT NUMERIC
  9624*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9625*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9626*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9627*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9628*
  9629*          MOVE ER-2722          TO WS-ERROR
  9630*          PERFORM 9900-ERROR-FORMAT
  9631*                                THRU 9900-EXIT
  9632*       END-IF
  9633*    END-IF
  9634
  9635     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9636
  9637     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9638        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9639                                    WS-TOL-AH-CLAIM.
  9640
  9641     IF CF-ST-REFUND-MIN NOT NUMERIC
  9642        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9643
  9644     IF CF-ST-REFUND-MIN NOT = ZEROS
  9645        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9646
  9647     IF CF-ST-TOL-PREM  NOT = ZEROS
  9648        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9649                                    WS-TOL-AH-PREM
  9650        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9651
  9652     IF CF-ST-TOL-REFUND NOT = ZEROS
  9653        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9654                                    WS-TOL-AH-REFUND
  9655        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9656
  9657     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9658        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9659        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9660                                    WS-AH-REFUND-OVS-AMT
  9661                                    EC-ST-OVR-SHT-AMT.
  9662
  9663     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9664        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9665        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9666                                    WS-TOL-LF-PREM-PCT
  9667                                    WS-TOL-AH-PREM-PCT.
  9668
  9669     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9670        CF-ST-TOL-REF-PCT GREATER THAN +0
  9671        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9672                                    WS-TOL-LF-REFUND-PCT
  9673                                    WS-TOL-AH-REFUND-PCT.
  9674
  9675     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9676        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9677        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9678                                    WS-AH-REFUND-OVS-PCT
  9679                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 177
* EL050.cbl
  9680
  9681     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9682     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9683
  9684     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9685          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9686
  9687     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9688     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9689     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9690
  9691     IF CF-ST-LF-PREM-TAX NUMERIC
  9692        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9693     END-IF
  9694     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9695        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9696     END-IF
  9697     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9698        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9699     END-IF
  9700
  9701     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9702         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9703     END-IF.
  9704
  9705     IF WS-LF-BENEFIT-CD = ZEROS
  9706        GO TO 0410-CHECK-AH.
  9707
  9708     IF CF-ST-RT-CALC NOT = SPACES
  9709        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9710                                    EC-ST-LF-REM-TERM-CALC
  9711     END-IF
  9712
  9713     IF WS-LF-COVERAGE-TYPE = 'R'
  9714        IF WS-LF-EARNINGS-CALC = '5'
  9715           IF CF-ST-RF-LN-CALC > '0'
  9716              MOVE CF-ST-RF-LN-CALC
  9717                                 TO WS-LF-REFUND-CALC
  9718                                    EC-ST-LF-REFUND-CALC
  9719           END-IF
  9720        ELSE
  9721           IF CF-ST-RF-LR-CALC > '0'
  9722              MOVE CF-ST-RF-LR-CALC
  9723                                 TO WS-LF-REFUND-CALC
  9724                                    EC-ST-LF-REFUND-CALC
  9725           END-IF
  9726        END-IF
  9727     ELSE
  9728        IF CF-ST-RF-LL-CALC > '0'
  9729           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9730                                    EC-ST-LF-REFUND-CALC
  9731        END-IF
  9732     END-IF
  9733
  9734     IF CF-ST-RT-CALC NOT = SPACES
  9735        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9736                                    EC-ST-LF-REM-TERM-CALC
  9737     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 178
* EL050.cbl
  9738
  9739     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9740     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9741
  9742     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9743
  9744     IF NO-BENEFIT-FOUND
  9745        GO TO 0410-CHECK-AH.
  9746
  9747     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9748        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9749                                 TO EC-ST-LF-REM-TERM-CALC
  9750                                    WS-LF-REM-TERM-CALC
  9751     END-IF
  9752
  9753     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9754        MOVE CF-ST-REFUND-CALC (SUB3)
  9755                                 TO WS-LF-REFUND-CALC
  9756                                    EC-ST-LF-REFUND-CALC
  9757     END-IF
  9758*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9759
  9760     .
  9761 0410-CHECK-AH.
  9762
  9763     IF WS-AH-BENEFIT-CD = ZEROS
  9764        GO TO 0500-SET-ACCOUNT.
  9765
  9766     IF CF-ST-RT-CALC NOT = SPACES
  9767        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9768                                    EC-ST-AH-REM-TERM-CALC
  9769     END-IF
  9770
  9771     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9772        IF CF-ST-RF-CP-CALC > '0'
  9773           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9774                                    EC-ST-AH-REFUND-CALC
  9775        END-IF
  9776     ELSE
  9777        IF CF-ST-RF-AH-CALC > '0'
  9778           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9779                                    EC-ST-AH-REFUND-CALC
  9780        END-IF
  9781     END-IF
  9782     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9783     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9784
  9785     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9786
  9787     IF NO-BENEFIT-FOUND
  9788        GO TO 0500-SET-ACCOUNT.
  9789
  9790     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9791        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9792                                 TO WS-AH-REM-TERM-CALC
  9793                                    EC-ST-AH-REM-TERM-CALC
  9794     END-IF
  9795
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 179
* EL050.cbl
  9796     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9797        MOVE CF-ST-REFUND-CALC (SUB3)
  9798                                 TO WS-AH-REFUND-CALC
  9799                                    EC-ST-AH-REFUND-CALC
  9800     END-IF
  9801
  9802*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9803
  9804     GO TO 0500-SET-ACCOUNT.
  9805
  9806 0499-STATE-NOT-FOUND.
  9807
  9808     MOVE ER-2603                TO WS-ERROR.
  9809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9810
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 180
* EL050.cbl
  9812
  9813 0500-SET-ACCOUNT.
  9814*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9815     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9816        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9817        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9818        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9819        MOVE '3'                 TO CNTL-REC-TYPE
  9820        MOVE +0                  TO CNTL-SEQ-NO
  9821
  9822        MOVE '3'                 TO RC-SW-2
  9823        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9824
  9825        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9826           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9827           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9828           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9829                                    WS-ST-AH-PREM-TAX-I
  9830                                    WS-ST-AH-PREM-TAX-G
  9831        ELSE
  9832           IF CF-ST-LF-PREM-TAX NUMERIC
  9833              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9834           END-IF
  9835           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9836              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9837           END-IF
  9838           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9839              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9840           END-IF
  9841        END-IF
  9842        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9843     END-IF
  9844*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9845*  FOR DCC ONLY
  9846     IF PB-COMPANY-ID = 'DCC'
  9847
  9848     MOVE ' '                    TO STAT-MASTER-SW
  9849     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9850     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9851     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9852     MOVE PB-STATE               TO ELSTAT-STATE
  9853     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9854        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9855     END-IF
  9856
  9857     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9858     SET BIN-TO-GREG             TO TRUE
  9859     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9860     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9861     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9862
  9863     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9864     IF STAT-MASTER-FOUND
  9865        MOVE 'N'                 TO STAT-MASTER-SW
  9866        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9867        IF STAT-MASTER-FOUND
  9868           IF (ELSTAT-KEY-SAVE (1:12) =
  9869                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 181
* EL050.cbl
  9870              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9871                 MOVE 'F'        TO STAT-MASTER-SW
  9872              ELSE
  9873                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9874                 IF (STAT-MASTER-FOUND)
  9875                    AND (ELSTAT-KEY-SAVE (1:12) =
  9876                        SF-CONTROL-PRIMARY (1:12))
  9877                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9878                    MOVE 'F'     TO STAT-MASTER-SW
  9879                 END-IF
  9880              END-IF
  9881           END-IF
  9882        END-IF
  9883     END-IF
  9884
  9885     IF STAT-MASTER-SW = 'F'
  9886        IF SF-ST-LF-PREM-TAX NUMERIC
  9887           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9888        END-IF
  9889        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9890           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9891        END-IF
  9892        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9893           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9894        END-IF
  9895     END-IF
  9896
  9897     END-IF
  9898     IF (PB-COMPANY-ID = 'DCC')
  9899        AND (PB-ISSUE)
  9900        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9901        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9902        AND (AM-GPCD = 06)
  9903        MOVE 'Y'                 TO WS-GOOD-HIN
  9904        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9905           MOVE PB-I-VIN         TO WS-WORK-VIN
  9906           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9907              (V1 > 16)
  9908              IF WS-WORK-VIN (V1:1) NUMERIC
  9909                 MOVE WS-WORK-VIN-N (V1)
  9910                                 TO WS-ROW-B-VAL (V1)
  9911              ELSE
  9912                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9913                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9914                    OR (V2 > 26)
  9915                 END-PERFORM
  9916                 IF V2 < 27
  9917                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9918                 ELSE
  9919                    MOVE 'N'     TO WS-GOOD-HIN
  9920                 END-IF
  9921              END-IF
  9922              COMPUTE WS-ROW-D-VAL (V1) =
  9923                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9924              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9925                 WS-ROW-D-VAL (V1)
  9926           END-PERFORM
  9927           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 182
* EL050.cbl
  9928           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9929             REMAINDER WS-VIN-REMAINDER
  9930           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9931              CONTINUE
  9932           ELSE
  9933              MOVE 'N'           TO WS-GOOD-HIN
  9934           END-IF
  9935        ELSE
  9936           MOVE 'N'              TO WS-GOOD-HIN
  9937        END-IF
  9938        IF WS-GOOD-HIN NOT = 'Y'
  9939           MOVE ER-3826           TO WS-ERROR
  9940           PERFORM 9900-ERROR-FORMAT
  9941                                 THRU 9900-EXIT
  9942        END-IF
  9943     END-IF
  9944     IF (PB-COMPANY-ID = 'DCC')
  9945        AND (PB-ISSUE)
  9946        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9947        AND (AM-GPCD NOT = 06)
  9948        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9949          MOVE PB-I-VIN          TO WS-WORK-VIN
  9950          MOVE +8                TO V2
  9951          MOVE ZEROS             TO WS-VIN-TOTAL
  9952          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9953           (V1 > 17)
  9954             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9955                MOVE ER-3825     TO WS-ERROR
  9956                PERFORM 9900-ERROR-FORMAT
  9957                                 THRU 9900-EXIT
  9958             ELSE
  9959                IF V1 = 8
  9960                   MOVE 10       TO V2
  9961                END-IF
  9962                IF V1 = 9
  9963                   MOVE 0        TO V2
  9964                END-IF
  9965                IF V1 = 10
  9966                   MOVE 9        TO V2
  9967                END-IF
  9968                IF WS-WORK-VIN (V1:1) NUMERIC
  9969                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9970                    + (WS-WORK-VIN-N (V1) * V2)
  9971                ELSE
  9972                   MOVE WS-WORK-VIN (V1:1)
  9973                                 TO WS-HEX-BYTE
  9974                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9975                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9976                    + (WS-NUM (V3) * V2)
  9977                END-IF
  9978                COMPUTE V2 = V2 - 1
  9979             END-IF
  9980          END-PERFORM
  9981          MOVE ZEROS TO WS-VIN-REMAINDER
  9982          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9983             REMAINDER WS-VIN-REMAINDER
  9984          IF ((WS-WORK-VIN (9:1) = 'X')
  9985             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 183
* EL050.cbl
  9986                     OR
  9987             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9988             CONTINUE
  9989          ELSE
  9990             MOVE ER-3826        TO WS-ERROR
  9991             PERFORM 9900-ERROR-FORMAT
  9992                                 THRU 9900-EXIT
  9993          END-IF
  9994        ELSE
  9995          MOVE ER-3826           TO WS-ERROR
  9996          PERFORM 9900-ERROR-FORMAT
  9997                                 THRU 9900-EXIT
  9998        END-IF
  9999     END-IF
 10000******************************************************************
 10001******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10002******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10003******* METHODS.
 10004******************************************************************
 10005     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10006        IF PB-CANCELLATION
 10007           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10008              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10009                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10010                IF FORM-MASTER-FOUND
 10011                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10012******************************************************************
 10013
 10014     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10015     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10016
 10017     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10018     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10019     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10020     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10021
 10022
 10023     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10024     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10025     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10026
 10027     IF AM-LF-OB-RATE NOT NUMERIC
 10028         MOVE ZERO               TO AM-LF-OB-RATE.
 10029
 10030     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10031         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10032
 10033     IF AM-AH-OB-RATE NOT NUMERIC
 10034         MOVE ZERO               TO AM-AH-OB-RATE.
 10035
 10036     IF WS-LF-JOINT-INDICATOR = 'J'
 10037         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10038     ELSE
 10039         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10040
 10041     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10042
 10043     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 184
* EL050.cbl
 10044         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10045
 10046     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10047         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10048                                       WS-IG-OVRD
 10049     ELSE
 10050         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10051             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10052                                       WS-IG-OVRD
 10053         ELSE
 10054             MOVE AM-IG             TO WS-IG-OVRD-AH
 10055                                       WS-IG-OVRD.
 10056
 10057     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10058         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10059                                       WS-IG-OVRD
 10060     ELSE
 10061         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10062             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10063                                       WS-IG-OVRD
 10064         ELSE
 10065             MOVE AM-IG             TO WS-IG-OVRD-LF
 10066                                       WS-IG-OVRD.
 10067
 10068     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10069     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10070     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10071     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10072     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10073
 10074     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10075     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10076     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10077     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10078
 10079     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10080     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10081     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10082     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10083     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10084     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10085     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10086
 10087     IF WS-ACCT-AH-DEV-PCT > +0
 10088        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10089     ELSE
 10090        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10091
 10092     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10093        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10094     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10095        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10096
 10097        IF AM-EARN-METHOD-L = 'S'
 10098            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10099                                        WS-LF-REFUND-CALC.
 10100
 10101        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 185
* EL050.cbl
 10102            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10103                                        WS-LF-REFUND-CALC.
 10104
 10105     IF WS-LF-COVERAGE-TYPE = 'R'
 10106         IF AM-EARN-METHOD-R = 'R'
 10107            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10108                                    WS-LF-REFUND-CALC.
 10109     IF WS-LF-COVERAGE-TYPE = 'R'
 10110         IF AM-EARN-METHOD-R = 'P'
 10111            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10112                                    WS-LF-REFUND-CALC.
 10113     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10114         IF AM-EARN-METHOD-L = 'R'
 10115            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10116                                    WS-LF-REFUND-CALC.
 10117     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10118         IF AM-EARN-METHOD-L = 'P'
 10119            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10120                                    WS-LF-REFUND-CALC.
 10121     IF WS-LF-COVERAGE-TYPE = 'R'
 10122         IF AM-EARN-METHOD-R = 'A'
 10123            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10124                                    WS-LF-REFUND-CALC.
 10125     IF WS-LF-COVERAGE-TYPE = 'R'
 10126         IF AM-EARN-METHOD-R = 'M'
 10127            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10128                                    WS-LF-REFUND-CALC.
 10129     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10130         IF AM-EARN-METHOD-L = 'A'
 10131            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10132                                    WS-LF-REFUND-CALC.
 10133     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10134         IF AM-EARN-METHOD-L = 'M'
 10135            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10136                                    WS-LF-REFUND-CALC.
 10137
 10138     IF AM-EARN-METHOD-A = 'R'
 10139        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10140                                    WS-AH-REFUND-CALC.
 10141     IF AM-EARN-METHOD-A = 'P'
 10142        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10143                                    WS-AH-REFUND-CALC.
 10144     IF AM-EARN-METHOD-A = 'C'
 10145        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10146                                    WS-AH-REFUND-CALC.
 10147     IF AM-EARN-METHOD-A = 'A'
 10148        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10149                                    WS-AH-REFUND-CALC.
 10150     IF AM-EARN-METHOD-A = 'M'
 10151        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10152                                    WS-AH-REFUND-CALC.
 10153     IF AM-EARN-METHOD-A = 'N'
 10154        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10155                                    WS-AH-REFUND-CALC.
 10156     IF AM-EARN-METHOD-A = 'S'
 10157        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10158                                    WS-AH-REFUND-CALC.
 10159
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 186
* EL050.cbl
 10160     IF AM-TOL-PREM NOT = ZEROS
 10161        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10162                                    WS-TOL-AH-PREM.
 10163
 10164     IF AM-OVR-SHT-AMT NUMERIC AND
 10165                  AM-OVR-SHT-AMT > 0
 10166        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10167                                    EC-AM-LF-OVR-SHT-AMT
 10168                                    WS-AH-REFUND-OVS-AMT
 10169                                    EC-AM-AH-OVR-SHT-AMT.
 10170
 10171     IF AM-OVR-SHT-PCT NUMERIC AND
 10172                    AM-OVR-SHT-PCT > 0
 10173        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10174                                    EC-AM-LF-OVR-SHT-PCT
 10175                                    WS-AH-REFUND-OVS-PCT
 10176                                    EC-AM-AH-OVR-SHT-PCT.
 10177
 10178     IF AM-TOL-REF-PCT NUMERIC AND
 10179                  AM-TOL-REF-PCT > 0
 10180        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10181                                    WS-TOL-AH-REFUND-PCT.
 10182
 10183     IF AM-TOL-REF  NOT = ZEROS  AND
 10184                  AM-TOL-REF NUMERIC
 10185        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10186                                    EC-AM-LF-TOL-REFUND
 10187                                    WS-TOL-AH-REFUND
 10188                                    EC-AM-AH-TOL-REFUND.
 10189
 10190     IF AM-TOL-CLM  NOT = ZEROS
 10191        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10192                                    WS-TOL-AH-CLAIM.
 10193
 10194     IF AM-CLP-TOL-PCT NOT NUMERIC
 10195        MOVE +0                  TO AM-CLP-TOL-PCT
 10196     END-IF
 10197
 10198     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10199        MOVE +0                  TO AM-SPP-LEASE-COMM
 10200     END-IF
 10201     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10202        MOVE WS-PL-TOL-LF-PREM-PCT
 10203                                 TO WS-TOL-LF-PREM-PCT.
 10204
 10205     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10206        MOVE WS-PL-TOL-AH-PREM-PCT
 10207                                 TO WS-TOL-AH-PREM-PCT.
 10208
 10209     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10210        MOVE WS-PL-TOL-LF-REFUND-PCT
 10211                                 TO WS-TOL-LF-REFUND-PCT.
 10212
 10213     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10214        MOVE WS-PL-TOL-AH-REFUND-PCT
 10215                                 TO WS-TOL-AH-REFUND-PCT.
 10216
 10217     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 187
* EL050.cbl
 10218        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10219
 10220     IF WS-PL-REF-OVS-PCT > +0
 10221        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10222
 10223     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10224        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10225     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10226        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10227     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10228        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10229     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10230        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10231     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10232        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10233     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10234        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10235
 10236     IF WS-AH-PL-REF-OVS-AMT > +0
 10237        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10238
 10239     IF WS-AH-PL-REF-OVS-PCT > +0
 10240        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10241
 10242     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10243     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10244
 10245     IF PB-CANCELLATION
 10246        GO TO 3000-CONTINUE-EDIT.
 10247
 10248     MOVE +1 TO SUB1.
 10249     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10250     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10251
 10252     IF CF-COMPANY-ID = 'DMD'
 10253       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10254         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10255        ELSE
 10256         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10257
 10258  0525-FIND-ACCT-COMM.
 10259     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10260        NEXT SENTENCE
 10261      ELSE
 10262         ADD +1 TO SUB1
 10263         IF SUB1 LESS +11
 10264            GO TO 0525-FIND-ACCT-COMM
 10265          ELSE
 10266             GO TO 0560-EDIT-CONTINUE.
 10267
 10268     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10269     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10270                                    PB-I-LIFE-COMMISSION.
 10271***  IF PB-COMPANY-ID = 'CRI'
 10272     IF PB-PREM-ACCTNG-ONLY
 10273         GO TO 0560-EDIT-CONTINUE.
 10274
 10275     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 188
* EL050.cbl
 10276     MOVE ' '    TO WS-CTBL-READ-SW.
 10277
 10278
 10279 0530-GET-AH-COMP.
 10280     IF NO-AH-COVERAGE  OR
 10281        NO-AH-BENEFIT-MATCH
 10282           GO TO 0540-NEXT-READ-STEP.
 10283
 10284     IF AM-A-COM (SUB1) NUMERIC
 10285        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10286         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10287         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10288         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10289         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10290     ELSE
 10291          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10292          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10293          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10294          MOVE ZEROS             TO WS-SUB1
 10295                                    WS-COMMISSION
 10296          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10297          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10298          IF WS-COMMISSION > ZEROS
 10299             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10300             GO TO 0540-NEXT-READ-STEP
 10301          END-IF
 10302          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10303          IF CTBL-TABLE-FOUND
 10304             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10305                                        PB-I-AH-TERM
 10306             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10307             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10308             GO TO 0540-NEXT-READ-STEP
 10309          ELSE
 10310             IF FIRST-TIME-THROUGH
 10311                 GO TO 0530-GET-AH-COMP
 10312             ELSE
 10313                 MOVE ER-2609                TO WS-ERROR
 10314                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10315
 10316 0540-NEXT-READ-STEP.
 10317     MOVE '0540' TO CTBL-SW.
 10318     MOVE ' '    TO WS-CTBL-READ-SW.
 10319
 10320 0540-GET-LF-COMP.
 10321     IF NO-LIFE-COVERAGE  OR
 10322        NO-LF-BENEFIT-MATCH
 10323           GO TO 0560-EDIT-CONTINUE.
 10324
 10325     IF WS-LF-JOINT-INDICATOR = 'J'
 10326        IF AM-J-COM (SUB1) NUMERIC
 10327           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10328           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10329           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10330           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10331           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10332        ELSE
 10333           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 189
* EL050.cbl
 10334           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10335           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10336           MOVE ZEROS                TO WS-SUB1
 10337                                        WS-COMMISSION
 10338           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10339           IF WS-COMMISSION > ZEROS
 10340              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10341              GO TO 0560-EDIT-CONTINUE
 10342           END-IF
 10343           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10344           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10345           IF CTBL-TABLE-FOUND
 10346              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10347              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10348              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10349              GO TO 0560-EDIT-CONTINUE
 10350           ELSE
 10351              IF FIRST-TIME-THROUGH
 10352                  GO TO 0540-GET-LF-COMP
 10353              ELSE
 10354                  MOVE ER-2609                TO WS-ERROR
 10355                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10356                  GO TO 0560-EDIT-CONTINUE.
 10357
 10358     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10359        IF AM-L-COM (SUB1) NUMERIC
 10360           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10361           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10362           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10363           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10364           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10365        ELSE
 10366           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10367           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10368           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10369           MOVE ZEROS                TO WS-SUB1
 10370                                        WS-COMMISSION
 10371           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10372           IF WS-COMMISSION IS GREATER THAN ZEROS
 10373              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10374              GO TO 0560-EDIT-CONTINUE
 10375           END-IF
 10376           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10377           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10378           IF CTBL-TABLE-FOUND
 10379              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10380              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10381              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10382              GO TO 0560-EDIT-CONTINUE
 10383           ELSE
 10384              IF FIRST-TIME-THROUGH
 10385                  GO TO 0540-GET-LF-COMP
 10386              ELSE
 10387                  MOVE ER-2609                TO WS-ERROR
 10388                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10389
 10390*    GO TO 0560-EDIT-CONTINUE.
 10391
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 190
* EL050.cbl
 10392 0560-EDIT-CONTINUE.
 10393     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10394                                    WS-AH-PMF-COMM
 10395*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10396*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10397     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10398        (SUB1 > +10)
 10399        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10400           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10401           MOVE '0530'           TO CTBL-SW
 10402           MOVE ' '              TO WS-CTBL-READ-SW
 10403           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10404           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10405           MOVE '0540'           TO CTBL-SW
 10406           MOVE ' '              TO WS-CTBL-READ-SW
 10407           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10408        END-IF
 10409     END-PERFORM
 10410     GO TO 0564-EDIT-CONTINUE
 10411     .
 10412 0561-CHECK-AH.
 10413     IF (NO-AH-COVERAGE)
 10414        OR (NO-AH-BENEFIT-MATCH)
 10415        CONTINUE
 10416     ELSE
 10417        IF (AM-A-COM (SUB1) NUMERIC)
 10418           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10419           IF (AM-COM-TYP (SUB1) = 'A')
 10420              AND (WS-AH-PMF-COMM = ZEROS)
 10421              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10422           END-IF
 10423           CONTINUE
 10424        ELSE
 10425           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10426           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10427           MOVE PB-AH-OVERRIDE-L1
 10428                                 TO CTBL-BEN-TYPE
 10429           MOVE ZEROS            TO WS-SUB1
 10430                                    WS-COMMISSION
 10431           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10432           PERFORM 8300-READ-CTBL-TABLE
 10433                                 THRU 8300-EXIT
 10434           IF CTBL-TABLE-FOUND
 10435              IF (AM-COM-TYP (SUB1) = 'A')
 10436                 AND (WS-AH-PMF-COMM = ZEROS)
 10437                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10438                                        PB-I-AH-TERM
 10439                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10440                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10441              END-IF
 10442              CONTINUE
 10443           ELSE
 10444              IF FIRST-TIME-THROUGH
 10445                 GO TO 0561-CHECK-AH
 10446              ELSE
 10447                 MOVE ER-2609    TO WS-ERROR
 10448                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10449              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 191
* EL050.cbl
 10450           END-IF
 10451        END-IF
 10452     END-IF
 10453     .
 10454 0561-EXIT.
 10455     EXIT.
 10456 0563-CHECK-LF.
 10457     IF (NO-LIFE-COVERAGE)
 10458        OR (NO-LF-BENEFIT-MATCH)
 10459        CONTINUE
 10460     ELSE
 10461        IF WS-LF-JOINT-INDICATOR = 'J'
 10462           IF AM-J-COM (SUB1) NUMERIC
 10463              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10464              IF (AM-COM-TYP (SUB1) = 'A')
 10465                 AND (WS-LF-PMF-COMM = ZEROS)
 10466                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10467              END-IF
 10468              CONTINUE
 10469           ELSE
 10470              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10471              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10472              MOVE PB-LIFE-OVERRIDE-L1
 10473                                 TO CTBL-BEN-TYPE
 10474              MOVE ZEROS         TO WS-SUB1
 10475                                    WS-COMMISSION
 10476              MOVE AM-J-COMA (SUB1)
 10477                                 TO CTBL-TABLE
 10478              PERFORM 8300-READ-CTBL-TABLE
 10479                                 THRU 8300-EXIT
 10480              IF CTBL-TABLE-FOUND
 10481                 IF (AM-COM-TYP (SUB1) = 'A')
 10482                    AND (WS-LF-PMF-COMM = ZEROS)
 10483                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10484                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10485                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10486                 END-IF
 10487                 CONTINUE
 10488              ELSE
 10489                 IF FIRST-TIME-THROUGH
 10490                    GO TO 0563-CHECK-LF
 10491                 ELSE
 10492                    MOVE ER-2609 TO WS-ERROR
 10493                    PERFORM 9900-ERROR-FORMAT
 10494                                 THRU 9900-EXIT
 10495*                   GO TO 0560-EDIT-CONTINUE
 10496                 END-IF
 10497              END-IF
 10498           END-IF
 10499        ELSE
 10500           IF AM-L-COM (SUB1) NUMERIC
 10501              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10502              IF (AM-COM-TYP (SUB1) = 'A')
 10503                 AND (WS-LF-PMF-COMM = ZEROS)
 10504                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10505              END-IF
 10506              CONTINUE
 10507           ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 192
* EL050.cbl
 10508              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10509              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10510              MOVE PB-LIFE-OVERRIDE-L1
 10511                                 TO CTBL-BEN-TYPE
 10512              MOVE ZEROS         TO WS-SUB1
 10513                                    WS-COMMISSION
 10514              MOVE AM-L-COMA (SUB1)
 10515                                 TO CTBL-TABLE
 10516              PERFORM 8300-READ-CTBL-TABLE
 10517                                 THRU 8300-EXIT
 10518              IF CTBL-TABLE-FOUND
 10519                 CONTINUE
 10520              ELSE
 10521                 IF FIRST-TIME-THROUGH
 10522                    GO TO 0563-CHECK-LF
 10523                 ELSE
 10524                    MOVE ER-2609 TO WS-ERROR
 10525                    PERFORM 9900-ERROR-FORMAT
 10526                                 THRU 9900-EXIT
 10527                 END-IF
 10528              END-IF
 10529           END-IF
 10530        END-IF
 10531     END-IF
 10532     .
 10533 0563-EXIT.
 10534     EXIT.
 10535 0564-EDIT-CONTINUE.
 10536
 10537     IF  PB-COMPANY-ID EQUAL 'DMD'
 10538         IF PB-I-NUM-BILLED EQUAL ZEROS
 10539            MOVE ER-8148       TO WS-ERROR
 10540            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10541
 10542*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10543*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10544*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10545*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10546*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10547*         IF NO-CONVERSION-ERROR
 10548*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10549*         ELSE
 10550*             IF PB-COMPANY-ID EQUAL 'HAN'
 10551*                 MOVE ZEROS     TO PB-I-AGE.
 10552     IF PB-I-BIRTHDAY > LOW-VALUES
 10553        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10554        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10555        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10556        PERFORM 8500-DATE-CONVERT
 10557                                 THRU 8500-EXIT
 10558        IF NO-CONVERSION-ERROR
 10559           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10560           IF PB-I-AGE > ZEROS
 10561              IF WS-WORK-AGE NOT = PB-I-AGE
 10562                 MOVE ER-9501    TO WS-ERROR
 10563                 PERFORM 9900-ERROR-FORMAT
 10564                                 THRU 9900-EXIT
 10565              END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 193
* EL050.cbl
 10566           ELSE
 10567              MOVE WS-WORK-AGE   TO PB-I-AGE
 10568           END-IF
 10569        END-IF
 10570     END-IF
 10571     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10572                                   WS-INS-AGE-SET
 10573     IF PB-I-AGE = ZEROS
 10574        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10575           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10576                                   WS-INS-AGE-SET
 10577           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10578
 10579     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10580                                   WS-AH-EDIT-AGE.
 10581
 10582     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10583        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10584        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10585        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10586        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10587        IF NO-CONVERSION-ERROR
 10588           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10589           IF PB-I-JOINT-AGE > 0
 10590              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10591                 MOVE ER-9503    TO WS-ERROR
 10592                 PERFORM 9900-ERROR-FORMAT
 10593                                 THRU 9900-EXIT
 10594              END-IF
 10595           ELSE
 10596              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10597           END-IF
 10598        ELSE
 10599           MOVE ZEROS            TO PB-I-JOINT-AGE
 10600        END-IF
 10601     END-IF
 10602     IF PB-I-JOINT-AGE NOT NUMERIC
 10603        MOVE ZERO               TO PB-I-JOINT-AGE.
 10604
 10605     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10606                                   WS-JNT-AGE-SET
 10607     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10608        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10609           (WS-AH-JOINT-INDICATOR = 'J')
 10610           IF PB-I-JOINT-AGE = ZEROS
 10611               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10612                                          WS-JNT-AGE-SET
 10613               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10614           END-IF
 10615        END-IF
 10616     END-IF
 10617
 10618     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10619     IF WS-LF-JOINT-INDICATOR = 'J'
 10620        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10621        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10622            IF  PB-I-JOINT-AGE = ZERO
 10623                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 194
* EL050.cbl
 10624                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10625            ELSE
 10626                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10627                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10628                    IF PB-COMPANY-ID NOT = 'LBL'
 10629                        MOVE ER-2685    TO WS-ERROR
 10630                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10631
 10632     IF WS-AH-JOINT-INDICATOR = 'J'
 10633        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10634            IF  PB-I-JOINT-AGE = ZERO
 10635                MOVE ER-2686       TO WS-ERROR
 10636                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10637            ELSE
 10638                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10639                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10640                                           WS-EDIT-AGE
 10641                    IF PB-COMPANY-ID NOT = 'LBL'
 10642                        MOVE ER-2685    TO WS-ERROR
 10643                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10644
 10645******************************************************************
 10646*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10647******************************************************************
 10648
 10649     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10650        (WS-AH-SPECIAL-CALC-CD = 'O')
 10651        NEXT SENTENCE
 10652     ELSE
 10653        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10654          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10655           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10656            WS-AH-JOINT-INDICATOR = 'J')  AND
 10657           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10658            MOVE ER-2627             TO WS-ERROR
 10659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10660
 10661     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10662        (WS-AH-SPECIAL-CALC-CD = 'O')
 10663         NEXT SENTENCE
 10664     ELSE
 10665         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10666            WS-AH-JOINT-INDICATOR = 'J'
 10667             IF PB-I-JOINT-INSURED = SPACES
 10668                 IF PB-COMPANY-ID NOT = 'JAL'
 10669                     MOVE ER-2696    TO WS-ERROR
 10670                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10671
 10672     IF PB-COMPANY-ID NOT = 'BOA'
 10673        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10674           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10675           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10676               PB-I-JOINT-INSURED NOT = SPACES)
 10677                MOVE ER-2691         TO WS-ERROR
 10678                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10679
 10680     IF PB-COMPANY-ID = 'BOA'
 10681        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 195
* EL050.cbl
 10682           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10683            IF PB-I-JOINT-AGE NOT = ZEROS
 10684                MOVE ER-2691         TO WS-ERROR
 10685                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10686
 10687     IF PB-COMPANY-ID = 'CRI'
 10688        IF PB-I-SIG-SW = 'J'
 10689           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10690              WS-AH-JOINT-INDICATOR NOT = 'J'
 10691              MOVE ER-2675       TO WS-ERROR
 10692              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     IF PB-COMPANY-ID = 'CRI'
 10695        IF PB-I-SIG-SW = 'S'
 10696           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10697              WS-AH-JOINT-INDICATOR = 'J'
 10698              MOVE ER-2676       TO WS-ERROR
 10699              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10700
 10701     IF PB-COMPANY-ID = 'CVL'
 10702         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10703            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10704              MOVE ER-2783           TO WS-ERROR
 10705              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10706     IF (WS-LF-JOINT-INDICATOR = 'J')
 10707        AND (WS-AH-JOINT-INDICATOR = 'J')
 10708        AND (PB-I-LF-TERM > 120)
 10709        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10710        MOVE ER-2783             TO WS-ERROR
 10711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10712     END-IF
 10713     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10714
 10715     IF PB-I-INDV-GRP-OVRD = 'I'
 10716        MOVE ER-2666             TO WS-ERROR
 10717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10718        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10719
 10720     IF PB-I-INDV-GRP-OVRD = 'G'
 10721        MOVE ER-2666             TO WS-ERROR
 10722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10723        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10724
 10725     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10726        NEXT SENTENCE
 10727     ELSE
 10728        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10729
 10730     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10731        IF WS-ERROR = ER-2666
 10732           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10733           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10734
 10735     IF PB-COMPANY-ID = 'CID'
 10736        IF PB-STATE = 'UT' OR 'MO'
 10737           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10738                 OR '76' OR '77')
 10739                      OR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 196
* EL050.cbl
 10740               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10741                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10742                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10743                   OR '2K' OR '2L'))
 10744              AND PB-I-INDV-GRP-CD = 'I'
 10745              MOVE ER-2721             TO WS-ERROR
 10746              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10747           END-IF
 10748        END-IF
 10749     END-IF
 10750
 10751     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10752     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10753        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10754     ELSE
 10755        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10756     END-IF
 10757
 10758*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10759*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10760     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10761                                    ACCOUNT-AH-CK-SW.
 10762
 10763     IF PB-REISSUED-CERT       OR
 10764        PB-REIN-ONLY-CERT      OR
 10765        PB-POLICY-IS-DECLINED  OR
 10766        PB-POLICY-IS-VOIDED
 10767*       OR PB-MONTHLY-CERT
 10768         GO TO 3000-CONTINUE-EDIT.
 10769
 10770     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10771        IF WS-EDIT-AGE           > +65
 10772           MOVE ER-2709          TO WS-ERROR
 10773           PERFORM 9900-ERROR-FORMAT
 10774                                 THRU 9900-EXIT
 10775        ELSE
 10776           IF WS-EDIT-AGE        > +55
 10777              MOVE ER-2718       TO WS-ERROR
 10778              PERFORM 9900-ERROR-FORMAT
 10779                                 THRU 9900-EXIT
 10780           END-IF
 10781        END-IF
 10782     IF PB-COMPANY-ID = 'DCC'
 10783        IF WS-EDIT-AGE           > +65
 10784           MOVE ER-2709          TO WS-ERROR
 10785           PERFORM 9900-ERROR-FORMAT
 10786                                 THRU 9900-EXIT
 10787        END-IF
 10788     END-IF
 10789     .
 10790
 10791 0565-LIFE-PLAN-LIMIT-EDITS.
 10792
 10793     IF NOT LF-PLAN-MASTER-FOUND
 10794        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10795                                    EC-AM-LF-MAX-TOT-BEN
 10796        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10797
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 197
* EL050.cbl
 10798     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10799
 10800     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10801         IF PL-LM-AGE (1) = ZEROS
 10802             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10803
 10804     IF NO-LF-BENEFIT-MATCH          OR
 10805        WS-LF-BENEFIT-CD = ZEROS     OR
 10806        WS-LF-SPECIAL-CALC-CD = 'M'
 10807        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10808
 10809     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10810     MOVE +1                     TO SUB2.
 10811
 10812     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10813        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10814           MOVE +5   TO SUB2
 10815           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10816              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10817              (PL-LM-AGE (SUB2) EQUAL +0)
 10818              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10819              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10820
 10821     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10822
 10823     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10824                               + PB-I-LF-ALT-BENEFIT-AMT.
 10825
 10826 0568-CHECK-LIFE-ATT-AGE.
 10827
 10828     IF PL-ATT-AGE NUMERIC AND
 10829        PL-ATT-AGE > +0
 10830        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10831     END-IF
 10832*    IF PL-ATT-AGE NUMERIC AND
 10833*       PL-ATT-AGE > +0
 10834*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10835*       IF PB-I-BIRTHDAY > LOW-VALUES
 10836*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10837*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10838*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10839*          SET BIN-PLUS-ELAPSED  TO TRUE
 10840*          PERFORM 8500-DATE-CONVERT
 10841*                                THRU 8500-EXIT
 10842*          IF NO-CONVERSION-ERROR
 10843*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10844*             MOVE ER-2669       TO WS-ERROR
 10845*             PERFORM 9900-ERROR-FORMAT
 10846*                                THRU 9900-EXIT
 10847*          END-IF
 10848*       ELSE
 10849*          IF WS-ATT-AGE >= PL-ATT-AGE
 10850*             MOVE ER-2669       TO WS-ERROR
 10851*             PERFORM 9900-ERROR-FORMAT
 10852*                                THRU 9900-EXIT
 10853*          END-IF
 10854*       END-IF
 10855*    END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 198
* EL050.cbl
 10856     .
 10857 0570-CHECK-LIFE-LIMITS.
 10858
 10859     IF PB-COMPANY-ID EQUAL 'CRI'
 10860        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10861           IF SUB2 GREATER THAN +4
 10862              MOVE ER-2637 TO WS-ERROR
 10863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10864              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10865
 10866     IF PB-COMPANY-ID  =  'NCL'
 10867        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10868            SUB2 GREATER THAN +8
 10869             MOVE 'U'         TO PB-BATCH-ENTRY
 10870             MOVE ER-2637     TO WS-ERROR
 10871             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10872             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10873
 10874     IF SUB2 > +8
 10875        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10876           AND (PB-I-SIG-SW = 'Y')
 10877           CONTINUE
 10878        ELSE
 10879           MOVE ER-2637          TO WS-ERROR
 10880           PERFORM 9900-ERROR-FORMAT
 10881                                 THRU 9900-EXIT
 10882        END-IF
 10883        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10884     END-IF
 10885     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10886     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10887     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10888
 10889     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10890        ADD +1  TO SUB2
 10891        GO TO 0570-CHECK-LIFE-LIMITS.
 10892
 10893     IF PB-COMPANY-ID = 'NCL'
 10894         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10895
 10896     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10897        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10898        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10899           AND (PB-I-SIG-SW = 'Y')
 10900           CONTINUE
 10901        ELSE
 10902           MOVE ER-2637          TO WS-ERROR
 10903           PERFORM 9900-ERROR-FORMAT
 10904                                 THRU 9900-EXIT
 10905        END-IF
 10906     END-IF
 10907     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10908
 10909
 10910 0570-CHECK-NCL-LIFE-LIMITS.
 10911
 10912     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10913        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 199
* EL050.cbl
 10914         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10915
 10916     IF APP-CERT-USED
 10917         IF SUB2  LESS THAN  +5
 10918             MOVE +5          TO SUB2
 10919             GO TO 0570-CHECK-LIFE-LIMITS.
 10920
 10921     MOVE ER-2637             TO WS-ERROR.
 10922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10923
 10924     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10925
 10926 0575-CHECK-NCL-SIG-SWITCH.
 10927
 10928     IF NOT APP-CERT-USED
 10929         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10930
 10931     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10932        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10933        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10934        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10935         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10936
 10937     IF SUB2 GREATER THAN +4
 10938         IF PL-LM-AGE (5) = ZEROS  AND
 10939            PL-LM-AGE (6) = ZEROS  AND
 10940            PL-LM-AGE (7) = ZEROS  AND
 10941            PL-LM-AGE (8) = ZEROS
 10942             MOVE  ER-1927        TO WS-ERROR
 10943             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10944             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10945         ELSE
 10946             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10947                 MOVE  ER-1920    TO WS-ERROR
 10948                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10949
 10950     IF PB-I-SIG-SW  = 'Y'
 10951       IF NOT PB-I-POLICY-ACCEPTED  AND
 10952          NOT PB-I-POLICY-DECLINED
 10953           MOVE 'U'               TO PB-BATCH-ENTRY
 10954           MOVE  ER-1926          TO WS-ERROR
 10955           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10956
 10957
 10958 0580-AH-PLAN-LIMIT-EDITS.
 10959
 10960     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10961        IF PB-I-AH-BENEFIT-AMT > +1250
 10962           MOVE ER-2702          TO WS-ERROR
 10963           PERFORM 9900-ERROR-FORMAT
 10964                                 THRU 9900-EXIT
 10965        END-IF
 10966     END-IF
 10967
 10968     IF (PB-COMPANY-ID = 'DCC')
 10969        AND (PB-MONTHLY-CERT)
 10970        IF PB-I-AH-BENEFIT-AMT > +3000
 10971           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 200
* EL050.cbl
 10972           PERFORM 9900-ERROR-FORMAT
 10973                                 THRU 9900-EXIT
 10974        END-IF
 10975     END-IF
 10976     IF NOT AH-PLAN-MASTER-FOUND
 10977        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10978        GO TO 3000-CONTINUE-EDIT.
 10979
 10980     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10981
 10982     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10983         IF PL-LM-AGE (1) = ZEROS
 10984             GO TO 3000-CONTINUE-EDIT.
 10985
 10986     IF NO-AH-BENEFIT-MATCH          OR
 10987        WS-AH-BENEFIT-CD = ZEROS     OR
 10988        WS-AH-SPECIAL-CALC-CD = 'M'
 10989        GO TO 3000-CONTINUE-EDIT.
 10990
 10991     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10992     MOVE +1                     TO SUB2.
 10993
 10994     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10995        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10996           MOVE +5 TO SUB2
 10997           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10998              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10999              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11000              (PL-LM-AGE (SUB2) EQUAL +0)
 11001              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11002              GO TO 3000-CONTINUE-EDIT.
 11003
 11004     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11005
 11006 0590-CHECK-AH-ATT-AGE.
 11007
 11008     IF PL-ATT-AGE NUMERIC AND
 11009        PL-ATT-AGE GREATER THAN +0
 11010        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11011     END-IF
 11012*       IF WS-ATT-AGE >= PL-ATT-AGE
 11013*          MOVE ER-3054          TO WS-ERROR
 11014*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11015     .
 11016 0597-CHECK-AH-LIMITS.
 11017
 11018     IF PB-COMPANY-ID EQUAL 'CRI'
 11019        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11020           IF SUB2 GREATER THAN +4
 11021              MOVE ER-2638       TO WS-ERROR
 11022              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11023              GO TO 3000-CONTINUE-EDIT.
 11024
 11025     IF PB-COMPANY-ID  =  'NCL'
 11026        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11027            SUB2 GREATER THAN +8
 11028             MOVE 'U'            TO PB-BATCH-ENTRY
 11029             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 201
* EL050.cbl
 11030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11031             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11032
 11033     IF SUB2 > +8
 11034        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11035           AND (PB-I-SIG-SW = 'Y')
 11036           CONTINUE
 11037        ELSE
 11038           MOVE ER-2638          TO WS-ERROR
 11039           PERFORM 9900-ERROR-FORMAT
 11040                                 THRU 9900-EXIT
 11041        END-IF
 11042        GO TO 3000-CONTINUE-EDIT
 11043     END-IF
 11044
 11045     IF PB-COMPANY-ID = 'CRI'
 11046        IF WS-ERROR = ER-2638
 11047           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11048
 11049     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11050     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11051     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11052     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11053
 11054     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11055        ADD +1                   TO SUB2
 11056        GO TO 0597-CHECK-AH-LIMITS.
 11057
 11058     IF PB-COMPANY-ID = 'NCL'
 11059         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11060
 11061     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11062        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11063        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11064                                 > PL-LM-AMT (SUB2))
 11065        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11066           AND (PB-I-SIG-SW = 'Y')
 11067           CONTINUE
 11068        ELSE
 11069           MOVE ER-2638          TO WS-ERROR
 11070           PERFORM 9900-ERROR-FORMAT
 11071                                 THRU 9900-EXIT
 11072        END-IF
 11073     END-IF
 11074
 11075     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11076         IF  WS-ERROR    EQUAL    ER-2638
 11077             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11078                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11079                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11080                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11081                MOVE  ER-1910    TO  WS-ERROR
 11082                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11083
 11084     IF PB-COMPANY-ID = 'CRI'
 11085        IF WS-ERROR = ER-2638
 11086            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11087            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 202
* EL050.cbl
 11088            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11089
 11090     GO TO 3000-CONTINUE-EDIT.
 11091
 11092 0597-CHECK-NCL-AH-LIMITS.
 11093
 11094     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11095        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11096        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11097                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11098         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11099
 11100     IF APP-CERT-USED
 11101         IF SUB2  LESS THAN  +5
 11102             MOVE +5             TO SUB2
 11103             GO TO 0597-CHECK-AH-LIMITS.
 11104
 11105     MOVE ER-2638                TO WS-ERROR.
 11106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11107
 11108     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11109
 11110 0599-CHECK-NCL-SIG-SWITCH.
 11111
 11112     IF NOT APP-CERT-USED
 11113         GO TO 3000-CONTINUE-EDIT.
 11114
 11115     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11116        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11117        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11118        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11119         GO TO 3000-CONTINUE-EDIT.
 11120
 11121     IF SUB2 GREATER THAN +4
 11122         IF PL-LM-AGE (5) = ZEROS  AND
 11123            PL-LM-AGE (6) = ZEROS  AND
 11124            PL-LM-AGE (7) = ZEROS  AND
 11125            PL-LM-AGE (8) = ZEROS
 11126             MOVE  ER-1927        TO WS-ERROR
 11127             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11128             GO TO 3000-CONTINUE-EDIT
 11129         ELSE
 11130             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11131                 MOVE  ER-1920    TO WS-ERROR
 11132                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11133
 11134     IF PB-I-SIG-SW  = 'Y'
 11135       IF NOT PB-I-POLICY-ACCEPTED  AND
 11136          NOT PB-I-POLICY-DECLINED
 11137           MOVE 'U'               TO PB-BATCH-ENTRY
 11138           MOVE  ER-1926          TO WS-ERROR
 11139           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11140
 11141******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 203
* EL050.cbl
 11143
 11144 3000-CONTINUE-EDIT.
 11145
 11146     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11147     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11148     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11149     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11150     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11151
 11152     IF BROWSE-STARTED
 11153        PERFORM 9990-RETURN THRU 9990-EXIT
 11154        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11155
 11156     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11157        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11158        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11159        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11160*       MOVE 1                   TO DC-OPTION-CODE
 11161        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11162        IF DATE-CONVERSION-ERROR
 11163           MOVE ER-2622          TO WS-ERROR
 11164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11165        ELSE
 11166           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11167              MOVE ER-2623       TO WS-ERROR
 11168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11169           ELSE
 11170              MOVE ER-2622       TO WS-ERROR
 11171              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11172
 11173     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11174     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11175     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11176*    MOVE 1                      TO DC-OPTION-CODE.
 11177     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11178     IF DATE-CONVERSION-ERROR
 11179        GO TO 3005-EDIT-CONTINUE
 11180     ELSE
 11181        IF DC-ELAPSED-DAYS GREATER +180
 11182           MOVE ER-2613          TO WS-ERROR
 11183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11184        ELSE
 11185           IF DC-ELAPSED-DAYS GREATER +90
 11186              MOVE ER-2612       TO WS-ERROR
 11187              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11188           ELSE
 11189             IF DC-ELAPSED-DAYS GREATER +60
 11190                MOVE ER-2614     TO WS-ERROR
 11191                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11192
 11193 3005-EDIT-CONTINUE.
 11194
 11195     IF PB-CANCELLATION
 11196         GO TO 3700-EDIT-CANCEL.
 11197
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 204
* EL050.cbl
 11199******************************************************************
 11200*                  E D I T   I S S U E                           *
 11201******************************************************************
 11202
 11203 3020-EDIT-ISSUE.
 11204
 11205      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11206      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11207      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11208      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11209      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11210
 11211     IF PB-ISSUE-FORCE
 11212        OR PB-ISSUE-DATE-FORCED
 11213        OR PB-FORCE-OFF
 11214        OR PB-OVERCHARGE-FORCE
 11215        CONTINUE
 11216     ELSE
 11217        MOVE ER-2670             TO WS-ERROR
 11218        PERFORM 9900-ERROR-FORMAT
 11219                                 THRU 9900-EXIT
 11220     END-IF
 11221     .
 11222 3022-SET-POLICY-STATUS.
 11223
 11224     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11225
 11226     IF (PB-REISSUED-CERT)
 11227             OR
 11228        ((PB-COMPANY-ID NOT = 'DCC')
 11229         AND (PB-MONTHLY-CERT))
 11230         MOVE '5'                TO PB-I-ENTRY-STATUS
 11231         MOVE 'E'                TO PB-BATCH-ENTRY
 11232     END-IF
 11233
 11234     IF PB-COMPANY-ID = 'DCC'
 11235        IF PB-MONTHLY-CERT
 11236           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11237        END-IF
 11238     END-IF
 11239     IF PB-POLICY-IS-DECLINED
 11240         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11241     IF PB-POLICY-IS-VOIDED
 11242         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11243     IF PB-NEEDS-UNDERWRITING
 11244         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11245     IF PB-REIN-ONLY-CERT
 11246         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11247     IF PB-PREM-ACCTNG-ONLY
 11248         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11249
 11250     MOVE SPACE                  TO PB-I-OB-FLAG.
 11251
 11252     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11253         MOVE ER-2665            TO WS-ERROR
 11254         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11255         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11256
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 205
* EL050.cbl
 11257     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11258        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11259           MOVE 'Z'             TO PB-I-OB-FLAG.
 11260
 11261     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11262        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11263           MOVE 'Z'             TO PB-I-OB-FLAG.
 11264
 11265     IF ACCOUNT-MAST-FOUND
 11266         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11267         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11268         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11269         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11270         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11271         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11272         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11273     END-IF
 11274
 11275     IF ACCOUNT-MAST-FOUND
 11276        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11277         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11278
 11279     IF (ACCOUNT-MAST-FOUND)
 11280        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11281        IF PB-REISSUED-CERT
 11282           CONTINUE
 11283        ELSE
 11284           MOVE ER-2608          TO WS-ERROR
 11285           PERFORM 9900-ERROR-FORMAT
 11286                                 THRU 9900-EXIT
 11287         END-IF
 11288     END-IF
 11289
 11290     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11291        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11292        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11293
 11294**********   DMD CUSTOM CODE FOLLOWS  **********
 11295 3024-EDIT-DMD-FIELDS.
 11296     IF PB-COMPANY-ID NOT = 'DMD'
 11297        GO TO 3025-EDIT-REINSURANCE.
 11298
 11299*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11300*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11301*** ERROR IF THEY ARE NOT EQUAL.
 11302
 11303     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11304     SET BIN-TO-GREG               TO TRUE.
 11305     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11306     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11307**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11308
 11309     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11310     SET BIN-TO-GREG               TO TRUE.
 11311     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11312     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11313**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11314
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 206
* EL050.cbl
 11315     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11316        MOVE ER-8116               TO WS-ERROR
 11317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11318
 11319     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11320
 11321     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11322                                      WK-FULL-CERT-NO.
 11323     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11324
 11325     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11326
 11327     IF PB-VALID-LIFE
 11328        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11329     ELSE
 11330        IF PB-VALID-AH
 11331          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11332
 11333
 11334     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11335     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11336     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11337                                      DCUA-UNDRWRTR-CODE
 11338                                      DCUA-UNDRWRTR-GROUP-CODE
 11339                                      DCUA-RETURN-CODE.
 11340
 11341****************************************************************
 11342*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11343***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11344***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11345***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11346***   TO THIS RECORD.                                        ***
 11347****************************************************************
 11348     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11349     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11350     IF DCUA-SUCCESSFUL-PROCESS
 11351        GO TO 3024-EDIT-DL7-CONT.
 11352
 11353     IF DCUA-RETURN-CODE EQUAL '01'
 11354        MOVE ER-8110               TO WS-ERROR
 11355        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL7-CONT.
 11358
 11359     IF DCUA-RETURN-CODE EQUAL '02'
 11360        MOVE ER-8111               TO WS-ERROR
 11361        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        GO TO 3024-EDIT-DL7-CONT.
 11364
 11365     IF DCUA-RETURN-CODE EQUAL '03'
 11366        MOVE ER-8074               TO WS-ERROR
 11367        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11369        GO TO 3024-EDIT-DL7-CONT.
 11370
 11371     IF DCUA-RETURN-CODE EQUAL '04'
 11372        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 207
* EL050.cbl
 11373        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11375        GO TO 3024-EDIT-DL7-CONT.
 11376
 11377     IF DCUA-RETURN-CODE EQUAL '05'
 11378        MOVE ER-8076               TO WS-ERROR
 11379        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11381        GO TO 3024-EDIT-DL7-CONT.
 11382
 11383     IF DCUA-RETURN-CODE EQUAL '06'
 11384        MOVE ER-8077               TO WS-ERROR
 11385        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11387        GO TO 3024-EDIT-DL7-CONT.
 11388
 11389     IF DCUA-RETURN-CODE EQUAL '07'
 11390        MOVE ER-8078               TO WS-ERROR
 11391        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11393        GO TO 3024-EDIT-DL7-CONT.
 11394
 11395     IF DCUA-RETURN-CODE EQUAL 'E1'
 11396        MOVE ER-8079               TO WS-ERROR
 11397        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399        GO TO 3024-EDIT-DL7-CONT.
 11400
 11401     IF DCUA-RETURN-CODE EQUAL 'E2'
 11402        MOVE ER-8080               TO WS-ERROR
 11403        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11405        GO TO 3024-EDIT-DL7-CONT.
 11406
 11407     IF DCUA-RETURN-CODE EQUAL 'E3'
 11408        MOVE ER-8098               TO WS-ERROR
 11409        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11411        GO TO 3024-EDIT-DL7-CONT.
 11412
 11413     IF DCUA-RETURN-CODE EQUAL 'C1'
 11414        MOVE ER-8099               TO WS-ERROR
 11415        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11417        GO TO 3024-EDIT-DL7-CONT.
 11418
 11419     IF DCUA-RETURN-CODE EQUAL 'U1'
 11420        MOVE ER-8109               TO WS-ERROR
 11421        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11423        GO TO 3024-EDIT-DL7-CONT.
 11424
 11425     IF DCUA-RETURN-CODE EQUAL 'N1'
 11426        MOVE ER-8112               TO WS-ERROR
 11427        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11429        GO TO 3024-EDIT-DL7-CONT.
 11430
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 208
* EL050.cbl
 11431     IF DCUA-RETURN-CODE EQUAL 'N2'
 11432        MOVE ER-8113               TO WS-ERROR
 11433        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11434        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11435        GO TO 3024-EDIT-DL7-CONT.
 11436
 11437     IF DCUA-RETURN-CODE EQUAL 'N3'
 11438        MOVE ER-8114               TO WS-ERROR
 11439        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL7-CONT.
 11442
 11443     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11444     MOVE ER-8097                  TO WS-ERROR.
 11445     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11446     GO TO 3024-EDIT-DL7-CONT.
 11447
 11448 3024-EDIT-DL7-CONT.
 11449
 11450     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11451     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11452     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11453        NEXT SENTENCE
 11454     ELSE
 11455        MOVE ER-9263               TO WS-ERROR
 11456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11457
 11458******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11459******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11460     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11461        NEXT SENTENCE
 11462     ELSE
 11463        MOVE ER-8039               TO WS-ERROR
 11464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11465
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 209
* EL050.cbl
 11467****************************************************************
 11468*** VALIDATE STATE  : DLO022                                 ***
 11469****************************************************************
 11470     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11471     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11472
 11473     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11474     IF DVSC-SUCCESSFUL-EDIT
 11475        GO TO 3024-EDIT-DL22-CONT.
 11476
 11477     IF DVSC-RETURN-CODE EQUAL '01'
 11478        MOVE ER-8300               TO WS-ERROR
 11479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11480        GO TO 3024-EDIT-DL22-CONT.
 11481
 11482     IF DVSC-RETURN-CODE EQUAL '02'
 11483        MOVE ER-8301               TO WS-ERROR
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 3024-EDIT-DL22-CONT.
 11486
 11487     IF DVSC-RETURN-CODE EQUAL '03'
 11488        MOVE ER-8302               TO WS-ERROR
 11489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11490        GO TO 3024-EDIT-DL22-CONT.
 11491
 11492     IF DVSC-RETURN-CODE EQUAL 'N1'
 11493        MOVE ER-8304               TO WS-ERROR
 11494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11495        GO TO 3024-EDIT-DL22-CONT.
 11496
 11497     MOVE ER-8303                  TO WS-ERROR
 11498     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11499
 11500 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 210
* EL050.cbl
 11502****************************************************************
 11503*** VALIDATE LOAN OFFICER : DLO021                           ***
 11504****************************************************************
 11505
 11506     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11507     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11508     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11509     IF DVLO-SUCCESSFUL-EDIT
 11510        GO TO 3024-EDIT-DL21-CONT.
 11511
 11512     IF DVLO-RETURN-CODE EQUAL '01'
 11513        MOVE ER-8081               TO WS-ERROR
 11514        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11515        GO TO 3024-EDIT-DL21-CONT.
 11516
 11517     IF DVLO-RETURN-CODE EQUAL '02'
 11518        MOVE ER-8082               TO WS-ERROR
 11519        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        GO TO 3024-EDIT-DL21-CONT.
 11521
 11522     IF DVLO-RETURN-CODE EQUAL '03'
 11523        MOVE ER-8083               TO WS-ERROR
 11524        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11525        GO TO 3024-EDIT-DL21-CONT.
 11526
 11527     IF DVLO-RETURN-CODE EQUAL '04'
 11528        MOVE ER-8084               TO WS-ERROR
 11529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530        GO TO 3024-EDIT-DL21-CONT.
 11531
 11532     IF DVLO-RETURN-CODE EQUAL '05'
 11533        MOVE ER-8085               TO WS-ERROR
 11534        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535        GO TO 3024-EDIT-DL21-CONT.
 11536
 11537     MOVE ER-7825                  TO WS-ERROR
 11538     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11539     GO TO 3024-EDIT-DL21-CONT.
 11540
 11541 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 211
* EL050.cbl
 11543
 11544****************************************************************
 11545*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11546****************************************************************
 11547
 11548     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11549     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11550     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11551     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11552     IF DIPF-SUCCESSFUL-EDIT
 11553        GO TO 3024-EDIT-DL02-CONT.
 11554
 11555     IF DIPF-RETURN-CODE EQUAL '01'
 11556        MOVE ER-8086               TO WS-ERROR
 11557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11558        GO TO 3024-EDIT-DL02-CONT.
 11559
 11560     IF DIPF-RETURN-CODE EQUAL '02'
 11561        MOVE ER-8087               TO WS-ERROR
 11562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11563        GO TO 3024-EDIT-DL02-CONT.
 11564
 11565     IF DIPF-RETURN-CODE EQUAL '03'
 11566        MOVE ER-8088               TO WS-ERROR
 11567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11568        GO TO 3024-EDIT-DL02-CONT.
 11569
 11570     MOVE ER-8095                  TO WS-ERROR
 11571     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11572     GO TO 3024-EDIT-DL02-CONT.
 11573
 11574 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 212
* EL050.cbl
 11576
 11577****************************************************************
 11578*** VALIDATE BANK ID : DLO003                                ***
 11579****************************************************************
 11580
 11581     MOVE WK-GREG-CENT           TO WCG-CENT.
 11582     MOVE WK-GREG-YYMM           TO WCG-REST.
 11583     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11584        MOVE ER-8040               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11586
 11587     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11588     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11589     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11590     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11591     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11592     IF DVBI-SUCCESSFUL-EDIT
 11593        GO TO 3024-EDIT-DL03-CONT.
 11594
 11595     IF DVBI-RETURN-CODE EQUAL '01'
 11596        MOVE ER-8089               TO WS-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11598        GO TO 3024-EDIT-DL03-CONT.
 11599
 11600     IF DVBI-RETURN-CODE EQUAL '02'
 11601        MOVE ER-8090               TO WS-ERROR
 11602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11603        GO TO 3024-EDIT-DL03-CONT.
 11604
 11605     IF DVBI-RETURN-CODE EQUAL '03'
 11606        MOVE ER-8091               TO WS-ERROR
 11607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608        GO TO 3024-EDIT-DL03-CONT.
 11609
 11610     IF DVBI-RETURN-CODE EQUAL '04'
 11611        MOVE ER-8092               TO WS-ERROR
 11612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11613        GO TO 3024-EDIT-DL03-CONT.
 11614
 11615     IF DVBI-RETURN-CODE EQUAL '05'
 11616        MOVE ER-8093               TO WS-ERROR
 11617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618        GO TO 3024-EDIT-DL03-CONT.
 11619
 11620     IF DVBI-RETURN-CODE EQUAL '06'
 11621        MOVE ER-8094               TO WS-ERROR
 11622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11623        GO TO 3024-EDIT-DL03-CONT.
 11624
 11625     MOVE ER-8096                  TO WS-ERROR
 11626     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11627     GO TO 3024-EDIT-DL03-CONT.
 11628
 11629 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 213
* EL050.cbl
 11631
 11632     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11633        NEXT SENTENCE
 11634     ELSE
 11635        MOVE ER-8042               TO WS-ERROR
 11636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11637
 11638     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11639     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11640     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11641
 11642     IF DMPF-RETURN-CODE = '01'
 11643        MOVE ER-8067               TO WS-ERROR
 11644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11645        GO TO 3024-EDIT-DL01-CONT.
 11646
 11647     IF DMPF-RETURN-CODE = '02'
 11648        MOVE ER-8068               TO WS-ERROR
 11649        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11650        GO TO 3024-EDIT-DL01-CONT.
 11651
 11652     IF DMPF-RETURN-CODE = '03'
 11653        MOVE ER-8069               TO WS-ERROR
 11654        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11655        GO TO 3024-EDIT-DL01-CONT.
 11656
 11657     IF DMPF-RETURN-CODE = 'E1'
 11658        MOVE ER-8070               TO WS-ERROR
 11659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11660        GO TO 3024-EDIT-DL01-CONT.
 11661
 11662     IF DMPF-RETURN-CODE = 'N1'
 11663        MOVE ER-8071               TO WS-ERROR
 11664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665        GO TO 3024-EDIT-DL01-CONT.
 11666
 11667     IF DMPF-RETURN-CODE NOT = 'OK'
 11668        MOVE ER-8072               TO WS-ERROR
 11669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11670
 11671 3024-EDIT-DL01-CONT.
 11672******************************************************************
 11673***  VALIDATES RATE CODES : DLO017                             ***
 11674******************************************************************
 11675
 11676      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11677      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11678      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11679      IF DVRC-SUCCESSFUL-EDIT
 11680        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11681        GO TO 3024-CHECK-VALID-RATE.
 11682
 11683      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11684
 11685      IF DVRC-RETURN-CODE EQUAL '01'
 11686         MOVE ER-7817                   TO WS-ERROR
 11687         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11688         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 214
* EL050.cbl
 11689
 11690      IF DVRC-RETURN-CODE EQUAL '02'
 11691         MOVE ER-7818                   TO WS-ERROR
 11692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11693         GO TO 3025-EDIT-REINSURANCE.
 11694
 11695      IF DVRC-RETURN-CODE EQUAL '03'
 11696         MOVE ER-7819                   TO WS-ERROR
 11697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11698         GO TO 3025-EDIT-REINSURANCE.
 11699
 11700       MOVE ER-7820                     TO WS-ERROR.
 11701       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11702       GO TO 3025-EDIT-REINSURANCE.
 11703
 11704******************************************************************
 11705***  GET PREMIUM RATES : DLO011                                ***
 11706******************************************************************
 11707
 11708 3024-CHECK-VALID-RATE.
 11709
 11710     IF VALID-RATE-CODE
 11711        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11712        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11713        MOVE SPACES                TO DPRB-RETURN-CODE
 11714        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11715     ELSE
 11716         GO TO 3025-EDIT-REINSURANCE.
 11717
 11718      IF DPRB-SUCCESSFUL-PROCESS
 11719         IF PB-VALID-LIFE
 11720             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11721             GO TO 3025-EDIT-REINSURANCE
 11722         ELSE
 11723             IF PB-VALID-AH
 11724                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11725                 GO TO 3025-EDIT-REINSURANCE.
 11726
 11727      IF DPRB-RETURN-CODE EQUAL '01'
 11728         MOVE ER-7812                   TO WS-ERROR
 11729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11730         GO TO 3025-EDIT-REINSURANCE.
 11731
 11732      IF DPRB-RETURN-CODE EQUAL '02'
 11733         MOVE ER-7813                   TO WS-ERROR
 11734         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11735         GO TO 3025-EDIT-REINSURANCE.
 11736
 11737      IF DPRB-RETURN-CODE EQUAL '03'
 11738         MOVE ER-7814                   TO WS-ERROR
 11739         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11740         GO TO 3025-EDIT-REINSURANCE.
 11741
 11742      IF DPRB-RETURN-CODE EQUAL '04'
 11743         IF NOT DPRB-1ST-TIME
 11744            MOVE ER-7815                   TO WS-ERROR
 11745            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11746            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 215
* EL050.cbl
 11747          ELSE
 11748         IF PB-VALID-LIFE
 11749            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11750          ELSE
 11751            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11752         END-IF
 11753         MOVE SPACES                TO DOCC-RETURN-CODE
 11754         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11755         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11756         IF DOCC-RETURN-CODE = 'OK'
 11757             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11758             GO TO 3024-CHECK-VALID-RATE
 11759           ELSE
 11760             MOVE ER-7823               TO WS-ERROR
 11761             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11762             GO TO 3025-EDIT-REINSURANCE.
 11763
 11764       MOVE ER-7816                     TO WS-ERROR.
 11765       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11766       GO TO 3025-EDIT-REINSURANCE.
 11767
 11768**********   DMD CUSTOM CODE ABOVE    **********
 11769
 11770 3025-EDIT-REINSURANCE.
 11771     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11772         GO TO 3027-EDIT-CONTINUE.
 11773
 11774     MOVE LOW-VALUES               TO ERREIN-KEY.
 11775     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11776     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11777                                      REIN-CODE-2
 11778                                      REIN-CODE-3.
 11779     MOVE 'A'                      TO REIN-TYPE.
 11780
 11781     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11782
 11783     MOVE '3026' TO REIN-SW.
 11784     MOVE ' '                   TO WS-REIN-READ-SW.
 11785
 11786     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11787     IF REIN-TABLE-NOT-FOUND
 11788         GO TO 3026-NO-SPEC-TABLE.
 11789
 11790     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11791     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11792                                   WS-NSP-ST-CD-LF.
 11793     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11794                                   WS-NSP-ST-CD-AH.
 11795
 11796     GO TO 3040-EDIT-CONTINUE.
 11797
 11798 3026-NO-SPEC-TABLE.
 11799
 11800     MOVE ER-2664                TO WS-ERROR.
 11801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11802     GO TO 3040-EDIT-CONTINUE.
 11803
 11804 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 216
* EL050.cbl
 11805
 11806     IF PB-I-REIN-TABLE = SPACES
 11807       GO TO 3040-EDIT-CONTINUE.
 11808
 11809     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11810          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11811          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11812           GO TO 3040-EDIT-CONTINUE.
 11813
 11814     MOVE LOW-VALUES            TO ERREIN-KEY.
 11815     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11816     MOVE 'A'                   TO REIN-TYPE.
 11817     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11818
 11819     MOVE '3028'                TO REIN-SW.
 11820     MOVE ' '                   TO WS-REIN-READ-SW.
 11821
 11822     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11823     IF REIN-TABLE-NOT-FOUND
 11824         GO TO 3028-NO-REIN-TABLE.
 11825
 11826     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11827     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11828                                   WS-NSP-ST-CD-LF.
 11829     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11830                                   WS-NSP-ST-CD-AH.
 11831
 11832     GO TO 3040-EDIT-CONTINUE.
 11833
 11834 3028-NO-REIN-TABLE.
 11835
 11836     MOVE ER-2615                TO WS-ERROR.
 11837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11838     GO TO 3040-EDIT-CONTINUE.
 11839
 11840 3040-EDIT-CONTINUE.
 11841
 11842     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11843         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11844
 11845     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11846         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11847
 11848     IF (NOT PB-REISSUED-CERT)
 11849        AND (NOT PB-MONTHLY-CERT)
 11850        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11851            MOVE '001'           TO PB-I-LF-TERM
 11852            MOVE 'M'             TO PB-I-INSURED-SEX.
 11853
 11854     IF (NOT PB-REISSUED-CERT)
 11855        AND (NOT PB-MONTHLY-CERT)
 11856        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11857            MOVE '001'           TO PB-I-AH-TERM
 11858            MOVE 'M'             TO PB-I-INSURED-SEX.
 11859
 11860 3040-EDIT-1ST-PMT-DT.
 11861     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11862     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 217
* EL050.cbl
 11863         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11864
 11865******************************************************************
 11866*                                                                *
 11867*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11868*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11869*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11870*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11871*                                                                *
 11872******************************************************************
 11873
 11874     IF PB-EFF-DT-PROCESSING
 11875        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11876                                    PB-I-LF-EXPIRE-DT
 11877                                    PB-I-AH-EXPIRE-DT
 11878        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11879        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11880        MOVE ZERO                TO DC-ELAPSED-DAYS
 11881        MOVE +1                  TO DC-ELAPSED-MONTHS
 11882        SET BIN-PLUS-ELAPSED     TO TRUE
 11883*       MOVE 6                   TO DC-OPTION-CODE
 11884        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11885        IF NO-CONVERSION-ERROR
 11886           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11887
 11888******************************************************************
 11889*                                                                *
 11890*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11891*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11892*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11893*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11894*                                                                *
 11895******************************************************************
 11896
 11897     IF PB-EXT-DAYS-PROCESSING
 11898          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11899                                         PB-I-LF-EXPIRE-DT
 11900                                         PB-I-AH-EXPIRE-DT
 11901          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11902          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11903          MOVE +1                     TO DC-ELAPSED-MONTHS
 11904          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11905          SET BIN-PLUS-ELAPSED        TO TRUE
 11906*         MOVE 6                      TO DC-OPTION-CODE
 11907          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11908          IF NO-CONVERSION-ERROR
 11909             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11910
 11911******************************************************************
 11912*                                                                *
 11913*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11914*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11915*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11916*        (EXPIRE DATE - (TERM -1))  *  -1.
 11917*                                                                *
 11918******************************************************************
 11919
 11920     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 218
* EL050.cbl
 11921        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11922           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11923              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11924              MOVE PB-I-AH-TERM      TO WS-TERM
 11925           ELSE
 11926              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11927              MOVE PB-I-LF-TERM      TO WS-TERM
 11928        ELSE
 11929           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11930              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11931              MOVE PB-I-LF-TERM      TO WS-TERM
 11932           ELSE
 11933              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11934              MOVE PB-I-AH-TERM      TO WS-TERM.
 11935
 11936     IF PB-EXPIRE-DT-PROCESSING
 11937        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11938        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11939        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11940        MOVE ZERO                TO DC-ELAPSED-DAYS
 11941                                    DC-ODD-DAYS-OVER
 11942          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11943          SET BIN-PLUS-ELAPSED    TO TRUE
 11944*         MOVE 6                  TO DC-OPTION-CODE
 11945          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11946          IF NO-CONVERSION-ERROR
 11947             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11948
 11949******************************************************************
 11950*                                                                *
 11951*            1ST PAYMENT DATE PROCESSING                         *
 11952*                                                                *
 11953******************************************************************
 11954
 11955     IF PB-1ST-PMT-DT-PROCESSING
 11956        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11957                                    PB-I-AH-EXPIRE-DT
 11958        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11959
 11960     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11961         NEXT SENTENCE
 11962     ELSE
 11963         MOVE ER-2680                 TO WS-ERROR
 11964         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11965         GO TO 3060-ORIG-TERM-CHECK.
 11966
 11967     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11968     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11969     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11970*    MOVE 1                      TO DC-OPTION-CODE.
 11971     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11972                                    DC-ELAPSED-DAYS
 11973                                    DC-ODD-DAYS-OVER.
 11974
 11975     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11976
 11977     IF DATE-CONVERSION-ERROR
 11978        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 219
* EL050.cbl
 11979
 11980     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11981     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11982        AND (WS-LF-COVERAGE-TYPE = 'L')
 11983        IF (DC-ELAPSED-MONTHS > 1)
 11984                      OR
 11985           ((DC-ELAPSED-MONTHS = 1)
 11986           AND (DC-ODD-DAYS-OVER > 0))
 11987           MOVE ER-2882          TO WS-ERROR
 11988           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989        END-IF
 11990     END-IF
 11991     if dc-elapsed-months > 0
 11992        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11993        + dc-odd-days-over
 11994     end-if
 11995     IF PB-EXT-DAYS-PROCESSING
 11996        CONTINUE
 11997     ELSE
 11998        IF DC-ELAPSED-MONTHS = +0
 11999           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12000        ELSE
 12001           IF (WS-LF-EARNINGS-CALC = '4')
 12002              AND (DC-ELAPSED-MONTHS > ZERO)
 12003              AND (DC-ELAPSED-DAYS > ZERO)
 12004              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12005           ELSE
 12006              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12007                                 THRU 6499-EXIT
 12008              MOVE WS-ODD-DAYS-OVER
 12009                                 TO PB-I-EXTENTION-DAYS
 12010           END-IF
 12011        END-IF
 12012     END-IF
 12013******************************************************************
 12014*                                                                *
 12015*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12016*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12017*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12018*            AND ANY ODD DAYS.                                   *
 12019*                                                                *
 12020******************************************************************
 12021
 12022     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12023                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12024     IF WS-LF-EARNINGS-CALC NOT = '4'
 12025        IF DC-ELAPSED-DAYS > ZEROS
 12026           MOVE ER-2681          TO WS-ERROR
 12027           PERFORM 9900-ERROR-FORMAT
 12028                                 THRU 9900-EXIT
 12029        END-IF
 12030     END-IF
 12031
 12032     IF WS-LF-EARNINGS-CALC NOT = '4'
 12033        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12034           MOVE ER-2681          TO WS-ERROR
 12035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12036
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 220
* EL050.cbl
 12037     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12038        (PB-I-LF-TERM NOT = ZERO) AND
 12039         NOT NO-LIFE-COVERAGE
 12040          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12041          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12042          IF WS-LF-EARNINGS-CALC = '4'
 12043             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12044             PB-I-PAY-FREQUENCY
 12045          END-IF
 12046          MOVE ZERO              TO DC-ELAPSED-DAYS
 12047                                    DC-ODD-DAYS-OVER
 12048          MOVE 1                 TO DC-END-OF-MONTH
 12049          SET BIN-PLUS-ELAPSED        TO TRUE
 12050*         MOVE 6                 TO DC-OPTION-CODE
 12051          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12052          IF NO-CONVERSION-ERROR
 12053             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12054             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12055                (WS-LF-SPECIAL-CALC-CD = 'L')
 12056                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12057                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12058                  MOVE +1             TO DC-ELAPSED-MONTHS
 12059                  SET BIN-PLUS-ELAPSED  TO TRUE
 12060*                 MOVE 6              TO DC-OPTION-CODE
 12061                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12062                  IF NO-CONVERSION-ERROR
 12063                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12064
 12065* okay, i had to move the new att age edit down here because the
 12066* expiration date could get recalculated and i need the exp date
 12067     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12068        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12069        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12070        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12071           AND ZEROS
 12072           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12073           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12074           SET ELAPSED-BETWEEN-BIN TO TRUE
 12075           PERFORM 8500-DATE-CONVERT
 12076                                 THRU 8500-EXIT
 12077           IF NO-CONVERSION-ERROR
 12078              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12079                 MOVE ER-2669       TO WS-ERROR
 12080*                PERFORM 9900-ERROR-FORMAT
 12081*                                THRU 9900-EXIT
 12082              END-IF
 12083           END-IF
 12084        ELSE
 12085           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12086           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12087              MOVE ER-2669       TO WS-ERROR
 12088*             PERFORM 9900-ERROR-FORMAT
 12089*                                THRU 9900-EXIT
 12090           ELSE
 12091              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12092                 MOVE ER-1570    TO WS-ERROR
 12093                 PERFORM 9900-ERROR-FORMAT
 12094                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 221
* EL050.cbl
 12095              END-IF
 12096           END-IF
 12097        END-IF
 12098        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12099           AND ZEROS
 12100           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12101           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12102           SET ELAPSED-BETWEEN-BIN TO TRUE
 12103           PERFORM 8500-DATE-CONVERT
 12104                                 THRU 8500-EXIT
 12105           IF NO-CONVERSION-ERROR
 12106              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12107                 MOVE ER-2669       TO WS-ERROR
 12108*                PERFORM 9900-ERROR-FORMAT
 12109*                                THRU 9900-EXIT
 12110              END-IF
 12111           END-IF
 12112        ELSE
 12113           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12114             (PB-I-LF-TERM / 12)
 12115           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12116              MOVE ER-2669       TO WS-ERROR
 12117*             PERFORM 9900-ERROR-FORMAT
 12118*                                THRU 9900-EXIT
 12119           ELSE
 12120              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12121                 MOVE ER-1571    TO WS-ERROR
 12122                 PERFORM 9900-ERROR-FORMAT
 12123                                 THRU 9900-EXIT
 12124              END-IF
 12125           END-IF
 12126        END-IF
 12127        IF WS-ERROR = ER-2669
 12128           PERFORM 9900-ERROR-FORMAT
 12129                                 THRU 9900-EXIT
 12130        END-IF
 12131     END-IF
 12132     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12133        (PB-I-AH-TERM NOT = ZERO) AND
 12134         NOT NO-AH-COVERAGE
 12135          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12136             AND (PB-COMPANY-ID = 'DCC')
 12137             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12138             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12139          ELSE
 12140             IF WS-LF-EARNINGS-CALC = '4'
 12141                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12142                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12143                PB-I-PAY-FREQUENCY
 12144             ELSE
 12145                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12146                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12147             END-IF
 12148          END-IF
 12149          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12150                                         DC-ODD-DAYS-OVER
 12151          MOVE 1                      TO DC-END-OF-MONTH
 12152          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 222
* EL050.cbl
 12153*         MOVE 6                      TO DC-OPTION-CODE
 12154          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12155          IF NO-CONVERSION-ERROR
 12156             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12157     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12158        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12159        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12160        IF PB-I-BIRTHDAY > LOW-VALUES
 12161           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12162           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12163           SET ELAPSED-BETWEEN-BIN TO TRUE
 12164           PERFORM 8500-DATE-CONVERT
 12165                                 THRU 8500-EXIT
 12166           IF NO-CONVERSION-ERROR
 12167              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12168                 MOVE ER-3054       TO WS-ERROR
 12169*                PERFORM 9900-ERROR-FORMAT
 12170*                                THRU 9900-EXIT
 12171              END-IF
 12172           END-IF
 12173        ELSE
 12174           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12175           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12176              MOVE ER-3054       TO WS-ERROR
 12177*             PERFORM 9900-ERROR-FORMAT
 12178*                                THRU 9900-EXIT
 12179           END-IF
 12180        END-IF
 12181        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12182           AND ZEROS
 12183           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12184           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12185           SET ELAPSED-BETWEEN-BIN TO TRUE
 12186           PERFORM 8500-DATE-CONVERT
 12187                                 THRU 8500-EXIT
 12188           IF NO-CONVERSION-ERROR
 12189              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12190                 MOVE ER-3054       TO WS-ERROR
 12191*                PERFORM 9900-ERROR-FORMAT
 12192*                                THRU 9900-EXIT
 12193              END-IF
 12194           END-IF
 12195        ELSE
 12196           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12197             (PB-I-AH-TERM / 12)
 12198           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12199              MOVE ER-3054       TO WS-ERROR
 12200*             PERFORM 9900-ERROR-FORMAT
 12201*                                THRU 9900-EXIT
 12202           END-IF
 12203        END-IF
 12204        IF WS-ERROR = ER-3054
 12205           PERFORM 9900-ERROR-FORMAT
 12206                                 THRU 9900-EXIT
 12207        END-IF
 12208     END-IF
 12209     MOVE SPACE                       TO DC-END-OF-MONTH.
 12210
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 223
* EL050.cbl
 12211     IF PB-COMPANY-ID = 'NCB'
 12212        GO TO 3040-EDIT-EXTENSION-DAYS.
 12213
 12214     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12215       AND
 12216        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12217        NEXT SENTENCE
 12218     ELSE
 12219        GO TO 3040-EDIT-EXTENSION-DAYS.
 12220
 12221     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12222        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12223        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12224     ELSE
 12225        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12226        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12227
 12228     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12229*    MOVE '1'      TO DC-OPTION-CODE
 12230     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12231     IF (NO-CONVERSION-ERROR)
 12232        AND (DC-ELAPSED-MONTHS > +1)
 12233        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12234        MOVE ER-2668   TO WS-ERROR
 12235        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12236
 12237 3040-EDIT-EXTENSION-DAYS.
 12238
 12239     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12240        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12241         GO TO 3050-EDIT-TERM-IN-DAYS
 12242     ELSE
 12243         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12244
 12245     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12246         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12247     ELSE
 12248        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12249           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12250           MOVE ER-2681         TO WS-ERROR
 12251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12252
 12253     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12254        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12255        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12256         GO TO 3060-ORIG-TERM-CHECK.
 12257
 12258     GO TO 3060-ORIG-TERM-CHECK.
 12259
 12260 3050-EDIT-TERM-IN-DAYS.
 12261
 12262     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12263
 12264     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12265         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12266     ELSE
 12267         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12268            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 224
* EL050.cbl
 12269            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12270
 12271     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12272                                       REMAINDER WS-WORK-TERM.
 12273     IF WS-WORK-TERM GREATER THAN ZERO
 12274         ADD +1 TO PB-I-LF-TERM.
 12275
 12276     IF NOT NO-AH-COVERAGE
 12277         MOVE ER-2684            TO WS-ERROR
 12278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12279
 12280
 12281 3060-ORIG-TERM-CHECK.
 12282
 12283******************************************************************
 12284*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12285******************************************************************
 12286
 12287     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12288        NEXT SENTENCE
 12289     ELSE
 12290        IF NOT NO-LIFE-COVERAGE
 12291           IF PB-I-LF-TERM NUMERIC
 12292              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12293              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12294              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12295                  NEXT SENTENCE
 12296           ELSE
 12297              MOVE ER-2647       TO WS-ERROR
 12298              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12299
 12300     IF NOT NO-AH-COVERAGE
 12301         IF PB-I-AH-TERM NUMERIC
 12302            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12303            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12304            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12305             NEXT SENTENCE
 12306          ELSE
 12307              MOVE ER-2658       TO WS-ERROR
 12308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12309
 12310     IF PB-COMPANY-ID = 'NCB'
 12311        GO TO 3070-LOAN-TERM-CHECK.
 12312
 12313     IF POLICY-HAS-AH
 12314       AND
 12315        POLICY-HAS-LIFE
 12316       AND
 12317        PB-I-LF-TERM NUMERIC
 12318       AND
 12319        PB-I-AH-TERM NUMERIC
 12320        NEXT SENTENCE
 12321     ELSE
 12322        GO TO 3070-LOAN-TERM-CHECK.
 12323
 12324     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12325     IF WS-TEX-FACT-2 LESS THAN +0
 12326        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 225
* EL050.cbl
 12327
 12328     IF WS-TEX-FACT-2 GREATER THAN +1
 12329        MOVE ER-2668             TO WS-ERROR
 12330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12331
 12332 3070-LOAN-TERM-CHECK.
 12333
 12334     IF (WS-LF-BENEFIT-CD = ZERO)
 12335         OR (NO-LF-BENEFIT-MATCH)
 12336            GO TO 3125-EDIT-PMT-FREQ.
 12337*    IF PB-COMPANY-ID NOT = 'DCC'
 12338*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12339*          AND 'V' AND 'W' AND 'X'
 12340*          GO TO 3125-EDIT-PMT-FREQ
 12341*       END-IF
 12342*    ELSE
 12343*       IF WS-AH-DCC-TRUNC = 'T'
 12344*          CONTINUE
 12345*       ELSE
 12346*          GO TO 3125-EDIT-PMT-FREQ
 12347*       END-IF
 12348*    END-IF
 12349     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12350                    OR
 12351        ((PB-COMPANY-ID = 'DCC')
 12352        AND (WS-AH-DCC-TRUNC = 'T'))
 12353        CONTINUE
 12354     ELSE
 12355        GO TO 3125-EDIT-PMT-FREQ
 12356     END-IF
 12357     IF PB-I-LOAN-TERM NOT NUMERIC
 12358         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12359
 12360     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12361        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12362*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12363        PB-I-LOAN-TERM NOT GREATER THAN +360
 12364         NEXT SENTENCE
 12365     ELSE
 12366         MOVE ER-2648            TO WS-ERROR
 12367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12368
 12369     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12370        MOVE ER-3058             TO WS-ERROR
 12371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372     end-if
 12373
 12374     IF WS-STATE-ABBREVIATION = 'NC'
 12375        IF PB-I-LOAN-TERM > +59
 12376           CONTINUE
 12377        ELSE
 12378           MOVE ER-2792          TO WS-ERROR
 12379           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12380        END-IF
 12381     END-IF
 12382
 12383     .
 12384 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 226
* EL050.cbl
 12385     IF (WS-LF-BENEFIT-CD = ZERO)
 12386         OR (NO-LF-BENEFIT-MATCH)
 12387            GO TO 3127-EDIT-LOAN-OFFICER.
 12388     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12389                    OR
 12390        ((PB-COMPANY-ID = 'DCC')
 12391        AND (WS-AH-DCC-TRUNC = 'T'))
 12392                    OR
 12393         (PB-COMPANY-ID = 'AHL')
 12394        CONTINUE
 12395     ELSE
 12396        IF (PB-I-LOAN-TERM > ZEROS)
 12397           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12398           MOVE ER-1575          TO WS-ERROR
 12399           PERFORM 9900-ERROR-FORMAT
 12400                                 THRU 9900-EXIT
 12401        END-IF
 12402     END-IF
 12403     IF WS-LF-EARNINGS-CALC NOT = '4'
 12404         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12405            MOVE ER-2653         TO WS-ERROR
 12406            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12407            GO TO 3127-EDIT-LOAN-OFFICER
 12408         ELSE
 12409            GO TO 3127-EDIT-LOAN-OFFICER.
 12410
 12411     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12412         MOVE ER-2655            TO WS-ERROR
 12413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12414         GO TO 3127-EDIT-LOAN-OFFICER.
 12415
 12416     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12417         MOVE ER-2654            TO WS-ERROR
 12418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12419         GO TO 3127-EDIT-LOAN-OFFICER.
 12420
 12421     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12422         GIVING WS-TEX-FACT-2
 12423             REMAINDER WS-TEX-FACT-3.
 12424
 12425*    IF WS-TEX-FACT-3 NOT = ZERO
 12426*       MOVE ER-2654             TO WS-ERROR
 12427*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12428
 12429
 12430 3127-EDIT-LOAN-OFFICER.
 12431
 12432     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12433        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12434           MOVE ER-2690          TO WS-ERROR
 12435           PERFORM 9900-ERROR-FORMAT
 12436                                 THRU 9900-EXIT
 12437        ELSE
 12438           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12439           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12440           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12441           MOVE PB-SV-STATE      TO LOFC-STATE
 12442           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 227
* EL050.cbl
 12443           MOVE PB-I-LOAN-OFFICER
 12444                                 TO LOFC-CODE
 12445           PERFORM 8586-READ-LOAN-OFFICER
 12446                                 THRU 8586-EXIT
 12447           IF (NOT LOFC-MASTER-FOUND)
 12448              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12449              MOVE ER-3006       TO WS-ERROR
 12450              PERFORM 9900-ERROR-FORMAT
 12451                                 THRU 9900-EXIT
 12452           END-IF
 12453        END-IF
 12454     END-IF
 12455     .
 12456 3129-EDIT-APR.
 12457
 12458     IF (WS-LF-BENEFIT-CD = ZERO)
 12459        OR (NO-LF-BENEFIT-MATCH)
 12460        IF PB-COMPANY-ID NOT = 'DCC'
 12461           GO TO 3130-EDIT-AGE
 12462*       ELSE
 12463*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12464*             GO TO 3130-EDIT-AGE
 12465*          END-IF
 12466        END-IF
 12467     END-IF
 12468
 12469     IF (WS-STATE-ABBREVIATION = 'OH')
 12470         AND (PB-I-RATE-CLASS NOT = 'L ')
 12471         AND (PB-I-LF-TERM GREATER THAN 60)
 12472         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12473         GO TO 3129-APR-CONT.
 12474
 12475     IF (WS-STATE-ABBREVIATION = 'RI')
 12476         AND (PB-I-LF-TERM GREATER THAN 60)
 12477         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12478         GO TO 3129-APR-CONT.
 12479
 12480     IF (WS-STATE-ABBREVIATION = 'UT')
 12481         AND (PB-I-LF-TERM GREATER THAN 62)
 12482         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12483         AND (PB-CERT-EFF-DT LESS WS-830901)
 12484         GO TO 3129-APR-CONT.
 12485
 12486     IF PB-COMPANY-ID = 'LAP'
 12487        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12488           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12489              MOVE ER-2656         TO WS-ERROR
 12490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12491              GO TO 3130-EDIT-AGE.
 12492
 12493     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12494        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12495        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12496        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12497        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12498        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12499         GO TO 3130-EDIT-AGE.
 12500
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 228
* EL050.cbl
 12501 3129-APR-CONT.
 12502     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12503         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12504         GO TO 3130-EDIT-AGE.
 12505
 12506     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12507         WS-AH-BENEFIT-CD (1:1) = 'S')
 12508        AND (PB-COMPANY-ID = 'DCC')
 12509        AND (PB-I-LOAN-APR = ZERO)
 12510        MOVE ER-2657             TO WS-ERROR
 12511        PERFORM 9900-ERROR-FORMAT
 12512                                 THRU 9900-EXIT
 12513        GO TO 3130-EDIT-AGE
 12514     END-IF
 12515     IF PB-I-LOAN-APR = ZERO
 12516        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12517     END-IF
 12518
 12519     IF PB-I-LOAN-APR = ZERO
 12520        MOVE ER-2656             TO WS-ERROR
 12521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12522        GO TO 3130-EDIT-AGE.
 12523
 12524*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12525     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12526        MOVE ER-2657             TO WS-ERROR
 12527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12528
 12529 3130-EDIT-AGE.
 12530
 12531******************************************************************
 12532*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12533******************************************************************
 12534
 12535     IF NOT NO-LIFE-COVERAGE
 12536        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12537           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12538               MOVE ER-2628             TO WS-ERROR
 12539               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12540
 12541     IF NOT NO-AH-COVERAGE
 12542        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12543           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12544               MOVE ER-2628         TO WS-ERROR
 12545               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12546
 12547 3133-SEX-CODE.
 12548     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12549         IF WS-DEFAULT-SEX = 'M'
 12550             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12551          ELSE
 12552             IF WS-DEFAULT-SEX = 'F'
 12553             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12554
 12555     IF PB-I-INSURED-SEX = '1'
 12556         MOVE 'M' TO PB-I-INSURED-SEX.
 12557
 12558     IF PB-I-INSURED-SEX = '2'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 229
* EL050.cbl
 12559         MOVE 'F' TO PB-I-INSURED-SEX.
 12560
 12561 3134-SIG-SW-EDIT.
 12562     IF PB-I-SIG-SW = SPACE
 12563         MOVE 'N'                TO  PB-I-SIG-SW.
 12564
 12565     IF PB-COMPANY-ID = 'NCL'
 12566         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12567             NEXT SENTENCE
 12568         ELSE
 12569             MOVE ER-1923        TO  WS-ERROR
 12570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12571     ELSE
 12572     IF PB-COMPANY-ID = 'CRI'
 12573         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12574             NEXT SENTENCE
 12575         ELSE
 12576             MOVE ER-2606        TO  WS-ERROR
 12577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12578     ELSE
 12579     IF PB-COMPANY-ID = 'TMS'
 12580         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12581             NEXT SENTENCE
 12582         ELSE
 12583             MOVE ER-2689        TO  WS-ERROR
 12584             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12585     ELSE
 12586         IF PB-I-SIG-SW = 'Y' OR 'N'
 12587             NEXT SENTENCE
 12588         ELSE
 12589             MOVE ER-2651        TO  WS-ERROR
 12590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12591
 12592     IF PB-COMPANY-ID = 'FLA'
 12593         IF (WS-EDIT-AGE GREATER 54  OR
 12594             WS-AH-EDIT-AGE GREATER 54)  AND
 12595            PB-I-SIG-SW = 'N'
 12596            MOVE ER-2651         TO  WS-ERROR
 12597            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12598
 12599 3135-NAME-EDIT.
 12600
 12601     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12602        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12603        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12604           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12605                                 TO PB-I-JOINT-FIRST-NAME
 12606        END-PERFORM
 12607     END-IF
 12608     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12609        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12610        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12611           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12612                                 TO PB-I-JOINT-LAST-NAME
 12613        END-PERFORM
 12614     END-IF
 12615     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12616        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 230
* EL050.cbl
 12617        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12618           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12619                                 TO PB-I-INSURED-FIRST-NAME
 12620        END-PERFORM
 12621     END-IF
 12622     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12623        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12624        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12625           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12626                                 TO PB-I-INSURED-LAST-NAME
 12627        END-PERFORM
 12628     END-IF
 12629     IF PB-I-INSURED-LAST-NAME = SPACES
 12630       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12631       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12632           MOVE ER-2660    TO WS-ERROR
 12633           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12634
 12635 3136-EDIT-SEX.
 12636
 12637******************************************************************
 12638*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12639******************************************************************
 12640
 12641     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12642        (WS-AH-SPECIAL-CALC-CD = 'O')
 12643        NEXT SENTENCE
 12644     ELSE
 12645        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12646           NEXT SENTENCE
 12647        ELSE
 12648           MOVE ER-2629            TO WS-ERROR
 12649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12650
 12651 3137-EDIT-EFF-DATE.
 12652
 12653     IF PB-REISSUED-CERT       OR
 12654        PB-POLICY-IS-DECLINED  OR
 12655        PB-POLICY-IS-VOIDED
 12656         GO TO 3139-EDIT-COVERAGE-CODES.
 12657
 12658     MOVE SPACE                  TO WS-2671-SW
 12659                                    WS-2672-SW.
 12660
 12661     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12662         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12663             MOVE ER-2703        TO WS-ERROR
 12664             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12665             GO TO 3139-EDIT-COVERAGE-CODES.
 12666
 12667     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12668         GO TO 3139-EDIT-COVERAGE-CODES.
 12669
 12670     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12671     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12672*    MOVE '1'                    TO DC-OPTION-CODE.
 12673     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12674     MOVE +0                     TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 231
* EL050.cbl
 12675                                    DC-ELAPSED-DAYS.
 12676     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12677
 12678     IF DATE-CONVERSION-ERROR
 12679         GO TO 3139-EDIT-COVERAGE-CODES.
 12680
 12681     IF DC-ELAPSED-DAYS GREATER +180
 12682         MOVE ER-2672            TO WS-ERROR
 12683         MOVE 'Y'                TO WS-2672-SW
 12684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12685     END-IF
 12686
 12687     IF WS-ERROR = ER-2671  AND
 12688        PB-COMPANY-ID  = 'LBL'
 12689        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12690        MOVE SPACE               TO WS-2671-SW
 12691        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12692
 12693     IF PB-ISSUE-DATE-FORCED  AND
 12694      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12695         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12696         MOVE ER-2673            TO WS-ERROR
 12697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12698         MOVE SPACE              TO WS-2671-SW
 12699                                    WS-2672-SW.
 12700
 12701     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12702         IF PB-ISSUE-DATE-FORCED
 12703             MOVE ER-2600          TO  WS-ERROR
 12704             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12705         ELSE
 12706             MOVE ER-2692          TO  WS-ERROR
 12707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12708
 12709
 12710 3139-EDIT-COVERAGE-CODES.
 12711
 12712     if pb-company-id not = 'AHL'
 12713        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12714           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12715           MOVE ER-2787          TO WS-ERROR
 12716           PERFORM 9900-ERROR-FORMAT
 12717                                 THRU 9900-EXIT
 12718        END-IF
 12719     end-if
 12720     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12721        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12722                                 > 250000.00
 12723           MOVE ER-2719          TO WS-ERROR
 12724           PERFORM 9900-ERROR-FORMAT
 12725                                 THRU 9900-EXIT
 12726        END-IF
 12727     END-IF
 12728
 12729     IF PB-POLICY-IS-DECLINED  OR
 12730        PB-POLICY-IS-VOIDED
 12731         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12732
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 232
* EL050.cbl
 12733     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12734        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12735         MOVE ER-2630                TO WS-ERROR
 12736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12737
 12738     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12739        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12740        PB-I-LF-PREMIUM-AMT = ZERO
 12741         GO TO 3140-CHECK-AH-FOR-ZERO.
 12742
 12743     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12744        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12745        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12746         GO TO 3140-CHECK-AH-FOR-ZERO.
 12747
 12748     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12749        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12750        MOVE ER-2631             TO WS-ERROR
 12751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12752     END-IF
 12753
 12754
 12755******************************************************************
 12756*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12757******************************************************************
 12758
 12759     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12760        NEXT SENTENCE
 12761     ELSE
 12762        IF PB-I-LF-BENEFIT-AMT = ZERO
 12763           MOVE ER-2632             TO WS-ERROR
 12764           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12765
 12766
 12767******************************************************************
 12768*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12769******************************************************************
 12770
 12771     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12772        CONTINUE
 12773     ELSE
 12774        IF PB-I-LF-PREMIUM-AMT = ZERO
 12775           IF (NOT PB-COMP-LF-PREM)
 12776              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12777              MOVE ER-2633       TO WS-ERROR
 12778              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12779           END-IF
 12780        END-IF
 12781     END-IF
 12782     .
 12783 3140-CHECK-AH-FOR-ZERO.
 12784
 12785     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12786        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12787        PB-I-AH-PREMIUM-AMT = ZERO
 12788         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12789
 12790     IF PB-COMPANY-ID = 'CSL'  AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 233
* EL050.cbl
 12791        PB-I-AH-BENEFIT-CD = ZERO  AND
 12792        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12793        PB-I-AH-PREMIUM-AMT = ZERO
 12794         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12795
 12796     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12797        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12798        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12799         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12800
 12801     IF PB-I-AH-BENEFIT-CD = ZERO
 12802         MOVE ER-2634            TO WS-ERROR
 12803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805******************************************************************
 12806*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12807******************************************************************
 12808
 12809     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12810        NEXT SENTENCE
 12811     ELSE
 12812        IF PB-I-AH-BENEFIT-AMT = ZERO
 12813           MOVE ER-2635             TO WS-ERROR
 12814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12815
 12816******************************************************************
 12817*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12818******************************************************************
 12819
 12820     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12821        NEXT SENTENCE
 12822     ELSE
 12823        IF PB-I-AH-PREMIUM-AMT = ZERO
 12824            IF NOT PB-COMP-AH-PREM
 12825                MOVE ER-2636    TO WS-ERROR
 12826                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12827
 12828
 12829 3140-EDIT-MAX-AMT-SIZES.
 12830* CUSTOM CODE FOR CLIENT    'DMD'
 12831     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12832                                     WS-RES-MUNI-TAX
 12833                                     PB-I-STATE-TAX
 12834                                     PB-I-MUNI-TAX.
 12835
 12836     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12837
 12838     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12839        GO TO 3150-RATE-OUTSTAND-BAL.
 12840
 12841     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12842        GO TO 3150-RATE-OUTSTAND-BAL.
 12843
 12844     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12845        GO TO 3150-RATE-OUTSTAND-BAL.
 12846
 12847     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12848                             OR 'RIC')
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 234
* EL050.cbl
 12849        GO TO 3150-RATE-OUTSTAND-BAL.
 12850
 12851     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12852        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12853            GO TO 3150-RATE-OUTSTAND-BAL
 12854        ELSE
 12855           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12856               GO TO 3150-RATE-OUTSTAND-BAL.
 12857
 12858     IF NOT PB-NO-MONTHS-SKIPPED
 12859        GO TO 3150-RATE-OUTSTAND-BAL.
 12860
 12861     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12862        GO TO 3150-RATE-OUTSTAND-BAL.
 12863
 12864     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12865        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12866           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12867             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12868           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12869           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12870              MOVE ER-2693     TO WS-ERROR
 12871              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12872              GO TO 3150-RATE-OUTSTAND-BAL
 12873           ELSE
 12874              GO TO 3150-RATE-OUTSTAND-BAL.
 12875
 12876 3150-RATE-OUTSTAND-BAL.
 12877
 12878* DMD RATING TEST
 12879     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12880         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12881         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12882         MOVE ER-2687                 TO WS-ERROR
 12883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12884         MOVE 'B'                     TO PB-I-OB-FLAG
 12885         GO TO 3260-EDIT-CONTINUE.
 12886
 12887     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12888         IF  WS-ERROR    EQUAL    ER-2693
 12889             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12890                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12891                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12892                 MOVE  +0            TO  WS-ERROR.
 12893
 12894     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12895         IF  WS-ERROR    EQUAL    ER-2693
 12896             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12897                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12898                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12899                 MOVE  +0            TO  WS-ERROR.
 12900
 12901     IF PLAN-MASTER-AH-SW = 'Y'
 12902        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12903            IF  WS-ERROR    EQUAL    ER-2693
 12904              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12905                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12906                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 235
* EL050.cbl
 12907                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12908                 MOVE  ER-1910           TO  WS-ERROR
 12909                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12910
 12911     IF PLAN-MASTER-AH-SW = 'Y'
 12912        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12913            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12914               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12915               MOVE  ER-1910           TO  WS-ERROR
 12916               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12917
 12918     IF PLAN-MASTER-AH-SW = 'Y'
 12919        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12920            IF  WS-ERROR    EQUAL    ER-2693
 12921                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12922                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12923                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12924                 MOVE  +0       TO  WS-ERROR.
 12925
 12926     IF WS-ERROR = ER-2693
 12927        IF PB-COMPANY-ID = 'JAL' AND
 12928           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12929           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12930           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12931
 12932     IF WS-ERROR = ER-2693
 12933        IF PB-COMPANY-ID = 'NCL'  AND
 12934           PB-I-AH-BENEFIT-CD = 'OA'
 12935           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12936           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12937
 12938     IF WS-ERROR = ER-2693
 12939        IF PB-COMPANY-ID = 'CNL' AND
 12940           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12941           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12942           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12943
 12944     IF WS-ERROR = ER-2693
 12945        IF PB-COMPANY-ID = 'HER'
 12946           IF WS-LEVEL
 12947              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12948              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12949
 12950     IF ((LF-BENEFIT-FOUND) AND
 12951         (NOT NO-LIFE-COVERAGE)  AND
 12952         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12953       OR   ((AH-BENEFIT-FOUND) AND
 12954             (NOT NO-AH-COVERAGE)    AND
 12955             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12956         NEXT SENTENCE
 12957     ELSE
 12958         GO TO 3215-EDIT-RATES.
 12959
 12960     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12961        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12962           MOVE ER-2674          TO WS-ERROR
 12963           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12964           GO TO 3215-EDIT-RATES.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 236
* EL050.cbl
 12965
 12966     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12967        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12968           MOVE ER-2674          TO WS-ERROR
 12969           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12970           GO TO 3215-EDIT-RATES.
 12971
 12972     MOVE 'B'                    TO PB-I-OB-FLAG.
 12973
 12974     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12975         NEXT SENTENCE
 12976     ELSE
 12977         IF NOT NO-LIFE-COVERAGE
 12978             IF WS-ACCT-LF-OB-RT = ZERO
 12979                MOVE ER-2641    TO WS-ERROR
 12980                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12981
 12982     IF PB-COMPANY-ID = 'CRI'
 12983       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12984         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12985         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12986         IF WS-ERROR = ER-2675
 12987            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12988            MOVE ER-2687              TO WS-ERROR
 12989            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12990         ELSE
 12991            MOVE ER-2687              TO WS-ERROR
 12992            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12993
 12994
 12995     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12996         NEXT SENTENCE
 12997     ELSE
 12998       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12999            NEXT SENTENCE
 13000       ELSE
 13001         IF NOT NO-AH-COVERAGE
 13002             IF WS-ACCT-AH-OB-RT = ZERO
 13003                MOVE ER-2642    TO WS-ERROR
 13004                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13005
 13006     IF PB-COMPANY-ID = 'CRI'
 13007       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13008         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13009         IF WS-ERROR = ER-2676
 13010            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13011            MOVE ER-2687              TO WS-ERROR
 13012            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13013         ELSE
 13014            MOVE ER-2687              TO WS-ERROR
 13015            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13016
 13017     IF PB-COMPANY-ID NOT = 'GIC'
 13018         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13019            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13020     ELSE
 13021         IF PB-I-LF-PREM-CALC = ZEROS
 13022             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 237
* EL050.cbl
 13023                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13024
 13025     IF PB-COMPANY-ID NOT = 'GIC'
 13026         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13027            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13028     ELSE
 13029         IF PB-I-AH-PREM-CALC = ZEROS
 13030             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13031                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13032
 13033     MOVE ZEROS TO PB-I-MORT-CODE.
 13034
 13035     GO TO 3260-EDIT-CONTINUE.
 13036
 13037
 13038 3215-EDIT-RATES.
 13039     IF ACCOUNT-MAST-FOUND
 13040         NEXT SENTENCE
 13041     ELSE
 13042         GO TO 3999-END-EDIT.
 13043
 13044 3220-CHECK-LF-RATES.
 13045
 13046     IF PB-COMPANY-ID = 'DCC'
 13047        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13048        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13049        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13050           AND (NOT WS-LF-CASH))
 13051                           OR
 13052           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13053           AND (NOT WS-AH-CASH)))
 13054                       AND
 13055           (PB-I-ENTRY-STATUS NOT = '5')
 13056           MOVE 'M'              TO PB-BATCH-ENTRY
 13057                                    PB-I-ENTRY-STATUS
 13058        END-IF
 13059     END-IF
 13060     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13061                                    PB-I-AH-PREM-CALC
 13062                                    PB-I-LF-ALT-PREM-CALC
 13063                                    PB-I-LF-ALT-RATE
 13064                                    PB-I-LF-REI-RATE
 13065                                    PB-I-LF-ALT-REI-RATE
 13066                                    PB-I-AH-REI-RATE
 13067                                    PB-I-TOT-FEES-CALC.
 13068
 13069     IF PB-COMPANY-ID EQUAL 'DMD'
 13070        NEXT SENTENCE
 13071     ELSE
 13072        MOVE ZEROS               TO PB-I-LF-RATE
 13073                                    PB-I-AH-RATE.
 13074
 13075     IF PB-I-TOT-FEES NOT NUMERIC
 13076        MOVE ZEROS               TO PB-I-TOT-FEES
 13077     END-IF
 13078     IF PB-I-LIVES NOT NUMERIC
 13079         MOVE ZERO               TO PB-I-LIVES.
 13080
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 238
* EL050.cbl
 13081     IF PB-I-NUM-BILLED NOT NUMERIC
 13082         MOVE ZERO               TO PB-I-NUM-BILLED.
 13083
 13084     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13085        MOVE +0                  TO PB-I-LF-PREM-TAX
 13086     END-IF
 13087
 13088     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13089        MOVE +0                  TO PB-I-AH-PREM-TAX
 13090     END-IF
 13091
 13092     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13093        PB-I-PAY-FREQUENCY = ZEROS
 13094            MOVE 12 TO CP-PAY-FREQUENCY
 13095     ELSE
 13096            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13097
 13098     IF PB-I-STATE-TAX NOT NUMERIC
 13099         MOVE ZEROS               TO PB-I-STATE-TAX.
 13100
 13101     IF PB-I-MUNI-TAX NOT NUMERIC
 13102         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13103
 13104     MOVE SPACES                 TO CP-BEN-CATEGORY
 13105     IF PB-COMPANY-ID  = 'CSL'  AND
 13106        PB-I-LF-TERM NOT = ZERO
 13107        COMPUTE WS-PAYMENT-AMT =
 13108             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13109        COMPUTE WS-CSL-AMT1 =
 13110             PB-I-LF-TERM * AM-MAX-MON-BEN
 13111        COMPUTE WS-CSL-AMT2 =
 13112             WS-PAYMENT-AMT * PB-I-LF-TERM
 13113        IF CP-PAY-FREQUENCY NOT = 12
 13114           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13115           MOVE '8' TO WS-CSL-CALC-CD
 13116        ELSE
 13117           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13118              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13119               AM-MAX-TOT-BEN
 13120               MOVE '6' TO WS-CSL-CALC-CD
 13121           ELSE
 13122              IF (WS-CSL-AMT1  GREATER THAN
 13123                 AM-MAX-TOT-BEN) AND
 13124                 (WS-CSL-AMT2  GREATER THAN
 13125                 AM-MAX-TOT-BEN)
 13126                 MOVE '7' TO WS-CSL-CALC-CD
 13127              ELSE
 13128                 MOVE '5' TO WS-CSL-CALC-CD.
 13129
 13130     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13131         NEXT SENTENCE
 13132     ELSE
 13133         GO TO 3300-CHECK-AH-RATES.
 13134
 13135*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13136
 13137     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13138        IF (PB-I-LF-CRIT-PER    EQUAL +0)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 239
* EL050.cbl
 13139              OR
 13140           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13141           MOVE ER-2618          TO WS-ERROR
 13142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13143           GO TO 3300-CHECK-AH-RATES.
 13144
 13145     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13146           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13147                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13148
 13149     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13150         MOVE ER-2687             TO WS-ERROR
 13151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13152         MOVE 'Z000'              TO PB-I-MORT-CODE
 13153         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13154         GO TO 3300-CHECK-AH-RATES.
 13155
 13156     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13157        IF PB-I-LIVES = ZERO
 13158           MOVE ER-2688          TO WS-ERROR
 13159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160
 13161     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13162
 13163     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13164     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13165     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13166     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13167     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13168     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13169     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13170     MOVE '3'                    TO CP-PROCESS-TYPE.
 13171     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13172     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13173
 13174******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13175     IF PB-COMPANY-ID EQUAL 'CDL'
 13176         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13177            CP-EARN-AS-NET-PAY)
 13178             IF PB-CERT-EFF-DT GREATER  WS-931231
 13179                 MOVE '1'        TO CP-EARNING-METHOD.
 13180*******
 13181
 13182     MOVE PB-SV-STATE            TO CP-STATE.
 13183     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13184     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13185     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13186     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13187     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13188                                    CP-RATING-BENEFIT-AMT.
 13189     IF CP-STATE-STD-ABBRV = 'OR'
 13190         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13191                                         PB-I-LF-ALT-BENEFIT-AMT.
 13192     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13193     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13194     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13195     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13196     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 240
* EL050.cbl
 13197     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13198     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13199     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13200     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13201                                    CP-REMAINING-TERM
 13202                                    CP-LOAN-TERM.
 13203
 13204     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13205         NEXT SENTENCE
 13206     ELSE
 13207         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13208             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13209                                           PB-I-LF-PREMIUM-AMT.
 13210
 13211     IF PB-COMPANY-ID EQUAL 'CSL'
 13212        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13213           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13214                                         PB-I-LF-PREMIUM-AMT.
 13215
 13216     IF PB-COMPANY-ID EQUAL 'NCB'
 13217         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13218            CP-EARN-AS-NET-PAY
 13219             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13220                 PB-I-LF-PREMIUM-AMT.
 13221
 13222     IF (CP-TRUNCATED-LIFE)
 13223        or ((pb-company-id = 'AHL')
 13224           and (pb-i-loan-term > pb-i-lf-term))
 13225        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13226
 13227     IF PB-COMPANY-ID EQUAL 'CRI'
 13228        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13229
 13230     IF CP-TERM-IS-DAYS
 13231         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13232     ELSE
 13233         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13234     IF PB-COMPANY-ID = 'DCC'
 13235        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13236        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13237        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13238        IF WS-LF-BEN-CATEGORY = 'D'
 13239           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13240           MOVE PB-I-LIFE-COMMISSION
 13241                                 TO CP-DCC-ACT-COMM
 13242           MOVE WS-LF-BEN-CATEGORY
 13243                                 TO CP-BEN-CATEGORY
 13244        END-IF
 13245        IF (CP-BENEFIT-CD (1:1) = 'P')
 13246           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13247           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13248           add pb-i-ah-premium-amt to cp-original-premium
 13249        END-IF
 13250     END-IF
 13251     IF PB-COMPANY-ID = 'CSL'
 13252         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13253         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13254         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 241
* EL050.cbl
 13255
 13256     IF PB-COMPANY-ID = 'CSL'
 13257        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13258
 13259     IF (CP-SPECIAL-CALC-CD = 'H')
 13260        OR (PB-COMPANY-ID = 'DCC')
 13261         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13262                                    TO CP-ALTERNATE-BENEFIT
 13263         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13264
 13265     IF (PB-COMPANY-ID = 'CID')
 13266        AND (WS-LF-EARNINGS-CALC = 'B')
 13267        AND (CP-STATE-STD-ABBRV = 'MN')
 13268        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13269                                 TO CP-ALTERNATE-BENEFIT
 13270        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13271     END-IF
 13272     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13273     MOVE 'R'                   TO CP-RATE-FILE.
 13274     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13275
 13276     IF CP-ERROR-RATE-NOT-FOUND
 13277        MOVE ER-2641            TO WS-ERROR
 13278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13279        GO TO 3300-CHECK-AH-RATES.
 13280
 13281     IF PB-COMPANY-ID EQUAL 'CRI'
 13282        IF CP-ERROR-NO-LIMITS-CRI
 13283           IF NOT ACCOUNT-LIFE-CHECKED
 13284              MOVE ER-2607      TO WS-ERROR
 13285              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13286
 13287******************************************************************
 13288*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13289*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13290******************************************************************
 13291
 13292* CALC LIFE AGE AT EXPIRATION.
 13293
 13294     COMPUTE WS-AGE-AT-EXPIRE =
 13295          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13296
 13297*    IF PB-STATE = 'CO' OR 'UT'
 13298*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13299*        MOVE 'F'            TO PB-FATAL-FLAG
 13300*        MOVE ER-2709        TO WS-ERROR
 13301*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13302*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13303
 13304*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13305*        MOVE 'X'            TO PB-FATAL-FLAG
 13306*        MOVE ER-2718        TO WS-ERROR
 13307*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13308*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13309
 13310* CALC A & H AGE AT EXPIRATION.
 13311
 13312     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 242
* EL050.cbl
 13313          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13314
 13315*    IF PB-STATE = 'CO' OR 'UT'
 13316*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13317*        MOVE 'F'            TO PB-FATAL-FLAG
 13318*        MOVE ER-2709        TO WS-ERROR
 13319*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13320*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13321
 13322*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13323*        MOVE 'X'            TO PB-FATAL-FLAG
 13324*        MOVE ER-2718        TO WS-ERROR
 13325*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13326*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13327
 13328     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13329        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13330
 13331     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13332        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13333
 13334     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13335        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13336
 13337     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13338         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13339         MOVE ER-2639        TO WS-ERROR
 13340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13341
 13342
 13343******************************************************************
 13344*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13345******************************************************************
 13346
 13347 PREMIUM-EDITING-IS-BYPASSED.
 13348     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13349        AND (CP-R-MAX-ATT-AGE > +0)
 13350        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13351        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13352           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13353           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13354           MOVE '1'              TO DC-OPTION-CODE
 13355           PERFORM 8500-DATE-CONVERT
 13356                                 THRU 8500-EXIT
 13357           IF NO-CONVERSION-ERROR
 13358              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13359                 MOVE ER-2661       TO WS-ERROR
 13360*                PERFORM 9900-ERROR-FORMAT
 13361*                                THRU 9900-EXIT
 13362              END-IF
 13363           END-IF
 13364        ELSE
 13365           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13366           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13367              MOVE ER-2661       TO WS-ERROR
 13368*             PERFORM 9900-ERROR-FORMAT
 13369*                                THRU 9900-EXIT
 13370           ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 243
* EL050.cbl
 13371              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13372                 MOVE ER-1570    TO WS-ERROR
 13373                 PERFORM 9900-ERROR-FORMAT
 13374                                 THRU 9900-EXIT
 13375              END-IF
 13376           END-IF
 13377        END-IF
 13378        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13379           MOVE PB-I-JOINT-BIRTHDAY
 13380                                 TO DC-BIN-DATE-1
 13381           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13382           MOVE '1'              TO DC-OPTION-CODE
 13383           PERFORM 8500-DATE-CONVERT
 13384                                 THRU 8500-EXIT
 13385           IF NO-CONVERSION-ERROR
 13386              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13387                 MOVE ER-2661       TO WS-ERROR
 13388*                PERFORM 9900-ERROR-FORMAT
 13389*                                THRU 9900-EXIT
 13390              END-IF
 13391           ELSE
 13392              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13393           END-IF
 13394        ELSE
 13395           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13396             (PB-I-LF-TERM / 12)
 13397           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13398              MOVE ER-2661       TO WS-ERROR
 13399*             PERFORM 9900-ERROR-FORMAT
 13400*                                THRU 9900-EXIT
 13401           ELSE
 13402              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13403                 MOVE ER-1571    TO WS-ERROR
 13404                 PERFORM 9900-ERROR-FORMAT
 13405                                 THRU 9900-EXIT
 13406              END-IF
 13407           END-IF
 13408        END-IF
 13409        IF WS-ERROR = ER-2661
 13410           PERFORM 9900-ERROR-FORMAT
 13411                                 THRU 9900-EXIT
 13412        END-IF
 13413     END-IF
 13414*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13415*       MOVE ER-2661             TO WS-ERROR
 13416*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13417
 13418     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13419        MOVE ER-2662             TO WS-ERROR
 13420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13421
 13422     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13423        MOVE ER-2677             TO WS-ERROR
 13424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13425
 13426     IF CP-ERROR-LOAN-TERM
 13427        MOVE ER-2648             TO WS-ERROR
 13428        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 244
* EL050.cbl
 13429
 13430 3221-CHECK-ERROR-RATE-OPEN.
 13431
 13432     IF CP-ERROR-RATE-FILE-NOTOPEN
 13433         GO TO 3990-FILES-NOT-OPEN.
 13434
 13435     IF PB-COMPANY-ID NOT = 'DMD'
 13436        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13437     END-IF
 13438     .
 13439 3221-CONTINUE.
 13440     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13441                                    WS-DCC-AH-RATE
 13442     IF PB-COMPANY-ID = 'DCC'
 13443        IF WS-LF-BEN-CATEGORY = 'D'
 13444           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13445              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13446        END-IF
 13447     END-IF
 13448     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13449*   X'A4FF' = 12/31/2009
 13450     IF (PB-COMPANY-ID = 'CID')
 13451        AND (WS-LF-EARNINGS-CALC = 'B')
 13452        AND (CP-STATE-STD-ABBRV = 'MN')
 13453        AND (PB-CERT-EFF-DT > X'A4FF')
 13454        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13455     END-IF
 13456     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13457
 13458     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13459     IF (PB-COMPANY-ID = 'DCC')
 13460        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13461        AND (PB-I-POLICY-IS-MONTHLY)
 13462        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13463        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13464     END-IF
 13465     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13466     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13467     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13468     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13469     IF (PB-COMPANY-ID = 'DCC')
 13470        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13471        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13472        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13473        MOVE ER-2786             TO WS-ERROR
 13474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13475     END-IF
 13476
 13477     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13478
 13479******************************************************************
 13480*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13481******************************************************************
 13482     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13483        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13484
 13485     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13486        GO TO 3225-CHECK-ALT-LIFE-RATE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 245
* EL050.cbl
 13487     ELSE
 13488       IF PB-I-LF-RATE = ZERO
 13489          MOVE ER-2641          TO WS-ERROR
 13490          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13491
 13492 3225-CHECK-ALT-LIFE-RATE.
 13493
 13494     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13495        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13496        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13497         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13498
 13499     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13500         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13501             AND PB-COMPANY-ID NOT = 'DCC')
 13502                   OR
 13503              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13504              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13505              AND PB-COMPANY-ID NOT = 'DCC')
 13506             MOVE ER-2720        TO  WS-ERROR
 13507             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13508             GO TO 3225-RATING-CONT
 13509         ELSE
 13510             GO TO 3225-RATING-CONT.
 13511     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13512        AND (AM-GPCD = 01 OR 06 OR 15)
 13513        MOVE ER-2798             TO WS-ERROR
 13514        PERFORM 9900-ERROR-FORMAT
 13515                                 THRU 9900-EXIT
 13516*       GO TO 3225-RATING-CONT
 13517     END-IF
 13518     IF (PB-COMPANY-ID = 'CID')
 13519        AND (WS-LF-EARNINGS-CALC = 'B')
 13520        AND (CP-STATE-STD-ABBRV = 'MN')
 13521        AND (PB-CERT-EFF-DT > X'A4FF')
 13522        GO TO 3225-RATING-CONT
 13523     END-IF
 13524     IF PB-COMPANY-ID = 'DCC'
 13525        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13526           AND (PB-I-POLICY-IS-MONTHLY)
 13527           GO TO 3225-RATING-CONT
 13528        END-IF
 13529     END-IF
 13530
 13531     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13532        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13533        CP-EARN-AS-REG-BALLOON
 13534        NEXT SENTENCE
 13535     ELSE
 13536        MOVE '2'                 TO CP-EARNING-METHOD.
 13537
 13538 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13539
 13540     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13541
 13542     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13543        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13544        (CP-SPECIAL-CALC-CD EQUAL 'H')
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 246
* EL050.cbl
 13545         NEXT SENTENCE
 13546     ELSE
 13547         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13548
 13549     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13550     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13551     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13552                                     CP-RATING-BENEFIT-AMT.
 13553     IF CP-STATE-STD-ABBRV = 'OR'
 13554         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13555                                         PB-I-LF-ALT-BENEFIT-AMT.
 13556     IF PB-COMPANY-ID = 'DCC'
 13557        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13558     END-IF
 13559     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13560     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13561     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13562                                    CP-REMAINING-TERM
 13563                                    CP-LOAN-TERM.
 13564     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13565        ADD +1                   TO CP-ORIGINAL-TERM
 13566                                    CP-REMAINING-TERM
 13567                                    CP-LOAN-TERM.
 13568
 13569     MOVE 'R'                   TO CP-RATE-FILE.
 13570     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13571
 13572     IF CP-ERROR-RATE-NOT-FOUND
 13573         MOVE ER-2641            TO WS-ERROR
 13574         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13575         GO TO 3300-CHECK-AH-RATES.
 13576
 13577     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13578     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13579
 13580     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13581         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13582
 13583     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13584                               + PB-I-LF-ALT-BENEFIT-AMT.
 13585
 13586     IF ACCOUNT-LIFE-CHECKED  OR
 13587        PB-POLICY-IS-VOIDED   OR
 13588        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13589        GO TO 3225-CONTINUE.
 13590
 13591     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13592        GO TO 3225-CONTINUE.
 13593
 13594     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13595                             EC-RT-LF-MAX-TOT-BEN
 13596        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13597        MOVE ER-2639       TO WS-ERROR
 13598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13599
 13600 3225-CONTINUE.
 13601     IF PB-I-LF-ALT-RATE = ZERO
 13602         MOVE ER-2659            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 247
* EL050.cbl
 13603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13604
 13605     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13606        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13607        MOVE ER-2698             TO WS-ERROR
 13608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13609
 13610 3225-RATING-CONT.
 13611
 13612     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13613         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13614         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13615         IF (PB-COMPANY-ID = 'DCC')
 13616            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13617            CONTINUE
 13618         ELSE
 13619            MOVE ER-2687         TO WS-ERROR
 13620            PERFORM 9900-ERROR-FORMAT
 13621                                 THRU 9900-EXIT
 13622         END-IF
 13623         GO TO 3290-EDIT-LF-REIN-RATE
 13624     END-IF
 13625
 13626* DMD RATING TEST
 13627     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13628         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13629         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13630         MOVE ER-2687                 TO WS-ERROR
 13631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13632         GO TO 3290-EDIT-LF-REIN-RATE.
 13633
 13634 3230-CLIENT-MORT-CD-SPECIALS.
 13635
 13636     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13637     SET BIN-TO-GREG          TO TRUE.
 13638*    MOVE ' '                 TO DC-OPTION-CODE.
 13639     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13640     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13641
 13642 C-POS-3230-MORT-CD.
 13643     IF PB-COMPANY-ID = 'POS' AND
 13644        PB-SV-CARRIER = '2'
 13645         NEXT SENTENCE
 13646     ELSE
 13647         GO TO C-POS-3240-MORT-CD.
 13648
 13649     IF PB-SV-GROUPING = '030'
 13650        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13651         MOVE '2350' TO PB-I-MORT-CODE
 13652      ELSE
 13653         MOVE '3300' TO PB-I-MORT-CODE.
 13654
 13655
 13656 C-POS-3240-MORT-CD.
 13657     IF PB-COMPANY-ID = 'POS' AND
 13658        PB-SV-CARRIER = '1'
 13659         NEXT SENTENCE
 13660     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 248
* EL050.cbl
 13661         GO TO 3230-CONTINUE.
 13662
 13663     IF PB-SV-STATE = '45' OR '47'
 13664        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13665         MOVE '5200' TO PB-I-MORT-CODE
 13666     ELSE
 13667         MOVE '8300' TO PB-I-MORT-CODE.
 13668
 13669 3230-CONTINUE.
 13670
 13671     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13672        GO TO 3240-CONTINUE
 13673     END-IF
 13674
 13675     IF PB-CERT-EFF-DT > WS-971231
 13676        GO TO 3240-CONTINUE
 13677     END-IF
 13678
 13679     IF LF-BENEFIT-FOUND AND
 13680        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13681         MOVE 'F250'       TO PB-I-MORT-CODE
 13682     ELSE
 13683         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13684             MOVE '7250'   TO PB-I-MORT-CODE
 13685         ELSE
 13686             MOVE '4251'   TO PB-I-MORT-CODE
 13687         END-IF
 13688     END-IF
 13689
 13690     .
 13691 3240-CONTINUE.
 13692
 13693     IF PB-COMPANY-ID NOT = 'GNL'
 13694         GO TO 3256-CONTINUE.
 13695
 13696     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13697         MOVE 'A300' TO PB-I-MORT-CODE
 13698     ELSE
 13699         MOVE '8350' TO PB-I-MORT-CODE.
 13700
 13701 3256-CONTINUE.
 13702     IF PB-COMPANY-ID NOT = 'ABL'
 13703         GO TO 3260-EDIT-CONTINUE.
 13704
 13705     IF PB-I-LF-TERM GREATER THAN 59
 13706         MOVE 'F550' TO PB-I-MORT-CODE
 13707     ELSE
 13708         MOVE 'E550' TO PB-I-MORT-CODE.
 13709
 13710 3260-EDIT-CONTINUE.
 13711     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13712
 13713 3290-EDIT-LF-REIN-RATE.
 13714     IF LF-REIN-NSP-NOT-USED
 13715         GO TO 3290-RATING-CONT.
 13716
 13717     IF PB-COMPANY-ID = 'DCC'
 13718        GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 249
* EL050.cbl
 13719     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13720     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13721     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13722     MOVE '3'                   TO CP-PROCESS-TYPE.
 13723     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13724
 13725******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13726     IF PB-COMPANY-ID EQUAL 'CDL'
 13727         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13728            CP-EARN-AS-NET-PAY)
 13729             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13730*            MOVE SPACE          TO DC-OPTION-CODE
 13731             SET BIN-TO-GREG     TO TRUE
 13732             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13733***  Y2K PROJ 7744
 13734             IF DC-GREG-DATE-CYMD GREATER 19931231
 13735                 MOVE '1'        TO CP-EARNING-METHOD.
 13736***  Y2K PROJ 7744
 13737*******
 13738
 13739     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13740     MOVE PB-SV-STATE           TO CP-STATE.
 13741     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13742     MOVE ZERO                  TO CP-DEVIATION-CODE
 13743                                   CP-RATE-DEV-PCT.
 13744     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13745     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13746                                   CP-RATING-BENEFIT-AMT.
 13747
 13748************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13749     IF PB-COMPANY-ID EQUAL 'NCB'
 13750         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13751            CP-EARN-AS-NET-PAY
 13752             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13753                 PB-I-LF-PREMIUM-AMT.
 13754************
 13755
 13756     IF CP-STATE-STD-ABBRV = 'OR'
 13757         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13758                                         PB-I-LF-ALT-BENEFIT-AMT.
 13759     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13760     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13761     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13762     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13763     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13764     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13765     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13766     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13767                                   CP-REMAINING-TERM
 13768                                   CP-LOAN-TERM.
 13769     IF CP-TRUNCATED-LIFE
 13770        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13771
 13772     IF CP-TERM-IS-DAYS
 13773         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13774     ELSE
 13775         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13776
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 250
* EL050.cbl
 13777     IF PB-COMPANY-ID = 'DCC'
 13778        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13779     END-IF
 13780     IF PB-COMPANY-ID NOT = 'TIC'
 13781          MOVE ZERO          TO CP-CLASS-CODE.
 13782
 13783     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13784
 13785     MOVE 'R'                   TO CP-RATE-FILE.
 13786     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13787
 13788     IF CP-ERROR-RATE-NOT-FOUND
 13789        IF PB-I-OB
 13790           MOVE ER-2625      TO WS-ERROR
 13791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13792           GO TO 3299-EDIT-CONTINUE
 13793        ELSE
 13794           MOVE ER-2643      TO WS-ERROR
 13795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796           GO TO 3299-EDIT-CONTINUE.
 13797
 13798     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13799
 13800     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13801     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13802
 13803     IF PB-I-LF-REI-RATE = ZERO
 13804         MOVE ER-2643        TO WS-ERROR
 13805         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13806
 13807 3290-CHECK-ALT-REIN-RATE.
 13808
 13809     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13810        GO TO 3290-RATING-CONT.
 13811
 13812     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13813     MOVE '2'                    TO CP-EARNING-METHOD.
 13814     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13815     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13816     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13817     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13818                                     CP-RATING-BENEFIT-AMT.
 13819     IF CP-STATE-STD-ABBRV = 'OR'
 13820         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13821                                         PB-I-LF-ALT-BENEFIT-AMT.
 13822     IF PB-COMPANY-ID = 'DCC'
 13823        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13824     END-IF
 13825     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13826     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13827     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13828                                    CP-REMAINING-TERM
 13829                                    CP-LOAN-TERM.
 13830     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13831        ADD +1                   TO CP-ORIGINAL-TERM
 13832                                    CP-REMAINING-TERM
 13833                                    CP-LOAN-TERM.
 13834
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 251
* EL050.cbl
 13835     MOVE 'R'                   TO CP-RATE-FILE.
 13836     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13837
 13838     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13839
 13840     IF PB-I-LF-ALT-REI-RATE = ZERO
 13841         MOVE ER-2643            TO WS-ERROR
 13842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13843
 13844 3290-RATING-CONT.
 13845
 13846     IF PB-I-OB
 13847*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13848        GO TO 3300-CHECK-AH-RATES.
 13849
 13850 3299-EDIT-CONTINUE.
 13851
 13852     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13853         NEXT SENTENCE
 13854     ELSE
 13855         MOVE ER-2620           TO WS-ERROR
 13856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13857
 13858 3300-CHECK-AH-RATES.
 13859     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13860         NEXT SENTENCE
 13861     ELSE
 13862         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13863
 13864     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13865        ((CF-COMPANY-ID = 'DMD') AND
 13866                (NO-DMD-RATING))
 13867         IF (PB-COMPANY-ID = 'DCC')
 13868            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13869            CONTINUE
 13870         ELSE
 13871            MOVE ER-2687         TO WS-ERROR
 13872            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13873         END-IF
 13874         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13875         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13876     END-IF
 13877
 13878     IF PB-I-OB
 13879        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13880
 13881     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13882         MOVE ER-2687             TO WS-ERROR
 13883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13884         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13885         GO TO 3999-END-EDIT.
 13886
 13887*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13888
 13889     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13890        IF PB-I-AH-CRIT-PER = ZERO
 13891           IF PB-COMPANY-ID = 'DCC'
 13892              AND AM-DCC-PRODUCT-CODE = 'DDF'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 252
* EL050.cbl
 13893              CONTINUE
 13894           ELSE
 13895              MOVE ER-2618       TO WS-ERROR
 13896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13897              GO TO 3999-END-EDIT
 13898           END-IF
 13899        END-IF
 13900     END-IF
 13901     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13902     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13903     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13904     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13905     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13906     MOVE PB-SV-STATE            TO CP-STATE.
 13907     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13908     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13909     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13910*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13911     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13912     MOVE '3'                    TO CP-PROCESS-TYPE.
 13913     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13914     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13915                                    CP-RATING-BENEFIT-AMT.
 13916     IF PB-COMPANY-ID = 'CID'
 13917               OR
 13918        CP-STATE-STD-ABBRV = 'OR'
 13919         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13920                                         PB-I-AH-TERM.
 13921     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13922        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13923           AND (PB-I-POLICY-IS-MONTHLY)
 13924           MOVE PB-I-LF-BENEFIT-AMT
 13925                                 TO CP-NET-BENEFIT-AMT
 13926           move pb-i-ah-premium-amt to cp-original-premium
 13927           add pb-i-lf-premium-amt to cp-original-premium
 13928        END-IF
 13929     END-IF
 13930     MOVE SPACES                 TO CP-BEN-CATEGORY
 13931     IF PB-COMPANY-ID = 'DCC'
 13932        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13933        EVALUATE TRUE
 13934           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13935              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13936              MOVE PB-I-LF-BENEFIT-AMT
 13937                                 TO CP-RATING-BENEFIT-AMT
 13938              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13939           WHEN WS-AH-BEN-CATEGORY = 'G'
 13940              MOVE PB-I-UNPAID-CASH-PRICE
 13941                                 TO CP-RATING-BENEFIT-AMT
 13942           WHEN WS-AH-BEN-CATEGORY = 'D'
 13943              MOVE WS-AH-PMF-COMM
 13944                                 TO CP-DCC-PMF-COMM
 13945              MOVE PB-I-AH-COMMISSION
 13946                                 TO CP-DCC-ACT-COMM
 13947        END-EVALUATE
 13948     END-IF
 13949     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13950     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 253
* EL050.cbl
 13951     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13952     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13953     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13954     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13955     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13956                                    CP-REMAINING-TERM
 13957                                    WS-WORK-TERM.
 13958     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13959
 13960     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13961     SET BIN-TO-GREG             TO TRUE.
 13962*    MOVE ' '                    TO DC-OPTION-CODE.
 13963     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13964     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13965
 13966     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13967     IF NOT VALID-SKIP-CODE
 13968         MOVE ER-2683            TO WS-ERROR
 13969         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13970         GO TO 3320-RATE-CONTINUE.
 13971
 13972     IF PB-NO-MONTHS-SKIPPED
 13973         GO TO 3320-RATE-CONTINUE.
 13974
 13975     MOVE SPACE TO NUMBER-OF-MONTHS.
 13976
 13977     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13978         MOVE 'S'                TO SK-MO (6).
 13979     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13980         MOVE 'S'                TO SK-MO (7).
 13981     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13982         MOVE 'S'                TO SK-MO (8).
 13983     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13984         MOVE 'S'                TO SK-MO (9).
 13985     IF PB-I-SKIP-CODE = 'A'
 13986         MOVE 'S'                TO SK-MO (10).
 13987
 13988     MOVE 1                      TO SUB2.
 13989     MOVE PB-I-AH-TERM           TO SUB3.
 13990     MOVE WS-MONTH               TO SUB1.
 13991     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13992     GO TO 3320-RATE-CONTINUE.
 13993
 13994 3310-GET-SKIP-MO.
 13995     IF SUB1 = 13
 13996         MOVE 1                  TO SUB1.
 13997
 13998     IF SK-MO (SUB1) = 'S'
 13999         SUBTRACT 1 FROM WS-WORK-TERM.
 14000
 14001     ADD 1 TO SUB2
 14002              SUB1.
 14003
 14004 3320-RATE-CONTINUE.
 14005
 14006     IF WS-WORK-TERM = ZERO
 14007         MOVE 1                  TO WS-WORK-TERM.
 14008
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 254
* EL050.cbl
 14009     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14010                                    CP-LOAN-TERM.
 14011
 14012     IF PB-COMPANY-ID EQUAL 'DMD'
 14013         NEXT SENTENCE
 14014     ELSE
 14015         MOVE ZERO               TO PB-I-AH-RATE
 14016                                    PB-I-AH-REI-RATE.
 14017
 14018
 14019     IF PB-COMPANY-ID EQUAL 'CRI'
 14020        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14021
 14022     IF PB-COMPANY-ID = 'CSL'
 14023         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14024         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14025         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14026         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14027
 14028     IF PB-COMPANY-ID = 'DCC'
 14029        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14030           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14031              PB-I-RATE-DEV-PCT-LF
 14032        END-IF
 14033        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14034                                 TO CP-ALTERNATE-BENEFIT
 14035        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14036        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14037        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14038     END-IF
 14039     IF (PB-COMPANY-ID = 'CID')
 14040        AND (WS-LF-EARNINGS-CALC = 'B')
 14041        AND (CP-STATE-STD-ABBRV = 'MN')
 14042        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14043     ELSE
 14044        MOVE ' '                 TO CP-AH-BALLOON-SW
 14045     END-IF
 14046     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14047     MOVE 'R'                   TO CP-RATE-FILE.
 14048     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14049
 14050     IF CP-ERROR-RATE-NOT-FOUND
 14051        IF PB-I-OB
 14052           MOVE ER-2624          TO WS-ERROR
 14053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054           GO TO 3340-CALCULATE-PREMIUM-AMT
 14055        ELSE
 14056          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14057              NEXT SENTENCE
 14058          ELSE
 14059           MOVE ER-2642          TO WS-ERROR
 14060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14061           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14062
 14063     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14064        CP-ERROR-DIV-BY-ZERO
 14065           MOVE ER-3782          TO WS-ERROR
 14066           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 255
* EL050.cbl
 14067
 14068     IF PB-COMPANY-ID EQUAL 'CRI'
 14069        IF CP-ERROR-NO-LIMITS-CRI
 14070           IF NOT ACCOUNT-AH-CHECKED
 14071              MOVE ER-2607          TO WS-ERROR
 14072              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14073
 14074     IF ACCOUNT-AH-CHECKED
 14075        NEXT SENTENCE
 14076     ELSE
 14077       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14078          MOVE ER-2640           TO WS-ERROR
 14079          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14080
 14081     IF PB-COMPANY-ID = 'CRI'
 14082         IF WS-ERROR = ER-2640
 14083             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14084     IF ACCOUNT-AH-CHECKED
 14085        CONTINUE
 14086     ELSE
 14087        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14088           AND (CP-R-MAX-ATT-AGE > +0)
 14089           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14090           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14091              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14092              MOVE PB-I-AH-EXPIRE-DT
 14093                                 TO DC-BIN-DATE-2
 14094              MOVE '1'           TO DC-OPTION-CODE
 14095              PERFORM 8500-DATE-CONVERT
 14096                                 THRU 8500-EXIT
 14097              IF NO-CONVERSION-ERROR
 14098                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14099                    MOVE ER-2661       TO WS-ERROR
 14100*                   PERFORM 9900-ERROR-FORMAT
 14101*                                THRU 9900-EXIT
 14102                 END-IF
 14103              END-IF
 14104           ELSE
 14105              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14106              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14107                 MOVE ER-2661    TO WS-ERROR
 14108*                PERFORM 9900-ERROR-FORMAT
 14109*                                THRU 9900-EXIT
 14110              ELSE
 14111                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14112                    MOVE ER-1570 TO WS-ERROR
 14113                    PERFORM 9900-ERROR-FORMAT
 14114                                 THRU 9900-EXIT
 14115                 END-IF
 14116              END-IF
 14117           END-IF
 14118           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14119              MOVE PB-I-JOINT-BIRTHDAY
 14120                                    TO DC-BIN-DATE-1
 14121              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14122              MOVE '1'              TO DC-OPTION-CODE
 14123              PERFORM 8500-DATE-CONVERT
 14124                                    THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 256
* EL050.cbl
 14125              IF NO-CONVERSION-ERROR
 14126                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14127                    MOVE ER-2661       TO WS-ERROR
 14128*                   PERFORM 9900-ERROR-FORMAT
 14129*                                   THRU 9900-EXIT
 14130                 END-IF
 14131              END-IF
 14132           ELSE
 14133              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14134                (PB-I-AH-TERM / 12)
 14135              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14136                 MOVE ER-2661       TO WS-ERROR
 14137*                PERFORM 9900-ERROR-FORMAT
 14138*                                   THRU 9900-EXIT
 14139              ELSE
 14140                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14141                    MOVE ER-1571 TO WS-ERROR
 14142                    PERFORM 9900-ERROR-FORMAT
 14143                                 THRU 9900-EXIT
 14144                 END-IF
 14145              END-IF
 14146           END-IF
 14147           IF WS-ERROR = ER-2661
 14148              PERFORM 9900-ERROR-FORMAT
 14149                                    THRU 9900-EXIT
 14150           END-IF
 14151        END-IF
 14152     END-IF
 14153*    IF ACCOUNT-AH-CHECKED
 14154*       NEXT SENTENCE
 14155*    ELSE
 14156*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14157*          MOVE ER-2661          TO WS-ERROR
 14158*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14159
 14160     IF ACCOUNT-AH-CHECKED
 14161        NEXT SENTENCE
 14162     ELSE
 14163        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14164           MOVE ER-2663          TO WS-ERROR
 14165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14166
 14167     IF ACCOUNT-AH-CHECKED OR
 14168        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14169         PB-POLICY-IS-VOIDED
 14170        NEXT SENTENCE
 14171     ELSE
 14172        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14173           MOVE ER-2667            TO WS-ERROR
 14174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14175
 14176     IF PB-COMPANY-ID = 'CRI'
 14177         IF WS-ERROR = ER-2667
 14178             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14179
 14180     IF ACCOUNT-AH-CHECKED
 14181        NEXT SENTENCE
 14182     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 257
* EL050.cbl
 14183        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14184           MOVE ER-2678            TO WS-ERROR
 14185           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14186
 14187     IF CP-ERROR-RATE-FILE-NOTOPEN
 14188         GO TO 3990-FILES-NOT-OPEN.
 14189
 14190 3321-CONTINUE.
 14191     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14192     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14193     IF (PB-COMPANY-ID = 'DCC')
 14194        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14195        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14196                                    PB-I-LF-ALT-PREM-CALC
 14197        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14198        IF WS-AH-BEN-CATEGORY = 'G'
 14199           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14200           + PB-I-ADDL-CLP)
 14201           * (1 + WS-TOL-CLP-PCT)
 14202*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14203        ELSE
 14204           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14205           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14206*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14207        END-IF
 14208        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14209                                 TO PB-I-AH-PREM-CALC
 14210        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14211           MOVE ER-8152          TO WS-ERROR
 14212           PERFORM 9900-ERROR-FORMAT
 14213                                 THRU 9900-EXIT
 14214        ELSE
 14215           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14216                 PB-I-ADDL-CLP)
 14217              MOVE ER-8148       TO WS-ERROR
 14218              PERFORM 9900-ERROR-FORMAT
 14219                                 THRU 9900-EXIT
 14220           END-IF
 14221        END-IF
 14222     END-IF
 14223     IF (PB-COMPANY-ID = 'DCC')
 14224        AND (PB-I-POLICY-IS-MONTHLY)
 14225        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14226        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14227        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14228           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14229        END-IF
 14230     END-IF
 14231     IF (PB-COMPANY-ID = 'DCC')
 14232        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14233        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14234        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14235        MOVE ER-2786             TO WS-ERROR
 14236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14237     END-IF
 14238     MOVE +0                     TO PB-I-AH-CLP
 14239     IF PB-COMPANY-ID = 'DCC'
 14240        IF WS-AH-BEN-CATEGORY = 'D'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 258
* EL050.cbl
 14241           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14242              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14243        ELSE
 14244           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14245              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14246           END-IF
 14247        END-IF
 14248     END-IF
 14249     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14250
 14251     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14252         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14253
 14254     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14255         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14256
 14257     IF PB-COMPANY-ID = 'CRI'
 14258         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14259            PB-I-PAYMENT-AMOUNT = ZERO
 14260             NEXT SENTENCE
 14261         ELSE
 14262             COMPUTE PB-I-AH-PREM-CALC =
 14263                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14264                 (CP-PREMIUM-RATE / 100)
 14265             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14266                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14267                                             PB-I-RATE-DEV-PCT-AH.
 14268
 14269     IF PB-I-AH-RATE  = ZERO
 14270       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14271           NEXT SENTENCE
 14272       ELSE
 14273         MOVE ER-2642            TO WS-ERROR
 14274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14275
 14276     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14277     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14278     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14279     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14280     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14281     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14282
 14283     IF (PB-COMPANY-ID = 'DCC')
 14284        AND (WS-AH-BEN-CATEGORY = 'G')
 14285        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14286        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14287        IF CP-DEVIATION-CODE NOT = '000'
 14288           MOVE '000'            TO CP-DEVIATION-CODE
 14289           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14290           IF NO-CP-ERROR
 14291              COMPUTE PB-I-DDF-IU-RATE-UP =
 14292              PB-I-AH-CLP - CP-CALC-PREMIUM
 14293           ELSE
 14294              MOVE ER-3057        TO WS-ERROR
 14295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14296           END-IF
 14297        END-IF
 14298     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 259
* EL050.cbl
 14299     .
 14300 3335-EDIT-AH-REIN-NSP-RATE.
 14301     IF AH-REIN-NSP-NOT-USED
 14302         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14303
 14304     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14305     IF PB-COMPANY-ID = 'DCC'
 14306         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14307     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14308     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14309     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14310     MOVE PB-SV-STATE            TO CP-STATE.
 14311     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14312     MOVE ZERO                   TO CP-DEVIATION-CODE
 14313                                    CP-RATE-DEV-PCT.
 14314*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14315     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14316     MOVE '3'                    TO CP-PROCESS-TYPE.
 14317     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14318     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14319                                    CP-RATING-BENEFIT-AMT.
 14320     IF CP-STATE-STD-ABBRV = 'OR'
 14321         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14322                                         PB-I-AH-TERM.
 14323     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14324     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14325     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14326     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14327     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14328     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14329                                    CP-REMAINING-TERM
 14330                                    WS-WORK-TERM.
 14331     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14332     IF PB-COMPANY-ID = 'DCC'
 14333        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14334     END-IF
 14335     IF  PB-COMPANY-ID = 'TIC'
 14336         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14337            MOVE ZERO TO CP-CLASS-CODE.
 14338
 14339     IF PB-COMPANY-ID NOT = 'TIC'
 14340          MOVE ZERO          TO CP-CLASS-CODE.
 14341
 14342     MOVE ZERO               TO CP-DEVIATION-CODE.
 14343
 14344     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14345
 14346     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14347
 14348     MOVE 'R'                   TO CP-RATE-FILE.
 14349     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14350
 14351     IF CP-ERROR-RATE-NOT-FOUND
 14352         MOVE ER-2645        TO WS-ERROR
 14353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14354         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14355
 14356     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 260
* EL050.cbl
 14357
 14358     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14359     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14360
 14361     IF PB-I-AH-REI-RATE = ZERO
 14362         MOVE ER-2645        TO WS-ERROR
 14363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14364
 14365
 14366 3340-CALCULATE-PREMIUM-AMT.
 14367
 14368     IF PB-COMPANY-ID = 'NCL'
 14369         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14370             WS-AH-SPECIAL-CALC-CD = 'O')
 14371             GO TO 3999-END-EDIT.
 14372
 14373     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14374                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14375                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14376                         OR 'AHL'
 14377         NEXT SENTENCE
 14378     ELSE
 14379         IF WS-STATE-ABBREVIATION = 'CT'
 14380             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14381                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14382                 COMPUTE PB-I-LF-PREM-CALC =
 14383                                     PB-I-LF-PREM-CALC * .90
 14384                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14385                                     PB-I-LF-ALT-PREM-CALC * .90
 14386                 COMPUTE PB-I-AH-PREM-CALC =
 14387                                     PB-I-AH-PREM-CALC * .90.
 14388
 14389     IF PB-COMP-LF-PREM
 14390        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14391        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14392
 14393     IF PB-COMP-AH-PREM
 14394        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14395
 14396 3340-CHECK-DCC-TOT-FEES.
 14397     IF (PB-COMPANY-ID = 'DCC')
 14398        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14399        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14400        AND (PB-I-POLICY-IS-MONTHLY)
 14401        CONTINUE
 14402     ELSE
 14403        GO TO 3340-EDIT-LF-AH-TOL
 14404     END-IF
 14405     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14406     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14407     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14408        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14409           PB-I-RATE-DEV-PCT-LF
 14410     END-IF
 14411     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14412        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14413           PB-I-RATE-DEV-PCT-AH
 14414     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 261
* EL050.cbl
 14415     MOVE 'N'                    TO CP-BEN-CATEGORY
 14416     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14417
 14418     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14419     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14420     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14421     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14422     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14423     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14424     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14425     MOVE '3'                    TO CP-PROCESS-TYPE.
 14426     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14427     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14428
 14429     MOVE PB-SV-STATE            TO CP-STATE.
 14430     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14431     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14432     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14433     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14434     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14435                                    CP-RATING-BENEFIT-AMT.
 14436     IF CP-STATE-STD-ABBRV = 'OR'
 14437         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14438                                         PB-I-LF-ALT-BENEFIT-AMT.
 14439     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14440     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14441     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14442     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14443     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14444     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14445     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14446     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14447     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14448                                    CP-REMAINING-TERM
 14449                                    CP-LOAN-TERM.
 14450     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14451         NEXT SENTENCE
 14452     ELSE
 14453         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14454             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14455                                           PB-I-LF-PREMIUM-AMT.
 14456
 14457     IF CP-TRUNCATED-LIFE
 14458        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14459
 14460     IF CP-TERM-IS-DAYS
 14461         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14462     ELSE
 14463         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14464
 14465     IF PB-COMPANY-ID = 'DCC'
 14466        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14467     END-IF
 14468     IF CP-SPECIAL-CALC-CD = 'H'
 14469         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14470                                    TO CP-ALTERNATE-BENEFIT
 14471         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14472     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 262
* EL050.cbl
 14473     MOVE 'R'                    TO CP-RATE-FILE
 14474     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14475     IF NOT CP-ERROR-RATE-NOT-FOUND
 14476        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14477        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14478           AND (CP-BENEFIT-CD (1:1) = 'S')
 14479           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14480                                    PB-I-LF-PREMIUM-AMT
 14481        END-IF
 14482     ELSE
 14483        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14484     END-IF
 14485     .
 14486 3340-EDIT-LF-AH-TOL.
 14487
 14488***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14489***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14490***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14491***
 14492     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14493         PB-I-AH-PREMIUM-AMT
 14494          GIVING WS-CALC-WORK.
 14495
 14496     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14497        AND WS-CALC-WORK NOT = ZERO
 14498         MOVE ER-2649            TO WS-ERROR
 14499         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14500
 14501     SUBTRACT PB-I-LF-PREM-CALC
 14502             FROM PB-I-LF-PREMIUM-AMT
 14503                 GIVING WS-UNSIGN-WRK1.
 14504
 14505     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14506             FROM PB-I-LF-ALT-PREMIUM-AMT
 14507                 GIVING WS-UNSIGN-WRK4.
 14508
 14509     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14510                                + WS-UNSIGN-WRK4.
 14511
 14512     SUBTRACT PB-I-AH-PREM-CALC
 14513             FROM PB-I-AH-PREMIUM-AMT
 14514                 GIVING WS-UNSIGN-WRK2.
 14515
 14516******************************************************************
 14517*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14518******************************************************************
 14519
 14520     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14521         MOVE ZERO TO WS-UNSIGN-WRK1.
 14522
 14523     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14524         MOVE ZERO TO WS-UNSIGN-WRK2.
 14525
 14526     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14527             GIVING WS-UNSIGN-WRK3.
 14528
 14529 3342-CONTINUE.
 14530
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 263
* EL050.cbl
 14531     IF (PB-I-LF-RATE = ZERO  AND
 14532         PB-I-AH-RATE = ZERO)
 14533         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14534            WS-AH-SPECIAL-CALC-CD = 'O'
 14535              NEXT SENTENCE
 14536         ELSE
 14537             GO TO 3345-EDIT-CONTINUE.
 14538
 14539     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14540         NEXT SENTENCE
 14541     ELSE
 14542     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14543        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14544           IF (PB-REISSUED-CERT         OR
 14545               PB-POLICY-IS-DECLINED    OR
 14546               PB-POLICY-IS-VOIDED)
 14547              NEXT SENTENCE
 14548           ELSE
 14549              IF WS-PREM-REJECT-SW = SPACE
 14550                 MOVE ER-2652    TO WS-ERROR
 14551                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14552                 GO TO 3344-CHECK-AH
 14553              ELSE
 14554                 MOVE ER-2650    TO WS-ERROR
 14555                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14556                 GO TO 3344-CHECK-AH.
 14557
 14558***
 14559***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14560***
 14561
 14562     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14563         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14564            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14565             (1 + WS-TOL-LF-PREM-PCT)
 14566         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14567            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14568             (1 - WS-TOL-LF-PREM-PCT)
 14569     ELSE
 14570         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14571         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14572
 14573***
 14574***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14575***
 14576
 14577     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14578         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14579          WS-TOL-LF-PREM.
 14580
 14581     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14582         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14583          WS-TOL-LF-PREM.
 14584
 14585     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14586        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14587
 14588     IF PB-REISSUED-CERT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 264
* EL050.cbl
 14589        or PB-POLICY-IS-DECLINED
 14590        or PB-POLICY-IS-VOIDED
 14591        continue
 14592     ELSE
 14593        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14594              > WS-TOL-LF-HIGH-PREM-AMT)
 14595           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14596              < WS-TOL-LF-LOW-PREM-AMT))
 14597                      or
 14598           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14599              > WS-TOL-LF-HIGH-PREM-PCT)
 14600           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14601              < WS-TOL-LF-LOW-PREM-PCT))
 14602           IF WS-PREM-REJECT-SW = SPACE
 14603              MOVE ER-2652       TO WS-ERROR
 14604              PERFORM 9900-ERROR-FORMAT
 14605                                 THRU 9900-EXIT
 14606           ELSE
 14607              MOVE ER-2650       TO WS-ERROR
 14608              PERFORM 9900-ERROR-FORMAT
 14609                                 THRU 9900-EXIT
 14610           end-if
 14611        end-if
 14612     end-if
 14613
 14614*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14615*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14616*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14617*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14618
 14619     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14620        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14621                      OR
 14622           ((PB-COMPANY-ID = 'DCC')
 14623           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14624           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14625           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14626        END-IF
 14627     END-IF
 14628
 14629     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14630        IF WS-COMP-MAX-CAP GREATER THAN +0
 14631           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14632              IF (PB-REISSUED-CERT         OR
 14633                  PB-POLICY-IS-DECLINED    OR
 14634                  PB-POLICY-IS-VOIDED)
 14635                 NEXT SENTENCE
 14636              ELSE
 14637                  MOVE ER-2646   TO  WS-ERROR
 14638                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14639
 14640 3344-CVL-TOLERANCE-CHECK.
 14641
 14642      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14643          GO TO 3344-CHECK-AH.
 14644
 14645      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14646          GO TO 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 265
* EL050.cbl
 14647
 14648      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14649                                     WS-UNSIGN-WRK6.
 14650
 14651      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14652          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14653                                 + PB-I-LF-PREMIUM-AMT
 14654                                 - PB-I-LF-PREM-CALC.
 14655
 14656      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14657          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14658                                 + PB-I-LF-ALT-PREMIUM-AMT
 14659                                 - PB-I-LF-ALT-PREM-CALC.
 14660
 14661      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14662          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14663              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14664                 MOVE ER-2652    TO  WS-ERROR
 14665                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14666              ELSE
 14667                 MOVE ER-2650    TO  WS-ERROR
 14668                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14669
 14670      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14671          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14672              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14673                 MOVE ER-2652    TO  WS-ERROR
 14674                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14675              ELSE
 14676                 MOVE ER-2650    TO  WS-ERROR
 14677                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14678
 14679 3344-CHECK-AH.
 14680
 14681****************************************************************
 14682***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14683***
 14684
 14685     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14686         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14687             (1 + WS-TOL-AH-PREM-PCT)
 14688         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14689             (1 - WS-TOL-AH-PREM-PCT)
 14690     ELSE
 14691         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14692         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14693
 14694***
 14695***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14696***
 14697
 14698     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14699         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14700
 14701     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14702         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14703
 14704     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 266
* EL050.cbl
 14705        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14706
 14707     IF (PB-REISSUED-CERT)
 14708        OR (PB-POLICY-IS-DECLINED)
 14709        OR (PB-POLICY-IS-VOIDED)
 14710        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14711        CONTINUE
 14712     ELSE
 14713        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14714              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14715                          or
 14716           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14717              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14718           IF WS-PREM-REJECT-SW = SPACE
 14719              MOVE ER-3052       TO WS-ERROR
 14720              PERFORM 9900-ERROR-FORMAT
 14721                                 THRU 9900-EXIT
 14722           ELSE
 14723              MOVE ER-3050       TO WS-ERROR
 14724              PERFORM 9900-ERROR-FORMAT
 14725                                 THRU 9900-EXIT
 14726           END-IF
 14727        END-IF
 14728     END-IF
 14729     if (pb-company-id = 'DCC')
 14730        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14731        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14732        and (pb-i-policy-is-monthly)
 14733        compute ws-tol-ah-high-prem-amt =
 14734           pb-i-tot-fees-calc + ws-tol-ah-prem
 14735        compute ws-tol-ah-low-prem-amt =
 14736           pb-i-tot-fees-calc - ws-tol-ah-prem
 14737        if ws-tol-ah-prem-pct > zeros
 14738           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14739              (1 + ws-tol-ah-prem-pct)
 14740           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14741              (1 - ws-tol-ah-prem-pct)
 14742        else
 14743           move +9999999.99      to ws-tol-ah-high-prem-pct
 14744           move +0               to ws-tol-ah-low-prem-pct
 14745        end-if
 14746        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14747            or
 14748           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14749                          or
 14750           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14751           or
 14752           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14753            move er-3049         to ws-error
 14754           perform 9900-error-format
 14755                                 thru 9900-exit
 14756
 14757        end-if
 14758     end-if
 14759     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14760         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14761             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14762             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 267
* EL050.cbl
 14763
 14764     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14765        IF WS-COMP-MAX-CAP GREATER THAN +0
 14766           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14767              IF (PB-REISSUED-CERT         OR
 14768                  PB-POLICY-IS-DECLINED    OR
 14769                  PB-POLICY-IS-VOIDED)
 14770                 NEXT SENTENCE
 14771              ELSE
 14772                  MOVE ER-2646   TO  WS-ERROR
 14773                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14774
 14775     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14776        (WS-COMP-MAX-CAP EQUAL +0)
 14777           GO TO 3345-EDIT-CONTINUE.
 14778
 14779     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14780        GREATER THAN WS-COMP-MAX-CAP
 14781           MOVE ER-2646          TO  WS-ERROR
 14782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14783
 14784 3345-EDIT-CONTINUE.
 14785
 14786*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14787*       IF PB-ENTRY-BATCH   NUMERIC
 14788*          IF PB-ISSUE
 14789*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14790*          ELSE
 14791*              IF PB-CANCELLATION
 14792*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14793
 14794*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14795*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14796*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14797*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14798*        ELSE
 14799*            MOVE  ER-1909            TO  WS-ERROR
 14800*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14801
 14802     IF PB-I-POLICY-ACCEPTED
 14803        IF PB-POLICY-IS-DECLINED  OR
 14804           PB-REISSUED-CERT  OR
 14805           PB-REIN-ONLY-CERT  OR
 14806           PB-POLICY-IS-VOIDED
 14807            MOVE  ER-1891         TO  WS-ERROR
 14808            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14809        ELSE
 14810            MOVE SPACE            TO  PB-BATCH-ENTRY
 14811            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14812
 14813     IF PB-I-POLICY-DECLINED
 14814        IF PB-REISSUED-CERT  OR
 14815           PB-REIN-ONLY-CERT  OR
 14816           PB-POLICY-IS-VOIDED
 14817            MOVE  ER-1906         TO  WS-ERROR
 14818            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14819        ELSE
 14820            MOVE  'D'             TO  PB-BATCH-ENTRY
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 268
* EL050.cbl
 14821                                      PB-I-ENTRY-STATUS.
 14822
 14823     IF PB-I-NEEDS-UNDERWRITING
 14824        IF PB-POLICY-IS-DECLINED OR
 14825           PB-REISSUED-CERT  OR
 14826           PB-REIN-ONLY-CERT  OR
 14827           PB-POLICY-IS-VOIDED
 14828            MOVE  ER-1907         TO  WS-ERROR
 14829            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14830        ELSE
 14831            MOVE 'U'              TO  PB-BATCH-ENTRY
 14832                                      PB-I-ENTRY-STATUS.
 14833
 14834     IF PB-NEEDS-UNDERWRITING
 14835        MOVE  ER-1901             TO  WS-ERROR
 14836        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14837     IF PB-COMPANY-ID = 'DCC'
 14838        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14839        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14840        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14841           AND (NOT WS-LF-CASH))
 14842                           OR
 14843           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14844           AND (NOT WS-AH-CASH)))
 14845                       AND
 14846           (PB-I-ENTRY-STATUS NOT = '5')
 14847           MOVE 'M'              TO PB-BATCH-ENTRY
 14848                                    PB-I-ENTRY-STATUS
 14849        END-IF
 14850     END-IF
 14851     IF  PB-COMPANY-ID NOT = 'NCL'
 14852         GO TO 3999-END-EDIT.
 14853
 14854     IF PB-REISSUED-CERT  OR
 14855        PB-POLICY-IS-DECLINED  OR
 14856        PB-POLICY-IS-VOIDED  OR
 14857        PB-I-OB
 14858         GO TO 3999-END-EDIT.
 14859
 14860     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14861         MOVE  ER-2644            TO  WS-ERROR
 14862         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14863         GO TO 3999-END-EDIT.
 14864
 14865     MOVE 'N'                     TO  FORM-MASTER-SW.
 14866     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14867
 14868     IF NOT FORM-MASTER-FOUND
 14869         GO TO 3999-END-EDIT.
 14870
 14871     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14872                                      FORM-MASTER-AH-SW.
 14873
 14874     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14875         MOVE  +1                 TO SUB6
 14876         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14877
 14878     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 269
* EL050.cbl
 14879         MOVE  +1                 TO SUB6
 14880         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14881
 14882     IF LF-FORM-MASTER-FOUND  OR
 14883        AH-FORM-MASTER-FOUND
 14884         GO TO 3360-CHECK-FORM-LIMITS
 14885     ELSE
 14886         GO TO 3999-END-EDIT.
 14887
 14888******************************************************************
 14889*                  3350-GET-ERFORM                               *
 14890*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14891*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14892******************************************************************
 14893
 14894 3350-GET-ERFORM.
 14895
 14896     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14897         GO TO  3350-ERFORM-GETMAIN.
 14898
 14899     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14900     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14901     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14902     MOVE 'Y'                     TO FORM-MASTER-SW.
 14903
 14904     IF PB-CANCELLATION
 14905         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14906            PB-SV-STATE          EQUAL   FO-STATE       AND
 14907            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14908              GO TO 3350-EXIT
 14909         ELSE
 14910             NEXT SENTENCE
 14911     ELSE
 14912         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14913            PB-SV-STATE          EQUAL   FO-STATE       AND
 14914            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14915              GO TO 3350-EXIT.
 14916
 14917 3350-ERFORM-GETMAIN.
 14918
 14919     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14920     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14921
 14922 3350-ERFORM-READ.
 14923
 14924     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14925     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14926     IF PB-CANCELLATION
 14927         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14928     ELSE
 14929         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14930     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14931
 14932     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14933
 14934     IF FORM-MASTER-FOUND
 14935       IF PB-CANCELLATION
 14936          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 270
* EL050.cbl
 14937             PB-SV-STATE          EQUAL   FO-STATE       AND
 14938             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14939              GO  TO 3350-EXIT
 14940          ELSE
 14941              NEXT SENTENCE
 14942       ELSE
 14943          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14944             PB-SV-STATE          EQUAL   FO-STATE       AND
 14945             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14946              GO  TO 3350-EXIT.
 14947
 14948     MOVE  'N'                    TO  FORM-MASTER-SW.
 14949     MOVE  ER-1895                TO  WS-ERROR.
 14950     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14951
 14952 3350-EXIT.
 14953      EXIT.
 14954
 14955******************************************************************
 14956*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14957*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14958*   VALID FOR THE POLICY FORM USED.                              *
 14959******************************************************************
 14960
 14961 3355-EDIT-FORM-LF-BENEFITS.
 14962
 14963     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14964        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14965         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14966         GO TO   3355-EXIT.
 14967
 14968     IF  SUB6    LESS THAN   +40
 14969         ADD  +1      TO  SUB6
 14970         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14971
 14972     MOVE  ER-1896         TO  WS-ERROR.
 14973     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14974
 14975 3355-EXIT.
 14976      EXIT.
 14977
 14978******************************************************************
 14979*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14980*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14981*   VALID FOR THE POLICY FORM USED.                              *
 14982******************************************************************
 14983
 14984 3356-EDIT-FORM-AH-BENEFITS.
 14985
 14986     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14987        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14988         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14989         GO TO  3356-EXIT.
 14990
 14991      IF  SUB6    LESS THAN     +40
 14992          ADD  +1      TO  SUB6
 14993          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14994
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 271
* EL050.cbl
 14995     MOVE  ER-1897         TO  WS-ERROR.
 14996     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14997
 14998 3356-EXIT.
 14999      EXIT.
 15000
 15001******************************************************************
 15002*                  3357-BENEFIT-SEARCH                           *
 15003*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15004*   CANCELLATIONS ONLY.                                          *
 15005******************************************************************
 15006 3357-BENEFIT-SEARCH.
 15007     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15008         MOVE +1                          TO SUB6
 15009         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15010
 15011     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15012         MOVE +1                          TO SUB6
 15013         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15014
 15015 3357-EXIT.
 15016     EXIT.
 15017
 15018******************************************************************
 15019*                  3358-BENEFIT-LIFE-SEARCH                      *
 15020*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15021*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15022*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15023******************************************************************
 15024 3358-BENEFIT-LIFE-SEARCH.
 15025     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15026       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15027         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15028           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15029              IF FO-PLAN-REFUND-METHOD (SUB6)
 15030                     IS GREATER THAN SPACES
 15031                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15032                                          WS-LF-REFUND-CALC
 15033                 GO TO 3358-EXIT.
 15034
 15035     IF SUB6 LESS THAN +40
 15036         ADD +1                 TO SUB6
 15037         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15038
 15039 3358-EXIT.
 15040     EXIT.
 15041******************************************************************
 15042*                  3359-BENEFIT-AH-SEARCH                        *
 15043*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15044*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15045*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15046******************************************************************
 15047 3359-BENEFIT-AH-SEARCH.
 15048     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15049       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15050         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15051           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15052              IF FO-PLAN-REFUND-METHOD (SUB6)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 272
* EL050.cbl
 15053                      IS GREATER THAN SPACES
 15054                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15055                                          WS-AH-REFUND-CALC
 15056                 GO TO 3359-EXIT.
 15057
 15058     IF SUB6 LESS THAN +40
 15059         ADD +1                 TO SUB6
 15060         GO TO 3359-BENEFIT-AH-SEARCH.
 15061
 15062 3359-EXIT.
 15063     EXIT.
 15064
 15065******************************************************************
 15066*                  3360-CHECK-FORM-LIMITS                        *
 15067*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15068*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15069******************************************************************
 15070
 15071 3360-CHECK-FORM-LIMITS.
 15072
 15073     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15074         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15075
 15076     IF NOT LF-FORM-MASTER-FOUND
 15077         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15078
 15079 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15080
 15081     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15082       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15083        WS-LF-JOINT-INDICATOR = 'J'  AND
 15084        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15085         IF PB-COMPANY-ID = 'NCL'
 15086            MOVE  ER-1911          TO  WS-ERROR
 15087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15088         ELSE
 15089            MOVE  ER-1892          TO  WS-ERROR
 15090            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15091
 15092 3360-CHECK-FORM-LF-ATT-AGE.
 15093
 15094     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15095
 15096     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15097         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15098         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15099            IF PB-COMPANY-ID = 'NCL'
 15100                MOVE  ER-1913      TO  WS-ERROR
 15101                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15102            ELSE
 15103                MOVE  ER-1894      TO  WS-ERROR
 15104                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15105
 15106 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15107
 15108     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15109         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15110         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 273
* EL050.cbl
 15111            IF PB-COMPANY-ID = 'NCL'
 15112                MOVE  ER-1914      TO  WS-ERROR
 15113                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15114            ELSE
 15115                MOVE  ER-1899      TO  WS-ERROR
 15116                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15117
 15118 3360-CHECK-FORM-LF-TERM-BAMT.
 15119
 15120     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15121         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15122         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15123           IF  PB-COMPANY-ID = 'NCL'
 15124               MOVE  ER-1916       TO  WS-ERROR
 15125               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15126           ELSE
 15127               MOVE  ER-1902       TO  WS-ERROR
 15128               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15129
 15130     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15131                                    PB-I-LF-ALT-BENEFIT-AMT.
 15132
 15133     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15134         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15135         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15136             IF  PB-COMPANY-ID = 'NCL'
 15137                 MOVE  ER-1918     TO  WS-ERROR
 15138                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15139             ELSE
 15140                 MOVE  ER-1904     TO  WS-ERROR
 15141                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15142
 15143******************************************************************
 15144*                  3360-CHECK-FORM-AH-LIMITS                     *
 15145*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15146*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15147******************************************************************
 15148
 15149 3360-CHECK-FORM-AH-LIMITS.
 15150
 15151     IF NOT AH-FORM-MASTER-FOUND
 15152         GO TO 3999-END-EDIT.
 15153
 15154 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15155
 15156     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15157       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15158        WS-AH-JOINT-INDICATOR = 'J'  AND
 15159        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15160         IF PB-COMPANY-ID = 'NCL'
 15161            MOVE  ER-1912          TO  WS-ERROR
 15162            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15163         ELSE
 15164            MOVE  ER-1893          TO  WS-ERROR
 15165            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15166
 15167 3360-CHECK-FORM-AH-ATT-AGE.
 15168
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 274
* EL050.cbl
 15169     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15170
 15171     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15172         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15173         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15174            IF PB-COMPANY-ID = 'NCL'
 15175                MOVE  ER-1913      TO  WS-ERROR
 15176                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15177            ELSE
 15178                MOVE  ER-1894      TO  WS-ERROR
 15179                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15180
 15181 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15182
 15183     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15184         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15185         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15186            IF PB-COMPANY-ID = 'NCL'
 15187                MOVE  ER-1915      TO  WS-ERROR
 15188                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15189            ELSE
 15190                MOVE  ER-1900      TO  WS-ERROR
 15191                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15192
 15193 3360-CHECK-FORM-AH-TERM-BAMT.
 15194
 15195     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15196         FO-AH-MAX-TERM    GREATER THAN  +0
 15197         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15198             IF  PB-COMPANY-ID = 'NCL'
 15199                 MOVE  ER-1917     TO  WS-ERROR
 15200                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15201             ELSE
 15202                  MOVE  ER-1903    TO  WS-ERROR
 15203                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15204
 15205     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15206         FO-MAX-AH-AMT    GREATER THAN  +0
 15207         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15208             IF  PB-COMPANY-ID = 'NCL'
 15209                 MOVE  ER-1919     TO  WS-ERROR
 15210                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15211             ELSE
 15212                 MOVE  ER-1905     TO  WS-ERROR
 15213                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15214
 15215     GO TO 3999-END-EDIT.
 15216
 15217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 275
* EL050.cbl
 15219******************************************************************
 15220*                  E D I T   C A N C E L                         *
 15221******************************************************************
 15222
 15223 3700-EDIT-CANCEL.
 15224     IF PB-COMPANY-ID = 'DMD'
 15225         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15226                                         WS-RES-MUNI-TAX
 15227                                         PB-CI-STATE-TAX
 15228                                         PB-CI-MUNI-TAX
 15229         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15230
 15231*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15232*       IF PB-ENTRY-BATCH  NUMERIC
 15233*          IF PB-CANCELLATION
 15234*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15235*          ELSE
 15236*             IF PB-ISSUE
 15237*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15238
 15239     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15240        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15241     END-IF
 15242*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15243*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15244
 15245     IF CM-ENTRY-STATUS = 'V'
 15246        MOVE ER-2780             TO WS-ERROR
 15247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15248        GO TO 3999-END-EDIT.
 15249
 15250     IF CM-ENTRY-STATUS = 'D'
 15251        MOVE ER-2781             TO WS-ERROR
 15252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15253        GO TO 3999-END-EDIT.
 15254
 15255     IF CM-ENTRY-STATUS = 'U'
 15256        MOVE ER-2782             TO WS-ERROR
 15257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15258
 15259***************************************************************
 15260*                                                             *
 15261*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15262*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15263*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15264*   OF ANOTHER COVERAGE.                                      *
 15265*                                                             *
 15266***************************************************************
 15267
 15268     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15269                                    PB-C-AH-CANCEL-VOID-SW.
 15270
 15271     IF PB-C-LF-CANCEL-AMT = ZERO
 15272        NEXT SENTENCE
 15273     ELSE
 15274        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15275           AND
 15276           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 276
* EL050.cbl
 15277               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15278               MOVE ER-2745           TO WS-ERROR
 15279               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15280
 15281     IF PB-C-AH-CANCEL-AMT = ZERO
 15282        NEXT SENTENCE
 15283     ELSE
 15284        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15285           AND
 15286           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15287               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15288               MOVE ER-2745           TO WS-ERROR
 15289               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290
 15291     IF WS-LF-EARNINGS-CALC = '4'
 15292        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15293
 15294     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15295     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15296     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15297     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15298     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15299     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15300
 15301     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15302                                      PB-C-AH-REF-CALC.
 15303     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15304
 15305******************************************************************
 15306*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15307*             TO VALIDATE COVERAGE.                              *
 15308******************************************************************
 15309
 15310     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15311        PB-C-LF-CANCEL-AMT = ZEROS
 15312          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15313      ELSE
 15314          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15315
 15316     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15317        PB-C-AH-CANCEL-AMT = ZEROS
 15318          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15319      ELSE
 15320          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15321
 15322     EVALUATE TRUE
 15323         WHEN PB-CANCEL-FORCE             OR
 15324              PB-CANCEL-DATE-FORCED       OR
 15325              PB-FORCE-OFF
 15326                  IF PB-COMPANY-ID = 'ACE'
 15327                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15328                  END-IF
 15329         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15330               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15331              (PB-COMPANY-ID = 'ACE' )
 15332                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15333         WHEN OTHER
 15334              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 277
* EL050.cbl
 15335                 MOVE ER-2794              TO WS-ERROR
 15336              ELSE
 15337                 MOVE ER-2749              TO WS-ERROR
 15338              END-IF
 15339              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15340     END-EVALUATE.
 15341
 15342
 15343*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15344*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15345*            MOVE  ER-1909            TO  WS-ERROR
 15346*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15347*        ELSE
 15348*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15349
 15350     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15351     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15352        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15353     ELSE
 15354        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15355     END-IF
 15356     .
 15357 3705-EDIT-CANCEL-DT.
 15358
 15359     IF LF-COVERAGE-CANCELLED
 15360        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15361         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15362         MOVE WS-CURRENT-MONTH-END
 15363                                 TO DC-BIN-DATE-2
 15364         SET ELAPSED-BETWEEN-BIN TO TRUE
 15365*        MOVE 1                  TO DC-OPTION-CODE
 15366         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15367         IF DATE-CONVERSION-ERROR
 15368            NEXT SENTENCE
 15369          ELSE
 15370             IF DC-ELAPSED-DAYS GREATER +180
 15371                IF PB-CANCEL-DATE-FORCED  OR
 15372                   PB-CANCEL-DATE-FORCED-NO-FEE
 15373                      MOVE ER-2751  TO WS-ERROR
 15374                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15375                 ELSE
 15376                   MOVE ER-2752  TO WS-ERROR
 15377                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15378
 15379     IF AH-COVERAGE-CANCELLED
 15380        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15381         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15382         MOVE WS-CURRENT-MONTH-END
 15383                                 TO DC-BIN-DATE-2
 15384         SET ELAPSED-BETWEEN-BIN TO TRUE
 15385*        MOVE 1                  TO DC-OPTION-CODE
 15386         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15387         IF DATE-CONVERSION-ERROR
 15388            NEXT SENTENCE
 15389          ELSE
 15390             IF DC-ELAPSED-DAYS GREATER +180
 15391                IF PB-CANCEL-DATE-FORCED OR
 15392                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 278
* EL050.cbl
 15393                      MOVE ER-2751  TO WS-ERROR
 15394                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15395                 ELSE
 15396                   MOVE ER-2752  TO WS-ERROR
 15397                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15398
 15399     IF WS-ERROR = ER-2752
 15400        AND (PB-COMPANY-ID = 'ABL'
 15401         OR  PB-COMPANY-ID = 'FGL'
 15402         OR  PB-COMPANY-ID = 'IST'
 15403         OR  PB-COMPANY-ID = 'JHL'
 15404         OR  PB-COMPANY-ID = 'LAP'
 15405         OR  PB-COMPANY-ID = 'LBL'
 15406         OR  PB-COMPANY-ID = 'NCB'
 15407         OR  PB-COMPANY-ID = 'NLI'
 15408         OR  PB-COMPANY-ID = 'OFI'
 15409         OR  PB-COMPANY-ID = 'PLI'
 15410         OR  PB-COMPANY-ID = 'TAO'
 15411         OR  PB-COMPANY-ID = 'TIC'
 15412         OR  PB-COMPANY-ID = 'HER'
 15413         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15414         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15415            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15416            MOVE ER-2762     TO WS-ERROR
 15417            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15418
 15419     IF LF-COVERAGE-CANCELLED
 15420        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15421        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15422             MOVE ER-2733         TO WS-ERROR
 15423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15424
 15425     IF AH-COVERAGE-CANCELLED
 15426        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15427        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15428              MOVE ER-2733        TO WS-ERROR
 15429              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15430
 15431     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15432        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15433        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15434           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15435            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15436              IF PB-COMPANY-ID NOT = 'LAP'
 15437               MOVE ER-2704            TO WS-ERROR
 15438               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15439
 15440     IF CERT-WAS-NOT-FOUND
 15441         GO TO 3999-END-EDIT.
 15442
 15443     IF PB-COMPANY-ID EQUAL 'CDC'
 15444        IF LF-COVERAGE-CANCELLED
 15445           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15446            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15447            MOVE PB-C-LF-CANCEL-DT
 15448                                 TO DC-BIN-DATE-2
 15449            SET ELAPSED-BETWEEN-BIN TO TRUE
 15450*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 279
* EL050.cbl
 15451            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15452            IF DATE-CONVERSION-ERROR
 15453               NEXT SENTENCE
 15454             ELSE
 15455                IF DC-ELAPSED-DAYS GREATER +60
 15456                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15457
 15458     IF PB-COMPANY-ID EQUAL 'CDC'
 15459        IF AH-COVERAGE-CANCELLED
 15460           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15461            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15462            MOVE PB-C-AH-CANCEL-DT
 15463                                 TO DC-BIN-DATE-2
 15464            MOVE +0              TO DC-ELAPSED-DAYS
 15465                                    DC-ELAPSED-MONTHS
 15466            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15467*           MOVE 1               TO DC-OPTION-CODE
 15468            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15469            IF DATE-CONVERSION-ERROR
 15470               NEXT SENTENCE
 15471             ELSE
 15472                IF DC-ELAPSED-DAYS GREATER +60
 15473                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15474
 15475     MOVE +0                     TO DC-ELAPSED-DAYS
 15476                                    DC-ELAPSED-MONTHS.
 15477
 15478     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15479        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15480          MOVE 'Z'                TO PB-CI-OB-FLAG
 15481          MOVE ER-2767            TO WS-ERROR
 15482          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15483          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15484          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15485          GO TO 3775-OVER-REF-CHK
 15486        ELSE
 15487          MOVE ZEROS              TO PB-CI-LIVES
 15488                                     PB-C-LIVES
 15489          IF PB-CI-OB-FLAG NOT = 'B'
 15490             MOVE SPACE           TO PB-CI-OB-FLAG.
 15491
 15492     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15493         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15494     ELSE
 15495         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15496
 15497     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15498        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15499            MOVE ER-2760         TO WS-ERROR
 15500            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15501
 15502     IF LF-COVERAGE-CANCELLED
 15503        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15504         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15505            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15506               MOVE ER-2774       TO WS-ERROR
 15507               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15508
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 280
* EL050.cbl
 15509     IF AH-COVERAGE-CANCELLED
 15510        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15511         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15512            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15513               MOVE ER-2775       TO WS-ERROR
 15514               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15515
 15516     IF LF-COVERAGE-CANCELLED
 15517        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15518         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15519            MOVE ER-2776         TO WS-ERROR
 15520            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15521
 15522     IF AH-COVERAGE-CANCELLED
 15523        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15524         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15525            MOVE ER-2777         TO WS-ERROR
 15526            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15527     IF LF-COVERAGE-CANCELLED
 15528        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15529        if pb-ci-lf-expire-dt = low-values or spaces
 15530           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15531           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15532           MOVE PB-CI-EXTENTION-DAYS
 15533                                 TO DC-ELAPSED-DAYS
 15534           SET BIN-PLUS-ELAPSED  TO TRUE
 15535           PERFORM 8500-DATE-CONVERT
 15536                                 THRU 8500-EXIT
 15537           IF DATE-CONVERSION-ERROR
 15538              move low-values    to dc-bin-date-2
 15539           end-if
 15540        else
 15541           move pb-ci-lf-expire-dt
 15542                                 to dc-bin-date-2
 15543        end-if
 15544        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15545           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15546                             OR  'FIA'
 15547              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15548           ELSE
 15549              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15550              MOVE ER-2731       TO WS-ERROR
 15551              PERFORM 9900-ERROR-FORMAT
 15552                                 THRU 9900-EXIT
 15553           end-if
 15554        end-if
 15555     end-if
 15556*    IF LF-COVERAGE-CANCELLED
 15557*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15558*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15559*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15560*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15561*        SET BIN-PLUS-ELAPSED      TO TRUE
 15562*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15563*        IF DATE-CONVERSION-ERROR
 15564*           NEXT SENTENCE
 15565*         ELSE
 15566*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 281
* EL050.cbl
 15567*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15568*                            OR  'FIA'
 15569*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15570*              ELSE
 15571*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15572*               MOVE ER-2731       TO WS-ERROR
 15573*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15574     .
 15575 3705-EDIT-AH-CANCEL-DT.
 15576     IF AH-COVERAGE-CANCELLED
 15577        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15578        if pb-ci-AH-expire-dt = low-values or spaces
 15579           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15580           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15581           MOVE PB-CI-EXTENTION-DAYS
 15582                                 TO DC-ELAPSED-DAYS
 15583           SET BIN-PLUS-ELAPSED  TO TRUE
 15584           PERFORM 8500-DATE-CONVERT
 15585                                 THRU 8500-EXIT
 15586           IF DATE-CONVERSION-ERROR
 15587              move low-values    to dc-bin-date-2
 15588           end-if
 15589        else
 15590           move pb-ci-ah-expire-dt
 15591                                 to dc-bin-date-2
 15592        end-if
 15593        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15594           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15595                             OR  'FIA'
 15596              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15597           ELSE
 15598              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15599              MOVE ER-2771       TO WS-ERROR
 15600              PERFORM 9900-ERROR-FORMAT
 15601                                 THRU 9900-EXIT
 15602           end-if
 15603        end-if
 15604     end-if
 15605*    IF AH-COVERAGE-CANCELLED
 15606*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15607*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15608*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15609*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15610**       MOVE 6                    TO DC-OPTION-CODE
 15611*        SET BIN-PLUS-ELAPSED      TO TRUE
 15612*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15613*        IF DATE-CONVERSION-ERROR
 15614*           NEXT SENTENCE
 15615*         ELSE
 15616*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15617*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15618*                             OR 'FIA'
 15619*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15620*             ELSE
 15621*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15622*              MOVE ER-2771       TO WS-ERROR
 15623*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15624     .
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 282
* EL050.cbl
 15625 3705-EDIT-CONTINUED.
 15626
 15627*    IF LF-COVERAGE-CANCELLED
 15628*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15629*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15630*            MOVE ER-2727         TO WS-ERROR
 15631*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15632*
 15633*    IF AH-COVERAGE-CANCELLED
 15634*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15635*        IF PB-COMPANY-ID = 'ACE'
 15636*           MOVE ER-2727        TO WS-ERROR
 15637*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15638*        ELSE
 15639*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15640*              MOVE ER-2727     TO WS-ERROR
 15641*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15642
 15643     IF PB-COMPANY-ID = 'ACE'
 15644       IF AH-COVERAGE-CANCELLED
 15645         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15646           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15647              MOVE ER-2732      TO WS-ERROR
 15648              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15649
 15650     IF PB-COMPANY-ID      EQUAL   'HER'
 15651        IF WS-ERROR        EQUAL   ER-2727
 15652            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15653            MOVE  ER-2725          TO  WS-ERROR
 15654            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15655
 15656     IF PB-C-CLAIM-CREATED-CANCEL
 15657            MOVE ER-2748         TO WS-ERROR
 15658            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15659
 15660     IF PB-C-LAST-NAME NOT = SPACES
 15661         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15662            MOVE ER-2747         TO WS-ERROR
 15663            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15664
 15665 3710-EDIT-LUMP-SUM-PRIOR.
 15666
 15667     IF AH-COVERAGE-CANCELLED
 15668         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15669             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15670                MOVE ER-2735    TO WS-ERROR
 15671                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15672
 15673     IF LF-COVERAGE-CANCELLED
 15674         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15675             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15676                MOVE ER-2735    TO WS-ERROR
 15677                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15678
 15679 3710-EDIT-PRIOR-DEATH.
 15680
 15681*    IF LF-COVERAGE-CANCELLED
 15682*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 283
* EL050.cbl
 15683*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15684*           (NOT PB-CI-OB)
 15685*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15686*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15687*                   MOVE ER-2732  TO WS-ERROR
 15688*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15689*
 15690*    IF AH-COVERAGE-CANCELLED
 15691*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15692*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15693*           (NOT PB-CI-OB)
 15694*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15695*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15696*                   MOVE ER-2732  TO WS-ERROR
 15697*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15698
 15699     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15700         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15701            (NOT PB-COMP-LF-CANCEL)
 15702             NEXT SENTENCE
 15703         ELSE
 15704           IF PB-C-LF-CANCEL-VOIDED
 15705              NEXT SENTENCE
 15706           ELSE
 15707              MOVE ER-2753      TO WS-ERROR
 15708              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15709
 15710     IF CANCEL-FUTURE-DT
 15711         GO TO 3999-END-EDIT.
 15712
 15713 3715-GET-REMAIN-TERM-LF.
 15714
 15715     IF NO-LF-BENEFIT-MATCH  OR
 15716        WS-LF-BENEFIT-CD = ZEROS
 15717        GO TO 3730-GET-AH-REMAIN-TERM.
 15718
 15719     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15720     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15721     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15722     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15723     MOVE PB-SV-STATE            TO CP-STATE.
 15724     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15725     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15726     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15727     MOVE '2'                    TO CP-PROCESS-TYPE.
 15728     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15729     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15730     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15731     IF (PB-COMPANY-ID = 'CID')
 15732        AND (CP-STATE-STD-ABBRV = 'WI')
 15733        MOVE '7'                 TO CP-REM-TERM-METHOD
 15734        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15735     ELSE
 15736        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15737        MOVE WS-REM-TRM-CALC-OPTION
 15738                                 TO CP-REM-TRM-CALC-OPTION
 15739     END-IF
 15740**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 284
* EL050.cbl
 15741     IF (PB-COMPANY-ID = 'CID')
 15742        AND (CP-STATE-STD-ABBRV = 'MO')
 15743        AND (PB-CERT-EFF-DT >= X'9B41')
 15744        AND (PB-CERT-EFF-DT <= X'A2FB')
 15745        MOVE '7'                 TO CP-REM-TERM-METHOD
 15746        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15747     END-IF
 15748     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15749                                    CP-LOAN-TERM.
 15750     IF CP-TRUNCATED-LIFE
 15751        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15752
 15753     IF CP-TERM-IS-DAYS
 15754         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15755     ELSE
 15756         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15757
 15758     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15759
 15760     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15761
 15762     IF LF-COVERAGE-CANCELLED
 15763        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15764        NEXT SENTENCE
 15765      ELSE
 15766          GO TO 3730-GET-AH-REMAIN-TERM.
 15767
 15768 3720-GET-LF-REFUND.
 15769
 15770     IF PB-C-LF-CANCEL-VOIDED OR
 15771        PB-C-AH-CANCEL-VOIDED
 15772        GO TO 3780-UPDATE-CANCEL-CERT.
 15773
 15774     IF PB-COMPANY-ID EQUAL 'BOA'
 15775         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15776         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15777         GO TO 3730-GET-AH-REMAIN-TERM.
 15778
 15779     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15780        (WS-AH-SPECIAL-CALC-CD = 'M')
 15781         MOVE ER-2767            TO WS-ERROR
 15782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15783         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15784         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15785         GO TO 3780-UPDATE-CANCEL-CERT.
 15786
 15787     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15788
 15789     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15790     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15791     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15792     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15793     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15794     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15795     IF (PB-COMPANY-ID = 'DCC')
 15796        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15797        IF PDEF-MASTER-FOUND
 15798           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 285
* EL050.cbl
 15799              (V1 > +8)
 15800              OR (PD-PROD-CODE (V1) = 'L')
 15801           END-PERFORM
 15802           IF V1 < +9
 15803              MOVE PD-MAX-AMT (V1)
 15804                           TO CP-R-MAX-TOT-BEN
 15805                              EC-AM-LF-MAX-TOT-BEN
 15806           END-IF
 15807        ELSE
 15808        MOVE ' '                 TO PDEF-MASTER-SW
 15809        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15810        MOVE PB-STATE            TO ERPDEF-STATE
 15811        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15812        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15813        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15814        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15815        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15816        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15817        IF PDEF-MASTER-FOUND
 15818           MOVE 'N'              TO PDEF-MASTER-SW
 15819           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15820           IF PDEF-MASTER-FOUND
 15821              IF (ERPDEF-KEY-SAVE (1:16) =
 15822                           PD-CONTROL-PRIMARY (1:16))
 15823                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15824                 CONTINUE
 15825              ELSE
 15826                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15827                 IF (ERPDEF-KEY-SAVE (1:16) =
 15828                           PD-CONTROL-PRIMARY (1:16))
 15829                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15830                    CONTINUE
 15831                 ELSE
 15832                    MOVE 'N'     TO PDEF-MASTER-SW
 15833                 END-IF
 15834              END-IF
 15835              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15836
 15837              IF PDEF-MASTER-FOUND
 15838                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15839                    (V1 > +8)
 15840                    OR (PD-PROD-CODE (V1) = 'L')
 15841                 END-PERFORM
 15842                 IF V1 < +9
 15843                    MOVE PD-MAX-AMT (V1)
 15844                                 TO CP-R-MAX-TOT-BEN
 15845                                    EC-AM-LF-MAX-TOT-BEN
 15846                 END-IF
 15847              END-IF
 15848           END-IF
 15849           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15850        END-IF
 15851        END-IF
 15852     END-IF
 15853     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15854
 15855     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15856
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 286
* EL050.cbl
 15857     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15858                                    PB-C-LF-REM-TERM.
 15859
 15860     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15861     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15862
 15863     IF PB-COMPANY-ID EQUAL 'FLC'
 15864        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15865           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15866           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15867                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15868                    - CM-LF-ITD-DEATH-AMT
 15869           IF PB-C-LF-REF-CALC LESS THAN +0
 15870              MOVE +0            TO PB-C-LF-REF-CALC
 15871              GO TO 3730-GET-AH-REMAIN-TERM
 15872           ELSE
 15873              GO TO 3730-GET-AH-REMAIN-TERM.
 15874
 15875     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15876                            OR '4' OR '5' OR '6' OR '8'
 15877                            OR '9' OR 'G'
 15878        MOVE PB-C-LF-REFUND-OVERRIDE
 15879                                 TO CP-EARNING-METHOD.
 15880
 15881     if pb-company-id = 'AHL'
 15882        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15883        if cp-class-code = spaces
 15884           move zeros            to cp-class-code
 15885        end-if
 15886     ELSE
 15887        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15888     END-IF
 15889*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15890     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15891     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15892                                    CP-RATING-BENEFIT-AMT.
 15893     IF CP-STATE-STD-ABBRV = 'OR'
 15894         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15895                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15896     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15897     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15898     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15899     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15900     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15901     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15902     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15903     IF WS-DEFAULT-APR NOT NUMERIC
 15904         MOVE ZEROS TO WS-DEFAULT-APR.
 15905****   N O T E   ****
 15906*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15907*      THE OH HARD CODING IN ELCRFNDP
 15908
 15909     IF PB-COMPANY-ID = 'CID'
 15910        IF CP-STATE-STD-ABBRV = 'OH'
 15911           MOVE WS-LF-EARNINGS-CALC
 15912                                 TO CP-EARNING-METHOD
 15913        END-IF
 15914     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 287
* EL050.cbl
 15915
 15916****   N O T E   ****
 15917
 15918     IF CP-EARN-AS-NET-PAY
 15919         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15920            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15921                MOVE WS-DEFAULT-APR
 15922                                 TO  CP-LOAN-APR
 15923                MOVE ER-3780     TO  WS-ERROR
 15924                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15925            ELSE
 15926                MOVE ER-3781     TO  WS-ERROR
 15927                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15928     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15929     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15930
 15931     IF CP-REFUND-TYPE-USED NOT = SPACE
 15932         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15933
 15934     IF CP-ERROR-RATE-IS-ZERO OR
 15935        CP-ERROR-RATE-NOT-FOUND
 15936        MOVE ER-2740             TO WS-ERROR
 15937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15938
 15939     IF CP-ERROR-RATE-FILE-NOTOPEN
 15940        MOVE ER-2617             TO WS-ERROR
 15941        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15942
 15943     IF PB-COMPANY-ID = 'DCC'
 15944        AND PB-CI-ENTRY-STATUS = 'M'
 15945        MOVE +0                  TO PB-C-LF-REF-CALC
 15946     ELSE
 15947        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15948     END-IF
 15949
 15950     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15951         GO TO 3730-GET-AH-REMAIN-TERM.
 15952
 15953*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15954*       ADD +1                   TO PB-C-LF-REM-TERM
 15955*                                   CP-REMAINING-TERM
 15956*                                   CP-ORIGINAL-TERM.
 15957
 15958     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15959     MOVE '2'                    TO CP-EARNING-METHOD
 15960                                    CP-RATING-METHOD.
 15961     IF PB-COMPANY-ID = 'CID'
 15962        IF (CP-STATE-STD-ABBRV = 'MN')
 15963           AND (PB-CERT-EFF-DT > X'A4FF')
 15964           AND (WS-LF-EARNINGS-CALC = 'B')
 15965           MOVE '5'              TO CP-EARNING-METHOD
 15966           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15967        END-IF
 15968     END-IF
 15969     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15970                                        CP-REMAINING-BENEFIT
 15971                                        CP-RATING-BENEFIT-AMT.
 15972     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 288
* EL050.cbl
 15973         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15974                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15975     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15976     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15977
 15978     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15979
 15980     IF CP-ERROR-RATE-IS-ZERO OR
 15981        CP-ERROR-RATE-NOT-FOUND
 15982        MOVE ER-2740             TO WS-ERROR
 15983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15984
 15985     IF CP-ERROR-RATE-FILE-NOTOPEN
 15986        MOVE ER-2617             TO WS-ERROR
 15987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988
 15989     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15990
 15991******************************************************************
 15992
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 289
* EL050.cbl
 15994 3730-GET-AH-REMAIN-TERM.
 15995     IF NO-AH-BENEFIT-MATCH  OR
 15996        WS-AH-BENEFIT-CD = ZEROS
 15997         GO TO 3770-CHECK-REFUNDS.
 15998
 15999     IF PB-CI-AH-LUMP-SUM-DISAB
 16000         IF  PB-C-AH-CANCEL-AMT = ZERO
 16001            IF NOT PB-COMP-AH-CANCEL
 16002             GO TO 3770-CHECK-REFUNDS.
 16003
 16004     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16005     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16006     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16007     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16008     MOVE PB-SV-STATE            TO CP-STATE.
 16009     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16010     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16011     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16012     MOVE '2'                    TO CP-PROCESS-TYPE.
 16013     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16014     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16015     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16016     IF (PB-COMPANY-ID = 'CID')
 16017        AND (CP-STATE-STD-ABBRV = 'WI')
 16018        MOVE '7'                 TO CP-REM-TERM-METHOD
 16019        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16020     ELSE
 16021        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16022        MOVE WS-REM-TRM-CALC-OPTION
 16023                                 TO CP-REM-TRM-CALC-OPTION
 16024     END-IF
 16025     IF (PB-COMPANY-ID = 'CID')
 16026        AND (CP-STATE-STD-ABBRV = 'MO')
 16027        AND (PB-CERT-EFF-DT >= X'9B41')
 16028        AND (PB-CERT-EFF-DT <= X'A2FB')
 16029        MOVE '7'                 TO CP-REM-TERM-METHOD
 16030        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16031     END-IF
 16032     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16033                                    CP-LOAN-TERM.
 16034     IF NOT CP-TERM-IS-DAYS
 16035         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16036
 16037     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16038
 16039     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16040
 16041     IF AH-COVERAGE-CANCELLED
 16042        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16043        NEXT SENTENCE
 16044      ELSE
 16045         GO TO 3770-CHECK-REFUNDS.
 16046
 16047 3740-GET-AH-REFUND.
 16048
 16049     IF PB-C-LF-CANCEL-VOIDED OR
 16050        PB-C-AH-CANCEL-VOIDED
 16051        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 290
* EL050.cbl
 16052
 16053     IF PB-COMPANY-ID = 'BOA'
 16054         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16055         GO TO 3770-CHECK-REFUNDS.
 16056
 16057     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16058*    MOVE ' '                    TO DC-OPTION-CODE
 16059     SET BIN-TO-GREG             TO TRUE
 16060     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16061     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16062                                    PB-C-AH-REM-TERM.
 16063     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16064     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16065
 16066     IF PB-COMPANY-ID EQUAL 'FLC'
 16067        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16068           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16069           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16070                    - CM-AH-ITD-AH-PMT)
 16071           IF PB-C-AH-REF-CALC LESS THAN +0
 16072              MOVE +0            TO PB-C-AH-REF-CALC
 16073              GO TO 3770-CHECK-REFUNDS
 16074           ELSE
 16075              GO TO 3770-CHECK-REFUNDS.
 16076
 16077     IF PB-COMPANY-ID = 'DCC'
 16078        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16079            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16080           MOVE 'S'              TO CP-EARNING-METHOD
 16081        END-IF
 16082     END-IF
 16083     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16084                            OR '4' OR '5' OR '6' OR '8'
 16085                            OR '9' OR 'G' OR 'S'
 16086        MOVE PB-C-AH-REFUND-OVERRIDE
 16087                                 TO CP-EARNING-METHOD.
 16088
 16089     if pb-company-id = 'AHL'
 16090        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16091        if cp-class-code = spaces
 16092           move zeros            to cp-class-code
 16093        end-if
 16094     ELSE
 16095        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16096     END-IF
 16097*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16098     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16099     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16100                                    CP-RATING-BENEFIT-AMT.
 16101     IF CP-STATE-STD-ABBRV = 'OR'
 16102         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16103                                         PB-CI-AH-TERM.
 16104     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16105     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16106     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16107     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16108     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16109     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 291
* EL050.cbl
 16110
 16111     IF CP-STATE-STD-ABBRV = 'OH'
 16112        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16113                                AND 'CID' AND 'DCC' AND 'AHL')
 16114           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16115              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16116              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16117              MOVE '6' TO CP-EARNING-METHOD
 16118           END-IF
 16119        END-IF
 16120        IF PB-COMPANY-ID = 'CID'
 16121           IF NO-LIFE-COVERAGE
 16122              IF CP-CRITICAL-PERIOD
 16123                 MOVE '2'       TO CP-EARNING-METHOD
 16124              ELSE
 16125                 MOVE '6'       TO CP-EARNING-METHOD
 16126              END-IF
 16127           ELSE
 16128              IF WS-LF-COVERAGE-TYPE = 'L'
 16129                 MOVE '2'       TO CP-EARNING-METHOD
 16130              ELSE
 16131                 IF (PB-CI-LF-TERM > +60) OR
 16132                    (WS-LF-EARNINGS-CALC = '5')
 16133                    IF CP-CRITICAL-PERIOD
 16134                       MOVE '2'  TO CP-EARNING-METHOD
 16135                    ELSE
 16136                       MOVE '6'  TO CP-EARNING-METHOD
 16137                    END-IF
 16138                 ELSE
 16139                    MOVE '1'     TO CP-EARNING-METHOD
 16140                 END-IF
 16141              END-IF
 16142           END-IF
 16143        END-IF
 16144     END-IF
 16145
 16146*    IF CP-STATE-STD-ABBRV = 'VA'
 16147*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16148*          IF CP-ORIGINAL-TERM GREATER 61
 16149*             MOVE '6' TO CP-EARNING-METHOD
 16150*          ELSE
 16151*             MOVE '1' TO CP-EARNING-METHOD.
 16152
 16153     IF WS-DEFAULT-APR NOT NUMERIC
 16154         MOVE ZEROS TO WS-DEFAULT-APR.
 16155     IF CP-EARN-AS-NET-PAY
 16156         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16157            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16158                MOVE WS-DEFAULT-APR
 16159                                 TO  CP-LOAN-APR
 16160                MOVE ER-3780     TO  WS-ERROR
 16161                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16162            ELSE
 16163                MOVE ER-3781     TO  WS-ERROR
 16164                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16165     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16166     IF PB-COMPANY-ID = 'DCC'
 16167        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 292
* EL050.cbl
 16168        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16169        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16170     END-IF
 16171     IF PB-COMPANY-ID = 'DCC'
 16172        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16173        AND (CP-EARNING-METHOD = 'D')
 16174        AND (CP-CANCEL-REASON NOT = 'R')
 16175        CONTINUE
 16176     ELSE
 16177        GO TO 3750-CONTINUE
 16178     END-IF
 16179     MOVE ' '                    TO DD-IU-SW
 16180     IF NOT PDEF-MASTER-FOUND
 16181        MOVE ' '                 TO PDEF-MASTER-SW
 16182        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16183        MOVE PB-STATE            TO ERPDEF-STATE
 16184        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16185        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16186        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16187        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16188        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16189        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16190        IF PDEF-MASTER-FOUND
 16191           MOVE 'N'              TO PDEF-MASTER-SW
 16192           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16193           IF PDEF-MASTER-FOUND
 16194              IF (ERPDEF-KEY-SAVE (1:16) =
 16195                           PD-CONTROL-PRIMARY (1:16))
 16196                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16197                 CONTINUE
 16198              ELSE
 16199                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16200                 IF (ERPDEF-KEY-SAVE (1:16) =
 16201                           PD-CONTROL-PRIMARY (1:16))
 16202                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16203                    CONTINUE
 16204                 ELSE
 16205                    MOVE ER-2740 TO WS-ERROR
 16206                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16207                    GO TO 3770-CHECK-REFUNDS
 16208                 END-IF
 16209              END-IF
 16210           END-IF
 16211           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16212        END-IF
 16213     END-IF
 16214     IF PDEF-MASTER-FOUND
 16215        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16216           (V1 > +8)
 16217           OR (PD-PROD-CODE (V1) = 'I')
 16218        END-PERFORM
 16219        IF V1 < +9
 16220           SET DD-IU-PRESENT        TO TRUE
 16221        END-IF
 16222        IF WS-AH-DCC-TRUNC = 'T'
 16223           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16224        ELSE
 16225           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 293
* EL050.cbl
 16226        END-IF
 16227        EVALUATE TRUE
 16228           WHEN WS-TERM > +168
 16229              MOVE 15               TO V1
 16230           WHEN WS-TERM > +156
 16231              MOVE 14               TO V1
 16232           WHEN WS-TERM > +144
 16233              MOVE 13               TO V1
 16234           WHEN WS-TERM > +132
 16235              MOVE 12               TO V1
 16236           WHEN WS-TERM > +120
 16237              MOVE 11               TO V1
 16238           WHEN WS-TERM > +108
 16239              MOVE 10               TO V1
 16240           WHEN WS-TERM > +96
 16241              MOVE 9                TO V1
 16242           WHEN WS-TERM > +84
 16243              MOVE 8                TO V1
 16244           WHEN WS-TERM > +72
 16245              MOVE 7                TO V1
 16246           WHEN WS-TERM > +60
 16247              MOVE 6                TO V1
 16248           WHEN WS-TERM > +48
 16249              MOVE 5                TO V1
 16250           WHEN WS-TERM > +36
 16251              MOVE 4                TO V1
 16252           WHEN WS-TERM > +24
 16253              MOVE 3                TO V1
 16254           WHEN WS-TERM > +12
 16255              MOVE 2                TO V1
 16256           WHEN OTHER
 16257              MOVE 1                TO V1
 16258        END-EVALUATE
 16259
 16260        EVALUATE TRUE
 16261*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16262*             < +13)
 16263*             AND (DD-IU-PRESENT)
 16264*             MOVE 2                TO V2
 16265*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16266*             MOVE 1                TO V2
 16267           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16268              MOVE 2                TO V2
 16269           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16270              MOVE 3                TO V2
 16271           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16272              MOVE 4                TO V2
 16273           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16274              MOVE 5                TO V2
 16275           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16276              MOVE 6                TO V2
 16277           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16278              MOVE 7                TO V2
 16279           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16280              MOVE 8                TO V2
 16281           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16282              MOVE 9                TO V2
 16283           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 294
* EL050.cbl
 16284              MOVE 10               TO V2
 16285           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16286              MOVE 11               TO V2
 16287           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16288              MOVE 12               TO V2
 16289           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16290              MOVE 13               TO V2
 16291           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16292              MOVE 14               TO V2
 16293           WHEN OTHER
 16294              MOVE 15               TO V2
 16295        END-EVALUATE
 16296
 16297        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16298                                 TO CP-DDF-LO-FACT
 16299        MOVE PD-UEP-FACTOR (V1 V2)
 16300                                 TO CP-DDF-HI-FACT
 16301
 16302        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16303        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16304        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16305           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16306        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16307        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16308        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16309           + PD-1ST-YR-ADMIN-ALLOW
 16310
 16311        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16312*       IF PI-CLP-YN = 'Y'
 16313*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16314*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16315*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16316*       END-IF
 16317
 16318        IF DD-IU-PRESENT
 16319           MOVE 'I'              TO CP-EARNING-METHOD
 16320        END-IF
 16321        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16322                                     CP-CLP-RATE-UP
 16323        IF CP-IU-RATE-UP NOT = ZEROS
 16324           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16325              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16326           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16327              / (1 - WS-WORK-FACT)
 16328        END-IF
 16329     END-IF
 16330     .
 16331 3750-CONTINUE.
 16332     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16333
 16334     IF CP-REFUND-TYPE-USED NOT = SPACE
 16335         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16336
 16337     IF CP-ERROR-RATE-IS-ZERO OR
 16338        CP-ERROR-RATE-NOT-FOUND
 16339        MOVE ER-2740             TO WS-ERROR
 16340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16341
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 295
* EL050.cbl
 16342     IF CP-ERROR-RATE-FILE-NOTOPEN
 16343        MOVE ER-2617             TO WS-ERROR
 16344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16345     IF PB-COMPANY-ID = 'DCC'
 16346        AND PB-CI-ENTRY-STATUS = 'M'
 16347        MOVE +0                  TO PB-C-AH-REF-CALC
 16348     ELSE
 16349        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16350     END-IF
 16351     IF PB-COMPANY-ID = 'DCC'
 16352        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16353        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16354        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16355        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16356        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16357        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16358        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16359        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16360        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16361     END-IF
 16362     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 296
* EL050.cbl
 16364
 16365 3770-CHECK-REFUNDS.
 16366
 16367     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16368        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16369           MOVE ER-2766          TO WS-ERROR
 16370           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16371           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16372           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16373              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16374
 16375     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16376        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16377           MOVE ER-2766          TO WS-ERROR
 16378           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16379           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16380           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16381              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16382
 16383     IF PB-COMP-LF-CANCEL
 16384        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16385        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16386           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16387              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16388
 16389     IF PB-COMP-AH-CANCEL
 16390        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16391        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16392           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16393              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16394
 16395     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16396             GIVING WS-UNSIGN-WRK1
 16397     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16398             GIVING WS-UNSIGN-WRK2.
 16399
 16400     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16401         MOVE ZERO TO WS-UNSIGN-WRK1.
 16402
 16403     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16404         MOVE ZERO TO WS-UNSIGN-WRK2.
 16405
 16406     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16407
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 297
* EL050.cbl
 16409
 16410 3772-CONTINUE.
 16411
 16412**********************************
 16413*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16414*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16415*** DOUBLES THE TOLERANCE AMOUNT.
 16416***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16417**********************************
 16418     IF PB-COMPANY-ID = 'MON'
 16419     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16420         IF WS-REF-REJECT-SW = SPACE
 16421             MOVE ER-2754        TO WS-ERROR
 16422             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16423           ELSE
 16424             MOVE ER-2736        TO WS-ERROR
 16425             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16426**********************************
 16427
 16428 3773-CONTINUE.
 16429
 16430     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16431        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16432           MOVE ER-2723          TO WS-ERROR
 16433           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16434
 16435     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16436        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16437           MOVE ER-2724          TO WS-ERROR
 16438           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16439
 16440     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16441         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16442             (1 + WS-LF-REFUND-OVS-PCT)
 16443     ELSE
 16444         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16445
 16446     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16447         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16448             (1 - WS-TOL-LF-REFUND-PCT)
 16449     ELSE
 16450         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16451
 16452     IF (PB-COMPANY-ID = 'DCC')
 16453        AND (PB-CI-ENTRY-STATUS = 'M')
 16454        AND (PB-C-LF-CANCEL-AMT > +0)
 16455        MOVE ER-3843             TO WS-ERROR
 16456        PERFORM 9900-ERROR-FORMAT
 16457                                 THRU 9900-EXIT
 16458     END-IF
 16459     EVALUATE TRUE
 16460        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16461           CONTINUE
 16462        WHEN PB-C-LF-CANCEL-AMT = +0
 16463                 AND PB-C-LF-REF-CALC > +0
 16464           CONTINUE
 16465        WHEN WS-LF-REFUND-OVS-AMT = 0
 16466                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 298
* EL050.cbl
 16467           CONTINUE
 16468        WHEN OTHER
 16469           IF WS-TOL-LF-REFUND  = +0
 16470              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16471           END-IF
 16472           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16473                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16474                          (PB-C-LF-CANCEL-AMT))
 16475              CONTINUE
 16476           ELSE
 16477              IF WS-LF-REFUND-OVS-AMT = +0
 16478                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16479              END-IF
 16480              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16481                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16482                                       PB-C-LF-CANCEL-AMT)
 16483                 CONTINUE
 16484              ELSE
 16485                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16486                   MOVE ER-2754   TO  WS-ERROR
 16487                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16488                 ELSE
 16489                    MOVE ER-2736   TO  WS-ERROR
 16490                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16491                 END-IF
 16492              END-IF
 16493           END-IF
 16494     END-EVALUATE.
 16495
 16496     EVALUATE TRUE
 16497        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16498           CONTINUE
 16499        WHEN PB-C-LF-CANCEL-AMT = +0
 16500                 AND PB-C-LF-REF-CALC > +0
 16501           CONTINUE
 16502        WHEN OTHER
 16503           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16504               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16505              CONTINUE
 16506           ELSE
 16507              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16508               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16509                CONTINUE
 16510              ELSE
 16511                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16512                     MOVE ER-2754   TO  WS-ERROR
 16513                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16514                 ELSE
 16515                     MOVE ER-2736   TO  WS-ERROR
 16516                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16517                 END-IF
 16518              END-IF
 16519           END-IF
 16520     END-EVALUATE.
 16521
 16522     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16523         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16524             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 299
* EL050.cbl
 16525     ELSE
 16526         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16527
 16528     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16529         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16530             (1 - WS-TOL-AH-REFUND-PCT)
 16531     ELSE
 16532         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16533
 16534     IF (PB-COMPANY-ID = 'DCC')
 16535        AND (PB-CI-ENTRY-STATUS = 'M')
 16536        AND (PB-C-AH-CANCEL-AMT > +0)
 16537        MOVE ER-3843             TO WS-ERROR
 16538        PERFORM 9900-ERROR-FORMAT
 16539                                 THRU 9900-EXIT
 16540     END-IF
 16541     EVALUATE TRUE
 16542        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16543           CONTINUE
 16544*       WHEN PB-C-AH-REF-CALC = +0 AND
 16545*                  PB-C-AH-CANCEL-AMT > +0
 16546        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16547                   PB-C-AH-REF-CALC > +0
 16548           CONTINUE
 16549        WHEN WS-AH-REFUND-OVS-AMT = +0
 16550                AND WS-TOL-AH-REFUND = +0
 16551           CONTINUE
 16552        WHEN OTHER
 16553           IF WS-TOL-AH-REFUND = +0
 16554              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16555           END-IF
 16556           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16557               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16558                                         PB-C-AH-CANCEL-AMT)
 16559              CONTINUE
 16560           ELSE
 16561              IF WS-AH-REFUND-OVS-AMT = +0
 16562                 MOVE +9999999.99 TO
 16563                         WS-AH-REFUND-OVS-AMT
 16564              END-IF
 16565              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16566                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16567                                         PB-C-AH-CANCEL-AMT)
 16568                 CONTINUE
 16569              ELSE
 16570                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16571                    MOVE ER-2754   TO  WS-ERROR
 16572                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16573                 ELSE
 16574                    MOVE ER-2736   TO  WS-ERROR
 16575                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16576                 END-IF
 16577              END-IF
 16578           END-IF
 16579     END-EVALUATE.
 16580
 16581     EVALUATE TRUE
 16582        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 300
* EL050.cbl
 16583           CONTINUE
 16584*       WHEN PB-C-AH-REF-CALC > +0 AND
 16585*                  PB-C-AH-CANCEL-AMT = +0
 16586        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16587                   PB-C-AH-REF-CALC = +0
 16588           CONTINUE
 16589        WHEN OTHER
 16590           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16591               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16592              CONTINUE
 16593           ELSE
 16594              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16595                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16596                 CONTINUE
 16597              ELSE
 16598                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16599                     MOVE ER-2754   TO  WS-ERROR
 16600                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16601                 ELSE
 16602                     MOVE ER-2736   TO  WS-ERROR
 16603                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16604                 END-IF
 16605              END-IF
 16606           END-IF
 16607     END-EVALUATE.
 16608
 16609     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16610        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16611        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16612           AND  PB-C-LF-REF-CALC < +1.00
 16613           AND  PB-C-AH-REF-CALC < +1.00
 16614           CONTINUE
 16615        ELSE
 16616           IF (PB-COMPANY-ID = 'DCC')
 16617              AND (PB-CI-ENTRY-STATUS = 'M')
 16618              CONTINUE
 16619           ELSE
 16620              MOVE ER-2741       TO WS-ERROR
 16621              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16622           END-IF
 16623        END-IF
 16624     END-IF
 16625
 16626     IF (PB-C-LF-CANCEL-AMT = ZERO
 16627        AND WS-LF-BENEFIT-CD NOT = ZERO
 16628        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16629        AND PB-C-LF-REF-CALC NOT = ZERO)
 16630        OR
 16631        (PB-C-LF-CANCEL-AMT = ZERO
 16632        AND WS-LF-BENEFIT-CD NOT = ZERO
 16633        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16634             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16635                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16636                NEXT SENTENCE
 16637             ELSE
 16638                MOVE ER-2739        TO WS-ERROR
 16639                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16640
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 301
* EL050.cbl
 16641     IF (PB-C-AH-CANCEL-AMT = ZERO
 16642        AND WS-AH-BENEFIT-CD NOT = ZERO
 16643        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16644        AND PB-C-AH-REF-CALC NOT = ZERO)
 16645        OR
 16646        (PB-C-AH-CANCEL-AMT = ZERO
 16647        AND WS-AH-BENEFIT-CD NOT = ZERO
 16648        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16649             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16650                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16651                NEXT SENTENCE
 16652             ELSE
 16653                MOVE ER-2738        TO WS-ERROR
 16654                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16655
 16656 3775-OVER-REF-CHK.
 16657
 16658     IF PB-CI-ENTRY-STATUS = '5'
 16659        GO TO 3780-UPDATE-CANCEL-CERT.
 16660
 16661     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16662                              PB-CI-LF-ALT-PREMIUM-AMT.
 16663
 16664     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16665        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16666                                 PB-C-LF-REF-CALC
 16667      ELSE
 16668        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16669                                 PB-C-LF-CANCEL-AMT.
 16670
 16671     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16672        MOVE ER-2755             TO WS-ERROR
 16673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16674
 16675     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16676
 16677     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16678        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16679                                 PB-C-AH-REF-CALC
 16680      ELSE
 16681        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16682                                 PB-C-AH-CANCEL-AMT.
 16683
 16684     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16685        MOVE ER-2778             TO WS-ERROR
 16686        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16687
 16688     IF PB-CI-OB-FLAG NOT = 'Z'
 16689        NEXT SENTENCE
 16690       ELSE
 16691         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16692            MOVE ER-2757           TO WS-ERROR
 16693            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16694
 16695 3780-UPDATE-CANCEL-CERT.
 16696
 16697     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16698        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 302
* EL050.cbl
 16699        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16700
 16701     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16702         MOVE ER-2729              TO WS-ERROR
 16703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16704
 16705     IF PB-CI-LF-BENEFIT-CD = ZERO
 16706         GO TO 3780-UPDATE-CONT-1.
 16707
 16708     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16709         GO TO 3780-UPDATE-CONT-1.
 16710
 16711     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16712       AND
 16713        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16714       AND
 16715        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16716       AND
 16717        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16718            NEXT SENTENCE
 16719       ELSE
 16720        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16721          AND
 16722***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16723***       AND
 16724           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16725            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16726               MOVE ER-2730      TO WS-ERROR
 16727               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16728               GO TO 3999-END-EDIT
 16729            ELSE
 16730               GO TO 3999-END-EDIT
 16731        ELSE
 16732            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16733               MOVE ER-2765           TO WS-ERROR
 16734               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16735               GO TO 3785-CHECK-NH.
 16736*              GO TO 3999-END-EDIT.
 16737
 16738 3780-UPDATE-CONT-1.
 16739     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16740
 16741     IF PB-CI-AH-BENEFIT-CD = ZERO
 16742         GO TO 3780-UPDATE-CONT-2.
 16743
 16744     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16745         GO TO 3780-UPDATE-CONT-2.
 16746
 16747     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16748
 16749     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16750       AND
 16751        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16752       AND
 16753        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16754       AND
 16755        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16756            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 303
* EL050.cbl
 16757       ELSE
 16758        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16759          AND
 16760***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16761***       AND
 16762           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16763           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16764            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16765               MOVE ER-2773      TO WS-ERROR
 16766               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16767               GO TO 3999-END-EDIT
 16768            ELSE
 16769               GO TO 3999-END-EDIT
 16770            END-IF
 16771           ELSE
 16772             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16773                MOVE ER-2890 TO WS-ERROR
 16774                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16775                GO TO 3999-END-EDIT
 16776             ELSE
 16777                GO TO 3785-CHECK-NH
 16778             END-IF
 16779           END-IF
 16780          ELSE
 16781            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16782              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16783                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16784                   MOVE ER-2890 TO WS-ERROR
 16785                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16786                   GO TO 3999-END-EDIT
 16787                ELSE
 16788                   MOVE ER-2765 TO WS-ERROR
 16789                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16790                   GO TO 3785-CHECK-NH
 16791                END-IF
 16792              ELSE
 16793               MOVE ER-2765      TO WS-ERROR
 16794               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16795               GO TO 3785-CHECK-NH.
 16796*              GO TO 3999-END-EDIT.
 16797
 16798 3780-UPDATE-CONT-2.
 16799
 16800     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16801        AND WS-LF-BENEFIT-CD = ZERO
 16802           MOVE ER-2743           TO WS-ERROR
 16803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16804
 16805     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16806        AND WS-AH-BENEFIT-CD = ZERO
 16807           MOVE ER-2744           TO WS-ERROR
 16808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16809
 16810     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16811        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16812        AND
 16813        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16814         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 304
* EL050.cbl
 16815           MOVE ER-2746           TO WS-ERROR
 16816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16817
 16818     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16819       AND
 16820        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16821             MOVE ER-2737        TO WS-ERROR
 16822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16823
 16824     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16825       AND
 16826        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16827             MOVE ER-2737        TO WS-ERROR
 16828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16829
 16830     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16831         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16832             OR 'CID' OR 'DCC' OR 'AHL'
 16833             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16834         ELSE
 16835             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16836                 MOVE ER-2768    TO WS-ERROR
 16837                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16838             ELSE
 16839                 MOVE ER-2756    TO WS-ERROR
 16840                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16841
 16842     IF CERT-PEND-ISSUE-RETURNED
 16843        MOVE ER-2772             TO WS-ERROR
 16844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16845 3785-CHECK-NH.
 16846     IF PB-STATE NOT = 'NH'
 16847        GO TO 3999-END-EDIT
 16848     END-IF
 16849
 16850     MOVE ER-2796                TO WS-ERROR
 16851     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16852     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16853        OR (CM-NH-INTERFACE-SW = 'Y')
 16854        MOVE ER-2793             TO WS-ERROR
 16855        PERFORM 9900-ERROR-FORMAT
 16856                                 THRU 9900-EXIT
 16857     END-IF
 16858     MOVE +0                     TO WS-PAYMENT-AMT
 16859     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16860        GO TO 3999-END-EDIT
 16861     END-IF
 16862     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16863        GO TO 3999-END-EDIT
 16864     END-IF
 16865     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16866     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16867     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16868        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16869     END-IF
 16870     MOVE '1'                    TO DC-OPTION-CODE
 16871     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16872     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 305
* EL050.cbl
 16873        IF DC-ELAPSED-DAYS < +16
 16874           GO TO 3999-END-EDIT
 16875        END-IF
 16876     END-IF
 16877     MOVE +0                     TO DC-ELAPSED-DAYS
 16878     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16879     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16880     MOVE '1'                    TO DC-OPTION-CODE
 16881     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16882     IF NO-CONVERSION-ERROR
 16883        IF DC-ELAPSED-DAYS > +30
 16884           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16885        ELSE
 16886           GO TO 3999-END-EDIT
 16887        END-IF
 16888     ELSE
 16889        GO TO 3999-END-EDIT
 16890     END-IF
 16891     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16892        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16893           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16894     IF WS-PAYMENT-AMT < 600.00
 16895        GO TO 3999-END-EDIT
 16896     END-IF
 16897     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16898
 16899     IF (ERMAIL-FOUND = ' ')
 16900         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16901         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16902        GO TO 3999-END-EDIT
 16903     END-IF
 16904     MOVE ER-2795                TO WS-ERROR
 16905     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16906
 16907     GO TO 3999-END-EDIT.
 16908******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 306
* EL050.cbl
 16910 3990-FILES-NOT-OPEN.
 16911
 16912     MOVE ER-2617                TO WS-ERROR.
 16913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16914     GO TO 9990-RETURN.
 16915
 16916 3999-END-EDIT.
 16917
 16918     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16919
 16920     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16921         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16922         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16923             PERFORM 9250-UNLOCK-RETURN
 16924             GO TO 9990-RETURN
 16925          ELSE
 16926             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16927             GO TO 9990-RETURN.
 16928
 16929     IF PB-CANCELLATION
 16930          GO TO 9990-RETURN.
 16931
 16932     IF CERT-WAS-NOT-FOUND
 16933        MOVE SPACES              TO CERTIFICATE-MASTER.
 16934
 16935     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16936
 16937     IF CERT-WAS-FOUND
 16938         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16939             PERFORM 9250-UNLOCK-RETURN
 16940          ELSE
 16941            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16942      ELSE
 16943         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16944
 16945     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16946        IF PB-COMPANY-ID = 'DCC' AND
 16947           (PB-CARRIER = '2' OR '4' OR '6')
 16948              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16949        END-IF
 16950     END-IF.
 16951
 16952     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16953         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16954     END-IF.
 16955
 16956     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16957     IF ((PB-COMPANY-ID = 'DCC')
 16958        AND (WS-NO-SECURE-PAY))
 16959                  OR
 16960        (WS-LF-SPECIAL-CALC-CD = 'O'
 16961        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16962        SET SKIP-ADDR-EDIT       TO TRUE
 16963     END-IF
 16964     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16965        AND (NOT SKIP-ADDR-EDIT)
 16966        MOVE ER-2963             TO WS-ERROR
 16967        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 307
* EL050.cbl
 16968                                 THRU 9900-EXIT
 16969        GO TO 9990-RETURN
 16970     END-IF
 16971     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16972     IF ERPNDM-FOUND NOT = 'X'
 16973        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16974           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16975           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16976           AND (NOT SKIP-ADDR-EDIT)
 16977           MOVE ER-2694          TO WS-ERROR
 16978           PERFORM 9900-ERROR-FORMAT
 16979                                 THRU 9900-EXIT
 16980        END-IF
 16981        MOVE ' '                 TO STATE-RECORD-ERROR
 16982        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16983        MOVE PM-STATE            TO CNTL-ACCESS
 16984        MOVE '3'                 TO CNTL-REC-TYPE
 16985        MOVE +0                  TO CNTL-SEQ-NO
 16986        MOVE '0'                 TO RC-SW-2
 16987        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16988        IF (NO-STATE-RECORD)
 16989           OR (CF-RECORD-TYPE NOT = '3')
 16990           OR (PM-STATE NOT = CF-STATE-CODE)
 16991           IF (PM-STATE = SPACES)
 16992              AND (SKIP-ADDR-EDIT)
 16993              CONTINUE
 16994           ELSE
 16995              MOVE ER-2963       TO WS-ERROR
 16996              PERFORM 9900-ERROR-FORMAT
 16997                                 THRU 9900-EXIT
 16998           END-IF
 16999        END-IF
 17000        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17001           MOVE ER-2883          TO WS-ERROR
 17002           PERFORM 9900-ERROR-FORMAT
 17003                                 THRU 9900-EXIT
 17004        END-IF
 17005        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17006           MOVE ' '                 TO STATE-RECORD-ERROR
 17007           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17008           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17009           MOVE '3'                 TO CNTL-REC-TYPE
 17010           MOVE +0                  TO CNTL-SEQ-NO
 17011           MOVE '0'                 TO RC-SW-2
 17012           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17013           IF NO-STATE-RECORD
 17014              OR (CF-RECORD-TYPE NOT = '3')
 17015              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17016              MOVE ER-2964          TO WS-ERROR
 17017              PERFORM 9900-ERROR-FORMAT
 17018                                    THRU 9900-EXIT
 17019           END-IF
 17020        END-IF
 17021     ELSE
 17022        IF NOT SKIP-ADDR-EDIT
 17023           MOVE ER-2393          TO WS-ERROR
 17024           PERFORM 9900-ERROR-FORMAT
 17025                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 308
* EL050.cbl
 17026        END-IF
 17027     END-IF
 17028
 17029     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17030
 17031     IF (ERMAIL-FOUND = ' ' AND
 17032        ERPNDM-FOUND = ' ')
 17033        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17034           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17035           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17036          OR
 17037           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17038          OR
 17039           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17040           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17041           GO TO 3999-UNLOCK-ERMAIL.
 17042
 17043     IF ERPNDM-FOUND = 'X'
 17044        GO TO 3999-UNLOCK-ERMAIL.
 17045
 17046     IF PM-INSURED-LAST-NAME      = SPACES
 17047        AND PM-INSURED-FIRST-NAME = SPACES
 17048        AND PM-ADDRESS-LINE-1     = SPACES
 17049        AND PM-ADDRESS-LINE-2     = SPACES
 17050        AND PM-CITY-STATE         = SPACES
 17051        AND PM-CRED-BENE-NAME     = SPACES
 17052        AND PM-CRED-BENE-ADDR     = SPACES
 17053        AND PM-CRED-BENE-CTYST    = SPACES
 17054        GO TO 3999-UNLOCK-ERMAIL
 17055     END-IF
 17056
 17057     MOVE SPACES                 TO MAILING-DATA.
 17058
 17059     MOVE 'MA'                   TO MA-RECORD-ID.
 17060     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17061     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17062     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17063     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17064     MOVE PB-SV-STATE            TO MA-STATE.
 17065     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17066     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17067
 17068     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17069     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17070
 17071     IF ERMAIL-FOUND = ' '
 17072        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17073     ELSE
 17074        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17075        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17076        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17077
 17078     GO TO 9990-RETURN.
 17079
 17080 3999-UNLOCK-ERMAIL.
 17081     IF ERMAIL-FOUND = ' '
 17082        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17083
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 309
* EL050.cbl
 17084     GO TO 9990-RETURN.
 17085******************************************************************
 17086
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 310
* EL050.cbl
 17088 4000-UPDATE-CANCELLED-CERT.
 17089     IF CERT-WAS-NOT-FOUND
 17090        GO TO 4299-EXIT.
 17091
 17092*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17093     IF PB-C-NH-INT-ON-REFS > ZEROS
 17094        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17095     END-IF
 17096     IF PB-C-REF-INTERFACE-SW = 'Y'
 17097        MOVE PB-C-REF-INTERFACE-SW
 17098                                 TO CM-NH-INTERFACE-SW
 17099     END-IF
 17100     IF PB-C-POST-CARD-IND = 'Y'
 17101        MOVE +8                  TO SUB
 17102        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17103        IF ERMAIL-FOUND = ' '
 17104           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17105              (SUB > +7)
 17106              OR (MA-MAIL-STATUS (SUB) = '1')
 17107           END-PERFORM
 17108        END-IF
 17109        IF (SUB > +7)
 17110           OR (ERMAIL-FOUND = 'X')
 17111           MOVE ER-3789          TO WS-ERROR
 17112           PERFORM 9900-ERROR-FORMAT
 17113                                 THRU 9900-EXIT
 17114        END-IF
 17115     ELSE
 17116        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17117     END-IF
 17118     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17119
 17120     IF PB-CI-OB-FLAG = 'Z'
 17121        GO TO 4150-SUMMARY-CERT-CANCEL.
 17122
 17123     IF PB-C-LF-CANCEL-VOIDED
 17124         PERFORM 4200-REVERSE-LF-CANCEL.
 17125     IF PB-C-AH-CANCEL-VOIDED
 17126         PERFORM 4200-REVERSE-AH-CANCEL.
 17127
 17128 4100-APPLY-LF-CANCEL.
 17129
 17130     MOVE +0                     TO WS-SUB.
 17131
 17132 4100-CHECK-LF-ERRORS.
 17133
 17134     ADD +1                       TO WS-SUB.
 17135
 17136     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17137        IF LF-COVERAGE-CANCELLED
 17138           GO TO 4100-LF-CANCEL-CONT
 17139        ELSE
 17140           GO TO 4100-UPDATE-LF-COVERAGE.
 17141
 17142     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17143                                   ER-2729 OR
 17144                                   ER-2730 OR
 17145                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 311
* EL050.cbl
 17146                                   ER-2732 OR
 17147                                   ER-2737 OR
 17148                                   ER-2740 OR
 17149                                   ER-2743 OR
 17150                                   ER-2749 OR
 17151                                   ER-2750 OR
 17152                                   ER-2755 OR
 17153                                   ER-2757 OR
 17154                                   ER-2760 OR
 17155                                   ER-2772 OR
 17156                                   ER-2774 OR
 17157                                   ER-2776 OR
 17158                                   ER-2794
 17159        GO TO 4100-UPDATE-LF-COVERAGE.
 17160
 17161     GO TO 4100-CHECK-LF-ERRORS.
 17162
 17163 4100-UPDATE-LF-COVERAGE.
 17164
 17165     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17166     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17167     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17168        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17169     END-IF
 17170     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17171                                      TO CM-CREDIT-INTERFACE-SW-2.
 17172     IF CM-LF-CANCEL-DT = LOW-VALUE
 17173         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17174
 17175     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17176         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17177                                         CM-LF-STATUS-AT-CANCEL.
 17178
 17179     GO TO 4100-APPLY-AH-CANCEL.
 17180
 17181 4100-LF-CANCEL-CONT.
 17182     IF PB-C-LF-CANCEL-VOIDED
 17183         GO TO 4100-APPLY-AH-CANCEL.
 17184
 17185     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17186         GO TO 4100-APPLY-AH-CANCEL.
 17187
 17188     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17189        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17190           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17191        ELSE
 17192           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17193
 17194     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17195     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17196
 17197     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17198         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17199
 17200     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17201        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17202         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17203         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 312
* EL050.cbl
 17204
 17205     IF PB-RECORD-RETURNED
 17206        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17207      ELSE
 17208        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17209
 17210 4100-APPLY-AH-CANCEL.
 17211
 17212     MOVE +0                      TO WS-SUB.
 17213
 17214 4100-CHECK-AH-ERRORS.
 17215
 17216     ADD +1                       TO WS-SUB.
 17217
 17218     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17219        IF AH-COVERAGE-CANCELLED
 17220           GO TO 4100-AH-CANCEL-CONT
 17221        ELSE
 17222           GO TO 4100-UPDATE-AH-COVERAGE.
 17223
 17224     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17225                                   ER-2729 OR
 17226                                   ER-2732 OR
 17227                                   ER-2737 OR
 17228                                   ER-2740 OR
 17229                                   ER-2744 OR
 17230                                   ER-2749 OR
 17231                                   ER-2750 OR
 17232                                   ER-2755 OR
 17233                                   ER-2757 OR
 17234                                   ER-2760 OR
 17235                                   ER-2771 OR
 17236                                   ER-2772 OR
 17237                                   ER-2773 OR
 17238                                   ER-2775 OR
 17239                                   ER-2777 OR
 17240                                   ER-2794
 17241        GO TO 4100-UPDATE-AH-COVERAGE.
 17242
 17243     GO TO 4100-CHECK-AH-ERRORS.
 17244
 17245 4100-UPDATE-AH-COVERAGE.
 17246
 17247     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17248     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17249     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17250     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17251                                      TO CM-CREDIT-INTERFACE-SW-2.
 17252     IF CM-AH-CANCEL-DT = LOW-VALUE
 17253         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17254
 17255     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17256         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17257                                         CM-AH-STATUS-AT-CANCEL.
 17258
 17259     IF LF-COVERAGE-CANCELLED
 17260         IF PB-RECORD-RETURNED
 17261              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 313
* EL050.cbl
 17262          ELSE
 17263              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17264
 17265     GO TO 4299-EXIT.
 17266
 17267 4100-AH-CANCEL-CONT.
 17268     IF PB-C-AH-CANCEL-VOIDED
 17269         GO TO 4299-EXIT.
 17270     if cm-credit-interface-sw-2 = ' '
 17271        if pb-fatal-errors or pb-unforced-errors
 17272           move '4'              to cm-credit-interface-sw-2
 17273        else
 17274           move '1'              to cm-credit-interface-sw-2
 17275        end-if
 17276     end-if
 17277     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17278         GO TO 4299-EXIT.
 17279
 17280     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17281        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17282           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17283        ELSE
 17284           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17285
 17286     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17287     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17288
 17289     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17290         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17291
 17292     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17293         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17294         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17295
 17296     IF PB-RECORD-RETURNED
 17297        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17298      ELSE
 17299        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17300
 17301     GO TO 4299-EXIT.
 17302
 17303 4150-SUMMARY-CERT-CANCEL.
 17304     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17305
 17306     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17307        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17308                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17309     ELSE
 17310        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17311                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17312
 17313     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17314        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17315                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17316     ELSE
 17317        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17318                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17319
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 314
* EL050.cbl
 17320     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17321        NEXT SENTENCE
 17322     ELSE
 17323        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17324
 17325     GO TO 4299-EXIT.
 17326
 17327 4200-REVERSE-LF-CANCEL.
 17328     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17329
 17330     IF CM-LF-CANCEL-APPLIED
 17331        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17332        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17333        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17334
 17335     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17336
 17337     IF PB-RECORD-RETURNED
 17338        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17339       ELSE
 17340        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17341
 17342 4200-REVERSE-LF-EXIT.
 17343       EXIT.
 17344
 17345 4200-REVERSE-AH-CANCEL.
 17346     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17347
 17348     IF CM-AH-CANCEL-APPLIED
 17349        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17350        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17351        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17352
 17353     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17354
 17355     IF PB-RECORD-RETURNED
 17356        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17357       ELSE
 17358        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17359
 17360 4200-REVERSE-AH-EXIT.
 17361       EXIT.
 17362
 17363 4299-EXIT.
 17364       EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 315
* EL050.cbl
 17366
 17367 4500-UPDATE-NEW-CERT.
 17368     IF CERT-WAS-FOUND
 17369         NEXT SENTENCE
 17370       ELSE
 17371         GO TO 4520-BUILD-NEW-KEY.
 17372
 17373     IF  CLASIC-CREATED-CERT
 17374         GO TO 4999-EXIT.
 17375
 17376     IF  CERT-WAS-CREATED-FOR-CLAIM
 17377         GO TO 4520-BUILD-NEW-KEY.
 17378
 17379     IF CERT-ADDED-BATCH
 17380        IF CM-RECORD-ID = 'CM'
 17381            GO TO 4999-EXIT.
 17382
 17383 4520-BUILD-NEW-KEY.
 17384* BUILD CONTROL PRIMARY
 17385
 17386     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17387                                       CM-COMPANY-CD-A1
 17388                                       CM-COMPANY-CD-A2
 17389                                       CM-COMPANY-CD-A4
 17390                                       CM-COMPANY-CD-A5.
 17391
 17392     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17393     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17394     MOVE PB-SV-STATE               TO CM-STATE.
 17395     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17396     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17397     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17398     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17399
 17400     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17401
 17402     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17403     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17404     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17405     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17406
 17407     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17408        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17409
 17410     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17411         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17412         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17413         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17414         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17415     ELSE
 17416         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17417
 17418     IF PB-COMPANY-ID   EQUAL  'CRI'
 17419         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17420         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17421         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17422         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17423         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 316
* EL050.cbl
 17424
 17425     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17426        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17427         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17428
 17429     IF PB-COMPANY-ID  = 'LBL'
 17430        IF PB-I-JOINT-COVERAGE
 17431            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17432                                           PB-I-MEMBER-NO
 17433            GO TO 4550-CONT-CERT-PROCESS.
 17434
 17435     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17436        NEXT SENTENCE
 17437     ELSE
 17438        GO TO 4540-BUILD-MEMBER-NO.
 17439
 17440******************************************************************
 17441*                                                                *
 17442*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17443*    FOR 'MON'.                                                  *
 17444*                                                                *
 17445******************************************************************
 17446
 17447     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17448     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17449     MOVE +1                     TO WS-SUB1
 17450                                    WS-SUB2.
 17451
 17452 4530-EDIT-MEMB-NAME.
 17453
 17454     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17455        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17456        ADD +1                       TO WS-SUB2.
 17457
 17458     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17459        ADD +1                       TO WS-SUB1
 17460        GO TO 4530-EDIT-MEMB-NAME.
 17461
 17462     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17463     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17464     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17465*    MOVE SPACE                      TO DC-OPTION-CODE.
 17466     SET  BIN-TO-GREG                TO TRUE.
 17467     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17468     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17469
 17470     GO TO 4550-CONT-CERT-PROCESS.
 17471
 17472******************************************************************
 17473*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17474******************************************************************
 17475
 17476 4540-BUILD-MEMBER-NO.
 17477
 17478     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17479         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17480         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17481         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 317
* EL050.cbl
 17482         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17483     ELSE
 17484         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17485
 17486     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17487        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17488         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17489
 17490 4550-CONT-CERT-PROCESS.
 17491
 17492*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17493*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17494*    ELSE
 17495*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17496
 17497     IF CERT-WAS-CREATED-FOR-CLAIM
 17498        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17499        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17500
 17501     IF CERT-AND-CLAIM-ONLINE
 17502        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17503        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17504
 17505     MOVE 'CM'                     TO CM-RECORD-ID.
 17506     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17507
 17508     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17509        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17510        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17511     ELSE
 17512        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17513        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17514
 17515     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17516     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17517     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17518     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17519     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17520     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17521     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17522                                      CM-LF-ITD-CANCEL-AMT
 17523                                      CM-LF-ITD-DEATH-AMT
 17524                                      CM-AH-ITD-AH-PMT
 17525                                      CM-AH-ITD-LUMP-PMT
 17526                                      CM-AH-ITD-CANCEL-AMT
 17527                                      CM-LF-NSP-PREMIUM-AMT
 17528                                      CM-AH-NSP-PREMIUM-AMT.
 17529*                                     CM-CLAIM-DEDUCT-WITHHELD
 17530*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17531     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17532     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17533     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17534     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17535     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17536     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17537     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17538     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17539     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 318
* EL050.cbl
 17540     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17541     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17542     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17543
 17544     IF PB-I-LIVES NOT NUMERIC
 17545         MOVE ZERO                 TO PB-I-LIVES.
 17546
 17547     IF PB-I-NUM-BILLED NOT NUMERIC
 17548         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17549
 17550     MOVE PB-I-LIVES               TO CM-LIVES.
 17551     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17552
 17553     IF PB-COMPANY-ID EQUAL  'DMD'
 17554         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17555         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17556
 17557     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17558     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17559     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17560     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17561     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17562     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17563
 17564     IF PB-I-LF-POLICY-FEE NUMERIC
 17565        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17566     ELSE
 17567        MOVE +0                    TO CM-LF-POLICY-FEE.
 17568
 17569     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17570        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17571        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17572     ELSE
 17573        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17574
 17575     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17576     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17577     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17578     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17579     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17580     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17581     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17582     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17583     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17584
 17585     IF PB-I-AH-POLICY-FEE NUMERIC
 17586        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17587     ELSE
 17588        MOVE +0                    TO CM-AH-POLICY-FEE.
 17589
 17590     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17591        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17592     ELSE
 17593        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17594
 17595     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17596     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17597
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 319
* EL050.cbl
 17598     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17599                                      CM-LF-DEATH-EXIT-DT
 17600                                      CM-AH-SETTLEMENT-EXIT-DT.
 17601
 17602*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17603*                       'TIH' OR 'OFL' OR 'FLA' OR
 17604*                       'TII' OR 'TMS' OR 'CRI' OR
 17605*                       'NCL'
 17606     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17607
 17608     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17609         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17610            MOVE '2'                TO CM-PREMIUM-TYPE.
 17611
 17612     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17613         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17614            MOVE '2'                TO CM-PREMIUM-TYPE.
 17615
 17616     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17617         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17618     ELSE
 17619         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17620         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17621
 17622     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17623     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17624     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17625     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17626     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17627     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17628     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17629     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17630
 17631     IF PB-NO-MONTHS-SKIPPED
 17632         MOVE SPACE                 TO CM-SKIP-CODE
 17633     ELSE
 17634         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17635
 17636     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17637     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17638                                       CM-LF-STATUS-AT-CANCEL.
 17639
 17640     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17641     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17642                                       CM-AH-STATUS-AT-CANCEL.
 17643
 17644     MOVE '1'                       TO CM-ENTRY-STATUS.
 17645
 17646     IF PB-REISSUED-CERT
 17647        MOVE '5'                    TO CM-ENTRY-STATUS.
 17648
 17649     IF PB-MONTHLY-CERT
 17650        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17651
 17652     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17653     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17654     IF PB-POLICY-IS-DECLINED
 17655        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 320
* EL050.cbl
 17656
 17657     IF PB-POLICY-IS-VOIDED
 17658        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17659
 17660     IF PB-NEEDS-UNDERWRITING
 17661        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17662
 17663     IF PB-REIN-ONLY-CERT
 17664        MOVE '9'                    TO CM-ENTRY-STATUS.
 17665
 17666     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17667         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17668     ELSE
 17669         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17670
 17671     IF PB-RECORD-RETURNED
 17672        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17673      ELSE
 17674        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17675
 17676     IF PB-I-MAIL-ADDRS-PRESENT
 17677        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17678
 17679     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17680                                       CM-ENTRY-DT.
 17681
 17682 4999-EXIT.
 17683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 321
* EL050.cbl
 17685
 17686 5000-PROCESS-REPS.
 17687     MOVE ' '                    TO AGTC-MASTER-SW
 17688     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17689     MOVE CO-TYPE                TO AGTC-TYPE
 17690     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17691     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17692     IF (AGTC-MASTER-SW NOT = 'N')
 17693        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17694        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17695        PERFORM 8583-READ-ERAGTC-NEXT
 17696                                 THRU 8583-EXIT
 17697     END-IF
 17698     IF AGTC-MASTER-SW = 'N'
 17699        CONTINUE
 17700     ELSE
 17701        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17702           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17703              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17704              MOVE 'Y'           TO AGTC-MASTER-SW
 17705           END-IF
 17706        END-IF
 17707     END-IF
 17708     .
 17709 5000-EXIT.
 17710     EXIT.
 17711 6370-EDIT-INPUT-LF-CODE.
 17712     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17713        MOVE +1                  TO SUB
 17714        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17715        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17716        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17717        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17718        GO TO 6370-SEARCH-LOOP.
 17719
 17720     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17721
 17722     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17723     MOVE SPACES                 TO CNTL-ACCESS.
 17724*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17725     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17726     MOVE +0                     TO CNTL-SEQ-NO.
 17727     MOVE '4' TO RC-SW-2.
 17728     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17729
 17730     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17731        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17732        GO TO 6370-NO-LF-FOUND.
 17733
 17734     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17735     MOVE +1                     TO SUB.
 17736
 17737 6370-SEARCH-LOOP.
 17738     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17739         GO TO 6370-NO-LF-FOUND.
 17740
 17741     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17742         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 322
* EL050.cbl
 17743         GO TO 6370-HER-NET-PAY-CHECK.
 17744
 17745     ADD 1   TO SUB.
 17746*    IF SUB GREATER 120
 17747     IF SUB GREATER 200
 17748         GO TO 6370-NO-LF-FOUND.
 17749
 17750     GO TO 6370-SEARCH-LOOP.
 17751
 17752 6370-NO-LF-FOUND.
 17753
 17754     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17755
 17756 6370-HER-NET-PAY-CHECK.
 17757
 17758     IF PB-COMPANY-ID = 'CID'
 17759        IF PB-SV-STATE = 'CA' OR 'MN'
 17760           IF PB-I-LF-BENEFIT-CD = '02'
 17761              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17762           ELSE
 17763              IF PB-I-LF-BENEFIT-CD = '04'
 17764                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17765              END-IF
 17766           END-IF
 17767        END-IF
 17768     END-IF
 17769
 17770     IF PB-COMPANY-ID NOT = 'HER'
 17771         GO TO 6370-EXIT.
 17772
 17773     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17774         GO TO 6370-EXIT.
 17775
 17776     IF PB-I-LF-TERM NOT NUMERIC
 17777         MOVE ZEROS              TO PB-I-LF-TERM.
 17778
 17779     IF PB-I-LOAN-TERM NOT NUMERIC
 17780         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17781
 17782     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17783         GO TO 6370-EXIT.
 17784
 17785     IF PB-I-LF-BENEFIT-CD = '33'
 17786         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17787
 17788     IF PB-I-LF-BENEFIT-CD = '34'
 17789         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17790
 17791 6370-EXIT.
 17792     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 323
* EL050.cbl
 17794
 17795 6380-EDIT-INPUT-AH-CODE.
 17796     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17797        MOVE +1                  TO SUB
 17798        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17799        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17800        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17801        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17802        GO TO 6380-SEARCH-LOOP.
 17803
 17804     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17805
 17806     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17807     MOVE SPACES                 TO CNTL-ACCESS.
 17808     MOVE 'A'                    TO CNTL-REC-TYPE.
 17809*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17810     MOVE +0                     TO CNTL-SEQ-NO.
 17811     MOVE '5' TO RC-SW-2.
 17812     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17813
 17814     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17815        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17816        GO TO 6380-NO-AH-FOUND.
 17817
 17818     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17819     MOVE +1 TO SUB.
 17820
 17821 6380-SEARCH-LOOP.
 17822     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17823         GO TO 6380-NO-AH-FOUND.
 17824
 17825     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17826         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17827         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17828
 17829     ADD 1   TO SUB.
 17830     IF SUB GREATER THAN 96
 17831*    IF SUB GREATER THAN 300
 17832         GO TO 6380-NO-AH-FOUND.
 17833
 17834     GO TO 6380-SEARCH-LOOP.
 17835
 17836 6380-NO-AH-FOUND.
 17837
 17838     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17839
 17840     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17841         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17842     ELSE
 17843         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17844
 17845 6380-CSO-AH-ONLY-CHECKS.
 17846
 17847     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17848        NEXT SENTENCE
 17849      ELSE
 17850        GO TO 6380-EXIT.
 17851
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 324
* EL050.cbl
 17852     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17853         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17854
 17855
 17856     GO TO 6380-EXIT
 17857     .
 17858 6380-CSO-LIFE-WITH-AH-CHECKS.
 17859
 17860
 17861     .
 17862 6380-EXIT.
 17863     EXIT.
 17864
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 325
* EL050.cbl
 17866
 17867 6400-COMPUTE-EXTENSION-DAYS.
 17868
 17869******************************************************************
 17870*                                                                *
 17871*                   COMPUTE EXTENSION DAYS                       *
 17872*                                                                *
 17873*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17874*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17875*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17876*    THE EXTENSION DAYS.                                         *
 17877*                                                                *
 17878******************************************************************
 17879
 17880     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17881     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17882
 17883******************************************************************
 17884*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17885*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17886******************************************************************
 17887
 17888     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17889        COMPUTE WS-ODD-DAYS-OVER =
 17890               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17891     ELSE
 17892        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17893
 17894     IF WS-ODD-DAYS-OVER = ZEROS
 17895           GO TO 6499-EXIT
 17896     ELSE
 17897        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17898           IF WS-WDF-MONTH = 02
 17899              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17900              ADD 2       TO  WS-ODD-DAYS-OVER
 17901              GO TO 6499-EXIT
 17902           ELSE
 17903              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17904                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17905                 GO TO 6499-EXIT
 17906               ELSE
 17907                 GO TO 6499-EXIT
 17908        ELSE
 17909           GO TO 6499-EXIT.
 17910
 17911 6412-CHECK-TO-DAY.
 17912
 17913        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17914           IF WS-WDT-DAY = 28
 17915              ADD 2              TO WS-ODD-DAYS-OVER
 17916           ELSE
 17917              IF WS-WDT-DAY = 29
 17918                 ADD 1           TO WS-ODD-DAYS-OVER
 17919              ELSE
 17920                 NEXT SENTENCE
 17921        ELSE
 17922           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17923              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 326
* EL050.cbl
 17924
 17925     GO TO 6499-EXIT.
 17926
 17927
 17928 6415-CHECK-LEAP-YEAR.
 17929
 17930     IF DC-DAYS-IN-MONTH = 29
 17931        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17932
 17933 6415-EXIT.
 17934     EXIT.
 17935
 17936 6499-EXIT.
 17937      EXIT.
 17938
 17939 6500-END.
 17940     EXIT.
 17941
 17942
 17943******************************************************************
 17944************* PROCEDURE DIVISION FOR EL050 ***********************
 17945********************** ELC50PD END *******************************
 17946
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 327
* EL050.cbl
 17948
 17949**START***********************************************************
 17950*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17951*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17952******************************************************************
 17953*
 17954 6600-GET-STATE-MUNICIPAL-TAX.
 17955
 17956     IF PB-COMPANY-ID NOT = 'DMD'
 17957         GO TO 6640-EXIT.
 17958
 17959     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17960     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17961     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17962*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17963*
 17964***  Y2K PROJ 7744
 17965     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17966     SET BIN-TO-GREG          TO TRUE.
 17967     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17968
 17969     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17970
 17971     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17972     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17973
 17974
 17975* EXEC CICS HANDLE CONDITION
 17976*        INVREQ    (6610-START-BROWSE)
 17977*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17978*        NOTFND    (6630-END-OF-FILE)
 17979*    END-EXEC.
 17980*    MOVE '"$8JI                 ! # #00017962' TO DFHEIV0
 17981     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17983     MOVE X'2320233030303137393632' TO DFHEIV0(25:11)
 17984     CALL 'kxdfhei1' USING DFHEIV0
 17985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17986
 17987
 17988 6610-START-BROWSE.
 17989
 17990
 17991* EXEC CICS HANDLE CONDITION
 17992*        NOTFND    (6630-END-OF-FILE)
 17993*        DISABLED  (6630-ERRESS-PROBLEM)
 17994*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17995*        ENDFILE   (6630-END-OF-FILE)
 17996*    END-EXEC.
 17997*    MOVE '"$IcJ''                ! $ #00017970' TO DFHEIV0
 17998     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18000     MOVE X'2420233030303137393730' TO DFHEIV0(25:11)
 18001     CALL 'kxdfhei1' USING DFHEIV0
 18002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18003
 18004
 18005
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 328
* EL050.cbl
 18006* EXEC CICS STARTBR
 18007*        DATASET (FILE-ID-ERRESS)
 18008*        RIDFLD  (WS-ERRESS-KEY)
 18009*        GTEQ
 18010*    END-EXEC.
 18011     MOVE 0
 18012       TO DFHEIV11
 18013*    MOVE '&,         G          &   #00017977' TO DFHEIV0
 18014     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18016     MOVE X'2020233030303137393737' TO DFHEIV0(25:11)
 18017     CALL 'kxdfhei1' USING DFHEIV0,
 18018           FILE-ID-ERRESS,
 18019           WS-ERRESS-KEY,
 18020           DFHEIV99,
 18021           DFHEIV11,
 18022           DFHEIV99
 18023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18024
 18025
 18026 6620-READ-NEXT-ERRESS-MASTER.
 18027
 18028
 18029* EXEC CICS HANDLE CONDITION
 18030*        NOTFND    (6630-END-OF-FILE)
 18031*        ENDFILE   (6630-END-OF-FILE)
 18032*        DISABLED  (6630-ERRESS-PROBLEM)
 18033*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18034*    END-EXEC.
 18035*    MOVE '"$I''cJ                ! % #00017985' TO DFHEIV0
 18036     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18038     MOVE X'2520233030303137393835' TO DFHEIV0(25:11)
 18039     CALL 'kxdfhei1' USING DFHEIV0
 18040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18041
 18042
 18043
 18044* EXEC CICS READNEXT
 18045*        DATASET (FILE-ID-ERRESS)
 18046*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18047*        RIDFLD  (WS-ERRESS-KEY)
 18048*    END-EXEC.
 18049     MOVE LENGTH OF
 18050      RESIDENT-STATE-TAX-MASTER
 18051       TO DFHEIV12
 18052     MOVE 0
 18053       TO DFHEIV11
 18054*    MOVE '&.IL                  )   #00017992' TO DFHEIV0
 18055     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18056     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18057     MOVE X'2020233030303137393932' TO DFHEIV0(25:11)
 18058     CALL 'kxdfhei1' USING DFHEIV0,
 18059           FILE-ID-ERRESS,
 18060           RESIDENT-STATE-TAX-MASTER,
 18061           DFHEIV12,
 18062           WS-ERRESS-KEY,
 18063           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 329
* EL050.cbl
 18064           DFHEIV11,
 18065           DFHEIV99,
 18066           DFHEIV99
 18067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18068
 18069
 18070     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18071
 18072* EXEC CICS ENDBR
 18073*            DATASET (FILE-ID-ERRESS)
 18074*       END-EXEC
 18075     MOVE 0
 18076       TO DFHEIV11
 18077*    MOVE '&2                    $   #00017999' TO DFHEIV0
 18078     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18080     MOVE X'2020233030303137393939' TO DFHEIV0(25:11)
 18081     CALL 'kxdfhei1' USING DFHEIV0,
 18082           FILE-ID-ERRESS,
 18083           DFHEIV11,
 18084           DFHEIV99
 18085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18086        GO TO 6630-END-OF-FILE.
 18087
 18088     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18089        NEXT SENTENCE
 18090      ELSE
 18091        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18092
 18093*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18094*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18095*
 18096     MOVE +2                     TO WS-SUB1.
 18097
 18098     IF PB-ISSUE
 18099     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18100        MOVE +1                  TO WS-SUB1.
 18101
 18102     IF PB-CANCELLATION
 18103     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18104        MOVE +1                  TO WS-SUB1.
 18105*
 18106*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18107*
 18108***  Y2K PROJ 7744
 18109     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18110***  Y2K PROJ 7744
 18111
 18112*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18113* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18114* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18115
 18116     ADD 1                    TO WS-YEAR-YY.
 18117
 18118     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18119         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18120                              TO WS-RES-STATE-TAX
 18121         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 330
* EL050.cbl
 18122                              TO WS-RES-MUNI-TAX
 18123     ELSE
 18124         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18125                              TO WS-RES-STATE-TAX
 18126         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18127                              TO WS-RES-MUNI-TAX.
 18128
 18129*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18130
 18131     IF PB-CANCELLATION
 18132         GO TO 6640-CANCEL-TAX.
 18133
 18134     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18135         COMPUTE PB-I-STATE-TAX ROUNDED =
 18136                                   PB-I-LF-PREMIUM-AMT
 18137                                 * WS-RES-STATE-TAX
 18138         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18139                                   PB-I-LF-PREMIUM-AMT
 18140                                 * WS-RES-MUNI-TAX
 18141     ELSE
 18142     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18143         COMPUTE PB-I-STATE-TAX ROUNDED =
 18144                                   PB-I-AH-PREMIUM-AMT
 18145                                 * WS-RES-STATE-TAX
 18146         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18147                                   PB-I-AH-PREMIUM-AMT
 18148                                 * WS-RES-MUNI-TAX.
 18149
 18150
 18151* EXEC CICS ENDBR
 18152*         DATASET (FILE-ID-ERRESS)
 18153*    END-EXEC.
 18154     MOVE 0
 18155       TO DFHEIV11
 18156*    MOVE '&2                    $   #00018066' TO DFHEIV0
 18157     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18158     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18159     MOVE X'2020233030303138303636' TO DFHEIV0(25:11)
 18160     CALL 'kxdfhei1' USING DFHEIV0,
 18161           FILE-ID-ERRESS,
 18162           DFHEIV11,
 18163           DFHEIV99
 18164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18165
 18166
 18167     GO TO 6640-EXIT.
 18168
 18169 6640-CANCEL-TAX.
 18170     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18171
 18172     IF PB-C-LF-CANCEL-AMT > ZEROS
 18173         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18174                                   PB-C-LF-CANCEL-AMT
 18175                                 * WS-RES-STATE-TAX
 18176         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18177                                   PB-C-LF-CANCEL-AMT
 18178                                *  WS-RES-MUNI-TAX
 18179     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 331
* EL050.cbl
 18180     IF PB-C-AH-CANCEL-AMT > ZEROS
 18181         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18182                                   PB-C-AH-CANCEL-AMT
 18183                                 * WS-RES-STATE-TAX
 18184         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18185                                   PB-C-AH-CANCEL-AMT
 18186                                *  WS-RES-MUNI-TAX.
 18187
 18188
 18189* EXEC CICS ENDBR
 18190*         DATASET (FILE-ID-ERRESS)
 18191*    END-EXEC.
 18192     MOVE 0
 18193       TO DFHEIV11
 18194*    MOVE '&2                    $   #00018091' TO DFHEIV0
 18195     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18196     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18197     MOVE X'2020233030303138303931' TO DFHEIV0(25:11)
 18198     CALL 'kxdfhei1' USING DFHEIV0,
 18199           FILE-ID-ERRESS,
 18200           DFHEIV11,
 18201           DFHEIV99
 18202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18203
 18204
 18205     GO TO 6640-EXIT.
 18206
 18207 6630-END-OF-FILE.
 18208     MOVE ER-8002              TO WS-ERROR.
 18209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18210
 18211     GO TO 6640-EXIT.
 18212
 18213 6630-ERRESS-PROBLEM.
 18214     MOVE ER-8044              TO WS-ERROR.
 18215     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18216
 18217 6640-EXIT.
 18218     EXIT.
 18219
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 332
* EL050.cbl
 18221 6650-GET-RES-STATE-COMM.
 18222
 18223     IF PB-COMPANY-ID NOT = 'DMD'
 18224         GO TO 6700-COMM-EXIT.
 18225
 18226     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18227     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18228     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18229     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18230     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18231     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18232     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18233
 18234*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18235*
 18236***  Y2K PROJ 7744
 18237     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18238     SET BIN-TO-GREG          TO TRUE.
 18239     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18240
 18241     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18242***  Y2K PROJ 7744
 18243
 18244     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18245
 18246
 18247* EXEC CICS HANDLE CONDITION
 18248*        INVREQ    (6660-START-BROWSE)
 18249*        DISABLED  (6690-ERRESC-PROBLEM)
 18250*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18251*        NOTFND    (6690-END-OF-FILE)
 18252*    END-EXEC.
 18253*    MOVE '"$8cJI                ! & #00018136' TO DFHEIV0
 18254     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18256     MOVE X'2620233030303138313336' TO DFHEIV0(25:11)
 18257     CALL 'kxdfhei1' USING DFHEIV0
 18258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18259
 18260
 18261
 18262* EXEC CICS RESETBR
 18263*        DATASET (FILE-ID-ERRESC)
 18264*        RIDFLD  (WS-ERRESC-KEY)
 18265*    END-EXEC.
 18266     MOVE 0
 18267       TO DFHEIV11
 18268*    MOVE '&4         G          &   #00018143' TO DFHEIV0
 18269     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18271     MOVE X'2020233030303138313433' TO DFHEIV0(25:11)
 18272     CALL 'kxdfhei1' USING DFHEIV0,
 18273           FILE-ID-ERRESC,
 18274           WS-ERRESC-KEY,
 18275           DFHEIV99,
 18276           DFHEIV11,
 18277           DFHEIV99
 18278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 333
* EL050.cbl
 18279
 18280
 18281 6660-START-BROWSE.
 18282
 18283
 18284* EXEC CICS HANDLE CONDITION
 18285*        NOTFND    (6690-END-OF-FILE)
 18286*        DISABLED  (6690-ERRESC-PROBLEM)
 18287*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18288*        ENDFILE   (6690-END-OF-FILE)
 18289*    END-EXEC.
 18290*    MOVE '"$IcJ''                ! '' #00018150' TO DFHEIV0
 18291     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18293     MOVE X'2720233030303138313530' TO DFHEIV0(25:11)
 18294     CALL 'kxdfhei1' USING DFHEIV0
 18295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18296
 18297
 18298
 18299* EXEC CICS STARTBR
 18300*        DATASET (FILE-ID-ERRESC)
 18301*        RIDFLD  (WS-ERRESC-KEY)
 18302*        GTEQ
 18303*    END-EXEC.
 18304     MOVE 0
 18305       TO DFHEIV11
 18306*    MOVE '&,         G          &   #00018157' TO DFHEIV0
 18307     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18309     MOVE X'2020233030303138313537' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0,
 18311           FILE-ID-ERRESC,
 18312           WS-ERRESC-KEY,
 18313           DFHEIV99,
 18314           DFHEIV11,
 18315           DFHEIV99
 18316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18317
 18318
 18319     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18320
 18321 6670-READ-NEXT-ERRESC-MASTER.
 18322
 18323
 18324* EXEC CICS HANDLE CONDITION
 18325*        NOTFND    (6690-END-OF-FILE)
 18326*        DISABLED  (6690-ERRESC-PROBLEM)
 18327*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18328*        ENDFILE   (6690-END-OF-FILE)
 18329*    END-EXEC.
 18330*    MOVE '"$IcJ''                ! ( #00018167' TO DFHEIV0
 18331     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18333     MOVE X'2820233030303138313637' TO DFHEIV0(25:11)
 18334     CALL 'kxdfhei1' USING DFHEIV0
 18335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18336
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 334
* EL050.cbl
 18337
 18338
 18339* EXEC CICS READNEXT
 18340*        DATASET (FILE-ID-ERRESC)
 18341*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18342*        RIDFLD  (ERRESC-RECORD-KEY)
 18343*    END-EXEC.
 18344     MOVE LENGTH OF
 18345      ACCOUNT-RESIDENT-ST-COMMISSION
 18346       TO DFHEIV12
 18347     MOVE 0
 18348       TO DFHEIV11
 18349*    MOVE '&.IL                  )   #00018174' TO DFHEIV0
 18350     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18351     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18352     MOVE X'2020233030303138313734' TO DFHEIV0(25:11)
 18353     CALL 'kxdfhei1' USING DFHEIV0,
 18354           FILE-ID-ERRESC,
 18355           ACCOUNT-RESIDENT-ST-COMMISSION,
 18356           DFHEIV12,
 18357           ERRESC-RECORD-KEY,
 18358           DFHEIV99,
 18359           DFHEIV11,
 18360           DFHEIV99,
 18361           DFHEIV99
 18362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18363
 18364
 18365     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18366        NEXT SENTENCE
 18367     ELSE
 18368
 18369* EXEC CICS ENDBR
 18370*            DATASET (FILE-ID-ERRESC)
 18371*       END-EXEC
 18372     MOVE 0
 18373       TO DFHEIV11
 18374*    MOVE '&2                    $   #00018183' TO DFHEIV0
 18375     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18376     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18377     MOVE X'2020233030303138313833' TO DFHEIV0(25:11)
 18378     CALL 'kxdfhei1' USING DFHEIV0,
 18379           FILE-ID-ERRESC,
 18380           DFHEIV11,
 18381           DFHEIV99
 18382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18383        GO TO 6690-END-OF-FILE.
 18384
 18385     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18386
 18387* EXEC CICS ENDBR
 18388*            DATASET (FILE-ID-ERRESC)
 18389*       END-EXEC
 18390     MOVE 0
 18391       TO DFHEIV11
 18392*    MOVE '&2                    $   #00018189' TO DFHEIV0
 18393     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 335
* EL050.cbl
 18395     MOVE X'2020233030303138313839' TO DFHEIV0(25:11)
 18396     CALL 'kxdfhei1' USING DFHEIV0,
 18397           FILE-ID-ERRESC,
 18398           DFHEIV11,
 18399           DFHEIV99
 18400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18401        GO TO 6690-END-OF-FILE.
 18402
 18403     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18404        NEXT SENTENCE
 18405      ELSE
 18406        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18407
 18408* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18409*
 18410     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18411
 18412     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18413
 18414     IF WS-SUB1 > ZERO
 18415         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18416             PERFORM 6680-SET-COMMISSION
 18417         ELSE
 18418             PERFORM 6680-SET-TABLE-CODE.
 18419
 18420
 18421* EXEC CICS ENDBR
 18422*         DATASET (FILE-ID-ERRESC)
 18423*    END-EXEC.
 18424     MOVE 0
 18425       TO DFHEIV11
 18426*    MOVE '&2                    $   #00018211' TO DFHEIV0
 18427     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18428     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18429     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 18430     CALL 'kxdfhei1' USING DFHEIV0,
 18431           FILE-ID-ERRESC,
 18432           DFHEIV11,
 18433           DFHEIV99
 18434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18435
 18436
 18437     GO TO 6700-COMM-EXIT.
 18438
 18439 6680-SET-TABLE-CODE.
 18440     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18441        MOVE ZEROS             TO WS-SUB1
 18442     ELSE
 18443* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18444* TO COMPUTE AH COMMISSION.
 18445        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18446        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18447        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18448        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18449        PERFORM 6680-READ-CTBL-TABLE
 18450        IF WS-CTBL-READ-SW NOT = 'Y'
 18451           MOVE ZEROS          TO WS-SUB1.
 18452
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 336
* EL050.cbl
 18453 6680-READ-CTBL-TABLE.
 18454*
 18455* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18456* TO COMPUTE LIFE COMMISSION
 18457
 18458     IF CTBL-SW = '0540'
 18459        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18460        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18461        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18462
 18463     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18464
 18465     IF CTBL-TABLE-FOUND
 18466        IF CTBL-SW = '0530'
 18467             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18468                                    * PB-I-AH-TERM
 18469             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18470             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18471        ELSE
 18472             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18473             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18474             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18475     ELSE
 18476        IF FIRST-TIME-THROUGH
 18477            GO TO 6680-READ-CTBL-TABLE
 18478        ELSE
 18479            MOVE ZEROS         TO WS-SUB1.
 18480
 18481 6680-SET-COMMISSION.
 18482     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18483           MOVE ZEROS          TO WS-SUB1
 18484       ELSE
 18485           MOVE RESC-COMMISSION-PER (WS-SUB)
 18486                               TO WS-COMMISSION
 18487           IF CTBL-SW = '0530'
 18488               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18489           ELSE
 18490               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18491
 18492 6680-SEARCH-CATEGORY.
 18493     ADD +1                   TO WS-SUB.
 18494     IF WS-SUB > +12
 18495         GO TO 6680-EXIT.
 18496
 18497     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18498          MOVE WS-SUB         TO WS-SUB1
 18499          GO TO 6680-EXIT.
 18500
 18501     GO TO 6680-SEARCH-CATEGORY.
 18502
 18503 6680-EXIT.
 18504     EXIT.
 18505
 18506 6690-END-OF-FILE.
 18507     GO TO 6700-COMM-EXIT.
 18508
 18509 6690-ERRESC-PROBLEM.
 18510      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 337
* EL050.cbl
 18511      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18512
 18513      GO TO 6700-COMM-EXIT.
 18514
 18515 6700-COMM-EXIT.
 18516     EXIT.
 18517
 18518 7000-GET-RATE.
 18519
 18520* EXEC CICS LINK
 18521*        PROGRAM    ('ELRATE')
 18522*        COMMAREA   (CALCULATION-PASS-AREA)
 18523*        LENGTH     (CP-COMM-LENGTH)
 18524*    END-EXEC.
 18525     MOVE 'ELRATE' TO DFHEIV1
 18526*    MOVE '."C                   (   #00018297' TO DFHEIV0
 18527     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18529     MOVE X'2020233030303138323937' TO DFHEIV0(25:11)
 18530     CALL 'kxdfhei1' USING DFHEIV0,
 18531           DFHEIV1,
 18532           CALCULATION-PASS-AREA,
 18533           CP-COMM-LENGTH,
 18534           DFHEIV99,
 18535           DFHEIV99,
 18536           DFHEIV99,
 18537           DFHEIV99
 18538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18539
 18540
 18541 7000-EXIT.
 18542     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 338
* EL050.cbl
 18544 7100-FIND-BENEFIT-IN-STATE.
 18545     MOVE 'N'                    TO BEN-SEARCH-SW.
 18546
 18547     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18548         VARYING SUB3 FROM 1 BY 1 UNTIL
 18549            ((SUB3 GREATER 50) OR
 18550              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18551               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18552
 18553     IF SUB3 NOT = 51
 18554         MOVE 'Y'                TO BEN-SEARCH-SW.
 18555
 18556     GO TO 7199-EXIT.
 18557
 18558 7100-BENEFIT-DUMMY.
 18559
 18560 7100-DUMMY-EXIT.
 18561     EXIT.
 18562
 18563 7199-EXIT.
 18564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 339
* EL050.cbl
 18566 7200-FIND-BENEFIT.
 18567     MOVE 'N'                    TO BEN-SEARCH-SW.
 18568
 18569     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18570         VARYING SUB3 FROM 1 BY 1 UNTIL
 18571            ((SUB3 GREATER 8) OR
 18572            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18573
 18574     IF SUB3 NOT = 9
 18575         MOVE 'Y'                TO BEN-SEARCH-SW.
 18576
 18577     GO TO 7200-EXIT.
 18578
 18579 7200-BENEFIT-DUMMY.
 18580
 18581 7200-DUMMY-EXIT.
 18582     EXIT.
 18583
 18584 7200-EXIT.
 18585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 340
* EL050.cbl
 18587 7250-LOOK-FOR-RESCINDED-CLAIM.
 18588     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18589                                    W-CL-COMP-CD.
 18590     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18591                                    W-CL-CERT-NO.
 18592
 18593
 18594* EXEC CICS HANDLE CONDITION
 18595*        NOTFND  (7250-CONTINUE)
 18596*        ENDFILE (7250-CONTINUE)
 18597*    END-EXEC.
 18598*    MOVE '"$I''                  ! ) #00018355' TO DFHEIV0
 18599     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18601     MOVE X'2920233030303138333535' TO DFHEIV0(25:11)
 18602     CALL 'kxdfhei1' USING DFHEIV0
 18603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18604
 18605
 18606
 18607* EXEC CICS IGNORE CONDITION
 18608*        DUPKEY
 18609*    END-EXEC.
 18610*    MOVE '"*$                   !   #00018360' TO DFHEIV0
 18611     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18613     MOVE X'2020233030303138333630' TO DFHEIV0(25:11)
 18614     CALL 'kxdfhei1' USING DFHEIV0
 18615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18616
 18617
 18618
 18619* EXEC CICS STARTBR
 18620*        DATASET   (CLMS-ID)
 18621*        RIDFLD    (ELMSTR-KEY)
 18622*        GENERIC   EQUAL
 18623*        KEYLENGTH (ELMSTR-LENGTH)
 18624*    END-EXEC.
 18625     MOVE 0
 18626       TO DFHEIV11
 18627*    MOVE '&,   KG    E          &   #00018364' TO DFHEIV0
 18628     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18629     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18630     MOVE X'2020233030303138333634' TO DFHEIV0(25:11)
 18631     CALL 'kxdfhei1' USING DFHEIV0,
 18632           CLMS-ID,
 18633           ELMSTR-KEY,
 18634           ELMSTR-LENGTH,
 18635           DFHEIV11,
 18636           DFHEIV99
 18637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18638
 18639
 18640     MOVE 'Y'                    TO W-BROWSE-SW.
 18641
 18642 7250-NEXT-CLAIM.
 18643
 18644
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 341
* EL050.cbl
 18645* EXEC CICS READNEXT
 18646*        DATASET   (CLMS-ID)
 18647*        RIDFLD    (ELMSTR-KEY)
 18648*        SET       (ADDRESS OF CLAIM-MASTER)
 18649*    END-EXEC.
 18650     MOVE 0
 18651       TO DFHEIV11
 18652*    MOVE '&.S                   )   #00018375' TO DFHEIV0
 18653     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303138333735' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           CLMS-ID,
 18658           DFHEIV20,
 18659           DFHEIV99,
 18660           ELMSTR-KEY,
 18661           DFHEIV99,
 18662           DFHEIV11,
 18663           DFHEIV99,
 18664           DFHEIV99
 18665     SET ADDRESS OF CLAIM-MASTER TO
 18666         DFHEIV20
 18667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18668
 18669
 18670     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18671        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18672         GO TO 7250-CONTINUE
 18673     END-IF.
 18674
 18675     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18676        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18677        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18678        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18679        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18680         GO TO 7250-NEXT-CLAIM
 18681     END-IF.
 18682
 18683     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18684        OR (CL-CLAIM-TYPE = 'I')
 18685        OR (CL-CLAIM-TYPE = 'G')
 18686          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18687              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18688              GO TO 7250-CONTINUE
 18689          END-IF
 18690     END-IF.
 18691
 18692     GO TO 7250-NEXT-CLAIM.
 18693
 18694 7250-CONTINUE.
 18695
 18696     IF W-BROWSE-SW = 'Y'
 18697
 18698* EXEC CICS ENDBR
 18699*            DATASET   (CLMS-ID)
 18700*        END-EXEC
 18701     MOVE 0
 18702       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 342
* EL050.cbl
 18703*    MOVE '&2                    $   #00018408' TO DFHEIV0
 18704     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18705     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18706     MOVE X'2020233030303138343038' TO DFHEIV0(25:11)
 18707     CALL 'kxdfhei1' USING DFHEIV0,
 18708           CLMS-ID,
 18709           DFHEIV11,
 18710           DFHEIV99
 18711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18712         MOVE 'N' TO W-BROWSE-SW
 18713     END-IF.
 18714
 18715 7250-EXIT.
 18716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 343
* EL050.cbl
 18718 7300-CHECK-FOR-OPEN-CLMS.
 18719
 18720*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18721*    MOVE SPACES                 TO CNTL-ACCESS.
 18722*    MOVE '1'                    TO CNTL-REC-TYPE.
 18723*    MOVE +0                     TO CNTL-SEQ-NO.
 18724
 18725*    MOVE '3'                    TO RC-SW-1.
 18726*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18727
 18728*    IF NOT CF-COMPANY-MASTER
 18729*         PERFORM 0099-COMPANY-NOT-FOUND
 18730*         GO TO 7300-EXIT.
 18731
 18732     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18733                                    W-CL-COMP-CD.
 18734     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18735                                    W-CL-CERT-NO.
 18736
 18737
 18738* EXEC CICS HANDLE CONDITION
 18739*        NOTFND  (7300-CONTINUE)
 18740*        ENDFILE (7300-CONTINUE)
 18741*    END-EXEC.
 18742*    MOVE '"$I''                  ! * #00018436' TO DFHEIV0
 18743     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18745     MOVE X'2A20233030303138343336' TO DFHEIV0(25:11)
 18746     CALL 'kxdfhei1' USING DFHEIV0
 18747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18748
 18749
 18750
 18751* EXEC CICS IGNORE CONDITION
 18752*        DUPKEY
 18753*    END-EXEC.
 18754*    MOVE '"*$                   !   #00018441' TO DFHEIV0
 18755     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18757     MOVE X'2020233030303138343431' TO DFHEIV0(25:11)
 18758     CALL 'kxdfhei1' USING DFHEIV0
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762
 18763* EXEC CICS STARTBR
 18764*        DATASET   (CLMS-ID)
 18765*        RIDFLD    (ELMSTR-KEY)
 18766*        GENERIC   EQUAL
 18767*        KEYLENGTH (ELMSTR-LENGTH)
 18768*    END-EXEC.
 18769     MOVE 0
 18770       TO DFHEIV11
 18771*    MOVE '&,   KG    E          &   #00018445' TO DFHEIV0
 18772     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18773     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18774     MOVE X'2020233030303138343435' TO DFHEIV0(25:11)
 18775     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 344
* EL050.cbl
 18776           CLMS-ID,
 18777           ELMSTR-KEY,
 18778           ELMSTR-LENGTH,
 18779           DFHEIV11,
 18780           DFHEIV99
 18781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18782
 18783
 18784     MOVE 'Y'                    TO W-BROWSE-SW.
 18785
 18786 7300-NEXT-CLAIM.
 18787
 18788
 18789* EXEC CICS READNEXT
 18790*        DATASET   (CLMS-ID)
 18791*        RIDFLD    (ELMSTR-KEY)
 18792*        SET       (ADDRESS OF CLAIM-MASTER)
 18793*    END-EXEC.
 18794     MOVE 0
 18795       TO DFHEIV11
 18796*    MOVE '&.S                   )   #00018456' TO DFHEIV0
 18797     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18798     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18799     MOVE X'2020233030303138343536' TO DFHEIV0(25:11)
 18800     CALL 'kxdfhei1' USING DFHEIV0,
 18801           CLMS-ID,
 18802           DFHEIV20,
 18803           DFHEIV99,
 18804           ELMSTR-KEY,
 18805           DFHEIV99,
 18806           DFHEIV11,
 18807           DFHEIV99,
 18808           DFHEIV99
 18809     SET ADDRESS OF CLAIM-MASTER TO
 18810         DFHEIV20
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
 18814     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18815        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18816         GO TO 7300-CONTINUE.
 18817
 18818     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18819        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18820        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18821        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18822        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18823         GO TO 7300-NEXT-CLAIM.
 18824
 18825*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18826     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18827        OR (CL-CLAIM-TYPE = 'I')
 18828        OR (CL-CLAIM-TYPE = 'G')
 18829        IF CLAIM-IS-OPEN
 18830           EVALUATE TRUE
 18831             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18832                 MOVE ER-2884      TO WS-ERROR
 18833             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 345
* EL050.cbl
 18834                 MOVE ER-2887      TO WS-ERROR
 18835             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18836                 MOVE ER-2886      TO WS-ERROR
 18837             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18838                 MOVE ER-2888      TO WS-ERROR
 18839             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18840                 MOVE ER-2885      TO WS-ERROR
 18841             WHEN OTHER
 18842                 MOVE ER-2768      TO WS-ERROR
 18843           END-EVALUATE
 18844           IF PB-C-AH-CANCEL-VOIDED OR
 18845              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18846                NOT AH-COVERAGE-CANCELLED)
 18847               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18848               MOVE ER-2768      TO WS-ERROR
 18849           END-IF
 18850           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18851           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18852              PB-FORCE-CODE NOT EQUAL '8'
 18853               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18854           END-IF
 18855           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18856           GO TO 7300-CONTINUE
 18857        ELSE
 18858           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18859*****THIS IS A RESCISSION OR REFORMATION
 18860              IF (AH-COVERAGE-CANCELLED AND
 18861                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18862                    MOVE ER-2890 TO WS-ERROR
 18863                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18864                    GO TO 7300-CONTINUE
 18865              END-IF
 18866           ELSE
 18867              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18868               AND PB-C-AH-CANCEL-DT > SPACES
 18869                 MOVE ER-2756        TO WS-ERROR
 18870                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18871                 GO TO 7300-CONTINUE
 18872              END-IF
 18873           END-IF
 18874        END-IF
 18875     ELSE
 18876*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18877        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18878           IF CLAIM-IS-OPEN
 18879              MOVE ER-2889      TO WS-ERROR
 18880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18881              GO TO 7300-CONTINUE
 18882           ELSE
 18883              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18884*****THIS IS A RESCISSION OR REFORMATION
 18885                 IF (LF-COVERAGE-CANCELLED AND
 18886                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18887                       MOVE ER-2890 TO WS-ERROR
 18888                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18889                       GO TO 7300-CONTINUE
 18890                 END-IF
 18891              ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 346
* EL050.cbl
 18892                 IF (AH-COVERAGE-CANCELLED AND
 18893                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18894                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18895                    (LF-COVERAGE-CANCELLED AND
 18896                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18897                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18898                       MOVE ER-2965 TO WS-ERROR
 18899                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18900                       GO TO 7300-CONTINUE
 18901                 END-IF
 18902                 IF LF-COVERAGE-CANCELLED
 18903                  IF CL-TOTAL-PAID-AMT > 0
 18904                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18905                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18906                        MOVE ER-2891 TO WS-ERROR
 18907                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18908                        GO TO 7300-CONTINUE
 18909                      END-IF
 18910                    ELSE
 18911                      MOVE ER-2892 TO WS-ERROR
 18912                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18913                      GO TO 7300-CONTINUE
 18914                    END-IF
 18915                  END-IF
 18916                 END-IF
 18917              END-IF
 18918           END-IF
 18919        END-IF
 18920     END-IF
 18921
 18922     GO TO 7300-NEXT-CLAIM.
 18923
 18924 7300-CONTINUE.
 18925
 18926     IF W-BROWSE-SW = 'Y'
 18927
 18928* EXEC CICS ENDBR
 18929*            DATASET   (CLMS-ID)
 18930*        END-EXEC.
 18931     MOVE 0
 18932       TO DFHEIV11
 18933*    MOVE '&2                    $   #00018575' TO DFHEIV0
 18934     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18935     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18936     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 18937     CALL 'kxdfhei1' USING DFHEIV0,
 18938           CLMS-ID,
 18939           DFHEIV11,
 18940           DFHEIV99
 18941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18942
 18943
 18944 7300-EXIT.
 18945     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 347
* EL050.cbl
 18947
 18948 7400-GET-REMAIN-TERM.
 18949
 18950* EXEC CICS LINK
 18951*        PROGRAM    ('ELRTRM')
 18952*        COMMAREA   (CALCULATION-PASS-AREA)
 18953*        LENGTH     (CP-COMM-LENGTH)
 18954*    END-EXEC.
 18955     MOVE 'ELRTRM' TO DFHEIV1
 18956*    MOVE '."C                   (   #00018584' TO DFHEIV0
 18957     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18959     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 18960     CALL 'kxdfhei1' USING DFHEIV0,
 18961           DFHEIV1,
 18962           CALCULATION-PASS-AREA,
 18963           CP-COMM-LENGTH,
 18964           DFHEIV99,
 18965           DFHEIV99,
 18966           DFHEIV99,
 18967           DFHEIV99
 18968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18969
 18970
 18971 7400-EXIT.
 18972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 348
* EL050.cbl
 18974
 18975 7500-GET-REMAIN-AMOUNT.
 18976
 18977* EXEC CICS LINK
 18978*        PROGRAM    ('ELRAMT')
 18979*        COMMAREA   (CALCULATION-PASS-AREA)
 18980*        LENGTH     (CP-COMM-LENGTH)
 18981*    END-EXEC.
 18982     MOVE 'ELRAMT' TO DFHEIV1
 18983*    MOVE '."C                   (   #00018595' TO DFHEIV0
 18984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18986     MOVE X'2020233030303138353935' TO DFHEIV0(25:11)
 18987     CALL 'kxdfhei1' USING DFHEIV0,
 18988           DFHEIV1,
 18989           CALCULATION-PASS-AREA,
 18990           CP-COMM-LENGTH,
 18991           DFHEIV99,
 18992           DFHEIV99,
 18993           DFHEIV99,
 18994           DFHEIV99
 18995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18996
 18997
 18998 7500-EXIT.
 18999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 349
* EL050.cbl
 19001
 19002 7600-GET-REFUND.
 19003
 19004* EXEC CICS LINK
 19005*        PROGRAM    ('ELRFND')
 19006*        COMMAREA   (CALCULATION-PASS-AREA)
 19007*        LENGTH     (CP-COMM-LENGTH)
 19008*    END-EXEC.
 19009     MOVE 'ELRFND' TO DFHEIV1
 19010*    MOVE '."C                   (   #00018606' TO DFHEIV0
 19011     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19012     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19013     MOVE X'2020233030303138363036' TO DFHEIV0(25:11)
 19014     CALL 'kxdfhei1' USING DFHEIV0,
 19015           DFHEIV1,
 19016           CALCULATION-PASS-AREA,
 19017           CP-COMM-LENGTH,
 19018           DFHEIV99,
 19019           DFHEIV99,
 19020           DFHEIV99,
 19021           DFHEIV99
 19022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19023
 19024
 19025 7600-EXIT.
 19026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 350
* EL050.cbl
 19028 7700-CALL-DL1.
 19029
 19030* EXEC CICS LINK
 19031*        PROGRAM    ('DLO001')
 19032*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19033*        LENGTH     (DLO001-COMM-LENGTH)
 19034*    END-EXEC.
 19035     MOVE 'DLO001' TO DFHEIV1
 19036*    MOVE '."C                   (   #00018616' TO DFHEIV0
 19037     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19039     MOVE X'2020233030303138363136' TO DFHEIV0(25:11)
 19040     CALL 'kxdfhei1' USING DFHEIV0,
 19041           DFHEIV1,
 19042           WS-DLO-MASTER-POLICY-FORM,
 19043           DLO001-COMM-LENGTH,
 19044           DFHEIV99,
 19045           DFHEIV99,
 19046           DFHEIV99,
 19047           DFHEIV99
 19048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19049
 19050
 19051 7700-EXIT.
 19052     EXIT.
 19053
 19054 7710-CALL-DL2.
 19055
 19056* EXEC CICS LINK
 19057*        PROGRAM    ('DLO002')
 19058*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19059*        LENGTH     (DLO002-COMM-LENGTH)
 19060*    END-EXEC.
 19061     MOVE 'DLO002' TO DFHEIV1
 19062*    MOVE '."C                   (   #00018626' TO DFHEIV0
 19063     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19064     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19065     MOVE X'2020233030303138363236' TO DFHEIV0(25:11)
 19066     CALL 'kxdfhei1' USING DFHEIV0,
 19067           DFHEIV1,
 19068           WS-DLO-INTERNAL-POLICY-FORM,
 19069           DLO002-COMM-LENGTH,
 19070           DFHEIV99,
 19071           DFHEIV99,
 19072           DFHEIV99,
 19073           DFHEIV99
 19074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19075
 19076
 19077 7710-EXIT.
 19078     EXIT.
 19079
 19080 7720-CALL-DL3.
 19081
 19082* EXEC CICS LINK
 19083*        PROGRAM    ('DLO003')
 19084*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19085*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 351
* EL050.cbl
 19086*    END-EXEC.
 19087     MOVE 'DLO003' TO DFHEIV1
 19088*    MOVE '."C                   (   #00018636' TO DFHEIV0
 19089     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19090     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19091     MOVE X'2020233030303138363336' TO DFHEIV0(25:11)
 19092     CALL 'kxdfhei1' USING DFHEIV0,
 19093           DFHEIV1,
 19094           WS-DLO-VALID-BANK-ID,
 19095           DLO003-COMM-LENGTH,
 19096           DFHEIV99,
 19097           DFHEIV99,
 19098           DFHEIV99,
 19099           DFHEIV99
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19101
 19102
 19103 7720-EXIT.
 19104     EXIT.
 19105
 19106 7730-CALL-DL7.
 19107
 19108* EXEC CICS LINK
 19109*        PROGRAM    ('DLO007')
 19110*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19111*        LENGTH     (DLO007-COMM-LENGTH)
 19112*    END-EXEC.
 19113     MOVE 'DLO007' TO DFHEIV1
 19114*    MOVE '."C                   (   #00018646' TO DFHEIV0
 19115     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19117     MOVE X'2020233030303138363436' TO DFHEIV0(25:11)
 19118     CALL 'kxdfhei1' USING DFHEIV0,
 19119           DFHEIV1,
 19120           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19121           DLO007-COMM-LENGTH,
 19122           DFHEIV99,
 19123           DFHEIV99,
 19124           DFHEIV99,
 19125           DFHEIV99
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19127
 19128
 19129 7730-EXIT.
 19130     EXIT.
 19131
 19132 7740-CALL-DL11.
 19133
 19134* EXEC CICS LINK
 19135*        PROGRAM    ('DLO011')
 19136*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19137*        LENGTH     (DLO011-COMM-LENGTH)
 19138*    END-EXEC.
 19139     MOVE 'DLO011' TO DFHEIV1
 19140*    MOVE '."C                   (   #00018656' TO DFHEIV0
 19141     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19143     MOVE X'2020233030303138363536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 352
* EL050.cbl
 19144     CALL 'kxdfhei1' USING DFHEIV0,
 19145           DFHEIV1,
 19146           WS-DLO-PREM-RATES-BEN-TYPE,
 19147           DLO011-COMM-LENGTH,
 19148           DFHEIV99,
 19149           DFHEIV99,
 19150           DFHEIV99,
 19151           DFHEIV99
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19153
 19154
 19155 7740-EXIT.
 19156     EXIT.
 19157
 19158 7750-CALL-DL17.
 19159
 19160* EXEC CICS LINK
 19161*        PROGRAM    ('DLO017')
 19162*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19163*        LENGTH     (DLO017-COMM-LENGTH)
 19164*    END-EXEC.
 19165     MOVE 'DLO017' TO DFHEIV1
 19166*    MOVE '."C                   (   #00018666' TO DFHEIV0
 19167     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19169     MOVE X'2020233030303138363636' TO DFHEIV0(25:11)
 19170     CALL 'kxdfhei1' USING DFHEIV0,
 19171           DFHEIV1,
 19172           WS-DLO-VALID-RATE-CODE,
 19173           DLO017-COMM-LENGTH,
 19174           DFHEIV99,
 19175           DFHEIV99,
 19176           DFHEIV99,
 19177           DFHEIV99
 19178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19179
 19180
 19181 7750-EXIT.
 19182     EXIT.
 19183
 19184 7755-CALL-DL19.
 19185
 19186* EXEC CICS LINK
 19187*        PROGRAM    ('DLO019')
 19188*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19189*        LENGTH     (DLO019-COMM-LENGTH)
 19190*    END-EXEC.
 19191     MOVE 'DLO019' TO DFHEIV1
 19192*    MOVE '."C                   (   #00018676' TO DFHEIV0
 19193     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19194     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19195     MOVE X'2020233030303138363736' TO DFHEIV0(25:11)
 19196     CALL 'kxdfhei1' USING DFHEIV0,
 19197           DFHEIV1,
 19198           WS-DLO-ORIG-COV-CAT,
 19199           DLO019-COMM-LENGTH,
 19200           DFHEIV99,
 19201           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 353
* EL050.cbl
 19202           DFHEIV99,
 19203           DFHEIV99
 19204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19205
 19206
 19207 7755-EXIT.
 19208     EXIT.
 19209
 19210 7760-CALL-DL21.
 19211
 19212* EXEC CICS LINK
 19213*        PROGRAM    ('DLO021')
 19214*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19215*        LENGTH     (DLO021-COMM-LENGTH)
 19216*    END-EXEC.
 19217     MOVE 'DLO021' TO DFHEIV1
 19218*    MOVE '."C                   (   #00018686' TO DFHEIV0
 19219     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19221     MOVE X'2020233030303138363836' TO DFHEIV0(25:11)
 19222     CALL 'kxdfhei1' USING DFHEIV0,
 19223           DFHEIV1,
 19224           WS-DLO-VALID-LOAN-OFFICER,
 19225           DLO021-COMM-LENGTH,
 19226           DFHEIV99,
 19227           DFHEIV99,
 19228           DFHEIV99,
 19229           DFHEIV99
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19231
 19232
 19233 7760-EXIT.
 19234     EXIT.
 19235
 19236 7770-CALL-DL22.
 19237
 19238* EXEC CICS LINK
 19239*        PROGRAM    ('DLO022')
 19240*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19241*        LENGTH     (DLO022-COMM-LENGTH)
 19242*    END-EXEC.
 19243     MOVE 'DLO022' TO DFHEIV1
 19244*    MOVE '."C                   (   #00018696' TO DFHEIV0
 19245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19247     MOVE X'2020233030303138363936' TO DFHEIV0(25:11)
 19248     CALL 'kxdfhei1' USING DFHEIV0,
 19249           DFHEIV1,
 19250           WS-DLO-VALID-STATE-CODE,
 19251           DLO022-COMM-LENGTH,
 19252           DFHEIV99,
 19253           DFHEIV99,
 19254           DFHEIV99,
 19255           DFHEIV99
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 354
* EL050.cbl
 19260     EXIT.
 19261
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 355
* EL050.cbl
 19263
 19264 7800-REWRITE-CERT.
 19265******************************************************************
 19266*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19267*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19268******************************************************************
 19269
 19270     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19271        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19272        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19273        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19274
 19275* EXEC CICS REWRITE
 19276*                  DATASET (CERT-ID)
 19277*                  FROM    (CERTIFICATE-MASTER)
 19278*              END-EXEC
 19279     MOVE LENGTH OF
 19280      CERTIFICATE-MASTER
 19281       TO DFHEIV11
 19282*    MOVE '&& L                  %   #00018717' TO DFHEIV0
 19283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19285     MOVE X'2020233030303138373137' TO DFHEIV0(25:11)
 19286     CALL 'kxdfhei1' USING DFHEIV0,
 19287           CERT-ID,
 19288           CERTIFICATE-MASTER,
 19289           DFHEIV11,
 19290           DFHEIV99
 19291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19292        GO TO 7800-EXIT.
 19293
 19294       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19295       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19296
 19297 7800-EXIT.
 19298      EXIT.
 19299
 19300 7900-DELETE-CERT.
 19301
 19302* EXEC CICS DELETE
 19303*        DATASET (CERT-ID)
 19304*    END-EXEC.
 19305*    MOVE '&(                    &   #00018730' TO DFHEIV0
 19306     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19307     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19308     MOVE X'2020233030303138373330' TO DFHEIV0(25:11)
 19309     CALL 'kxdfhei1' USING DFHEIV0,
 19310           CERT-ID,
 19311           DFHEIV99,
 19312           DFHEIV99,
 19313           DFHEIV99,
 19314           DFHEIV99
 19315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19316
 19317
 19318 7900-EXIT.
 19319     EXIT.
 19320
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 356
* EL050.cbl
 19321 8000-WRITE-CERT.
 19322
 19323* EXEC CICS HANDLE CONDITION
 19324*        DUPKEY    (8000-FREE-MAIN)
 19325*    END-EXEC.
 19326*    MOVE '"$$                   ! + #00018738' TO DFHEIV0
 19327     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19329     MOVE X'2B20233030303138373338' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0
 19331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19332
 19333
 19334
 19335* EXEC CICS WRITE
 19336*        DATASET     (CERT-ID)
 19337*        FROM        (CERTIFICATE-MASTER)
 19338*        RIDFLD      (ELCERT-KEY)
 19339*    END-EXEC.
 19340     MOVE LENGTH OF
 19341      CERTIFICATE-MASTER
 19342       TO DFHEIV11
 19343*    MOVE '&$ L                  ''   #00018742' TO DFHEIV0
 19344     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19346     MOVE X'2020233030303138373432' TO DFHEIV0(25:11)
 19347     CALL 'kxdfhei1' USING DFHEIV0,
 19348           CERT-ID,
 19349           CERTIFICATE-MASTER,
 19350           DFHEIV11,
 19351           ELCERT-KEY,
 19352           DFHEIV99,
 19353           DFHEIV99
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357 8000-FREE-MAIN.
 19358
 19359 8000-EXIT.
 19360      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 357
* EL050.cbl
 19362
 19363 8100-READ-ERPNDM.
 19364
 19365* EXEC CICS HANDLE CONDITION
 19366*         NOTFND     (8100-NOTFND)
 19367*         ENDFILE    (8100-NOTFND)
 19368*    END-EXEC.
 19369*    MOVE '"$I''                  ! , #00018755' TO DFHEIV0
 19370     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19372     MOVE X'2C20233030303138373535' TO DFHEIV0(25:11)
 19373     CALL 'kxdfhei1' USING DFHEIV0
 19374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19375
 19376
 19377     MOVE SPACES                 TO ERPNDM-FOUND.
 19378     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19379
 19380
 19381* EXEC CICS READ
 19382*         DATASET   (FILE-ERPNDM)
 19383*         RIDFLD    (PM-CONTROL-PRIMARY)
 19384*         INTO      (PENDING-MAILING-DATA)
 19385*    END-EXEC.
 19386     MOVE LENGTH OF
 19387      PENDING-MAILING-DATA
 19388       TO DFHEIV11
 19389*    MOVE '&"IL       E          (   #00018763' TO DFHEIV0
 19390     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19392     MOVE X'2020233030303138373633' TO DFHEIV0(25:11)
 19393     CALL 'kxdfhei1' USING DFHEIV0,
 19394           FILE-ERPNDM,
 19395           PENDING-MAILING-DATA,
 19396           DFHEIV11,
 19397           PM-CONTROL-PRIMARY,
 19398           DFHEIV99,
 19399           DFHEIV99,
 19400           DFHEIV99
 19401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19402
 19403
 19404     GO TO 8100-EXIT.
 19405
 19406 8100-NOTFND.
 19407
 19408     MOVE 'X'                    TO ERPNDM-FOUND.
 19409     MOVE ER-2694                TO WS-ERROR.
 19410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19411     MOVE ER-2883                TO WS-ERROR
 19412     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19413     .
 19414 8100-EXIT.
 19415     EXIT.
 19416
 19417 8110-READ-ERMAIL.
 19418
 19419* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 358
* EL050.cbl
 19420*         NOTFND     (8110-NOTFND)
 19421*         ENDFILE    (8110-NOTFND)
 19422*    END-EXEC.
 19423*    MOVE '"$I''                  ! - #00018783' TO DFHEIV0
 19424     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19426     MOVE X'2D20233030303138373833' TO DFHEIV0(25:11)
 19427     CALL 'kxdfhei1' USING DFHEIV0
 19428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19429
 19430
 19431     MOVE SPACES                 TO ERMAIL-FOUND.
 19432     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19433     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19434     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19435     MOVE PB-SV-STATE            TO MA-STATE.
 19436
 19437
 19438* EXEC CICS READ
 19439*         UPDATE
 19440*         DATASET   (FILE-ERMAIL)
 19441*         RIDFLD    (MA-CONTROL-PRIMARY)
 19442*         INTO      (MAILING-DATA)
 19443*    END-EXEC.
 19444     MOVE LENGTH OF
 19445      MAILING-DATA
 19446       TO DFHEIV11
 19447*    MOVE '&"IL       EU         (   #00018794' TO DFHEIV0
 19448     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19449     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19450     MOVE X'2020233030303138373934' TO DFHEIV0(25:11)
 19451     CALL 'kxdfhei1' USING DFHEIV0,
 19452           FILE-ERMAIL,
 19453           MAILING-DATA,
 19454           DFHEIV11,
 19455           MA-CONTROL-PRIMARY,
 19456           DFHEIV99,
 19457           DFHEIV99,
 19458           DFHEIV99
 19459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19460
 19461
 19462     GO TO 8110-EXIT.
 19463
 19464 8110-NOTFND.
 19465     MOVE 'X'                    TO ERMAIL-FOUND.
 19466
 19467 8110-EXIT.
 19468     EXIT.
 19469
 19470 8120-REWRITE-ERMAIL.
 19471
 19472* EXEC CICS REWRITE
 19473*         DATASET    (FILE-ERMAIL)
 19474*         FROM       (MAILING-DATA)
 19475*    END-EXEC.
 19476     MOVE LENGTH OF
 19477      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 359
* EL050.cbl
 19478       TO DFHEIV11
 19479*    MOVE '&& L                  %   #00018810' TO DFHEIV0
 19480     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19481     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19482     MOVE X'2020233030303138383130' TO DFHEIV0(25:11)
 19483     CALL 'kxdfhei1' USING DFHEIV0,
 19484           FILE-ERMAIL,
 19485           MAILING-DATA,
 19486           DFHEIV11,
 19487           DFHEIV99
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19489
 19490
 19491 8120-EXIT.
 19492     EXIT.
 19493
 19494 8130-WRITE-ERMAIL.
 19495
 19496* EXEC CICS HANDLE CONDITION
 19497*         DUPKEY   (8130-EXIT)
 19498*    END-EXEC.
 19499*    MOVE '"$$                   ! . #00018819' TO DFHEIV0
 19500     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19502     MOVE X'2E20233030303138383139' TO DFHEIV0(25:11)
 19503     CALL 'kxdfhei1' USING DFHEIV0
 19504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19505
 19506
 19507
 19508* EXEC CICS WRITE
 19509*         DATASET     (FILE-ERMAIL)
 19510*         RIDFLD      (MA-CONTROL-PRIMARY)
 19511*         FROM        (MAILING-DATA)
 19512*    END-EXEC.
 19513     MOVE LENGTH OF
 19514      MAILING-DATA
 19515       TO DFHEIV11
 19516*    MOVE '&$ L                  ''   #00018823' TO DFHEIV0
 19517     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19519     MOVE X'2020233030303138383233' TO DFHEIV0(25:11)
 19520     CALL 'kxdfhei1' USING DFHEIV0,
 19521           FILE-ERMAIL,
 19522           MAILING-DATA,
 19523           DFHEIV11,
 19524           MA-CONTROL-PRIMARY,
 19525           DFHEIV99,
 19526           DFHEIV99
 19527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19528
 19529
 19530 8130-EXIT.
 19531     EXIT.
 19532
 19533 8140-UNLOCK-ERMAIL.
 19534
 19535* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 360
* EL050.cbl
 19536*         DATASET   (FILE-ERMAIL)
 19537*    END-EXEC.
 19538*    MOVE '&*                    #   #00018833' TO DFHEIV0
 19539     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19540     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19541     MOVE X'2020233030303138383333' TO DFHEIV0(25:11)
 19542     CALL 'kxdfhei1' USING DFHEIV0,
 19543           FILE-ERMAIL,
 19544           DFHEIV99
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19546
 19547
 19548 8140-EXIT.
 19549     EXIT.
 19550
 19551 8180-UPDATE-VIN-NUMBER.
 19552
 19553* EXEC CICS HANDLE CONDITION
 19554*        NOTFND   (8180-NOTFND)
 19555*    END-EXEC.
 19556*    MOVE '"$I                   ! / #00018841' TO DFHEIV0
 19557     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19558     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19559     MOVE X'2F20233030303138383431' TO DFHEIV0(25:11)
 19560     CALL 'kxdfhei1' USING DFHEIV0
 19561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19562
 19563
 19564     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19565     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19566
 19567
 19568* EXEC CICS READ
 19569*        UPDATE
 19570*        DATASET  (CRTT-ID)
 19571*        RIDFLD   (WS-ELCRTT-KEY)
 19572*        INTO     (CERTIFICATE-TRAILERS)
 19573*    END-EXEC.
 19574     MOVE LENGTH OF
 19575      CERTIFICATE-TRAILERS
 19576       TO DFHEIV11
 19577*    MOVE '&"IL       EU         (   #00018848' TO DFHEIV0
 19578     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19579     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19580     MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
 19581     CALL 'kxdfhei1' USING DFHEIV0,
 19582           CRTT-ID,
 19583           CERTIFICATE-TRAILERS,
 19584           DFHEIV11,
 19585           WS-ELCRTT-KEY,
 19586           DFHEIV99,
 19587           DFHEIV99,
 19588           DFHEIV99
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19590
 19591
 19592     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19593         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 361
* EL050.cbl
 19594
 19595* EXEC CICS REWRITE
 19596*           DATASET  (CRTT-ID)
 19597*           FROM     (CERTIFICATE-TRAILERS)
 19598*        END-EXEC
 19599     MOVE LENGTH OF
 19600      CERTIFICATE-TRAILERS
 19601       TO DFHEIV11
 19602*    MOVE '&& L                  %   #00018857' TO DFHEIV0
 19603     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19605     MOVE X'2020233030303138383537' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0,
 19607           CRTT-ID,
 19608           CERTIFICATE-TRAILERS,
 19609           DFHEIV11,
 19610           DFHEIV99
 19611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19612     ELSE
 19613
 19614* EXEC CICS UNLOCK
 19615*          DATASET  (CRTT-ID)
 19616*       END-EXEC
 19617*    MOVE '&*                    #   #00018862' TO DFHEIV0
 19618     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19620     MOVE X'2020233030303138383632' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0,
 19622           CRTT-ID,
 19623           DFHEIV99
 19624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19625     END-IF.
 19626
 19627     GO TO 8180-EXIT.
 19628
 19629 8180-NOTFND.
 19630
 19631     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19632     MOVE 'CS'         TO CS-RECORD-ID.
 19633     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19634     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19635     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19636     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19637
 19638* EXEC CICS WRITE
 19639*       DATASET  (CRTT-ID)
 19640*       RIDFLD   (WS-ELCRTT-KEY)
 19641*       FROM     (CERTIFICATE-TRAILERS)
 19642*    END-EXEC.
 19643     MOVE LENGTH OF
 19644      CERTIFICATE-TRAILERS
 19645       TO DFHEIV11
 19646*    MOVE '&$ L                  ''   #00018877' TO DFHEIV0
 19647     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19648     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19649     MOVE X'2020233030303138383737' TO DFHEIV0(25:11)
 19650     CALL 'kxdfhei1' USING DFHEIV0,
 19651           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 362
* EL050.cbl
 19652           CERTIFICATE-TRAILERS,
 19653           DFHEIV11,
 19654           WS-ELCRTT-KEY,
 19655           DFHEIV99,
 19656           DFHEIV99
 19657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19658
 19659
 19660 8180-EXIT.
 19661     EXIT.
 19662
 19663 8190-UPDATE-REFUND-CLAIM-FLAG.
 19664
 19665* EXEC CICS HANDLE CONDITION
 19666*        NOTFND   (8190-NOTFND)
 19667*    END-EXEC.
 19668*    MOVE '"$I                   ! 0 #00018887' TO DFHEIV0
 19669     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19671     MOVE X'3020233030303138383837' TO DFHEIV0(25:11)
 19672     CALL 'kxdfhei1' USING DFHEIV0
 19673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19674
 19675
 19676     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19677     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19678
 19679
 19680* EXEC CICS READ
 19681*        UPDATE
 19682*        DATASET  (CRTT-ID)
 19683*        RIDFLD   (WS-ELCRTT-KEY)
 19684*        INTO     (CERTIFICATE-TRAILERS)
 19685*    END-EXEC.
 19686     MOVE LENGTH OF
 19687      CERTIFICATE-TRAILERS
 19688       TO DFHEIV11
 19689*    MOVE '&"IL       EU         (   #00018894' TO DFHEIV0
 19690     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19691     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19692     MOVE X'2020233030303138383934' TO DFHEIV0(25:11)
 19693     CALL 'kxdfhei1' USING DFHEIV0,
 19694           CRTT-ID,
 19695           CERTIFICATE-TRAILERS,
 19696           DFHEIV11,
 19697           WS-ELCRTT-KEY,
 19698           DFHEIV99,
 19699           DFHEIV99,
 19700           DFHEIV99
 19701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19702
 19703
 19704     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19705
 19706* EXEC CICS REWRITE
 19707*       DATASET  (CRTT-ID)
 19708*       FROM     (CERTIFICATE-TRAILERS)
 19709*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 363
* EL050.cbl
 19710     MOVE LENGTH OF
 19711      CERTIFICATE-TRAILERS
 19712       TO DFHEIV11
 19713*    MOVE '&& L                  %   #00018902' TO DFHEIV0
 19714     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19715     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19716     MOVE X'2020233030303138393032' TO DFHEIV0(25:11)
 19717     CALL 'kxdfhei1' USING DFHEIV0,
 19718           CRTT-ID,
 19719           CERTIFICATE-TRAILERS,
 19720           DFHEIV11,
 19721           DFHEIV99
 19722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19723
 19724
 19725     GO TO 8190-EXIT.
 19726
 19727 8190-NOTFND.
 19728
 19729     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19730     MOVE 'CS'         TO CS-RECORD-ID.
 19731     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19732     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19733     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19734     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19735
 19736* EXEC CICS WRITE
 19737*       DATASET  (CRTT-ID)
 19738*       RIDFLD   (WS-ELCRTT-KEY)
 19739*       FROM     (CERTIFICATE-TRAILERS)
 19740*    END-EXEC.
 19741     MOVE LENGTH OF
 19742      CERTIFICATE-TRAILERS
 19743       TO DFHEIV11
 19744*    MOVE '&$ L                  ''   #00018917' TO DFHEIV0
 19745     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19747     MOVE X'2020233030303138393137' TO DFHEIV0(25:11)
 19748     CALL 'kxdfhei1' USING DFHEIV0,
 19749           CRTT-ID,
 19750           CERTIFICATE-TRAILERS,
 19751           DFHEIV11,
 19752           WS-ELCRTT-KEY,
 19753           DFHEIV99,
 19754           DFHEIV99
 19755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19756
 19757
 19758 8190-EXIT.
 19759     EXIT.
 19760
 19761 8195-UPDATE-AGE-FLAGS.
 19762
 19763* EXEC CICS HANDLE CONDITION
 19764*        NOTFND   (8195-NOTFND)
 19765*    END-EXEC.
 19766*    MOVE '"$I                   ! 1 #00018927' TO DFHEIV0
 19767     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 364
* EL050.cbl
 19768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19769     MOVE X'3120233030303138393237' TO DFHEIV0(25:11)
 19770     CALL 'kxdfhei1' USING DFHEIV0
 19771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19772
 19773
 19774     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19775     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19776
 19777
 19778* EXEC CICS READ
 19779*        UPDATE
 19780*        DATASET  (CRTT-ID)
 19781*        RIDFLD   (WS-ELCRTT-KEY)
 19782*        INTO     (CERTIFICATE-TRAILERS)
 19783*    END-EXEC.
 19784     MOVE LENGTH OF
 19785      CERTIFICATE-TRAILERS
 19786       TO DFHEIV11
 19787*    MOVE '&"IL       EU         (   #00018934' TO DFHEIV0
 19788     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           CRTT-ID,
 19793           CERTIFICATE-TRAILERS,
 19794           DFHEIV11,
 19795           WS-ELCRTT-KEY,
 19796           DFHEIV99,
 19797           DFHEIV99,
 19798           DFHEIV99
 19799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19800
 19801
 19802     IF WS-INS-AGE-SET = 'Y'
 19803        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19804     END-IF
 19805     IF WS-JNT-AGE-SET = 'Y'
 19806        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19807     END-IF
 19808
 19809
 19810* EXEC CICS REWRITE
 19811*       DATASET  (CRTT-ID)
 19812*       FROM     (CERTIFICATE-TRAILERS)
 19813*    END-EXEC.
 19814     MOVE LENGTH OF
 19815      CERTIFICATE-TRAILERS
 19816       TO DFHEIV11
 19817*    MOVE '&& L                  %   #00018948' TO DFHEIV0
 19818     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19819     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19820     MOVE X'2020233030303138393438' TO DFHEIV0(25:11)
 19821     CALL 'kxdfhei1' USING DFHEIV0,
 19822           CRTT-ID,
 19823           CERTIFICATE-TRAILERS,
 19824           DFHEIV11,
 19825           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 365
* EL050.cbl
 19826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19827
 19828
 19829     GO TO 8195-EXIT.
 19830
 19831 8195-NOTFND.
 19832
 19833     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19834     MOVE 'CS'         TO CS-RECORD-ID.
 19835     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19836     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19837     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19838     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19839     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19840
 19841* EXEC CICS WRITE
 19842*       DATASET  (CRTT-ID)
 19843*       RIDFLD   (WS-ELCRTT-KEY)
 19844*       FROM     (CERTIFICATE-TRAILERS)
 19845*    END-EXEC.
 19846     MOVE LENGTH OF
 19847      CERTIFICATE-TRAILERS
 19848       TO DFHEIV11
 19849*    MOVE '&$ L                  ''   #00018964' TO DFHEIV0
 19850     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19852     MOVE X'2020233030303138393634' TO DFHEIV0(25:11)
 19853     CALL 'kxdfhei1' USING DFHEIV0,
 19854           CRTT-ID,
 19855           CERTIFICATE-TRAILERS,
 19856           DFHEIV11,
 19857           WS-ELCRTT-KEY,
 19858           DFHEIV99,
 19859           DFHEIV99
 19860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19861
 19862
 19863 8195-EXIT.
 19864     EXIT.
 19865
 19866 8200-READ-REIN-TABLE.
 19867
 19868* EXEC CICS HANDLE CONDITION
 19869*         NOTFND   (8200-NOTFND)
 19870*    END-EXEC.
 19871*    MOVE '"$I                   ! 2 #00018974' TO DFHEIV0
 19872     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19874     MOVE X'3220233030303138393734' TO DFHEIV0(25:11)
 19875     CALL 'kxdfhei1' USING DFHEIV0
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19877
 19878
 19879
 19880* EXEC CICS READ
 19881*        DATASET     (REIN-ID)
 19882*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19883*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 366
* EL050.cbl
 19884*    END-EXEC.
 19885*    MOVE '&"S        E          (   #00018978' TO DFHEIV0
 19886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19888     MOVE X'2020233030303138393738' TO DFHEIV0(25:11)
 19889     CALL 'kxdfhei1' USING DFHEIV0,
 19890           REIN-ID,
 19891           DFHEIV20,
 19892           DFHEIV99,
 19893           ERREIN-KEY,
 19894           DFHEIV99,
 19895           DFHEIV99,
 19896           DFHEIV99
 19897     SET ADDRESS OF REINSURANCE-RECORD TO
 19898         DFHEIV20
 19899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19900
 19901
 19902     GO TO 8200-EXIT.
 19903
 19904 8200-NOTFND.
 19905     MOVE 'N'             TO WS-REIN-READ-SW.
 19906
 19907 8200-EXIT.
 19908      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 367
* EL050.cbl
 19910
 19911 8300-READ-CTBL-TABLE.
 19912
 19913* EXEC CICS HANDLE CONDITION
 19914*        NOTFND    (8300-NOTFND)
 19915*        DISABLED  (8300-ERRESS-PROBLEM)
 19916*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19917*        ENDFILE   (8300-NOTFND)
 19918*    END-EXEC.
 19919*    MOVE '"$IcJ''                ! 3 #00018994' TO DFHEIV0
 19920     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19921     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19922     MOVE X'3320233030303138393934' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0
 19924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19925
 19926
 19927
 19928* EXEC CICS READ
 19929*        DATASET     (CTBL-ID)
 19930*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19931*        RIDFLD      (ERCTBL-KEY)
 19932*    END-EXEC.
 19933*    MOVE '&"S        E          (   #00019001' TO DFHEIV0
 19934     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19936     MOVE X'2020233030303139303031' TO DFHEIV0(25:11)
 19937     CALL 'kxdfhei1' USING DFHEIV0,
 19938           CTBL-ID,
 19939           DFHEIV20,
 19940           DFHEIV99,
 19941           ERCTBL-KEY,
 19942           DFHEIV99,
 19943           DFHEIV99,
 19944           DFHEIV99
 19945     SET ADDRESS OF COMM-TABLE-RECORD TO
 19946         DFHEIV20
 19947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19948
 19949
 19950     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19951
 19952     GO TO 8300-EXIT.
 19953
 19954 8300-NOTFND.
 19955
 19956     IF CTBL-SW = '0530'
 19957         MOVE 'AA'                     TO WS-AH-COMP-CD
 19958         MOVE '0550'                   TO CTBL-SW
 19959         MOVE '1'                      TO WS-CTBL-READ-SW
 19960         GO TO 8300-EXIT.
 19961
 19962     IF CTBL-SW = '0540'
 19963         MOVE 'AA'                     TO WS-LF-COMP-CD
 19964         MOVE '0550'                   TO CTBL-SW
 19965         MOVE '1'                      TO WS-CTBL-READ-SW
 19966         GO TO 8300-EXIT.
 19967
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 368
* EL050.cbl
 19968     IF CTBL-SW = '0550'
 19969         MOVE '2'                      TO WS-CTBL-READ-SW
 19970         GO TO 8300-EXIT.
 19971
 19972     GO TO 8300-EXIT.
 19973
 19974 8300-ERRESS-PROBLEM.
 19975
 19976      MOVE ER-8050              TO WS-ERROR.
 19977      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19978
 19979     GO TO 8300-EXIT.
 19980
 19981 8300-EXIT.
 19982      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 369
* EL050.cbl
 19984
 19985
 19986 8400-GETMAIN-ERFORM.
 19987
 19988
 19989* EXEC CICS   GETMAIN
 19990*        LENGTH  (500)
 19991*        SET     (ADDRESS OF FORM-MASTER)
 19992*    END-EXEC.
 19993     MOVE 500
 19994       TO DFHEIV11
 19995*    MOVE '," L                  $   #00019045' TO DFHEIV0
 19996     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19998     MOVE X'2020233030303139303435' TO DFHEIV0(25:11)
 19999     CALL 'kxdfhei1' USING DFHEIV0,
 20000           DFHEIV20,
 20001           DFHEIV11,
 20002           DFHEIV99
 20003     SET ADDRESS OF FORM-MASTER TO
 20004         DFHEIV20
 20005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20006
 20007
 20008     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20009
 20010 8400-EXIT.
 20011      EXIT.
 20012
 20013 8450-READ-FORM-MASTER.
 20014
 20015
 20016* EXEC CICS  HANDLE CONDITION
 20017*        NOTFND   (8450-FORM-NOT-FOUND)
 20018*        ENDFILE  (8450-FORM-NOT-FOUND)
 20019*    END-EXEC.
 20020*    MOVE '"$I''                  ! 4 #00019057' TO DFHEIV0
 20021     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20023     MOVE X'3420233030303139303537' TO DFHEIV0(25:11)
 20024     CALL 'kxdfhei1' USING DFHEIV0
 20025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20026
 20027
 20028
 20029* EXEC CICS   READ
 20030*        DATASET   (FORM-ID)
 20031*        RIDFLD    (ERFORM-KEY)
 20032*        INTO      (FORM-MASTER)
 20033*        GTEQ
 20034*    END-EXEC.
 20035     MOVE LENGTH OF
 20036      FORM-MASTER
 20037       TO DFHEIV11
 20038*    MOVE '&"IL       G          (   #00019062' TO DFHEIV0
 20039     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303139303632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 370
* EL050.cbl
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           FORM-ID,
 20044           FORM-MASTER,
 20045           DFHEIV11,
 20046           ERFORM-KEY,
 20047           DFHEIV99,
 20048           DFHEIV99,
 20049           DFHEIV99
 20050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20051
 20052
 20053     MOVE  'Y'           TO  FORM-MASTER-SW.
 20054
 20055     GO TO  8450-EXIT.
 20056
 20057 8450-FORM-NOT-FOUND.
 20058
 20059     MOVE  'N'           TO  FORM-MASTER-SW.
 20060
 20061 8450-EXIT.
 20062      EXIT.
 20063
 20064 8500-DATE-CONVERT.
 20065
 20066* EXEC CICS LINK
 20067*        PROGRAM    ('ELDATCV')
 20068*        COMMAREA   (DATE-CONVERSION-DATA)
 20069*        LENGTH     (DC-COMM-LENGTH)
 20070*    END-EXEC.
 20071     MOVE 'ELDATCV' TO DFHEIV1
 20072*    MOVE '."C                   (   #00019081' TO DFHEIV0
 20073     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20075     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
 20076     CALL 'kxdfhei1' USING DFHEIV0,
 20077           DFHEIV1,
 20078           DATE-CONVERSION-DATA,
 20079           DC-COMM-LENGTH,
 20080           DFHEIV99,
 20081           DFHEIV99,
 20082           DFHEIV99,
 20083           DFHEIV99
 20084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20085
 20086
 20087 8500-EXIT.
 20088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 371
* EL050.cbl
 20090
 20091 8555-RELOAD-CONTROL-FILE.
 20092     CONTINUE.
 20093
 20094 8555-EXIT.
 20095     EXIT.
 20096
 20097 8557-GETMAIN-ERPLAN.
 20098
 20099
 20100* EXEC CICS GETMAIN
 20101*        LENGTH    (840)
 20102*        SET       (ADDRESS OF PLAN-RECORDS)
 20103*    END-EXEC.
 20104     MOVE 840
 20105       TO DFHEIV11
 20106*    MOVE '," L                  $   #00019099' TO DFHEIV0
 20107     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20108     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20109     MOVE X'2020233030303139303939' TO DFHEIV0(25:11)
 20110     CALL 'kxdfhei1' USING DFHEIV0,
 20111           DFHEIV20,
 20112           DFHEIV11,
 20113           DFHEIV99
 20114     SET ADDRESS OF PLAN-RECORDS TO
 20115         DFHEIV20
 20116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20117
 20118
 20119     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20120
 20121 8557-EXIT.
 20122     EXIT.
 20123
 20124 8560-GETMAIN.
 20125
 20126* EXEC CICS GETMAIN
 20127*        LENGTH    (2000)
 20128*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20129*    END-EXEC.
 20130     MOVE 2000
 20131       TO DFHEIV11
 20132*    MOVE '," L                  $   #00019110' TO DFHEIV0
 20133     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20134     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20135     MOVE X'2020233030303139313130' TO DFHEIV0(25:11)
 20136     CALL 'kxdfhei1' USING DFHEIV0,
 20137           DFHEIV20,
 20138           DFHEIV11,
 20139           DFHEIV99
 20140     SET ADDRESS OF ACCOUNT-MASTER TO
 20141         DFHEIV20
 20142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20143
 20144
 20145     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20146
 20147 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 372
* EL050.cbl
 20148     EXIT.
 20149
 20150 8570-START-ACCOUNT-MASTER.
 20151
 20152* EXEC CICS HANDLE CONDITION
 20153*        NOTFND    (0199-ACCT-NOT-FOUND)
 20154*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20155*    END-EXEC.
 20156*    MOVE '"$I''                  ! 5 #00019121' TO DFHEIV0
 20157     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20159     MOVE X'3520233030303139313231' TO DFHEIV0(25:11)
 20160     CALL 'kxdfhei1' USING DFHEIV0
 20161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20162
 20163
 20164
 20165* EXEC CICS STARTBR
 20166*        DATASET    (ACCT-ID)
 20167*        RIDFLD     (ERACCT-KEY)
 20168*        GTEQ
 20169*    END-EXEC.
 20170     MOVE 0
 20171       TO DFHEIV11
 20172*    MOVE '&,         G          &   #00019126' TO DFHEIV0
 20173     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20175     MOVE X'2020233030303139313236' TO DFHEIV0(25:11)
 20176     CALL 'kxdfhei1' USING DFHEIV0,
 20177           ACCT-ID,
 20178           ERACCT-KEY,
 20179           DFHEIV99,
 20180           DFHEIV11,
 20181           DFHEIV99
 20182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20183
 20184
 20185 8570-EXIT.
 20186     EXIT.
 20187
 20188 8580-READ-ACCOUNT-MASTER.
 20189
 20190* EXEC CICS HANDLE CONDITION
 20191*        NOTFND    (0199-ACCT-NOT-FOUND)
 20192*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20193*    END-EXEC.
 20194*    MOVE '"$I''                  ! 6 #00019136' TO DFHEIV0
 20195     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20197     MOVE X'3620233030303139313336' TO DFHEIV0(25:11)
 20198     CALL 'kxdfhei1' USING DFHEIV0
 20199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20200
 20201
 20202
 20203* EXEC CICS READNEXT
 20204*        DATASET     (ACCT-ID)
 20205*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 373
* EL050.cbl
 20206*        RIDFLD      (ERACCT-KEY)
 20207*    END-EXEC.
 20208     MOVE LENGTH OF
 20209      ACCOUNT-MASTER
 20210       TO DFHEIV12
 20211     MOVE 0
 20212       TO DFHEIV11
 20213*    MOVE '&.IL                  )   #00019141' TO DFHEIV0
 20214     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20215     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20216     MOVE X'2020233030303139313431' TO DFHEIV0(25:11)
 20217     CALL 'kxdfhei1' USING DFHEIV0,
 20218           ACCT-ID,
 20219           ACCOUNT-MASTER,
 20220           DFHEIV12,
 20221           ERACCT-KEY,
 20222           DFHEIV99,
 20223           DFHEIV11,
 20224           DFHEIV99,
 20225           DFHEIV99
 20226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20227
 20228
 20229 8580-EXIT.
 20230     EXIT.
 20231
 20232 8582-READ-COMPENSATION-MASTER.
 20233
 20234* EXEC CICS HANDLE CONDITION
 20235*        NOTFND    (8582-COMP-NOT-FOUND)
 20236*        ENDFILE   (8582-COMP-NOT-FOUND)
 20237*    END-EXEC.
 20238*    MOVE '"$I''                  ! 7 #00019151' TO DFHEIV0
 20239     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20240     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20241     MOVE X'3720233030303139313531' TO DFHEIV0(25:11)
 20242     CALL 'kxdfhei1' USING DFHEIV0
 20243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20244
 20245
 20246
 20247* EXEC CICS READ
 20248*        DATASET     (COMP-ID)
 20249*        INTO        (COMPENSATION-MASTER)
 20250*        RIDFLD      (ERCOMP-KEY)
 20251*    END-EXEC.
 20252     MOVE LENGTH OF
 20253      COMPENSATION-MASTER
 20254       TO DFHEIV11
 20255*    MOVE '&"IL       E          (   #00019156' TO DFHEIV0
 20256     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20258     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 20259     CALL 'kxdfhei1' USING DFHEIV0,
 20260           COMP-ID,
 20261           COMPENSATION-MASTER,
 20262           DFHEIV11,
 20263           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 374
* EL050.cbl
 20264           DFHEIV99,
 20265           DFHEIV99,
 20266           DFHEIV99
 20267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20268
 20269
 20270     MOVE 'Y'                    TO COMP-MASTER-SW
 20271
 20272     GO TO 8582-EXIT
 20273     .
 20274 8582-COMP-NOT-FOUND.
 20275
 20276     MOVE 'N'                    TO COMP-MASTER-SW.
 20277
 20278 8582-EXIT.
 20279     EXIT.
 20280
 20281 8583-READ-ERAGTC.
 20282
 20283* EXEC CICS HANDLE CONDITION
 20284*        NOTFND    (8583-AGTC-NOT-FOUND)
 20285*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20286*    END-EXEC.
 20287*    MOVE '"$I''                  ! 8 #00019174' TO DFHEIV0
 20288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20290     MOVE X'3820233030303139313734' TO DFHEIV0(25:11)
 20291     CALL 'kxdfhei1' USING DFHEIV0
 20292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20293
 20294
 20295
 20296* EXEC CICS STARTBR
 20297*        DATASET    (AGTC-ID)
 20298*        RIDFLD     (ERAGTC-KEY)
 20299*        GTEQ
 20300*    END-EXEC.
 20301     MOVE 0
 20302       TO DFHEIV11
 20303*    MOVE '&,         G          &   #00019179' TO DFHEIV0
 20304     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           AGTC-ID,
 20309           ERAGTC-KEY,
 20310           DFHEIV99,
 20311           DFHEIV11,
 20312           DFHEIV99
 20313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20314
 20315
 20316 8583-READ-ERAGTC-NEXT.
 20317
 20318* EXEC CICS READNEXT
 20319*        DATASET     (AGTC-ID)
 20320*        INTO        (AGENT-COMMISSIONS)
 20321*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 375
* EL050.cbl
 20322*    END-EXEC.
 20323     MOVE LENGTH OF
 20324      AGENT-COMMISSIONS
 20325       TO DFHEIV12
 20326     MOVE 0
 20327       TO DFHEIV11
 20328*    MOVE '&.IL                  )   #00019186' TO DFHEIV0
 20329     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20330     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20331     MOVE X'2020233030303139313836' TO DFHEIV0(25:11)
 20332     CALL 'kxdfhei1' USING DFHEIV0,
 20333           AGTC-ID,
 20334           AGENT-COMMISSIONS,
 20335           DFHEIV12,
 20336           ERAGTC-KEY,
 20337           DFHEIV99,
 20338           DFHEIV11,
 20339           DFHEIV99,
 20340           DFHEIV99
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20345
 20346     GO TO 8583-EXIT
 20347     .
 20348 8583-AGTC-NOT-FOUND.
 20349
 20350     MOVE 'N'                    TO AGTC-MASTER-SW.
 20351
 20352 8583-EXIT.
 20353     EXIT.
 20354
 20355 8584-READ-BANK-CROSS-REF.
 20356
 20357* EXEC CICS HANDLE CONDITION
 20358*        NOTFND    (8584-BXRF-NOT-FOUND)
 20359*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20360*    END-EXEC.
 20361*    MOVE '"$I''                  ! 9 #00019204' TO DFHEIV0
 20362     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20364     MOVE X'3920233030303139323034' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369
 20370* EXEC CICS READ
 20371*        DATASET     (BXRF-ID)
 20372*        INTO        (BANK-CROSS-REFERENCE)
 20373*        RIDFLD      (ERBXRF-KEY)
 20374*        LENGTH      (BXRF-REC-LENGTH)
 20375*    END-EXEC.
 20376*    MOVE '&"IL       E          (   #00019209' TO DFHEIV0
 20377     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20379     MOVE X'2020233030303139323039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 376
* EL050.cbl
 20380     CALL 'kxdfhei1' USING DFHEIV0,
 20381           BXRF-ID,
 20382           BANK-CROSS-REFERENCE,
 20383           BXRF-REC-LENGTH,
 20384           ERBXRF-KEY,
 20385           DFHEIV99,
 20386           DFHEIV99,
 20387           DFHEIV99
 20388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20389
 20390
 20391     MOVE 'Y'                    TO BXRF-MASTER-SW
 20392
 20393     GO TO 8584-EXIT
 20394     .
 20395 8584-BXRF-NOT-FOUND.
 20396
 20397     MOVE 'N'                    TO BXRF-MASTER-SW.
 20398
 20399 8584-EXIT.
 20400     EXIT.
 20401
 20402 8585-READ-PLAN-MASTER.
 20403
 20404
 20405* EXEC CICS HANDLE CONDITION
 20406*        NOTFND    (8585-PLAN-NOT-FOUND)
 20407*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20408*    END-EXEC.
 20409*    MOVE '"$I''                  ! : #00019229' TO DFHEIV0
 20410     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20412     MOVE X'3A20233030303139323239' TO DFHEIV0(25:11)
 20413     CALL 'kxdfhei1' USING DFHEIV0
 20414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20415
 20416
 20417
 20418* EXEC CICS READ
 20419*        DATASET     (PLAN-ID)
 20420*        INTO        (PLAN-MASTER)
 20421*        RIDFLD      (ERPLAN-KEY)
 20422*    END-EXEC.
 20423     MOVE LENGTH OF
 20424      PLAN-MASTER
 20425       TO DFHEIV11
 20426*    MOVE '&"IL       E          (   #00019234' TO DFHEIV0
 20427     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20428     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20429     MOVE X'2020233030303139323334' TO DFHEIV0(25:11)
 20430     CALL 'kxdfhei1' USING DFHEIV0,
 20431           PLAN-ID,
 20432           PLAN-MASTER,
 20433           DFHEIV11,
 20434           ERPLAN-KEY,
 20435           DFHEIV99,
 20436           DFHEIV99,
 20437           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 377
* EL050.cbl
 20438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20439
 20440
 20441     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20442
 20443     GO TO 8585-EXIT.
 20444
 20445 8585-PLAN-NOT-FOUND.
 20446
 20447     MOVE 'N'                    TO PLAN-MASTER-SW.
 20448
 20449 8585-EXIT.
 20450     EXIT.
 20451
 20452 8586-READ-LOAN-OFFICER.
 20453
 20454* EXEC CICS READ
 20455*        DATASET     (LOFC-ID)
 20456*        INTO        (LOAN-OFFICER-MASTER)
 20457*        RIDFLD      (ERLOFC-KEY)
 20458*        RESP        (WS-RESPONSE)
 20459*    END-EXEC
 20460     MOVE LENGTH OF
 20461      LOAN-OFFICER-MASTER
 20462       TO DFHEIV11
 20463*    MOVE '&"IL       E          (  N#00019252' TO DFHEIV0
 20464     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20466     MOVE X'204E233030303139323532' TO DFHEIV0(25:11)
 20467     CALL 'kxdfhei1' USING DFHEIV0,
 20468           LOFC-ID,
 20469           LOAN-OFFICER-MASTER,
 20470           DFHEIV11,
 20471           ERLOFC-KEY,
 20472           DFHEIV99,
 20473           DFHEIV99,
 20474           DFHEIV99
 20475     MOVE EIBRESP  TO WS-RESPONSE
 20476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20477
 20478     IF WS-RESP-NORMAL
 20479        MOVE 'Y'                 TO LOFC-MASTER-SW
 20480     ELSE
 20481        MOVE 'N'                 TO LOFC-MASTER-SW
 20482     END-IF
 20483     .
 20484 8586-EXIT.
 20485     EXIT.
 20486 8587-START-ERPDEF.
 20487
 20488* EXEC CICS STARTBR
 20489*       DATASET   (PDEF-ID)
 20490*       RIDFLD    (ERPDEF-KEY)
 20491*       GTEQ
 20492*       RESP      (WS-RESPONSE)
 20493*    END-EXEC
 20494     MOVE 0
 20495       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 378
* EL050.cbl
 20496*    MOVE '&,         G          &  N#00019268' TO DFHEIV0
 20497     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20499     MOVE X'204E233030303139323638' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0,
 20501           PDEF-ID,
 20502           ERPDEF-KEY,
 20503           DFHEIV99,
 20504           DFHEIV11,
 20505           DFHEIV99
 20506     MOVE EIBRESP  TO WS-RESPONSE
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20508     IF WS-RESP-NORMAL
 20509        MOVE 'Y'                 TO PDEF-MASTER-SW
 20510     ELSE
 20511        MOVE 'N'                 TO PDEF-MASTER-SW
 20512     END-IF
 20513     .
 20514 8587-EXIT.
 20515     EXIT.
 20516 8588-READ-ERPDEF.
 20517
 20518* EXEC CICS READNEXT
 20519*       DATASET   (PDEF-ID)
 20520*       RIDFLD    (ERPDEF-KEY)
 20521*       INTO      (PRODUCT-MASTER)
 20522*       RESP      (WS-RESPONSE)
 20523*    END-EXEC
 20524     MOVE LENGTH OF
 20525      PRODUCT-MASTER
 20526       TO DFHEIV12
 20527     MOVE 0
 20528       TO DFHEIV11
 20529*    MOVE '&.IL                  )  N#00019283' TO DFHEIV0
 20530     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20532     MOVE X'204E233030303139323833' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0,
 20534           PDEF-ID,
 20535           PRODUCT-MASTER,
 20536           DFHEIV12,
 20537           ERPDEF-KEY,
 20538           DFHEIV99,
 20539           DFHEIV11,
 20540           DFHEIV99,
 20541           DFHEIV99
 20542     MOVE EIBRESP  TO WS-RESPONSE
 20543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20544     IF WS-RESP-NORMAL
 20545        MOVE 'Y'                 TO PDEF-MASTER-SW
 20546     ELSE
 20547        MOVE 'N'                 TO PDEF-MASTER-SW
 20548     END-IF
 20549     .
 20550 8588-EXIT.
 20551     EXIT.
 20552 8589-ENDBR-ERPDEF.
 20553
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 379
* EL050.cbl
 20554* EXEC CICS ENDBR
 20555*       DATASET   (PDEF-ID)
 20556*    END-EXEC
 20557     MOVE 0
 20558       TO DFHEIV11
 20559*    MOVE '&2                    $   #00019298' TO DFHEIV0
 20560     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20562     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0,
 20564           PDEF-ID,
 20565           DFHEIV11,
 20566           DFHEIV99
 20567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20568     .
 20569 8589-EXIT.
 20570     EXIT.
 20571 8590-READ-CERT-MASTER.
 20572     IF PB-COMPANY-ID = 'UCL'
 20573         GO TO 8690-READ-CERT-MASTER-UCL.
 20574
 20575
 20576* EXEC CICS HANDLE CONDITION
 20577*         NOTFND    (0299-CERT-NOT-FOUND)
 20578*    END-EXEC.
 20579*    MOVE '"$I                   ! ; #00019308' TO DFHEIV0
 20580     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20582     MOVE X'3B20233030303139333038' TO DFHEIV0(25:11)
 20583     CALL 'kxdfhei1' USING DFHEIV0
 20584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20585
 20586
 20587
 20588* EXEC CICS READ
 20589*        DATASET     (CERT-ID)
 20590*        INTO        (CERTIFICATE-MASTER)
 20591*        RIDFLD      (ELCERT-KEY)
 20592*        UPDATE
 20593*    END-EXEC.
 20594     MOVE LENGTH OF
 20595      CERTIFICATE-MASTER
 20596       TO DFHEIV11
 20597*    MOVE '&"IL       EU         (   #00019312' TO DFHEIV0
 20598     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20599     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20600     MOVE X'2020233030303139333132' TO DFHEIV0(25:11)
 20601     CALL 'kxdfhei1' USING DFHEIV0,
 20602           CERT-ID,
 20603           CERTIFICATE-MASTER,
 20604           DFHEIV11,
 20605           ELCERT-KEY,
 20606           DFHEIV99,
 20607           DFHEIV99,
 20608           DFHEIV99
 20609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20610
 20611
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 380
* EL050.cbl
 20612 8590-EXIT.
 20613     EXIT.
 20614
 20615 8690-READ-CERT-MASTER-UCL.
 20616
 20617* EXEC CICS HANDLE CONDITION
 20618*         NOTFND    (8700-READ-CERT-MASTER)
 20619*    END-EXEC.
 20620*    MOVE '"$I                   ! < #00019323' TO DFHEIV0
 20621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20623     MOVE X'3C20233030303139333233' TO DFHEIV0(25:11)
 20624     CALL 'kxdfhei1' USING DFHEIV0
 20625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20626
 20627
 20628 8690-READ-CERT-CONT.
 20629
 20630* EXEC CICS READ
 20631*        DATASET     (CERT-ID)
 20632*        INTO        (CERTIFICATE-MASTER)
 20633*        RIDFLD      (ELCERT-KEY)
 20634*        UPDATE
 20635*    END-EXEC.
 20636     MOVE LENGTH OF
 20637      CERTIFICATE-MASTER
 20638       TO DFHEIV11
 20639*    MOVE '&"IL       EU         (   #00019328' TO DFHEIV0
 20640     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20642     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 20643     CALL 'kxdfhei1' USING DFHEIV0,
 20644           CERT-ID,
 20645           CERTIFICATE-MASTER,
 20646           DFHEIV11,
 20647           ELCERT-KEY,
 20648           DFHEIV99,
 20649           DFHEIV99,
 20650           DFHEIV99
 20651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20652
 20653
 20654     GO TO 8590-EXIT.
 20655
 20656 8700-READ-CERT-MASTER.
 20657     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20658     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20659
 20660* EXEC CICS HANDLE CONDITION
 20661*         DUPKEY    (8720-COMP-ACCOUNTS)
 20662*         ENDFILE   (8730-END-BROWSE)
 20663*         NOTFND    (8740-NOT-FOUND)
 20664*    END-EXEC.
 20665*    MOVE '"$$''I                 ! = #00019340' TO DFHEIV0
 20666     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20668     MOVE X'3D20233030303139333430' TO DFHEIV0(25:11)
 20669     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 381
* EL050.cbl
 20670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20671
 20672
 20673
 20674* EXEC CICS STARTBR
 20675*        DATASET     ('ELCERT5')
 20676*        RIDFLD      (ELCERT2-KEY)
 20677*        EQUAL
 20678*    END-EXEC.
 20679     MOVE 'ELCERT5' TO DFHEIV1
 20680     MOVE 0
 20681       TO DFHEIV11
 20682*    MOVE '&,         E          &   #00019346' TO DFHEIV0
 20683     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20685     MOVE X'2020233030303139333436' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           DFHEIV1,
 20688           ELCERT2-KEY,
 20689           DFHEIV99,
 20690           DFHEIV11,
 20691           DFHEIV99
 20692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20693
 20694
 20695 8710-READ-NEXT.
 20696
 20697* EXEC CICS READNEXT
 20698*        DATASET     ('ELCERT5')
 20699*        INTO        (CERTIFICATE-MASTER)
 20700*        RIDFLD      (ELCERT2-KEY)
 20701*    END-EXEC.
 20702     MOVE LENGTH OF
 20703      CERTIFICATE-MASTER
 20704       TO DFHEIV12
 20705     MOVE 'ELCERT5' TO DFHEIV1
 20706     MOVE 0
 20707       TO DFHEIV11
 20708*    MOVE '&.IL                  )   #00019353' TO DFHEIV0
 20709     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20711     MOVE X'2020233030303139333533' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           DFHEIV1,
 20714           CERTIFICATE-MASTER,
 20715           DFHEIV12,
 20716           ELCERT2-KEY,
 20717           DFHEIV99,
 20718           DFHEIV11,
 20719           DFHEIV99,
 20720           DFHEIV99
 20721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20722
 20723
 20724 8720-COMP-ACCOUNTS.
 20725
 20726* EXEC CICS ENTER
 20727*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 382
* EL050.cbl
 20728*         FROM (PB-C-LAST-NAME)
 20729*    END-EXEC.
 20730     MOVE 001
 20731       TO DFHEIV11
 20732*    MOVE ':$F                   %   #00019360' TO DFHEIV0
 20733     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20734     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20735     MOVE X'2020233030303139333630' TO DFHEIV0(25:11)
 20736     CALL 'kxdfhei1' USING DFHEIV0,
 20737           DFHEIV11,
 20738           PB-C-LAST-NAME,
 20739           DFHEIV99,
 20740           DFHEIV99
 20741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20742
 20743
 20744
 20745* EXEC CICS ENTER
 20746*         TRACEID (002)
 20747*         FROM (CM-INSURED-LAST-NAME)
 20748*    END-EXEC.
 20749     MOVE 002
 20750       TO DFHEIV11
 20751*    MOVE ':$F                   %   #00019365' TO DFHEIV0
 20752     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20754     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           DFHEIV11,
 20757           CM-INSURED-LAST-NAME,
 20758           DFHEIV99,
 20759           DFHEIV99
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763     IF PB-CERT-NO NOT = CM-CERT-NO
 20764         GO TO 8730-END-BROWSE.
 20765
 20766     IF PB-ACCOUNT = CM-ACCOUNT
 20767         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20768             MOVE ER-2799        TO WS-ERROR
 20769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20770             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20771             GO TO 8730-END-BROWSE.
 20772
 20773     GO TO 8710-READ-NEXT.
 20774
 20775 8730-END-BROWSE.
 20776
 20777* EXEC CICS ENDBR
 20778*         DATASET    ('ELCERT5')
 20779*    END-EXEC.
 20780     MOVE 'ELCERT5' TO DFHEIV1
 20781     MOVE 0
 20782       TO DFHEIV11
 20783*    MOVE '&2                    $   #00019383' TO DFHEIV0
 20784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 383
* EL050.cbl
 20786     MOVE X'2020233030303139333833' TO DFHEIV0(25:11)
 20787     CALL 'kxdfhei1' USING DFHEIV0,
 20788           DFHEIV1,
 20789           DFHEIV11,
 20790           DFHEIV99
 20791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20792
 20793
 20794 8740-NOT-FOUND.
 20795     GO TO 0299-CERT-NOT-FOUND.
 20796
 20797 8750-START-ELSTAT.
 20798
 20799* EXEC CICS STARTBR
 20800*       DATASET   (STAT-ID)
 20801*       RIDFLD    (ELSTAT-KEY)
 20802*       GTEQ
 20803*       RESP      (WS-RESPONSE)
 20804*    END-EXEC
 20805     MOVE 0
 20806       TO DFHEIV11
 20807*    MOVE '&,         G          &  N#00019391' TO DFHEIV0
 20808     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20809     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20810     MOVE X'204E233030303139333931' TO DFHEIV0(25:11)
 20811     CALL 'kxdfhei1' USING DFHEIV0,
 20812           STAT-ID,
 20813           ELSTAT-KEY,
 20814           DFHEIV99,
 20815           DFHEIV11,
 20816           DFHEIV99
 20817     MOVE EIBRESP  TO WS-RESPONSE
 20818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20819     IF WS-RESP-NORMAL
 20820        MOVE 'Y'                 TO STAT-MASTER-SW
 20821     ELSE
 20822        MOVE 'N'                 TO STAT-MASTER-SW
 20823     END-IF
 20824     .
 20825 8750-EXIT.
 20826     EXIT.
 20827 8752-READ-ELSTAT.
 20828
 20829* EXEC CICS READNEXT
 20830*       DATASET   (STAT-ID)
 20831*       RIDFLD    (ELSTAT-KEY)
 20832*       INTO      (STATE-FILE)
 20833*       RESP      (WS-RESPONSE)
 20834*    END-EXEC
 20835     MOVE LENGTH OF
 20836      STATE-FILE
 20837       TO DFHEIV12
 20838     MOVE 0
 20839       TO DFHEIV11
 20840*    MOVE '&.IL                  )  N#00019406' TO DFHEIV0
 20841     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20843     MOVE X'204E233030303139343036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 384
* EL050.cbl
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           STAT-ID,
 20846           STATE-FILE,
 20847           DFHEIV12,
 20848           ELSTAT-KEY,
 20849           DFHEIV99,
 20850           DFHEIV11,
 20851           DFHEIV99,
 20852           DFHEIV99
 20853     MOVE EIBRESP  TO WS-RESPONSE
 20854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20855     IF WS-RESP-NORMAL
 20856        MOVE 'Y'                 TO STAT-MASTER-SW
 20857     ELSE
 20858        MOVE 'N'                 TO STAT-MASTER-SW
 20859     END-IF
 20860     .
 20861 8752-EXIT.
 20862     EXIT.
 20863 8800-GET-COMP-RATE.
 20864     MOVE +1 TO IB.
 20865     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20866         ADD +9 TO IB
 20867         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20868             ADD +9 TO IB
 20869             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20870                MOVE ZEROS       TO WS-WK-RATE
 20871                GO TO 8800-EXIT.
 20872
 20873     IF PB-I-AGE GREATER CT-AGE (1)
 20874         ADD +3 TO IB
 20875         IF PB-I-AGE GREATER CT-AGE (2)
 20876             ADD +3 TO IB
 20877             IF PB-I-AGE GREATER CT-AGE (3)
 20878                MOVE ZEROS       TO WS-WK-RATE
 20879                GO TO 8800-EXIT.
 20880
 20881     IF WS-WORK-TERM GREATER CT-TRM (1)
 20882         ADD +1 TO IB
 20883         IF WS-WORK-TERM GREATER CT-TRM (2)
 20884             ADD +1 TO IB
 20885             IF WS-WORK-TERM GREATER CT-TRM (3)
 20886                MOVE ZEROS       TO WS-WK-RATE
 20887                GO TO 8800-EXIT.
 20888
 20889     IF CT-RT (IB) NOT NUMERIC
 20890         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20891         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20892         GO TO 8800-GET-COMP-RATE.
 20893
 20894     MOVE CT-RT (IB) TO WS-WK-RATE.
 20895
 20896 8800-EXIT.
 20897     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 385
* EL050.cbl
 20899 8900-ADDRESS-FILE.
 20900     IF ERACCT-FILE-ADDRESSED
 20901         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20902         GO TO 8900-ADDRESS-EXIT.
 20903
 20904     IF ELCNTL-FILE-ADDRESSED
 20905         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20906         GO TO 8900-ADDRESS-EXIT.
 20907
 20908     IF ERPLAN-FILE-ADDRESSED
 20909         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20910         GO TO 8900-ADDRESS-EXIT.
 20911
 20912     IF ERFORM-FILE-ADDRESSED
 20913         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20914         GO TO 8900-ADDRESS-EXIT.
 20915
 20916 8900-ADDRESS-EXIT.
 20917     EXIT.
 20918
 20919 9000-READ-CONTROL.
 20920
 20921* EXEC CICS HANDLE CONDITION
 20922*        NOTFND    (9000-NOTFND)
 20923*    END-EXEC.
 20924*    MOVE '"$I                   ! > #00019477' TO DFHEIV0
 20925     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20927     MOVE X'3E20233030303139343737' TO DFHEIV0(25:11)
 20928     CALL 'kxdfhei1' USING DFHEIV0
 20929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20930
 20931
 20932
 20933* EXEC CICS READ
 20934*        DATASET     (CNTL-ID)
 20935*        SET         (ADDRESS OF CONTROL-FILE)
 20936*        RIDFLD      (ELCNTL-KEY)
 20937*        GTEQ
 20938*    END-EXEC.
 20939*    MOVE '&"S        G          (   #00019481' TO DFHEIV0
 20940     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20942     MOVE X'2020233030303139343831' TO DFHEIV0(25:11)
 20943     CALL 'kxdfhei1' USING DFHEIV0,
 20944           CNTL-ID,
 20945           DFHEIV20,
 20946           DFHEIV99,
 20947           ELCNTL-KEY,
 20948           DFHEIV99,
 20949           DFHEIV99,
 20950           DFHEIV99
 20951     SET ADDRESS OF CONTROL-FILE TO
 20952         DFHEIV20
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 386
* EL050.cbl
 20957
 20958 9000-NOTFND.
 20959     IF RC-SW-1 = '1'
 20960        MOVE ER-2616              TO WS-ERROR
 20961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20962        GO TO 9000-EXIT.
 20963
 20964     IF RC-SW-1 = '2'
 20965        MOVE ER-2602              TO WS-ERROR
 20966        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20967
 20968 9000-EXIT.
 20969      EXIT.
 20970
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 387
* EL050.cbl
 20972 9100-READ-CONTROL.
 20973
 20974* EXEC CICS HANDLE CONDITION
 20975*        NOTFND  (9100-NOTFND)
 20976*        ENDFILE (9100-NOTFND)
 20977*    END-EXEC.
 20978*    MOVE '"$I''                  ! ? #00019505' TO DFHEIV0
 20979     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20981     MOVE X'3F20233030303139353035' TO DFHEIV0(25:11)
 20982     CALL 'kxdfhei1' USING DFHEIV0
 20983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20984
 20985
 20986
 20987* EXEC CICS READ
 20988*        DATASET     (CNTL-ID)
 20989*        INTO        (CONTROL-FILE)
 20990*        RIDFLD      (ELCNTL-KEY)
 20991*        GTEQ
 20992*    END-EXEC.
 20993     MOVE LENGTH OF
 20994      CONTROL-FILE
 20995       TO DFHEIV11
 20996*    MOVE '&"IL       G          (   #00019510' TO DFHEIV0
 20997     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20999     MOVE X'2020233030303139353130' TO DFHEIV0(25:11)
 21000     CALL 'kxdfhei1' USING DFHEIV0,
 21001           CNTL-ID,
 21002           CONTROL-FILE,
 21003           DFHEIV11,
 21004           ELCNTL-KEY,
 21005           DFHEIV99,
 21006           DFHEIV99,
 21007           DFHEIV99
 21008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21009
 21010
 21011     GO TO 9100-EXIT.
 21012
 21013 9100-NOTFND.
 21014     IF RC-SW-2 = '0'
 21015        MOVE '1'                  TO STATE-RECORD-ERROR
 21016        GO TO 9100-EXIT
 21017     END-IF
 21018     IF RC-SW-2 = '1'
 21019        MOVE '1'                  TO LF-BENEFIT-ERROR
 21020        MOVE ER-2604              TO WS-ERROR
 21021        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21022        GO TO 9100-EXIT.
 21023
 21024     IF RC-SW-2 = '2'
 21025        MOVE '1'                  TO AH-BENEFIT-ERROR
 21026        MOVE ER-2605              TO WS-ERROR
 21027        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21028        GO TO 9100-EXIT.
 21029
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 388
* EL050.cbl
 21030     IF RC-SW-2 = '3'
 21031         MOVE ER-2603           TO WS-ERROR
 21032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21033         GO TO 9100-EXIT.
 21034
 21035     IF RC-SW-2 = '4'
 21036         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21037         GO TO 9100-EXIT.
 21038
 21039     IF RC-SW-2 = '5'
 21040         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21041         IF WS-AH-INPUT-CD-1 = SPACE
 21042             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21043         ELSE
 21044             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21045
 21046 9100-EXIT.
 21047      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 389
* EL050.cbl
 21049 9200-CONTROL-GETMAIN.
 21050
 21051* EXEC CICS GETMAIN
 21052*         LENGTH   (750)
 21053*         SET      (ADDRESS OF CONTROL-FILE)
 21054*    END-EXEC.
 21055     MOVE 750
 21056       TO DFHEIV11
 21057*    MOVE '," L                  $   #00019556' TO DFHEIV0
 21058     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303139353536' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           DFHEIV20,
 21063           DFHEIV11,
 21064           DFHEIV99
 21065     SET ADDRESS OF CONTROL-FILE TO
 21066         DFHEIV20
 21067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21068
 21069
 21070     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21071
 21072 9200-EXIT.
 21073     EXIT.
 21074
 21075 9250-UNLOCK-RETURN.
 21076
 21077* EXEC CICS UNLOCK
 21078*        DATASET   (CERT-ID)
 21079*    END-EXEC.
 21080*    MOVE '&*                    #   #00019567' TO DFHEIV0
 21081     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21082     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21083     MOVE X'2020233030303139353637' TO DFHEIV0(25:11)
 21084     CALL 'kxdfhei1' USING DFHEIV0,
 21085           CERT-ID,
 21086           DFHEIV99
 21087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21088
 21089
 21090 9300-ABEND.
 21091     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21092
 21093
 21094* EXEC CICS LINK
 21095*        PROGRAM   ('EL004')
 21096*        COMMAREA  (WS-ERROR-LINE)
 21097*        LENGTH    (72)
 21098*    END-EXEC.
 21099     MOVE 'EL004' TO DFHEIV1
 21100     MOVE 72
 21101       TO DFHEIV11
 21102*    MOVE '."C                   (   #00019574' TO DFHEIV0
 21103     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21105     MOVE X'2020233030303139353734' TO DFHEIV0(25:11)
 21106     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 390
* EL050.cbl
 21107           DFHEIV1,
 21108           WS-ERROR-LINE,
 21109           DFHEIV11,
 21110           DFHEIV99,
 21111           DFHEIV99,
 21112           DFHEIV99,
 21113           DFHEIV99
 21114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21115
 21116
 21117     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21118
 21119
 21120* EXEC CICS ABEND
 21121*        ABCODE ('EL50')
 21122*    END-EXEC.
 21123     MOVE 'EL50' TO DFHEIV5
 21124*    MOVE '.,A                   "   #00019582' TO DFHEIV0
 21125     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21126     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21127     MOVE X'2020233030303139353832' TO DFHEIV0(25:11)
 21128     CALL 'kxdfhei1' USING DFHEIV0,
 21129           DFHEIV5
 21130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21131
 21132
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 391
* EL050.cbl
 21134
 21135******************************************************************
 21136*                                                                *
 21137*            E R R O R   F O R M A T   R O U T I N E             *
 21138*                                                                *
 21139******************************************************************
 21140
 21141 9900-ERROR-FORMAT.
 21142
 21143     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21144                    PB-COMMON-ERROR (2) OR
 21145                    PB-COMMON-ERROR (3) OR
 21146                    PB-COMMON-ERROR (4) OR
 21147                    PB-COMMON-ERROR (5) OR
 21148                    PB-COMMON-ERROR (6) OR
 21149                    PB-COMMON-ERROR (7) OR
 21150                    PB-COMMON-ERROR (8) OR
 21151                    PB-COMMON-ERROR (9) OR
 21152                    PB-COMMON-ERROR (10)
 21153        GO TO 9900-EXIT.
 21154
 21155     IF PB-NO-OF-ERRORS = +10
 21156        GO TO 9900-EXIT.
 21157
 21158     ADD +1  TO PB-NO-OF-ERRORS.
 21159     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21160                                       (PB-NO-OF-ERRORS).
 21161 9900-EXIT.
 21162     EXIT.
 21163
 21164 9990-RETURN.
 21165     IF BROWSE-STARTED
 21166
 21167* EXEC CICS ENDBR
 21168*            DATASET  (ACCT-ID)
 21169*       END-EXEC.
 21170     MOVE 0
 21171       TO DFHEIV11
 21172*    MOVE '&2                    $   #00019619' TO DFHEIV0
 21173     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21174     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21175     MOVE X'2020233030303139363139' TO DFHEIV0(25:11)
 21176     CALL 'kxdfhei1' USING DFHEIV0,
 21177           ACCT-ID,
 21178           DFHEIV11,
 21179           DFHEIV99
 21180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21181
 21182
 21183 9990-EXIT.
 21184     EXIT.
 21185
 21186
 21187****Check for CRTO record, add one if not found.
 21188 9991-CHECK-FOR-ELCRTO.
 21189
 21190* EXEC CICS HANDLE CONDITION
 21191*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 392
* EL050.cbl
 21192*         ENDFILE (9991-CRTO-NOT-FOUND)
 21193*     END-EXEC.
 21194*    MOVE '"$I''                  ! @ #00019629' TO DFHEIV0
 21195     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21197     MOVE X'4020233030303139363239' TO DFHEIV0(25:11)
 21198     CALL 'kxdfhei1' USING DFHEIV0
 21199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21200
 21201     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21202     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21203     MOVE +0                     TO ELCRTO-SEQ-NO
 21204
 21205
 21206* EXEC CICS READ
 21207*       DATASET   ('ELCRTO')
 21208*       INTO      (ORIGINAL-CERTIFICATE)
 21209*       RIDFLD    (ELCRTO-KEY)
 21210*       GTEQ
 21211*       RESP      (WS-RESPONSE)
 21212*    END-EXEC
 21213     MOVE LENGTH OF
 21214      ORIGINAL-CERTIFICATE
 21215       TO DFHEIV11
 21216     MOVE 'ELCRTO' TO DFHEIV1
 21217*    MOVE '&"IL       G          (  N#00019637' TO DFHEIV0
 21218     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21220     MOVE X'204E233030303139363337' TO DFHEIV0(25:11)
 21221     CALL 'kxdfhei1' USING DFHEIV0,
 21222           DFHEIV1,
 21223           ORIGINAL-CERTIFICATE,
 21224           DFHEIV11,
 21225           ELCRTO-KEY,
 21226           DFHEIV99,
 21227           DFHEIV99,
 21228           DFHEIV99
 21229     MOVE EIBRESP  TO WS-RESPONSE
 21230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21231
 21232     IF WS-RESP-NORMAL
 21233        AND (OC-CONTROL-PRIMARY (1:33) =
 21234                 PB-CONTROL-BY-ACCOUNT (1:33))
 21235        AND (OC-RECORD-TYPE =  'I')
 21236           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21237               GO TO 9991-CHECK-INDICATORS
 21238           ELSE
 21239               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21240               GO TO 9991-CRTO-ADD-REC
 21241           END-IF
 21242     END-IF.
 21243
 21244 9991-CRTO-NOT-FOUND.
 21245
 21246     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21247     MOVE 'OC'                TO OC-RECORD-ID
 21248     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21249                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 393
* EL050.cbl
 21250     MOVE +4096               TO OC-KEY-SEQ-NO.
 21251
 21252 9991-CRTO-ADD-REC.
 21253
 21254     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21255     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21256     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21257     MOVE 'I'                 TO OC-RECORD-TYPE
 21258     IF PB-ISSUE
 21259         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21260         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21261         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21262         MOVE PB-I-AGE               TO OC-INS-AGE
 21263         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21264         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21265         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21266         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21267         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21268         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21269         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21270         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21271         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21272         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21273         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21274         IF PB-I-JOINT-COMMISSION > +0
 21275             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21276         ELSE
 21277             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21278         END-IF
 21279         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21280         MOVE +0                     TO OC-LF-CANCEL-AMT
 21281                                        OC-LF-ITD-CANCEL-AMT
 21282         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21283         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21284         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21285         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21286         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21287         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21288         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21289         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21290         MOVE +0                     TO OC-AH-CANCEL-AMT
 21291                                        OC-AH-ITD-CANCEL-AMT
 21292         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21293         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21294         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21295     ELSE
 21296         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21297         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21298         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21299         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21300         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21301         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21302         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21303         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21304         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21305          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21306             MOVE SPACES             TO OC-LF-BENCD
 21307             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 394
* EL050.cbl
 21308                                        OC-LF-BEN-AMT
 21309                                        OC-LF-PRM-AMT
 21310                                        OC-LF-ALT-BEN-AMT
 21311                                        OC-LF-ALT-PRM-AMT
 21312                                        OC-LF-COMM-PCT
 21313                                        OC-LF-CANCEL-AMT
 21314             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21315             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21316         ELSE
 21317             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21318             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21319             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21320             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21321             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21322             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21323             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21324             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21325             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21326             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21327         END-IF
 21328         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21329         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21330          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21331             MOVE SPACES             TO OC-AH-BENCD
 21332             MOVE ZEROS              TO OC-AH-TERM
 21333                                        OC-AH-BEN-AMT
 21334                                        OC-AH-PRM-AMT
 21335                                        OC-AH-COMM-PCT
 21336                                        OC-AH-CANCEL-AMT
 21337                                        OC-AH-CP
 21338             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21339             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21340         ELSE
 21341             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21342             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21343             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21344             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21345             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21346             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21347             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21348             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21349             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21350         END-IF
 21351         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21352         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21353         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21354         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21355     END-IF
 21356     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21357
 21358     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21359
 21360
 21361* EXEC CICS READ
 21362*         DATASET   (FILE-ERMAIL)
 21363*         RIDFLD    (MA-CONTROL-PRIMARY)
 21364*         INTO      (MAILING-DATA)
 21365*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 395
* EL050.cbl
 21366*    END-EXEC
 21367     MOVE LENGTH OF
 21368      MAILING-DATA
 21369       TO DFHEIV11
 21370*    MOVE '&"IL       E          (  N#00019773' TO DFHEIV0
 21371     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21373     MOVE X'204E233030303139373733' TO DFHEIV0(25:11)
 21374     CALL 'kxdfhei1' USING DFHEIV0,
 21375           FILE-ERMAIL,
 21376           MAILING-DATA,
 21377           DFHEIV11,
 21378           MA-CONTROL-PRIMARY,
 21379           DFHEIV99,
 21380           DFHEIV99,
 21381           DFHEIV99
 21382     MOVE EIBRESP  TO WS-RESPONSE
 21383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21384
 21385     IF WS-RESP-NORMAL
 21386         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21387     END-IF.
 21388
 21389     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21390     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21391
 21392
 21393* EXEC CICS READ
 21394*         DATASET  (CRTT-ID)
 21395*         RIDFLD   (WS-ELCRTT-KEY)
 21396*         INTO     (CERTIFICATE-TRAILERS)
 21397*         RESP     (WS-RESPONSE)
 21398*    END-EXEC
 21399     MOVE LENGTH OF
 21400      CERTIFICATE-TRAILERS
 21401       TO DFHEIV11
 21402*    MOVE '&"IL       E          (  N#00019787' TO DFHEIV0
 21403     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21405     MOVE X'204E233030303139373837' TO DFHEIV0(25:11)
 21406     CALL 'kxdfhei1' USING DFHEIV0,
 21407           CRTT-ID,
 21408           CERTIFICATE-TRAILERS,
 21409           DFHEIV11,
 21410           WS-ELCRTT-KEY,
 21411           DFHEIV99,
 21412           DFHEIV99,
 21413           DFHEIV99
 21414     MOVE EIBRESP  TO WS-RESPONSE
 21415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21416
 21417     IF WS-RESP-NORMAL
 21418         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21419         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21420     END-IF.
 21421
 21422
 21423* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 396
* EL050.cbl
 21424*       DATASET   ('ELCRTO')
 21425*       FROM      (ORIGINAL-CERTIFICATE)
 21426*       RIDFLD    (OC-CONTROL-PRIMARY)
 21427*       RESP      (WS-RESPONSE)
 21428*    END-EXEC.
 21429     MOVE LENGTH OF
 21430      ORIGINAL-CERTIFICATE
 21431       TO DFHEIV11
 21432     MOVE 'ELCRTO' TO DFHEIV1
 21433*    MOVE '&$ L                  ''  N#00019799' TO DFHEIV0
 21434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21436     MOVE X'204E233030303139373939' TO DFHEIV0(25:11)
 21437     CALL 'kxdfhei1' USING DFHEIV0,
 21438           DFHEIV1,
 21439           ORIGINAL-CERTIFICATE,
 21440           DFHEIV11,
 21441           OC-CONTROL-PRIMARY,
 21442           DFHEIV99,
 21443           DFHEIV99
 21444     MOVE EIBRESP  TO WS-RESPONSE
 21445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21446
 21447
 21448     GO TO 9991-EXIT.
 21449
 21450 9991-CHECK-INDICATORS.
 21451
 21452     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21453         GO TO 9991-EXIT
 21454     END-IF.
 21455
 21456     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21457         GO TO 9991-EXIT
 21458     END-IF.
 21459
 21460
 21461* EXEC CICS READ
 21462*       DATASET   ('ELCRTO')
 21463*       INTO      (ORIGINAL-CERTIFICATE)
 21464*       RIDFLD    (OC-CONTROL-PRIMARY)
 21465*       UPDATE
 21466*       RESP      (WS-RESPONSE)
 21467*    END-EXEC
 21468     MOVE LENGTH OF
 21469      ORIGINAL-CERTIFICATE
 21470       TO DFHEIV11
 21471     MOVE 'ELCRTO' TO DFHEIV1
 21472*    MOVE '&"IL       EU         (  N#00019818' TO DFHEIV0
 21473     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21474     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21475     MOVE X'204E233030303139383138' TO DFHEIV0(25:11)
 21476     CALL 'kxdfhei1' USING DFHEIV0,
 21477           DFHEIV1,
 21478           ORIGINAL-CERTIFICATE,
 21479           DFHEIV11,
 21480           OC-CONTROL-PRIMARY,
 21481           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 397
* EL050.cbl
 21482           DFHEIV99,
 21483           DFHEIV99
 21484     MOVE EIBRESP  TO WS-RESPONSE
 21485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21486     IF WS-RESP-NORMAL
 21487        IF PB-ISSUE
 21488          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21489          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21490          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21491          MOVE PB-I-AGE               TO OC-INS-AGE
 21492          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21493          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21494          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21495          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21496          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21497          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21498          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21499          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21500          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21501          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21502          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21503          IF PB-I-JOINT-COMMISSION > +0
 21504              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21505          ELSE
 21506              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21507          END-IF
 21508          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21509          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21510          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21511          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21512          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21513          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21514          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21515          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21516          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21517
 21518          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21519
 21520* EXEC CICS READ
 21521*             DATASET   (FILE-ERMAIL)
 21522*             RIDFLD    (MA-CONTROL-PRIMARY)
 21523*             INTO      (MAILING-DATA)
 21524*             RESP      (WS-RESPONSE)
 21525*         END-EXEC
 21526     MOVE LENGTH OF
 21527      MAILING-DATA
 21528       TO DFHEIV11
 21529*    MOVE '&"IL       E          (  N#00019858' TO DFHEIV0
 21530     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21532     MOVE X'204E233030303139383538' TO DFHEIV0(25:11)
 21533     CALL 'kxdfhei1' USING DFHEIV0,
 21534           FILE-ERMAIL,
 21535           MAILING-DATA,
 21536           DFHEIV11,
 21537           MA-CONTROL-PRIMARY,
 21538           DFHEIV99,
 21539           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 398
* EL050.cbl
 21540           DFHEIV99
 21541     MOVE EIBRESP  TO WS-RESPONSE
 21542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21543          IF WS-RESP-NORMAL
 21544             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21545          END-IF
 21546
 21547          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21548          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21549
 21550* EXEC CICS READ
 21551*             DATASET  (CRTT-ID)
 21552*             RIDFLD   (WS-ELCRTT-KEY)
 21553*             INTO     (CERTIFICATE-TRAILERS)
 21554*             RESP     (WS-RESPONSE)
 21555*         END-EXEC
 21556     MOVE LENGTH OF
 21557      CERTIFICATE-TRAILERS
 21558       TO DFHEIV11
 21559*    MOVE '&"IL       E          (  N#00019870' TO DFHEIV0
 21560     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21562     MOVE X'204E233030303139383730' TO DFHEIV0(25:11)
 21563     CALL 'kxdfhei1' USING DFHEIV0,
 21564           CRTT-ID,
 21565           CERTIFICATE-TRAILERS,
 21566           DFHEIV11,
 21567           WS-ELCRTT-KEY,
 21568           DFHEIV99,
 21569           DFHEIV99,
 21570           DFHEIV99
 21571     MOVE EIBRESP  TO WS-RESPONSE
 21572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21573          IF WS-RESP-NORMAL
 21574             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21575                               OC-INS-AGE-DEFAULT-FLAG
 21576             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21577                               OC-JNT-AGE-DEFAULT-FLAG
 21578          END-IF
 21579
 21580        ELSE
 21581          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21582             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21583             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21584             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21585          END-IF
 21586          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21587             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21588             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21589             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21590          END-IF
 21591          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21592        END-IF
 21593
 21594* EXEC CICS REWRITE
 21595*          DATASET   ('ELCRTO')
 21596*          FROM      (ORIGINAL-CERTIFICATE)
 21597*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 399
* EL050.cbl
 21598*       END-EXEC
 21599     MOVE LENGTH OF
 21600      ORIGINAL-CERTIFICATE
 21601       TO DFHEIV11
 21602     MOVE 'ELCRTO' TO DFHEIV1
 21603*    MOVE '&& L                  %  N#00019896' TO DFHEIV0
 21604     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21605     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21606     MOVE X'204E233030303139383936' TO DFHEIV0(25:11)
 21607     CALL 'kxdfhei1' USING DFHEIV0,
 21608           DFHEIV1,
 21609           ORIGINAL-CERTIFICATE,
 21610           DFHEIV11,
 21611           DFHEIV99
 21612     MOVE EIBRESP  TO WS-RESPONSE
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21614     END-IF.
 21615
 21616 9991-EXIT.
 21617     EXIT.
 21618
 21619
 21620 9999-RETURN.
 21621     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21622
 21623
 21624* EXEC CICS RETURN
 21625*    END-EXEC.
 21626*    MOVE '.(                    ''   #00019910' TO DFHEIV0
 21627     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21629     MOVE X'2020233030303139393130' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0,
 21631           DFHEIV99,
 21632           DFHEIV99,
 21633           DFHEIV99,
 21634           DFHEIV99,
 21635           DFHEIV99,
 21636           DFHEIV99
 21637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21638
 21639
 21640
 21641* GOBACK.
 21642     MOVE '9%                    "   ' TO DFHEIV0
 21643     MOVE 'EL050' TO DFHEIV1
 21644     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21645     GOBACK.
 21646
 21647 9999-DFHBACK SECTION.
 21648     MOVE '9%                    "   ' TO DFHEIV0
 21649     MOVE 'EL050' TO DFHEIV1
 21650     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21651     GOBACK.
 21652 9999-DFHEXIT.
 21653     IF DFHEIGDJ EQUAL 0001
 21654         NEXT SENTENCE
 21655     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 400
* EL050.cbl
 21656         GO TO 9300-ABEND,
 21657               3990-FILES-NOT-OPEN
 21658         DEPENDING ON DFHEIGDI
 21659     ELSE IF DFHEIGDJ EQUAL 3
 21660         GO TO 6610-START-BROWSE,
 21661               6630-ERRESS-PROBLEM,
 21662               6630-END-OF-FILE
 21663         DEPENDING ON DFHEIGDI
 21664     ELSE IF DFHEIGDJ EQUAL 4
 21665         GO TO 6630-END-OF-FILE,
 21666               6630-ERRESS-PROBLEM,
 21667               6630-ERRESS-PROBLEM,
 21668               6630-END-OF-FILE
 21669         DEPENDING ON DFHEIGDI
 21670     ELSE IF DFHEIGDJ EQUAL 5
 21671         GO TO 6630-END-OF-FILE,
 21672               6630-END-OF-FILE,
 21673               6630-ERRESS-PROBLEM,
 21674               6630-ERRESS-PROBLEM
 21675         DEPENDING ON DFHEIGDI
 21676     ELSE IF DFHEIGDJ EQUAL 6
 21677         GO TO 6660-START-BROWSE,
 21678               6690-ERRESC-PROBLEM,
 21679               6690-ERRESC-PROBLEM,
 21680               6690-END-OF-FILE
 21681         DEPENDING ON DFHEIGDI
 21682     ELSE IF DFHEIGDJ EQUAL 7
 21683         GO TO 6690-END-OF-FILE,
 21684               6690-ERRESC-PROBLEM,
 21685               6690-ERRESC-PROBLEM,
 21686               6690-END-OF-FILE
 21687         DEPENDING ON DFHEIGDI
 21688     ELSE IF DFHEIGDJ EQUAL 8
 21689         GO TO 6690-END-OF-FILE,
 21690               6690-ERRESC-PROBLEM,
 21691               6690-ERRESC-PROBLEM,
 21692               6690-END-OF-FILE
 21693         DEPENDING ON DFHEIGDI
 21694     ELSE IF DFHEIGDJ EQUAL 9
 21695         GO TO 7250-CONTINUE,
 21696               7250-CONTINUE
 21697         DEPENDING ON DFHEIGDI
 21698     ELSE IF DFHEIGDJ EQUAL 10
 21699         GO TO 7300-CONTINUE,
 21700               7300-CONTINUE
 21701         DEPENDING ON DFHEIGDI
 21702     ELSE IF DFHEIGDJ EQUAL 11
 21703         GO TO 8000-FREE-MAIN
 21704         DEPENDING ON DFHEIGDI
 21705     ELSE IF DFHEIGDJ EQUAL 12
 21706         GO TO 8100-NOTFND,
 21707               8100-NOTFND
 21708         DEPENDING ON DFHEIGDI
 21709     ELSE IF DFHEIGDJ EQUAL 13
 21710         GO TO 8110-NOTFND,
 21711               8110-NOTFND
 21712         DEPENDING ON DFHEIGDI
 21713     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 401
* EL050.cbl
 21714         GO TO 8130-EXIT
 21715         DEPENDING ON DFHEIGDI
 21716     ELSE IF DFHEIGDJ EQUAL 15
 21717         GO TO 8180-NOTFND
 21718         DEPENDING ON DFHEIGDI
 21719     ELSE IF DFHEIGDJ EQUAL 16
 21720         GO TO 8190-NOTFND
 21721         DEPENDING ON DFHEIGDI
 21722     ELSE IF DFHEIGDJ EQUAL 17
 21723         GO TO 8195-NOTFND
 21724         DEPENDING ON DFHEIGDI
 21725     ELSE IF DFHEIGDJ EQUAL 18
 21726         GO TO 8200-NOTFND
 21727         DEPENDING ON DFHEIGDI
 21728     ELSE IF DFHEIGDJ EQUAL 19
 21729         GO TO 8300-NOTFND,
 21730               8300-ERRESS-PROBLEM,
 21731               8300-ERRESS-PROBLEM,
 21732               8300-NOTFND
 21733         DEPENDING ON DFHEIGDI
 21734     ELSE IF DFHEIGDJ EQUAL 20
 21735         GO TO 8450-FORM-NOT-FOUND,
 21736               8450-FORM-NOT-FOUND
 21737         DEPENDING ON DFHEIGDI
 21738     ELSE IF DFHEIGDJ EQUAL 21
 21739         GO TO 0199-ACCT-NOT-FOUND,
 21740               0199-ACCT-NOT-FOUND
 21741         DEPENDING ON DFHEIGDI
 21742     ELSE IF DFHEIGDJ EQUAL 22
 21743         GO TO 0199-ACCT-NOT-FOUND,
 21744               0199-ACCT-NOT-FOUND
 21745         DEPENDING ON DFHEIGDI
 21746     ELSE IF DFHEIGDJ EQUAL 23
 21747         GO TO 8582-COMP-NOT-FOUND,
 21748               8582-COMP-NOT-FOUND
 21749         DEPENDING ON DFHEIGDI
 21750     ELSE IF DFHEIGDJ EQUAL 24
 21751         GO TO 8583-AGTC-NOT-FOUND,
 21752               8583-AGTC-NOT-FOUND
 21753         DEPENDING ON DFHEIGDI
 21754     ELSE IF DFHEIGDJ EQUAL 25
 21755         GO TO 8584-BXRF-NOT-FOUND,
 21756               8584-BXRF-NOT-FOUND
 21757         DEPENDING ON DFHEIGDI
 21758     ELSE IF DFHEIGDJ EQUAL 26
 21759         GO TO 8585-PLAN-NOT-FOUND,
 21760               8585-PLAN-NOT-FOUND
 21761         DEPENDING ON DFHEIGDI
 21762     ELSE IF DFHEIGDJ EQUAL 27
 21763         GO TO 0299-CERT-NOT-FOUND
 21764         DEPENDING ON DFHEIGDI
 21765     ELSE IF DFHEIGDJ EQUAL 28
 21766         GO TO 8700-READ-CERT-MASTER
 21767         DEPENDING ON DFHEIGDI
 21768     ELSE IF DFHEIGDJ EQUAL 29
 21769         GO TO 8720-COMP-ACCOUNTS,
 21770               8730-END-BROWSE,
 21771               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 29-Oct-13 15:15 Page 402
* EL050.cbl
 21772         DEPENDING ON DFHEIGDI
 21773     ELSE IF DFHEIGDJ EQUAL 30
 21774         GO TO 9000-NOTFND
 21775         DEPENDING ON DFHEIGDI
 21776     ELSE IF DFHEIGDJ EQUAL 31
 21777         GO TO 9100-NOTFND,
 21778               9100-NOTFND
 21779         DEPENDING ON DFHEIGDI
 21780     ELSE IF DFHEIGDJ EQUAL 32
 21781         GO TO 9991-CRTO-NOT-FOUND,
 21782               9991-CRTO-NOT-FOUND
 21783         DEPENDING ON DFHEIGDI.
 21784     MOVE '9%                    "   ' TO DFHEIV0
 21785     MOVE 'EL050' TO DFHEIV1
 21786     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21787     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87801
