* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64******************************************************************
    65
    66 ENVIRONMENT DIVISION.
    67
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   3
* EL6311.cbl
    69 DATA DIVISION.
    70 WORKING-STORAGE SECTION.
    71 01  DFH-START PIC X(04).
    72 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    73 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    74 77  FILLER  PIC X(32)  VALUE '********************************'.
    75 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    76 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    77 77  A1                          PIC S999 COMP-3 VALUE +0.
    78 77  N1                          PIC S999 COMP-3 VALUE +0.
    79 77  N2                          PIC S999 COMP-3 VALUE +0.
    80 77  N3                          PIC S999 COMP-3 VALUE +0.
    81 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    82 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    83 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    84     88  REVERSAL                    VALUE 'Y'.
    85 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    86 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    87 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    88 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    89 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    90     88  ERMAIL-FOUND                 VALUE 'Y'.
    91 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    92 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    93 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    94 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    95     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    96
    97*    COPY ELCSCTM.
    98******************************************************************
    99*                                                                *
   100*                                                                *
   101*                            ELCSCTM                             *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-MESSAGE.
   108     12  FILLER                          PIC X(30)
   109            VALUE '** LOGIC SECURITY VIOLATION -'.
   110     12  SM-READ                         PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' PGM='.
   113     12  SM-PGM                          PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' OPR='.
   116     12  SM-PROCESSOR-ID                 PIC X(4).
   117     12  FILLER                          PIC X(6)
   118            VALUE ' TERM='.
   119     12  SM-TERMID                       PIC X(4).
   120     12  FILLER                          PIC XX   VALUE SPACE.
   121     12  SM-JUL-DATE                     PIC 9(5).
   122     12  FILLER                          PIC X    VALUE SPACE.
   123     12  SM-TIME                         PIC 99.99.
   124
   125
   126*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   4
* EL6311.cbl
   127******************************************************************
   128*                                                                *
   129*                                                                *
   130*                            ELCSCRTY                            *
   131*                            VMOD=2.001                          *
   132*                                                                *
   133*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   134*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   135*        SAVED IN PI-SECURITY-ADDRESS.                           *
   136*                                                                *
   137******************************************************************
   138 01  SECURITY-CONTROL.
   139     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   140     12  FILLER                       PIC XX    VALUE 'SC'.
   141     12  SC-CREDIT-CODES.
   142         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   143             20  SC-CREDIT-DISPLAY    PIC X.
   144             20  SC-CREDIT-UPDATE     PIC X.
   145     12  SC-CLAIMS-CODES.
   146         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   147             20  SC-CLAIMS-DISPLAY    PIC X.
   148             20  SC-CLAIMS-UPDATE     PIC X.
   149
   150 01  WS-VA-NO-COMM-MESS.
   151     12  FILLER                  PIC X(41) VALUE
   152        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   153 01  WS-OC-MESSAGE.
   154     12  FILLER                  PIC X(43) VALUE
   155        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   156     12  WS-OC-DIS-AMT           PIC -----9.99.
   157     12  FILLER                  PIC X(4) VALUE ' ON '.
   158     12  WS-OC-DATE              PIC X(10).
   159 01  WS-DATE-AREA.
   160     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   161     12  WS-CURRENT-DT.
   162         16  FILLER              PIC X(6)    VALUE SPACES.
   163         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   164     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   165     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   166     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   167
   168 01  STANDARD-AREAS.
   169     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   170     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   171     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   172     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   173     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   174     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   175     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   176     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   177     12  PGM-NAME                PIC X(8).
   178     12  TIME-IN                 PIC S9(7).
   179     12  TIME-OUT-R  REDEFINES TIME-IN.
   180         16  FILLER              PIC X.
   181         16  TIME-OUT            PIC 99V99.
   182         16  FILLER              PIC XX.
   183     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   184     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   5
* EL6311.cbl
   185     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   186     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   187     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   188     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   189     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   190     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   191     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   192     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   193     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   194     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   195     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   196     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   197     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   198     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   199     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   200     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   201     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   202     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   203     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   204     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   205     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   206     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   207     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   208     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   209     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   210     12  FILE-ID                 PIC X(8).
   211     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   212     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   213     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   214     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   215     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   216     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   217     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   218     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   219     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   220     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   221     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   222     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   223     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   224     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   225     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   226
   227 01  WS-PASS-AREA.
   228     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   229     05  WS-PASS-VADS-REC    PIC X(350).
   230*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   231*                                COPY ELCZREC.
   232******************************************************************
   233*                                                                *
   234*                                                                *
   235*                            ELCZREC.                            *
   236*                                                                *
   237*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   238*                                                                *
   239******************************************************************
   240*-----------------------------------------------------------------
   241*                   C H A N G E   L O G
   242*
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   6
* EL6311.cbl
   243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   244*-----------------------------------------------------------------
   245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   246* EFFECTIVE    NUMBER
   247*-----------------------------------------------------------------
   248* 122011    2011022800001  AJRA  NEW FILE
   249* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   250* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   251*-----------------------------------------------------------------
   252 01  W-Z-CONTROL-DATA.
   253     05  W-NUMBER-OF-COPIES      PIC  9.
   254     05  FILLER                  PIC  X.
   255     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   256     05  FILLER                  PIC  X.
   257     05  W-DAYS-TO-RESEND        PIC  999.
   258     05  FILLER                  PIC  X.
   259     05  W-FORM-TO-RESEND        PIC  X(4).
   260     05  FILLER                  PIC  X.
   261     05  W-PROMPT-LETTER         PIC  X.
   262     05  FILLER                  PIC  X.
   263     05  W-ENCLOSURE-CD          PIC  XXX.
   264     05  FILLER                  PIC  X.
   265     05  W-AUTO-CLOSE-IND        PIC  X.
   266     05  FILLER                  PIC  X.
   267     05  W-LETTER-TO-BENE        PIC  X.
   268     05  FILLER                  PIC  X.
   269     05  W-LETTER-TO-ACCT        PIC  X.
   270     05  FILLER                  PIC  X.
   271     05  W-LETTER-TYPE           PIC  X.
   272     05  FILLER                  PIC  X.
   273     05  W-PRINT-CERTIFICATE     PIC  X.
   274     05  FILLER                  PIC  X.
   275     05  W-REFUND-REQUIRED       PIC  X.
   276     05  FILLER                  PIC  X.
   277     05  W-ONBASE-CODE           PIC  XX.
   278     05  FILLER                  PIC  X.
   279     05  W-ACCT-SUMM             PIC  X.
   280     05  FILLER                  PIC  X.
   281     05  W-CSO-SUMM              PIC  X.
   282     05  FILLER                  PIC  X.
   283     05  W-REASONS-REQUIRED      PIC  X.
   284     05  FILLER                  PIC  X(29).
   285******************************************************************
   286*                                                                *
   287*              A C C E S S   K E Y S                             *
   288*                                                                *
   289******************************************************************
   290
   291 01  ACCESS-KEYS.
   292     12  ERPYAJ-KEY.
   293         16  ERPYAJ-COMPANY-CD       PIC X.
   294         16  ERPYAJ-CARRIER          PIC X.
   295         16  ERPYAJ-GROUPING         PIC X(6).
   296         16  ERPYAJ-FIN-RESP         PIC X(10).
   297         16  ERPYAJ-ACCOUNT          PIC X(10).
   298         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   299         16  ERPYAJ-TYPE             PIC X.
   300     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   7
* EL6311.cbl
   301     12  ELCERT-KEY.
   302         16  ELCERT-COMPANY-CD       PIC X.
   303         16  ELCERT-CARRIER          PIC X.
   304         16  ELCERT-GROUPING         PIC X(6).
   305         16  ELCERT-STATE            PIC XX.
   306         16  ELCERT-ACCOUNT          PIC X(10).
   307         16  ELCERT-CERT-EFF-DT      PIC XX.
   308         16  ELCERT-CERT-NO.
   309             20  ELCERT-CERT-PRIME   PIC X(10).
   310             20  ELCERT-CERT-SFX     PIC X.
   311
   312     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   313     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   314     12  ELCRTO-KEY.
   315         16  ELCRTO-COMPANY-CD       PIC X.
   316         16  ELCRTO-CARRIER          PIC X.
   317         16  ELCRTO-GROUPING         PIC X(6).
   318         16  ELCRTO-STATE            PIC XX.
   319         16  ELCRTO-ACCOUNT          PIC X(10).
   320         16  ELCRTO-CERT-EFF-DT      PIC XX.
   321         16  ELCRTO-CERT-NO.
   322             20  ELCRTO-CERT-PRIME   PIC X(10).
   323             20  ELCRTO-CERT-SFX     PIC X.
   324         16  ELCRTO-RECORD-TYPE      PIC X.
   325         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   326
   327     12  ELCRTT-KEY.
   328         16  ELCRTT-PRIMARY          PIC X(33).
   329         16  ELCRTT-REC-TYPE         PIC X(1).
   330     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   331     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   332
   333     12  ERPNDB-KEY.
   334         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   335         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   336         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   337         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   338             ERPNDB-BATCH-SEQ-NO     PIC XX.
   339         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   340
   341     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   342     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   343     12  ELLETR-KEY.
   344         16  LETR-COMPANY-CD     PIC X.
   345         16  LETR-LETTER-ID      PIC X(4).
   346         16  LETR-FILLER         PIC X(8).
   347         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   348     12  ERPNDM-KEY.
   349         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   350         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   351         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   352         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   353
   354*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   355     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   356*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   357     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   358
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   8
* EL6311.cbl
   359     12  ERPNDB-ALT-KEY.
   360         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   361         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   362         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   363         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   364         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   365         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   366         16  ERPNDB-CERT-NO.
   367             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   368             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   369         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   370         16  ERPNDB-RECORD-TYPE      PIC X.
   371
   372      12  ERPNDB-CSR-KEY.
   373          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   374          20  ERPNDB-CSR-ID                PIC X(4).
   375          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   376          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   377          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   378
   379     12  ERNOTE-KEY.
   380         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   381         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   382         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   383         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   384         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   385         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   386         16  ERNOTE-CERT-NO.
   387             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   388             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   389
   390     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   391     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   392
   393     12  ERCNOT-KEY.
   394         16  ERCNOT-PART-KEY.
   395             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   396             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   397             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   398             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   399             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   400             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   401             20  ERCNOT-CERT-NO.
   402                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   403                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   404         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   405         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   406
   407     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   408     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   409
   410     12  ERMAIL-KEY.
   411         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   412         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   413         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   414         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   415         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   416         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page   9
* EL6311.cbl
   417         16  ERMAIL-CERT-NO.
   418             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   419             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   420
   421     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   422     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   423
   424     12  ERRQST-KEY.
   425         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   426         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   427
   428     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   429     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   430
   431     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   432
   433     12  ERLOFC-KEY.
   434         16  ERLOFC-COMPANY-CD          PIC  X.
   435         16  ERLOFC-CARRIER             PIC  X.
   436         16  ERLOFC-GROUPING            PIC  X(6).
   437         16  ERLOFC-STATE               PIC  XX.
   438         16  ERLOFC-ACCOUNT             PIC  X(10).
   439         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   440*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   441
   442     12  ERACCT-KEY.
   443         16  ERACCT-COMPANY-CD          PIC  X.
   444         16  ERACCT-CARRIER             PIC  X.
   445         16  ERACCT-GROUPING            PIC  X(6).
   446         16  ERACCT-STATE               PIC  XX.
   447         16  ERACCT-ACCOUNT             PIC  X(10).
   448         16  ERACCT-EXP-DT.
   449             20  ERACCT-DT              PIC  XX.
   450             20  ERACCT-FILL            PIC  X(4).
   451
   452     12  ERENDT-KEY.
   453         16  ENDT-COMPANY-CD       PIC X.
   454         16  ENDT-CARRIER          PIC X.
   455         16  ENDT-GROUPING         PIC X(6).
   456         16  ENDT-STATE            PIC XX.
   457         16  ENDT-ACCOUNT          PIC X(10).
   458         16  ENDT-CERT-EFF-DT      PIC XX.
   459         16  ENDT-CERT-PRIME       PIC X(10).
   460         16  ENDT-CERT-SFX         PIC X.
   461         16  ENDT-RECORD-TYPE      PIC X.
   462         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   463
   464 01  WS-ELMSTR-WORK.
   465     12  ELMSTR-KEY.
   466         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   467         16  MSTR-CERT-NO.
   468             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   469             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   470     12  W-CLAIM-KEY.
   471         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   472         16  W-CL-CERT-NO.
   473             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   474             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  10
* EL6311.cbl
   475      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   476 01  CANCEL-GEN-PASS-AREA.
   477     05  CG-OPTION-CODE          PIC X.
   478         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   479         88  CG-FLAT-CANCEL        VALUE '1'.
   480         88  CG-CANCEL             VALUE '2'.
   481         88  CG-CANCEL-REISSUE     VALUE '3'.
   482     05  CG-ERROR-CODE           PIC 99.
   483         88  CG-SUCCESS            VALUE 00.
   484         88  CG-DATE-ERROR         VALUE 01.
   485         88  CG-CERT-NOT-FOUND     VALUE 02.
   486         88  CG-AMOUNT-ERROR       VALUE 04.
   487         88  CG-OPTION-ERROR       VALUE 05.
   488         88  CG-PREV-CAN           VALUE 06.
   489         88  CG-INVALID-DATA       VALUE 07.
   490         88  CG-NO-ACCT-MSTR       VALUE 08.
   491         88  CG-SFX-A-EXIST        VALUE 09.
   492         88  CG-MISC-ERROR         VALUE 99.
   493     05  CG-COMPANY-ID           PIC XXX.
   494     05  CG-PROC-ID              PIC XXXX.
   495     05  CG-CURRENT-DT           PIC XX.
   496     05  CG-MONTH-END-DT         PIC XX.
   497     05  CG-CERT-KEY.
   498         10  CG-CERT-COMPANY-CD  PIC X.
   499         10  CG-CERT-CARRIER     PIC X.
   500         10  CG-CERT-GROUP       PIC X(6).
   501         10  CG-CERT-STATE       PIC XX.
   502         10  CG-CERT-ACCOUNT     PIC X(10).
   503         10  CG-CERT-EFF-DT      PIC XX.
   504         10  CG-CERT-CERT-NO     PIC X(11).
   505     05  CG-LF-CAN-DATA.
   506         10  CG-LF-CAN-DT        PIC XX.
   507         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   508     05  CG-AH-CAN-DATA.
   509         10  CG-AH-CAN-DT        PIC XX.
   510         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   511     05  CG-CERT-PROFILE-DATA.
   512         10  CG-INS-LNAME        PIC X(15).
   513         10  CG-INS-FNAME        PIC X(10).
   514         10  CG-INS-MID-INIT     PIC X.
   515         10  CG-INS-AGE          PIC 99.
   516         10  CG-JNT-LNAME        PIC X(15).
   517         10  CG-JNT-FNAME        PIC X(10).
   518         10  CG-JNT-MID-INIT     PIC X.
   519         10  CG-JNT-AGE          PIC 99.
   520     05  CG-LF-ISS-DATA.
   521         10  CG-LF-BENCD         PIC XX.
   522         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   523         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   524     05  CG-AH-ISS-DATA.
   525         10  CG-AH-BENCD         PIC XX.
   526         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   527     05  CG-BATCH-NO             PIC X(6).
   528     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   529     05  FILLER                  PIC X(306).
   530******************************************************************
   531*                                                                *
   532*            G E N E R A L   W O R K   A R E A                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  11
* EL6311.cbl
   533*                                                                *
   534******************************************************************
   535
   536 01  WORK-AREA.
   537     12  WS-RESPONSE             PIC S9(8)   COMP.
   538         88  RESP-NORMAL                  VALUE +00.
   539         88  RESP-NOTFND                  VALUE +13.
   540         88  RESP-DUPREC                  VALUE +14.
   541         88  RESP-DUPKEY                  VALUE +15.
   542         88  RESP-NOTOPEN                 VALUE +19.
   543         88  RESP-ENDFILE                 VALUE +20.
   544     12  DEEDIT-FIELD            PIC X(15).
   545     12  FILLER          REDEFINES DEEDIT-FIELD.
   546         16  FILLER              PIC X(4).
   547         16  DEEDIT-FIELD-X11    PIC X(11).
   548     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   549                                 PIC S9(15).
   550     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   551                                 PIC S9(13)V99.
   552     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   553                                 PIC S9(11)V9999.
   554     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   555     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   556     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   557         16  WS-CALC-TERM-WHOLE  PIC S999.
   558         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   559
   560     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   561     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   562         16  WS-HR-MINS          PIC 99V99.
   563         16  FILLER              PIC XX.
   564
   565     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   566     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   567
   568     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   569     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   570
   571     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   572     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   573     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   574     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   575     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   576     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   577     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   578
   579     12  QID.
   580         16  QID-TERM            PIC X(4).
   581         16  FILLER              PIC X(4)    VALUE '607B'.
   582
   583     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   584         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   585
   586     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   587         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   588
   589     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   590         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  12
* EL6311.cbl
   591
   592     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   593
   594     12  WS-NUMERIC-SW           PIC X.
   595        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   596
   597     12  WS-EDIT-CSO-FIELD.
   598         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   599                                 PIC X.
   600
   601     12  WS-SAVE-INPUT-FIELDS.
   602         16  WS-BAGE             PIC 99       VALUE ZERO.
   603*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   604         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   605         16  FILLER REDEFINES WS-BAPR.
   606             20  WS-APR-WHOLE-NUM    PIC 99.
   607             20  WS-APR-DEC          PIC 9999.
   608         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   609         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   610
   611         16  WS-B-COVERAGE OCCURS 2 TIMES.
   612             20  WS-TERM-IN-DAYS-SW  PIC X.
   613                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   614             20  WS-BTERM        PIC 999       COMP-3.
   615             20  WS-BALT-TERM    PIC 999       COMP-3.
   616             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   617             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   618             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   619             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   620             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   621             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   622
   623         16  WS-C-FIELDS COMP-3.
   624             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   625             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   626             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   627
   628         16  WS-D-FIELDS COMP-3.
   629             20  WS-DRISS        PIC S9(5)    VALUE +0.
   630             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   631             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   632             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   633             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   634             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   635
   636     12  WS-SAVE-BIRTH-DATE.
   637         16  FILLER              PIC X(4)   VALUE SPACES.
   638         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   639
   640     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   641     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   642     12  FILLER REDEFINES WS-WORK-BIN-RED.
   643         16  FILLER              PIC X(02).
   644         16  WS-WORK-BIN-DT      PIC X(02).
   645     12  WS-SW-1                 PIC X     VALUE SPACE.
   646     12  WS-SW-2                 PIC X     VALUE SPACE.
   647     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   648         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  13
* EL6311.cbl
   649     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   650         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   651
   652     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   653     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   654     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   655     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   656     12  WS-CONVERTED-CANCEL-DATES.
   657         16  WS-CONVERTED-CANDT1                  PIC XX.
   658         16  WS-CONVERTED-CANDT2                  PIC XX.
   659
   660     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   661
   662     12  WS-REC-FOUND-SW         PIC X.
   663         88  RECORD-NOT-FOUND    VALUE 'N'.
   664
   665     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   666         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   667         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   668
   669     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   670         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   671         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   672
   673     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   674         88  BROWSE-STARTED      VALUE 'Y'.
   675
   676     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   677         88  FIRST-TIME          VALUE 'Y'.
   678
   679     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   680         88  FIRST-ENTRY         VALUE 'Y'.
   681
   682     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   683         88  REC-BILLED          VALUE 'Y'.
   684
   685     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   686         88  NO-CURSOR-SET       VALUE +0.
   687         88  CURSOR-SET          VALUE +1.
   688
   689     12  WS-ERR-SW               PIC X.
   690         88  STD-ERRORS          VALUE 'S'.
   691         88  TRN-ERRORS          VALUE 'T'.
   692
   693     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   694         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   695
   696     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   697         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   698
   699     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   700         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   701
   702     12  WS-ERR-CODE.
   703         16  FILLER              PIC 99.
   704         16  WS-ERROR-SUB        PIC 99.
   705
   706     12  WS-DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  14
* EL6311.cbl
   707         16  WS-WORK-MM          PIC XX.
   708         16  WS-WORK-DD          PIC XX.
   709         16  WS-WORK-YY          PIC XX.
   710
   711     12  WS-MM-YY.
   712         16  WS-MM               PIC XX.
   713         16  FILLER              PIC X     VALUE '/'.
   714         16  WS-YY               PIC XX.
   715
   716     12  WS-CERT-EFF-DT          PIC XX.
   717
   718     12  WS-MEMBER-NO            PIC X(12).
   719     12  FILLER  REDEFINES  WS-MEMBER-NO.
   720         16  WS-MEMBER-NO-1-8    PIC 9(8).
   721         16  FILLER              PIC X(4).
   722
   723     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   724
   725     12  WS-ERPNDB-ALT-KEY.
   726         16  WS-PB-COMPANY-CD-A1         PIC X.
   727         16  WS-PB-CARRIER               PIC X.
   728         16  WS-PB-GROUPING              PIC X(6).
   729         16  WS-PB-STATE                 PIC XX.
   730         16  WS-PB-ACCOUNT               PIC X(10).
   731         16  WS-PB-CERT-EFF-DT           PIC XX.
   732         16  WS-PB-CERT-NO.
   733             20  WS-PB-CERT-PRIME        PIC X(10).
   734             20  WS-PB-CERT-SFX          PIC X.
   735         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   736         16  WS-PB-RECORD-TYPE           PIC X.
   737
   738     12  WS-SHOW-SAVE-AREAS.
   739         16  WS-NEW-CERT-NO.
   740             20  WS-NEW-PRIME    PIC X(10).
   741             20  WS-NEW-SUFFIX   PIC X.
   742         16  WS-NEW-CERT-EFF-DT  PIC XX.
   743         16  WS-NEW-RECORD-TYPE  PIC X.
   744         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   745             88   SHOW-RECORD            VALUE 'Y'.
   746
   747     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   748
   749     12  WS-BATCH-NO.
   750         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   751         16  FILLER              PIC X(5) VALUE SPACES.
   752
   753     12  WS-FIRST-NAME.
   754         16  WS-1ST-INIT         PIC X.
   755         16  FILLER              PIC X(9).
   756
   757     12  WS-INITIALS.
   758         16  WS-INITIAL-1        PIC X.
   759         16  WS-INITIAL-2        PIC X.
   760
   761     12  WS-C-HDG.
   762         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   763         16  FILLER              PIC X(4) VALUE '-REF'.
   764
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  15
* EL6311.cbl
   765     12  WS-D-PREM-HDG.
   766         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   767         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   768
   769     12  WS-D-REFUND-HDG.
   770         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   771         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   772
   773     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   774
   775     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   776     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   777     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   778     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   779     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   780     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   781     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   782
   783     12  WS-01-CANCEL-ERR        PIC X(25)
   784         VALUE 'CANCEL DATE ERROR'.
   785     12  WS-02-CANCEL-ERR        PIC X(25)
   786         VALUE 'CERT NOT FOUND'.
   787     12  WS-04-CANCEL-ERR        PIC X(25)
   788         VALUE 'CANCEL AMOUNT ERROR'.
   789     12  WS-05-CANCEL-ERR        PIC X(25)
   790         VALUE 'CANCEL OPTION ERROR'.
   791     12  WS-06-CANCEL-ERR        PIC X(25)
   792         VALUE 'PREVIOUSLY CANCELLED'.
   793     12  WS-07-CANCEL-ERR        PIC X(25)
   794         VALUE 'INVALID DATA'.
   795     12  WS-08-CANCEL-ERR        PIC X(25)
   796         VALUE 'NO ACCOUNT MASTER'.
   797     12  WS-09-CANCEL-ERR        PIC X(25)
   798         VALUE 'SUFFIX ALREADY EXISTS'.
   799     12  WS-99-CANCEL-ERR        PIC X(25)
   800         VALUE 'MISC CANCEL ERROR'.
   801
   802     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   803     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   804
   805     12  WS-AGE-FIELDS.
   806         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   807         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   808         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   809         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   810
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  16
* EL6311.cbl
   812
   813******************************************************************
   814*                                                                *
   815*                 B A T C H   T O T A L S                        *
   816*                                                                *
   817******************************************************************
   818
   819     12  WS-BATCH-RECORD.
   820         16  FILLER                       PIC X(10).
   821         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   822         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   823         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   824         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   825         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   826         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   827         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   828         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   829         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   830         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   831         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   832         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   833         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   834         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   835         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   836         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   837         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   838         16  WS-ACCOUNT-NAME              PIC X(30).
   839         16  FILLER                       PIC X.
   840         16  WS-REFERENCE                 PIC X(12).
   841         16  FILLER                       PIC X(197).
   842
   843     12  WS-BATCH-TOTALS.
   844         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   845         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   846         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   847         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   848         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   849         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   850         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   851         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   852         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   853         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   854         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   855         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   856         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   858         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   859         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   861         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   862         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   863
   864     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   865
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  17
* EL6311.cbl
   867
   868******************************************************************
   869*                                                                *
   870*                E R R O R   M E S S A G E S                     *
   871*                                                                *
   872******************************************************************
   873
   874 01  ERROR-MESSAGES.
   875     12  ER-0004                 PIC  9(4) VALUE 0004.
   876     12  ER-0008                 PIC  9(4) VALUE 0008.
   877     12  ER-0023                 PIC  9(4) VALUE 0023.
   878     12  ER-0029                 PIC  9(4) VALUE 0029.
   879     12  ER-0033                 PIC  9(4) VALUE 0033.
   880     12  ER-0070                 PIC  9(4) VALUE 0070.
   881     12  ER-0220                 PIC  9(4) VALUE 0220.
   882     12  ER-0248                 PIC  9(4) VALUE 0248.
   883     12  ER-0280                 PIC  9(4) VALUE 0280.
   884     12  ER-0348                 PIC  9(4) VALUE 0348.
   885     12  ER-0582                 PIC  9(4) VALUE 0582.
   886     12  ER-0877                 PIC  9(4) VALUE 0877.
   887     12  ER-1236                 PIC  9(4) VALUE 1236.
   888     12  ER-1570                 PIC  9(4) VALUE 1570.
   889     12  ER-1575                 PIC  9(4) VALUE 1575.
   890     12  ER-1609                 PIC  9(4) VALUE 1609.
   891     12  ER-1819                 PIC  9(4) VALUE 1819.
   892     12  ER-2129                 PIC  9(4) VALUE 2129.
   893     12  ER-2188                 PIC  9(4) VALUE 2188.
   894     12  ER-2192                 PIC  9(4) VALUE 2192.
   895     12  ER-2196                 PIC  9(4) VALUE 2196.
   896     12  ER-2197                 PIC  9(4) VALUE 2197.
   897     12  ER-2198                 PIC  9(4) VALUE 2198.
   898     12  ER-2200                 PIC  9(4) VALUE 2200.
   899     12  ER-2212                 PIC  9(4) VALUE 2212.
   900     12  ER-2218                 PIC  9(4) VALUE 2218.
   901     12  ER-2220                 PIC  9(4) VALUE 2220.
   902     12  ER-2222                 PIC  9(4) VALUE 2222.
   903     12  ER-2223                 PIC  9(4) VALUE 2223.
   904     12  ER-2224                 PIC  9(4) VALUE 2224.
   905     12  ER-2225                 PIC  9(4) VALUE 2225.
   906     12  ER-2226                 PIC  9(4) VALUE 2226.
   907     12  ER-2227                 PIC  9(4) VALUE 2227.
   908     12  ER-2228                 PIC  9(4) VALUE 2228.
   909     12  ER-2240                 PIC  9(4) VALUE 2240.
   910     12  ER-2241                 PIC  9(4) VALUE 2241.
   911     12  ER-2242                 PIC  9(4) VALUE 2242.
   912     12  ER-2243                 PIC  9(4) VALUE 2243.
   913     12  ER-2244                 PIC  9(4) VALUE 2244.
   914     12  ER-2245                 PIC  9(4) VALUE 2245.
   915     12  ER-2246                 PIC  9(4) VALUE 2246.
   916     12  ER-2247                 PIC  9(4) VALUE 2247.
   917     12  ER-2251                 PIC  9(4) VALUE 2251.
   918     12  ER-2252                 PIC  9(4) VALUE 2252.
   919     12  ER-2253                 PIC  9(4) VALUE 2253.
   920     12  ER-2254                 PIC  9(4) VALUE 2254.
   921     12  ER-2255                 PIC  9(4) VALUE 2255.
   922     12  ER-2256                 PIC  9(4) VALUE 2256.
   923     12  ER-2257                 PIC  9(4) VALUE 2257.
   924     12  ER-2258                 PIC  9(4) VALUE 2258.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  18
* EL6311.cbl
   925     12  ER-2259                 PIC  9(4) VALUE 2259.
   926     12  ER-2260                 PIC  9(4) VALUE 2260.
   927     12  ER-2261                 PIC  9(4) VALUE 2261.
   928     12  ER-2287                 PIC  9(4) VALUE 2287.
   929     12  ER-2336                 PIC  9(4) VALUE 2336.
   930     12  ER-2337                 PIC  9(4) VALUE 2337.
   931     12  ER-2437                 PIC  9(4) VALUE 2437.
   932     12  ER-2471                 PIC  9(4) VALUE 2471.
   933     12  ER-2530                 PIC  9(4) VALUE 2530.
   934     12  ER-2531                 PIC  9(4) VALUE 2531.
   935     12  ER-2532                 PIC  9(4) VALUE 2532.
   936     12  ER-2533                 PIC  9(4) VALUE 2533.
   937     12  ER-2547                 PIC  9(4) VALUE 2547.
   938     12  ER-2591                 PIC  9(4) VALUE 2591.
   939     12  ER-2592                 PIC  9(4) VALUE 2592.
   940     12  ER-2593                 PIC  9(4) VALUE 2593.
   941     12  ER-2600                 PIC  9(4) VALUE 2600.
   942     12  ER-2601                 PIC  9(4) VALUE 2601.
   943     12  ER-2604                 PIC  9(4) VALUE 2604.
   944     12  ER-2605                 PIC  9(4) VALUE 2605.
   945     12  ER-2606                 PIC  9(4) VALUE 2606.
   946     12  ER-2607                 PIC  9(4) VALUE 2607.
   947     12  ER-2622                 PIC  9(4) VALUE 2622.
   948     12  ER-2625                 PIC  9(4) VALUE 2625.
   949     12  ER-2626                 PIC  9(4) VALUE 2626.
   950     12  ER-2627                 PIC  9(4) VALUE 2627.
   951     12  ER-2628                 PIC  9(4) VALUE 2628.
   952     12  ER-2629                 PIC  9(4) VALUE 2629.
   953     12  ER-2630                 PIC  9(4) VALUE 2630.
   954     12  ER-2631                 PIC  9(4) VALUE 2631.
   955     12  ER-2632                 PIC  9(4) VALUE 2632.
   956     12  ER-2633                 PIC  9(4) VALUE 2633.
   957     12  ER-2634                 PIC  9(4) VALUE 2634.
   958     12  ER-2635                 PIC  9(4) VALUE 2635.
   959     12  ER-2636                 PIC  9(4) VALUE 2636.
   960     12  ER-2639                 PIC  9(4) VALUE 2639.
   961     12  ER-2640                 PIC  9(4) VALUE 2640.
   962     12  ER-2647                 PIC  9(4) VALUE 2647.
   963     12  ER-2648                 PIC  9(4) VALUE 2648.
   964     12  ER-2649                 PIC  9(4) VALUE 2649.
   965     12  ER-2650                 PIC  9(4) VALUE 2650.
   966     12  ER-2653                 PIC  9(4) VALUE 2653.
   967     12  ER-2654                 PIC  9(4) VALUE 2654.
   968     12  ER-2655                 PIC  9(4) VALUE 2655.
   969     12  ER-2656                 PIC  9(4) VALUE 2656.
   970     12  ER-2657                 PIC  9(4) VALUE 2657.
   971     12  ER-2660                 PIC  9(4) VALUE 2660.
   972     12  ER-2662                 PIC  9(4) VALUE 2662.
   973     12  ER-2663                 PIC  9(4) VALUE 2663.
   974     12  ER-2664                 PIC  9(4) VALUE 2664.
   975     12  ER-2667                 PIC  9(4) VALUE 2667.
   976     12  ER-2668                 PIC  9(4) VALUE 2668.
   977     12  ER-2669                 PIC  9(4) VALUE 2669.
   978     12  ER-2670                 PIC  9(4) VALUE 2670.
   979     12  ER-2671                 PIC  9(4) VALUE 2671.
   980     12  ER-2672                 PIC  9(4) VALUE 2672.
   981     12  ER-2673                 PIC  9(4) VALUE 2673.
   982     12  ER-2677                 PIC  9(4) VALUE 2677.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  19
* EL6311.cbl
   983     12  ER-2678                 PIC  9(4) VALUE 2678.
   984     12  ER-2679                 PIC  9(4) VALUE 2679.
   985     12  ER-2680                 PIC  9(4) VALUE 2680.
   986     12  ER-2681                 PIC  9(4) VALUE 2681.
   987     12  ER-2682                 PIC  9(4) VALUE 2682.
   988     12  ER-2683                 PIC  9(4) VALUE 2683.
   989     12  ER-2684                 PIC  9(4) VALUE 2684.
   990     12  ER-2686                 PIC  9(4) VALUE 2686.
   991     12  ER-2689                 PIC  9(4) VALUE 2689.
   992     12  ER-2690                 PIC  9(4) VALUE 2690.
   993     12  ER-2693                 PIC  9(4) VALUE 2693.
   994     12  ER-2695                 PIC  9(4) VALUE 2695.
   995     12  ER-2701                 PIC  9(4) VALUE 2701.
   996     12  ER-2720                 PIC  9(4) VALUE 2720.
   997     12  ER-2709                 PIC  9(4) VALUE 2709.
   998     12  ER-2704                 PIC  9(4) VALUE 2704.
   999     12  ER-2725                 PIC  9(4) VALUE 2725.
  1000     12  ER-2726                 PIC  9(4) VALUE 2726.
  1001     12  ER-2728                 PIC  9(4) VALUE 2728.
  1002     12  ER-2729                 PIC  9(4) VALUE 2729.
  1003     12  ER-2731                 PIC  9(4) VALUE 2731.
  1004     12  ER-2732                 PIC  9(4) VALUE 2732.
  1005     12  ER-2733                 PIC  9(4) VALUE 2733.
  1006     12  ER-2735                 PIC  9(4) VALUE 2735.
  1007     12  ER-2738                 PIC  9(4) VALUE 2738.
  1008     12  ER-2742                 PIC  9(4) VALUE 2742.
  1009     12  ER-2743                 PIC  9(4) VALUE 2743.
  1010     12  ER-2744                 PIC  9(4) VALUE 2744.
  1011     12  ER-2747                 PIC  9(4) VALUE 2747.
  1012     12  ER-2749                 PIC  9(4) VALUE 2749.
  1013     12  ER-2753                 PIC  9(4) VALUE 2753.
  1014     12  ER-2755                 PIC  9(4) VALUE 2755.
  1015     12  ER-2757                 PIC  9(4) VALUE 2757.
  1016     12  ER-2771                 PIC  9(4) VALUE 2771.
  1017     12  ER-2774                 PIC  9(4) VALUE 2774.
  1018     12  ER-2775                 PIC  9(4) VALUE 2775.
  1019     12  ER-2776                 PIC  9(4) VALUE 2776.
  1020     12  ER-2777                 PIC  9(4) VALUE 2777.
  1021     12  ER-2794                 PIC  9(4) VALUE 2794.
  1022     12  ER-2799                 PIC  9(4) VALUE 2799.
  1023     12  ER-2900                 PIC  9(4) VALUE 2900.
  1024     12  ER-2902                 PIC  9(4) VALUE 2902.
  1025     12  ER-2945                 PIC  9(4) VALUE 2945.
  1026     12  ER-3000                 PIC  9(4) VALUE 3000.
  1027     12  ER-3006                 PIC  9(4) VALUE 3006.
  1028     12  ER-3224                 PIC  9(4) VALUE 3224.
  1029     12  ER-3831                 PIC  9(4) VALUE 3831.
  1030     12  ER-3834                 PIC  9(4) VALUE 3834.
  1031     12  ER-3835                 PIC  9(4) VALUE 3835.
  1032     12  ER-4005                 PIC  9(4) VALUE 4005.
  1033     12  ER-7401                 PIC  9(4) VALUE 7401.
  1034     12  ER-7402                 PIC  9(4) VALUE 7402.
  1035     12  ER-7403                 PIC  9(4) VALUE 7403.
  1036     12  ER-7404                 PIC  9(4) VALUE 7404.
  1037     12  ER-7423                 PIC  9(4) VALUE 7423.
  1038     12  ER-7424                 PIC  9(4) VALUE 7424.
  1039     12  ER-7433                 PIC  9(4) VALUE 7433.
  1040     12  ER-7450                 PIC  9(4) VALUE 7450.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  20
* EL6311.cbl
  1041     12  ER-7451                 PIC  9(4) VALUE 7451.
  1042     12  ER-7530                 PIC  9(4) VALUE 7530.
  1043     12  ER-7573                 PIC  9(4) VALUE 7573.
  1044     12  ER-7631                 PIC  9(4) VALUE 7631.
  1045     12  ER-7632                 PIC  9(4) VALUE 7632.
  1046     12  ER-7633                 PIC  9(4) VALUE 7633.
  1047     12  ER-7537                 PIC  9(4) VALUE 7537.
  1048     12  ER-7538                 PIC  9(4) VALUE 7538.
  1049     12  ER-7574                 PIC  9(4) VALUE 7574.
  1050     12  ER-7997                 PIC  9(4) VALUE 7997.
  1051     12  ER-7998                 PIC  9(4) VALUE 7998.
  1052     12  ER-8148                 PIC  9(4) VALUE 8148.
  1053     12  ER-9841                 PIC  9(4) VALUE 9841.
  1054
  1055*                                COPY ELCTEXT.
  1056******************************************************************
  1057*                                                                *
  1058*                                                                *
  1059*                            ELCTEXT.                            *
  1060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1061*                            VMOD=2.008                          *
  1062*                                                                *
  1063*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1064*                                     FORM LETTERS,              *
  1065*                                     CERT FORM DISPLAY.
  1066*                                                                *
  1067*   FILE TYPE = VSAM,KSDS                                        *
  1068*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1069*                                                                *
  1070*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1071*       ALTERNATE INDEX = NONE                                   *
  1072*                                                                *
  1073*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1074*       ALTERNATE INDEX = NONE                                   *
  1075*                                                                *
  1076*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1077*       ALTERNATE INDEX = NONE                                   *
  1078*                                                                *
  1079*   LOG = NO                                                     *
  1080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1081******************************************************************
  1082 01  TEXT-FILES.
  1083     12  TEXT-FILE-ID                PIC XX.
  1084         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1085         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1086         88  HELP-FILE-TEXT             VALUE 'TH'.
  1087
  1088     12  TX-CONTROL-PRIMARY.
  1089         16  TX-COMPANY-CD           PIC X.
  1090             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1091         16  TX-ACCESS-CD-GENL       PIC X(12).
  1092
  1093         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1094             20  TX-LETTER-NO        PIC X(4).
  1095             20  FILLER              PIC X(8).
  1096
  1097         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1098             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  21
* EL6311.cbl
  1099
  1100         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1101             20  TX-HELP-TYPE        PIC X.
  1102                 88  HELP-FOR-GENERAL   VALUE ' '.
  1103                 88  HELP-BY-SCREEN     VALUE 'S'.
  1104                 88  HELP-BY-ERROR      VALUE 'E'.
  1105             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1106                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1107             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1108                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1109             20  FILLER              PIC X(4).
  1110
  1111         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1112
  1113     12  TX-PROCESS-CONTROL          PIC XX.
  1114         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1115
  1116     12  TX-TEXT-LINE                PIC X(70).
  1117
  1118     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1119         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1120         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1121         88  TX-VALID-FORM-SQUEEZE-VALUE
  1122                                        VALUE 'Y' ' '.
  1123
  1124     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1125         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1126         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1127         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1128         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1129         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1130         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1131         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1132                                              'K' 'N' ' '
  1133                                              'Z'.
  1134
  1135     12  TX-ARCHIVE-SW               PIC X.
  1136         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1137         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1138         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1139
  1140     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1141     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1142
  1143     12  TX-BSR-CODE                 PIC X.
  1144         88  TX-BSR-LETTER              VALUE 'B'.
  1145         88  TX-NON-BSR-LETTER          VALUE ' '.
  1146
  1147     12  FILLER                      PIC X.
  1148*****************************************************************
  1149*                                COPY ELCCRTO.
  1150******************************************************************
  1151*                                                                *
  1152*                            ELCCRTO.                            *
  1153*                                                                *
  1154*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1155*                                                                *
  1156*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  22
* EL6311.cbl
  1157*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1158*                                                                *
  1159*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1160*                                                                *
  1161*   LOG = YES                                                    *
  1162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1163******************************************************************
  1164*                   C H A N G E   L O G
  1165*
  1166* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1167*-----------------------------------------------------------------
  1168*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1169* EFFECTIVE    NUMBER
  1170*-----------------------------------------------------------------
  1171* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1172* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1173* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1174* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1175* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1176******************************************************************
  1177 01  ORIGINAL-CERTIFICATE.
  1178     12  OC-RECORD-ID                      PIC XX.
  1179         88  VALID-OC-ID                      VALUE 'OC'.
  1180     12  OC-CONTROL-PRIMARY.
  1181         16  OC-COMPANY-CD                 PIC X.
  1182         16  OC-CARRIER                    PIC X.
  1183         16  OC-GROUPING                   PIC X(6).
  1184         16  OC-STATE                      PIC XX.
  1185         16  OC-ACCOUNT                    PIC X(10).
  1186         16  OC-CERT-EFF-DT                PIC XX.
  1187         16  OC-CERT-NO.
  1188             20  OC-CERT-PRIME             PIC X(10).
  1189             20  OC-CERT-SFX               PIC X.
  1190         16  OC-RECORD-TYPE                PIC X.
  1191         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1192     12  OC-LAST-MAINT-DT                  PIC XX.
  1193     12  OC-LAST-MAINT-BY                  PIC X(4).
  1194     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1195     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1196     12  FILLER                            PIC X(49).
  1197     12  OC-ORIG-REC.
  1198         16  OC-INS-LAST-NAME              PIC X(15).
  1199         16  OC-INS-FIRST-NAME             PIC X(10).
  1200         16  OC-INS-MIDDLE-INIT            PIC X.
  1201         16  OC-INS-AGE                    PIC S999     COMP-3.
  1202         16  OC-JNT-LAST-NAME              PIC X(15).
  1203         16  OC-JNT-FIRST-NAME             PIC X(10).
  1204         16  OC-JNT-MIDDLE-INIT            PIC X.
  1205         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1206         16  OC-LF-BENCD                   PIC XX.
  1207         16  OC-LF-TERM                    PIC S999      COMP-3.
  1208         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1209         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1210         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1211         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1212         16  OC-LF-EXP-DT                  PIC XX.
  1213         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1214         16  OC-LF-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  23
* EL6311.cbl
  1215         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1216         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1217         16  OC-AH-BENCD                   PIC XX.
  1218         16  OC-AH-TERM                    PIC S999      COMP-3.
  1219         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1220         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1221         16  OC-AH-EXP-DT                  PIC XX.
  1222         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1223         16  OC-AH-CP                      PIC 99.
  1224         16  OC-AH-CANCEL-DT               PIC XX.
  1225         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1226         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1227         16  OC-CRED-BENE-NAME             PIC X(25).
  1228         16  OC-1ST-PMT-DT                 PIC XX.
  1229         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1230         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1231         16  OC-ISSUE-TRAN-IND             PIC X.
  1232         16  OC-CANCEL-TRAN-IND            PIC X.
  1233         16  FILLER                        PIC X(211).
  1234
  1235     12  FILLER                            PIC X(50).
  1236******************************************************************
  1237*                                COPY ERCACCT.
  1238******************************************************************
  1239*                                                                *
  1240*                                                                *
  1241*                            ERCACCT                             *
  1242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1243*                            VMOD=2.031                          *
  1244*                                                                *
  1245*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1246*                                                                *
  1247*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1248*   VSAM ACCOUNT MASTER FILES.                                   *
  1249*                                                                *
  1250*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1251*                                                                *
  1252*   FILE TYPE = VSAM,KSDS                                        *
  1253*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1254*                                                                *
  1255*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1256*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1257*                                                                *
  1258*   LOG = NO                                                     *
  1259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1260*                                                                *
  1261*                                                                *
  1262******************************************************************
  1263*                   C H A N G E   L O G
  1264*
  1265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1266*-----------------------------------------------------------------
  1267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1268* EFFECTIVE    NUMBER
  1269*-----------------------------------------------------------------
  1270* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1271* 092705    2005050300006  PEMA  ADD SPP LEASES
  1272* 022808    2007083100002  PEMA  ADD FREEZE STATUS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  24
* EL6311.cbl
  1273* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1274* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1275* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1276* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1277******************************************************************
  1278
  1279 01  ACCOUNT-MASTER.
  1280     12  AM-RECORD-ID                      PIC XX.
  1281         88  VALID-AM-ID                      VALUE 'AM'.
  1282
  1283     12  AM-CONTROL-PRIMARY.
  1284         16  AM-COMPANY-CD                 PIC X.
  1285         16  AM-MSTR-CNTRL.
  1286             20  AM-CONTROL-A.
  1287                 24  AM-CARRIER            PIC X.
  1288                 24  AM-GROUPING.
  1289                     28 AM-GROUPING-PREFIX PIC XXX.
  1290                     28 AM-GROUPING-PRIME  PIC XXX.
  1291                 24  AM-STATE              PIC XX.
  1292                 24  AM-ACCOUNT.
  1293                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1294                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1295             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1296                                           PIC X(19).
  1297             20  AM-CNTRL-B.
  1298                 24  AM-EXPIRATION-DT      PIC XX.
  1299                 24  FILLER                PIC X(4).
  1300             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1301                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1302
  1303     12  AM-CONTROL-BY-VAR-GRP.
  1304         16  AM-COMPANY-CD-A1              PIC X.
  1305         16  AM-VG-CARRIER                 PIC X.
  1306         16  AM-VG-GROUPING                PIC X(6).
  1307         16  AM-VG-STATE                   PIC XX.
  1308         16  AM-VG-ACCOUNT                 PIC X(10).
  1309         16  AM-VG-DATE.
  1310             20  AM-VG-EXPIRATION-DT       PIC XX.
  1311             20  FILLER                    PIC X(4).
  1312         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1313                                           PIC 9(11)      COMP-3.
  1314     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1315         16  FILLER                        PIC X(10).
  1316         16  AM-VG-KEY3.
  1317             20  AM-VG3-ACCOUNT            PIC X(10).
  1318             20  AM-VG3-EXP-DT             PIC XX.
  1319         16  FILLER                        PIC X(4).
  1320     12  AM-MAINT-INFORMATION.
  1321         16  AM-LAST-MAINT-DT              PIC XX.
  1322         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1323         16  AM-LAST-MAINT-USER            PIC X(4).
  1324         16  FILLER                        PIC XX.
  1325
  1326     12  AM-EFFECTIVE-DT                   PIC XX.
  1327     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1328
  1329     12  AM-PREV-DATES  COMP-3.
  1330         16  AM-PREV-EXP-DT                PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  25
* EL6311.cbl
  1331         16  AM-PREV-EFF-DT                PIC 9(11).
  1332
  1333     12  AM-REPORT-CODE-1                  PIC X(10).
  1334     12  AM-REPORT-CODE-2                  PIC X(10).
  1335
  1336     12  AM-CITY-CODE                      PIC X(4).
  1337     12  AM-COUNTY-PARISH                  PIC X(6).
  1338
  1339     12  AM-NAME                           PIC X(30).
  1340     12  AM-PERSON                         PIC X(30).
  1341     12  AM-ADDRS                          PIC X(30).
  1342     12  AM-CITY.
  1343         16  AM-ADDR-CITY                  PIC X(28).
  1344         16  AM-ADDR-STATE                 PIC XX.
  1345     12  AM-ZIP.
  1346         16  AM-ZIP-PRIME.
  1347             20  AM-ZIP-PRI-1ST            PIC X.
  1348                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1349             20  FILLER                    PIC X(4).
  1350         16  AM-ZIP-PLUS4                  PIC X(4).
  1351     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1352         16  AM-CAN-POSTAL-1               PIC XXX.
  1353         16  AM-CAN-POSTAL-2               PIC XXX.
  1354         16  FILLER                        PIC XXX.
  1355     12  AM-TEL-NO.
  1356         16  AM-AREA-CODE                  PIC 999.
  1357         16  AM-TEL-PRE                    PIC 999.
  1358         16  AM-TEL-NBR                    PIC 9(4).
  1359     12  AM-TEL-LOC                        PIC X.
  1360         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1361         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1362
  1363     12  AM-COMM-STRUCTURE.
  1364         16  AM-DEFN-1.
  1365             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1366                 24  AM-AGT.
  1367                     28  AM-AGT-PREFIX     PIC X(4).
  1368                     28  AM-AGT-PRIME      PIC X(6).
  1369                 24  AM-COM-TYP            PIC X.
  1370                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1371                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1372                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1373                 24  AM-RECALC-LV-INDIC    PIC X.
  1374                 24  AM-RETRO-LV-INDIC     PIC X.
  1375                 24  AM-GL-CODES           PIC X.
  1376                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1377                 24  FILLER                PIC X(01).
  1378         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1379             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1380                 24  FILLER                PIC X(11).
  1381                 24  AM-L-COMA             PIC XXX.
  1382                 24  AM-J-COMA             PIC XXX.
  1383                 24  AM-A-COMA             PIC XXX.
  1384                 24  FILLER                PIC X(6).
  1385
  1386     12  AM-COMM-CHANGE-STATUS             PIC X.
  1387         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1388
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  26
* EL6311.cbl
  1389     12  AM-CSR-CODE                       PIC X(4).
  1390
  1391     12  AM-BILLING-STATUS                 PIC X.
  1392         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1393         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1394     12  AM-AUTO-REFUND-SW                 PIC X.
  1395         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1396         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1397     12  AM-GPCD                           PIC 99.
  1398     12  AM-IG                             PIC X.
  1399         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1400         88  AM-HAS-GROUP                     VALUE '2'.
  1401     12  AM-STATUS                         PIC X.
  1402         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1403         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1404         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1405         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1406         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1407         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1408     12  AM-REMIT-TO                       PIC 99.
  1409     12  AM-ID-NO                          PIC X(11).
  1410
  1411     12  AM-CAL-TABLE                      PIC XX.
  1412     12  AM-LF-DEVIATION                   PIC XXX.
  1413     12  AM-AH-DEVIATION                   PIC XXX.
  1414     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1415     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1416     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1417     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1418     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1419     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1420
  1421     12  AM-USER-FIELDS.
  1422         16  AM-FLD-1                      PIC XX.
  1423         16  AM-FLD-2                      PIC XX.
  1424         16  AM-FLD-3                      PIC XX.
  1425         16  AM-FLD-4                      PIC XX.
  1426         16  AM-FLD-5                      PIC XX.
  1427
  1428     12  AM-1ST-PROD-DATE.
  1429         16  AM-1ST-PROD-YR                PIC XX.
  1430         16  AM-1ST-PROD-MO                PIC XX.
  1431         16  AM-1ST-PROD-DA                PIC XX.
  1432     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1433     12  AM-CERTS-PURGED-DATE.
  1434         16  AM-PUR-YR                     PIC XX.
  1435         16  AM-PUR-MO                     PIC XX.
  1436         16  AM-PUR-DA                     PIC XX.
  1437     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1438     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1439     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1440     12  AM-INACTIVE-DATE.
  1441         16  AM-INA-MO                     PIC 99.
  1442         16  AM-INA-DA                     PIC 99.
  1443         16  AM-INA-YR                     PIC 99.
  1444     12  AM-AR-HI-CERT-DATE                PIC XX.
  1445
  1446     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  27
* EL6311.cbl
  1447     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1448
  1449     12  AM-OB-PAYMENT-MODE                PIC X.
  1450         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1451         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1452         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1453         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1454
  1455     12  AM-AH-ONLY-INDICATOR              PIC X.
  1456         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1457         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1458
  1459     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1460
  1461     12  AM-OVER-SHORT.
  1462         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1463         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1464
  1465     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1466     12  AM-DCC-CLP-STATE                  PIC XX.
  1467
  1468     12  AM-RECALC-COMM                    PIC X.
  1469     12  AM-RECALC-REIN                    PIC X.
  1470
  1471     12  AM-REI-TABLE                      PIC XXX.
  1472     12  AM-REI-ET-LF                      PIC X.
  1473     12  AM-REI-ET-AH                      PIC X.
  1474     12  AM-REI-PE-LF                      PIC X.
  1475     12  AM-REI-PE-AH                      PIC X.
  1476     12  AM-REI-PRT-ST                     PIC X.
  1477     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1478     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1479     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1480     12  AM-REI-GROUP-A                    PIC X(6).
  1481     12  AM-REI-MORT                       PIC X(4).
  1482     12  AM-REI-PRT-OW                     PIC X.
  1483     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1484     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1485     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1486     12  AM-REI-GROUP-B                    PIC X(6).
  1487
  1488     12  AM-TRUST-TYPE                     PIC X(2).
  1489
  1490     12  AM-EMPLOYER-STMT-USED             PIC X.
  1491     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1492
  1493     12  AM-STD-AH-TYPE                    PIC XX.
  1494     12  AM-EARN-METHODS.
  1495         16  AM-EARN-METHOD-R              PIC X.
  1496             88 AM-REF-RL-R78                 VALUE 'R'.
  1497             88 AM-REF-RL-PR                  VALUE 'P'.
  1498             88 AM-REF-RL-MEAN                VALUE 'M'.
  1499             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1500         16  AM-EARN-METHOD-L              PIC X.
  1501             88 AM-REF-LL-R78                 VALUE 'R'.
  1502             88 AM-REF-LL-PR                  VALUE 'P'.
  1503             88 AM-REF-LL-MEAN                VALUE 'M'.
  1504             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  28
* EL6311.cbl
  1505         16  AM-EARN-METHOD-A              PIC X.
  1506             88 AM-REF-AH-R78                 VALUE 'R'.
  1507             88 AM-REF-AH-PR                  VALUE 'P'.
  1508             88 AM-REF-AH-MEAN                VALUE 'M'.
  1509             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1510             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1511             88 AM-REF-AH-NET                 VALUE 'N'.
  1512
  1513     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1514     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1515     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1516
  1517     12  AM-RET-Y-N                        PIC X.
  1518     12  AM-RET-P-E                        PIC X.
  1519     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1520     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1521     12  AM-RET-GRP                        PIC X(6).
  1522     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1523         16  AM-POOL-PRIME                 PIC XXX.
  1524         16  AM-POOL-SUB                   PIC XXX.
  1525     12  AM-RETRO-EARNINGS.
  1526         16  AM-RET-EARN-R                 PIC X.
  1527         16  AM-RET-EARN-L                 PIC X.
  1528         16  AM-RET-EARN-A                 PIC X.
  1529     12  AM-RET-ST-TAX-USE                 PIC X.
  1530         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1531         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1532     12  AM-RETRO-BEG-EARNINGS.
  1533         16  AM-RET-BEG-EARN-R             PIC X.
  1534         16  AM-RET-BEG-EARN-L             PIC X.
  1535         16  AM-RET-BEG-EARN-A             PIC X.
  1536     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1537     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1538
  1539     12  AM-USER-SELECT-OPTIONS.
  1540         16  AM-USER-SELECT-1              PIC X(10).
  1541         16  AM-USER-SELECT-2              PIC X(10).
  1542         16  AM-USER-SELECT-3              PIC X(10).
  1543         16  AM-USER-SELECT-4              PIC X(10).
  1544         16  AM-USER-SELECT-5              PIC X(10).
  1545
  1546     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1547
  1548     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1549
  1550     12  AM-RPT045A-SWITCH                 PIC X.
  1551         88  RPT045A-OFF                   VALUE 'N'.
  1552
  1553     12  AM-INSURANCE-LIMITS.
  1554         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1555         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1556
  1557     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1558         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1559
  1560     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1561         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1562         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  29
* EL6311.cbl
  1563
  1564     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1565
  1566     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1567     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1568     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1569     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1570     12  AM-DCC-UEF-STATE                  PIC XX.
  1571     12  FILLER                            PIC XXX.
  1572     12  AM-REPORT-CODE-3                  PIC X(10).
  1573*    12  FILLER                            PIC X(22).
  1574
  1575     12  AM-RESERVE-DATE.
  1576         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1577         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1578         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1579
  1580     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1581     12  AM-NOTIFICATION-TYPES.
  1582         16  AM-NOTIF-OF-LETTERS           PIC X.
  1583         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1584         16  AM-NOTIF-OF-REPORTS           PIC X.
  1585         16  AM-NOTIF-OF-STATUS            PIC X.
  1586
  1587     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1588         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1589         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1590         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1591         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1592
  1593     12  AM-BENEFIT-CONTROLS.
  1594         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1595             20  AM-BENEFIT-CODE           PIC XX.
  1596             20  AM-BENEFIT-TYPE           PIC X.
  1597             20  AM-BENEFIT-REVISION       PIC XXX.
  1598             20  AM-BENEFIT-REM-TERM       PIC X.
  1599             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1600             20  FILLER                    PIC XX.
  1601         16  FILLER                        PIC X(80).
  1602
  1603     12  AM-TRANSFER-DATA.
  1604         16  AM-TRANSFERRED-FROM.
  1605             20  AM-TRNFROM-CARRIER        PIC X.
  1606             20  AM-TRNFROM-GROUPING.
  1607                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1608                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1609             20  AM-TRNFROM-STATE          PIC XX.
  1610             20  AM-TRNFROM-ACCOUNT.
  1611                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1612                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1613             20  AM-TRNFROM-DTE            PIC XX.
  1614         16  AM-TRANSFERRED-TO.
  1615             20  AM-TRNTO-CARRIER          PIC X.
  1616             20  AM-TRNTO-GROUPING.
  1617                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1618                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1619             20  AM-TRNTO-STATE            PIC XX.
  1620             20  AM-TRNTO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  30
* EL6311.cbl
  1621                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1622                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1623             20  AM-TRNTO-DTE              PIC XX.
  1624         16  FILLER                        PIC X(10).
  1625
  1626     12  AM-SAVED-REMIT-TO                 PIC 99.
  1627
  1628     12  AM-COMM-STRUCTURE-SAVED.
  1629         16  AM-DEFN-1-SAVED.
  1630             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1631                 24  AM-AGT-SV             PIC X(10).
  1632                 24  AM-COM-TYP-SV         PIC X.
  1633                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1634                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1635                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1636                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1637                 24  FILLER                PIC X.
  1638                 24  AM-GL-CODES-SV        PIC X.
  1639                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1640                 24  FILLER                PIC X.
  1641         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1642             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1643                 24  FILLER                PIC X(11).
  1644                 24  AM-L-COMA-SV          PIC XXX.
  1645                 24  AM-J-COMA-SV          PIC XXX.
  1646                 24  AM-A-COMA-SV          PIC XXX.
  1647                 24  FILLER                PIC X(6).
  1648
  1649     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1650         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1651            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1652            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1653            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1654
  1655     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1656     12  FILLER                            PIC X(120).
  1657
  1658     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1659         16  AM-CONTROL-NAME               PIC X(30).
  1660         16  AM-EXECUTIVE-ONE.
  1661             20  AM-EXEC1-NAME             PIC X(15).
  1662             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1663                                                          COMP-3.
  1664             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1665                                                          COMP-3.
  1666         16  AM-EXECUTIVE-TWO.
  1667             20  AM-EXEC2-NAME             PIC X(15).
  1668             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1669                                                          COMP-3.
  1670             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1671                                                          COMP-3.
  1672
  1673     12  AM-RETRO-ADDITIONAL-DATA.
  1674         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1675         16  AM-RETRO-PREM-P-E             PIC X.
  1676         16  AM-RETRO-CLMS-P-I             PIC X.
  1677         16  AM-RETRO-RET-BRACKET-LF.
  1678             20  AM-RETRO-RET-METHOD-LF    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  31
* EL6311.cbl
  1679                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1680                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1681             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1682                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1683                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1684             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1685                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1686                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1687         16  AM-RETRO-RET-BRACKET-AH.
  1688             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1689                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1690                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1691                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1692             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1693                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1694                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1695             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1696                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1697                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1698
  1699     12  AM-COMMENTS.
  1700         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1701
  1702     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1703         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1704         16  AM-FLI-BILLING-CODE           PIC X.
  1705         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1706         16  AM-FLI-UNITED-IDENT           PIC X.
  1707         16  AM-FLI-INTEREST-LOST-DATA.
  1708             20  AM-FLI-BANK-NO            PIC X(5).
  1709             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1710             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1711             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1712         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1713             20  AM-FLI-AGT                PIC X(9).
  1714             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1715             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1716         16  FILLER                        PIC X(102).
  1717
  1718     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1719         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1720             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1721             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1722             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1723             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1724             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1725         16  FILLER                          PIC X(10).
  1726******************************************************************
  1727*                                COPY ELCVADS.
  1728******************************************************************
  1729*                                                                *
  1730*                                                                *
  1731*                            ELCVADS.                            *
  1732*                                                                *
  1733*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1734*   ELVADS                  LENGTH = 350                         *
  1735******************************************************************
  1736******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  32
* EL6311.cbl
  1737*                   C H A N G E   L O G
  1738*
  1739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1740*-----------------------------------------------------------------
  1741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1742* EFFECTIVE    NUMBER
  1743*-----------------------------------------------------------------
  1744* 100111    2011022800001  AJRA  NAPERSOFT
  1745******************************************************************
  1746
  1747 01  VIRGINIA-DISCLOSURE.
  1748     12  VD-COMPANY-CD              PIC X.
  1749     12  VD-CARRIER                 PIC X.
  1750     12  VD-GROUPING.
  1751         20  VD-GROUPING-PREFIX     PIC XXX.
  1752         20  VD-GROUPING-PRIME      PIC XXX.
  1753     12  VD-STATE                   PIC XX.
  1754     12  VD-ACCOUNT.
  1755         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1756         20  VD-ACCOUNT-PRIME       PIC X(6).
  1757     12  VD-CERT-EFF-DT             PIC XX.
  1758     12  VD-CERT-NO.
  1759         20  VD-CERT-PRIME          PIC X(10).
  1760         20  VD-CERT-SFX            PIC X.
  1761     12  VD-ENTRY-BATCH             PIC X(6).
  1762     12  VD-CSR-ID                  PIC X(4).
  1763     12  VD-NAME.
  1764         20  VD-INSURED-LAST-NAME   PIC X(15).
  1765         20  VD-INSURED-FIRST-NAME.
  1766             24  VD-INSURED-1ST-INIT PIC X.
  1767             24  FILLER             PIC X(9).
  1768         20  VD-INSURED-MIDDLE-INIT PIC X.
  1769     12  VD-JOINT-INSURED.
  1770         20 VD-JOINT-LAST-NAME      PIC X(15).
  1771         20 VD-JOINT-FIRST-NAME.
  1772            24  VD-JOINT-FIRST-INIT PIC X.
  1773            24  FILLER              PIC X(9).
  1774         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1775     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1776     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1777     12  VD-INSURED-CITY-STATE.
  1778         20  VD-INSURED-CITY        PIC X(28).
  1779         20  VD-INSURED-STATE       PIC XX.
  1780     12  VD-INSURED-ZIP-CODE.
  1781         20  VD-INSURED-ZIP-PRIME.
  1782             24  VD-INSURED-ZIP-1   PIC X.
  1783                 88  VD-CANADIAN-POST-CODE
  1784                                       VALUE 'A' THRU 'Z'.
  1785             24  FILLER             PIC X(4).
  1786         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1787     12  VD-BENEFICIARY-NAME        PIC X(30).
  1788     12  VD-ACCOUNT-NAME            PIC X(30).
  1789     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1790     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1791     12  VD-1ST-PMT-DT              PIC XX.
  1792     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1793         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1794         88  VD-INVALID-LIFE           VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  33
* EL6311.cbl
  1795                                             '90' THRU '99'.
  1796     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1797                                    PIC XX.
  1798     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1799     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1800     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1801     12  VD-LF-TERM                 PIC S999   COMP-3.
  1802     12  VD-AH-BENEFIT-CD           PIC XX.
  1803         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1804         88  VD-INVALID-AH             VALUE '  ' '00'
  1805                                             '90' THRU '99'.
  1806     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1807     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1808     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1809     12  VD-AH-TERM                 PIC S999   COMP-3.
  1810     12  VD-LETTER-ID               PIC X(4).
  1811     12  VD-PROC-ID                 PIC X(4).
  1812     12  VD-COMP-ID                 PIC X(3).
  1813     12  VD-CURRENT-DATE            PIC XX.
  1814     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1815     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1816     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  34
* EL6311.cbl
  1818*    COPY ELCDATE.
  1819******************************************************************
  1820*                                                                *
  1821*                                                                *
  1822*                            ELCDATE.                            *
  1823*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1824*                            VMOD=2.003
  1825*                                                                *
  1826*                                                                *
  1827*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1828*                 LENGTH = 200                                   *
  1829******************************************************************
  1830
  1831 01  DATE-CONVERSION-DATA.
  1832     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1833     12  DC-OPTION-CODE                PIC X.
  1834         88  BIN-TO-GREG                VALUE ' '.
  1835         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1836         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1837         88  YMD-GREG-TO-BIN            VALUE '3'.
  1838         88  MDY-GREG-TO-BIN            VALUE '4'.
  1839         88  JULIAN-TO-BIN              VALUE '5'.
  1840         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1841         88  FIND-CENTURY               VALUE '7'.
  1842         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1843         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1844         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1845         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1846         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1847         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1848         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1849         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1850         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1851         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1852         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1853         88  BIN-3-TO-GREG              VALUE 'I'.
  1854         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1855         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1856         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1857         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1858         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1859         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1860         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1861         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1862         88  THREE-CHARACTER-BIN
  1863                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1864         88  GREGORIAN-TO-BIN
  1865                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1866         88  BIN-TO-GREGORIAN
  1867                  VALUES ' ' '1' 'I' '8' 'G'.
  1868         88  JULIAN-TO-BINARY
  1869                  VALUES '5' 'C' 'E' 'F'.
  1870     12  DC-ERROR-CODE                 PIC X.
  1871         88  NO-CONVERSION-ERROR        VALUE ' '.
  1872         88  DATE-CONVERSION-ERROR
  1873                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1874         88  DATE-IS-ZERO               VALUE '1'.
  1875         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  35
* EL6311.cbl
  1876         88  DATE-IS-INVALID            VALUE '3'.
  1877         88  DATE1-GREATER-DATE2        VALUE '4'.
  1878         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1879         88  DATE-INVALID-OPTION        VALUE '9'.
  1880         88  INVALID-CENTURY            VALUE 'A'.
  1881         88  ONLY-CENTURY               VALUE 'B'.
  1882         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1883         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1884     12  DC-END-OF-MONTH               PIC X.
  1885         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1886     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1887         88  USE-NORMAL-PROCESS         VALUE ' '.
  1888         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1889         88  ADJUST-UP-100-YRS          VALUE '2'.
  1890     12  FILLER                        PIC X.
  1891     12  DC-CONVERSION-DATES.
  1892         16  DC-BIN-DATE-1             PIC XX.
  1893         16  DC-BIN-DATE-2             PIC XX.
  1894         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1895         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1896                       DC-GREG-DATE-1-EDIT.
  1897             20  DC-EDIT1-MONTH        PIC 99.
  1898             20  SLASH1-1              PIC X.
  1899             20  DC-EDIT1-DAY          PIC 99.
  1900             20  SLASH1-2              PIC X.
  1901             20  DC-EDIT1-YEAR         PIC 99.
  1902         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1903         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1904                     DC-GREG-DATE-2-EDIT.
  1905             20  DC-EDIT2-MONTH        PIC 99.
  1906             20  SLASH2-1              PIC X.
  1907             20  DC-EDIT2-DAY          PIC 99.
  1908             20  SLASH2-2              PIC X.
  1909             20  DC-EDIT2-YEAR         PIC 99.
  1910         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1911         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1912                     DC-GREG-DATE-1-YMD.
  1913             20  DC-YMD-YEAR           PIC 99.
  1914             20  DC-YMD-MONTH          PIC 99.
  1915             20  DC-YMD-DAY            PIC 99.
  1916         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1917         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1918                      DC-GREG-DATE-1-MDY.
  1919             20  DC-MDY-MONTH          PIC 99.
  1920             20  DC-MDY-DAY            PIC 99.
  1921             20  DC-MDY-YEAR           PIC 99.
  1922         16  DC-GREG-DATE-1-ALPHA.
  1923             20  DC-ALPHA-MONTH        PIC X(10).
  1924             20  DC-ALPHA-DAY          PIC 99.
  1925             20  FILLER                PIC XX.
  1926             20  DC-ALPHA-CENTURY.
  1927                 24 DC-ALPHA-CEN-N     PIC 99.
  1928             20  DC-ALPHA-YEAR         PIC 99.
  1929         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1930         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1931         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1932         16  DC-JULIAN-DATE            PIC 9(05).
  1933         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  36
* EL6311.cbl
  1934                                       PIC 9(05).
  1935         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1936             20  DC-JULIAN-YEAR        PIC 99.
  1937             20  DC-JULIAN-DAYS        PIC 999.
  1938         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1939         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1940         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1941     12  DATE-CONVERSION-VARIBLES.
  1942         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1943         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1944             20  FILLER                PIC 9(3).
  1945             20  HOLD-CEN-1-CCYY.
  1946                 24  HOLD-CEN-1-CC     PIC 99.
  1947                 24  HOLD-CEN-1-YY     PIC 99.
  1948             20  HOLD-CEN-1-MO         PIC 99.
  1949             20  HOLD-CEN-1-DA         PIC 99.
  1950         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1951             20  HOLD-CEN-1-R-MO       PIC 99.
  1952             20  HOLD-CEN-1-R-DA       PIC 99.
  1953             20  HOLD-CEN-1-R-CCYY.
  1954                 24  HOLD-CEN-1-R-CC   PIC 99.
  1955                 24  HOLD-CEN-1-R-YY   PIC 99.
  1956             20  FILLER                PIC 9(3).
  1957         16  HOLD-CENTURY-1-X.
  1958             20  FILLER                PIC X(3)  VALUE SPACES.
  1959             20  HOLD-CEN-1-X-CCYY.
  1960                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1961                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1962             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1963             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1964         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1965             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1966             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1967             20  HOLD-CEN-1-R-X-CCYY.
  1968                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1969                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1970             20  FILLER                PIC XXX.
  1971         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1972         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1973         16  DC-JULIAN-DATE-1          PIC 9(07).
  1974         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1975             20  DC-JULIAN-1-CCYY.
  1976                 24  DC-JULIAN-1-CC    PIC 99.
  1977                 24  DC-JULIAN-1-YR    PIC 99.
  1978             20  DC-JULIAN-DA-1        PIC 999.
  1979         16  DC-JULIAN-DATE-2          PIC 9(07).
  1980         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1981             20  DC-JULIAN-2-CCYY.
  1982                 24  DC-JULIAN-2-CC    PIC 99.
  1983                 24  DC-JULIAN-2-YR    PIC 99.
  1984             20  DC-JULIAN-DA-2        PIC 999.
  1985         16  DC-GREG-DATE-A-EDIT.
  1986             20  DC-EDITA-MONTH        PIC 99.
  1987             20  SLASHA-1              PIC X VALUE '/'.
  1988             20  DC-EDITA-DAY          PIC 99.
  1989             20  SLASHA-2              PIC X VALUE '/'.
  1990             20  DC-EDITA-CCYY.
  1991                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  37
* EL6311.cbl
  1992                 24  DC-EDITA-YEAR     PIC 99.
  1993         16  DC-GREG-DATE-B-EDIT.
  1994             20  DC-EDITB-MONTH        PIC 99.
  1995             20  SLASHB-1              PIC X VALUE '/'.
  1996             20  DC-EDITB-DAY          PIC 99.
  1997             20  SLASHB-2              PIC X VALUE '/'.
  1998             20  DC-EDITB-CCYY.
  1999                 24  DC-EDITB-CENT     PIC 99.
  2000                 24  DC-EDITB-YEAR     PIC 99.
  2001         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2002         16  DC-GREG-DATE-CYMD-R REDEFINES
  2003                              DC-GREG-DATE-CYMD.
  2004             20  DC-CYMD-CEN           PIC 99.
  2005             20  DC-CYMD-YEAR          PIC 99.
  2006             20  DC-CYMD-MONTH         PIC 99.
  2007             20  DC-CYMD-DAY           PIC 99.
  2008         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2009         16  DC-GREG-DATE-MDCY-R REDEFINES
  2010                              DC-GREG-DATE-MDCY.
  2011             20  DC-MDCY-MONTH         PIC 99.
  2012             20  DC-MDCY-DAY           PIC 99.
  2013             20  DC-MDCY-CEN           PIC 99.
  2014             20  DC-MDCY-YEAR          PIC 99.
  2015    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2016        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2017    12  DC-EL310-DATE                  PIC X(21).
  2018    12  FILLER                         PIC X(28).
  2019
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  38
* EL6311.cbl
  2021*    COPY ELCLOGOF.
  2022******************************************************************
  2023*                                                                *
  2024*                                                                *
  2025*                            ELCLOGOF.                           *
  2026*                            VMOD=2.001                          *
  2027*                                                                *
  2028*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2029*                                                                *
  2030******************************************************************
  2031 01  CLASIC-LOGOFF.
  2032     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2033     12  LOGOFF-TEXT.
  2034         16  FILLER          PIC X(5)    VALUE SPACES.
  2035         16  LOGOFF-MSG.
  2036             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2037             20  FILLER      PIC X       VALUE SPACES.
  2038             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2039         16  FILLER          PIC X(80)
  2040           VALUE '* YOU ARE NOW LOGGED OFF'.
  2041         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2042         16  FILLER          PIC X       VALUE QUOTE.
  2043         16  LOGOFF-SYS-MSG  PIC X(17)
  2044           VALUE 'S CLAS-IC SYSTEM '.
  2045     12  TEXT-MESSAGES.
  2046         16  UNACCESS-MSG    PIC X(29)
  2047             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2048         16  PGMIDERR-MSG    PIC X(17)
  2049             VALUE 'PROGRAM NOT FOUND'.
  2050
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  39
* EL6311.cbl
  2052*    COPY ELCATTR.
  2053******************************************************************
  2054*                                                                *
  2055*                            ELCATTR.                            *
  2056*                            VMOD=2.001                          *
  2057*                                                                *
  2058*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2059*                                                                *
  2060*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2061*                                                                *
  2062*                   POS 1   P=PROTECTED                          *
  2063*                           U=UNPROTECTED                        *
  2064*                           S=ASKIP                              *
  2065*                   POS 2   A=ALPHA/NUMERIC                      *
  2066*                           N=NUMERIC                            *
  2067*                   POS 3   N=NORMAL                             *
  2068*                           B=BRIGHT                             *
  2069*                           D=DARK                               *
  2070*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2071*                           OF=MODIFIED DATA TAG OFF             *
  2072*                                                                *
  2073*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2074******************************************************************
  2075 01  ATTRIBUTE-LIST.
  2076     12  AL-PABOF            PIC X       VALUE 'Y'.
  2077     12  AL-PABON            PIC X       VALUE 'Z'.
  2078     12  AL-PADOF            PIC X       VALUE '%'.
  2079     12  AL-PADON            PIC X       VALUE '_'.
  2080     12  AL-PANOF            PIC X       VALUE '-'.
  2081     12  AL-PANON            PIC X       VALUE '/'.
  2082     12  AL-SABOF            PIC X       VALUE '8'.
  2083     12  AL-SABON            PIC X       VALUE '9'.
  2084     12  AL-SADOF            PIC X       VALUE '@'.
  2085     12  AL-SADON            PIC X       VALUE QUOTE.
  2086     12  AL-SANOF            PIC X       VALUE '0'.
  2087     12  AL-SANON            PIC X       VALUE '1'.
  2088     12  AL-UABOF            PIC X       VALUE 'H'.
  2089     12  AL-UABON            PIC X       VALUE 'I'.
  2090     12  AL-UADOF            PIC X       VALUE '<'.
  2091     12  AL-UADON            PIC X       VALUE '('.
  2092     12  AL-UANOF            PIC X       VALUE ' '.
  2093     12  AL-UANON            PIC X       VALUE 'A'.
  2094     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2095     12  AL-UNBON            PIC X       VALUE 'R'.
  2096     12  AL-UNDOF            PIC X       VALUE '*'.
  2097     12  AL-UNDON            PIC X       VALUE ')'.
  2098     12  AL-UNNOF            PIC X       VALUE '&'.
  2099     12  AL-UNNON            PIC X       VALUE 'J'.
  2100
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  40
* EL6311.cbl
  2102*    COPY ELCEMIB.
  2103******************************************************************
  2104*                                                                *
  2105*                                                                *
  2106*                            ELCEMIB.                            *
  2107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2108*                            VMOD=2.005                          *
  2109*                                                                *
  2110*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2111*                                                                *
  2112******************************************************************
  2113 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2114     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2115     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2116     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2117     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2118     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2119     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2120     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2121     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2122     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2123         88  EMI-NO-ERRORS                    VALUE '1'.
  2124         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2125         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2126     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2127         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2128     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2129         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2130         88  EMI-AREA1-FULL                   VALUE '2'.
  2131     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2132         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2133         88  EMI-AREA2-FULL                   VALUE '2'.
  2134     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2135         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2136         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2137         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2138         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2139         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2140     12  EMI-ERROR-LINES.
  2141         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2142         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2143         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2144         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2145             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2146                 24  EMI-ERR-NUM         PIC X(4).
  2147                 24  EMI-FILLER          PIC X.
  2148                 24  EMI-SEV             PIC X.
  2149                 24  FILLER              PIC X.
  2150             20  FILLER                  PIC X(02).
  2151     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2152         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2153             20  EMI-ERROR-NUMBER    PIC X(4).
  2154             20  EMI-FILL            PIC X.
  2155             20  EMI-SEVERITY        PIC X.
  2156             20  FILLER              PIC X.
  2157             20  EMI-ERROR-TEXT.
  2158                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2159                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  41
* EL6311.cbl
  2160     12  EMI-SEVERITY-SAVE           PIC X.
  2161         88  EMI-NOTE                    VALUE 'N'.
  2162         88  EMI-WARNING                 VALUE 'W'.
  2163         88  EMI-FORCABLE                VALUE 'F'.
  2164         88  EMI-FATAL                   VALUE 'X'.
  2165     12  EMI-MESSAGE-FLAG            PIC X.
  2166         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2167         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2168     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2169     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2170         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2171         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2172         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2173     12  FILLER                      PIC X(137)  VALUE SPACES.
  2174     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2175     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2176     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2177     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2178
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  42
* EL6311.cbl
  2180*    COPY ELCINTF.
  2181******************************************************************
  2182*                                                                *
  2183*                                                                *
  2184*                            ELCINTF.                            *
  2185*                            VMOD=2.017                          *
  2186*                                                                *
  2187*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2188*                                                                *
  2189*       LENGTH = 1024                                            *
  2190*                                                                *
  2191******************************************************************
  2192*                   C H A N G E   L O G
  2193*
  2194* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2195*-----------------------------------------------------------------
  2196*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2197* EFFECTIVE    NUMBER
  2198*-----------------------------------------------------------------
  2199* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2200******************************************************************
  2201 01  PROGRAM-INTERFACE-BLOCK.
  2202     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2203     12  PI-CALLING-PROGRAM              PIC X(8).
  2204     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2205     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2206     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2207     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2208     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2209     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2210     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2211     12  PI-COMPANY-ID                   PIC XXX.
  2212     12  PI-COMPANY-CD                   PIC X.
  2213
  2214     12  PI-COMPANY-PASSWORD             PIC X(8).
  2215
  2216     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2217
  2218     12  PI-CONTROL-IN-PROGRESS.
  2219         16  PI-CARRIER                  PIC X.
  2220         16  PI-GROUPING                 PIC X(6).
  2221         16  PI-STATE                    PIC XX.
  2222         16  PI-ACCOUNT                  PIC X(10).
  2223         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2224                                         PIC X(10).
  2225         16  PI-CLAIM-CERT-GRP.
  2226             20  PI-CLAIM-NO             PIC X(7).
  2227             20  PI-CERT-NO.
  2228                 25  PI-CERT-PRIME       PIC X(10).
  2229                 25  PI-CERT-SFX         PIC X.
  2230             20  PI-CERT-EFF-DT          PIC XX.
  2231         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2232             20  PI-PLAN-CODE            PIC X(2).
  2233             20  PI-REVISION-NUMBER      PIC X(3).
  2234             20  PI-PLAN-EFF-DT          PIC X(2).
  2235             20  PI-PLAN-EXP-DT          PIC X(2).
  2236             20  FILLER                  PIC X(11).
  2237         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  43
* EL6311.cbl
  2238             20  PI-OE-REFERENCE-1.
  2239                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2240                 25  PI-OE-REF-1-SUFF    PIC XX.
  2241
  2242     12  PI-SESSION-IN-PROGRESS          PIC X.
  2243         88  CLAIM-SESSION                   VALUE '1'.
  2244         88  CREDIT-SESSION                  VALUE '2'.
  2245         88  WARRANTY-SESSION                VALUE '3'.
  2246         88  MORTGAGE-SESSION                VALUE '4'.
  2247         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2248
  2249
  2250*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2251
  2252     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2253     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2254
  2255     12  PI-CREDIT-USER                  PIC X.
  2256         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2257         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2258
  2259     12  PI-CLAIM-USER                   PIC X.
  2260         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2261         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2262
  2263     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2264         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2265         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2266         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2267         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2268         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2269
  2270     12  PI-PROCESSOR-ID                 PIC X(4).
  2271
  2272     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2273
  2274     12  PI-MEMBER-CAPTION               PIC X(10).
  2275
  2276     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2277         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2278
  2279     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2280     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2281     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2282     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2283
  2284     12  PI-AH-OVERRIDE-L1               PIC X.
  2285     12  PI-AH-OVERRIDE-L2               PIC XX.
  2286     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2287     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2288
  2289     12  PI-NEW-SYSTEM                   PIC X(2).
  2290
  2291     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2292     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2293         88  PI-USES-PAID-TO                 VALUE '1'.
  2294     12  PI-CRDTCRD-SYSTEM.
  2295         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  44
* EL6311.cbl
  2296             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2297             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2298         16  PI-CC-MONTH-END-DT          PIC XX.
  2299     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2300
  2301     12  PI-OE-REFERENCE-2.
  2302         16  PI-OE-REF-2-PRIME           PIC X(10).
  2303         16  PI-OE-REF-2-SUFF            PIC X.
  2304
  2305     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2306
  2307     12  PI-LANGUAGE-TYPE                PIC X.
  2308             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2309             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2310             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2311
  2312     12  PI-POLICY-LINKAGE-IND           PIC X.
  2313         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2314         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2315                                                   LOW-VALUES.
  2316
  2317     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2318     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2319         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2320         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2321
  2322     12  PI-PROCESSOR-CSR-IND            PIC X.
  2323         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2324         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2325
  2326     12  FILLER                          PIC X(3).
  2327
  2328     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2329
  2330     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2331         PI-SYSTEM-LEVEL.
  2332
  2333         16  PI-ENTRY-CODES.
  2334             20  PI-ENTRY-CD-1           PIC X.
  2335             20  PI-ENTRY-CD-2           PIC X.
  2336
  2337         16  PI-RETURN-CODES.
  2338             20  PI-RETURN-CD-1          PIC X.
  2339             20  PI-RETURN-CD-2          PIC X.
  2340
  2341         16  PI-UPDATE-STATUS-SAVE.
  2342             20  PI-UPDATE-BY            PIC X(4).
  2343             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2344
  2345         16  PI-LOWER-CASE-LETTERS       PIC X.
  2346             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2347
  2348*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2349*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2350*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2351
  2352         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2353             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  45
* EL6311.cbl
  2354             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2355             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2356             88  ACCNT-CNTL                  VALUE '3'.
  2357             88  CARR-ACCNT-CNTL             VALUE '4'.
  2358
  2359         16  PI-PROCESSOR-CAP-LIST.
  2360             20  PI-SYSTEM-CONTROLS.
  2361                24 PI-SYSTEM-DISPLAY     PIC X.
  2362                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2363                24 PI-SYSTEM-MODIFY      PIC X.
  2364                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2365             20  FILLER                  PIC XX.
  2366             20  PI-DISPLAY-CAP          PIC X.
  2367                 88  DISPLAY-CAP             VALUE 'Y'.
  2368             20  PI-MODIFY-CAP           PIC X.
  2369                 88  MODIFY-CAP              VALUE 'Y'.
  2370             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2371                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2372             20  PI-FORCE-CAP            PIC X.
  2373                 88  FORCE-CAP               VALUE 'Y'.
  2374
  2375         16  PI-PROGRAM-CONTROLS.
  2376             20  PI-PGM-PRINT-OPT        PIC X.
  2377             20  PI-PGM-FORMAT-OPT       PIC X.
  2378             20  PI-PGM-PROCESS-OPT      PIC X.
  2379             20  PI-PGM-TOTALS-OPT       PIC X.
  2380
  2381         16  PI-HELP-INTERFACE.
  2382             20  PI-LAST-ERROR-NO        PIC X(4).
  2383             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2384
  2385         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2386             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2387
  2388         16  PI-CR-CONTROL-IN-PROGRESS.
  2389             20  PI-CR-CARRIER           PIC X.
  2390             20  PI-CR-GROUPING          PIC X(6).
  2391             20  PI-CR-STATE             PIC XX.
  2392             20  PI-CR-ACCOUNT           PIC X(10).
  2393             20  PI-CR-FIN-RESP          PIC X(10).
  2394             20  PI-CR-TYPE              PIC X.
  2395
  2396         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2397
  2398         16  PI-CR-MONTH-END-DT          PIC XX.
  2399
  2400         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2401             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2402             88  PI-ZERO-CARRIER             VALUE '1'.
  2403             88  PI-ZERO-GROUPING            VALUE '2'.
  2404             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2405
  2406         16  PI-CARRIER-SECURITY         PIC X.
  2407             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2408
  2409         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2410             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2411             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  46
* EL6311.cbl
  2412
  2413         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2414             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2415                                         INDEXED BY PI-ACCESS-NDX
  2416                                         PIC X.
  2417
  2418         16  PI-GA-BILLING-CONTROL       PIC X.
  2419             88  PI-GA-BILLING               VALUE '1'.
  2420
  2421         16  PI-MAIL-PROCESSING          PIC X.
  2422             88  PI-MAIL-YES                 VALUE 'Y'.
  2423
  2424         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2425
  2426         16  PI-AR-SYSTEM.
  2427             20  PI-AR-PROCESSING-CNTL   PIC X.
  2428                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2429             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2430             20  PI-AR-MONTH-END-DT      PIC XX.
  2431
  2432         16  PI-MP-SYSTEM.
  2433             20  PI-MORTGAGE-USER            PIC X.
  2434                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2435                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2436             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2437                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2438                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2439                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2440                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2441                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2442             20  PI-MP-MONTH-END-DT          PIC XX.
  2443             20  PI-MP-REFERENCE-NO.
  2444                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2445                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2446
  2447         16  PI-LABEL-CONTROL            PIC X(01).
  2448             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2449             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2450
  2451         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2452             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2453
  2454         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2455             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2456             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2457
  2458         16  FILLER                      PIC X(14).
  2459
  2460     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2461******************************************************************
  2462
  2463     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2464*    COPY ELC631PI.
  2465******************************************************************
  2466*                                                                *
  2467*                                                                *
  2468*                            ELC631PI                            *
  2469*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  47
* EL6311.cbl
  2470*                                                                *
  2471*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2472*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2473*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2474*                                                                *
  2475*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2476*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2477*    BETWEEN PROGRAMS.                                           *
  2478*                                                                *
  2479*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2480*                                                                *
  2481*               EL631 - EL6311 - EL6312 - EL6313                 *
  2482*                                                                *
  2483******************************************************************
  2484
  2485         16  PI-631-DATA.
  2486             20  PI-ERPNDB-KEY.
  2487                 24  PI-PB-COMPANY-CD     PIC X.
  2488                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2489                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2490                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2491
  2492             20  PI-ERPNDB-ALT-KEY.
  2493                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2494                 24  PI-PB-CARRIER        PIC X.
  2495                 24  PI-PB-GROUPING       PIC X(6).
  2496                 24  PI-PB-STATE          PIC XX.
  2497                 24  PI-PB-ACCOUNT        PIC X(10).
  2498                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2499                 24  PI-PB-CERT-NO.
  2500                     28  PI-PB-CERT-PRIME PIC X(10).
  2501                     28  PI-PB-CERT-SFX   PIC X.
  2502                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2503                 24  PI-PB-RECORD-TYPE    PIC X.
  2504
  2505             20  PI-ERPNDB-CSR-KEY.
  2506                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2507                 24  PI-PB-CSR-ID             PIC X(4).
  2508                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2509                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2510                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2511
  2512             20  PI-BROWSE-TYPE               PIC X.
  2513                 88  PI-FILE-BROWSE             VALUE ' '.
  2514                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2515                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2516                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2517                 88  PI-CSR-BROWSE              VALUE '4'.
  2518
  2519             20  PI-MAINT-FUNCTION            PIC X.
  2520                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2521                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2522                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2523                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2524                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2525                 88  PI-PF5-FUNCTION            VALUE '5'.
  2526                 88  PI-PF6-FUNCTION            VALUE '6'.
  2527
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  48
* EL6311.cbl
  2528             20  PI-FILE-SWITCHES.
  2529                 24  PI-ALL-ISSUES-SW         PIC X.
  2530                     88  ALL-ISSUES             VALUE 'Y'.
  2531                 24  PI-ALL-CANCELS-SW        PIC X.
  2532                     88  ALL-CANCELS            VALUE 'Y'.
  2533                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2534                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2535                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2536                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2537                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2538                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2539                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2540                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2541                 24  PI-HOLD-REC-SW           PIC X.
  2542                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2543                 24  PI-CHANGE-REC-SW         PIC X.
  2544                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2545                 24  PI-CHK-REQ-REC-SW        PIC X.
  2546                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2547                 24  PI-ISSUE-WARNING-SW      PIC X.
  2548                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2549                 24  PI-CANCEL-WARNING-SW     PIC X.
  2550                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2551             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2552                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2553             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2554                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2555
  2556             20  PI-MAP-NAME                  PIC X(8).
  2557
  2558             20  PI-CURSOR                    PIC S9(4) COMP.
  2559
  2560             20  PI-PREV-ALT-KEY              PIC X(36).
  2561             20  PI-PREV-CSR-KEY              PIC X(15).
  2562             20  PI-PREV-KEY.
  2563                 24  PI-PREV-COMPANY-CD       PIC X.
  2564                 24  PI-PREV-BATCH            PIC X(6).
  2565                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2566                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2567             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2568             20  PI-BROWSE-SW                 PIC X.
  2569                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2570                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2571             20  PI-SV-CARRIER                PIC X.
  2572             20  PI-SV-GROUPING               PIC X(6).
  2573             20  PI-SV-STATE                  PIC XX.
  2574             20  PI-EDIT-SW                   PIC X.
  2575             20  PI-DISPLAY-SW                PIC XX.
  2576                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2577                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2578             20  PI-CRITERIA-DATA             PIC X(350).
  2579             20  PI-BMODE                     PIC X.
  2580             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2581             20  PI-BPMTS                     PIC S999     COMP-3.
  2582             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2583             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2584             20  PI-CSR-SESSION-SW            PIC X.
  2585                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  49
* EL6311.cbl
  2586             20  PI-ERRORS-SW                 PIC X.
  2587                 88  FATAL-ERRORS               VALUE 'X'.
  2588*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2589             20  FILLER                       PIC X(5).
  2590
  2591        16  FILLER             PIC X(94).
  2592
  2593 01  W-LETTER-COMMUNICATION-AREAS.
  2594*    COPY ELC1042.
  2595******************************************************************
  2596*                                                                *
  2597*                                                                *
  2598*                           ELC1042                              *
  2599*                            VMOD=2.002                          *
  2600*                                                                *
  2601*    NOTE                                                        *
  2602*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2603*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2604*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2605*        TO THESE PROGRAMS.                                      *
  2606*                                                                *
  2607*    NOTE                                                        *
  2608*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2609*        USE ONLY!                                               *
  2610*                                                                *
  2611******************************************************************
  2612
  2613         16  PI-1042-WA.
  2614             20  PI-ACTION       PIC  X(01).
  2615                 88 PI-SHOW-MODE           VALUE '1'.
  2616                 88 PI-CLEAR-MODE          VALUE '2'.
  2617                 88 PI-CREATE-MODE         VALUE '3'.
  2618             20  PI-COMM-CONTROL PIC  X(12).
  2619             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2620             20  PI-EOF-SW       PIC  X(01).
  2621                 88  PI-FILE-EOF           VALUE 'Y'.
  2622             20  PI-FILETYP      PIC  X(01).
  2623             20  PI-FORM-SQUEEZE-CONTROL
  2624                                 PIC  X(01).
  2625                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2626                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2627             20  PI-LAST-CONTROL PIC  X(12).
  2628             20  PI-TEMP-STOR-ITEMS
  2629                                 PIC S9(04) COMP.
  2630             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2631             20  PI-UPDATE-SW    PIC  9(01).
  2632                 88 ANY-UPDATES            VALUE 1.
  2633             20  PI-104-SCREEN-SENT-IND
  2634                                 PIC  X(01).
  2635                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2636                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2637             20  PI-1042-SCREEN-SENT-IND
  2638                                 PIC  X(01).
  2639                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2640                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2641             20  PI-1042-ARCHIVE-IND
  2642                                 PIC  X(01).
  2643                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  50
* EL6311.cbl
  2644             20  FILLER          PIC  X(29).
  2645*    COPY ELC689PI.
  2646******************************************************************
  2647*                                                                *
  2648*                            ELC689PI                            *
  2649*                            VMOD=2.003                          *
  2650*                                                                *
  2651*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2652*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2653*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2654*                                                                *
  2655*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2656*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2657*    BETWEEN PROGRAMS.                                           *
  2658*                                                                *
  2659*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2660*                                                                *
  2661*               EL631 - EL689  - EL6891 - EL6892                 *
  2662*                                                                *
  2663******************************************************************
  2664*                   C H A N G E   L O G
  2665*
  2666* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2667*-----------------------------------------------------------------
  2668*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2669* EFFECTIVE    NUMBER
  2670*-----------------------------------------------------------------
  2671* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2672* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2673* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2674******************************************************************
  2675
  2676
  2677         16  PI-689-WORK-AREA.
  2678             20  PI-689-ALT-PRINTER-ID
  2679                                 PIC  X(04).
  2680             20  PI-689-ARCHIVE-NUMBER
  2681                                 PIC  9(08).
  2682             20  PI-689-ARCHIVE-SW
  2683                                 PIC  X(01).
  2684                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2685             20  PI-689-DATA-SOURCE
  2686                                 PIC  X(01).
  2687                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2688                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2689                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2690                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2691                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2692             20  PI-689-ERROR-IND
  2693                                 PIC  X(01).
  2694                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2695             20  PI-689-ERROR    PIC  9(04).
  2696                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2697                 88  PI-689-FATAL-ERROR
  2698                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2699                            0042 0047 0051 0066 0067 0070
  2700                            0168 0169 0174 0175 0176 0177 0179
  2701                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  51
* EL6311.cbl
  2702                            0191
  2703                            0215 0279 0280
  2704                            0412 0413 0454
  2705                            0533 0537
  2706                            2055 2114 2208 2209 2216 2232 2369
  2707                            2398 2433 2908 2999
  2708                            3000 3770 3771 3775
  2709                            7250 7365 7367 7368 7369 7370 7371
  2710                            7272 7373 7374 7376 7377 7378 7379
  2711                            7381 7388 7390 7393 7395 7396 7398
  2712                            9095 9096 9281 9298 9299 9320 9327
  2713                            9426 9427.
  2714                 88  PI-689-STOP-ERROR
  2715                     VALUES 0004 0008 0013 0023 0029 0033
  2716                            0042 0047 0066 0067 0070
  2717                            0168 0169 0174 0175 0176 0177
  2718                            0181 0182 0184 0185 0189 0190
  2719                            0279 0280
  2720                            0412 0413 0454
  2721                            2055 2208 2209 2216 2232
  2722                            2398 2999
  2723                            3000 3770 3771 3775
  2724                            7250 7365 7369 7370 7371
  2725                            7272 7373 7374 7376 7377 7378 7379
  2726                            7381 7388 7390 7393 7396 7398
  2727                            9095 9096 9299 9320 9426.
  2728             20  PI-689-FOLLOW-UP-DATE
  2729                                 PIC  X(02).
  2730             20  PI-689-FORM-NUMBER
  2731                                 PIC  X(04).
  2732             20  PI-689-LABEL-SOURCE
  2733                                 PIC X(01).
  2734                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2735                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2736                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2737                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2738                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2739                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2740                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2741             20  PI-689-NUMBER-COPIES
  2742                                 PIC  9(01).
  2743             20  PI-689-NUMBER-LABEL-LINES
  2744                                 PIC  9(01).
  2745             20  PI-689-NUMBER-TEXT-RECORDS
  2746                                 PIC  9(03).
  2747             20  PI-689-PRINT-ORDER-SW
  2748                                 PIC  X(01).
  2749                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2750                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2751                 88  PI-689-PRINT-LATER     VALUE '3'.
  2752                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2753             20  PI-689-PRINT-RESTRICTION
  2754                                 PIC  X(01).
  2755                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2756                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2757                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2758             20  PI-689-PRINT-SW PIC  X(01).
  2759                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  52
* EL6311.cbl
  2760             20  PI-689-RESEND-DATE-1
  2761                                 PIC  X(02).
  2762             20  PI-689-RESEND-LETR-1
  2763                                 PIC X(4).
  2764             20  PI-689-TEMP-STOR-ID
  2765                                 PIC  X(08).
  2766             20  PI-689-USE-SCREEN-IND
  2767                                 PIC  X(01).
  2768                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2769             20  PI-689-ARCH-POINTER
  2770                                 PIC S9(08) COMP.
  2771                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2772             20  PI-689-ARCT-POINTER
  2773                                 PIC S9(08) COMP.
  2774                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2775             20  PI-689-VARIABLE-DATA-GRP.
  2776                 24  PI-689-VARIABLE-DATA-1
  2777                                 PIC  X(30).
  2778                 24  PI-689-VARIABLE-DATA-2
  2779                                 PIC  X(30).
  2780                 24  PI-689-VARIABLE-DATA-3
  2781                                 PIC  X(30).
  2782                 24  PI-689-VARIABLE-DATA-4
  2783                                 PIC  X(30).
  2784
  2785         16  PI-689-KEY-DATA-FIELDS.
  2786             20  PI-689-ACCOUNT  PIC  X(10).
  2787             20  PI-689-CARRIER  PIC  X(01).
  2788             20  PI-689-CERT-NO.
  2789                 24  PI-689-CERT-PRIME
  2790                                 PIC  X(10).
  2791                 24  PI-689-CERT-SFX
  2792                                 PIC  X(01).
  2793             20  PI-689-CHG-SEQ-NO
  2794                                 PIC S9(04)    COMP.
  2795             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2796                                 PIC  X(02).
  2797             20  PI-689-ENTRY-BATCH
  2798                                 PIC  X(06).
  2799             20  PI-689-EFF-DATE PIC  X(02).
  2800             20  PI-689-EXP-DATE PIC  X(02).
  2801             20  PI-689-GROUPING PIC  X(06).
  2802             20  PI-689-RESP-PERSON
  2803                                 PIC  X(10).
  2804             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2805             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2806                                 PIC  X(04).
  2807             20  PI-689-STATE    PIC  X(02).
  2808             20  PI-689-TYPE     PIC  X(01).
  2809             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2810             20  PI-689-ALT-SEQ-NO
  2811                                 PIC S9(04)    COMP.
  2812         16  PI-689-DATE-EDIT    PIC  X(08).
  2813         16  PI-689-FOLLOW-UP-EDIT
  2814                                 PIC  X(08).
  2815         16  PI-689-RESEND1-EDIT PIC  X(08).
  2816         16  PI-689-SEQ-EDIT     PIC  X(08).
  2817         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  53
* EL6311.cbl
  2818         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2819             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2820         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2821         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  54
* EL6311.cbl
  2823
  2824 01  WS-EL6315-PASS-AREA.
  2825        16  PI-6315-ISS-CAN-SW      PIC X.
  2826        16  FILLER                  PIC X(120).
  2827        16  PI-RES-REF-CLM-TYPE     PIC X.
  2828        16  FILLER                  PIC X.
  2829        16  PI-6315-PASS-AREA.
  2830            20 FILLER               PIC X(236).
  2831            20 PI-6315-FINALIZED    PIC X.
  2832            20 FILLER               PIC X(280).
  2833
  2834 01  WS-EL6316-PASS-AREA.
  2835        16  PI-ISS-CAN-SW           PIC X.
  2836        16  FILLER                  PIC X(121).
  2837        16  PI-CLM-RESC-IND         PIC X.
  2838        16  PI-6316-PASS-AREA.
  2839            20 FILLER               PIC X(236).
  2840            20 PI-6316-FINALIZED    PIC X.
  2841            20 FILLER               PIC X(280).
  2842
  2843******************************************************************
  2844*                                                                *
  2845*         P A S S   A R E A   F O R   E D I T                    *
  2846*                                                                *
  2847******************************************************************
  2848
  2849 01  PASSED-RECORD.
  2850     12  RECORD-SAVE                  PIC X(585).
  2851* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2852*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2853*                    BY  WK-CURRENT-DATE.
  2854******************************************************************
  2855*                                                                *
  2856*                                                                *
  2857*                             ELC50W1                            *
  2858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2859*                            VMOD=2.004                          *
  2860*                                                                *
  2861*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2862*                                                                *
  2863*                                                                *
  2864******************************************************************
  2865
  2866     12  WK-WORK-AREA.
  2867         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2868         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2869         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2870         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2871         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2872         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2873         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2874         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2875         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2876         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2877         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2878         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2879         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2880         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  55
* EL6311.cbl
  2881         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2882         16  WK-CREDIT-EDIT-CONTROLS.
  2883             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2884             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2885             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2886             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2887             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2888             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2889         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2890         16  WK-SAVE-REIN-DATA.
  2891             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2892             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2893             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2894         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2895             88  ENTRY-FROM-EL6311       VALUE '6'.
  2896         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2897         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2898     12  WK-RECORD-ADDRESSES.
  2899         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2900         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2901         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2902         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2903         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2904         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2905         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2906         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2907     12  WK-OVER-SHORT-AREA.
  2908         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2909         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2910         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2911             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2912         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  56
* EL6311.cbl
  2914
  2915*    COPY ELCEDITC.
  2916******************************************************************
  2917*                                                                *
  2918*                                                                *
  2919*                            ELCEDITC                            *
  2920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2921*                            VMOD=2.012                          *
  2922*                                                                *
  2923*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2924*                     EL6313, EL050 AND EL517.                   *
  2925*                                                                *
  2926******************************************************************
  2927******************************************************************
  2928*                   C H A N G E   L O G
  2929*
  2930* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2931*-----------------------------------------------------------------
  2932*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2933* EFFECTIVE    NUMBER
  2934*-----------------------------------------------------------------
  2935* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2936******************************************************************
  2937
  2938     12  EDIT-CRITERIA-DATA.
  2939         16  EC-CO-MONTH-END-DT       PIC XX.
  2940         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2941         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2942         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2943         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2944         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2945         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2946         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2947         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2948         16  EC-CO-REM-TERM-CALC      PIC X.
  2949               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2950               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2951               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2952               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2953
  2954         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2955               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2956               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2957               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2958               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2959               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2960               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2961               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2962               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2963               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2964               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2965
  2966         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2967               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2968               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2969               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2970               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2971               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  57
* EL6311.cbl
  2972               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2973               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2974               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2975
  2976         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2977                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2978                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2979
  2980         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2981                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2982                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2983                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2984                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2985                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  2986                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  2987                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  2988                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  2989
  2990         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  2991               88  EC-BR-REDUCING                   VALUE 'R'.
  2992               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  2993
  2994         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  2995         16  EC-BR-LF-DESC             PIC X(10).
  2996         16  EC-BR-AH-DESC             PIC X(10).
  2997         16  EC-BR-LF-COMMENT          PIC X(10).
  2998         16  EC-BR-AH-COMMENT          PIC X(10).
  2999
  3000         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3001               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3002               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3003               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3004               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3005
  3006         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3007               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3008               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3009               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3010               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3011
  3012         16  EC-BR-LF-REFUND-CALC      PIC X.
  3013                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3014                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3015                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3016                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3017                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3018                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3019                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3020
  3021         16  EC-BR-AH-REFUND-CALC      PIC X.
  3022                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3023                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3024                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3025                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3026                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3027                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3028                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3029                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  58
* EL6311.cbl
  3030
  3031         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3032                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3033                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3034                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3035
  3036         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3037                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3038                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3039                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3040
  3041         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3042         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3043         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3044         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3045
  3046         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3047         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3048                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3049                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3050                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3051                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3052
  3053         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3054               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3055               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3056               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3057               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3058               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3059
  3060         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3061               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3062               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3063               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3064               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3065               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3066
  3067         16  EC-ST-LF-REFUND-CALC      PIC X.
  3068                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3069                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3070                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3071                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3072                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3073                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3074                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3075                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3076
  3077         16  EC-ST-AH-REFUND-CALC      PIC X.
  3078                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3079                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3080                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3081                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3082                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3083                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3084                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3085                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3086
  3087         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  59
* EL6311.cbl
  3088         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3089         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3090         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3091         16  EC-AM-EXPIRATION-DT       PIC XX.
  3092         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3093         16  EC-AM-CLASS-CD            PIC XX.
  3094         16  EC-AM-LF-DEVIATION        PIC XXX.
  3095         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3096         16  EC-AM-AH-DEVIATION        PIC XXX.
  3097         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3098         16  EC-AM-PHONE-NO            PIC X(10).
  3099
  3100         16  EC-AM-LF-REFUND-CALC      PIC X.
  3101                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3102                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3103                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3104                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3105                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3106                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3107                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3108
  3109         16  EC-AM-AH-REFUND-CALC      PIC X.
  3110                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3111                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3112                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3113                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3114                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3115                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3116                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3117
  3118         16  EC-AM-BEN-I-G-CD          PIC X.
  3119                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3120                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3121                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3122
  3123         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3124         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3125         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3126         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3127         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3128         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3129         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3130         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3131         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3132
  3133         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3134         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3135         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3136         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3137         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3138         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3139         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3140         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3141         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3142         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3143         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3144         16  EC-RT-LF-NSP-ST           PIC XX.
  3145         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  60
* EL6311.cbl
  3146         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3147         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3148
  3149         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3150             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3151                                             'M' '5' '9' '2'.
  3152             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3153             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3154             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3155             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3156             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3157             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3158             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3159             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3160             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3161             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3162
  3163         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3164             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3165                                             'M' '5' '9' '2'.
  3166             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3167             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3168             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3169             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3170             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3171             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3172             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3173             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3174             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3175             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3176
  3177         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3178         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3179         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3180         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3181         16  EC-CM-DEATH-DT            PIC XX.
  3182
  3183*DMD CUSTOM CODING FIELDS BELOW
  3184*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3185         16  EC-BR-DMD-RATING-SW       PIC X.
  3186                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3187                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3188                 88  NO-DMD-RATING               VALUE 'N'.
  3189
  3190         16  EC-NEW-CERT               PIC X(11).
  3191         16  EC-NEW-STATE              PIC XX.
  3192         16  FILLER                    PIC X.
  3193*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3194         16  OVER-SHORT-EDIT-FIELDS.
  3195             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3196             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3197             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3198             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3199             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3200             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3201             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3202             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3203             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  61
* EL6311.cbl
  3204         16  FILLER                    PIC X(71).
  3205
  3206******************************************************************
  3207
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  62
* EL6311.cbl
  3209
  3210*    COPY ELCJPFX.
  3211******************************************************************
  3212*                                                                *
  3213*                                                                *
  3214*                            ELCJPFX.                            *
  3215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3216*                            VMOD=2.002                          *
  3217*                                                                *
  3218*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3219*                                                                *
  3220*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3221*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3222*        ELCNTL - CONTROL FILE                                   *
  3223*        ELMSTR - CLAIM MASTERS                                  *
  3224*        ELTRLR - ACTIVITY TRAILERS                              *
  3225*        ELCHKQ - CHECK QUE                                      *
  3226******************************************************************
  3227 01  JOURNAL-RECORD.
  3228     12  JP-USER-ID                  PIC X(4).
  3229     12  JP-FILE-ID                  PIC X(8).
  3230     12  JP-PROGRAM-ID               PIC X(8).
  3231     12  JP-RECORD-TYPE              PIC X.
  3232         88 JP-ADD              VALUE 'A'.
  3233         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3234         88 JP-AFTER-CHANGE     VALUE 'C'.
  3235         88 JP-DELETE           VALUE 'D'.
  3236         88 JP-GENERIC-DELETE   VALUE 'G'.
  3237         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3238         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3239     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3240     12  JP-RECORD-AREA
  3241
  3242
  3243                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  63
* EL6311.cbl
  3245*    COPY ELCAID.
  3246******************************************************************
  3247*                                                                *
  3248*                            ELCAID.                             *
  3249*                            VMOD=2.001                          *
  3250*                                                                *
  3251*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3252*                                                                *
  3253*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3254*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3255******************************************************************
  3256
  3257 01  DFHAID.
  3258   02  DFHNULL   PIC  X  VALUE  ' '.
  3259   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3260   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3261   02  DFHPEN    PIC  X  VALUE  '='.
  3262   02  DFHOPID   PIC  X  VALUE  'W'.
  3263   02  DFHPA1    PIC  X  VALUE  '%'.
  3264   02  DFHPA2    PIC  X  VALUE  '>'.
  3265   02  DFHPA3    PIC  X  VALUE  ','.
  3266   02  DFHPF1    PIC  X  VALUE  '1'.
  3267   02  DFHPF2    PIC  X  VALUE  '2'.
  3268   02  DFHPF3    PIC  X  VALUE  '3'.
  3269   02  DFHPF4    PIC  X  VALUE  '4'.
  3270   02  DFHPF5    PIC  X  VALUE  '5'.
  3271   02  DFHPF6    PIC  X  VALUE  '6'.
  3272   02  DFHPF7    PIC  X  VALUE  '7'.
  3273   02  DFHPF8    PIC  X  VALUE  '8'.
  3274   02  DFHPF9    PIC  X  VALUE  '9'.
  3275   02  DFHPF10   PIC  X  VALUE  ':'.
  3276   02  DFHPF11   PIC  X  VALUE  '#'.
  3277   02  DFHPF12   PIC  X  VALUE  '@'.
  3278   02  DFHPF13   PIC  X  VALUE  'A'.
  3279   02  DFHPF14   PIC  X  VALUE  'B'.
  3280   02  DFHPF15   PIC  X  VALUE  'C'.
  3281   02  DFHPF16   PIC  X  VALUE  'D'.
  3282   02  DFHPF17   PIC  X  VALUE  'E'.
  3283   02  DFHPF18   PIC  X  VALUE  'F'.
  3284   02  DFHPF19   PIC  X  VALUE  'G'.
  3285   02  DFHPF20   PIC  X  VALUE  'H'.
  3286   02  DFHPF21   PIC  X  VALUE  'I'.
  3287*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3288   02  DFHPF22   PIC  X  VALUE  '['.
  3289   02  DFHPF23   PIC  X  VALUE  '.'.
  3290   02  DFHPF24   PIC  X  VALUE  '<'.
  3291   02  DFHMSRE   PIC  X  VALUE  'X'.
  3292   02  DFHSTRF   PIC  X  VALUE  'h'.
  3293   02  DFHTRIG   PIC  X  VALUE  '"'.
  3294
  3295 01  FILLER    REDEFINES DFHAID.
  3296     12  FILLER              PIC X(8).
  3297     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3298
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  64
* EL6311.cbl
  3300*    COPY EL6311S.
  3301 01  EL631BI.
  3302     05  FILLER            PIC  X(0012).
  3303*    -------------------------------
  3304     05  BDATEL PIC S9(0004) COMP.
  3305     05  BDATEF PIC  X(0001).
  3306     05  FILLER REDEFINES BDATEF.
  3307         10  BDATEA PIC  X(0001).
  3308     05  BDATEI PIC  X(0008).
  3309*    -------------------------------
  3310     05  BTIMEL PIC S9(0004) COMP.
  3311     05  BTIMEF PIC  X(0001).
  3312     05  FILLER REDEFINES BTIMEF.
  3313         10  BTIMEA PIC  X(0001).
  3314     05  BTIMEI PIC  X(0005).
  3315*    -------------------------------
  3316     05  BHEADL PIC S9(0004) COMP.
  3317     05  BHEADF PIC  X(0001).
  3318     05  FILLER REDEFINES BHEADF.
  3319         10  BHEADA PIC  X(0001).
  3320     05  BHEADI PIC  X(0038).
  3321*    -------------------------------
  3322     05  BNCERTLL PIC S9(0004) COMP.
  3323     05  BNCERTLF PIC  X(0001).
  3324     05  FILLER REDEFINES BNCERTLF.
  3325         10  BNCERTLA PIC  X(0001).
  3326     05  BNCERTLI PIC  X(0008).
  3327*    -------------------------------
  3328     05  BNCERTL PIC S9(0004) COMP.
  3329     05  BNCERTF PIC  X(0001).
  3330     05  FILLER REDEFINES BNCERTF.
  3331         10  BNCERTA PIC  X(0001).
  3332     05  BNCERTI PIC  X(0011).
  3333*    -------------------------------
  3334     05  BNSTATLL PIC S9(0004) COMP.
  3335     05  BNSTATLF PIC  X(0001).
  3336     05  FILLER REDEFINES BNSTATLF.
  3337         10  BNSTATLA PIC  X(0001).
  3338     05  BNSTATLI PIC  X(0009).
  3339*    -------------------------------
  3340     05  BNSTATL PIC S9(0004) COMP.
  3341     05  BNSTATF PIC  X(0001).
  3342     05  FILLER REDEFINES BNSTATF.
  3343         10  BNSTATA PIC  X(0001).
  3344     05  BNSTATI PIC  X(0002).
  3345*    -------------------------------
  3346     05  BCHGTL PIC S9(0004) COMP.
  3347     05  BCHGTF PIC  X(0001).
  3348     05  FILLER REDEFINES BCHGTF.
  3349         10  BCHGTA PIC  X(0001).
  3350     05  BCHGTI PIC  X(0004).
  3351*    -------------------------------
  3352     05  BCHGL PIC S9(0004) COMP.
  3353     05  BCHGF PIC  X(0001).
  3354     05  FILLER REDEFINES BCHGF.
  3355         10  BCHGA PIC  X(0001).
  3356     05  BCHGI PIC  X(0004).
  3357*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  65
* EL6311.cbl
  3358     05  BMAINTL PIC S9(0004) COMP.
  3359     05  BMAINTF PIC  X(0001).
  3360     05  FILLER REDEFINES BMAINTF.
  3361         10  BMAINTA PIC  X(0001).
  3362     05  BMAINTI PIC  X(0001).
  3363*    -------------------------------
  3364     05  BMANTBYL PIC S9(0004) COMP.
  3365     05  BMANTBYF PIC  X(0001).
  3366     05  FILLER REDEFINES BMANTBYF.
  3367         10  BMANTBYA PIC  X(0001).
  3368     05  BMANTBYI PIC  X(0004).
  3369*    -------------------------------
  3370     05  BCHGHDGL PIC S9(0004) COMP.
  3371     05  BCHGHDGF PIC  X(0001).
  3372     05  FILLER REDEFINES BCHGHDGF.
  3373         10  BCHGHDGA PIC  X(0001).
  3374     05  BCHGHDGI PIC  X(0003).
  3375*    -------------------------------
  3376     05  BMANTDTL PIC S9(0004) COMP.
  3377     05  BMANTDTF PIC  X(0001).
  3378     05  FILLER REDEFINES BMANTDTF.
  3379         10  BMANTDTA PIC  X(0001).
  3380     05  BMANTDTI PIC  X(0008).
  3381*    -------------------------------
  3382     05  BMANTATL PIC S9(0004) COMP.
  3383     05  BMANTATF PIC  X(0001).
  3384     05  FILLER REDEFINES BMANTATF.
  3385         10  BMANTATA PIC  X(0001).
  3386     05  BMANTATI PIC  X(0005).
  3387*    -------------------------------
  3388     05  BCSRL PIC S9(0004) COMP.
  3389     05  BCSRF PIC  X(0001).
  3390     05  FILLER REDEFINES BCSRF.
  3391         10  BCSRA PIC  X(0001).
  3392     05  BCSRI PIC  X(0004).
  3393*    -------------------------------
  3394     05  BBATCHL PIC S9(0004) COMP.
  3395     05  BBATCHF PIC  X(0001).
  3396     05  FILLER REDEFINES BBATCHF.
  3397         10  BBATCHA PIC  X(0001).
  3398     05  BBATCHI PIC  X(0006).
  3399*    -------------------------------
  3400     05  BSEQL PIC S9(0004) COMP.
  3401     05  BSEQF PIC  X(0001).
  3402     05  FILLER REDEFINES BSEQF.
  3403         10  BSEQA PIC  X(0001).
  3404     05  BSEQI PIC  X(0004).
  3405*    -------------------------------
  3406     05  BMOENDTL PIC S9(0004) COMP.
  3407     05  BMOENDTF PIC  X(0001).
  3408     05  FILLER REDEFINES BMOENDTF.
  3409         10  BMOENDTA PIC  X(0001).
  3410     05  BMOENDTI PIC  X(0008).
  3411*    -------------------------------
  3412     05  BCARRL PIC S9(0004) COMP.
  3413     05  BCARRF PIC  X(0001).
  3414     05  FILLER REDEFINES BCARRF.
  3415         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  66
* EL6311.cbl
  3416     05  BCARRI PIC  X(0001).
  3417*    -------------------------------
  3418     05  BGROUPL PIC S9(0004) COMP.
  3419     05  BGROUPF PIC  X(0001).
  3420     05  FILLER REDEFINES BGROUPF.
  3421         10  BGROUPA PIC  X(0001).
  3422     05  BGROUPI PIC  X(0006).
  3423*    -------------------------------
  3424     05  BSTATEL PIC S9(0004) COMP.
  3425     05  BSTATEF PIC  X(0001).
  3426     05  FILLER REDEFINES BSTATEF.
  3427         10  BSTATEA PIC  X(0001).
  3428     05  BSTATEI PIC  X(0002).
  3429*    -------------------------------
  3430     05  BACCTL PIC S9(0004) COMP.
  3431     05  BACCTF PIC  X(0001).
  3432     05  FILLER REDEFINES BACCTF.
  3433         10  BACCTA PIC  X(0001).
  3434     05  BACCTI PIC  X(0010).
  3435*    -------------------------------
  3436     05  BVINHL PIC S9(0004) COMP.
  3437     05  BVINHF PIC  X(0001).
  3438     05  FILLER REDEFINES BVINHF.
  3439         10  BVINHA PIC  X(0001).
  3440     05  BVINHI PIC  X(0004).
  3441*    -------------------------------
  3442     05  BVINL PIC S9(0004) COMP.
  3443     05  BVINF PIC  X(0001).
  3444     05  FILLER REDEFINES BVINF.
  3445         10  BVINA PIC  X(0001).
  3446     05  BVINI PIC  X(0017).
  3447*    -------------------------------
  3448     05  BREFHDGL PIC S9(0004) COMP.
  3449     05  BREFHDGF PIC  X(0001).
  3450     05  FILLER REDEFINES BREFHDGF.
  3451         10  BREFHDGA PIC  X(0001).
  3452     05  BREFHDGI PIC  X(0004).
  3453*    -------------------------------
  3454     05  BREFL PIC S9(0004) COMP.
  3455     05  BREFF PIC  X(0001).
  3456     05  FILLER REDEFINES BREFF.
  3457         10  BREFA PIC  X(0001).
  3458     05  BREFI PIC  X(0012).
  3459*    -------------------------------
  3460     05  BAGEDEFL PIC S9(0004) COMP.
  3461     05  BAGEDEFF PIC  X(0001).
  3462     05  FILLER REDEFINES BAGEDEFF.
  3463         10  BAGEDEFA PIC  X(0001).
  3464     05  BAGEDEFI PIC  X(0004).
  3465*    -------------------------------
  3466     05  BCERTNOL PIC S9(0004) COMP.
  3467     05  BCERTNOF PIC  X(0001).
  3468     05  FILLER REDEFINES BCERTNOF.
  3469         10  BCERTNOA PIC  X(0001).
  3470     05  BCERTNOI PIC  X(0010).
  3471*    -------------------------------
  3472     05  BSUFIXL PIC S9(0004) COMP.
  3473     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  67
* EL6311.cbl
  3474     05  FILLER REDEFINES BSUFIXF.
  3475         10  BSUFIXA PIC  X(0001).
  3476     05  BSUFIXI PIC  X(0001).
  3477*    -------------------------------
  3478     05  BEFFDTL PIC S9(0004) COMP.
  3479     05  BEFFDTF PIC  X(0001).
  3480     05  FILLER REDEFINES BEFFDTF.
  3481         10  BEFFDTA PIC  X(0001).
  3482     05  BEFFDTI PIC  X(0008).
  3483*    -------------------------------
  3484     05  BLSTNML PIC S9(0004) COMP.
  3485     05  BLSTNMF PIC  X(0001).
  3486     05  FILLER REDEFINES BLSTNMF.
  3487         10  BLSTNMA PIC  X(0001).
  3488     05  BLSTNMI PIC  X(0015).
  3489*    -------------------------------
  3490     05  B1STNML PIC S9(0004) COMP.
  3491     05  B1STNMF PIC  X(0001).
  3492     05  FILLER REDEFINES B1STNMF.
  3493         10  B1STNMA PIC  X(0001).
  3494     05  B1STNMI PIC  X(0010).
  3495*    -------------------------------
  3496     05  BINITL PIC S9(0004) COMP.
  3497     05  BINITF PIC  X(0001).
  3498     05  FILLER REDEFINES BINITF.
  3499         10  BINITA PIC  X(0001).
  3500     05  BINITI PIC  X(0001).
  3501*    -------------------------------
  3502     05  BSEXL PIC S9(0004) COMP.
  3503     05  BSEXF PIC  X(0001).
  3504     05  FILLER REDEFINES BSEXF.
  3505         10  BSEXA PIC  X(0001).
  3506     05  BSEXI PIC  X(0001).
  3507*    -------------------------------
  3508     05  BAGEL PIC S9(0004) COMP.
  3509     05  BAGEF PIC  X(0001).
  3510     05  FILLER REDEFINES BAGEF.
  3511         10  BAGEA PIC  X(0001).
  3512     05  BAGEI PIC  X(0002).
  3513*    -------------------------------
  3514     05  BBIRTHL PIC S9(0004) COMP.
  3515     05  BBIRTHF PIC  X(0001).
  3516     05  FILLER REDEFINES BBIRTHF.
  3517         10  BBIRTHA PIC  X(0001).
  3518     05  BBIRTHI PIC  X(0008).
  3519*    -------------------------------
  3520     05  B1STPMTL PIC S9(0004) COMP.
  3521     05  B1STPMTF PIC  X(0001).
  3522     05  FILLER REDEFINES B1STPMTF.
  3523         10  B1STPMTA PIC  X(0001).
  3524     05  B1STPMTI PIC  X(0008).
  3525*    -------------------------------
  3526     05  BDAYSL PIC S9(0004) COMP.
  3527     05  BDAYSF PIC  X(0001).
  3528     05  FILLER REDEFINES BDAYSF.
  3529         10  BDAYSA PIC  X(0001).
  3530     05  BDAYSI PIC  X(0003).
  3531*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  68
* EL6311.cbl
  3532     05  BLNTRML PIC S9(0004) COMP.
  3533     05  BLNTRMF PIC  X(0001).
  3534     05  FILLER REDEFINES BLNTRMF.
  3535         10  BLNTRMA PIC  X(0001).
  3536     05  BLNTRMI PIC  X(0003).
  3537*    -------------------------------
  3538     05  BLNOFCRL PIC S9(0004) COMP.
  3539     05  BLNOFCRF PIC  X(0001).
  3540     05  FILLER REDEFINES BLNOFCRF.
  3541         10  BLNOFCRA PIC  X(0001).
  3542     05  BLNOFCRI PIC  X(0005).
  3543*    -------------------------------
  3544     05  BMODEL PIC S9(0004) COMP.
  3545     05  BMODEF PIC  X(0001).
  3546     05  FILLER REDEFINES BMODEF.
  3547         10  BMODEA PIC  X(0001).
  3548     05  BMODEI PIC  X(0001).
  3549*    -------------------------------
  3550     05  BFREQL PIC S9(0004) COMP.
  3551     05  BFREQF PIC  X(0001).
  3552     05  FILLER REDEFINES BFREQF.
  3553         10  BFREQA PIC  X(0001).
  3554     05  BFREQI PIC  X(0002).
  3555*    -------------------------------
  3556     05  BPMTSL PIC S9(0004) COMP.
  3557     05  BPMTSF PIC  X(0001).
  3558     05  FILLER REDEFINES BPMTSF.
  3559         10  BPMTSA PIC  X(0001).
  3560     05  BPMTSI PIC  999.
  3561*    -------------------------------
  3562     05  BPMTAMTL PIC S9(0004) COMP.
  3563     05  BPMTAMTF PIC  X(0001).
  3564     05  FILLER REDEFINES BPMTAMTF.
  3565         10  BPMTAMTA PIC  X(0001).
  3566     05  BPMTAMTI PIC  9(7)V99.
  3567*    -------------------------------
  3568     05  BAPRL PIC S9(0004) COMP.
  3569     05  BAPRF PIC  X(0001).
  3570     05  FILLER REDEFINES BAPRF.
  3571         10  BAPRA PIC  X(0001).
  3572     05  BAPRI PIC  X(7).
  3573*    -------------------------------
  3574     05  BLIVESL PIC S9(0004) COMP.
  3575     05  BLIVESF PIC  X(0001).
  3576     05  FILLER REDEFINES BLIVESF.
  3577         10  BLIVESA PIC  X(0001).
  3578     05  BLIVESI PIC  X(0009).
  3579*    -------------------------------
  3580     05  BMEMCAPL PIC S9(0004) COMP.
  3581     05  BMEMCAPF PIC  X(0001).
  3582     05  FILLER REDEFINES BMEMCAPF.
  3583         10  BMEMCAPA PIC  X(0001).
  3584     05  BMEMCAPI PIC  X(0011).
  3585*    -------------------------------
  3586     05  BORIGHDL PIC S9(0004) COMP.
  3587     05  BORIGHDF PIC  X(0001).
  3588     05  FILLER REDEFINES BORIGHDF.
  3589         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  69
* EL6311.cbl
  3590     05  BORIGHDI PIC  X(0009).
  3591*    -------------------------------
  3592     05  DMDBILL PIC S9(0004) COMP.
  3593     05  DMDBILF PIC  X(0001).
  3594     05  FILLER REDEFINES DMDBILF.
  3595         10  DMDBILA PIC  X(0001).
  3596     05  DMDBILI PIC  X(0006).
  3597*    -------------------------------
  3598     05  BFORCEL PIC S9(0004) COMP.
  3599     05  BFORCEF PIC  X(0001).
  3600     05  FILLER REDEFINES BFORCEF.
  3601         10  BFORCEA PIC  X(0001).
  3602     05  BFORCEI PIC  X(0001).
  3603*    -------------------------------
  3604     05  BENTRYL PIC S9(0004) COMP.
  3605     05  BENTRYF PIC  X(0001).
  3606     05  FILLER REDEFINES BENTRYF.
  3607         10  BENTRYA PIC  X(0001).
  3608     05  BENTRYI PIC  X(0001).
  3609*    -------------------------------
  3610     05  BREINL PIC S9(0004) COMP.
  3611     05  BREINF PIC  X(0001).
  3612     05  FILLER REDEFINES BREINF.
  3613         10  BREINA PIC  X(0001).
  3614     05  BREINI PIC  X(0001).
  3615*    -------------------------------
  3616     05  BBILCDL PIC S9(0004) COMP.
  3617     05  BBILCDF PIC  X(0001).
  3618     05  FILLER REDEFINES BBILCDF.
  3619         10  BBILCDA PIC  X(0001).
  3620     05  BBILCDI PIC  X(0001).
  3621*    -------------------------------
  3622     05  BUNWRITL PIC S9(0004) COMP.
  3623     05  BUNWRITF PIC  X(0001).
  3624     05  FILLER REDEFINES BUNWRITF.
  3625         10  BUNWRITA PIC  X(0001).
  3626     05  BUNWRITI PIC  X(0001).
  3627*    -------------------------------
  3628     05  BSKPCDL PIC S9(0004) COMP.
  3629     05  BSKPCDF PIC  X(0001).
  3630     05  FILLER REDEFINES BSKPCDF.
  3631         10  BSKPCDA PIC  X(0001).
  3632     05  BSKPCDI PIC  X(0001).
  3633*    -------------------------------
  3634     05  BINDGRPL PIC S9(0004) COMP.
  3635     05  BINDGRPF PIC  X(0001).
  3636     05  FILLER REDEFINES BINDGRPF.
  3637         10  BINDGRPA PIC  X(0001).
  3638     05  BINDGRPI PIC  X(0001).
  3639*    -------------------------------
  3640     05  BSIGL PIC S9(0004) COMP.
  3641     05  BSIGF PIC  X(0001).
  3642     05  FILLER REDEFINES BSIGF.
  3643         10  BSIGA PIC  X(0001).
  3644     05  BSIGI PIC  X(0001).
  3645*    -------------------------------
  3646     05  BRTCLSL PIC S9(0004) COMP.
  3647     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  70
* EL6311.cbl
  3648     05  FILLER REDEFINES BRTCLSF.
  3649         10  BRTCLSA PIC  X(0001).
  3650     05  BRTCLSI PIC  X(0002).
  3651*    -------------------------------
  3652     05  BCHGCNTL PIC S9(0004) COMP.
  3653     05  BCHGCNTF PIC  X(0001).
  3654     05  FILLER REDEFINES BCHGCNTF.
  3655         10  BCHGCNTA PIC  X(0001).
  3656     05  BCHGCNTI PIC  X(0003).
  3657*    -------------------------------
  3658     05  BMEMBERL PIC S9(0004) COMP.
  3659     05  BMEMBERF PIC  X(0001).
  3660     05  FILLER REDEFINES BMEMBERF.
  3661         10  BMEMBERA PIC  X(0001).
  3662     05  BMEMBERI PIC  X(0012).
  3663*    -------------------------------
  3664     05  BORGNOL PIC S9(0004) COMP.
  3665     05  BORGNOF PIC  X(0001).
  3666     05  FILLER REDEFINES BORGNOF.
  3667         10  BORGNOA PIC  X(0001).
  3668     05  BORGNOI PIC  X(0006).
  3669*    -------------------------------
  3670     05  BORGSEQL PIC S9(0004) COMP.
  3671     05  BORGSEQF PIC  X(0001).
  3672     05  FILLER REDEFINES BORGSEQF.
  3673         10  BORGSEQA PIC  X(0001).
  3674     05  BORGSEQI PIC  X(0004).
  3675*    -------------------------------
  3676     05  BBILLEDL PIC S9(0004) COMP.
  3677     05  BBILLEDF PIC  X(0001).
  3678     05  FILLER REDEFINES BBILLEDF.
  3679         10  BBILLEDA PIC  X(0001).
  3680     05  BBILLEDI PIC  9(9).
  3681*    -------------------------------
  3682     05  BKIND1L PIC S9(0004) COMP.
  3683     05  BKIND1F PIC  X(0001).
  3684     05  FILLER REDEFINES BKIND1F.
  3685         10  BKIND1A PIC  X(0001).
  3686     05  BKIND1I PIC  X(0002).
  3687*    -------------------------------
  3688     05  BTYPE1L PIC S9(0004) COMP.
  3689     05  BTYPE1F PIC  X(0001).
  3690     05  FILLER REDEFINES BTYPE1F.
  3691         10  BTYPE1A PIC  X(0001).
  3692     05  BTYPE1I PIC  X(0003).
  3693*    -------------------------------
  3694     05  BTERM1L PIC S9(0004) COMP.
  3695     05  BTERM1F PIC  X(0001).
  3696     05  FILLER REDEFINES BTERM1F.
  3697         10  BTERM1A PIC  X(0001).
  3698     05  BTERM1I PIC  X(0003).
  3699*    -------------------------------
  3700     05  BBEN1L PIC S9(0004) COMP.
  3701     05  BBEN1F PIC  X(0001).
  3702     05  FILLER REDEFINES BBEN1F.
  3703         10  BBEN1A PIC  X(0001).
  3704     05  BBEN1I PIC  X(0012).
  3705*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  71
* EL6311.cbl
  3706     05  BPREM1L PIC S9(0004) COMP.
  3707     05  BPREM1F PIC  X(0001).
  3708     05  FILLER REDEFINES BPREM1F.
  3709         10  BPREM1A PIC  X(0001).
  3710     05  BPREM1I PIC  X(0011).
  3711*    -------------------------------
  3712     05  BEXPIR1L PIC S9(0004) COMP.
  3713     05  BEXPIR1F PIC  X(0001).
  3714     05  FILLER REDEFINES BEXPIR1F.
  3715         10  BEXPIR1A PIC  X(0001).
  3716     05  BEXPIR1I PIC  X(0008).
  3717*    -------------------------------
  3718     05  BCP1L PIC S9(0004) COMP.
  3719     05  BCP1F PIC  X(0001).
  3720     05  FILLER REDEFINES BCP1F.
  3721         10  BCP1A PIC  X(0001).
  3722     05  BCP1I PIC  X(0002).
  3723*    -------------------------------
  3724     05  BALTBN1L PIC S9(0004) COMP.
  3725     05  BALTBN1F PIC  X(0001).
  3726     05  FILLER REDEFINES BALTBN1F.
  3727         10  BALTBN1A PIC  X(0001).
  3728     05  BALTBN1I PIC  X(0012).
  3729*    -------------------------------
  3730     05  BALTPR1L PIC S9(0004) COMP.
  3731     05  BALTPR1F PIC  X(0001).
  3732     05  FILLER REDEFINES BALTPR1F.
  3733         10  BALTPR1A PIC  X(0001).
  3734     05  BALTPR1I PIC  X(0011).
  3735*    -------------------------------
  3736     05  BBNCD1L PIC S9(0004) COMP.
  3737     05  BBNCD1F PIC  X(0001).
  3738     05  FILLER REDEFINES BBNCD1F.
  3739         10  BBNCD1A PIC  X(0001).
  3740     05  BBNCD1I PIC  X(0003).
  3741*    -------------------------------
  3742     05  BCPRM1L PIC S9(0004) COMP.
  3743     05  BCPRM1F PIC  X(0001).
  3744     05  FILLER REDEFINES BCPRM1F.
  3745         10  BCPRM1A PIC  X(0001).
  3746     05  BCPRM1I PIC  X(0011).
  3747*    -------------------------------
  3748     05  BCAPRM1L PIC S9(0004) COMP.
  3749     05  BCAPRM1F PIC  X(0001).
  3750     05  FILLER REDEFINES BCAPRM1F.
  3751         10  BCAPRM1A PIC  X(0001).
  3752     05  BCAPRM1I PIC  X(0011).
  3753*    -------------------------------
  3754     05  BENABR1L PIC S9(0004) COMP.
  3755     05  BENABR1F PIC  X(0001).
  3756     05  FILLER REDEFINES BENABR1F.
  3757         10  BENABR1A PIC  X(0001).
  3758     05  BENABR1I PIC  X(0005).
  3759*    -------------------------------
  3760     05  BDIFF1L PIC S9(0004) COMP.
  3761     05  BDIFF1F PIC  X(0001).
  3762     05  FILLER REDEFINES BDIFF1F.
  3763         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  72
* EL6311.cbl
  3764     05  BDIFF1I PIC  X(0011).
  3765*    -------------------------------
  3766     05  BBILIT1L PIC S9(0004) COMP.
  3767     05  BBILIT1F PIC  X(0001).
  3768     05  FILLER REDEFINES BBILIT1F.
  3769         10  BBILIT1A PIC  X(0001).
  3770     05  BBILIT1I PIC  X(0008).
  3771*    -------------------------------
  3772     05  BADIFF1L PIC S9(0004) COMP.
  3773     05  BADIFF1F PIC  X(0001).
  3774     05  FILLER REDEFINES BADIFF1F.
  3775         10  BADIFF1A PIC  X(0001).
  3776     05  BADIFF1I PIC  X(0011).
  3777*    -------------------------------
  3778     05  BKIND2L PIC S9(0004) COMP.
  3779     05  BKIND2F PIC  X(0001).
  3780     05  FILLER REDEFINES BKIND2F.
  3781         10  BKIND2A PIC  X(0001).
  3782     05  BKIND2I PIC  X(0002).
  3783*    -------------------------------
  3784     05  BTYPE2L PIC S9(0004) COMP.
  3785     05  BTYPE2F PIC  X(0001).
  3786     05  FILLER REDEFINES BTYPE2F.
  3787         10  BTYPE2A PIC  X(0001).
  3788     05  BTYPE2I PIC  X(0003).
  3789*    -------------------------------
  3790     05  BTERM2L PIC S9(0004) COMP.
  3791     05  BTERM2F PIC  X(0001).
  3792     05  FILLER REDEFINES BTERM2F.
  3793         10  BTERM2A PIC  X(0001).
  3794     05  BTERM2I PIC  X(0003).
  3795*    -------------------------------
  3796     05  BBEN2L PIC S9(0004) COMP.
  3797     05  BBEN2F PIC  X(0001).
  3798     05  FILLER REDEFINES BBEN2F.
  3799         10  BBEN2A PIC  X(0001).
  3800     05  BBEN2I PIC  X(0012).
  3801*    -------------------------------
  3802     05  BPREM2L PIC S9(0004) COMP.
  3803     05  BPREM2F PIC  X(0001).
  3804     05  FILLER REDEFINES BPREM2F.
  3805         10  BPREM2A PIC  X(0001).
  3806     05  BPREM2I PIC  X(0011).
  3807*    -------------------------------
  3808     05  BEXPIR2L PIC S9(0004) COMP.
  3809     05  BEXPIR2F PIC  X(0001).
  3810     05  FILLER REDEFINES BEXPIR2F.
  3811         10  BEXPIR2A PIC  X(0001).
  3812     05  BEXPIR2I PIC  X(0008).
  3813*    -------------------------------
  3814     05  BCP2L PIC S9(0004) COMP.
  3815     05  BCP2F PIC  X(0001).
  3816     05  FILLER REDEFINES BCP2F.
  3817         10  BCP2A PIC  X(0001).
  3818     05  BCP2I PIC  X(0002).
  3819*    -------------------------------
  3820     05  BALTBN2L PIC S9(0004) COMP.
  3821     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  73
* EL6311.cbl
  3822     05  FILLER REDEFINES BALTBN2F.
  3823         10  BALTBN2A PIC  X(0001).
  3824     05  BALTBN2I PIC  X(0012).
  3825*    -------------------------------
  3826     05  BALTPR2L PIC S9(0004) COMP.
  3827     05  BALTPR2F PIC  X(0001).
  3828     05  FILLER REDEFINES BALTPR2F.
  3829         10  BALTPR2A PIC  X(0001).
  3830     05  BALTPR2I PIC  X(0011).
  3831*    -------------------------------
  3832     05  BBNCD2L PIC S9(0004) COMP.
  3833     05  BBNCD2F PIC  X(0001).
  3834     05  FILLER REDEFINES BBNCD2F.
  3835         10  BBNCD2A PIC  X(0001).
  3836     05  BBNCD2I PIC  X(0003).
  3837*    -------------------------------
  3838     05  BCPRM2L PIC S9(0004) COMP.
  3839     05  BCPRM2F PIC  X(0001).
  3840     05  FILLER REDEFINES BCPRM2F.
  3841         10  BCPRM2A PIC  X(0001).
  3842     05  BCPRM2I PIC  X(0011).
  3843*    -------------------------------
  3844     05  BCAPRM2L PIC S9(0004) COMP.
  3845     05  BCAPRM2F PIC  X(0001).
  3846     05  FILLER REDEFINES BCAPRM2F.
  3847         10  BCAPRM2A PIC  X(0001).
  3848     05  BCAPRM2I PIC  X(0011).
  3849*    -------------------------------
  3850     05  BENABR2L PIC S9(0004) COMP.
  3851     05  BENABR2F PIC  X(0001).
  3852     05  FILLER REDEFINES BENABR2F.
  3853         10  BENABR2A PIC  X(0001).
  3854     05  BENABR2I PIC  X(0005).
  3855*    -------------------------------
  3856     05  BDIFF2L PIC S9(0004) COMP.
  3857     05  BDIFF2F PIC  X(0001).
  3858     05  FILLER REDEFINES BDIFF2F.
  3859         10  BDIFF2A PIC  X(0001).
  3860     05  BDIFF2I PIC  X(0011).
  3861*    -------------------------------
  3862     05  BBILIT2L PIC S9(0004) COMP.
  3863     05  BBILIT2F PIC  X(0001).
  3864     05  FILLER REDEFINES BBILIT2F.
  3865         10  BBILIT2A PIC  X(0001).
  3866     05  BBILIT2I PIC  X(0008).
  3867*    -------------------------------
  3868     05  BADIFF2L PIC S9(0004) COMP.
  3869     05  BADIFF2F PIC  X(0001).
  3870     05  FILLER REDEFINES BADIFF2F.
  3871         10  BADIFF2A PIC  X(0001).
  3872     05  BADIFF2I PIC  X(0011).
  3873*    -------------------------------
  3874     05  BERMSG1L PIC S9(0004) COMP.
  3875     05  BERMSG1F PIC  X(0001).
  3876     05  FILLER REDEFINES BERMSG1F.
  3877         10  BERMSG1A PIC  X(0001).
  3878     05  BERMSG1I PIC  X(0078).
  3879*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  74
* EL6311.cbl
  3880     05  BERMSG2L PIC S9(0004) COMP.
  3881     05  BERMSG2F PIC  X(0001).
  3882     05  FILLER REDEFINES BERMSG2F.
  3883         10  BERMSG2A PIC  X(0001).
  3884     05  BERMSG2I PIC  X(0078).
  3885*    -------------------------------
  3886     05  BERMSG3L PIC S9(0004) COMP.
  3887     05  BERMSG3F PIC  X(0001).
  3888     05  FILLER REDEFINES BERMSG3F.
  3889         10  BERMSG3A PIC  X(0001).
  3890     05  BERMSG3I PIC  X(0078).
  3891*    -------------------------------
  3892     05  BPFENTRL PIC S9(0004) COMP.
  3893     05  BPFENTRF PIC  X(0001).
  3894     05  FILLER REDEFINES BPFENTRF.
  3895         10  BPFENTRA PIC  X(0001).
  3896     05  BPFENTRI PIC  9(2).
  3897*    -------------------------------
  3898     05  BPF5HDRL PIC S9(0004) COMP.
  3899     05  BPF5HDRF PIC  X(0001).
  3900     05  FILLER REDEFINES BPF5HDRF.
  3901         10  BPF5HDRA PIC  X(0001).
  3902     05  BPF5HDRI PIC  X(0005).
  3903*    -------------------------------
  3904     05  BPF4HDRL PIC S9(0004) COMP.
  3905     05  BPF4HDRF PIC  X(0001).
  3906     05  FILLER REDEFINES BPF4HDRF.
  3907         10  BPF4HDRA PIC  X(0001).
  3908     05  BPF4HDRI PIC  X(0013).
  3909*    -------------------------------
  3910     05  BF15HDRL PIC S9(0004) COMP.
  3911     05  BF15HDRF PIC  X(0001).
  3912     05  FILLER REDEFINES BF15HDRF.
  3913         10  BF15HDRA PIC  X(0001).
  3914     05  BF15HDRI PIC  X(0010).
  3915 01  EL631BO REDEFINES EL631BI.
  3916     05  FILLER            PIC  X(0012).
  3917*    -------------------------------
  3918     05  FILLER            PIC  X(0003).
  3919     05  BDATEO PIC  X(0008).
  3920*    -------------------------------
  3921     05  FILLER            PIC  X(0003).
  3922     05  BTIMEO PIC  99.99.
  3923*    -------------------------------
  3924     05  FILLER            PIC  X(0003).
  3925     05  BHEADO PIC  X(0038).
  3926*    -------------------------------
  3927     05  FILLER            PIC  X(0003).
  3928     05  BNCERTLO PIC  X(0008).
  3929*    -------------------------------
  3930     05  FILLER            PIC  X(0003).
  3931     05  BNCERTO PIC  X(0011).
  3932*    -------------------------------
  3933     05  FILLER            PIC  X(0003).
  3934     05  BNSTATLO PIC  X(0009).
  3935*    -------------------------------
  3936     05  FILLER            PIC  X(0003).
  3937     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  75
* EL6311.cbl
  3938*    -------------------------------
  3939     05  FILLER            PIC  X(0003).
  3940     05  BCHGTO PIC  X(0004).
  3941*    -------------------------------
  3942     05  FILLER            PIC  X(0003).
  3943     05  BCHGO PIC  ZZZ9.
  3944*    -------------------------------
  3945     05  FILLER            PIC  X(0003).
  3946     05  BMAINTO PIC  X(0001).
  3947*    -------------------------------
  3948     05  FILLER            PIC  X(0003).
  3949     05  BMANTBYO PIC  X(0004).
  3950*    -------------------------------
  3951     05  FILLER            PIC  X(0003).
  3952     05  BCHGHDGO PIC  X(0003).
  3953*    -------------------------------
  3954     05  FILLER            PIC  X(0003).
  3955     05  BMANTDTO PIC  X(0008).
  3956*    -------------------------------
  3957     05  FILLER            PIC  X(0003).
  3958     05  BMANTATO PIC  99.99.
  3959*    -------------------------------
  3960     05  FILLER            PIC  X(0003).
  3961     05  BCSRO PIC  X(0004).
  3962*    -------------------------------
  3963     05  FILLER            PIC  X(0003).
  3964     05  BBATCHO PIC  X(0006).
  3965*    -------------------------------
  3966     05  FILLER            PIC  X(0003).
  3967     05  BSEQO PIC  X(0004).
  3968*    -------------------------------
  3969     05  FILLER            PIC  X(0003).
  3970     05  BMOENDTO PIC  X(0008).
  3971*    -------------------------------
  3972     05  FILLER            PIC  X(0003).
  3973     05  BCARRO PIC  X(0001).
  3974*    -------------------------------
  3975     05  FILLER            PIC  X(0003).
  3976     05  BGROUPO PIC  X(0006).
  3977*    -------------------------------
  3978     05  FILLER            PIC  X(0003).
  3979     05  BSTATEO PIC  X(0002).
  3980*    -------------------------------
  3981     05  FILLER            PIC  X(0003).
  3982     05  BACCTO PIC  X(0010).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BVINHO PIC  X(0004).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BVINO PIC  X(0017).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BREFHDGO PIC  X(0004).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BREFO PIC  X(0012).
  3995*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  76
* EL6311.cbl
  3996     05  FILLER            PIC  X(0003).
  3997     05  BAGEDEFO PIC  X(0004).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BCERTNOO PIC  X(0010).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BSUFIXO PIC  X(0001).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BEFFDTO PIC  X(0008).
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BLSTNMO PIC  X(0015).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  B1STNMO PIC  X(0010).
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BINITO PIC  X(0001).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BSEXO PIC  X(0001).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BAGEO PIC  X(0002).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BBIRTHO PIC  X(0008).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  B1STPMTO PIC  X(0008).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BDAYSO PIC  X(0003).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BLNTRMO PIC  X(0003).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BLNOFCRO PIC  X(0005).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BMODEO PIC  X(0001).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BFREQO PIC  X(0002).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BPMTSO PIC  X(0003).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BPMTAMTO PIC  ZZZZZ9.99.
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BAPRO PIC  99.9999.
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  77
* EL6311.cbl
  4054     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BMEMCAPO PIC  X(0011).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BORIGHDO PIC  X(0009).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  DMDBILO PIC  X(0006).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BFORCEO PIC  X(0001).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BENTRYO PIC  X(0001).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BREINO PIC  X(0001).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BBILCDO PIC  X(0001).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BUNWRITO PIC  X(0001).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BSKPCDO PIC  X(0001).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BINDGRPO PIC  X(0001).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BSIGO PIC  X(0001).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BRTCLSO PIC  X(0002).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  BCHGCNTO PIC  X(0003).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BMEMBERO PIC  X(0012).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BORGNOO PIC  X(0006).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BORGSEQO PIC  X(0004).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BKIND1O PIC  X(0002).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  78
* EL6311.cbl
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BTERM1O PIC  X(0003).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BBEN1O PIC  X(0012).
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BPREM1O PIC  X(0011).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BEXPIR1O PIC  X(0008).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BCP1O PIC  X(0002).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BALTBN1O PIC  X(0012).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BALTPR1O PIC  X(0011).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BBNCD1O PIC  X(0003).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BCPRM1O PIC  X(0011).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BCAPRM1O PIC  X(0011).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BENABR1O PIC  X(0005).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BDIFF1O PIC  X(0011).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BBILIT1O PIC  X(0008).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BADIFF1O PIC  X(0011).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BKIND2O PIC  X(0002).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BTYPE2O PIC  X(0003).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BTERM2O PIC  X(0003).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BBEN2O PIC  X(0012).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BPREM2O PIC  X(0011).
  4169*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  79
* EL6311.cbl
  4170     05  FILLER            PIC  X(0003).
  4171     05  BEXPIR2O PIC  X(0008).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BCP2O PIC  X(0002).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BALTBN2O PIC  X(0012).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BALTPR2O PIC  X(0011).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BBNCD2O PIC  X(0003).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BCPRM2O PIC  X(0011).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BCAPRM2O PIC  X(0011).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BENABR2O PIC  X(0005).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BDIFF2O PIC  X(0011).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BBILIT2O PIC  X(0008).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BADIFF2O PIC  X(0011).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BERMSG1O PIC  X(0078).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BERMSG2O PIC  X(0078).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BERMSG3O PIC  X(0078).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BPFENTRO PIC  X(0002).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BPF5HDRO PIC  X(0005).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BPF4HDRO PIC  X(0013).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BF15HDRO PIC  X(0010).
  4223*    -------------------------------
  4224 01  EL631CI REDEFINES EL631BI.
  4225     05  FILLER            PIC  X(0012).
  4226*    -------------------------------
  4227     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  80
* EL6311.cbl
  4228     05  CDATEF PIC  X(0001).
  4229     05  FILLER REDEFINES CDATEF.
  4230         10  CDATEA PIC  X(0001).
  4231     05  CDATEI PIC  X(0008).
  4232*    -------------------------------
  4233     05  CTIMEL PIC S9(0004) COMP.
  4234     05  CTIMEF PIC  X(0001).
  4235     05  FILLER REDEFINES CTIMEF.
  4236         10  CTIMEA PIC  X(0001).
  4237     05  CTIMEI PIC  X(0005).
  4238*    -------------------------------
  4239     05  CHEADL PIC S9(0004) COMP.
  4240     05  CHEADF PIC  X(0001).
  4241     05  FILLER REDEFINES CHEADF.
  4242         10  CHEADA PIC  X(0001).
  4243     05  CHEADI PIC  X(0038).
  4244*    -------------------------------
  4245     05  CCHGTL PIC S9(0004) COMP.
  4246     05  CCHGTF PIC  X(0001).
  4247     05  FILLER REDEFINES CCHGTF.
  4248         10  CCHGTA PIC  X(0001).
  4249     05  CCHGTI PIC  X(0004).
  4250*    -------------------------------
  4251     05  CCHGL PIC S9(0004) COMP.
  4252     05  CCHGF PIC  X(0001).
  4253     05  FILLER REDEFINES CCHGF.
  4254         10  CCHGA PIC  X(0001).
  4255     05  CCHGI PIC  X(0004).
  4256*    -------------------------------
  4257     05  CMAINTL PIC S9(0004) COMP.
  4258     05  CMAINTF PIC  X(0001).
  4259     05  FILLER REDEFINES CMAINTF.
  4260         10  CMAINTA PIC  X(0001).
  4261     05  CMAINTI PIC  X(0001).
  4262*    -------------------------------
  4263     05  CMANTBYL PIC S9(0004) COMP.
  4264     05  CMANTBYF PIC  X(0001).
  4265     05  FILLER REDEFINES CMANTBYF.
  4266         10  CMANTBYA PIC  X(0001).
  4267     05  CMANTBYI PIC  X(0004).
  4268*    -------------------------------
  4269     05  CCHGHDGL PIC S9(0004) COMP.
  4270     05  CCHGHDGF PIC  X(0001).
  4271     05  FILLER REDEFINES CCHGHDGF.
  4272         10  CCHGHDGA PIC  X(0001).
  4273     05  CCHGHDGI PIC  X(0003).
  4274*    -------------------------------
  4275     05  CMANTDTL PIC S9(0004) COMP.
  4276     05  CMANTDTF PIC  X(0001).
  4277     05  FILLER REDEFINES CMANTDTF.
  4278         10  CMANTDTA PIC  X(0001).
  4279     05  CMANTDTI PIC  X(0008).
  4280*    -------------------------------
  4281     05  CMANTATL PIC S9(0004) COMP.
  4282     05  CMANTATF PIC  X(0001).
  4283     05  FILLER REDEFINES CMANTATF.
  4284         10  CMANTATA PIC  X(0001).
  4285     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  81
* EL6311.cbl
  4286*    -------------------------------
  4287     05  CCSRL PIC S9(0004) COMP.
  4288     05  CCSRF PIC  X(0001).
  4289     05  FILLER REDEFINES CCSRF.
  4290         10  CCSRA PIC  X(0001).
  4291     05  CCSRI PIC  X(0004).
  4292*    -------------------------------
  4293     05  CBATCHL PIC S9(0004) COMP.
  4294     05  CBATCHF PIC  X(0001).
  4295     05  FILLER REDEFINES CBATCHF.
  4296         10  CBATCHA PIC  X(0001).
  4297     05  CBATCHI PIC  X(0006).
  4298*    -------------------------------
  4299     05  CSEQL PIC S9(0004) COMP.
  4300     05  CSEQF PIC  X(0001).
  4301     05  FILLER REDEFINES CSEQF.
  4302         10  CSEQA PIC  X(0001).
  4303     05  CSEQI PIC  X(0004).
  4304*    -------------------------------
  4305     05  CMOENDTL PIC S9(0004) COMP.
  4306     05  CMOENDTF PIC  X(0001).
  4307     05  FILLER REDEFINES CMOENDTF.
  4308         10  CMOENDTA PIC  X(0001).
  4309     05  CMOENDTI PIC  X(0008).
  4310*    -------------------------------
  4311     05  CCARRL PIC S9(0004) COMP.
  4312     05  CCARRF PIC  X(0001).
  4313     05  FILLER REDEFINES CCARRF.
  4314         10  CCARRA PIC  X(0001).
  4315     05  CCARRI PIC  X(0001).
  4316*    -------------------------------
  4317     05  CGROUPL PIC S9(0004) COMP.
  4318     05  CGROUPF PIC  X(0001).
  4319     05  FILLER REDEFINES CGROUPF.
  4320         10  CGROUPA PIC  X(0001).
  4321     05  CGROUPI PIC  X(0006).
  4322*    -------------------------------
  4323     05  CSTATEL PIC S9(0004) COMP.
  4324     05  CSTATEF PIC  X(0001).
  4325     05  FILLER REDEFINES CSTATEF.
  4326         10  CSTATEA PIC  X(0001).
  4327     05  CSTATEI PIC  X(0002).
  4328*    -------------------------------
  4329     05  CACCTL PIC S9(0004) COMP.
  4330     05  CACCTF PIC  X(0001).
  4331     05  FILLER REDEFINES CACCTF.
  4332         10  CACCTA PIC  X(0001).
  4333     05  CACCTI PIC  X(0010).
  4334*    -------------------------------
  4335     05  CORIGHDL PIC S9(0004) COMP.
  4336     05  CORIGHDF PIC  X(0001).
  4337     05  FILLER REDEFINES CORIGHDF.
  4338         10  CORIGHDA PIC  X(0001).
  4339     05  CORIGHDI PIC  X(0011).
  4340*    -------------------------------
  4341     05  CORGNOL PIC S9(0004) COMP.
  4342     05  CORGNOF PIC  X(0001).
  4343     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  82
* EL6311.cbl
  4344         10  CORGNOA PIC  X(0001).
  4345     05  CORGNOI PIC  X(0006).
  4346*    -------------------------------
  4347     05  CORGSEQL PIC S9(0004) COMP.
  4348     05  CORGSEQF PIC  X(0001).
  4349     05  FILLER REDEFINES CORGSEQF.
  4350         10  CORGSEQA PIC  X(0001).
  4351     05  CORGSEQI PIC  X(0004).
  4352*    -------------------------------
  4353     05  CREFHDGL PIC S9(0004) COMP.
  4354     05  CREFHDGF PIC  X(0001).
  4355     05  FILLER REDEFINES CREFHDGF.
  4356         10  CREFHDGA PIC  X(0001).
  4357     05  CREFHDGI PIC  X(0010).
  4358*    -------------------------------
  4359     05  CREFL PIC S9(0004) COMP.
  4360     05  CREFF PIC  X(0001).
  4361     05  FILLER REDEFINES CREFF.
  4362         10  CREFA PIC  X(0001).
  4363     05  CREFI PIC  X(0012).
  4364*    -------------------------------
  4365     05  CNHINTL PIC S9(0004) COMP.
  4366     05  CNHINTF PIC  X(0001).
  4367     05  FILLER REDEFINES CNHINTF.
  4368         10  CNHINTA PIC  X(0001).
  4369     05  CNHINTI PIC  9(7)V99.
  4370*    -------------------------------
  4371     05  CCERTNOL PIC S9(0004) COMP.
  4372     05  CCERTNOF PIC  X(0001).
  4373     05  FILLER REDEFINES CCERTNOF.
  4374         10  CCERTNOA PIC  X(0001).
  4375     05  CCERTNOI PIC  X(0010).
  4376*    -------------------------------
  4377     05  CSUFIXL PIC S9(0004) COMP.
  4378     05  CSUFIXF PIC  X(0001).
  4379     05  FILLER REDEFINES CSUFIXF.
  4380         10  CSUFIXA PIC  X(0001).
  4381     05  CSUFIXI PIC  X(0001).
  4382*    -------------------------------
  4383     05  CEFFDTL PIC S9(0004) COMP.
  4384     05  CEFFDTF PIC  X(0001).
  4385     05  FILLER REDEFINES CEFFDTF.
  4386         10  CEFFDTA PIC  X(0001).
  4387     05  CEFFDTI PIC  X(0008).
  4388*    -------------------------------
  4389     05  CLSTNML PIC S9(0004) COMP.
  4390     05  CLSTNMF PIC  X(0001).
  4391     05  FILLER REDEFINES CLSTNMF.
  4392         10  CLSTNMA PIC  X(0001).
  4393     05  CLSTNMI PIC  X(0015).
  4394*    -------------------------------
  4395     05  CPCYNL PIC S9(0004) COMP.
  4396     05  CPCYNF PIC  X(0001).
  4397     05  FILLER REDEFINES CPCYNF.
  4398         10  CPCYNA PIC  X(0001).
  4399     05  CPCYNI PIC  X(0001).
  4400*    -------------------------------
  4401     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  83
* EL6311.cbl
  4402     05  CINAMEF PIC  X(0001).
  4403     05  FILLER REDEFINES CINAMEF.
  4404         10  CINAMEA PIC  X(0001).
  4405     05  CINAMEI PIC  X(0015).
  4406*    -------------------------------
  4407     05  CINITSL PIC S9(0004) COMP.
  4408     05  CINITSF PIC  X(0001).
  4409     05  FILLER REDEFINES CINITSF.
  4410         10  CINITSA PIC  X(0001).
  4411     05  CINITSI PIC  X(0010).
  4412*    -------------------------------
  4413     05  CCANREAL PIC S9(0004) COMP.
  4414     05  CCANREAF PIC  X(0001).
  4415     05  FILLER REDEFINES CCANREAF.
  4416         10  CCANREAA PIC  X(0001).
  4417     05  CCANREAI PIC  X(0001).
  4418*    -------------------------------
  4419     05  CKIND1L PIC S9(0004) COMP.
  4420     05  CKIND1F PIC  X(0001).
  4421     05  FILLER REDEFINES CKIND1F.
  4422         10  CKIND1A PIC  X(0001).
  4423     05  CKIND1I PIC  X(0002).
  4424*    -------------------------------
  4425     05  CCANDT1L PIC S9(0004) COMP.
  4426     05  CCANDT1F PIC  X(0001).
  4427     05  FILLER REDEFINES CCANDT1F.
  4428         10  CCANDT1A PIC  X(0001).
  4429     05  CCANDT1I PIC  X(0008).
  4430*    -------------------------------
  4431     05  CREFND1L PIC S9(0004) COMP.
  4432     05  CREFND1F PIC  X(0001).
  4433     05  FILLER REDEFINES CREFND1F.
  4434         10  CREFND1A PIC  X(0001).
  4435     05  CREFND1I PIC  S9(9)V99.
  4436*    -------------------------------
  4437     05  CMTHD1L PIC S9(0004) COMP.
  4438     05  CMTHD1F PIC  X(0001).
  4439     05  FILLER REDEFINES CMTHD1F.
  4440         10  CMTHD1A PIC  X(0001).
  4441     05  CMTHD1I PIC  X(0001).
  4442*    -------------------------------
  4443     05  CKIND2L PIC S9(0004) COMP.
  4444     05  CKIND2F PIC  X(0001).
  4445     05  FILLER REDEFINES CKIND2F.
  4446         10  CKIND2A PIC  X(0001).
  4447     05  CKIND2I PIC  X(0002).
  4448*    -------------------------------
  4449     05  CCANDT2L PIC S9(0004) COMP.
  4450     05  CCANDT2F PIC  X(0001).
  4451     05  FILLER REDEFINES CCANDT2F.
  4452         10  CCANDT2A PIC  X(0001).
  4453     05  CCANDT2I PIC  X(0008).
  4454*    -------------------------------
  4455     05  CREFND2L PIC S9(0004) COMP.
  4456     05  CREFND2F PIC  X(0001).
  4457     05  FILLER REDEFINES CREFND2F.
  4458         10  CREFND2A PIC  X(0001).
  4459     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  84
* EL6311.cbl
  4460*    -------------------------------
  4461     05  CMTHD2L PIC S9(0004) COMP.
  4462     05  CMTHD2F PIC  X(0001).
  4463     05  FILLER REDEFINES CMTHD2F.
  4464         10  CMTHD2A PIC  X(0001).
  4465     05  CMTHD2I PIC  X(0001).
  4466*    -------------------------------
  4467     05  CLIVESL PIC S9(0004) COMP.
  4468     05  CLIVESF PIC  X(0001).
  4469     05  FILLER REDEFINES CLIVESF.
  4470         10  CLIVESA PIC  X(0001).
  4471     05  CLIVESI PIC  X(0003).
  4472*    -------------------------------
  4473     05  CFORCEL PIC S9(0004) COMP.
  4474     05  CFORCEF PIC  X(0001).
  4475     05  FILLER REDEFINES CFORCEF.
  4476         10  CFORCEA PIC  X(0001).
  4477     05  CFORCEI PIC  X(0001).
  4478*    -------------------------------
  4479     05  CBILCDL PIC S9(0004) COMP.
  4480     05  CBILCDF PIC  X(0001).
  4481     05  FILLER REDEFINES CBILCDF.
  4482         10  CBILCDA PIC  X(0001).
  4483     05  CBILCDI PIC  X(0001).
  4484*    -------------------------------
  4485     05  CCRFND1L PIC S9(0004) COMP.
  4486     05  CCRFND1F PIC  X(0001).
  4487     05  FILLER REDEFINES CCRFND1F.
  4488         10  CCRFND1A PIC  X(0001).
  4489     05  CCRFND1I PIC  X(0011).
  4490*    -------------------------------
  4491     05  CCRFND2L PIC S9(0004) COMP.
  4492     05  CCRFND2F PIC  X(0001).
  4493     05  FILLER REDEFINES CCRFND2F.
  4494         10  CCRFND2A PIC  X(0001).
  4495     05  CCRFND2I PIC  X(0011).
  4496*    -------------------------------
  4497     05  CBILIT1L PIC S9(0004) COMP.
  4498     05  CBILIT1F PIC  X(0001).
  4499     05  FILLER REDEFINES CBILIT1F.
  4500         10  CBILIT1A PIC  X(0001).
  4501     05  CBILIT1I PIC  X(0008).
  4502*    -------------------------------
  4503     05  CDRFND1L PIC S9(0004) COMP.
  4504     05  CDRFND1F PIC  X(0001).
  4505     05  FILLER REDEFINES CDRFND1F.
  4506         10  CDRFND1A PIC  X(0001).
  4507     05  CDRFND1I PIC  X(0011).
  4508*    -------------------------------
  4509     05  CBILIT2L PIC S9(0004) COMP.
  4510     05  CBILIT2F PIC  X(0001).
  4511     05  FILLER REDEFINES CBILIT2F.
  4512         10  CBILIT2A PIC  X(0001).
  4513     05  CBILIT2I PIC  X(0008).
  4514*    -------------------------------
  4515     05  CDRFND2L PIC S9(0004) COMP.
  4516     05  CDRFND2F PIC  X(0001).
  4517     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  85
* EL6311.cbl
  4518         10  CDRFND2A PIC  X(0001).
  4519     05  CDRFND2I PIC  X(0011).
  4520*    -------------------------------
  4521     05  CCANTXTL PIC S9(0004) COMP.
  4522     05  CCANTXTF PIC  X(0001).
  4523     05  FILLER REDEFINES CCANTXTF.
  4524         10  CCANTXTA PIC  X(0001).
  4525     05  CCANTXTI PIC  X(0005).
  4526*    -------------------------------
  4527     05  CCANFEEL PIC S9(0004) COMP.
  4528     05  CCANFEEF PIC  X(0001).
  4529     05  FILLER REDEFINES CCANFEEF.
  4530         10  CCANFEEA PIC  X(0001).
  4531     05  CCANFEEI PIC  X(0002).
  4532*    -------------------------------
  4533     05  CTERM1L PIC S9(0004) COMP.
  4534     05  CTERM1F PIC  X(0001).
  4535     05  FILLER REDEFINES CTERM1F.
  4536         10  CTERM1A PIC  X(0001).
  4537     05  CTERM1I PIC  X(0003).
  4538*    -------------------------------
  4539     05  CRTERM1L PIC S9(0004) COMP.
  4540     05  CRTERM1F PIC  X(0001).
  4541     05  FILLER REDEFINES CRTERM1F.
  4542         10  CRTERM1A PIC  X(0001).
  4543     05  CRTERM1I PIC  X(0003).
  4544*    -------------------------------
  4545     05  CPREM1L PIC S9(0004) COMP.
  4546     05  CPREM1F PIC  X(0001).
  4547     05  FILLER REDEFINES CPREM1F.
  4548         10  CPREM1A PIC  X(0001).
  4549     05  CPREM1I PIC  X(0011).
  4550*    -------------------------------
  4551     05  CTERM2L PIC S9(0004) COMP.
  4552     05  CTERM2F PIC  X(0001).
  4553     05  FILLER REDEFINES CTERM2F.
  4554         10  CTERM2A PIC  X(0001).
  4555     05  CTERM2I PIC  X(0003).
  4556*    -------------------------------
  4557     05  CRTERM2L PIC S9(0004) COMP.
  4558     05  CRTERM2F PIC  X(0001).
  4559     05  FILLER REDEFINES CRTERM2F.
  4560         10  CRTERM2A PIC  X(0001).
  4561     05  CRTERM2I PIC  X(0003).
  4562*    -------------------------------
  4563     05  CPREM2L PIC S9(0004) COMP.
  4564     05  CPREM2F PIC  X(0001).
  4565     05  FILLER REDEFINES CPREM2F.
  4566         10  CPREM2A PIC  X(0001).
  4567     05  CPREM2I PIC  X(0011).
  4568*    -------------------------------
  4569     05  CENTRDTL PIC S9(0004) COMP.
  4570     05  CENTRDTF PIC  X(0001).
  4571     05  FILLER REDEFINES CENTRDTF.
  4572         10  CENTRDTA PIC  X(0001).
  4573     05  CENTRDTI PIC  X(0008).
  4574*    -------------------------------
  4575     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  86
* EL6311.cbl
  4576     05  CPAYEEF PIC  X(0001).
  4577     05  FILLER REDEFINES CPAYEEF.
  4578         10  CPAYEEA PIC  X(0001).
  4579     05  CPAYEEI PIC  X(0006).
  4580*    -------------------------------
  4581     05  CRFNDSWL PIC S9(0004) COMP.
  4582     05  CRFNDSWF PIC  X(0001).
  4583     05  FILLER REDEFINES CRFNDSWF.
  4584         10  CRFNDSWA PIC  X(0001).
  4585     05  CRFNDSWI PIC  X(0003).
  4586*    -------------------------------
  4587     05  CLFHDGL PIC S9(0004) COMP.
  4588     05  CLFHDGF PIC  X(0001).
  4589     05  FILLER REDEFINES CLFHDGF.
  4590         10  CLFHDGA PIC  X(0001).
  4591     05  CLFHDGI PIC  X(0006).
  4592*    -------------------------------
  4593     05  CAHHDGL PIC S9(0004) COMP.
  4594     05  CAHHDGF PIC  X(0001).
  4595     05  FILLER REDEFINES CAHHDGF.
  4596         10  CAHHDGA PIC  X(0001).
  4597     05  CAHHDGI PIC  X(0006).
  4598*    -------------------------------
  4599     05  CENTDTL PIC S9(0004) COMP.
  4600     05  CENTDTF PIC  X(0001).
  4601     05  FILLER REDEFINES CENTDTF.
  4602         10  CENTDTA PIC  X(0001).
  4603     05  CENTDTI PIC  X(0008).
  4604*    -------------------------------
  4605     05  CENTBYL PIC S9(0004) COMP.
  4606     05  CENTBYF PIC  X(0001).
  4607     05  FILLER REDEFINES CENTBYF.
  4608         10  CENTBYA PIC  X(0001).
  4609     05  CENTBYI PIC  X(0004).
  4610*    -------------------------------
  4611     05  CCHGCNTL PIC S9(0004) COMP.
  4612     05  CCHGCNTF PIC  X(0001).
  4613     05  FILLER REDEFINES CCHGCNTF.
  4614         10  CCHGCNTA PIC  X(0001).
  4615     05  CCHGCNTI PIC  X(0003).
  4616*    -------------------------------
  4617     05  CLFREFNL PIC S9(0004) COMP.
  4618     05  CLFREFNF PIC  X(0001).
  4619     05  FILLER REDEFINES CLFREFNF.
  4620         10  CLFREFNA PIC  X(0001).
  4621     05  CLFREFNI PIC  X(0006).
  4622*    -------------------------------
  4623     05  CAHREFNL PIC S9(0004) COMP.
  4624     05  CAHREFNF PIC  X(0001).
  4625     05  FILLER REDEFINES CAHREFNF.
  4626         10  CAHREFNA PIC  X(0001).
  4627     05  CAHREFNI PIC  X(0006).
  4628*    -------------------------------
  4629     05  CREINCDL PIC S9(0004) COMP.
  4630     05  CREINCDF PIC  X(0001).
  4631     05  FILLER REDEFINES CREINCDF.
  4632         10  CREINCDA PIC  X(0001).
  4633     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  87
* EL6311.cbl
  4634*    -------------------------------
  4635     05  CAEFFDTL PIC S9(0004) COMP.
  4636     05  CAEFFDTF PIC  X(0001).
  4637     05  FILLER REDEFINES CAEFFDTF.
  4638         10  CAEFFDTA PIC  X(0001).
  4639     05  CAEFFDTI PIC  X(0008).
  4640*    -------------------------------
  4641     05  CAEXPDTL PIC S9(0004) COMP.
  4642     05  CAEXPDTF PIC  X(0001).
  4643     05  FILLER REDEFINES CAEXPDTF.
  4644         10  CAEXPDTA PIC  X(0001).
  4645     05  CAEXPDTI PIC  X(0008).
  4646*    -------------------------------
  4647     05  COMMLFL PIC S9(0004) COMP.
  4648     05  COMMLFF PIC  X(0001).
  4649     05  FILLER REDEFINES COMMLFF.
  4650         10  COMMLFA PIC  X(0001).
  4651     05  COMMLFI PIC  X(0006).
  4652*    -------------------------------
  4653     05  COMMAHL PIC S9(0004) COMP.
  4654     05  COMMAHF PIC  X(0001).
  4655     05  FILLER REDEFINES COMMAHF.
  4656         10  COMMAHA PIC  X(0001).
  4657     05  COMMAHI PIC  X(0006).
  4658*    -------------------------------
  4659     05  CERMSG1L PIC S9(0004) COMP.
  4660     05  CERMSG1F PIC  X(0001).
  4661     05  FILLER REDEFINES CERMSG1F.
  4662         10  CERMSG1A PIC  X(0001).
  4663     05  CERMSG1I PIC  X(0078).
  4664*    -------------------------------
  4665     05  CERMSG2L PIC S9(0004) COMP.
  4666     05  CERMSG2F PIC  X(0001).
  4667     05  FILLER REDEFINES CERMSG2F.
  4668         10  CERMSG2A PIC  X(0001).
  4669     05  CERMSG2I PIC  X(0078).
  4670*    -------------------------------
  4671     05  CERMSG3L PIC S9(0004) COMP.
  4672     05  CERMSG3F PIC  X(0001).
  4673     05  FILLER REDEFINES CERMSG3F.
  4674         10  CERMSG3A PIC  X(0001).
  4675     05  CERMSG3I PIC  X(0078).
  4676*    -------------------------------
  4677     05  CPFENTRL PIC S9(0004) COMP.
  4678     05  CPFENTRF PIC  X(0001).
  4679     05  FILLER REDEFINES CPFENTRF.
  4680         10  CPFENTRA PIC  X(0001).
  4681     05  CPFENTRI PIC  9(2).
  4682*    -------------------------------
  4683     05  CPF5HDRL PIC S9(0004) COMP.
  4684     05  CPF5HDRF PIC  X(0001).
  4685     05  FILLER REDEFINES CPF5HDRF.
  4686         10  CPF5HDRA PIC  X(0001).
  4687     05  CPF5HDRI PIC  X(0005).
  4688*    -------------------------------
  4689     05  CPF4HDRL PIC S9(0004) COMP.
  4690     05  CPF4HDRF PIC  X(0001).
  4691     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  88
* EL6311.cbl
  4692         10  CPF4HDRA PIC  X(0001).
  4693     05  CPF4HDRI PIC  X(0013).
  4694*    -------------------------------
  4695     05  CF15HDRL PIC S9(0004) COMP.
  4696     05  CF15HDRF PIC  X(0001).
  4697     05  FILLER REDEFINES CF15HDRF.
  4698         10  CF15HDRA PIC  X(0001).
  4699     05  CF15HDRI PIC  X(0022).
  4700 01  EL631CO REDEFINES EL631BI.
  4701     05  FILLER            PIC  X(0012).
  4702*    -------------------------------
  4703     05  FILLER            PIC  X(0003).
  4704     05  CDATEO PIC  X(0008).
  4705*    -------------------------------
  4706     05  FILLER            PIC  X(0003).
  4707     05  CTIMEO PIC  99.99.
  4708*    -------------------------------
  4709     05  FILLER            PIC  X(0003).
  4710     05  CHEADO PIC  X(0038).
  4711*    -------------------------------
  4712     05  FILLER            PIC  X(0003).
  4713     05  CCHGTO PIC  X(0004).
  4714*    -------------------------------
  4715     05  FILLER            PIC  X(0003).
  4716     05  CCHGO PIC  ZZZ9.
  4717*    -------------------------------
  4718     05  FILLER            PIC  X(0003).
  4719     05  CMAINTO PIC  X(0001).
  4720*    -------------------------------
  4721     05  FILLER            PIC  X(0003).
  4722     05  CMANTBYO PIC  X(0004).
  4723*    -------------------------------
  4724     05  FILLER            PIC  X(0003).
  4725     05  CCHGHDGO PIC  X(0003).
  4726*    -------------------------------
  4727     05  FILLER            PIC  X(0003).
  4728     05  CMANTDTO PIC  X(0008).
  4729*    -------------------------------
  4730     05  FILLER            PIC  X(0003).
  4731     05  CMANTATO PIC  99.99.
  4732*    -------------------------------
  4733     05  FILLER            PIC  X(0003).
  4734     05  CCSRO PIC  X(0004).
  4735*    -------------------------------
  4736     05  FILLER            PIC  X(0003).
  4737     05  CBATCHO PIC  X(0006).
  4738*    -------------------------------
  4739     05  FILLER            PIC  X(0003).
  4740     05  CSEQO PIC  X(0004).
  4741*    -------------------------------
  4742     05  FILLER            PIC  X(0003).
  4743     05  CMOENDTO PIC  X(0008).
  4744*    -------------------------------
  4745     05  FILLER            PIC  X(0003).
  4746     05  CCARRO PIC  X(0001).
  4747*    -------------------------------
  4748     05  FILLER            PIC  X(0003).
  4749     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  89
* EL6311.cbl
  4750*    -------------------------------
  4751     05  FILLER            PIC  X(0003).
  4752     05  CSTATEO PIC  X(0002).
  4753*    -------------------------------
  4754     05  FILLER            PIC  X(0003).
  4755     05  CACCTO PIC  X(0010).
  4756*    -------------------------------
  4757     05  FILLER            PIC  X(0003).
  4758     05  CORIGHDO PIC  X(0011).
  4759*    -------------------------------
  4760     05  FILLER            PIC  X(0003).
  4761     05  CORGNOO PIC  X(0006).
  4762*    -------------------------------
  4763     05  FILLER            PIC  X(0003).
  4764     05  CORGSEQO PIC  X(0004).
  4765*    -------------------------------
  4766     05  FILLER            PIC  X(0003).
  4767     05  CREFHDGO PIC  X(0010).
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CREFO PIC  X(0012).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CNHINTO PIC  999999.99.
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CCERTNOO PIC  X(0010).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CSUFIXO PIC  X(0001).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CEFFDTO PIC  X(0008).
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CLSTNMO PIC  X(0015).
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CPCYNO PIC  X(0001).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CINAMEO PIC  X(0015).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CINITSO PIC  X(0010).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CCANREAO PIC  X(0001).
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CKIND1O PIC  X(0002).
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CCANDT1O PIC  X(0008).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CREFND1O PIC  Z(7).99-.
  4807*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  90
* EL6311.cbl
  4808     05  FILLER            PIC  X(0003).
  4809     05  CMTHD1O PIC  X(0001).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CKIND2O PIC  X(0002).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CCANDT2O PIC  X(0008).
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CREFND2O PIC  Z(7).99-.
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CMTHD2O PIC  X(0001).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CLIVESO PIC  X(0003).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CFORCEO PIC  X(0001).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CBILCDO PIC  X(0001).
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CCRFND1O PIC  Z(7).99-.
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CCRFND2O PIC  Z(7).99-.
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CBILIT1O PIC  X(0008).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CDRFND1O PIC  Z(7).99-.
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CBILIT2O PIC  X(0008).
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CDRFND2O PIC  Z(7).99-.
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CCANTXTO PIC  X(0005).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CCANFEEO PIC  Z9.
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CTERM1O PIC  ZZ9.
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CRTERM1O PIC  ZZ9.
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CPREM1O PIC  ZZZZZZ9.99-.
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  91
* EL6311.cbl
  4866     05  CTERM2O PIC  ZZ9.
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CRTERM2O PIC  ZZ9.
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CPREM2O PIC  ZZZZZZ9.99-.
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CENTRDTO PIC  X(0008).
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  CPAYEEO PIC  X(0006).
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CRFNDSWO PIC  X(0003).
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CLFHDGO PIC  X(0006).
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CAHHDGO PIC  X(0006).
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CENTDTO PIC  X(0008).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CENTBYO PIC  X(0004).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CCHGCNTO PIC  X(0003).
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CLFREFNO PIC  X(0006).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CAHREFNO PIC  X(0006).
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
  4905     05  CREINCDO PIC  X(0003).
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CAEFFDTO PIC  X(0008).
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CAEXPDTO PIC  X(0008).
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  COMMLFO PIC  .99999.
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  COMMAHO PIC  .99999.
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CERMSG1O PIC  X(0078).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  92
* EL6311.cbl
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CERMSG3O PIC  X(0078).
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CPFENTRO PIC  X(0002).
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CPF5HDRO PIC  X(0005).
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CPF4HDRO PIC  X(0013).
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CF15HDRO PIC  X(0022).
  4939*    -------------------------------
  4940 01  EL631DI REDEFINES EL631BI.
  4941     05  FILLER            PIC  X(0012).
  4942*    -------------------------------
  4943     05  DDATEL PIC S9(0004) COMP.
  4944     05  DDATEF PIC  X(0001).
  4945     05  FILLER REDEFINES DDATEF.
  4946         10  DDATEA PIC  X(0001).
  4947     05  DDATEI PIC  X(0008).
  4948*    -------------------------------
  4949     05  DTIMEL PIC S9(0004) COMP.
  4950     05  DTIMEF PIC  X(0001).
  4951     05  FILLER REDEFINES DTIMEF.
  4952         10  DTIMEA PIC  X(0001).
  4953     05  DTIMEI PIC  X(0005).
  4954*    -------------------------------
  4955     05  DHEADL PIC S9(0004) COMP.
  4956     05  DHEADF PIC  X(0001).
  4957     05  FILLER REDEFINES DHEADF.
  4958         10  DHEADA PIC  X(0001).
  4959     05  DHEADI PIC  X(0038).
  4960*    -------------------------------
  4961     05  DLDATEL PIC S9(0004) COMP.
  4962     05  DLDATEF PIC  X(0001).
  4963     05  FILLER REDEFINES DLDATEF.
  4964         10  DLDATEA PIC  X(0001).
  4965     05  DLDATEI PIC  X(0010).
  4966*    -------------------------------
  4967     05  DBATCHL PIC S9(0004) COMP.
  4968     05  DBATCHF PIC  X(0001).
  4969     05  FILLER REDEFINES DBATCHF.
  4970         10  DBATCHA PIC  X(0001).
  4971     05  DBATCHI PIC  X(0011).
  4972*    -------------------------------
  4973     05  DACCTNML PIC S9(0004) COMP.
  4974     05  DACCTNMF PIC  X(0001).
  4975     05  FILLER REDEFINES DACCTNMF.
  4976         10  DACCTNMA PIC  X(0001).
  4977     05  DACCTNMI PIC  X(0030).
  4978*    -------------------------------
  4979     05  DPROCDTL PIC S9(0004) COMP.
  4980     05  DPROCDTF PIC  X(0001).
  4981     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  93
* EL6311.cbl
  4982         10  DPROCDTA PIC  X(0001).
  4983     05  DPROCDTI PIC  X(0008).
  4984*    -------------------------------
  4985     05  DINPUTL PIC S9(0004) COMP.
  4986     05  DINPUTF PIC  X(0001).
  4987     05  FILLER REDEFINES DINPUTF.
  4988         10  DINPUTA PIC  X(0001).
  4989     05  DINPUTI PIC  X(0008).
  4990*    -------------------------------
  4991     05  DMAINDTL PIC S9(0004) COMP.
  4992     05  DMAINDTF PIC  X(0001).
  4993     05  FILLER REDEFINES DMAINDTF.
  4994         10  DMAINDTA PIC  X(0001).
  4995     05  DMAINDTI PIC  X(0008).
  4996*    -------------------------------
  4997     05  DCARRL PIC S9(0004) COMP.
  4998     05  DCARRF PIC  X(0001).
  4999     05  FILLER REDEFINES DCARRF.
  5000         10  DCARRA PIC  X(0001).
  5001     05  DCARRI PIC  X(0001).
  5002*    -------------------------------
  5003     05  DGROUPL PIC S9(0004) COMP.
  5004     05  DGROUPF PIC  X(0001).
  5005     05  FILLER REDEFINES DGROUPF.
  5006         10  DGROUPA PIC  X(0001).
  5007     05  DGROUPI PIC  X(0006).
  5008*    -------------------------------
  5009     05  DSTATEL PIC S9(0004) COMP.
  5010     05  DSTATEF PIC  X(0001).
  5011     05  FILLER REDEFINES DSTATEF.
  5012         10  DSTATEA PIC  X(0001).
  5013     05  DSTATEI PIC  X(0002).
  5014*    -------------------------------
  5015     05  DACCTL PIC S9(0004) COMP.
  5016     05  DACCTF PIC  X(0001).
  5017     05  FILLER REDEFINES DACCTF.
  5018         10  DACCTA PIC  X(0001).
  5019     05  DACCTI PIC  X(0010).
  5020*    -------------------------------
  5021     05  DRECVDTL PIC S9(0004) COMP.
  5022     05  DRECVDTF PIC  X(0001).
  5023     05  FILLER REDEFINES DRECVDTF.
  5024         10  DRECVDTA PIC  X(0001).
  5025     05  DRECVDTI PIC  X(0008).
  5026*    -------------------------------
  5027     05  DCSRL PIC S9(0004) COMP.
  5028     05  DCSRF PIC  X(0001).
  5029     05  FILLER REDEFINES DCSRF.
  5030         10  DCSRA PIC  X(0001).
  5031     05  DCSRI PIC  X(0004).
  5032*    -------------------------------
  5033     05  DREFHDGL PIC S9(0004) COMP.
  5034     05  DREFHDGF PIC  X(0001).
  5035     05  FILLER REDEFINES DREFHDGF.
  5036         10  DREFHDGA PIC  X(0001).
  5037     05  DREFHDGI PIC  X(0010).
  5038*    -------------------------------
  5039     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  94
* EL6311.cbl
  5040     05  DREFF PIC  X(0001).
  5041     05  FILLER REDEFINES DREFF.
  5042         10  DREFA PIC  X(0001).
  5043     05  DREFI PIC  X(0012).
  5044*    -------------------------------
  5045     05  DLFPHDGL PIC S9(0004) COMP.
  5046     05  DLFPHDGF PIC  X(0001).
  5047     05  FILLER REDEFINES DLFPHDGF.
  5048         10  DLFPHDGA PIC  X(0001).
  5049     05  DLFPHDGI PIC  X(0010).
  5050*    -------------------------------
  5051     05  DAHPHDGL PIC S9(0004) COMP.
  5052     05  DAHPHDGF PIC  X(0001).
  5053     05  FILLER REDEFINES DAHPHDGF.
  5054         10  DAHPHDGA PIC  X(0001).
  5055     05  DAHPHDGI PIC  X(0010).
  5056*    -------------------------------
  5057     05  DLFRHDGL PIC S9(0004) COMP.
  5058     05  DLFRHDGF PIC  X(0001).
  5059     05  FILLER REDEFINES DLFRHDGF.
  5060         10  DLFRHDGA PIC  X(0001).
  5061     05  DLFRHDGI PIC  X(0009).
  5062*    -------------------------------
  5063     05  DAHRHDGL PIC S9(0004) COMP.
  5064     05  DAHRHDGF PIC  X(0001).
  5065     05  FILLER REDEFINES DAHRHDGF.
  5066         10  DAHRHDGA PIC  X(0001).
  5067     05  DAHRHDGI PIC  X(0009).
  5068*    -------------------------------
  5069     05  DRISSL PIC S9(0004) COMP.
  5070     05  DRISSF PIC  X(0001).
  5071     05  FILLER REDEFINES DRISSF.
  5072         10  DRISSA PIC  X(0001).
  5073     05  DRISSI PIC  X(0005).
  5074*    -------------------------------
  5075     05  DRLFPRML PIC S9(0004) COMP.
  5076     05  DRLFPRMF PIC  X(0001).
  5077     05  FILLER REDEFINES DRLFPRMF.
  5078         10  DRLFPRMA PIC  X(0001).
  5079     05  DRLFPRMI PIC  S9(9)V99.
  5080*    -------------------------------
  5081     05  DRAHPRML PIC S9(0004) COMP.
  5082     05  DRAHPRMF PIC  X(0001).
  5083     05  FILLER REDEFINES DRAHPRMF.
  5084         10  DRAHPRMA PIC  X(0001).
  5085     05  DRAHPRMI PIC  S9(9)V99.
  5086*    -------------------------------
  5087     05  DRCANCL PIC S9(0004) COMP.
  5088     05  DRCANCF PIC  X(0001).
  5089     05  FILLER REDEFINES DRCANCF.
  5090         10  DRCANCA PIC  X(0001).
  5091     05  DRCANCI PIC  X(0005).
  5092*    -------------------------------
  5093     05  DRLFRFDL PIC S9(0004) COMP.
  5094     05  DRLFRFDF PIC  X(0001).
  5095     05  FILLER REDEFINES DRLFRFDF.
  5096         10  DRLFRFDA PIC  X(0001).
  5097     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  95
* EL6311.cbl
  5098*    -------------------------------
  5099     05  DRAHRFDL PIC S9(0004) COMP.
  5100     05  DRAHRFDF PIC  X(0001).
  5101     05  FILLER REDEFINES DRAHRFDF.
  5102         10  DRAHRFDA PIC  X(0001).
  5103     05  DRAHRFDI PIC  S9(9)V99.
  5104*    -------------------------------
  5105     05  DEISSL PIC S9(0004) COMP.
  5106     05  DEISSF PIC  X(0001).
  5107     05  FILLER REDEFINES DEISSF.
  5108         10  DEISSA PIC  X(0001).
  5109     05  DEISSI PIC  X(0005).
  5110*    -------------------------------
  5111     05  DELFPRML PIC S9(0004) COMP.
  5112     05  DELFPRMF PIC  X(0001).
  5113     05  FILLER REDEFINES DELFPRMF.
  5114         10  DELFPRMA PIC  X(0001).
  5115     05  DELFPRMI PIC  X(0011).
  5116*    -------------------------------
  5117     05  DEAHPRML PIC S9(0004) COMP.
  5118     05  DEAHPRMF PIC  X(0001).
  5119     05  FILLER REDEFINES DEAHPRMF.
  5120         10  DEAHPRMA PIC  X(0001).
  5121     05  DEAHPRMI PIC  X(0011).
  5122*    -------------------------------
  5123     05  DECANCL PIC S9(0004) COMP.
  5124     05  DECANCF PIC  X(0001).
  5125     05  FILLER REDEFINES DECANCF.
  5126         10  DECANCA PIC  X(0001).
  5127     05  DECANCI PIC  X(0005).
  5128*    -------------------------------
  5129     05  DELFRFDL PIC S9(0004) COMP.
  5130     05  DELFRFDF PIC  X(0001).
  5131     05  FILLER REDEFINES DELFRFDF.
  5132         10  DELFRFDA PIC  X(0001).
  5133     05  DELFRFDI PIC  X(0011).
  5134*    -------------------------------
  5135     05  DEAHRFDL PIC S9(0004) COMP.
  5136     05  DEAHRFDF PIC  X(0001).
  5137     05  FILLER REDEFINES DEAHRFDF.
  5138         10  DEAHRFDA PIC  X(0001).
  5139     05  DEAHRFDI PIC  X(0011).
  5140*    -------------------------------
  5141     05  DCISSL PIC S9(0004) COMP.
  5142     05  DCISSF PIC  X(0001).
  5143     05  FILLER REDEFINES DCISSF.
  5144         10  DCISSA PIC  X(0001).
  5145     05  DCISSI PIC  X(0005).
  5146*    -------------------------------
  5147     05  DCLFPRML PIC S9(0004) COMP.
  5148     05  DCLFPRMF PIC  X(0001).
  5149     05  FILLER REDEFINES DCLFPRMF.
  5150         10  DCLFPRMA PIC  X(0001).
  5151     05  DCLFPRMI PIC  X(0011).
  5152*    -------------------------------
  5153     05  DCAHPRML PIC S9(0004) COMP.
  5154     05  DCAHPRMF PIC  X(0001).
  5155     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  96
* EL6311.cbl
  5156         10  DCAHPRMA PIC  X(0001).
  5157     05  DCAHPRMI PIC  X(0011).
  5158*    -------------------------------
  5159     05  DCCANCL PIC S9(0004) COMP.
  5160     05  DCCANCF PIC  X(0001).
  5161     05  FILLER REDEFINES DCCANCF.
  5162         10  DCCANCA PIC  X(0001).
  5163     05  DCCANCI PIC  X(0005).
  5164*    -------------------------------
  5165     05  DCLFRFDL PIC S9(0004) COMP.
  5166     05  DCLFRFDF PIC  X(0001).
  5167     05  FILLER REDEFINES DCLFRFDF.
  5168         10  DCLFRFDA PIC  X(0001).
  5169     05  DCLFRFDI PIC  X(0011).
  5170*    -------------------------------
  5171     05  DCAHRFDL PIC S9(0004) COMP.
  5172     05  DCAHRFDF PIC  X(0001).
  5173     05  FILLER REDEFINES DCAHRFDF.
  5174         10  DCAHRFDA PIC  X(0001).
  5175     05  DCAHRFDI PIC  X(0011).
  5176*    -------------------------------
  5177     05  DOISSL PIC S9(0004) COMP.
  5178     05  DOISSF PIC  X(0001).
  5179     05  FILLER REDEFINES DOISSF.
  5180         10  DOISSA PIC  X(0001).
  5181     05  DOISSI PIC  X(0005).
  5182*    -------------------------------
  5183     05  DOLFPRML PIC S9(0004) COMP.
  5184     05  DOLFPRMF PIC  X(0001).
  5185     05  FILLER REDEFINES DOLFPRMF.
  5186         10  DOLFPRMA PIC  X(0001).
  5187     05  DOLFPRMI PIC  X(0011).
  5188*    -------------------------------
  5189     05  DOAHPRML PIC S9(0004) COMP.
  5190     05  DOAHPRMF PIC  X(0001).
  5191     05  FILLER REDEFINES DOAHPRMF.
  5192         10  DOAHPRMA PIC  X(0001).
  5193     05  DOAHPRMI PIC  X(0011).
  5194*    -------------------------------
  5195     05  DOCANCL PIC S9(0004) COMP.
  5196     05  DOCANCF PIC  X(0001).
  5197     05  FILLER REDEFINES DOCANCF.
  5198         10  DOCANCA PIC  X(0001).
  5199     05  DOCANCI PIC  X(0005).
  5200*    -------------------------------
  5201     05  DOLFRFDL PIC S9(0004) COMP.
  5202     05  DOLFRFDF PIC  X(0001).
  5203     05  FILLER REDEFINES DOLFRFDF.
  5204         10  DOLFRFDA PIC  X(0001).
  5205     05  DOLFRFDI PIC  X(0011).
  5206*    -------------------------------
  5207     05  DOAHRFDL PIC S9(0004) COMP.
  5208     05  DOAHRFDF PIC  X(0001).
  5209     05  FILLER REDEFINES DOAHRFDF.
  5210         10  DOAHRFDA PIC  X(0001).
  5211     05  DOAHRFDI PIC  X(0011).
  5212*    -------------------------------
  5213     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  97
* EL6311.cbl
  5214     05  DITOTALF PIC  X(0001).
  5215     05  FILLER REDEFINES DITOTALF.
  5216         10  DITOTALA PIC  X(0001).
  5217     05  DITOTALI PIC  X(0005).
  5218*    -------------------------------
  5219     05  DIFATALL PIC S9(0004) COMP.
  5220     05  DIFATALF PIC  X(0001).
  5221     05  FILLER REDEFINES DIFATALF.
  5222         10  DIFATALA PIC  X(0001).
  5223     05  DIFATALI PIC  X(0005).
  5224*    -------------------------------
  5225     05  DIFORCEL PIC S9(0004) COMP.
  5226     05  DIFORCEF PIC  X(0001).
  5227     05  FILLER REDEFINES DIFORCEF.
  5228         10  DIFORCEA PIC  X(0001).
  5229     05  DIFORCEI PIC  X(0005).
  5230*    -------------------------------
  5231     05  DIHOLDL PIC S9(0004) COMP.
  5232     05  DIHOLDF PIC  X(0001).
  5233     05  FILLER REDEFINES DIHOLDF.
  5234         10  DIHOLDA PIC  X(0001).
  5235     05  DIHOLDI PIC  X(0005).
  5236*    -------------------------------
  5237     05  DIAVAILL PIC S9(0004) COMP.
  5238     05  DIAVAILF PIC  X(0001).
  5239     05  FILLER REDEFINES DIAVAILF.
  5240         10  DIAVAILA PIC  X(0001).
  5241     05  DIAVAILI PIC  X(0005).
  5242*    -------------------------------
  5243     05  DIGPREML PIC S9(0004) COMP.
  5244     05  DIGPREMF PIC  X(0001).
  5245     05  FILLER REDEFINES DIGPREMF.
  5246         10  DIGPREMA PIC  X(0001).
  5247     05  DIGPREMI PIC  X(0011).
  5248*    -------------------------------
  5249     05  DIBPREML PIC S9(0004) COMP.
  5250     05  DIBPREMF PIC  X(0001).
  5251     05  FILLER REDEFINES DIBPREMF.
  5252         10  DIBPREMA PIC  X(0001).
  5253     05  DIBPREMI PIC  X(0011).
  5254*    -------------------------------
  5255     05  DCTOTALL PIC S9(0004) COMP.
  5256     05  DCTOTALF PIC  X(0001).
  5257     05  FILLER REDEFINES DCTOTALF.
  5258         10  DCTOTALA PIC  X(0001).
  5259     05  DCTOTALI PIC  X(0005).
  5260*    -------------------------------
  5261     05  DCFATALL PIC S9(0004) COMP.
  5262     05  DCFATALF PIC  X(0001).
  5263     05  FILLER REDEFINES DCFATALF.
  5264         10  DCFATALA PIC  X(0001).
  5265     05  DCFATALI PIC  X(0005).
  5266*    -------------------------------
  5267     05  DCFORCEL PIC S9(0004) COMP.
  5268     05  DCFORCEF PIC  X(0001).
  5269     05  FILLER REDEFINES DCFORCEF.
  5270         10  DCFORCEA PIC  X(0001).
  5271     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  98
* EL6311.cbl
  5272*    -------------------------------
  5273     05  DCHOLDL PIC S9(0004) COMP.
  5274     05  DCHOLDF PIC  X(0001).
  5275     05  FILLER REDEFINES DCHOLDF.
  5276         10  DCHOLDA PIC  X(0001).
  5277     05  DCHOLDI PIC  X(0005).
  5278*    -------------------------------
  5279     05  DCAVAILL PIC S9(0004) COMP.
  5280     05  DCAVAILF PIC  X(0001).
  5281     05  FILLER REDEFINES DCAVAILF.
  5282         10  DCAVAILA PIC  X(0001).
  5283     05  DCAVAILI PIC  X(0005).
  5284*    -------------------------------
  5285     05  DCGPREML PIC S9(0004) COMP.
  5286     05  DCGPREMF PIC  X(0001).
  5287     05  FILLER REDEFINES DCGPREMF.
  5288         10  DCGPREMA PIC  X(0001).
  5289     05  DCGPREMI PIC  X(0011).
  5290*    -------------------------------
  5291     05  DCBPREML PIC S9(0004) COMP.
  5292     05  DCBPREMF PIC  X(0001).
  5293     05  FILLER REDEFINES DCBPREMF.
  5294         10  DCBPREMA PIC  X(0001).
  5295     05  DCBPREMI PIC  X(0011).
  5296*    -------------------------------
  5297     05  DNTOTALL PIC S9(0004) COMP.
  5298     05  DNTOTALF PIC  X(0001).
  5299     05  FILLER REDEFINES DNTOTALF.
  5300         10  DNTOTALA PIC  X(0001).
  5301     05  DNTOTALI PIC  X(0005).
  5302*    -------------------------------
  5303     05  DNFATALL PIC S9(0004) COMP.
  5304     05  DNFATALF PIC  X(0001).
  5305     05  FILLER REDEFINES DNFATALF.
  5306         10  DNFATALA PIC  X(0001).
  5307     05  DNFATALI PIC  X(0005).
  5308*    -------------------------------
  5309     05  DNFORCEL PIC S9(0004) COMP.
  5310     05  DNFORCEF PIC  X(0001).
  5311     05  FILLER REDEFINES DNFORCEF.
  5312         10  DNFORCEA PIC  X(0001).
  5313     05  DNFORCEI PIC  X(0005).
  5314*    -------------------------------
  5315     05  DNHOLDL PIC S9(0004) COMP.
  5316     05  DNHOLDF PIC  X(0001).
  5317     05  FILLER REDEFINES DNHOLDF.
  5318         10  DNHOLDA PIC  X(0001).
  5319     05  DNHOLDI PIC  X(0005).
  5320*    -------------------------------
  5321     05  DNAVAILL PIC S9(0004) COMP.
  5322     05  DNAVAILF PIC  X(0001).
  5323     05  FILLER REDEFINES DNAVAILF.
  5324         10  DNAVAILA PIC  X(0001).
  5325     05  DNAVAILI PIC  X(0005).
  5326*    -------------------------------
  5327     05  DNGPREML PIC S9(0004) COMP.
  5328     05  DNGPREMF PIC  X(0001).
  5329     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page  99
* EL6311.cbl
  5330         10  DNGPREMA PIC  X(0001).
  5331     05  DNGPREMI PIC  X(0011).
  5332*    -------------------------------
  5333     05  DNBPREML PIC S9(0004) COMP.
  5334     05  DNBPREMF PIC  X(0001).
  5335     05  FILLER REDEFINES DNBPREMF.
  5336         10  DNBPREMA PIC  X(0001).
  5337     05  DNBPREMI PIC  X(0011).
  5338*    -------------------------------
  5339     05  DERMSGL PIC S9(0004) COMP.
  5340     05  DERMSGF PIC  X(0001).
  5341     05  FILLER REDEFINES DERMSGF.
  5342         10  DERMSGA PIC  X(0001).
  5343     05  DERMSGI PIC  X(0075).
  5344*    -------------------------------
  5345     05  DPFENTRL PIC S9(0004) COMP.
  5346     05  DPFENTRF PIC  X(0001).
  5347     05  FILLER REDEFINES DPFENTRF.
  5348         10  DPFENTRA PIC  X(0001).
  5349     05  DPFENTRI PIC  9(2).
  5350 01  EL631DO REDEFINES EL631BI.
  5351     05  FILLER            PIC  X(0012).
  5352*    -------------------------------
  5353     05  FILLER            PIC  X(0003).
  5354     05  DDATEO PIC  X(0008).
  5355*    -------------------------------
  5356     05  FILLER            PIC  X(0003).
  5357     05  DTIMEO PIC  99.99.
  5358*    -------------------------------
  5359     05  FILLER            PIC  X(0003).
  5360     05  DHEADO PIC  X(0038).
  5361*    -------------------------------
  5362     05  FILLER            PIC  X(0003).
  5363     05  DLDATEO PIC  X(0010).
  5364*    -------------------------------
  5365     05  FILLER            PIC  X(0003).
  5366     05  DBATCHO PIC  X(0011).
  5367*    -------------------------------
  5368     05  FILLER            PIC  X(0003).
  5369     05  DACCTNMO PIC  X(0030).
  5370*    -------------------------------
  5371     05  FILLER            PIC  X(0003).
  5372     05  DPROCDTO PIC  X(0008).
  5373*    -------------------------------
  5374     05  FILLER            PIC  X(0003).
  5375     05  DINPUTO PIC  X(0008).
  5376*    -------------------------------
  5377     05  FILLER            PIC  X(0003).
  5378     05  DMAINDTO PIC  X(0008).
  5379*    -------------------------------
  5380     05  FILLER            PIC  X(0003).
  5381     05  DCARRO PIC  X(0001).
  5382*    -------------------------------
  5383     05  FILLER            PIC  X(0003).
  5384     05  DGROUPO PIC  X(0006).
  5385*    -------------------------------
  5386     05  FILLER            PIC  X(0003).
  5387     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 100
* EL6311.cbl
  5388*    -------------------------------
  5389     05  FILLER            PIC  X(0003).
  5390     05  DACCTO PIC  X(0010).
  5391*    -------------------------------
  5392     05  FILLER            PIC  X(0003).
  5393     05  DRECVDTO PIC  X(0008).
  5394*    -------------------------------
  5395     05  FILLER            PIC  X(0003).
  5396     05  DCSRO PIC  X(0004).
  5397*    -------------------------------
  5398     05  FILLER            PIC  X(0003).
  5399     05  DREFHDGO PIC  X(0010).
  5400*    -------------------------------
  5401     05  FILLER            PIC  X(0003).
  5402     05  DREFO PIC  X(0012).
  5403*    -------------------------------
  5404     05  FILLER            PIC  X(0003).
  5405     05  DLFPHDGO PIC  X(0010).
  5406*    -------------------------------
  5407     05  FILLER            PIC  X(0003).
  5408     05  DAHPHDGO PIC  X(0010).
  5409*    -------------------------------
  5410     05  FILLER            PIC  X(0003).
  5411     05  DLFRHDGO PIC  X(0009).
  5412*    -------------------------------
  5413     05  FILLER            PIC  X(0003).
  5414     05  DAHRHDGO PIC  X(0009).
  5415*    -------------------------------
  5416     05  FILLER            PIC  X(0003).
  5417     05  DRISSO PIC  ZZ99-.
  5418*    -------------------------------
  5419     05  FILLER            PIC  X(0003).
  5420     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DRCANCO PIC  ZZ99-.
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DEISSO PIC  ZZ99-.
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DECANCO PIC  ZZ99-.
  5445*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 101
* EL6311.cbl
  5446     05  FILLER            PIC  X(0003).
  5447     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DCISSO PIC  ZZ99-.
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DCCANCO PIC  ZZ99-.
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DOISSO PIC  ZZ99-.
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DOCANCO PIC  ZZ99-.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DITOTALO PIC  ZZZ99.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DIFATALO PIC  ZZZ99.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DIFORCEO PIC  ZZZ99.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DIHOLDO PIC  ZZZ99.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DIAVAILO PIC  ZZZ99.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 102
* EL6311.cbl
  5504     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DCTOTALO PIC  ZZZ99.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DCFATALO PIC  ZZZ99.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DCFORCEO PIC  ZZZ99.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DCHOLDO PIC  ZZZ99.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DCAVAILO PIC  ZZZ99.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DNTOTALO PIC  ---99.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DNFATALO PIC  ---99.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DNFORCEO PIC  ---99.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DNHOLDO PIC  ---99.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
  5543     05  DNAVAILO PIC  ---99.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DNGPREMO PIC  -------9.99.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DNBPREMO PIC  -------9.99.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DERMSGO PIC  X(0075).
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DPFENTRO PIC  X(0002).
  5556*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 103
* EL6311.cbl
  5558 01  MAP-B REDEFINES EL631BI.
  5559     12  FILLER                  PIC X(569).
  5560*    12  FILLER                  PIC X(512).
  5561*    12  FILLER                  PIC X(510).
  5562     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5563         16  BKIND-LEN               PIC S9(4)  COMP.
  5564         16  BKIND-ATTRB             PIC X.
  5565         16  BKIND                   PIC XX.
  5566         16  BTYPE-LEN               PIC S9(4)  COMP.
  5567         16  BTYPE-ATTRB             PIC X.
  5568         16  BTYPE                   PIC X(3).
  5569         16  BTERM-LEN               PIC S9(4)  COMP.
  5570         16  BTERM-ATTRB             PIC X.
  5571         16  BTERMI                  PIC 999.
  5572         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5573         16  BBEN-LEN                PIC S9(4)  COMP.
  5574         16  BBEN-ATTRB              PIC X.
  5575         16  BBENI                   PIC 9(10)V99.
  5576*        16  BBENI                   PIC 9(12).
  5577         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5578         16  BPREM-LEN               PIC S9(4)  COMP.
  5579         16  BPREM-ATTRB             PIC X.
  5580         16  BPREMI                  PIC S9(9)V99.
  5581*        16  BPREMI                  PIC 9(11).
  5582         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5583         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5584         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5585         16  BEXPIRE-ATTRB           PIC X.
  5586         16  BEXPIRE                 PIC X(8).
  5587         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5588         16  BCRIT-PERD-ATTRB        PIC X.
  5589         16  BCRIT-PERDI             PIC 99.
  5590         16  BCRIT-PERDO REDEFINES
  5591                         BCRIT-PERDI PIC ZZ.
  5592         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5593         16  BALT-BEN-ATTRB          PIC X.
  5594         16  BALT-BENI               PIC 9(10)V99.
  5595*        16  BALT-BENI               PIC 9(12).
  5596         16  BALT-BENO REDEFINES
  5597                           BALT-BENI PIC Z(9).ZZ.
  5598         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5599         16  BALT-PREM-ATTRB         PIC X.
  5600         16  BALT-PREMI              PIC 9(9)V99.
  5601*        16  BALT-PREMI              PIC 9(11).
  5602         16  BALT-PREMO REDEFINES
  5603                          BALT-PREMI PIC Z(7).ZZ-.
  5604         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5605         16  BBEN-CD-ATTRB           PIC X.
  5606         16  BBEN-CD                 PIC XXX.
  5607         16  BCPREM-LEN              PIC S9(4)  COMP.
  5608         16  BCPREM-ATTRB            PIC X.
  5609         16  BCPREMI                 PIC S9(9)V99.
  5610*        16  BCPREMI                 PIC X(11).
  5611         16  BCPREMO REDEFINES BCPREMI
  5612                                     PIC Z(7).99-.
  5613         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5614         16  BCALT-PREM-ATTRB        PIC X.
  5615         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 104
* EL6311.cbl
  5616         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5617         16  BBEN-ABBR-ATTRB         PIC X.
  5618         16  BBEN-ABBR               PIC X(5).
  5619         16  BDIFF-LEN               PIC S9(4)  COMP.
  5620         16  BDIFF-ATTRB             PIC X.
  5621         16  BDIFFO                  PIC Z(7).99-.
  5622         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5623         16  BBILL-LIT-ATTRB         PIC X.
  5624         16  BBILL-LIT               PIC X(8).
  5625         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5626         16  BDALT-PREM-ATTRB        PIC X.
  5627         16  BDALT-PREM              PIC Z(7).99-.
  5628
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 105
* EL6311.cbl
  5630
  5631****************************************************************
  5632*
  5633* Copyright (c) 2007 by Clerity Solutions, Inc.
  5634* All rights reserved.
  5635*
  5636****************************************************************
  5637 01  DFHEIV.
  5638   02  DFHEIV0               PIC X(35).
  5639   02  DFHEIV1               PIC X(08).
  5640   02  DFHEIV2               PIC X(08).
  5641   02  DFHEIV3               PIC X(08).
  5642   02  DFHEIV4               PIC X(06).
  5643   02  DFHEIV5               PIC X(04).
  5644   02  DFHEIV6               PIC X(04).
  5645   02  DFHEIV7               PIC X(02).
  5646   02  DFHEIV8               PIC X(02).
  5647   02  DFHEIV9               PIC X(01).
  5648   02  DFHEIV10              PIC S9(7) COMP-3.
  5649   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5650   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5651   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5652   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5653   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5654   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5655   02  DFHEIV17              PIC X(04).
  5656   02  DFHEIV18              PIC X(04).
  5657   02  DFHEIV19              PIC X(04).
  5658   02  DFHEIV20              USAGE IS POINTER.
  5659   02  DFHEIV21              USAGE IS POINTER.
  5660   02  DFHEIV22              USAGE IS POINTER.
  5661   02  DFHEIV23              USAGE IS POINTER.
  5662   02  DFHEIV24              USAGE IS POINTER.
  5663   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5664   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5665   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5666   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5667   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5668   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5669   02  FILLER                PIC X(02).
  5670   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5671   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5672   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5673   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5674   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5675 LINKAGE  SECTION.
  5676*****************************************************************
  5677*                                                               *
  5678* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5679* All rights reserved.                                          *
  5680*                                                               *
  5681*****************************************************************
  5682 01  dfheiblk.
  5683     02  eibtime          pic s9(7) comp-3.
  5684     02  eibdate          pic s9(7) comp-3.
  5685     02  eibtrnid         pic x(4).
  5686     02  eibtaskn         pic s9(7) comp-3.
  5687     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 106
* EL6311.cbl
  5688     02  dfheigdi         pic s9(4) comp.
  5689     02  eibcposn         pic s9(4) comp.
  5690     02  eibcalen         pic s9(4) comp.
  5691     02  eibaid           pic x(1).
  5692     02  eibfiller1       pic x(1).
  5693     02  eibfn            pic x(2).
  5694     02  eibfiller2       pic x(2).
  5695     02  eibrcode         pic x(6).
  5696     02  eibfiller3       pic x(2).
  5697     02  eibds            pic x(8).
  5698     02  eibreqid         pic x(8).
  5699     02  eibrsrce         pic x(8).
  5700     02  eibsync          pic x(1).
  5701     02  eibfree          pic x(1).
  5702     02  eibrecv          pic x(1).
  5703     02  eibsend          pic x(1).
  5704     02  eibatt           pic x(1).
  5705     02  eibeoc           pic x(1).
  5706     02  eibfmh           pic x(1).
  5707     02  eibcompl         pic x(1).
  5708     02  eibsig           pic x(1).
  5709     02  eibconf          pic x(1).
  5710     02  eiberr           pic x(1).
  5711     02  eibrldbk         pic x(1).
  5712     02  eiberrcd         pic x(4).
  5713     02  eibsynrb         pic x(1).
  5714     02  eibnodat         pic x(1).
  5715     02  eibfiller5       pic x(2).
  5716     02  eibresp          pic 9(09) comp.
  5717     02  eibresp2         pic 9(09) comp.
  5718     02  dfheigdj         pic s9(4) comp.
  5719     02  dfheigdk         pic s9(4) comp.
  5720 01  DFHCOMMAREA                 PIC X(1300).
  5721
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 107
* EL6311.cbl
  5723*    COPY ERCPNDB.
  5724******************************************************************
  5725*                                                                *
  5726*                                                                *
  5727*                            ERCPNDB.                            *
  5728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5729*                            VMOD=2.025                          *
  5730*                                                                *
  5731*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5732*                                                                *
  5733******************************************************************
  5734*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5735*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5736******************************************************************
  5737*                                                                *
  5738*                                                                *
  5739*   FILE TYPE = VSAM,KSDS                                        *
  5740*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5741*                                                                *
  5742*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5743*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5744*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5745*                                                 RKP=13,LEN=36  *
  5746*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5747*                                      AND CHG-SEQ.)             *
  5748*                                                RKP=49,LEN=11   *
  5749*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5750*                                      AND CHG-SEQ.)             *
  5751*                                                RKP=60,LEN=15   *
  5752*                                                                *
  5753*   LOG = NO                                                     *
  5754*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5755******************************************************************
  5756******************************************************************
  5757*                   C H A N G E   L O G
  5758*
  5759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5760*-----------------------------------------------------------------
  5761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5762* EFFECTIVE    NUMBER
  5763*-----------------------------------------------------------------
  5764* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5765* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5766* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5767* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5768* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5769* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5770* 032306                   PEMA  ADD BOW LOAN NUMBER
  5771* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5772* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5773* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5774* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5775* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5776* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5777* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5778* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5779******************************************************************
  5780
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 108
* EL6311.cbl
  5781 01  PENDING-BUSINESS.
  5782     12  PB-RECORD-ID                     PIC XX.
  5783         88  VALID-PB-ID                        VALUE 'PB'.
  5784
  5785     12  PB-CONTROL-PRIMARY.
  5786         16  PB-COMPANY-CD                PIC X.
  5787         16  PB-ENTRY-BATCH               PIC X(6).
  5788         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5789         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5790
  5791     12  PB-CONTROL-BY-ACCOUNT.
  5792         16  PB-COMPANY-CD-A1             PIC X.
  5793         16  PB-CARRIER                   PIC X.
  5794         16  PB-GROUPING.
  5795             20  PB-GROUPING-PREFIX       PIC XXX.
  5796             20  PB-GROUPING-PRIME        PIC XXX.
  5797         16  PB-STATE                     PIC XX.
  5798         16  PB-ACCOUNT.
  5799             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5800             20  PB-ACCOUNT-PRIME         PIC X(6).
  5801         16  PB-CERT-EFF-DT               PIC XX.
  5802         16  PB-CERT-NO.
  5803             20  PB-CERT-PRIME            PIC X(10).
  5804             20  PB-CERT-SFX              PIC X.
  5805         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5806
  5807         16  PB-RECORD-TYPE               PIC X.
  5808             88  PB-MAILING-DATA                VALUE '0'.
  5809             88  PB-ISSUE                       VALUE '1'.
  5810             88  PB-CANCELLATION                VALUE '2'.
  5811             88  PB-BATCH-TRAILER               VALUE '9'.
  5812
  5813     12  PB-CONTROL-BY-ORIG-BATCH.
  5814         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5815         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5816         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5817         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5818
  5819     12  PB-CONTROL-BY-CSR.
  5820         16  PB-CSR-COMPANY-CD            PIC X.
  5821         16  PB-CSR-ID                    PIC X(4).
  5822         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5823         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5824         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5825******************************************************************
  5826*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5827******************************************************************
  5828
  5829     12  PB-LAST-MAINT-DT                 PIC XX.
  5830     12  PB-LAST-MAINT-BY                 PIC X(4).
  5831     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5832
  5833     12  PB-RECORD-BODY                   PIC X(375).
  5834
  5835     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5836         16  PB-CERT-ORIGIN               PIC X.
  5837             88  CLASIC-CREATED-CERT         VALUE '1'.
  5838         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 109
* EL6311.cbl
  5839             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5840             20  PB-I-INSURED-FIRST-NAME.
  5841                 24  PB-I-INSURED-1ST-INIT PIC X.
  5842                 24  FILLER                PIC X(9).
  5843             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5844         16  PB-I-AGE                     PIC S99   COMP-3.
  5845         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5846         16  PB-I-BIRTHDAY                PIC XX.
  5847         16  PB-I-INSURED-SEX             PIC X.
  5848             88  PB-SEX-MALE     VALUE 'M'.
  5849             88  PB-SEX-FEMALE   VALUE 'F'.
  5850
  5851         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5852         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5853         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5854         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5855         16  PB-I-SKIP-CODE               PIC X.
  5856             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5857             88  PB-SKIP-JULY              VALUE '1'.
  5858             88  PB-SKIP-AUGUST            VALUE '2'.
  5859             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5860             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5861             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5862             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5863             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5864             88  PB-SKIP-JUNE              VALUE '8'.
  5865             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5866             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5867             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5868         16  PB-I-TERM-TYPE               PIC X.
  5869             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5870             88  PB-PAID-WEEKLY            VALUE 'W'.
  5871             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5872             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5873             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5874         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5875         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5876         16  PB-I-DATA-ENTRY-SW           PIC X.
  5877             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5878             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5879             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5880             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5881         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5882         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5883*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5884         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5885         16  FILLER                       PIC X.
  5886
  5887         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5888             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5889             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5890                                                   '90' THRU '99'.
  5891         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5892                                          PIC XX.
  5893         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5894         16  PB-I-AMOUNT-FINANCED REDEFINES
  5895                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5896         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 110
* EL6311.cbl
  5897         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5898                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5899         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5900         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5901         16  PB-I-CLP-AMOUNT REDEFINES
  5902                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5903         16  PB-I-LF-CALC-FLAG            PIC X.
  5904             88 PB-COMP-LF-PREM               VALUE '?'.
  5905         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5906         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5907         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5908         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5909         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5910         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5911         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5912         16  PB-I-LF-ABBR                 PIC XXX.
  5913         16  PB-I-LF-INPUT-CD             PIC XX.
  5914
  5915         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5916             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5917             88  PB-INVALID-AH               VALUE '  ' '00'
  5918                                                   '90' THRU '99'.
  5919         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5920         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5921         16  PB-I-AH-CALC-FLAG            PIC X.
  5922             88 PB-COMP-AH-PREM                  VALUE '?'.
  5923         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5924         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5925         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5926         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5927         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5928         16  PB-I-AH-ABBR                 PIC XXX.
  5929         16  PB-I-AH-INPUT-CD             PIC XXX.
  5930
  5931         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5932         16  PB-I-REIN-TABLE              PIC XXX.
  5933         16  PB-I-BUSINESS-TYPE           PIC 99.
  5934         16  PB-I-INDV-GRP-CD             PIC X.
  5935         16  PB-I-MORT-CODE.
  5936             20  PB-I-TABLE               PIC X.
  5937             20  PB-I-INTEREST            PIC XX.
  5938             20  PB-I-MORT-TYP            PIC X.
  5939         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5940         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5941         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5942         16  PB-I-INDV-GRP-OVRD           PIC X.
  5943         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5944         16  PB-I-SIG-SW                  PIC X.
  5945             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5946         16  PB-I-RATE-CLASS              PIC XX.
  5947         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5948         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5949         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5950         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5951         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5952         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5953         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5954         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 111
* EL6311.cbl
  5955         16  PB-I-OB-FLAG                 PIC X.
  5956             88  PB-I-OB                      VALUE 'B'.
  5957             88  PB-I-SUMMARY                 VALUE 'Z'.
  5958         16  PB-I-ENTRY-STATUS            PIC X.
  5959             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5960                                              'M' '5' '9' '2'.
  5961             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5962             88  PB-I-POLICY-PENDING          VALUE '2'.
  5963             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5964             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5965             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5966             88  PB-I-REIN-ONLY               VALUE '9'.
  5967             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5968             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5969             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5970             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5971         16  PB-I-INT-CODE                PIC X.
  5972             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5973             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5974         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5975         16  PB-I-SOC-SEC-NO              PIC X(11).
  5976         16  PB-I-MEMBER-NO               PIC X(12).
  5977         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5978*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5979         16  PB-I-OLD-LOF                 PIC XXX.
  5980         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5981         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5982         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5983         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5984         16  PB-I-LIFE-INDICATOR          PIC X.
  5985             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5986         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5987         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5988                                          PIC S9(5)V99    COMP-3.
  5989         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5990             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5991             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5992         16  PB-I-1ST-PMT-DT              PIC XX.
  5993         16  PB-I-JOINT-INSURED.
  5994             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5995             20 PB-I-JOINT-FIRST-NAME.
  5996                24  PB-I-JOINT-FIRST-INIT PIC X.
  5997                24  FILLER                PIC X(9).
  5998             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5999*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6000         16  PB-I-BENEFICIARY-NAME.
  6001             20  PB-I-BANK-NUMBER         PIC X(10).
  6002             20  FILLER                   PIC X(15).
  6003         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6004         16  PB-I-REFERENCE               PIC X(12).
  6005         16  FILLER REDEFINES PB-I-REFERENCE.
  6006             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6007             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6008             20  PB-I-CLP-STATE           PIC XX.
  6009         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6010             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6011             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6012             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 112
* EL6311.cbl
  6013         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6014         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6015         16  PB-I-RESIDENT-STATE          PIC XX.
  6016         16  PB-I-RATE-CODE               PIC X(4).
  6017         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6018         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6019         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6020         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6021         16  PB-I-BANK-NOCHRGB            PIC 99.
  6022         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6023         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6024
  6025     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6026         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6027             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6028         16  PB-C-CANCEL-ORIGIN           PIC X.
  6029             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6030         16  PB-C-LF-CANCEL-DT            PIC XX.
  6031         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6032         16  PB-C-LF-CALC-REQ             PIC X.
  6033             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6034         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6035         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6036         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6037             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6038         16  PB-C-AH-CANCEL-DT            PIC XX.
  6039         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6040         16  PB-C-AH-CALC-REQ             PIC X.
  6041             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6042         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6043         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6044         16  PB-C-LAST-NAME               PIC X(15).
  6045         16  PB-C-REFUND-SW               PIC X.
  6046             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6047             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6048         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6049         16  PB-C-PAYEE-CODE              PIC X(6).
  6050         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6051         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6052         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6053         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6054         16  PB-C-REFERENCE               PIC X(12).
  6055         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6056         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6057         16  PB-C-POST-CARD-IND           PIC X.
  6058         16  PB-C-CANCEL-REASON           PIC X.
  6059         16  PB-C-REF-INTERFACE-SW        PIC X.
  6060         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6061         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6062         16  FILLER                       PIC X(01).
  6063*        16  FILLER                       PIC X(18).
  6064         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6065*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6066         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6067         16  PB-CANCELED-CERT-DATA.
  6068             20  PB-CI-INSURED-NAME.
  6069                 24  PB-CI-LAST-NAME      PIC X(15).
  6070                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 113
* EL6311.cbl
  6071             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6072             20  PB-CI-INSURED-SEX        PIC X.
  6073             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6074             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6075             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6076             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6077             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6078             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6079             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6080             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6081             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6082             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6083             20  PB-CI-RATE-CLASS         PIC XX.
  6084             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6085             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6086             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6087             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6088             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6089             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6090             20  PB-CI-LF-ABBR            PIC X(3).
  6091             20  PB-CI-AH-ABBR            PIC X(3).
  6092             20  PB-CI-OB-FLAG            PIC X.
  6093                 88  PB-CI-OB                VALUE 'B'.
  6094             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6095                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6096                                           'M' '4' '5' '9' '2'.
  6097                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6098                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6099                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6100                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6101                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6102                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6103                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6104                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6105                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6106                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6107                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6108                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6109             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6110                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6111                                           'M' '4' '5' '9' '2'.
  6112                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6113                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6114                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6115                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6116                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6117                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6118                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6119                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6120                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6121                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6122                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6123                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6124             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6125             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6126             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6127             20  PB-CI-MEMBER-NO          PIC X(12).
  6128             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 114
* EL6311.cbl
  6129                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6130                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6131             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6132             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6133             20  PB-CI-COMP-EXCP-SW       PIC X.
  6134                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6135                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6136             20  PB-CI-ENTRY-STATUS       PIC X.
  6137             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6138             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6139             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6140             20  PB-CI-DEATH-DT           PIC XX.
  6141             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6142             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6143             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6144             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6145             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6146             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6147             20  PB-CI-ENTRY-DT              PIC XX.
  6148             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6149             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6150             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6151             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6152             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6153             20  PB-CI-OLD-LOF               PIC XXX.
  6154*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6155             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6156             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6157             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6158             20  PB-CI-INDV-GRP-CD           PIC X.
  6159             20  PB-CI-BENEFICIARY-NAME.
  6160                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6161                 24  FILLER                  PIC X(15).
  6162             20  PB-CI-NOTE-SW               PIC X.
  6163             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6164             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6165             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6166             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6167             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6168             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6169             20  PB-CI-FIRST-NAME            PIC X(10).
  6170             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6171
  6172         16  FILLER                       PIC X(13).
  6173*032306  16  FILLER                       PIC X(27).
  6174*        16  FILLER                       PIC X(46).
  6175
  6176     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6177         16  FILLER                       PIC X(10).
  6178         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6179         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6180         16  PB-M-INSURED-MID-INIT        PIC X.
  6181         16  PB-M-INSURED-AGE             PIC 99.
  6182         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6183         16  PB-M-INSURED-SEX             PIC X.
  6184         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6185         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6186         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 115
* EL6311.cbl
  6187         16  PB-M-INSURED-CITY-STATE.
  6188             20  PB-M-INSURED-CITY        PIC X(28).
  6189             20  PB-M-INSURED-STATE       PIC XX.
  6190         16  PB-M-INSURED-ZIP-CODE.
  6191             20  PB-M-INSURED-ZIP-PRIME.
  6192                 24  PB-M-INSURED-ZIP-1   PIC X.
  6193                     88  PB-M-CANADIAN-POST-CODE
  6194                                             VALUE 'A' THRU 'Z'.
  6195                 24  FILLER               PIC X(4).
  6196             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6197         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6198                                        PB-M-INSURED-ZIP-CODE.
  6199             20  PM-M-INS-CAN-POST1       PIC XXX.
  6200             20  PM-M-INS-CAN-POST2       PIC XXX.
  6201             20  FILLER                   PIC XXX.
  6202         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6203         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6204         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6205         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6206         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6207         16  PB-M-CRED-BENE-CITYST.
  6208             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6209             20  PB-M-CRED-BENE-STATE     PIC XX.
  6210         16  FILLER                       PIC X(92).
  6211
  6212     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6213         16  FILLER                       PIC X(10).
  6214         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6215         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6216         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6217         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6218         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6219         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6220         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6221         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6222         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6223         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6224         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6225         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6226         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6227         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6228         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6229         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6230         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6231         16  PB-ACCOUNT-NAME              PIC X(30).
  6232         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6233         16  PB-REFERENCE                 PIC X(12).
  6234         16  PB-B-RECEIVED-DT             PIC XX.
  6235         16  FILLER                       PIC X(234).
  6236
  6237     12  PB-RECORD-STATUS.
  6238         16  PB-CREDIT-SELECT-DT          PIC XX.
  6239         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6240         16  PB-BILLED-DT                 PIC XX.
  6241         16  PB-BILLING-STATUS            PIC X.
  6242             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6243             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6244             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 116
* EL6311.cbl
  6245         16  PB-RECORD-BILL               PIC X.
  6246             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6247             88  PB-RECORD-RETURNED           VALUE 'R'.
  6248             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6249             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6250             88  PB-OVERRIDE-AH               VALUE 'A'.
  6251             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6252         16  PB-BATCH-ENTRY               PIC X.
  6253             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6254             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6255             88  PB-REISSUED-CERT             VALUE 'E'.
  6256             88  PB-MONTHLY-CERT              VALUE 'M'.
  6257             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6258             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6259             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6260         16  PB-FORCE-CODE                PIC X.
  6261             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6262             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6263             88  PB-CANCEL-FORCE              VALUE '8'.
  6264             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6265             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6266             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6267             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6268             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6269             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6270             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6271         16  PB-FATAL-FLAG                PIC X.
  6272             88  PB-FATAL-ERRORS              VALUE 'X'.
  6273         16  PB-FORCE-ER-CD               PIC X.
  6274             88  PB-FORCE-ERRORS              VALUE 'F'.
  6275             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6276         16  PB-WARN-ER-CD                PIC X.
  6277             88  PB-WARNING-ERRORS            VALUE 'W'.
  6278         16  FILLER                       PIC X.
  6279         16  PB-OUT-BAL-CD                PIC X.
  6280             88  PB-OUT-OF-BAL                VALUE 'O'.
  6281         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6282         16  PB-AH-OVERRIDE-L1            PIC X.
  6283         16  PB-INPUT-DT                  PIC XX.
  6284         16  PB-INPUT-BY                  PIC X(4).
  6285         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6286         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6287         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6288         16  PB-LF-EARNING-METHOD         PIC X.
  6289         16  PB-AH-EARNING-METHOD         PIC X.
  6290         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6291         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6292         16  PB-REIN-CD                   PIC XXX.
  6293         16  PB-LF-REFUND-TYPE            PIC X.
  6294         16  PB-AH-REFUND-TYPE            PIC X.
  6295         16  PB-ACCT-EFF-DT               PIC XX.
  6296         16  PB-ACCT-EXP-DT               PIC XX.
  6297         16  PB-COMPANY-ID                PIC X(3).
  6298         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6299         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6300         16  PB-SV-CARRIER                PIC X.
  6301         16  PB-SV-GROUPING               PIC X(6).
  6302         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 117
* EL6311.cbl
  6303         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6304         16  PB-GA-BILLING-INFO.
  6305             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6306                                          PIC XX.
  6307         16  PB-SV-REMIT-TO  REDEFINES
  6308             PB-GA-BILLING-INFO           PIC X(10).
  6309         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6310         16  PB-I-LOAN-OFFICER            PIC X(5).
  6311         16  PB-I-VIN                     PIC X(17).
  6312
  6313         16  FILLER                       PIC X(04).
  6314         16  IMNET-BYPASS-SW              PIC X.
  6315
  6316******************************************************************
  6317*                COMMON EDIT ERRORS                              *
  6318******************************************************************
  6319
  6320     12  PB-COMMON-ERRORS.
  6321         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6322                                           PIC S9(4)     COMP.
  6323
  6324******************************************************************
  6325
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 118
* EL6311.cbl
  6327*    COPY ELCCERT.
  6328******************************************************************
  6329*                                                                *
  6330*                            ELCCERT.                            *
  6331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6332*                            VMOD=2.013                          *
  6333*                                                                *
  6334*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6335*                                                                *
  6336*   FILE TYPE = VSAM,KSDS                                        *
  6337*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6338*                                                                *
  6339*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6340*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6341*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6342*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6343*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6344*                                                                *
  6345*   LOG = YES                                                    *
  6346*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6347******************************************************************
  6348*                   C H A N G E   L O G
  6349*
  6350* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6351*-----------------------------------------------------------------
  6352*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6353* EFFECTIVE    NUMBER
  6354*-----------------------------------------------------------------
  6355* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6356* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6357* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6358* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6359* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6360* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6361* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6362* 032612  CR2011110200001  PEMA  AHL CHANGES
  6363******************************************************************
  6364
  6365 01  CERTIFICATE-MASTER.
  6366     12  CM-RECORD-ID                      PIC XX.
  6367         88  VALID-CM-ID                      VALUE 'CM'.
  6368
  6369     12  CM-CONTROL-PRIMARY.
  6370         16  CM-COMPANY-CD                 PIC X.
  6371         16  CM-CARRIER                    PIC X.
  6372         16  CM-GROUPING.
  6373             20  CM-GROUPING-PREFIX        PIC X(3).
  6374             20  CM-GROUPING-PRIME         PIC X(3).
  6375         16  CM-STATE                      PIC XX.
  6376         16  CM-ACCOUNT.
  6377             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6378             20  CM-ACCOUNT-PRIME          PIC X(6).
  6379         16  CM-CERT-EFF-DT                PIC XX.
  6380         16  CM-CERT-NO.
  6381             20  CM-CERT-PRIME             PIC X(10).
  6382             20  CM-CERT-SFX               PIC X.
  6383
  6384     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 119
* EL6311.cbl
  6385         16  CM-COMPANY-CD-A1              PIC X.
  6386         16  CM-INSURED-LAST-NAME          PIC X(15).
  6387         16  CM-INSURED-INITIALS.
  6388             20  CM-INSURED-INITIAL1       PIC X.
  6389             20  CM-INSURED-INITIAL2       PIC X.
  6390
  6391     12  CM-CONTROL-BY-SSN.
  6392         16  CM-COMPANY-CD-A2              PIC X.
  6393         16  CM-SOC-SEC-NO.
  6394             20  CM-SSN-STATE              PIC XX.
  6395             20  CM-SSN-ACCOUNT            PIC X(6).
  6396             20  CM-SSN-LN3.
  6397                 25  CM-INSURED-INITIALS-A2.
  6398                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6399                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6400                 25 CM-PART-LAST-NAME-A2         PIC X.
  6401
  6402     12  CM-CONTROL-BY-CERT-NO.
  6403         16  CM-COMPANY-CD-A4              PIC X.
  6404         16  CM-CERT-NO-A4                 PIC X(11).
  6405
  6406     12  CM-CONTROL-BY-MEMB.
  6407         16  CM-COMPANY-CD-A5              PIC X.
  6408         16  CM-MEMBER-NO.
  6409             20  CM-MEMB-STATE             PIC XX.
  6410             20  CM-MEMB-ACCOUNT           PIC X(6).
  6411             20  CM-MEMB-LN4.
  6412                 25  CM-INSURED-INITIALS-A5.
  6413                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6414                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6415                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6416
  6417     12  CM-INSURED-PROFILE-DATA.
  6418         16  CM-INSURED-FIRST-NAME.
  6419             20  CM-INSURED-1ST-INIT       PIC X.
  6420             20  FILLER                    PIC X(9).
  6421         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6422         16  CM-INSURED-SEX                PIC X.
  6423             88  CM-SEX-MALE                  VALUE 'M'.
  6424             88  CM-SEX-FEMAL                 VALUE 'F'.
  6425         16  CM-INSURED-JOINT-AGE          PIC 99.
  6426         16  CM-JOINT-INSURED-NAME.
  6427             20  CM-JT-LAST-NAME           PIC X(15).
  6428             20  CM-JT-FIRST-NAME.
  6429                 24  CM-JT-1ST-INIT        PIC X.
  6430                 24  FILLER                PIC X(9).
  6431             20  CM-JT-INITIAL             PIC X.
  6432
  6433     12  CM-LIFE-DATA.
  6434         16  CM-LF-BENEFIT-CD              PIC XX.
  6435         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6436         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6437         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6438         16  CM-LF-DEV-CODE                PIC XXX.
  6439         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6440         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6441         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6442         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 120
* EL6311.cbl
  6443         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6444         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6445         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6446         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6447         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6448         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6449         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6450         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6451         16  FILLER                        PIC XX.
  6452
  6453     12  CM-AH-DATA.
  6454         16  CM-AH-BENEFIT-CD              PIC XX.
  6455         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6456         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6457         16  CM-AH-DEV-CODE                PIC XXX.
  6458         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6459         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6460         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6461         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6462         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6463         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6464         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6465         16  CM-AH-PAID-THRU-DT            PIC XX.
  6466             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6467         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6468         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6469         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6470         16  FILLER                        PIC X.
  6471
  6472     12  CM-LOAN-INFORMATION.
  6473         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6474         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6475                                           PIC S9(5)V99  COMP-3.
  6476         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6477         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6478         16  CM-PAY-FREQUENCY              PIC S99.
  6479         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6480         16  CM-RATE-CLASS                 PIC XX.
  6481         16  CM-BENEFICIARY                PIC X(25).
  6482         16  CM-POLICY-FORM-NO             PIC X(12).
  6483         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6484         16  CM-LAST-ADD-ON-DT             PIC XX.
  6485         16  CM-DEDUCTIBLE-AMOUNTS.
  6486             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6487             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6488         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6489             20  CM-RESIDENT-STATE         PIC XX.
  6490             20  CM-RATE-CODE              PIC X(4).
  6491             20  FILLER                    PIC XX.
  6492         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6493             20  CM-LOAN-OFFICER           PIC X(5).
  6494             20  FILLER                    PIC XXX.
  6495         16  CM-CSR-CODE                   PIC XXX.
  6496         16  CM-UNDERWRITING-CODE          PIC X.
  6497             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6498         16  CM-POST-CARD-IND              PIC X.
  6499         16  CM-NH-INTERFACE-SW            PIC X.
  6500         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 121
* EL6311.cbl
  6501             88  CM-SING-PRM                  VALUE '1'.
  6502             88  CM-O-B-COVERAGE              VALUE '2'.
  6503             88  CM-OPEN-END                  VALUE '3'.
  6504         16  CM-IND-GRP-TYPE               PIC X.
  6505             88  CM-INDIVIDUAL                VALUE 'I'.
  6506             88  CM-GROUP                     VALUE 'G'.
  6507         16  CM-SKIP-CODE                  PIC X.
  6508             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6509             88  SKIP-JULY                    VALUE '1'.
  6510             88  SKIP-AUGUST                  VALUE '2'.
  6511             88  SKIP-SEPTEMBER               VALUE '3'.
  6512             88  SKIP-JULY-AUG                VALUE '4'.
  6513             88  SKIP-AUG-SEPT                VALUE '5'.
  6514             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6515             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6516             88  SKIP-JUNE                    VALUE '8'.
  6517             88  SKIP-JUNE-JULY               VALUE '9'.
  6518             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6519             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6520         16  CM-PAYMENT-MODE               PIC X.
  6521             88  PAY-MONTHLY                  VALUE SPACE.
  6522             88  PAY-WEEKLY                   VALUE '1'.
  6523             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6524             88  PAY-BI-WEEKLY                VALUE '3'.
  6525             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6526         16  CM-LOAN-NUMBER                PIC X(8).
  6527         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6528         16  CM-OLD-LOF                    PIC XXX.
  6529*        16  CM-LOAN-OFFICER               PIC XXX.
  6530         16  CM-REIN-TABLE                 PIC XXX.
  6531         16  CM-SPECIAL-REIN-CODE          PIC X.
  6532         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6533         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6534         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6535
  6536     12  CM-STATUS-DATA.
  6537         16  CM-ENTRY-STATUS               PIC X.
  6538         16  CM-ENTRY-DT                   PIC XX.
  6539
  6540         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6541         16  CM-LF-CANCEL-DT               PIC XX.
  6542         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6543
  6544         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6545         16  CM-LF-DEATH-DT                PIC XX.
  6546         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6547
  6548         16  CM-LF-CURRENT-STATUS          PIC X.
  6549             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6550                                                'M' '4' '5' '9'.
  6551             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6552             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6553             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6554             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6555             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6556             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6557             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6558             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 122
* EL6311.cbl
  6559             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6560             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6561             88  CM-LF-DECLINED               VALUE 'D'.
  6562             88  CM-LF-VOIDED                 VALUE 'V'.
  6563
  6564         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6565         16  CM-AH-CANCEL-DT               PIC XX.
  6566         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6567
  6568         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6569         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6570         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6571
  6572         16  CM-AH-CURRENT-STATUS          PIC X.
  6573             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6574                                                'M' '4' '5' '9'.
  6575             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6576             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6577             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6578             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6579             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6580             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6581             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6582             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6583             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6584             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6585             88  CM-AH-DECLINED               VALUE 'D'.
  6586             88  CM-AH-VOIDED                 VALUE 'V'.
  6587
  6588         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6589             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6590             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6591             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6592         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6593
  6594         16  CM-ENTRY-BATCH                PIC X(6).
  6595         16  CM-LF-EXIT-BATCH              PIC X(6).
  6596         16  CM-AH-EXIT-BATCH              PIC X(6).
  6597         16  CM-LAST-MONTH-END             PIC XX.
  6598
  6599     12  CM-NOTE-SW                        PIC X.
  6600         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6601         88  CERT-NOTES-PRESENT               VALUE '1'.
  6602         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6603         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6604         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6605         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6606         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6607         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6608     12  CM-COMP-EXCP-SW                   PIC X.
  6609         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6610         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6611     12  CM-INSURED-ADDRESS-SW             PIC X.
  6612         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6613         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6614
  6615*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6616     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 123
* EL6311.cbl
  6617     12  FILLER                            PIC X.
  6618
  6619*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6620     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6621     12  FILLER                            PIC X.
  6622*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6623     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6624
  6625     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6626         88  CERT-ADDED-BATCH                 VALUE ' '.
  6627         88  CERT-ADDED-ONLINE                VALUE '1'.
  6628         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6629         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6630         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6631     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6632         88  CERT-AS-LOADED                   VALUE ' '.
  6633         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6634         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6635         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6636         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6637         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6638         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6639         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6640
  6641     12  CM-ACCOUNT-COMM-PCTS.
  6642         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6643         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6644
  6645     12  CM-USER-FIELD                     PIC X.
  6646     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6647     12  CM-CLP-STATE                      PIC XX.
  6648     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6649     12  CM-USER-RESERVED                  PIC XXX.
  6650     12  FILLER REDEFINES CM-USER-RESERVED.
  6651         16  CM-AH-CLASS-CD                PIC XX.
  6652         16  F                             PIC X.
  6653******************************************************************
  6654
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 124
* EL6311.cbl
  6656*    COPY ERCNOTE.
  6657******************************************************************
  6658*                                                                *
  6659*                                                                *
  6660*                            ERCNOTE                             *
  6661*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6662*                            VMOD=2.003                          *
  6663*                                                                *
  6664*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6665*                                                                *
  6666*        FILE TYPE= VSAM,KSDS                                    *
  6667*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6668*                                                                *
  6669*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6670*                                                                *
  6671*        LOG = YES                                               *
  6672*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6673*                                                                *
  6674******************************************************************
  6675*                   C H A N G E   L O G
  6676*
  6677* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6678*-----------------------------------------------------------------
  6679*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6680* EFFECTIVE    NUMBER
  6681*-----------------------------------------------------------------
  6682* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6683*                                FILE WILL CONTAIN BILLING NOTES O
  6684******************************************************************
  6685
  6686 01  CERTIFICATE-NOTE.
  6687     12  CN-RECORD-ID                PIC  XX.
  6688         88  VALID-CN-ID                  VALUE 'CN'.
  6689
  6690     12  CN-CONTROL-PRIMARY.
  6691         16  CN-COMPANY-CD           PIC X.
  6692         16  CN-CARRIER              PIC X.
  6693         16  CN-GROUPING.
  6694             20 CN-GROUPING-PREFIX   PIC XXX.
  6695             20 CN-GROUPING-PRIME    PIC XXX.
  6696         16  CN-STATE                PIC XX.
  6697         16  CN-ACCOUNT.
  6698             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6699             20 CN-ACCOUNT-PRIME     PIC X(6).
  6700         16  CN-CERT-EFF-DT          PIC XX.
  6701         16  CN-CERT-NO.
  6702             20  CN-CERT-PRIME       PIC X(10).
  6703             20  CN-CERT-SFX         PIC X.
  6704
  6705     12  CN-BILLING-START-LINE-NO    PIC 99.
  6706     12  CN-BILLING-END-LINE-NO      PIC 99.
  6707
  6708     12  CN-LINES.
  6709         16  CN-LINE OCCURS 10       PIC X(77).
  6710
  6711     12  CN-LAST-MAINT-DT            PIC XX.
  6712     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6713     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 125
* EL6311.cbl
  6714     12  FILLER                      PIC X(6).
  6715******************************************************************
  6716
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 126
* EL6311.cbl
  6718*    COPY ERCPNDM.
  6719******************************************************************
  6720*                                                                *
  6721*                                                                *
  6722*                            ERCPNDM                             *
  6723*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6724*                            VMOD=2.003                          *
  6725*                                                                *
  6726*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6727*                                                                *
  6728*   FILE TYPE = VSAM,KSDS                                        *
  6729*   RECORD SIZE = 374   RECFORM = FIX                            *
  6730*                                                                *
  6731*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6732*   ALTERNATE PATH    = NOT USED                                 *
  6733*                                                                *
  6734*   LOG = YES                                                    *
  6735*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6736******************************************************************
  6737*                   C H A N G E   L O G
  6738*
  6739* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6740*-----------------------------------------------------------------
  6741*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6742* EFFECTIVE    NUMBER
  6743*-----------------------------------------------------------------
  6744* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6745* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6746* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6747******************************************************************
  6748
  6749 01  PENDING-MAILING-DATA.
  6750     12  PM-RECORD-ID                      PIC XX.
  6751         88  VALID-MA-ID                       VALUE 'PM'.
  6752
  6753     12  PM-CONTROL-PRIMARY.
  6754         16  PM-COMPANY-CD                 PIC X.
  6755         16  PM-ENTRY-BATCH                PIC X(6).
  6756         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6757         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6758
  6759     12  FILLER                            PIC X(14).
  6760
  6761     12  PM-ACCESS-CONTROL.
  6762         16  PM-SOURCE-SYSTEM              PIC XX.
  6763             88  PM-FROM-CREDIT                VALUE 'CR'.
  6764             88  PM-FROM-VSI                   VALUE 'VS'.
  6765             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6766             88  PM-FROM-OTHER                 VALUE 'OT'.
  6767         16  PM-RECORD-ADD-DT              PIC XX.
  6768         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6769         16  PM-LAST-MAINT-DT              PIC XX.
  6770         16  PM-LAST-MAINT-BY              PIC XXXX.
  6771         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6772
  6773     12  PM-PROFILE-INFO.
  6774         16  PM-QUALIFY-CODE-1             PIC XX.
  6775         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 127
* EL6311.cbl
  6776         16  PM-QUALIFY-CODE-3             PIC XX.
  6777         16  PM-QUALIFY-CODE-4             PIC XX.
  6778         16  PM-QUALIFY-CODE-5             PIC XX.
  6779
  6780         16  PM-INSURED-LAST-NAME          PIC X(15).
  6781         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6782         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6783         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6784         16  PM-INSURED-BIRTH-DT           PIC XX.
  6785         16  PM-INSURED-SEX                PIC X.
  6786             88  PM-SEX-MALE                   VALUE 'M'.
  6787             88  PM-SEX-FEMALE                 VALUE 'F'.
  6788         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6789
  6790         16  PM-ADDRESS-CORRECTED          PIC X.
  6791         16  PM-JOINT-BIRTH-DT             PIC XX.
  6792*        16  FILLER                        PIC X(12).
  6793
  6794         16  PM-ADDRESS-LINE-1             PIC X(30).
  6795         16  PM-ADDRESS-LINE-2             PIC X(30).
  6796         16  PM-CITY-STATE.
  6797             20  PM-CITY                   PIC X(28).
  6798             20  PM-STATE                  PIC XX.
  6799         16  PM-ZIP.
  6800             20  PM-ZIP-CODE.
  6801                 24  PM-ZIP-1              PIC X.
  6802                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6803                 24  FILLER                PIC X(4).
  6804             20  PM-ZIP-PLUS4              PIC X(4).
  6805         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6806             20  PM-CAN-POST1              PIC XXX.
  6807             20  PM-CAN-POST2              PIC XXX.
  6808             20  FILLER                    PIC XXX.
  6809
  6810         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6811
  6812         16  FILLER                        PIC X(03).
  6813
  6814     12  PM-CRED-BENE-INFO.
  6815         16  PM-CRED-BENE-NAME             PIC X(25).
  6816         16  PM-CRED-BENE-ADDR             PIC X(30).
  6817         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6818         16  PM-CRED-BENE-CTYST.
  6819             20  PM-CRED-BENE-CITY         PIC X(28).
  6820             20  PM-CRED-BENE-STATE        PIC XX.
  6821         16  PM-CRED-BENE-ZIP.
  6822             20  PM-CB-ZIP-CODE.
  6823                 24  PM-CB-ZIP-1           PIC X.
  6824                     88  PM-CB-CANADIAN-POST-CODE
  6825                                  VALUE 'A' THRU 'Z'.
  6826                 24  FILLER                PIC X(4).
  6827             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6828         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6829             20  PM-CB-CAN-POST1           PIC XXX.
  6830             20  PM-CB-CAN-POST2           PIC XXX.
  6831             20  FILLER                    PIC XXX.
  6832     12  PM-POST-CARD-MAIL-DATA.
  6833         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 128
* EL6311.cbl
  6834             20  PM-MAIL-TYPE              PIC X.
  6835                 88  PM-12MO-MAILING           VALUE '1'.
  6836                 88  PM-EXP-MAILING            VALUE '2'.
  6837             20  PM-MAIL-STATUS            PIC X.
  6838                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6839                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6840                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6841             20  PM-MAIL-DATE              PIC XX.
  6842     12  FILLER                            PIC XX.
  6843     12  FILLER                            PIC X(12).
  6844*    12  FILLER                            PIC X(30).
  6845
  6846******************************************************************
  6847
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 129
* EL6311.cbl
  6849*    COPY ERCMAIL.
  6850******************************************************************
  6851*                                                                *
  6852*                                                                *
  6853*                            ERCMAIL                             *
  6854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6855*                            VMOD=2.003                          *
  6856*                                                                *
  6857*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6858*                                                                *
  6859*   FILE TYPE = VSAM,KSDS                                        *
  6860*   RECORD SIZE = 374   RECFORM = FIX                            *
  6861*                                                                *
  6862*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6863*   ALTERNATE PATH    = NOT USED                                 *
  6864*                                                                *
  6865*   LOG = YES                                                    *
  6866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6867******************************************************************
  6868*                   C H A N G E   L O G
  6869*
  6870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6871*-----------------------------------------------------------------
  6872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6873* EFFECTIVE    NUMBER
  6874*-----------------------------------------------------------------
  6875* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6876* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6877* 111108                   PEMA  ADD CRED BENE ADDR2
  6878******************************************************************
  6879
  6880 01  MAILING-DATA.
  6881     12  MA-RECORD-ID                      PIC XX.
  6882         88  VALID-MA-ID                       VALUE 'MA'.
  6883
  6884     12  MA-CONTROL-PRIMARY.
  6885         16  MA-COMPANY-CD                 PIC X.
  6886         16  MA-CARRIER                    PIC X.
  6887         16  MA-GROUPING.
  6888             20  MA-GROUPING-PREFIX        PIC XXX.
  6889             20  MA-GROUPING-PRIME         PIC XXX.
  6890         16  MA-STATE                      PIC XX.
  6891         16  MA-ACCOUNT.
  6892             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6893             20  MA-ACCOUNT-PRIME          PIC X(6).
  6894         16  MA-CERT-EFF-DT                PIC XX.
  6895         16  MA-CERT-NO.
  6896             20  MA-CERT-PRIME             PIC X(10).
  6897             20  MA-CERT-SFX               PIC X.
  6898
  6899     12  FILLER                            PIC XX.
  6900
  6901     12  MA-ACCESS-CONTROL.
  6902         16  MA-SOURCE-SYSTEM              PIC XX.
  6903             88  MA-FROM-CREDIT                VALUE 'CR'.
  6904             88  MA-FROM-VSI                   VALUE 'VS'.
  6905             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6906             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 130
* EL6311.cbl
  6907         16  MA-RECORD-ADD-DT              PIC XX.
  6908         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6909         16  MA-LAST-MAINT-DT              PIC XX.
  6910         16  MA-LAST-MAINT-BY              PIC XXXX.
  6911         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6912
  6913     12  MA-PROFILE-INFO.
  6914         16  MA-QUALIFY-CODE-1             PIC XX.
  6915         16  MA-QUALIFY-CODE-2             PIC XX.
  6916         16  MA-QUALIFY-CODE-3             PIC XX.
  6917         16  MA-QUALIFY-CODE-4             PIC XX.
  6918         16  MA-QUALIFY-CODE-5             PIC XX.
  6919
  6920         16  MA-INSURED-LAST-NAME          PIC X(15).
  6921         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6922         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6923         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6924         16  MA-INSURED-BIRTH-DT           PIC XX.
  6925         16  MA-INSURED-SEX                PIC X.
  6926             88  MA-SEX-MALE                   VALUE 'M'.
  6927             88  MA-SEX-FEMALE                 VALUE 'F'.
  6928         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6929
  6930         16  MA-ADDRESS-CORRECTED          PIC X.
  6931         16  MA-JOINT-BIRTH-DT             PIC XX.
  6932*        16  FILLER                        PIC X(12).
  6933
  6934         16  MA-ADDRESS-LINE-1             PIC X(30).
  6935         16  MA-ADDRESS-LINE-2             PIC X(30).
  6936         16  MA-CITY-STATE.
  6937             20  MA-CITY                   PIC X(28).
  6938             20  MA-ADDR-STATE             PIC XX.
  6939         16  MA-ZIP.
  6940             20  MA-ZIP-CODE.
  6941                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6942                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6943                 24  FILLER                PIC X(4).
  6944             20  MA-ZIP-PLUS4              PIC X(4).
  6945         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6946             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6947             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6948             20  FILLER                    PIC X(3).
  6949
  6950         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6951
  6952         16  FILLER                        PIC XXX.
  6953*        16  FILLER                        PIC X(10).
  6954
  6955     12  MA-CRED-BENE-INFO.
  6956         16  MA-CRED-BENE-NAME                 PIC X(25).
  6957         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6958         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6959         16  MA-CRED-BENE-CTYST.
  6960             20  MA-CRED-BENE-CITY             PIC X(28).
  6961             20  MA-CRED-BENE-STATE            PIC XX.
  6962         16  MA-CRED-BENE-ZIP.
  6963             20  MA-CB-ZIP-CODE.
  6964                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 131
* EL6311.cbl
  6965                     88  MA-CB-CANADIAN-POST-CODE
  6966                                           VALUE 'A' THRU 'Z'.
  6967                 24  FILLER                    PIC X(4).
  6968             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6969         16  MA-CB-CANADIAN-POSTAL-CODE
  6970                            REDEFINES MA-CRED-BENE-ZIP.
  6971             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6972             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6973             20  FILLER                        PIC X(3).
  6974     12  MA-POST-CARD-MAIL-DATA.
  6975         16  MA-MAIL-DATA OCCURS 7.
  6976             20  MA-MAIL-TYPE              PIC X.
  6977                 88  MA-12MO-MAILING           VALUE '1'.
  6978                 88  MA-EXP-MAILING            VALUE '2'.
  6979             20  MA-MAIL-STATUS            PIC X.
  6980                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6981                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6982                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6983             20  MA-MAIL-DATE              PIC XX.
  6984     12  FILLER                            PIC XX.
  6985     12  FILLER                            PIC XX.
  6986*    12  FILLER                            PIC X(30).
  6987******************************************************************
  6988
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 132
* EL6311.cbl
  6990*    COPY ERCRQST.
  6991******************************************************************
  6992*                                                                *
  6993*                                                                *
  6994*                            ERCRQST.                            *
  6995*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6996*                            VMOD=2.002                          *
  6997*                                                                *
  6998*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  6999*                                                                *
  7000*   FILE TYPE = VSAM,KSDS                                        *
  7001*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7002*                                                                *
  7003*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7004*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7005*                                   ACCOUNT, REF, BATCH)         *
  7006*                                                RKP=9, LEN=38   *
  7007*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7008*                                   ACCOUNT, REF, BATCH)         *
  7009*                                                RKP=47, LEN=46  *
  7010*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7011*                                   BATCH)                       *
  7012*                                                RKP=93, LEN=24  *
  7013*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7014*                                   REF, BATCH)                  *
  7015*                                                RKP=117, LEN=35 *
  7016*   LOG = NO                                                     *
  7017*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7018******************************************************************
  7019
  7020 01  AR-REQUEST-RECORD.
  7021     12  RQ-RECORD-ID                     PIC XX.
  7022         88  VALID-RQ-ID                        VALUE 'RQ'.
  7023
  7024     12  RQ-CONTROL-PRIMARY.
  7025         16  RQ-COMPANY-CD                PIC X.
  7026         16  RQ-ENTRY-BATCH               PIC X(6).
  7027
  7028     12  RQ-CONTROL-BY-ACCT-REF.
  7029         16  RQ-COMPANY-CD-A1             PIC X.
  7030         16  RQ-CARRIER-A1                PIC X.
  7031         16  RQ-GROUPING-A1               PIC X(6).
  7032         16  RQ-STATE-A1                  PIC XX.
  7033         16  RQ-ACCOUNT-A1                PIC X(10).
  7034         16  RQ-REFERENCE-A1              PIC X(12).
  7035         16  RQ-BATCH-A1                  PIC X(6).
  7036
  7037     12  RQ-CONTROL-BY-FIN-RESP.
  7038         16  RQ-COMPANY-CD-A2             PIC X.
  7039         16  RQ-CARRIER-A2                PIC X.
  7040         16  RQ-GROUPING-A2               PIC X(6).
  7041         16  RQ-FIN-RESP-A2               PIC X(10).
  7042         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7043         16  RQ-REFERENCE-A2              PIC X(12).
  7044         16  RQ-BATCH-A2                  PIC X(6).
  7045
  7046     12  RQ-CONTROL-BY-ACCT-AGENT.
  7047         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 133
* EL6311.cbl
  7048         16  RQ-CARRIER-A3                PIC X.
  7049         16  RQ-GROUPING-A3               PIC X(6).
  7050         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7051         16  RQ-BATCH-A3                  PIC X(6).
  7052
  7053     12  RQ-CONTROL-BY-SUMMARY.
  7054         16  RQ-COMPANY-CD-A4             PIC X.
  7055         16  RQ-SUMMARY-CODE              PIC X(6).
  7056         16  RQ-ACCOUNT-A4                PIC X(10).
  7057         16  RQ-REFERENCE-A4              PIC X(12).
  7058         16  RQ-BATCH-A4                  PIC X(6).
  7059
  7060     12  RQ-REQUEST-METHOD                PIC X.
  7061         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7062         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7063         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7064         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7065     12  FILLER                           PIC X.
  7066     12  RQ-STATUS                        PIC X.
  7067         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7068         88  RQ-RESUBMIT                      VALUE 'R'.
  7069     12  RQ-PROCESSOR-ID                  PIC X(4).
  7070     12  RQ-ENTRY-DT                      PIC XX.
  7071     12  RQ-MO-END-DT                     PIC XX.
  7072     12  RQ-REQUEST-DT                    PIC XX.
  7073     12  RQ-STMT-DT                       PIC XX.
  7074     12  RQ-REVERSAL-DT                   PIC XX.
  7075     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7076     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7077
  7078     12  FILLER                           PIC X(27).
  7079
  7080******************************************************************
  7081
  7082
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 134
* EL6311.cbl
  7084*    COPY ERCLOFC.
  7085******************************************************************
  7086*                                                                *
  7087*                                                                *
  7088*                            ERCLOFC                             *
  7089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7090*                            VMOD=2.003                          *
  7091*                                                                *
  7092*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7093*                                                                *
  7094*   FILE TYPE = VSAM,KSDS                                        *
  7095*   RECORD SIZE = 670   RECFORM = FIX                            *
  7096*                                                                *
  7097*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7098*                                                                *
  7099*   LOG = YES                                                    *
  7100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7101*                                                                *
  7102******************************************************************
  7103
  7104 01  LOAN-OFFICER-MASTER.
  7105     12  LO-RECORD-ID                PIC XX.
  7106         88  VALID-LO-ID                VALUE 'LO'.
  7107
  7108     12  LO-CONTROL-PRIMARY.
  7109         16  LO-COMPANY-CD           PIC X.
  7110         16  LO-CARRIER              PIC X.
  7111         16  LO-GROUPING.
  7112             20  LO-GROUPING-PREFIX  PIC XXX.
  7113             20  LO-GROUPING-PRIME   PIC XXX.
  7114         16  LO-STATE                PIC XX.
  7115         16  LO-ACCOUNT.
  7116             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7117             20  LO-ACCOUNT-PRIME    PIC X(6).
  7118         16  LO-OFFICER-CODE         PIC X(5).
  7119
  7120     12  LO-OFFICER-NAME             PIC X(30).
  7121
  7122     12  LO-LAST-MAINT-DT            PIC XX.
  7123     12  LO-LAST-USER                PIC X(4).
  7124     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7125
  7126     12  LO-COMP-CONTROL             PIC X.
  7127             88  LO-SHOW-COMP           VALUE 'Y'.
  7128             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7129     12  LO-DETAIL-CONTROL           PIC X.
  7130             88  LO-PRINT-DETAIL        VALUE 'D'.
  7131             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7132
  7133     12  LO-SV-CARRIER               PIC X.
  7134     12  LO-SV-GROUPING              PIC X(6).
  7135     12  LO-SV-STATE                 PIC XX.
  7136
  7137     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7138     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7139
  7140     12  LO-OFFICER-INFO.
  7141         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 135
* EL6311.cbl
  7142             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7143             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7144             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7145             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7146             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7147             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7148             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7149             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7150     12  FILLER                      PIC X(198).
  7151******************************************************************
  7152
  7153*    COPY ERCPYAJ.
  7154******************************************************************
  7155*                                                                *
  7156*                            ERCPYAJ                             *
  7157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7158*                            VMOD=2.015                          *
  7159*                                                                *
  7160*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7161*                                                                *
  7162*                                                                *
  7163*   FILE TYPE = VSAM,KSDS                                        *
  7164*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7165*                                                                *
  7166*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7167*       ALTERNATE PATHS = NONE                                   *
  7168*                                                                *
  7169*   LOG = YES                                                    *
  7170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7171******************************************************************
  7172******************************************************************
  7173*                   C H A N G E   L O G
  7174*
  7175* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7176*-----------------------------------------------------------------
  7177*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7178* EFFECTIVE    NUMBER
  7179*-----------------------------------------------------------------
  7180* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7181* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7182******************************************************************
  7183
  7184 01  PENDING-PAY-ADJ.
  7185     12  PY-RECORD-ID                     PIC XX.
  7186         88  VALID-PY-ID                        VALUE 'PY'.
  7187
  7188     12  PY-CONTROL-PRIMARY.
  7189         16  PY-COMPANY-CD                PIC X.
  7190         16  PY-CARRIER                   PIC X.
  7191         16  PY-GROUPING                  PIC X(6).
  7192         16  PY-FIN-RESP                  PIC X(10).
  7193         16  PY-ACCOUNT                   PIC X(10).
  7194         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7195                                          PIC X(10).
  7196         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7197         16  PY-RECORD-TYPE               PIC X.
  7198             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7199             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 136
* EL6311.cbl
  7200             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7201             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7202             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7203             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7204             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7205             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7206             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7207             88  PY-FICA-ENTRY                VALUE 'F'.
  7208             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7209             88  PY-POLICY-FEE                VALUE 'W'.
  7210             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7211
  7212     12  PY-PYMT-TYPE                     PIC X.
  7213             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7214             88  PY-REINS-PYMT                VALUE 'R'.
  7215             88  PY-EXP-PYMT                  VALUE 'E'.
  7216
  7217     12  PY-BIL-INV                       PIC X(6).
  7218     12  PY-REF-NO                        PIC X(12).
  7219
  7220     12  PY-LAST-MAINT-DT                 PIC XX.
  7221     12  PY-LAST-MAINT-BY                 PIC X(4).
  7222     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7223
  7224     12  PY-PYADJ-RECORD.
  7225         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7226         16  PY-ENTRY-COMMENT             PIC X(30).
  7227         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7228             20  PY-GL-ACCOUNT            PIC X(10).
  7229             20  PY-GL-STATE              PIC X(02).
  7230             20  PY-GL-CANC-SW            PIC X(01).
  7231                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7232                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7233             20  PY-GL-COMMENT            PIC X(10).
  7234             20  FILLER      REDEFINES PY-GL-COMMENT.
  7235                 24  PY-GL-CHECK-NO       PIC 9(06).
  7236                 24  FILLER               PIC X(04).
  7237             20  FILLER                   PIC X(07).
  7238         16  PY-SAVE-ACCOUNT              PIC X(10).
  7239         16  PY-SAVE-TYPE                 PIC X(01).
  7240
  7241         16  PY-LETTERS.
  7242             20  PY-LETTER OCCURS 3 TIMES
  7243                           INDEXED BY PY-LET-NDX
  7244                                          PIC X(04).
  7245
  7246         16  PY-ERCOMP-TYPE               PIC X.
  7247             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7248             88  PY-GA-TYPE                   VALUE 'G'.
  7249             88  PY-BANK-TYPE                 VALUE 'B'.
  7250         16  FILLER                       PIC X(05).
  7251
  7252     12  PY-RECORD-STATUS.
  7253         16  PY-CREDIT-SELECT-DT          PIC XX.
  7254         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7255         16  PY-BILLED-DATE               PIC XX.
  7256         16  PY-REPORTED-DT               PIC XX.
  7257         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 137
* EL6311.cbl
  7258             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7259             88  PY-GA-PMT                    VALUE 'G'.
  7260             88  PY-OVWRITE-PMT               VALUE 'O'.
  7261             88  PY-NON-AR-PMT                VALUE 'N'.
  7262         16  FILLER                       PIC X(5).
  7263         16  PY-INPUT-DT                  PIC XX.
  7264         16  PY-CHECK-NUMBER              PIC X(6).
  7265         16  PY-VOID-SW                   PIC X.
  7266             88  PY-CHECK-VOIDED              VALUE 'V'.
  7267         16  PY-CHECK-ORIGIN-SW           PIC X.
  7268             88  PY-BILLING-CHECK             VALUE 'B'.
  7269             88  PY-REFUND-CHECK              VALUE 'R'.
  7270             88  PY-GA-CHECK                  VALUE 'G'.
  7271             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7272             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7273         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7274         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7275         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7276         16  PY-BILL-FLAG                 PIC X.
  7277             88  PY-BILLED                    VALUE 'B'.
  7278         16  PY-AR-FLAG                   PIC X.
  7279             88  PY-AR-CYCLE                  VALUE 'C'.
  7280             88  PY-AR-MONTH-END              VALUE 'M'.
  7281         16  PY-AR-DATE                   PIC XX.
  7282
  7283     12  PY-GL-CODES.
  7284         16  PY-GL-DB                     PIC X(14).
  7285         16  PY-GL-CR                     PIC X(14).
  7286         16  PY-GL-FLAG                   PIC X.
  7287         16  PY-GL-DATE                   PIC XX.
  7288
  7289     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7290     12  FILLER                           PIC X(3).
  7291******************************************************************
  7292
  7293*    COPY ERCCNOT.
  7294******************************************************************
  7295*                                                                *
  7296*                            ERCCNOT                             *
  7297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7298*                            VMOD=2.003                          *
  7299*                                                                *
  7300*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7301*                                                                *
  7302*        FILE TYPE= VSAM,KSDS                                    *
  7303*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7304*                                                                *
  7305*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7306*                                                                *
  7307*        LOG = YES                                               *
  7308*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7309*                                                                *
  7310******************************************************************
  7311*                   C H A N G E   L O G
  7312*
  7313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7314*-----------------------------------------------------------------
  7315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 138
* EL6311.cbl
  7316* EFFECTIVE    NUMBER
  7317*-----------------------------------------------------------------
  7318* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7319******************************************************************
  7320
  7321 01  CERT-NOTE-FILE.
  7322     12  CZ-RECORD-ID                PIC  XX.
  7323         88  VALID-CZ-ID                  VALUE 'CZ'.
  7324
  7325     12  CZ-CONTROL-PRIMARY.
  7326         16  CZ-COMPANY-CD           PIC X.
  7327         16  CZ-CARRIER              PIC X.
  7328         16  CZ-GROUPING.
  7329             20 CZ-GROUPING-PREFIX   PIC XXX.
  7330             20 CZ-GROUPING-PRIME    PIC XXX.
  7331         16  CZ-STATE                PIC XX.
  7332         16  CZ-ACCOUNT.
  7333             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7334             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7335         16  CZ-CERT-EFF-DT          PIC XX.
  7336         16  CZ-CERT-NO.
  7337             20  CZ-CERT-PRIME       PIC X(10).
  7338             20  CZ-CERT-SFX         PIC X.
  7339         16  CZ-RECORD-TYPE          PIC X.
  7340             88  CERT-NOTE           VALUE '1'.
  7341             88  CLAIM-CERT-NOTE     VALUE '2'.
  7342         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7343
  7344     12  CZ-LAST-MAINT-DT            PIC XX.
  7345     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7346     12  CZ-LAST-MAINT-USER          PIC X(4).
  7347
  7348     12  CZ-NOTE-INFORMATION.
  7349         16  CZ-NOTE                 PIC X(63).
  7350         16  FILLER                  PIC X(39).
  7351******************************************************************
  7352
  7353*    COPY ELCMSTR.
  7354******************************************************************
  7355*                                                                *
  7356*                            ELCMSTR.                            *
  7357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7358*                            VMOD=2.012                          *
  7359*                                                                *
  7360*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7361*                                                                *
  7362*   FILE TYPE = VSAM,KSDS                                        *
  7363*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7364*                                                                *
  7365*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7366*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7367*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7368*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7369*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7370*                                                 RKP=75,LEN=21  *
  7371*                                                                *
  7372*   **** NOTE ****                                               *
  7373*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 139
* EL6311.cbl
  7374*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7375*                                                                *
  7376*   LOG = YES                                                    *
  7377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7378******************************************************************
  7379*                   C H A N G E   L O G
  7380*
  7381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7382*-----------------------------------------------------------------
  7383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7384* EFFECTIVE    NUMBER
  7385*-----------------------------------------------------------------
  7386* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7387* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7388******************************************************************
  7389 01  CLAIM-MASTER.
  7390     12  CL-RECORD-ID                PIC XX.
  7391         88  VALID-CL-ID         VALUE 'CL'.
  7392
  7393     12  CL-CONTROL-PRIMARY.
  7394         16  CL-COMPANY-CD           PIC X.
  7395         16  CL-CARRIER              PIC X.
  7396         16  CL-CLAIM-NO             PIC X(7).
  7397         16  CL-CERT-NO.
  7398             20  CL-CERT-PRIME       PIC X(10).
  7399             20  CL-CERT-SFX         PIC X.
  7400
  7401     12  CL-CONTROL-BY-NAME.
  7402         16  CL-COMPANY-CD-A1        PIC X.
  7403         16  CL-INSURED-LAST-NAME    PIC X(15).
  7404         16  CL-INSURED-NAME.
  7405             20  CL-INSURED-1ST-NAME PIC X(12).
  7406             20  CL-INSURED-MID-INIT PIC X.
  7407
  7408     12  CL-CONTROL-BY-SSN.
  7409         16  CL-COMPANY-CD-A2        PIC X.
  7410         16  CL-SOC-SEC-NO.
  7411             20  CL-SSN-STATE        PIC XX.
  7412             20  CL-SSN-ACCOUNT      PIC X(6).
  7413             20  CL-SSN-LN3          PIC X(3).
  7414
  7415     12  CL-CONTROL-BY-CERT-NO.
  7416         16  CL-COMPANY-CD-A4        PIC X.
  7417         16  CL-CERT-NO-A4.
  7418             20  CL-CERT-A4-PRIME    PIC X(10).
  7419             20  CL-CERT-A4-SFX      PIC X.
  7420
  7421     12  CL-CONTROL-BY-CCN.
  7422         16  CL-COMPANY-CD-A5        PIC X.
  7423         16  CL-CCN-A5.
  7424             20  CL-CCN.
  7425                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7426                 24  CL-CCN-PRIME-A5 PIC X(12).
  7427             20  CL-CCN-FILLER-A5    PIC X(4).
  7428
  7429     12  CL-INSURED-PROFILE-DATA.
  7430         16  CL-INSURED-BIRTH-DT     PIC XX.
  7431         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 140
* EL6311.cbl
  7432             88  INSURED-IS-MALE        VALUE 'M'.
  7433             88  INSURED-IS-FEMALE      VALUE 'F'.
  7434             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7435         16  CL-INSURED-OCC-CD       PIC X(6).
  7436         16  FILLER                  PIC X(5).
  7437
  7438     12  CL-PROCESSING-INFO.
  7439         16  CL-PROCESSOR-ID         PIC X(4).
  7440         16  CL-CLAIM-STATUS         PIC X.
  7441             88  CLAIM-IS-OPEN          VALUE 'O'.
  7442             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7443         16  CL-CLAIM-TYPE           PIC X.
  7444*            88  AH-CLAIM               VALUE 'A'.
  7445*            88  LIFE-CLAIM             VALUE 'L'.
  7446*            88  PROPERTY-CLAIM         VALUE 'P'.
  7447*            88  IUI-CLAIM              VALUE 'I'.
  7448*            88  GAP-CLAIM              VALUE 'G'.
  7449         16  CL-CLAIM-PREM-TYPE      PIC X.
  7450             88  SINGLE-PREMIUM         VALUE '1'.
  7451             88  O-B-COVERAGE           VALUE '2'.
  7452             88  OPEN-END-COVERAGE      VALUE '3'.
  7453         16  CL-INCURRED-DT          PIC XX.
  7454         16  CL-REPORTED-DT          PIC XX.
  7455         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7456         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7457         16  CL-LAST-PMT-DT          PIC XX.
  7458         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7459         16  CL-PAID-THRU-DT         PIC XX.
  7460         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7461         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7462         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7463         16  CL-PMT-CALC-METHOD      PIC X.
  7464             88  CL-360-DAY-YR          VALUE '1'.
  7465             88  CL-365-DAY-YR          VALUE '2'.
  7466             88  CL-FULL-MONTHS         VALUE '3'.
  7467         16  CL-CAUSE-CD             PIC X(6).
  7468
  7469         16  CL-PRIME-CERT-NO.
  7470             20  CL-PRIME-CERT-PRIME PIC X(10).
  7471             20  CL-PRIME-CERT-SFX   PIC X.
  7472
  7473         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7474             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7475             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7476
  7477         16  CL-MICROFILM-NO         PIC X(10).
  7478         16  CL-PROG-FORM-TYPE       PIC X.
  7479         16  CL-LAST-ADD-ON-DT       PIC XX.
  7480
  7481         16  CL-LAST-REOPEN-DT       PIC XX.
  7482         16  CL-LAST-CLOSE-DT        PIC XX.
  7483         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7484             88  FINAL-PAID             VALUE '1'.
  7485             88  CLAIM-DENIED           VALUE '2'.
  7486             88  AUTO-CLOSE             VALUE '3'.
  7487             88  MANUAL-CLOSE           VALUE '4'.
  7488             88  BENEFITS-CHANGED       VALUE 'C'.
  7489             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 141
* EL6311.cbl
  7490         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7491         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7492         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7493             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7494         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7495         16  FILLER                  PIC X.
  7496
  7497     12  CL-CERTIFICATE-DATA.
  7498         16  CL-CERT-ORIGIN          PIC X.
  7499             88  CERT-WAS-ONLINE        VALUE '1'.
  7500             88  CERT-WAS-CREATED       VALUE '2'.
  7501             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7502         16  CL-CERT-KEY-DATA.
  7503             20  CL-CERT-CARRIER     PIC X.
  7504             20  CL-CERT-GROUPING    PIC X(6).
  7505             20  CL-CERT-STATE       PIC XX.
  7506             20  CL-CERT-ACCOUNT.
  7507                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7508                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7509             20  CL-CERT-EFF-DT      PIC XX.
  7510
  7511     12  CL-STATUS-CONTROLS.
  7512         16  CL-PRIORITY-CD          PIC X.
  7513             88  CONFIDENTIAL-DATA      VALUE '8'.
  7514             88  HIGHEST-PRIORITY       VALUE '9'.
  7515         16  CL-SUPV-ATTN-CD         PIC X.
  7516             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7517             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7518         16  CL-PURGED-DT            PIC XX.
  7519         16  CL-RESTORED-DT          PIC XX.
  7520         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7521         16  CL-NEXT-RESEND-DT       PIC XX.
  7522         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7523         16  FILLER                  PIC XX.
  7524         16  CL-LAST-MAINT-DT        PIC XX.
  7525         16  CL-LAST-MAINT-USER      PIC X(4).
  7526         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7527         16  CL-LAST-MAINT-TYPE      PIC X.
  7528             88  CLAIM-SET-UP           VALUE ' '.
  7529             88  PAYMENT-MADE           VALUE '1'.
  7530             88  LETTER-SENT            VALUE '2'.
  7531             88  MASTER-WAS-ALTERED     VALUE '3'.
  7532             88  MASTER-WAS-RESTORED    VALUE '4'.
  7533             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7534             88  FILE-CONVERTED         VALUE '6'.
  7535             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7536             88  ERROR-CORRECTION       VALUE 'E'.
  7537         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7538         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7539         16  CL-BENEFICIARY          PIC X(10).
  7540         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7541         16  CL-DENIAL-TYPE          PIC X.
  7542             88  CL-TYPE-DENIAL          VALUE '1'.
  7543             88  CL-TYPE-RESCISSION      VALUE '2'.
  7544             88  CL-TYPE-REFORMATION     VALUE '3'.
  7545             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7546             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7547         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 142
* EL6311.cbl
  7548
  7549     12  CL-TRAILER-CONTROLS.
  7550         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7551             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7552             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7553             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7554         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7555         16  FILLER                  PIC XX.
  7556         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7557         16  CL-ADDRESS-TRAILER-CNT.
  7558             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7559                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7560             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7561                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7562             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7563                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7564             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7565                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7566             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7567                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7568             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7569                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7570             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7571                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7572
  7573     12  CL-CV-REFERENCE-NO.
  7574         16  CL-CV-REFNO-PRIME       PIC X(18).
  7575         16  CL-CV-REFNO-SFX         PIC XX.
  7576
  7577     12  CL-FILE-LOCATION            PIC X(4).
  7578
  7579     12  CL-PROCESS-ERRORS.
  7580         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7581             88  NO-FATAL-ERRORS        VALUE ZERO.
  7582         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7583             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7584
  7585     12  CL-PRODUCT-CD               PIC X.
  7586
  7587     12  CL-CURRENT-KEY-DATA.
  7588         16  CL-CURRENT-CARRIER      PIC X.
  7589         16  CL-CURRENT-GROUPING     PIC X(6).
  7590         16  CL-CURRENT-STATE        PIC XX.
  7591         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7592
  7593     12  CL-ASSOCIATES               PIC X.
  7594         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7595         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7596         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7597         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7598
  7599     12  CL-ACTIVITY-CODE            PIC 99.
  7600     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7601     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7602
  7603     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7604     12  CL-LAG-REPORT-CODE          PIC 9.
  7605     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 143
* EL6311.cbl
  7606     12  CL-LEGAL-STATE              PIC XX.
  7607
  7608*    12  FILLER                      PIC X(5).
  7609     12  CL-YESNOSW                  PIC X.
  7610     12  FILLER                      PIC X(4).
  7611
  7612*    COPY ERCENDT.
  7613******************************************************************
  7614*                                                                *
  7615*                                                                *
  7616*                            ERCENDT.                            *
  7617*                            VMOD=2.001                          *
  7618*                                                                *
  7619*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7620*                                                                *
  7621*   FILE TYPE = VSAM,KSDS                                        *
  7622*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7623*                                                                *
  7624*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7625*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7626*                                                                *
  7627*   LOG = NO                                                     *
  7628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7629******************************************************************
  7630*-----------------------------------------------------------------
  7631*                   C H A N G E   L O G
  7632*
  7633* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7634*-----------------------------------------------------------------
  7635*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7636* EFFECTIVE    NUMBER
  7637*-----------------------------------------------------------------
  7638* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7639*                                WITH OPEN CLAIMS
  7640* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7641* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7642* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7643*-----------------------------------------------------------------
  7644 01  ENDORSEMENT-RECORD.
  7645     12  EN-RECORD-ID                PIC XX.
  7646         88  VALID-EN-ID                VALUE 'EN'.
  7647     12  EN-CONTROL-PRIMARY.
  7648         16  EN-COMPANY-CD           PIC X.
  7649         16  EN-CARRIER              PIC X.
  7650         16  EN-GROUPING             PIC X(6).
  7651         16  EN-STATE                PIC XX.
  7652         16  EN-ACCOUNT              PIC X(10).
  7653         16  EN-CERT-EFF-DT          PIC XX.
  7654         16  EN-CERT-NO.
  7655             20  EN-CERT-PRIME       PIC X(10).
  7656             20  EN-CERT-SFX         PIC X.
  7657         16  EN-REC-TYPE             PIC X.
  7658             88  EN-ISSUE               VALUE 'I'.
  7659             88  EN-CANCELLATION        VALUE 'C'.
  7660         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7661     12  EN-CONTROL-BY-ARCH-NO.
  7662         16  EN-COMPANY-CD-A1              PIC X.
  7663         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 144
* EL6311.cbl
  7664     12  EN-LAST-MAINT-DT            PIC XX.
  7665     12  EN-LAST-MAINT-BY            PIC X(4).
  7666     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7667     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7668     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7669         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7670         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7671         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7672         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7673         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7674         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7675         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7676         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7677         16  EN-LF-ORIG-BENCD        PIC XX.
  7678         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7679         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7680         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7681         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7682         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7683         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7684*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7685         16  EN-ORIG-CRED-BENE       PIC X(25).
  7686         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7687         16  FILLER                  PIC X.
  7688         16  EN-AH-ORIG-BENCD        PIC XX.
  7689         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7690         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7691         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7692         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7693*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7694*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7695         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7696         16  F                       PIC X(09).
  7697         16  EN-AH-ORIG-CP           PIC 99.
  7698         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7699         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7700         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7701         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7702         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7703         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7704         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7705         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7706         16  EN-LF-NEW-BENCD         PIC XX.
  7707         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7708         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7709         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7710         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7711         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7712         16  EN-LF-NEW-EXP-DT        PIC XX.
  7713         16  EN-NEW-CRED-BENE        PIC X(25).
  7714         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7715         16  FILLER                  PIC X.
  7716         16  EN-AH-NEW-BENCD         PIC XX.
  7717         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7718         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7719         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7720         16  EN-AH-NEW-EXP-DT        PIC XX.
  7721*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 145
* EL6311.cbl
  7722*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7723*        16  F                       PIC X(12).
  7724         16  EN-AH-NEW-CP            PIC 99.
  7725         16  EN-SIG-SW               PIC X.
  7726         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7727         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7728         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7729         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7730         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7731         16  FILLER                  PIC X(33).
  7732     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7733         16  EN-LF-ORIG-REF-DT       PIC XX.
  7734         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7735         16  EN-AH-ORIG-REF-DT       PIC XX.
  7736         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7737         16  EN-LF-NEW-REF-DT        PIC XX.
  7738         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7739         16  EN-AH-NEW-REF-DT        PIC XX.
  7740         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7741         16  EN-FLAG-CERT            PIC X.
  7742         16  EN-INS-LAST-NAME        PIC X(15).
  7743         16  EN-INS-FIRST-NAME       PIC X(10).
  7744         16  EN-INS-MIDDLE-INIT      PIC X.
  7745         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7746         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7747         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7748         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7749         16  FILLER                  PIC X(262).
  7750     12  EN-MONEY-SW             PIC X.
  7751     12  EN-HEALTH-APP           PIC X.
  7752     12  EN-VOUCHER-SW           PIC X.
  7753     12  EN-PAYEE                PIC X(14).
  7754     12  EN-INPUT-DT             PIC XX.
  7755     12  EN-PROCESS-DT           PIC XX.
  7756     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7757     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7758     12  EN-REASON-CODES.
  7759         16  F OCCURS 12.
  7760             20  EN-REASON-CODE  PIC X(4).
  7761     12  EN-TEMPLATE-USED        PIC X(8).
  7762     12  EN-DOCU-TYPE            PIC X.
  7763         88  EN-VERI-DOCU          VALUE 'V'.
  7764         88  EN-GCE-DOCU           VALUE 'G'.
  7765         88  EN-CANC-DOCU          VALUE 'C'.
  7766     12  EN-COMMENTS1            PIC X(13).
  7767     12  EN-COMMENTS2            PIC X(70).
  7768     12  EN-COMM-CHGBK           PIC X.
  7769         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7770         88  EN-CHG-ACCT           VALUE 'Y'.
  7771     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7772     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7773     12  EN-BATCH-NUMBER         PIC X(6).
  7774     12  EN-ACCT-SUMM            PIC X.
  7775     12  EN-CSO-SUMM             PIC X.
  7776     12  FILLER                  PIC X(13).
  7777******************************************************************
  7778
  7779*    COPY ELCCRTT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 146
* EL6311.cbl
  7780******************************************************************
  7781*                                                                *
  7782*                            ELCCRTT.                            *
  7783*                                                                *
  7784*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7785*                                                                *
  7786*   FILE TYPE = VSAM,KSDS                                        *
  7787*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7788*                                                                *
  7789*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7790*                                                                *
  7791*   LOG = YES                                                    *
  7792*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7793******************************************************************
  7794*                   C H A N G E   L O G
  7795*
  7796* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7797*-----------------------------------------------------------------
  7798*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7799* EFFECTIVE    NUMBER
  7800*-----------------------------------------------------------------
  7801* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7802* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7803* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7804* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7805******************************************************************
  7806
  7807 01  CERTIFICATE-TRAILERS.
  7808     12  CS-RECORD-ID                      PIC XX.
  7809         88  VALID-CS-ID                      VALUE 'CS'.
  7810
  7811     12  CS-CONTROL-PRIMARY.
  7812         16  CS-COMPANY-CD                 PIC X.
  7813         16  CS-CARRIER                    PIC X.
  7814         16  CS-GROUPING                   PIC X(6).
  7815         16  CS-STATE                      PIC XX.
  7816         16  CS-ACCOUNT                    PIC X(10).
  7817         16  CS-CERT-EFF-DT                PIC XX.
  7818         16  CS-CERT-NO.
  7819             20  CS-CERT-PRIME             PIC X(10).
  7820             20  CS-CERT-SFX               PIC X.
  7821         16  CS-TRAILER-TYPE               PIC X.
  7822             88  COMM-TRLR           VALUE 'A'.
  7823             88  FUTURE-TRLR         VALUE 'B'.
  7824             88  CERT-DATA-TRLR      VALUE 'C'.
  7825
  7826     12  CS-DATA-AREA                      PIC X(516).
  7827
  7828     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7829         16  CS-BANK-COMMISSION-AREA.
  7830             20  CS-BANK-COMMS       OCCURS 10.
  7831                 24  CS-AGT                PIC X(10).
  7832                 24  CS-COM-TYP            PIC X.
  7833                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7834                 24  CS-RECALC-LV-INDIC    PIC X.
  7835                 24  FILLER                PIC X(10).
  7836         16  FILLER                        PIC X(256).
  7837
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 147
* EL6311.cbl
  7838     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7839         16  CS-VIN-NUMBER                 PIC X(17).
  7840         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7841         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7842         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7843         16  FILLER                        PIC X(496).
  7844******************************************************************
  7845
  7846 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7847                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7848                          PENDING-MAILING-DATA MAILING-DATA
  7849                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7850                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7851                          CLAIM-MASTER ENDORSEMENT-RECORD
  7852                          CERTIFICATE-TRAILERS.
  7853 0000-DFHEXIT SECTION.
  7854     MOVE '9#                    $   ' TO DFHEIV0.
  7855     MOVE 'EL6311' TO DFHEIV1.
  7856     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7857
  7858     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7859     MOVE EIBTRMID               TO QID-TERM.
  7860     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7861     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7862     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7863     MOVE 2                      TO EMI-SWITCH2.
  7864
  7865     IF EIBCALEN = 0
  7866         GO TO 8800-UNAUTHORIZED-ACCESS.
  7867
  7868     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  7869     MOVE '5'                   TO DC-OPTION-CODE.
  7870     PERFORM 9700-DATE-LINK.
  7871     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7872     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7873
  7874     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7875     MOVE SPACE                  TO DC-OPTION-CODE.
  7876     PERFORM 9700-DATE-LINK.
  7877     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7878     MOVE LOW-VALUES             TO EL631BI.
  7879
  7880
  7881* EXEC CICS HANDLE CONDITION
  7882*        PGMIDERR  (9600-PGMID-ERROR)
  7883*        ERROR     (9990-ABEND)
  7884*        INVREQ    (9990-ABEND)
  7885*        QIDERR    (0010-MAIN-LOGIC)
  7886*    END-EXEC.
  7887*    MOVE '"$L.8N                ! " #00007876' TO DFHEIV0
  7888     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7889     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7890     MOVE X'2220233030303037383736' TO DFHEIV0(25:11)
  7891     CALL 'kxdfhei1' USING DFHEIV0
  7892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7893
  7894
  7895     IF PI-CALLING-PROGRAM NOT = THIS-PGM
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 148
* EL6311.cbl
  7896         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7897             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7898             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7899             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7900             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7901             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7902             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7903             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7904             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7905
  7906             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7907                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7908
  7909             ELSE
  7910                 NEXT SENTENCE
  7911
  7912         ELSE
  7913             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7914             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7915             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7916             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7917             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7918             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7919             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7920             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7921             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7922             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7923             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7924             GO TO 3900-RE-DISPLAY-RECORD
  7925     ELSE
  7926         GO TO 0020-MAIN-LOGIC.
  7927
  7928 0010-MAIN-LOGIC.
  7929     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7930                                    WS-FIRST-ENTRY-SW.
  7931
  7932     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7933
  7934     MOVE LOW-VALUES             TO EC-NEW-CERT
  7935                                    EC-NEW-STATE.
  7936
  7937     IF PI-DISPLAY-ORIGINAL-BATCH
  7938         NEXT SENTENCE
  7939     ELSE
  7940         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7941             GO TO 5000-BROWSE-BATCH-HEADERS.
  7942
  7943     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7944         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7945
  7946     IF PI-CSR-BROWSE
  7947        GO TO 4200-BROWSE-CSR-FORWARD.
  7948
  7949     IF PI-FILE-BROWSE
  7950         GO TO 4300-BROWSE-FILE-FORWARD.
  7951
  7952     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7953
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 149
* EL6311.cbl
  7954 0020-MAIN-LOGIC.
  7955     IF EIBAID = DFHCLEAR
  7956         GO TO 9400-CLEAR.
  7957
  7958     MOVE LOW-VALUES             TO EC-NEW-CERT
  7959                                    EC-NEW-STATE.
  7960
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 150
* EL6311.cbl
  7962
  7963******************************************************************
  7964*                                                                *
  7965*              R E C E I V E   M A P                             *
  7966*                                                                *
  7967******************************************************************
  7968
  7969 0200-RECEIVE.
  7970     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7971         MOVE ER-0008            TO EMI-ERROR
  7972         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7973         IF PI-MAP-NAME = EL631B
  7974             MOVE -1                 TO BMAINTL
  7975             GO TO 8200-SEND-DATAONLY
  7976         ELSE
  7977             IF PI-MAP-NAME = EL631C
  7978                 MOVE -1                 TO CMAINTL
  7979                 GO TO 8200-SEND-DATAONLY
  7980             ELSE
  7981                 IF PI-MAP-NAME = EL631D
  7982                     MOVE -1                 TO DPFENTRL
  7983                     GO TO 8200-SEND-DATAONLY.
  7984
  7985
  7986* EXEC CICS RECEIVE
  7987*        MAP      (PI-MAP-NAME)
  7988*        MAPSET   (MAPSET-EL6311S)
  7989*        INTO     (EL631BI)
  7990*    END-EXEC.
  7991     MOVE LENGTH OF
  7992      EL631BI
  7993       TO DFHEIV11
  7994*    MOVE '8"T I  L              ''   #00007973' TO DFHEIV0
  7995     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7997     MOVE X'2020233030303037393733' TO DFHEIV0(25:11)
  7998     CALL 'kxdfhei1' USING DFHEIV0,
  7999           PI-MAP-NAME,
  8000           EL631BI,
  8001           DFHEIV11,
  8002           MAPSET-EL6311S,
  8003           DFHEIV99,
  8004           DFHEIV99
  8005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8006
  8007
  8008******************************************************************
  8009*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8010******************************************************************
  8011
  8012     IF BTYPE-LEN (1) EQUAL +3
  8013        IF BTYPE (1) EQUAL ALL ' '
  8014            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8015
  8016     IF BTYPE-LEN (2) EQUAL +3
  8017        IF BTYPE (2) EQUAL ALL ' '
  8018            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8019
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 151
* EL6311.cbl
  8020     INSPECT EL631BI CONVERTING '_' TO ' '.
  8021
  8022     IF PI-MAP-NAME = EL631B
  8023         IF BPFENTRL GREATER THAN ZEROS
  8024             IF EIBAID NOT = DFHENTER
  8025                 MOVE ER-0004       TO EMI-ERROR
  8026                 MOVE -1            TO BPFENTRL
  8027                 MOVE AL-UNBOF      TO BPFENTRA
  8028                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029                 GO TO 8200-SEND-DATAONLY
  8030             ELSE
  8031                 IF BPFENTRI NUMERIC AND
  8032                   (BPFENTRI GREATER 0 AND LESS 25)
  8033                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8034                 ELSE
  8035                     MOVE ER-0029  TO EMI-ERROR
  8036                     MOVE AL-UNBON TO BPFENTRA
  8037                     MOVE -1       TO BPFENTRL
  8038                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8039                     GO TO 8200-SEND-DATAONLY
  8040         ELSE
  8041             NEXT SENTENCE
  8042     ELSE
  8043         IF PI-MAP-NAME = EL631C
  8044            IF CPFENTRL GREATER THAN ZEROS
  8045                IF EIBAID NOT = DFHENTER
  8046                 MOVE ER-0004         TO EMI-ERROR
  8047                 MOVE -1              TO CPFENTRL
  8048                 MOVE AL-UNBOF        TO CPFENTRA
  8049                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8050                 GO TO 8200-SEND-DATAONLY
  8051             ELSE
  8052                 IF CPFENTRI NUMERIC AND
  8053                   (CPFENTRI GREATER 0 AND LESS 25)
  8054                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8055                 ELSE
  8056                     MOVE ER-0029      TO EMI-ERROR
  8057                     MOVE AL-UNBON     TO CPFENTRA
  8058                     MOVE -1           TO CPFENTRL
  8059                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8060                     GO TO 8200-SEND-DATAONLY
  8061         ELSE
  8062             NEXT SENTENCE
  8063     ELSE
  8064     IF PI-MAP-NAME = EL631D
  8065         IF DPFENTRL GREATER THAN ZEROS
  8066             IF EIBAID NOT = DFHENTER
  8067                 MOVE ER-0004         TO EMI-ERROR
  8068                 MOVE -1              TO DPFENTRL
  8069                 MOVE AL-UNBOF        TO DPFENTRA
  8070                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8071                 GO TO 8200-SEND-DATAONLY
  8072             ELSE
  8073                 IF DPFENTRI NUMERIC AND
  8074                   (DPFENTRI GREATER 0 AND LESS 25)
  8075                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8076                 ELSE
  8077                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 152
* EL6311.cbl
  8078                     MOVE AL-UNBON     TO DPFENTRA
  8079                     MOVE -1           TO DPFENTRL
  8080                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8081                     GO TO 8200-SEND-DATAONLY.
  8082
  8083     IF EIBAID = DFHPF23
  8084         GO TO 8810-PF23.
  8085
  8086     IF EIBAID = DFHPF24
  8087         GO TO 9200-RETURN-MAIN-MENU.
  8088
  8089     IF EIBAID = DFHPF12
  8090         GO TO 9500-PF12.
  8091
  8092     IF PI-MAP-NAME = EL631B
  8093        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8094
  8095     IF PI-MAP-NAME = EL631C
  8096        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8097
  8098     IF PI-MAP-NAME = EL631D
  8099        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8100
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 153
* EL6311.cbl
  8102
  8103******************************************************************
  8104*                                                                *
  8105*      ISSUE SCREEN PF KEY CHECKING                              *
  8106*                                                                *
  8107******************************************************************
  8108
  8109******************************************************************
  8110*                                                                *
  8111*      PF KEY FUNCTIONS:                                         *
  8112*                                                                *
  8113*      PF1  = BROWSE FORWARD                                     *
  8114*      PF2  = BROWSE BACKWARD                                    *
  8115*      PF3  = CERTIFICATE LOOKUP                                 *
  8116*      PF4  = DISPLAY BATCH HEADER                               *
  8117*      PF5  = ADD ISSUE  SCREEN                                  *
  8118*      PF6  = ADD CANCEL SCREEN                                  *
  8119*      PF7  = CERTIFICATE DISPLAY                                *
  8120*      PF8  = CERTIFICATE NOTES                                  *
  8121*      PF9  = EDIT CONTROL                                       *
  8122*      PF10 = DISPLAY LETTER SCREEN                              *
  8123*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8124*      PF12 = HELP SCREEN                                        *
  8125*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8126*      PF14 = ACCOUNT MASTER                                     *
  8127*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8128*      PF16 = DISPLAY LETTER REVIEW                              *
  8129*                                                                *
  8130******************************************************************
  8131
  8132 0300-CHECK-ISSUE-PF-KEYS.
  8133     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8134        MOVE ER-2337            TO EMI-ERROR
  8135        MOVE -1                  TO BMAINTL
  8136        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8137        GO TO 8200-SEND-DATAONLY.
  8138
  8139     IF EIBAID = DFHPF1
  8140        MOVE '0'                TO PI-EDIT-SW
  8141        IF PI-PRIMARY-BROWSE
  8142           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8143        ELSE
  8144           IF PI-PRIMARY-WITH-SELECT
  8145              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8146           ELSE
  8147              IF PI-FILE-BROWSE
  8148                 GO TO 4300-BROWSE-FILE-FORWARD
  8149              ELSE
  8150                 IF PI-CSR-BROWSE
  8151                    GO TO 4200-BROWSE-CSR-FORWARD
  8152                 ELSE
  8153                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8154
  8155     IF EIBAID = DFHPF2
  8156        MOVE '0'                TO PI-EDIT-SW
  8157        IF PI-PRIMARY-BROWSE
  8158           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8159        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 154
* EL6311.cbl
  8160           IF PI-PRIMARY-WITH-SELECT
  8161              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8162           ELSE
  8163              IF PI-FILE-BROWSE
  8164                 GO TO 4800-BROWSE-FILE-BACKWARD
  8165              ELSE
  8166                 IF PI-CSR-BROWSE
  8167                    GO TO 4900-BROWSE-CSR-BACKWARD
  8168                 ELSE
  8169                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8170
  8171     IF EIBAID = DFHPF3
  8172        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8173        MOVE XCTL-EL127         TO PGM-NAME
  8174        GO TO 9300-XCTL.
  8175
  8176     IF (EIBAID = DFHPF15 OR DFHPF6)
  8177        AND (CSR-EDIT-SESSION)
  8178*       AND (FATAL-OR-UNFORCED)
  8179        AND (FATAL-ERRORS)
  8180        MOVE ER-1819             TO EMI-ERROR
  8181        MOVE -1                  TO BMAINTL
  8182        MOVE AL-UANON            TO BMAINTA
  8183        PERFORM 9900-ERROR-FORMAT
  8184                                 THRU 9900-EXIT
  8185        GO TO 8200-SEND-DATAONLY
  8186     END-IF
  8187     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8188      OR (EIBAID = DFHPF10)
  8189        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8190        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8191        IF (RESP-NORMAL)
  8192           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8193              AM-CONTROL-PRIMARY (1:20))
  8194            IF AM-NAME NOT GREATER THAN SPACES OR
  8195               AM-ADDRS NOT GREATER THAN SPACES  OR
  8196               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8197               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8198               AM-ZIP NOT GREATER THAN SPACES
  8199               MOVE ER-3834             TO EMI-ERROR
  8200               MOVE -1                  TO BMAINTL
  8201               MOVE AL-UANON            TO BMAINTA
  8202               PERFORM 9900-ERROR-FORMAT
  8203                                 THRU 9900-EXIT
  8204               GO TO 8200-SEND-DATAONLY
  8205            END-IF
  8206        ELSE
  8207           MOVE ER-1609             TO EMI-ERROR
  8208           MOVE -1                  TO BMAINTL
  8209           MOVE AL-UANON            TO BMAINTA
  8210           PERFORM 9900-ERROR-FORMAT
  8211                                THRU 9900-EXIT
  8212           GO TO 8200-SEND-DATAONLY
  8213        END-IF
  8214
  8215        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8216        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8217        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 155
* EL6311.cbl
  8218            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8219               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8220               MA-CITY NOT GREATER THAN SPACES OR
  8221               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8222               MA-ZIP-CODE NOT GREATER THAN SPACES
  8223               MOVE ER-3835             TO EMI-ERROR
  8224               MOVE -1                  TO BMAINTL
  8225               MOVE AL-UANON            TO BMAINTA
  8226               PERFORM 9900-ERROR-FORMAT
  8227                                 THRU 9900-EXIT
  8228               GO TO 8200-SEND-DATAONLY
  8229            END-IF
  8230        ELSE
  8231           MOVE ER-3000             TO EMI-ERROR
  8232           MOVE -1                  TO BMAINTL
  8233           MOVE AL-UANON            TO BMAINTA
  8234           PERFORM 9900-ERROR-FORMAT
  8235                                THRU 9900-EXIT
  8236           GO TO 8200-SEND-DATAONLY
  8237        END-IF
  8238
  8239     END-IF
  8240     IF (EIBAID = DFHPF15)
  8241        AND (CSR-EDIT-SESSION)
  8242        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8243        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8244        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8245        MOVE PI-SV-STATE         TO PI-STATE
  8246        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8247        MOVE BCERTNOI            TO PI-CERT-PRIME
  8248        MOVE BSUFIXI             TO PI-CERT-SFX
  8249        MOVE BEFFDTI             TO DEEDIT-FIELD
  8250        PERFORM 8600-DEEDIT
  8251        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8252        MOVE '4'                 TO DC-OPTION-CODE
  8253        PERFORM 9700-DATE-LINK
  8254        IF DATE-CONVERSION-ERROR
  8255           MOVE ER-0348          TO EMI-ERROR
  8256           MOVE -1               TO BEFFDTL
  8257           MOVE AL-UABON         TO BEFFDTA
  8258           PERFORM 9900-ERROR-FORMAT
  8259                                 THRU 9900-EXIT
  8260           GO TO 8200-SEND-DATAONLY
  8261        ELSE
  8262           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8263           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8264           MOVE XCTL-EL6315      TO PGM-NAME
  8265           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8266           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8267           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8268           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8269           GO TO 9300-XCTL
  8270        END-IF
  8271     END-IF
  8272
  8273     IF EIBAID = DFHPF4
  8274        MOVE '0'                TO PI-EDIT-SW
  8275        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 156
* EL6311.cbl
  8276           NEXT SENTENCE
  8277        ELSE
  8278           GO TO 7200-DISPLAY-BATCHES.
  8279
  8280     IF EIBAID = DFHPF5
  8281        MOVE ER-0029                TO EMI-ERROR
  8282        MOVE -1                     TO BPFENTRL
  8283        MOVE AL-UNBON               TO BPFENTRA
  8284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8285        GO TO 8200-SEND-DATAONLY.
  8286*        MOVE '0'                TO PI-EDIT-SW
  8287*        IF PI-DISPLAY-ORIGINAL-BATCH
  8288*           NEXT SENTENCE
  8289*        ELSE
  8290*           MOVE EL631B              TO PI-MAP-NAME
  8291*           MOVE LOW-VALUES          TO EL631BI
  8292*           MOVE 'A'                 TO BMAINTO
  8293*           MOVE AL-UANON            TO BMAINTA
  8294*           MOVE -1                  TO BMAINTL
  8295*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8296*           GO TO 8100-SEND-INITIAL-MAP.
  8297
  8298     IF EIBAID = DFHPF6
  8299        IF NOT CSR-EDIT-SESSION
  8300           MOVE ER-0029                TO EMI-ERROR
  8301           MOVE -1                     TO BPFENTRL
  8302           MOVE AL-UNBON               TO BPFENTRA
  8303           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8304           GO TO 8200-SEND-DATAONLY
  8305*           MOVE '0'              TO PI-EDIT-SW
  8306*           IF PI-DISPLAY-ORIGINAL-BATCH
  8307*              NEXT SENTENCE
  8308*           ELSE
  8309*              MOVE EL631C        TO PI-MAP-NAME
  8310*              MOVE LOW-VALUES    TO EL631CI
  8311*              MOVE 'A'           TO CMAINTO
  8312*              MOVE AL-UANON      TO CMAINTA
  8313*              MOVE -1            TO CMAINTL
  8314*              MOVE '6'           TO PI-MAINT-FUNCTION
  8315*              GO TO 8100-SEND-INITIAL-MAP
  8316*           END-IF
  8317        ELSE
  8318           PERFORM 5100-PROCESS-POL-RESC
  8319                                 THRU 5100-EXIT
  8320           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8321           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8322                                    PI-PREV-SEQ-NO
  8323           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8324*                                    WS-CANCEL-LETTER-SW
  8325                                    PI-ALL-ISSUES-SW
  8326                                    PI-ALL-CANCELS-SW
  8327           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8328        END-IF
  8329     END-IF
  8330     IF EIBAID = DFHPF7
  8331        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8332        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8333        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 157
* EL6311.cbl
  8334        MOVE PI-SV-STATE            TO PI-STATE
  8335        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8336        MOVE BCERTNOI               TO PI-CERT-PRIME
  8337        MOVE BSUFIXI                TO PI-CERT-SFX
  8338        MOVE BEFFDTI                TO DEEDIT-FIELD
  8339        PERFORM 8600-DEEDIT
  8340        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8341        MOVE '4'                    TO DC-OPTION-CODE
  8342        PERFORM 9700-DATE-LINK
  8343        IF DATE-CONVERSION-ERROR
  8344           MOVE ER-0348            TO EMI-ERROR
  8345           MOVE -1                  TO BEFFDTL
  8346           MOVE AL-UABON            TO BEFFDTA
  8347           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8348           GO TO 8200-SEND-DATAONLY
  8349        ELSE
  8350           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8351           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8352           MOVE XCTL-EL1273        TO PGM-NAME
  8353           GO TO 9300-XCTL.
  8354
  8355     IF EIBAID = DFHPF8
  8356        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8357        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8358        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8359        MOVE PI-SV-STATE            TO PI-STATE
  8360        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8361        MOVE BCERTNOI               TO PI-CERT-PRIME
  8362        MOVE BSUFIXI                TO PI-CERT-SFX
  8363        MOVE BEFFDTI                TO DEEDIT-FIELD
  8364        PERFORM 8600-DEEDIT
  8365        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8366        MOVE '4'                    TO DC-OPTION-CODE
  8367        PERFORM 9700-DATE-LINK
  8368        IF DATE-CONVERSION-ERROR
  8369           MOVE ER-0348            TO EMI-ERROR
  8370           MOVE -1                  TO BEFFDTL
  8371           MOVE AL-UABON            TO BEFFDTA
  8372           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8373           GO TO 8200-SEND-DATAONLY
  8374        ELSE
  8375           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8376           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8377           IF PI-COMPANY-ID = 'DMD'
  8378               MOVE XCTL-EL401DMD      TO PGM-NAME
  8379             ELSE
  8380               MOVE XCTL-EL1279        TO PGM-NAME
  8381           END-IF
  8382           GO TO 9300-XCTL.
  8383
  8384     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8385        MOVE XCTL-EL6312         TO PGM-NAME
  8386
  8387* EXEC CICS XCTL
  8388*           PROGRAM   (PGM-NAME)
  8389*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8390*           LENGTH    (WS-COMM-LENGTH)
  8391*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 158
* EL6311.cbl
  8392*    MOVE '.$C                   %   #00008357' TO DFHEIV0
  8393     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8394     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8395     MOVE X'2020233030303038333537' TO DFHEIV0(25:11)
  8396     CALL 'kxdfhei1' USING DFHEIV0,
  8397           PGM-NAME,
  8398           PROGRAM-INTERFACE-BLOCK,
  8399           WS-COMM-LENGTH,
  8400           DFHEIV99
  8401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8402     ELSE
  8403        MOVE '0'                 TO  PI-EDIT-SW.
  8404
  8405     IF  EIBAID = DFHPF10
  8406         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8407         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8408         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8409                                    PI-1042-WA
  8410         MOVE 4                  TO PI-689-DATA-SOURCE
  8411         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8412         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8413         MOVE PI-SV-STATE        TO PI-689-STATE
  8414         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8415         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8416         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8417         MOVE PI-PB-ALT-CHG-SEQ-NO
  8418                                 TO PI-689-ALT-SEQ-NO
  8419         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8420         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8421         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8422         MOVE +0                 TO PI-689-CONTROL
  8423         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8424                                    PI-689-EXP-DATE
  8425                                    PI-689-RESP-PERSON
  8426                                    PI-689-TYPE
  8427                                    PI-689-FOLLOW-UP-EDIT
  8428                                    PI-689-RESEND1-EDIT
  8429                                    PI-689-SEQ-EDIT
  8430                                    PI-689-BCSEQ-EDIT
  8431                                    PI-689-LBL-OVERRIDE
  8432         MOVE W-LETTER-COMMUNICATION-AREAS
  8433                                 TO PI-PROGRAM-WORK-AREA
  8434         MOVE XCTL-EL689         TO PGM-NAME
  8435         GO TO 9300-XCTL.
  8436
  8437     IF  EIBAID = DFHPF16
  8438         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8439         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8440         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8441                                    PI-1042-WA
  8442         MOVE 4                  TO PI-689-DATA-SOURCE
  8443         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8444         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8445         MOVE PI-SV-STATE        TO PI-689-STATE
  8446         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8447         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8448         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8449         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 159
* EL6311.cbl
  8450                                 TO PI-689-ALT-SEQ-NO
  8451         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8452         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8453         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8454         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8455         MOVE W-LETTER-COMMUNICATION-AREAS
  8456                                 TO PI-PROGRAM-WORK-AREA
  8457         MOVE XCTL-EL690         TO PGM-NAME
  8458         GO TO 9300-XCTL.
  8459
  8460     IF EIBAID = DFHPF13
  8461         MOVE XCTL-EL6313        TO PGM-NAME
  8462         GO TO 9300-XCTL.
  8463
  8464     IF EIBAID = DFHPF17
  8465        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8466        IF (PB-I-LOAN-APR > ZEROS)
  8467           AND (PB-I-BENEFICIARY-NAME NOT
  8468              = SPACES AND LOW-VALUES)
  8469
  8470           MOVE LINK-ELVADS          TO PGM-NAME
  8471
  8472* EXEC CICS LINK
  8473*              PROGRAM    (PGM-NAME)
  8474*              COMMAREA   (WS-PASS-AREA)
  8475*              LENGTH     (WS-PASS-AREA-LENGTH)
  8476*          END-EXEC
  8477*    MOVE '."C                   (   #00008431' TO DFHEIV0
  8478     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8479     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8480     MOVE X'2020233030303038343331' TO DFHEIV0(25:11)
  8481     CALL 'kxdfhei1' USING DFHEIV0,
  8482           PGM-NAME,
  8483           WS-PASS-AREA,
  8484           WS-PASS-AREA-LENGTH,
  8485           DFHEIV99,
  8486           DFHEIV99,
  8487           DFHEIV99,
  8488           DFHEIV99
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8490
  8491           MOVE 0000             TO EMI-ERROR
  8492           MOVE -1               TO BMAINTL
  8493           PERFORM 9900-ERROR-FORMAT
  8494                                 THRU 9900-EXIT
  8495           GO TO 8200-SEND-DATAONLY
  8496        ELSE
  8497           MOVE ER-0877            TO EMI-ERROR
  8498           MOVE -1                  TO BEFFDTL
  8499           MOVE AL-UABON            TO BEFFDTA
  8500           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8501           GO TO 8200-SEND-DATAONLY
  8502        END-IF
  8503     END-IF
  8504     IF EIBAID = DFHPF14
  8505        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8506        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8507        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 160
* EL6311.cbl
  8508        MOVE PI-SV-STATE            TO PI-CR-STATE
  8509        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8510        MOVE SPACE                  TO PI-EDIT-SW
  8511        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8512        MOVE XCTL-EL650             TO PGM-NAME
  8513        GO TO 9300-XCTL.
  8514
  8515     IF EIBAID = DFHPF15
  8516        IF PI-COMPANY-ID  =  'HER'
  8517            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8518            MOVE XCTL-EL680         TO PGM-NAME
  8519            GO TO 9300-XCTL.
  8520
  8521     IF EIBAID = DFHENTER OR DFHPF11
  8522        GO TO 1000-ISSUE-MAINLINE.
  8523
  8524     MOVE ER-0029                TO EMI-ERROR
  8525     MOVE -1                     TO BPFENTRL
  8526     MOVE AL-UNBON               TO BPFENTRA
  8527     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8528     GO TO 8200-SEND-DATAONLY.
  8529
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 161
* EL6311.cbl
  8531
  8532******************************************************************
  8533*                                                                *
  8534*      CANCEL SCREEN PF KEY CHECKING                             *
  8535*                                                                *
  8536******************************************************************
  8537
  8538******************************************************************
  8539*                                                                *
  8540*      PF KEY FUNCTIONS:                                         *
  8541*                                                                *
  8542*      PF1  = BROWSE FORWARD                                     *
  8543*      PF2  = BROWSE BACKWARD                                    *
  8544*      PF3  = CERTIFICATE LOOKUP                                 *
  8545*      PF4  = DISPLAY BATCH HEADER                               *
  8546*      PF5  = ADD ISSUE SCREEN                                   *
  8547*      PF6  = ADD CANCEL SCREEN                                  *
  8548*      PF7  = CERTIFICATE DISPLAY                                *
  8549*      PF8  = CERTIFICATE NOTES                                  *
  8550*      PF9  = EDIT CONTROL                                       *
  8551*      PF10 = DISPLAY LETTER SCREEN                              *
  8552*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8553*      PF12 = DISPLAY HELP SCREEN                                *
  8554*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8555*      PF14 = ACCOUNT MASTER                                     *
  8556*      PF16 = LETTER REVIEW                                      *
  8557*                                                                *
  8558******************************************************************
  8559
  8560 0400-CHECK-CANCEL-PF-KEYS.
  8561     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8562        MOVE ER-2337             TO EMI-ERROR
  8563        MOVE -1                  TO CMAINTL
  8564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8565        GO TO 8200-SEND-DATAONLY.
  8566
  8567     IF EIBAID = DFHPF1
  8568        MOVE '0'                TO PI-EDIT-SW
  8569        IF PI-PRIMARY-BROWSE
  8570           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8571        ELSE
  8572           IF PI-PRIMARY-WITH-SELECT
  8573              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8574           ELSE
  8575              IF PI-FILE-BROWSE
  8576                 GO TO 4300-BROWSE-FILE-FORWARD
  8577              ELSE
  8578                 IF PI-CSR-BROWSE
  8579                    GO TO 4200-BROWSE-CSR-FORWARD
  8580                 ELSE
  8581                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8582
  8583     IF EIBAID = DFHPF2
  8584        MOVE '0'                TO PI-EDIT-SW
  8585        IF PI-PRIMARY-BROWSE
  8586           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8587        ELSE
  8588           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 162
* EL6311.cbl
  8589              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8590           ELSE
  8591              IF PI-FILE-BROWSE
  8592                 GO TO 4800-BROWSE-FILE-BACKWARD
  8593              ELSE
  8594                 IF PI-CSR-BROWSE
  8595                    GO TO 4900-BROWSE-CSR-BACKWARD
  8596                 ELSE
  8597                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8598
  8599     IF EIBAID = DFHPF3
  8600        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8601        MOVE XCTL-EL127         TO PGM-NAME
  8602        GO TO 9300-XCTL.
  8603
  8604     IF (EIBAID = DFHPF15 OR DFHPF17)
  8605        AND (CSR-EDIT-SESSION)
  8606*       AND (FATAL-OR-UNFORCED)
  8607        AND (FATAL-ERRORS)
  8608        MOVE ER-1819             TO EMI-ERROR
  8609        MOVE -1                  TO CMAINTL
  8610        MOVE AL-UANON            TO CMAINTA
  8611        PERFORM 9900-ERROR-FORMAT
  8612                                 THRU 9900-EXIT
  8613        GO TO 8200-SEND-DATAONLY
  8614     END-IF
  8615     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8616       AND (CSR-EDIT-SESSION)
  8617        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8618        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8619        IF (RESP-NORMAL)
  8620           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8621              AM-CONTROL-PRIMARY (1:20))
  8622            IF AM-NAME NOT GREATER THAN SPACES OR
  8623               AM-ADDRS NOT GREATER THAN SPACES  OR
  8624               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8625               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8626               AM-ZIP NOT GREATER THAN SPACES
  8627               MOVE ER-3834             TO EMI-ERROR
  8628               MOVE -1                  TO BMAINTL
  8629               MOVE AL-UANON            TO BMAINTA
  8630               PERFORM 9900-ERROR-FORMAT
  8631                                 THRU 9900-EXIT
  8632               GO TO 8200-SEND-DATAONLY
  8633            END-IF
  8634        ELSE
  8635           MOVE ER-1609             TO EMI-ERROR
  8636           MOVE -1                  TO BMAINTL
  8637           MOVE AL-UANON            TO BMAINTA
  8638           PERFORM 9900-ERROR-FORMAT
  8639                                THRU 9900-EXIT
  8640           GO TO 8200-SEND-DATAONLY
  8641        END-IF
  8642
  8643        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8644        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8645        IF (ERMAIL-FOUND)
  8646            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 163
* EL6311.cbl
  8647               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8648               MA-CITY NOT GREATER THAN SPACES OR
  8649               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8650               MA-ZIP-CODE NOT GREATER THAN SPACES
  8651               MOVE ER-3835             TO EMI-ERROR
  8652               MOVE -1                  TO BMAINTL
  8653               MOVE AL-UANON            TO BMAINTA
  8654               PERFORM 9900-ERROR-FORMAT
  8655                                 THRU 9900-EXIT
  8656               GO TO 8200-SEND-DATAONLY
  8657            END-IF
  8658        ELSE
  8659           MOVE ER-3000             TO EMI-ERROR
  8660           MOVE -1                  TO BMAINTL
  8661           MOVE AL-UANON            TO BMAINTA
  8662           PERFORM 9900-ERROR-FORMAT
  8663                                THRU 9900-EXIT
  8664           GO TO 8200-SEND-DATAONLY
  8665        END-IF
  8666
  8667     END-IF
  8668     IF (EIBAID = DFHPF15 OR DFHPF17)
  8669        AND (CSR-EDIT-SESSION)
  8670        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8671        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8672        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8673        MOVE PI-SV-STATE         TO PI-STATE
  8674        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8675        MOVE CCERTNOI            TO PI-CERT-PRIME
  8676        MOVE CSUFIXI             TO PI-CERT-SFX
  8677        MOVE CEFFDTI             TO DEEDIT-FIELD
  8678        PERFORM 8600-DEEDIT
  8679        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8680        MOVE '4'                 TO DC-OPTION-CODE
  8681        PERFORM 9700-DATE-LINK
  8682        IF DATE-CONVERSION-ERROR
  8683           MOVE ER-0348          TO EMI-ERROR
  8684           MOVE -1               TO CEFFDTL
  8685           MOVE AL-UABON         TO CEFFDTA
  8686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8687           GO TO 8200-SEND-DATAONLY
  8688        ELSE
  8689           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8690           PERFORM 6000-CREATE-TEMP-STORAGE
  8691                                 THRU 6000-EXIT
  8692           IF EIBAID = DFHPF17
  8693               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8694                                  THRU 6400-EXIT
  8695               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8696                                 '2' AND '3' AND '4'
  8697                  MOVE ER-3831     TO  EMI-ERROR
  8698                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8699                  GO TO 8200-SEND-DATAONLY
  8700               END-IF
  8701               MOVE 'Y'          TO PI-CLM-RESC-IND
  8702           ELSE
  8703               MOVE 'N'          TO PI-CLM-RESC-IND
  8704           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 164
* EL6311.cbl
  8705           MOVE XCTL-EL6316      TO PGM-NAME
  8706           MOVE '2'              TO PI-ISS-CAN-SW
  8707           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8708           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8709           GO TO 9300-XCTL
  8710        END-IF
  8711     END-IF
  8712
  8713     IF EIBAID = DFHPF4
  8714        MOVE '0'                TO PI-EDIT-SW
  8715        IF PI-DISPLAY-ORIGINAL-BATCH
  8716           NEXT SENTENCE
  8717        ELSE
  8718           GO TO 7200-DISPLAY-BATCHES.
  8719
  8720     IF EIBAID = DFHPF5
  8721        MOVE ER-0029                TO EMI-ERROR
  8722        MOVE -1                     TO BPFENTRL
  8723        MOVE AL-UNBON               TO BPFENTRA
  8724        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8725        GO TO 8200-SEND-DATAONLY.
  8726*        MOVE '0'                TO PI-EDIT-SW
  8727*        IF PI-DISPLAY-ORIGINAL-BATCH
  8728*           NEXT SENTENCE
  8729*        ELSE
  8730*           MOVE EL631B              TO PI-MAP-NAME
  8731*           MOVE LOW-VALUES          TO EL631BI
  8732*           MOVE 'A'                 TO BMAINTO
  8733*           MOVE AL-UANON            TO BMAINTA
  8734*           MOVE -1                  TO BMAINTL
  8735*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8736*           GO TO 8100-SEND-INITIAL-MAP.
  8737
  8738     IF EIBAID = DFHPF6
  8739        MOVE ER-0029                TO EMI-ERROR
  8740        MOVE -1                     TO BPFENTRL
  8741        MOVE AL-UNBON               TO BPFENTRA
  8742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8743        GO TO 8200-SEND-DATAONLY.
  8744*        MOVE '0'                TO PI-EDIT-SW
  8745*        IF PI-DISPLAY-ORIGINAL-BATCH
  8746*           NEXT SENTENCE
  8747*        ELSE
  8748*           MOVE EL631C              TO PI-MAP-NAME
  8749*           MOVE LOW-VALUES          TO EL631CI
  8750*           MOVE 'A'                 TO CMAINTO
  8751*           MOVE AL-UANON            TO CMAINTA
  8752*           MOVE -1                  TO CMAINTL
  8753*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8754*           GO TO 8100-SEND-INITIAL-MAP.
  8755
  8756     IF EIBAID = DFHPF7
  8757        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8758        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8759        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8760        MOVE PI-SV-STATE            TO PI-STATE
  8761        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8762        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 165
* EL6311.cbl
  8763        MOVE CSUFIXI                TO PI-CERT-SFX
  8764        MOVE CEFFDTI                TO DEEDIT-FIELD
  8765        PERFORM 8600-DEEDIT
  8766        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8767        MOVE '4'                    TO DC-OPTION-CODE
  8768        PERFORM 9700-DATE-LINK
  8769        IF DATE-CONVERSION-ERROR
  8770           MOVE ER-0348            TO EMI-ERROR
  8771           MOVE -1                  TO BEFFDTL
  8772           MOVE AL-UABON            TO BEFFDTA
  8773           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8774           GO TO 8200-SEND-DATAONLY
  8775        ELSE
  8776           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8777           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8778           MOVE XCTL-EL1273        TO PGM-NAME
  8779           GO TO 9300-XCTL.
  8780
  8781     IF EIBAID = DFHPF8
  8782        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8783        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8784        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8785        MOVE PI-SV-STATE            TO PI-STATE
  8786        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8787        MOVE CCERTNOI               TO PI-CERT-PRIME
  8788        MOVE CSUFIXI                TO PI-CERT-SFX
  8789        MOVE CEFFDTI                TO DEEDIT-FIELD
  8790        PERFORM 8600-DEEDIT
  8791        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8792        MOVE '4'                    TO DC-OPTION-CODE
  8793        PERFORM 9700-DATE-LINK
  8794        IF DATE-CONVERSION-ERROR
  8795           MOVE ER-0348             TO EMI-ERROR
  8796           MOVE -1                  TO BEFFDTL
  8797           MOVE AL-UABON            TO BEFFDTA
  8798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8799           GO TO 8200-SEND-DATAONLY
  8800        ELSE
  8801           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8802           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8803           IF PI-COMPANY-ID = 'DMD'
  8804               MOVE XCTL-EL401DMD      TO PGM-NAME
  8805             ELSE
  8806               MOVE XCTL-EL1279        TO PGM-NAME
  8807           END-IF
  8808           GO TO 9300-XCTL.
  8809
  8810     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8811        MOVE XCTL-EL6312     TO PGM-NAME
  8812
  8813* EXEC CICS XCTL
  8814*           PROGRAM  (PGM-NAME)
  8815*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8816*           LENGTH   (WS-COMM-LENGTH)
  8817*       END-EXEC
  8818*    MOVE '.$C                   %   #00008758' TO DFHEIV0
  8819     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8820     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 166
* EL6311.cbl
  8821     MOVE X'2020233030303038373538' TO DFHEIV0(25:11)
  8822     CALL 'kxdfhei1' USING DFHEIV0,
  8823           PGM-NAME,
  8824           PROGRAM-INTERFACE-BLOCK,
  8825           WS-COMM-LENGTH,
  8826           DFHEIV99
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8828     ELSE
  8829        MOVE '0'                 TO  PI-EDIT-SW.
  8830
  8831     IF EIBAID = DFHPF10
  8832         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8833         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8834         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8835         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8836                                    PI-1042-WA
  8837         MOVE 4                  TO PI-689-DATA-SOURCE
  8838         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8839         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8840         MOVE PI-SV-STATE        TO PI-689-STATE
  8841         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8842         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8843         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8844         MOVE PI-PB-ALT-CHG-SEQ-NO
  8845                                 TO PI-689-ALT-SEQ-NO
  8846         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8847         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8848         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8849         MOVE +0                 TO PI-689-CONTROL
  8850         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8851                                    PI-689-EXP-DATE
  8852                                    PI-689-RESP-PERSON
  8853                                    PI-689-TYPE
  8854                                    PI-689-FOLLOW-UP-EDIT
  8855                                    PI-689-RESEND1-EDIT
  8856                                    PI-689-SEQ-EDIT
  8857                                    PI-689-BCSEQ-EDIT
  8858                                    PI-689-LBL-OVERRIDE
  8859         MOVE W-LETTER-COMMUNICATION-AREAS
  8860                                 TO PI-PROGRAM-WORK-AREA
  8861         MOVE XCTL-EL689         TO PGM-NAME
  8862         GO TO 9300-XCTL.
  8863
  8864     IF  EIBAID = DFHPF16
  8865         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8866         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8867         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8868                                    PI-1042-WA
  8869         MOVE 4                  TO PI-689-DATA-SOURCE
  8870         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8871         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8872         MOVE PI-SV-STATE        TO PI-689-STATE
  8873         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8874         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8875         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8876         MOVE PI-PB-ALT-CHG-SEQ-NO
  8877                                 TO PI-689-ALT-SEQ-NO
  8878         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 167
* EL6311.cbl
  8879         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8880         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8881         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8882         MOVE W-LETTER-COMMUNICATION-AREAS
  8883                                 TO PI-PROGRAM-WORK-AREA
  8884         MOVE XCTL-EL690         TO PGM-NAME
  8885         GO TO 9300-XCTL.
  8886
  8887     IF EIBAID = DFHPF13
  8888        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8889        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8890        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8891        MOVE PI-SV-STATE            TO PI-STATE
  8892        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8893        MOVE CCERTNOI               TO PI-CERT-PRIME
  8894        MOVE CSUFIXI                TO PI-CERT-SFX
  8895        MOVE CEFFDTI                TO DEEDIT-FIELD
  8896        PERFORM 8600-DEEDIT
  8897        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8898        MOVE '4'                    TO DC-OPTION-CODE
  8899        PERFORM 9700-DATE-LINK
  8900        IF DATE-CONVERSION-ERROR
  8901           MOVE ER-0348            TO EMI-ERROR
  8902           MOVE -1                  TO CEFFDTL
  8903           MOVE AL-UABON            TO CEFFDTA
  8904           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8905           GO TO 8200-SEND-DATAONLY
  8906        ELSE
  8907           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8908           MOVE AL-UANON            TO CEFFDTA
  8909           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8910           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8911           MOVE XCTL-EL677         TO PGM-NAME
  8912           GO TO 9300-XCTL.
  8913
  8914     IF EIBAID = DFHPF14
  8915        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8916        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8917        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8918        MOVE PI-SV-STATE            TO PI-CR-STATE
  8919        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8920        MOVE SPACE                  TO PI-EDIT-SW
  8921        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8922        MOVE XCTL-EL650             TO PGM-NAME
  8923        GO TO 9300-XCTL.
  8924
  8925     IF EIBAID = DFHENTER OR DFHPF11
  8926        GO TO 2000-CANCEL-MAINLINE.
  8927
  8928     MOVE ER-0029                TO EMI-ERROR.
  8929     MOVE -1                     TO CPFENTRL.
  8930     MOVE AL-UNBON               TO CPFENTRA.
  8931     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8932     GO TO 8200-SEND-DATAONLY.
  8933
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 168
* EL6311.cbl
  8935
  8936******************************************************************
  8937*                                                                *
  8938*      BATCH SCREEN PF KEY CHECKING                              *
  8939*                                                                *
  8940******************************************************************
  8941
  8942******************************************************************
  8943*                                                                *
  8944*      PF KEY FUNCTIONS:                                         *
  8945*                                                                *
  8946*      PF1 = BROWSE FORWARD                                      *
  8947*      PF2 = BROWSE BACKWARD                                     *
  8948*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8949*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8950*                                                                *
  8951*                                                                *
  8952******************************************************************
  8953
  8954 0500-CHECK-BATCH-PF-KEYS.
  8955     IF EIBAID = DFHPF1
  8956        MOVE '0'                TO PI-EDIT-SW
  8957        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8958           GO TO 5000-BROWSE-BATCH-HEADERS
  8959        ELSE
  8960           IF PI-GOOD-BROWSE
  8961              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8962                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  8963              ELSE
  8964                 IF PI-FILE-BROWSE
  8965                    GO TO 4300-BROWSE-FILE-FORWARD
  8966                 ELSE
  8967                    IF PI-CSR-BROWSE
  8968                       GO TO 4200-BROWSE-CSR-FORWARD
  8969                    ELSE
  8970                       GO TO 4000-BROWSE-DETAIL-FORWARD
  8971           ELSE
  8972              GO TO 0800-BROWSE-ERROR.
  8973
  8974     IF EIBAID = DFHPF2
  8975        MOVE '0'                TO PI-EDIT-SW
  8976        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8977           GO TO 5500-BROWSE-BATCH-BACKWARD
  8978        ELSE
  8979           IF PI-GOOD-BROWSE
  8980              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8981                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8982              ELSE
  8983                 IF PI-FILE-BROWSE
  8984                    GO TO 4800-BROWSE-FILE-BACKWARD
  8985                 ELSE
  8986                    IF PI-CSR-BROWSE
  8987                       GO TO 4900-BROWSE-CSR-BACKWARD
  8988                    ELSE
  8989                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  8990           ELSE
  8991              GO TO 0800-BROWSE-ERROR.
  8992
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 169
* EL6311.cbl
  8993     IF EIBAID = DFHPF3
  8994        GO TO 3000-BATCH-MAINLINE.
  8995
  8996     IF  EIBAID = DFHPF4
  8997        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8998        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8999        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9000        MOVE PI-SV-STATE            TO PI-CR-STATE
  9001        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9002                                       PI-CR-FIN-RESP
  9003        MOVE 'A'                    TO PI-CR-TYPE
  9004        MOVE SPACE                  TO PI-EDIT-SW
  9005        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9006        MOVE XCTL-EL640             TO PGM-NAME
  9007        GO TO 9300-XCTL.
  9008
  9009     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9010       AND
  9011        (EIBAID = DFHENTER)
  9012           GO TO 3500-EDIT-BATCH-DATA.
  9013
  9014     IF EIBAID = DFHENTER
  9015        GO TO 3500-EDIT-BATCH-DATA.
  9016
  9017     MOVE ER-0029             TO EMI-ERROR.
  9018     MOVE -1                  TO DPFENTRL.
  9019     MOVE AL-UNBON            TO DPFENTRA.
  9020     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9021     GO TO 8200-SEND-DATAONLY.
  9022
  9023 0800-BROWSE-ERROR.
  9024     MOVE ER-2258                TO EMI-ERROR.
  9025     MOVE -1                     TO DPFENTRL.
  9026     MOVE AL-UNBON               TO DPFENTRA.
  9027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9028     GO TO 8200-SEND-DATAONLY.
  9029
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 170
* EL6311.cbl
  9031
  9032******************************************************************
  9033*                                                                *
  9034*                I S S U E   M A I N L I N E                     *
  9035*                                                                *
  9036******************************************************************
  9037
  9038 1000-ISSUE-MAINLINE.
  9039     IF PI-DISPLAY-ORIGINAL-BATCH
  9040        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9041           MOVE ER-0023             TO EMI-ERROR
  9042           MOVE -1                  TO BMAINTL
  9043           MOVE AL-UABON            TO BMAINTA
  9044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045           GO TO 8200-SEND-DATAONLY
  9046        ELSE
  9047           NEXT SENTENCE
  9048     ELSE
  9049        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9050           MOVE ER-0023             TO EMI-ERROR
  9051           MOVE -1                  TO BMAINTL
  9052           MOVE AL-UABON            TO BMAINTA
  9053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054           GO TO 8200-SEND-DATAONLY.
  9055
  9056     IF BMAINTI = 'S'
  9057        GO TO 1100-SHOW-REQUEST.
  9058
  9059     IF NOT MODIFY-CAP
  9060         MOVE 'UPDATE'       TO SM-READ
  9061         PERFORM 9995-SECURITY-VIOLATION
  9062         MOVE ER-0070        TO EMI-ERROR
  9063         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9064         GO TO 8100-SEND-INITIAL-MAP.
  9065
  9066     IF BMAINTL GREATER THAN ZEROS
  9067        IF PI-PF5-FUNCTION
  9068           IF BMAINTI NOT = 'A'
  9069              MOVE AL-UABON  TO BMAINTA
  9070              MOVE -1        TO BMAINTL
  9071              MOVE ER-2260   TO EMI-ERROR
  9072              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9073              GO TO 8200-SEND-DATAONLY.
  9074
  9075     IF BCERTNOL = ZEROS
  9076       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9077         NEXT SENTENCE
  9078     ELSE
  9079         IF BCERTNOL NOT = ZEROS
  9080             MOVE AL-UANON       TO BCERTNOA
  9081         ELSE
  9082             MOVE -1             TO BCERTNOL
  9083             MOVE  1             TO SET-CURSOR-SW
  9084             MOVE ER-2218        TO EMI-ERROR
  9085             MOVE AL-UABON       TO BCERTNOA
  9086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9087
  9088     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 171
* EL6311.cbl
  9089         MOVE AL-UANON       TO BSUFIXA
  9090     ELSE
  9091         MOVE AL-SANOF       TO BSUFIXA.
  9092
  9093     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9094        NEXT SENTENCE
  9095     ELSE
  9096        IF BEFFDTL NOT = ZEROS
  9097           MOVE AL-UNNON             TO BEFFDTA
  9098           MOVE BEFFDTI              TO DEEDIT-FIELD
  9099           PERFORM 8600-DEEDIT
  9100           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9101           MOVE 4                    TO DC-OPTION-CODE
  9102           PERFORM 9700-DATE-LINK
  9103           IF NO-CONVERSION-ERROR
  9104              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9105              ELSE
  9106              MOVE -1                TO BEFFDTL
  9107              MOVE  1                TO SET-CURSOR-SW
  9108              MOVE ER-2226           TO EMI-ERROR
  9109              MOVE AL-UNBON          TO BEFFDTA
  9110              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111           ELSE
  9112              MOVE -1                TO BEFFDTL
  9113              MOVE  1                TO SET-CURSOR-SW
  9114              MOVE ER-2220           TO EMI-ERROR
  9115              MOVE AL-UNBON          TO BEFFDTA
  9116              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9117
  9118     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9119
  9120     IF BCERTNOL NOT = ZEROS
  9121        MOVE BCERTNOI                TO WS-NEW-PRIME
  9122     ELSE
  9123        MOVE SPACES                  TO WS-NEW-PRIME.
  9124
  9125     IF BSUFIXL NOT = ZEROS
  9126        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9127     ELSE
  9128        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9129
  9130     IF BEFFDTL NOT = ZEROS
  9131        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9132     ELSE
  9133        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9134
  9135     IF BMAINTI = 'A' OR 'K' OR 'S'
  9136        NEXT SENTENCE
  9137     ELSE
  9138        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9139        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9140           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9141           WS-PB-RECORD-TYPE NOT = '1'
  9142           IF BMAINTI = 'C'
  9143               MOVE ER-2287          TO EMI-ERROR
  9144               MOVE -1               TO BCERTNOL
  9145               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9146               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 172
* EL6311.cbl
  9147               GO TO 8200-SEND-DATAONLY
  9148             ELSE
  9149               MOVE ER-2260          TO EMI-ERROR
  9150               MOVE -1               TO BCERTNOL
  9151               MOVE AL-UABON         TO BCERTNOA
  9152               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9153               GO TO 8200-SEND-DATAONLY.
  9154
  9155     IF BMAINTI = 'D'
  9156         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9157
  9158*    IF BMICRNOL  NOT =  ZEROS
  9159*        IF BMICRNOI  NUMERIC
  9160*            MOVE AL-UNNON       TO  BMICRNOA
  9161*        ELSE
  9162*            MOVE -1             TO  BMICRNOL
  9163*            MOVE 1              TO  SET-CURSOR-SW
  9164*            MOVE AL-UNBON       TO  BMICRNOA
  9165*            MOVE ER-2701        TO  EMI-ERROR
  9166*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9167     IF BVINL NOT = ZEROS
  9168        MOVE AL-UANON            TO BVINA
  9169     END-IF
  9170     IF B1STNML NOT = ZEROS
  9171         MOVE AL-UANON                TO B1STNMA.
  9172
  9173     IF BINITL  NOT = ZEROS
  9174        MOVE AL-UANON                TO BINITA.
  9175
  9176     IF BSEXL NOT = ZEROS
  9177        IF BSEXI = 'M' OR 'F'
  9178           MOVE AL-UANON             TO BSEXA
  9179        ELSE
  9180           MOVE -1               TO BSEXL
  9181           MOVE ER-2629          TO EMI-ERROR
  9182           MOVE AL-UABON         TO BSEXA
  9183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9184
  9185     IF BAGEL NOT = ZEROS
  9186         IF BAGEI NUMERIC
  9187             MOVE BAGEI              TO WS-BAGE
  9188             MOVE AL-UNNON           TO BAGEA
  9189         ELSE
  9190             MOVE -1                 TO BAGEL
  9191             MOVE  1                 TO SET-CURSOR-SW
  9192             MOVE ER-2223            TO EMI-ERROR
  9193             MOVE AL-UNBON           TO BAGEA
  9194             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9195
  9196     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9197
  9198     IF (BBIRTHL GREATER THAN +0) AND
  9199        (BBIRTHI NOT EQUAL SPACES)
  9200        NEXT SENTENCE
  9201     ELSE
  9202        GO TO 1010-CHECK-AGE.
  9203
  9204     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 173
* EL6311.cbl
  9205     PERFORM 8600-DEEDIT.
  9206     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9207     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9208     MOVE AL-UNNON               TO BBIRTHA.
  9209     MOVE '4'                    TO DC-OPTION-CODE.
  9210     PERFORM 9700-DATE-LINK.
  9211     IF DATE-CONVERSION-ERROR
  9212        MOVE -1                  TO BBIRTHL
  9213        MOVE  1                  TO SET-CURSOR-SW
  9214        MOVE ER-2228             TO EMI-ERROR
  9215        MOVE AL-UNBON            TO BBIRTHA
  9216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9217        GO TO 1010-CHECK-AGE.
  9218
  9219     IF (NO-CONVERSION-ERROR) AND
  9220        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9221        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9222        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9223        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9224                                    WS-CONVERTED-BIRTH
  9225        MOVE AL-UANON            TO BBIRTHA
  9226     ELSE
  9227        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9228        MOVE AL-UANON            TO BBIRTHA.
  9229
  9230 1010-CHECK-AGE.
  9231
  9232*    IF BAGEL = ZERO
  9233*       IF BBIRTHL GREATER THAN ZERO
  9234*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9235
  9236     IF B1STPMTL NOT = ZEROS
  9237        IF B1STPMTI = SPACES
  9238           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9239        ELSE
  9240           MOVE B1STPMTI             TO DEEDIT-FIELD
  9241           PERFORM 8600-DEEDIT
  9242           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9243           MOVE AL-UNNON             TO B1STPMTA
  9244           MOVE 4                    TO DC-OPTION-CODE
  9245           PERFORM 9700-DATE-LINK
  9246           IF NO-CONVERSION-ERROR
  9247              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9248              MOVE AL-UANON          TO B1STPMTA
  9249           ELSE
  9250              MOVE -1                TO B1STPMTL
  9251              MOVE  1                TO SET-CURSOR-SW
  9252              MOVE ER-2200           TO EMI-ERROR
  9253              MOVE AL-UNBON          TO B1STPMTA
  9254              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9255
  9256     IF BDAYSL NOT = ZEROS
  9257         IF BDAYSI NUMERIC
  9258             MOVE AL-UNNON           TO BDAYSA
  9259         ELSE
  9260             MOVE -1                 TO BDAYSL
  9261             MOVE ER-2530            TO EMI-ERROR
  9262             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 174
* EL6311.cbl
  9263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9264
  9265     IF BLNTRML NOT = ZEROS
  9266         IF BLNTRMI NUMERIC
  9267             MOVE AL-UNNON       TO BLNTRMA
  9268         ELSE
  9269             MOVE -1             TO BLNTRML
  9270             MOVE ER-2533        TO EMI-ERROR
  9271             MOVE AL-UNBON       TO BLNTRMA
  9272             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9273
  9274**   IF PI-COMPANY-ID = 'DMD'
  9275     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9276        NEXT SENTENCE
  9277     ELSE
  9278         IF BLNOFCRL NOT = ZEROS
  9279            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9280            IF LOAN-OFFICER-FOUND
  9281                MOVE AL-UANON        TO BLNOFCRA
  9282             ELSE
  9283                 MOVE SPACE          TO WS-LOAN-OFFICER
  9284                 MOVE -1             TO BLNOFCRL
  9285                 MOVE  1             TO SET-CURSOR-SW
  9286                 MOVE ER-3006        TO EMI-ERROR
  9287                 MOVE AL-UNBON       TO BLNOFCRA
  9288                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9289
  9290     IF BFREQL NOT = ZEROS
  9291         IF BFREQI NUMERIC
  9292             MOVE AL-UNNON       TO BFREQA
  9293         ELSE
  9294             MOVE -1             TO BFREQL
  9295             MOVE  1             TO SET-CURSOR-SW
  9296             MOVE ER-2223        TO EMI-ERROR
  9297             MOVE AL-UNBON       TO BFREQA
  9298             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9299
  9300     IF BMODEL NOT = ZEROS
  9301         MOVE BMODEI             TO WS-MODE-CODE
  9302                                    PI-BMODE
  9303         IF WS-MODE-CODE-VALID
  9304             MOVE AL-UANON       TO BMODEA
  9305         ELSE
  9306             MOVE -1             TO BMODEL
  9307             MOVE ER-2591        TO EMI-ERROR
  9308             MOVE AL-UABON       TO BMODEA
  9309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9310
  9311     IF BPMTSL NOT = ZEROS
  9312         IF BPMTSI NUMERIC
  9313             MOVE AL-UNNON           TO BPMTSA
  9314             MOVE BPMTSI             TO PI-BPMTS
  9315         ELSE
  9316             MOVE -1                 TO BPMTSL
  9317             MOVE ER-2592            TO EMI-ERROR
  9318             MOVE AL-UNBON           TO BPMTSA
  9319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9320
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 175
* EL6311.cbl
  9321     IF BPMTAMTL NOT = ZEROS
  9322
  9323* EXEC CICS BIF DEEDIT
  9324*            FIELD  (BPMTAMTI)
  9325*            LENGTH (9)
  9326*       END-EXEC
  9327     MOVE 9
  9328       TO DFHEIV11
  9329*    MOVE '@"L                   #   #00009257' TO DFHEIV0
  9330     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9331     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9332     MOVE X'2020233030303039323537' TO DFHEIV0(25:11)
  9333     CALL 'kxdfhei1' USING DFHEIV0,
  9334           BPMTAMTI,
  9335           DFHEIV11
  9336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9337        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9338*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9339*        PERFORM 8600-DEEDIT
  9340*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9341
  9342*    IF BAPRL NOT = ZEROS
  9343*        EXEC CICS BIF DEEDIT
  9344*            FIELD  (BAPRI)
  9345*            LENGTH (7)
  9346*        END-EXEC
  9347*        MOVE BAPRI              TO WS-BAPR.
  9348
  9349     IF BAPRL > 0
  9350        MOVE +0                  TO  WS-BAPR
  9351        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9352           (WS-SUB > 7)
  9353           OR (BAPRI (WS-SUB:1) NUMERIC)
  9354           OR (BAPRI (WS-SUB:1) = '.')
  9355        END-PERFORM
  9356        IF WS-SUB > 7
  9357           MOVE ER-2471       TO EMI-ERROR
  9358           MOVE -1            TO BAPRL
  9359           MOVE AL-UNBON      TO BAPRA
  9360           PERFORM 9900-ERROR-FORMAT
  9361                                 THRU 9900-EXIT
  9362        ELSE
  9363           IF BAPRI (WS-SUB:1) NUMERIC
  9364              MOVE WS-SUB           TO WS-BEG
  9365              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9366                 (WS-SUB > 7)
  9367                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9368              END-PERFORM
  9369              COMPUTE WS-END = WS-SUB - WS-BEG
  9370              MOVE BAPRI (WS-BEG:WS-END)
  9371                                 TO WS-APR-WHOLE-NUM
  9372           END-IF
  9373           IF BAPRI (WS-SUB:1) = '.'
  9374              COMPUTE WS-BEG = WS-SUB + 1
  9375              IF (WS-BEG < 8)
  9376                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9377                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9378                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 176
* EL6311.cbl
  9379                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9380                 END-PERFORM
  9381                 COMPUTE WS-END = WS-SUB - WS-BEG
  9382                 MOVE BAPRI (WS-BEG:WS-END)
  9383                                 TO WS-APR-DEC (1:WS-END)
  9384              END-IF
  9385           END-IF
  9386           MOVE AL-UNNON      TO BAPRA
  9387           MOVE WS-BAPR       TO BAPRO
  9388        END-IF
  9389     END-IF
  9390*     IF BAPRL NOT = ZEROS
  9391*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9392*        PERFORM 8600-DEEDIT
  9393*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9394
  9395     IF BLIVESL NOT = ZEROS
  9396        MOVE BLIVESI             TO DEEDIT-FIELD
  9397        PERFORM 8600-DEEDIT
  9398        IF DEEDIT-FIELD-V0 NUMERIC
  9399           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9400           MOVE AL-UNNON         TO BLIVESA
  9401        ELSE
  9402           MOVE -1               TO BLIVESL
  9403           MOVE AL-UNBON         TO BLIVESA
  9404           MOVE ER-2223          TO EMI-ERROR
  9405           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9406
  9407*DMD CUSTOM CODING*************START
  9408*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9409     IF PI-COMPANY-ID NOT = 'DMD'
  9410         MOVE ZEROS               TO BBILLEDL
  9411         GO TO 1010-EDIT-CONT.
  9412
  9413     IF BBILLEDL NOT = ZEROS
  9414        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9415        MOVE 'Y'                 TO WS-NUMERIC-SW
  9416        MOVE +1                  TO WS-CSO-SUB
  9417        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9418        IF CSO-NUMERIC-FIELD
  9419
  9420* EXEC CICS BIF DEEDIT
  9421*              FIELD  (BBILLEDI)
  9422*              LENGTH (9)
  9423*          END-EXEC
  9424     MOVE 9
  9425       TO DFHEIV11
  9426*    MOVE '@"L                   #   #00009343' TO DFHEIV0
  9427     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9428     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9429     MOVE X'2020233030303039333433' TO DFHEIV0(25:11)
  9430     CALL 'kxdfhei1' USING DFHEIV0,
  9431           BBILLEDI,
  9432           DFHEIV11
  9433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9434           MOVE BBILLEDI         TO WS-BILLED
  9435           MOVE AL-UNNON         TO BBILLEDA
  9436        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 177
* EL6311.cbl
  9437           MOVE -1               TO BBILLEDL
  9438           MOVE AL-UNBON         TO BBILLEDA
  9439           MOVE ER-2547          TO EMI-ERROR
  9440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9441     ELSE
  9442        IF BMAINTI EQUAL 'A'
  9443           MOVE -1               TO BBILLEDL
  9444           MOVE AL-UNBON         TO BBILLEDA
  9445           MOVE ER-8148          TO EMI-ERROR
  9446           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9447
  9448 1010-EDIT-CONT.
  9449
  9450     IF BFORCEL  NOT = ZEROS
  9451         IF FORCE-CAP
  9452            MOVE AL-UANON            TO BFORCEA
  9453         ELSE
  9454            MOVE ER-2945             TO EMI-ERROR
  9455            MOVE AL-UABON            TO BFORCEA
  9456            MOVE -1                  TO BFORCEL
  9457            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458
  9459     IF BENTRYL NOT = ZEROS
  9460        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9461                         'D' AND 'V' AND 'U' AND 'M'
  9462           MOVE ER-2224              TO EMI-ERROR
  9463           MOVE AL-UABON             TO BENTRYA
  9464           MOVE -1                   TO BENTRYL
  9465           MOVE  1                   TO SET-CURSOR-SW
  9466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9467        ELSE
  9468           MOVE AL-UANON             TO BENTRYA.
  9469
  9470     IF BUNWRITL NOT = ZEROS
  9471        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9472           MOVE ER-7574              TO EMI-ERROR
  9473           MOVE AL-UABON             TO BUNWRITA
  9474           MOVE -1                   TO BUNWRITL
  9475           MOVE  1                   TO SET-CURSOR-SW
  9476           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9477        ELSE
  9478           MOVE AL-UANON             TO BUNWRITA.
  9479
  9480     IF BREINL  NOT = ZEROS
  9481         MOVE AL-UANON               TO BREINA.
  9482
  9483     IF BBILCDL NOT = ZEROS
  9484        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9485                             AND 'A' AND 'B' AND 'E'
  9486           MOVE ER-2225              TO EMI-ERROR
  9487           MOVE AL-UABON             TO BBILCDA
  9488           MOVE -1                   TO BBILCDL
  9489           MOVE  1                   TO SET-CURSOR-SW
  9490           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9491        ELSE
  9492           MOVE AL-UANON             TO BBILCDA.
  9493
  9494     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 178
* EL6311.cbl
  9495         MOVE AL-UANON               TO BSKPCDA.
  9496
  9497     IF BINDGRPL NOT = ZEROS
  9498         MOVE AL-UANON               TO BINDGRPA.
  9499
  9500     IF BSIGL   NOT = ZEROS
  9501         MOVE AL-UANON               TO BSIGA.
  9502
  9503     IF BRTCLSL NOT = ZEROS
  9504         MOVE AL-UANON               TO BRTCLSA.
  9505
  9506     IF BMEMBERL NOT = ZEROS
  9507         MOVE AL-UANON               TO BMEMBERA.
  9508
  9509     MOVE +0                         TO WS-SUB1.
  9510
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 179
* EL6311.cbl
  9512
  9513******************************************************************
  9514*                                                                *
  9515*           E D I T   I S S U E   C O V E R A G E S              *
  9516*                                                                *
  9517******************************************************************
  9518
  9519 1020-EDIT-COVERAGES.
  9520     ADD +1                      TO WS-SUB1.
  9521
  9522     IF WS-SUB1 GREATER +2
  9523        GO TO 1025-EDIT-COMPLETE.
  9524
  9525     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9526       IF (BMODEL   GREATER ZERO  OR
  9527            BPMTSL   GREATER ZERO  OR
  9528            BPMTAMTL GREATER ZERO)
  9529          AND
  9530            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9531               GO TO 1021-CONT-EDIT.
  9532
  9533     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9534        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9535        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9536        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9537        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9538        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9539        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9540        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9541        NEXT SENTENCE
  9542         ELSE
  9543            GO TO 1020-EDIT-COVERAGES.
  9544
  9545 1021-CONT-EDIT.
  9546
  9547     IF BMAINTI = 'A'
  9548        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9549           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9550        ELSE
  9551           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9552           MOVE ER-7404          TO EMI-ERROR
  9553           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9554           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9555     ELSE
  9556        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9557           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9558
  9559     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9560        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9561        PERFORM 8600-DEEDIT
  9562        IF DEEDIT-FIELD-V0 NUMERIC
  9563           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9564        ELSE
  9565           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9566
  9567     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9568*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9569        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 180
* EL6311.cbl
  9570           BPMTSL  GREATER THAN ZEROS
  9571           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9572
  9573     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9574         IF BMODEL   GREATER THAN ZEROS  OR
  9575            BPMTSL   GREATER THAN ZEROS  OR
  9576            BPMTAMTL GREATER THAN ZEROS
  9577             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9578
  9579     IF BMAINTI = ('C' OR 'K')
  9580        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9581           NEXT SENTENCE
  9582        ELSE
  9583           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9584           PERFORM 8600-DEEDIT
  9585           IF DEEDIT-FIELD-V0 NUMERIC
  9586              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9587              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9588                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9589              ELSE
  9590                    MOVE ER-2241      TO EMI-ERROR
  9591                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9592                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9593                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9594           ELSE
  9595              MOVE ER-2223          TO EMI-ERROR
  9596              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9597              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9599     ELSE
  9600        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9601            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9602            PERFORM 8600-DEEDIT
  9603            IF DEEDIT-FIELD-V0      NUMERIC
  9604               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9605                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9606                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9607               ELSE
  9608                  MOVE ER-2241         TO EMI-ERROR
  9609                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9610                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9611                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9612            ELSE
  9613              MOVE ER-2223             TO EMI-ERROR
  9614              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9615              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9616              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9617        ELSE
  9618            MOVE ER-2240               TO EMI-ERROR
  9619            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9620            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9621*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9622*        IF BMODEL  GREATER THAN ZEROS  AND
  9623*           BPMTSL  GREATER THAN ZEROS
  9624*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9625
  9626     IF BBEN-LEN (WS-SUB1) = ZEROS
  9627        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 181
* EL6311.cbl
  9628           NEXT SENTENCE
  9629     ELSE
  9630        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9631           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9632
  9633* EXEC CICS BIF DEEDIT
  9634*              FIELD  (BBENI (WS-SUB1))
  9635*              LENGTH (12)
  9636*          END-EXEC
  9637     MOVE 12
  9638       TO DFHEIV11
  9639*    MOVE '@"L                   #   #00009545' TO DFHEIV0
  9640     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9641     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9642     MOVE X'2020233030303039353435' TO DFHEIV0(25:11)
  9643     CALL 'kxdfhei1' USING DFHEIV0,
  9644           BBENI(WS-SUB1),
  9645           DFHEIV11
  9646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9647           IF BBENI (WS-SUB1)  NUMERIC
  9648              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9649                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9650*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9651*          PERFORM 8600-DEEDIT
  9652*          IF DEEDIT-FIELD-V2  NUMERIC
  9653*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9654*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9655              ELSE
  9656                 MOVE ER-7632    TO EMI-ERROR
  9657                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9658                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9659                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9660           ELSE
  9661              MOVE ER-2223         TO EMI-ERROR
  9662              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9663              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9664              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9665        ELSE
  9666           MOVE ER-7632    TO EMI-ERROR
  9667           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9668           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9669           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9670
  9671     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9672        AND (BMAINTI = ('C' OR 'K'))
  9673        CONTINUE
  9674     ELSE
  9675        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9676           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9677           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9678              FOR ALL '.'
  9679           IF WS-TALLY > 1
  9680              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9681                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9682              END-PERFORM
  9683              IF A1 < 9
  9684                 ADD 3 TO A1
  9685                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 182
* EL6311.cbl
  9686              END-IF
  9687           ELSE
  9688              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9689                (A1 > 11)
  9690                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9691                  LOW-VALUES OR SPACES)
  9692              END-PERFORM
  9693              IF A1 > 1 AND < 12
  9694                 MOVE SPACES
  9695                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9696              END-IF
  9697           END-IF
  9698
  9699* EXEC CICS BIF DEEDIT
  9700*              FIELD  (BPREMI (WS-SUB1))
  9701*              LENGTH (11)
  9702*          END-EXEC
  9703     MOVE 11
  9704       TO DFHEIV11
  9705*    MOVE '@"L                   #   #00009600' TO DFHEIV0
  9706     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9707     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9708     MOVE X'2020233030303039363030' TO DFHEIV0(25:11)
  9709     CALL 'kxdfhei1' USING DFHEIV0,
  9710           BPREMI(WS-SUB1),
  9711           DFHEIV11
  9712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9713           IF BPREMI (WS-SUB1) NUMERIC
  9714              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9715                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9716*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9717*          PERFORM 8600-DEEDIT
  9718*          IF DEEDIT-FIELD-V2  NUMERIC
  9719*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9720*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9721              ELSE
  9722                 IF PI-COMPANY-ID NOT = 'DCC'
  9723                    MOVE ER-7633    TO EMI-ERROR
  9724                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9725                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9726                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9727                 END-IF
  9728              END-IF
  9729           ELSE
  9730              MOVE ER-2223         TO EMI-ERROR
  9731              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9732              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9733              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9734           END-IF
  9735        ELSE
  9736           IF PI-COMPANY-ID NOT = 'DCC'
  9737              MOVE ER-7633         TO EMI-ERROR
  9738              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9739              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9740              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9741           END-IF
  9742        END-IF
  9743     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 183
* EL6311.cbl
  9744
  9745     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9746        NEXT SENTENCE
  9747     ELSE
  9748        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9749
  9750* EXEC CICS BIF DEEDIT
  9751*           FIELD  (BCPREMI (WS-SUB1))
  9752*           LENGTH (11)
  9753*       END-EXEC
  9754     MOVE 11
  9755       TO DFHEIV11
  9756*    MOVE '@"L                   #   #00009640' TO DFHEIV0
  9757     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9758     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9759     MOVE X'2020233030303039363430' TO DFHEIV0(25:11)
  9760     CALL 'kxdfhei1' USING DFHEIV0,
  9761           BCPREMI(WS-SUB1),
  9762           DFHEIV11
  9763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9764        IF BCPREMI (WS-SUB1) NUMERIC
  9765           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9766*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9767*       PERFORM 8600-DEEDIT
  9768*       IF DEEDIT-FIELD-V2  NUMERIC
  9769*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9770        ELSE
  9771           MOVE ER-2223         TO EMI-ERROR
  9772           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9773           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9774           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9775
  9776     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9777        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9778        PERFORM 8600-DEEDIT
  9779        IF DEEDIT-FIELD-V0 NUMERIC
  9780           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9781           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9782         ELSE
  9783           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9784           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9785           MOVE ER-2223              TO EMI-ERROR
  9786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9787
  9788     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9789        IF BEXPIRE   (WS-SUB1) = SPACES
  9790           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9791        ELSE
  9792           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9793           PERFORM 8600-DEEDIT
  9794           IF DEEDIT-FIELD-V0        NUMERIC
  9795              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9796              MOVE 4                TO DC-OPTION-CODE
  9797              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9798              PERFORM 9700-DATE-LINK
  9799              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9800                                                        (WS-SUB1)
  9801              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 184
* EL6311.cbl
  9802                 NEXT SENTENCE
  9803              ELSE
  9804                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9805                 MOVE ER-2531    TO EMI-ERROR
  9806                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9807                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9808           ELSE
  9809             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9810             MOVE ER-2532        TO EMI-ERROR
  9811             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9812             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9813
  9814     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9815        NEXT SENTENCE
  9816     ELSE
  9817
  9818* EXEC CICS BIF DEEDIT
  9819*           FIELD  (BALT-BENI (WS-SUB1))
  9820*           LENGTH (12)
  9821*       END-EXEC
  9822     MOVE 12
  9823       TO DFHEIV11
  9824*    MOVE '@"L                   #   #00009697' TO DFHEIV0
  9825     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9826     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9827     MOVE X'2020233030303039363937' TO DFHEIV0(25:11)
  9828     CALL 'kxdfhei1' USING DFHEIV0,
  9829           BALT-BENI(WS-SUB1),
  9830           DFHEIV11
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9832        IF BALT-BENI (WS-SUB1) NUMERIC
  9833           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9834*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9835*       PERFORM 8600-DEEDIT
  9836*       IF DEEDIT-FIELD-V0 NUMERIC
  9837*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9838        ELSE
  9839           MOVE ER-2223         TO EMI-ERROR
  9840           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9841           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9842           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9843
  9844     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9845        NEXT SENTENCE
  9846     ELSE
  9847
  9848* EXEC CICS BIF DEEDIT
  9849*           FIELD  (BALT-PREMI (WS-SUB1))
  9850*           LENGTH (11)
  9851*       END-EXEC
  9852     MOVE 11
  9853       TO DFHEIV11
  9854*    MOVE '@"L                   #   #00009716' TO DFHEIV0
  9855     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9856     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9857     MOVE X'2020233030303039373136' TO DFHEIV0(25:11)
  9858     CALL 'kxdfhei1' USING DFHEIV0,
  9859           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 185
* EL6311.cbl
  9860           DFHEIV11
  9861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9862        IF BALT-PREMI (WS-SUB1) NUMERIC
  9863           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9864*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9865*       PERFORM 8600-DEEDIT
  9866*       IF DEEDIT-FIELD-V0 NUMERIC
  9867*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9868        ELSE
  9869           MOVE ER-2223         TO EMI-ERROR
  9870           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9871           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9873
  9874      GO TO 1020-EDIT-COVERAGES.
  9875
  9876 1025-EDIT-COMPLETE.
  9877     IF PI-COMPANY-ID  =  'DMD'
  9878        MOVE LOW-VALUES             TO BNCERTI
  9879                                       BNSTATI.
  9880
  9881     IF EMI-ERROR = ZEROS
  9882         NEXT SENTENCE
  9883     ELSE
  9884         GO TO 8200-SEND-DATAONLY.
  9885
  9886     IF BMAINTI = 'A'
  9887         GO TO 1200-ADD-ISSUE-ROUTINE.
  9888
  9889     IF BMAINTI = 'C'
  9890         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9891
  9892     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9893
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 186
* EL6311.cbl
  9895
  9896 1030-EDIT-FOR-NUMERICS.
  9897     IF WS-CSO-SUB EQUAL 10
  9898        GO TO 1030-EDIT-EXIT.
  9899
  9900     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9901        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9902        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9903           ADD +1               TO WS-CSO-SUB
  9904           GO TO 1030-EDIT-FOR-NUMERICS.
  9905
  9906     MOVE 'N'                   TO WS-NUMERIC-SW.
  9907
  9908 1030-EDIT-EXIT.
  9909******************************************************************
  9910*                                                                *
  9911*                 C A L C U L A T E   A G E                      *
  9912*                                                                *
  9913******************************************************************
  9914
  9915
  9916 1095-CALC-AGE.
  9917
  9918     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9919     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9920     MOVE 1                  TO DC-OPTION-CODE.
  9921     PERFORM 9700-DATE-LINK
  9922     IF NO-CONVERSION-ERROR
  9923         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9924         MOVE WS-BAGE            TO BAGEI
  9925         MOVE +2                 TO BAGEL
  9926         MOVE AL-UNNON TO BAGEA.
  9927
  9928 1099-EXIT.
  9929     EXIT.
  9930
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 187
* EL6311.cbl
  9932
  9933******************************************************************
  9934*                                                                *
  9935*                   S H O W   I S S U E                          *
  9936*                                                                *
  9937******************************************************************
  9938
  9939 1100-SHOW-REQUEST.
  9940     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9941
  9942     IF BCERTNOL = ZEROS AND
  9943        BEFFDTL  = ZEROS
  9944        MOVE -1                  TO BMAINTL
  9945        GO TO 8200-SEND-DATAONLY.
  9946
  9947     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9948
  9949     IF BSUFIXL NOT = ZEROS
  9950        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9951     ELSE
  9952        MOVE SPACE               TO WS-NEW-SUFFIX.
  9953
  9954     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9955     PERFORM 8600-DEEDIT.
  9956     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9957     MOVE '4'                    TO DC-OPTION-CODE.
  9958     PERFORM 9700-DATE-LINK.
  9959     IF DATE-CONVERSION-ERROR
  9960        MOVE ER-0348             TO EMI-ERROR
  9961        MOVE -1                  TO BEFFDTL
  9962        MOVE AL-UABON            TO BEFFDTA
  9963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9964        GO TO 8200-SEND-DATAONLY
  9965     ELSE
  9966        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  9967        MOVE AL-UANON            TO BEFFDTA
  9968        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  9969
  9970     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9971
  9972     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
  9973        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
  9974          MOVE 'Y'                    TO WS-SHOW-SW
  9975          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9976             GO TO 4100-BROWSE-PRIMARY-FORWARD
  9977           ELSE
  9978             IF PI-FILE-BROWSE
  9979                GO TO 4300-BROWSE-FILE-FORWARD
  9980              ELSE
  9981                IF PI-CSR-BROWSE
  9982                   GO TO 4200-BROWSE-CSR-FORWARD
  9983                ELSE
  9984                   GO TO 4000-BROWSE-DETAIL-FORWARD
  9985        ELSE
  9986           GO TO 3900-RE-DISPLAY-RECORD.
  9987
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 188
* EL6311.cbl
  9989
  9990******************************************************************
  9991*                                                                *
  9992*            A D D   I S S U E   R O U T I N E                   *
  9993*                                                                *
  9994******************************************************************
  9995
  9996***************************************************************
  9997*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
  9998*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  9999*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10000*     4. LINK TO THE EDIT ROUTINE.                            *
 10001*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10002*     6. WRITE THE NEW ISSUE RECORD.                          *
 10003*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10004*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10005*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10006*        ELSE                                                 *
 10007*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10008***************************************************************
 10009
 10010 1200-ADD-ISSUE-ROUTINE.
 10011     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10012
 10013
 10014* EXEC CICS GETMAIN
 10015*        SET     (ADDRESS OF PENDING-BUSINESS)
 10016*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10017*    END-EXEC.
 10018*    MOVE '," L                  $   #00009871' TO DFHEIV0
 10019     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10020     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10021     MOVE X'2020233030303039383731' TO DFHEIV0(25:11)
 10022     CALL 'kxdfhei1' USING DFHEIV0,
 10023           DFHEIV20,
 10024           ERPNDB-RECORD-LENGTH,
 10025           DFHEIV99
 10026     SET ADDRESS OF PENDING-BUSINESS TO
 10027         DFHEIV20
 10028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10029
 10030
 10031
 10032* EXEC CICS HANDLE CONDITION
 10033*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10034*    END-EXEC.
 10035*    MOVE '"$I                   ! # #00009876' TO DFHEIV0
 10036     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10038     MOVE X'2320233030303039383736' TO DFHEIV0(25:11)
 10039     CALL 'kxdfhei1' USING DFHEIV0
 10040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10041
 10042
 10043     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10044     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10045     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10046
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 189
* EL6311.cbl
 10047
 10048* EXEC CICS READ
 10049*        INTO    (PENDING-BUSINESS)
 10050*        DATASET (FILE-ID-ERPNDB)
 10051*        RIDFLD  (ERPNDB-KEY)
 10052*    END-EXEC.
 10053     MOVE LENGTH OF
 10054      PENDING-BUSINESS
 10055       TO DFHEIV11
 10056*    MOVE '&"IL       E          (   #00009884' TO DFHEIV0
 10057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10059     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0,
 10061           FILE-ID-ERPNDB,
 10062           PENDING-BUSINESS,
 10063           DFHEIV11,
 10064           ERPNDB-KEY,
 10065           DFHEIV99,
 10066           DFHEIV99,
 10067           DFHEIV99
 10068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10069
 10070
 10071     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10072
 10073     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10074     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10075     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10076     MOVE SPACES                 TO PENDING-BUSINESS.
 10077     MOVE 'PB'                   TO PB-RECORD-ID.
 10078     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10079     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10080     MOVE SPACES                 TO PB-CERT-SFX.
 10081     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10082     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10083                                    PB-ALT-CHG-SEQ-NO.
 10084
 10085     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10086     MOVE '1'                    TO PB-RECORD-TYPE.
 10087
 10088     IF BSUFIXL NOT = ZEROS
 10089        MOVE BSUFIXI             TO PB-CERT-SFX.
 10090
 10091     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10092
 10093     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10094     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10095
 10096     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10097                                    PB-I-LF-PREM-CALC
 10098                                    PB-I-LF-ALT-PREM-CALC
 10099                                    PB-I-LF-RATE
 10100                                    PB-I-LF-ALT-RATE
 10101                                    PB-I-LF-REI-RATE
 10102                                    PB-I-LF-ALT-REI-RATE
 10103                                    PB-I-RATE-DEV-PCT-LF
 10104                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 190
* EL6311.cbl
 10105                                    PB-I-AH-RATE
 10106                                    PB-I-AH-REI-RATE
 10107                                    PB-I-AH-RATE-TRM
 10108                                    PB-I-RATE-DEV-PCT-AH
 10109                                    PB-I-BUSINESS-TYPE
 10110                                    PB-I-LIFE-COMMISSION
 10111                                    PB-I-JOINT-COMMISSION
 10112                                    PB-I-JOINT-AGE
 10113                                    PB-I-AH-COMMISSION
 10114                                    PB-I-CURR-SEQ
 10115                                    PB-CHG-COUNT
 10116                                    PB-LF-BILLED-AMTS
 10117                                    PB-AH-BILLED-AMTS
 10118                                    PB-CALC-TOLERANCE
 10119                                    PB-I-EXTENTION-DAYS
 10120*                                   PB-I-MICROFILM-NO
 10121                                    PB-I-TERM-IN-DAYS.
 10122
 10123     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10124                                    PB-I-LF-EXPIRE-DT
 10125                                    PB-I-AH-EXPIRE-DT
 10126                                    PB-BILLED-DT
 10127                                    PB-ACCT-EFF-DT
 10128                                    PB-ACCT-EXP-DT
 10129                                    PB-I-1ST-PMT-DT.
 10130
 10131     MOVE 'X'                    TO PB-FATAL-FLAG.
 10132
 10133     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10134
 10135     IF BLSTNML GREATER THAN ZEROS
 10136         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10137
 10138*    IF BMICRNOL  GREATER  ZEROS
 10139*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10140*    ELSE
 10141*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10142     IF BVINL > ZEROS
 10143        MOVE BVINI               TO PB-I-VIN
 10144     END-IF
 10145     IF B1STNML GREATER THAN ZEROS
 10146         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10147
 10148     IF BINITL  GREATER THAN ZEROS
 10149         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10150
 10151     IF BBIRTHL GREATER THAN ZERO
 10152         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10153     ELSE
 10154         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10155
 10156     IF B1STPMTL GREATER THAN ZERO
 10157         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10158     ELSE
 10159         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10160
 10161     IF BAGEL    GREATER THAN ZEROS
 10162         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 191
* EL6311.cbl
 10163        ELSE
 10164         MOVE ZEROS              TO PB-I-AGE.
 10165
 10166     IF BSEXL    GREATER THAN ZEROS
 10167         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10168
 10169     IF BTERM-LEN (1) GREATER THAN ZEROS
 10170        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10171     ELSE
 10172        MOVE ZEROS               TO PB-I-LF-TERM.
 10173
 10174     IF BTERM-LEN (2) GREATER THAN ZEROS
 10175        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10176     ELSE
 10177        MOVE ZEROS               TO PB-I-AH-TERM.
 10178
 10179     IF BLNTRML       GREATER THAN ZEROS
 10180         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10181        ELSE
 10182         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10183
 10184     IF BFREQL        GREATER THAN ZEROS
 10185         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10186        ELSE
 10187         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10188
 10189     IF BSKPCDL       GREATER THAN ZEROS
 10190         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10191
 10192     IF BMODEL        GREATER THAN ZEROS
 10193         MOVE BMODEI             TO PB-I-TERM-TYPE
 10194                                    PI-BMODE.
 10195
 10196     IF BPMTSL        GREATER THAN ZEROS
 10197         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10198                                    PI-BPMTS
 10199        ELSE
 10200         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10201                                    PI-BPMTS.
 10202
 10203     IF BPMTAMTL      GREATER THAN ZEROS
 10204         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10205        ELSE
 10206         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10207
 10208     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10209        IF BTYPE  (1)   NOT = ZEROS
 10210           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10211                                    PI-BTYPE (1)
 10212           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10213           MOVE SPACES           TO PB-I-LF-ABBR
 10214        ELSE
 10215           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10216                                    PB-I-LF-ABBR
 10217           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10218     ELSE
 10219        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10220                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 192
* EL6311.cbl
 10221        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10222
 10223     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10224         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10225     ELSE
 10226         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10227
 10228     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10229         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10230     ELSE
 10231         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10232
 10233     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10234         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10235            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10236            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10237         ELSE
 10238            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10239            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10240     ELSE
 10241         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10242
 10243     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10244         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10245
 10246     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10247         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10248         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10249     ELSE
 10250         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10251
 10252     IF  BALT-PREM-LEN     (2) > ZEROS
 10253         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10254     ELSE
 10255         MOVE ZEROS            TO PB-I-TOT-FEES.
 10256
 10257     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10258        IF BTYPE      (2)   NOT = ZEROS
 10259           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10260                                  PI-BTYPE (2)
 10261           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10262           MOVE SPACES         TO PB-I-AH-ABBR
 10263        ELSE
 10264           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10265                                  PB-I-AH-ABBR
 10266           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10267     ELSE
 10268        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10269                                  PB-I-AH-ABBR
 10270        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10271
 10272     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10273         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10274     ELSE
 10275         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10276
 10277     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10278         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 193
* EL6311.cbl
 10279            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10280            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10281         ELSE
 10282            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10283            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10284     ELSE
 10285         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10286
 10287     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10288         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10289
 10290     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10291        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10292     ELSE
 10293        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10294
 10295     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10296        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10297     ELSE
 10298        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10299
 10300     IF BINDGRPL  GREATER THAN ZEROS
 10301         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10302
 10303     IF BRTCLSL   GREATER THAN ZEROS
 10304         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10305
 10306     IF BSIGL     GREATER THAN ZEROS
 10307         MOVE BSIGI              TO PB-I-SIG-SW.
 10308
 10309     IF BAPRL     GREATER THAN ZEROS
 10310         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10311     ELSE
 10312         MOVE ZEROS              TO PB-I-LOAN-APR.
 10313
 10314     IF BMEMBERL  GREATER THAN ZEROS
 10315         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10316
 10317     IF BLNOFCRL  GREATER THAN ZEROS
 10318         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10319
 10320     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10321        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10322     ELSE
 10323        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10324
 10325     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10326        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10327     ELSE
 10328        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10329
 10330     IF BDAYSL   GREATER THAN ZEROS
 10331        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10332                                    PB-I-EXTENTION-DAYS
 10333     ELSE
 10334        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10335                                    PB-I-EXTENTION-DAYS.
 10336
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 194
* EL6311.cbl
 10337     IF BDAYSL GREATER THAN ZEROS
 10338        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10339
 10340     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10341        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10342           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10343
 10344     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10345        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10346           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10347
 10348     IF B1STPMTL GREATER THAN ZEROS
 10349        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10350
 10351     IF PB-EXT-DAYS-PROCESSING
 10352        IF PB-I-EXTENTION-DAYS = ZEROS
 10353           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10354
 10355     IF PB-EXPIRE-DT-PROCESSING
 10356        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10357           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10358             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10359
 10360     IF PB-1ST-PMT-DT-PROCESSING
 10361        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10362           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10363
 10364     IF BREINL GREATER THAN ZEROS
 10365        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10366
 10367     IF BENTRYL NOT = ZEROS
 10368        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10369        IF PI-COMPANY-ID = 'CID'
 10370           AND (PB-BATCH-ENTRY = 'P')
 10371           AND (PB-STATE = 'VA')
 10372           PERFORM 1500-UPDATE-ERNOTE
 10373                                 THRU 1500-EXIT
 10374        END-IF
 10375     END-IF
 10376     IF BUNWRITL NOT = ZEROS
 10377        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10378
 10379     IF BFORCEL NOT = ZEROS
 10380        MOVE BFORCEI             TO PB-FORCE-CODE.
 10381
 10382     IF BBILCDL NOT = ZEROS
 10383        MOVE BBILCDI             TO PB-RECORD-BILL.
 10384
 10385     IF BLIVESL GREATER THAN ZEROS
 10386        MOVE WS-BLIVES           TO PB-I-LIVES
 10387     ELSE
 10388        MOVE ZEROS               TO PB-I-LIVES.
 10389
 10390     IF BBILLEDL GREATER THAN ZEROS
 10391        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10392     ELSE
 10393        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10394
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 195
* EL6311.cbl
 10395*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10396
 10397 1260-WRITE-PB-RECORD.
 10398     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10399                                    PB-INPUT-BY.
 10400     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10401     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10402                                    PB-INPUT-DT.
 10403
 10404     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10405     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10406                                    PB-CONTROL-BY-ORIG-BATCH.
 10407
 10408
 10409     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10410     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10411     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10412     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10413     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10414
 10415     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10416
 10417     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10418
 10419     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10420     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10421     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10422
 10423     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10424     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10425
 10426 1275-WRITE-PENDING-BUSINESS.
 10427     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10428     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10429     MOVE 'A'                    TO JP-RECORD-TYPE.
 10430     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10431
 10432
 10433* EXEC CICS HANDLE CONDITION
 10434*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10435*    END-EXEC.
 10436*    MOVE '"$%                   ! $ #00010251' TO DFHEIV0
 10437     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10439     MOVE X'2420233030303130323531' TO DFHEIV0(25:11)
 10440     CALL 'kxdfhei1' USING DFHEIV0
 10441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10442
 10443
 10444
 10445* EXEC CICS WRITE
 10446*        DATASET (FILE-ID-ERPNDB)
 10447*        FROM    (PENDING-BUSINESS)
 10448*        RIDFLD  (PB-CONTROL-PRIMARY)
 10449*    END-EXEC.
 10450     MOVE LENGTH OF
 10451      PENDING-BUSINESS
 10452       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 196
* EL6311.cbl
 10453*    MOVE '&$ L                  ''   #00010255' TO DFHEIV0
 10454     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10455     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10456     MOVE X'2020233030303130323535' TO DFHEIV0(25:11)
 10457     CALL 'kxdfhei1' USING DFHEIV0,
 10458           FILE-ID-ERPNDB,
 10459           PENDING-BUSINESS,
 10460           DFHEIV11,
 10461           PB-CONTROL-PRIMARY,
 10462           DFHEIV99,
 10463           DFHEIV99
 10464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10465
 10466
 10467     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10468
 10469     PERFORM 8400-LOG-JOURNAL-RECORD.
 10470
 10471******************************************************************
 10472*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10473******************************************************************
 10474     display ' made it to add orig cert '
 10475     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10476     MOVE ' '                    TO WS-ERMAIL-SW
 10477
 10478* EXEC CICS READ
 10479*       DATASET   (FILE-ID-ERMAIL)
 10480*       SET       (ADDRESS OF MAILING-DATA)
 10481*       RIDFLD    (ERMAIL-KEY)
 10482*       RESP      (WS-RESPONSE)
 10483*    END-EXEC
 10484*    MOVE '&"S        E          (  N#00010271' TO DFHEIV0
 10485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10487     MOVE X'204E233030303130323731' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0,
 10489           FILE-ID-ERMAIL,
 10490           DFHEIV20,
 10491           DFHEIV99,
 10492           ERMAIL-KEY,
 10493           DFHEIV99,
 10494           DFHEIV99,
 10495           DFHEIV99
 10496     SET ADDRESS OF MAILING-DATA TO
 10497         DFHEIV20
 10498     MOVE EIBRESP  TO WS-RESPONSE
 10499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10500     IF RESP-NORMAL
 10501        SET ERMAIL-FOUND TO TRUE
 10502     END-IF
 10503
 10504     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10505     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10506     MOVE 'OC'                   TO OC-RECORD-ID
 10507     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10508                                 TO OC-CONTROL-PRIMARY (1:33)
 10509     MOVE 'I'                    TO OC-RECORD-TYPE
 10510     MOVE +4096                  TO OC-KEY-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 197
* EL6311.cbl
 10511     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10512     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10513     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10514     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10515     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10516     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10517     MOVE PB-I-AGE               TO OC-INS-AGE
 10518     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10519     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10520     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10521     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10522     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10523     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10524     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10525     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10526     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10527     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10528     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10529     IF PB-I-JOINT-COMMISSION > +0
 10530         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10531     ELSE
 10532         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10533     END-IF
 10534     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10535     MOVE +0                     TO OC-LF-CANCEL-AMT
 10536                                    OC-LF-ITD-CANCEL-AMT
 10537     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10538     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10539     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10540     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10541     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10542     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10543     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10544     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10545     MOVE +0                     TO OC-AH-CANCEL-AMT
 10546                                    OC-AH-ITD-CANCEL-AMT
 10547     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10548     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10549     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10550     IF ERMAIL-FOUND
 10551        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10552     END-IF
 10553     IF NOT CERT-TRL-REC-NOT-FOUND
 10554        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10555                           OC-INS-AGE-DEFAULT-FLAG
 10556        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10557                           OC-JNT-AGE-DEFAULT-FLAG
 10558     END-IF
 10559     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10560     .
 10561 1275-WRITE-ELCRTO.
 10562
 10563* EXEC CICS WRITE
 10564*       DATASET   ('ELCRTO')
 10565*       FROM      (ORIGINAL-CERTIFICATE)
 10566*       RIDFLD    (OC-CONTROL-PRIMARY)
 10567*       RESP      (WS-RESPONSE)
 10568*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 198
* EL6311.cbl
 10569     MOVE LENGTH OF
 10570      ORIGINAL-CERTIFICATE
 10571       TO DFHEIV11
 10572     MOVE 'ELCRTO' TO DFHEIV1
 10573*    MOVE '&$ L                  ''  N#00010339' TO DFHEIV0
 10574     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10576     MOVE X'204E233030303130333339' TO DFHEIV0(25:11)
 10577     CALL 'kxdfhei1' USING DFHEIV0,
 10578           DFHEIV1,
 10579           ORIGINAL-CERTIFICATE,
 10580           DFHEIV11,
 10581           OC-CONTROL-PRIMARY,
 10582           DFHEIV99,
 10583           DFHEIV99
 10584     MOVE EIBRESP  TO WS-RESPONSE
 10585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10586     display ' just wrote 1275 ' ws-response
 10587     IF RESP-DUPKEY
 10588        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10589        GO TO 1275-WRITE-ELCRTO
 10590     ELSE
 10591        IF NOT RESP-NORMAL
 10592           MOVE -1               TO BMAINTL
 10593           MOVE ER-7450          TO EMI-ERROR
 10594           PERFORM 9900-ERROR-FORMAT
 10595                                 THRU 9900-EXIT
 10596           GO TO 8200-SEND-DATAONLY
 10597        END-IF
 10598     END-IF
 10599******************************************************************
 10600*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10601******************************************************************
 10602
 10603
 10604* EXEC CICS READ
 10605*        INTO    (PENDING-BUSINESS)
 10606*        DATASET (FILE-ID-ERPNDB)
 10607*        RIDFLD  (ERPNDB-KEY)
 10608*        UPDATE
 10609*    END-EXEC.
 10610     MOVE LENGTH OF
 10611      PENDING-BUSINESS
 10612       TO DFHEIV11
 10613*    MOVE '&"IL       EU         (   #00010362' TO DFHEIV0
 10614     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10616     MOVE X'2020233030303130333632' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0,
 10618           FILE-ID-ERPNDB,
 10619           PENDING-BUSINESS,
 10620           DFHEIV11,
 10621           ERPNDB-KEY,
 10622           DFHEIV99,
 10623           DFHEIV99,
 10624           DFHEIV99
 10625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10626
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 199
* EL6311.cbl
 10627
 10628     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10629     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10630     MOVE 'B'                    TO JP-RECORD-TYPE.
 10631     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10632
 10633     PERFORM 8400-LOG-JOURNAL-RECORD.
 10634
 10635     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10636
 10637
 10638* EXEC CICS REWRITE
 10639*        DATASET (FILE-ID-ERPNDB)
 10640*        FROM    (PENDING-BUSINESS)
 10641*    END-EXEC.
 10642     MOVE LENGTH OF
 10643      PENDING-BUSINESS
 10644       TO DFHEIV11
 10645*    MOVE '&& L                  %   #00010378' TO DFHEIV0
 10646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10648     MOVE X'2020233030303130333738' TO DFHEIV0(25:11)
 10649     CALL 'kxdfhei1' USING DFHEIV0,
 10650           FILE-ID-ERPNDB,
 10651           PENDING-BUSINESS,
 10652           DFHEIV11,
 10653           DFHEIV99
 10654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10655
 10656
 10657     MOVE 'C'                    TO JP-RECORD-TYPE.
 10658     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10659
 10660     PERFORM 8400-LOG-JOURNAL-RECORD.
 10661
 10662     IF WS-ERRORS-PRESENT
 10663         GO TO 3900-RE-DISPLAY-RECORD.
 10664
 10665     MOVE ZEROS                  TO EMI-ERROR.
 10666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10667     MOVE LOW-VALUES             TO EL631BI.
 10668     MOVE  -1                    TO BMAINTL.
 10669     GO TO 8100-SEND-INITIAL-MAP.
 10670
 10671 1280-BATCH-HDR-NOT-FOUND.
 10672     MOVE -1                     TO BMAINTL.
 10673     MOVE ER-7450                TO EMI-ERROR.
 10674     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10675     GO TO 8200-SEND-DATAONLY.
 10676
 10677 1290-DUPLICATE-ALT-INDEX.
 10678
 10679******************************************************************
 10680*                                                                *
 10681*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10682*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10683*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10684*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 200
* EL6311.cbl
 10685*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10686*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10687*                                                                *
 10688******************************************************************
 10689
 10690     IF LCP-ONCTR-01 =  0
 10691         ADD 1 TO LCP-ONCTR-01
 10692        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10693
 10694     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10695
 10696     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10697         NEXT SENTENCE
 10698     ELSE
 10699         ADD +1 TO PB-BATCH-SEQ-NO
 10700                   PB-CSR-BATCH-SEQ-NO
 10701         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10702         GO TO 1275-WRITE-PENDING-BUSINESS.
 10703
 10704     MOVE -1                     TO BCERTNOL.
 10705     MOVE AL-UABON               TO BCERTNOA.
 10706     MOVE AL-UNBON               TO BEFFDTA.
 10707
 10708     MOVE 1                      TO EMI-SUB
 10709                                    EMI-SWITCH1
 10710                                    EMI-SWITCH-AREA-1
 10711                                    EMI-SWITCH-AREA-2.
 10712
 10713     MOVE SPACES                 TO EMI-ERROR-LINES.
 10714
 10715
 10716* EXEC CICS SYNCPOINT ROLLBACK
 10717*    END-EXEC.
 10718*    MOVE '6"R                   !   #00010441' TO DFHEIV0
 10719     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10721     MOVE X'2020233030303130343431' TO DFHEIV0(25:11)
 10722     CALL 'kxdfhei1' USING DFHEIV0
 10723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10724
 10725
 10726     MOVE ER-2247                TO EMI-ERROR.
 10727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10728     GO TO 8200-SEND-DATAONLY.
 10729
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 201
* EL6311.cbl
 10731
 10732
 10733 1295-READ-CERT-TRAILER.
 10734
 10735
 10736* EXEC CICS GETMAIN
 10737*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10738*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10739*        INITIMG (GETMAIN-SPACE)
 10740*    END-EXEC
 10741*    MOVE ',"IL                  $   #00010453' TO DFHEIV0
 10742     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10743     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10744     MOVE X'2020233030303130343533' TO DFHEIV0(25:11)
 10745     CALL 'kxdfhei1' USING DFHEIV0,
 10746           DFHEIV20,
 10747           ELCRTT-RECORD-LENGTH,
 10748           GETMAIN-SPACE
 10749     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10750         DFHEIV20
 10751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10752
 10753     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10754     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10755     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10756
 10757
 10758* EXEC CICS HANDLE CONDITION
 10759*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10760*    END-EXEC.
 10761*    MOVE '"$I                   ! % #00010463' TO DFHEIV0
 10762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10764     MOVE X'2520233030303130343633' TO DFHEIV0(25:11)
 10765     CALL 'kxdfhei1' USING DFHEIV0
 10766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10767
 10768
 10769
 10770* EXEC CICS READ
 10771*        DATASET  (CRTT-ID)
 10772*        RIDFLD   (ELCRTT-KEY)
 10773*        INTO     (CERTIFICATE-TRAILERS)
 10774*    END-EXEC.
 10775     MOVE LENGTH OF
 10776      CERTIFICATE-TRAILERS
 10777       TO DFHEIV11
 10778*    MOVE '&"IL       E          (   #00010467' TO DFHEIV0
 10779     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10781     MOVE X'2020233030303130343637' TO DFHEIV0(25:11)
 10782     CALL 'kxdfhei1' USING DFHEIV0,
 10783           CRTT-ID,
 10784           CERTIFICATE-TRAILERS,
 10785           DFHEIV11,
 10786           ELCRTT-KEY,
 10787           DFHEIV99,
 10788           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 202
* EL6311.cbl
 10789           DFHEIV99
 10790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10791
 10792
 10793     GO TO 1295-EXIT.
 10794
 10795 1295-CERT-TRL-REC-NOTFND.
 10796     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10797
 10798 1295-EXIT.
 10799     EXIT.
 10800
 10801******************************************************************
 10802*                                                                *
 10803*          C H A N G E   I S S U E   R O U T I N E               *
 10804*                                                                *
 10805******************************************************************
 10806
 10807***************************************************************
 10808*                                                             *
 10809*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10810*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10811*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10812*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10813*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10814*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10815*     5. LINK TO THE EDIT ROUTINE.                            *
 10816*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10817*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10818*              THE EDIT ROUTINE.                              *
 10819*     7. REWRITE THE NEW ISSUE                                *
 10820*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10821*                                                             *
 10822***************************************************************
 10823
 10824 1300-CHANGE-ISSUE-ROUTINE.
 10825     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10826
 10827     IF BCHGL NOT = ZEROS
 10828        MOVE ER-2196             TO EMI-ERROR
 10829        MOVE AL-UABON            TO BMAINTA
 10830        MOVE -1                  TO BMAINTL
 10831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10832        GO TO 8200-SEND-DATAONLY.
 10833
 10834     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10835
 10836     IF BSUFIXL NOT = ZEROS
 10837        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10838     ELSE
 10839        MOVE SPACE               TO WS-NEW-SUFFIX.
 10840
 10841     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10842     PERFORM 8600-DEEDIT.
 10843     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10844     MOVE '4'                    TO DC-OPTION-CODE.
 10845     PERFORM 9700-DATE-LINK.
 10846     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 203
* EL6311.cbl
 10847        MOVE ER-0348             TO EMI-ERROR
 10848        MOVE -1                  TO BEFFDTL
 10849        MOVE AL-UABON            TO BEFFDTA
 10850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10851        GO TO 8200-SEND-DATAONLY
 10852     ELSE
 10853        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10854        MOVE AL-UANON            TO BEFFDTA
 10855        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10856
 10857 1325-PROCESS-ISSUE-CHANGES.
 10858
 10859* EXEC CICS HANDLE CONDITION
 10860*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10861*    END-EXEC.
 10862*    MOVE '"$I                   ! & #00010538' TO DFHEIV0
 10863     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10865     MOVE X'2620233030303130353338' TO DFHEIV0(25:11)
 10866     CALL 'kxdfhei1' USING DFHEIV0
 10867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10868
 10869
 10870     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10871     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10872     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10873
 10874
 10875* EXEC CICS GETMAIN
 10876*        SET      (ADDRESS OF PENDING-BUSINESS)
 10877*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10878*        INITIMG  (GETMAIN-SPACE)
 10879*     END-EXEC.
 10880*    MOVE ',"IL                  $   #00010546' TO DFHEIV0
 10881     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10883     MOVE X'2020233030303130353436' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           DFHEIV20,
 10886           ERPNDB-RECORD-LENGTH,
 10887           GETMAIN-SPACE
 10888     SET ADDRESS OF PENDING-BUSINESS TO
 10889         DFHEIV20
 10890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10891
 10892
 10893
 10894* EXEC CICS READ
 10895*        INTO    (PENDING-BUSINESS)
 10896*        DATASET (FILE-ID-ERPNDB)
 10897*        RIDFLD  (ERPNDB-KEY)
 10898*    END-EXEC.
 10899     MOVE LENGTH OF
 10900      PENDING-BUSINESS
 10901       TO DFHEIV11
 10902*    MOVE '&"IL       E          (   #00010552' TO DFHEIV0
 10903     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10904     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 204
* EL6311.cbl
 10905     MOVE X'2020233030303130353532' TO DFHEIV0(25:11)
 10906     CALL 'kxdfhei1' USING DFHEIV0,
 10907           FILE-ID-ERPNDB,
 10908           PENDING-BUSINESS,
 10909           DFHEIV11,
 10910           ERPNDB-KEY,
 10911           DFHEIV99,
 10912           DFHEIV99,
 10913           DFHEIV99
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10915
 10916
 10917     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10918
 10919
 10920* EXEC CICS HANDLE CONDITION
 10921*         NOTFND     (1385-REC-NOT-FOUND)
 10922*    END-EXEC.
 10923*    MOVE '"$I                   ! '' #00010560' TO DFHEIV0
 10924     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10926     MOVE X'2720233030303130353630' TO DFHEIV0(25:11)
 10927     CALL 'kxdfhei1' USING DFHEIV0
 10928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10929
 10930
 10931**********************************************************
 10932*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10933*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10934**********************************************************
 10935
 10936
 10937* EXEC CICS READ
 10938*        DATASET (FILE-ID-ERPNDB)
 10939*        INTO    (PENDING-BUSINESS)
 10940*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10941*    END-EXEC.
 10942     MOVE LENGTH OF
 10943      PENDING-BUSINESS
 10944       TO DFHEIV11
 10945*    MOVE '&"IL       E          (   #00010569' TO DFHEIV0
 10946     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10948     MOVE X'2020233030303130353639' TO DFHEIV0(25:11)
 10949     CALL 'kxdfhei1' USING DFHEIV0,
 10950           FILE-ID-ERPNDB,
 10951           PENDING-BUSINESS,
 10952           DFHEIV11,
 10953           PI-PREV-CONTROL-PRIMARY,
 10954           DFHEIV99,
 10955           DFHEIV99,
 10956           DFHEIV99
 10957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10958
 10959
 10960********** DO NOT ALLOW CHANGES IF THRU A/R
 10961     IF BMAINTI = 'C'
 10962         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 205
* EL6311.cbl
 10963             MOVE ER-4005          TO EMI-ERROR
 10964             MOVE -1               TO BMAINTL
 10965             MOVE AL-UABON         TO BMAINTA
 10966             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10967             GO TO 8200-SEND-DATAONLY.
 10968**********
 10969
 10970     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10971        MOVE -1                 TO BMAINTL
 10972        MOVE ER-2197            TO EMI-ERROR
 10973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10974        GO TO 8200-SEND-DATAONLY.
 10975
 10976     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 10977        MOVE ER-2196             TO EMI-ERROR
 10978        MOVE AL-UABON            TO BMAINTA
 10979        MOVE -1                  TO BMAINTL
 10980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10981        GO TO 8200-SEND-DATAONLY.
 10982
 10983     MOVE ZEROS                  TO WS-SEQ-SAVE.
 10984
 10985     IF PB-BILLED-DT = LOW-VALUES AND
 10986        PB-CHG-COUNT = ZEROS
 10987        NEXT SENTENCE
 10988     ELSE
 10989        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10990            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 10991           OR
 10992           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10993            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10994           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 10995
 10996
 10997* EXEC CICS READ
 10998*        DATASET (FILE-ID-ERPNDB)
 10999*        INTO    (PENDING-BUSINESS)
 11000*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11001*        UPDATE
 11002*    END-EXEC.
 11003     MOVE LENGTH OF
 11004      PENDING-BUSINESS
 11005       TO DFHEIV11
 11006*    MOVE '&"IL       EU         (   #00010611' TO DFHEIV0
 11007     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11008     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11009     MOVE X'2020233030303130363131' TO DFHEIV0(25:11)
 11010     CALL 'kxdfhei1' USING DFHEIV0,
 11011           FILE-ID-ERPNDB,
 11012           PENDING-BUSINESS,
 11013           DFHEIV11,
 11014           PI-PREV-CONTROL-PRIMARY,
 11015           DFHEIV99,
 11016           DFHEIV99,
 11017           DFHEIV99
 11018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11019
 11020
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 206
* EL6311.cbl
 11021     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11022     MOVE 'B'                    TO JP-RECORD-TYPE
 11023     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11024     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11025
 11026     PERFORM 8400-LOG-JOURNAL-RECORD.
 11027
 11028     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11029        PB-CHG-COUNT NOT = ZEROS
 11030        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11031            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11032           OR
 11033           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11034            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11035            MOVE LOW-VALUES             TO PB-BILLED-DT
 11036            ADD +1                      TO PB-CHG-COUNT.
 11037
 11038     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11039     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11040     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11041     MOVE '5'                    TO DC-OPTION-CODE.
 11042     PERFORM 9700-DATE-LINK
 11043     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11044
 11045*    IF BMICRNOL  GREATER  ZEROS
 11046*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11047
 11048     IF BVINL > ZEROS
 11049        MOVE BVINI               TO PB-I-VIN
 11050     END-IF
 11051     IF (BFORCEL NOT = ZEROS)
 11052        AND (PB-COMPANY-ID = 'DCC')
 11053        AND (BFORCEI = ' ')
 11054        AND (PB-FORCE-CODE = 'O')
 11055        COMPUTE PB-I-AH-PREMIUM-AMT =
 11056           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11057        PERFORM 1800-REMOVE-CERT-NOTES
 11058                                 THRU 1800-EXIT
 11059        PERFORM 1900-DELETE-ERPYAJ
 11060                                 THRU 1900-EXIT
 11061        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11062     END-IF
 11063     IF (BFORCEL NOT = ZEROS)
 11064        AND (PB-COMPANY-ID = 'DCC')
 11065        AND (BFORCEI = 'O')
 11066        AND (PB-FORCE-CODE NOT = 'O')
 11067        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11068           PB-I-AH-PREM-CALC
 11069        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11070        MOVE SPACE               TO DC-OPTION-CODE
 11071        PERFORM 9700-DATE-LINK
 11072        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11073        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11074        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11075        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11076        PERFORM 1500-UPDATE-ERNOTE
 11077                                 THRU 1500-EXIT
 11078        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 207
* EL6311.cbl
 11079                                 THRU 1600-EXIT
 11080     END-IF
 11081     IF BLSTNML  GREATER THAN ZEROS
 11082         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11083
 11084     IF B1STNML  GREATER THAN ZEROS
 11085         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11086
 11087     IF BINITL   GREATER THAN ZEROS
 11088         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11089
 11090     IF BBIRTHL  GREATER THAN ZERO
 11091         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11092
 11093     IF B1STPMTL GREATER THAN ZERO
 11094         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11095
 11096     IF BAGEL    GREATER THAN ZEROS
 11097         MOVE BAGEI              TO PB-I-AGE.
 11098
 11099     MOVE 'N'                    TO WS-INS-AGE-SET
 11100                                    WS-JNT-AGE-SET.
 11101     IF BAGEL    GREATER THAN ZEROS
 11102        MOVE 'Y'                TO WS-INS-AGE-SET
 11103        IF BAGEI = ZERO AND
 11104             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11105           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11106           MOVE 'AGE*'          TO BAGEDEFO
 11107        ELSE
 11108           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11109           MOVE 'AGE '          TO BAGEDEFO
 11110        END-IF
 11111        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11112     END-IF.
 11113
 11114     IF BSEXL    GREATER THAN ZEROS
 11115         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11116
 11117     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11118        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11119
 11120     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11121        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11122
 11123     IF BLNTRML  GREATER THAN ZEROS
 11124         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11125
 11126     IF BFREQL   GREATER THAN ZEROS
 11127         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11128
 11129     IF BSKPCDL  GREATER THAN ZEROS
 11130         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11131
 11132     IF BMODEL   GREATER THAN ZEROS
 11133         MOVE BMODEI             TO PB-I-TERM-TYPE
 11134                                    PI-BMODE.
 11135
 11136     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 208
* EL6311.cbl
 11137         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11138                                    PI-BPMTS.
 11139
 11140     IF BPMTAMTL GREATER THAN ZEROS
 11141         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11142
 11143     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11144         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11145
 11146     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11147         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11148
 11149     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11150
 11151     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11152         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11153            SUBTRACT PB-I-LF-PREMIUM-AMT
 11154                     FROM WS-B-LF-ISS-PRM-ENTERED
 11155            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11156            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11157            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11158         ELSE
 11159            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11160            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11161
 11162     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11163            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11164                     FROM WS-B-LF-ISS-PRM-ENTERED
 11165         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11166         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11167
 11168     IF  BALT-PREM-LEN     (2)  > ZEROS
 11169         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11170
 11171     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11172         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11173
 11174     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11175         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11176            SUBTRACT PB-I-AH-PREMIUM-AMT
 11177                     FROM WS-B-AH-ISS-PRM-ENTERED
 11178            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11179            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11180            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11181         ELSE
 11182            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11183            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11184
 11185     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11186        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11187
 11188     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11189        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11190
 11191     IF BINDGRPL            GREATER THAN ZEROS
 11192         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11193
 11194     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 209
* EL6311.cbl
 11195         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11196
 11197     IF BSIGL               GREATER THAN ZEROS
 11198         MOVE BSIGI              TO PB-I-SIG-SW.
 11199
 11200     IF BAPRL               GREATER THAN ZEROS
 11201         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11202
 11203     IF BMEMBERL            GREATER THAN ZEROS
 11204         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11205
 11206     IF BLNOFCRL            GREATER THAN ZEROS
 11207         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11208
 11209     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11210        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11211
 11212     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11213        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11214
 11215     IF BDAYSL              GREATER THAN ZEROS
 11216        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11217                                    PB-I-EXTENTION-DAYS.
 11218
 11219     IF BDAYSL GREATER THAN ZEROS
 11220        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11221
 11222     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11223        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11224           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11225
 11226     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11227        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11228           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11229
 11230     IF B1STPMTL GREATER THAN ZEROS
 11231        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11232
 11233     IF PB-EXT-DAYS-PROCESSING
 11234        IF PB-I-EXTENTION-DAYS = ZEROS
 11235           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11236
 11237     IF PB-EXPIRE-DT-PROCESSING
 11238        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11239           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11240             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11241
 11242     IF PB-1ST-PMT-DT-PROCESSING
 11243        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11244           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11245
 11246     IF BREINL GREATER THAN ZEROS
 11247        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11248
 11249     IF BFORCEL NOT = ZEROS
 11250        MOVE BFORCEI             TO PB-FORCE-CODE.
 11251     IF (BENTRYL NOT = ZEROS)
 11252        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 210
* EL6311.cbl
 11253        AND (PB-STATE = 'VA')
 11254        AND (BENTRYI NOT = 'P')
 11255        AND (PB-BATCH-ENTRY = 'P')
 11256        PERFORM 1800-REMOVE-CERT-NOTES
 11257                                 THRU 1800-EXIT
 11258     END-IF
 11259     IF BENTRYL NOT = ZEROS
 11260        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11261        IF PI-COMPANY-ID = 'CID'
 11262           AND (PB-BATCH-ENTRY = 'P')
 11263           AND (PB-STATE = 'VA')
 11264           PERFORM 1500-UPDATE-ERNOTE
 11265                                 THRU 1500-EXIT
 11266        END-IF
 11267     END-IF
 11268
 11269     IF BUNWRITL NOT = ZEROS
 11270        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11271
 11272     IF BBILCDL NOT = ZEROS
 11273        MOVE BBILCDI             TO PB-RECORD-BILL.
 11274
 11275     IF BLIVESL GREATER THAN ZEROS
 11276        MOVE WS-BLIVES           TO PB-I-LIVES.
 11277
 11278
 11279*DMD CUSTOM CODING*************START
 11280     IF PI-COMPANY-ID NOT = 'DMD'
 11281         MOVE ZEROS               TO BBILLEDL.
 11282*DMD CUSTOM CODING*************END
 11283
 11284     IF BBILLEDL GREATER THAN ZEROS
 11285        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11286
 11287
 11288*****************************************************************
 11289*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11290*****************************************************************
 11291
 11292     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11293        IF BTYPE  (1)   = ZEROS OR SPACES
 11294           IF REMOVE-LF-COVERAGE
 11295               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11296                                        PI-BTYPE (1)
 11297               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11298                                        WS-B-LF-ISS-PRM-ENTERED
 11299               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11300                                        WS-B-LF-ISS-PRM-ENTERED
 11301               SUBTRACT PB-I-LF-PREM-CALC FROM
 11302                                        WS-B-LF-ISS-PRM-COMPUTED
 11303               MOVE ZEROS            TO PB-I-LF-TERM
 11304                                        PB-I-LF-BENEFIT-AMT
 11305                                        PB-I-LF-PREMIUM-AMT
 11306                                        PB-I-LF-BENEFIT-CD
 11307                                        PB-I-LF-PREM-CALC
 11308                                        PB-I-LF-CRIT-PER
 11309                                        PB-I-LF-ALT-BENEFIT-AMT
 11310                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 211
* EL6311.cbl
 11311               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11312           ELSE
 11313               NEXT SENTENCE
 11314        ELSE
 11315           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11316                                    PI-BTYPE (1).
 11317     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11318        IF BTYPE  (2)   = ZEROS OR SPACES
 11319           IF  REMOVE-AH-COVERAGE
 11320               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11321                                        PI-BTYPE (2)
 11322               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11323                                        WS-B-AH-ISS-PRM-ENTERED
 11324               SUBTRACT PB-I-AH-PREM-CALC FROM
 11325                                        WS-B-AH-ISS-PRM-COMPUTED
 11326               MOVE ZEROS            TO PB-I-AH-TERM
 11327                                        PB-I-AH-BENEFIT-AMT
 11328                                        PB-I-AH-PREMIUM-AMT
 11329                                        PB-I-AH-BENEFIT-CD
 11330                                        PB-I-AH-PREM-CALC
 11331                                        PB-I-AH-CRIT-PER
 11332               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11333           ELSE
 11334               NEXT SENTENCE
 11335        ELSE
 11336           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11337                                    PI-BTYPE (2).
 11338 1360-REWRITE-PB-RECORD.
 11339     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11340
 11341     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11342     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11343
 11344     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11345
 11346     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11347     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11348
 11349     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11350         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11351
 11352     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11353         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11354
 11355     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11356
 11357     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11358
 11359     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11360
 11361     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11362     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11363     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11364
 11365     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11366     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11367
 11368 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 212
* EL6311.cbl
 11369     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11370     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11371     MOVE 'C'                    TO JP-RECORD-TYPE.
 11372     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11373
 11374
 11375* EXEC CICS REWRITE
 11376*        DATASET (FILE-ID-ERPNDB)
 11377*        FROM    (PENDING-BUSINESS)
 11378*    END-EXEC.
 11379     MOVE LENGTH OF
 11380      PENDING-BUSINESS
 11381       TO DFHEIV11
 11382*    MOVE '&& L                  %   #00010971' TO DFHEIV0
 11383     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11384     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11385     MOVE X'2020233030303130393731' TO DFHEIV0(25:11)
 11386     CALL 'kxdfhei1' USING DFHEIV0,
 11387           FILE-ID-ERPNDB,
 11388           PENDING-BUSINESS,
 11389           DFHEIV11,
 11390           DFHEIV99
 11391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11392
 11393
 11394     PERFORM 8400-LOG-JOURNAL-RECORD.
 11395******************************************************************
 11396*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11397******************************************************************
 11398     display ' made it to update orig cert '
 11399     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11400     MOVE ' '                    TO WS-ERMAIL-SW
 11401
 11402* EXEC CICS READ
 11403*       DATASET   (FILE-ID-ERMAIL)
 11404*       SET       (ADDRESS OF MAILING-DATA)
 11405*       RIDFLD    (ERMAIL-KEY)
 11406*       RESP      (WS-RESPONSE)
 11407*    END-EXEC
 11408*    MOVE '&"S        E          (  N#00010983' TO DFHEIV0
 11409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11411     MOVE X'204E233030303130393833' TO DFHEIV0(25:11)
 11412     CALL 'kxdfhei1' USING DFHEIV0,
 11413           FILE-ID-ERMAIL,
 11414           DFHEIV20,
 11415           DFHEIV99,
 11416           ERMAIL-KEY,
 11417           DFHEIV99,
 11418           DFHEIV99,
 11419           DFHEIV99
 11420     SET ADDRESS OF MAILING-DATA TO
 11421         DFHEIV20
 11422     MOVE EIBRESP  TO WS-RESPONSE
 11423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11424     IF RESP-NORMAL
 11425        SET ERMAIL-FOUND TO TRUE
 11426     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 213
* EL6311.cbl
 11427
 11428     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11429     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11430                                 TO ELCRTO-KEY
 11431     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11432     MOVE +0                     TO ELCRTO-SEQ-NO
 11433
 11434* EXEC CICS READ
 11435*       DATASET   ('ELCRTO')
 11436*       INTO      (ORIGINAL-CERTIFICATE)
 11437*       RIDFLD    (ELCRTO-KEY)
 11438*       GTEQ
 11439*       RESP      (WS-RESPONSE)
 11440*    END-EXEC
 11441     MOVE LENGTH OF
 11442      ORIGINAL-CERTIFICATE
 11443       TO DFHEIV11
 11444     MOVE 'ELCRTO' TO DFHEIV1
 11445*    MOVE '&"IL       G          (  N#00010998' TO DFHEIV0
 11446     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11448     MOVE X'204E233030303130393938' TO DFHEIV0(25:11)
 11449     CALL 'kxdfhei1' USING DFHEIV0,
 11450           DFHEIV1,
 11451           ORIGINAL-CERTIFICATE,
 11452           DFHEIV11,
 11453           ELCRTO-KEY,
 11454           DFHEIV99,
 11455           DFHEIV99,
 11456           DFHEIV99
 11457     MOVE EIBRESP  TO WS-RESPONSE
 11458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11459     display ' just read gteq ' ws-response
 11460     IF RESP-NORMAL
 11461        AND (OC-CONTROL-PRIMARY (1:33) =
 11462                 PB-CONTROL-BY-ACCOUNT (1:33))
 11463        AND (OC-RECORD-TYPE = 'I')
 11464        display ' resp norm, key =, type i '
 11465        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11466           display ' end proc blank '
 11467           display ' csr edit session ' PI-CSR-SESSION-SW
 11468           IF NOT CSR-EDIT-SESSION
 11469
 11470* EXEC CICS READ
 11471*                DATASET   ('ELCRTO')
 11472*                INTO      (ORIGINAL-CERTIFICATE)
 11473*                RIDFLD    (OC-CONTROL-PRIMARY)
 11474*                UPDATE
 11475*                RESP      (WS-RESPONSE)
 11476*             END-EXEC
 11477     MOVE LENGTH OF
 11478      ORIGINAL-CERTIFICATE
 11479       TO DFHEIV11
 11480     MOVE 'ELCRTO' TO DFHEIV1
 11481*    MOVE '&"IL       EU         (  N#00011015' TO DFHEIV0
 11482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11484     MOVE X'204E233030303131303135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 214
* EL6311.cbl
 11485     CALL 'kxdfhei1' USING DFHEIV0,
 11486           DFHEIV1,
 11487           ORIGINAL-CERTIFICATE,
 11488           DFHEIV11,
 11489           OC-CONTROL-PRIMARY,
 11490           DFHEIV99,
 11491           DFHEIV99,
 11492           DFHEIV99
 11493     MOVE EIBRESP  TO WS-RESPONSE
 11494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11495              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11496              IF RESP-NORMAL
 11497                 display ' good read upd '
 11498                 MOVE PB-I-INSURED-LAST-NAME TO
 11499                         OC-INS-LAST-NAME
 11500                 MOVE PB-I-INSURED-FIRST-NAME TO
 11501                         OC-INS-FIRST-NAME
 11502                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11503                         OC-INS-MIDDLE-INIT
 11504                 MOVE PB-I-AGE         TO OC-INS-AGE
 11505                 MOVE PB-I-JOINT-LAST-NAME   TO
 11506                         OC-JNT-LAST-NAME
 11507                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11508                         OC-JNT-FIRST-NAME
 11509                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11510                         OC-JNT-MIDDLE-INIT
 11511                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11512                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11513                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11514                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11515                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11516                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11517                         OC-LF-ALT-BEN-AMT
 11518                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11519                         OC-LF-ALT-PRM-AMT
 11520                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11521                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11522                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11523                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11524                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11525                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11526                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11527                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11528                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11529                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11530                 IF OC-CANCEL-TRAN-IND = 'N'
 11531                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11532                    MOVE +0            TO OC-LF-CANCEL-AMT
 11533                                          OC-LF-ITD-CANCEL-AMT
 11534                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11535                    MOVE +0            TO OC-AH-CANCEL-AMT
 11536                                          OC-AH-ITD-CANCEL-AMT
 11537                 END-IF
 11538                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11539                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11540                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11541                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11542                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 215
* EL6311.cbl
 11543                    MOVE MA-CRED-BENE-NAME
 11544                                 TO OC-CRED-BENE-NAME
 11545                 END-IF
 11546                 IF NOT CERT-TRL-REC-NOT-FOUND
 11547                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11548                           OC-INS-AGE-DEFAULT-FLAG
 11549                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11550                           OC-JNT-AGE-DEFAULT-FLAG
 11551                 END-IF
 11552
 11553* EXEC CICS REWRITE
 11554*                   DATASET   ('ELCRTO')
 11555*                   FROM      (ORIGINAL-CERTIFICATE)
 11556*                   RESP      (WS-RESPONSE)
 11557*                END-EXEC
 11558     MOVE LENGTH OF
 11559      ORIGINAL-CERTIFICATE
 11560       TO DFHEIV11
 11561     MOVE 'ELCRTO' TO DFHEIV1
 11562*    MOVE '&& L                  %  N#00011079' TO DFHEIV0
 11563     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11564     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11565     MOVE X'204E233030303131303739' TO DFHEIV0(25:11)
 11566     CALL 'kxdfhei1' USING DFHEIV0,
 11567           DFHEIV1,
 11568           ORIGINAL-CERTIFICATE,
 11569           DFHEIV11,
 11570           DFHEIV99
 11571     MOVE EIBRESP  TO WS-RESPONSE
 11572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11573                 display ' just rewrote ' ws-response
 11574              END-IF
 11575           END-IF
 11576        ELSE
 11577           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11578           MOVE 'OC'             TO OC-RECORD-ID
 11579           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11580           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11581           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11582           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11583           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11584           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11585           MOVE PB-I-AGE         TO OC-INS-AGE
 11586           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11587           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11588           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11589           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11590           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11591           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11592           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11593           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11594           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11595           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11596           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11597           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11598           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11599           MOVE +0               TO OC-LF-CANCEL-AMT
 11600                                    OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 216
* EL6311.cbl
 11601           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11602           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11603           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11604           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11605           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11606           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11607           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11608           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11609           MOVE +0               TO OC-AH-CANCEL-AMT
 11610                                    OC-AH-ITD-CANCEL-AMT
 11611           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11612           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11613           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11614           IF ERMAIL-FOUND
 11615              MOVE MA-CRED-BENE-NAME
 11616                                 TO OC-CRED-BENE-NAME
 11617           END-IF
 11618           IF NOT CERT-TRL-REC-NOT-FOUND
 11619              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11620                           OC-INS-AGE-DEFAULT-FLAG
 11621              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11622                           OC-JNT-AGE-DEFAULT-FLAG
 11623           END-IF
 11624           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11625
 11626* EXEC CICS WRITE
 11627*             DATASET   ('ELCRTO')
 11628*             FROM      (ORIGINAL-CERTIFICATE)
 11629*             RIDFLD    (OC-CONTROL-PRIMARY)
 11630*             RESP      (WS-RESPONSE)
 11631*          END-EXEC
 11632     MOVE LENGTH OF
 11633      ORIGINAL-CERTIFICATE
 11634       TO DFHEIV11
 11635     MOVE 'ELCRTO' TO DFHEIV1
 11636*    MOVE '&$ L                  ''  N#00011136' TO DFHEIV0
 11637     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11638     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11639     MOVE X'204E233030303131313336' TO DFHEIV0(25:11)
 11640     CALL 'kxdfhei1' USING DFHEIV0,
 11641           DFHEIV1,
 11642           ORIGINAL-CERTIFICATE,
 11643           DFHEIV11,
 11644           OC-CONTROL-PRIMARY,
 11645           DFHEIV99,
 11646           DFHEIV99
 11647     MOVE EIBRESP  TO WS-RESPONSE
 11648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11649        END-IF
 11650     ELSE
 11651        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11652        MOVE 'OC'                TO OC-RECORD-ID
 11653        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11654                                 TO OC-CONTROL-PRIMARY (1:33)
 11655        MOVE 'I'                 TO OC-RECORD-TYPE
 11656        MOVE +4096               TO OC-KEY-SEQ-NO
 11657        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11658        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 217
* EL6311.cbl
 11659        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11660        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11661        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11662        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11663        MOVE PB-I-AGE            TO OC-INS-AGE
 11664        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11665        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11666        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11667        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11668        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11669        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11670        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11671        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11672        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11673        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11674        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11675        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11676        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11677        MOVE +0                  TO OC-LF-CANCEL-AMT
 11678                                    OC-LF-ITD-CANCEL-AMT
 11679        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11680        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11681        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11682        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11683        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11684        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11685        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11686        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11687        MOVE +0                  TO OC-AH-CANCEL-AMT
 11688                                    OC-AH-ITD-CANCEL-AMT
 11689        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11690        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11691        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11692        IF ERMAIL-FOUND
 11693           MOVE MA-CRED-BENE-NAME
 11694                                 TO OC-CRED-BENE-NAME
 11695        END-IF
 11696        IF NOT CERT-TRL-REC-NOT-FOUND
 11697           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11698                           OC-INS-AGE-DEFAULT-FLAG
 11699           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11700                           OC-JNT-AGE-DEFAULT-FLAG
 11701        END-IF
 11702        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11703
 11704* EXEC CICS WRITE
 11705*          DATASET   ('ELCRTO')
 11706*          FROM      (ORIGINAL-CERTIFICATE)
 11707*          RIDFLD    (OC-CONTROL-PRIMARY)
 11708*          RESP      (WS-RESPONSE)
 11709*       END-EXEC
 11710     MOVE LENGTH OF
 11711      ORIGINAL-CERTIFICATE
 11712       TO DFHEIV11
 11713     MOVE 'ELCRTO' TO DFHEIV1
 11714*    MOVE '&$ L                  ''  N#00011196' TO DFHEIV0
 11715     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11716     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 218
* EL6311.cbl
 11717     MOVE X'204E233030303131313936' TO DFHEIV0(25:11)
 11718     CALL 'kxdfhei1' USING DFHEIV0,
 11719           DFHEIV1,
 11720           ORIGINAL-CERTIFICATE,
 11721           DFHEIV11,
 11722           OC-CONTROL-PRIMARY,
 11723           DFHEIV99,
 11724           DFHEIV99
 11725     MOVE EIBRESP  TO WS-RESPONSE
 11726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11727     END-IF
 11728******************************************************************
 11729*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11730******************************************************************
 11731
 11732     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11733     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11734
 11735
 11736* EXEC CICS READ
 11737*        INTO    (PENDING-BUSINESS)
 11738*        DATASET (FILE-ID-ERPNDB)
 11739*        RIDFLD  (ERPNDB-KEY)
 11740*        UPDATE
 11741*    END-EXEC.
 11742     MOVE LENGTH OF
 11743      PENDING-BUSINESS
 11744       TO DFHEIV11
 11745*    MOVE '&"IL       EU         (   #00011210' TO DFHEIV0
 11746     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11747     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11748     MOVE X'2020233030303131323130' TO DFHEIV0(25:11)
 11749     CALL 'kxdfhei1' USING DFHEIV0,
 11750           FILE-ID-ERPNDB,
 11751           PENDING-BUSINESS,
 11752           DFHEIV11,
 11753           ERPNDB-KEY,
 11754           DFHEIV99,
 11755           DFHEIV99,
 11756           DFHEIV99
 11757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11758
 11759
 11760     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11761     MOVE 'B'                    TO JP-RECORD-TYPE.
 11762     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11763
 11764     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11765
 11766     PERFORM 8400-LOG-JOURNAL-RECORD.
 11767
 11768     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11769
 11770     MOVE 'C'                    TO JP-RECORD-TYPE.
 11771     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11772
 11773
 11774* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 219
* EL6311.cbl
 11775*        DATASET    (FILE-ID-ERPNDB)
 11776*        FROM       (PENDING-BUSINESS)
 11777*    END-EXEC.
 11778     MOVE LENGTH OF
 11779      PENDING-BUSINESS
 11780       TO DFHEIV11
 11781*    MOVE '&& L                  %   #00011230' TO DFHEIV0
 11782     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11783     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11784     MOVE X'2020233030303131323330' TO DFHEIV0(25:11)
 11785     CALL 'kxdfhei1' USING DFHEIV0,
 11786           FILE-ID-ERPNDB,
 11787           PENDING-BUSINESS,
 11788           DFHEIV11,
 11789           DFHEIV99
 11790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11791
 11792
 11793     PERFORM 8400-LOG-JOURNAL-RECORD.
 11794
 11795     IF WS-ERRORS-PRESENT
 11796        GO TO 3900-RE-DISPLAY-RECORD.
 11797
 11798     MOVE ZEROS                  TO EMI-ERROR.
 11799     MOVE -1                     TO BMAINTL.
 11800     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11801     GO TO 3900-RE-DISPLAY-RECORD.
 11802
 11803 1380-BATCH-HDR-NOT-FOUND.
 11804     MOVE -1                     TO BMAINTL.
 11805     MOVE ER-7450                TO EMI-ERROR.
 11806     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11807     GO TO 8200-SEND-DATAONLY.
 11808
 11809 1385-REC-NOT-FOUND.
 11810     MOVE -1                     TO BMAINTL.
 11811     MOVE ER-7451                TO EMI-ERROR.
 11812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11813     GO TO 8200-SEND-DATAONLY.
 11814
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 220
* EL6311.cbl
 11816
 11817 1386-UPDATE-AGE-FLAGS.
 11818
 11819
 11820* EXEC CICS GETMAIN
 11821*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11822*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11823*        INITIMG (GETMAIN-SPACE)
 11824*    END-EXEC
 11825*    MOVE ',"IL                  $   #00011261' TO DFHEIV0
 11826     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11827     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11828     MOVE X'2020233030303131323631' TO DFHEIV0(25:11)
 11829     CALL 'kxdfhei1' USING DFHEIV0,
 11830           DFHEIV20,
 11831           ELCRTT-RECORD-LENGTH,
 11832           GETMAIN-SPACE
 11833     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11834         DFHEIV20
 11835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11836
 11837
 11838* EXEC CICS HANDLE CONDITION
 11839*        NOTFND   (1386-NOTFND)
 11840*    END-EXEC.
 11841*    MOVE '"$I                   ! ( #00011267' TO DFHEIV0
 11842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11844     MOVE X'2820233030303131323637' TO DFHEIV0(25:11)
 11845     CALL 'kxdfhei1' USING DFHEIV0
 11846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11847
 11848
 11849     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11850     MOVE 'C'                TO ELCRTT-REC-TYPE
 11851
 11852
 11853* EXEC CICS READ
 11854*        UPDATE
 11855*        DATASET  (CRTT-ID)
 11856*        RIDFLD   (ELCRTT-KEY)
 11857*        INTO     (CERTIFICATE-TRAILERS)
 11858*    END-EXEC.
 11859     MOVE LENGTH OF
 11860      CERTIFICATE-TRAILERS
 11861       TO DFHEIV11
 11862*    MOVE '&"IL       EU         (   #00011274' TO DFHEIV0
 11863     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11864     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11865     MOVE X'2020233030303131323734' TO DFHEIV0(25:11)
 11866     CALL 'kxdfhei1' USING DFHEIV0,
 11867           CRTT-ID,
 11868           CERTIFICATE-TRAILERS,
 11869           DFHEIV11,
 11870           ELCRTT-KEY,
 11871           DFHEIV99,
 11872           DFHEIV99,
 11873           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 221
* EL6311.cbl
 11874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11875
 11876
 11877     IF WS-INS-AGE-SET = 'Y'
 11878        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11879     END-IF
 11880     IF WS-JNT-AGE-SET = 'Y'
 11881        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11882     END-IF
 11883
 11884
 11885* EXEC CICS REWRITE
 11886*       DATASET  (CRTT-ID)
 11887*       FROM     (CERTIFICATE-TRAILERS)
 11888*    END-EXEC.
 11889     MOVE LENGTH OF
 11890      CERTIFICATE-TRAILERS
 11891       TO DFHEIV11
 11892*    MOVE '&& L                  %   #00011288' TO DFHEIV0
 11893     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11894     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11895     MOVE X'2020233030303131323838' TO DFHEIV0(25:11)
 11896     CALL 'kxdfhei1' USING DFHEIV0,
 11897           CRTT-ID,
 11898           CERTIFICATE-TRAILERS,
 11899           DFHEIV11,
 11900           DFHEIV99
 11901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11902
 11903
 11904     GO TO 1386-EXIT.
 11905
 11906 1386-NOTFND.
 11907
 11908     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11909     MOVE 'CS'         TO CS-RECORD-ID.
 11910     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11911     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11912     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11913     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11914     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11915
 11916* EXEC CICS WRITE
 11917*       DATASET  (CRTT-ID)
 11918*       RIDFLD   (ELCRTT-KEY)
 11919*       FROM     (CERTIFICATE-TRAILERS)
 11920*    END-EXEC.
 11921     MOVE LENGTH OF
 11922      CERTIFICATE-TRAILERS
 11923       TO DFHEIV11
 11924*    MOVE '&$ L                  ''   #00011304' TO DFHEIV0
 11925     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11927     MOVE X'2020233030303131333034' TO DFHEIV0(25:11)
 11928     CALL 'kxdfhei1' USING DFHEIV0,
 11929           CRTT-ID,
 11930           CERTIFICATE-TRAILERS,
 11931           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 222
* EL6311.cbl
 11932           ELCRTT-KEY,
 11933           DFHEIV99,
 11934           DFHEIV99
 11935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11936
 11937
 11938 1386-EXIT.
 11939     EXIT.
 11940
 11941 1390-UPDATE-ERPNDM.
 11942
 11943
 11944* EXEC CICS HANDLE CONDITION
 11945*        NOTFND (1399-EXIT)
 11946*    END-EXEC.
 11947*    MOVE '"$I                   ! ) #00011315' TO DFHEIV0
 11948     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11950     MOVE X'2920233030303131333135' TO DFHEIV0(25:11)
 11951     CALL 'kxdfhei1' USING DFHEIV0
 11952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11953
 11954
 11955     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11956
 11957
 11958* EXEC CICS READ
 11959*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 11960*        DATASET (FILE-ID-ERPNDM)
 11961*        RIDFLD  (ERPNDM-KEY)
 11962*        UPDATE
 11963*    END-EXEC.
 11964*    MOVE '&"S        EU         (   #00011321' TO DFHEIV0
 11965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11966     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11967     MOVE X'2020233030303131333231' TO DFHEIV0(25:11)
 11968     CALL 'kxdfhei1' USING DFHEIV0,
 11969           FILE-ID-ERPNDM,
 11970           DFHEIV20,
 11971           DFHEIV99,
 11972           ERPNDM-KEY,
 11973           DFHEIV99,
 11974           DFHEIV99,
 11975           DFHEIV99
 11976     SET ADDRESS OF PENDING-MAILING-DATA TO
 11977         DFHEIV20
 11978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11979
 11980
 11981     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 11982     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 11983     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 11984
 11985     IF BLSTNML GREATER THAN ZEROS
 11986         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 11987
 11988     IF B1STNML GREATER  THAN ZEROS
 11989         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 223
* EL6311.cbl
 11990
 11991     IF BINITL GREATER THAN ZEROS
 11992         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 11993
 11994     IF BAGEL GREATER THAN ZEROS
 11995         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 11996
 11997     IF BBIRTHL GREATER THAN ZEROS
 11998         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 11999
 12000     IF BSEXL GREATER THAN ZEROS
 12001         MOVE  BSEXI             TO PM-INSURED-SEX.
 12002
 12003
 12004* EXEC CICS REWRITE
 12005*        DATASET (FILE-ID-ERPNDM)
 12006*        FROM    (PENDING-MAILING-DATA)
 12007*    END-EXEC.
 12008     MOVE LENGTH OF
 12009      PENDING-MAILING-DATA
 12010       TO DFHEIV11
 12011*    MOVE '&& L                  %   #00011350' TO DFHEIV0
 12012     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12013     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12014     MOVE X'2020233030303131333530' TO DFHEIV0(25:11)
 12015     CALL 'kxdfhei1' USING DFHEIV0,
 12016           FILE-ID-ERPNDM,
 12017           PENDING-MAILING-DATA,
 12018           DFHEIV11,
 12019           DFHEIV99
 12020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12021
 12022
 12023 1399-EXIT.
 12024     EXIT.
 12025
 12026******************************************************************
 12027*                                                                *
 12028*          D E L E T E   I S S U E   R O U T I N E               *
 12029*                                                                *
 12030******************************************************************
 12031
 12032 1400-DELETE-ISSUE-ROUTINE.
 12033     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12034
 12035     IF BCHGL NOT = ZEROS
 12036        MOVE ER-2196             TO EMI-ERROR
 12037        MOVE AL-UABON            TO BMAINTA
 12038        MOVE -1                  TO BMAINTL
 12039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12040        GO TO 8200-SEND-DATAONLY.
 12041
 12042
 12043* EXEC CICS HANDLE CONDITION
 12044*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12045*    END-EXEC.
 12046*    MOVE '"$I                   ! * #00011374' TO DFHEIV0
 12047     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 224
* EL6311.cbl
 12048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12049     MOVE X'2A20233030303131333734' TO DFHEIV0(25:11)
 12050     CALL 'kxdfhei1' USING DFHEIV0
 12051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12052
 12053
 12054     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12055     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12056     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12057
 12058
 12059* EXEC CICS READ
 12060*        SET     (ADDRESS OF PENDING-BUSINESS)
 12061*        DATASET (FILE-ID-ERPNDB)
 12062*        RIDFLD  (ERPNDB-KEY)
 12063*    END-EXEC.
 12064*    MOVE '&"S        E          (   #00011382' TO DFHEIV0
 12065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12067     MOVE X'2020233030303131333832' TO DFHEIV0(25:11)
 12068     CALL 'kxdfhei1' USING DFHEIV0,
 12069           FILE-ID-ERPNDB,
 12070           DFHEIV20,
 12071           DFHEIV99,
 12072           ERPNDB-KEY,
 12073           DFHEIV99,
 12074           DFHEIV99,
 12075           DFHEIV99
 12076     SET ADDRESS OF PENDING-BUSINESS TO
 12077         DFHEIV20
 12078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12079
 12080
 12081     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12082
 12083     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12084
 12085     IF BSUFIXL NOT = ZEROS
 12086        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12087     ELSE
 12088        MOVE SPACE               TO WS-NEW-SUFFIX.
 12089
 12090     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12091     PERFORM 8600-DEEDIT.
 12092     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12093     MOVE '4'                    TO DC-OPTION-CODE.
 12094     PERFORM 9700-DATE-LINK.
 12095     IF DATE-CONVERSION-ERROR
 12096        MOVE ER-0348             TO EMI-ERROR
 12097        MOVE -1                  TO BEFFDTL
 12098        MOVE AL-UABON            TO BEFFDTA
 12099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100        GO TO 8200-SEND-DATAONLY
 12101     ELSE
 12102        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12103        MOVE AL-UANON            TO BEFFDTA
 12104        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12105
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 225
* EL6311.cbl
 12106
 12107* EXEC CICS HANDLE CONDITION
 12108*         NOTFND    (1490-RECORD-NOT-FOUND)
 12109*    END-EXEC.
 12110*    MOVE '"$I                   ! + #00011413' TO DFHEIV0
 12111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12113     MOVE X'2B20233030303131343133' TO DFHEIV0(25:11)
 12114     CALL 'kxdfhei1' USING DFHEIV0
 12115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12116
 12117
 12118
 12119* EXEC CICS READ
 12120*        SET     (ADDRESS OF PENDING-BUSINESS)
 12121*        DATASET (FILE-ID-ERPNDB)
 12122*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12123*        UPDATE
 12124*    END-EXEC.
 12125*    MOVE '&"S        EU         (   #00011417' TO DFHEIV0
 12126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12127     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12128     MOVE X'2020233030303131343137' TO DFHEIV0(25:11)
 12129     CALL 'kxdfhei1' USING DFHEIV0,
 12130           FILE-ID-ERPNDB,
 12131           DFHEIV20,
 12132           DFHEIV99,
 12133           PI-PREV-CONTROL-PRIMARY,
 12134           DFHEIV99,
 12135           DFHEIV99,
 12136           DFHEIV99
 12137     SET ADDRESS OF PENDING-BUSINESS TO
 12138         DFHEIV20
 12139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12140
 12141
 12142     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12143        MOVE -1                 TO BMAINTL
 12144        MOVE ER-2197            TO EMI-ERROR
 12145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12146        GO TO 8200-SEND-DATAONLY.
 12147
 12148     IF PB-BILLED-DT NOT = LOW-VALUES
 12149        MOVE -1                 TO BMAINTL
 12150        MOVE ER-2129            TO EMI-ERROR
 12151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12152        GO TO 8200-SEND-DATAONLY.
 12153
 12154     IF PB-CHG-COUNT NOT = ZEROS
 12155        MOVE ER-2336            TO EMI-ERROR
 12156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12157        MOVE AL-UABON            TO BMAINTA
 12158        MOVE -1                  TO BMAINTL
 12159        GO TO 8200-SEND-DATAONLY.
 12160
 12161     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12162        PB-CHG-COUNT NOT = ZEROS
 12163        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 226
* EL6311.cbl
 12164        MOVE AL-UABON            TO BMAINTA
 12165        MOVE -1                  TO BMAINTL
 12166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12167        GO TO 8200-SEND-DATAONLY.
 12168******************************************************************
 12169*                                                                *
 12170*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12171*                                                                *
 12172******************************************************************
 12173     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12174     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12175     MOVE +0                     TO ELCRTO-SEQ-NO
 12176
 12177* EXEC CICS READ
 12178*       DATASET   ('ELCRTO')
 12179*       INTO      (ORIGINAL-CERTIFICATE)
 12180*       RIDFLD    (ELCRTO-KEY)
 12181*       GTEQ
 12182*       RESP      (WS-RESPONSE)
 12183*    END-EXEC
 12184     MOVE LENGTH OF
 12185      ORIGINAL-CERTIFICATE
 12186       TO DFHEIV11
 12187     MOVE 'ELCRTO' TO DFHEIV1
 12188*    MOVE '&"IL       G          (  N#00011458' TO DFHEIV0
 12189     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12191     MOVE X'204E233030303131343538' TO DFHEIV0(25:11)
 12192     CALL 'kxdfhei1' USING DFHEIV0,
 12193           DFHEIV1,
 12194           ORIGINAL-CERTIFICATE,
 12195           DFHEIV11,
 12196           ELCRTO-KEY,
 12197           DFHEIV99,
 12198           DFHEIV99,
 12199           DFHEIV99
 12200     MOVE EIBRESP  TO WS-RESPONSE
 12201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12202     IF RESP-NORMAL
 12203        AND (OC-CONTROL-PRIMARY (1:33) =
 12204                 PB-CONTROL-BY-ACCOUNT (1:33))
 12205        AND (OC-RECORD-TYPE = 'I')
 12206
 12207* EXEC CICS READ
 12208*          DATASET   ('ELCRTO')
 12209*          INTO      (ORIGINAL-CERTIFICATE)
 12210*          RIDFLD    (ELCRTO-KEY)
 12211*          UPDATE
 12212*          RESP      (WS-RESPONSE)
 12213*       END-EXEC
 12214     MOVE LENGTH OF
 12215      ORIGINAL-CERTIFICATE
 12216       TO DFHEIV11
 12217     MOVE 'ELCRTO' TO DFHEIV1
 12218*    MOVE '&"IL       EU         (  N#00011469' TO DFHEIV0
 12219     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12220     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12221     MOVE X'204E233030303131343639' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 227
* EL6311.cbl
 12222     CALL 'kxdfhei1' USING DFHEIV0,
 12223           DFHEIV1,
 12224           ORIGINAL-CERTIFICATE,
 12225           DFHEIV11,
 12226           ELCRTO-KEY,
 12227           DFHEIV99,
 12228           DFHEIV99,
 12229           DFHEIV99
 12230     MOVE EIBRESP  TO WS-RESPONSE
 12231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12232        IF RESP-NORMAL
 12233
 12234* EXEC CICS DELETE
 12235*             DATASET   ('ELCRTO')
 12236*          END-EXEC
 12237     MOVE 'ELCRTO' TO DFHEIV1
 12238*    MOVE '&(                    &   #00011477' TO DFHEIV0
 12239     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12240     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12241     MOVE X'2020233030303131343737' TO DFHEIV0(25:11)
 12242     CALL 'kxdfhei1' USING DFHEIV0,
 12243           DFHEIV1,
 12244           DFHEIV99,
 12245           DFHEIV99,
 12246           DFHEIV99,
 12247           DFHEIV99
 12248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12249        END-IF
 12250     END-IF
 12251******************************************************************
 12252*                                                                *
 12253*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12254*                                                                *
 12255******************************************************************
 12256
 12257* EXEC CICS HANDLE CONDITION
 12258*        NOTFND    (1405-DELETE-CERTIFICATE)
 12259*    END-EXEC.
 12260*    MOVE '"$I                   ! , #00011487' TO DFHEIV0
 12261     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12263     MOVE X'2C20233030303131343837' TO DFHEIV0(25:11)
 12264     CALL 'kxdfhei1' USING DFHEIV0
 12265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12266
 12267
 12268
 12269* EXEC CICS READ
 12270*        EQUAL
 12271*        DATASET   (FILE-ID-ERPNDM)
 12272*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12273*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12274*        UPDATE
 12275*    END-EXEC.
 12276*    MOVE '&"S        EU         (   #00011491' TO DFHEIV0
 12277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12278     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12279     MOVE X'2020233030303131343931' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 228
* EL6311.cbl
 12280     CALL 'kxdfhei1' USING DFHEIV0,
 12281           FILE-ID-ERPNDM,
 12282           DFHEIV20,
 12283           DFHEIV99,
 12284           PI-PREV-CONTROL-PRIMARY,
 12285           DFHEIV99,
 12286           DFHEIV99,
 12287           DFHEIV99
 12288     SET ADDRESS OF PENDING-MAILING-DATA TO
 12289         DFHEIV20
 12290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12291
 12292
 12293     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12294     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12295     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12296
 12297     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12298
 12299
 12300* EXEC CICS DELETE
 12301*        DATASET   (FILE-ID-ERPNDM)
 12302*    END-EXEC.
 12303*    MOVE '&(                    &   #00011505' TO DFHEIV0
 12304     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12306     MOVE X'2020233030303131353035' TO DFHEIV0(25:11)
 12307     CALL 'kxdfhei1' USING DFHEIV0,
 12308           FILE-ID-ERPNDM,
 12309           DFHEIV99,
 12310           DFHEIV99,
 12311           DFHEIV99,
 12312           DFHEIV99
 12313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12314
 12315
 12316******************************************************************
 12317*                PROCESS   CERTIFICATE                           *
 12318******************************************************************
 12319
 12320 1405-DELETE-CERTIFICATE.
 12321
 12322* EXEC CICS HANDLE CONDITION
 12323*         NOTFND  (1420-CONTINUE-DELETE)
 12324*    END-EXEC.
 12325*    MOVE '"$I                   ! - #00011514' TO DFHEIV0
 12326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12328     MOVE X'2D20233030303131353134' TO DFHEIV0(25:11)
 12329     CALL 'kxdfhei1' USING DFHEIV0
 12330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12331
 12332
 12333     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12334     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12335     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12336     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12337
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 229
* EL6311.cbl
 12338
 12339* EXEC CICS READ
 12340*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12341*        DATASET (FILE-ID-ELCERT)
 12342*        RIDFLD  (ELCERT-KEY)
 12343*        UPDATE
 12344*    END-EXEC.
 12345*    MOVE '&"S        EU         (   #00011523' TO DFHEIV0
 12346     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12348     MOVE X'2020233030303131353233' TO DFHEIV0(25:11)
 12349     CALL 'kxdfhei1' USING DFHEIV0,
 12350           FILE-ID-ELCERT,
 12351           DFHEIV20,
 12352           DFHEIV99,
 12353           ELCERT-KEY,
 12354           DFHEIV99,
 12355           DFHEIV99,
 12356           DFHEIV99
 12357     SET ADDRESS OF CERTIFICATE-MASTER TO
 12358         DFHEIV20
 12359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12360
 12361
 12362     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12363
 12364     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12365     MOVE 'B'                    TO JP-RECORD-TYPE
 12366     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12367
 12368     PERFORM 8400-LOG-JOURNAL-RECORD.
 12369
 12370     IF CERT-NOTES-ARE-NOT-PRESENT
 12371        MOVE ' '                 TO WS-CERT-NOTE-SW
 12372     ELSE
 12373        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12374
 12375     IF INSURED-ADDR-PRESENT
 12376        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12377
 12378******************************************************************
 12379******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12380******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12381******************************************************************
 12382******************************************************************
 12383
 12384     IF CERT-ADDED-BATCH AND
 12385        (NOT NO-CLAIM-ATTACHED
 12386         OR
 12387         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12388        GO TO 1410-REWRITE-CERT.
 12389
 12390******************************************************************
 12391******************************************************************
 12392
 12393     IF CERT-ADDED-BATCH  AND
 12394        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12395        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 230
* EL6311.cbl
 12396
 12397     IF NO-CLAIM-ATTACHED
 12398        NEXT SENTENCE
 12399     ELSE
 12400        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12401        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12402        GO TO 1410-REWRITE-CERT.
 12403
 12404     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12405     MOVE 'D'                      TO JP-RECORD-TYPE.
 12406     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12407
 12408
 12409* EXEC CICS DELETE
 12410*         DATASET    (FILE-ID-ELCERT)
 12411*    END-EXEC.
 12412*    MOVE '&(                    &   #00011576' TO DFHEIV0
 12413     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12415     MOVE X'2020233030303131353736' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           FILE-ID-ELCERT,
 12418           DFHEIV99,
 12419           DFHEIV99,
 12420           DFHEIV99,
 12421           DFHEIV99
 12422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12423
 12424
 12425     PERFORM 8400-LOG-JOURNAL-RECORD.
 12426
 12427******************************************************************
 12428*                                                                *
 12429*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12430*                                                                *
 12431******************************************************************
 12432
 12433     IF  CERT-NOTES-ARE-PRESENT
 12434         NEXT SENTENCE
 12435     ELSE
 12436         GO TO 1407-DELETE-MAILING.
 12437
 12438
 12439* EXEC CICS HANDLE CONDITION
 12440*         NOTFND  (1406-DELETE-ERNOTE)
 12441*    END-EXEC.
 12442*    MOVE '"$I                   ! . #00011593' TO DFHEIV0
 12443     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12445     MOVE X'2E20233030303131353933' TO DFHEIV0(25:11)
 12446     CALL 'kxdfhei1' USING DFHEIV0
 12447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12448
 12449
 12450     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12451     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12452     MOVE 0                     TO ERCNOT-SEQUENCE.
 12453
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 231
* EL6311.cbl
 12454 1406-DELETE-ERCNOT-LOOP.
 12455
 12456
 12457* EXEC CICS READ
 12458*        GTEQ
 12459*        DATASET   (FILE-ID-ERCNOT)
 12460*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12461*        RIDFLD    (ERCNOT-KEY)
 12462*    END-EXEC.
 12463*    MOVE '&"S        G          (   #00011603' TO DFHEIV0
 12464     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12465     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12466     MOVE X'2020233030303131363033' TO DFHEIV0(25:11)
 12467     CALL 'kxdfhei1' USING DFHEIV0,
 12468           FILE-ID-ERCNOT,
 12469           DFHEIV20,
 12470           DFHEIV99,
 12471           ERCNOT-KEY,
 12472           DFHEIV99,
 12473           DFHEIV99,
 12474           DFHEIV99
 12475     SET ADDRESS OF CERT-NOTE-FILE TO
 12476         DFHEIV20
 12477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12478
 12479
 12480     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12481     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12482         GO TO 1406-DELETE-ERNOTE
 12483     END-IF.
 12484
 12485     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12486     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12487     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12488
 12489     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12490
 12491
 12492* EXEC CICS DELETE
 12493*        DATASET   (FILE-ID-ERCNOT)
 12494*        RIDFLD    (ERCNOT-KEY)
 12495*        END-EXEC.
 12496*    MOVE '&(  R                 &   #00011621' TO DFHEIV0
 12497     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12499     MOVE X'2020233030303131363231' TO DFHEIV0(25:11)
 12500     CALL 'kxdfhei1' USING DFHEIV0,
 12501           FILE-ID-ERCNOT,
 12502           ERCNOT-KEY,
 12503           DFHEIV99,
 12504           DFHEIV99,
 12505           DFHEIV99
 12506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12507
 12508
 12509     PERFORM 8400-LOG-JOURNAL-RECORD.
 12510
 12511     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 232
* EL6311.cbl
 12512
 12513 1406-DELETE-ERNOTE.
 12514
 12515
 12516* EXEC CICS HANDLE CONDITION
 12517*         NOTFND  (1407-DELETE-MAILING)
 12518*    END-EXEC.
 12519*    MOVE '"$I                   ! / #00011632' TO DFHEIV0
 12520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12522     MOVE X'2F20233030303131363332' TO DFHEIV0(25:11)
 12523     CALL 'kxdfhei1' USING DFHEIV0
 12524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12525
 12526
 12527
 12528* EXEC CICS READ
 12529*        EQUAL
 12530*        DATASET   (FILE-ID-ERNOTE)
 12531*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12532*        RIDFLD    (ELCERT-KEY)
 12533*        UPDATE
 12534*    END-EXEC.
 12535*    MOVE '&"S        EU         (   #00011636' TO DFHEIV0
 12536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12537     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12538     MOVE X'2020233030303131363336' TO DFHEIV0(25:11)
 12539     CALL 'kxdfhei1' USING DFHEIV0,
 12540           FILE-ID-ERNOTE,
 12541           DFHEIV20,
 12542           DFHEIV99,
 12543           ELCERT-KEY,
 12544           DFHEIV99,
 12545           DFHEIV99,
 12546           DFHEIV99
 12547     SET ADDRESS OF CERTIFICATE-NOTE TO
 12548         DFHEIV20
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12553     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12554     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12555
 12556     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12557
 12558
 12559* EXEC CICS DELETE
 12560*        DATASET   (FILE-ID-ERNOTE)
 12561*        END-EXEC.
 12562*    MOVE '&(                    &   #00011650' TO DFHEIV0
 12563     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12565     MOVE X'2020233030303131363530' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0,
 12567           FILE-ID-ERNOTE,
 12568           DFHEIV99,
 12569           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 233
* EL6311.cbl
 12570           DFHEIV99,
 12571           DFHEIV99
 12572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12573
 12574
 12575     PERFORM 8400-LOG-JOURNAL-RECORD.
 12576
 12577******************************************************************
 12578*                                                                *
 12579*                DELETE MAILING ADDRESS RECORDS                  *
 12580*                                                                *
 12581******************************************************************
 12582
 12583 1407-DELETE-MAILING.
 12584     IF CERT-ADDRESS-PRESENT
 12585        NEXT SENTENCE
 12586     ELSE
 12587        GO TO 1420-CONTINUE-DELETE.
 12588
 12589
 12590* EXEC CICS HANDLE CONDITION
 12591*         NOTFND  (1420-CONTINUE-DELETE)
 12592*    END-EXEC.
 12593*    MOVE '"$I                   ! 0 #00011668' TO DFHEIV0
 12594     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12596     MOVE X'3020233030303131363638' TO DFHEIV0(25:11)
 12597     CALL 'kxdfhei1' USING DFHEIV0
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12599
 12600
 12601
 12602* EXEC CICS READ
 12603*        EQUAL
 12604*        DATASET   (FILE-ID-ERMAIL)
 12605*        SET       (ADDRESS OF MAILING-DATA)
 12606*        RIDFLD    (ELCERT-KEY)
 12607*        UPDATE
 12608*    END-EXEC.
 12609*    MOVE '&"S        EU         (   #00011672' TO DFHEIV0
 12610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12611     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12612     MOVE X'2020233030303131363732' TO DFHEIV0(25:11)
 12613     CALL 'kxdfhei1' USING DFHEIV0,
 12614           FILE-ID-ERMAIL,
 12615           DFHEIV20,
 12616           DFHEIV99,
 12617           ELCERT-KEY,
 12618           DFHEIV99,
 12619           DFHEIV99,
 12620           DFHEIV99
 12621     SET ADDRESS OF MAILING-DATA TO
 12622         DFHEIV20
 12623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12624
 12625
 12626     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12627     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 234
* EL6311.cbl
 12628     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12629
 12630     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12631
 12632
 12633* EXEC CICS DELETE
 12634*        DATASET   (FILE-ID-ERMAIL)
 12635*    END-EXEC.
 12636*    MOVE '&(                    &   #00011686' TO DFHEIV0
 12637     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12638     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12639     MOVE X'2020233030303131363836' TO DFHEIV0(25:11)
 12640     CALL 'kxdfhei1' USING DFHEIV0,
 12641           FILE-ID-ERMAIL,
 12642           DFHEIV99,
 12643           DFHEIV99,
 12644           DFHEIV99,
 12645           DFHEIV99
 12646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12647
 12648
 12649     GO TO 1420-CONTINUE-DELETE.
 12650
 12651 1410-REWRITE-CERT.
 12652     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12653     MOVE 'C'                      TO JP-RECORD-TYPE.
 12654     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12655     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12656
 12657
 12658* EXEC CICS REWRITE
 12659*         DATASET    (FILE-ID-ELCERT)
 12660*         FROM       (CERTIFICATE-MASTER)
 12661*         END-EXEC.
 12662     MOVE LENGTH OF
 12663      CERTIFICATE-MASTER
 12664       TO DFHEIV11
 12665*    MOVE '&& L                  %   #00011698' TO DFHEIV0
 12666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12668     MOVE X'2020233030303131363938' TO DFHEIV0(25:11)
 12669     CALL 'kxdfhei1' USING DFHEIV0,
 12670           FILE-ID-ELCERT,
 12671           CERTIFICATE-MASTER,
 12672           DFHEIV11,
 12673           DFHEIV99
 12674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12675
 12676
 12677     PERFORM 8400-LOG-JOURNAL-RECORD.
 12678
 12679 1420-CONTINUE-DELETE.
 12680     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12681     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12682
 12683     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12684     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12685
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 235
* EL6311.cbl
 12686     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12687
 12688 1450-DELETE-PB-RECORD.
 12689     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12690     MOVE 'D'                      TO JP-RECORD-TYPE
 12691     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12692
 12693
 12694* EXEC CICS DELETE
 12695*        DATASET    (FILE-ID-ERPNDB)
 12696*    END-EXEC.
 12697*    MOVE '&(                    &   #00011719' TO DFHEIV0
 12698     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12700     MOVE X'2020233030303131373139' TO DFHEIV0(25:11)
 12701     CALL 'kxdfhei1' USING DFHEIV0,
 12702           FILE-ID-ERPNDB,
 12703           DFHEIV99,
 12704           DFHEIV99,
 12705           DFHEIV99,
 12706           DFHEIV99
 12707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12708
 12709
 12710     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12711
 12712     PERFORM 8400-LOG-JOURNAL-RECORD.
 12713
 12714     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12715     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12716     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12717
 12718
 12719* EXEC CICS HANDLE CONDITION
 12720*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12721*    END-EXEC.
 12722*    MOVE '"$I                   ! 1 #00011731' TO DFHEIV0
 12723     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12725     MOVE X'3120233030303131373331' TO DFHEIV0(25:11)
 12726     CALL 'kxdfhei1' USING DFHEIV0
 12727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12728
 12729
 12730
 12731* EXEC CICS READ
 12732*        SET     (ADDRESS OF PENDING-BUSINESS)
 12733*        DATASET (FILE-ID-ERPNDB)
 12734*        RIDFLD  (ERPNDB-KEY)
 12735*        UPDATE
 12736*    END-EXEC.
 12737*    MOVE '&"S        EU         (   #00011735' TO DFHEIV0
 12738     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12739     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12740     MOVE X'2020233030303131373335' TO DFHEIV0(25:11)
 12741     CALL 'kxdfhei1' USING DFHEIV0,
 12742           FILE-ID-ERPNDB,
 12743           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 236
* EL6311.cbl
 12744           DFHEIV99,
 12745           ERPNDB-KEY,
 12746           DFHEIV99,
 12747           DFHEIV99,
 12748           DFHEIV99
 12749     SET ADDRESS OF PENDING-BUSINESS TO
 12750         DFHEIV20
 12751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12752
 12753
 12754     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12755
 12756     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12757
 12758     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12759        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12760        MOVE 'D'                   TO JP-RECORD-TYPE
 12761        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12762
 12763* EXEC CICS DELETE
 12764*            DATASET    (FILE-ID-ERPNDB)
 12765*       END-EXEC
 12766*    MOVE '&(                    &   #00011750' TO DFHEIV0
 12767     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12768     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12769     MOVE X'2020233030303131373530' TO DFHEIV0(25:11)
 12770     CALL 'kxdfhei1' USING DFHEIV0,
 12771           FILE-ID-ERPNDB,
 12772           DFHEIV99,
 12773           DFHEIV99,
 12774           DFHEIV99,
 12775           DFHEIV99
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12777        PERFORM 8400-LOG-JOURNAL-RECORD
 12778     ELSE
 12779        MOVE 'B'                 TO JP-RECORD-TYPE
 12780        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12781        PERFORM 8400-LOG-JOURNAL-RECORD
 12782        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12783        MOVE 'C'                 TO JP-RECORD-TYPE
 12784        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12785
 12786* EXEC CICS REWRITE
 12787*            DATASET    (FILE-ID-ERPNDB)
 12788*            FROM       (PENDING-BUSINESS)
 12789*       END-EXEC
 12790     MOVE LENGTH OF
 12791      PENDING-BUSINESS
 12792       TO DFHEIV11
 12793*    MOVE '&& L                  %   #00011761' TO DFHEIV0
 12794     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12795     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12796     MOVE X'2020233030303131373631' TO DFHEIV0(25:11)
 12797     CALL 'kxdfhei1' USING DFHEIV0,
 12798           FILE-ID-ERPNDB,
 12799           PENDING-BUSINESS,
 12800           DFHEIV11,
 12801           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 237
* EL6311.cbl
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12803        PERFORM 8400-LOG-JOURNAL-RECORD.
 12804
 12805******************************************************************
 12806*                                                                *
 12807*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12808*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12809*                                                                *
 12810******************************************************************
 12811
 12812     IF NOT PI-AR-PROCESSING
 12813        GO TO 1475-DELETE-FINISHED.
 12814
 12815     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12816        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12817        NEXT SENTENCE
 12818     ELSE
 12819        GO TO 1475-DELETE-FINISHED.
 12820
 12821
 12822* EXEC CICS HANDLE CONDITION
 12823*         NOTFND    (1475-DELETE-FINISHED)
 12824*         END-EXEC.
 12825*    MOVE '"$I                   ! 2 #00011783' TO DFHEIV0
 12826     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12827     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12828     MOVE X'3220233030303131373833' TO DFHEIV0(25:11)
 12829     CALL 'kxdfhei1' USING DFHEIV0
 12830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12831
 12832
 12833     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12834     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12835
 12836
 12837* EXEC CICS READ
 12838*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12839*        DATASET (FILE-ID-ERRQST)
 12840*        RIDFLD  (ERRQST-KEY)
 12841*        UPDATE
 12842*    END-EXEC.
 12843*    MOVE '&"S        EU         (   #00011790' TO DFHEIV0
 12844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303131373930' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           FILE-ID-ERRQST,
 12849           DFHEIV20,
 12850           DFHEIV99,
 12851           ERRQST-KEY,
 12852           DFHEIV99,
 12853           DFHEIV99,
 12854           DFHEIV99
 12855     SET ADDRESS OF AR-REQUEST-RECORD TO
 12856         DFHEIV20
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 238
* EL6311.cbl
 12860     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12861
 12862     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12863
 12864     MOVE 'D'                      TO JP-RECORD-TYPE.
 12865     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12866
 12867
 12868* EXEC CICS DELETE
 12869*         DATASET    (FILE-ID-ERRQST)
 12870*    END-EXEC.
 12871*    MOVE '&(                    &   #00011804' TO DFHEIV0
 12872     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12873     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12874     MOVE X'2020233030303131383034' TO DFHEIV0(25:11)
 12875     CALL 'kxdfhei1' USING DFHEIV0,
 12876           FILE-ID-ERRQST,
 12877           DFHEIV99,
 12878           DFHEIV99,
 12879           DFHEIV99,
 12880           DFHEIV99
 12881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12882
 12883
 12884     PERFORM 8400-LOG-JOURNAL-RECORD.
 12885
 12886 1475-DELETE-FINISHED.
 12887     MOVE ZEROS                  TO EMI-ERROR.
 12888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12889     MOVE LOW-VALUES             TO EL631BI.
 12890     MOVE -1                     TO BMAINTL.
 12891     GO TO 8100-SEND-INITIAL-MAP.
 12892
 12893 1480-BATCH-HDR-NOT-FOUND.
 12894     MOVE -1                     TO BMAINTL.
 12895     MOVE ER-7450                TO EMI-ERROR.
 12896     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12897     GO TO 8200-SEND-DATAONLY.
 12898
 12899 1490-RECORD-NOT-FOUND.
 12900     MOVE -1                     TO BMAINTL.
 12901     MOVE ER-7451                TO EMI-ERROR.
 12902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12903     GO TO 8200-SEND-DATAONLY.
 12904
 12905******************************************************************
 12906*            O V E R   C H A R G E   P R O C E S S I N G         *
 12907******************************************************************
 12908 1500-UPDATE-ERNOTE.
 12909     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12910     MOVE 'A'                    TO WS-NOTE-SW
 12911     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12912     .
 12913 1500-EXIT.
 12914     EXIT.
 12915 1510-ADD-ERNOTE-REC.
 12916
 12917* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 239
* EL6311.cbl
 12918*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12919*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12920*        INITIMG (GETMAIN-SPACE)
 12921*    END-EXEC
 12922*    MOVE ',"IL                  $   #00011840' TO DFHEIV0
 12923     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12924     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12925     MOVE X'2020233030303131383430' TO DFHEIV0(25:11)
 12926     CALL 'kxdfhei1' USING DFHEIV0,
 12927           DFHEIV20,
 12928           ERNOTE-RECORD-LENGTH,
 12929           GETMAIN-SPACE
 12930     SET ADDRESS OF CERTIFICATE-NOTE TO
 12931         DFHEIV20
 12932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12933     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12934                                 TO ERNOTE-KEY
 12935
 12936* EXEC CICS READ
 12937*       DATASET    (FILE-ID-ERNOTE)
 12938*       RIDFLD     (ERNOTE-KEY)
 12939*       INTO       (CERTIFICATE-NOTE)
 12940*       RESP       (WS-RESPONSE)
 12941*       UPDATE
 12942*    END-EXEC
 12943     MOVE LENGTH OF
 12944      CERTIFICATE-NOTE
 12945       TO DFHEIV11
 12946*    MOVE '&"IL       EU         (  N#00011847' TO DFHEIV0
 12947     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12948     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12949     MOVE X'204E233030303131383437' TO DFHEIV0(25:11)
 12950     CALL 'kxdfhei1' USING DFHEIV0,
 12951           FILE-ID-ERNOTE,
 12952           CERTIFICATE-NOTE,
 12953           DFHEIV11,
 12954           ERNOTE-KEY,
 12955           DFHEIV99,
 12956           DFHEIV99,
 12957           DFHEIV99
 12958     MOVE EIBRESP  TO WS-RESPONSE
 12959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12960     IF RESP-NORMAL
 12961        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12962           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12963        END-IF
 12964        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12965           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12966        END-IF
 12967        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 12968           (N1 > +10)
 12969           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12970           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12971        END-PERFORM
 12972        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12973          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12974
 12975* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 240
* EL6311.cbl
 12976*            DATASET    (FILE-ID-ERNOTE)
 12977*          END-EXEC
 12978*    MOVE '&*                    #   #00011868' TO DFHEIV0
 12979     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12981     MOVE X'2020233030303131383638' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0,
 12983           FILE-ID-ERNOTE,
 12984           DFHEIV99
 12985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12986        ELSE
 12987          PERFORM VARYING N1 FROM +1 BY +1
 12988           UNTIL (N1 > +10)
 12989           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 12990          END-PERFORM
 12991          IF (N1 < +11)
 12992            IF N1 >= CN-BILLING-START-LINE-NO AND
 12993              N1 <= CN-BILLING-END-LINE-NO
 12994              IF PI-COMPANY-ID = 'DCC'
 12995                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12996              ELSE
 12997                 MOVE WS-VA-NO-COMM-MESS
 12998                                    TO CN-LINE (N1)
 12999              END-IF
 13000            ELSE
 13001              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13002               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13003                IF PI-COMPANY-ID = 'DCC'
 13004                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13005                ELSE
 13006                  MOVE WS-VA-NO-COMM-MESS
 13007                                    TO CN-LINE (N1)
 13008                END-IF
 13009                MOVE N1             TO CN-BILLING-END-LINE-NO
 13010              ELSE
 13011                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13012                  IF PI-COMPANY-ID = 'DCC'
 13013                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13014                  ELSE
 13015                     MOVE WS-VA-NO-COMM-MESS
 13016                                    TO CN-LINE (N1)
 13017                  END-IF
 13018                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13019                                      CN-BILLING-START-LINE-NO
 13020                ELSE
 13021                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13022                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13023                     IF PI-COMPANY-ID = 'DCC'
 13024                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13025                     ELSE
 13026                       MOVE WS-VA-NO-COMM-MESS
 13027                                    TO CN-LINE (N1)
 13028                     END-IF
 13029                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13030                  ELSE
 13031                     PERFORM 1700-SQUEEZE-IT-IN
 13032                                 THRU 1700-EXIT
 13033                  END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 241
* EL6311.cbl
 13034                END-IF
 13035              END-IF
 13036            END-IF
 13037            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13038            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13039            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13040
 13041* EXEC CICS REWRITE
 13042*              DATASET    (FILE-ID-ERNOTE)
 13043*              FROM       (CERTIFICATE-NOTE)
 13044*              RESP       (WS-RESPONSE)
 13045*           END-EXEC
 13046     MOVE LENGTH OF
 13047      CERTIFICATE-NOTE
 13048       TO DFHEIV11
 13049*    MOVE '&& L                  %  N#00011925' TO DFHEIV0
 13050     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13051     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13052     MOVE X'204E233030303131393235' TO DFHEIV0(25:11)
 13053     CALL 'kxdfhei1' USING DFHEIV0,
 13054           FILE-ID-ERNOTE,
 13055           CERTIFICATE-NOTE,
 13056           DFHEIV11,
 13057           DFHEIV99
 13058     MOVE EIBRESP  TO WS-RESPONSE
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13060          END-IF
 13061        END-IF
 13062     ELSE
 13063        MOVE SPACES              TO CERTIFICATE-NOTE
 13064        MOVE 'CN'                TO CN-RECORD-ID
 13065        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13066                                 TO CN-CONTROL-PRIMARY
 13067                                    ERNOTE-KEY
 13068        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13069                                    CN-BILLING-END-LINE-NO
 13070        IF PI-COMPANY-ID = 'DCC'
 13071           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13072        ELSE
 13073           MOVE WS-VA-NO-COMM-MESS
 13074                                 TO CN-LINE (1)
 13075        END-IF
 13076        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13077        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13078        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13079
 13080* EXEC CICS WRITE
 13081*          DATASET    (FILE-ID-ERNOTE)
 13082*          FROM       (CERTIFICATE-NOTE)
 13083*          RIDFLD     (ERNOTE-KEY)
 13084*          RESP       (WS-RESPONSE)
 13085*       END-EXEC
 13086     MOVE LENGTH OF
 13087      CERTIFICATE-NOTE
 13088       TO DFHEIV11
 13089*    MOVE '&$ L                  ''  N#00011949' TO DFHEIV0
 13090     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 242
* EL6311.cbl
 13092     MOVE X'204E233030303131393439' TO DFHEIV0(25:11)
 13093     CALL 'kxdfhei1' USING DFHEIV0,
 13094           FILE-ID-ERNOTE,
 13095           CERTIFICATE-NOTE,
 13096           DFHEIV11,
 13097           ERNOTE-KEY,
 13098           DFHEIV99,
 13099           DFHEIV99
 13100     MOVE EIBRESP  TO WS-RESPONSE
 13101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13102     END-IF
 13103     .
 13104 1510-EXIT.
 13105     EXIT.
 13106 1520-UPDATE-ELCERT.
 13107     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13108                                 TO ELCERT-KEY
 13109
 13110* EXEC CICS READ
 13111*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13112*        DATASET (FILE-ID-ELCERT)
 13113*        RIDFLD  (ELCERT-KEY)
 13114*        UPDATE
 13115*        RESP    (WS-RESPONSE)
 13116*    END-EXEC
 13117*    MOVE '&"S        EU         (  N#00011962' TO DFHEIV0
 13118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13119     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13120     MOVE X'204E233030303131393632' TO DFHEIV0(25:11)
 13121     CALL 'kxdfhei1' USING DFHEIV0,
 13122           FILE-ID-ELCERT,
 13123           DFHEIV20,
 13124           DFHEIV99,
 13125           ELCERT-KEY,
 13126           DFHEIV99,
 13127           DFHEIV99,
 13128           DFHEIV99
 13129     SET ADDRESS OF CERTIFICATE-MASTER TO
 13130         DFHEIV20
 13131     MOVE EIBRESP  TO WS-RESPONSE
 13132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13133     IF RESP-NORMAL
 13134        IF WS-NOTE-SW = 'A'
 13135           IF CM-NOTE-SW = ' '
 13136              MOVE '2'             TO CM-NOTE-SW
 13137           ELSE
 13138             IF CM-NOTE-SW = '1'
 13139                MOVE '3'           TO CM-NOTE-SW
 13140             ELSE
 13141               IF CM-NOTE-SW = '4'
 13142                  MOVE '6'         TO CM-NOTE-SW
 13143               ELSE
 13144                 IF CM-NOTE-SW = '5'
 13145                    MOVE '7'       TO CM-NOTE-SW
 13146                 END-IF
 13147               END-IF
 13148             END-IF
 13149           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 243
* EL6311.cbl
 13150        ELSE
 13151           IF CM-NOTE-SW = '2'
 13152              MOVE ' '             TO CM-NOTE-SW
 13153           ELSE
 13154             IF CM-NOTE-SW = '3'
 13155                MOVE '1'           TO CM-NOTE-SW
 13156             ELSE
 13157               IF CM-NOTE-SW = '6'
 13158                  MOVE '4'         TO CM-NOTE-SW
 13159               ELSE
 13160                 IF CM-NOTE-SW = '7'
 13161                    MOVE '5'       TO CM-NOTE-SW
 13162                 END-IF
 13163               END-IF
 13164             END-IF
 13165           END-IF
 13166        END-IF
 13167
 13168* EXEC CICS REWRITE
 13169*          DATASET    (FILE-ID-ELCERT)
 13170*          FROM       (CERTIFICATE-MASTER)
 13171*          RESP       (WS-RESPONSE)
 13172*       END-EXEC
 13173     MOVE LENGTH OF
 13174      CERTIFICATE-MASTER
 13175       TO DFHEIV11
 13176*    MOVE '&& L                  %  N#00012003' TO DFHEIV0
 13177     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13178     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13179     MOVE X'204E233030303132303033' TO DFHEIV0(25:11)
 13180     CALL 'kxdfhei1' USING DFHEIV0,
 13181           FILE-ID-ELCERT,
 13182           CERTIFICATE-MASTER,
 13183           DFHEIV11,
 13184           DFHEIV99
 13185     MOVE EIBRESP  TO WS-RESPONSE
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13187        IF RESP-NORMAL
 13188           CONTINUE
 13189        ELSE
 13190           MOVE WS-RESPONSE TO EMI-ERROR
 13191           PERFORM 9900-ERROR-FORMAT
 13192                                 THRU 9900-EXIT
 13193           GO TO 8200-SEND-DATAONLY
 13194        END-IF
 13195     ELSE
 13196        MOVE -1                  TO BMAINTL
 13197        MOVE 0249                TO EMI-ERROR
 13198        PERFORM 9900-ERROR-FORMAT
 13199                                 THRU 9900-EXIT
 13200        GO TO 8200-SEND-DATAONLY
 13201     END-IF
 13202     .
 13203 1520-EXIT.
 13204     EXIT.
 13205 1600-UPDATE-ERPYAJ.
 13206     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13207                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 244
* EL6311.cbl
 13208     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13209                                 THRU 1620-EXIT
 13210     .
 13211 1600-EXIT.
 13212     EXIT.
 13213 1610-ADD-ERPYAJ-BANK-REC.
 13214
 13215* EXEC CICS GETMAIN
 13216*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13217*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13218*        INITIMG (GETMAIN-SPACE)
 13219*    END-EXEC
 13220*    MOVE ',"IL                  $   #00012035' TO DFHEIV0
 13221     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13223     MOVE X'2020233030303132303335' TO DFHEIV0(25:11)
 13224     CALL 'kxdfhei1' USING DFHEIV0,
 13225           DFHEIV20,
 13226           ERPYAJ-RECORD-LENGTH,
 13227           GETMAIN-SPACE
 13228     SET ADDRESS OF PENDING-PAY-ADJ TO
 13229         DFHEIV20
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13231     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13232     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13233     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13234     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13235     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13236     MOVE +10                    TO ERPYAJ-SEQ-NO
 13237     MOVE 'R'                    TO ERPYAJ-TYPE
 13238     IF REVERSAL
 13239        MOVE 'C'                 TO ERPYAJ-TYPE
 13240     END-IF
 13241     MOVE SPACES                 TO PENDING-PAY-ADJ
 13242     MOVE 'PY'                   TO PY-RECORD-ID
 13243     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13244     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13245     IF REVERSAL
 13246        MOVE PB-I-DCC-OVER-CHG-AMT
 13247                                 TO PY-ENTRY-AMT
 13248     END-IF
 13249     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13250                                    PY-INPUT-DT
 13251*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13252*                                   PY-INPUT-DT
 13253     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13254     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13255     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13256     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13257     IF PB-CARRIER = '2'
 13258        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13259     ELSE
 13260        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13261     END-IF
 13262     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13263                                    PY-BILLED-DATE
 13264                                    PY-AR-DATE
 13265                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 245
* EL6311.cbl
 13266                                    PY-CHECK-WRITTEN-DT
 13267     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13268                                    PY-CHECK-QUE-SEQUENCE
 13269     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13270     PERFORM WITH TEST AFTER
 13271        UNTIL (NOT RESP-DUPKEY)
 13272           AND (NOT RESP-DUPREC)
 13273
 13274* EXEC CICS WRITE
 13275*          DATASET    (FILE-ID-ERPYAJ)
 13276*          FROM       (PENDING-PAY-ADJ)
 13277*          RIDFLD     (ERPYAJ-KEY)
 13278*          RESP       (WS-RESPONSE)
 13279*       END-EXEC
 13280     MOVE LENGTH OF
 13281      PENDING-PAY-ADJ
 13282       TO DFHEIV11
 13283*    MOVE '&$ L                  ''  N#00012082' TO DFHEIV0
 13284     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13286     MOVE X'204E233030303132303832' TO DFHEIV0(25:11)
 13287     CALL 'kxdfhei1' USING DFHEIV0,
 13288           FILE-ID-ERPYAJ,
 13289           PENDING-PAY-ADJ,
 13290           DFHEIV11,
 13291           ERPYAJ-KEY,
 13292           DFHEIV99,
 13293           DFHEIV99
 13294     MOVE EIBRESP  TO WS-RESPONSE
 13295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13296        IF RESP-DUPKEY OR RESP-DUPREC
 13297           ADD +1                TO ERPYAJ-SEQ-NO
 13298           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13299        END-IF
 13300     END-PERFORM
 13301     .
 13302 1610-EXIT.
 13303     EXIT.
 13304 1620-ADD-ERPYAJ-DLR-REC.
 13305     MOVE 'C'                    TO ERPYAJ-TYPE
 13306     IF REVERSAL
 13307        MOVE 'R'                 TO ERPYAJ-TYPE
 13308     END-IF
 13309     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13310                                    ERPYAJ-ACCOUNT
 13311     ADD +1                      TO ERPYAJ-SEQ-NO
 13312     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13313     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13314     IF PB-CARRIER = '2'
 13315        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13316     ELSE
 13317        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13318     END-IF
 13319     PERFORM WITH TEST AFTER
 13320        UNTIL (NOT RESP-DUPKEY)
 13321           AND (NOT RESP-DUPREC)
 13322
 13323* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 246
* EL6311.cbl
 13324*          DATASET    (FILE-ID-ERPYAJ)
 13325*          FROM       (PENDING-PAY-ADJ)
 13326*          RIDFLD     (ERPYAJ-KEY)
 13327*          RESP       (WS-RESPONSE)
 13328*       END-EXEC
 13329     MOVE LENGTH OF
 13330      PENDING-PAY-ADJ
 13331       TO DFHEIV11
 13332*    MOVE '&$ L                  ''  N#00012114' TO DFHEIV0
 13333     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13335     MOVE X'204E233030303132313134' TO DFHEIV0(25:11)
 13336     CALL 'kxdfhei1' USING DFHEIV0,
 13337           FILE-ID-ERPYAJ,
 13338           PENDING-PAY-ADJ,
 13339           DFHEIV11,
 13340           ERPYAJ-KEY,
 13341           DFHEIV99,
 13342           DFHEIV99
 13343     MOVE EIBRESP  TO WS-RESPONSE
 13344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13345        IF RESP-DUPKEY OR RESP-DUPREC
 13346           ADD +1                TO ERPYAJ-SEQ-NO
 13347           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13348        END-IF
 13349     END-PERFORM
 13350     .
 13351 1620-EXIT.
 13352     EXIT.
 13353 1700-SQUEEZE-IT-IN.
 13354     IF (N1 > CN-BILLING-END-LINE-NO)
 13355        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13356           N1 = +1
 13357           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13358           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13359              IF PI-COMPANY-ID = 'DCC'
 13360                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13361              ELSE
 13362                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13363              END-IF
 13364              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13365              MOVE +2 TO N1
 13366           END-IF
 13367        END-PERFORM
 13368     ELSE
 13369        IF (N1 < CN-BILLING-START-LINE-NO)
 13370           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13371              N1 = +10
 13372              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13373              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13374                 IF PI-COMPANY-ID = 'DCC'
 13375                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13376                 ELSE
 13377                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13378                 END-IF
 13379                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13380                 MOVE +9 TO N1
 13381              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 247
* EL6311.cbl
 13382           END-PERFORM
 13383        END-IF
 13384     END-IF
 13385     .
 13386 1700-EXIT.
 13387     EXIT.
 13388 1800-REMOVE-CERT-NOTES.
 13389     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13390                                 TO ERNOTE-KEY
 13391
 13392* EXEC CICS READ
 13393*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13394*       DATASET    (FILE-ID-ERNOTE)
 13395*       RIDFLD     (ERNOTE-KEY)
 13396*       RESP       (WS-RESPONSE)
 13397*       UPDATE
 13398*    END-EXEC
 13399*    MOVE '&"S        EU         (  N#00012166' TO DFHEIV0
 13400     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13401     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13402     MOVE X'204E233030303132313636' TO DFHEIV0(25:11)
 13403     CALL 'kxdfhei1' USING DFHEIV0,
 13404           FILE-ID-ERNOTE,
 13405           DFHEIV20,
 13406           DFHEIV99,
 13407           ERNOTE-KEY,
 13408           DFHEIV99,
 13409           DFHEIV99,
 13410           DFHEIV99
 13411     SET ADDRESS OF CERTIFICATE-NOTE TO
 13412         DFHEIV20
 13413     MOVE EIBRESP  TO WS-RESPONSE
 13414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13415     IF RESP-NORMAL
 13416        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13417           (N1 > +10)
 13418           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13419           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13420        END-PERFORM
 13421        IF N1 < +11
 13422           MOVE SPACES              TO CN-LINE (N1)
 13423           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13424              N1 <= CN-BILLING-END-LINE-NO
 13425              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13426              IF CN-BILLING-END-LINE-NO <
 13427                               CN-BILLING-START-LINE-NO
 13428                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13429                                     CN-BILLING-START-LINE-NO
 13430              END-IF
 13431              PERFORM 1820-SQUEEZE-ERNOTE
 13432                                  THRU 1820-EXIT
 13433           END-IF
 13434           IF CN-LINES = SPACES
 13435
 13436* EXEC CICS DELETE
 13437*                DATASET    (FILE-ID-ERNOTE)
 13438*                RESP       (WS-RESPONSE)
 13439*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 248
* EL6311.cbl
 13440*    MOVE '&(                    &  N#00012193' TO DFHEIV0
 13441     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13442     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13443     MOVE X'204E233030303132313933' TO DFHEIV0(25:11)
 13444     CALL 'kxdfhei1' USING DFHEIV0,
 13445           FILE-ID-ERNOTE,
 13446           DFHEIV99,
 13447           DFHEIV99,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     MOVE EIBRESP  TO WS-RESPONSE
 13451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13452              IF RESP-NORMAL
 13453                 MOVE 'D'        TO WS-NOTE-SW
 13454                 PERFORM 1520-UPDATE-ELCERT
 13455                                 THRU 1520-EXIT
 13456              END-IF
 13457           ELSE
 13458
 13459* EXEC CICS REWRITE
 13460*                DATASET    (FILE-ID-ERNOTE)
 13461*                FROM       (CERTIFICATE-NOTE)
 13462*                RESP       (WS-RESPONSE)
 13463*             END-EXEC
 13464     MOVE LENGTH OF
 13465      CERTIFICATE-NOTE
 13466       TO DFHEIV11
 13467*    MOVE '&& L                  %  N#00012203' TO DFHEIV0
 13468     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13469     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13470     MOVE X'204E233030303132323033' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           FILE-ID-ERNOTE,
 13473           CERTIFICATE-NOTE,
 13474           DFHEIV11,
 13475           DFHEIV99
 13476     MOVE EIBRESP  TO WS-RESPONSE
 13477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13478           END-IF
 13479        END-IF
 13480     END-IF
 13481     .
 13482 1800-EXIT.
 13483     EXIT.
 13484 1820-SQUEEZE-ERNOTE.
 13485     MOVE CN-BILLING-START-LINE-NO TO N2
 13486     IF N2 = 0
 13487         MOVE +1                 TO N2
 13488     END-IF
 13489     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13490        (N1 > +9)
 13491        IF CN-LINE (N1) = SPACES
 13492           MOVE CN-LINE (N1 + +1)
 13493                                 TO CN-LINE (N1)
 13494           MOVE SPACES           TO CN-LINE (N1 + +1)
 13495        END-IF
 13496     END-PERFORM
 13497     .
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 249
* EL6311.cbl
 13498 1820-EXIT.
 13499     EXIT.
 13500 1900-DELETE-ERPYAJ.
 13501     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13502     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13503     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13504     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13505     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13506     MOVE +10                    TO ERPYAJ-SEQ-NO
 13507     MOVE 'R'                    TO ERPYAJ-TYPE
 13508     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13509
 13510* EXEC CICS STARTBR
 13511*       DATASET    (FILE-ID-ERPYAJ)
 13512*       RIDFLD     (ERPYAJ-KEY)
 13513*       RESP       (WS-RESPONSE)
 13514*    END-EXEC
 13515     MOVE 0
 13516       TO DFHEIV11
 13517*    MOVE '&,         G          &  N#00012239' TO DFHEIV0
 13518     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13520     MOVE X'204E233030303132323339' TO DFHEIV0(25:11)
 13521     CALL 'kxdfhei1' USING DFHEIV0,
 13522           FILE-ID-ERPYAJ,
 13523           ERPYAJ-KEY,
 13524           DFHEIV99,
 13525           DFHEIV11,
 13526           DFHEIV99
 13527     MOVE EIBRESP  TO WS-RESPONSE
 13528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13529     IF RESP-NORMAL
 13530        CONTINUE
 13531     ELSE
 13532        GO TO 1900-GET-DEALER
 13533     END-IF
 13534     .
 13535 1900-READNEXT-ERPYAJ-B.
 13536*  GET THE BANK ERPYAJ RECORD
 13537
 13538* EXEC CICS READNEXT
 13539*       DATASET    (FILE-ID-ERPYAJ)
 13540*       RIDFLD     (ERPYAJ-KEY)
 13541*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13542*       RESP       (WS-RESPONSE)
 13543*    END-EXEC
 13544     MOVE 0
 13545       TO DFHEIV11
 13546*    MOVE '&.S                   )  N#00012252' TO DFHEIV0
 13547     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13548     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13549     MOVE X'204E233030303132323532' TO DFHEIV0(25:11)
 13550     CALL 'kxdfhei1' USING DFHEIV0,
 13551           FILE-ID-ERPYAJ,
 13552           DFHEIV20,
 13553           DFHEIV99,
 13554           ERPYAJ-KEY,
 13555           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 250
* EL6311.cbl
 13556           DFHEIV11,
 13557           DFHEIV99,
 13558           DFHEIV99
 13559     SET ADDRESS OF PENDING-PAY-ADJ TO
 13560         DFHEIV20
 13561     MOVE EIBRESP  TO WS-RESPONSE
 13562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13563     IF RESP-NORMAL
 13564        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13565           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13566              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13567                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13568
 13569* EXEC CICS READ
 13570*                   DATASET    (FILE-ID-ERPYAJ)
 13571*                   RIDFLD     (ERPYAJ-KEY)
 13572*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13573*                   RESP       (WS-RESPONSE)
 13574*                   UPDATE
 13575*                END-EXEC
 13576*    MOVE '&"S        EU         (  N#00012263' TO DFHEIV0
 13577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13578     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13579     MOVE X'204E233030303132323633' TO DFHEIV0(25:11)
 13580     CALL 'kxdfhei1' USING DFHEIV0,
 13581           FILE-ID-ERPYAJ,
 13582           DFHEIV20,
 13583           DFHEIV99,
 13584           ERPYAJ-KEY,
 13585           DFHEIV99,
 13586           DFHEIV99,
 13587           DFHEIV99
 13588     SET ADDRESS OF PENDING-PAY-ADJ TO
 13589         DFHEIV20
 13590     MOVE EIBRESP  TO WS-RESPONSE
 13591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13592                 IF RESP-NORMAL
 13593
 13594* EXEC CICS DELETE
 13595*                      DATASET   (FILE-ID-ERPYAJ)
 13596*                      RESP      (WS-RESPONSE)
 13597*                   END-EXEC
 13598*    MOVE '&(                    &  N#00012271' TO DFHEIV0
 13599     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13600     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13601     MOVE X'204E233030303132323731' TO DFHEIV0(25:11)
 13602     CALL 'kxdfhei1' USING DFHEIV0,
 13603           FILE-ID-ERPYAJ,
 13604           DFHEIV99,
 13605           DFHEIV99,
 13606           DFHEIV99,
 13607           DFHEIV99
 13608     MOVE EIBRESP  TO WS-RESPONSE
 13609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13610                 END-IF
 13611              ELSE
 13612                 SET REVERSAL    TO TRUE
 13613                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 251
* EL6311.cbl
 13614                                 THRU 1600-EXIT
 13615                 GO TO 1900-EXIT
 13616              END-IF
 13617           ELSE
 13618              GO TO 1900-READNEXT-ERPYAJ-B
 13619           END-IF
 13620        END-IF
 13621
 13622* EXEC CICS ENDBR
 13623*          DATASET   (FILE-ID-ERPYAJ)
 13624*       END-EXEC
 13625     MOVE 0
 13626       TO DFHEIV11
 13627*    MOVE '&2                    $   #00012286' TO DFHEIV0
 13628     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13629     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13630     MOVE X'2020233030303132323836' TO DFHEIV0(25:11)
 13631     CALL 'kxdfhei1' USING DFHEIV0,
 13632           FILE-ID-ERPYAJ,
 13633           DFHEIV11,
 13634           DFHEIV99
 13635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13636     END-IF
 13637     .
 13638 1900-GET-DEALER.
 13639     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13640     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13641     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13642     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13643     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13644     MOVE +10                    TO ERPYAJ-SEQ-NO
 13645     MOVE 'C'                    TO ERPYAJ-TYPE
 13646     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13647
 13648* EXEC CICS STARTBR
 13649*       DATASET    (FILE-ID-ERPYAJ)
 13650*       RIDFLD     (ERPYAJ-KEY)
 13651*       RESP       (WS-RESPONSE)
 13652*    END-EXEC
 13653     MOVE 0
 13654       TO DFHEIV11
 13655*    MOVE '&,         G          &  N#00012300' TO DFHEIV0
 13656     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13658     MOVE X'204E233030303132333030' TO DFHEIV0(25:11)
 13659     CALL 'kxdfhei1' USING DFHEIV0,
 13660           FILE-ID-ERPYAJ,
 13661           ERPYAJ-KEY,
 13662           DFHEIV99,
 13663           DFHEIV11,
 13664           DFHEIV99
 13665     MOVE EIBRESP  TO WS-RESPONSE
 13666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13667     IF RESP-NORMAL
 13668        CONTINUE
 13669     ELSE
 13670        GO TO 1900-EXIT
 13671     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 252
* EL6311.cbl
 13672     .
 13673 1900-READNEXT-ERPYAJ-D.
 13674*  GET THE DEALER ERPYAJ RECORD
 13675
 13676* EXEC CICS READNEXT
 13677*       DATASET    (FILE-ID-ERPYAJ)
 13678*       RIDFLD     (ERPYAJ-KEY)
 13679*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13680*       RESP       (WS-RESPONSE)
 13681*    END-EXEC
 13682     MOVE 0
 13683       TO DFHEIV11
 13684*    MOVE '&.S                   )  N#00012313' TO DFHEIV0
 13685     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13686     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13687     MOVE X'204E233030303132333133' TO DFHEIV0(25:11)
 13688     CALL 'kxdfhei1' USING DFHEIV0,
 13689           FILE-ID-ERPYAJ,
 13690           DFHEIV20,
 13691           DFHEIV99,
 13692           ERPYAJ-KEY,
 13693           DFHEIV99,
 13694           DFHEIV11,
 13695           DFHEIV99,
 13696           DFHEIV99
 13697     SET ADDRESS OF PENDING-PAY-ADJ TO
 13698         DFHEIV20
 13699     MOVE EIBRESP  TO WS-RESPONSE
 13700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13701     IF RESP-NORMAL
 13702        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13703           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13704              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13705                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13706
 13707* EXEC CICS READ
 13708*                   DATASET    (FILE-ID-ERPYAJ)
 13709*                   RIDFLD     (ERPYAJ-KEY)
 13710*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13711*                   RESP       (WS-RESPONSE)
 13712*                   UPDATE
 13713*                END-EXEC
 13714*    MOVE '&"S        EU         (  N#00012324' TO DFHEIV0
 13715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13716     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13717     MOVE X'204E233030303132333234' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0,
 13719           FILE-ID-ERPYAJ,
 13720           DFHEIV20,
 13721           DFHEIV99,
 13722           ERPYAJ-KEY,
 13723           DFHEIV99,
 13724           DFHEIV99,
 13725           DFHEIV99
 13726     SET ADDRESS OF PENDING-PAY-ADJ TO
 13727         DFHEIV20
 13728     MOVE EIBRESP  TO WS-RESPONSE
 13729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 253
* EL6311.cbl
 13730                 IF RESP-NORMAL
 13731
 13732* EXEC CICS DELETE
 13733*                      DATASET   (FILE-ID-ERPYAJ)
 13734*                      RESP      (WS-RESPONSE)
 13735*                   END-EXEC
 13736*    MOVE '&(                    &  N#00012332' TO DFHEIV0
 13737     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13738     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13739     MOVE X'204E233030303132333332' TO DFHEIV0(25:11)
 13740     CALL 'kxdfhei1' USING DFHEIV0,
 13741           FILE-ID-ERPYAJ,
 13742           DFHEIV99,
 13743           DFHEIV99,
 13744           DFHEIV99,
 13745           DFHEIV99
 13746     MOVE EIBRESP  TO WS-RESPONSE
 13747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13748                 END-IF
 13749              ELSE
 13750                 SET REVERSAL    TO TRUE
 13751              END-IF
 13752           ELSE
 13753              GO TO 1900-READNEXT-ERPYAJ-D
 13754           END-IF
 13755        END-IF
 13756
 13757* EXEC CICS ENDBR
 13758*          DATASET   (FILE-ID-ERPYAJ)
 13759*       END-EXEC
 13760     MOVE 0
 13761       TO DFHEIV11
 13762*    MOVE '&2                    $   #00012344' TO DFHEIV0
 13763     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13765     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 13766     CALL 'kxdfhei1' USING DFHEIV0,
 13767           FILE-ID-ERPYAJ,
 13768           DFHEIV11,
 13769           DFHEIV99
 13770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13771     END-IF
 13772     .
 13773 1900-EXIT.
 13774     EXIT.
 13775******************************************************************
 13776*            C A N C E L   M A I N L I N E                       *
 13777******************************************************************
 13778
 13779 2000-CANCEL-MAINLINE.
 13780     IF PI-DISPLAY-ORIGINAL-BATCH
 13781        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13782           MOVE ER-0023             TO EMI-ERROR
 13783           MOVE -1                  TO CMAINTL
 13784           MOVE AL-UABON            TO CMAINTA
 13785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13786           GO TO 8200-SEND-DATAONLY
 13787        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 254
* EL6311.cbl
 13788           NEXT SENTENCE
 13789     ELSE
 13790        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13791           MOVE ER-0023             TO EMI-ERROR
 13792           MOVE -1                  TO CMAINTL
 13793           MOVE AL-UABON            TO CMAINTA
 13794           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13795           GO TO 8200-SEND-DATAONLY.
 13796
 13797     IF CMAINTI = 'S'
 13798        GO TO 2100-SHOW-REQUEST.
 13799
 13800     IF NOT MODIFY-CAP
 13801         MOVE 'UPDATE'       TO SM-READ
 13802         PERFORM 9995-SECURITY-VIOLATION
 13803         MOVE ER-0070        TO EMI-ERROR
 13804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805         GO TO 8100-SEND-INITIAL-MAP.
 13806
 13807     IF CMAINTL GREATER THAN ZEROS
 13808        IF PI-PF6-FUNCTION
 13809           IF CMAINTI NOT = 'A'
 13810              MOVE AL-UABON  TO CMAINTA
 13811              MOVE -1        TO CMAINTL
 13812              MOVE ER-2260   TO EMI-ERROR
 13813              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13814              GO TO 8200-SEND-DATAONLY.
 13815
 13816     IF CCERTNOL = ZEROS
 13817       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13818         NEXT SENTENCE
 13819     ELSE
 13820         IF CCERTNOL NOT = ZEROS
 13821             MOVE AL-UANON       TO CCERTNOA
 13822         ELSE
 13823             MOVE -1             TO CCERTNOL
 13824             MOVE  1             TO SET-CURSOR-SW
 13825             MOVE ER-2218       TO EMI-ERROR
 13826             MOVE AL-UABON       TO CCERTNOA
 13827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13828
 13829     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13830        NEXT SENTENCE
 13831     ELSE
 13832        IF CEFFDTL NOT = ZEROS
 13833           MOVE AL-UNNON         TO CEFFDTA
 13834           MOVE CEFFDTI TO DEEDIT-FIELD
 13835           PERFORM 8600-DEEDIT
 13836           MOVE 4                TO DC-OPTION-CODE
 13837           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13838           PERFORM 9700-DATE-LINK
 13839           IF NO-CONVERSION-ERROR
 13840              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13841              ELSE
 13842              MOVE -1            TO CEFFDTL
 13843              MOVE  1            TO SET-CURSOR-SW
 13844              MOVE ER-2226      TO EMI-ERROR
 13845              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 255
* EL6311.cbl
 13846              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13847          ELSE
 13848          MOVE -1                 TO CEFFDTL
 13849          MOVE  1                 TO SET-CURSOR-SW
 13850          MOVE ER-2220            TO EMI-ERROR
 13851          MOVE AL-UNBON           TO CEFFDTA
 13852          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13853
 13854     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13855
 13856     IF CCERTNOL NOT = ZEROS
 13857        MOVE CCERTNOI                TO WS-NEW-PRIME
 13858     ELSE
 13859        MOVE SPACES                  TO WS-NEW-PRIME.
 13860
 13861     IF CSUFIXL NOT = ZEROS
 13862        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13863     ELSE
 13864        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13865
 13866     IF CEFFDTL NOT = ZEROS
 13867        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13868     ELSE
 13869        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13870
 13871     IF CMAINTI = 'A' OR 'K' OR 'S'
 13872        NEXT SENTENCE
 13873     ELSE
 13874        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13875        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13876           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13877           WS-PB-RECORD-TYPE NOT = '2'
 13878           IF CMAINTI = 'C'
 13879              MOVE ER-2287          TO EMI-ERROR
 13880              MOVE -1               TO CCERTNOL
 13881              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13882              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13883              GO TO 8200-SEND-DATAONLY
 13884             ELSE
 13885              MOVE ER-2260          TO EMI-ERROR
 13886              MOVE -1               TO CCERTNOL
 13887              MOVE AL-UABON         TO CCERTNOA
 13888              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13889              GO TO 8200-SEND-DATAONLY.
 13890
 13891     IF CMAINTI = 'D'
 13892        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13893
 13894     IF CLSTNML GREATER THAN ZEROS
 13895         MOVE AL-UANON           TO CLSTNMA.
 13896
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 256
* EL6311.cbl
 13898
 13899******************************************************************
 13900*                                                                *
 13901*           E D I T   C A N C E L   C O V E R A G E S            *
 13902*                                                                *
 13903******************************************************************
 13904
 13905 2015-EDIT-COVERAGES.
 13906     IF CCANDT1L      GREATER THAN ZEROS OR
 13907        CREFND1L      GREATER THAN ZEROS OR
 13908        CCANDT2L      GREATER THAN ZEROS OR
 13909        CREFND2L      GREATER THAN ZEROS OR
 13910        CMTHD1L       GREATER THAN ZEROS OR
 13911        CMTHD2L       GREATER THAN ZEROS OR
 13912        CLIVESL       GREATER THAN ZEROS OR
 13913        CPAYEEL       GREATER THAN ZEROS OR
 13914        CFORCEL       GREATER THAN ZEROS OR
 13915        CBILCDL       GREATER THAN ZEROS OR
 13916        CCANREAL      GREATER THAN ZEROS
 13917            NEXT SENTENCE
 13918         ELSE
 13919            GO TO 2030-EDIT-COMPLETE.
 13920
 13921     IF CCANDT1L = ZEROS
 13922        AND (CMAINTI = 'C' OR 'K')
 13923        NEXT SENTENCE
 13924     ELSE
 13925        IF CCANDT1L      GREATER THAN ZEROS
 13926            MOVE AL-UNNON            TO CCANDT1A
 13927            IF CCANDT1I = SPACES
 13928               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13929            ELSE
 13930               MOVE CCANDT1I            TO DEEDIT-FIELD
 13931               PERFORM 8600-DEEDIT
 13932               IF DEEDIT-FIELD-V0   NUMERIC
 13933                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13934                  MOVE 4                TO DC-OPTION-CODE
 13935                  PERFORM 9700-DATE-LINK
 13936                  IF NO-CONVERSION-ERROR
 13937                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13938                  ELSE
 13939                      MOVE -1        TO CCANDT1L
 13940                      MOVE ER-2227   TO EMI-ERROR
 13941                      MOVE AL-UNBON  TO CCANDT1A
 13942                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13943               ELSE
 13944                  MOVE -1         TO CCANDT1L
 13945                  MOVE ER-2223    TO EMI-ERROR
 13946                  MOVE AL-UNBON   TO CCANDT1A
 13947                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13948        ELSE
 13949            IF CREFND1L GREATER THAN ZEROS
 13950               MOVE -1             TO CCANDT1L
 13951               MOVE ER-2222        TO EMI-ERROR
 13952               MOVE AL-UNBOF       TO CCANDT1A
 13953               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13954
 13955     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 257
* EL6311.cbl
 13956        AND (CMAINTI = 'C' OR 'K')
 13957         NEXT SENTENCE
 13958     ELSE
 13959         IF CREFND1L NOT = ZEROS
 13960            MOVE AL-UNNON        TO CREFND1A
 13961
 13962* EXEC CICS BIF DEEDIT
 13963*               FIELD  (CREFND1I)
 13964*               LENGTH (11)
 13965*           END-EXEC
 13966     MOVE 11
 13967       TO DFHEIV11
 13968*    MOVE '@"L                   #   #00012537' TO DFHEIV0
 13969     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13970     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13971     MOVE X'2020233030303132353337' TO DFHEIV0(25:11)
 13972     CALL 'kxdfhei1' USING DFHEIV0,
 13973           CREFND1I,
 13974           DFHEIV11
 13975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13976            MOVE CREFND1I        TO WS-CREFND1
 13977*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 13978*           PERFORM 8600-DEEDIT
 13979*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 13980            IF WS-CREFND1  = ZEROS
 13981               AND CMAINTI = 'A'
 13982             MOVE ER-2437        TO EMI-ERROR
 13983             MOVE -1             TO CREFND1L
 13984             MOVE AL-UNBON       TO CREFND1A
 13985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13986
 13987     IF CCANREAL > +0
 13988        MOVE AL-UANON            TO CCANREAA
 13989        IF CCANREAI = 'R' OR ' '
 13990           CONTINUE
 13991        ELSE
 13992           MOVE ER-9841        TO EMI-ERROR
 13993           MOVE -1             TO CCANREAL
 13994           MOVE AL-UABON       TO CCANREAA
 13995           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13996        END-IF
 13997     END-IF
 13998     IF CMTHD1L EQUAL +0
 13999        NEXT SENTENCE
 14000     ELSE
 14001        IF CMTHD1L NOT = +0
 14002           MOVE AL-UNNON        TO CMTHD1A
 14003           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14004                         OR '5' OR '6' OR '8' OR '9'
 14005                         OR 'R' OR ' '
 14006              NEXT SENTENCE
 14007           ELSE
 14008              MOVE ER-0582        TO EMI-ERROR
 14009              MOVE -1             TO CMTHD1L
 14010              MOVE AL-UNBON       TO CMTHD1A
 14011              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14012
 14013     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 258
* EL6311.cbl
 14014        AND (CMAINTI = 'C' OR 'K')
 14015         NEXT SENTENCE
 14016     ELSE
 14017         IF CCANDT2L  GREATER THAN ZEROS
 14018             MOVE AL-UNNON       TO CCANDT2A
 14019             IF CCANDT2I = SPACES
 14020                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14021             ELSE
 14022                MOVE CCANDT2I       TO DEEDIT-FIELD
 14023                PERFORM 8600-DEEDIT
 14024                IF DEEDIT-FIELD-V0   NUMERIC
 14025                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14026                   MOVE 4                TO DC-OPTION-CODE
 14027                   PERFORM 9700-DATE-LINK
 14028                   IF NO-CONVERSION-ERROR
 14029                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14030                   ELSE
 14031                      MOVE -1       TO CCANDT2L
 14032                      MOVE ER-2227  TO EMI-ERROR
 14033                      MOVE AL-UNBON TO CCANDT2A
 14034                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14035                ELSE
 14036                   MOVE -1         TO CCANDT2L
 14037                   MOVE ER-2223    TO EMI-ERROR
 14038                   MOVE AL-UNBON   TO CCANDT2A
 14039                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14040         ELSE
 14041            IF CREFND2L GREATER THAN ZEROS
 14042               MOVE -1             TO CCANDT2L
 14043               MOVE ER-2222        TO EMI-ERROR
 14044               MOVE AL-UNBOF       TO CCANDT2A
 14045               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14046
 14047     IF CREFND2L = ZEROS
 14048        AND (CMAINTI = 'C' OR 'K')
 14049         NEXT SENTENCE
 14050     ELSE
 14051         IF CREFND2L NOT = ZEROS
 14052            MOVE AL-UNNON        TO CREFND2A
 14053
 14054* EXEC CICS BIF DEEDIT
 14055*               FIELD  (CREFND2I)
 14056*               LENGTH (11)
 14057*           END-EXEC
 14058     MOVE 11
 14059       TO DFHEIV11
 14060*    MOVE '@"L                   #   #00012618' TO DFHEIV0
 14061     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14062     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14063     MOVE X'2020233030303132363138' TO DFHEIV0(25:11)
 14064     CALL 'kxdfhei1' USING DFHEIV0,
 14065           CREFND2I,
 14066           DFHEIV11
 14067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14068            MOVE CREFND2I        TO WS-CREFND2
 14069*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14070*           PERFORM 8600-DEEDIT
 14071*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 259
* EL6311.cbl
 14072            IF WS-CREFND2  = ZEROS
 14073               AND CMAINTI = 'A'
 14074             MOVE ER-2437        TO EMI-ERROR
 14075             MOVE -1             TO CREFND2L
 14076             MOVE AL-UNBON       TO CREFND2A
 14077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14078
 14079     IF CMTHD2L EQUAL +0
 14080        NEXT SENTENCE
 14081     ELSE
 14082        IF CMTHD2L NOT = +0
 14083           MOVE AL-UNNON        TO CMTHD2A
 14084           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14085                         OR '5' OR '6' OR '8' OR '9'
 14086                         OR ' ' OR 'R'
 14087              NEXT SENTENCE
 14088           ELSE
 14089              MOVE ER-0582        TO EMI-ERROR
 14090              MOVE -1             TO CMTHD2L
 14091              MOVE AL-UNBON       TO CMTHD2A
 14092              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14093
 14094     IF CLIVESL GREATER THAN ZEROS
 14095         MOVE CLIVESI            TO DEEDIT-FIELD
 14096         PERFORM 8600-DEEDIT
 14097         IF DEEDIT-FIELD-V0 NUMERIC
 14098             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14099             MOVE AL-UNNON       TO CLIVESA
 14100         ELSE
 14101             MOVE -1             TO CLIVESL
 14102             MOVE AL-UNBON       TO CLIVESA
 14103             MOVE ER-2223        TO EMI-ERROR
 14104             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14105
 14106     IF CFORCEL  NOT = ZEROS
 14107         IF FORCE-CAP
 14108            MOVE AL-UANON            TO CFORCEA
 14109         ELSE
 14110            MOVE ER-2945             TO EMI-ERROR
 14111            MOVE AL-UABON            TO CFORCEA
 14112            MOVE -1                  TO CFORCEL
 14113            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14114
 14115     IF CPAYEEL GREATER THAN ZEROS
 14116        MOVE AL-UANON            TO CPAYEEA.
 14117
 14118     IF CBILCDL NOT = ZEROS
 14119        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14120                             AND 'A' AND 'B' AND 'E'
 14121           MOVE ER-2225              TO EMI-ERROR
 14122           MOVE AL-UABON             TO CBILCDA
 14123           MOVE -1                   TO CBILCDL
 14124           MOVE  1                   TO SET-CURSOR-SW
 14125           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14126        ELSE
 14127           MOVE AL-UANON             TO CBILCDA.
 14128
 14129 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 260
* EL6311.cbl
 14130     IF EMI-ERROR = ZEROS
 14131         NEXT SENTENCE
 14132     ELSE
 14133         GO TO 8200-SEND-DATAONLY.
 14134
 14135     IF CMAINTI = 'A'
 14136        GO TO 2200-ADD-CANCEL-ROUTINE.
 14137
 14138     IF CMAINTI = 'C'
 14139        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14140
 14141     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14142
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 261
* EL6311.cbl
 14144
 14145******************************************************************
 14146*                                                                *
 14147*                   S H O W   C A N C E L                        *
 14148*                                                                *
 14149******************************************************************
 14150
 14151 2100-SHOW-REQUEST.
 14152     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14153
 14154     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14155        MOVE -1                  TO CMAINTL
 14156        GO TO 8200-SEND-DATAONLY.
 14157
 14158     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14159
 14160     IF CSUFIXL NOT = ZEROS
 14161        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14162       ELSE
 14163        MOVE SPACE            TO WS-NEW-SUFFIX.
 14164
 14165     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14166     PERFORM 8600-DEEDIT.
 14167     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14168     MOVE '4'                    TO DC-OPTION-CODE.
 14169     PERFORM 9700-DATE-LINK.
 14170     IF DATE-CONVERSION-ERROR
 14171        MOVE ER-0348             TO EMI-ERROR
 14172        MOVE -1                  TO CEFFDTL
 14173        MOVE AL-UABON            TO CEFFDTA
 14174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14175        GO TO 8200-SEND-DATAONLY
 14176     ELSE
 14177        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14178        MOVE AL-UANON            TO CEFFDTA
 14179        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14180
 14181     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14182
 14183     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14184        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14185        MOVE 'Y'                    TO WS-SHOW-SW
 14186        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14187           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14188        ELSE
 14189           IF PI-FILE-BROWSE
 14190              GO TO 4300-BROWSE-FILE-FORWARD
 14191           ELSE
 14192              IF PI-CSR-BROWSE
 14193                 GO TO 4200-BROWSE-CSR-FORWARD
 14194              ELSE
 14195                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14196     ELSE
 14197        GO TO 3900-RE-DISPLAY-RECORD.
 14198
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 262
* EL6311.cbl
 14200
 14201
 14202******************************************************************
 14203*                                                                *
 14204*            A D D   C A N C E L   R O U T I N E                 *
 14205*                                                                *
 14206******************************************************************
 14207
 14208 2200-ADD-CANCEL-ROUTINE.
 14209     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14210
 14211
 14212* EXEC CICS GETMAIN
 14213*        SET     (ADDRESS OF PENDING-BUSINESS)
 14214*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14215*    END-EXEC.
 14216*    MOVE '," L                  $   #00012765' TO DFHEIV0
 14217     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14218     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14219     MOVE X'2020233030303132373635' TO DFHEIV0(25:11)
 14220     CALL 'kxdfhei1' USING DFHEIV0,
 14221           DFHEIV20,
 14222           ERPNDB-RECORD-LENGTH,
 14223           DFHEIV99
 14224     SET ADDRESS OF PENDING-BUSINESS TO
 14225         DFHEIV20
 14226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14227
 14228
 14229
 14230* EXEC CICS HANDLE CONDITION
 14231*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14232*    END-EXEC.
 14233*    MOVE '"$I                   ! 3 #00012770' TO DFHEIV0
 14234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14236     MOVE X'3320233030303132373730' TO DFHEIV0(25:11)
 14237     CALL 'kxdfhei1' USING DFHEIV0
 14238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14239
 14240
 14241     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14242     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14243     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14244
 14245
 14246* EXEC CICS READ
 14247*        INTO    (PENDING-BUSINESS)
 14248*        DATASET (FILE-ID-ERPNDB)
 14249*        RIDFLD  (ERPNDB-KEY)
 14250*    END-EXEC.
 14251     MOVE LENGTH OF
 14252      PENDING-BUSINESS
 14253       TO DFHEIV11
 14254*    MOVE '&"IL       E          (   #00012778' TO DFHEIV0
 14255     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14257     MOVE X'2020233030303132373738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 263
* EL6311.cbl
 14258     CALL 'kxdfhei1' USING DFHEIV0,
 14259           FILE-ID-ERPNDB,
 14260           PENDING-BUSINESS,
 14261           DFHEIV11,
 14262           ERPNDB-KEY,
 14263           DFHEIV99,
 14264           DFHEIV99,
 14265           DFHEIV99
 14266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14267
 14268
 14269     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14270
 14271     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14272     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14273     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14274     MOVE SPACES                 TO PENDING-BUSINESS.
 14275     MOVE 'PB'                   TO PB-RECORD-ID.
 14276     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14277     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14278     MOVE SPACES                 TO PB-CERT-SFX.
 14279     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14280     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14281                                    PB-ALT-CHG-SEQ-NO.
 14282
 14283     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14284     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14285     MOVE '2'                    TO PB-RECORD-TYPE.
 14286
 14287     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14288     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14289
 14290
 14291     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14292                                    PB-ALT-CHG-SEQ-NO
 14293                                    PB-C-LF-REF-CALC
 14294                                    PB-C-AH-REF-CALC
 14295                                    PB-C-LF-RFND-CLP
 14296                                    PB-C-AH-RFND-CLP
 14297                                    PB-CI-INSURED-AGE
 14298                                    PB-CI-LF-TERM
 14299                                    PB-CI-AH-TERM
 14300                                    PB-CI-LF-BENEFIT-CD
 14301                                    PB-CI-LF-BENEFIT-AMT
 14302                                    PB-CI-LF-ALT-BENEFIT-AMT
 14303                                    PB-CI-LF-PREMIUM-AMT
 14304                                    PB-CI-LF-ALT-PREMIUM-AMT
 14305                                    PB-CI-AH-BENEFIT-CD
 14306                                    PB-CI-AH-BENEFIT-AMT
 14307                                    PB-CI-AH-PREMIUM-AMT
 14308                                    PB-CI-PAY-FREQUENCY
 14309                                    PB-CI-LOAN-APR
 14310                                    PB-CI-LOAN-TERM
 14311                                    PB-CI-LIFE-COMMISSION
 14312                                    PB-CI-AH-COMMISSION
 14313                                    PB-CI-CURR-SEQ
 14314                                    PB-CI-AH-CANCEL-AMT
 14315                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 264
* EL6311.cbl
 14316                                    PB-CI-RATE-DEV-PCT-LF
 14317                                    PB-CI-RATE-DEV-PCT-AH
 14318                                    PB-CI-EXTENTION-DAYS
 14319                                    PB-CI-TERM-IN-DAYS
 14320                                    PB-CI-LIVES
 14321                                    PB-CI-LF-CRIT-PER
 14322                                    PB-CI-AH-CRIT-PER
 14323                                    PB-C-LF-REM-TERM
 14324                                    PB-C-AH-REM-TERM
 14325                                    PB-CHG-COUNT
 14326                                    PB-LF-BILLED-AMTS
 14327                                    PB-AH-BILLED-AMTS
 14328                                    PB-C-NH-INT-ON-REFS
 14329*                                   PB-C-MICROFILM-NO
 14330                                    PB-CALC-TOLERANCE.
 14331
 14332     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14333                                    PB-CI-AH-SETTLEMENT-DT
 14334                                    PB-CI-DEATH-DT
 14335                                    PB-CI-LF-PRIOR-CANCEL-DT
 14336                                    PB-CI-AH-PRIOR-CANCEL-DT
 14337                                    PB-CI-ENTRY-DT
 14338                                    PB-CI-LF-EXPIRE-DT
 14339                                    PB-CI-AH-EXPIRE-DT
 14340                                    PB-CI-LOAN-1ST-PMT-DT
 14341                                    PB-C-LF-CANCEL-DT
 14342                                    PB-C-AH-CANCEL-DT
 14343                                    PB-CREDIT-ACCEPT-DT
 14344                                    PB-BILLED-DT
 14345                                    PB-ACCT-EFF-DT
 14346                                    PB-ACCT-EXP-DT.
 14347
 14348     MOVE 'X'                    TO PB-FATAL-FLAG.
 14349
 14350     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14351
 14352     IF CSUFIXL     GREATER THAN ZEROS
 14353        MOVE CSUFIXI             TO PB-CERT-SFX.
 14354
 14355*    IF CMICRNOL  GREATER  ZEROS
 14356*        IF CMICRNOI  NUMERIC
 14357*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14358*            MOVE AL-UNNON       TO  CMICRNOA
 14359*        ELSE
 14360*            MOVE -1             TO  CMICRNOL
 14361*            MOVE AL-UNBON       TO  CMICRNOA
 14362*            MOVE ER-2701        TO  EMI-ERROR
 14363*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14364
 14365     IF CLSTNML     GREATER THAN ZEROS
 14366        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14367
 14368     IF CCANREAL > ZEROS
 14369        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14370     END-IF
 14371     IF CPCYNL > ZEROS
 14372        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14373     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 265
* EL6311.cbl
 14374     IF CCANDT1L    GREATER THAN ZEROS
 14375        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14376
 14377     IF CCANDT2L    GREATER THAN ZEROS
 14378        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14379
 14380     IF CMTHD1L    GREATER THAN +0
 14381        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14382
 14383     IF CMTHD2L    GREATER THAN +0
 14384        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14385
 14386     IF CREFND1L    GREATER THAN ZEROS
 14387        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14388        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14389     ELSE
 14390        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14391
 14392     IF CREFND2L    GREATER THAN ZEROS
 14393        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14394        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14395     ELSE
 14396        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14397
 14398     IF CLIVESL     GREATER THAN ZEROS
 14399        MOVE WS-CLIVES           TO PB-C-LIVES
 14400     ELSE
 14401        MOVE ZEROS               TO PB-C-LIVES.
 14402
 14403     IF CPAYEEL     GREATER THAN ZEROS
 14404        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14405
 14406     IF CFORCEL     GREATER THAN ZEROS
 14407        MOVE CFORCEI             TO PB-FORCE-CODE.
 14408
 14409     IF CBILCDL     GREATER THAN ZEROS
 14410        MOVE CBILCDI             TO PB-RECORD-BILL.
 14411
 14412*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14413
 14414 2260-WRITE-PB-RECORD.
 14415     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14416                                    PB-INPUT-BY.
 14417     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14418     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14419                                    PB-INPUT-DT.
 14420
 14421     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14422     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14423                                    PB-CONTROL-BY-ORIG-BATCH.
 14424
 14425     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14426     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14427     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14428     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14429     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14430
 14431     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 266
* EL6311.cbl
 14432
 14433     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14434
 14435     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14436     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14437     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14438
 14439     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14440     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14441
 14442 2275-WRITE-PENDING-BUSINESS.
 14443     MOVE 'A'                    TO JP-RECORD-TYPE.
 14444     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14445     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14446     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14447
 14448
 14449* EXEC CICS HANDLE CONDITION
 14450*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14451*    END-EXEC.
 14452*    MOVE '"$%                   ! 4 #00012963' TO DFHEIV0
 14453     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14455     MOVE X'3420233030303132393633' TO DFHEIV0(25:11)
 14456     CALL 'kxdfhei1' USING DFHEIV0
 14457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14458
 14459
 14460
 14461* EXEC CICS WRITE
 14462*        DATASET (FILE-ID-ERPNDB)
 14463*        FROM    (PENDING-BUSINESS)
 14464*        RIDFLD  (PB-CONTROL-PRIMARY)
 14465*    END-EXEC.
 14466     MOVE LENGTH OF
 14467      PENDING-BUSINESS
 14468       TO DFHEIV11
 14469*    MOVE '&$ L                  ''   #00012967' TO DFHEIV0
 14470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14472     MOVE X'2020233030303132393637' TO DFHEIV0(25:11)
 14473     CALL 'kxdfhei1' USING DFHEIV0,
 14474           FILE-ID-ERPNDB,
 14475           PENDING-BUSINESS,
 14476           DFHEIV11,
 14477           PB-CONTROL-PRIMARY,
 14478           DFHEIV99,
 14479           DFHEIV99
 14480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14481
 14482
 14483     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14484
 14485     PERFORM 8400-LOG-JOURNAL-RECORD.
 14486
 14487******************************************************************
 14488*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14489******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 267
* EL6311.cbl
 14490
 14491     display ' made it to add orig CANCEL cert '
 14492     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14493     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14494     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14495     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14496
 14497
 14498* EXEC CICS READ
 14499*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14500*        DATASET (FILE-ID-ELCERT)
 14501*        RIDFLD  (ELCERT-KEY)
 14502*        RESP    (WS-RESPONSE)
 14503*    END-EXEC.
 14504*    MOVE '&"S        E          (  N#00012987' TO DFHEIV0
 14505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14507     MOVE X'204E233030303132393837' TO DFHEIV0(25:11)
 14508     CALL 'kxdfhei1' USING DFHEIV0,
 14509           FILE-ID-ELCERT,
 14510           DFHEIV20,
 14511           DFHEIV99,
 14512           ELCERT-KEY,
 14513           DFHEIV99,
 14514           DFHEIV99,
 14515           DFHEIV99
 14516     SET ADDRESS OF CERTIFICATE-MASTER TO
 14517         DFHEIV20
 14518     MOVE EIBRESP  TO WS-RESPONSE
 14519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14520
 14521
 14522     IF NOT RESP-NORMAL
 14523        GO TO 2276-BYPASS-CRTO
 14524     END-IF
 14525
 14526     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14527     MOVE ' '                    TO WS-ERMAIL-SW
 14528
 14529
 14530* EXEC CICS READ
 14531*       DATASET   (FILE-ID-ERMAIL)
 14532*       SET       (ADDRESS OF MAILING-DATA)
 14533*       RIDFLD    (ERMAIL-KEY)
 14534*       RESP      (WS-RESPONSE)
 14535*    END-EXEC
 14536*    MOVE '&"S        E          (  N#00013001' TO DFHEIV0
 14537     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14539     MOVE X'204E233030303133303031' TO DFHEIV0(25:11)
 14540     CALL 'kxdfhei1' USING DFHEIV0,
 14541           FILE-ID-ERMAIL,
 14542           DFHEIV20,
 14543           DFHEIV99,
 14544           ERMAIL-KEY,
 14545           DFHEIV99,
 14546           DFHEIV99,
 14547           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 268
* EL6311.cbl
 14548     SET ADDRESS OF MAILING-DATA TO
 14549         DFHEIV20
 14550     MOVE EIBRESP  TO WS-RESPONSE
 14551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14552
 14553     IF RESP-NORMAL
 14554        SET ERMAIL-FOUND TO TRUE
 14555     END-IF
 14556
 14557     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14558
 14559     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14560     MOVE 'OC'                   TO OC-RECORD-ID
 14561     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14562                                 TO OC-CONTROL-PRIMARY (1:33)
 14563     MOVE 'I'                    TO OC-RECORD-TYPE
 14564     MOVE +4096                  TO OC-KEY-SEQ-NO
 14565     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14566     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14567     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14568
 14569     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14570     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14571     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14572     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14573     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14574     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14575     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14576     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14577     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14578     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14579     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14580     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14581     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14582     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14583     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14584     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14585     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14586     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14587     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14588     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14589     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14590     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14591     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14592     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14593     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14594     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14595     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14596     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14597     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14598     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14599     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14600     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14601
 14602     IF ERMAIL-FOUND
 14603        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14604     END-IF
 14605     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 269
* EL6311.cbl
 14606        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14607                           OC-INS-AGE-DEFAULT-FLAG
 14608        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14609                           OC-JNT-AGE-DEFAULT-FLAG
 14610     END-IF
 14611     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14612     .
 14613 2275-WRITE-ELCRTO.
 14614
 14615
 14616* EXEC CICS WRITE
 14617*       DATASET   ('ELCRTO')
 14618*       FROM      (ORIGINAL-CERTIFICATE)
 14619*       RIDFLD    (OC-CONTROL-PRIMARY)
 14620*       RESP      (WS-RESPONSE)
 14621*    END-EXEC
 14622     MOVE LENGTH OF
 14623      ORIGINAL-CERTIFICATE
 14624       TO DFHEIV11
 14625     MOVE 'ELCRTO' TO DFHEIV1
 14626*    MOVE '&$ L                  ''  N#00013070' TO DFHEIV0
 14627     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14629     MOVE X'204E233030303133303730' TO DFHEIV0(25:11)
 14630     CALL 'kxdfhei1' USING DFHEIV0,
 14631           DFHEIV1,
 14632           ORIGINAL-CERTIFICATE,
 14633           DFHEIV11,
 14634           OC-CONTROL-PRIMARY,
 14635           DFHEIV99,
 14636           DFHEIV99
 14637     MOVE EIBRESP  TO WS-RESPONSE
 14638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14639
 14640     display ' just wrote 2275 ' ws-response
 14641     IF RESP-DUPKEY
 14642        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14643        GO TO 2275-WRITE-ELCRTO
 14644     ELSE
 14645        IF NOT RESP-NORMAL
 14646           MOVE -1               TO BMAINTL
 14647           MOVE ER-7450          TO EMI-ERROR
 14648           PERFORM 9900-ERROR-FORMAT
 14649                                 THRU 9900-EXIT
 14650           GO TO 8200-SEND-DATAONLY
 14651        END-IF
 14652     END-IF.
 14653
 14654 2276-BYPASS-CRTO.
 14655******************************************************************
 14656*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14657******************************************************************
 14658
 14659
 14660* EXEC CICS READ
 14661*        INTO    (PENDING-BUSINESS)
 14662*        DATASET (FILE-ID-ERPNDB)
 14663*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 270
* EL6311.cbl
 14664*        UPDATE
 14665*    END-EXEC.
 14666     MOVE LENGTH OF
 14667      PENDING-BUSINESS
 14668       TO DFHEIV11
 14669*    MOVE '&"IL       EU         (   #00013096' TO DFHEIV0
 14670     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14672     MOVE X'2020233030303133303936' TO DFHEIV0(25:11)
 14673     CALL 'kxdfhei1' USING DFHEIV0,
 14674           FILE-ID-ERPNDB,
 14675           PENDING-BUSINESS,
 14676           DFHEIV11,
 14677           ERPNDB-KEY,
 14678           DFHEIV99,
 14679           DFHEIV99,
 14680           DFHEIV99
 14681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14682
 14683
 14684     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14685     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14686     MOVE 'B'                    TO JP-RECORD-TYPE.
 14687     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14688
 14689     PERFORM 8400-LOG-JOURNAL-RECORD.
 14690
 14691     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14692
 14693
 14694* EXEC CICS REWRITE
 14695*        DATASET (FILE-ID-ERPNDB)
 14696*        FROM    (PENDING-BUSINESS)
 14697*    END-EXEC.
 14698     MOVE LENGTH OF
 14699      PENDING-BUSINESS
 14700       TO DFHEIV11
 14701*    MOVE '&& L                  %   #00013112' TO DFHEIV0
 14702     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14703     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14704     MOVE X'2020233030303133313132' TO DFHEIV0(25:11)
 14705     CALL 'kxdfhei1' USING DFHEIV0,
 14706           FILE-ID-ERPNDB,
 14707           PENDING-BUSINESS,
 14708           DFHEIV11,
 14709           DFHEIV99
 14710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14711
 14712
 14713     MOVE 'C'                    TO JP-RECORD-TYPE.
 14714     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14715
 14716     PERFORM 8400-LOG-JOURNAL-RECORD.
 14717
 14718     IF WS-ERRORS-PRESENT
 14719        GO TO 3900-RE-DISPLAY-RECORD.
 14720
 14721     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 271
* EL6311.cbl
 14722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14723     MOVE LOW-VALUES             TO EL631CI.
 14724     MOVE  -1                    TO CMAINTL.
 14725     GO TO 8100-SEND-INITIAL-MAP.
 14726
 14727 2280-BATCH-HDR-NOT-FOUND.
 14728     MOVE -1                     TO BMAINTL.
 14729     MOVE ER-7450                TO EMI-ERROR.
 14730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14731     GO TO 8200-SEND-DATAONLY.
 14732
 14733 2290-DUPLICATE-ALT-INDEX.
 14734
 14735******************************************************************
 14736*                                                                *
 14737*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14738*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14739*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14740*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14741*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14742*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14743*                                                                *
 14744******************************************************************
 14745
 14746     IF LCP-ONCTR-02 =  0
 14747         ADD 1 TO LCP-ONCTR-02
 14748        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14749
 14750     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14751
 14752     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14753         NEXT SENTENCE
 14754     ELSE
 14755         ADD +1 TO PB-BATCH-SEQ-NO
 14756                   PB-CSR-BATCH-SEQ-NO
 14757         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14758         GO TO 2275-WRITE-PENDING-BUSINESS.
 14759
 14760     MOVE -1                     TO CCERTNOL.
 14761     MOVE AL-UABON               TO CCERTNOA.
 14762     MOVE AL-UNBON               TO CEFFDTA.
 14763
 14764     MOVE 1                      TO EMI-SUB
 14765                                    EMI-SWITCH1
 14766                                    EMI-SWITCH-AREA-1
 14767                                    EMI-SWITCH-AREA-2.
 14768
 14769     MOVE SPACES                 TO EMI-ERROR-LINES.
 14770
 14771
 14772* EXEC CICS SYNCPOINT ROLLBACK
 14773*    END-EXEC.
 14774*    MOVE '6"R                   !   #00013175' TO DFHEIV0
 14775     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14777     MOVE X'2020233030303133313735' TO DFHEIV0(25:11)
 14778     CALL 'kxdfhei1' USING DFHEIV0
 14779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 272
* EL6311.cbl
 14780
 14781
 14782     MOVE ER-2247                TO EMI-ERROR.
 14783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14784     GO TO 8200-SEND-DATAONLY.
 14785
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 273
* EL6311.cbl
 14787
 14788******************************************************************
 14789*                                                                *
 14790*          C H A N G E   C A N C E L   R O U T I N E             *
 14791*                                                                *
 14792******************************************************************
 14793
 14794***************************************************************
 14795*                                                             *
 14796*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14797*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14798*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14799*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14800*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14801*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14802*     5. LINK TO THE EDIT ROUTINE.                            *
 14803*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14804*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14805*              THE EDIT ROUTINE.                              *
 14806*     7. REWRITE THE NEW ISSUE                                *
 14807*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14808*                                                             *
 14809***************************************************************
 14810 2300-CHANGE-CANCEL-ROUTINE.
 14811     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14812
 14813     IF CCHGL NOT = ZEROS
 14814        MOVE ER-2196             TO EMI-ERROR
 14815        MOVE AL-UABON            TO CMAINTA
 14816        MOVE -1                  TO CMAINTL
 14817        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14818        GO TO 8200-SEND-DATAONLY.
 14819
 14820     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14821
 14822     IF CSUFIXL NOT = ZEROS
 14823        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14824     ELSE
 14825        MOVE SPACE               TO WS-NEW-SUFFIX.
 14826
 14827     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14828     PERFORM 8600-DEEDIT.
 14829     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14830     MOVE '4'                    TO DC-OPTION-CODE.
 14831
 14832     PERFORM 9700-DATE-LINK.
 14833
 14834     IF DATE-CONVERSION-ERROR
 14835        MOVE ER-0348             TO EMI-ERROR
 14836        MOVE -1                  TO CEFFDTL
 14837        MOVE AL-UABON            TO CEFFDTA
 14838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14839        GO TO 8200-SEND-DATAONLY
 14840     ELSE
 14841        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14842        MOVE AL-UANON            TO CEFFDTA
 14843        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14844
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 274
* EL6311.cbl
 14845 2325-PROCESS-CANCEL-CHANGES.
 14846
 14847* EXEC CICS HANDLE CONDITION
 14848*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14849*    END-EXEC.
 14850*    MOVE '"$I                   ! 5 #00013242' TO DFHEIV0
 14851     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14853     MOVE X'3520233030303133323432' TO DFHEIV0(25:11)
 14854     CALL 'kxdfhei1' USING DFHEIV0
 14855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14856
 14857
 14858     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14859     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14860     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14861
 14862
 14863* EXEC CICS GETMAIN
 14864*        SET      (ADDRESS OF PENDING-BUSINESS)
 14865*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14866*        INITIMG  (GETMAIN-SPACE)
 14867*     END-EXEC.
 14868*    MOVE ',"IL                  $   #00013250' TO DFHEIV0
 14869     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14871     MOVE X'2020233030303133323530' TO DFHEIV0(25:11)
 14872     CALL 'kxdfhei1' USING DFHEIV0,
 14873           DFHEIV20,
 14874           ERPNDB-RECORD-LENGTH,
 14875           GETMAIN-SPACE
 14876     SET ADDRESS OF PENDING-BUSINESS TO
 14877         DFHEIV20
 14878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14879
 14880
 14881
 14882* EXEC CICS READ
 14883*        INTO    (PENDING-BUSINESS)
 14884*        DATASET (FILE-ID-ERPNDB)
 14885*        RIDFLD  (ERPNDB-KEY)
 14886*    END-EXEC.
 14887     MOVE LENGTH OF
 14888      PENDING-BUSINESS
 14889       TO DFHEIV11
 14890*    MOVE '&"IL       E          (   #00013256' TO DFHEIV0
 14891     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14893     MOVE X'2020233030303133323536' TO DFHEIV0(25:11)
 14894     CALL 'kxdfhei1' USING DFHEIV0,
 14895           FILE-ID-ERPNDB,
 14896           PENDING-BUSINESS,
 14897           DFHEIV11,
 14898           ERPNDB-KEY,
 14899           DFHEIV99,
 14900           DFHEIV99,
 14901           DFHEIV99
 14902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 275
* EL6311.cbl
 14903
 14904
 14905     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14906
 14907
 14908* EXEC CICS HANDLE CONDITION
 14909*         NOTFND     (2385-REC-NOT-FOUND)
 14910*    END-EXEC.
 14911*    MOVE '"$I                   ! 6 #00013264' TO DFHEIV0
 14912     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14914     MOVE X'3620233030303133323634' TO DFHEIV0(25:11)
 14915     CALL 'kxdfhei1' USING DFHEIV0
 14916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14917
 14918
 14919**********************************************************
 14920*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14921*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14922**********************************************************
 14923
 14924
 14925* EXEC CICS READ
 14926*        DATASET (FILE-ID-ERPNDB)
 14927*        INTO    (PENDING-BUSINESS)
 14928*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14929*    END-EXEC.
 14930     MOVE LENGTH OF
 14931      PENDING-BUSINESS
 14932       TO DFHEIV11
 14933*    MOVE '&"IL       E          (   #00013273' TO DFHEIV0
 14934     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14936     MOVE X'2020233030303133323733' TO DFHEIV0(25:11)
 14937     CALL 'kxdfhei1' USING DFHEIV0,
 14938           FILE-ID-ERPNDB,
 14939           PENDING-BUSINESS,
 14940           DFHEIV11,
 14941           PI-PREV-CONTROL-PRIMARY,
 14942           DFHEIV99,
 14943           DFHEIV99,
 14944           DFHEIV99
 14945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14946
 14947
 14948********** DO NOT ALLOW CHANGES IF THRU A/R
 14949     IF BMAINTI = 'C'
 14950         IF PB-EL860-INTERNAL-PROCESS
 14951             MOVE ER-4005          TO EMI-ERROR
 14952             MOVE -1               TO BMAINTL
 14953             MOVE AL-UABON         TO BMAINTA
 14954             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14955             GO TO 8200-SEND-DATAONLY.
 14956**********
 14957
 14958     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14959        MOVE -1                 TO CMAINTL
 14960        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 276
* EL6311.cbl
 14961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14962        GO TO 8200-SEND-DATAONLY.
 14963
 14964     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 14965        MOVE ER-2196             TO EMI-ERROR
 14966        MOVE AL-UABON            TO CMAINTA
 14967        MOVE -1                  TO CMAINTL
 14968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14969        GO TO 8200-SEND-DATAONLY.
 14970     MOVE ZEROS                  TO WS-SEQ-SAVE.
 14971
 14972     IF PB-BILLED-DT = LOW-VALUES AND
 14973        PB-CHG-COUNT = ZEROS
 14974        NEXT SENTENCE
 14975     ELSE
 14976        IF (CREFND1L GREATER THAN ZEROS AND
 14977            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 14978           OR
 14979           (CREFND2L GREATER THAN ZEROS AND
 14980            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14981           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 14982
 14983
 14984* EXEC CICS READ
 14985*        DATASET (FILE-ID-ERPNDB)
 14986*        INTO    (PENDING-BUSINESS)
 14987*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14988*        UPDATE
 14989*    END-EXEC.
 14990     MOVE LENGTH OF
 14991      PENDING-BUSINESS
 14992       TO DFHEIV11
 14993*    MOVE '&"IL       EU         (   #00013314' TO DFHEIV0
 14994     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14995     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14996     MOVE X'2020233030303133333134' TO DFHEIV0(25:11)
 14997     CALL 'kxdfhei1' USING DFHEIV0,
 14998           FILE-ID-ERPNDB,
 14999           PENDING-BUSINESS,
 15000           DFHEIV11,
 15001           PI-PREV-CONTROL-PRIMARY,
 15002           DFHEIV99,
 15003           DFHEIV99,
 15004           DFHEIV99
 15005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15006
 15007
 15008     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15009     MOVE 'B'                    TO JP-RECORD-TYPE
 15010     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15011     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15012
 15013     PERFORM 8400-LOG-JOURNAL-RECORD.
 15014
 15015     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15016          PB-CHG-COUNT NOT = ZEROS
 15017        IF (CREFND1L GREATER THAN ZEROS AND
 15018            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 277
* EL6311.cbl
 15019           OR
 15020           (CREFND2L GREATER THAN ZEROS AND
 15021            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15022            ADD +1                      TO PB-CHG-COUNT
 15023            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15024
 15025*    IF CMICRNOL  GREATER  ZEROS
 15026*        IF CMICRNOI  NUMERIC
 15027*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15028*            MOVE AL-UNNON       TO  CMICRNOA
 15029*        ELSE
 15030*            MOVE -1             TO  CMICRNOL
 15031*            MOVE AL-UNBON       TO  CMICRNOA
 15032*            MOVE ER-2701        TO  EMI-ERROR
 15033*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15034
 15035     IF CSUFIXL GREATER THAN ZEROS
 15036        MOVE CSUFIXI             TO PB-CERT-SFX.
 15037
 15038     IF CLSTNML GREATER THAN ZEROS
 15039         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15040
 15041     IF CCANREAL > ZEROS
 15042        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15043     END-IF
 15044     IF CPCYNL > ZEROS
 15045        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15046     END-IF
 15047     IF CCANDT1L    GREATER THAN ZEROS
 15048        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15049
 15050     IF CCANDT2L    GREATER THAN ZEROS
 15051        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15052
 15053     IF CMTHD1L    GREATER THAN +0
 15054        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15055
 15056     IF CMTHD2L    GREATER THAN +0
 15057        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15058
 15059     IF CREFND1L    GREATER THAN ZEROS
 15060        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15061        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15062        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15063        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15064
 15065     IF CREFND2L    GREATER THAN ZEROS
 15066        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15067        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15068        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15069        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15070
 15071     IF CLIVESL     GREATER THAN ZEROS
 15072        MOVE WS-CLIVES           TO PB-C-LIVES.
 15073
 15074     IF CPAYEEL     GREATER THAN ZEROS
 15075        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15076
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 278
* EL6311.cbl
 15077     IF CFORCEL     GREATER THAN ZEROS
 15078        MOVE CFORCEI             TO PB-FORCE-CODE.
 15079
 15080     IF CBILCDL     GREATER THAN ZEROS
 15081        MOVE CBILCDI             TO PB-RECORD-BILL.
 15082
 15083 2360-REWRITE-PB-RECORD.
 15084     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15085     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15086     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15087     MOVE 'C'                    TO JP-RECORD-TYPE.
 15088     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15089     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15090     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15091
 15092     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15093
 15094     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15095     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15096
 15097     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15098
 15099     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15100
 15101     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15102     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15103     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15104
 15105     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15106     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15107
 15108 2375-REWRITE-PENDING-BUSINESS.
 15109     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15110     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15111     MOVE 'C'                    TO JP-RECORD-TYPE.
 15112     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15113
 15114
 15115* EXEC CICS REWRITE
 15116*        DATASET (FILE-ID-ERPNDB)
 15117*        FROM    (PENDING-BUSINESS)
 15118*    END-EXEC.
 15119     MOVE LENGTH OF
 15120      PENDING-BUSINESS
 15121       TO DFHEIV11
 15122*    MOVE '&& L                  %   #00013427' TO DFHEIV0
 15123     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15124     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15125     MOVE X'2020233030303133343237' TO DFHEIV0(25:11)
 15126     CALL 'kxdfhei1' USING DFHEIV0,
 15127           FILE-ID-ERPNDB,
 15128           PENDING-BUSINESS,
 15129           DFHEIV11,
 15130           DFHEIV99
 15131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15132
 15133
 15134     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 279
* EL6311.cbl
 15135
 15136******************************************************************
 15137*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15138******************************************************************
 15139
 15140     display ' made it to update orig cancel cert '
 15141
 15142     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15143     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15144     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15145     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15146
 15147
 15148* EXEC CICS READ
 15149*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15150*        DATASET (FILE-ID-ELCERT)
 15151*        RIDFLD  (ELCERT-KEY)
 15152*        RESP    (WS-RESPONSE)
 15153*    END-EXEC.
 15154*    MOVE '&"S        E          (  N#00013445' TO DFHEIV0
 15155     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15156     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15157     MOVE X'204E233030303133343435' TO DFHEIV0(25:11)
 15158     CALL 'kxdfhei1' USING DFHEIV0,
 15159           FILE-ID-ELCERT,
 15160           DFHEIV20,
 15161           DFHEIV99,
 15162           ELCERT-KEY,
 15163           DFHEIV99,
 15164           DFHEIV99,
 15165           DFHEIV99
 15166     SET ADDRESS OF CERTIFICATE-MASTER TO
 15167         DFHEIV20
 15168     MOVE EIBRESP  TO WS-RESPONSE
 15169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15170
 15171
 15172     IF NOT RESP-NORMAL
 15173        GO TO 2376-BYPASS-CRTO
 15174     END-IF
 15175
 15176
 15177     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15178     MOVE ' '                    TO WS-ERMAIL-SW
 15179
 15180
 15181* EXEC CICS READ
 15182*       DATASET   (FILE-ID-ERMAIL)
 15183*       SET       (ADDRESS OF MAILING-DATA)
 15184*       RIDFLD    (ERMAIL-KEY)
 15185*       RESP      (WS-RESPONSE)
 15186*    END-EXEC
 15187*    MOVE '&"S        E          (  N#00013460' TO DFHEIV0
 15188     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15190     MOVE X'204E233030303133343630' TO DFHEIV0(25:11)
 15191     CALL 'kxdfhei1' USING DFHEIV0,
 15192           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 280
* EL6311.cbl
 15193           DFHEIV20,
 15194           DFHEIV99,
 15195           ERMAIL-KEY,
 15196           DFHEIV99,
 15197           DFHEIV99,
 15198           DFHEIV99
 15199     SET ADDRESS OF MAILING-DATA TO
 15200         DFHEIV20
 15201     MOVE EIBRESP  TO WS-RESPONSE
 15202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15203
 15204     IF RESP-NORMAL
 15205        SET ERMAIL-FOUND TO TRUE
 15206     END-IF
 15207
 15208     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15209
 15210     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15211                                 TO ELCRTO-KEY
 15212     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15213     MOVE +0                     TO ELCRTO-SEQ-NO
 15214
 15215
 15216* EXEC CICS READ
 15217*       DATASET   ('ELCRTO')
 15218*       INTO      (ORIGINAL-CERTIFICATE)
 15219*       RIDFLD    (ELCRTO-KEY)
 15220*       GTEQ
 15221*       RESP      (WS-RESPONSE)
 15222*    END-EXEC
 15223     MOVE LENGTH OF
 15224      ORIGINAL-CERTIFICATE
 15225       TO DFHEIV11
 15226     MOVE 'ELCRTO' TO DFHEIV1
 15227*    MOVE '&"IL       G          (  N#00013478' TO DFHEIV0
 15228     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15230     MOVE X'204E233030303133343738' TO DFHEIV0(25:11)
 15231     CALL 'kxdfhei1' USING DFHEIV0,
 15232           DFHEIV1,
 15233           ORIGINAL-CERTIFICATE,
 15234           DFHEIV11,
 15235           ELCRTO-KEY,
 15236           DFHEIV99,
 15237           DFHEIV99,
 15238           DFHEIV99
 15239     MOVE EIBRESP  TO WS-RESPONSE
 15240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15241
 15242     display ' just read gteq ' ws-response
 15243     IF RESP-NORMAL
 15244        AND (OC-CONTROL-PRIMARY (1:33) =
 15245                 PB-CONTROL-BY-ACCOUNT (1:33))
 15246        AND (OC-RECORD-TYPE = 'I')
 15247        display ' resp norm, key =, type i '
 15248        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15249           display ' end proc blank '
 15250           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 281
* EL6311.cbl
 15251           IF NOT CSR-EDIT-SESSION
 15252
 15253* EXEC CICS READ
 15254*                DATASET   ('ELCRTO')
 15255*                INTO      (ORIGINAL-CERTIFICATE)
 15256*                RIDFLD    (OC-CONTROL-PRIMARY)
 15257*                UPDATE
 15258*                RESP      (WS-RESPONSE)
 15259*             END-EXEC
 15260     MOVE LENGTH OF
 15261      ORIGINAL-CERTIFICATE
 15262       TO DFHEIV11
 15263     MOVE 'ELCRTO' TO DFHEIV1
 15264*    MOVE '&"IL       EU         (  N#00013496' TO DFHEIV0
 15265     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15266     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15267     MOVE X'204E233030303133343936' TO DFHEIV0(25:11)
 15268     CALL 'kxdfhei1' USING DFHEIV0,
 15269           DFHEIV1,
 15270           ORIGINAL-CERTIFICATE,
 15271           DFHEIV11,
 15272           OC-CONTROL-PRIMARY,
 15273           DFHEIV99,
 15274           DFHEIV99,
 15275           DFHEIV99
 15276     MOVE EIBRESP  TO WS-RESPONSE
 15277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15278              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15279              IF RESP-NORMAL
 15280                 display ' good read upd '
 15281                 IF OC-ISSUE-TRAN-IND = 'N'
 15282                    MOVE CM-INSURED-LAST-NAME   TO
 15283                         OC-INS-LAST-NAME
 15284                    MOVE CM-INSURED-FIRST-NAME  TO
 15285                         OC-INS-FIRST-NAME
 15286                    MOVE CM-INSURED-INITIAL2    TO
 15287                         OC-INS-MIDDLE-INIT
 15288                    MOVE CM-INSURED-ISSUE-AGE   TO
 15289                         OC-INS-AGE
 15290                    MOVE CM-JT-LAST-NAME        TO
 15291                         OC-JNT-LAST-NAME
 15292                    MOVE CM-JT-FIRST-NAME       TO
 15293                         OC-JNT-FIRST-NAME
 15294                    MOVE CM-JT-INITIAL          TO
 15295                         OC-JNT-MIDDLE-INIT
 15296                    MOVE CM-INSURED-JOINT-AGE   TO
 15297                         OC-JNT-AGE
 15298                    MOVE CM-LF-BENEFIT-CD       TO
 15299                         OC-LF-BENCD
 15300                    MOVE CM-LF-ORIG-TERM        TO
 15301                         OC-LF-TERM
 15302                    MOVE CM-LF-BENEFIT-AMT      TO
 15303                         OC-LF-BEN-AMT
 15304                    MOVE CM-LF-PREMIUM-AMT      TO
 15305                         OC-LF-PRM-AMT
 15306                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15307                         OC-LF-ALT-BEN-AMT
 15308                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 282
* EL6311.cbl
 15309                         OC-LF-ALT-PRM-AMT
 15310                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15311                         OC-LF-EXP-DT
 15312                    MOVE CM-LIFE-COMM-PCT       TO
 15313                         OC-LF-COMM-PCT
 15314                    MOVE CM-AH-BENEFIT-CD       TO
 15315                         OC-AH-BENCD
 15316                    MOVE CM-AH-ORIG-TERM        TO
 15317                         OC-AH-TERM
 15318                    MOVE CM-AH-BENEFIT-AMT      TO
 15319                         OC-AH-BEN-AMT
 15320                    MOVE CM-AH-PREMIUM-AMT      TO
 15321                         OC-AH-PRM-AMT
 15322                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15323                         OC-AH-EXP-DT
 15324                    MOVE CM-AH-COMM-PCT         TO
 15325                         OC-AH-COMM-PCT
 15326                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15327                         OC-AH-CP
 15328                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15329                         OC-1ST-PMT-DT
 15330                 END-IF
 15331                 MOVE PB-C-LF-CANCEL-DT      TO
 15332                         OC-LF-CANCEL-DT
 15333                 MOVE PB-C-LF-CANCEL-AMT     TO
 15334                         OC-LF-CANCEL-AMT
 15335                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15336                         OC-LF-ITD-CANCEL-AMT
 15337                 MOVE PB-C-AH-CANCEL-DT      TO
 15338                         OC-AH-CANCEL-DT
 15339                 MOVE PB-C-AH-CANCEL-AMT     TO
 15340                         OC-AH-CANCEL-AMT
 15341                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15342                         OC-AH-ITD-CANCEL-AMT
 15343                 MOVE 'Y'                    TO
 15344                         OC-CANCEL-TRAN-IND
 15345                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15346                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15347                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15348                 IF ERMAIL-FOUND
 15349                    MOVE MA-CRED-BENE-NAME
 15350                                 TO OC-CRED-BENE-NAME
 15351                 END-IF
 15352                 IF NOT CERT-TRL-REC-NOT-FOUND
 15353                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15354                           OC-INS-AGE-DEFAULT-FLAG
 15355                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15356                           OC-JNT-AGE-DEFAULT-FLAG
 15357                 END-IF
 15358
 15359* EXEC CICS REWRITE
 15360*                   DATASET   ('ELCRTO')
 15361*                   FROM      (ORIGINAL-CERTIFICATE)
 15362*                   RESP      (WS-RESPONSE)
 15363*                END-EXEC
 15364     MOVE LENGTH OF
 15365      ORIGINAL-CERTIFICATE
 15366       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 283
* EL6311.cbl
 15367     MOVE 'ELCRTO' TO DFHEIV1
 15368*    MOVE '&& L                  %  N#00013583' TO DFHEIV0
 15369     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15370     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15371     MOVE X'204E233030303133353833' TO DFHEIV0(25:11)
 15372     CALL 'kxdfhei1' USING DFHEIV0,
 15373           DFHEIV1,
 15374           ORIGINAL-CERTIFICATE,
 15375           DFHEIV11,
 15376           DFHEIV99
 15377     MOVE EIBRESP  TO WS-RESPONSE
 15378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15379                 display ' just rewrote ' ws-response
 15380              END-IF
 15381           END-IF
 15382        ELSE
 15383           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15384           MOVE 'OC'             TO OC-RECORD-ID
 15385           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15386           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15387           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15388           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15389           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15390           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15391           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15392           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15393           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15394           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15395           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15396           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15397           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15398           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15399           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15400           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15401           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15402           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15403           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15404           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15405           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15406           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15407           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15408           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15409           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15410           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15411           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15412           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15413           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15414           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15415           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15416           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15417           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15418           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15419           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15420           IF ERMAIL-FOUND
 15421              MOVE MA-CRED-BENE-NAME
 15422                                 TO OC-CRED-BENE-NAME
 15423           END-IF
 15424           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 284
* EL6311.cbl
 15425              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15426                           OC-INS-AGE-DEFAULT-FLAG
 15427              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15428                           OC-JNT-AGE-DEFAULT-FLAG
 15429           END-IF
 15430           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15431
 15432* EXEC CICS WRITE
 15433*             DATASET   ('ELCRTO')
 15434*             FROM      (ORIGINAL-CERTIFICATE)
 15435*             RIDFLD    (OC-CONTROL-PRIMARY)
 15436*             RESP      (WS-RESPONSE)
 15437*          END-EXEC
 15438     MOVE LENGTH OF
 15439      ORIGINAL-CERTIFICATE
 15440       TO DFHEIV11
 15441     MOVE 'ELCRTO' TO DFHEIV1
 15442*    MOVE '&$ L                  ''  N#00013640' TO DFHEIV0
 15443     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15444     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15445     MOVE X'204E233030303133363430' TO DFHEIV0(25:11)
 15446     CALL 'kxdfhei1' USING DFHEIV0,
 15447           DFHEIV1,
 15448           ORIGINAL-CERTIFICATE,
 15449           DFHEIV11,
 15450           OC-CONTROL-PRIMARY,
 15451           DFHEIV99,
 15452           DFHEIV99
 15453     MOVE EIBRESP  TO WS-RESPONSE
 15454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15455        END-IF
 15456     ELSE
 15457        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15458        MOVE 'OC'                TO OC-RECORD-ID
 15459        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15460                                 TO OC-CONTROL-PRIMARY (1:33)
 15461        MOVE 'I'                 TO OC-RECORD-TYPE
 15462        MOVE +4096               TO OC-KEY-SEQ-NO
 15463        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15464        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15465        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15466        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15467        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15468        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15469        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15470        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15471        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15472        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15473        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15474        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15475        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15476        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15477        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15478        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15479        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15480        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15481        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15482        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 285
* EL6311.cbl
 15483        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15484        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15485        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15486        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15487        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15488        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15489        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15490        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15491        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15492        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15493        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15494        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15495        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15496        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15497        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15498        IF ERMAIL-FOUND
 15499           MOVE MA-CRED-BENE-NAME
 15500                                 TO OC-CRED-BENE-NAME
 15501        END-IF
 15502        IF NOT CERT-TRL-REC-NOT-FOUND
 15503           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15504                           OC-INS-AGE-DEFAULT-FLAG
 15505           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15506                           OC-JNT-AGE-DEFAULT-FLAG
 15507        END-IF
 15508        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15509
 15510
 15511* EXEC CICS WRITE
 15512*          DATASET   ('ELCRTO')
 15513*          FROM      (ORIGINAL-CERTIFICATE)
 15514*          RIDFLD    (OC-CONTROL-PRIMARY)
 15515*          RESP      (WS-RESPONSE)
 15516*       END-EXEC
 15517     MOVE LENGTH OF
 15518      ORIGINAL-CERTIFICATE
 15519       TO DFHEIV11
 15520     MOVE 'ELCRTO' TO DFHEIV1
 15521*    MOVE '&$ L                  ''  N#00013701' TO DFHEIV0
 15522     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15523     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15524     MOVE X'204E233030303133373031' TO DFHEIV0(25:11)
 15525     CALL 'kxdfhei1' USING DFHEIV0,
 15526           DFHEIV1,
 15527           ORIGINAL-CERTIFICATE,
 15528           DFHEIV11,
 15529           OC-CONTROL-PRIMARY,
 15530           DFHEIV99,
 15531           DFHEIV99
 15532     MOVE EIBRESP  TO WS-RESPONSE
 15533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15534     END-IF.
 15535
 15536 2376-BYPASS-CRTO.
 15537******************************************************************
 15538*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15539******************************************************************
 15540
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 286
* EL6311.cbl
 15541
 15542* EXEC CICS HANDLE CONDITION
 15543*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15544*    END-EXEC.
 15545*    MOVE '"$I                   ! 7 #00013714' TO DFHEIV0
 15546     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15548     MOVE X'3720233030303133373134' TO DFHEIV0(25:11)
 15549     CALL 'kxdfhei1' USING DFHEIV0
 15550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15551
 15552
 15553
 15554* EXEC CICS READ
 15555*        INTO    (PENDING-BUSINESS)
 15556*        DATASET (FILE-ID-ERPNDB)
 15557*        RIDFLD  (ERPNDB-KEY)
 15558*        UPDATE
 15559*    END-EXEC.
 15560     MOVE LENGTH OF
 15561      PENDING-BUSINESS
 15562       TO DFHEIV11
 15563*    MOVE '&"IL       EU         (   #00013718' TO DFHEIV0
 15564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15565     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15566     MOVE X'2020233030303133373138' TO DFHEIV0(25:11)
 15567     CALL 'kxdfhei1' USING DFHEIV0,
 15568           FILE-ID-ERPNDB,
 15569           PENDING-BUSINESS,
 15570           DFHEIV11,
 15571           ERPNDB-KEY,
 15572           DFHEIV99,
 15573           DFHEIV99,
 15574           DFHEIV99
 15575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15576
 15577
 15578     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15579     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15580     MOVE 'B'                    TO JP-RECORD-TYPE.
 15581     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15582
 15583     PERFORM 8400-LOG-JOURNAL-RECORD.
 15584
 15585     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15586
 15587
 15588* EXEC CICS REWRITE
 15589*        DATASET (FILE-ID-ERPNDB)
 15590*        FROM    (PENDING-BUSINESS)
 15591*    END-EXEC.
 15592     MOVE LENGTH OF
 15593      PENDING-BUSINESS
 15594       TO DFHEIV11
 15595*    MOVE '&& L                  %   #00013734' TO DFHEIV0
 15596     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15597     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15598     MOVE X'2020233030303133373334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 287
* EL6311.cbl
 15599     CALL 'kxdfhei1' USING DFHEIV0,
 15600           FILE-ID-ERPNDB,
 15601           PENDING-BUSINESS,
 15602           DFHEIV11,
 15603           DFHEIV99
 15604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15605
 15606
 15607     MOVE 'C'                    TO JP-RECORD-TYPE.
 15608     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15609
 15610     PERFORM 8400-LOG-JOURNAL-RECORD.
 15611
 15612     IF WS-ERRORS-PRESENT
 15613         GO TO 3900-RE-DISPLAY-RECORD.
 15614
 15615     MOVE ZEROS                  TO EMI-ERROR
 15616     MOVE -1                     TO CMAINTL
 15617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15618     GO TO 3900-RE-DISPLAY-RECORD.
 15619
 15620 2380-BATCH-HDR-NOT-FOUND.
 15621     MOVE -1                     TO BMAINTL.
 15622     MOVE ER-7450                TO EMI-ERROR.
 15623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15624     GO TO 8200-SEND-DATAONLY.
 15625
 15626 2385-REC-NOT-FOUND.
 15627     MOVE -1                     TO BMAINTL.
 15628     MOVE ER-7451                TO EMI-ERROR.
 15629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15630     GO TO 8200-SEND-DATAONLY.
 15631
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 288
* EL6311.cbl
 15633
 15634******************************************************************
 15635*                                                                *
 15636*          D E L E T E   C A N C E L   R O U T I N E             *
 15637*                                                                *
 15638******************************************************************
 15639
 15640 2400-DELETE-CANCEL-ROUTINE.
 15641     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15642
 15643     IF CCHGL NOT = ZEROS
 15644        MOVE ER-2196             TO EMI-ERROR
 15645        MOVE AL-UABON            TO CMAINTA
 15646        MOVE -1                  TO CMAINTL
 15647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15648        GO TO 8200-SEND-DATAONLY.
 15649
 15650
 15651* EXEC CICS HANDLE CONDITION
 15652*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15653*    END-EXEC.
 15654*    MOVE '"$I                   ! 8 #00013782' TO DFHEIV0
 15655     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15656     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15657     MOVE X'3820233030303133373832' TO DFHEIV0(25:11)
 15658     CALL 'kxdfhei1' USING DFHEIV0
 15659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15660
 15661
 15662     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15663     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15664     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15665
 15666
 15667* EXEC CICS READ
 15668*        SET     (ADDRESS OF PENDING-BUSINESS)
 15669*        DATASET (FILE-ID-ERPNDB)
 15670*        RIDFLD  (ERPNDB-KEY)
 15671*    END-EXEC.
 15672*    MOVE '&"S        E          (   #00013790' TO DFHEIV0
 15673     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15674     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15675     MOVE X'2020233030303133373930' TO DFHEIV0(25:11)
 15676     CALL 'kxdfhei1' USING DFHEIV0,
 15677           FILE-ID-ERPNDB,
 15678           DFHEIV20,
 15679           DFHEIV99,
 15680           ERPNDB-KEY,
 15681           DFHEIV99,
 15682           DFHEIV99,
 15683           DFHEIV99
 15684     SET ADDRESS OF PENDING-BUSINESS TO
 15685         DFHEIV20
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15690
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 289
* EL6311.cbl
 15691     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15692
 15693     IF CSUFIXL NOT = ZEROS
 15694        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15695     ELSE
 15696        MOVE SPACE               TO WS-NEW-SUFFIX.
 15697
 15698     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15699
 15700     PERFORM 8600-DEEDIT.
 15701     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15702     MOVE '4'                    TO DC-OPTION-CODE.
 15703     PERFORM 9700-DATE-LINK.
 15704
 15705     IF DATE-CONVERSION-ERROR
 15706        MOVE ER-0348             TO EMI-ERROR
 15707        MOVE -1                  TO CEFFDTL
 15708        MOVE AL-UABON            TO CEFFDTA
 15709        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15710        GO TO 8200-SEND-DATAONLY
 15711     ELSE
 15712        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15713        MOVE AL-UANON            TO CEFFDTA
 15714        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15715
 15716
 15717* EXEC CICS HANDLE CONDITION
 15718*         NOTFND    (2490-RECORD-NOT-FOUND)
 15719*    END-EXEC.
 15720*    MOVE '"$I                   ! 9 #00013823' TO DFHEIV0
 15721     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15723     MOVE X'3920233030303133383233' TO DFHEIV0(25:11)
 15724     CALL 'kxdfhei1' USING DFHEIV0
 15725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15726
 15727
 15728
 15729* EXEC CICS READ
 15730*        SET     (ADDRESS OF PENDING-BUSINESS)
 15731*        DATASET (FILE-ID-ERPNDB)
 15732*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15733*        UPDATE
 15734*    END-EXEC.
 15735*    MOVE '&"S        EU         (   #00013827' TO DFHEIV0
 15736     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15737     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15738     MOVE X'2020233030303133383237' TO DFHEIV0(25:11)
 15739     CALL 'kxdfhei1' USING DFHEIV0,
 15740           FILE-ID-ERPNDB,
 15741           DFHEIV20,
 15742           DFHEIV99,
 15743           PI-PREV-CONTROL-PRIMARY,
 15744           DFHEIV99,
 15745           DFHEIV99,
 15746           DFHEIV99
 15747     SET ADDRESS OF PENDING-BUSINESS TO
 15748         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 290
* EL6311.cbl
 15749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15750
 15751
 15752     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15753        MOVE -1                 TO CMAINTL
 15754        MOVE ER-2197            TO EMI-ERROR
 15755        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15756        GO TO 8200-SEND-DATAONLY.
 15757
 15758     IF PB-BILLED-DT NOT = LOW-VALUES
 15759        MOVE -1                 TO CMAINTL
 15760        MOVE ER-2129            TO EMI-ERROR
 15761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15762        GO TO 8200-SEND-DATAONLY.
 15763
 15764     IF PB-CHG-COUNT NOT = ZEROS
 15765        MOVE ER-2336            TO EMI-ERROR
 15766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15767        MOVE AL-UABON            TO CMAINTA
 15768        MOVE -1                  TO CMAINTL
 15769        GO TO 8200-SEND-DATAONLY.
 15770
 15771     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15772        PB-CHG-COUNT NOT = ZEROS
 15773        MOVE ER-2196             TO EMI-ERROR
 15774        MOVE AL-UABON            TO CMAINTA
 15775        MOVE -1                  TO CMAINTL
 15776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15777        GO TO 8200-SEND-DATAONLY.
 15778
 15779     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15780        MOVE ER-2900 TO EMI-ERROR
 15781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15782        MOVE AL-UABON         TO CMAINTA
 15783        MOVE -1               TO CMAINTL
 15784        GO TO 8200-SEND-DATAONLY.
 15785
 15786
 15787* EXEC CICS HANDLE CONDITION
 15788*         NOTFND  (2475-CONTINUE-DELETE)
 15789*    END-EXEC
 15790*    MOVE '"$I                   ! : #00013868' TO DFHEIV0
 15791     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15793     MOVE X'3A20233030303133383638' TO DFHEIV0(25:11)
 15794     CALL 'kxdfhei1' USING DFHEIV0
 15795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15796
 15797     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15798     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15799     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15800     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15801
 15802
 15803* EXEC CICS READ
 15804*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15805*        DATASET (FILE-ID-ELCERT)
 15806*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 291
* EL6311.cbl
 15807*        UPDATE
 15808*    END-EXEC.
 15809*    MOVE '&"S        EU         (   #00013877' TO DFHEIV0
 15810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15812     MOVE X'2020233030303133383737' TO DFHEIV0(25:11)
 15813     CALL 'kxdfhei1' USING DFHEIV0,
 15814           FILE-ID-ELCERT,
 15815           DFHEIV20,
 15816           DFHEIV99,
 15817           ELCERT-KEY,
 15818           DFHEIV99,
 15819           DFHEIV99,
 15820           DFHEIV99
 15821     SET ADDRESS OF CERTIFICATE-MASTER TO
 15822         DFHEIV20
 15823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15824
 15825
 15826     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15827
 15828     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15829     MOVE 'B'                    TO JP-RECORD-TYPE.
 15830     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15831     PERFORM 8400-LOG-JOURNAL-RECORD.
 15832
 15833     IF PB-CI-LIVES NOT NUMERIC
 15834         MOVE ZERO                    TO PB-CI-LIVES.
 15835
 15836     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15837        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15838           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15839           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15840           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15841                                            CM-LF-CANCEL-DT
 15842           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15843        ELSE
 15844           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15845           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15846           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15847           MOVE PB-CI-LIVES              TO CM-LIVES.
 15848
 15849     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15850        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15851           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15852               MOVE CM-LF-STATUS-AT-CANCEL
 15853                                        TO CM-LF-CURRENT-STATUS
 15854               MOVE SPACE
 15855                                        TO CM-LF-STATUS-AT-CANCEL
 15856           ELSE
 15857               MOVE PB-CI-LF-POLICY-STATUS
 15858                                        TO CM-LF-CURRENT-STATUS
 15859        ELSE
 15860           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15861
 15862
 15863     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15864        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 292
* EL6311.cbl
 15865           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15866           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15867           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15868                                            CM-AH-CANCEL-DT
 15869           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15870        ELSE
 15871           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15872           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15873           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15874           MOVE PB-CI-LIVES              TO CM-LIVES.
 15875
 15876     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15877        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15878           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15879               MOVE CM-AH-STATUS-AT-CANCEL
 15880                                        TO CM-AH-CURRENT-STATUS
 15881               MOVE SPACE
 15882                                        TO CM-AH-STATUS-AT-CANCEL
 15883           ELSE
 15884               MOVE PB-CI-AH-POLICY-STATUS
 15885                                        TO CM-AH-CURRENT-STATUS
 15886        ELSE
 15887           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15888
 15889 2450-REWRITE-CERT.
 15890     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15891     MOVE 'C'                      TO JP-RECORD-TYPE.
 15892     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15893
 15894
 15895* EXEC CICS REWRITE
 15896*        DATASET  (FILE-ID-ELCERT)
 15897*        FROM     (CERTIFICATE-MASTER)
 15898*    END-EXEC.
 15899     MOVE LENGTH OF
 15900      CERTIFICATE-MASTER
 15901       TO DFHEIV11
 15902*    MOVE '&& L                  %   #00013952' TO DFHEIV0
 15903     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15904     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15905     MOVE X'2020233030303133393532' TO DFHEIV0(25:11)
 15906     CALL 'kxdfhei1' USING DFHEIV0,
 15907           FILE-ID-ELCERT,
 15908           CERTIFICATE-MASTER,
 15909           DFHEIV11,
 15910           DFHEIV99
 15911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15912
 15913
 15914     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15915
 15916     PERFORM 8400-LOG-JOURNAL-RECORD.
 15917
 15918 2475-CONTINUE-DELETE.
 15919     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15920     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15921
 15922     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 293
* EL6311.cbl
 15923     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15924
 15925     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15926
 15927     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15928     MOVE 'D'                    TO JP-RECORD-TYPE
 15929     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15930
 15931
 15932* EXEC CICS DELETE
 15933*        DATASET    (FILE-ID-ERPNDB)
 15934*    END-EXEC.
 15935*    MOVE '&(                    &   #00013974' TO DFHEIV0
 15936     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15938     MOVE X'2020233030303133393734' TO DFHEIV0(25:11)
 15939     CALL 'kxdfhei1' USING DFHEIV0,
 15940           FILE-ID-ERPNDB,
 15941           DFHEIV99,
 15942           DFHEIV99,
 15943           DFHEIV99,
 15944           DFHEIV99
 15945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15946
 15947
 15948     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15949
 15950     PERFORM 8400-LOG-JOURNAL-RECORD.
 15951
 15952     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15953     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15954
 15955
 15956* EXEC CICS HANDLE CONDITION
 15957*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15958*    END-EXEC.
 15959*    MOVE '"$I                   ! ; #00013985' TO DFHEIV0
 15960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15962     MOVE X'3B20233030303133393835' TO DFHEIV0(25:11)
 15963     CALL 'kxdfhei1' USING DFHEIV0
 15964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15965
 15966
 15967
 15968* EXEC CICS READ
 15969*        SET     (ADDRESS OF PENDING-BUSINESS)
 15970*        DATASET (FILE-ID-ERPNDB)
 15971*        RIDFLD  (ERPNDB-KEY)
 15972*        UPDATE
 15973*    END-EXEC.
 15974*    MOVE '&"S        EU         (   #00013989' TO DFHEIV0
 15975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15976     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15977     MOVE X'2020233030303133393839' TO DFHEIV0(25:11)
 15978     CALL 'kxdfhei1' USING DFHEIV0,
 15979           FILE-ID-ERPNDB,
 15980           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 294
* EL6311.cbl
 15981           DFHEIV99,
 15982           ERPNDB-KEY,
 15983           DFHEIV99,
 15984           DFHEIV99,
 15985           DFHEIV99
 15986     SET ADDRESS OF PENDING-BUSINESS TO
 15987         DFHEIV20
 15988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15989
 15990
 15991     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 15992     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15993
 15994     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15995        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15996        MOVE 'D'                 TO JP-RECORD-TYPE
 15997        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15998
 15999* EXEC CICS DELETE
 16000*            DATASET    (FILE-ID-ERPNDB)
 16001*       END-EXEC
 16002*    MOVE '&(                    &   #00014003' TO DFHEIV0
 16003     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16005     MOVE X'2020233030303134303033' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0,
 16007           FILE-ID-ERPNDB,
 16008           DFHEIV99,
 16009           DFHEIV99,
 16010           DFHEIV99,
 16011           DFHEIV99
 16012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16013        PERFORM 8400-LOG-JOURNAL-RECORD
 16014     ELSE
 16015        MOVE 'B'                 TO JP-RECORD-TYPE
 16016        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16017        PERFORM 8400-LOG-JOURNAL-RECORD
 16018        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16019        MOVE 'C'                 TO JP-RECORD-TYPE
 16020        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16021
 16022* EXEC CICS REWRITE
 16023*            DATASET    (FILE-ID-ERPNDB)
 16024*            FROM       (PENDING-BUSINESS)
 16025*       END-EXEC
 16026     MOVE LENGTH OF
 16027      PENDING-BUSINESS
 16028       TO DFHEIV11
 16029*    MOVE '&& L                  %   #00014014' TO DFHEIV0
 16030     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16031     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16032     MOVE X'2020233030303134303134' TO DFHEIV0(25:11)
 16033     CALL 'kxdfhei1' USING DFHEIV0,
 16034           FILE-ID-ERPNDB,
 16035           PENDING-BUSINESS,
 16036           DFHEIV11,
 16037           DFHEIV99
 16038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 295
* EL6311.cbl
 16039        PERFORM 8400-LOG-JOURNAL-RECORD.
 16040
 16041******************************************************************
 16042*                                                                *
 16043*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16044*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16045*                                                                *
 16046******************************************************************
 16047
 16048     IF NOT PI-AR-PROCESSING
 16049        GO TO 2480-DELETE-FINISHED.
 16050
 16051     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16052        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16053        NEXT SENTENCE
 16054     ELSE
 16055        GO TO 2480-DELETE-FINISHED.
 16056
 16057
 16058* EXEC CICS HANDLE CONDITION
 16059*         NOTFND    (2480-DELETE-FINISHED)
 16060*    END-EXEC.
 16061*    MOVE '"$I                   ! < #00014036' TO DFHEIV0
 16062     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16064     MOVE X'3C20233030303134303336' TO DFHEIV0(25:11)
 16065     CALL 'kxdfhei1' USING DFHEIV0
 16066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16067
 16068
 16069     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16070     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16071
 16072
 16073* EXEC CICS READ
 16074*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16075*        DATASET (FILE-ID-ERRQST)
 16076*        RIDFLD  (ERRQST-KEY)
 16077*        UPDATE
 16078*    END-EXEC.
 16079*    MOVE '&"S        EU         (   #00014043' TO DFHEIV0
 16080     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16082     MOVE X'2020233030303134303433' TO DFHEIV0(25:11)
 16083     CALL 'kxdfhei1' USING DFHEIV0,
 16084           FILE-ID-ERRQST,
 16085           DFHEIV20,
 16086           DFHEIV99,
 16087           ERRQST-KEY,
 16088           DFHEIV99,
 16089           DFHEIV99,
 16090           DFHEIV99
 16091     SET ADDRESS OF AR-REQUEST-RECORD TO
 16092         DFHEIV20
 16093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16094
 16095
 16096     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 296
* EL6311.cbl
 16097
 16098     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16099
 16100     MOVE 'D'                      TO JP-RECORD-TYPE.
 16101     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16102
 16103
 16104* EXEC CICS DELETE
 16105*         DATASET    (FILE-ID-ERRQST)
 16106*    END-EXEC.
 16107*    MOVE '&(                    &   #00014057' TO DFHEIV0
 16108     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16109     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16110     MOVE X'2020233030303134303537' TO DFHEIV0(25:11)
 16111     CALL 'kxdfhei1' USING DFHEIV0,
 16112           FILE-ID-ERRQST,
 16113           DFHEIV99,
 16114           DFHEIV99,
 16115           DFHEIV99,
 16116           DFHEIV99
 16117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16118
 16119
 16120     PERFORM 8400-LOG-JOURNAL-RECORD.
 16121
 16122 2480-DELETE-FINISHED.
 16123     MOVE ZEROS                  TO EMI-ERROR.
 16124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16125     MOVE LOW-VALUES             TO EL631CI.
 16126     MOVE -1                     TO CMAINTL.
 16127     GO TO 8100-SEND-INITIAL-MAP.
 16128
 16129 2485-BATCH-HDR-NOT-FOUND.
 16130     MOVE -1                     TO CMAINTL
 16131     MOVE AL-UABON               TO CMAINTA.
 16132     MOVE ER-7450                TO EMI-ERROR.
 16133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16134     GO TO 8200-SEND-DATAONLY.
 16135
 16136 2490-RECORD-NOT-FOUND.
 16137     MOVE -1                     TO CMAINTL
 16138     MOVE AL-UABON               TO CMAINTA.
 16139     MOVE ER-7451                TO EMI-ERROR.
 16140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16141     GO TO 8200-SEND-DATAONLY.
 16142
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 297
* EL6311.cbl
 16144
 16145***************************************************************
 16146*                                                             *
 16147*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16148*                                                             *
 16149***************************************************************
 16150
 16151***************************************************************
 16152*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16153*     AN ALREADY BILLED RECORD.                               *
 16154***************************************************************
 16155
 16156 2700-BUILD-CORRECTION-RECORD.
 16157     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16158     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16159     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16160     MOVE '5'                    TO DC-OPTION-CODE.
 16161     PERFORM 9700-DATE-LINK.
 16162     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16163
 16164     IF PB-CHG-COUNT = ZEROS
 16165        MOVE +1                  TO WS-SEQ-SAVE
 16166     ELSE
 16167        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16168
 16169     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16170     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16171
 16172     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16173
 16174     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16175     MOVE 'A'                    TO JP-RECORD-TYPE.
 16176     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16177
 16178
 16179* EXEC CICS WRITE
 16180*        DATASET    (FILE-ID-ERPNDB)
 16181*        FROM       (PENDING-BUSINESS)
 16182*        RIDFLD     (PB-CONTROL-PRIMARY)
 16183*    END-EXEC.
 16184     MOVE LENGTH OF
 16185      PENDING-BUSINESS
 16186       TO DFHEIV11
 16187*    MOVE '&$ L                  ''   #00014119' TO DFHEIV0
 16188     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16189     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16190     MOVE X'2020233030303134313139' TO DFHEIV0(25:11)
 16191     CALL 'kxdfhei1' USING DFHEIV0,
 16192           FILE-ID-ERPNDB,
 16193           PENDING-BUSINESS,
 16194           DFHEIV11,
 16195           PB-CONTROL-PRIMARY,
 16196           DFHEIV99,
 16197           DFHEIV99
 16198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16199
 16200
 16201     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 298
* EL6311.cbl
 16202
 16203     PERFORM 8400-LOG-JOURNAL-RECORD.
 16204
 16205 2799-EXIT.
 16206      EXIT.
 16207
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 299
* EL6311.cbl
 16209
 16210******************************************************************
 16211*                                                                *
 16212*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16213*                                                                *
 16214******************************************************************
 16215
 16216 2800-REWRITE-ISSUE-CERT-KEY.
 16217     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16218
 16219     IF  BCERTNOL GREATER THAN ZEROS
 16220         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16221
 16222     IF  BSUFIXL  GREATER THAN ZEROS
 16223         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16224
 16225     IF  BEFFDTL  GREATER THAN ZEROS
 16226         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16227
 16228 2810-READ-BY-ACCOUNT.
 16229
 16230* EXEC CICS HANDLE CONDITION
 16231*         NOTFND    (2820-PROCESS-REWRITE)
 16232*    END-EXEC.
 16233*    MOVE '"$I                   ! = #00014153' TO DFHEIV0
 16234     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16236     MOVE X'3D20233030303134313533' TO DFHEIV0(25:11)
 16237     CALL 'kxdfhei1' USING DFHEIV0
 16238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16239
 16240
 16241
 16242* EXEC CICS READ
 16243*        SET     (ADDRESS OF PENDING-BUSINESS)
 16244*        DATASET (FILE-ID-ERPNDB2)
 16245*        RIDFLD  (ERPNDB-ALT-KEY)
 16246*    END-EXEC.
 16247*    MOVE '&"S        E          (   #00014157' TO DFHEIV0
 16248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16250     MOVE X'2020233030303134313537' TO DFHEIV0(25:11)
 16251     CALL 'kxdfhei1' USING DFHEIV0,
 16252           FILE-ID-ERPNDB2,
 16253           DFHEIV20,
 16254           DFHEIV99,
 16255           ERPNDB-ALT-KEY,
 16256           DFHEIV99,
 16257           DFHEIV99,
 16258           DFHEIV99
 16259     SET ADDRESS OF PENDING-BUSINESS TO
 16260         DFHEIV20
 16261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16262
 16263
 16264     GO TO 2890-DUPLICATE-RECORD.
 16265
 16266  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 300
* EL6311.cbl
 16267
 16268* EXEC CICS HANDLE CONDITION
 16269*         NOTFND    (2885-RECORD-MISSING)
 16270*    END-EXEC.
 16271*    MOVE '"$I                   ! > #00014166' TO DFHEIV0
 16272     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16274     MOVE X'3E20233030303134313636' TO DFHEIV0(25:11)
 16275     CALL 'kxdfhei1' USING DFHEIV0
 16276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16277
 16278
 16279     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16280
 16281
 16282* EXEC CICS READ
 16283*        SET     (ADDRESS OF PENDING-BUSINESS)
 16284*        DATASET (FILE-ID-ERPNDB)
 16285*        RIDFLD  (ERPNDB-KEY)
 16286*        UPDATE
 16287*    END-EXEC.
 16288*    MOVE '&"S        EU         (   #00014172' TO DFHEIV0
 16289     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16290     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16291     MOVE X'2020233030303134313732' TO DFHEIV0(25:11)
 16292     CALL 'kxdfhei1' USING DFHEIV0,
 16293           FILE-ID-ERPNDB,
 16294           DFHEIV20,
 16295           DFHEIV99,
 16296           ERPNDB-KEY,
 16297           DFHEIV99,
 16298           DFHEIV99,
 16299           DFHEIV99
 16300     SET ADDRESS OF PENDING-BUSINESS TO
 16301         DFHEIV20
 16302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16303
 16304
 16305     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16306     MOVE 'D'                    TO JP-RECORD-TYPE.
 16307     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16308     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16309
 16310     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16311
 16312     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16313     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16314     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16315
 16316
 16317* EXEC CICS DELETE
 16318*        DATASET    (FILE-ID-ERPNDB)
 16319*    END-EXEC.
 16320*    MOVE '&(                    &   #00014190' TO DFHEIV0
 16321     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16322     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16323     MOVE X'2020233030303134313930' TO DFHEIV0(25:11)
 16324     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 301
* EL6311.cbl
 16325           FILE-ID-ERPNDB,
 16326           DFHEIV99,
 16327           DFHEIV99,
 16328           DFHEIV99,
 16329           DFHEIV99
 16330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16331
 16332
 16333     PERFORM 8400-LOG-JOURNAL-RECORD.
 16334
 16335
 16336* EXEC CICS GETMAIN
 16337*        SET      (ADDRESS OF PENDING-BUSINESS)
 16338*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16339*        INITIMG  (GETMAIN-SPACE)
 16340*    END-EXEC.
 16341*    MOVE ',"IL                  $   #00014196' TO DFHEIV0
 16342     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16343     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16344     MOVE X'2020233030303134313936' TO DFHEIV0(25:11)
 16345     CALL 'kxdfhei1' USING DFHEIV0,
 16346           DFHEIV20,
 16347           ERPNDB-RECORD-LENGTH,
 16348           GETMAIN-SPACE
 16349     SET ADDRESS OF PENDING-BUSINESS TO
 16350         DFHEIV20
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16355
 16356
 16357* EXEC CICS HANDLE CONDITION
 16358*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16359*    END-EXEC.
 16360*    MOVE '"$I                   ! ? #00014204' TO DFHEIV0
 16361     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16363     MOVE X'3F20233030303134323034' TO DFHEIV0(25:11)
 16364     CALL 'kxdfhei1' USING DFHEIV0
 16365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16366
 16367
 16368
 16369* EXEC CICS READ
 16370*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16371*        DATASET (FILE-ID-ELCERT)
 16372*        RIDFLD  (ELCERT-KEY)
 16373*        UPDATE
 16374*    END-EXEC.
 16375*    MOVE '&"S        EU         (   #00014208' TO DFHEIV0
 16376     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16377     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16378     MOVE X'2020233030303134323038' TO DFHEIV0(25:11)
 16379     CALL 'kxdfhei1' USING DFHEIV0,
 16380           FILE-ID-ELCERT,
 16381           DFHEIV20,
 16382           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 302
* EL6311.cbl
 16383           ELCERT-KEY,
 16384           DFHEIV99,
 16385           DFHEIV99,
 16386           DFHEIV99
 16387     SET ADDRESS OF CERTIFICATE-MASTER TO
 16388         DFHEIV20
 16389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16390
 16391
 16392     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16393     MOVE 'B'                    TO JP-RECORD-TYPE
 16394     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16395     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16396
 16397     IF INSURED-ADDR-PRESENT
 16398        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16399
 16400     IF CERT-NOTES-ARE-NOT-PRESENT
 16401        MOVE SPACE               TO WS-CERT-NOTE-SW
 16402     ELSE
 16403        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16404
 16405     IF CERT-ADDED-BATCH      OR
 16406        CERT-AND-CLAIM-ONLINE OR
 16407        CERT-WAS-CREATED-FOR-CLAIM
 16408        NEXT SENTENCE
 16409     ELSE
 16410        GO TO 2825-DELETE-CERTIFICATE.
 16411
 16412     PERFORM 8400-LOG-JOURNAL-RECORD.
 16413
 16414*********************************************************
 16415** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16416     IF CERT-ADDED-BATCH
 16417         GO TO 2822-REWRITE-ELCERT.
 16418*********************************************************
 16419
 16420     IF NO-CLAIM-ATTACHED
 16421        NEXT SENTENCE
 16422     ELSE
 16423        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16424        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16425
 16426 2822-REWRITE-ELCERT.
 16427     MOVE 'C'                    TO JP-RECORD-TYPE
 16428     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16429
 16430     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16431
 16432
 16433* EXEC CICS REWRITE
 16434*         DATASET    (FILE-ID-ELCERT)
 16435*         FROM       (CERTIFICATE-MASTER)
 16436*    END-EXEC.
 16437     MOVE LENGTH OF
 16438      CERTIFICATE-MASTER
 16439       TO DFHEIV11
 16440*    MOVE '&& L                  %   #00014255' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 303
* EL6311.cbl
 16441     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16442     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16443     MOVE X'2020233030303134323535' TO DFHEIV0(25:11)
 16444     CALL 'kxdfhei1' USING DFHEIV0,
 16445           FILE-ID-ELCERT,
 16446           CERTIFICATE-MASTER,
 16447           DFHEIV11,
 16448           DFHEIV99
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16450
 16451
 16452     PERFORM 8400-LOG-JOURNAL-RECORD.
 16453
 16454     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16455
 16456 2825-DELETE-CERTIFICATE.
 16457     MOVE 'D'                      TO JP-RECORD-TYPE.
 16458     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16459
 16460     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16461
 16462
 16463* EXEC CICS DELETE
 16464*         DATASET    (FILE-ID-ELCERT)
 16465*    END-EXEC.
 16466*    MOVE '&(                    &   #00014270' TO DFHEIV0
 16467     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16469     MOVE X'2020233030303134323730' TO DFHEIV0(25:11)
 16470     CALL 'kxdfhei1' USING DFHEIV0,
 16471           FILE-ID-ELCERT,
 16472           DFHEIV99,
 16473           DFHEIV99,
 16474           DFHEIV99,
 16475           DFHEIV99
 16476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16477
 16478
 16479     PERFORM 8400-LOG-JOURNAL-RECORD.
 16480
 16481******************************************************************
 16482*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16483******************************************************************
 16484
 16485     IF CERT-NOTES-ARE-PRESENT
 16486        NEXT SENTENCE
 16487     ELSE
 16488        GO TO 2827-DELETE-MAILING.
 16489
 16490
 16491* EXEC CICS HANDLE CONDITION
 16492*         NOTFND  (2827-DELETE-MAILING)
 16493*    END-EXEC.
 16494*    MOVE '"$I                   ! @ #00014285' TO DFHEIV0
 16495     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16497     MOVE X'4020233030303134323835' TO DFHEIV0(25:11)
 16498     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 304
* EL6311.cbl
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502
 16503* EXEC CICS READ
 16504*        EQUAL
 16505*        DATASET   (FILE-ID-ERNOTE)
 16506*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16507*        RIDFLD    (ELCERT-KEY)
 16508*        UPDATE
 16509*    END-EXEC.
 16510*    MOVE '&"S        EU         (   #00014289' TO DFHEIV0
 16511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16513     MOVE X'2020233030303134323839' TO DFHEIV0(25:11)
 16514     CALL 'kxdfhei1' USING DFHEIV0,
 16515           FILE-ID-ERNOTE,
 16516           DFHEIV20,
 16517           DFHEIV99,
 16518           ELCERT-KEY,
 16519           DFHEIV99,
 16520           DFHEIV99,
 16521           DFHEIV99
 16522     SET ADDRESS OF CERTIFICATE-NOTE TO
 16523         DFHEIV20
 16524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16525
 16526
 16527     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16528     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16529     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16530
 16531     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16532
 16533
 16534* EXEC CICS DELETE
 16535*        DATASET   (FILE-ID-ERNOTE)
 16536*    END-EXEC.
 16537*    MOVE '&(                    &   #00014303' TO DFHEIV0
 16538     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16540     MOVE X'2020233030303134333033' TO DFHEIV0(25:11)
 16541     CALL 'kxdfhei1' USING DFHEIV0,
 16542           FILE-ID-ERNOTE,
 16543           DFHEIV99,
 16544           DFHEIV99,
 16545           DFHEIV99,
 16546           DFHEIV99
 16547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16548
 16549
 16550     PERFORM 8400-LOG-JOURNAL-RECORD.
 16551
 16552******************************************************************
 16553*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16554******************************************************************
 16555
 16556 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 305
* EL6311.cbl
 16557     IF CERT-ADDRESS-PRESENT
 16558        NEXT SENTENCE
 16559     ELSE
 16560        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16561
 16562
 16563* EXEC CICS HANDLE CONDITION
 16564*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16565*    END-EXEC.
 16566*    MOVE '"$I                   ! A #00014319' TO DFHEIV0
 16567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16569     MOVE X'4120233030303134333139' TO DFHEIV0(25:11)
 16570     CALL 'kxdfhei1' USING DFHEIV0
 16571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16572
 16573
 16574     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16575
 16576
 16577* EXEC CICS READ
 16578*        EQUAL
 16579*        DATASET   (FILE-ID-ERMAIL)
 16580*        SET       (ADDRESS OF MAILING-DATA)
 16581*        RIDFLD    (ERMAIL-KEY)
 16582*        UPDATE
 16583*    END-EXEC.
 16584*    MOVE '&"S        EU         (   #00014325' TO DFHEIV0
 16585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16587     MOVE X'2020233030303134333235' TO DFHEIV0(25:11)
 16588     CALL 'kxdfhei1' USING DFHEIV0,
 16589           FILE-ID-ERMAIL,
 16590           DFHEIV20,
 16591           DFHEIV99,
 16592           ERMAIL-KEY,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     SET ADDRESS OF MAILING-DATA TO
 16597         DFHEIV20
 16598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16599
 16600
 16601     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16602     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16603     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16604
 16605     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16606
 16607
 16608* EXEC CICS DELETE
 16609*        DATASET   (FILE-ID-ERMAIL)
 16610*    END-EXEC.
 16611*    MOVE '&(                    &   #00014339' TO DFHEIV0
 16612     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16614     MOVE X'2020233030303134333339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 306
* EL6311.cbl
 16615     CALL 'kxdfhei1' USING DFHEIV0,
 16616           FILE-ID-ERMAIL,
 16617           DFHEIV99,
 16618           DFHEIV99,
 16619           DFHEIV99,
 16620           DFHEIV99
 16621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16622
 16623
 16624     PERFORM 8400-LOG-JOURNAL-RECORD.
 16625
 16626 2830-BUILD-NEW-ISSUE-RECORD.
 16627     MOVE SPACES                 TO ELCERT-KEY.
 16628
 16629     IF  BCERTNOL GREATER THAN ZEROS
 16630         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16631
 16632     IF  BSUFIXL  GREATER THAN ZEROS
 16633         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16634
 16635     IF BEFFDTL GREATER THAN ZEROS
 16636        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16637
 16638 2870-WRITE-PENDING-BUSINESS.
 16639     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16640     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16641     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16642     MOVE '5'                    TO DC-OPTION-CODE.
 16643     PERFORM 9700-DATE-LINK.
 16644     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16645
 16646     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16647
 16648     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16649     MOVE 'A'                    TO JP-RECORD-TYPE.
 16650     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16651
 16652
 16653* EXEC CICS WRITE
 16654*        DATASET  (FILE-ID-ERPNDB)
 16655*        FROM     (PENDING-BUSINESS)
 16656*        RIDFLD   (PB-CONTROL-PRIMARY)
 16657*    END-EXEC.
 16658     MOVE LENGTH OF
 16659      PENDING-BUSINESS
 16660       TO DFHEIV11
 16661*    MOVE '&$ L                  ''   #00014371' TO DFHEIV0
 16662     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16664     MOVE X'2020233030303134333731' TO DFHEIV0(25:11)
 16665     CALL 'kxdfhei1' USING DFHEIV0,
 16666           FILE-ID-ERPNDB,
 16667           PENDING-BUSINESS,
 16668           DFHEIV11,
 16669           PB-CONTROL-PRIMARY,
 16670           DFHEIV99,
 16671           DFHEIV99
 16672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 307
* EL6311.cbl
 16673
 16674
 16675     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16676
 16677     PERFORM 8400-LOG-JOURNAL-RECORD.
 16678
 16679     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16680
 16681 2885-RECORD-MISSING.
 16682     MOVE -1                     TO BMAINTL
 16683     MOVE AL-UABON               TO BMAINTA
 16684     MOVE ER-2902                TO EMI-ERROR.
 16685     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16686     GO TO 8200-SEND-DATAONLY.
 16687
 16688 2890-DUPLICATE-RECORD.
 16689     MOVE -1                     TO BMAINTL.
 16690     MOVE AL-UABON               TO BCERTNOA.
 16691     MOVE AL-UNBON               TO BEFFDTA.
 16692     MOVE SPACE                  TO BMAINTI.
 16693
 16694     MOVE 1                      TO EMI-SUB
 16695                                    EMI-SWITCH1
 16696                                    EMI-SWITCH-AREA-1
 16697                                    EMI-SWITCH-AREA-2.
 16698
 16699     MOVE SPACES                 TO EMI-ERROR-LINES.
 16700
 16701
 16702* EXEC CICS SYNCPOINT ROLLBACK
 16703*    END-EXEC.
 16704*    MOVE '6"R                   !   #00014403' TO DFHEIV0
 16705     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16707     MOVE X'2020233030303134343033' TO DFHEIV0(25:11)
 16708     CALL 'kxdfhei1' USING DFHEIV0
 16709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16710
 16711
 16712     MOVE ER-2247                TO EMI-ERROR.
 16713     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16714     GO TO 8200-SEND-DATAONLY.
 16715
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 308
* EL6311.cbl
 16717
 16718******************************************************************
 16719*                                                                *
 16720*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16721*                                                                *
 16722******************************************************************
 16723
 16724 2900-REWRITE-CAN-CERT-KEY.
 16725     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16726
 16727     IF  CCERTNOL GREATER THAN ZEROS
 16728         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16729
 16730     IF  CSUFIXL  GREATER THAN ZEROS
 16731         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16732
 16733     IF  CEFFDTL  GREATER THAN ZEROS
 16734         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16735
 16736 2910-READ-BY-ACCOUNT.
 16737
 16738* EXEC CICS HANDLE CONDITION
 16739*         NOTFND    (2920-PROCESS-REWRITE)
 16740*    END-EXEC.
 16741*    MOVE '"$I                   ! B #00014431' TO DFHEIV0
 16742     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16744     MOVE X'4220233030303134343331' TO DFHEIV0(25:11)
 16745     CALL 'kxdfhei1' USING DFHEIV0
 16746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16747
 16748
 16749
 16750* EXEC CICS READ
 16751*        SET     (ADDRESS OF PENDING-BUSINESS)
 16752*        DATASET (FILE-ID-ERPNDB2)
 16753*        RIDFLD  (ERPNDB-ALT-KEY)
 16754*    END-EXEC.
 16755*    MOVE '&"S        E          (   #00014435' TO DFHEIV0
 16756     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16758     MOVE X'2020233030303134343335' TO DFHEIV0(25:11)
 16759     CALL 'kxdfhei1' USING DFHEIV0,
 16760           FILE-ID-ERPNDB2,
 16761           DFHEIV20,
 16762           DFHEIV99,
 16763           ERPNDB-ALT-KEY,
 16764           DFHEIV99,
 16765           DFHEIV99,
 16766           DFHEIV99
 16767     SET ADDRESS OF PENDING-BUSINESS TO
 16768         DFHEIV20
 16769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16770
 16771
 16772     GO TO 2990-DUPLICATE-RECORD.
 16773
 16774  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 309
* EL6311.cbl
 16775
 16776* EXEC CICS HANDLE CONDITION
 16777*         NOTFND    (2985-RECORD-MISSING)
 16778*    END-EXEC.
 16779*    MOVE '"$I                   ! C #00014444' TO DFHEIV0
 16780     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16782     MOVE X'4320233030303134343434' TO DFHEIV0(25:11)
 16783     CALL 'kxdfhei1' USING DFHEIV0
 16784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16785
 16786
 16787     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16788
 16789
 16790* EXEC CICS READ
 16791*        SET     (ADDRESS OF PENDING-BUSINESS)
 16792*        DATASET (FILE-ID-ERPNDB)
 16793*        RIDFLD  (ERPNDB-KEY)
 16794*        UPDATE
 16795*    END-EXEC.
 16796*    MOVE '&"S        EU         (   #00014450' TO DFHEIV0
 16797     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16798     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16799     MOVE X'2020233030303134343530' TO DFHEIV0(25:11)
 16800     CALL 'kxdfhei1' USING DFHEIV0,
 16801           FILE-ID-ERPNDB,
 16802           DFHEIV20,
 16803           DFHEIV99,
 16804           ERPNDB-KEY,
 16805           DFHEIV99,
 16806           DFHEIV99,
 16807           DFHEIV99
 16808     SET ADDRESS OF PENDING-BUSINESS TO
 16809         DFHEIV20
 16810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16811
 16812
 16813     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16814     MOVE 'D'                    TO JP-RECORD-TYPE.
 16815     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16816     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16817
 16818     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16819
 16820     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16821     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16822     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16823
 16824
 16825* EXEC CICS DELETE
 16826*        DATASET    (FILE-ID-ERPNDB)
 16827*    END-EXEC.
 16828*    MOVE '&(                    &   #00014468' TO DFHEIV0
 16829     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16831     MOVE X'2020233030303134343638' TO DFHEIV0(25:11)
 16832     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 310
* EL6311.cbl
 16833           FILE-ID-ERPNDB,
 16834           DFHEIV99,
 16835           DFHEIV99,
 16836           DFHEIV99,
 16837           DFHEIV99
 16838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16839
 16840
 16841     PERFORM 8400-LOG-JOURNAL-RECORD.
 16842
 16843
 16844* EXEC CICS GETMAIN
 16845*        SET      (ADDRESS OF PENDING-BUSINESS)
 16846*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16847*        INITIMG  (GETMAIN-SPACE)
 16848*    END-EXEC.
 16849*    MOVE ',"IL                  $   #00014474' TO DFHEIV0
 16850     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16851     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16852     MOVE X'2020233030303134343734' TO DFHEIV0(25:11)
 16853     CALL 'kxdfhei1' USING DFHEIV0,
 16854           DFHEIV20,
 16855           ERPNDB-RECORD-LENGTH,
 16856           GETMAIN-SPACE
 16857     SET ADDRESS OF PENDING-BUSINESS TO
 16858         DFHEIV20
 16859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16860
 16861
 16862     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16863
 16864 2950-PROCESS-CANCELS.
 16865
 16866
 16867* EXEC CICS HANDLE CONDITION
 16868*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16869*    END-EXEC.
 16870*    MOVE '"$I                   ! D #00014484' TO DFHEIV0
 16871     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16873     MOVE X'4420233030303134343834' TO DFHEIV0(25:11)
 16874     CALL 'kxdfhei1' USING DFHEIV0
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16876
 16877
 16878
 16879* EXEC CICS READ
 16880*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16881*        DATASET (FILE-ID-ELCERT)
 16882*        RIDFLD  (ELCERT-KEY)
 16883*        UPDATE
 16884*    END-EXEC.
 16885*    MOVE '&"S        EU         (   #00014488' TO DFHEIV0
 16886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16888     MOVE X'2020233030303134343838' TO DFHEIV0(25:11)
 16889     CALL 'kxdfhei1' USING DFHEIV0,
 16890           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 311
* EL6311.cbl
 16891           DFHEIV20,
 16892           DFHEIV99,
 16893           ELCERT-KEY,
 16894           DFHEIV99,
 16895           DFHEIV99,
 16896           DFHEIV99
 16897     SET ADDRESS OF CERTIFICATE-MASTER TO
 16898         DFHEIV20
 16899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16900
 16901
 16902     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16903
 16904     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16905     MOVE 'B'                      TO JP-RECORD-TYPE.
 16906     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16907     PERFORM 8400-LOG-JOURNAL-RECORD.
 16908
 16909     IF PB-CI-LIVES NOT NUMERIC
 16910         MOVE ZERO                    TO PB-CI-LIVES.
 16911
 16912     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16913        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16914        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16915        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16916                                         CM-LF-CANCEL-DT
 16917     ELSE
 16918        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16919        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16920        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16921        MOVE PB-CI-LIVES              TO CM-LIVES.
 16922
 16923     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16924        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16925            MOVE CM-LF-STATUS-AT-CANCEL
 16926                                     TO CM-LF-CURRENT-STATUS
 16927            MOVE SPACE
 16928                                     TO CM-LF-STATUS-AT-CANCEL
 16929        ELSE
 16930            MOVE PB-CI-LF-POLICY-STATUS
 16931                                     TO CM-LF-CURRENT-STATUS
 16932     ELSE
 16933        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16934
 16935     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16936        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16937        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16938        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16939                                         CM-AH-CANCEL-DT
 16940     ELSE
 16941        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16942        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16943        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16944        MOVE PB-CI-LIVES              TO CM-LIVES.
 16945
 16946     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16947        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16948            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 312
* EL6311.cbl
 16949                                     TO CM-AH-CURRENT-STATUS
 16950            MOVE SPACE
 16951                                     TO CM-AH-STATUS-AT-CANCEL
 16952        ELSE
 16953            MOVE PB-CI-AH-POLICY-STATUS
 16954                                     TO CM-AH-CURRENT-STATUS
 16955     ELSE
 16956        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16957
 16958 2975-REWRITE-CERT.
 16959     MOVE 'C'                      TO JP-RECORD-TYPE.
 16960     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16961
 16962
 16963* EXEC CICS REWRITE
 16964*        DATASET    (FILE-ID-ELCERT)
 16965*        FROM       (CERTIFICATE-MASTER)
 16966*    END-EXEC.
 16967     MOVE LENGTH OF
 16968      CERTIFICATE-MASTER
 16969       TO DFHEIV11
 16970*    MOVE '&& L                  %   #00014555' TO DFHEIV0
 16971     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16972     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16973     MOVE X'2020233030303134353535' TO DFHEIV0(25:11)
 16974     CALL 'kxdfhei1' USING DFHEIV0,
 16975           FILE-ID-ELCERT,
 16976           CERTIFICATE-MASTER,
 16977           DFHEIV11,
 16978           DFHEIV99
 16979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16980
 16981
 16982     PERFORM 8400-LOG-JOURNAL-RECORD.
 16983
 16984 2960-BUILD-NEW-CANCEL-RECORD.
 16985     IF  CCERTNOL GREATER THAN ZEROS
 16986         MOVE CCERTNOI            TO PB-CERT-PRIME.
 16987
 16988     IF  CSUFIXL  GREATER THAN ZEROS
 16989         MOVE CSUFIXI             TO PB-CERT-SFX.
 16990
 16991     IF  CEFFDTL  GREATER  THAN ZEROS
 16992         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 16993
 16994 2970-WRITE-PENDING-BUSINESS.
 16995     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16996     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16997     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16998     MOVE '5'                    TO DC-OPTION-CODE.
 16999     PERFORM 9700-DATE-LINK.
 17000     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17001
 17002     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17003
 17004     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17005                                    PB-CI-INSURED-SEX
 17006                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 313
* EL6311.cbl
 17007                                    PB-CI-AH-BENEFIT-CD
 17008                                    PB-CI-RATE-CLASS
 17009                                    PB-CI-RATE-DEV-LF
 17010                                    PB-CI-RATE-DEV-AH
 17011                                    PB-CI-LF-ABBR
 17012                                    PB-CI-AH-ABBR
 17013                                    PB-CI-OB-FLAG
 17014                                    PB-CI-LF-POLICY-STATUS
 17015                                    PB-CI-AH-POLICY-STATUS
 17016                                    PB-CI-INDV-GRP-CD
 17017                                    PB-CI-BENEFICIARY-NAME
 17018                                    PB-CI-NOTE-SW
 17019                                    PB-CI-SOC-SEC-NO
 17020                                    PB-CI-MEMBER-NO
 17021                                    PB-CI-INT-CODE
 17022                                    PB-CI-COMP-EXCP-SW
 17023                                    PB-CI-ENTRY-STATUS
 17024                                    PB-CI-CREDIT-INTERFACE-SW-1
 17025                                    PB-CI-CREDIT-INTERFACE-SW-2
 17026                                    PB-CI-ENTRY-BATCH.
 17027
 17028     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17029                                    PB-CI-AH-SETTLEMENT-DT
 17030                                    PB-CI-DEATH-DT
 17031                                    PB-CI-LF-PRIOR-CANCEL-DT
 17032                                    PB-CI-AH-PRIOR-CANCEL-DT
 17033                                    PB-CI-LOAN-1ST-PMT-DT
 17034                                    PB-CI-ENTRY-DT
 17035                                    PB-CI-LF-EXPIRE-DT
 17036                                    PB-CI-AH-EXPIRE-DT.
 17037
 17038     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17039                                    PB-CI-LF-TERM
 17040                                    PB-CI-LF-BENEFIT-AMT
 17041                                    PB-CI-LF-ALT-BENEFIT-AMT
 17042                                    PB-CI-LF-PREMIUM-AMT
 17043                                    PB-CI-LF-ALT-PREMIUM-AMT
 17044                                    PB-CI-AH-TERM
 17045                                    PB-CI-AH-BENEFIT-AMT
 17046                                    PB-CI-AH-PREMIUM-AMT
 17047                                    PB-CI-RATE-DEV-PCT-LF
 17048                                    PB-CI-RATE-DEV-PCT-AH
 17049                                    PB-CI-LIFE-COMMISSION
 17050                                    PB-CI-AH-COMMISSION
 17051                                    PB-CI-PAY-FREQUENCY
 17052                                    PB-CI-LOAN-APR
 17053                                    PB-CI-LOAN-TERM
 17054                                    PB-CI-CURR-SEQ
 17055                                    PB-CI-AH-CANCEL-AMT
 17056                                    PB-CI-LF-CANCEL-AMT
 17057                                    PB-CI-EXTENTION-DAYS
 17058                                    PB-CI-TERM-IN-DAYS
 17059                                    PB-CI-LOAN-OFFICER
 17060                                    PB-CI-LIVES
 17061                                    PB-CI-LF-CRIT-PER
 17062                                    PB-CI-AH-CRIT-PER
 17063                                    PB-C-LF-REM-TERM
 17064                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 314
* EL6311.cbl
 17065
 17066     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17067     MOVE 'A'                    TO JP-RECORD-TYPE.
 17068     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17069
 17070
 17071* EXEC CICS HANDLE CONDITION
 17072*        DUPREC   (2990-DUPLICATE-RECORD)
 17073*    END-EXEC.
 17074*    MOVE '"$%                   ! E #00014648' TO DFHEIV0
 17075     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17076     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17077     MOVE X'4520233030303134363438' TO DFHEIV0(25:11)
 17078     CALL 'kxdfhei1' USING DFHEIV0
 17079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17080
 17081
 17082
 17083* EXEC CICS WRITE
 17084*        DATASET  (FILE-ID-ERPNDB)
 17085*        FROM     (PENDING-BUSINESS)
 17086*        RIDFLD   (PB-CONTROL-PRIMARY)
 17087*    END-EXEC.
 17088     MOVE LENGTH OF
 17089      PENDING-BUSINESS
 17090       TO DFHEIV11
 17091*    MOVE '&$ L                  ''   #00014652' TO DFHEIV0
 17092     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17094     MOVE X'2020233030303134363532' TO DFHEIV0(25:11)
 17095     CALL 'kxdfhei1' USING DFHEIV0,
 17096           FILE-ID-ERPNDB,
 17097           PENDING-BUSINESS,
 17098           DFHEIV11,
 17099           PB-CONTROL-PRIMARY,
 17100           DFHEIV99,
 17101           DFHEIV99
 17102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17103
 17104
 17105     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17106
 17107     PERFORM 8400-LOG-JOURNAL-RECORD.
 17108
 17109     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17110
 17111 2985-RECORD-MISSING.
 17112     MOVE -1                     TO CMAINTL
 17113     MOVE AL-UABON               TO CMAINTA.
 17114
 17115     MOVE ER-2902                TO EMI-ERROR.
 17116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17117     GO TO 8200-SEND-DATAONLY.
 17118
 17119 2990-DUPLICATE-RECORD.
 17120     MOVE SPACE                  TO CMAINTI.
 17121     MOVE -1                     TO CMAINTL.
 17122     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 315
* EL6311.cbl
 17123     MOVE AL-UNBON               TO CEFFDTA.
 17124
 17125     MOVE 1                      TO EMI-SUB
 17126                                    EMI-SWITCH1
 17127                                    EMI-SWITCH-AREA-1
 17128                                    EMI-SWITCH-AREA-2.
 17129     MOVE SPACES                 TO EMI-ERROR-LINES.
 17130
 17131
 17132* EXEC CICS SYNCPOINT ROLLBACK
 17133*    END-EXEC.
 17134*    MOVE '6"R                   !   #00014684' TO DFHEIV0
 17135     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17137     MOVE X'2020233030303134363834' TO DFHEIV0(25:11)
 17138     CALL 'kxdfhei1' USING DFHEIV0
 17139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17140
 17141
 17142     MOVE ER-2247                TO EMI-ERROR.
 17143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17144     GO TO 8200-SEND-DATAONLY.
 17145
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 316
* EL6311.cbl
 17147
 17148***************************************************************
 17149*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17150*     PREMIUM FOR A SINGLE BATCH.                             *
 17151*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17152***************************************************************
 17153
 17154 3000-BATCH-MAINLINE.
 17155     IF PI-PREV-KEY NOT = SPACES
 17156         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17157     ELSE
 17158         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17159
 17160     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17161
 17162 3010-READNEXT.
 17163
 17164* EXEC CICS READ
 17165*         DATASET    (FILE-ID-ERPNDB)
 17166*         SET        (ADDRESS OF PENDING-BUSINESS)
 17167*         RIDFLD     (ERPNDB-KEY)
 17168*         GTEQ
 17169*    END-EXEC.
 17170*    MOVE '&"S        G          (   #00014708' TO DFHEIV0
 17171     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17172     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17173     MOVE X'2020233030303134373038' TO DFHEIV0(25:11)
 17174     CALL 'kxdfhei1' USING DFHEIV0,
 17175           FILE-ID-ERPNDB,
 17176           DFHEIV20,
 17177           DFHEIV99,
 17178           ERPNDB-KEY,
 17179           DFHEIV99,
 17180           DFHEIV99,
 17181           DFHEIV99
 17182     SET ADDRESS OF PENDING-BUSINESS TO
 17183         DFHEIV20
 17184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17185
 17186
 17187     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17188        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17189          GO TO 3030-END-BATCH.
 17190
 17191     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17192
 17193     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17194        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17195          GO TO 3020-BUMP-SEQ.
 17196
 17197     IF PB-ISSUE
 17198        ADD +1                   TO WS-ISS-TOTAL-CNT
 17199        IF PB-FATAL-ERRORS
 17200           ADD +1                      TO WS-ISS-FATAL-CNT
 17201           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17202           GO TO 3020-BUMP-SEQ
 17203        ELSE
 17204           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 317
* EL6311.cbl
 17205              ADD +1                      TO WS-ISS-FORCE-CNT
 17206              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17207              GO TO 3020-BUMP-SEQ
 17208           ELSE
 17209              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17210                 ADD +1                      TO WS-ISS-HOLD-CNT
 17211                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17212                 GO TO 3020-BUMP-SEQ
 17213              ELSE
 17214                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17215                     THRU  3299-EXIT
 17216                 GO TO 3020-BUMP-SEQ.
 17217
 17218     IF PB-CANCELLATION
 17219        ADD +1                   TO WS-CAN-TOTAL-CNT
 17220        IF PB-FATAL-ERRORS
 17221           ADD +1                 TO WS-CAN-FATAL-CNT
 17222           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17223           GO TO 3020-BUMP-SEQ
 17224        ELSE
 17225           IF PB-UNFORCED-ERRORS
 17226              ADD +1                 TO WS-CAN-FORCE-CNT
 17227              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17228              GO TO 3020-BUMP-SEQ
 17229           ELSE
 17230              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17231                 ADD +1                 TO WS-CAN-HOLD-CNT
 17232                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17233                 GO TO 3020-BUMP-SEQ
 17234              ELSE
 17235                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17236                     THRU  3499-EXIT
 17237                 GO TO 3020-BUMP-SEQ.
 17238
 17239     IF PB-BATCH-TRAILER
 17240         GO TO 3030-END-BATCH.
 17241
 17242 3020-BUMP-SEQ.
 17243     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17244     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17245     GO TO 3010-READNEXT.
 17246
 17247 3030-END-BATCH.
 17248     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17249     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17250     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17251     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17252
 17253     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17254                                          - WS-ISS-FORCE-CNT
 17255                                          - WS-ISS-HOLD-CNT).
 17256
 17257     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17258     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17259
 17260     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17261     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17262     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 318
* EL6311.cbl
 17263     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17264     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17265                                          - WS-CAN-FORCE-CNT
 17266                                          - WS-CAN-HOLD-CNT).
 17267     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17268     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17269
 17270     COMPUTE WS-NET-TOTAL-CNT
 17271         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17272     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17273     COMPUTE WS-NET-FATAL-CNT
 17274         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17275     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17276     COMPUTE WS-NET-FORCE-CNT
 17277         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17278     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17279     COMPUTE WS-NET-HOLD-CNT
 17280         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17281     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17282
 17283     COMPUTE WS-NET-AVAIL-CNT
 17284          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17285                              - WS-ISS-FORCE-CNT
 17286                              - WS-ISS-HOLD-CNT)
 17287          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17288                              - WS-CAN-FORCE-CNT
 17289                              - WS-CAN-HOLD-CNT).
 17290     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17291
 17292     COMPUTE WS-NET-GOOD-PREM
 17293         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17294     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17295     COMPUTE WS-NET-BAD-PREM
 17296         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17297     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17298
 17299     MOVE 0000                   TO EMI-ERROR.
 17300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17301     MOVE -1                     TO DPFENTRL.
 17302     GO TO 8200-SEND-DATAONLY.
 17303
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 319
* EL6311.cbl
 17305
 17306******************************************************************
 17307*                                                                *
 17308*           A D D    B A D   I S S U E   P R E M I U M           *
 17309*                                                                *
 17310******************************************************************
 17311
 17312 3100-ADD-BAD-ISSUE-PREM.
 17313     IF PB-OVERRIDE-LIFE
 17314       OR PB-OVERRIDE-BOTH
 17315           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17316           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17317       ELSE
 17318           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17319           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17320
 17321     IF PB-OVERRIDE-AH
 17322       OR PB-OVERRIDE-BOTH
 17323           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17324       ELSE
 17325           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17326
 17327 3199-EXIT.
 17328     EXIT.
 17329
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 320
* EL6311.cbl
 17331
 17332******************************************************************
 17333*                                                                *
 17334*       A D D   G O O D   I S S U E   P R E M I U M              *
 17335*                                                                *
 17336******************************************************************
 17337
 17338 3200-ADD-GOOD-ISSUE-PREM.
 17339     IF PB-OVERRIDE-LIFE
 17340       OR PB-OVERRIDE-BOTH
 17341           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17342           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17343       ELSE
 17344           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17345           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17346
 17347     IF PB-OVERRIDE-AH
 17348       OR PB-OVERRIDE-BOTH
 17349           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17350       ELSE
 17351           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17352
 17353 3299-EXIT.
 17354     EXIT.
 17355
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 321
* EL6311.cbl
 17357
 17358
 17359******************************************************************
 17360*                                                                *
 17361*        A D D   B A D   C A N C E L   P R E M I U M             *
 17362*                                                                *
 17363******************************************************************
 17364
 17365 3300-ADD-BAD-CANCEL-PREM.
 17366     IF PB-OVERRIDE-LIFE
 17367       OR PB-OVERRIDE-BOTH
 17368           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17369       ELSE
 17370           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17371
 17372     IF PB-OVERRIDE-AH
 17373       OR PB-OVERRIDE-BOTH
 17374           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17375       ELSE
 17376           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17377
 17378 3399-EXIT.
 17379     EXIT.
 17380
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 322
* EL6311.cbl
 17382
 17383******************************************************************
 17384*                                                                *
 17385*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17386*                                                                *
 17387******************************************************************
 17388
 17389 3400-ADD-GOOD-CANCEL-PREM.
 17390     IF PB-OVERRIDE-LIFE
 17391       OR PB-OVERRIDE-BOTH
 17392           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17393       ELSE
 17394           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17395
 17396     IF PB-OVERRIDE-AH
 17397       OR PB-OVERRIDE-BOTH
 17398           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17399       ELSE
 17400           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17401
 17402 3499-EXIT.
 17403     EXIT.
 17404
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 323
* EL6311.cbl
 17406
 17407******************************************************************
 17408*                                                                *
 17409*           E D I T   B A T C H   D A T A                        *
 17410*                                                                *
 17411******************************************************************
 17412
 17413 3500-EDIT-BATCH-DATA.
 17414     IF PI-PREV-KEY NOT = SPACES
 17415        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17416     ELSE
 17417        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17418
 17419     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17420     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17421
 17422
 17423* EXEC CICS HANDLE CONDITION
 17424*         NOTFND      (3590-NOT-FOUND)
 17425*    END-EXEC.
 17426*    MOVE '"$I                   ! F #00014950' TO DFHEIV0
 17427     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17429     MOVE X'4620233030303134393530' TO DFHEIV0(25:11)
 17430     CALL 'kxdfhei1' USING DFHEIV0
 17431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17432
 17433
 17434     IF DRISSL   GREATER THAN ZEROS OR
 17435        DRISSL   GREATER THAN ZEROS OR
 17436        DRLFPRML GREATER THAN ZEROS OR
 17437        DRAHPRML GREATER THAN ZEROS OR
 17438        DRCANCL  GREATER THAN ZEROS OR
 17439        DRLFRFDL GREATER THAN ZEROS OR
 17440        DRAHRFDL GREATER THAN ZEROS
 17441              NEXT SENTENCE
 17442          ELSE
 17443              MOVE ER-3224    TO EMI-ERROR
 17444              MOVE -1         TO DPFENTRL
 17445              MOVE AL-UNBON   TO DPFENTRA
 17446              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17447              GO TO 8200-SEND-DATAONLY.
 17448
 17449     IF NOT MODIFY-CAP
 17450         MOVE 'UPDATE'       TO SM-READ
 17451         PERFORM 9995-SECURITY-VIOLATION
 17452         MOVE ER-0070        TO EMI-ERROR
 17453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17454         GO TO 8100-SEND-INITIAL-MAP.
 17455
 17456        IF DRISSL GREATER THAN ZEROS
 17457           MOVE AL-UNNON         TO DRISSA
 17458           MOVE DRISSI           TO DEEDIT-FIELD
 17459           PERFORM 8600-DEEDIT
 17460           IF DEEDIT-FIELD-V0  NUMERIC
 17461              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17462           ELSE
 17463              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 324
* EL6311.cbl
 17464              MOVE -1         TO DRISSL
 17465              MOVE AL-UNBON   TO DRISSA
 17466              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17467
 17468        IF DRLFPRML GREATER THAN ZEROS
 17469           MOVE AL-UNNON         TO DRLFPRMA
 17470
 17471* EXEC CICS BIF DEEDIT
 17472*              FIELD  (DRLFPRMI)
 17473*              LENGTH (11)
 17474*          END-EXEC
 17475     MOVE 11
 17476       TO DFHEIV11
 17477*    MOVE '@"L                   #   #00014990' TO DFHEIV0
 17478     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17479     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17480     MOVE X'2020233030303134393930' TO DFHEIV0(25:11)
 17481     CALL 'kxdfhei1' USING DFHEIV0,
 17482           DRLFPRMI,
 17483           DFHEIV11
 17484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17485           IF DRLFPRMI NUMERIC
 17486              MOVE DRLFPRMI   TO WS-DRLFPRM
 17487*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17488*          PERFORM 8600-DEEDIT
 17489*          IF DEEDIT-FIELD-V2  NUMERIC
 17490*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17491           ELSE
 17492              MOVE ER-2223    TO EMI-ERROR
 17493              MOVE -1         TO DRLFPRML
 17494              MOVE AL-UNBON   TO DRLFPRMA
 17495              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17496
 17497        IF DRAHPRML GREATER THAN ZEROS
 17498           MOVE AL-UNNON         TO DRAHPRMA
 17499
 17500* EXEC CICS BIF DEEDIT
 17501*              FIELD  (DRAHPRMI)
 17502*              LENGTH (11)
 17503*          END-EXEC
 17504     MOVE 11
 17505       TO DFHEIV11
 17506*    MOVE '@"L                   #   #00015008' TO DFHEIV0
 17507     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17508     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17509     MOVE X'2020233030303135303038' TO DFHEIV0(25:11)
 17510     CALL 'kxdfhei1' USING DFHEIV0,
 17511           DRAHPRMI,
 17512           DFHEIV11
 17513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17514           IF DRAHPRMI NUMERIC
 17515              MOVE DRAHPRMI   TO WS-DRAHPRM
 17516*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17517*          PERFORM 8600-DEEDIT
 17518*          IF DEEDIT-FIELD-V2  NUMERIC
 17519*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17520           ELSE
 17521              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 325
* EL6311.cbl
 17522              MOVE -1         TO DRAHPRML
 17523              MOVE AL-UNBON   TO DRAHPRMA
 17524              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17525
 17526        IF DRCANCL GREATER THAN ZEROS
 17527           MOVE AL-UNNON         TO DRCANCA
 17528           MOVE DRCANCI          TO DEEDIT-FIELD
 17529           PERFORM 8600-DEEDIT
 17530           IF DEEDIT-FIELD-V0  NUMERIC
 17531              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17532           ELSE
 17533              MOVE ER-2223    TO EMI-ERROR
 17534              MOVE -1         TO DRCANCL
 17535              MOVE AL-UNBON   TO DRCANCL
 17536              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17537
 17538        IF DRLFRFDL GREATER THAN ZEROS
 17539           MOVE AL-UNNON         TO DRLFRFDA
 17540
 17541* EXEC CICS BIF DEEDIT
 17542*              FIELD  (DRLFRFDI)
 17543*              LENGTH (11)
 17544*          END-EXEC
 17545     MOVE 11
 17546       TO DFHEIV11
 17547*    MOVE '@"L                   #   #00015038' TO DFHEIV0
 17548     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17549     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17550     MOVE X'2020233030303135303338' TO DFHEIV0(25:11)
 17551     CALL 'kxdfhei1' USING DFHEIV0,
 17552           DRLFRFDI,
 17553           DFHEIV11
 17554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17555           IF DRLFRFDI NUMERIC
 17556              MOVE DRLFRFDI   TO WS-DRLFRFD
 17557*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17558*          PERFORM 8600-DEEDIT
 17559*          IF DEEDIT-FIELD-V2  NUMERIC
 17560*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17561           ELSE
 17562              MOVE ER-2223    TO EMI-ERROR
 17563              MOVE -1         TO DRLFRFDL
 17564              MOVE AL-UNBON   TO DRLFRFDA
 17565              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17566
 17567        IF DRAHRFDL GREATER THAN ZEROS
 17568           MOVE AL-UNNON         TO DRAHRFDA
 17569
 17570* EXEC CICS BIF DEEDIT
 17571*              FIELD  (DRAHRFDI)
 17572*              LENGTH (11)
 17573*          END-EXEC
 17574     MOVE 11
 17575       TO DFHEIV11
 17576*    MOVE '@"L                   #   #00015056' TO DFHEIV0
 17577     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17579     MOVE X'2020233030303135303536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 326
* EL6311.cbl
 17580     CALL 'kxdfhei1' USING DFHEIV0,
 17581           DRAHRFDI,
 17582           DFHEIV11
 17583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17584           IF DRAHRFDI NUMERIC
 17585              MOVE DRAHRFDI   TO WS-DRAHRFD
 17586*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17587*          PERFORM 8600-DEEDIT
 17588*          IF DEEDIT-FIELD-V2  NUMERIC
 17589*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17590           ELSE
 17591              MOVE ER-2223    TO EMI-ERROR
 17592              MOVE -1         TO DRAHRFDL
 17593              MOVE AL-UNBON   TO DRAHRFDA
 17594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17595
 17596     IF EMI-ERROR = ZEROS
 17597        GO 3600-UPDATE-BATCH-HEADER.
 17598
 17599     GO TO 8200-SEND-DATAONLY.
 17600
 17601 3590-NOT-FOUND.
 17602     MOVE ER-2192                TO EMI-ERROR.
 17603     MOVE -1                     TO DPFENTRL.
 17604     MOVE AL-UNBON               TO DPFENTRA.
 17605     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17606     GO TO 8200-SEND-DATAONLY.
 17607
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 327
* EL6311.cbl
 17609
 17610******************************************************************
 17611*                                                                *
 17612*           U P D A T E   B A T C H   H E A D E R                *
 17613*                                                                *
 17614******************************************************************
 17615
 17616 3600-UPDATE-BATCH-HEADER.
 17617
 17618* EXEC CICS HANDLE CONDITION
 17619*         NOTFND      (3690-NOT-FOUND)
 17620*    END-EXEC.
 17621*    MOVE '"$I                   ! G #00015093' TO DFHEIV0
 17622     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17624     MOVE X'4720233030303135303933' TO DFHEIV0(25:11)
 17625     CALL 'kxdfhei1' USING DFHEIV0
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17627
 17628
 17629
 17630* EXEC CICS READ
 17631*        DATASET (FILE-ID-ERPNDB)
 17632*        RIDFLD  (ERPNDB-KEY)
 17633*        SET     (ADDRESS OF PENDING-BUSINESS)
 17634*        UPDATE
 17635*    END-EXEC.
 17636*    MOVE '&"S        EU         (   #00015097' TO DFHEIV0
 17637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17639     MOVE X'2020233030303135303937' TO DFHEIV0(25:11)
 17640     CALL 'kxdfhei1' USING DFHEIV0,
 17641           FILE-ID-ERPNDB,
 17642           DFHEIV20,
 17643           DFHEIV99,
 17644           ERPNDB-KEY,
 17645           DFHEIV99,
 17646           DFHEIV99,
 17647           DFHEIV99
 17648     SET ADDRESS OF PENDING-BUSINESS TO
 17649         DFHEIV20
 17650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17651
 17652
 17653     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17654     MOVE 'B'                    TO JP-RECORD-TYPE.
 17655     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17656
 17657     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17658
 17659     PERFORM 8400-LOG-JOURNAL-RECORD.
 17660
 17661     IF DRISSL GREATER THAN ZEROS
 17662        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17663
 17664     IF DRCANCL GREATER THAN ZEROS
 17665        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17666
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 328
* EL6311.cbl
 17667
 17668     IF DRLFPRML GREATER THAN ZEROS
 17669        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17670
 17671     IF DRAHPRML GREATER THAN ZEROS
 17672        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17673
 17674     IF DRLFRFDL GREATER THAN ZEROS
 17675        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17676
 17677     IF DRAHRFDL GREATER THAN ZEROS
 17678        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17679
 17680 3670-REWRITE-BATCH-HEADER.
 17681     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17682        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17683        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17684        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17685        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17686        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17687        MOVE SPACE               TO PB-OUT-BAL-CD
 17688     ELSE
 17689        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17690
 17691     MOVE 'C'                    TO JP-RECORD-TYPE.
 17692     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17693
 17694
 17695* EXEC CICS REWRITE
 17696*         DATASET      (FILE-ID-ERPNDB)
 17697*         FROM         (PENDING-BUSINESS)
 17698*    END-EXEC.
 17699     MOVE LENGTH OF
 17700      PENDING-BUSINESS
 17701       TO DFHEIV11
 17702*    MOVE '&& L                  %   #00015145' TO DFHEIV0
 17703     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17704     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17705     MOVE X'2020233030303135313435' TO DFHEIV0(25:11)
 17706     CALL 'kxdfhei1' USING DFHEIV0,
 17707           FILE-ID-ERPNDB,
 17708           PENDING-BUSINESS,
 17709           DFHEIV11,
 17710           DFHEIV99
 17711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17712
 17713
 17714     PERFORM 8400-LOG-JOURNAL-RECORD.
 17715
 17716     GO TO 7200-DISPLAY-BATCHES.
 17717
 17718 3690-NOT-FOUND.
 17719     MOVE ER-2192                TO EMI-ERROR.
 17720     MOVE -1                     TO DPFENTRL.
 17721     MOVE AL-UNBON               TO DPFENTRA.
 17722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17723     GO TO 8200-SEND-DATAONLY.
 17724
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 329
* EL6311.cbl
 17726
 17727******************************************************************
 17728*                                                                *
 17729*           R E - D I S P L A Y   R E C O R D                    *
 17730*                                                                *
 17731******************************************************************
 17732
 17733 3900-RE-DISPLAY-RECORD.
 17734
 17735* EXEC CICS HANDLE CONDITION
 17736*         NOTFND   (3990-NOT-FOUND)
 17737*    END-EXEC.
 17738*    MOVE '"$I                   ! H #00015170' TO DFHEIV0
 17739     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17741     MOVE X'4820233030303135313730' TO DFHEIV0(25:11)
 17742     CALL 'kxdfhei1' USING DFHEIV0
 17743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17744
 17745
 17746     IF PI-DISPLAY-ORIGINAL-BATCH
 17747         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17748     ELSE
 17749         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17750
 17751
 17752* EXEC CICS READ
 17753*         DATASET   (FILE-ID)
 17754*         RIDFLD    (PI-PREV-KEY)
 17755*         SET       (ADDRESS OF PENDING-BUSINESS)
 17756*    END-EXEC.
 17757*    MOVE '&"S        E          (   #00015179' TO DFHEIV0
 17758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17760     MOVE X'2020233030303135313739' TO DFHEIV0(25:11)
 17761     CALL 'kxdfhei1' USING DFHEIV0,
 17762           FILE-ID,
 17763           DFHEIV20,
 17764           DFHEIV99,
 17765           PI-PREV-KEY,
 17766           DFHEIV99,
 17767           DFHEIV99,
 17768           DFHEIV99
 17769     SET ADDRESS OF PENDING-BUSINESS TO
 17770         DFHEIV20
 17771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17772
 17773
 17774     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17775
 17776     IF PB-ISSUE
 17777         GO TO 7000-DISPLAY-ISSUES.
 17778
 17779     IF PB-CANCELLATION
 17780         GO TO 7100-DISPLAY-CANCELS.
 17781
 17782     IF PB-BATCH-TRAILER
 17783         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 330
* EL6311.cbl
 17784
 17785 3990-NOT-FOUND.
 17786     MOVE LOW-VALUES             TO EL631BI.
 17787
 17788     IF PI-MAP-NAME = EL631B
 17789         MOVE -1                  TO BMAINTL
 17790     ELSE
 17791         MOVE -1                  TO CMAINTL.
 17792
 17793     GO TO 8100-SEND-INITIAL-MAP.
 17794
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 331
* EL6311.cbl
 17796
 17797***************************************************************
 17798*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17799*                                                             *
 17800*      1. START BROWSE WITH                                   *
 17801*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17802*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17803*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17804*                                                             *
 17805*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17806*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17807*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17808*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17809*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17810*               AND IS IT TO BE DISPLAYED.                    *
 17811*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17812*               DISPLAYED.                                    *
 17813*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17814*               DISPLAYED.                                    *
 17815*                                                             *
 17816*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17817*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17818***************************************************************
 17819
 17820 4000-BROWSE-DETAIL-FORWARD.
 17821     IF FIRST-TIME
 17822        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17823     ELSE
 17824        IF SHOW-RECORD
 17825           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17826           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17827           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17828           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17829           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17830        ELSE
 17831           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17832
 17833
 17834* EXEC CICS HANDLE CONDITION
 17835*         NOTFND   (4050-END-RECORDS)
 17836*         ENDFILE  (4050-END-RECORDS)
 17837*    END-EXEC.
 17838*    MOVE '"$I''                  ! I #00015244' TO DFHEIV0
 17839     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17841     MOVE X'4920233030303135323434' TO DFHEIV0(25:11)
 17842     CALL 'kxdfhei1' USING DFHEIV0
 17843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17844
 17845
 17846
 17847* EXEC CICS STARTBR
 17848*         DATASET   (FILE-ID-ERPNDB2)
 17849*         RIDFLD    (ERPNDB-ALT-KEY)
 17850*    END-EXEC.
 17851     MOVE 0
 17852       TO DFHEIV11
 17853*    MOVE '&,         G          &   #00015249' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 332
* EL6311.cbl
 17854     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17856     MOVE X'2020233030303135323439' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0,
 17858           FILE-ID-ERPNDB2,
 17859           ERPNDB-ALT-KEY,
 17860           DFHEIV99,
 17861           DFHEIV11,
 17862           DFHEIV99
 17863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17864
 17865
 17866     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17867
 17868     IF FIRST-TIME OR SHOW-RECORD
 17869        MOVE SPACE               TO WS-FIRST-TIME-SW
 17870        GO TO 4005-READ-NEXT-RECORD.
 17871
 17872
 17873* EXEC CICS READNEXT
 17874*         DATASET    (FILE-ID-ERPNDB2)
 17875*         SET        (ADDRESS OF PENDING-BUSINESS)
 17876*         RIDFLD     (ERPNDB-ALT-KEY)
 17877*    END-EXEC.
 17878     MOVE 0
 17879       TO DFHEIV11
 17880*    MOVE '&.S                   )   #00015260' TO DFHEIV0
 17881     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17882     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17883     MOVE X'2020233030303135323630' TO DFHEIV0(25:11)
 17884     CALL 'kxdfhei1' USING DFHEIV0,
 17885           FILE-ID-ERPNDB2,
 17886           DFHEIV20,
 17887           DFHEIV99,
 17888           ERPNDB-ALT-KEY,
 17889           DFHEIV99,
 17890           DFHEIV11,
 17891           DFHEIV99,
 17892           DFHEIV99
 17893     SET ADDRESS OF PENDING-BUSINESS TO
 17894         DFHEIV20
 17895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17896
 17897
 17898 4005-READ-NEXT-RECORD.
 17899
 17900* EXEC CICS READNEXT
 17901*         DATASET    (FILE-ID-ERPNDB2)
 17902*         SET        (ADDRESS OF PENDING-BUSINESS)
 17903*         RIDFLD     (ERPNDB-ALT-KEY)
 17904*    END-EXEC.
 17905     MOVE 0
 17906       TO DFHEIV11
 17907*    MOVE '&.S                   )   #00015267' TO DFHEIV0
 17908     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17909     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17910     MOVE X'2020233030303135323637' TO DFHEIV0(25:11)
 17911     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 333
* EL6311.cbl
 17912           FILE-ID-ERPNDB2,
 17913           DFHEIV20,
 17914           DFHEIV99,
 17915           ERPNDB-ALT-KEY,
 17916           DFHEIV99,
 17917           DFHEIV11,
 17918           DFHEIV99,
 17919           DFHEIV99
 17920     SET ADDRESS OF PENDING-BUSINESS TO
 17921         DFHEIV20
 17922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17923
 17924
 17925     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17926
 17927     IF WS-BATCH-PREFIX = '#CL'
 17928        GO TO 4005-READ-NEXT-RECORD.
 17929
 17930     IF SHOW-RECORD
 17931        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17932           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17933           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17934           PB-STATE         NOT = PI-PB-STATE          OR
 17935           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17936           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17937           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17938           GO TO 4050-END-RECORDS
 17939        ELSE
 17940           GO TO 4010-CHECK-REC-TYPE.
 17941
 17942     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17943        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17944        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17945        PB-STATE            NOT = PI-PB-STATE          OR
 17946        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17947        GO TO 4050-END-RECORDS.
 17948
 17949     IF PB-BATCH-TRAILER
 17950        GO TO 4005-READ-NEXT-RECORD.
 17951
 17952     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17953        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17954           GO TO 4005-READ-NEXT-RECORD
 17955        ELSE
 17956           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17957              GO TO 4010-CHECK-REC-TYPE
 17958           ELSE
 17959              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17960                 GO TO 4010-CHECK-REC-TYPE
 17961              ELSE
 17962                 GO TO 4005-READ-NEXT-RECORD.
 17963
 17964     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17965        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17966           GO TO 4005-READ-NEXT-RECORD.
 17967
 17968 4010-CHECK-REC-TYPE.
 17969     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 334
* EL6311.cbl
 17970         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17971             NEXT SENTENCE
 17972         ELSE
 17973             GO TO 4005-READ-NEXT-RECORD.
 17974
 17975     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17976         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17977             NEXT SENTENCE
 17978        ELSE
 17979             GO TO 4005-READ-NEXT-RECORD.
 17980
 17981     IF NOT DISPLAY-CHANGE-RECORDS AND
 17982            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17983        GO TO 4005-READ-NEXT-RECORD.
 17984
 17985     IF DISPLAY-HOLD-RECORDS AND
 17986        NOT PB-RECORD-ON-HOLD
 17987          GO TO 4005-READ-NEXT-RECORD.
 17988
 17989     IF PB-ISSUE
 17990        IF DISPLAY-CHK-REQ-RECORDS
 17991            GO TO 4005-READ-NEXT-RECORD.
 17992
 17993     IF PB-ISSUE
 17994        IF ISSUE-WITH-WARNING
 17995           IF PB-WARNING-ERRORS
 17996              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17997                  GO TO 4005-READ-NEXT-RECORD
 17998              ELSE
 17999                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18000                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18001                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18002                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18003                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18004                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18005                 GO TO 7000-DISPLAY-ISSUES
 18006           ELSE
 18007              GO TO 4005-READ-NEXT-RECORD.
 18008
 18009     IF PB-ISSUE
 18010        IF (ISSUES-IN-ERROR AND
 18011            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18012            ALL-ISSUES
 18013            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18014            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18015            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18016            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18017            MOVE PB-SV-STATE            TO PI-SV-STATE
 18018            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18019            GO TO 7000-DISPLAY-ISSUES
 18020        ELSE
 18021            GO TO 4005-READ-NEXT-RECORD.
 18022
 18023     IF PB-CANCELLATION
 18024        IF DISPLAY-CHK-REQ-RECORDS
 18025           IF PB-C-REFUND-REQUESTED
 18026              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18027              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 335
* EL6311.cbl
 18028              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18029              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18030              MOVE PB-SV-STATE            TO PI-SV-STATE
 18031              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18032              GO TO 7100-DISPLAY-CANCELS
 18033           ELSE
 18034               GO TO 4005-READ-NEXT-RECORD.
 18035
 18036     IF PB-CANCELLATION
 18037        IF CANCEL-WITH-WARNING
 18038           IF PB-WARNING-ERRORS
 18039              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18040                  GO TO 4005-READ-NEXT-RECORD
 18041              ELSE
 18042                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18043                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18044                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18045                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18046                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18047                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18048                 GO TO 7100-DISPLAY-CANCELS
 18049           ELSE
 18050              GO TO 4005-READ-NEXT-RECORD.
 18051
 18052     IF PB-CANCELLATION
 18053        IF (CANCEL-IN-ERROR  AND
 18054            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18055            ALL-CANCELS
 18056            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18057            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18058            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18059            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18060            MOVE PB-SV-STATE            TO PI-SV-STATE
 18061            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18062            GO TO 7100-DISPLAY-CANCELS.
 18063
 18064     GO TO 4005-READ-NEXT-RECORD.
 18065
 18066 4050-END-RECORDS.
 18067******************************************************************
 18068*                                                                *
 18069*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18070*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18071*         PROGRAM.                                               *
 18072*                                                                *
 18073******************************************************************
 18074
 18075     IF BROWSE-STARTED
 18076        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18077
 18078* EXEC CICS ENDBR
 18079*            DATASET  (FILE-ID-ERPNDB2)
 18080*       END-EXEC.
 18081     MOVE 0
 18082       TO DFHEIV11
 18083*    MOVE '&2                    $   #00015425' TO DFHEIV0
 18084     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18085     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 336
* EL6311.cbl
 18086     MOVE X'2020233030303135343235' TO DFHEIV0(25:11)
 18087     CALL 'kxdfhei1' USING DFHEIV0,
 18088           FILE-ID-ERPNDB2,
 18089           DFHEIV11,
 18090           DFHEIV99
 18091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18092
 18093
 18094     IF  EIBTRNID NOT = TRANS-EXB1
 18095         IF PENDING-BUS-RECS-FOUND
 18096             NEXT SENTENCE
 18097           ELSE
 18098             MOVE '9'            TO PI-BROWSE-SW
 18099             GO TO 9400-CLEAR.
 18100
 18101     IF SHOW-RECORD
 18102        MOVE ER-2253            TO EMI-ERROR
 18103       ELSE
 18104        MOVE ER-2254            TO EMI-ERROR.
 18105
 18106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18107
 18108     IF PI-MAP-NAME = SPACES
 18109        MOVE -1                  TO DPFENTRL
 18110        MOVE EL631D               TO PI-MAP-NAME
 18111        GO TO 8100-SEND-INITIAL-MAP.
 18112
 18113     IF PI-MAP-NAME = EL631B
 18114        MOVE -1                  TO BMAINTL
 18115     ELSE
 18116        IF PI-MAP-NAME = EL631C
 18117           MOVE -1               TO CMAINTL
 18118        ELSE
 18119           MOVE -1               TO DPFENTRL.
 18120
 18121     GO TO 8200-SEND-DATAONLY.
 18122
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 337
* EL6311.cbl
 18124
 18125***************************************************************
 18126*                                                             *
 18127*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18128*                                                             *
 18129*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18130*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18131*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18132*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18133*                                                             *
 18134*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18135*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18136*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18137*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18138*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18139*                AND IS IT TO BE DISPLAYED.                   *
 18140*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18141*                DISPLAYED.                                   *
 18142*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18143*                DISPLAYED.                                   *
 18144*                                                             *
 18145*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18146*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18147*                                                             *
 18148*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18149*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18150*                THEY ARE NOT TO BE DISPLAYED.                *
 18151*                                                             *
 18152***************************************************************
 18153
 18154 4100-BROWSE-PRIMARY-FORWARD.
 18155     IF FIRST-TIME  OR SHOW-RECORD
 18156        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18157        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18158        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18159     ELSE
 18160        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18161        IF ERPNDB-BATCH-SEQ-NO = +9999
 18162           GO TO 4150-END-BATCH
 18163        ELSE
 18164           IF DISPLAY-CHANGE-RECORDS
 18165              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18166           ELSE
 18167              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18168              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18169
 18170     IF FIRST-TIME
 18171         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18172            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18173              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18174
 18175
 18176* EXEC CICS HANDLE CONDITION
 18177*         ENDFILE  (4150-END-BATCH)
 18178*    END-EXEC.
 18179*    MOVE '"$''                   ! J #00015510' TO DFHEIV0
 18180     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 338
* EL6311.cbl
 18182     MOVE X'4A20233030303135353130' TO DFHEIV0(25:11)
 18183     CALL 'kxdfhei1' USING DFHEIV0
 18184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18185
 18186
 18187 4105-READ-NEXT.
 18188
 18189* EXEC CICS HANDLE CONDITION
 18190*         NOTFND    (4150-END-BATCH)
 18191*    END-EXEC.
 18192*    MOVE '"$I                   ! K #00015515' TO DFHEIV0
 18193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18195     MOVE X'4B20233030303135353135' TO DFHEIV0(25:11)
 18196     CALL 'kxdfhei1' USING DFHEIV0
 18197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18198
 18199
 18200     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18201
 18202     IF PI-DISPLAY-ORIGINAL-BATCH
 18203        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18204     ELSE
 18205        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18206
 18207
 18208* EXEC CICS READ
 18209*         DATASET   (FILE-ID)
 18210*         SET       (ADDRESS OF PENDING-BUSINESS)
 18211*         RIDFLD    (ERPNDB-KEY)
 18212*         GTEQ
 18213*    END-EXEC.
 18214*    MOVE '&"S        G          (   #00015526' TO DFHEIV0
 18215     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18216     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18217     MOVE X'2020233030303135353236' TO DFHEIV0(25:11)
 18218     CALL 'kxdfhei1' USING DFHEIV0,
 18219           FILE-ID,
 18220           DFHEIV20,
 18221           DFHEIV99,
 18222           ERPNDB-KEY,
 18223           DFHEIV99,
 18224           DFHEIV99,
 18225           DFHEIV99
 18226     SET ADDRESS OF PENDING-BUSINESS TO
 18227         DFHEIV20
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231     IF PI-DISPLAY-ORIGINAL-BATCH
 18232        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18233           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18234           GO TO 4150-END-BATCH
 18235        ELSE
 18236           IF PB-BATCH-TRAILER
 18237              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18238              GO TO 4105-READ-NEXT
 18239           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 339
* EL6311.cbl
 18240              NEXT SENTENCE
 18241     ELSE
 18242        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18243           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18244           GO TO 4150-END-BATCH.
 18245
 18246     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18247
 18248     IF WS-BATCH-PREFIX = '#CL'
 18249         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18250         GO TO 4105-READ-NEXT.
 18251
 18252     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18253     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18254     MOVE PB-STATE               TO PI-PB-STATE.
 18255     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18256
 18257     IF PB-BATCH-TRAILER
 18258        IF SHOW-RECORD
 18259           GO TO 4150-END-BATCH
 18260        ELSE
 18261           MOVE ER-2251         TO EMI-ERROR
 18262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18263           MOVE 1               TO PI-BROWSE-TYPE
 18264           GO TO 7200-DISPLAY-BATCHES.
 18265
 18266     IF SHOW-RECORD
 18267           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18268              GO TO 4110-BUMP-SEQ
 18269           ELSE
 18270              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18271                 GO TO 4110-BUMP-SEQ
 18272              ELSE
 18273                 GO TO 4107-CHECK-REC-TYPE.
 18274
 18275     IF NOT  PI-PRIMARY-WITH-SELECT
 18276        GO TO 4107-CHECK-REC-TYPE.
 18277
 18278     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18279        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18280           GO TO 4110-BUMP-SEQ
 18281        ELSE
 18282           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18283              GO TO 4107-CHECK-REC-TYPE
 18284           ELSE
 18285              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18286                 GO TO 4107-CHECK-REC-TYPE
 18287              ELSE
 18288                 GO TO 4110-BUMP-SEQ.
 18289
 18290     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18291        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18292           GO TO 4110-BUMP-SEQ.
 18293
 18294 4107-CHECK-REC-TYPE.
 18295     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18296         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18297             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 340
* EL6311.cbl
 18298           ELSE
 18299             GO TO 4110-BUMP-SEQ.
 18300
 18301     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18302         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18303             NEXT SENTENCE
 18304           ELSE
 18305             GO TO 4110-BUMP-SEQ.
 18306
 18307     IF NOT DISPLAY-CHANGE-RECORDS AND
 18308        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18309           GO TO 4110-BUMP-SEQ.
 18310
 18311     IF DISPLAY-HOLD-RECORDS AND
 18312        NOT PB-RECORD-ON-HOLD
 18313          GO TO 4110-BUMP-SEQ.
 18314
 18315     IF PB-ISSUE
 18316        IF DISPLAY-CHK-REQ-RECORDS
 18317            GO TO 4110-BUMP-SEQ.
 18318
 18319     IF PB-ISSUE
 18320        IF ISSUE-WITH-WARNING
 18321           IF PB-WARNING-ERRORS
 18322              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18323                  GO TO 4110-BUMP-SEQ
 18324              ELSE
 18325                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18326                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18327                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18328                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18329                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18330                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18331                 GO TO 7000-DISPLAY-ISSUES
 18332        ELSE
 18333            GO TO 4110-BUMP-SEQ.
 18334
 18335     IF PB-ISSUE
 18336        IF (ISSUES-IN-ERROR AND
 18337            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18338            ALL-ISSUES
 18339            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18340            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18341            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18342            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18343            MOVE PB-SV-STATE            TO PI-SV-STATE
 18344            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18345            GO TO 7000-DISPLAY-ISSUES
 18346        ELSE
 18347            GO TO 4110-BUMP-SEQ.
 18348
 18349     IF PB-CANCELLATION
 18350        IF DISPLAY-CHK-REQ-RECORDS
 18351           IF PB-C-REFUND-REQUESTED
 18352              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18353              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18354              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18355              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 341
* EL6311.cbl
 18356              MOVE PB-SV-STATE            TO PI-SV-STATE
 18357              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18358              GO TO 7100-DISPLAY-CANCELS
 18359           ELSE
 18360              GO TO 4110-BUMP-SEQ.
 18361
 18362     IF PB-CANCELLATION
 18363        IF CANCEL-WITH-WARNING
 18364           IF PB-WARNING-ERRORS
 18365              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18366                  GO TO 4110-BUMP-SEQ
 18367              ELSE
 18368                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18369                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18370                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18371                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18372                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18373                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18374                 GO TO 7100-DISPLAY-CANCELS
 18375           ELSE
 18376              GO TO 4110-BUMP-SEQ.
 18377
 18378     IF PB-CANCELLATION
 18379        IF (CANCEL-IN-ERROR  AND
 18380            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18381            ALL-CANCELS
 18382            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18383            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18384            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18385            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18386            MOVE PB-SV-STATE            TO PI-SV-STATE
 18387            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18388            GO TO 7100-DISPLAY-CANCELS.
 18389
 18390 4110-BUMP-SEQ.
 18391     IF NOT DISPLAY-CHANGE-RECORDS
 18392        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18393        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18394     ELSE
 18395        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18396           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18397           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18398        ELSE
 18399           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18400           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18401
 18402     GO TO 4105-READ-NEXT.
 18403
 18404 4150-END-BATCH.
 18405******************************************************************
 18406*                                                                *
 18407*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18408*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18409*         PROGRAM.                                               *
 18410*                                                                *
 18411******************************************************************
 18412
 18413     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 342
* EL6311.cbl
 18414         IF PENDING-BUS-RECS-FOUND
 18415             NEXT SENTENCE
 18416           ELSE
 18417             MOVE '9'            TO PI-BROWSE-SW
 18418             GO TO 9400-CLEAR.
 18419
 18420     IF SHOW-RECORD
 18421        MOVE ER-2253             TO EMI-ERROR
 18422     ELSE
 18423        MOVE ER-2251             TO EMI-ERROR.
 18424
 18425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18426
 18427     IF PI-MAP-NAME = SPACES
 18428        MOVE -1                  TO BMAINTL
 18429        MOVE EL631B              TO PI-MAP-NAME
 18430        GO TO 8100-SEND-INITIAL-MAP.
 18431
 18432     IF PI-MAP-NAME = EL631B
 18433        MOVE -1                  TO BMAINTL
 18434     ELSE
 18435        IF PI-MAP-NAME = EL631C
 18436           MOVE -1               TO CMAINTL
 18437        ELSE
 18438           MOVE -1               TO DPFENTRL.
 18439
 18440     GO TO 8200-SEND-DATAONLY.
 18441
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 343
* EL6311.cbl
 18443
 18444***************************************************************
 18445*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18446*                                                             *
 18447*      1. START BROWSE WITH                                   *
 18448*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18449*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18450*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18451*                                                             *
 18452*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18453*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18454*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18455*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18456*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18457*               AND IS IT TO BE DISPLAYED.                    *
 18458*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18459*               DISPLAYED.                                    *
 18460*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18461*               DISPLAYED.                                    *
 18462*                                                             *
 18463*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18464*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18465***************************************************************
 18466
 18467 4200-BROWSE-CSR-FORWARD.
 18468
 18469     IF FIRST-TIME
 18470        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18471     ELSE
 18472        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18473
 18474
 18475* EXEC CICS HANDLE CONDITION
 18476*         NOTFND   (4250-END-RECORDS)
 18477*         ENDFILE  (4250-END-RECORDS)
 18478*    END-EXEC.
 18479*    MOVE '"$I''                  ! L #00015776' TO DFHEIV0
 18480     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18482     MOVE X'4C20233030303135373736' TO DFHEIV0(25:11)
 18483     CALL 'kxdfhei1' USING DFHEIV0
 18484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18485
 18486
 18487
 18488* EXEC CICS STARTBR
 18489*         DATASET   (FILE-ID-ERPNDB4)
 18490*         RIDFLD    (ERPNDB-CSR-KEY)
 18491*    END-EXEC.
 18492     MOVE 0
 18493       TO DFHEIV11
 18494*    MOVE '&,         G          &   #00015781' TO DFHEIV0
 18495     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18497     MOVE X'2020233030303135373831' TO DFHEIV0(25:11)
 18498     CALL 'kxdfhei1' USING DFHEIV0,
 18499           FILE-ID-ERPNDB4,
 18500           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 344
* EL6311.cbl
 18501           DFHEIV99,
 18502           DFHEIV11,
 18503           DFHEIV99
 18504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18505
 18506
 18507     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18508
 18509     IF FIRST-TIME
 18510        MOVE SPACE               TO WS-FIRST-TIME-SW
 18511        GO TO 4205-READ-NEXT-RECORD.
 18512
 18513
 18514* EXEC CICS READNEXT
 18515*         DATASET    (FILE-ID-ERPNDB4)
 18516*         SET        (ADDRESS OF PENDING-BUSINESS)
 18517*         RIDFLD     (ERPNDB-CSR-KEY)
 18518*    END-EXEC.
 18519     MOVE 0
 18520       TO DFHEIV11
 18521*    MOVE '&.S                   )   #00015792' TO DFHEIV0
 18522     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18523     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18524     MOVE X'2020233030303135373932' TO DFHEIV0(25:11)
 18525     CALL 'kxdfhei1' USING DFHEIV0,
 18526           FILE-ID-ERPNDB4,
 18527           DFHEIV20,
 18528           DFHEIV99,
 18529           ERPNDB-CSR-KEY,
 18530           DFHEIV99,
 18531           DFHEIV11,
 18532           DFHEIV99,
 18533           DFHEIV99
 18534     SET ADDRESS OF PENDING-BUSINESS TO
 18535         DFHEIV20
 18536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18537
 18538
 18539 4205-READ-NEXT-RECORD.
 18540
 18541
 18542* EXEC CICS READNEXT
 18543*         DATASET    (FILE-ID-ERPNDB4)
 18544*         SET        (ADDRESS OF PENDING-BUSINESS)
 18545*         RIDFLD     (ERPNDB-CSR-KEY)
 18546*    END-EXEC.
 18547     MOVE 0
 18548       TO DFHEIV11
 18549*    MOVE '&.S                   )   #00015800' TO DFHEIV0
 18550     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18551     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18552     MOVE X'2020233030303135383030' TO DFHEIV0(25:11)
 18553     CALL 'kxdfhei1' USING DFHEIV0,
 18554           FILE-ID-ERPNDB4,
 18555           DFHEIV20,
 18556           DFHEIV99,
 18557           ERPNDB-CSR-KEY,
 18558           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 345
* EL6311.cbl
 18559           DFHEIV11,
 18560           DFHEIV99,
 18561           DFHEIV99
 18562     SET ADDRESS OF PENDING-BUSINESS TO
 18563         DFHEIV20
 18564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18565
 18566
 18567     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18568
 18569     IF WS-BATCH-PREFIX = '#CL'
 18570        GO TO 4205-READ-NEXT-RECORD.
 18571
 18572     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18573        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18574        GO TO 4250-END-RECORDS.
 18575
 18576     IF PB-BATCH-TRAILER
 18577        GO TO 4205-READ-NEXT-RECORD.
 18578
 18579     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18580        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18581           GO TO 4205-READ-NEXT-RECORD
 18582        ELSE
 18583           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18584              GO TO 4210-CHECK-REC-TYPE
 18585           ELSE
 18586              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18587                 GO TO 4210-CHECK-REC-TYPE
 18588              ELSE
 18589                 GO TO 4205-READ-NEXT-RECORD.
 18590
 18591     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18592        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18593           GO TO 4205-READ-NEXT-RECORD.
 18594
 18595 4210-CHECK-REC-TYPE.
 18596     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18597         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18598             NEXT SENTENCE
 18599         ELSE
 18600             GO TO 4205-READ-NEXT-RECORD.
 18601
 18602     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18603         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18604             NEXT SENTENCE
 18605        ELSE
 18606             GO TO 4205-READ-NEXT-RECORD.
 18607
 18608     IF NOT DISPLAY-CHANGE-RECORDS AND
 18609            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18610        GO TO 4205-READ-NEXT-RECORD.
 18611
 18612     IF DISPLAY-HOLD-RECORDS AND
 18613        NOT PB-RECORD-ON-HOLD
 18614          GO TO 4205-READ-NEXT-RECORD.
 18615
 18616     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 346
* EL6311.cbl
 18617        IF DISPLAY-CHK-REQ-RECORDS
 18618            GO TO 4205-READ-NEXT-RECORD.
 18619
 18620     IF PB-ISSUE
 18621        IF ISSUE-WITH-WARNING
 18622           IF PB-WARNING-ERRORS
 18623              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18624                  GO TO 4205-READ-NEXT-RECORD
 18625              ELSE
 18626                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18627                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18628                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18629                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18630                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18631                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18632                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18633                 GO TO 7000-DISPLAY-ISSUES
 18634           ELSE
 18635              GO TO 4205-READ-NEXT-RECORD.
 18636
 18637     IF PB-ISSUE
 18638        IF (ISSUES-IN-ERROR AND
 18639            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18640            ALL-ISSUES
 18641            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18642            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18643            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18644            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18645            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18646            MOVE PB-SV-STATE            TO PI-SV-STATE
 18647            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18648            GO TO 7000-DISPLAY-ISSUES
 18649        ELSE
 18650            GO TO 4205-READ-NEXT-RECORD.
 18651
 18652     IF PB-CANCELLATION
 18653        IF DISPLAY-CHK-REQ-RECORDS
 18654           IF PB-C-REFUND-REQUESTED
 18655              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18656              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18657              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18658              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18659              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18660              MOVE PB-SV-STATE            TO PI-SV-STATE
 18661              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18662              GO TO 7100-DISPLAY-CANCELS
 18663           ELSE
 18664               GO TO 4205-READ-NEXT-RECORD.
 18665
 18666     IF PB-CANCELLATION
 18667        IF CANCEL-WITH-WARNING
 18668           IF PB-WARNING-ERRORS
 18669              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18670                  GO TO 4205-READ-NEXT-RECORD
 18671              ELSE
 18672                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18673                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18674                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 347
* EL6311.cbl
 18675                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18676                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18677                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18678                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18679                 GO TO 7100-DISPLAY-CANCELS
 18680           ELSE
 18681              GO TO 4205-READ-NEXT-RECORD.
 18682
 18683     IF PB-CANCELLATION
 18684        IF (CANCEL-IN-ERROR  AND
 18685            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18686            ALL-CANCELS
 18687            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18688            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18689            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18690            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18691            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18692            MOVE PB-SV-STATE            TO PI-SV-STATE
 18693            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18694            GO TO 7100-DISPLAY-CANCELS.
 18695
 18696     GO TO 4205-READ-NEXT-RECORD.
 18697
 18698 4250-END-RECORDS.
 18699******************************************************************
 18700*                                                                *
 18701*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18702*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18703*         PROGRAM.                                               *
 18704*                                                                *
 18705******************************************************************
 18706
 18707     IF BROWSE-STARTED
 18708        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18709
 18710* EXEC CICS ENDBR
 18711*            DATASET  (FILE-ID-ERPNDB4)
 18712*       END-EXEC.
 18713     MOVE 0
 18714       TO DFHEIV11
 18715*    MOVE '&2                    $   #00015948' TO DFHEIV0
 18716     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18717     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18718     MOVE X'2020233030303135393438' TO DFHEIV0(25:11)
 18719     CALL 'kxdfhei1' USING DFHEIV0,
 18720           FILE-ID-ERPNDB4,
 18721           DFHEIV11,
 18722           DFHEIV99
 18723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18724
 18725
 18726     IF  EIBTRNID NOT = TRANS-EXB1
 18727         IF PENDING-BUS-RECS-FOUND
 18728             NEXT SENTENCE
 18729           ELSE
 18730             MOVE '9'            TO PI-BROWSE-SW
 18731             GO TO 9400-CLEAR.
 18732
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 348
* EL6311.cbl
 18733     IF SHOW-RECORD
 18734        MOVE ER-2253            TO EMI-ERROR
 18735       ELSE
 18736        MOVE ER-2254            TO EMI-ERROR.
 18737
 18738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18739
 18740     IF PI-MAP-NAME = SPACES
 18741        MOVE -1                  TO DPFENTRL
 18742        MOVE EL631D               TO PI-MAP-NAME
 18743        GO TO 8100-SEND-INITIAL-MAP.
 18744
 18745     IF PI-MAP-NAME = EL631B
 18746        MOVE -1                  TO BMAINTL
 18747     ELSE
 18748        IF PI-MAP-NAME = EL631C
 18749           MOVE -1               TO CMAINTL
 18750        ELSE
 18751           MOVE -1               TO DPFENTRL.
 18752
 18753     GO TO 8200-SEND-DATAONLY.
 18754
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 349
* EL6311.cbl
 18756
 18757***************************************************************
 18758*                                                             *
 18759*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18760*                                                             *
 18761*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18762*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18763*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18764*                                                             *
 18765*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18766*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18767*          A. IS IT WITHIN THE SAME COMPANY                   *
 18768*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18769*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18770*                AND IS IT TO BE DISPLAYED.                   *
 18771*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18772*                DISPLAYED.                                   *
 18773*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18774*                DISPLAYED.                                   *
 18775*                                                             *
 18776*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18777*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18778*                                                             *
 18779*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18780*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18781*                THEY ARE NOT TO BE DISPLAYED.                *
 18782*                                                             *
 18783***************************************************************
 18784
 18785 4300-BROWSE-FILE-FORWARD.
 18786     IF FIRST-TIME OR SHOW-RECORD
 18787        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18788        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18789        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18790     ELSE
 18791        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18792        IF ERPNDB-BATCH-SEQ-NO = +9999
 18793           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18794        ELSE
 18795           IF DISPLAY-CHANGE-RECORDS
 18796              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18797           ELSE
 18798              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18799              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18800
 18801
 18802* EXEC CICS HANDLE CONDITION
 18803*         ENDFILE  (4350-END-BATCH)
 18804*         NOTFND   (4350-END-BATCH)
 18805*    END-EXEC.
 18806*    MOVE '"$''I                  ! M #00016027' TO DFHEIV0
 18807     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18809     MOVE X'4D20233030303136303237' TO DFHEIV0(25:11)
 18810     CALL 'kxdfhei1' USING DFHEIV0
 18811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18812
 18813
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 350
* EL6311.cbl
 18814 4305-READ-NEXT.
 18815     IF PI-DISPLAY-ORIGINAL-BATCH
 18816        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18817     ELSE
 18818        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18819
 18820
 18821* EXEC CICS READ
 18822*         DATASET   (FILE-ID)
 18823*         SET       (ADDRESS OF PENDING-BUSINESS)
 18824*         RIDFLD    (ERPNDB-KEY)
 18825*         GTEQ
 18826*    END-EXEC.
 18827*    MOVE '&"S        G          (   #00016038' TO DFHEIV0
 18828     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18830     MOVE X'2020233030303136303338' TO DFHEIV0(25:11)
 18831     CALL 'kxdfhei1' USING DFHEIV0,
 18832           FILE-ID,
 18833           DFHEIV20,
 18834           DFHEIV99,
 18835           ERPNDB-KEY,
 18836           DFHEIV99,
 18837           DFHEIV99,
 18838           DFHEIV99
 18839     SET ADDRESS OF PENDING-BUSINESS TO
 18840         DFHEIV20
 18841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18842
 18843
 18844     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18845        GO TO 4350-END-BATCH.
 18846
 18847     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18848                                    WS-BATCH-NO.
 18849
 18850     IF  WS-BATCH-PREFIX = '#CL'
 18851         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18852         GO TO 4305-READ-NEXT.
 18853
 18854     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18855     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18856     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18857     MOVE PB-STATE               TO PI-PB-STATE.
 18858     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18859
 18860     IF PB-BATCH-TRAILER
 18861        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18862        GO TO 4305-READ-NEXT.
 18863
 18864     IF SHOW-RECORD
 18865           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18866              GO TO 4310-BUMP-SEQ
 18867           ELSE
 18868              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18869                 GO TO 4310-BUMP-SEQ
 18870              ELSE
 18871                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 351
* EL6311.cbl
 18872
 18873     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18874        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18875           GO TO 4310-BUMP-SEQ
 18876        ELSE
 18877           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18878              GO TO 4307-CHECK-REC-TYPE
 18879           ELSE
 18880              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18881                 GO TO 4307-CHECK-REC-TYPE
 18882              ELSE
 18883                 GO TO 4310-BUMP-SEQ.
 18884
 18885     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18886        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18887           GO TO 4310-BUMP-SEQ.
 18888
 18889 4307-CHECK-REC-TYPE.
 18890     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18891         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18892             NEXT SENTENCE
 18893         ELSE
 18894             GO TO 4310-BUMP-SEQ.
 18895
 18896     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18897         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18898             NEXT SENTENCE
 18899        ELSE
 18900             GO TO 4310-BUMP-SEQ.
 18901
 18902     IF NOT DISPLAY-CHANGE-RECORDS AND
 18903            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18904        GO TO 4310-BUMP-SEQ.
 18905
 18906     IF DISPLAY-HOLD-RECORDS AND
 18907        NOT PB-RECORD-ON-HOLD
 18908          GO TO 4310-BUMP-SEQ.
 18909
 18910     IF PB-ISSUE
 18911        IF DISPLAY-CHK-REQ-RECORDS
 18912           GO TO 4310-BUMP-SEQ.
 18913
 18914     IF PB-ISSUE
 18915        IF ISSUE-WITH-WARNING
 18916           IF PB-WARNING-ERRORS
 18917              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18918                  GO TO 4310-BUMP-SEQ
 18919              ELSE
 18920                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18921                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18922                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18923                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18924                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18925                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18926                 GO TO 7000-DISPLAY-ISSUES
 18927           ELSE
 18928              GO TO 4310-BUMP-SEQ.
 18929
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 352
* EL6311.cbl
 18930     IF PB-ISSUE
 18931        IF (ISSUES-IN-ERROR AND
 18932            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18933            ALL-ISSUES
 18934            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18935            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18936            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18937            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18938            MOVE PB-SV-STATE            TO PI-SV-STATE
 18939            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18940            GO TO 7000-DISPLAY-ISSUES
 18941        ELSE
 18942            GO TO 4310-BUMP-SEQ.
 18943
 18944     IF PB-CANCELLATION
 18945        IF DISPLAY-CHK-REQ-RECORDS
 18946           IF PB-C-REFUND-REQUESTED
 18947              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18948              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18949              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18950              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18951              MOVE PB-SV-STATE            TO PI-SV-STATE
 18952              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18953              GO TO 7100-DISPLAY-CANCELS
 18954           ELSE
 18955              GO TO 4310-BUMP-SEQ.
 18956
 18957     IF PB-CANCELLATION
 18958        IF CANCEL-WITH-WARNING
 18959           IF PB-WARNING-ERRORS
 18960              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18961                  GO TO 4310-BUMP-SEQ
 18962              ELSE
 18963                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18964                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18965                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18966                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18967                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18968                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18969                 GO TO 7100-DISPLAY-CANCELS
 18970           ELSE
 18971              GO TO 4310-BUMP-SEQ.
 18972
 18973     IF PB-CANCELLATION
 18974        IF (CANCEL-IN-ERROR  AND
 18975            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18976            ALL-CANCELS
 18977            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18978            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18979            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18980            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18981            MOVE PB-SV-STATE            TO PI-SV-STATE
 18982            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18983            GO TO 7100-DISPLAY-CANCELS.
 18984
 18985 4310-BUMP-SEQ.
 18986     IF NOT DISPLAY-CHANGE-RECORDS
 18987        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 353
* EL6311.cbl
 18988        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18989     ELSE
 18990        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18991           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18992           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18993        ELSE
 18994           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18995           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 18996
 18997     GO TO 4305-READ-NEXT.
 18998
 18999 4350-END-BATCH.
 19000
 19001******************************************************************
 19002*                                                                *
 19003*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19004*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19005*         PROGRAM.                                               *
 19006*                                                                *
 19007******************************************************************
 19008
 19009     IF  EIBTRNID NOT = TRANS-EXB1
 19010         IF PENDING-BUS-RECS-FOUND
 19011             NEXT SENTENCE
 19012           ELSE
 19013             MOVE '9'            TO PI-BROWSE-SW
 19014             GO TO 9400-CLEAR.
 19015
 19016     IF SHOW-RECORD
 19017        MOVE ER-2253            TO EMI-ERROR
 19018     ELSE
 19019        MOVE ER-2251            TO EMI-ERROR.
 19020
 19021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19022
 19023     IF PI-MAP-NAME = SPACES
 19024        MOVE -1                  TO BMAINTL
 19025        MOVE EL631B               TO PI-MAP-NAME
 19026        GO TO 8100-SEND-INITIAL-MAP.
 19027
 19028     IF PI-MAP-NAME = EL631B
 19029        MOVE -1                  TO BMAINTL
 19030     ELSE
 19031        IF PI-MAP-NAME = EL631C
 19032           MOVE -1               TO CMAINTL
 19033        ELSE
 19034           MOVE -1               TO DPFENTRL.
 19035
 19036     GO TO 8200-SEND-DATAONLY.
 19037
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 354
* EL6311.cbl
 19039
 19040******************************************************************
 19041*                                                                *
 19042*        B R O W S E   D E T A I L   B A C K W A R D             *
 19043*                                                                *
 19044******************************************************************
 19045
 19046 4500-BROWSE-DETAIL-BACKWARD.
 19047
 19048     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19049
 19050
 19051* EXEC CICS HANDLE CONDITION
 19052*         NOTFND   (4570-NOT-FOUND)
 19053*         ENDFILE  (4550-END-RECORDS)
 19054*    END-EXEC
 19055*    MOVE '"$I''                  ! N #00016251' TO DFHEIV0
 19056     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19058     MOVE X'4E20233030303136323531' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0
 19060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19061
 19062
 19063* EXEC CICS STARTBR
 19064*         DATASET   (FILE-ID-ERPNDB2)
 19065*         RIDFLD    (ERPNDB-ALT-KEY)
 19066*    END-EXEC.
 19067     MOVE 0
 19068       TO DFHEIV11
 19069*    MOVE '&,         G          &   #00016256' TO DFHEIV0
 19070     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19071     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303136323536' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           FILE-ID-ERPNDB2,
 19075           ERPNDB-ALT-KEY,
 19076           DFHEIV99,
 19077           DFHEIV11,
 19078           DFHEIV99
 19079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19080
 19081
 19082     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19083                                    WS-FIRST-TIME-SW.
 19084
 19085 4505-READ-PREV-RECORD.
 19086
 19087* EXEC CICS READPREV
 19088*         DATASET    (FILE-ID-ERPNDB2)
 19089*         SET        (ADDRESS OF PENDING-BUSINESS)
 19090*         RIDFLD     (ERPNDB-ALT-KEY)
 19091*    END-EXEC.
 19092     MOVE 0
 19093       TO DFHEIV11
 19094*    MOVE '&0S                   )   #00016265' TO DFHEIV0
 19095     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 355
* EL6311.cbl
 19097     MOVE X'2020233030303136323635' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0,
 19099           FILE-ID-ERPNDB2,
 19100           DFHEIV20,
 19101           DFHEIV99,
 19102           ERPNDB-ALT-KEY,
 19103           DFHEIV99,
 19104           DFHEIV11,
 19105           DFHEIV99,
 19106           DFHEIV99
 19107     SET ADDRESS OF PENDING-BUSINESS TO
 19108         DFHEIV20
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19110
 19111
 19112     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19113
 19114     IF WS-BATCH-PREFIX = '#CL'
 19115         GO TO 4505-READ-PREV-RECORD.
 19116
 19117     IF FIRST-TIME
 19118         MOVE SPACE               TO WS-FIRST-TIME-SW
 19119         GO TO 4505-READ-PREV-RECORD.
 19120
 19121     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19122        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19123        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19124        PB-STATE         NOT = PI-PB-STATE    OR
 19125        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19126          GO TO 4550-END-RECORDS.
 19127
 19128
 19129     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19130
 19131     IF PB-BATCH-TRAILER
 19132        GO TO 4505-READ-PREV-RECORD.
 19133
 19134     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19135
 19136     IF  WS-BATCH-PREFIX = '#CL'
 19137         GO TO 4505-READ-PREV-RECORD.
 19138
 19139     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19140        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19141           GO TO 4505-READ-PREV-RECORD
 19142        ELSE
 19143           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19144              GO TO 4510-CHECK-REC-TYPE
 19145           ELSE
 19146              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19147                 GO TO 4510-CHECK-REC-TYPE
 19148              ELSE
 19149                 GO TO 4505-READ-PREV-RECORD.
 19150
 19151     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19152        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19153           GO TO 4505-READ-PREV-RECORD.
 19154
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 356
* EL6311.cbl
 19155 4510-CHECK-REC-TYPE.
 19156     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19157         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19158             NEXT SENTENCE
 19159         ELSE
 19160             GO TO 4505-READ-PREV-RECORD.
 19161
 19162     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19163         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19164             NEXT SENTENCE
 19165        ELSE
 19166             GO TO 4505-READ-PREV-RECORD.
 19167
 19168     IF NOT DISPLAY-CHANGE-RECORDS AND
 19169            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19170        GO TO 4505-READ-PREV-RECORD.
 19171
 19172     IF DISPLAY-HOLD-RECORDS AND
 19173        NOT PB-RECORD-ON-HOLD
 19174          GO TO 4505-READ-PREV-RECORD.
 19175
 19176     IF PB-ISSUE
 19177        IF DISPLAY-CHK-REQ-RECORDS
 19178           GO TO 4505-READ-PREV-RECORD.
 19179
 19180     IF PB-ISSUE
 19181        IF ISSUE-WITH-WARNING
 19182           IF PB-WARNING-ERRORS
 19183              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19184                  GO TO 4505-READ-PREV-RECORD
 19185              ELSE
 19186                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19187                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19188                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19189                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19190                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19191                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19192                 GO TO 7000-DISPLAY-ISSUES
 19193           ELSE
 19194              GO TO 4505-READ-PREV-RECORD.
 19195
 19196     IF PB-ISSUE
 19197        IF (ISSUES-IN-ERROR AND
 19198            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19199            ALL-ISSUES
 19200            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19201            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19202            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19203            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19204            MOVE PB-SV-STATE            TO PI-SV-STATE
 19205            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19206            GO TO 7000-DISPLAY-ISSUES
 19207        ELSE
 19208            GO TO 4505-READ-PREV-RECORD.
 19209
 19210     IF PB-CANCELLATION
 19211        IF DISPLAY-CHK-REQ-RECORDS
 19212           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 357
* EL6311.cbl
 19213              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19214              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19215              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19216              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19217              MOVE PB-SV-STATE            TO PI-SV-STATE
 19218              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19219              GO TO 7100-DISPLAY-CANCELS
 19220           ELSE
 19221              GO TO 4505-READ-PREV-RECORD.
 19222
 19223     IF PB-CANCELLATION
 19224        IF CANCEL-WITH-WARNING
 19225           IF PB-WARNING-ERRORS
 19226              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19227                  GO TO 4505-READ-PREV-RECORD
 19228              ELSE
 19229                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19230                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19231                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19232                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19233                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19234                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19235                 GO TO 7100-DISPLAY-CANCELS
 19236           ELSE
 19237              GO TO 4505-READ-PREV-RECORD.
 19238
 19239     IF PB-CANCELLATION
 19240        IF (CANCEL-IN-ERROR  AND
 19241            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19242            ALL-CANCELS
 19243            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19244            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19245            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19246            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19247            MOVE PB-SV-STATE            TO PI-SV-STATE
 19248            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19249            GO TO 7100-DISPLAY-CANCELS.
 19250
 19251     GO TO 4505-READ-PREV-RECORD.
 19252
 19253 4550-END-RECORDS.
 19254     IF PI-MAP-NAME = EL631B
 19255        MOVE -1                  TO BMAINTL
 19256     ELSE
 19257        IF PI-MAP-NAME = EL631C
 19258           MOVE -1               TO CMAINTL
 19259        ELSE
 19260           MOVE -1               TO DPFENTRL.
 19261
 19262     MOVE ER-2255               TO EMI-ERROR.
 19263     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19264     GO TO 8200-SEND-DATAONLY.
 19265
 19266 4570-NOT-FOUND.
 19267
 19268******************************************************************
 19269*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19270******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 358
* EL6311.cbl
 19271
 19272
 19273* EXEC CICS RESETBR
 19274*         DATASET    (FILE-ID-ERPNDB2)
 19275*         RIDFLD     (ERPNDB-ALT-KEY)
 19276*    END-EXEC.
 19277     MOVE 0
 19278       TO DFHEIV11
 19279*    MOVE '&4         G          &   #00016431' TO DFHEIV0
 19280     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19282     MOVE X'2020233030303136343331' TO DFHEIV0(25:11)
 19283     CALL 'kxdfhei1' USING DFHEIV0,
 19284           FILE-ID-ERPNDB2,
 19285           ERPNDB-ALT-KEY,
 19286           DFHEIV99,
 19287           DFHEIV11,
 19288           DFHEIV99
 19289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19290
 19291
 19292
 19293* EXEC CICS READNEXT
 19294*         DATASET    (FILE-ID-ERPNDB2)
 19295*         SET        (ADDRESS OF PENDING-BUSINESS)
 19296*         RIDFLD     (ERPNDB-ALT-KEY)
 19297*    END-EXEC.
 19298     MOVE 0
 19299       TO DFHEIV11
 19300*    MOVE '&.S                   )   #00016436' TO DFHEIV0
 19301     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19302     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19303     MOVE X'2020233030303136343336' TO DFHEIV0(25:11)
 19304     CALL 'kxdfhei1' USING DFHEIV0,
 19305           FILE-ID-ERPNDB2,
 19306           DFHEIV20,
 19307           DFHEIV99,
 19308           ERPNDB-ALT-KEY,
 19309           DFHEIV99,
 19310           DFHEIV11,
 19311           DFHEIV99,
 19312           DFHEIV99
 19313     SET ADDRESS OF PENDING-BUSINESS TO
 19314         DFHEIV20
 19315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19316
 19317
 19318
 19319* EXEC CICS READPREV
 19320*         DATASET    (FILE-ID-ERPNDB2)
 19321*         SET        (ADDRESS OF PENDING-BUSINESS)
 19322*         RIDFLD     (ERPNDB-ALT-KEY)
 19323*    END-EXEC.
 19324     MOVE 0
 19325       TO DFHEIV11
 19326*    MOVE '&0S                   )   #00016442' TO DFHEIV0
 19327     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 359
* EL6311.cbl
 19329     MOVE X'2020233030303136343432' TO DFHEIV0(25:11)
 19330     CALL 'kxdfhei1' USING DFHEIV0,
 19331           FILE-ID-ERPNDB2,
 19332           DFHEIV20,
 19333           DFHEIV99,
 19334           ERPNDB-ALT-KEY,
 19335           DFHEIV99,
 19336           DFHEIV11,
 19337           DFHEIV99,
 19338           DFHEIV99
 19339     SET ADDRESS OF PENDING-BUSINESS TO
 19340         DFHEIV20
 19341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19342
 19343
 19344 4580-READ-PREV-RECORD.
 19345
 19346* EXEC CICS READPREV
 19347*         DATASET    (FILE-ID-ERPNDB2)
 19348*         SET        (ADDRESS OF PENDING-BUSINESS)
 19349*         RIDFLD     (ERPNDB-ALT-KEY)
 19350*    END-EXEC.
 19351     MOVE 0
 19352       TO DFHEIV11
 19353*    MOVE '&0S                   )   #00016449' TO DFHEIV0
 19354     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19355     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19356     MOVE X'2020233030303136343439' TO DFHEIV0(25:11)
 19357     CALL 'kxdfhei1' USING DFHEIV0,
 19358           FILE-ID-ERPNDB2,
 19359           DFHEIV20,
 19360           DFHEIV99,
 19361           ERPNDB-ALT-KEY,
 19362           DFHEIV99,
 19363           DFHEIV11,
 19364           DFHEIV99,
 19365           DFHEIV99
 19366     SET ADDRESS OF PENDING-BUSINESS TO
 19367         DFHEIV20
 19368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19369
 19370
 19371     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19372
 19373     IF WS-BATCH-PREFIX = '#CL'
 19374        GO TO 4580-READ-PREV-RECORD.
 19375
 19376     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19377     GO TO 4505-READ-PREV-RECORD.
 19378
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 360
* EL6311.cbl
 19380
 19381******************************************************************
 19382*                                                                *
 19383*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19384*                                                                *
 19385******************************************************************
 19386
 19387 4600-BROWSE-PRIMARY-BACKWARD.
 19388        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19389
 19390     IF ERPNDB-BATCH-SEQ-NO = +9999
 19391        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19392
 19393        IF ERPNDB-BATCH-SEQ-NO = +0000
 19394           GO TO 4650-END-BATCH
 19395        ELSE
 19396           IF PI-MAP-NAME NOT = EL631D
 19397              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19398                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19399              ELSE
 19400                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19401                 IF DISPLAY-CHANGE-RECORDS
 19402                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19403                 ELSE
 19404                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19405
 19406
 19407* EXEC CICS HANDLE CONDITION
 19408*         NOTFND    (4680-NOT-FOUND)
 19409*         ENDFILE   (4680-NOT-FOUND)
 19410*    END-EXEC.
 19411*    MOVE '"$I''                  ! O #00016490' TO DFHEIV0
 19412     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19414     MOVE X'4F20233030303136343930' TO DFHEIV0(25:11)
 19415     CALL 'kxdfhei1' USING DFHEIV0
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419 4605-READ-NEXT.
 19420     IF ERPNDB-BATCH-SEQ-NO = +0000
 19421        GO TO 4650-END-BATCH.
 19422
 19423     IF PI-DISPLAY-ORIGINAL-BATCH
 19424        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19425     ELSE
 19426        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19427
 19428
 19429* EXEC CICS READ
 19430*         DATASET   (FILE-ID)
 19431*         SET       (ADDRESS OF PENDING-BUSINESS)
 19432*         RIDFLD    (ERPNDB-KEY)
 19433*    END-EXEC.
 19434*    MOVE '&"S        E          (   #00016504' TO DFHEIV0
 19435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19437     MOVE X'2020233030303136353034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 361
* EL6311.cbl
 19438     CALL 'kxdfhei1' USING DFHEIV0,
 19439           FILE-ID,
 19440           DFHEIV20,
 19441           DFHEIV99,
 19442           ERPNDB-KEY,
 19443           DFHEIV99,
 19444           DFHEIV99,
 19445           DFHEIV99
 19446     SET ADDRESS OF PENDING-BUSINESS TO
 19447         DFHEIV20
 19448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19449
 19450
 19451     IF NOT  PI-PRIMARY-WITH-SELECT
 19452        GO TO 4607-CHECK-REC-TYPE.
 19453
 19454     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19455
 19456     IF  WS-BATCH-PREFIX = '#CL'
 19457         GO TO 4610-BUMP-SEQ.
 19458
 19459     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19460        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19461           GO TO 4610-BUMP-SEQ
 19462        ELSE
 19463           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19464              GO TO 4607-CHECK-REC-TYPE
 19465           ELSE
 19466              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19467                 GO TO 4607-CHECK-REC-TYPE
 19468              ELSE
 19469                 GO TO 4610-BUMP-SEQ.
 19470
 19471     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19472        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19473           GO TO 4610-BUMP-SEQ.
 19474
 19475 4607-CHECK-REC-TYPE.
 19476     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19477         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19478             NEXT SENTENCE
 19479         ELSE
 19480             GO TO 4610-BUMP-SEQ.
 19481
 19482     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19483         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19484             NEXT SENTENCE
 19485        ELSE
 19486             GO TO 4610-BUMP-SEQ.
 19487
 19488     IF NOT DISPLAY-CHANGE-RECORDS AND
 19489            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19490        GO TO 4610-BUMP-SEQ.
 19491
 19492     IF DISPLAY-HOLD-RECORDS AND
 19493        NOT PB-RECORD-ON-HOLD
 19494          GO TO 4610-BUMP-SEQ.
 19495
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 362
* EL6311.cbl
 19496     IF PB-ISSUE
 19497        IF DISPLAY-CHK-REQ-RECORDS
 19498           GO TO 4610-BUMP-SEQ.
 19499
 19500     IF PB-ISSUE
 19501        IF ISSUE-WITH-WARNING
 19502           IF PB-WARNING-ERRORS
 19503              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19504                  GO TO 4610-BUMP-SEQ
 19505              ELSE
 19506                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19507                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19508                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19509                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19510                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19511                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19512                 GO TO 7000-DISPLAY-ISSUES
 19513           ELSE
 19514              GO TO 4610-BUMP-SEQ.
 19515
 19516     IF PB-ISSUE
 19517        IF (ISSUES-IN-ERROR AND
 19518            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19519            ALL-ISSUES
 19520            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19521            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19522            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19523            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19524            MOVE PB-SV-STATE            TO PI-SV-STATE
 19525            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19526            GO TO 7000-DISPLAY-ISSUES
 19527        ELSE
 19528            GO TO 4610-BUMP-SEQ.
 19529
 19530     IF PB-CANCELLATION
 19531        IF DISPLAY-CHK-REQ-RECORDS
 19532           IF PB-C-REFUND-REQUESTED
 19533              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19534              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19535              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19536              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19537              MOVE PB-SV-STATE            TO PI-SV-STATE
 19538              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19539              GO TO 7100-DISPLAY-CANCELS
 19540           ELSE
 19541              GO TO 4610-BUMP-SEQ.
 19542
 19543     IF PB-CANCELLATION
 19544        IF CANCEL-WITH-WARNING
 19545           IF PB-WARNING-ERRORS
 19546              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19547                  GO TO 4610-BUMP-SEQ
 19548              ELSE
 19549                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19550                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19551                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19552                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19553                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 363
* EL6311.cbl
 19554                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19555                 GO TO 7100-DISPLAY-CANCELS
 19556           ELSE
 19557              GO TO 4610-BUMP-SEQ.
 19558
 19559     IF PB-CANCELLATION
 19560        IF (CANCEL-IN-ERROR  AND
 19561            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19562            ALL-CANCELS
 19563            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19564            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19565            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19566            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19567            MOVE PB-SV-STATE            TO PI-SV-STATE
 19568            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19569            GO TO 7100-DISPLAY-CANCELS.
 19570
 19571 4610-BUMP-SEQ.
 19572     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19573        GO TO 4650-END-BATCH.
 19574
 19575     IF DISPLAY-CHANGE-RECORDS
 19576        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19577           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19578        ELSE
 19579           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19580           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19581        ELSE
 19582           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19583           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19584
 19585        GO TO 4605-READ-NEXT.
 19586
 19587 4650-END-BATCH.
 19588     IF PI-MAP-NAME = EL631B
 19589        MOVE -1                  TO BMAINTL
 19590     ELSE
 19591        IF PI-MAP-NAME = EL631C
 19592           MOVE -1               TO CMAINTL
 19593        ELSE
 19594           MOVE -1               TO DPFENTRL.
 19595
 19596     MOVE ER-2252               TO EMI-ERROR.
 19597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19598     GO TO 8200-SEND-DATAONLY.
 19599
 19600 4680-NOT-FOUND.
 19601     IF DISPLAY-CHANGE-RECORDS
 19602        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19603           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19604        ELSE
 19605           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19606           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19607     ELSE
 19608        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19609
 19610     GO TO 4605-READ-NEXT.
 19611
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 364
* EL6311.cbl
 19613
 19614******************************************************************
 19615*                                                                *
 19616*        B R O W S E   F I L E   B A C K W A R D S               *
 19617*                                                                *
 19618******************************************************************
 19619
 19620 4800-BROWSE-FILE-BACKWARD.
 19621
 19622* EXEC CICS HANDLE CONDITION
 19623*         NOTFND   (4860-NOT-FOUND)
 19624*         ENDFILE  (4850-END-RECORDS)
 19625*    END-EXEC.
 19626*    MOVE '"$I''                  ! P #00016680' TO DFHEIV0
 19627     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19629     MOVE X'5020233030303136363830' TO DFHEIV0(25:11)
 19630     CALL 'kxdfhei1' USING DFHEIV0
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19632
 19633
 19634     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19635
 19636     IF PI-DISPLAY-ORIGINAL-BATCH
 19637        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19638     ELSE
 19639        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19640
 19641
 19642* EXEC CICS STARTBR
 19643*         DATASET   (FILE-ID)
 19644*         RIDFLD    (ERPNDB-KEY)
 19645*    END-EXEC.
 19646     MOVE 0
 19647       TO DFHEIV11
 19648*    MOVE '&,         G          &   #00016692' TO DFHEIV0
 19649     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19651     MOVE X'2020233030303136363932' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           FILE-ID,
 19654           ERPNDB-KEY,
 19655           DFHEIV99,
 19656           DFHEIV11,
 19657           DFHEIV99
 19658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19659
 19660
 19661     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19662
 19663
 19664* EXEC CICS READPREV
 19665*         DATASET    (FILE-ID-ERPNDB)
 19666*         SET        (ADDRESS OF PENDING-BUSINESS)
 19667*         RIDFLD     (ERPNDB-KEY)
 19668*    END-EXEC.
 19669     MOVE 0
 19670       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 365
* EL6311.cbl
 19671*    MOVE '&0S                   )   #00016699' TO DFHEIV0
 19672     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19674     MOVE X'2020233030303136363939' TO DFHEIV0(25:11)
 19675     CALL 'kxdfhei1' USING DFHEIV0,
 19676           FILE-ID-ERPNDB,
 19677           DFHEIV20,
 19678           DFHEIV99,
 19679           ERPNDB-KEY,
 19680           DFHEIV99,
 19681           DFHEIV11,
 19682           DFHEIV99,
 19683           DFHEIV99
 19684     SET ADDRESS OF PENDING-BUSINESS TO
 19685         DFHEIV20
 19686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19687
 19688
 19689 4810-READ-PREV-RECORD.
 19690
 19691* EXEC CICS READPREV
 19692*         DATASET    (FILE-ID-ERPNDB)
 19693*         SET        (ADDRESS OF PENDING-BUSINESS)
 19694*         RIDFLD     (ERPNDB-KEY)
 19695*    END-EXEC.
 19696     MOVE 0
 19697       TO DFHEIV11
 19698*    MOVE '&0S                   )   #00016706' TO DFHEIV0
 19699     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19700     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19701     MOVE X'2020233030303136373036' TO DFHEIV0(25:11)
 19702     CALL 'kxdfhei1' USING DFHEIV0,
 19703           FILE-ID-ERPNDB,
 19704           DFHEIV20,
 19705           DFHEIV99,
 19706           ERPNDB-KEY,
 19707           DFHEIV99,
 19708           DFHEIV11,
 19709           DFHEIV99,
 19710           DFHEIV99
 19711     SET ADDRESS OF PENDING-BUSINESS TO
 19712         DFHEIV20
 19713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19714
 19715
 19716     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19717        GO TO 4850-END-RECORDS.
 19718
 19719     IF PB-BATCH-TRAILER
 19720        GO TO 4810-READ-PREV-RECORD.
 19721
 19722     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19723
 19724     IF  WS-BATCH-PREFIX = '#CL'
 19725         GO TO 4810-READ-PREV-RECORD.
 19726
 19727     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19728        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 366
* EL6311.cbl
 19729           GO TO 4810-READ-PREV-RECORD
 19730        ELSE
 19731           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19732              GO TO 4820-CHECK-REC-TYPE
 19733           ELSE
 19734              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19735                 GO TO 4820-CHECK-REC-TYPE
 19736              ELSE
 19737                 GO TO 4810-READ-PREV-RECORD.
 19738
 19739     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19740        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19741           GO TO 4810-READ-PREV-RECORD.
 19742
 19743 4820-CHECK-REC-TYPE.
 19744     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19745         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19746             NEXT SENTENCE
 19747         ELSE
 19748             GO TO 4810-READ-PREV-RECORD.
 19749
 19750     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19751         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19752             NEXT SENTENCE
 19753        ELSE
 19754             GO TO 4810-READ-PREV-RECORD.
 19755
 19756     IF NOT DISPLAY-CHANGE-RECORDS AND
 19757            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19758        GO TO 4810-READ-PREV-RECORD.
 19759
 19760     IF DISPLAY-HOLD-RECORDS AND
 19761        NOT PB-RECORD-ON-HOLD
 19762          GO TO 4810-READ-PREV-RECORD.
 19763
 19764     IF PB-ISSUE
 19765        IF DISPLAY-CHK-REQ-RECORDS
 19766           GO TO 4810-READ-PREV-RECORD.
 19767
 19768     IF PB-ISSUE
 19769        IF ISSUE-WITH-WARNING
 19770           IF PB-WARNING-ERRORS
 19771              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19772                  GO TO 4810-READ-PREV-RECORD
 19773              ELSE
 19774                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19775                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19776                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19777                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19778                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19779                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19780                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19781                 GO TO 7000-DISPLAY-ISSUES
 19782           ELSE
 19783              GO TO 4810-READ-PREV-RECORD.
 19784
 19785     IF PB-ISSUE
 19786        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 367
* EL6311.cbl
 19787            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19788            ALL-ISSUES
 19789            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19790            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19791            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19792            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19793            MOVE PB-SV-STATE            TO PI-SV-STATE
 19794            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19795            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19796            GO TO 7000-DISPLAY-ISSUES
 19797        ELSE
 19798            GO TO 4810-READ-PREV-RECORD.
 19799
 19800     IF PB-CANCELLATION
 19801        IF DISPLAY-CHK-REQ-RECORDS
 19802           IF PB-C-REFUND-REQUESTED
 19803              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19804              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19805              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19806              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19807              MOVE PB-SV-STATE            TO PI-SV-STATE
 19808              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19809              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19810              GO TO 7100-DISPLAY-CANCELS
 19811           ELSE
 19812              GO TO 4810-READ-PREV-RECORD.
 19813
 19814     IF PB-CANCELLATION
 19815        IF CANCEL-WITH-WARNING
 19816           IF PB-WARNING-ERRORS
 19817              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19818                  GO TO 4810-READ-PREV-RECORD
 19819              ELSE
 19820                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19821                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19822                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19823                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19824                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19825                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19826                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19827                 GO TO 7100-DISPLAY-CANCELS
 19828           ELSE
 19829              GO TO 4810-READ-PREV-RECORD.
 19830
 19831     IF PB-CANCELLATION
 19832        IF (CANCEL-IN-ERROR  AND
 19833            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19834            ALL-CANCELS
 19835            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19836            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19837            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19838            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19839            MOVE PB-SV-STATE            TO PI-SV-STATE
 19840            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19841            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19842            GO TO 7100-DISPLAY-CANCELS.
 19843
 19844     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 368
* EL6311.cbl
 19845
 19846 4850-END-RECORDS.
 19847     MOVE ER-2252                TO EMI-ERROR.
 19848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19849
 19850     IF PI-MAP-NAME = EL631B
 19851        MOVE -1                  TO BPFENTRL
 19852     ELSE
 19853        MOVE -1                  TO CPFENTRL.
 19854
 19855     GO TO 8200-SEND-DATAONLY.
 19856
 19857 4860-NOT-FOUND.
 19858
 19859******************************************************************
 19860*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19861******************************************************************
 19862
 19863
 19864* EXEC CICS RESETBR
 19865*         DATASET    (FILE-ID-ERPNDB)
 19866*         RIDFLD     (ERPNDB-KEY)
 19867*     END-EXEC.
 19868     MOVE 0
 19869       TO DFHEIV11
 19870*    MOVE '&4         G          &   #00016859' TO DFHEIV0
 19871     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19872     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19873     MOVE X'2020233030303136383539' TO DFHEIV0(25:11)
 19874     CALL 'kxdfhei1' USING DFHEIV0,
 19875           FILE-ID-ERPNDB,
 19876           ERPNDB-KEY,
 19877           DFHEIV99,
 19878           DFHEIV11,
 19879           DFHEIV99
 19880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19881
 19882
 19883
 19884* EXEC CICS READNEXT
 19885*         DATASET    (FILE-ID-ERPNDB)
 19886*         SET        (ADDRESS OF PENDING-BUSINESS)
 19887*         RIDFLD     (ERPNDB-KEY)
 19888*    END-EXEC.
 19889     MOVE 0
 19890       TO DFHEIV11
 19891*    MOVE '&.S                   )   #00016864' TO DFHEIV0
 19892     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19894     MOVE X'2020233030303136383634' TO DFHEIV0(25:11)
 19895     CALL 'kxdfhei1' USING DFHEIV0,
 19896           FILE-ID-ERPNDB,
 19897           DFHEIV20,
 19898           DFHEIV99,
 19899           ERPNDB-KEY,
 19900           DFHEIV99,
 19901           DFHEIV11,
 19902           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 369
* EL6311.cbl
 19903           DFHEIV99
 19904     SET ADDRESS OF PENDING-BUSINESS TO
 19905         DFHEIV20
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909
 19910* EXEC CICS READPREV
 19911*         DATASET    (FILE-ID-ERPNDB)
 19912*         SET        (ADDRESS OF PENDING-BUSINESS)
 19913*         RIDFLD     (ERPNDB-KEY)
 19914*    END-EXEC.
 19915     MOVE 0
 19916       TO DFHEIV11
 19917*    MOVE '&0S                   )   #00016870' TO DFHEIV0
 19918     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19920     MOVE X'2020233030303136383730' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0,
 19922           FILE-ID-ERPNDB,
 19923           DFHEIV20,
 19924           DFHEIV99,
 19925           ERPNDB-KEY,
 19926           DFHEIV99,
 19927           DFHEIV11,
 19928           DFHEIV99,
 19929           DFHEIV99
 19930     SET ADDRESS OF PENDING-BUSINESS TO
 19931         DFHEIV20
 19932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19933
 19934
 19935     GO TO 4810-READ-PREV-RECORD.
 19936
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 370
* EL6311.cbl
 19938
 19939******************************************************************
 19940*                                                                *
 19941*           B R O W S E   C S R   B A C K W A R D                *
 19942*                                                                *
 19943******************************************************************
 19944
 19945 4900-BROWSE-CSR-BACKWARD.
 19946
 19947     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19948
 19949
 19950* EXEC CICS HANDLE CONDITION
 19951*         NOTFND   (4970-NOT-FOUND)
 19952*         ENDFILE  (4950-END-RECORDS)
 19953*    END-EXEC
 19954*    MOVE '"$I''                  ! Q #00016890' TO DFHEIV0
 19955     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19957     MOVE X'5120233030303136383930' TO DFHEIV0(25:11)
 19958     CALL 'kxdfhei1' USING DFHEIV0
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19960
 19961
 19962* EXEC CICS STARTBR
 19963*         DATASET   (FILE-ID-ERPNDB4)
 19964*         RIDFLD    (ERPNDB-CSR-KEY)
 19965*    END-EXEC.
 19966     MOVE 0
 19967       TO DFHEIV11
 19968*    MOVE '&,         G          &   #00016895' TO DFHEIV0
 19969     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19971     MOVE X'2020233030303136383935' TO DFHEIV0(25:11)
 19972     CALL 'kxdfhei1' USING DFHEIV0,
 19973           FILE-ID-ERPNDB4,
 19974           ERPNDB-CSR-KEY,
 19975           DFHEIV99,
 19976           DFHEIV11,
 19977           DFHEIV99
 19978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19979
 19980
 19981     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19982                                    WS-FIRST-TIME-SW.
 19983
 19984 4905-READ-PREV-RECORD.
 19985
 19986* EXEC CICS READPREV
 19987*         DATASET    (FILE-ID-ERPNDB4)
 19988*         SET        (ADDRESS OF PENDING-BUSINESS)
 19989*         RIDFLD     (ERPNDB-CSR-KEY)
 19990*    END-EXEC.
 19991     MOVE 0
 19992       TO DFHEIV11
 19993*    MOVE '&0S                   )   #00016904' TO DFHEIV0
 19994     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19995     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 371
* EL6311.cbl
 19996     MOVE X'2020233030303136393034' TO DFHEIV0(25:11)
 19997     CALL 'kxdfhei1' USING DFHEIV0,
 19998           FILE-ID-ERPNDB4,
 19999           DFHEIV20,
 20000           DFHEIV99,
 20001           ERPNDB-CSR-KEY,
 20002           DFHEIV99,
 20003           DFHEIV11,
 20004           DFHEIV99,
 20005           DFHEIV99
 20006     SET ADDRESS OF PENDING-BUSINESS TO
 20007         DFHEIV20
 20008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20009
 20010
 20011     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20012
 20013     IF WS-BATCH-PREFIX = '#CL'
 20014         GO TO 4905-READ-PREV-RECORD.
 20015
 20016     IF FIRST-TIME
 20017         MOVE SPACE               TO WS-FIRST-TIME-SW
 20018         GO TO 4905-READ-PREV-RECORD.
 20019
 20020     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20021        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20022        GO TO 4950-END-RECORDS.
 20023
 20024     IF PB-BATCH-TRAILER
 20025        GO TO 4905-READ-PREV-RECORD.
 20026
 20027     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20028
 20029     IF  WS-BATCH-PREFIX = '#CL'
 20030         GO TO 4905-READ-PREV-RECORD.
 20031
 20032     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20033        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20034           GO TO 4905-READ-PREV-RECORD
 20035        ELSE
 20036           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20037              GO TO 4910-CHECK-REC-TYPE
 20038           ELSE
 20039              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20040                 GO TO 4910-CHECK-REC-TYPE
 20041              ELSE
 20042                 GO TO 4905-READ-PREV-RECORD.
 20043
 20044     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20045        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20046           GO TO 4905-READ-PREV-RECORD.
 20047
 20048 4910-CHECK-REC-TYPE.
 20049     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20050         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20051             NEXT SENTENCE
 20052         ELSE
 20053             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 372
* EL6311.cbl
 20054
 20055     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20056         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20057             NEXT SENTENCE
 20058        ELSE
 20059             GO TO 4905-READ-PREV-RECORD.
 20060
 20061     IF NOT DISPLAY-CHANGE-RECORDS AND
 20062            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20063        GO TO 4905-READ-PREV-RECORD.
 20064
 20065     IF DISPLAY-HOLD-RECORDS AND
 20066        NOT PB-RECORD-ON-HOLD
 20067          GO TO 4905-READ-PREV-RECORD.
 20068
 20069     IF PB-ISSUE
 20070        IF DISPLAY-CHK-REQ-RECORDS
 20071           GO TO 4905-READ-PREV-RECORD.
 20072
 20073     IF PB-ISSUE
 20074        IF ISSUE-WITH-WARNING
 20075           IF PB-WARNING-ERRORS
 20076              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20077                  GO TO 4505-READ-PREV-RECORD
 20078              ELSE
 20079                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20080                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20081                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20082                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20083                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20084                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20085                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20086                 GO TO 7000-DISPLAY-ISSUES
 20087           ELSE
 20088              GO TO 4905-READ-PREV-RECORD.
 20089
 20090     IF PB-ISSUE
 20091        IF (ISSUES-IN-ERROR AND
 20092            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20093            ALL-ISSUES
 20094            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20095            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20096            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20097            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20098            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20099            MOVE PB-SV-STATE            TO PI-SV-STATE
 20100            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20101            GO TO 7000-DISPLAY-ISSUES
 20102        ELSE
 20103            GO TO 4905-READ-PREV-RECORD.
 20104
 20105     IF PB-CANCELLATION
 20106        IF DISPLAY-CHK-REQ-RECORDS
 20107           IF PB-C-REFUND-REQUESTED
 20108              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20109              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20110              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20111              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 373
* EL6311.cbl
 20112              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20113              MOVE PB-SV-STATE            TO PI-SV-STATE
 20114              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20115              GO TO 7100-DISPLAY-CANCELS
 20116           ELSE
 20117              GO TO 4905-READ-PREV-RECORD.
 20118
 20119     IF PB-CANCELLATION
 20120        IF CANCEL-WITH-WARNING
 20121           IF PB-WARNING-ERRORS
 20122              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20123                  GO TO 4505-READ-PREV-RECORD
 20124              ELSE
 20125                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20126                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20127                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20128                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20129                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20130                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20131                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20132                 GO TO 7100-DISPLAY-CANCELS
 20133           ELSE
 20134              GO TO 4905-READ-PREV-RECORD.
 20135
 20136     IF PB-CANCELLATION
 20137        IF (CANCEL-IN-ERROR  AND
 20138            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20139            ALL-CANCELS
 20140            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20141            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20142            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20143            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20144            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20145            MOVE PB-SV-STATE            TO PI-SV-STATE
 20146            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20147            GO TO 7100-DISPLAY-CANCELS.
 20148
 20149     GO TO 4905-READ-PREV-RECORD.
 20150
 20151 4950-END-RECORDS.
 20152     IF PI-MAP-NAME = EL631B
 20153        MOVE -1                  TO BMAINTL
 20154     ELSE
 20155        IF PI-MAP-NAME = EL631C
 20156           MOVE -1               TO CMAINTL
 20157        ELSE
 20158           MOVE -1               TO DPFENTRL.
 20159
 20160     MOVE ER-2255               TO EMI-ERROR.
 20161     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20162     GO TO 8200-SEND-DATAONLY.
 20163
 20164 4970-NOT-FOUND.
 20165
 20166******************************************************************
 20167*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20168******************************************************************
 20169
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 374
* EL6311.cbl
 20170
 20171* EXEC CICS RESETBR
 20172*         DATASET    (FILE-ID-ERPNDB4)
 20173*         RIDFLD     (ERPNDB-CSR-KEY)
 20174*    END-EXEC.
 20175     MOVE 0
 20176       TO DFHEIV11
 20177*    MOVE '&4         G          &   #00017069' TO DFHEIV0
 20178     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20179     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20180     MOVE X'2020233030303137303639' TO DFHEIV0(25:11)
 20181     CALL 'kxdfhei1' USING DFHEIV0,
 20182           FILE-ID-ERPNDB4,
 20183           ERPNDB-CSR-KEY,
 20184           DFHEIV99,
 20185           DFHEIV11,
 20186           DFHEIV99
 20187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20188
 20189
 20190
 20191* EXEC CICS READNEXT
 20192*         DATASET    (FILE-ID-ERPNDB4)
 20193*         SET        (ADDRESS OF PENDING-BUSINESS)
 20194*         RIDFLD     (ERPNDB-CSR-KEY)
 20195*    END-EXEC.
 20196     MOVE 0
 20197       TO DFHEIV11
 20198*    MOVE '&.S                   )   #00017074' TO DFHEIV0
 20199     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20200     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20201     MOVE X'2020233030303137303734' TO DFHEIV0(25:11)
 20202     CALL 'kxdfhei1' USING DFHEIV0,
 20203           FILE-ID-ERPNDB4,
 20204           DFHEIV20,
 20205           DFHEIV99,
 20206           ERPNDB-CSR-KEY,
 20207           DFHEIV99,
 20208           DFHEIV11,
 20209           DFHEIV99,
 20210           DFHEIV99
 20211     SET ADDRESS OF PENDING-BUSINESS TO
 20212         DFHEIV20
 20213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20214
 20215
 20216
 20217* EXEC CICS READPREV
 20218*         DATASET    (FILE-ID-ERPNDB4)
 20219*         SET        (ADDRESS OF PENDING-BUSINESS)
 20220*         RIDFLD     (ERPNDB-CSR-KEY)
 20221*    END-EXEC.
 20222     MOVE 0
 20223       TO DFHEIV11
 20224*    MOVE '&0S                   )   #00017080' TO DFHEIV0
 20225     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20227     MOVE X'2020233030303137303830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 375
* EL6311.cbl
 20228     CALL 'kxdfhei1' USING DFHEIV0,
 20229           FILE-ID-ERPNDB4,
 20230           DFHEIV20,
 20231           DFHEIV99,
 20232           ERPNDB-CSR-KEY,
 20233           DFHEIV99,
 20234           DFHEIV11,
 20235           DFHEIV99,
 20236           DFHEIV99
 20237     SET ADDRESS OF PENDING-BUSINESS TO
 20238         DFHEIV20
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20240
 20241
 20242 4980-READ-PREV-RECORD.
 20243
 20244* EXEC CICS READPREV
 20245*         DATASET    (FILE-ID-ERPNDB4)
 20246*         SET        (ADDRESS OF PENDING-BUSINESS)
 20247*         RIDFLD     (ERPNDB-CSR-KEY)
 20248*    END-EXEC.
 20249     MOVE 0
 20250       TO DFHEIV11
 20251*    MOVE '&0S                   )   #00017087' TO DFHEIV0
 20252     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20253     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20254     MOVE X'2020233030303137303837' TO DFHEIV0(25:11)
 20255     CALL 'kxdfhei1' USING DFHEIV0,
 20256           FILE-ID-ERPNDB4,
 20257           DFHEIV20,
 20258           DFHEIV99,
 20259           ERPNDB-CSR-KEY,
 20260           DFHEIV99,
 20261           DFHEIV11,
 20262           DFHEIV99,
 20263           DFHEIV99
 20264     SET ADDRESS OF PENDING-BUSINESS TO
 20265         DFHEIV20
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20270
 20271     IF WS-BATCH-PREFIX = '#CL'
 20272        GO TO 4980-READ-PREV-RECORD.
 20273
 20274     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20275     GO TO 4905-READ-PREV-RECORD.
 20276
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 376
* EL6311.cbl
 20278
 20279
 20280******************************************************************
 20281*                                                                *
 20282*        B R O W S E   B A T C H   H E A D E R S                 *
 20283*                                                                *
 20284******************************************************************
 20285
 20286 5000-BROWSE-BATCH-HEADERS.
 20287
 20288     IF EIBTRNID NOT = TRANS-EXB1
 20289        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20290        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20291        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20292        GO TO 5010-READ-NEXT-RECORD.
 20293
 20294     IF EIBAID = DFHPF4
 20295        MOVE '0'                TO PI-EDIT-SW
 20296        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20297        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20298        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20299        GO TO 5010-READ-NEXT-RECORD.
 20300
 20301     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20302     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20303     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20304
 20305
 20306* EXEC CICS HANDLE CONDITION
 20307*         ENDFILE  (5050-NOT-FOUND)
 20308*    END-EXEC.
 20309*    MOVE '"$''                   ! R #00017129' TO DFHEIV0
 20310     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20312     MOVE X'5220233030303137313239' TO DFHEIV0(25:11)
 20313     CALL 'kxdfhei1' USING DFHEIV0
 20314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20315
 20316
 20317 5010-READ-NEXT-RECORD.
 20318
 20319* EXEC CICS HANDLE CONDITION
 20320*         NOTFND    (5050-NOT-FOUND)
 20321*    END-EXEC.
 20322*    MOVE '"$I                   ! S #00017134' TO DFHEIV0
 20323     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20325     MOVE X'5320233030303137313334' TO DFHEIV0(25:11)
 20326     CALL 'kxdfhei1' USING DFHEIV0
 20327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20328
 20329
 20330
 20331* EXEC CICS READ
 20332*         DATASET   (FILE-ID-ERPNDB)
 20333*         SET       (ADDRESS OF PENDING-BUSINESS)
 20334*         RIDFLD    (ERPNDB-KEY)
 20335*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 377
* EL6311.cbl
 20336*    END-EXEC.
 20337*    MOVE '&"S        G          (   #00017138' TO DFHEIV0
 20338     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20340     MOVE X'2020233030303137313338' TO DFHEIV0(25:11)
 20341     CALL 'kxdfhei1' USING DFHEIV0,
 20342           FILE-ID-ERPNDB,
 20343           DFHEIV20,
 20344           DFHEIV99,
 20345           ERPNDB-KEY,
 20346           DFHEIV99,
 20347           DFHEIV99,
 20348           DFHEIV99
 20349     SET ADDRESS OF PENDING-BUSINESS TO
 20350         DFHEIV20
 20351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20352
 20353
 20354     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20355         GO TO 5050-NOT-FOUND.
 20356
 20357     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20358
 20359     IF WS-BATCH-PREFIX = '#CL'
 20360         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20361         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20362         GO TO 5010-READ-NEXT-RECORD.
 20363
 20364     IF NOT PB-BATCH-TRAILER
 20365         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20366         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20367         GO TO 5010-READ-NEXT-RECORD.
 20368
 20369     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20370         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20371             NEXT SENTENCE
 20372         ELSE
 20373             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20374             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20375             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20376             GO TO 5010-READ-NEXT-RECORD.
 20377
 20378     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20379         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20380             NEXT SENTENCE
 20381        ELSE
 20382             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20383             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20384             GO TO 5010-READ-NEXT-RECORD.
 20385
 20386     IF EIBAID = DFHPF4
 20387        MOVE '0'                TO PI-EDIT-SW
 20388        GO TO 7200-DISPLAY-BATCHES.
 20389
 20390     IF PI-CSR-BROWSE
 20391        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20392           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20393           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 378
* EL6311.cbl
 20394           GO TO 5010-READ-NEXT-RECORD.
 20395
 20396     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20397       IF PI-PB-CARRIER    = SPACES AND
 20398          PI-PB-GROUPING   = SPACES AND
 20399          PI-PB-STATE      = SPACES AND
 20400          PI-PB-ACCOUNT    = SPACES
 20401            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20402            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20403            GO TO 7200-DISPLAY-BATCHES
 20404         ELSE
 20405           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20406              PI-PB-GROUPING   = PB-GROUPING AND
 20407              PI-PB-STATE      = PB-STATE    AND
 20408              PI-PB-ACCOUNT    = PB-ACCOUNT
 20409              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20410              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20411              GO TO 7200-DISPLAY-BATCHES.
 20412
 20413     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20414     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20415
 20416
 20417* EXEC CICS HANDLE CONDITION
 20418*         NOTFND    (5050-NOT-FOUND)
 20419*    END-EXEC.
 20420*    MOVE '"$I                   ! T #00017207' TO DFHEIV0
 20421     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20423     MOVE X'5420233030303137323037' TO DFHEIV0(25:11)
 20424     CALL 'kxdfhei1' USING DFHEIV0
 20425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20426
 20427
 20428
 20429* EXEC CICS READ
 20430*         DATASET   (FILE-ID-ERPNDB)
 20431*         SET       (ADDRESS OF PENDING-BUSINESS)
 20432*         RIDFLD    (ERPNDB-KEY)
 20433*         GTEQ
 20434*    END-EXEC.
 20435*    MOVE '&"S        G          (   #00017211' TO DFHEIV0
 20436     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20438     MOVE X'2020233030303137323131' TO DFHEIV0(25:11)
 20439     CALL 'kxdfhei1' USING DFHEIV0,
 20440           FILE-ID-ERPNDB,
 20441           DFHEIV20,
 20442           DFHEIV99,
 20443           ERPNDB-KEY,
 20444           DFHEIV99,
 20445           DFHEIV99,
 20446           DFHEIV99
 20447     SET ADDRESS OF PENDING-BUSINESS TO
 20448         DFHEIV20
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20450
 20451
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 379
* EL6311.cbl
 20452     GO TO 5010-READ-NEXT-RECORD.
 20453
 20454 5050-NOT-FOUND.
 20455
 20456******************************************************************
 20457*                                                                *
 20458*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20459*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20460*         PROGRAM.                                               *
 20461*                                                                *
 20462******************************************************************
 20463
 20464     IF EIBTRNID NOT = TRANS-EXB1
 20465        IF PENDING-BUS-RECS-FOUND
 20466            NEXT SENTENCE
 20467          ELSE
 20468            MOVE '9'            TO PI-BROWSE-SW
 20469            GO TO 9400-CLEAR.
 20470
 20471     MOVE ER-2256                TO EMI-ERROR.
 20472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20473
 20474     IF PI-MAP-NAME = SPACES
 20475        MOVE EL631D              TO PI-MAP-NAME
 20476        MOVE -1                  TO DPFENTRL
 20477        GO TO 8100-SEND-INITIAL-MAP.
 20478
 20479     IF PI-MAP-NAME = EL631B
 20480        MOVE -1                  TO BMAINTL
 20481     ELSE
 20482        IF PI-MAP-NAME = EL631C
 20483           MOVE -1               TO CMAINTL
 20484        ELSE
 20485           MOVE -1               TO DPFENTRL
 20486           GO TO 8200-SEND-DATAONLY.
 20487
 20488     GO TO 8100-SEND-INITIAL-MAP.
 20489
 20490     .
 20491 5100-PROCESS-POL-RESC.
 20492     MOVE ZEROS                  TO CG-LF-BENCD
 20493                                    CG-AH-BENCD
 20494                                    CG-LF-CAN-AMT
 20495                                    CG-AH-CAN-AMT
 20496     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20497                                    CG-AH-CAN-DT
 20498     MOVE SPACES                 TO CG-BATCH-NO
 20499     MOVE '4'                    TO CG-OPTION-CODE
 20500     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20501     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20502     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20503     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20504     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20505     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20506     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20507     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20508     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20509     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 380
* EL6311.cbl
 20510     MOVE PI-PREV-ALT-KEY (1:33)
 20511                                 TO CG-CERT-KEY
 20512     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20513     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20514                                    CG-AH-CAN-AMT
 20515     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20516                                    CG-AH-CAN-DT
 20517     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20518     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20519      display 'about to cancel ' cg-cert-key
 20520
 20521* EXEC CICS LINK
 20522*        PROGRAM  ('ELCANC')
 20523*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20524*    END-EXEC
 20525     MOVE LENGTH OF
 20526      CANCEL-GEN-PASS-AREA
 20527       TO DFHEIV11
 20528     MOVE 'ELCANC' TO DFHEIV1
 20529*    MOVE '."C                   (   #00017286' TO DFHEIV0
 20530     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20532     MOVE X'2020233030303137323836' TO DFHEIV0(25:11)
 20533     CALL 'kxdfhei1' USING DFHEIV0,
 20534           DFHEIV1,
 20535           CANCEL-GEN-PASS-AREA,
 20536           DFHEIV11,
 20537           DFHEIV99,
 20538           DFHEIV99,
 20539           DFHEIV99,
 20540           DFHEIV99
 20541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20542     IF CG-SUCCESS
 20543        CONTINUE
 20544     ELSE
 20545        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20546        MOVE '3'                 TO EMI-SWITCH1
 20547        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20548        EVALUATE TRUE
 20549           WHEN CG-DATE-ERROR
 20550             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20551           WHEN CG-CERT-NOT-FOUND
 20552             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20553           WHEN CG-AMOUNT-ERROR
 20554             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20555           WHEN CG-OPTION-ERROR
 20556             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20557           WHEN CG-PREV-CAN
 20558             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20559           WHEN CG-INVALID-DATA
 20560             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20561           WHEN CG-NO-ACCT-MSTR
 20562             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20563           WHEN CG-SFX-A-EXIST
 20564             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20565           WHEN CG-MISC-ERROR
 20566             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20567           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 381
* EL6311.cbl
 20568             MOVE ' ERROR - ELCANC - RETURN '
 20569                                 TO EMI-ERROR-TEXT (1) (12:25)
 20570        END-EVALUATE
 20571        GO TO 8200-SEND-DATAONLY
 20572     END-IF
 20573     .
 20574 5100-EXIT.
 20575     EXIT.
 20576
 20577******************************************************************
 20578*                                                                *
 20579*        B R O W S E   B A T C H   B A C K W A R D S             *
 20580*                                                                *
 20581******************************************************************
 20582
 20583 5500-BROWSE-BATCH-BACKWARD.
 20584
 20585* EXEC CICS HANDLE CONDITION
 20586*         NOTFND   (5550-END-RECORDS)
 20587*         ENDFILE  (5550-END-RECORDS)
 20588*    END-EXEC.
 20589*    MOVE '"$I''                  ! U #00017332' TO DFHEIV0
 20590     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20592     MOVE X'5520233030303137333332' TO DFHEIV0(25:11)
 20593     CALL 'kxdfhei1' USING DFHEIV0
 20594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20595
 20596
 20597 5505-START-BROWSE.
 20598     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20599     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20600     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20601
 20602
 20603* EXEC CICS STARTBR
 20604*         DATASET   (FILE-ID-ERPNDB)
 20605*         RIDFLD    (ERPNDB-ALT-KEY)
 20606*    END-EXEC.
 20607     MOVE 0
 20608       TO DFHEIV11
 20609*    MOVE '&,         G          &   #00017342' TO DFHEIV0
 20610     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20611     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20612     MOVE X'2020233030303137333432' TO DFHEIV0(25:11)
 20613     CALL 'kxdfhei1' USING DFHEIV0,
 20614           FILE-ID-ERPNDB,
 20615           ERPNDB-ALT-KEY,
 20616           DFHEIV99,
 20617           DFHEIV11,
 20618           DFHEIV99
 20619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20620
 20621
 20622     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20623
 20624
 20625* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 382
* EL6311.cbl
 20626*         DATASET    (FILE-ID-ERPNDB)
 20627*         SET        (ADDRESS OF PENDING-BUSINESS)
 20628*         RIDFLD     (ERPNDB-KEY)
 20629*    END-EXEC.
 20630     MOVE 0
 20631       TO DFHEIV11
 20632*    MOVE '&.S                   )   #00017349' TO DFHEIV0
 20633     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20635     MOVE X'2020233030303137333439' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0,
 20637           FILE-ID-ERPNDB,
 20638           DFHEIV20,
 20639           DFHEIV99,
 20640           ERPNDB-KEY,
 20641           DFHEIV99,
 20642           DFHEIV11,
 20643           DFHEIV99,
 20644           DFHEIV99
 20645     SET ADDRESS OF PENDING-BUSINESS TO
 20646         DFHEIV20
 20647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20648
 20649
 20650
 20651* EXEC CICS READPREV
 20652*         DATASET    (FILE-ID-ERPNDB)
 20653*         SET        (ADDRESS OF PENDING-BUSINESS)
 20654*         RIDFLD     (ERPNDB-KEY)
 20655*    END-EXEC.
 20656     MOVE 0
 20657       TO DFHEIV11
 20658*    MOVE '&0S                   )   #00017355' TO DFHEIV0
 20659     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303137333535' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           FILE-ID-ERPNDB,
 20664           DFHEIV20,
 20665           DFHEIV99,
 20666           ERPNDB-KEY,
 20667           DFHEIV99,
 20668           DFHEIV11,
 20669           DFHEIV99,
 20670           DFHEIV99
 20671     SET ADDRESS OF PENDING-BUSINESS TO
 20672         DFHEIV20
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20674
 20675
 20676
 20677* EXEC CICS READPREV
 20678*         DATASET    (FILE-ID-ERPNDB)
 20679*         SET        (ADDRESS OF PENDING-BUSINESS)
 20680*         RIDFLD     (ERPNDB-KEY)
 20681*    END-EXEC.
 20682     MOVE 0
 20683       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 383
* EL6311.cbl
 20684*    MOVE '&0S                   )   #00017361' TO DFHEIV0
 20685     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20686     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20687     MOVE X'2020233030303137333631' TO DFHEIV0(25:11)
 20688     CALL 'kxdfhei1' USING DFHEIV0,
 20689           FILE-ID-ERPNDB,
 20690           DFHEIV20,
 20691           DFHEIV99,
 20692           ERPNDB-KEY,
 20693           DFHEIV99,
 20694           DFHEIV11,
 20695           DFHEIV99,
 20696           DFHEIV99
 20697     SET ADDRESS OF PENDING-BUSINESS TO
 20698         DFHEIV20
 20699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20700
 20701
 20702     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20703        GO TO 5550-END-RECORDS.
 20704
 20705     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20706
 20707     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20708
 20709     IF  WS-BATCH-PREFIX = '#CL'
 20710             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20711
 20712* EXEC CICS ENDBR
 20713*                 DATASET  (FILE-ID-ERPNDB)
 20714*            END-EXEC
 20715     MOVE 0
 20716       TO DFHEIV11
 20717*    MOVE '&2                    $   #00017376' TO DFHEIV0
 20718     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20720     MOVE X'2020233030303137333736' TO DFHEIV0(25:11)
 20721     CALL 'kxdfhei1' USING DFHEIV0,
 20722           FILE-ID-ERPNDB,
 20723           DFHEIV11,
 20724           DFHEIV99
 20725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20726         GO TO 5505-START-BROWSE.
 20727
 20728     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20729         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20730             NEXT SENTENCE
 20731         ELSE
 20732             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20733
 20734* EXEC CICS ENDBR
 20735*                 DATASET  (FILE-ID-ERPNDB)
 20736*            END-EXEC
 20737     MOVE 0
 20738       TO DFHEIV11
 20739*    MOVE '&2                    $   #00017386' TO DFHEIV0
 20740     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 384
* EL6311.cbl
 20742     MOVE X'2020233030303137333836' TO DFHEIV0(25:11)
 20743     CALL 'kxdfhei1' USING DFHEIV0,
 20744           FILE-ID-ERPNDB,
 20745           DFHEIV11,
 20746           DFHEIV99
 20747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20748             GO TO 5505-START-BROWSE.
 20749
 20750
 20751     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20752         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20753             NEXT SENTENCE
 20754        ELSE
 20755             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20756
 20757* EXEC CICS ENDBR
 20758*                 DATASET  (FILE-ID-ERPNDB)
 20759*            END-EXEC
 20760     MOVE 0
 20761       TO DFHEIV11
 20762*    MOVE '&2                    $   #00017397' TO DFHEIV0
 20763     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20765     MOVE X'2020233030303137333937' TO DFHEIV0(25:11)
 20766     CALL 'kxdfhei1' USING DFHEIV0,
 20767           FILE-ID-ERPNDB,
 20768           DFHEIV11,
 20769           DFHEIV99
 20770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20771             GO TO 5505-START-BROWSE.
 20772
 20773     IF NOT PB-BATCH-TRAILER
 20774        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20775
 20776* EXEC CICS ENDBR
 20777*            DATASET  (FILE-ID-ERPNDB)
 20778*       END-EXEC
 20779     MOVE 0
 20780       TO DFHEIV11
 20781*    MOVE '&2                    $   #00017404' TO DFHEIV0
 20782     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20783     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20784     MOVE X'2020233030303137343034' TO DFHEIV0(25:11)
 20785     CALL 'kxdfhei1' USING DFHEIV0,
 20786           FILE-ID-ERPNDB,
 20787           DFHEIV11,
 20788           DFHEIV99
 20789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20790        GO TO 5505-START-BROWSE.
 20791
 20792     IF PI-CSR-BROWSE
 20793        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20794           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20795
 20796* EXEC CICS ENDBR
 20797*               DATASET  (FILE-ID-ERPNDB)
 20798*          END-EXEC
 20799     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 385
* EL6311.cbl
 20800       TO DFHEIV11
 20801*    MOVE '&2                    $   #00017412' TO DFHEIV0
 20802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20804     MOVE X'2020233030303137343132' TO DFHEIV0(25:11)
 20805     CALL 'kxdfhei1' USING DFHEIV0,
 20806           FILE-ID-ERPNDB,
 20807           DFHEIV11,
 20808           DFHEIV99
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20810           GO TO 5505-START-BROWSE.
 20811
 20812     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20813        IF PI-PB-CARRIER    = SPACES AND
 20814           PI-PB-GROUPING   = SPACES AND
 20815           PI-PB-STATE      = SPACES AND
 20816           PI-PB-ACCOUNT    = SPACES
 20817             GO TO 7200-DISPLAY-BATCHES
 20818          ELSE
 20819            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20820               PI-PB-GROUPING   = PB-GROUPING AND
 20821               PI-PB-STATE      = PB-STATE    AND
 20822               PI-PB-ACCOUNT    = PB-ACCOUNT
 20823                 GO TO 7200-DISPLAY-BATCHES.
 20824
 20825     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20826
 20827
 20828* EXEC CICS ENDBR
 20829*         DATASET  (FILE-ID-ERPNDB)
 20830*    END-EXEC.
 20831     MOVE 0
 20832       TO DFHEIV11
 20833*    MOVE '&2                    $   #00017432' TO DFHEIV0
 20834     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20836     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 20837     CALL 'kxdfhei1' USING DFHEIV0,
 20838           FILE-ID-ERPNDB,
 20839           DFHEIV11,
 20840           DFHEIV99
 20841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20842
 20843
 20844     GO TO 5505-START-BROWSE.
 20845
 20846 5550-END-RECORDS.
 20847     MOVE ER-2257                TO EMI-ERROR.
 20848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20849     MOVE -1                     TO DPFENTRL.
 20850
 20851     GO TO 8200-SEND-DATAONLY.
 20852
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 386
* EL6311.cbl
 20854
 20855******************************************************************
 20856*                                                                *
 20857*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20858*                                                                *
 20859******************************************************************
 20860
 20861 6000-CREATE-TEMP-STORAGE.
 20862
 20863
 20864* EXEC CICS HANDLE CONDITION
 20865*        QIDERR  (6050-QID-ERROR)
 20866*    END-EXEC.
 20867*    MOVE '"$N                   ! V #00017455' TO DFHEIV0
 20868     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20870     MOVE X'5620233030303137343535' TO DFHEIV0(25:11)
 20871     CALL 'kxdfhei1' USING DFHEIV0
 20872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20873
 20874
 20875
 20876* EXEC CICS WRITEQ TS
 20877*        QUEUE    (QID)
 20878*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20879*        LENGTH   (WS-COMM-LENGTH)
 20880*        ITEM     (W-ONE)
 20881*    END-EXEC.
 20882*    MOVE '*" I                  ''   #00017459' TO DFHEIV0
 20883     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20885     MOVE X'2020233030303137343539' TO DFHEIV0(25:11)
 20886     CALL 'kxdfhei1' USING DFHEIV0,
 20887           QID,
 20888           PROGRAM-INTERFACE-BLOCK,
 20889           WS-COMM-LENGTH,
 20890           W-ONE,
 20891           DFHEIV99,
 20892           DFHEIV99
 20893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20894
 20895
 20896 6000-EXIT.
 20897      EXIT.
 20898
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 387
* EL6311.cbl
 20900
 20901******************************************************************
 20902*                                                                *
 20903*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20904*                                                                *
 20905******************************************************************
 20906
 20907 6050-RECOVER-TEMP-STORAGE.
 20908     IF PGM-NAME = XCTL-EL6312
 20909        GO TO 6050-EXIT.
 20910
 20911     IF PGM-NAME = XCTL-EL6313
 20912        GO TO 6050-EXIT.
 20913
 20914     IF PGM-NAME = XCTL-EL6315
 20915         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20916     END-IF
 20917
 20918     IF PGM-NAME = XCTL-EL6316
 20919         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20920     END-IF
 20921
 20922
 20923* EXEC CICS HANDLE CONDITION
 20924*        QIDERR  (6050-QID-ERROR)
 20925*    END-EXEC.
 20926*    MOVE '"$N                   ! W #00017492' TO DFHEIV0
 20927     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20929     MOVE X'5720233030303137343932' TO DFHEIV0(25:11)
 20930     CALL 'kxdfhei1' USING DFHEIV0
 20931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20932
 20933
 20934
 20935* EXEC CICS READQ TS
 20936*         QUEUE   (QID)
 20937*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20938*         LENGTH  (WS-COMM-LENGTH)
 20939*         ITEM    (W-ONE)
 20940*     END-EXEC.
 20941*    MOVE '*$II   L              ''   #00017496' TO DFHEIV0
 20942     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20944     MOVE X'2020233030303137343936' TO DFHEIV0(25:11)
 20945     CALL 'kxdfhei1' USING DFHEIV0,
 20946           QID,
 20947           PROGRAM-INTERFACE-BLOCK,
 20948           WS-COMM-LENGTH,
 20949           W-ONE,
 20950           DFHEIV99,
 20951           DFHEIV99
 20952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20953
 20954
 20955 6050-DELETE-TEMP-STORAGE.
 20956
 20957
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 388
* EL6311.cbl
 20958* EXEC CICS DELETEQ TS
 20959*        QUEUE   (QID)
 20960*    END-EXEC.
 20961*    MOVE '*&                    #   #00017505' TO DFHEIV0
 20962     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 20963     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20964     MOVE X'2020233030303137353035' TO DFHEIV0(25:11)
 20965     CALL 'kxdfhei1' USING DFHEIV0,
 20966           QID,
 20967           DFHEIV99
 20968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20969
 20970
 20971     GO TO 6050-EXIT.
 20972
 20973 6050-QID-ERROR.
 20974     MOVE ER-0033                TO EMI-ERROR
 20975     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20976
 20977 6050-EXIT.
 20978      EXIT.
 20979
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 389
* EL6311.cbl
 20981
 20982******************************************************************
 20983*                                                                *
 20984*            T E R M   C O N V E R S I O N                       *
 20985*                                                                *
 20986******************************************************************
 20987
 20988 6100-TERM-CONVERSION.
 20989
 20990     IF PI-BPMTS = ZERO
 20991         GO TO 6199-EXIT.
 20992
 20993     IF PI-BMODE = ' ' OR 'M'
 20994         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 20995         GO TO 6105-ROUND-TERM.
 20996
 20997     IF PI-BMODE = 'S'
 20998         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 20999         GO TO 6105-ROUND-TERM.
 21000
 21001     IF PI-BMODE = 'W'
 21002         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21003         GO TO 6105-ROUND-TERM.
 21004
 21005     IF PI-BMODE = 'B'
 21006         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21007         GO TO 6105-ROUND-TERM.
 21008
 21009     IF PI-BMODE = 'T'
 21010         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21011
 21012 6105-ROUND-TERM.
 21013
 21014     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21015         ADD +1                  TO WS-CALC-TERM-WHOLE
 21016         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21017
 21018     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21019         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21020
 21021     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21022         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21023                                      WS-BTERM    (WS-SUB1)
 21024         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21025
 21026     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21027         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21028             MOVE -1               TO BMODEL
 21029             MOVE ER-2593          TO EMI-ERROR
 21030             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21031             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21032
 21033 6124-CHECK-BENEFIT.
 21034
 21035     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21036        GO TO 6126-COMPUTE-BENEFIT.
 21037
 21038     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 390
* EL6311.cbl
 21039
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 391
* EL6311.cbl
 21041******************************************************************
 21042**         COMPUTE TERM AND BENEFIT
 21043******************************************************************
 21044 6125-COMPUTE-TERM-BENEFIT.
 21045
 21046     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21047        PI-BPMTAMT = ZERO
 21048         GO TO 6199-EXIT.
 21049
 21050     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21051                                     WS-BTERM  (WS-SUB1).
 21052     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21053
 21054 6126-COMPUTE-BENEFIT.
 21055
 21056     IF PI-BMODE = 'M' OR  ' '
 21057         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21058
 21059     IF PI-BMODE = 'W'
 21060         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21061
 21062     IF PI-BMODE = 'S'
 21063         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21064
 21065     IF PI-BMODE = 'B'
 21066         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21067
 21068     IF PI-BMODE = 'T'
 21069         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21070
 21071     IF WS-SUB1 = +1
 21072        COMPUTE WS-BBEN (WS-SUB1) =
 21073                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21074
 21075     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21076     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21077     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21078
 21079 6199-EXIT.
 21080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 392
* EL6311.cbl
 21082
 21083******************************************************************
 21084*                                                                *
 21085*             D I S P L A Y   I S S U E S                        *
 21086*                                                                *
 21087******************************************************************
 21088
 21089 6200-CREATE-VADS.
 21090     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21091     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21092     MOVE SPACES                 TO WS-PASS-VADS-REC
 21093
 21094* EXEC CICS GETMAIN
 21095*       SET      (ADDRESS OF PENDING-BUSINESS)
 21096*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21097*       INITIMG  (GETMAIN-SPACE)
 21098*       RESP     (WS-RESPONSE)
 21099*    END-EXEC
 21100*    MOVE ',"IL                  $  N#00017631' TO DFHEIV0
 21101     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21102     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21103     MOVE X'204E233030303137363331' TO DFHEIV0(25:11)
 21104     CALL 'kxdfhei1' USING DFHEIV0,
 21105           DFHEIV20,
 21106           ERPNDB-RECORD-LENGTH,
 21107           GETMAIN-SPACE
 21108     SET ADDRESS OF PENDING-BUSINESS TO
 21109         DFHEIV20
 21110     MOVE EIBRESP  TO WS-RESPONSE
 21111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21112
 21113* EXEC CICS READ
 21114*       INTO    (PENDING-BUSINESS)
 21115*       DATASET (FILE-ID-ERPNDB)
 21116*       RIDFLD  (ERPNDB-KEY)
 21117*       RESP    (WS-RESPONSE)
 21118*    END-EXEC
 21119     MOVE LENGTH OF
 21120      PENDING-BUSINESS
 21121       TO DFHEIV11
 21122*    MOVE '&"IL       E          (  N#00017637' TO DFHEIV0
 21123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21125     MOVE X'204E233030303137363337' TO DFHEIV0(25:11)
 21126     CALL 'kxdfhei1' USING DFHEIV0,
 21127           FILE-ID-ERPNDB,
 21128           PENDING-BUSINESS,
 21129           DFHEIV11,
 21130           ERPNDB-KEY,
 21131           DFHEIV99,
 21132           DFHEIV99,
 21133           DFHEIV99
 21134     MOVE EIBRESP  TO WS-RESPONSE
 21135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21136     IF RESP-NORMAL
 21137        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21138        IF (RESP-NORMAL)
 21139           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 393
* EL6311.cbl
 21140              AM-CONTROL-PRIMARY (1:20))
 21141           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21142        ELSE
 21143           MOVE 'ACCOUNT NOT FOUND'
 21144                                 TO VD-ACCOUNT-NAME
 21145        END-IF
 21146        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21147                                    TO M1
 21148        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21149        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21150           (A2 > M1)
 21151           OR (WS-WORK-FIELD (A2:1) = '*')
 21152           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21153           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21154        END-PERFORM
 21155        IF A2 > M1
 21156           CONTINUE
 21157        ELSE
 21158           MOVE WS-WORK-FIELD (1:A2 - 1)
 21159                                    TO VD-ACCOUNT-NAME
 21160        END-IF
 21161        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21162        MOVE PB-CARRIER          TO VD-CARRIER
 21163        MOVE PB-GROUPING         TO VD-GROUPING
 21164        MOVE PB-STATE            TO VD-STATE
 21165        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21166        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21167        MOVE PB-CERT-NO          TO VD-CERT-NO
 21168        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21169        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21170        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21171        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21172        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21173        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21174        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21175        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21176        MOVE PB-CSR-ID           TO VD-CSR-ID
 21177        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21178        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21179        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21180        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21181        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21182        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21183        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21184        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21185        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21186        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21187        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21188        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21189        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21190     END-IF
 21191     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21192
 21193
 21194* EXEC CICS GETMAIN
 21195*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21196*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21197*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 394
* EL6311.cbl
 21198*       RESP     (WS-RESPONSE)
 21199*    END-EXEC
 21200*    MOVE ',"IL                  $  N#00017700' TO DFHEIV0
 21201     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21202     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21203     MOVE X'204E233030303137373030' TO DFHEIV0(25:11)
 21204     CALL 'kxdfhei1' USING DFHEIV0,
 21205           DFHEIV20,
 21206           ERPNDM-RECORD-LENGTH,
 21207           GETMAIN-SPACE
 21208     SET ADDRESS OF PENDING-MAILING-DATA TO
 21209         DFHEIV20
 21210     MOVE EIBRESP  TO WS-RESPONSE
 21211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21212
 21213
 21214* EXEC CICS READ
 21215*       INTO    (PENDING-MAILING-DATA)
 21216*       DATASET (FILE-ID-ERPNDM)
 21217*       RIDFLD  (ERPNDM-KEY)
 21218*       RESP    (WS-RESPONSE)
 21219*    END-EXEC
 21220     MOVE LENGTH OF
 21221      PENDING-MAILING-DATA
 21222       TO DFHEIV11
 21223*    MOVE '&"IL       E          (  N#00017707' TO DFHEIV0
 21224     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21226     MOVE X'204E233030303137373037' TO DFHEIV0(25:11)
 21227     CALL 'kxdfhei1' USING DFHEIV0,
 21228           FILE-ID-ERPNDM,
 21229           PENDING-MAILING-DATA,
 21230           DFHEIV11,
 21231           ERPNDM-KEY,
 21232           DFHEIV99,
 21233           DFHEIV99,
 21234           DFHEIV99
 21235     MOVE EIBRESP  TO WS-RESPONSE
 21236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21237
 21238     IF RESP-NORMAL
 21239        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21240        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21241        MOVE PM-CITY              TO VD-INSURED-CITY
 21242        MOVE PM-STATE             TO VD-INSURED-STATE
 21243        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21244     END-IF
 21245
 21246     MOVE 'VAC1'                  TO VD-LETTER-ID
 21247     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21248     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21249     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21250     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21251     MOVE +0                      TO VD-ARCHIVE-NO
 21252     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21253     .
 21254 6200-EXIT.
 21255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 395
* EL6311.cbl
 21256 6210-READ-ERACCT.
 21257     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21258     MOVE LOW-VALUES             TO ERACCT-FILL
 21259
 21260* EXEC CICS READ
 21261*         DATASET   ('ERACCT')
 21262*         INTO      (ACCOUNT-MASTER)
 21263*         RIDFLD    (ERACCT-KEY)
 21264*         GTEQ
 21265*         RESP      (WS-RESPONSE)
 21266*    END-EXEC
 21267     MOVE LENGTH OF
 21268      ACCOUNT-MASTER
 21269       TO DFHEIV11
 21270     MOVE 'ERACCT' TO DFHEIV1
 21271*    MOVE '&"IL       G          (  N#00017735' TO DFHEIV0
 21272     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21273     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21274     MOVE X'204E233030303137373335' TO DFHEIV0(25:11)
 21275     CALL 'kxdfhei1' USING DFHEIV0,
 21276           DFHEIV1,
 21277           ACCOUNT-MASTER,
 21278           DFHEIV11,
 21279           ERACCT-KEY,
 21280           DFHEIV99,
 21281           DFHEIV99,
 21282           DFHEIV99
 21283     MOVE EIBRESP  TO WS-RESPONSE
 21284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21285     .
 21286 6210-EXIT.
 21287     EXIT.
 21288
 21289 6220-READ-ERMAIL.
 21290
 21291     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21292     MOVE ' '                    TO WS-ERMAIL-SW
 21293
 21294
 21295* EXEC CICS READ
 21296*       DATASET   (FILE-ID-ERMAIL)
 21297*       SET       (ADDRESS OF MAILING-DATA)
 21298*       RIDFLD    (ERMAIL-KEY)
 21299*       RESP      (WS-RESPONSE)
 21300*    END-EXEC
 21301*    MOVE '&"S        E          (  N#00017751' TO DFHEIV0
 21302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21304     MOVE X'204E233030303137373531' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0,
 21306           FILE-ID-ERMAIL,
 21307           DFHEIV20,
 21308           DFHEIV99,
 21309           ERMAIL-KEY,
 21310           DFHEIV99,
 21311           DFHEIV99,
 21312           DFHEIV99
 21313     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 396
* EL6311.cbl
 21314         DFHEIV20
 21315     MOVE EIBRESP  TO WS-RESPONSE
 21316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21317
 21318     IF RESP-NORMAL
 21319        SET ERMAIL-FOUND TO TRUE
 21320     END-IF
 21321     .
 21322 6220-EXIT.
 21323     EXIT.
 21324
 21325 6400-CHECK-FOR-RES-REF-CLAIM.
 21326     display 'made it to 6400- for ' pi-cert-no
 21327     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21328
 21329     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21330                                    W-CL-COMP-CD.
 21331     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21332                                    W-CL-CERT-NO.
 21333     MOVE SPACES                 TO MSTR-CERT-SFX.
 21334
 21335
 21336* EXEC CICS HANDLE CONDITION
 21337*        NOTFND  (6400-CONTINUE)
 21338*        ENDFILE (6400-CONTINUE)
 21339*    END-EXEC.
 21340*    MOVE '"$I''                  ! X #00017775' TO DFHEIV0
 21341     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21342     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21343     MOVE X'5820233030303137373735' TO DFHEIV0(25:11)
 21344     CALL 'kxdfhei1' USING DFHEIV0
 21345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21346
 21347
 21348
 21349* EXEC CICS IGNORE CONDITION
 21350*        DUPKEY
 21351*    END-EXEC.
 21352*    MOVE '"*$                   !   #00017780' TO DFHEIV0
 21353     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21355     MOVE X'2020233030303137373830' TO DFHEIV0(25:11)
 21356     CALL 'kxdfhei1' USING DFHEIV0
 21357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21358
 21359
 21360
 21361* EXEC CICS STARTBR
 21362*        DATASET   (CLMS-ID)
 21363*        RIDFLD    (ELMSTR-KEY)
 21364*        GENERIC   EQUAL
 21365*        KEYLENGTH (ELMSTR-LENGTH)
 21366*    END-EXEC.
 21367     MOVE 0
 21368       TO DFHEIV11
 21369*    MOVE '&,   KG    E          &   #00017784' TO DFHEIV0
 21370     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21371     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 397
* EL6311.cbl
 21372     MOVE X'2020233030303137373834' TO DFHEIV0(25:11)
 21373     CALL 'kxdfhei1' USING DFHEIV0,
 21374           CLMS-ID,
 21375           ELMSTR-KEY,
 21376           ELMSTR-LENGTH,
 21377           DFHEIV11,
 21378           DFHEIV99
 21379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21380
 21381
 21382     display 'browse started'
 21383     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21384
 21385 6400-NEXT-CLAIM.
 21386
 21387
 21388* EXEC CICS READNEXT
 21389*        DATASET   (CLMS-ID)
 21390*        RIDFLD    (ELMSTR-KEY)
 21391*        SET       (ADDRESS OF CLAIM-MASTER)
 21392*    END-EXEC.
 21393     MOVE 0
 21394       TO DFHEIV11
 21395*    MOVE '&.S                   )   #00017796' TO DFHEIV0
 21396     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21398     MOVE X'2020233030303137373936' TO DFHEIV0(25:11)
 21399     CALL 'kxdfhei1' USING DFHEIV0,
 21400           CLMS-ID,
 21401           DFHEIV20,
 21402           DFHEIV99,
 21403           ELMSTR-KEY,
 21404           DFHEIV99,
 21405           DFHEIV11,
 21406           DFHEIV99,
 21407           DFHEIV99
 21408     SET ADDRESS OF CLAIM-MASTER TO
 21409         DFHEIV20
 21410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21411
 21412
 21413     display 'read claim for ' mstr-cert-no
 21414     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21415        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21416         GO TO 6400-CONTINUE
 21417     END-IF.
 21418
 21419     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21420        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21421        PI-STATE       NOT = CL-CERT-STATE     OR
 21422        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21423        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21424         GO TO 6400-NEXT-CLAIM
 21425     END-IF.
 21426
 21427     display 'found claim ' cl-claim-no
 21428        ' with denial type ' cl-denial-type
 21429     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 398
* EL6311.cbl
 21430         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21431         GO TO 6400-CONTINUE
 21432     END-IF.
 21433
 21434     GO TO 6400-NEXT-CLAIM.
 21435
 21436 6400-CONTINUE.
 21437
 21438     IF WS-BROWSE-STARTED-SW = 'Y'
 21439
 21440* EXEC CICS ENDBR
 21441*            DATASET   (CLMS-ID)
 21442*        END-EXEC
 21443     MOVE 0
 21444       TO DFHEIV11
 21445*    MOVE '&2                    $   #00017828' TO DFHEIV0
 21446     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21448     MOVE X'2020233030303137383238' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0,
 21450           CLMS-ID,
 21451           DFHEIV11,
 21452           DFHEIV99
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21454         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21455     END-IF.
 21456
 21457 6400-EXIT.
 21458     EXIT.
 21459
 21460 7000-DISPLAY-ISSUES.
 21461
 21462     IF PI-DISPLAY-ORIGINAL-BATCH
 21463        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21464        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21465     ELSE
 21466        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21467
 21468     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21469
 21470     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21471     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21472
 21473     MOVE LOW-VALUES                 TO EL631BI.
 21474     MOVE ZEROS                      TO PI-BPMTAMT
 21475                                        PI-BPMTS.
 21476     MOVE SPACE                      TO PI-BMODE
 21477                                        PI-BTYPE (1)
 21478                                        PI-BTYPE (2).
 21479     MOVE EL631B                     TO PI-MAP-NAME.
 21480     MOVE 'Y'                        TO PI-BROWSE-SW.
 21481     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21482                                        PI-HIGH-SEQ-NO.
 21483
 21484     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21485        MOVE AL-SABOF                TO BCHGTA
 21486        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21487        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 399
* EL6311.cbl
 21488     ELSE
 21489        MOVE AL-SADOF                TO BCHGTA
 21490                                        BCHGA
 21491        MOVE PB-CHG-COUNT            TO BCHGO.
 21492
 21493     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21494     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21495     MOVE WS-HR-MINS                 TO BMANTATO.
 21496
 21497     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21498        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21499        MOVE SPACE                   TO DC-OPTION-CODE
 21500        PERFORM 9700-DATE-LINK
 21501        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21502        MOVE 'INACTIVE'              TO BMOENDTO
 21503     ELSE
 21504        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21505        MOVE SPACE                   TO DC-OPTION-CODE
 21506        PERFORM 9700-DATE-LINK
 21507        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21508        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21509        MOVE SPACE                   TO DC-OPTION-CODE
 21510        PERFORM 9700-DATE-LINK
 21511        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21512
 21513*    MOVE PB-I-REFERENCE             TO BREFO.
 21514
 21515*    IF PI-COMPANY-ID EQUAL 'HER'
 21516*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21517*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21518*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21519*                MOVE WS-MEMBER-NO-1-8
 21520*                                TO  BMICRNOO.
 21521
 21522*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21523*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21524*            MOVE PB-I-MICROFILM-NO
 21525*                                TO  BMICRNOO.
 21526     IF PB-I-VIN NOT = SPACES
 21527        MOVE PB-I-VIN            TO BVINO
 21528     END-IF
 21529
 21530     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21531     MOVE PB-CERT-SFX                TO BSUFIXO.
 21532     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21533     MOVE SPACE                      TO DC-OPTION-CODE.
 21534     PERFORM 9700-DATE-LINK.
 21535     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21536
 21537     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21538     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21539     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21540     MOVE PB-I-INSURED-SEX           TO BSEXO
 21541
 21542     IF PB-I-AGE NOT = ZEROS
 21543         MOVE PB-I-AGE               TO BAGEO.
 21544
 21545     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 400
* EL6311.cbl
 21546                                 TO ELCERT-KEY
 21547     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21548     IF NOT CERT-TRL-REC-NOT-FOUND
 21549         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21550             MOVE 'AGE*'             TO BAGEDEFO
 21551         ELSE
 21552             MOVE 'AGE '             TO BAGEDEFO
 21553         END-IF
 21554     ELSE
 21555         MOVE 'AGE '             TO BAGEDEFO
 21556     END-IF
 21557
 21558     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21559         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21560         MOVE SPACE                  TO DC-OPTION-CODE
 21561         PERFORM 9700-DATE-LINK
 21562         IF NO-CONVERSION-ERROR
 21563            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21564
 21565     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21566         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21567         MOVE SPACE                  TO DC-OPTION-CODE
 21568         PERFORM 9700-DATE-LINK
 21569         IF NO-CONVERSION-ERROR
 21570            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21571
 21572     IF PB-I-EXTENTION-DAYS NUMERIC
 21573        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21574           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21575        ELSE
 21576           IF PB-I-TERM-IN-DAYS NUMERIC
 21577              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21578                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21579
 21580     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21581        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21582
 21583     MOVE PB-FORCE-CODE              TO BFORCEO.
 21584     MOVE PB-I-TERM-TYPE             TO BMODEO
 21585                                        PI-BMODE.
 21586
 21587     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21588        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21589
 21590     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21591         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21592                                        PI-BPMTS.
 21593
 21594     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21595         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21596           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21597                                        PI-BPMTAMT.
 21598
 21599     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21600     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21601     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21602     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21603     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 401
* EL6311.cbl
 21604     MOVE PB-I-SIG-SW                TO BSIGO.
 21605     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21606     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21607     MOVE PB-RECORD-BILL             TO BBILCDO.
 21608     MOVE PB-FORCE-CODE              TO BFORCEO.
 21609
 21610     IF (PB-I-LIVES NUMERIC)
 21611        AND (PB-I-LIVES > ZEROS)
 21612        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21613        IF (RESP-NORMAL)
 21614           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21615           CONTINUE
 21616        ELSE
 21617           MOVE PB-I-LIVES       TO BLIVESO
 21618        END-IF
 21619     END-IF
 21620
 21621     IF PB-I-NUM-BILLED NUMERIC AND
 21622        PB-I-NUM-BILLED GREATER THAN ZEROS
 21623        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21624*    ELSE
 21625*       MOVE ZEROS                   TO BBILLEDO.
 21626
 21627     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21628
 21629     IF PB-I-LOAN-APR NOT = ZEROS
 21630        MOVE PB-I-LOAN-APR           TO BAPRO.
 21631
 21632     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21633        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21634
 21635     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21636        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21637           MOVE AL-SANOF                TO BORIGHDA
 21638           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21639           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21640
 21641     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21642
 21643     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21644        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21645
 21646     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21647        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21648                                        PI-BTYPE (1).
 21649
 21650     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21651        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21652
 21653     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21654        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21655
 21656     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21657        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21658
 21659     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21660        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21661
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 402
* EL6311.cbl
 21662     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21663        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21664
 21665     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21666         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21667         MOVE SPACE                  TO DC-OPTION-CODE
 21668         PERFORM 9700-DATE-LINK
 21669         IF NO-CONVERSION-ERROR
 21670            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21671
 21672     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21673        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21674        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21675        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21676        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21677                 GIVING BDIFFO (1)
 21678     ELSE
 21679        MOVE SPACES                  TO BBEN-CD     (1)
 21680                                        BBEN-ABBR   (1).
 21681
 21682     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21683        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21684        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21685                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21686
 21687     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21688       IF PB-RECORD-ON-HOLD
 21689          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21690
 21691     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21692       IF PB-RECORD-RETURNED
 21693          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21694
 21695     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21696        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21697             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21698
 21699     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21700
 21701     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21702        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21703
 21704     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21705        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21706                                        PI-BTYPE (2).
 21707
 21708     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21709        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21710
 21711     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21712        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21713
 21714     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21715        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21716
 21717     IF PB-I-TOT-FEES NOT NUMERIC
 21718        MOVE ZEROS               TO PB-I-TOT-FEES
 21719     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 403
* EL6311.cbl
 21720     IF PB-I-TOT-FEES > ZEROS
 21721        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21722
 21723     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21724         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21725         MOVE SPACE                  TO DC-OPTION-CODE
 21726         PERFORM 9700-DATE-LINK
 21727         IF NO-CONVERSION-ERROR
 21728            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21729
 21730     IF PB-I-TOT-FEES > ZEROS
 21731        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21732        SUBTRACT PB-I-TOT-FEES FROM
 21733                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21734
 21735     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21736        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21737        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21738        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21739        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21740                 GIVING BDIFFO (2)
 21741     ELSE
 21742        MOVE SPACES                  TO BBEN-CD     (2)
 21743                                        BBEN-ABBR   (2).
 21744
 21745     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21746       IF PB-RECORD-ON-HOLD
 21747          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21748
 21749     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21750       IF PB-RECORD-RETURNED
 21751          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21752
 21753     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21754        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21755             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21756
 21757     MOVE PB-CSR-ID                  TO BCSRO.
 21758
 21759     IF PI-COMPANY-ID  =  'DMD'
 21760        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21761            NEXT SENTENCE
 21762        ELSE
 21763            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21764               MOVE 'NEW CERT'       TO BNCERTLI
 21765               MOVE EC-NEW-CERT      TO BNCERTO.
 21766
 21767     IF PI-COMPANY-ID  =  'DMD'
 21768        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21769            NEXT SENTENCE
 21770        ELSE
 21771           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21772               MOVE 'NEW STATE'      TO BNSTATLI
 21773               MOVE EC-NEW-STATE     TO BNSTATO.
 21774
 21775 7000-CONTINUE.
 21776     MOVE 'C'                        TO BMAINTI.
 21777     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 404
* EL6311.cbl
 21778
 21779     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21780        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21781
 21782     IF PI-6315-FINALIZED = 'Y'   AND
 21783        PB-UNFORCED-ERRORS
 21784          MOVE -1                TO BFORCEL
 21785          MOVE  1                TO SET-CURSOR-SW
 21786     END-IF
 21787
 21788     IF NO-CURSOR-SET
 21789        MOVE -1                      TO BMAINTL.
 21790
 21791     GO TO 8100-SEND-INITIAL-MAP.
 21792
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 405
* EL6311.cbl
 21794
 21795******************************************************************
 21796*                                                                *
 21797*             D I S P L A Y   C A N C E L S                      *
 21798*                                                                *
 21799******************************************************************
 21800
 21801 7100-DISPLAY-CANCELS.
 21802     IF PI-DISPLAY-ORIGINAL-BATCH
 21803        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21804        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21805     ELSE
 21806        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21807
 21808     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21809
 21810     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21811     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21812
 21813     MOVE LOW-VALUES                 TO EL631CI.
 21814     MOVE EL631C                     TO PI-MAP-NAME.
 21815     MOVE 'Y'                        TO PI-BROWSE-SW.
 21816     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21817                                        PI-HIGH-SEQ-NO.
 21818
 21819     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21820        MOVE AL-SABOF                TO CCHGTA
 21821        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21822        MOVE AL-SANON                TO CCHGA
 21823      ELSE
 21824        MOVE AL-SADOF                TO CCHGTA
 21825                                        CCHGA
 21826        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21827
 21828*    MOVE PB-C-REFERENCE             TO CREFO.
 21829
 21830*    IF PB-C-MICROFILM-NO IS NUMERIC
 21831*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21832*          MOVE PB-C-MICROFILM-NO
 21833*                                TO CMICRNOO
 21834*          MOVE AL-UNNON         TO CMICRNOA
 21835*       END-IF
 21836*    END-IF
 21837     IF PB-C-NH-INT-ON-REFS NUMERIC
 21838        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21839           MOVE PB-C-NH-INT-ON-REFS
 21840                                 TO CNHINTO
 21841           MOVE AL-SANOF         TO CNHINTA
 21842        END-IF
 21843     END-IF
 21844     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21845     MOVE PB-CERT-SFX                TO CSUFIXO.
 21846     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21847     MOVE SPACE                      TO DC-OPTION-CODE.
 21848     PERFORM 9700-DATE-LINK.
 21849     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21850
 21851     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 406
* EL6311.cbl
 21852        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21853        MOVE SPACE                   TO DC-OPTION-CODE
 21854        PERFORM 9700-DATE-LINK
 21855        IF NO-CONVERSION-ERROR
 21856           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21857
 21858     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21859        NEXT SENTENCE
 21860     ELSE
 21861        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21862
 21863     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21864        NEXT SENTENCE
 21865     ELSE
 21866        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21867
 21868     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21869        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21870        MOVE SPACE                   TO DC-OPTION-CODE
 21871        PERFORM 9700-DATE-LINK
 21872        IF NO-CONVERSION-ERROR
 21873           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21874
 21875     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21876         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21877
 21878     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21879         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21880
 21881     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21882        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21883        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21884                 GIVING CDRFND1O.
 21885
 21886     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21887        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21888        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21889                 GIVING CDRFND2O.
 21890
 21891     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21892       IF PB-RECORD-ON-HOLD
 21893          MOVE 'ON HOLD'             TO CBILIT1O.
 21894
 21895     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21896       IF PB-RECORD-RETURNED
 21897          MOVE 'RETURNED'            TO CBILIT1O.
 21898
 21899     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21900        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21901             MOVE 'OVERRIDE'         TO CBILIT1O.
 21902
 21903     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21904       IF PB-RECORD-ON-HOLD
 21905          MOVE 'ON HOLD'             TO CBILIT2O.
 21906
 21907     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21908       IF PB-RECORD-RETURNED
 21909          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 407
* EL6311.cbl
 21910
 21911     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21912        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21913             MOVE 'OVERRIDE'         TO CBILIT2O.
 21914
 21915     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21916     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21917     IF PB-C-POST-CARD-IND = 'Y'
 21918        MOVE 'Y'                     TO CPCYNO
 21919     ELSE
 21920        MOVE 'N'                     TO CPCYNO
 21921     END-IF
 21922     MOVE PB-FORCE-CODE              TO CFORCEO.
 21923     MOVE PB-RECORD-BILL             TO CBILCDO.
 21924     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21925     MOVE SPACES                     TO CINITSO.
 21926     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21927         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21928     ELSE
 21929         MOVE PB-CI-INITIALS         TO CINITSO
 21930     END-IF.
 21931
 21932     IF PB-CI-CANCEL-FEE NUMERIC
 21933        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21934        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21935     ELSE
 21936        MOVE ZEROES                  TO W-CANCEL-FEE.
 21937
 21938     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21939
 21940     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21941        ADD PB-CI-LF-PREMIUM-AMT
 21942             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21943
 21944     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21945        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21946
 21947     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21948     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21949     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21950     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21951
 21952     IF PB-C-LIVES NUMERIC
 21953        MOVE PB-C-LIVES              TO CLIVESO.
 21954
 21955     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21956        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 21957
 21958     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 21959        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 21960        MOVE SPACE                   TO DC-OPTION-CODE
 21961        PERFORM 9700-DATE-LINK
 21962        IF NO-CONVERSION-ERROR
 21963           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 21964
 21965     IF  PB-C-REFUND-CREATED
 21966         MOVE 'YES'                  TO CRFNDSWO
 21967     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 408
* EL6311.cbl
 21968         IF PB-C-REFUND-REQUESTED
 21969            MOVE 'REQ'               TO CRFNDSWO
 21970         ELSE
 21971            MOVE 'NO'                TO CRFNDSWO.
 21972
 21973     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 21974     MOVE SPACE                      TO DC-OPTION-CODE.
 21975     PERFORM 9700-DATE-LINK.
 21976     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 21977     MOVE PB-INPUT-BY                TO CENTBYO.
 21978
 21979     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21980        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21981        MOVE SPACE                   TO DC-OPTION-CODE
 21982        PERFORM 9700-DATE-LINK
 21983        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21984        MOVE 'INACTIVE'              TO CMOENDTO
 21985     ELSE
 21986        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21987        MOVE SPACE                   TO DC-OPTION-CODE
 21988        PERFORM 9700-DATE-LINK
 21989        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21990        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21991        MOVE SPACE                   TO DC-OPTION-CODE
 21992        PERFORM 9700-DATE-LINK
 21993        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 21994
 21995     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 21996
 21997     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21998     MOVE WS-HR-MINS                 TO CMANTATO.
 21999
 22000     EVALUATE PB-LF-REFUND-TYPE
 22001        WHEN '1'
 22002           MOVE 'RULE78'            TO CLFREFNO
 22003        WHEN '2'
 22004           MOVE 'PRORAT'            TO CLFREFNO
 22005        WHEN '3'
 22006           MOVE 'CALIF'             TO CLFREFNO
 22007        WHEN '4'
 22008           MOVE 'IRREG'             TO CLFREFNO
 22009        WHEN '5'
 22010           MOVE 'NETPAY'            TO CLFREFNO
 22011        WHEN '6'
 22012           MOVE 'ATCP'              TO CLFREFNO
 22013        WHEN '7'
 22014           MOVE 'UTAH'              TO CLFREFNO
 22015        WHEN '8'
 22016           MOVE 'MEAN'              TO CLFREFNO
 22017        WHEN '9'
 22018           MOVE 'SUM '              TO CLFREFNO
 22019        WHEN 'B'
 22020           MOVE 'BALN'              TO CLFREFNO
 22021     END-EVALUATE.
 22022
 22023     EVALUATE TRUE
 22024        WHEN PB-AH-REFUND-TYPE =  '1'
 22025           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 409
* EL6311.cbl
 22026        WHEN PB-AH-REFUND-TYPE =  '2'
 22027           MOVE 'PRORAT'            TO CAHREFNO
 22028        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22029           MOVE 'CALIF'             TO CAHREFNO
 22030        WHEN PB-AH-REFUND-TYPE =  '4'
 22031           MOVE 'IRREG'             TO CAHREFNO
 22032        WHEN PB-AH-REFUND-TYPE =  '5'
 22033           MOVE 'NETPAY'            TO CAHREFNO
 22034        WHEN PB-AH-REFUND-TYPE =  '6'
 22035           MOVE 'ATCP'              TO CAHREFNO
 22036        WHEN PB-AH-REFUND-TYPE =  '7'
 22037           MOVE 'UTAH'              TO CAHREFNO
 22038        WHEN PB-AH-REFUND-TYPE =  '8'
 22039           MOVE 'MEAN'              TO CAHREFNO
 22040        WHEN PB-AH-REFUND-TYPE =  '9'
 22041           MOVE 'SUM '              TO CAHREFNO
 22042        WHEN PB-AH-REFUND-TYPE =  'B'
 22043           MOVE 'BALN'              TO CAHREFNO
 22044     END-EVALUATE.
 22045
 22046     MOVE PB-REIN-CD                 TO CREINCDO.
 22047
 22048     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22049        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22050        MOVE SPACE                   TO DC-OPTION-CODE
 22051        PERFORM 9700-DATE-LINK
 22052        IF NO-CONVERSION-ERROR
 22053           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22054
 22055     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22056        MOVE 999999                  TO WS-EXP-DT-EDIT
 22057        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22058        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22059     ELSE
 22060        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22061           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22062           MOVE SPACE                   TO DC-OPTION-CODE
 22063           PERFORM 9700-DATE-LINK
 22064           IF NO-CONVERSION-ERROR
 22065              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22066
 22067     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22068        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22069           MOVE AL-SANOF                TO CORIGHDA
 22070           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22071           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22072
 22073     MOVE PB-CSR-ID              TO CCSRO.
 22074
 22075     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22076     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22077
 22078     MOVE 'C'                    TO CMAINTI.
 22079     MOVE AL-UANON               TO CMAINTA.
 22080
 22081     IF PI-6316-FINALIZED = 'Y'  AND
 22082        PB-UNFORCED-ERRORS
 22083          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 410
* EL6311.cbl
 22084          MOVE  1                TO SET-CURSOR-SW
 22085     END-IF
 22086
 22087     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22088        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22089
 22090     IF NO-CURSOR-SET
 22091        MOVE -1                  TO CMAINTL.
 22092
 22093     GO TO 8100-SEND-INITIAL-MAP.
 22094
 22095
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 411
* EL6311.cbl
 22097***************************************************************
 22098*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22099*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22100***************************************************************
 22101
 22102 7200-DISPLAY-BATCHES.
 22103     MOVE EL631D                 TO PI-MAP-NAME.
 22104     MOVE LOW-VALUES             TO EL631DI.
 22105
 22106     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22107
 22108
 22109* EXEC CICS HANDLE CONDITION
 22110*         NOTFND   (3690-NOT-FOUND)
 22111*    END-EXEC.
 22112*    MOVE '"$I                   ! Y #00018485' TO DFHEIV0
 22113     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22115     MOVE X'5920233030303138343835' TO DFHEIV0(25:11)
 22116     CALL 'kxdfhei1' USING DFHEIV0
 22117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22118
 22119
 22120     IF PI-DISPLAY-SCREEN
 22121        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22122     ELSE
 22123        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22124
 22125     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22126     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22127
 22128
 22129* EXEC CICS READ
 22130*         DATASET   (FILE-ID-ERPNDB)
 22131*         RIDFLD    (ERPNDB-KEY)
 22132*         SET       (ADDRESS OF PENDING-BUSINESS)
 22133*    END-EXEC.
 22134*    MOVE '&"S        E          (   #00018497' TO DFHEIV0
 22135     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22137     MOVE X'2020233030303138343937' TO DFHEIV0(25:11)
 22138     CALL 'kxdfhei1' USING DFHEIV0,
 22139           FILE-ID-ERPNDB,
 22140           DFHEIV20,
 22141           DFHEIV99,
 22142           ERPNDB-KEY,
 22143           DFHEIV99,
 22144           DFHEIV99,
 22145           DFHEIV99
 22146     SET ADDRESS OF PENDING-BUSINESS TO
 22147         DFHEIV20
 22148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22149
 22150
 22151     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22152     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22153     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22154     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 412
* EL6311.cbl
 22155     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22156
 22157     MOVE EL631D                 TO PI-MAP-NAME.
 22158     MOVE LOW-VALUES             TO EL631DI.
 22159     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22160
 22161*    IF PI-AR-PROCESSING
 22162*       MOVE PB-REFERENCE        TO DREFO.
 22163
 22164     MOVE PB-CSR-ID              TO DCSRO.
 22165
 22166     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22167        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22168        MOVE SPACE               TO DC-OPTION-CODE
 22169        PERFORM 9700-DATE-LINK
 22170        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22171        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22172        MOVE 'INACTIVE'          TO DLDATEO
 22173     ELSE
 22174        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22175        MOVE SPACE               TO DC-OPTION-CODE
 22176        PERFORM 9700-DATE-LINK
 22177        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22178
 22179     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22180     MOVE SPACE                  TO DC-OPTION-CODE.
 22181     PERFORM 9700-DATE-LINK.
 22182     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22183
 22184     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22185        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22186     ELSE
 22187        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22188        MOVE SPACE               TO DC-OPTION-CODE
 22189        PERFORM 9700-DATE-LINK
 22190        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22191
 22192     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22193     MOVE SPACE                  TO DC-OPTION-CODE.
 22194     PERFORM 9700-DATE-LINK.
 22195     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22196
 22197     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22198     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22199
 22200     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22201        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22202                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22203
 22204     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22205     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22206     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22207
 22208     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22209        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22210                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22211
 22212     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 413
* EL6311.cbl
 22213     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22214     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22215
 22216     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22217        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22218                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22219
 22220     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22221     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22222
 22223     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22224        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22225                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22226
 22227     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22228     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22229     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22230
 22231     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22232        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22233                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22234
 22235     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22236     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22237     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22238
 22239     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22240        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22241                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22242
 22243     MOVE -1                     TO DPFENTRL.
 22244     GO TO 8100-SEND-INITIAL-MAP.
 22245
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 414
* EL6311.cbl
 22247
 22248***************************************************************
 22249*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22250*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22251*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22252*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22253*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22254*     ARE THEN SET ACCORDINGLY.                               *
 22255*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22256*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22257*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22258***************************************************************
 22259
 22260******************************************************************
 22261*                                                                *
 22262*            E R R O R   A N A L Y S I S                         *
 22263*                                                                *
 22264******************************************************************
 22265
 22266******************************************************************
 22267*                                                                *
 22268*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22269*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22270*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22271*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22272*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22273*                                                                *
 22274*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22275*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22276*                                                                *
 22277******************************************************************
 22278
 22279 7300-FORMAT-ERRORS.
 22280     MOVE ' '                    TO PI-ERRORS-SW
 22281     IF PB-COMMON-ERRORS = LOW-VALUES
 22282        IF PB-FATAL-ERRORS
 22283           MOVE ER-2695          TO EMI-ERROR
 22284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22285           GO TO 7399-EXIT.
 22286
 22287     MOVE +0                     TO WS-SUB4.
 22288
 22289 7310-ERROR-LOOP.
 22290
 22291     ADD +1                      TO WS-SUB4.
 22292
 22293     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22294        GO TO 7350-SET-ERROR-FLAGS.
 22295
 22296     IF PI-COMPANY-ID = 'UCL'
 22297         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22298             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22299             MOVE ' '                   TO DC-OPTION-CODE
 22300             PERFORM 9700-DATE-LINK
 22301             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22302
 22303     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 415
* EL6311.cbl
 22305     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22306
 22307     GO TO 7310-ERROR-LOOP.
 22308
 22309
 22310 7350-SET-ERROR-FLAGS.
 22311
 22312     IF EMI-FATAL-CTR NOT = ZEROS
 22313        display 'fatal error counter = ' emi-fatal-ctr
 22314        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22315        MOVE 'X'                 TO PB-FATAL-FLAG
 22316                                    PI-ERRORS-SW
 22317        GO TO 7355-SET-ERROR-FLAGS.
 22318
 22319     IF EMI-FORCABLE-CTR NOT = ZEROS
 22320        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22321        IF PB-ISSUE
 22322           IF PB-ISSUE-FORCE
 22323              MOVE 'F'           TO PB-FORCE-ER-CD
 22324              MOVE ER-2600       TO EMI-ERROR
 22325              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22326             ELSE
 22327              MOVE 'X'           TO PB-FORCE-ER-CD
 22328*                                   PI-ERRORS-SW
 22329          ELSE
 22330           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22331              MOVE 'F'           TO PB-FORCE-ER-CD
 22332              MOVE ER-2600       TO EMI-ERROR
 22333              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22334             ELSE
 22335              MOVE 'X'           TO PB-FORCE-ER-CD.
 22336*                                   PI-ERRORS-SW.
 22337
 22338     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22339     IF PB-ISSUE
 22340         MOVE 'I'                TO ENDT-RECORD-TYPE
 22341     ELSE
 22342         MOVE 'C'                TO ENDT-RECORD-TYPE
 22343     END-IF
 22344     MOVE +0                     TO ENDT-SEQ-NO
 22345
 22346
 22347* EXEC CICS READ
 22348*        DATASET   (FILE-ID-ERENDT)
 22349*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22350*        RIDFLD    (ERENDT-KEY)
 22351*        RESP      (WS-RESPONSE)
 22352*        GTEQ
 22353*    END-EXEC
 22354*    MOVE '&"S        G          (  N#00018698' TO DFHEIV0
 22355     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22357     MOVE X'204E233030303138363938' TO DFHEIV0(25:11)
 22358     CALL 'kxdfhei1' USING DFHEIV0,
 22359           FILE-ID-ERENDT,
 22360           DFHEIV20,
 22361           DFHEIV99,
 22362           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 416
* EL6311.cbl
 22363           DFHEIV99,
 22364           DFHEIV99,
 22365           DFHEIV99
 22366     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22367         DFHEIV20
 22368     MOVE EIBRESP  TO WS-RESPONSE
 22369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22370
 22371     IF RESP-NORMAL
 22372        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22373        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22374            MOVE ER-0280          TO EMI-ERROR
 22375            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22376            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22377            EVALUATE TRUE
 22378              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22379                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22380              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22381                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22382              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22383                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22384            END-EVALUATE
 22385        END-IF
 22386     END-IF
 22387
 22388
 22389
 22390     IF FIRST-ENTRY OR
 22391        EIBAID = DFHPF1 OR DFHPF2
 22392        MOVE '0'                TO PI-EDIT-SW
 22393        GO TO 7399-EXIT.
 22394
 22395 7355-SET-ERROR-FLAGS.
 22396
 22397     IF EMI-WARNING-CTR NOT = ZEROS
 22398        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22399        MOVE 'W'                 TO PB-WARN-ER-CD.
 22400
 22401     IF PB-UNFORCED-ERRORS OR
 22402        PB-FATAL-ERRORS    OR
 22403        PB-RECORD-ON-HOLD  OR
 22404        PB-RECORD-RETURNED OR
 22405        PB-CANCELLATION
 22406          NEXT SENTENCE
 22407        ELSE
 22408          GO TO 7399-EXIT.
 22409
 22410
 22411* EXEC CICS  HANDLE CONDITION
 22412*           NOTFND   (7399-EXIT)
 22413*    END-EXEC.
 22414*    MOVE '"$I                   ! Z #00018745' TO DFHEIV0
 22415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22417     MOVE X'5A20233030303138373435' TO DFHEIV0(25:11)
 22418     CALL 'kxdfhei1' USING DFHEIV0
 22419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22420
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 417
* EL6311.cbl
 22421
 22422     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22423     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22424     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22425     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22426
 22427
 22428* EXEC CICS READ
 22429*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22430*        DATASET (FILE-ID-ELCERT)
 22431*        RIDFLD  (ELCERT-KEY)
 22432*        UPDATE
 22433*    END-EXEC.
 22434*    MOVE '&"S        EU         (   #00018754' TO DFHEIV0
 22435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22436     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22437     MOVE X'2020233030303138373534' TO DFHEIV0(25:11)
 22438     CALL 'kxdfhei1' USING DFHEIV0,
 22439           FILE-ID-ELCERT,
 22440           DFHEIV20,
 22441           DFHEIV99,
 22442           ELCERT-KEY,
 22443           DFHEIV99,
 22444           DFHEIV99,
 22445           DFHEIV99
 22446     SET ADDRESS OF CERTIFICATE-MASTER TO
 22447         DFHEIV20
 22448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22449
 22450
 22451
 22452     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22453     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22454
 22455     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22456        GO TO 7360-REWRITE-CERT-MASTER.
 22457
 22458     IF PB-ISSUE
 22459        IF PB-RECORD-RETURNED
 22460            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22461            GO TO 7360-REWRITE-CERT-MASTER
 22462        ELSE
 22463            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22464            GO TO 7360-REWRITE-CERT-MASTER.
 22465
 22466     IF PB-RECORD-RETURNED
 22467         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22468         GO TO 7360-REWRITE-CERT-MASTER.
 22469
 22470     IF PB-C-LF-CANCEL-VOIDED
 22471        IF (PB-UNFORCED-ERRORS OR
 22472            PB-FATAL-ERRORS    OR
 22473            PB-RECORD-ON-HOLD)
 22474            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22475            GO TO 7360-REWRITE-CERT-MASTER
 22476        ELSE
 22477            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22478            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 418
* EL6311.cbl
 22479
 22480     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22481                            OR PB-RECORD-ON-HOLD)
 22482        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22483     ELSE
 22484        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22485
 22486 7360-REWRITE-CERT-MASTER.
 22487
 22488     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22489        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22490
 22491* EXEC CICS UNLOCK
 22492*            DATASET    (FILE-ID-ELCERT)
 22493*       END-EXEC
 22494*    MOVE '&*                    #   #00018800' TO DFHEIV0
 22495     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22496     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22497     MOVE X'2020233030303138383030' TO DFHEIV0(25:11)
 22498     CALL 'kxdfhei1' USING DFHEIV0,
 22499           FILE-ID-ELCERT,
 22500           DFHEIV99
 22501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22502        GO TO 7399-EXIT.
 22503
 22504
 22505* EXEC CICS REWRITE
 22506*         DATASET    (FILE-ID-ELCERT)
 22507*         FROM       (CERTIFICATE-MASTER)
 22508*    END-EXEC.
 22509     MOVE LENGTH OF
 22510      CERTIFICATE-MASTER
 22511       TO DFHEIV11
 22512*    MOVE '&& L                  %   #00018805' TO DFHEIV0
 22513     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22514     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22515     MOVE X'2020233030303138383035' TO DFHEIV0(25:11)
 22516     CALL 'kxdfhei1' USING DFHEIV0,
 22517           FILE-ID-ELCERT,
 22518           CERTIFICATE-MASTER,
 22519           DFHEIV11,
 22520           DFHEIV99
 22521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22522
 22523
 22524 7399-EXIT.
 22525      EXIT.
 22526
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 419
* EL6311.cbl
 22528
 22529*************************************************************
 22530*                                                           *
 22531*              S E T   A T T R I B U T E S                  *
 22532*                                                           *
 22533*************************************************************
 22534
 22535 7400-SET-ATTRIBUTES.
 22536
 22537     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22538        GO TO 7499-EXIT.
 22539
 22540**2601**
 22541
 22542     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22543        IF PB-ISSUE
 22544           MOVE AL-UABON         TO BEFFDTA
 22545           GO TO 7499-EXIT
 22546         ELSE
 22547           MOVE AL-UABON         TO CEFFDTA
 22548           GO TO 7499-EXIT.
 22549
 22550**2604**
 22551
 22552     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22553        IF PB-ISSUE
 22554           MOVE AL-UABON         TO BTYPE1A
 22555           MOVE -1               TO BTYPE1L
 22556           MOVE  1               TO SET-CURSOR-SW
 22557           GO TO 7499-EXIT.
 22558
 22559**2605**
 22560
 22561     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22562        IF PB-ISSUE
 22563           MOVE AL-UABON         TO BTYPE2A
 22564           MOVE -1               TO BTYPE2L
 22565           MOVE  1               TO SET-CURSOR-SW
 22566           GO TO 7499-EXIT.
 22567
 22568**2606**
 22569
 22570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22571        IF PB-ISSUE
 22572           MOVE AL-UABON         TO BSIGA
 22573           MOVE -1               TO BSIGL
 22574           MOVE  1               TO SET-CURSOR-SW
 22575           GO TO 7499-EXIT.
 22576
 22577**2607**
 22578
 22579     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22580        IF PB-ISSUE
 22581           MOVE AL-UABON         TO BSIGA
 22582           MOVE -1               TO BSIGL
 22583           MOVE  1               TO SET-CURSOR-SW
 22584           GO TO 7499-EXIT.
 22585
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 420
* EL6311.cbl
 22586**2615**
 22587
 22588     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22589        IF PB-ISSUE
 22590           MOVE AL-UABOF         TO BREINA
 22591           MOVE -1               TO BREINL
 22592           GO TO 7499-EXIT.
 22593
 22594**2622**
 22595
 22596     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22597        IF PB-ISSUE
 22598           MOVE AL-UABON         TO BEFFDTA
 22599           GO TO 7499-EXIT
 22600        ELSE
 22601           MOVE AL-UABON         TO CEFFDTA
 22602           GO TO 7499-EXIT.
 22603
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 421
* EL6311.cbl
 22605
 22606*************************************************************
 22607*                                                           *
 22608*              I S S U E   E R R O R S                      *
 22609*                                                           *
 22610*************************************************************
 22611
 22612 7420-ISSUE-ERRORS.
 22613
 22614**2626**
 22615
 22616     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22617        MOVE AL-UABON            TO BCERTNOA
 22618        GO TO 7499-EXIT.
 22619
 22620**2627**
 22621
 22622     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22623        MOVE AL-UNBON            TO BAGEA
 22624        MOVE -1                  TO BAGEL
 22625        MOVE  1                  TO SET-CURSOR-SW
 22626        GO TO 7499-EXIT.
 22627
 22628**2628**
 22629
 22630     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22631        MOVE AL-UNBON            TO BAGEA
 22632        MOVE -1                  TO BAGEL
 22633        MOVE  1                  TO SET-CURSOR-SW
 22634        GO TO 7499-EXIT.
 22635
 22636**2629**
 22637
 22638     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22639        MOVE AL-UABON            TO BSEXA
 22640        MOVE -1                  TO BSEXL
 22641        MOVE  1                  TO SET-CURSOR-SW
 22642        GO TO 7499-EXIT.
 22643
 22644**2630**
 22645
 22646     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22647        MOVE -1                  TO BTYPE1L
 22648        MOVE  1                  TO SET-CURSOR-SW
 22649        GO TO 7499-EXIT.
 22650
 22651**2631**
 22652
 22653     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22654        MOVE -1                  TO BTYPE1L
 22655        MOVE  1                  TO SET-CURSOR-SW
 22656        GO TO 7499-EXIT.
 22657
 22658**2632**
 22659
 22660     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22661        MOVE AL-UNBON            TO BBEN1A
 22662        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 422
* EL6311.cbl
 22663        MOVE  1                  TO SET-CURSOR-SW
 22664        GO TO 7499-EXIT.
 22665
 22666**2633**
 22667
 22668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22669        MOVE AL-UNBON            TO BPREM1A
 22670        MOVE -1                  TO BPREM1L
 22671        MOVE  1                  TO SET-CURSOR-SW
 22672        GO TO 7499-EXIT.
 22673
 22674**2634**
 22675
 22676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22677        MOVE -1                  TO BTYPE2L
 22678        MOVE  1                  TO SET-CURSOR-SW
 22679        GO TO 7499-EXIT.
 22680
 22681**2635**
 22682
 22683     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22684        MOVE AL-UNBON            TO BBEN2A
 22685        MOVE -1                  TO BBEN2L
 22686        MOVE  1                  TO SET-CURSOR-SW
 22687        GO TO 7499-EXIT.
 22688
 22689**2636**
 22690
 22691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22692        MOVE AL-UNBON            TO BPREM2A
 22693        MOVE -1                  TO BPREM2L
 22694        MOVE  1                  TO SET-CURSOR-SW
 22695        GO TO 7499-EXIT.
 22696
 22697**2639**
 22698
 22699     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22700        MOVE AL-UNBON            TO BBEN1A
 22701        MOVE -1                  TO BBEN1L
 22702        MOVE  1                  TO SET-CURSOR-SW
 22703        GO TO 7499-EXIT.
 22704
 22705**2640**
 22706
 22707     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22708        MOVE AL-UNBON            TO BBEN2A
 22709        MOVE -1                  TO BBEN2L
 22710        MOVE  1                  TO SET-CURSOR-SW
 22711        GO TO 7499-EXIT.
 22712
 22713**2647**
 22714
 22715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22716        MOVE AL-UNBON            TO BTERM1A
 22717        MOVE -1                  TO BTERM1L
 22718        MOVE  1                  TO SET-CURSOR-SW
 22719        GO TO 7499-EXIT.
 22720
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 423
* EL6311.cbl
 22721**2648**
 22722
 22723     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22724        MOVE AL-UNBON            TO BLNTRMA
 22725        MOVE -1                  TO BLNTRML
 22726        MOVE  1                  TO SET-CURSOR-SW
 22727        GO TO 7499-EXIT.
 22728
 22729**2649**
 22730
 22731     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22732        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22733            MOVE AL-UNBON            TO BPREM1A
 22734            MOVE -1                  TO BPREM1L
 22735            MOVE  1                  TO SET-CURSOR-SW
 22736            GO TO 7499-EXIT
 22737     ELSE
 22738        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22739           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22740            MOVE AL-UNBON            TO BPREM2A
 22741            MOVE -1                  TO BPREM2L
 22742            MOVE  1                  TO SET-CURSOR-SW
 22743            GO TO 7499-EXIT.
 22744
 22745**2650**
 22746
 22747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22748        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22749            MOVE AL-UNBON        TO BPREM1A
 22750            MOVE -1              TO BPREM1L
 22751            MOVE  1              TO SET-CURSOR-SW
 22752            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22753                MOVE AL-UNBON        TO BPREM2A
 22754                MOVE -1              TO BPREM2L
 22755                MOVE  1              TO SET-CURSOR-SW
 22756                GO TO 7499-EXIT
 22757            ELSE
 22758                GO TO 7499-EXIT
 22759        ELSE
 22760            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22761                MOVE AL-UNBON        TO BPREM2A
 22762                MOVE -1              TO BPREM2L
 22763                MOVE  1              TO SET-CURSOR-SW
 22764                GO TO 7499-EXIT
 22765            ELSE
 22766                GO TO 7499-EXIT.
 22767
 22768**2651**
 22769
 22770     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22771        MOVE AL-UABON            TO BSIGA
 22772        MOVE -1                  TO BSIGL
 22773        MOVE  1                  TO SET-CURSOR-SW
 22774        GO TO 7499-EXIT.
 22775
 22776**2653**
 22777
 22778     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 424
* EL6311.cbl
 22779        MOVE AL-UABON            TO BFREQA
 22780        MOVE -1                  TO BFREQL
 22781        MOVE  1                  TO SET-CURSOR-SW
 22782        GO TO 7499-EXIT.
 22783
 22784**2654**
 22785
 22786     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22787        MOVE AL-UABON            TO BFREQA
 22788        MOVE -1                  TO BFREQL
 22789        MOVE  1                  TO SET-CURSOR-SW
 22790        GO TO 7499-EXIT.
 22791
 22792**2655**
 22793
 22794     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22795        MOVE AL-UABON            TO BFREQA
 22796        MOVE -1                  TO BFREQL
 22797        MOVE  1                  TO SET-CURSOR-SW
 22798        GO TO 7499-EXIT.
 22799
 22800**2656**
 22801
 22802     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22803        MOVE AL-UNBON            TO BAPRA
 22804        MOVE -1                  TO BAPRL
 22805        MOVE  1                  TO SET-CURSOR-SW
 22806        GO TO 7499-EXIT.
 22807
 22808**2657**
 22809
 22810     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22811        MOVE AL-UNBON            TO BAPRA
 22812        MOVE -1                  TO BAPRL
 22813        MOVE  1                  TO SET-CURSOR-SW
 22814        GO TO 7499-EXIT.
 22815
 22816**2658**
 22817
 22818     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22819        MOVE AL-UNBON            TO BTERM2A
 22820        MOVE -1                  TO BTERM2L
 22821        MOVE  1                  TO SET-CURSOR-SW
 22822        GO TO 7499-EXIT.
 22823
 22824**2660**
 22825
 22826     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22827        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22828        MOVE -1                  TO BLSTNML
 22829        MOVE  1                  TO SET-CURSOR-SW
 22830        GO TO 7499-EXIT.
 22831
 22832
 22833**2662**
 22834
 22835     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22836        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 425
* EL6311.cbl
 22837        MOVE -1                  TO BAGEL
 22838        MOVE  1                  TO SET-CURSOR-SW
 22839        GO TO 7499-EXIT.
 22840
 22841**2663**
 22842
 22843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22844        MOVE AL-UNBON            TO BAGEA
 22845        MOVE -1                  TO BAGEL
 22846        MOVE  1                  TO SET-CURSOR-SW
 22847        GO TO 7499-EXIT.
 22848
 22849**2664**
 22850
 22851     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22852        MOVE AL-UABON            TO BREINA
 22853        MOVE -1                  TO BREINL
 22854        MOVE  1                  TO SET-CURSOR-SW
 22855        GO TO 7499-EXIT.
 22856
 22857**2667**
 22858
 22859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22860        MOVE AL-UNBON            TO BBEN2A
 22861        MOVE -1                  TO BBEN2L
 22862        MOVE  1                  TO SET-CURSOR-SW
 22863        GO TO 7499-EXIT.
 22864
 22865**2668**
 22866
 22867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22868        MOVE AL-UABON            TO BEFFDTA
 22869        GO TO 7499-EXIT.
 22870
 22871**2669**
 22872
 22873     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22874        MOVE AL-UNBON            TO BAGEA
 22875        MOVE -1                  TO BAGEL
 22876        MOVE  1                  TO SET-CURSOR-SW
 22877        GO TO 7499-EXIT.
 22878
 22879**2670**
 22880
 22881     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22882        MOVE AL-UABON            TO BFORCEA
 22883        MOVE -1                  TO BFORCEL
 22884        MOVE  1                  TO SET-CURSOR-SW
 22885        GO TO 7499-EXIT.
 22886
 22887**2671**
 22888
 22889     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22890        MOVE AL-UABON            TO BEFFDTA
 22891        GO TO 7499-EXIT.
 22892
 22893**2672**
 22894
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 426
* EL6311.cbl
 22895     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22896        MOVE AL-UABON            TO BEFFDTA
 22897        GO TO 7499-EXIT.
 22898
 22899**2673**
 22900
 22901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22902        MOVE AL-UABON            TO BEFFDTA
 22903        GO TO 7499-EXIT.
 22904
 22905**2674**
 22906
 22907     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22908        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22909        MOVE -1                  TO BTYPE1L
 22910        MOVE  1                  TO SET-CURSOR-SW
 22911        GO TO 7499-EXIT.
 22912
 22913**2677**
 22914
 22915     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22916        MOVE AL-UNBON            TO BTERM1A
 22917        MOVE -1                  TO BTERM1L
 22918        MOVE  1                  TO SET-CURSOR-SW
 22919        GO TO 7499-EXIT.
 22920
 22921**2678**
 22922
 22923     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22924        MOVE AL-UNBON            TO BTERM2A
 22925        MOVE -1                  TO BTERM2L
 22926        MOVE  1                  TO SET-CURSOR-SW
 22927        GO TO 7499-EXIT.
 22928
 22929**2679**
 22930
 22931     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22932        MOVE AL-UABON            TO BTYPE1A
 22933        MOVE -1                  TO BTYPE1L
 22934        MOVE  1                  TO SET-CURSOR-SW
 22935        GO TO 7499-EXIT.
 22936
 22937**2680**
 22938
 22939     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22940        MOVE AL-UABOF            TO B1STPMTA
 22941        MOVE -1                  TO B1STPMTL
 22942        MOVE  1                  TO SET-CURSOR-SW
 22943        GO TO 7499-EXIT.
 22944
 22945**2681**
 22946
 22947     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22948        MOVE AL-UABON            TO BDAYSA
 22949        MOVE -1                  TO BDAYSL
 22950        MOVE  1                  TO SET-CURSOR-SW
 22951        GO TO 7499-EXIT.
 22952
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 427
* EL6311.cbl
 22953**2682**
 22954
 22955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 22956        MOVE AL-UABON            TO BTERM1A
 22957        MOVE -1                  TO BTERM1L
 22958        MOVE  1                  TO SET-CURSOR-SW
 22959        GO TO 7499-EXIT.
 22960
 22961**2683**
 22962
 22963     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 22964        MOVE AL-UABON            TO BSKPCDA
 22965        MOVE -1                  TO BSKPCDL
 22966        MOVE  1                  TO SET-CURSOR-SW
 22967        GO TO 7499-EXIT.
 22968
 22969**2684**
 22970
 22971     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 22972        MOVE AL-UABON            TO BTYPE2A
 22973        MOVE -1                  TO BTYPE2L
 22974        MOVE  1                  TO SET-CURSOR-SW
 22975        GO TO 7499-EXIT.
 22976
 22977**2686**
 22978
 22979     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 22980        MOVE AL-UABON            TO BTYPE2A
 22981        MOVE -1                  TO BTYPE2L
 22982        MOVE  1                  TO SET-CURSOR-SW
 22983        GO TO 7499-EXIT.
 22984
 22985**2689**
 22986
 22987     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 22988        MOVE AL-UABON            TO BSIGA
 22989        MOVE -1                  TO BSIGL
 22990        MOVE  1                  TO SET-CURSOR-SW
 22991        GO TO 7499-EXIT.
 22992
 22993**2690**
 22994
 22995     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 22996        MOVE AL-UABOF            TO BLNOFCRA
 22997        MOVE -1                  TO BLNOFCRL
 22998        MOVE  1                  TO SET-CURSOR-SW
 22999        GO TO 7499-EXIT.
 23000
 23001**2693**
 23002
 23003     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23004        MOVE AL-UABOF            TO BLNOFCRA
 23005        MOVE AL-UNBON            TO BBEN1A
 23006        MOVE -1                  TO BBEN1L
 23007        MOVE  1                  TO SET-CURSOR-SW
 23008        GO TO 7499-EXIT.
 23009
 23010**2720**
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 428
* EL6311.cbl
 23011
 23012     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23013        MOVE AL-UNBON            TO BBEN1A
 23014        MOVE -1                  TO BBEN1L
 23015        MOVE  1                  TO SET-CURSOR-SW
 23016        GO TO 7499-EXIT.
 23017
 23018**2709**
 23019
 23020*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23021*       MOVE AL-UNBON            TO BBEN1A
 23022*       MOVE -1                  TO BBEN1L
 23023*       MOVE  1                  TO SET-CURSOR-SW
 23024*       GO TO 7499-EXIT.
 23025
 23026*************************************************************
 23027*                                                           *
 23028*            C A N C E L   E R R O R S                      *
 23029*                                                           *
 23030*************************************************************
 23031
 23032**2726**
 23033
 23034     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23035        MOVE AL-UABON            TO CCERTNOA
 23036        GO TO 7499-EXIT.
 23037
 23038**2728**
 23039
 23040     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23041        MOVE AL-UABON            TO CCERTNOA
 23042        GO TO 7499-EXIT.
 23043
 23044**2729**
 23045
 23046     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23047        MOVE AL-UABON            TO CCERTNOA
 23048        GO TO 7499-EXIT.
 23049
 23050**2730**
 23051
 23052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23053        MOVE AL-UABON            TO CCERTNOA
 23054        GO TO 7499-EXIT.
 23055
 23056**2731**
 23057
 23058     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23059        MOVE AL-UABON            TO CCANDT1A
 23060        MOVE -1                  TO CCANDT1L
 23061        MOVE  1                  TO SET-CURSOR-SW
 23062        GO TO 7499-EXIT.
 23063
 23064**2732**
 23065
 23066     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 23067        MOVE AL-UABON            TO CCANDT1A
 23068        MOVE -1                  TO CCANDT1L
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 429
* EL6311.cbl
 23069        MOVE  1                  TO SET-CURSOR-SW
 23070        GO TO 7499-EXIT.
 23071
 23072**2733**
 23073
 23074     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23075        MOVE AL-UABON            TO CCANDT1A
 23076        MOVE -1                  TO CCANDT1L
 23077        MOVE  1                  TO SET-CURSOR-SW
 23078        GO TO 7499-EXIT.
 23079
 23080**2734**
 23081
 23082     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23083        MOVE AL-UNBON            TO CREFND1A
 23084        MOVE -1                  TO CREFND1L
 23085        MOVE  1                  TO SET-CURSOR-SW
 23086        GO TO 7499-EXIT.
 23087
 23088**2735**
 23089
 23090     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23091        MOVE AL-UABON            TO CCANDT2A
 23092        MOVE -1                  TO CCANDT2L
 23093        MOVE  1                  TO SET-CURSOR-SW
 23094        GO TO 7499-EXIT.
 23095
 23096**2736**
 23097
 23098     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23099        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23100            MOVE AL-UNBON        TO CREFND1A
 23101            MOVE -1              TO CREFND1L
 23102            MOVE  1              TO SET-CURSOR-SW
 23103            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23104                MOVE AL-UNBON        TO CREFND2A
 23105                MOVE -1              TO CREFND2L
 23106                MOVE  1              TO SET-CURSOR-SW
 23107                GO TO 7499-EXIT
 23108            ELSE
 23109                GO TO 7499-EXIT
 23110        ELSE
 23111            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23112                MOVE AL-UNBON        TO CREFND2A
 23113                MOVE -1              TO CREFND2L
 23114                MOVE  1              TO SET-CURSOR-SW
 23115                GO TO 7499-EXIT
 23116            ELSE
 23117                GO TO 7499-EXIT.
 23118
 23119**2738**
 23120
 23121     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23122        MOVE -1                  TO CREFND2L
 23123        MOVE  1                  TO SET-CURSOR-SW
 23124        GO TO 7499-EXIT.
 23125
 23126**2739**
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 430
* EL6311.cbl
 23127
 23128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23129        MOVE -1                  TO CREFND1L
 23130        MOVE  1                  TO SET-CURSOR-SW
 23131        GO TO 7499-EXIT.
 23132
 23133**2741**
 23134
 23135     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23136        MOVE -1                  TO CREFND1L
 23137        MOVE  1                  TO SET-CURSOR-SW
 23138        GO TO 7499-EXIT.
 23139
 23140**2743**
 23141
 23142     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23143        MOVE AL-UNBON            TO CCANDT1A
 23144        MOVE -1                  TO CCANDT1L
 23145        MOVE  1                  TO SET-CURSOR-SW
 23146        GO TO 7499-EXIT.
 23147
 23148**2744**
 23149
 23150     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23151        MOVE AL-UNBON            TO CCANDT2A
 23152        MOVE -1                  TO CCANDT2L
 23153        MOVE  1                  TO SET-CURSOR-SW
 23154        GO TO 7499-EXIT.
 23155
 23156**2747**
 23157
 23158     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23159        MOVE AL-UABON            TO CLSTNMA
 23160        MOVE -1                  TO CLSTNML
 23161        MOVE  1                  TO SET-CURSOR-SW
 23162        GO TO 7499-EXIT.
 23163
 23164**2749**
 23165
 23166     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23167        MOVE AL-UABON            TO CFORCEA
 23168        MOVE -1                  TO CFORCEL
 23169        MOVE  1                  TO SET-CURSOR-SW
 23170        GO TO 7499-EXIT.
 23171
 23172**2753**
 23173
 23174     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23175        MOVE AL-UNBON            TO CCANDT1A
 23176        MOVE -1                  TO CCANDT1L
 23177        MOVE  1                  TO SET-CURSOR-SW
 23178        GO TO 7499-EXIT.
 23179
 23180**2755**
 23181
 23182     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 23183        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23184            MOVE AL-UNBON        TO CREFND1A
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 431
* EL6311.cbl
 23185            MOVE -1              TO CREFND1L
 23186            MOVE  1              TO SET-CURSOR-SW
 23187            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23188                MOVE AL-UNBON        TO CREFND2A
 23189                MOVE -1              TO CREFND2L
 23190                MOVE  1              TO SET-CURSOR-SW
 23191                GO TO 7499-EXIT
 23192            ELSE
 23193                GO TO 7499-EXIT
 23194        ELSE
 23195            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23196                MOVE AL-UNBON        TO CREFND2A
 23197                MOVE -1              TO CREFND2L
 23198                MOVE  1              TO SET-CURSOR-SW
 23199            ELSE
 23200                GO TO 7499-EXIT.
 23201
 23202**2757**
 23203
 23204     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23205        MOVE AL-UNBON            TO CLIVESA
 23206        MOVE -1                  TO CLIVESL
 23207        MOVE  1                  TO SET-CURSOR-SW
 23208        GO TO 7499-EXIT.
 23209
 23210**2771**
 23211
 23212     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23213        MOVE AL-UABON            TO CCANDT2A
 23214        MOVE -1                  TO CCANDT2L
 23215        MOVE  1                  TO SET-CURSOR-SW
 23216        GO TO 7499-EXIT.
 23217
 23218**2774**
 23219
 23220     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23221        MOVE AL-UABON            TO CCANDT1A
 23222        MOVE -1                  TO CCANDT1L
 23223        MOVE  1                  TO SET-CURSOR-SW
 23224        GO TO 7499-EXIT.
 23225
 23226**2775**
 23227
 23228     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23229        MOVE AL-UABON            TO CCANDT2A
 23230        MOVE -1                  TO CCANDT2L
 23231        MOVE  1                  TO SET-CURSOR-SW
 23232        GO TO 7499-EXIT.
 23233
 23234**2776**
 23235
 23236     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23237        MOVE AL-UABON            TO CCANDT1A
 23238        MOVE -1                  TO CCANDT1L
 23239        MOVE  1                  TO SET-CURSOR-SW
 23240        GO TO 7499-EXIT.
 23241
 23242
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 432
* EL6311.cbl
 23243**2777**
 23244
 23245     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23246        MOVE AL-UABON            TO CCANDT2A
 23247        MOVE -1                  TO CCANDT2L
 23248        MOVE  1                  TO SET-CURSOR-SW
 23249        GO TO 7499-EXIT.
 23250
 23251**2794**
 23252
 23253     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23254        MOVE AL-UABON            TO CFORCEA
 23255        MOVE -1                  TO CFORCEL
 23256        MOVE  1                  TO SET-CURSOR-SW
 23257        GO TO 7499-EXIT.
 23258
 23259**2799**
 23260
 23261     IF PI-COMPANY-ID = 'UCL'
 23262         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23263             MOVE AL-UNBON            TO BEFFDTA
 23264             MOVE -1                  TO BEFFDTL
 23265             MOVE  1                  TO SET-CURSOR-SW
 23266             GO TO 7499-EXIT.
 23267
 23268 7499-EXIT.
 23269      EXIT.
 23270
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 433
* EL6311.cbl
 23272
 23273 7500-READ-ERLOFC.
 23274     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23275                                     ERLOFC-KEY.
 23276
 23277     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23278
 23279     IF ST-ACCNT-CNTL
 23280         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23281
 23282     IF CARR-GROUP-ST-ACCNT-CNTL
 23283         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23284         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23285         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23286
 23287     IF CARR-ST-ACCNT-CNTL
 23288         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23289         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23290
 23291     IF CARR-ACCNT-CNTL
 23292         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23293
 23294     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23295
 23296     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23297
 23298
 23299* EXEC CICS HANDLE CONDITION
 23300*        NOTFND   (7550-OFFICER-NOTFND)
 23301*    END-EXEC.
 23302*    MOVE '"$I                   ! [ #00019584' TO DFHEIV0
 23303     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23305     MOVE X'5B20233030303139353834' TO DFHEIV0(25:11)
 23306     CALL 'kxdfhei1' USING DFHEIV0
 23307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23308
 23309
 23310
 23311* EXEC CICS READ
 23312*        DATASET   (FILE-ID-ERLOFC)
 23313*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23314*        RIDFLD    (ERLOFC-KEY)
 23315*        EQUAL
 23316*    END-EXEC.
 23317*    MOVE '&"S        E          (   #00019588' TO DFHEIV0
 23318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23320     MOVE X'2020233030303139353838' TO DFHEIV0(25:11)
 23321     CALL 'kxdfhei1' USING DFHEIV0,
 23322           FILE-ID-ERLOFC,
 23323           DFHEIV20,
 23324           DFHEIV99,
 23325           ERLOFC-KEY,
 23326           DFHEIV99,
 23327           DFHEIV99,
 23328           DFHEIV99
 23329     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 434
* EL6311.cbl
 23330         DFHEIV20
 23331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23332
 23333
 23334     GO TO 7599-EXIT.
 23335
 23336 7550-OFFICER-NOTFND.
 23337     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23338
 23339 7599-EXIT.
 23340      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 435
* EL6311.cbl
 23342******************************************************************
 23343*                                                                *
 23344*            S  E N D    I N I T I A L   M A P                   *
 23345*                                                                *
 23346******************************************************************
 23347
 23348 8100-SEND-INITIAL-MAP.
 23349     MOVE EIBTIME                TO TIME-IN.
 23350
 23351     IF EIBAID = DFHPF11
 23352        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23354
 23355
 23356     IF PI-COMPANY-ID = CLIENT-GIC
 23357        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23358                                       BCPREM-ATTRB (2).
 23359
 23360     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23361                         CLIENT-PEM OR
 23362                         CLIENT-CSO)
 23363        AND PI-DISPLAY-ORIGINAL-BATCH
 23364          IF PI-MAP-NAME = EL631B
 23365             MOVE AL-SADOF               TO BPF5HDRA
 23366                                            BPF4HDRA
 23367          ELSE
 23368             IF PI-MAP-NAME = EL631C
 23369                MOVE AL-SADOF            TO CPF5HDRA
 23370                                            CPF4HDRA.
 23371
 23372     IF PI-MAP-NAME = EL631B
 23373        MOVE AL-SADOF               TO BPF5HDRA
 23374     ELSE
 23375        MOVE AL-SADOF               TO CPF5HDRA
 23376     END-IF
 23377
 23378*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23379     IF PI-MAP-NAME = EL631B
 23380          IF PI-COMPANY-ID NOT = 'DMD'
 23381             MOVE AL-SANOF            TO BBILLEDA
 23382             MOVE AL-SADOF            TO DMDBILA.
 23383*DMD CUSTOM CODING*************END
 23384
 23385     IF PI-PROCESSOR-ID = 'LGXX'
 23386        IF PI-MAP-NAME = EL631B
 23387           MOVE AL-SABOF                    TO BREFHDGA
 23388           MOVE AL-SANOF                    TO BREFA
 23389        ELSE
 23390           IF PI-MAP-NAME = EL631C
 23391              MOVE AL-SABOF                 TO CREFHDGA
 23392              MOVE AL-SANOF                 TO CREFA.
 23393
 23394*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23395     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23396        NEXT SENTENCE
 23397     ELSE
 23398        IF PI-MAP-NAME = EL631C
 23399           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 436
* EL6311.cbl
 23400                                       CCANFEEA.
 23401
 23402     IF PI-MAP-NAME = EL631D
 23403        IF PI-AR-PROCESSING
 23404           MOVE AL-SANOF            TO DREFHDGA
 23405        ELSE
 23406           MOVE AL-SADOF            TO DREFHDGA.
 23407
 23408     IF (PI-COMPANY-ID NOT = 'DCC')
 23409        AND (PI-MAP-NAME = EL631B)
 23410        MOVE AL-SADOF            TO BVINHA
 23411                                    BVINA
 23412     END-IF
 23413     IF PI-MAP-NAME = EL631B
 23414        IF CSR-EDIT-SESSION
 23415           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23416                                 TO BHEADO
 23417           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23418        ELSE
 23419           MOVE AL-SADOF         TO BF15HDRA
 23420           MOVE '4=B-HDR      '  TO BPF4HDRO
 23421        END-IF
 23422        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23423        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23424        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23425        MOVE WS-CURRENT-DT          TO BDATEO
 23426        MOVE TIME-OUT               TO BTIMEO
 23427        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23428        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23429        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23430        IF   WS-DISPLAY-SCREEN
 23431             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23432             MOVE PB-SV-CARRIER     TO BCARRO
 23433             MOVE PB-SV-GROUPING    TO BGROUPO
 23434             MOVE PB-SV-STATE       TO BSTATEO
 23435             MOVE PB-ACCOUNT        TO BACCTO
 23436        ELSE
 23437             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23438     ELSE
 23439        IF PI-MAP-NAME = EL631C
 23440           MOVE '4=B-HDR      '     TO CPF4HDRO
 23441           IF CSR-EDIT-SESSION
 23442              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23443                                 TO CHEADO
 23444           ELSE
 23445              MOVE AL-SADOF      TO CF15HDRA
 23446           END-IF
 23447           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23448           MOVE WS-CURRENT-DT          TO CDATEO
 23449           MOVE TIME-OUT               TO CTIMEO
 23450           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23451           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23452           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23453           MOVE WS-C-HDG               TO CLFHDGO
 23454           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23455           MOVE WS-C-HDG               TO CAHHDGO
 23456           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23457           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 437
* EL6311.cbl
 23458           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23459           IF   WS-DISPLAY-SCREEN
 23460                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23461                MOVE PB-SV-CARRIER     TO CCARRO
 23462                MOVE PB-SV-GROUPING    TO CGROUPO
 23463                MOVE PB-SV-STATE       TO CSTATEO
 23464                MOVE PB-ACCOUNT        TO CACCTO
 23465           ELSE
 23466                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23467        ELSE
 23468           MOVE WS-CURRENT-DT          TO DDATEO
 23469           MOVE TIME-OUT               TO DTIMEO
 23470           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23471                                          WS-REFUND-HDG-OVERRIDE
 23472           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23473           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23474           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23475                                          WS-REFUND-HDG-OVERRIDE
 23476           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23477           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23478           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23479           IF CSR-EDIT-SESSION
 23480              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23481                                 TO DHEADO
 23482           END-IF
 23483           IF  WS-DISPLAY-SCREEN
 23484               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23485               MOVE PB-CARRIER         TO DCARRO
 23486               MOVE PB-GROUPING        TO DGROUPO
 23487               MOVE PB-STATE           TO DSTATEO
 23488               MOVE PB-ACCOUNT         TO DACCTO
 23489               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23490           ELSE
 23491               MOVE EL631D             TO PI-MAP-NAME
 23492               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23493               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23494
 23495     MOVE SPACE                        TO WS-DISPLAY-SW.
 23496
 23497
 23498* EXEC CICS SEND
 23499*        MAP      (PI-MAP-NAME)
 23500*        MAPSET   (MAPSET-EL6311S)
 23501*        FROM     (EL631BI)
 23502*        ERASE
 23503*        CURSOR
 23504*    END-EXEC.
 23505     MOVE LENGTH OF
 23506      EL631BI
 23507       TO DFHEIV12
 23508     MOVE -1
 23509       TO DFHEIV11
 23510*    MOVE '8$     CT  E    H L F ,   #00019758' TO DFHEIV0
 23511     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23512     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23513     MOVE X'2020233030303139373538' TO DFHEIV0(25:11)
 23514     CALL 'kxdfhei1' USING DFHEIV0,
 23515           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 438
* EL6311.cbl
 23516           EL631BI,
 23517           DFHEIV12,
 23518           MAPSET-EL6311S,
 23519           DFHEIV99,
 23520           DFHEIV99,
 23521           DFHEIV99,
 23522           DFHEIV11,
 23523           DFHEIV99,
 23524           DFHEIV99,
 23525           DFHEIV99
 23526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23527
 23528
 23529     GO TO 9100-RETURN-TRAN.
 23530
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 439
* EL6311.cbl
 23532
 23533******************************************************************
 23534*                                                                *
 23535*              S E N D    D A T A O N L Y                        *
 23536*                                                                *
 23537******************************************************************
 23538
 23539 8200-SEND-DATAONLY.
 23540     MOVE EIBTIME                TO TIME-IN.
 23541
 23542     IF PI-COMPANY-ID = CLIENT-GIC
 23543        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23544                                       BCPREM-ATTRB (2).
 23545
 23546     IF PI-MAP-NAME = EL631B
 23547        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23548        MOVE WS-CURRENT-DT          TO BDATEO
 23549        MOVE TIME-OUT               TO BTIMEO
 23550        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23551        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23552        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23553        MOVE SPACES                 TO BPFENTRO
 23554        MOVE AL-UANOF               TO BPFENTRA
 23555
 23556*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23557        IF PI-COMPANY-ID NOT = 'DMD'
 23558             MOVE AL-SANOF            TO BBILLEDA
 23559             MOVE AL-SADOF            TO DMDBILA
 23560         ELSE
 23561            NEXT SENTENCE
 23562*DMD CUSTOM CODING*************END
 23563     ELSE
 23564        IF PI-MAP-NAME = EL631C
 23565           MOVE WS-CURRENT-DT          TO CDATEO
 23566           MOVE TIME-OUT               TO CTIMEO
 23567           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23568           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23569           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23570           MOVE SPACES                 TO CPFENTRO
 23571           MOVE AL-UANOF               TO CPFENTRA
 23572        ELSE
 23573           MOVE WS-CURRENT-DT          TO DDATEO
 23574           MOVE TIME-OUT               TO DTIMEO
 23575           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23576
 23577
 23578* EXEC CICS SEND
 23579*        MAP      (PI-MAP-NAME)
 23580*        MAPSET   (MAPSET-EL6311S)
 23581*        FROM     (EL631BI)
 23582*        DATAONLY
 23583*        CURSOR
 23584*    END-EXEC.
 23585     MOVE LENGTH OF
 23586      EL631BI
 23587       TO DFHEIV12
 23588     MOVE -1
 23589       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 440
* EL6311.cbl
 23590*    MOVE '8$D    CT       H L F ,   #00019814' TO DFHEIV0
 23591     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23592     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23593     MOVE X'2020233030303139383134' TO DFHEIV0(25:11)
 23594     CALL 'kxdfhei1' USING DFHEIV0,
 23595           PI-MAP-NAME,
 23596           EL631BI,
 23597           DFHEIV12,
 23598           MAPSET-EL6311S,
 23599           DFHEIV99,
 23600           DFHEIV99,
 23601           DFHEIV99,
 23602           DFHEIV11,
 23603           DFHEIV99,
 23604           DFHEIV99,
 23605           DFHEIV99
 23606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23607
 23608
 23609     GO TO 9100-RETURN-TRAN.
 23610
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 441
* EL6311.cbl
 23612
 23613******************************************************************
 23614*                                                                *
 23615*           U T I L I T Y   R O U T I N E S                      *
 23616*                                                                *
 23617******************************************************************
 23618
 23619 8300-SEND-TEXT.
 23620
 23621* EXEC CICS SEND TEXT
 23622*        FROM     (LOGOFF-TEXT)
 23623*        LENGTH   (LOGOFF-LENGTH)
 23624*        ERASE
 23625*        FREEKB
 23626*    END-EXEC.
 23627*    MOVE '8&      T  E F  H   F -   #00019833' TO DFHEIV0
 23628     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23629     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23630     MOVE X'2020233030303139383333' TO DFHEIV0(25:11)
 23631     CALL 'kxdfhei1' USING DFHEIV0,
 23632           LOGOFF-TEXT,
 23633           LOGOFF-LENGTH,
 23634           DFHEIV99,
 23635           DFHEIV99,
 23636           DFHEIV99,
 23637           DFHEIV99,
 23638           DFHEIV99,
 23639           DFHEIV99,
 23640           DFHEIV99,
 23641           DFHEIV99,
 23642           DFHEIV99,
 23643           DFHEIV99
 23644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23645
 23646
 23647
 23648* EXEC CICS RETURN
 23649*    END-EXEC.
 23650*    MOVE '.(                    ''   #00019840' TO DFHEIV0
 23651     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23652     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23653     MOVE X'2020233030303139383430' TO DFHEIV0(25:11)
 23654     CALL 'kxdfhei1' USING DFHEIV0,
 23655           DFHEIV99,
 23656           DFHEIV99,
 23657           DFHEIV99,
 23658           DFHEIV99,
 23659           DFHEIV99,
 23660           DFHEIV99
 23661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23662
 23663
 23664 8400-LOG-JOURNAL-RECORD.
 23665     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23666     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23667
 23668*    EXEC CICS JOURNAL
 23669*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 442
* EL6311.cbl
 23670*        JTYPEID     ('EL')
 23671*        FROM        (JOURNAL-RECORD)
 23672*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23673*    END-EXEC.
 23674
 23675 8600-DEEDIT.
 23676
 23677* EXEC CICS BIF DEEDIT
 23678*         FIELD   (DEEDIT-FIELD)
 23679*         LENGTH  (15)
 23680*    END-EXEC.
 23681     MOVE 15
 23682       TO DFHEIV11
 23683*    MOVE '@"L                   #   #00019855' TO DFHEIV0
 23684     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23685     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23686     MOVE X'2020233030303139383535' TO DFHEIV0(25:11)
 23687     CALL 'kxdfhei1' USING DFHEIV0,
 23688           DEEDIT-FIELD,
 23689           DFHEIV11
 23690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23691
 23692
 23693 8800-UNAUTHORIZED-ACCESS.
 23694     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23695     GO TO 8300-SEND-TEXT.
 23696
 23697 8810-PF23.
 23698     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23699     MOVE XCTL-EL005             TO PGM-NAME.
 23700     GO TO 9300-XCTL.
 23701
 23702 9100-RETURN-TRAN.
 23703     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23704
 23705     IF  PI-MAP-NAME =  EL631B
 23706         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23707
 23708     IF  PI-MAP-NAME =  EL631C
 23709         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23710
 23711     IF  PI-MAP-NAME =  EL631D
 23712         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23713
 23714
 23715* EXEC CICS RETURN
 23716*        TRANSID    (TRANS-EXB1)
 23717*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23718*        LENGTH     (1300)
 23719*    END-EXEC.
 23720     MOVE 1300
 23721       TO DFHEIV11
 23722*    MOVE '.(CT                  ''   #00019881' TO DFHEIV0
 23723     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23725     MOVE X'2020233030303139383831' TO DFHEIV0(25:11)
 23726     CALL 'kxdfhei1' USING DFHEIV0,
 23727           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 443
* EL6311.cbl
 23728           PROGRAM-INTERFACE-BLOCK,
 23729           DFHEIV11,
 23730           DFHEIV99,
 23731           DFHEIV99,
 23732           DFHEIV99
 23733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23734
 23735
 23736 9200-RETURN-MAIN-MENU.
 23737     MOVE XCTL-EL626             TO PGM-NAME.
 23738     GO TO 9300-XCTL.
 23739
 23740 9300-XCTL.
 23741
 23742* EXEC CICS XCTL
 23743*        PROGRAM    (PGM-NAME)
 23744*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23745*        LENGTH     (PI-COMM-LENGTH)
 23746*    END-EXEC.
 23747*    MOVE '.$C                   %   #00019892' TO DFHEIV0
 23748     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23750     MOVE X'2020233030303139383932' TO DFHEIV0(25:11)
 23751     CALL 'kxdfhei1' USING DFHEIV0,
 23752           PGM-NAME,
 23753           PROGRAM-INTERFACE-BLOCK,
 23754           PI-COMM-LENGTH,
 23755           DFHEIV99
 23756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23757
 23758
 23759 9400-CLEAR.
 23760     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23761     GO TO 9300-XCTL.
 23762
 23763 9500-PF12.
 23764     MOVE XCTL-EL010             TO PGM-NAME.
 23765     GO TO 9300-XCTL.
 23766
 23767 9600-PGMID-ERROR.
 23768
 23769* EXEC CICS HANDLE CONDITION
 23770*        PGMIDERR    (8300-SEND-TEXT)
 23771*    END-EXEC.
 23772*    MOVE '"$L                   ! \ #00019907' TO DFHEIV0
 23773     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23775     MOVE X'5C20233030303139393037' TO DFHEIV0(25:11)
 23776     CALL 'kxdfhei1' USING DFHEIV0
 23777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23778
 23779
 23780     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23781     MOVE ' '                    TO PI-ENTRY-CD-1.
 23782     MOVE XCTL-EL005             TO PGM-NAME.
 23783     MOVE PGM-NAME               TO LOGOFF-PGM.
 23784     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23785     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 444
* EL6311.cbl
 23786
 23787 9700-DATE-LINK.
 23788     MOVE LINK-ELDATCV           TO PGM-NAME.
 23789
 23790* EXEC CICS LINK
 23791*        PROGRAM    (PGM-NAME)
 23792*        COMMAREA   (DATE-CONVERSION-DATA)
 23793*        LENGTH     (DC-COMM-LENGTH)
 23794*    END-EXEC.
 23795*    MOVE '."C                   (   #00019920' TO DFHEIV0
 23796     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23798     MOVE X'2020233030303139393230' TO DFHEIV0(25:11)
 23799     CALL 'kxdfhei1' USING DFHEIV0,
 23800           PGM-NAME,
 23801           DATE-CONVERSION-DATA,
 23802           DC-COMM-LENGTH,
 23803           DFHEIV99,
 23804           DFHEIV99,
 23805           DFHEIV99,
 23806           DFHEIV99
 23807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23808
 23809
 23810 9800-LINK-PENDING-EDIT.
 23811     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23812     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23813
 23814     MOVE LINK-EL050             TO PGM-NAME
 23815     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23816     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23817                                    WK-CO-TOL-CLAIM
 23818                                    WK-CO-TOL-PREM
 23819                                    WK-CO-TOL-REFUND
 23820                                    WK-CO-TOL-PREM-PCT
 23821                                    WK-CO-TOL-REFUND-PCT
 23822                                    WK-REFUND-OVS-AMT
 23823                                    WK-REFUND-OVS-PCT
 23824                                    WK-ACCT-ADDR
 23825                                    WK-LIFE-EDIT-ADDR
 23826                                    WK-AH-EDIT-ADDR
 23827                                    WK-LIFE-BEN-ADDR
 23828                                    WK-AH-BEN-ADDR
 23829                                    WK-STATE-ADDR
 23830                                    WK-PLAN-ADDR
 23831                                    WK-FORM-ADDR
 23832     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23833
 23834     MOVE '6'                    TO WK-ENTRY-SW.
 23835
 23836     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23837
 23838     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23839                                    EC-AM-EXPIRATION-DT
 23840                                    EC-AM-EFFECTIVE-DT
 23841                                    EC-CM-LF-CANCEL-DT
 23842                                    EC-CM-AH-CANCEL-DT
 23843                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 445
* EL6311.cbl
 23844
 23845     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23846                                    EC-CO-TOL-REFUND
 23847                                    EC-CO-MIN-AGE
 23848                                    EC-CO-MIN-PREMIUM
 23849                                    EC-CO-MIN-TERM
 23850                                    EC-CO-MAX-TERM
 23851                                    EC-ST-TOL-PREM
 23852                                    EC-ST-TOL-REFUND
 23853                                    EC-AM-LF-TOL-PREM
 23854                                    EC-AM-AH-TOL-PREM
 23855                                    EC-AM-LF-MAX-ATT-AGE
 23856                                    EC-AM-LF-MAX-AGE
 23857                                    EC-AM-LF-MAX-TERM
 23858                                    EC-AM-LF-MAX-TOT-BEN
 23859                                    EC-AM-AH-MAX-ATT-AGE
 23860                                    EC-AM-AH-MAX-AGE
 23861                                    EC-AM-AH-MAX-TERM
 23862                                    EC-AM-AH-MAX-TOT-BEN
 23863                                    EC-AM-AH-MAX-MON-BEN
 23864                                    EC-RT-LF-MAX-ATT-AGE
 23865                                    EC-RT-LF-MAX-AGE
 23866                                    EC-RT-LF-MAX-TERM
 23867                                    EC-RT-LF-MAX-TOT-BEN
 23868                                    EC-RT-AH-MAX-ATT-AGE
 23869                                    EC-RT-AH-MAX-AGE
 23870                                    EC-RT-AH-MAX-TERM
 23871                                    EC-RT-AH-MAX-TOT-BEN
 23872                                    EC-RT-AH-MAX-MON-BEN
 23873                                    EC-RT-AH-RATE
 23874                                    EC-RT-LF-RATE
 23875                                    EC-RT-LF-NSP-RATE
 23876                                    EC-RT-AH-NSP-RATE
 23877                                    EC-CM-LF-PRIOR-REFUND
 23878                                    EC-CM-AH-PRIOR-REFUND.
 23879
 23880     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23881                                    EC-ST-TOL-PREM-PCT
 23882                                    EC-AM-LF-TOL-REFUND
 23883                                    EC-AM-LF-DEV-PERCENT
 23884                                    EC-CO-TOL-REFUND-PCT
 23885                                    EC-ST-TOL-REFUND-PCT
 23886                                    EC-AM-AH-TOL-REFUND
 23887                                    EC-AM-AH-DEV-PERCENT.
 23888
 23889
 23890* EXEC CICS LINK
 23891*         PROGRAM   (PGM-NAME)
 23892*         COMMAREA  (PASSED-RECORD)
 23893*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23894*    END-EXEC.
 23895*    MOVE '."C                   (   #00020005' TO DFHEIV0
 23896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23898     MOVE X'2020233030303230303035' TO DFHEIV0(25:11)
 23899     CALL 'kxdfhei1' USING DFHEIV0,
 23900           PGM-NAME,
 23901           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 446
* EL6311.cbl
 23902           WS-EDIT-PASS-LENGTH,
 23903           DFHEIV99,
 23904           DFHEIV99,
 23905           DFHEIV99,
 23906           DFHEIV99
 23907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23908
 23909
 23910     MOVE '1'                    TO PI-EDIT-SW.
 23911     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23912
 23913     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23914
 23915     IF PI-COMPANY-ID = 'UCL'
 23916         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23917
 23918     IF VALID-PB-ID
 23919        GO TO 9800-EXIT.
 23920
 23921     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23922
 23923     IF PI-MAP-NAME = EL631B
 23924        MOVE -1                  TO BMAINTL
 23925       ELSE
 23926        MOVE -1                  TO CMAINTL.
 23927
 23928     GO TO 8200-SEND-DATAONLY.
 23929
 23930 9800-EXIT.
 23931      EXIT.
 23932
 23933 9900-ERROR-FORMAT.
 23934
 23935     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23936
 23937     IF NOT EMI-ERRORS-COMPLETE
 23938         MOVE LINK-EL001         TO PGM-NAME
 23939
 23940* EXEC CICS LINK
 23941*            PROGRAM    (PGM-NAME)
 23942*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23943*            LENGTH     (EMI-COMM-LENGTH)
 23944*        END-EXEC.
 23945*    MOVE '."C                   (   #00020040' TO DFHEIV0
 23946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23948     MOVE X'2020233030303230303430' TO DFHEIV0(25:11)
 23949     CALL 'kxdfhei1' USING DFHEIV0,
 23950           PGM-NAME,
 23951           ERROR-MESSAGE-INTERFACE-BLOCK,
 23952           EMI-COMM-LENGTH,
 23953           DFHEIV99,
 23954           DFHEIV99,
 23955           DFHEIV99,
 23956           DFHEIV99
 23957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23958
 23959
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 447
* EL6311.cbl
 23960 9900-EXIT.
 23961     EXIT.
 23962
 23963 9990-ABEND.
 23964     MOVE LINK-EL004             TO PGM-NAME.
 23965     MOVE DFHEIBLK               TO EMI-LINE1.
 23966
 23967* EXEC CICS LINK
 23968*        PROGRAM   (PGM-NAME)
 23969*        COMMAREA  (EMI-LINE1)
 23970*        LENGTH    (72)
 23971*    END-EXEC.
 23972     MOVE 72
 23973       TO DFHEIV11
 23974*    MOVE '."C                   (   #00020052' TO DFHEIV0
 23975     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23977     MOVE X'2020233030303230303532' TO DFHEIV0(25:11)
 23978     CALL 'kxdfhei1' USING DFHEIV0,
 23979           PGM-NAME,
 23980           EMI-LINE1,
 23981           DFHEIV11,
 23982           DFHEIV99,
 23983           DFHEIV99,
 23984           DFHEIV99,
 23985           DFHEIV99
 23986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23987
 23988
 23989     IF PI-MAP-NAME = EL631B
 23990        MOVE -1                  TO BMAINTL
 23991       ELSE
 23992        MOVE -1                  TO CMAINTL.
 23993
 23994     IF EIBTRNID NOT = TRANS-EXB1
 23995        GO TO 8100-SEND-INITIAL-MAP
 23996       ELSE
 23997        GO TO 8200-SEND-DATAONLY.
 23998
 23999 9995-SECURITY-VIOLATION.
 24000*                            COPY ELCSCTP.
 24001******************************************************************
 24002*                                                                *
 24003*                            ELCSCTP                             *
 24004*                            VMOD=2.001                          *
 24005*                                                                *
 24006*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24007******************************************************************
 24008
 24009
 24010     MOVE EIBDATE          TO SM-JUL-DATE.
 24011     MOVE EIBTRMID         TO SM-TERMID.
 24012     MOVE THIS-PGM         TO SM-PGM.
 24013     MOVE EIBTIME          TO TIME-IN.
 24014     MOVE TIME-OUT         TO SM-TIME.
 24015     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24016
 24017
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 448
* EL6311.cbl
 24018* EXEC CICS LINK
 24019*         PROGRAM  ('EL003')
 24020*         COMMAREA (SECURITY-MESSAGE)
 24021*         LENGTH   (80)
 24022*    END-EXEC.
 24023     MOVE 'EL003' TO DFHEIV1
 24024     MOVE 80
 24025       TO DFHEIV11
 24026*    MOVE '."C                   (   #00020086' TO DFHEIV0
 24027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24029     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 24030     CALL 'kxdfhei1' USING DFHEIV0,
 24031           DFHEIV1,
 24032           SECURITY-MESSAGE,
 24033           DFHEIV11,
 24034           DFHEIV99,
 24035           DFHEIV99,
 24036           DFHEIV99,
 24037           DFHEIV99
 24038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24039
 24040
 24041******************************************************************
 24042
 24043
 24044 9999-DFHBACK SECTION.
 24045     MOVE '9%                    "   ' TO DFHEIV0
 24046     MOVE 'EL6311' TO DFHEIV1
 24047     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24048     GOBACK.
 24049 9999-DFHEXIT.
 24050     IF DFHEIGDJ EQUAL 0001
 24051         NEXT SENTENCE
 24052     ELSE IF DFHEIGDJ EQUAL 2
 24053         GO TO 9600-PGMID-ERROR,
 24054               9990-ABEND,
 24055               9990-ABEND,
 24056               0010-MAIN-LOGIC
 24057         DEPENDING ON DFHEIGDI
 24058     ELSE IF DFHEIGDJ EQUAL 3
 24059         GO TO 1280-BATCH-HDR-NOT-FOUND
 24060         DEPENDING ON DFHEIGDI
 24061     ELSE IF DFHEIGDJ EQUAL 4
 24062         GO TO 1290-DUPLICATE-ALT-INDEX
 24063         DEPENDING ON DFHEIGDI
 24064     ELSE IF DFHEIGDJ EQUAL 5
 24065         GO TO 1295-CERT-TRL-REC-NOTFND
 24066         DEPENDING ON DFHEIGDI
 24067     ELSE IF DFHEIGDJ EQUAL 6
 24068         GO TO 1380-BATCH-HDR-NOT-FOUND
 24069         DEPENDING ON DFHEIGDI
 24070     ELSE IF DFHEIGDJ EQUAL 7
 24071         GO TO 1385-REC-NOT-FOUND
 24072         DEPENDING ON DFHEIGDI
 24073     ELSE IF DFHEIGDJ EQUAL 8
 24074         GO TO 1386-NOTFND
 24075         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 449
* EL6311.cbl
 24076     ELSE IF DFHEIGDJ EQUAL 9
 24077         GO TO 1399-EXIT
 24078         DEPENDING ON DFHEIGDI
 24079     ELSE IF DFHEIGDJ EQUAL 10
 24080         GO TO 1480-BATCH-HDR-NOT-FOUND
 24081         DEPENDING ON DFHEIGDI
 24082     ELSE IF DFHEIGDJ EQUAL 11
 24083         GO TO 1490-RECORD-NOT-FOUND
 24084         DEPENDING ON DFHEIGDI
 24085     ELSE IF DFHEIGDJ EQUAL 12
 24086         GO TO 1405-DELETE-CERTIFICATE
 24087         DEPENDING ON DFHEIGDI
 24088     ELSE IF DFHEIGDJ EQUAL 13
 24089         GO TO 1420-CONTINUE-DELETE
 24090         DEPENDING ON DFHEIGDI
 24091     ELSE IF DFHEIGDJ EQUAL 14
 24092         GO TO 1406-DELETE-ERNOTE
 24093         DEPENDING ON DFHEIGDI
 24094     ELSE IF DFHEIGDJ EQUAL 15
 24095         GO TO 1407-DELETE-MAILING
 24096         DEPENDING ON DFHEIGDI
 24097     ELSE IF DFHEIGDJ EQUAL 16
 24098         GO TO 1420-CONTINUE-DELETE
 24099         DEPENDING ON DFHEIGDI
 24100     ELSE IF DFHEIGDJ EQUAL 17
 24101         GO TO 1480-BATCH-HDR-NOT-FOUND
 24102         DEPENDING ON DFHEIGDI
 24103     ELSE IF DFHEIGDJ EQUAL 18
 24104         GO TO 1475-DELETE-FINISHED
 24105         DEPENDING ON DFHEIGDI
 24106     ELSE IF DFHEIGDJ EQUAL 19
 24107         GO TO 2280-BATCH-HDR-NOT-FOUND
 24108         DEPENDING ON DFHEIGDI
 24109     ELSE IF DFHEIGDJ EQUAL 20
 24110         GO TO 2290-DUPLICATE-ALT-INDEX
 24111         DEPENDING ON DFHEIGDI
 24112     ELSE IF DFHEIGDJ EQUAL 21
 24113         GO TO 2380-BATCH-HDR-NOT-FOUND
 24114         DEPENDING ON DFHEIGDI
 24115     ELSE IF DFHEIGDJ EQUAL 22
 24116         GO TO 2385-REC-NOT-FOUND
 24117         DEPENDING ON DFHEIGDI
 24118     ELSE IF DFHEIGDJ EQUAL 23
 24119         GO TO 2380-BATCH-HDR-NOT-FOUND
 24120         DEPENDING ON DFHEIGDI
 24121     ELSE IF DFHEIGDJ EQUAL 24
 24122         GO TO 2485-BATCH-HDR-NOT-FOUND
 24123         DEPENDING ON DFHEIGDI
 24124     ELSE IF DFHEIGDJ EQUAL 25
 24125         GO TO 2490-RECORD-NOT-FOUND
 24126         DEPENDING ON DFHEIGDI
 24127     ELSE IF DFHEIGDJ EQUAL 26
 24128         GO TO 2475-CONTINUE-DELETE
 24129         DEPENDING ON DFHEIGDI
 24130     ELSE IF DFHEIGDJ EQUAL 27
 24131         GO TO 2485-BATCH-HDR-NOT-FOUND
 24132         DEPENDING ON DFHEIGDI
 24133     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 450
* EL6311.cbl
 24134         GO TO 2480-DELETE-FINISHED
 24135         DEPENDING ON DFHEIGDI
 24136     ELSE IF DFHEIGDJ EQUAL 29
 24137         GO TO 2820-PROCESS-REWRITE
 24138         DEPENDING ON DFHEIGDI
 24139     ELSE IF DFHEIGDJ EQUAL 30
 24140         GO TO 2885-RECORD-MISSING
 24141         DEPENDING ON DFHEIGDI
 24142     ELSE IF DFHEIGDJ EQUAL 31
 24143         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24144         DEPENDING ON DFHEIGDI
 24145     ELSE IF DFHEIGDJ EQUAL 32
 24146         GO TO 2827-DELETE-MAILING
 24147         DEPENDING ON DFHEIGDI
 24148     ELSE IF DFHEIGDJ EQUAL 33
 24149         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24150         DEPENDING ON DFHEIGDI
 24151     ELSE IF DFHEIGDJ EQUAL 34
 24152         GO TO 2920-PROCESS-REWRITE
 24153         DEPENDING ON DFHEIGDI
 24154     ELSE IF DFHEIGDJ EQUAL 35
 24155         GO TO 2985-RECORD-MISSING
 24156         DEPENDING ON DFHEIGDI
 24157     ELSE IF DFHEIGDJ EQUAL 36
 24158         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24159         DEPENDING ON DFHEIGDI
 24160     ELSE IF DFHEIGDJ EQUAL 37
 24161         GO TO 2990-DUPLICATE-RECORD
 24162         DEPENDING ON DFHEIGDI
 24163     ELSE IF DFHEIGDJ EQUAL 38
 24164         GO TO 3590-NOT-FOUND
 24165         DEPENDING ON DFHEIGDI
 24166     ELSE IF DFHEIGDJ EQUAL 39
 24167         GO TO 3690-NOT-FOUND
 24168         DEPENDING ON DFHEIGDI
 24169     ELSE IF DFHEIGDJ EQUAL 40
 24170         GO TO 3990-NOT-FOUND
 24171         DEPENDING ON DFHEIGDI
 24172     ELSE IF DFHEIGDJ EQUAL 41
 24173         GO TO 4050-END-RECORDS,
 24174               4050-END-RECORDS
 24175         DEPENDING ON DFHEIGDI
 24176     ELSE IF DFHEIGDJ EQUAL 42
 24177         GO TO 4150-END-BATCH
 24178         DEPENDING ON DFHEIGDI
 24179     ELSE IF DFHEIGDJ EQUAL 43
 24180         GO TO 4150-END-BATCH
 24181         DEPENDING ON DFHEIGDI
 24182     ELSE IF DFHEIGDJ EQUAL 44
 24183         GO TO 4250-END-RECORDS,
 24184               4250-END-RECORDS
 24185         DEPENDING ON DFHEIGDI
 24186     ELSE IF DFHEIGDJ EQUAL 45
 24187         GO TO 4350-END-BATCH,
 24188               4350-END-BATCH
 24189         DEPENDING ON DFHEIGDI
 24190     ELSE IF DFHEIGDJ EQUAL 46
 24191         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:14 Page 451
* EL6311.cbl
 24192               4550-END-RECORDS
 24193         DEPENDING ON DFHEIGDI
 24194     ELSE IF DFHEIGDJ EQUAL 47
 24195         GO TO 4680-NOT-FOUND,
 24196               4680-NOT-FOUND
 24197         DEPENDING ON DFHEIGDI
 24198     ELSE IF DFHEIGDJ EQUAL 48
 24199         GO TO 4860-NOT-FOUND,
 24200               4850-END-RECORDS
 24201         DEPENDING ON DFHEIGDI
 24202     ELSE IF DFHEIGDJ EQUAL 49
 24203         GO TO 4970-NOT-FOUND,
 24204               4950-END-RECORDS
 24205         DEPENDING ON DFHEIGDI
 24206     ELSE IF DFHEIGDJ EQUAL 50
 24207         GO TO 5050-NOT-FOUND
 24208         DEPENDING ON DFHEIGDI
 24209     ELSE IF DFHEIGDJ EQUAL 51
 24210         GO TO 5050-NOT-FOUND
 24211         DEPENDING ON DFHEIGDI
 24212     ELSE IF DFHEIGDJ EQUAL 52
 24213         GO TO 5050-NOT-FOUND
 24214         DEPENDING ON DFHEIGDI
 24215     ELSE IF DFHEIGDJ EQUAL 53
 24216         GO TO 5550-END-RECORDS,
 24217               5550-END-RECORDS
 24218         DEPENDING ON DFHEIGDI
 24219     ELSE IF DFHEIGDJ EQUAL 54
 24220         GO TO 6050-QID-ERROR
 24221         DEPENDING ON DFHEIGDI
 24222     ELSE IF DFHEIGDJ EQUAL 55
 24223         GO TO 6050-QID-ERROR
 24224         DEPENDING ON DFHEIGDI
 24225     ELSE IF DFHEIGDJ EQUAL 56
 24226         GO TO 6400-CONTINUE,
 24227               6400-CONTINUE
 24228         DEPENDING ON DFHEIGDI
 24229     ELSE IF DFHEIGDJ EQUAL 57
 24230         GO TO 3690-NOT-FOUND
 24231         DEPENDING ON DFHEIGDI
 24232     ELSE IF DFHEIGDJ EQUAL 58
 24233         GO TO 7399-EXIT
 24234         DEPENDING ON DFHEIGDI
 24235     ELSE IF DFHEIGDJ EQUAL 59
 24236         GO TO 7550-OFFICER-NOTFND
 24237         DEPENDING ON DFHEIGDI
 24238     ELSE IF DFHEIGDJ EQUAL 60
 24239         GO TO 8300-SEND-TEXT
 24240         DEPENDING ON DFHEIGDI.
 24241     MOVE '9%                    "   ' TO DFHEIV0
 24242     MOVE 'EL6311' TO DFHEIV1
 24243     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24244     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14728     Code:       96327
