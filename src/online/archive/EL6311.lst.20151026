* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76******************************************************************
    77
    78 ENVIRONMENT DIVISION.
    79
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   4
* EL6311.cbl
    81 DATA DIVISION.
    82 WORKING-STORAGE SECTION.
    83 01  DFH-START PIC X(04).
    84 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    85 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    86 77  FILLER  PIC X(32)  VALUE '********************************'.
    87 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    88 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    89 77  A1                          PIC S999 COMP-3 VALUE +0.
    90 77  N1                          PIC S999 COMP-3 VALUE +0.
    91 77  N2                          PIC S999 COMP-3 VALUE +0.
    92 77  N3                          PIC S999 COMP-3 VALUE +0.
    93 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    95 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    96     88  REVERSAL                    VALUE 'Y'.
    97 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    98 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    99 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   100 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   101 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   102     88  ERMAIL-FOUND                 VALUE 'Y'.
   103 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   104 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   105 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   106 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   107     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   108 77  ws-stop-sw                  pic x value ' '.
   109     88  i-say-stop                 value 'Y'.
   110 77  ws-check-sw                 pic x value ' '.
   111     88  i-have-checks              value 'Y'.
   112 77  ws-proc-check-sw            pic x value ' '.
   113     88  i-have-processed-checks    value 'Y'.
   114 77  ws-chek-browse-sw           pic x value ' '.
   115 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   116 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   117 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   118 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   119 01  P pointer.
   120 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   121 01  var-ptr pointer.
   122 01  env-var-len                 pic 9(4)  binary.
   123 01  rc                          pic 9(9)  binary.
   124 01  WS-KIXSYS.
   125     05  WS-KIX-FIL1             PIC X(10).
   126     05  WS-KIX-APPS             PIC X(10).
   127     05  WS-KIX-ENV              PIC X(10).
   128     05  WS-KIX-MYENV            PIC X(10).
   129     05  WS-KIX-SYS              PIC X(10).
   130*    COPY ELCSCTM.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCSCTM                             *
   135*                            VMOD=2.001                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   138*                                                                *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   5
* EL6311.cbl
   139******************************************************************
   140 01  SECURITY-MESSAGE.
   141     12  FILLER                          PIC X(30)
   142            VALUE '** LOGIC SECURITY VIOLATION -'.
   143     12  SM-READ                         PIC X(6).
   144     12  FILLER                          PIC X(5)
   145            VALUE ' PGM='.
   146     12  SM-PGM                          PIC X(6).
   147     12  FILLER                          PIC X(5)
   148            VALUE ' OPR='.
   149     12  SM-PROCESSOR-ID                 PIC X(4).
   150     12  FILLER                          PIC X(6)
   151            VALUE ' TERM='.
   152     12  SM-TERMID                       PIC X(4).
   153     12  FILLER                          PIC XX   VALUE SPACE.
   154     12  SM-JUL-DATE                     PIC 9(5).
   155     12  FILLER                          PIC X    VALUE SPACE.
   156     12  SM-TIME                         PIC 99.99.
   157
   158
   159*    COPY ELCSCRTY.
   160******************************************************************
   161*                                                                *
   162*                                                                *
   163*                            ELCSCRTY                            *
   164*                            VMOD=2.001                          *
   165*                                                                *
   166*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   167*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   168*        SAVED IN PI-SECURITY-ADDRESS.                           *
   169*                                                                *
   170******************************************************************
   171 01  SECURITY-CONTROL.
   172     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   173     12  FILLER                       PIC XX    VALUE 'SC'.
   174     12  SC-CREDIT-CODES.
   175         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   176             20  SC-CREDIT-DISPLAY    PIC X.
   177             20  SC-CREDIT-UPDATE     PIC X.
   178     12  SC-CLAIMS-CODES.
   179         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   180             20  SC-CLAIMS-DISPLAY    PIC X.
   181             20  SC-CLAIMS-UPDATE     PIC X.
   182
   183 01  WS-VA-NO-COMM-MESS.
   184     12  FILLER                  PIC X(41) VALUE
   185        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   186 01  WS-OC-MESSAGE.
   187     12  FILLER                  PIC X(43) VALUE
   188        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   189     12  WS-OC-DIS-AMT           PIC -----9.99.
   190     12  FILLER                  PIC X(4) VALUE ' ON '.
   191     12  WS-OC-DATE              PIC X(10).
   192 01  WS-DATE-AREA.
   193     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   194     12  WS-CURRENT-DT.
   195         16  FILLER              PIC X(6)    VALUE SPACES.
   196         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   6
* EL6311.cbl
   197     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   198     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   199     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   200
   201 01  STANDARD-AREAS.
   202     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   203     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   204     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   205     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   206     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   207     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   208     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   209     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   210     12  PGM-NAME                PIC X(8).
   211     12  TIME-IN                 PIC S9(7).
   212     12  TIME-OUT-R  REDEFINES TIME-IN.
   213         16  FILLER              PIC X.
   214         16  TIME-OUT            PIC 99V99.
   215         16  FILLER              PIC XX.
   216     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   217     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   218     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   219     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   220     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   221     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   222     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   223     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   224     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   225     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   226     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   227     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   228     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   229     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   230     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   231     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   232     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   233     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   234     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   235     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   236     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   237     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   238     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   239     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   240     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   241     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   242     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   243     12  FILE-ID                 PIC X(8).
   244     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   245     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   246     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   247     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   248     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   249     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   250     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   251     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   252     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   253     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   254     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   7
* EL6311.cbl
   255     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   256     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   257     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   258     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   259
   260 01  WS-PASS-AREA.
   261     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   262     05  WS-PASS-VADS-REC    PIC X(350).
   263*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   264*                                COPY ELCZREC.
   265******************************************************************
   266*                                                                *
   267*                                                                *
   268*                            ELCZREC.                            *
   269*                                                                *
   270*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   271*                                                                *
   272******************************************************************
   273*-----------------------------------------------------------------
   274*                   C H A N G E   L O G
   275*
   276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   277*-----------------------------------------------------------------
   278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   279* EFFECTIVE    NUMBER
   280*-----------------------------------------------------------------
   281* 122011    2011022800001  AJRA  NEW FILE
   282* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   283* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   284* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   285* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   286*-----------------------------------------------------------------
   287 01  W-Z-CONTROL-DATA.
   288     05  W-NUMBER-OF-COPIES      PIC  9.
   289     05  FILLER                  PIC  X.
   290     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   291     05  FILLER                  PIC  X.
   292     05  W-DAYS-TO-RESEND        PIC  999.
   293     05  FILLER                  PIC  X.
   294     05  W-FORM-TO-RESEND        PIC  X(4).
   295     05  W-ADD-BAR-CODE          PIC  X.
   296     05  W-PROMPT-LETTER         PIC  X.
   297     05  W-HAS-RETURN-ENV        PIC  X.
   298     05  W-ENCLOSURE-CD          PIC  XXX.
   299     05  W-SIG-FLAG-DEFAULT      PIC  X.
   300     05  W-AUTO-CLOSE-IND        PIC  X.
   301     05  FILLER                  PIC  X.
   302     05  W-LETTER-TO-BENE        PIC  X.
   303     05  FILLER                  PIC  X.
   304     05  W-LETTER-TO-ACCT        PIC  X.
   305     05  FILLER                  PIC  X.
   306     05  W-LETTER-TYPE           PIC  X.
   307     05  FILLER                  PIC  X.
   308     05  W-PRINT-CERTIFICATE     PIC  X.
   309     05  FILLER                  PIC  X.
   310     05  W-REFUND-REQUIRED       PIC  X.
   311     05  FILLER                  PIC  X.
   312     05  W-ONBASE-CODE           PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   8
* EL6311.cbl
   313     05  FILLER                  PIC  X.
   314     05  W-ACCT-SUMM             PIC  X.
   315     05  FILLER                  PIC  X.
   316     05  W-CSO-SUMM              PIC  X.
   317     05  FILLER                  PIC  X.
   318     05  W-REASONS-REQUIRED      PIC  X.
   319     05  FILLER                  PIC  X(29).
   320******************************************************************
   321*                                                                *
   322*              A C C E S S   K E Y S                             *
   323*                                                                *
   324******************************************************************
   325
   326 01  ACCESS-KEYS.
   327     12  ERPYAJ-KEY.
   328         16  ERPYAJ-COMPANY-CD       PIC X.
   329         16  ERPYAJ-CARRIER          PIC X.
   330         16  ERPYAJ-GROUPING         PIC X(6).
   331         16  ERPYAJ-FIN-RESP         PIC X(10).
   332         16  ERPYAJ-ACCOUNT          PIC X(10).
   333         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   334         16  ERPYAJ-TYPE             PIC X.
   335     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   336     12  ELCERT-KEY.
   337         16  ELCERT-COMPANY-CD       PIC X.
   338         16  ELCERT-CARRIER          PIC X.
   339         16  ELCERT-GROUPING         PIC X(6).
   340         16  ELCERT-STATE            PIC XX.
   341         16  ELCERT-ACCOUNT          PIC X(10).
   342         16  ELCERT-CERT-EFF-DT      PIC XX.
   343         16  ELCERT-CERT-NO.
   344             20  ELCERT-CERT-PRIME   PIC X(10).
   345             20  ELCERT-CERT-SFX     PIC X.
   346
   347     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   348     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   349     12  ELCRTO-KEY.
   350         16  ELCRTO-COMPANY-CD       PIC X.
   351         16  ELCRTO-CARRIER          PIC X.
   352         16  ELCRTO-GROUPING         PIC X(6).
   353         16  ELCRTO-STATE            PIC XX.
   354         16  ELCRTO-ACCOUNT          PIC X(10).
   355         16  ELCRTO-CERT-EFF-DT      PIC XX.
   356         16  ELCRTO-CERT-NO.
   357             20  ELCRTO-CERT-PRIME   PIC X(10).
   358             20  ELCRTO-CERT-SFX     PIC X.
   359         16  ELCRTO-RECORD-TYPE      PIC X.
   360         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   361
   362     12  ELCRTT-KEY.
   363         16  ELCRTT-PRIMARY          PIC X(33).
   364         16  ELCRTT-REC-TYPE         PIC X(1).
   365     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   366     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   367
   368     12  ERPNDB-KEY.
   369         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   370         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page   9
* EL6311.cbl
   371         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   372         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   373             ERPNDB-BATCH-SEQ-NO     PIC XX.
   374         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   375
   376     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   377     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   378     12  ERCHEK-KEY.
   379         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   380         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   381         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   382         16  CHEK-STATE              PIC XX      VALUE SPACES.
   383         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   384         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   385         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   386         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   387         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   388     12  ELLETR-KEY.
   389         16  LETR-COMPANY-CD     PIC X.
   390         16  LETR-LETTER-ID      PIC X(4).
   391         16  LETR-FILLER         PIC X(8).
   392         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   393     12  ERPNDM-KEY.
   394         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   395         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   396         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   397         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   398
   399*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   400     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   401*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   402     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   403
   404     12  ERPNDB-ALT-KEY.
   405         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   406         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   407         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   408         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   409         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   410         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   411         16  ERPNDB-CERT-NO.
   412             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   413             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   414         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   415         16  ERPNDB-RECORD-TYPE      PIC X.
   416
   417      12  ERPNDB-CSR-KEY.
   418          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   419          20  ERPNDB-CSR-ID                PIC X(4).
   420          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   421          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   422          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   423
   424     12  ERNOTE-KEY.
   425         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   426         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   427         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   428         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  10
* EL6311.cbl
   429         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   430         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   431         16  ERNOTE-CERT-NO.
   432             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   433             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   434
   435     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   436     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   437
   438     12  ERCNOT-KEY.
   439         16  ERCNOT-PART-KEY.
   440             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   441             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   442             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   443             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   444             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   445             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   446             20  ERCNOT-CERT-NO.
   447                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   448                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   449         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   450         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   451
   452     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   453     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   454
   455     12  ERMAIL-KEY.
   456         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   457         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   458         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   459         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   460         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   461         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   462         16  ERMAIL-CERT-NO.
   463             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   464             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   465
   466     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   467     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   468
   469     12  ERRQST-KEY.
   470         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   471         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   472
   473     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   474     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   475
   476     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   477
   478     12  ERLOFC-KEY.
   479         16  ERLOFC-COMPANY-CD          PIC  X.
   480         16  ERLOFC-CARRIER             PIC  X.
   481         16  ERLOFC-GROUPING            PIC  X(6).
   482         16  ERLOFC-STATE               PIC  XX.
   483         16  ERLOFC-ACCOUNT             PIC  X(10).
   484         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   485*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   486
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  11
* EL6311.cbl
   487     12  ERACCT-KEY.
   488         16  ERACCT-COMPANY-CD          PIC  X.
   489         16  ERACCT-CARRIER             PIC  X.
   490         16  ERACCT-GROUPING            PIC  X(6).
   491         16  ERACCT-STATE               PIC  XX.
   492         16  ERACCT-ACCOUNT             PIC  X(10).
   493         16  ERACCT-EXP-DT.
   494             20  ERACCT-DT              PIC  XX.
   495             20  ERACCT-FILL            PIC  X(4).
   496
   497     12  ERENDT-KEY.
   498         16  ENDT-COMPANY-CD       PIC X.
   499         16  ENDT-CARRIER          PIC X.
   500         16  ENDT-GROUPING         PIC X(6).
   501         16  ENDT-STATE            PIC XX.
   502         16  ENDT-ACCOUNT          PIC X(10).
   503         16  ENDT-CERT-EFF-DT      PIC XX.
   504         16  ENDT-CERT-PRIME       PIC X(10).
   505         16  ENDT-CERT-SFX         PIC X.
   506         16  ENDT-RECORD-TYPE      PIC X.
   507         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   508
   509 01  WS-ELMSTR-WORK.
   510     12  ELMSTR-KEY.
   511         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   512         16  MSTR-CERT-NO.
   513             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   514             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   515     12  W-CLAIM-KEY.
   516         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   517         16  W-CL-CERT-NO.
   518             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   519             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   520      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   521 01  CANCEL-GEN-PASS-AREA.
   522     05  CG-OPTION-CODE          PIC X.
   523         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   524         88  CG-FLAT-CANCEL        VALUE '1'.
   525         88  CG-CANCEL             VALUE '2'.
   526         88  CG-CANCEL-REISSUE     VALUE '3'.
   527     05  CG-ERROR-CODE           PIC 99.
   528         88  CG-SUCCESS            VALUE 00.
   529         88  CG-DATE-ERROR         VALUE 01.
   530         88  CG-CERT-NOT-FOUND     VALUE 02.
   531         88  CG-AMOUNT-ERROR       VALUE 04.
   532         88  CG-OPTION-ERROR       VALUE 05.
   533         88  CG-PREV-CAN           VALUE 06.
   534         88  CG-INVALID-DATA       VALUE 07.
   535         88  CG-NO-ACCT-MSTR       VALUE 08.
   536         88  CG-SFX-A-EXIST        VALUE 09.
   537         88  CG-MISC-ERROR         VALUE 99.
   538     05  CG-COMPANY-ID           PIC XXX.
   539     05  CG-PROC-ID              PIC XXXX.
   540     05  CG-CURRENT-DT           PIC XX.
   541     05  CG-MONTH-END-DT         PIC XX.
   542     05  CG-CERT-KEY.
   543         10  CG-CERT-COMPANY-CD  PIC X.
   544         10  CG-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  12
* EL6311.cbl
   545         10  CG-CERT-GROUP       PIC X(6).
   546         10  CG-CERT-STATE       PIC XX.
   547         10  CG-CERT-ACCOUNT     PIC X(10).
   548         10  CG-CERT-EFF-DT      PIC XX.
   549         10  CG-CERT-CERT-NO     PIC X(11).
   550     05  CG-LF-CAN-DATA.
   551         10  CG-LF-CAN-DT        PIC XX.
   552         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   553     05  CG-AH-CAN-DATA.
   554         10  CG-AH-CAN-DT        PIC XX.
   555         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   556     05  CG-CERT-PROFILE-DATA.
   557         10  CG-INS-LNAME        PIC X(15).
   558         10  CG-INS-FNAME        PIC X(10).
   559         10  CG-INS-MID-INIT     PIC X.
   560         10  CG-INS-AGE          PIC 99.
   561         10  CG-JNT-LNAME        PIC X(15).
   562         10  CG-JNT-FNAME        PIC X(10).
   563         10  CG-JNT-MID-INIT     PIC X.
   564         10  CG-JNT-AGE          PIC 99.
   565     05  CG-LF-ISS-DATA.
   566         10  CG-LF-BENCD         PIC XX.
   567         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   568         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   569     05  CG-AH-ISS-DATA.
   570         10  CG-AH-BENCD         PIC XX.
   571         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   572     05  CG-BATCH-NO             PIC X(6).
   573     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   574     05  FILLER                  PIC X(306).
   575******************************************************************
   576*                                                                *
   577*            G E N E R A L   W O R K   A R E A                   *
   578*                                                                *
   579******************************************************************
   580
   581 01  WORK-AREA.
   582     12  WS-RESPONSE             PIC S9(8)   COMP.
   583         88  RESP-NORMAL           VALUE +0.
   584         88  resp-file-notfnd      value +12.
   585         88  RESP-NOTFND           VALUE +13.
   586         88  resp-duprec           value +14.
   587         88  resp-dupkey           value +15.
   588         88  resp-invreq           value +16.
   589         88  RESP-NOTOPEN          VALUE +19.
   590         88  RESP-ENDFILE          VALUE +20.
   591         88  resp-lengtherr        value +22.
   592     12  DEEDIT-FIELD            PIC X(15).
   593     12  FILLER          REDEFINES DEEDIT-FIELD.
   594         16  FILLER              PIC X(4).
   595         16  DEEDIT-FIELD-X11    PIC X(11).
   596     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   597                                 PIC S9(15).
   598     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   599                                 PIC S9(13)V99.
   600     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   601                                 PIC S9(11)V9999.
   602     12  W-ONE                   PIC S9(4) COMP VALUE +1.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  13
* EL6311.cbl
   603     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   604     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   605         16  WS-CALC-TERM-WHOLE  PIC S999.
   606         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   607
   608     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   609     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   610         16  WS-HR-MINS          PIC 99V99.
   611         16  FILLER              PIC XX.
   612
   613     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   614     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   615
   616     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   617     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   618
   619     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   620     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   621     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   622     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   623     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   624     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   625     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   626
   627     12  QID.
   628         16  QID-TERM            PIC X(4).
   629         16  FILLER              PIC X(4)    VALUE '607B'.
   630
   631     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   632         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   633
   634     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   635         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   636
   637     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   638         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   639                                         'A'.
   640
   641     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   642
   643     12  WS-NUMERIC-SW           PIC X.
   644        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   645
   646     12  WS-EDIT-CSO-FIELD.
   647         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   648                                 PIC X.
   649
   650     12  WS-SAVE-INPUT-FIELDS.
   651         16  WS-BAGE             PIC 99       VALUE ZERO.
   652*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   653         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   654         16  FILLER REDEFINES WS-BAPR.
   655             20  WS-APR-WHOLE-NUM    PIC 99.
   656             20  WS-APR-DEC          PIC 9999.
   657         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   658         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   659
   660         16  WS-B-COVERAGE OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  14
* EL6311.cbl
   661             20  WS-TERM-IN-DAYS-SW  PIC X.
   662                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   663             20  WS-BTERM        PIC 999       COMP-3.
   664             20  WS-BALT-TERM    PIC 999       COMP-3.
   665             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   666             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   667             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   668             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   669             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   670             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   671
   672         16  WS-C-FIELDS COMP-3.
   673             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   674             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   675             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   676
   677         16  WS-D-FIELDS COMP-3.
   678             20  WS-DRISS        PIC S9(5)    VALUE +0.
   679             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   680             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   681             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   682             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   683             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   684
   685     12  WS-SAVE-BIRTH-DATE.
   686         16  FILLER              PIC X(4)   VALUE SPACES.
   687         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   688
   689     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   690     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   691     12  FILLER REDEFINES WS-WORK-BIN-RED.
   692         16  FILLER              PIC X(02).
   693         16  WS-WORK-BIN-DT      PIC X(02).
   694     12  WS-SW-1                 PIC X     VALUE SPACE.
   695     12  WS-SW-2                 PIC X     VALUE SPACE.
   696     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   697         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   698     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   699         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   700
   701     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   702     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   703     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   704     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   705     12  WS-CONVERTED-CANCEL-DATES.
   706         16  WS-CONVERTED-CANDT1                  PIC XX.
   707         16  WS-CONVERTED-CANDT2                  PIC XX.
   708
   709     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   710
   711     12  WS-REC-FOUND-SW         PIC X.
   712         88  RECORD-NOT-FOUND    VALUE 'N'.
   713
   714     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   715         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   716         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   717
   718     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  15
* EL6311.cbl
   719         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   720         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   721
   722     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   723         88  BROWSE-STARTED      VALUE 'Y'.
   724
   725     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   726         88  FIRST-TIME          VALUE 'Y'.
   727
   728     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   729         88  FIRST-ENTRY         VALUE 'Y'.
   730
   731     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   732         88  REC-BILLED          VALUE 'Y'.
   733
   734     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   735         88  NO-CURSOR-SET       VALUE +0.
   736         88  CURSOR-SET          VALUE +1.
   737
   738     12  WS-ERR-SW               PIC X.
   739         88  STD-ERRORS          VALUE 'S'.
   740         88  TRN-ERRORS          VALUE 'T'.
   741
   742     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   743         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   744
   745     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   746         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   747
   748     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   749         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   750
   751     12  WS-ERR-CODE.
   752         16  FILLER              PIC 99.
   753         16  WS-ERROR-SUB        PIC 99.
   754
   755     12  WS-DATE-WORK.
   756         16  WS-WORK-MM          PIC XX.
   757         16  WS-WORK-DD          PIC XX.
   758         16  WS-WORK-YY          PIC XX.
   759
   760     12  WS-MM-YY.
   761         16  WS-MM               PIC XX.
   762         16  FILLER              PIC X     VALUE '/'.
   763         16  WS-YY               PIC XX.
   764
   765     12  WS-CERT-EFF-DT          PIC XX.
   766
   767     12  WS-MEMBER-NO            PIC X(12).
   768     12  FILLER  REDEFINES  WS-MEMBER-NO.
   769         16  WS-MEMBER-NO-1-8    PIC 9(8).
   770         16  FILLER              PIC X(4).
   771
   772     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   773
   774     12  WS-ERPNDB-ALT-KEY.
   775         16  WS-PB-COMPANY-CD-A1         PIC X.
   776         16  WS-PB-CARRIER               PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  16
* EL6311.cbl
   777         16  WS-PB-GROUPING              PIC X(6).
   778         16  WS-PB-STATE                 PIC XX.
   779         16  WS-PB-ACCOUNT               PIC X(10).
   780         16  WS-PB-CERT-EFF-DT           PIC XX.
   781         16  WS-PB-CERT-NO.
   782             20  WS-PB-CERT-PRIME        PIC X(10).
   783             20  WS-PB-CERT-SFX          PIC X.
   784         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   785         16  WS-PB-RECORD-TYPE           PIC X.
   786
   787     12  WS-SHOW-SAVE-AREAS.
   788         16  WS-NEW-CERT-NO.
   789             20  WS-NEW-PRIME    PIC X(10).
   790             20  WS-NEW-SUFFIX   PIC X.
   791         16  WS-NEW-CERT-EFF-DT  PIC XX.
   792         16  WS-NEW-RECORD-TYPE  PIC X.
   793         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   794             88   SHOW-RECORD            VALUE 'Y'.
   795
   796     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   797
   798     12  WS-BATCH-NO.
   799         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   800         16  FILLER              PIC X(5) VALUE SPACES.
   801
   802     12  WS-FIRST-NAME.
   803         16  WS-1ST-INIT         PIC X.
   804         16  FILLER              PIC X(9).
   805
   806     12  WS-INITIALS.
   807         16  WS-INITIAL-1        PIC X.
   808         16  WS-INITIAL-2        PIC X.
   809
   810     12  WS-C-HDG.
   811         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   812         16  FILLER              PIC X(4) VALUE '-REF'.
   813
   814     12  WS-D-PREM-HDG.
   815         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   816         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   817
   818     12  WS-D-REFUND-HDG.
   819         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   820         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   821
   822     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   823
   824     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   825     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   826     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   827     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   828     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   829     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   830     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   831
   832     12  WS-01-CANCEL-ERR        PIC X(25)
   833         VALUE 'CANCEL DATE ERROR'.
   834     12  WS-02-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  17
* EL6311.cbl
   835         VALUE 'CERT NOT FOUND'.
   836     12  WS-04-CANCEL-ERR        PIC X(25)
   837         VALUE 'CANCEL AMOUNT ERROR'.
   838     12  WS-05-CANCEL-ERR        PIC X(25)
   839         VALUE 'CANCEL OPTION ERROR'.
   840     12  WS-06-CANCEL-ERR        PIC X(25)
   841         VALUE 'PREVIOUSLY CANCELLED'.
   842     12  WS-07-CANCEL-ERR        PIC X(25)
   843         VALUE 'INVALID DATA'.
   844     12  WS-08-CANCEL-ERR        PIC X(25)
   845         VALUE 'NO ACCOUNT MASTER'.
   846     12  WS-09-CANCEL-ERR        PIC X(25)
   847         VALUE 'SUFFIX ALREADY EXISTS'.
   848     12  WS-99-CANCEL-ERR        PIC X(25)
   849         VALUE 'MISC CANCEL ERROR'.
   850
   851     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   852     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   853
   854     12  WS-AGE-FIELDS.
   855         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   856         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   857         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   858         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   859
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  18
* EL6311.cbl
   861
   862******************************************************************
   863*                                                                *
   864*                 B A T C H   T O T A L S                        *
   865*                                                                *
   866******************************************************************
   867
   868     12  WS-BATCH-RECORD.
   869         16  FILLER                       PIC X(10).
   870         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   871         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   872         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   873         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   874         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   875         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   876         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   877         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   878         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   883         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   884         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   885         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   886         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   887         16  WS-ACCOUNT-NAME              PIC X(30).
   888         16  FILLER                       PIC X.
   889         16  WS-REFERENCE                 PIC X(12).
   890         16  FILLER                       PIC X(197).
   891
   892     12  WS-BATCH-TOTALS.
   893         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   894         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   895         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   898         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   899         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   904         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   905         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   911         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   912
   913     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   914
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  19
* EL6311.cbl
   916
   917******************************************************************
   918*                                                                *
   919*                E R R O R   M E S S A G E S                     *
   920*                                                                *
   921******************************************************************
   922
   923 01  ERROR-MESSAGES.
   924     12  ER-0004                 PIC  9(4) VALUE 0004.
   925     12  ER-0008                 PIC  9(4) VALUE 0008.
   926     12  ER-0023                 PIC  9(4) VALUE 0023.
   927     12  ER-0029                 PIC  9(4) VALUE 0029.
   928     12  ER-0033                 PIC  9(4) VALUE 0033.
   929     12  ER-0070                 PIC  9(4) VALUE 0070.
   930     12  ER-0220                 PIC  9(4) VALUE 0220.
   931     12  ER-0248                 PIC  9(4) VALUE 0248.
   932     12  ER-0280                 PIC  9(4) VALUE 0280.
   933     12  ER-0348                 PIC  9(4) VALUE 0348.
   934     12  ER-0582                 PIC  9(4) VALUE 0582.
   935     12  ER-0877                 PIC  9(4) VALUE 0877.
   936     12  ER-1236                 PIC  9(4) VALUE 1236.
   937     12  ER-1570                 PIC  9(4) VALUE 1570.
   938     12  ER-1575                 PIC  9(4) VALUE 1575.
   939     12  ER-1609                 PIC  9(4) VALUE 1609.
   940     12  ER-1819                 PIC  9(4) VALUE 1819.
   941     12  ER-2077                 PIC  9(4) VALUE 2077.
   942     12  ER-2129                 PIC  9(4) VALUE 2129.
   943     12  ER-2188                 PIC  9(4) VALUE 2188.
   944     12  ER-2192                 PIC  9(4) VALUE 2192.
   945     12  ER-2196                 PIC  9(4) VALUE 2196.
   946     12  ER-2197                 PIC  9(4) VALUE 2197.
   947     12  ER-2198                 PIC  9(4) VALUE 2198.
   948     12  ER-2200                 PIC  9(4) VALUE 2200.
   949     12  ER-2212                 PIC  9(4) VALUE 2212.
   950     12  ER-2218                 PIC  9(4) VALUE 2218.
   951     12  ER-2220                 PIC  9(4) VALUE 2220.
   952     12  ER-2222                 PIC  9(4) VALUE 2222.
   953     12  ER-2223                 PIC  9(4) VALUE 2223.
   954     12  ER-2224                 PIC  9(4) VALUE 2224.
   955     12  ER-2225                 PIC  9(4) VALUE 2225.
   956     12  ER-2226                 PIC  9(4) VALUE 2226.
   957     12  ER-2227                 PIC  9(4) VALUE 2227.
   958     12  ER-2228                 PIC  9(4) VALUE 2228.
   959     12  ER-2240                 PIC  9(4) VALUE 2240.
   960     12  ER-2241                 PIC  9(4) VALUE 2241.
   961     12  ER-2242                 PIC  9(4) VALUE 2242.
   962     12  ER-2243                 PIC  9(4) VALUE 2243.
   963     12  ER-2244                 PIC  9(4) VALUE 2244.
   964     12  ER-2245                 PIC  9(4) VALUE 2245.
   965     12  ER-2246                 PIC  9(4) VALUE 2246.
   966     12  ER-2247                 PIC  9(4) VALUE 2247.
   967     12  ER-2251                 PIC  9(4) VALUE 2251.
   968     12  ER-2252                 PIC  9(4) VALUE 2252.
   969     12  ER-2253                 PIC  9(4) VALUE 2253.
   970     12  ER-2254                 PIC  9(4) VALUE 2254.
   971     12  ER-2255                 PIC  9(4) VALUE 2255.
   972     12  ER-2256                 PIC  9(4) VALUE 2256.
   973     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  20
* EL6311.cbl
   974     12  ER-2258                 PIC  9(4) VALUE 2258.
   975     12  ER-2259                 PIC  9(4) VALUE 2259.
   976     12  ER-2260                 PIC  9(4) VALUE 2260.
   977     12  ER-2261                 PIC  9(4) VALUE 2261.
   978     12  ER-2287                 PIC  9(4) VALUE 2287.
   979     12  ER-2336                 PIC  9(4) VALUE 2336.
   980     12  ER-2337                 PIC  9(4) VALUE 2337.
   981     12  ER-2437                 PIC  9(4) VALUE 2437.
   982     12  ER-2471                 PIC  9(4) VALUE 2471.
   983     12  ER-2530                 PIC  9(4) VALUE 2530.
   984     12  ER-2531                 PIC  9(4) VALUE 2531.
   985     12  ER-2532                 PIC  9(4) VALUE 2532.
   986     12  ER-2533                 PIC  9(4) VALUE 2533.
   987     12  ER-2547                 PIC  9(4) VALUE 2547.
   988     12  ER-2591                 PIC  9(4) VALUE 2591.
   989     12  ER-2592                 PIC  9(4) VALUE 2592.
   990     12  ER-2593                 PIC  9(4) VALUE 2593.
   991     12  ER-2600                 PIC  9(4) VALUE 2600.
   992     12  ER-2601                 PIC  9(4) VALUE 2601.
   993     12  ER-2604                 PIC  9(4) VALUE 2604.
   994     12  ER-2605                 PIC  9(4) VALUE 2605.
   995     12  ER-2606                 PIC  9(4) VALUE 2606.
   996     12  ER-2607                 PIC  9(4) VALUE 2607.
   997     12  ER-2622                 PIC  9(4) VALUE 2622.
   998     12  ER-2625                 PIC  9(4) VALUE 2625.
   999     12  ER-2626                 PIC  9(4) VALUE 2626.
  1000     12  ER-2627                 PIC  9(4) VALUE 2627.
  1001     12  ER-2628                 PIC  9(4) VALUE 2628.
  1002     12  ER-2629                 PIC  9(4) VALUE 2629.
  1003     12  ER-2630                 PIC  9(4) VALUE 2630.
  1004     12  ER-2631                 PIC  9(4) VALUE 2631.
  1005     12  ER-2632                 PIC  9(4) VALUE 2632.
  1006     12  ER-2633                 PIC  9(4) VALUE 2633.
  1007     12  ER-2634                 PIC  9(4) VALUE 2634.
  1008     12  ER-2635                 PIC  9(4) VALUE 2635.
  1009     12  ER-2636                 PIC  9(4) VALUE 2636.
  1010     12  ER-2639                 PIC  9(4) VALUE 2639.
  1011     12  ER-2640                 PIC  9(4) VALUE 2640.
  1012     12  ER-2647                 PIC  9(4) VALUE 2647.
  1013     12  ER-2648                 PIC  9(4) VALUE 2648.
  1014     12  ER-2649                 PIC  9(4) VALUE 2649.
  1015     12  ER-2650                 PIC  9(4) VALUE 2650.
  1016     12  ER-2653                 PIC  9(4) VALUE 2653.
  1017     12  ER-2654                 PIC  9(4) VALUE 2654.
  1018     12  ER-2655                 PIC  9(4) VALUE 2655.
  1019     12  ER-2656                 PIC  9(4) VALUE 2656.
  1020     12  ER-2657                 PIC  9(4) VALUE 2657.
  1021     12  ER-2660                 PIC  9(4) VALUE 2660.
  1022     12  ER-2661                 PIC  9(4) VALUE 2661.
  1023     12  ER-2662                 PIC  9(4) VALUE 2662.
  1024     12  ER-2663                 PIC  9(4) VALUE 2663.
  1025     12  ER-2664                 PIC  9(4) VALUE 2664.
  1026     12  ER-2667                 PIC  9(4) VALUE 2667.
  1027     12  ER-2668                 PIC  9(4) VALUE 2668.
  1028     12  ER-2669                 PIC  9(4) VALUE 2669.
  1029     12  ER-2670                 PIC  9(4) VALUE 2670.
  1030     12  ER-2671                 PIC  9(4) VALUE 2671.
  1031     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  21
* EL6311.cbl
  1032     12  ER-2673                 PIC  9(4) VALUE 2673.
  1033     12  ER-2677                 PIC  9(4) VALUE 2677.
  1034     12  ER-2678                 PIC  9(4) VALUE 2678.
  1035     12  ER-2679                 PIC  9(4) VALUE 2679.
  1036     12  ER-2680                 PIC  9(4) VALUE 2680.
  1037     12  ER-2681                 PIC  9(4) VALUE 2681.
  1038     12  ER-2682                 PIC  9(4) VALUE 2682.
  1039     12  ER-2683                 PIC  9(4) VALUE 2683.
  1040     12  ER-2684                 PIC  9(4) VALUE 2684.
  1041     12  ER-2686                 PIC  9(4) VALUE 2686.
  1042     12  ER-2689                 PIC  9(4) VALUE 2689.
  1043     12  ER-2690                 PIC  9(4) VALUE 2690.
  1044     12  ER-2693                 PIC  9(4) VALUE 2693.
  1045     12  ER-2695                 PIC  9(4) VALUE 2695.
  1046     12  ER-2701                 PIC  9(4) VALUE 2701.
  1047     12  ER-2720                 PIC  9(4) VALUE 2720.
  1048     12  ER-2709                 PIC  9(4) VALUE 2709.
  1049     12  ER-2704                 PIC  9(4) VALUE 2704.
  1050     12  ER-2725                 PIC  9(4) VALUE 2725.
  1051     12  ER-2726                 PIC  9(4) VALUE 2726.
  1052     12  ER-2728                 PIC  9(4) VALUE 2728.
  1053     12  ER-2729                 PIC  9(4) VALUE 2729.
  1054     12  ER-2731                 PIC  9(4) VALUE 2731.
  1055     12  ER-2732                 PIC  9(4) VALUE 2732.
  1056     12  ER-2733                 PIC  9(4) VALUE 2733.
  1057     12  ER-2735                 PIC  9(4) VALUE 2735.
  1058     12  ER-2738                 PIC  9(4) VALUE 2738.
  1059     12  ER-2742                 PIC  9(4) VALUE 2742.
  1060     12  ER-2743                 PIC  9(4) VALUE 2743.
  1061     12  ER-2744                 PIC  9(4) VALUE 2744.
  1062     12  ER-2747                 PIC  9(4) VALUE 2747.
  1063     12  ER-2749                 PIC  9(4) VALUE 2749.
  1064     12  ER-2753                 PIC  9(4) VALUE 2753.
  1065     12  ER-2755                 PIC  9(4) VALUE 2755.
  1066     12  ER-2757                 PIC  9(4) VALUE 2757.
  1067     12  ER-2771                 PIC  9(4) VALUE 2771.
  1068     12  ER-2774                 PIC  9(4) VALUE 2774.
  1069     12  ER-2775                 PIC  9(4) VALUE 2775.
  1070     12  ER-2776                 PIC  9(4) VALUE 2776.
  1071     12  ER-2777                 PIC  9(4) VALUE 2777.
  1072     12  ER-2794                 PIC  9(4) VALUE 2794.
  1073     12  ER-2799                 PIC  9(4) VALUE 2799.
  1074     12  ER-2900                 PIC  9(4) VALUE 2900.
  1075     12  ER-2902                 PIC  9(4) VALUE 2902.
  1076     12  ER-2945                 PIC  9(4) VALUE 2945.
  1077     12  ER-3000                 PIC  9(4) VALUE 3000.
  1078     12  ER-3006                 PIC  9(4) VALUE 3006.
  1079     12  ER-3054                 PIC  9(4) VALUE 3054.
  1080     12  ER-3224                 PIC  9(4) VALUE 3224.
  1081     12  ER-3269                 PIC  9(4) VALUE 3269.
  1082     12  er-3444                 pic  9(4) value 3444.
  1083     12  er-3446                 pic  9(4) value 3446.
  1084     12  er-3447                 pic  9(4) value 3447.
  1085     12  er-3448                 pic  9(4) value 3448.
  1086     12  er-3449                 pic  9(4) value 3449.
  1087     12  ER-3504                 PIC  9(4) VALUE 3504.
  1088     12  ER-3513                 PIC  9(4) VALUE 3513.
  1089     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  22
* EL6311.cbl
  1090     12  ER-3834                 PIC  9(4) VALUE 3834.
  1091     12  ER-3835                 PIC  9(4) VALUE 3835.
  1092     12  ER-4005                 PIC  9(4) VALUE 4005.
  1093     12  ER-7144                 PIC  9(4) VALUE 7144.
  1094     12  ER-7401                 PIC  9(4) VALUE 7401.
  1095     12  ER-7402                 PIC  9(4) VALUE 7402.
  1096     12  ER-7403                 PIC  9(4) VALUE 7403.
  1097     12  ER-7404                 PIC  9(4) VALUE 7404.
  1098     12  ER-7423                 PIC  9(4) VALUE 7423.
  1099     12  ER-7424                 PIC  9(4) VALUE 7424.
  1100     12  ER-7433                 PIC  9(4) VALUE 7433.
  1101     12  ER-7450                 PIC  9(4) VALUE 7450.
  1102     12  ER-7451                 PIC  9(4) VALUE 7451.
  1103     12  ER-7530                 PIC  9(4) VALUE 7530.
  1104     12  ER-7573                 PIC  9(4) VALUE 7573.
  1105     12  ER-7631                 PIC  9(4) VALUE 7631.
  1106     12  ER-7632                 PIC  9(4) VALUE 7632.
  1107     12  ER-7633                 PIC  9(4) VALUE 7633.
  1108     12  ER-7537                 PIC  9(4) VALUE 7537.
  1109     12  ER-7538                 PIC  9(4) VALUE 7538.
  1110     12  ER-7574                 PIC  9(4) VALUE 7574.
  1111     12  ER-7997                 PIC  9(4) VALUE 7997.
  1112     12  ER-7998                 PIC  9(4) VALUE 7998.
  1113     12  ER-8148                 PIC  9(4) VALUE 8148.
  1114     12  ER-9063                 PIC  9(4) VALUE 9063.
  1115     12  ER-9076                 PIC  9(4) VALUE 9076.
  1116     12  ER-9618                 PIC  9(4) VALUE 9618.
  1117     12  ER-9841                 PIC  9(4) VALUE 9841.
  1118
  1119*                                COPY ELCTEXT.
  1120******************************************************************
  1121*                                                                *
  1122*                                                                *
  1123*                            ELCTEXT.                            *
  1124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1125*                            VMOD=2.008                          *
  1126*                                                                *
  1127*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1128*                                     FORM LETTERS,              *
  1129*                                     CERT FORM DISPLAY.
  1130*                                                                *
  1131*   FILE TYPE = VSAM,KSDS                                        *
  1132*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1133*                                                                *
  1134*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1135*       ALTERNATE INDEX = NONE                                   *
  1136*                                                                *
  1137*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1138*       ALTERNATE INDEX = NONE                                   *
  1139*                                                                *
  1140*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1141*       ALTERNATE INDEX = NONE                                   *
  1142*                                                                *
  1143*   LOG = NO                                                     *
  1144*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1145******************************************************************
  1146 01  TEXT-FILES.
  1147     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  23
* EL6311.cbl
  1148         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1149         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1150         88  HELP-FILE-TEXT             VALUE 'TH'.
  1151
  1152     12  TX-CONTROL-PRIMARY.
  1153         16  TX-COMPANY-CD           PIC X.
  1154             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1155         16  TX-ACCESS-CD-GENL       PIC X(12).
  1156
  1157         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1158             20  TX-LETTER-NO        PIC X(4).
  1159             20  FILLER              PIC X(8).
  1160
  1161         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1162             20  TX-FORM-NO          PIC X(12).
  1163
  1164         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1165             20  TX-HELP-TYPE        PIC X.
  1166                 88  HELP-FOR-GENERAL   VALUE ' '.
  1167                 88  HELP-BY-SCREEN     VALUE 'S'.
  1168                 88  HELP-BY-ERROR      VALUE 'E'.
  1169             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1170                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1171             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1172                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1173             20  FILLER              PIC X(4).
  1174
  1175         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1176
  1177     12  TX-PROCESS-CONTROL          PIC XX.
  1178         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1179
  1180     12  TX-TEXT-LINE                PIC X(70).
  1181
  1182     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1183         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1184         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1185         88  TX-VALID-FORM-SQUEEZE-VALUE
  1186                                        VALUE 'Y' ' '.
  1187
  1188     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1189         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1190         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1191         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1192         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1193         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1194         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1195         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1196                                              'K' 'N' ' '
  1197                                              'Z'.
  1198
  1199     12  TX-ARCHIVE-SW               PIC X.
  1200         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1201         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1202         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1203
  1204     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1205     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  24
* EL6311.cbl
  1206
  1207     12  TX-BSR-CODE                 PIC X.
  1208         88  TX-BSR-LETTER              VALUE 'B'.
  1209         88  TX-NON-BSR-LETTER          VALUE ' '.
  1210
  1211     12  FILLER                      PIC X.
  1212*****************************************************************
  1213*                                COPY ELCCRTO.
  1214******************************************************************
  1215*                                                                *
  1216*                            ELCCRTO.                            *
  1217*                                                                *
  1218*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1219*                                                                *
  1220*   FILE TYPE = VSAM,KSDS                                        *
  1221*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1222*                                                                *
  1223*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1224*                                                                *
  1225*   LOG = YES                                                    *
  1226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1227******************************************************************
  1228*                   C H A N G E   L O G
  1229*
  1230* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1231*-----------------------------------------------------------------
  1232*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1233* EFFECTIVE    NUMBER
  1234*-----------------------------------------------------------------
  1235* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1236* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1237* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1238* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1239* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1240******************************************************************
  1241 01  ORIGINAL-CERTIFICATE.
  1242     12  OC-RECORD-ID                      PIC XX.
  1243         88  VALID-OC-ID                      VALUE 'OC'.
  1244     12  OC-CONTROL-PRIMARY.
  1245         16  OC-COMPANY-CD                 PIC X.
  1246         16  OC-CARRIER                    PIC X.
  1247         16  OC-GROUPING                   PIC X(6).
  1248         16  OC-STATE                      PIC XX.
  1249         16  OC-ACCOUNT                    PIC X(10).
  1250         16  OC-CERT-EFF-DT                PIC XX.
  1251         16  OC-CERT-NO.
  1252             20  OC-CERT-PRIME             PIC X(10).
  1253             20  OC-CERT-SFX               PIC X.
  1254         16  OC-RECORD-TYPE                PIC X.
  1255         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1256     12  OC-LAST-MAINT-DT                  PIC XX.
  1257     12  OC-LAST-MAINT-BY                  PIC X(4).
  1258     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1259     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1260     12  FILLER                            PIC X(49).
  1261     12  OC-ORIG-REC.
  1262         16  OC-INS-LAST-NAME              PIC X(15).
  1263         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  25
* EL6311.cbl
  1264         16  OC-INS-MIDDLE-INIT            PIC X.
  1265         16  OC-INS-AGE                    PIC S999     COMP-3.
  1266         16  OC-JNT-LAST-NAME              PIC X(15).
  1267         16  OC-JNT-FIRST-NAME             PIC X(10).
  1268         16  OC-JNT-MIDDLE-INIT            PIC X.
  1269         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1270         16  OC-LF-BENCD                   PIC XX.
  1271         16  OC-LF-TERM                    PIC S999      COMP-3.
  1272         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1273         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1274         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1275         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1276         16  OC-LF-EXP-DT                  PIC XX.
  1277         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1278         16  OC-LF-CANCEL-DT               PIC XX.
  1279         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1280         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1281         16  OC-AH-BENCD                   PIC XX.
  1282         16  OC-AH-TERM                    PIC S999      COMP-3.
  1283         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1284         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1285         16  OC-AH-EXP-DT                  PIC XX.
  1286         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1287         16  OC-AH-CP                      PIC 99.
  1288         16  OC-AH-CANCEL-DT               PIC XX.
  1289         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1290         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1291         16  OC-CRED-BENE-NAME             PIC X(25).
  1292         16  OC-1ST-PMT-DT                 PIC XX.
  1293         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1294         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1295         16  OC-ISSUE-TRAN-IND             PIC X.
  1296         16  OC-CANCEL-TRAN-IND            PIC X.
  1297         16  FILLER                        PIC X(211).
  1298
  1299     12  FILLER                            PIC X(50).
  1300******************************************************************
  1301*                                COPY ERCACCT.
  1302******************************************************************
  1303*                                                                *
  1304*                                                                *
  1305*                            ERCACCT                             *
  1306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1307*                            VMOD=2.031                          *
  1308*                                                                *
  1309*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1310*                                                                *
  1311*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1312*   VSAM ACCOUNT MASTER FILES.                                   *
  1313*                                                                *
  1314*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1315*                                                                *
  1316*   FILE TYPE = VSAM,KSDS                                        *
  1317*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1318*                                                                *
  1319*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1320*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1321*                                                                *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  26
* EL6311.cbl
  1322*   LOG = NO                                                     *
  1323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1324*                                                                *
  1325*                                                                *
  1326******************************************************************
  1327*                   C H A N G E   L O G
  1328*
  1329* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1330*-----------------------------------------------------------------
  1331*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1332* EFFECTIVE    NUMBER
  1333*-----------------------------------------------------------------
  1334* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1335* 092705    2005050300006  PEMA  ADD SPP LEASES
  1336* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1337* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1338* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1339* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1340* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1341******************************************************************
  1342
  1343 01  ACCOUNT-MASTER.
  1344     12  AM-RECORD-ID                      PIC XX.
  1345         88  VALID-AM-ID                      VALUE 'AM'.
  1346
  1347     12  AM-CONTROL-PRIMARY.
  1348         16  AM-COMPANY-CD                 PIC X.
  1349         16  AM-MSTR-CNTRL.
  1350             20  AM-CONTROL-A.
  1351                 24  AM-CARRIER            PIC X.
  1352                 24  AM-GROUPING.
  1353                     28 AM-GROUPING-PREFIX PIC XXX.
  1354                     28 AM-GROUPING-PRIME  PIC XXX.
  1355                 24  AM-STATE              PIC XX.
  1356                 24  AM-ACCOUNT.
  1357                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1358                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1359             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1360                                           PIC X(19).
  1361             20  AM-CNTRL-B.
  1362                 24  AM-EXPIRATION-DT      PIC XX.
  1363                 24  FILLER                PIC X(4).
  1364             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1365                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1366
  1367     12  AM-CONTROL-BY-VAR-GRP.
  1368         16  AM-COMPANY-CD-A1              PIC X.
  1369         16  AM-VG-CARRIER                 PIC X.
  1370         16  AM-VG-GROUPING                PIC X(6).
  1371         16  AM-VG-STATE                   PIC XX.
  1372         16  AM-VG-ACCOUNT                 PIC X(10).
  1373         16  AM-VG-DATE.
  1374             20  AM-VG-EXPIRATION-DT       PIC XX.
  1375             20  FILLER                    PIC X(4).
  1376         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1377                                           PIC 9(11)      COMP-3.
  1378     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1379         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  27
* EL6311.cbl
  1380         16  AM-VG-KEY3.
  1381             20  AM-VG3-ACCOUNT            PIC X(10).
  1382             20  AM-VG3-EXP-DT             PIC XX.
  1383         16  FILLER                        PIC X(4).
  1384     12  AM-MAINT-INFORMATION.
  1385         16  AM-LAST-MAINT-DT              PIC XX.
  1386         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1387         16  AM-LAST-MAINT-USER            PIC X(4).
  1388         16  FILLER                        PIC XX.
  1389
  1390     12  AM-EFFECTIVE-DT                   PIC XX.
  1391     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1392
  1393     12  AM-PREV-DATES  COMP-3.
  1394         16  AM-PREV-EXP-DT                PIC 9(11).
  1395         16  AM-PREV-EFF-DT                PIC 9(11).
  1396
  1397     12  AM-REPORT-CODE-1                  PIC X(10).
  1398     12  AM-REPORT-CODE-2                  PIC X(10).
  1399
  1400     12  AM-CITY-CODE                      PIC X(4).
  1401     12  AM-COUNTY-PARISH                  PIC X(6).
  1402
  1403     12  AM-NAME                           PIC X(30).
  1404     12  AM-PERSON                         PIC X(30).
  1405     12  AM-ADDRS                          PIC X(30).
  1406     12  AM-CITY.
  1407         16  AM-ADDR-CITY                  PIC X(28).
  1408         16  AM-ADDR-STATE                 PIC XX.
  1409     12  AM-ZIP.
  1410         16  AM-ZIP-PRIME.
  1411             20  AM-ZIP-PRI-1ST            PIC X.
  1412                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1413             20  FILLER                    PIC X(4).
  1414         16  AM-ZIP-PLUS4                  PIC X(4).
  1415     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1416         16  AM-CAN-POSTAL-1               PIC XXX.
  1417         16  AM-CAN-POSTAL-2               PIC XXX.
  1418         16  FILLER                        PIC XXX.
  1419     12  AM-TEL-NO.
  1420         16  AM-AREA-CODE                  PIC 999.
  1421         16  AM-TEL-PRE                    PIC 999.
  1422         16  AM-TEL-NBR                    PIC 9(4).
  1423     12  AM-TEL-LOC                        PIC X.
  1424         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1425         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1426
  1427     12  AM-COMM-STRUCTURE.
  1428         16  AM-DEFN-1.
  1429             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1430                 24  AM-AGT.
  1431                     28  AM-AGT-PREFIX     PIC X(4).
  1432                     28  AM-AGT-PRIME      PIC X(6).
  1433                 24  AM-COM-TYP            PIC X.
  1434                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1435                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1436                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1437                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  28
* EL6311.cbl
  1438                 24  AM-RETRO-LV-INDIC     PIC X.
  1439                 24  AM-GL-CODES           PIC X.
  1440                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1441                 24  FILLER                PIC X(01).
  1442         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1443             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1444                 24  FILLER                PIC X(11).
  1445                 24  AM-L-COMA             PIC XXX.
  1446                 24  AM-J-COMA             PIC XXX.
  1447                 24  AM-A-COMA             PIC XXX.
  1448                 24  FILLER                PIC X(6).
  1449
  1450     12  AM-COMM-CHANGE-STATUS             PIC X.
  1451         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1452
  1453     12  AM-CSR-CODE                       PIC X(4).
  1454
  1455     12  AM-BILLING-STATUS                 PIC X.
  1456         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1457         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1458     12  AM-AUTO-REFUND-SW                 PIC X.
  1459         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1460         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1461     12  AM-GPCD                           PIC 99.
  1462     12  AM-IG                             PIC X.
  1463         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1464         88  AM-HAS-GROUP                     VALUE '2'.
  1465     12  AM-STATUS                         PIC X.
  1466         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1467         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1468         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1469         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1470         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1471         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1472     12  AM-REMIT-TO                       PIC 99.
  1473     12  AM-ID-NO                          PIC X(11).
  1474
  1475     12  AM-CAL-TABLE                      PIC XX.
  1476     12  AM-LF-DEVIATION                   PIC XXX.
  1477     12  AM-AH-DEVIATION                   PIC XXX.
  1478     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1479     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1480     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1481     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1482     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1483     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1484
  1485     12  AM-USER-FIELDS.
  1486         16  AM-FLD-1                      PIC XX.
  1487         16  AM-FLD-2                      PIC XX.
  1488         16  AM-FLD-3                      PIC XX.
  1489         16  AM-FLD-4                      PIC XX.
  1490         16  AM-FLD-5                      PIC XX.
  1491
  1492     12  AM-1ST-PROD-DATE.
  1493         16  AM-1ST-PROD-YR                PIC XX.
  1494         16  AM-1ST-PROD-MO                PIC XX.
  1495         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  29
* EL6311.cbl
  1496     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1497     12  AM-CERTS-PURGED-DATE.
  1498         16  AM-PUR-YR                     PIC XX.
  1499         16  AM-PUR-MO                     PIC XX.
  1500         16  AM-PUR-DA                     PIC XX.
  1501     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1502     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1503     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1504     12  AM-INACTIVE-DATE.
  1505         16  AM-INA-MO                     PIC 99.
  1506         16  AM-INA-DA                     PIC 99.
  1507         16  AM-INA-YR                     PIC 99.
  1508     12  AM-AR-HI-CERT-DATE                PIC XX.
  1509
  1510     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1511     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1512
  1513     12  AM-OB-PAYMENT-MODE                PIC X.
  1514         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1515         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1516         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1517         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1518
  1519     12  AM-AH-ONLY-INDICATOR              PIC X.
  1520         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1521         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1522
  1523     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1524
  1525     12  AM-OVER-SHORT.
  1526         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1527         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1528
  1529     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1530     12  AM-DCC-CLP-STATE                  PIC XX.
  1531
  1532     12  AM-RECALC-COMM                    PIC X.
  1533     12  AM-RECALC-REIN                    PIC X.
  1534
  1535     12  AM-REI-TABLE                      PIC XXX.
  1536     12  AM-REI-ET-LF                      PIC X.
  1537     12  AM-REI-ET-AH                      PIC X.
  1538     12  AM-REI-PE-LF                      PIC X.
  1539     12  AM-REI-PE-AH                      PIC X.
  1540     12  AM-REI-PRT-ST                     PIC X.
  1541     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1542     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1543     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1544     12  AM-REI-GROUP-A                    PIC X(6).
  1545     12  AM-REI-MORT                       PIC X(4).
  1546     12  AM-REI-PRT-OW                     PIC X.
  1547     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1548     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1549     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1550     12  AM-REI-GROUP-B                    PIC X(6).
  1551
  1552     12  AM-TRUST-TYPE                     PIC X(2).
  1553
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  30
* EL6311.cbl
  1554     12  AM-EMPLOYER-STMT-USED             PIC X.
  1555     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1556
  1557     12  AM-STD-AH-TYPE                    PIC XX.
  1558     12  AM-EARN-METHODS.
  1559         16  AM-EARN-METHOD-R              PIC X.
  1560             88 AM-REF-RL-R78                 VALUE 'R'.
  1561             88 AM-REF-RL-PR                  VALUE 'P'.
  1562             88 AM-REF-RL-MEAN                VALUE 'M'.
  1563             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1564         16  AM-EARN-METHOD-L              PIC X.
  1565             88 AM-REF-LL-R78                 VALUE 'R'.
  1566             88 AM-REF-LL-PR                  VALUE 'P'.
  1567             88 AM-REF-LL-MEAN                VALUE 'M'.
  1568             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1569         16  AM-EARN-METHOD-A              PIC X.
  1570             88 AM-REF-AH-R78                 VALUE 'R'.
  1571             88 AM-REF-AH-PR                  VALUE 'P'.
  1572             88 AM-REF-AH-MEAN                VALUE 'M'.
  1573             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1574             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1575             88 AM-REF-AH-NET                 VALUE 'N'.
  1576
  1577     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1578     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1579     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1580
  1581     12  AM-RET-Y-N                        PIC X.
  1582     12  AM-RET-P-E                        PIC X.
  1583     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1584     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1585     12  AM-RET-GRP                        PIC X(6).
  1586     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1587         16  AM-POOL-PRIME                 PIC XXX.
  1588         16  AM-POOL-SUB                   PIC XXX.
  1589     12  AM-RETRO-EARNINGS.
  1590         16  AM-RET-EARN-R                 PIC X.
  1591         16  AM-RET-EARN-L                 PIC X.
  1592         16  AM-RET-EARN-A                 PIC X.
  1593     12  AM-RET-ST-TAX-USE                 PIC X.
  1594         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1595         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1596     12  AM-RETRO-BEG-EARNINGS.
  1597         16  AM-RET-BEG-EARN-R             PIC X.
  1598         16  AM-RET-BEG-EARN-L             PIC X.
  1599         16  AM-RET-BEG-EARN-A             PIC X.
  1600     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1601     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1602
  1603     12  AM-USER-SELECT-OPTIONS.
  1604         16  AM-USER-SELECT-1              PIC X(10).
  1605         16  AM-USER-SELECT-2              PIC X(10).
  1606         16  AM-USER-SELECT-3              PIC X(10).
  1607         16  AM-USER-SELECT-4              PIC X(10).
  1608         16  AM-USER-SELECT-5              PIC X(10).
  1609
  1610     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1611
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  31
* EL6311.cbl
  1612     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1613
  1614     12  AM-RPT045A-SWITCH                 PIC X.
  1615         88  RPT045A-OFF                   VALUE 'N'.
  1616
  1617     12  AM-INSURANCE-LIMITS.
  1618         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1619         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1620
  1621     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1622         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1623
  1624     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1625         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1626         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1627
  1628     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1629
  1630     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1631     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1632     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1633     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1634     12  AM-DCC-UEF-STATE                  PIC XX.
  1635     12  FILLER                            PIC XXX.
  1636     12  AM-REPORT-CODE-3                  PIC X(10).
  1637*    12  FILLER                            PIC X(22).
  1638
  1639     12  AM-RESERVE-DATE.
  1640         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1641         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1642         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1643
  1644     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1645     12  AM-NOTIFICATION-TYPES.
  1646         16  AM-NOTIF-OF-LETTERS           PIC X.
  1647         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1648         16  AM-NOTIF-OF-REPORTS           PIC X.
  1649         16  AM-NOTIF-OF-STATUS            PIC X.
  1650
  1651     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1652         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1653         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1654         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1655         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1656
  1657     12  AM-BENEFIT-CONTROLS.
  1658         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1659             20  AM-BENEFIT-CODE           PIC XX.
  1660             20  AM-BENEFIT-TYPE           PIC X.
  1661             20  AM-BENEFIT-REVISION       PIC XXX.
  1662             20  AM-BENEFIT-REM-TERM       PIC X.
  1663             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1664             20  FILLER                    PIC XX.
  1665         16  FILLER                        PIC X(80).
  1666
  1667     12  AM-TRANSFER-DATA.
  1668         16  AM-TRANSFERRED-FROM.
  1669             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  32
* EL6311.cbl
  1670             20  AM-TRNFROM-GROUPING.
  1671                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1672                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1673             20  AM-TRNFROM-STATE          PIC XX.
  1674             20  AM-TRNFROM-ACCOUNT.
  1675                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1676                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1677             20  AM-TRNFROM-DTE            PIC XX.
  1678         16  AM-TRANSFERRED-TO.
  1679             20  AM-TRNTO-CARRIER          PIC X.
  1680             20  AM-TRNTO-GROUPING.
  1681                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1682                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1683             20  AM-TRNTO-STATE            PIC XX.
  1684             20  AM-TRNTO-ACCOUNT.
  1685                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1686                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1687             20  AM-TRNTO-DTE              PIC XX.
  1688         16  FILLER                        PIC X(10).
  1689
  1690     12  AM-SAVED-REMIT-TO                 PIC 99.
  1691
  1692     12  AM-COMM-STRUCTURE-SAVED.
  1693         16  AM-DEFN-1-SAVED.
  1694             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1695                 24  AM-AGT-SV             PIC X(10).
  1696                 24  AM-COM-TYP-SV         PIC X.
  1697                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1698                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1699                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1700                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1701                 24  FILLER                PIC X.
  1702                 24  AM-GL-CODES-SV        PIC X.
  1703                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1704                 24  FILLER                PIC X.
  1705         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1706             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1707                 24  FILLER                PIC X(11).
  1708                 24  AM-L-COMA-SV          PIC XXX.
  1709                 24  AM-J-COMA-SV          PIC XXX.
  1710                 24  AM-A-COMA-SV          PIC XXX.
  1711                 24  FILLER                PIC X(6).
  1712
  1713     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1714         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1715            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1716            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1717            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1718
  1719     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1720     12  FILLER                            PIC X(120).
  1721
  1722     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1723         16  AM-CONTROL-NAME               PIC X(30).
  1724         16  AM-EXECUTIVE-ONE.
  1725             20  AM-EXEC1-NAME             PIC X(15).
  1726             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1727                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  33
* EL6311.cbl
  1728             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1729                                                          COMP-3.
  1730         16  AM-EXECUTIVE-TWO.
  1731             20  AM-EXEC2-NAME             PIC X(15).
  1732             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1733                                                          COMP-3.
  1734             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1735                                                          COMP-3.
  1736
  1737     12  AM-RETRO-ADDITIONAL-DATA.
  1738         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1739         16  AM-RETRO-PREM-P-E             PIC X.
  1740         16  AM-RETRO-CLMS-P-I             PIC X.
  1741         16  AM-RETRO-RET-BRACKET-LF.
  1742             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1743                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1744                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1745             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1746                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1747                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1748             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1749                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1750                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1751         16  AM-RETRO-RET-BRACKET-AH.
  1752             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1753                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1754                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1755                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1756             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1757                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1758                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1759             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1760                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1761                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1762
  1763     12  AM-COMMENTS.
  1764         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1765
  1766     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1767         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1768         16  AM-FLI-BILLING-CODE           PIC X.
  1769         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1770         16  AM-FLI-UNITED-IDENT           PIC X.
  1771         16  AM-FLI-INTEREST-LOST-DATA.
  1772             20  AM-FLI-BANK-NO            PIC X(5).
  1773             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1774             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1775             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1776         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1777             20  AM-FLI-AGT                PIC X(9).
  1778             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1779             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1780         16  FILLER                        PIC X(102).
  1781
  1782     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1783         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1784             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1785             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  34
* EL6311.cbl
  1786             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1787             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1788             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1789         16  FILLER                          PIC X(10).
  1790******************************************************************
  1791*                                COPY ELCVADS.
  1792******************************************************************
  1793*                                                                *
  1794*                                                                *
  1795*                            ELCVADS.                            *
  1796*                                                                *
  1797*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1798*   ELVADS                  LENGTH = 350                         *
  1799******************************************************************
  1800******************************************************************
  1801*                   C H A N G E   L O G
  1802*
  1803* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1804*-----------------------------------------------------------------
  1805*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1806* EFFECTIVE    NUMBER
  1807*-----------------------------------------------------------------
  1808* 100111    2011022800001  AJRA  NAPERSOFT
  1809******************************************************************
  1810
  1811 01  VIRGINIA-DISCLOSURE.
  1812     12  VD-COMPANY-CD              PIC X.
  1813     12  VD-CARRIER                 PIC X.
  1814     12  VD-GROUPING.
  1815         20  VD-GROUPING-PREFIX     PIC XXX.
  1816         20  VD-GROUPING-PRIME      PIC XXX.
  1817     12  VD-STATE                   PIC XX.
  1818     12  VD-ACCOUNT.
  1819         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1820         20  VD-ACCOUNT-PRIME       PIC X(6).
  1821     12  VD-CERT-EFF-DT             PIC XX.
  1822     12  VD-CERT-NO.
  1823         20  VD-CERT-PRIME          PIC X(10).
  1824         20  VD-CERT-SFX            PIC X.
  1825     12  VD-ENTRY-BATCH             PIC X(6).
  1826     12  VD-CSR-ID                  PIC X(4).
  1827     12  VD-NAME.
  1828         20  VD-INSURED-LAST-NAME   PIC X(15).
  1829         20  VD-INSURED-FIRST-NAME.
  1830             24  VD-INSURED-1ST-INIT PIC X.
  1831             24  FILLER             PIC X(9).
  1832         20  VD-INSURED-MIDDLE-INIT PIC X.
  1833     12  VD-JOINT-INSURED.
  1834         20 VD-JOINT-LAST-NAME      PIC X(15).
  1835         20 VD-JOINT-FIRST-NAME.
  1836            24  VD-JOINT-FIRST-INIT PIC X.
  1837            24  FILLER              PIC X(9).
  1838         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1839     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1840     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1841     12  VD-INSURED-CITY-STATE.
  1842         20  VD-INSURED-CITY        PIC X(28).
  1843         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  35
* EL6311.cbl
  1844     12  VD-INSURED-ZIP-CODE.
  1845         20  VD-INSURED-ZIP-PRIME.
  1846             24  VD-INSURED-ZIP-1   PIC X.
  1847                 88  VD-CANADIAN-POST-CODE
  1848                                       VALUE 'A' THRU 'Z'.
  1849             24  FILLER             PIC X(4).
  1850         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1851     12  VD-BENEFICIARY-NAME        PIC X(30).
  1852     12  VD-ACCOUNT-NAME            PIC X(30).
  1853     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1854     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1855     12  VD-1ST-PMT-DT              PIC XX.
  1856     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1857         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1858         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1859                                             '90' THRU '99'.
  1860     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1861                                    PIC XX.
  1862     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1863     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1864     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1865     12  VD-LF-TERM                 PIC S999   COMP-3.
  1866     12  VD-AH-BENEFIT-CD           PIC XX.
  1867         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1868         88  VD-INVALID-AH             VALUE '  ' '00'
  1869                                             '90' THRU '99'.
  1870     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1871     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1872     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1873     12  VD-AH-TERM                 PIC S999   COMP-3.
  1874     12  VD-LETTER-ID               PIC X(4).
  1875     12  VD-PROC-ID                 PIC X(4).
  1876     12  VD-COMP-ID                 PIC X(3).
  1877     12  VD-CURRENT-DATE            PIC XX.
  1878     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1879     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1880     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  36
* EL6311.cbl
  1882*    COPY ELCDATE.
  1883******************************************************************
  1884*                                                                *
  1885*                                                                *
  1886*                            ELCDATE.                            *
  1887*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1888*                            VMOD=2.003
  1889*                                                                *
  1890*                                                                *
  1891*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1892*                 LENGTH = 200                                   *
  1893******************************************************************
  1894
  1895 01  DATE-CONVERSION-DATA.
  1896     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1897     12  DC-OPTION-CODE                PIC X.
  1898         88  BIN-TO-GREG                VALUE ' '.
  1899         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1900         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1901         88  YMD-GREG-TO-BIN            VALUE '3'.
  1902         88  MDY-GREG-TO-BIN            VALUE '4'.
  1903         88  JULIAN-TO-BIN              VALUE '5'.
  1904         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1905         88  FIND-CENTURY               VALUE '7'.
  1906         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1907         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1908         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1909         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1910         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1911         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1912         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1913         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1914         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1915         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1916         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1917         88  BIN-3-TO-GREG              VALUE 'I'.
  1918         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1919         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1920         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1921         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1922         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1923         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1924         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1925         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1926         88  THREE-CHARACTER-BIN
  1927                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1928         88  GREGORIAN-TO-BIN
  1929                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1930         88  BIN-TO-GREGORIAN
  1931                  VALUES ' ' '1' 'I' '8' 'G'.
  1932         88  JULIAN-TO-BINARY
  1933                  VALUES '5' 'C' 'E' 'F'.
  1934     12  DC-ERROR-CODE                 PIC X.
  1935         88  NO-CONVERSION-ERROR        VALUE ' '.
  1936         88  DATE-CONVERSION-ERROR
  1937                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1938         88  DATE-IS-ZERO               VALUE '1'.
  1939         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  37
* EL6311.cbl
  1940         88  DATE-IS-INVALID            VALUE '3'.
  1941         88  DATE1-GREATER-DATE2        VALUE '4'.
  1942         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1943         88  DATE-INVALID-OPTION        VALUE '9'.
  1944         88  INVALID-CENTURY            VALUE 'A'.
  1945         88  ONLY-CENTURY               VALUE 'B'.
  1946         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1947         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1948     12  DC-END-OF-MONTH               PIC X.
  1949         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1950     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1951         88  USE-NORMAL-PROCESS         VALUE ' '.
  1952         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1953         88  ADJUST-UP-100-YRS          VALUE '2'.
  1954     12  FILLER                        PIC X.
  1955     12  DC-CONVERSION-DATES.
  1956         16  DC-BIN-DATE-1             PIC XX.
  1957         16  DC-BIN-DATE-2             PIC XX.
  1958         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1959         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1960                       DC-GREG-DATE-1-EDIT.
  1961             20  DC-EDIT1-MONTH        PIC 99.
  1962             20  SLASH1-1              PIC X.
  1963             20  DC-EDIT1-DAY          PIC 99.
  1964             20  SLASH1-2              PIC X.
  1965             20  DC-EDIT1-YEAR         PIC 99.
  1966         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1967         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1968                     DC-GREG-DATE-2-EDIT.
  1969             20  DC-EDIT2-MONTH        PIC 99.
  1970             20  SLASH2-1              PIC X.
  1971             20  DC-EDIT2-DAY          PIC 99.
  1972             20  SLASH2-2              PIC X.
  1973             20  DC-EDIT2-YEAR         PIC 99.
  1974         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1975         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1976                     DC-GREG-DATE-1-YMD.
  1977             20  DC-YMD-YEAR           PIC 99.
  1978             20  DC-YMD-MONTH          PIC 99.
  1979             20  DC-YMD-DAY            PIC 99.
  1980         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1981         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1982                      DC-GREG-DATE-1-MDY.
  1983             20  DC-MDY-MONTH          PIC 99.
  1984             20  DC-MDY-DAY            PIC 99.
  1985             20  DC-MDY-YEAR           PIC 99.
  1986         16  DC-GREG-DATE-1-ALPHA.
  1987             20  DC-ALPHA-MONTH        PIC X(10).
  1988             20  DC-ALPHA-DAY          PIC 99.
  1989             20  FILLER                PIC XX.
  1990             20  DC-ALPHA-CENTURY.
  1991                 24 DC-ALPHA-CEN-N     PIC 99.
  1992             20  DC-ALPHA-YEAR         PIC 99.
  1993         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1994         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1995         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1996         16  DC-JULIAN-DATE            PIC 9(05).
  1997         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  38
* EL6311.cbl
  1998                                       PIC 9(05).
  1999         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2000             20  DC-JULIAN-YEAR        PIC 99.
  2001             20  DC-JULIAN-DAYS        PIC 999.
  2002         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2003         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2004         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2005     12  DATE-CONVERSION-VARIBLES.
  2006         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2007         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2008             20  FILLER                PIC 9(3).
  2009             20  HOLD-CEN-1-CCYY.
  2010                 24  HOLD-CEN-1-CC     PIC 99.
  2011                 24  HOLD-CEN-1-YY     PIC 99.
  2012             20  HOLD-CEN-1-MO         PIC 99.
  2013             20  HOLD-CEN-1-DA         PIC 99.
  2014         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2015             20  HOLD-CEN-1-R-MO       PIC 99.
  2016             20  HOLD-CEN-1-R-DA       PIC 99.
  2017             20  HOLD-CEN-1-R-CCYY.
  2018                 24  HOLD-CEN-1-R-CC   PIC 99.
  2019                 24  HOLD-CEN-1-R-YY   PIC 99.
  2020             20  FILLER                PIC 9(3).
  2021         16  HOLD-CENTURY-1-X.
  2022             20  FILLER                PIC X(3)  VALUE SPACES.
  2023             20  HOLD-CEN-1-X-CCYY.
  2024                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2025                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2026             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2027             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2028         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2029             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2030             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2031             20  HOLD-CEN-1-R-X-CCYY.
  2032                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2033                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2034             20  FILLER                PIC XXX.
  2035         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2036         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2037         16  DC-JULIAN-DATE-1          PIC 9(07).
  2038         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2039             20  DC-JULIAN-1-CCYY.
  2040                 24  DC-JULIAN-1-CC    PIC 99.
  2041                 24  DC-JULIAN-1-YR    PIC 99.
  2042             20  DC-JULIAN-DA-1        PIC 999.
  2043         16  DC-JULIAN-DATE-2          PIC 9(07).
  2044         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2045             20  DC-JULIAN-2-CCYY.
  2046                 24  DC-JULIAN-2-CC    PIC 99.
  2047                 24  DC-JULIAN-2-YR    PIC 99.
  2048             20  DC-JULIAN-DA-2        PIC 999.
  2049         16  DC-GREG-DATE-A-EDIT.
  2050             20  DC-EDITA-MONTH        PIC 99.
  2051             20  SLASHA-1              PIC X VALUE '/'.
  2052             20  DC-EDITA-DAY          PIC 99.
  2053             20  SLASHA-2              PIC X VALUE '/'.
  2054             20  DC-EDITA-CCYY.
  2055                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  39
* EL6311.cbl
  2056                 24  DC-EDITA-YEAR     PIC 99.
  2057         16  DC-GREG-DATE-B-EDIT.
  2058             20  DC-EDITB-MONTH        PIC 99.
  2059             20  SLASHB-1              PIC X VALUE '/'.
  2060             20  DC-EDITB-DAY          PIC 99.
  2061             20  SLASHB-2              PIC X VALUE '/'.
  2062             20  DC-EDITB-CCYY.
  2063                 24  DC-EDITB-CENT     PIC 99.
  2064                 24  DC-EDITB-YEAR     PIC 99.
  2065         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2066         16  DC-GREG-DATE-CYMD-R REDEFINES
  2067                              DC-GREG-DATE-CYMD.
  2068             20  DC-CYMD-CEN           PIC 99.
  2069             20  DC-CYMD-YEAR          PIC 99.
  2070             20  DC-CYMD-MONTH         PIC 99.
  2071             20  DC-CYMD-DAY           PIC 99.
  2072         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2073         16  DC-GREG-DATE-MDCY-R REDEFINES
  2074                              DC-GREG-DATE-MDCY.
  2075             20  DC-MDCY-MONTH         PIC 99.
  2076             20  DC-MDCY-DAY           PIC 99.
  2077             20  DC-MDCY-CEN           PIC 99.
  2078             20  DC-MDCY-YEAR          PIC 99.
  2079    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2080        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2081    12  DC-EL310-DATE                  PIC X(21).
  2082    12  FILLER                         PIC X(28).
  2083
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  40
* EL6311.cbl
  2085*    COPY ELCLOGOF.
  2086******************************************************************
  2087*                                                                *
  2088*                                                                *
  2089*                            ELCLOGOF.                           *
  2090*                            VMOD=2.001                          *
  2091*                                                                *
  2092*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2093*                                                                *
  2094******************************************************************
  2095 01  CLASIC-LOGOFF.
  2096     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2097     12  LOGOFF-TEXT.
  2098         16  FILLER          PIC X(5)    VALUE SPACES.
  2099         16  LOGOFF-MSG.
  2100             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2101             20  FILLER      PIC X       VALUE SPACES.
  2102             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2103         16  FILLER          PIC X(80)
  2104           VALUE '* YOU ARE NOW LOGGED OFF'.
  2105         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2106         16  FILLER          PIC X       VALUE QUOTE.
  2107         16  LOGOFF-SYS-MSG  PIC X(17)
  2108           VALUE 'S CLAS-IC SYSTEM '.
  2109     12  TEXT-MESSAGES.
  2110         16  UNACCESS-MSG    PIC X(29)
  2111             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2112         16  PGMIDERR-MSG    PIC X(17)
  2113             VALUE 'PROGRAM NOT FOUND'.
  2114
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  41
* EL6311.cbl
  2116*    COPY ELCATTR.
  2117******************************************************************
  2118*                                                                *
  2119*                            ELCATTR.                            *
  2120*                            VMOD=2.001                          *
  2121*                                                                *
  2122*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2123*                                                                *
  2124*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2125*                                                                *
  2126*                   POS 1   P=PROTECTED                          *
  2127*                           U=UNPROTECTED                        *
  2128*                           S=ASKIP                              *
  2129*                   POS 2   A=ALPHA/NUMERIC                      *
  2130*                           N=NUMERIC                            *
  2131*                   POS 3   N=NORMAL                             *
  2132*                           B=BRIGHT                             *
  2133*                           D=DARK                               *
  2134*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2135*                           OF=MODIFIED DATA TAG OFF             *
  2136*                                                                *
  2137*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2138******************************************************************
  2139 01  ATTRIBUTE-LIST.
  2140     12  AL-PABOF            PIC X       VALUE 'Y'.
  2141     12  AL-PABON            PIC X       VALUE 'Z'.
  2142     12  AL-PADOF            PIC X       VALUE '%'.
  2143     12  AL-PADON            PIC X       VALUE '_'.
  2144     12  AL-PANOF            PIC X       VALUE '-'.
  2145     12  AL-PANON            PIC X       VALUE '/'.
  2146     12  AL-SABOF            PIC X       VALUE '8'.
  2147     12  AL-SABON            PIC X       VALUE '9'.
  2148     12  AL-SADOF            PIC X       VALUE '@'.
  2149     12  AL-SADON            PIC X       VALUE QUOTE.
  2150     12  AL-SANOF            PIC X       VALUE '0'.
  2151     12  AL-SANON            PIC X       VALUE '1'.
  2152     12  AL-UABOF            PIC X       VALUE 'H'.
  2153     12  AL-UABON            PIC X       VALUE 'I'.
  2154     12  AL-UADOF            PIC X       VALUE '<'.
  2155     12  AL-UADON            PIC X       VALUE '('.
  2156     12  AL-UANOF            PIC X       VALUE ' '.
  2157     12  AL-UANON            PIC X       VALUE 'A'.
  2158     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2159     12  AL-UNBON            PIC X       VALUE 'R'.
  2160     12  AL-UNDOF            PIC X       VALUE '*'.
  2161     12  AL-UNDON            PIC X       VALUE ')'.
  2162     12  AL-UNNOF            PIC X       VALUE '&'.
  2163     12  AL-UNNON            PIC X       VALUE 'J'.
  2164
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  42
* EL6311.cbl
  2166*    COPY ELCEMIB.
  2167******************************************************************
  2168*                                                                *
  2169*                                                                *
  2170*                            ELCEMIB.                            *
  2171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2172*                            VMOD=2.005                          *
  2173*                                                                *
  2174*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2175*                                                                *
  2176******************************************************************
  2177 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2178     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2179     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2180     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2181     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2182     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2183     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2184     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2185     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2186     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2187         88  EMI-NO-ERRORS                    VALUE '1'.
  2188         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2189         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2190     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2191         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2192     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2193         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2194         88  EMI-AREA1-FULL                   VALUE '2'.
  2195     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2196         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2197         88  EMI-AREA2-FULL                   VALUE '2'.
  2198     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2199         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2200         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2201         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2202         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2203         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2204     12  EMI-ERROR-LINES.
  2205         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2206         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2207         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2208         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2209             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2210                 24  EMI-ERR-NUM         PIC X(4).
  2211                 24  EMI-FILLER          PIC X.
  2212                 24  EMI-SEV             PIC X.
  2213                 24  FILLER              PIC X.
  2214             20  FILLER                  PIC X(02).
  2215     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2216         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2217             20  EMI-ERROR-NUMBER    PIC X(4).
  2218             20  EMI-FILL            PIC X.
  2219             20  EMI-SEVERITY        PIC X.
  2220             20  FILLER              PIC X.
  2221             20  EMI-ERROR-TEXT.
  2222                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2223                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  43
* EL6311.cbl
  2224     12  EMI-SEVERITY-SAVE           PIC X.
  2225         88  EMI-NOTE                    VALUE 'N'.
  2226         88  EMI-WARNING                 VALUE 'W'.
  2227         88  EMI-FORCABLE                VALUE 'F'.
  2228         88  EMI-FATAL                   VALUE 'X'.
  2229     12  EMI-MESSAGE-FLAG            PIC X.
  2230         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2231         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2232     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2233     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2234         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2235         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2236         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2237     12  emi-claim-no                pic x(7).
  2238     12  emi-claim-type              pic x(6).
  2239     12  FILLER                      PIC X(124)  VALUE SPACES.
  2240     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2241     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2242     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2243     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2244
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  44
* EL6311.cbl
  2246*    COPY ELCINTF.
  2247******************************************************************
  2248*                                                                *
  2249*                                                                *
  2250*                            ELCINTF.                            *
  2251*                            VMOD=2.017                          *
  2252*                                                                *
  2253*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2254*                                                                *
  2255*       LENGTH = 1024                                            *
  2256*                                                                *
  2257******************************************************************
  2258*                   C H A N G E   L O G
  2259*
  2260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2261*-----------------------------------------------------------------
  2262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2263* EFFECTIVE    NUMBER
  2264*-----------------------------------------------------------------
  2265* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2266******************************************************************
  2267 01  PROGRAM-INTERFACE-BLOCK.
  2268     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2269     12  PI-CALLING-PROGRAM              PIC X(8).
  2270     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2271     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2272     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2273     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2274     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2275     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2276     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2277     12  PI-COMPANY-ID                   PIC XXX.
  2278     12  PI-COMPANY-CD                   PIC X.
  2279
  2280     12  PI-COMPANY-PASSWORD             PIC X(8).
  2281
  2282     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2283
  2284     12  PI-CONTROL-IN-PROGRESS.
  2285         16  PI-CARRIER                  PIC X.
  2286         16  PI-GROUPING                 PIC X(6).
  2287         16  PI-STATE                    PIC XX.
  2288         16  PI-ACCOUNT                  PIC X(10).
  2289         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2290                                         PIC X(10).
  2291         16  PI-CLAIM-CERT-GRP.
  2292             20  PI-CLAIM-NO             PIC X(7).
  2293             20  PI-CERT-NO.
  2294                 25  PI-CERT-PRIME       PIC X(10).
  2295                 25  PI-CERT-SFX         PIC X.
  2296             20  PI-CERT-EFF-DT          PIC XX.
  2297         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2298             20  PI-PLAN-CODE            PIC X(2).
  2299             20  PI-REVISION-NUMBER      PIC X(3).
  2300             20  PI-PLAN-EFF-DT          PIC X(2).
  2301             20  PI-PLAN-EXP-DT          PIC X(2).
  2302             20  FILLER                  PIC X(11).
  2303         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  45
* EL6311.cbl
  2304             20  PI-OE-REFERENCE-1.
  2305                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2306                 25  PI-OE-REF-1-SUFF    PIC XX.
  2307
  2308     12  PI-SESSION-IN-PROGRESS          PIC X.
  2309         88  CLAIM-SESSION                   VALUE '1'.
  2310         88  CREDIT-SESSION                  VALUE '2'.
  2311         88  WARRANTY-SESSION                VALUE '3'.
  2312         88  MORTGAGE-SESSION                VALUE '4'.
  2313         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2314
  2315
  2316*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2317
  2318     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2319     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2320
  2321     12  PI-CREDIT-USER                  PIC X.
  2322         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2323         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2324
  2325     12  PI-CLAIM-USER                   PIC X.
  2326         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2327         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2328
  2329     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2330         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2331         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2332         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2333         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2334         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2335
  2336     12  PI-PROCESSOR-ID                 PIC X(4).
  2337
  2338     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2339
  2340     12  PI-MEMBER-CAPTION               PIC X(10).
  2341
  2342     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2343         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2344
  2345     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2346     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2347     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2348     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2349
  2350     12  PI-AH-OVERRIDE-L1               PIC X.
  2351     12  PI-AH-OVERRIDE-L2               PIC XX.
  2352     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2353     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2354
  2355     12  PI-NEW-SYSTEM                   PIC X(2).
  2356
  2357     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2358     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2359         88  PI-USES-PAID-TO                 VALUE '1'.
  2360     12  PI-CRDTCRD-SYSTEM.
  2361         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  46
* EL6311.cbl
  2362             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2363             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2364         16  PI-CC-MONTH-END-DT          PIC XX.
  2365     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2366
  2367     12  PI-OE-REFERENCE-2.
  2368         16  PI-OE-REF-2-PRIME           PIC X(10).
  2369         16  PI-OE-REF-2-SUFF            PIC X.
  2370
  2371     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2372
  2373     12  PI-LANGUAGE-TYPE                PIC X.
  2374             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2375             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2376             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2377
  2378     12  PI-POLICY-LINKAGE-IND           PIC X.
  2379         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2380         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2381                                                   LOW-VALUES.
  2382
  2383     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2384     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2385         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2386         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2387
  2388     12  PI-PROCESSOR-CSR-IND            PIC X.
  2389         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2390         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2391
  2392     12  FILLER                          PIC X(3).
  2393
  2394     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2395
  2396     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2397         PI-SYSTEM-LEVEL.
  2398
  2399         16  PI-ENTRY-CODES.
  2400             20  PI-ENTRY-CD-1           PIC X.
  2401             20  PI-ENTRY-CD-2           PIC X.
  2402
  2403         16  PI-RETURN-CODES.
  2404             20  PI-RETURN-CD-1          PIC X.
  2405             20  PI-RETURN-CD-2          PIC X.
  2406
  2407         16  PI-UPDATE-STATUS-SAVE.
  2408             20  PI-UPDATE-BY            PIC X(4).
  2409             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2410
  2411         16  PI-LOWER-CASE-LETTERS       PIC X.
  2412             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2413
  2414*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2415*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2416*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2417
  2418         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2419             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  47
* EL6311.cbl
  2420             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2421             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2422             88  ACCNT-CNTL                  VALUE '3'.
  2423             88  CARR-ACCNT-CNTL             VALUE '4'.
  2424
  2425         16  PI-PROCESSOR-CAP-LIST.
  2426             20  PI-SYSTEM-CONTROLS.
  2427                24 PI-SYSTEM-DISPLAY     PIC X.
  2428                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2429                24 PI-SYSTEM-MODIFY      PIC X.
  2430                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2431             20  FILLER                  PIC XX.
  2432             20  PI-DISPLAY-CAP          PIC X.
  2433                 88  DISPLAY-CAP             VALUE 'Y'.
  2434             20  PI-MODIFY-CAP           PIC X.
  2435                 88  MODIFY-CAP              VALUE 'Y'.
  2436             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2437                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2438             20  PI-FORCE-CAP            PIC X.
  2439                 88  FORCE-CAP               VALUE 'Y'.
  2440
  2441         16  PI-PROGRAM-CONTROLS.
  2442             20  PI-PGM-PRINT-OPT        PIC X.
  2443             20  PI-PGM-FORMAT-OPT       PIC X.
  2444             20  PI-PGM-PROCESS-OPT      PIC X.
  2445             20  PI-PGM-TOTALS-OPT       PIC X.
  2446
  2447         16  PI-HELP-INTERFACE.
  2448             20  PI-LAST-ERROR-NO        PIC X(4).
  2449             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2450
  2451         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2452             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2453
  2454         16  PI-CR-CONTROL-IN-PROGRESS.
  2455             20  PI-CR-CARRIER           PIC X.
  2456             20  PI-CR-GROUPING          PIC X(6).
  2457             20  PI-CR-STATE             PIC XX.
  2458             20  PI-CR-ACCOUNT           PIC X(10).
  2459             20  PI-CR-FIN-RESP          PIC X(10).
  2460             20  PI-CR-TYPE              PIC X.
  2461
  2462         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2463
  2464         16  PI-CR-MONTH-END-DT          PIC XX.
  2465
  2466         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2467             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2468             88  PI-ZERO-CARRIER             VALUE '1'.
  2469             88  PI-ZERO-GROUPING            VALUE '2'.
  2470             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2471
  2472         16  PI-CARRIER-SECURITY         PIC X.
  2473             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2474
  2475         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2476             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2477             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  48
* EL6311.cbl
  2478
  2479         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2480             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2481                                         INDEXED BY PI-ACCESS-NDX
  2482                                         PIC X.
  2483
  2484         16  PI-GA-BILLING-CONTROL       PIC X.
  2485             88  PI-GA-BILLING               VALUE '1'.
  2486
  2487         16  PI-MAIL-PROCESSING          PIC X.
  2488             88  PI-MAIL-YES                 VALUE 'Y'.
  2489
  2490         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2491
  2492         16  PI-AR-SYSTEM.
  2493             20  PI-AR-PROCESSING-CNTL   PIC X.
  2494                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2495             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2496             20  PI-AR-MONTH-END-DT      PIC XX.
  2497
  2498         16  PI-MP-SYSTEM.
  2499             20  PI-MORTGAGE-USER            PIC X.
  2500                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2501                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2502             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2503                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2504                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2505                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2506                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2507                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2508             20  PI-MP-MONTH-END-DT          PIC XX.
  2509             20  PI-MP-REFERENCE-NO.
  2510                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2511                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2512
  2513         16  PI-LABEL-CONTROL            PIC X(01).
  2514             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2515             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2516
  2517         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2518             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2519
  2520         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2521             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2522             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2523
  2524         16  FILLER                      PIC X(14).
  2525
  2526     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2527******************************************************************
  2528
  2529     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2530*    COPY ELC631PI.
  2531******************************************************************
  2532*                                                                *
  2533*                                                                *
  2534*                            ELC631PI                            *
  2535*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  49
* EL6311.cbl
  2536*                                                                *
  2537*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2538*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2539*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2540*                                                                *
  2541*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2542*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2543*    BETWEEN PROGRAMS.                                           *
  2544*                                                                *
  2545*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2546*                                                                *
  2547*               EL631 - EL6311 - EL6312 - EL6313                 *
  2548*                                                                *
  2549******************************************************************
  2550*                   C H A N G E   L O G
  2551*
  2552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2553*-----------------------------------------------------------------
  2554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2555* EFFECTIVE    NUMBER
  2556*-----------------------------------------------------------------
  2557* 021414    2003053000001  PEMA  changes for auto chk request
  2558******************************************************************
  2559
  2560         16  PI-631-DATA.
  2561             20  PI-ERPNDB-KEY.
  2562                 24  PI-PB-COMPANY-CD     PIC X.
  2563                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2564                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2565                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2566
  2567             20  PI-ERPNDB-ALT-KEY.
  2568                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2569                 24  PI-PB-CARRIER        PIC X.
  2570                 24  PI-PB-GROUPING       PIC X(6).
  2571                 24  PI-PB-STATE          PIC XX.
  2572                 24  PI-PB-ACCOUNT        PIC X(10).
  2573                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2574                 24  PI-PB-CERT-NO.
  2575                     28  PI-PB-CERT-PRIME PIC X(10).
  2576                     28  PI-PB-CERT-SFX   PIC X.
  2577                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2578                 24  PI-PB-RECORD-TYPE    PIC X.
  2579
  2580             20  PI-ERPNDB-CSR-KEY.
  2581                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2582                 24  PI-PB-CSR-ID             PIC X(4).
  2583                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2584                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2585                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2586
  2587             20  PI-BROWSE-TYPE               PIC X.
  2588                 88  PI-FILE-BROWSE             VALUE ' '.
  2589                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2590                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2591                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2592                 88  PI-CSR-BROWSE              VALUE '4'.
  2593
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  50
* EL6311.cbl
  2594             20  PI-MAINT-FUNCTION            PIC X.
  2595                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2596                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2597                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2598                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2599                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2600                 88  PI-PF5-FUNCTION            VALUE '5'.
  2601                 88  PI-PF6-FUNCTION            VALUE '6'.
  2602
  2603             20  PI-FILE-SWITCHES.
  2604                 24  PI-ALL-ISSUES-SW         PIC X.
  2605                     88  ALL-ISSUES             VALUE 'Y'.
  2606                 24  PI-ALL-CANCELS-SW        PIC X.
  2607                     88  ALL-CANCELS            VALUE 'Y'.
  2608                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2609                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2610                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2611                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2612                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2613                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2614                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2615                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2616                 24  PI-HOLD-REC-SW           PIC X.
  2617                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2618                 24  PI-CHANGE-REC-SW         PIC X.
  2619                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2620                 24  PI-CHK-REQ-REC-SW        PIC X.
  2621                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2622                 24  PI-ISSUE-WARNING-SW      PIC X.
  2623                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2624                 24  PI-CANCEL-WARNING-SW     PIC X.
  2625                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2626             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2627                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2628             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2629                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2630
  2631             20  PI-MAP-NAME                  PIC X(8).
  2632
  2633             20  PI-CURSOR                    PIC S9(4) COMP.
  2634
  2635             20  PI-PREV-ALT-KEY              PIC X(36).
  2636             20  PI-PREV-CSR-KEY              PIC X(15).
  2637             20  PI-PREV-KEY.
  2638                 24  PI-PREV-COMPANY-CD       PIC X.
  2639                 24  PI-PREV-BATCH            PIC X(6).
  2640                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2641                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2642             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2643             20  PI-BROWSE-SW                 PIC X.
  2644                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2645                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2646             20  PI-SV-CARRIER                PIC X.
  2647             20  PI-SV-GROUPING               PIC X(6).
  2648             20  PI-SV-STATE                  PIC XX.
  2649             20  PI-EDIT-SW                   PIC X.
  2650             20  PI-DISPLAY-SW                PIC XX.
  2651                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  51
* EL6311.cbl
  2652                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2653             20  PI-CRITERIA-DATA             PIC X(350).
  2654             20  PI-BMODE                     PIC X.
  2655             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2656             20  PI-BPMTS                     PIC S999     COMP-3.
  2657             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2658             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2659             20  PI-CSR-SESSION-SW            PIC X.
  2660                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2661             20  PI-ERRORS-SW                 PIC X.
  2662                 88  FATAL-ERRORS               VALUE 'X'.
  2663*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2664             20  pi-unforced-sw               pic x.
  2665                 88  unforced-errors            value 'X'.
  2666             20  FILLER                       PIC X(4).
  2667
  2668        16  FILLER             PIC X(94).
  2669
  2670 01  W-LETTER-COMMUNICATION-AREAS.
  2671*    COPY ELC1042.
  2672******************************************************************
  2673*                                                                *
  2674*                                                                *
  2675*                           ELC1042                              *
  2676*                            VMOD=2.002                          *
  2677*                                                                *
  2678*    NOTE                                                        *
  2679*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2680*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2681*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2682*        TO THESE PROGRAMS.                                      *
  2683*                                                                *
  2684*    NOTE                                                        *
  2685*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2686*        USE ONLY!                                               *
  2687*                                                                *
  2688******************************************************************
  2689
  2690         16  PI-1042-WA.
  2691             20  PI-ACTION       PIC  X(01).
  2692                 88 PI-SHOW-MODE           VALUE '1'.
  2693                 88 PI-CLEAR-MODE          VALUE '2'.
  2694                 88 PI-CREATE-MODE         VALUE '3'.
  2695             20  PI-COMM-CONTROL PIC  X(12).
  2696             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2697             20  PI-EOF-SW       PIC  X(01).
  2698                 88  PI-FILE-EOF           VALUE 'Y'.
  2699             20  PI-FILETYP      PIC  X(01).
  2700             20  PI-FORM-SQUEEZE-CONTROL
  2701                                 PIC  X(01).
  2702                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2703                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2704             20  PI-LAST-CONTROL PIC  X(12).
  2705             20  PI-TEMP-STOR-ITEMS
  2706                                 PIC S9(04) COMP.
  2707             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2708             20  PI-UPDATE-SW    PIC  9(01).
  2709                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  52
* EL6311.cbl
  2710             20  PI-104-SCREEN-SENT-IND
  2711                                 PIC  X(01).
  2712                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2713                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2714             20  PI-1042-SCREEN-SENT-IND
  2715                                 PIC  X(01).
  2716                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2717                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2718             20  PI-1042-ARCHIVE-IND
  2719                                 PIC  X(01).
  2720                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2721             20  FILLER          PIC  X(29).
  2722*    COPY ELC689PI.
  2723******************************************************************
  2724*                                                                *
  2725*                            ELC689PI                            *
  2726*                            VMOD=2.003                          *
  2727*                                                                *
  2728*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2729*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2730*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2731*                                                                *
  2732*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2733*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2734*    BETWEEN PROGRAMS.                                           *
  2735*                                                                *
  2736*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2737*                                                                *
  2738*               EL631 - EL689  - EL6891 - EL6892                 *
  2739*                                                                *
  2740******************************************************************
  2741*                   C H A N G E   L O G
  2742*
  2743* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2744*-----------------------------------------------------------------
  2745*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2746* EFFECTIVE    NUMBER
  2747*-----------------------------------------------------------------
  2748* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2749* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2750* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2751******************************************************************
  2752
  2753
  2754         16  PI-689-WORK-AREA.
  2755             20  PI-689-ALT-PRINTER-ID
  2756                                 PIC  X(04).
  2757             20  PI-689-ARCHIVE-NUMBER
  2758                                 PIC  9(08).
  2759             20  PI-689-ARCHIVE-SW
  2760                                 PIC  X(01).
  2761                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2762             20  PI-689-DATA-SOURCE
  2763                                 PIC  X(01).
  2764                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2765                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2766                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2767                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  53
* EL6311.cbl
  2768                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2769             20  PI-689-ERROR-IND
  2770                                 PIC  X(01).
  2771                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2772             20  PI-689-ERROR    PIC  9(04).
  2773                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2774                 88  PI-689-FATAL-ERROR
  2775                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2776                            0042 0047 0051 0066 0067 0070
  2777                            0168 0169 0174 0175 0176 0177 0179
  2778                            0180 0181 0182 0184 0185 0189 0190
  2779                            0191
  2780                            0215 0279 0280
  2781                            0412 0413 0454
  2782                            0533 0537
  2783                            2055 2114 2208 2209 2216 2232 2369
  2784                            2398 2433 2908 2999
  2785                            3000 3770 3771 3775
  2786                            7250 7365 7367 7368 7369 7370 7371
  2787                            7272 7373 7374 7376 7377 7378 7379
  2788                            7381 7388 7390 7393 7395 7396 7398
  2789                            9095 9096 9281 9298 9299 9320 9327
  2790                            9426 9427.
  2791                 88  PI-689-STOP-ERROR
  2792                     VALUES 0004 0008 0013 0023 0029 0033
  2793                            0042 0047 0066 0067 0070
  2794                            0168 0169 0174 0175 0176 0177
  2795                            0181 0182 0184 0185 0189 0190
  2796                            0279 0280
  2797                            0412 0413 0454
  2798                            2055 2208 2209 2216 2232
  2799                            2398 2999
  2800                            3000 3770 3771 3775
  2801                            7250 7365 7369 7370 7371
  2802                            7272 7373 7374 7376 7377 7378 7379
  2803                            7381 7388 7390 7393 7396 7398
  2804                            9095 9096 9299 9320 9426.
  2805             20  PI-689-FOLLOW-UP-DATE
  2806                                 PIC  X(02).
  2807             20  PI-689-FORM-NUMBER
  2808                                 PIC  X(04).
  2809             20  PI-689-LABEL-SOURCE
  2810                                 PIC X(01).
  2811                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2812                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2813                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2814                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2815                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2816                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2817                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2818             20  PI-689-NUMBER-COPIES
  2819                                 PIC  9(01).
  2820             20  PI-689-NUMBER-LABEL-LINES
  2821                                 PIC  9(01).
  2822             20  PI-689-NUMBER-TEXT-RECORDS
  2823                                 PIC  9(03).
  2824             20  PI-689-PRINT-ORDER-SW
  2825                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  54
* EL6311.cbl
  2826                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2827                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2828                 88  PI-689-PRINT-LATER     VALUE '3'.
  2829                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2830             20  PI-689-PRINT-RESTRICTION
  2831                                 PIC  X(01).
  2832                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2833                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2834                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2835             20  PI-689-PRINT-SW PIC  X(01).
  2836                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2837             20  PI-689-RESEND-DATE-1
  2838                                 PIC  X(02).
  2839             20  PI-689-RESEND-LETR-1
  2840                                 PIC X(4).
  2841             20  PI-689-TEMP-STOR-ID
  2842                                 PIC  X(08).
  2843             20  PI-689-USE-SCREEN-IND
  2844                                 PIC  X(01).
  2845                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2846             20  PI-689-ARCH-POINTER
  2847                                 PIC S9(08) COMP.
  2848                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2849             20  PI-689-ARCT-POINTER
  2850                                 PIC S9(08) COMP.
  2851                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2852             20  PI-689-VARIABLE-DATA-GRP.
  2853                 24  PI-689-VARIABLE-DATA-1
  2854                                 PIC  X(30).
  2855                 24  PI-689-VARIABLE-DATA-2
  2856                                 PIC  X(30).
  2857                 24  PI-689-VARIABLE-DATA-3
  2858                                 PIC  X(30).
  2859                 24  PI-689-VARIABLE-DATA-4
  2860                                 PIC  X(30).
  2861
  2862         16  PI-689-KEY-DATA-FIELDS.
  2863             20  PI-689-ACCOUNT  PIC  X(10).
  2864             20  PI-689-CARRIER  PIC  X(01).
  2865             20  PI-689-CERT-NO.
  2866                 24  PI-689-CERT-PRIME
  2867                                 PIC  X(10).
  2868                 24  PI-689-CERT-SFX
  2869                                 PIC  X(01).
  2870             20  PI-689-CHG-SEQ-NO
  2871                                 PIC S9(04)    COMP.
  2872             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2873                                 PIC  X(02).
  2874             20  PI-689-ENTRY-BATCH
  2875                                 PIC  X(06).
  2876             20  PI-689-EFF-DATE PIC  X(02).
  2877             20  PI-689-EXP-DATE PIC  X(02).
  2878             20  PI-689-GROUPING PIC  X(06).
  2879             20  PI-689-RESP-PERSON
  2880                                 PIC  X(10).
  2881             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2882             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2883                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  55
* EL6311.cbl
  2884             20  PI-689-STATE    PIC  X(02).
  2885             20  PI-689-TYPE     PIC  X(01).
  2886             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2887             20  PI-689-ALT-SEQ-NO
  2888                                 PIC S9(04)    COMP.
  2889         16  PI-689-DATE-EDIT    PIC  X(08).
  2890         16  PI-689-FOLLOW-UP-EDIT
  2891                                 PIC  X(08).
  2892         16  PI-689-RESEND1-EDIT PIC  X(08).
  2893         16  PI-689-SEQ-EDIT     PIC  X(08).
  2894         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2895         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2896             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2897         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2898         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  56
* EL6311.cbl
  2900
  2901 01  WS-EL6315-PASS-AREA.
  2902        16  PI-6315-ISS-CAN-SW      PIC X.
  2903        16  FILLER                  PIC X(120).
  2904        16  PI-RES-REF-CLM-TYPE     PIC X.
  2905        16  FILLER                  PIC X.
  2906        16  PI-6315-PASS-AREA.
  2907            20 FILLER               PIC X(236).
  2908            20 PI-6315-FINALIZED    PIC X.
  2909            20 FILLER               PIC X(280).
  2910
  2911 01  WS-EL6316-PASS-AREA.
  2912        16  PI-ISS-CAN-SW           PIC X.
  2913        16  FILLER                  PIC X(121).
  2914        16  PI-CLM-RESC-IND         PIC X.
  2915        16  PI-6316-PASS-AREA.
  2916            20 FILLER               PIC X(236).
  2917            20 PI-6316-FINALIZED    PIC X.
  2918            20 FILLER               PIC X(280).
  2919
  2920******************************************************************
  2921*                                                                *
  2922*         P A S S   A R E A   F O R   E D I T                    *
  2923*                                                                *
  2924******************************************************************
  2925
  2926 01  PASSED-RECORD.
  2927     12  RECORD-SAVE                  PIC X(585).
  2928* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2929*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2930*                    BY  WK-CURRENT-DATE.
  2931******************************************************************
  2932*                                                                *
  2933*                                                                *
  2934*                             ELC50W1                            *
  2935*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2936*                            VMOD=2.004                          *
  2937*                                                                *
  2938*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2939*                                                                *
  2940*                                                                *
  2941******************************************************************
  2942
  2943     12  WK-WORK-AREA.
  2944         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2945         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2946         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2947         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2948         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2949         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2950         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2951         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2952         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2953         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2954         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2955         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2956         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2957         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  57
* EL6311.cbl
  2958         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2959         16  WK-CREDIT-EDIT-CONTROLS.
  2960             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2961             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2962             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2963             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2964             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2965             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2966         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2967         16  WK-SAVE-REIN-DATA.
  2968             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2969             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2970             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2971         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2972             88  ENTRY-FROM-EL6311       VALUE '6'.
  2973         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2974         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2975     12  WK-RECORD-ADDRESSES.
  2976         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2977         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2978         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2979         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2980         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2981         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2982         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2983         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2984     12  WK-OVER-SHORT-AREA.
  2985         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2986         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2987         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2988             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2989         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  58
* EL6311.cbl
  2991
  2992*    COPY ELCEDITC.
  2993******************************************************************
  2994*                                                                *
  2995*                                                                *
  2996*                            ELCEDITC                            *
  2997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2998*                            VMOD=2.012                          *
  2999*                                                                *
  3000*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3001*                     EL6313, EL050 AND EL517.                   *
  3002*                                                                *
  3003******************************************************************
  3004******************************************************************
  3005*                   C H A N G E   L O G
  3006*
  3007* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3008*-----------------------------------------------------------------
  3009*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3010* EFFECTIVE    NUMBER
  3011*-----------------------------------------------------------------
  3012* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3013******************************************************************
  3014
  3015     12  EDIT-CRITERIA-DATA.
  3016         16  EC-CO-MONTH-END-DT       PIC XX.
  3017         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3018         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3019         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3020         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3021         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3022         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3023         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3024         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3025         16  EC-CO-REM-TERM-CALC      PIC X.
  3026               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3027               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3028               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3029               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3030
  3031         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3032               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3033               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3034               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3035               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3036               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3037               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3038               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3039               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3040               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3041               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3042
  3043         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3044               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3045               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3046               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3047               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3048               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  59
* EL6311.cbl
  3049               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3050               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3051               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3052
  3053         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3054                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3055                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3056
  3057         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3058                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3059                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3060                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3061                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3062                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3063                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3064                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3065                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3066
  3067         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3068               88  EC-BR-REDUCING                   VALUE 'R'.
  3069               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3070
  3071         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3072         16  EC-BR-LF-DESC             PIC X(10).
  3073         16  EC-BR-AH-DESC             PIC X(10).
  3074         16  EC-BR-LF-COMMENT          PIC X(10).
  3075         16  EC-BR-AH-COMMENT          PIC X(10).
  3076
  3077         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3078               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3079               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3080               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3081               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3082
  3083         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3084               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3085               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3086               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3087               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3088
  3089         16  EC-BR-LF-REFUND-CALC      PIC X.
  3090                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3091                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3092                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3093                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3094                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3095                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3096                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3097
  3098         16  EC-BR-AH-REFUND-CALC      PIC X.
  3099                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3100                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3101                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3102                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3103                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3104                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3105                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3106                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  60
* EL6311.cbl
  3107
  3108         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3109                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3110                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3111                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3112
  3113         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3114                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3115                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3116                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3117
  3118         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3119         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3120         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3121         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3122
  3123         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3124         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3125                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3126                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3127                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3128                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3129
  3130         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3131               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3132               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3133               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3134               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3135               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3136
  3137         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3138               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3139               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3140               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3141               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3142               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3143
  3144         16  EC-ST-LF-REFUND-CALC      PIC X.
  3145                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3146                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3147                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3148                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3149                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3150                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3151                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3152                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3153
  3154         16  EC-ST-AH-REFUND-CALC      PIC X.
  3155                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3156                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3157                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3158                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3159                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3160                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3161                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3162                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3163
  3164         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  61
* EL6311.cbl
  3165         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3166         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3167         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3168         16  EC-AM-EXPIRATION-DT       PIC XX.
  3169         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3170         16  EC-AM-CLASS-CD            PIC XX.
  3171         16  EC-AM-LF-DEVIATION        PIC XXX.
  3172         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3173         16  EC-AM-AH-DEVIATION        PIC XXX.
  3174         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3175         16  EC-AM-PHONE-NO            PIC X(10).
  3176
  3177         16  EC-AM-LF-REFUND-CALC      PIC X.
  3178                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3179                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3180                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3181                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3182                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3183                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3184                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3185
  3186         16  EC-AM-AH-REFUND-CALC      PIC X.
  3187                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3188                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3189                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3190                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3191                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3192                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3193                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3194
  3195         16  EC-AM-BEN-I-G-CD          PIC X.
  3196                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3197                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3198                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3199
  3200         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3201         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3202         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3203         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3204         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3205         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3206         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3207         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3208         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3209
  3210         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3211         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3212         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3213         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3214         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3215         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3216         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3217         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3218         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3219         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3220         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3221         16  EC-RT-LF-NSP-ST           PIC XX.
  3222         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  62
* EL6311.cbl
  3223         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3224         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3225
  3226         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3227             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3228                                             'M' '5' '9' '2'.
  3229             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3230             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3231             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3232             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3233             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3234             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3235             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3236             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3237             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3238             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3239
  3240         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3241             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3242                                             'M' '5' '9' '2'.
  3243             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3244             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3245             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3246             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3247             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3248             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3249             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3250             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3251             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3252             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3253
  3254         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3255         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3256         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3257         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3258         16  EC-CM-DEATH-DT            PIC XX.
  3259
  3260*DMD CUSTOM CODING FIELDS BELOW
  3261*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3262         16  EC-BR-DMD-RATING-SW       PIC X.
  3263                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3264                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3265                 88  NO-DMD-RATING               VALUE 'N'.
  3266
  3267         16  EC-NEW-CERT               PIC X(11).
  3268         16  EC-NEW-STATE              PIC XX.
  3269         16  FILLER                    PIC X.
  3270*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3271         16  OVER-SHORT-EDIT-FIELDS.
  3272             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3273             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3274             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3275             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3276             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3277             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3278             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3279             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3280             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  63
* EL6311.cbl
  3281         16  FILLER                    PIC X(71).
  3282
  3283******************************************************************
  3284
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  64
* EL6311.cbl
  3286
  3287*    COPY ELCJPFX.
  3288******************************************************************
  3289*                                                                *
  3290*                                                                *
  3291*                            ELCJPFX.                            *
  3292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3293*                            VMOD=2.002                          *
  3294*                                                                *
  3295*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3296*                                                                *
  3297*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3298*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3299*        ELCNTL - CONTROL FILE                                   *
  3300*        ELMSTR - CLAIM MASTERS                                  *
  3301*        ELTRLR - ACTIVITY TRAILERS                              *
  3302*        ELCHKQ - CHECK QUE                                      *
  3303******************************************************************
  3304 01  JOURNAL-RECORD.
  3305     12  jp-date                     pic s9(5) comp-3.
  3306     12  jp-time                     pic s9(7) comp-3.
  3307     12  JP-USER-ID                  PIC X(4).
  3308     12  JP-FILE-ID                  PIC X(8).
  3309     12  JP-PROGRAM-ID               PIC X(8).
  3310     12  JP-RECORD-TYPE              PIC X.
  3311         88 JP-ADD              VALUE 'A'.
  3312         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3313         88 JP-AFTER-CHANGE     VALUE 'C'.
  3314         88 JP-DELETE           VALUE 'D'.
  3315         88 JP-GENERIC-DELETE   VALUE 'G'.
  3316         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3317         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3318     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3319     12  JP-RECORD-AREA
  3320
  3321
  3322                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  65
* EL6311.cbl
  3324*    COPY ELCAID.
  3325******************************************************************
  3326*                                                                *
  3327*                            ELCAID.                             *
  3328*                            VMOD=2.001                          *
  3329*                                                                *
  3330*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3331*                                                                *
  3332*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3333*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3334******************************************************************
  3335
  3336 01  DFHAID.
  3337   02  DFHNULL   PIC  X  VALUE  ' '.
  3338   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3339   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3340   02  DFHPEN    PIC  X  VALUE  '='.
  3341   02  DFHOPID   PIC  X  VALUE  'W'.
  3342   02  DFHPA1    PIC  X  VALUE  '%'.
  3343   02  DFHPA2    PIC  X  VALUE  '>'.
  3344   02  DFHPA3    PIC  X  VALUE  ','.
  3345   02  DFHPF1    PIC  X  VALUE  '1'.
  3346   02  DFHPF2    PIC  X  VALUE  '2'.
  3347   02  DFHPF3    PIC  X  VALUE  '3'.
  3348   02  DFHPF4    PIC  X  VALUE  '4'.
  3349   02  DFHPF5    PIC  X  VALUE  '5'.
  3350   02  DFHPF6    PIC  X  VALUE  '6'.
  3351   02  DFHPF7    PIC  X  VALUE  '7'.
  3352   02  DFHPF8    PIC  X  VALUE  '8'.
  3353   02  DFHPF9    PIC  X  VALUE  '9'.
  3354   02  DFHPF10   PIC  X  VALUE  ':'.
  3355   02  DFHPF11   PIC  X  VALUE  '#'.
  3356   02  DFHPF12   PIC  X  VALUE  '@'.
  3357   02  DFHPF13   PIC  X  VALUE  'A'.
  3358   02  DFHPF14   PIC  X  VALUE  'B'.
  3359   02  DFHPF15   PIC  X  VALUE  'C'.
  3360   02  DFHPF16   PIC  X  VALUE  'D'.
  3361   02  DFHPF17   PIC  X  VALUE  'E'.
  3362   02  DFHPF18   PIC  X  VALUE  'F'.
  3363   02  DFHPF19   PIC  X  VALUE  'G'.
  3364   02  DFHPF20   PIC  X  VALUE  'H'.
  3365   02  DFHPF21   PIC  X  VALUE  'I'.
  3366*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3367   02  DFHPF22   PIC  X  VALUE  '['.
  3368   02  DFHPF23   PIC  X  VALUE  '.'.
  3369   02  DFHPF24   PIC  X  VALUE  '<'.
  3370   02  DFHMSRE   PIC  X  VALUE  'X'.
  3371   02  DFHSTRF   PIC  X  VALUE  'h'.
  3372   02  DFHTRIG   PIC  X  VALUE  '"'.
  3373
  3374 01  FILLER    REDEFINES DFHAID.
  3375     12  FILLER              PIC X(8).
  3376     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3377
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  66
* EL6311.cbl
  3379*    COPY EL6311S.
  3380 01  EL631BI.
  3381     05  FILLER            PIC  X(0012).
  3382*    -------------------------------
  3383     05  BDATEL PIC S9(0004) COMP.
  3384     05  BDATEF PIC  X(0001).
  3385     05  FILLER REDEFINES BDATEF.
  3386         10  BDATEA PIC  X(0001).
  3387     05  BDATEI PIC  X(0008).
  3388*    -------------------------------
  3389     05  BTIMEL PIC S9(0004) COMP.
  3390     05  BTIMEF PIC  X(0001).
  3391     05  FILLER REDEFINES BTIMEF.
  3392         10  BTIMEA PIC  X(0001).
  3393     05  BTIMEI PIC  X(0005).
  3394*    -------------------------------
  3395     05  BHEADL PIC S9(0004) COMP.
  3396     05  BHEADF PIC  X(0001).
  3397     05  FILLER REDEFINES BHEADF.
  3398         10  BHEADA PIC  X(0001).
  3399     05  BHEADI PIC  X(0038).
  3400*    -------------------------------
  3401     05  BNCERTLL PIC S9(0004) COMP.
  3402     05  BNCERTLF PIC  X(0001).
  3403     05  FILLER REDEFINES BNCERTLF.
  3404         10  BNCERTLA PIC  X(0001).
  3405     05  BNCERTLI PIC  X(0008).
  3406*    -------------------------------
  3407     05  BNCERTL PIC S9(0004) COMP.
  3408     05  BNCERTF PIC  X(0001).
  3409     05  FILLER REDEFINES BNCERTF.
  3410         10  BNCERTA PIC  X(0001).
  3411     05  BNCERTI PIC  X(0011).
  3412*    -------------------------------
  3413     05  BNSTATLL PIC S9(0004) COMP.
  3414     05  BNSTATLF PIC  X(0001).
  3415     05  FILLER REDEFINES BNSTATLF.
  3416         10  BNSTATLA PIC  X(0001).
  3417     05  BNSTATLI PIC  X(0009).
  3418*    -------------------------------
  3419     05  BNSTATL PIC S9(0004) COMP.
  3420     05  BNSTATF PIC  X(0001).
  3421     05  FILLER REDEFINES BNSTATF.
  3422         10  BNSTATA PIC  X(0001).
  3423     05  BNSTATI PIC  X(0002).
  3424*    -------------------------------
  3425     05  BCHGTL PIC S9(0004) COMP.
  3426     05  BCHGTF PIC  X(0001).
  3427     05  FILLER REDEFINES BCHGTF.
  3428         10  BCHGTA PIC  X(0001).
  3429     05  BCHGTI PIC  X(0004).
  3430*    -------------------------------
  3431     05  BCHGL PIC S9(0004) COMP.
  3432     05  BCHGF PIC  X(0001).
  3433     05  FILLER REDEFINES BCHGF.
  3434         10  BCHGA PIC  X(0001).
  3435     05  BCHGI PIC  X(0004).
  3436*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  67
* EL6311.cbl
  3437     05  BCOMPIDL PIC S9(0004) COMP.
  3438     05  BCOMPIDF PIC  X(0001).
  3439     05  FILLER REDEFINES BCOMPIDF.
  3440         10  BCOMPIDA PIC  X(0001).
  3441     05  BCOMPIDI PIC  X(0003).
  3442*    -------------------------------
  3443     05  BREGIONL PIC S9(0004) COMP.
  3444     05  BREGIONF PIC  X(0001).
  3445     05  FILLER REDEFINES BREGIONF.
  3446         10  BREGIONA PIC  X(0001).
  3447     05  BREGIONI PIC  X(0006).
  3448*    -------------------------------
  3449     05  BUSERL PIC S9(0004) COMP.
  3450     05  BUSERF PIC  X(0001).
  3451     05  FILLER REDEFINES BUSERF.
  3452         10  BUSERA PIC  X(0001).
  3453     05  BUSERI PIC  X(0004).
  3454*    -------------------------------
  3455     05  BMAINTL PIC S9(0004) COMP.
  3456     05  BMAINTF PIC  X(0001).
  3457     05  FILLER REDEFINES BMAINTF.
  3458         10  BMAINTA PIC  X(0001).
  3459     05  BMAINTI PIC  X(0001).
  3460*    -------------------------------
  3461     05  BMANTBYL PIC S9(0004) COMP.
  3462     05  BMANTBYF PIC  X(0001).
  3463     05  FILLER REDEFINES BMANTBYF.
  3464         10  BMANTBYA PIC  X(0001).
  3465     05  BMANTBYI PIC  X(0004).
  3466*    -------------------------------
  3467     05  BCHGHDGL PIC S9(0004) COMP.
  3468     05  BCHGHDGF PIC  X(0001).
  3469     05  FILLER REDEFINES BCHGHDGF.
  3470         10  BCHGHDGA PIC  X(0001).
  3471     05  BCHGHDGI PIC  X(0003).
  3472*    -------------------------------
  3473     05  BMANTDTL PIC S9(0004) COMP.
  3474     05  BMANTDTF PIC  X(0001).
  3475     05  FILLER REDEFINES BMANTDTF.
  3476         10  BMANTDTA PIC  X(0001).
  3477     05  BMANTDTI PIC  X(0008).
  3478*    -------------------------------
  3479     05  BMANTATL PIC S9(0004) COMP.
  3480     05  BMANTATF PIC  X(0001).
  3481     05  FILLER REDEFINES BMANTATF.
  3482         10  BMANTATA PIC  X(0001).
  3483     05  BMANTATI PIC  X(0005).
  3484*    -------------------------------
  3485     05  BCSRL PIC S9(0004) COMP.
  3486     05  BCSRF PIC  X(0001).
  3487     05  FILLER REDEFINES BCSRF.
  3488         10  BCSRA PIC  X(0001).
  3489     05  BCSRI PIC  X(0004).
  3490*    -------------------------------
  3491     05  BBATCHL PIC S9(0004) COMP.
  3492     05  BBATCHF PIC  X(0001).
  3493     05  FILLER REDEFINES BBATCHF.
  3494         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  68
* EL6311.cbl
  3495     05  BBATCHI PIC  X(0006).
  3496*    -------------------------------
  3497     05  BSEQL PIC S9(0004) COMP.
  3498     05  BSEQF PIC  X(0001).
  3499     05  FILLER REDEFINES BSEQF.
  3500         10  BSEQA PIC  X(0001).
  3501     05  BSEQI PIC  X(0004).
  3502*    -------------------------------
  3503     05  BMOENDTL PIC S9(0004) COMP.
  3504     05  BMOENDTF PIC  X(0001).
  3505     05  FILLER REDEFINES BMOENDTF.
  3506         10  BMOENDTA PIC  X(0001).
  3507     05  BMOENDTI PIC  X(0008).
  3508*    -------------------------------
  3509     05  BCARRL PIC S9(0004) COMP.
  3510     05  BCARRF PIC  X(0001).
  3511     05  FILLER REDEFINES BCARRF.
  3512         10  BCARRA PIC  X(0001).
  3513     05  BCARRI PIC  X(0001).
  3514*    -------------------------------
  3515     05  BGROUPL PIC S9(0004) COMP.
  3516     05  BGROUPF PIC  X(0001).
  3517     05  FILLER REDEFINES BGROUPF.
  3518         10  BGROUPA PIC  X(0001).
  3519     05  BGROUPI PIC  X(0006).
  3520*    -------------------------------
  3521     05  BSTATEL PIC S9(0004) COMP.
  3522     05  BSTATEF PIC  X(0001).
  3523     05  FILLER REDEFINES BSTATEF.
  3524         10  BSTATEA PIC  X(0001).
  3525     05  BSTATEI PIC  X(0002).
  3526*    -------------------------------
  3527     05  BACCTL PIC S9(0004) COMP.
  3528     05  BACCTF PIC  X(0001).
  3529     05  FILLER REDEFINES BACCTF.
  3530         10  BACCTA PIC  X(0001).
  3531     05  BACCTI PIC  X(0010).
  3532*    -------------------------------
  3533     05  BVINHL PIC S9(0004) COMP.
  3534     05  BVINHF PIC  X(0001).
  3535     05  FILLER REDEFINES BVINHF.
  3536         10  BVINHA PIC  X(0001).
  3537     05  BVINHI PIC  X(0004).
  3538*    -------------------------------
  3539     05  BVINL PIC S9(0004) COMP.
  3540     05  BVINF PIC  X(0001).
  3541     05  FILLER REDEFINES BVINF.
  3542         10  BVINA PIC  X(0001).
  3543     05  BVINI PIC  X(0017).
  3544*    -------------------------------
  3545     05  BREFHDGL PIC S9(0004) COMP.
  3546     05  BREFHDGF PIC  X(0001).
  3547     05  FILLER REDEFINES BREFHDGF.
  3548         10  BREFHDGA PIC  X(0001).
  3549     05  BREFHDGI PIC  X(0004).
  3550*    -------------------------------
  3551     05  BREFL PIC S9(0004) COMP.
  3552     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  69
* EL6311.cbl
  3553     05  FILLER REDEFINES BREFF.
  3554         10  BREFA PIC  X(0001).
  3555     05  BREFI PIC  X(0012).
  3556*    -------------------------------
  3557     05  BAGEDEFL PIC S9(0004) COMP.
  3558     05  BAGEDEFF PIC  X(0001).
  3559     05  FILLER REDEFINES BAGEDEFF.
  3560         10  BAGEDEFA PIC  X(0001).
  3561     05  BAGEDEFI PIC  X(0004).
  3562*    -------------------------------
  3563     05  BCERTNOL PIC S9(0004) COMP.
  3564     05  BCERTNOF PIC  X(0001).
  3565     05  FILLER REDEFINES BCERTNOF.
  3566         10  BCERTNOA PIC  X(0001).
  3567     05  BCERTNOI PIC  X(0010).
  3568*    -------------------------------
  3569     05  BSUFIXL PIC S9(0004) COMP.
  3570     05  BSUFIXF PIC  X(0001).
  3571     05  FILLER REDEFINES BSUFIXF.
  3572         10  BSUFIXA PIC  X(0001).
  3573     05  BSUFIXI PIC  X(0001).
  3574*    -------------------------------
  3575     05  BEFFDTL PIC S9(0004) COMP.
  3576     05  BEFFDTF PIC  X(0001).
  3577     05  FILLER REDEFINES BEFFDTF.
  3578         10  BEFFDTA PIC  X(0001).
  3579     05  BEFFDTI PIC  X(0008).
  3580*    -------------------------------
  3581     05  BLSTNML PIC S9(0004) COMP.
  3582     05  BLSTNMF PIC  X(0001).
  3583     05  FILLER REDEFINES BLSTNMF.
  3584         10  BLSTNMA PIC  X(0001).
  3585     05  BLSTNMI PIC  X(0015).
  3586*    -------------------------------
  3587     05  B1STNML PIC S9(0004) COMP.
  3588     05  B1STNMF PIC  X(0001).
  3589     05  FILLER REDEFINES B1STNMF.
  3590         10  B1STNMA PIC  X(0001).
  3591     05  B1STNMI PIC  X(0010).
  3592*    -------------------------------
  3593     05  BINITL PIC S9(0004) COMP.
  3594     05  BINITF PIC  X(0001).
  3595     05  FILLER REDEFINES BINITF.
  3596         10  BINITA PIC  X(0001).
  3597     05  BINITI PIC  X(0001).
  3598*    -------------------------------
  3599     05  BSEXL PIC S9(0004) COMP.
  3600     05  BSEXF PIC  X(0001).
  3601     05  FILLER REDEFINES BSEXF.
  3602         10  BSEXA PIC  X(0001).
  3603     05  BSEXI PIC  X(0001).
  3604*    -------------------------------
  3605     05  BAGEL PIC S9(0004) COMP.
  3606     05  BAGEF PIC  X(0001).
  3607     05  FILLER REDEFINES BAGEF.
  3608         10  BAGEA PIC  X(0001).
  3609     05  BAGEI PIC  X(0002).
  3610*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  70
* EL6311.cbl
  3611     05  BBIRTHL PIC S9(0004) COMP.
  3612     05  BBIRTHF PIC  X(0001).
  3613     05  FILLER REDEFINES BBIRTHF.
  3614         10  BBIRTHA PIC  X(0001).
  3615     05  BBIRTHI PIC  X(0008).
  3616*    -------------------------------
  3617     05  B1STPMTL PIC S9(0004) COMP.
  3618     05  B1STPMTF PIC  X(0001).
  3619     05  FILLER REDEFINES B1STPMTF.
  3620         10  B1STPMTA PIC  X(0001).
  3621     05  B1STPMTI PIC  X(0008).
  3622*    -------------------------------
  3623     05  BDAYSL PIC S9(0004) COMP.
  3624     05  BDAYSF PIC  X(0001).
  3625     05  FILLER REDEFINES BDAYSF.
  3626         10  BDAYSA PIC  X(0001).
  3627     05  BDAYSI PIC  X(0003).
  3628*    -------------------------------
  3629     05  BLNTRML PIC S9(0004) COMP.
  3630     05  BLNTRMF PIC  X(0001).
  3631     05  FILLER REDEFINES BLNTRMF.
  3632         10  BLNTRMA PIC  X(0001).
  3633     05  BLNTRMI PIC  X(0003).
  3634*    -------------------------------
  3635     05  BLNOFCRL PIC S9(0004) COMP.
  3636     05  BLNOFCRF PIC  X(0001).
  3637     05  FILLER REDEFINES BLNOFCRF.
  3638         10  BLNOFCRA PIC  X(0001).
  3639     05  BLNOFCRI PIC  X(0005).
  3640*    -------------------------------
  3641     05  BMODEL PIC S9(0004) COMP.
  3642     05  BMODEF PIC  X(0001).
  3643     05  FILLER REDEFINES BMODEF.
  3644         10  BMODEA PIC  X(0001).
  3645     05  BMODEI PIC  X(0001).
  3646*    -------------------------------
  3647     05  BFREQL PIC S9(0004) COMP.
  3648     05  BFREQF PIC  X(0001).
  3649     05  FILLER REDEFINES BFREQF.
  3650         10  BFREQA PIC  X(0001).
  3651     05  BFREQI PIC  X(0002).
  3652*    -------------------------------
  3653     05  BPMTSL PIC S9(0004) COMP.
  3654     05  BPMTSF PIC  X(0001).
  3655     05  FILLER REDEFINES BPMTSF.
  3656         10  BPMTSA PIC  X(0001).
  3657     05  BPMTSI PIC  999.
  3658*    -------------------------------
  3659     05  BPMTAMTL PIC S9(0004) COMP.
  3660     05  BPMTAMTF PIC  X(0001).
  3661     05  FILLER REDEFINES BPMTAMTF.
  3662         10  BPMTAMTA PIC  X(0001).
  3663     05  BPMTAMTI PIC  9(7)V99.
  3664*    -------------------------------
  3665     05  BAPRL PIC S9(0004) COMP.
  3666     05  BAPRF PIC  X(0001).
  3667     05  FILLER REDEFINES BAPRF.
  3668         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  71
* EL6311.cbl
  3669     05  BAPRI PIC  X(7).
  3670*    -------------------------------
  3671     05  BLIVESL PIC S9(0004) COMP.
  3672     05  BLIVESF PIC  X(0001).
  3673     05  FILLER REDEFINES BLIVESF.
  3674         10  BLIVESA PIC  X(0001).
  3675     05  BLIVESI PIC  X(0009).
  3676*    -------------------------------
  3677     05  BMEMCAPL PIC S9(0004) COMP.
  3678     05  BMEMCAPF PIC  X(0001).
  3679     05  FILLER REDEFINES BMEMCAPF.
  3680         10  BMEMCAPA PIC  X(0001).
  3681     05  BMEMCAPI PIC  X(0011).
  3682*    -------------------------------
  3683     05  BORIGHDL PIC S9(0004) COMP.
  3684     05  BORIGHDF PIC  X(0001).
  3685     05  FILLER REDEFINES BORIGHDF.
  3686         10  BORIGHDA PIC  X(0001).
  3687     05  BORIGHDI PIC  X(0009).
  3688*    -------------------------------
  3689     05  DMDBILL PIC S9(0004) COMP.
  3690     05  DMDBILF PIC  X(0001).
  3691     05  FILLER REDEFINES DMDBILF.
  3692         10  DMDBILA PIC  X(0001).
  3693     05  DMDBILI PIC  X(0006).
  3694*    -------------------------------
  3695     05  BFORCEL PIC S9(0004) COMP.
  3696     05  BFORCEF PIC  X(0001).
  3697     05  FILLER REDEFINES BFORCEF.
  3698         10  BFORCEA PIC  X(0001).
  3699     05  BFORCEI PIC  X(0001).
  3700*    -------------------------------
  3701     05  BENTRYL PIC S9(0004) COMP.
  3702     05  BENTRYF PIC  X(0001).
  3703     05  FILLER REDEFINES BENTRYF.
  3704         10  BENTRYA PIC  X(0001).
  3705     05  BENTRYI PIC  X(0001).
  3706*    -------------------------------
  3707     05  BREINL PIC S9(0004) COMP.
  3708     05  BREINF PIC  X(0001).
  3709     05  FILLER REDEFINES BREINF.
  3710         10  BREINA PIC  X(0001).
  3711     05  BREINI PIC  X(0001).
  3712*    -------------------------------
  3713     05  BBILCDL PIC S9(0004) COMP.
  3714     05  BBILCDF PIC  X(0001).
  3715     05  FILLER REDEFINES BBILCDF.
  3716         10  BBILCDA PIC  X(0001).
  3717     05  BBILCDI PIC  X(0001).
  3718*    -------------------------------
  3719     05  BUNWRITL PIC S9(0004) COMP.
  3720     05  BUNWRITF PIC  X(0001).
  3721     05  FILLER REDEFINES BUNWRITF.
  3722         10  BUNWRITA PIC  X(0001).
  3723     05  BUNWRITI PIC  X(0001).
  3724*    -------------------------------
  3725     05  BSKPCDL PIC S9(0004) COMP.
  3726     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  72
* EL6311.cbl
  3727     05  FILLER REDEFINES BSKPCDF.
  3728         10  BSKPCDA PIC  X(0001).
  3729     05  BSKPCDI PIC  X(0001).
  3730*    -------------------------------
  3731     05  BINDGRPL PIC S9(0004) COMP.
  3732     05  BINDGRPF PIC  X(0001).
  3733     05  FILLER REDEFINES BINDGRPF.
  3734         10  BINDGRPA PIC  X(0001).
  3735     05  BINDGRPI PIC  X(0001).
  3736*    -------------------------------
  3737     05  BSIGL PIC S9(0004) COMP.
  3738     05  BSIGF PIC  X(0001).
  3739     05  FILLER REDEFINES BSIGF.
  3740         10  BSIGA PIC  X(0001).
  3741     05  BSIGI PIC  X(0001).
  3742*    -------------------------------
  3743     05  BRTCLSL PIC S9(0004) COMP.
  3744     05  BRTCLSF PIC  X(0001).
  3745     05  FILLER REDEFINES BRTCLSF.
  3746         10  BRTCLSA PIC  X(0001).
  3747     05  BRTCLSI PIC  X(0002).
  3748*    -------------------------------
  3749     05  BCHGCNTL PIC S9(0004) COMP.
  3750     05  BCHGCNTF PIC  X(0001).
  3751     05  FILLER REDEFINES BCHGCNTF.
  3752         10  BCHGCNTA PIC  X(0001).
  3753     05  BCHGCNTI PIC  X(0003).
  3754*    -------------------------------
  3755     05  BMEMBERL PIC S9(0004) COMP.
  3756     05  BMEMBERF PIC  X(0001).
  3757     05  FILLER REDEFINES BMEMBERF.
  3758         10  BMEMBERA PIC  X(0001).
  3759     05  BMEMBERI PIC  X(0012).
  3760*    -------------------------------
  3761     05  BORGNOL PIC S9(0004) COMP.
  3762     05  BORGNOF PIC  X(0001).
  3763     05  FILLER REDEFINES BORGNOF.
  3764         10  BORGNOA PIC  X(0001).
  3765     05  BORGNOI PIC  X(0006).
  3766*    -------------------------------
  3767     05  BORGSEQL PIC S9(0004) COMP.
  3768     05  BORGSEQF PIC  X(0001).
  3769     05  FILLER REDEFINES BORGSEQF.
  3770         10  BORGSEQA PIC  X(0001).
  3771     05  BORGSEQI PIC  X(0004).
  3772*    -------------------------------
  3773     05  BBILLEDL PIC S9(0004) COMP.
  3774     05  BBILLEDF PIC  X(0001).
  3775     05  FILLER REDEFINES BBILLEDF.
  3776         10  BBILLEDA PIC  X(0001).
  3777     05  BBILLEDI PIC  9(9).
  3778*    -------------------------------
  3779     05  BKIND1L PIC S9(0004) COMP.
  3780     05  BKIND1F PIC  X(0001).
  3781     05  FILLER REDEFINES BKIND1F.
  3782         10  BKIND1A PIC  X(0001).
  3783     05  BKIND1I PIC  X(0002).
  3784*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  73
* EL6311.cbl
  3785     05  BTYPE1L PIC S9(0004) COMP.
  3786     05  BTYPE1F PIC  X(0001).
  3787     05  FILLER REDEFINES BTYPE1F.
  3788         10  BTYPE1A PIC  X(0001).
  3789     05  BTYPE1I PIC  X(0003).
  3790*    -------------------------------
  3791     05  BTERM1L PIC S9(0004) COMP.
  3792     05  BTERM1F PIC  X(0001).
  3793     05  FILLER REDEFINES BTERM1F.
  3794         10  BTERM1A PIC  X(0001).
  3795     05  BTERM1I PIC  X(0003).
  3796*    -------------------------------
  3797     05  BBEN1L PIC S9(0004) COMP.
  3798     05  BBEN1F PIC  X(0001).
  3799     05  FILLER REDEFINES BBEN1F.
  3800         10  BBEN1A PIC  X(0001).
  3801     05  BBEN1I PIC  X(0012).
  3802*    -------------------------------
  3803     05  BPREM1L PIC S9(0004) COMP.
  3804     05  BPREM1F PIC  X(0001).
  3805     05  FILLER REDEFINES BPREM1F.
  3806         10  BPREM1A PIC  X(0001).
  3807     05  BPREM1I PIC  X(0011).
  3808*    -------------------------------
  3809     05  BEXPIR1L PIC S9(0004) COMP.
  3810     05  BEXPIR1F PIC  X(0001).
  3811     05  FILLER REDEFINES BEXPIR1F.
  3812         10  BEXPIR1A PIC  X(0001).
  3813     05  BEXPIR1I PIC  X(0008).
  3814*    -------------------------------
  3815     05  BCP1L PIC S9(0004) COMP.
  3816     05  BCP1F PIC  X(0001).
  3817     05  FILLER REDEFINES BCP1F.
  3818         10  BCP1A PIC  X(0001).
  3819     05  BCP1I PIC  X(0002).
  3820*    -------------------------------
  3821     05  BALTBN1L PIC S9(0004) COMP.
  3822     05  BALTBN1F PIC  X(0001).
  3823     05  FILLER REDEFINES BALTBN1F.
  3824         10  BALTBN1A PIC  X(0001).
  3825     05  BALTBN1I PIC  X(0012).
  3826*    -------------------------------
  3827     05  BALTPR1L PIC S9(0004) COMP.
  3828     05  BALTPR1F PIC  X(0001).
  3829     05  FILLER REDEFINES BALTPR1F.
  3830         10  BALTPR1A PIC  X(0001).
  3831     05  BALTPR1I PIC  X(0011).
  3832*    -------------------------------
  3833     05  BBNCD1L PIC S9(0004) COMP.
  3834     05  BBNCD1F PIC  X(0001).
  3835     05  FILLER REDEFINES BBNCD1F.
  3836         10  BBNCD1A PIC  X(0001).
  3837     05  BBNCD1I PIC  X(0003).
  3838*    -------------------------------
  3839     05  BCPRM1L PIC S9(0004) COMP.
  3840     05  BCPRM1F PIC  X(0001).
  3841     05  FILLER REDEFINES BCPRM1F.
  3842         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  74
* EL6311.cbl
  3843     05  BCPRM1I PIC  X(0011).
  3844*    -------------------------------
  3845     05  BCAPRM1L PIC S9(0004) COMP.
  3846     05  BCAPRM1F PIC  X(0001).
  3847     05  FILLER REDEFINES BCAPRM1F.
  3848         10  BCAPRM1A PIC  X(0001).
  3849     05  BCAPRM1I PIC  X(0011).
  3850*    -------------------------------
  3851     05  BENABR1L PIC S9(0004) COMP.
  3852     05  BENABR1F PIC  X(0001).
  3853     05  FILLER REDEFINES BENABR1F.
  3854         10  BENABR1A PIC  X(0001).
  3855     05  BENABR1I PIC  X(0005).
  3856*    -------------------------------
  3857     05  BDIFF1L PIC S9(0004) COMP.
  3858     05  BDIFF1F PIC  X(0001).
  3859     05  FILLER REDEFINES BDIFF1F.
  3860         10  BDIFF1A PIC  X(0001).
  3861     05  BDIFF1I PIC  X(0011).
  3862*    -------------------------------
  3863     05  BBILIT1L PIC S9(0004) COMP.
  3864     05  BBILIT1F PIC  X(0001).
  3865     05  FILLER REDEFINES BBILIT1F.
  3866         10  BBILIT1A PIC  X(0001).
  3867     05  BBILIT1I PIC  X(0008).
  3868*    -------------------------------
  3869     05  BADIFF1L PIC S9(0004) COMP.
  3870     05  BADIFF1F PIC  X(0001).
  3871     05  FILLER REDEFINES BADIFF1F.
  3872         10  BADIFF1A PIC  X(0001).
  3873     05  BADIFF1I PIC  X(0011).
  3874*    -------------------------------
  3875     05  BKIND2L PIC S9(0004) COMP.
  3876     05  BKIND2F PIC  X(0001).
  3877     05  FILLER REDEFINES BKIND2F.
  3878         10  BKIND2A PIC  X(0001).
  3879     05  BKIND2I PIC  X(0002).
  3880*    -------------------------------
  3881     05  BTYPE2L PIC S9(0004) COMP.
  3882     05  BTYPE2F PIC  X(0001).
  3883     05  FILLER REDEFINES BTYPE2F.
  3884         10  BTYPE2A PIC  X(0001).
  3885     05  BTYPE2I PIC  X(0003).
  3886*    -------------------------------
  3887     05  BTERM2L PIC S9(0004) COMP.
  3888     05  BTERM2F PIC  X(0001).
  3889     05  FILLER REDEFINES BTERM2F.
  3890         10  BTERM2A PIC  X(0001).
  3891     05  BTERM2I PIC  X(0003).
  3892*    -------------------------------
  3893     05  BBEN2L PIC S9(0004) COMP.
  3894     05  BBEN2F PIC  X(0001).
  3895     05  FILLER REDEFINES BBEN2F.
  3896         10  BBEN2A PIC  X(0001).
  3897     05  BBEN2I PIC  X(0012).
  3898*    -------------------------------
  3899     05  BPREM2L PIC S9(0004) COMP.
  3900     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  75
* EL6311.cbl
  3901     05  FILLER REDEFINES BPREM2F.
  3902         10  BPREM2A PIC  X(0001).
  3903     05  BPREM2I PIC  X(0011).
  3904*    -------------------------------
  3905     05  BEXPIR2L PIC S9(0004) COMP.
  3906     05  BEXPIR2F PIC  X(0001).
  3907     05  FILLER REDEFINES BEXPIR2F.
  3908         10  BEXPIR2A PIC  X(0001).
  3909     05  BEXPIR2I PIC  X(0008).
  3910*    -------------------------------
  3911     05  BCP2L PIC S9(0004) COMP.
  3912     05  BCP2F PIC  X(0001).
  3913     05  FILLER REDEFINES BCP2F.
  3914         10  BCP2A PIC  X(0001).
  3915     05  BCP2I PIC  X(0002).
  3916*    -------------------------------
  3917     05  BALTBN2L PIC S9(0004) COMP.
  3918     05  BALTBN2F PIC  X(0001).
  3919     05  FILLER REDEFINES BALTBN2F.
  3920         10  BALTBN2A PIC  X(0001).
  3921     05  BALTBN2I PIC  X(0012).
  3922*    -------------------------------
  3923     05  BALTPR2L PIC S9(0004) COMP.
  3924     05  BALTPR2F PIC  X(0001).
  3925     05  FILLER REDEFINES BALTPR2F.
  3926         10  BALTPR2A PIC  X(0001).
  3927     05  BALTPR2I PIC  X(0011).
  3928*    -------------------------------
  3929     05  BBNCD2L PIC S9(0004) COMP.
  3930     05  BBNCD2F PIC  X(0001).
  3931     05  FILLER REDEFINES BBNCD2F.
  3932         10  BBNCD2A PIC  X(0001).
  3933     05  BBNCD2I PIC  X(0003).
  3934*    -------------------------------
  3935     05  BCPRM2L PIC S9(0004) COMP.
  3936     05  BCPRM2F PIC  X(0001).
  3937     05  FILLER REDEFINES BCPRM2F.
  3938         10  BCPRM2A PIC  X(0001).
  3939     05  BCPRM2I PIC  X(0011).
  3940*    -------------------------------
  3941     05  BCAPRM2L PIC S9(0004) COMP.
  3942     05  BCAPRM2F PIC  X(0001).
  3943     05  FILLER REDEFINES BCAPRM2F.
  3944         10  BCAPRM2A PIC  X(0001).
  3945     05  BCAPRM2I PIC  X(0011).
  3946*    -------------------------------
  3947     05  BENABR2L PIC S9(0004) COMP.
  3948     05  BENABR2F PIC  X(0001).
  3949     05  FILLER REDEFINES BENABR2F.
  3950         10  BENABR2A PIC  X(0001).
  3951     05  BENABR2I PIC  X(0005).
  3952*    -------------------------------
  3953     05  BDIFF2L PIC S9(0004) COMP.
  3954     05  BDIFF2F PIC  X(0001).
  3955     05  FILLER REDEFINES BDIFF2F.
  3956         10  BDIFF2A PIC  X(0001).
  3957     05  BDIFF2I PIC  X(0011).
  3958*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  76
* EL6311.cbl
  3959     05  BBILIT2L PIC S9(0004) COMP.
  3960     05  BBILIT2F PIC  X(0001).
  3961     05  FILLER REDEFINES BBILIT2F.
  3962         10  BBILIT2A PIC  X(0001).
  3963     05  BBILIT2I PIC  X(0008).
  3964*    -------------------------------
  3965     05  BADIFF2L PIC S9(0004) COMP.
  3966     05  BADIFF2F PIC  X(0001).
  3967     05  FILLER REDEFINES BADIFF2F.
  3968         10  BADIFF2A PIC  X(0001).
  3969     05  BADIFF2I PIC  X(0011).
  3970*    -------------------------------
  3971     05  BERMSG1L PIC S9(0004) COMP.
  3972     05  BERMSG1F PIC  X(0001).
  3973     05  FILLER REDEFINES BERMSG1F.
  3974         10  BERMSG1A PIC  X(0001).
  3975     05  BERMSG1I PIC  X(0078).
  3976*    -------------------------------
  3977     05  BERMSG2L PIC S9(0004) COMP.
  3978     05  BERMSG2F PIC  X(0001).
  3979     05  FILLER REDEFINES BERMSG2F.
  3980         10  BERMSG2A PIC  X(0001).
  3981     05  BERMSG2I PIC  X(0078).
  3982*    -------------------------------
  3983     05  BERMSG3L PIC S9(0004) COMP.
  3984     05  BERMSG3F PIC  X(0001).
  3985     05  FILLER REDEFINES BERMSG3F.
  3986         10  BERMSG3A PIC  X(0001).
  3987     05  BERMSG3I PIC  X(0078).
  3988*    -------------------------------
  3989     05  BPFENTRL PIC S9(0004) COMP.
  3990     05  BPFENTRF PIC  X(0001).
  3991     05  FILLER REDEFINES BPFENTRF.
  3992         10  BPFENTRA PIC  X(0001).
  3993     05  BPFENTRI PIC  9(2).
  3994*    -------------------------------
  3995     05  BPF5HDRL PIC S9(0004) COMP.
  3996     05  BPF5HDRF PIC  X(0001).
  3997     05  FILLER REDEFINES BPF5HDRF.
  3998         10  BPF5HDRA PIC  X(0001).
  3999     05  BPF5HDRI PIC  X(0005).
  4000*    -------------------------------
  4001     05  BPF4HDRL PIC S9(0004) COMP.
  4002     05  BPF4HDRF PIC  X(0001).
  4003     05  FILLER REDEFINES BPF4HDRF.
  4004         10  BPF4HDRA PIC  X(0001).
  4005     05  BPF4HDRI PIC  X(0013).
  4006*    -------------------------------
  4007     05  BF15HDRL PIC S9(0004) COMP.
  4008     05  BF15HDRF PIC  X(0001).
  4009     05  FILLER REDEFINES BF15HDRF.
  4010         10  BF15HDRA PIC  X(0001).
  4011     05  BF15HDRI PIC  X(0010).
  4012 01  EL631BO REDEFINES EL631BI.
  4013     05  FILLER            PIC  X(0012).
  4014*    -------------------------------
  4015     05  FILLER            PIC  X(0003).
  4016     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  77
* EL6311.cbl
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BTIMEO PIC  99.99.
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BHEADO PIC  X(0038).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BNCERTLO PIC  X(0008).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BNCERTO PIC  X(0011).
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  BNSTATLO PIC  X(0009).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BNSTATO PIC  X(0002).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BCHGTO PIC  X(0004).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BCHGO PIC  ZZZ9.
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BCOMPIDO PIC  X(0003).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BREGIONO PIC  X(0006).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BUSERO PIC  X(0004).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BMAINTO PIC  X(0001).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BMANTBYO PIC  X(0004).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BCHGHDGO PIC  X(0003).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BMANTDTO PIC  X(0008).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BMANTATO PIC  99.99.
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BCSRO PIC  X(0004).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BBATCHO PIC  X(0006).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BSEQO PIC  X(0004).
  4074*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  78
* EL6311.cbl
  4075     05  FILLER            PIC  X(0003).
  4076     05  BMOENDTO PIC  X(0008).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BCARRO PIC  X(0001).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BGROUPO PIC  X(0006).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BSTATEO PIC  X(0002).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BACCTO PIC  X(0010).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BVINHO PIC  X(0004).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BVINO PIC  X(0017).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BREFHDGO PIC  X(0004).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BREFO PIC  X(0012).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BAGEDEFO PIC  X(0004).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BCERTNOO PIC  X(0010).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BSUFIXO PIC  X(0001).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BEFFDTO PIC  X(0008).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BLSTNMO PIC  X(0015).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  B1STNMO PIC  X(0010).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BINITO PIC  X(0001).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BSEXO PIC  X(0001).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BAGEO PIC  X(0002).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BBIRTHO PIC  X(0008).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  79
* EL6311.cbl
  4133     05  B1STPMTO PIC  X(0008).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BDAYSO PIC  X(0003).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BLNTRMO PIC  X(0003).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BLNOFCRO PIC  X(0005).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BMODEO PIC  X(0001).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BFREQO PIC  X(0002).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BPMTSO PIC  X(0003).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BPMTAMTO PIC  ZZZZZ9.99.
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BAPRO PIC  99.9999.
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BMEMCAPO PIC  X(0011).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BORIGHDO PIC  X(0009).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  DMDBILO PIC  X(0006).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BFORCEO PIC  X(0001).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BENTRYO PIC  X(0001).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BREINO PIC  X(0001).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BBILCDO PIC  X(0001).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BUNWRITO PIC  X(0001).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BSKPCDO PIC  X(0001).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  80
* EL6311.cbl
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BSIGO PIC  X(0001).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BRTCLSO PIC  X(0002).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BCHGCNTO PIC  X(0003).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BMEMBERO PIC  X(0012).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BORGNOO PIC  X(0006).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BORGSEQO PIC  X(0004).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BKIND1O PIC  X(0002).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BTYPE1O PIC  X(0003).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BTERM1O PIC  X(0003).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BBEN1O PIC  X(0012).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BPREM1O PIC  X(0011).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BEXPIR1O PIC  X(0008).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BCP1O PIC  X(0002).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BALTBN1O PIC  X(0012).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BALTPR1O PIC  X(0011).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BBNCD1O PIC  X(0003).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BCPRM1O PIC  X(0011).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BCAPRM1O PIC  X(0011).
  4248*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  81
* EL6311.cbl
  4249     05  FILLER            PIC  X(0003).
  4250     05  BENABR1O PIC  X(0005).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BDIFF1O PIC  X(0011).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BBILIT1O PIC  X(0008).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BADIFF1O PIC  X(0011).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BKIND2O PIC  X(0002).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BTYPE2O PIC  X(0003).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BTERM2O PIC  X(0003).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  BBEN2O PIC  X(0012).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BPREM2O PIC  X(0011).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BEXPIR2O PIC  X(0008).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BCP2O PIC  X(0002).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BALTBN2O PIC  X(0012).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BALTPR2O PIC  X(0011).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BBNCD2O PIC  X(0003).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BCPRM2O PIC  X(0011).
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BCAPRM2O PIC  X(0011).
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BENABR2O PIC  X(0005).
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BDIFF2O PIC  X(0011).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BBILIT2O PIC  X(0008).
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  82
* EL6311.cbl
  4307     05  BADIFF2O PIC  X(0011).
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BERMSG1O PIC  X(0078).
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BERMSG2O PIC  X(0078).
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BERMSG3O PIC  X(0078).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  BPFENTRO PIC  X(0002).
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  BPF5HDRO PIC  X(0005).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
  4325     05  BPF4HDRO PIC  X(0013).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
  4328     05  BF15HDRO PIC  X(0010).
  4329*    -------------------------------
  4330 01  EL631CI REDEFINES EL631BI.
  4331     05  FILLER            PIC  X(0012).
  4332*    -------------------------------
  4333     05  CDATEL PIC S9(0004) COMP.
  4334     05  CDATEF PIC  X(0001).
  4335     05  FILLER REDEFINES CDATEF.
  4336         10  CDATEA PIC  X(0001).
  4337     05  CDATEI PIC  X(0008).
  4338*    -------------------------------
  4339     05  CTIMEL PIC S9(0004) COMP.
  4340     05  CTIMEF PIC  X(0001).
  4341     05  FILLER REDEFINES CTIMEF.
  4342         10  CTIMEA PIC  X(0001).
  4343     05  CTIMEI PIC  X(0005).
  4344*    -------------------------------
  4345     05  CHEADL PIC S9(0004) COMP.
  4346     05  CHEADF PIC  X(0001).
  4347     05  FILLER REDEFINES CHEADF.
  4348         10  CHEADA PIC  X(0001).
  4349     05  CHEADI PIC  X(0038).
  4350*    -------------------------------
  4351     05  CCHGTL PIC S9(0004) COMP.
  4352     05  CCHGTF PIC  X(0001).
  4353     05  FILLER REDEFINES CCHGTF.
  4354         10  CCHGTA PIC  X(0001).
  4355     05  CCHGTI PIC  X(0004).
  4356*    -------------------------------
  4357     05  CCHGL PIC S9(0004) COMP.
  4358     05  CCHGF PIC  X(0001).
  4359     05  FILLER REDEFINES CCHGF.
  4360         10  CCHGA PIC  X(0001).
  4361     05  CCHGI PIC  X(0004).
  4362*    -------------------------------
  4363     05  CMAINTL PIC S9(0004) COMP.
  4364     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  83
* EL6311.cbl
  4365     05  FILLER REDEFINES CMAINTF.
  4366         10  CMAINTA PIC  X(0001).
  4367     05  CMAINTI PIC  X(0001).
  4368*    -------------------------------
  4369     05  CMANTBYL PIC S9(0004) COMP.
  4370     05  CMANTBYF PIC  X(0001).
  4371     05  FILLER REDEFINES CMANTBYF.
  4372         10  CMANTBYA PIC  X(0001).
  4373     05  CMANTBYI PIC  X(0004).
  4374*    -------------------------------
  4375     05  CCHGHDGL PIC S9(0004) COMP.
  4376     05  CCHGHDGF PIC  X(0001).
  4377     05  FILLER REDEFINES CCHGHDGF.
  4378         10  CCHGHDGA PIC  X(0001).
  4379     05  CCHGHDGI PIC  X(0003).
  4380*    -------------------------------
  4381     05  CMANTDTL PIC S9(0004) COMP.
  4382     05  CMANTDTF PIC  X(0001).
  4383     05  FILLER REDEFINES CMANTDTF.
  4384         10  CMANTDTA PIC  X(0001).
  4385     05  CMANTDTI PIC  X(0008).
  4386*    -------------------------------
  4387     05  CMANTATL PIC S9(0004) COMP.
  4388     05  CMANTATF PIC  X(0001).
  4389     05  FILLER REDEFINES CMANTATF.
  4390         10  CMANTATA PIC  X(0001).
  4391     05  CMANTATI PIC  X(0005).
  4392*    -------------------------------
  4393     05  CCSRL PIC S9(0004) COMP.
  4394     05  CCSRF PIC  X(0001).
  4395     05  FILLER REDEFINES CCSRF.
  4396         10  CCSRA PIC  X(0001).
  4397     05  CCSRI PIC  X(0004).
  4398*    -------------------------------
  4399     05  CBATCHL PIC S9(0004) COMP.
  4400     05  CBATCHF PIC  X(0001).
  4401     05  FILLER REDEFINES CBATCHF.
  4402         10  CBATCHA PIC  X(0001).
  4403     05  CBATCHI PIC  X(0006).
  4404*    -------------------------------
  4405     05  CSEQL PIC S9(0004) COMP.
  4406     05  CSEQF PIC  X(0001).
  4407     05  FILLER REDEFINES CSEQF.
  4408         10  CSEQA PIC  X(0001).
  4409     05  CSEQI PIC  X(0004).
  4410*    -------------------------------
  4411     05  CMOENDTL PIC S9(0004) COMP.
  4412     05  CMOENDTF PIC  X(0001).
  4413     05  FILLER REDEFINES CMOENDTF.
  4414         10  CMOENDTA PIC  X(0001).
  4415     05  CMOENDTI PIC  X(0008).
  4416*    -------------------------------
  4417     05  CCARRL PIC S9(0004) COMP.
  4418     05  CCARRF PIC  X(0001).
  4419     05  FILLER REDEFINES CCARRF.
  4420         10  CCARRA PIC  X(0001).
  4421     05  CCARRI PIC  X(0001).
  4422*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  84
* EL6311.cbl
  4423     05  CGROUPL PIC S9(0004) COMP.
  4424     05  CGROUPF PIC  X(0001).
  4425     05  FILLER REDEFINES CGROUPF.
  4426         10  CGROUPA PIC  X(0001).
  4427     05  CGROUPI PIC  X(0006).
  4428*    -------------------------------
  4429     05  CSTATEL PIC S9(0004) COMP.
  4430     05  CSTATEF PIC  X(0001).
  4431     05  FILLER REDEFINES CSTATEF.
  4432         10  CSTATEA PIC  X(0001).
  4433     05  CSTATEI PIC  X(0002).
  4434*    -------------------------------
  4435     05  CACCTL PIC S9(0004) COMP.
  4436     05  CACCTF PIC  X(0001).
  4437     05  FILLER REDEFINES CACCTF.
  4438         10  CACCTA PIC  X(0001).
  4439     05  CACCTI PIC  X(0010).
  4440*    -------------------------------
  4441     05  CORIGHDL PIC S9(0004) COMP.
  4442     05  CORIGHDF PIC  X(0001).
  4443     05  FILLER REDEFINES CORIGHDF.
  4444         10  CORIGHDA PIC  X(0001).
  4445     05  CORIGHDI PIC  X(0011).
  4446*    -------------------------------
  4447     05  CORGNOL PIC S9(0004) COMP.
  4448     05  CORGNOF PIC  X(0001).
  4449     05  FILLER REDEFINES CORGNOF.
  4450         10  CORGNOA PIC  X(0001).
  4451     05  CORGNOI PIC  X(0006).
  4452*    -------------------------------
  4453     05  CORGSEQL PIC S9(0004) COMP.
  4454     05  CORGSEQF PIC  X(0001).
  4455     05  FILLER REDEFINES CORGSEQF.
  4456         10  CORGSEQA PIC  X(0001).
  4457     05  CORGSEQI PIC  X(0004).
  4458*    -------------------------------
  4459     05  CREFHDGL PIC S9(0004) COMP.
  4460     05  CREFHDGF PIC  X(0001).
  4461     05  FILLER REDEFINES CREFHDGF.
  4462         10  CREFHDGA PIC  X(0001).
  4463     05  CREFHDGI PIC  X(0010).
  4464*    -------------------------------
  4465     05  CREFL PIC S9(0004) COMP.
  4466     05  CREFF PIC  X(0001).
  4467     05  FILLER REDEFINES CREFF.
  4468         10  CREFA PIC  X(0001).
  4469     05  CREFI PIC  X(0012).
  4470*    -------------------------------
  4471     05  CNHINTL PIC S9(0004) COMP.
  4472     05  CNHINTF PIC  X(0001).
  4473     05  FILLER REDEFINES CNHINTF.
  4474         10  CNHINTA PIC  X(0001).
  4475     05  CNHINTI PIC  9(7)V99.
  4476*    -------------------------------
  4477     05  CCERTNOL PIC S9(0004) COMP.
  4478     05  CCERTNOF PIC  X(0001).
  4479     05  FILLER REDEFINES CCERTNOF.
  4480         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  85
* EL6311.cbl
  4481     05  CCERTNOI PIC  X(0010).
  4482*    -------------------------------
  4483     05  CSUFIXL PIC S9(0004) COMP.
  4484     05  CSUFIXF PIC  X(0001).
  4485     05  FILLER REDEFINES CSUFIXF.
  4486         10  CSUFIXA PIC  X(0001).
  4487     05  CSUFIXI PIC  X(0001).
  4488*    -------------------------------
  4489     05  CEFFDTL PIC S9(0004) COMP.
  4490     05  CEFFDTF PIC  X(0001).
  4491     05  FILLER REDEFINES CEFFDTF.
  4492         10  CEFFDTA PIC  X(0001).
  4493     05  CEFFDTI PIC  X(0008).
  4494*    -------------------------------
  4495     05  CLSTNML PIC S9(0004) COMP.
  4496     05  CLSTNMF PIC  X(0001).
  4497     05  FILLER REDEFINES CLSTNMF.
  4498         10  CLSTNMA PIC  X(0001).
  4499     05  CLSTNMI PIC  X(0015).
  4500*    -------------------------------
  4501     05  CPCYNL PIC S9(0004) COMP.
  4502     05  CPCYNF PIC  X(0001).
  4503     05  FILLER REDEFINES CPCYNF.
  4504         10  CPCYNA PIC  X(0001).
  4505     05  CPCYNI PIC  X(0001).
  4506*    -------------------------------
  4507     05  CINAMEL PIC S9(0004) COMP.
  4508     05  CINAMEF PIC  X(0001).
  4509     05  FILLER REDEFINES CINAMEF.
  4510         10  CINAMEA PIC  X(0001).
  4511     05  CINAMEI PIC  X(0015).
  4512*    -------------------------------
  4513     05  CINITSL PIC S9(0004) COMP.
  4514     05  CINITSF PIC  X(0001).
  4515     05  FILLER REDEFINES CINITSF.
  4516         10  CINITSA PIC  X(0001).
  4517     05  CINITSI PIC  X(0010).
  4518*    -------------------------------
  4519     05  CCANREAL PIC S9(0004) COMP.
  4520     05  CCANREAF PIC  X(0001).
  4521     05  FILLER REDEFINES CCANREAF.
  4522         10  CCANREAA PIC  X(0001).
  4523     05  CCANREAI PIC  X(0001).
  4524*    -------------------------------
  4525     05  CKIND1L PIC S9(0004) COMP.
  4526     05  CKIND1F PIC  X(0001).
  4527     05  FILLER REDEFINES CKIND1F.
  4528         10  CKIND1A PIC  X(0001).
  4529     05  CKIND1I PIC  X(0002).
  4530*    -------------------------------
  4531     05  CCANDT1L PIC S9(0004) COMP.
  4532     05  CCANDT1F PIC  X(0001).
  4533     05  FILLER REDEFINES CCANDT1F.
  4534         10  CCANDT1A PIC  X(0001).
  4535     05  CCANDT1I PIC  X(0008).
  4536*    -------------------------------
  4537     05  CREFND1L PIC S9(0004) COMP.
  4538     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  86
* EL6311.cbl
  4539     05  FILLER REDEFINES CREFND1F.
  4540         10  CREFND1A PIC  X(0001).
  4541     05  CREFND1I PIC  S9(9)V99.
  4542*    -------------------------------
  4543     05  CMTHD1L PIC S9(0004) COMP.
  4544     05  CMTHD1F PIC  X(0001).
  4545     05  FILLER REDEFINES CMTHD1F.
  4546         10  CMTHD1A PIC  X(0001).
  4547     05  CMTHD1I PIC  X(0001).
  4548*    -------------------------------
  4549     05  CKIND2L PIC S9(0004) COMP.
  4550     05  CKIND2F PIC  X(0001).
  4551     05  FILLER REDEFINES CKIND2F.
  4552         10  CKIND2A PIC  X(0001).
  4553     05  CKIND2I PIC  X(0002).
  4554*    -------------------------------
  4555     05  CCANDT2L PIC S9(0004) COMP.
  4556     05  CCANDT2F PIC  X(0001).
  4557     05  FILLER REDEFINES CCANDT2F.
  4558         10  CCANDT2A PIC  X(0001).
  4559     05  CCANDT2I PIC  X(0008).
  4560*    -------------------------------
  4561     05  CREFND2L PIC S9(0004) COMP.
  4562     05  CREFND2F PIC  X(0001).
  4563     05  FILLER REDEFINES CREFND2F.
  4564         10  CREFND2A PIC  X(0001).
  4565     05  CREFND2I PIC  S9(9)V99.
  4566*    -------------------------------
  4567     05  CMTHD2L PIC S9(0004) COMP.
  4568     05  CMTHD2F PIC  X(0001).
  4569     05  FILLER REDEFINES CMTHD2F.
  4570         10  CMTHD2A PIC  X(0001).
  4571     05  CMTHD2I PIC  X(0001).
  4572*    -------------------------------
  4573     05  CLIVESL PIC S9(0004) COMP.
  4574     05  CLIVESF PIC  X(0001).
  4575     05  FILLER REDEFINES CLIVESF.
  4576         10  CLIVESA PIC  X(0001).
  4577     05  CLIVESI PIC  X(0003).
  4578*    -------------------------------
  4579     05  CFORCEL PIC S9(0004) COMP.
  4580     05  CFORCEF PIC  X(0001).
  4581     05  FILLER REDEFINES CFORCEF.
  4582         10  CFORCEA PIC  X(0001).
  4583     05  CFORCEI PIC  X(0001).
  4584*    -------------------------------
  4585     05  CBILCDL PIC S9(0004) COMP.
  4586     05  CBILCDF PIC  X(0001).
  4587     05  FILLER REDEFINES CBILCDF.
  4588         10  CBILCDA PIC  X(0001).
  4589     05  CBILCDI PIC  X(0001).
  4590*    -------------------------------
  4591     05  CCRFND1L PIC S9(0004) COMP.
  4592     05  CCRFND1F PIC  X(0001).
  4593     05  FILLER REDEFINES CCRFND1F.
  4594         10  CCRFND1A PIC  X(0001).
  4595     05  CCRFND1I PIC  X(0011).
  4596*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  87
* EL6311.cbl
  4597     05  CCRFND2L PIC S9(0004) COMP.
  4598     05  CCRFND2F PIC  X(0001).
  4599     05  FILLER REDEFINES CCRFND2F.
  4600         10  CCRFND2A PIC  X(0001).
  4601     05  CCRFND2I PIC  X(0011).
  4602*    -------------------------------
  4603     05  CBILIT1L PIC S9(0004) COMP.
  4604     05  CBILIT1F PIC  X(0001).
  4605     05  FILLER REDEFINES CBILIT1F.
  4606         10  CBILIT1A PIC  X(0001).
  4607     05  CBILIT1I PIC  X(0008).
  4608*    -------------------------------
  4609     05  CDRFND1L PIC S9(0004) COMP.
  4610     05  CDRFND1F PIC  X(0001).
  4611     05  FILLER REDEFINES CDRFND1F.
  4612         10  CDRFND1A PIC  X(0001).
  4613     05  CDRFND1I PIC  X(0011).
  4614*    -------------------------------
  4615     05  CBILIT2L PIC S9(0004) COMP.
  4616     05  CBILIT2F PIC  X(0001).
  4617     05  FILLER REDEFINES CBILIT2F.
  4618         10  CBILIT2A PIC  X(0001).
  4619     05  CBILIT2I PIC  X(0008).
  4620*    -------------------------------
  4621     05  CDRFND2L PIC S9(0004) COMP.
  4622     05  CDRFND2F PIC  X(0001).
  4623     05  FILLER REDEFINES CDRFND2F.
  4624         10  CDRFND2A PIC  X(0001).
  4625     05  CDRFND2I PIC  X(0011).
  4626*    -------------------------------
  4627     05  CCANTXTL PIC S9(0004) COMP.
  4628     05  CCANTXTF PIC  X(0001).
  4629     05  FILLER REDEFINES CCANTXTF.
  4630         10  CCANTXTA PIC  X(0001).
  4631     05  CCANTXTI PIC  X(0005).
  4632*    -------------------------------
  4633     05  CCANFEEL PIC S9(0004) COMP.
  4634     05  CCANFEEF PIC  X(0001).
  4635     05  FILLER REDEFINES CCANFEEF.
  4636         10  CCANFEEA PIC  X(0001).
  4637     05  CCANFEEI PIC  X(0002).
  4638*    -------------------------------
  4639     05  CTERM1L PIC S9(0004) COMP.
  4640     05  CTERM1F PIC  X(0001).
  4641     05  FILLER REDEFINES CTERM1F.
  4642         10  CTERM1A PIC  X(0001).
  4643     05  CTERM1I PIC  X(0003).
  4644*    -------------------------------
  4645     05  CRTERM1L PIC S9(0004) COMP.
  4646     05  CRTERM1F PIC  X(0001).
  4647     05  FILLER REDEFINES CRTERM1F.
  4648         10  CRTERM1A PIC  X(0001).
  4649     05  CRTERM1I PIC  X(0003).
  4650*    -------------------------------
  4651     05  CPREM1L PIC S9(0004) COMP.
  4652     05  CPREM1F PIC  X(0001).
  4653     05  FILLER REDEFINES CPREM1F.
  4654         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  88
* EL6311.cbl
  4655     05  CPREM1I PIC  X(0011).
  4656*    -------------------------------
  4657     05  CTERM2L PIC S9(0004) COMP.
  4658     05  CTERM2F PIC  X(0001).
  4659     05  FILLER REDEFINES CTERM2F.
  4660         10  CTERM2A PIC  X(0001).
  4661     05  CTERM2I PIC  X(0003).
  4662*    -------------------------------
  4663     05  CRTERM2L PIC S9(0004) COMP.
  4664     05  CRTERM2F PIC  X(0001).
  4665     05  FILLER REDEFINES CRTERM2F.
  4666         10  CRTERM2A PIC  X(0001).
  4667     05  CRTERM2I PIC  X(0003).
  4668*    -------------------------------
  4669     05  CPREM2L PIC S9(0004) COMP.
  4670     05  CPREM2F PIC  X(0001).
  4671     05  FILLER REDEFINES CPREM2F.
  4672         10  CPREM2A PIC  X(0001).
  4673     05  CPREM2I PIC  X(0011).
  4674*    -------------------------------
  4675     05  CENTRDTL PIC S9(0004) COMP.
  4676     05  CENTRDTF PIC  X(0001).
  4677     05  FILLER REDEFINES CENTRDTF.
  4678         10  CENTRDTA PIC  X(0001).
  4679     05  CENTRDTI PIC  X(0008).
  4680*    -------------------------------
  4681     05  CPAYEEL PIC S9(0004) COMP.
  4682     05  CPAYEEF PIC  X(0001).
  4683     05  FILLER REDEFINES CPAYEEF.
  4684         10  CPAYEEA PIC  X(0001).
  4685     05  CPAYEEI PIC  X(0006).
  4686*    -------------------------------
  4687     05  CRFNDSWL PIC S9(0004) COMP.
  4688     05  CRFNDSWF PIC  X(0001).
  4689     05  FILLER REDEFINES CRFNDSWF.
  4690         10  CRFNDSWA PIC  X(0001).
  4691     05  CRFNDSWI PIC  X(0003).
  4692*    -------------------------------
  4693     05  CLFHDGL PIC S9(0004) COMP.
  4694     05  CLFHDGF PIC  X(0001).
  4695     05  FILLER REDEFINES CLFHDGF.
  4696         10  CLFHDGA PIC  X(0001).
  4697     05  CLFHDGI PIC  X(0006).
  4698*    -------------------------------
  4699     05  CAHHDGL PIC S9(0004) COMP.
  4700     05  CAHHDGF PIC  X(0001).
  4701     05  FILLER REDEFINES CAHHDGF.
  4702         10  CAHHDGA PIC  X(0001).
  4703     05  CAHHDGI PIC  X(0006).
  4704*    -------------------------------
  4705     05  CENTDTL PIC S9(0004) COMP.
  4706     05  CENTDTF PIC  X(0001).
  4707     05  FILLER REDEFINES CENTDTF.
  4708         10  CENTDTA PIC  X(0001).
  4709     05  CENTDTI PIC  X(0008).
  4710*    -------------------------------
  4711     05  CENTBYL PIC S9(0004) COMP.
  4712     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  89
* EL6311.cbl
  4713     05  FILLER REDEFINES CENTBYF.
  4714         10  CENTBYA PIC  X(0001).
  4715     05  CENTBYI PIC  X(0004).
  4716*    -------------------------------
  4717     05  CCHGCNTL PIC S9(0004) COMP.
  4718     05  CCHGCNTF PIC  X(0001).
  4719     05  FILLER REDEFINES CCHGCNTF.
  4720         10  CCHGCNTA PIC  X(0001).
  4721     05  CCHGCNTI PIC  X(0003).
  4722*    -------------------------------
  4723     05  CLFREFNL PIC S9(0004) COMP.
  4724     05  CLFREFNF PIC  X(0001).
  4725     05  FILLER REDEFINES CLFREFNF.
  4726         10  CLFREFNA PIC  X(0001).
  4727     05  CLFREFNI PIC  X(0006).
  4728*    -------------------------------
  4729     05  CAHREFNL PIC S9(0004) COMP.
  4730     05  CAHREFNF PIC  X(0001).
  4731     05  FILLER REDEFINES CAHREFNF.
  4732         10  CAHREFNA PIC  X(0001).
  4733     05  CAHREFNI PIC  X(0006).
  4734*    -------------------------------
  4735     05  CREINCDL PIC S9(0004) COMP.
  4736     05  CREINCDF PIC  X(0001).
  4737     05  FILLER REDEFINES CREINCDF.
  4738         10  CREINCDA PIC  X(0001).
  4739     05  CREINCDI PIC  X(0003).
  4740*    -------------------------------
  4741     05  CAEFFDTL PIC S9(0004) COMP.
  4742     05  CAEFFDTF PIC  X(0001).
  4743     05  FILLER REDEFINES CAEFFDTF.
  4744         10  CAEFFDTA PIC  X(0001).
  4745     05  CAEFFDTI PIC  X(0008).
  4746*    -------------------------------
  4747     05  CAEXPDTL PIC S9(0004) COMP.
  4748     05  CAEXPDTF PIC  X(0001).
  4749     05  FILLER REDEFINES CAEXPDTF.
  4750         10  CAEXPDTA PIC  X(0001).
  4751     05  CAEXPDTI PIC  X(0008).
  4752*    -------------------------------
  4753     05  COMMLFL PIC S9(0004) COMP.
  4754     05  COMMLFF PIC  X(0001).
  4755     05  FILLER REDEFINES COMMLFF.
  4756         10  COMMLFA PIC  X(0001).
  4757     05  COMMLFI PIC  X(0006).
  4758*    -------------------------------
  4759     05  COMMAHL PIC S9(0004) COMP.
  4760     05  COMMAHF PIC  X(0001).
  4761     05  FILLER REDEFINES COMMAHF.
  4762         10  COMMAHA PIC  X(0001).
  4763     05  COMMAHI PIC  X(0006).
  4764*    -------------------------------
  4765     05  CERMSG1L PIC S9(0004) COMP.
  4766     05  CERMSG1F PIC  X(0001).
  4767     05  FILLER REDEFINES CERMSG1F.
  4768         10  CERMSG1A PIC  X(0001).
  4769     05  CERMSG1I PIC  X(0078).
  4770*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  90
* EL6311.cbl
  4771     05  CERMSG2L PIC S9(0004) COMP.
  4772     05  CERMSG2F PIC  X(0001).
  4773     05  FILLER REDEFINES CERMSG2F.
  4774         10  CERMSG2A PIC  X(0001).
  4775     05  CERMSG2I PIC  X(0078).
  4776*    -------------------------------
  4777     05  CERMSG3L PIC S9(0004) COMP.
  4778     05  CERMSG3F PIC  X(0001).
  4779     05  FILLER REDEFINES CERMSG3F.
  4780         10  CERMSG3A PIC  X(0001).
  4781     05  CERMSG3I PIC  X(0078).
  4782*    -------------------------------
  4783     05  CPFENTRL PIC S9(0004) COMP.
  4784     05  CPFENTRF PIC  X(0001).
  4785     05  FILLER REDEFINES CPFENTRF.
  4786         10  CPFENTRA PIC  X(0001).
  4787     05  CPFENTRI PIC  9(2).
  4788*    -------------------------------
  4789     05  CPF5HDRL PIC S9(0004) COMP.
  4790     05  CPF5HDRF PIC  X(0001).
  4791     05  FILLER REDEFINES CPF5HDRF.
  4792         10  CPF5HDRA PIC  X(0001).
  4793     05  CPF5HDRI PIC  X(0005).
  4794*    -------------------------------
  4795     05  CPF4HDRL PIC S9(0004) COMP.
  4796     05  CPF4HDRF PIC  X(0001).
  4797     05  FILLER REDEFINES CPF4HDRF.
  4798         10  CPF4HDRA PIC  X(0001).
  4799     05  CPF4HDRI PIC  X(0013).
  4800*    -------------------------------
  4801     05  CF15HDRL PIC S9(0004) COMP.
  4802     05  CF15HDRF PIC  X(0001).
  4803     05  FILLER REDEFINES CF15HDRF.
  4804         10  CF15HDRA PIC  X(0001).
  4805     05  CF15HDRI PIC  X(0022).
  4806 01  EL631CO REDEFINES EL631BI.
  4807     05  FILLER            PIC  X(0012).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CDATEO PIC  X(0008).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CTIMEO PIC  99.99.
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CHEADO PIC  X(0038).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CCHGTO PIC  X(0004).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CCHGO PIC  ZZZ9.
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CMAINTO PIC  X(0001).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  91
* EL6311.cbl
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CCHGHDGO PIC  X(0003).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CMANTDTO PIC  X(0008).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CMANTATO PIC  99.99.
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CCSRO PIC  X(0004).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CBATCHO PIC  X(0006).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CSEQO PIC  X(0004).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CMOENDTO PIC  X(0008).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CCARRO PIC  X(0001).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CGROUPO PIC  X(0006).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CSTATEO PIC  X(0002).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CACCTO PIC  X(0010).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CORIGHDO PIC  X(0011).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CORGNOO PIC  X(0006).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CORGSEQO PIC  X(0004).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CREFHDGO PIC  X(0010).
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CREFO PIC  X(0012).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CNHINTO PIC  999999.99.
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CCERTNOO PIC  X(0010).
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CSUFIXO PIC  X(0001).
  4886*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  92
* EL6311.cbl
  4887     05  FILLER            PIC  X(0003).
  4888     05  CEFFDTO PIC  X(0008).
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CLSTNMO PIC  X(0015).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CPCYNO PIC  X(0001).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CINAMEO PIC  X(0015).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CINITSO PIC  X(0010).
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CCANREAO PIC  X(0001).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CKIND1O PIC  X(0002).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CCANDT1O PIC  X(0008).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CREFND1O PIC  Z(7).99-.
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CMTHD1O PIC  X(0001).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CKIND2O PIC  X(0002).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CCANDT2O PIC  X(0008).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CREFND2O PIC  Z(7).99-.
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CMTHD2O PIC  X(0001).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CLIVESO PIC  X(0003).
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CFORCEO PIC  X(0001).
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CBILCDO PIC  X(0001).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CCRFND1O PIC  Z(7).99-.
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CCRFND2O PIC  Z(7).99-.
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  93
* EL6311.cbl
  4945     05  CBILIT1O PIC  X(0008).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CDRFND1O PIC  Z(7).99-.
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CBILIT2O PIC  X(0008).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CDRFND2O PIC  Z(7).99-.
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CCANTXTO PIC  X(0005).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CCANFEEO PIC  Z9.
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CTERM1O PIC  ZZ9.
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CRTERM1O PIC  ZZ9.
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CPREM1O PIC  ZZZZZZ9.99-.
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CTERM2O PIC  ZZ9.
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CRTERM2O PIC  ZZ9.
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CPREM2O PIC  ZZZZZZ9.99-.
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CENTRDTO PIC  X(0008).
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CPAYEEO PIC  X(0006).
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CRFNDSWO PIC  X(0003).
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CLFHDGO PIC  X(0006).
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CAHHDGO PIC  X(0006).
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CENTDTO PIC  X(0008).
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CENTBYO PIC  X(0004).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  94
* EL6311.cbl
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CLFREFNO PIC  X(0006).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CAHREFNO PIC  X(0006).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CREINCDO PIC  X(0003).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CAEFFDTO PIC  X(0008).
  5015*    -------------------------------
  5016     05  FILLER            PIC  X(0003).
  5017     05  CAEXPDTO PIC  X(0008).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  COMMLFO PIC  .99999.
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  COMMAHO PIC  .99999.
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CERMSG1O PIC  X(0078).
  5027*    -------------------------------
  5028     05  FILLER            PIC  X(0003).
  5029     05  CERMSG2O PIC  X(0078).
  5030*    -------------------------------
  5031     05  FILLER            PIC  X(0003).
  5032     05  CERMSG3O PIC  X(0078).
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CPFENTRO PIC  X(0002).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  CPF5HDRO PIC  X(0005).
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  CPF4HDRO PIC  X(0013).
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  CF15HDRO PIC  X(0022).
  5045*    -------------------------------
  5046 01  EL631DI REDEFINES EL631BI.
  5047     05  FILLER            PIC  X(0012).
  5048*    -------------------------------
  5049     05  DDATEL PIC S9(0004) COMP.
  5050     05  DDATEF PIC  X(0001).
  5051     05  FILLER REDEFINES DDATEF.
  5052         10  DDATEA PIC  X(0001).
  5053     05  DDATEI PIC  X(0008).
  5054*    -------------------------------
  5055     05  DTIMEL PIC S9(0004) COMP.
  5056     05  DTIMEF PIC  X(0001).
  5057     05  FILLER REDEFINES DTIMEF.
  5058         10  DTIMEA PIC  X(0001).
  5059     05  DTIMEI PIC  X(0005).
  5060*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  95
* EL6311.cbl
  5061     05  DHEADL PIC S9(0004) COMP.
  5062     05  DHEADF PIC  X(0001).
  5063     05  FILLER REDEFINES DHEADF.
  5064         10  DHEADA PIC  X(0001).
  5065     05  DHEADI PIC  X(0038).
  5066*    -------------------------------
  5067     05  DLDATEL PIC S9(0004) COMP.
  5068     05  DLDATEF PIC  X(0001).
  5069     05  FILLER REDEFINES DLDATEF.
  5070         10  DLDATEA PIC  X(0001).
  5071     05  DLDATEI PIC  X(0010).
  5072*    -------------------------------
  5073     05  DBATCHL PIC S9(0004) COMP.
  5074     05  DBATCHF PIC  X(0001).
  5075     05  FILLER REDEFINES DBATCHF.
  5076         10  DBATCHA PIC  X(0001).
  5077     05  DBATCHI PIC  X(0011).
  5078*    -------------------------------
  5079     05  DACCTNML PIC S9(0004) COMP.
  5080     05  DACCTNMF PIC  X(0001).
  5081     05  FILLER REDEFINES DACCTNMF.
  5082         10  DACCTNMA PIC  X(0001).
  5083     05  DACCTNMI PIC  X(0030).
  5084*    -------------------------------
  5085     05  DPROCDTL PIC S9(0004) COMP.
  5086     05  DPROCDTF PIC  X(0001).
  5087     05  FILLER REDEFINES DPROCDTF.
  5088         10  DPROCDTA PIC  X(0001).
  5089     05  DPROCDTI PIC  X(0008).
  5090*    -------------------------------
  5091     05  DINPUTL PIC S9(0004) COMP.
  5092     05  DINPUTF PIC  X(0001).
  5093     05  FILLER REDEFINES DINPUTF.
  5094         10  DINPUTA PIC  X(0001).
  5095     05  DINPUTI PIC  X(0008).
  5096*    -------------------------------
  5097     05  DMAINDTL PIC S9(0004) COMP.
  5098     05  DMAINDTF PIC  X(0001).
  5099     05  FILLER REDEFINES DMAINDTF.
  5100         10  DMAINDTA PIC  X(0001).
  5101     05  DMAINDTI PIC  X(0008).
  5102*    -------------------------------
  5103     05  DCARRL PIC S9(0004) COMP.
  5104     05  DCARRF PIC  X(0001).
  5105     05  FILLER REDEFINES DCARRF.
  5106         10  DCARRA PIC  X(0001).
  5107     05  DCARRI PIC  X(0001).
  5108*    -------------------------------
  5109     05  DGROUPL PIC S9(0004) COMP.
  5110     05  DGROUPF PIC  X(0001).
  5111     05  FILLER REDEFINES DGROUPF.
  5112         10  DGROUPA PIC  X(0001).
  5113     05  DGROUPI PIC  X(0006).
  5114*    -------------------------------
  5115     05  DSTATEL PIC S9(0004) COMP.
  5116     05  DSTATEF PIC  X(0001).
  5117     05  FILLER REDEFINES DSTATEF.
  5118         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  96
* EL6311.cbl
  5119     05  DSTATEI PIC  X(0002).
  5120*    -------------------------------
  5121     05  DACCTL PIC S9(0004) COMP.
  5122     05  DACCTF PIC  X(0001).
  5123     05  FILLER REDEFINES DACCTF.
  5124         10  DACCTA PIC  X(0001).
  5125     05  DACCTI PIC  X(0010).
  5126*    -------------------------------
  5127     05  DRECVDTL PIC S9(0004) COMP.
  5128     05  DRECVDTF PIC  X(0001).
  5129     05  FILLER REDEFINES DRECVDTF.
  5130         10  DRECVDTA PIC  X(0001).
  5131     05  DRECVDTI PIC  X(0008).
  5132*    -------------------------------
  5133     05  DCSRL PIC S9(0004) COMP.
  5134     05  DCSRF PIC  X(0001).
  5135     05  FILLER REDEFINES DCSRF.
  5136         10  DCSRA PIC  X(0001).
  5137     05  DCSRI PIC  X(0004).
  5138*    -------------------------------
  5139     05  DREFHDGL PIC S9(0004) COMP.
  5140     05  DREFHDGF PIC  X(0001).
  5141     05  FILLER REDEFINES DREFHDGF.
  5142         10  DREFHDGA PIC  X(0001).
  5143     05  DREFHDGI PIC  X(0010).
  5144*    -------------------------------
  5145     05  DREFL PIC S9(0004) COMP.
  5146     05  DREFF PIC  X(0001).
  5147     05  FILLER REDEFINES DREFF.
  5148         10  DREFA PIC  X(0001).
  5149     05  DREFI PIC  X(0012).
  5150*    -------------------------------
  5151     05  DLFPHDGL PIC S9(0004) COMP.
  5152     05  DLFPHDGF PIC  X(0001).
  5153     05  FILLER REDEFINES DLFPHDGF.
  5154         10  DLFPHDGA PIC  X(0001).
  5155     05  DLFPHDGI PIC  X(0010).
  5156*    -------------------------------
  5157     05  DAHPHDGL PIC S9(0004) COMP.
  5158     05  DAHPHDGF PIC  X(0001).
  5159     05  FILLER REDEFINES DAHPHDGF.
  5160         10  DAHPHDGA PIC  X(0001).
  5161     05  DAHPHDGI PIC  X(0010).
  5162*    -------------------------------
  5163     05  DLFRHDGL PIC S9(0004) COMP.
  5164     05  DLFRHDGF PIC  X(0001).
  5165     05  FILLER REDEFINES DLFRHDGF.
  5166         10  DLFRHDGA PIC  X(0001).
  5167     05  DLFRHDGI PIC  X(0009).
  5168*    -------------------------------
  5169     05  DAHRHDGL PIC S9(0004) COMP.
  5170     05  DAHRHDGF PIC  X(0001).
  5171     05  FILLER REDEFINES DAHRHDGF.
  5172         10  DAHRHDGA PIC  X(0001).
  5173     05  DAHRHDGI PIC  X(0009).
  5174*    -------------------------------
  5175     05  DRISSL PIC S9(0004) COMP.
  5176     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  97
* EL6311.cbl
  5177     05  FILLER REDEFINES DRISSF.
  5178         10  DRISSA PIC  X(0001).
  5179     05  DRISSI PIC  X(0005).
  5180*    -------------------------------
  5181     05  DRLFPRML PIC S9(0004) COMP.
  5182     05  DRLFPRMF PIC  X(0001).
  5183     05  FILLER REDEFINES DRLFPRMF.
  5184         10  DRLFPRMA PIC  X(0001).
  5185     05  DRLFPRMI PIC  S9(9)V99.
  5186*    -------------------------------
  5187     05  DRAHPRML PIC S9(0004) COMP.
  5188     05  DRAHPRMF PIC  X(0001).
  5189     05  FILLER REDEFINES DRAHPRMF.
  5190         10  DRAHPRMA PIC  X(0001).
  5191     05  DRAHPRMI PIC  S9(9)V99.
  5192*    -------------------------------
  5193     05  DRCANCL PIC S9(0004) COMP.
  5194     05  DRCANCF PIC  X(0001).
  5195     05  FILLER REDEFINES DRCANCF.
  5196         10  DRCANCA PIC  X(0001).
  5197     05  DRCANCI PIC  X(0005).
  5198*    -------------------------------
  5199     05  DRLFRFDL PIC S9(0004) COMP.
  5200     05  DRLFRFDF PIC  X(0001).
  5201     05  FILLER REDEFINES DRLFRFDF.
  5202         10  DRLFRFDA PIC  X(0001).
  5203     05  DRLFRFDI PIC  S9(9)V99.
  5204*    -------------------------------
  5205     05  DRAHRFDL PIC S9(0004) COMP.
  5206     05  DRAHRFDF PIC  X(0001).
  5207     05  FILLER REDEFINES DRAHRFDF.
  5208         10  DRAHRFDA PIC  X(0001).
  5209     05  DRAHRFDI PIC  S9(9)V99.
  5210*    -------------------------------
  5211     05  DEISSL PIC S9(0004) COMP.
  5212     05  DEISSF PIC  X(0001).
  5213     05  FILLER REDEFINES DEISSF.
  5214         10  DEISSA PIC  X(0001).
  5215     05  DEISSI PIC  X(0005).
  5216*    -------------------------------
  5217     05  DELFPRML PIC S9(0004) COMP.
  5218     05  DELFPRMF PIC  X(0001).
  5219     05  FILLER REDEFINES DELFPRMF.
  5220         10  DELFPRMA PIC  X(0001).
  5221     05  DELFPRMI PIC  X(0011).
  5222*    -------------------------------
  5223     05  DEAHPRML PIC S9(0004) COMP.
  5224     05  DEAHPRMF PIC  X(0001).
  5225     05  FILLER REDEFINES DEAHPRMF.
  5226         10  DEAHPRMA PIC  X(0001).
  5227     05  DEAHPRMI PIC  X(0011).
  5228*    -------------------------------
  5229     05  DECANCL PIC S9(0004) COMP.
  5230     05  DECANCF PIC  X(0001).
  5231     05  FILLER REDEFINES DECANCF.
  5232         10  DECANCA PIC  X(0001).
  5233     05  DECANCI PIC  X(0005).
  5234*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  98
* EL6311.cbl
  5235     05  DELFRFDL PIC S9(0004) COMP.
  5236     05  DELFRFDF PIC  X(0001).
  5237     05  FILLER REDEFINES DELFRFDF.
  5238         10  DELFRFDA PIC  X(0001).
  5239     05  DELFRFDI PIC  X(0011).
  5240*    -------------------------------
  5241     05  DEAHRFDL PIC S9(0004) COMP.
  5242     05  DEAHRFDF PIC  X(0001).
  5243     05  FILLER REDEFINES DEAHRFDF.
  5244         10  DEAHRFDA PIC  X(0001).
  5245     05  DEAHRFDI PIC  X(0011).
  5246*    -------------------------------
  5247     05  DCISSL PIC S9(0004) COMP.
  5248     05  DCISSF PIC  X(0001).
  5249     05  FILLER REDEFINES DCISSF.
  5250         10  DCISSA PIC  X(0001).
  5251     05  DCISSI PIC  X(0005).
  5252*    -------------------------------
  5253     05  DCLFPRML PIC S9(0004) COMP.
  5254     05  DCLFPRMF PIC  X(0001).
  5255     05  FILLER REDEFINES DCLFPRMF.
  5256         10  DCLFPRMA PIC  X(0001).
  5257     05  DCLFPRMI PIC  X(0011).
  5258*    -------------------------------
  5259     05  DCAHPRML PIC S9(0004) COMP.
  5260     05  DCAHPRMF PIC  X(0001).
  5261     05  FILLER REDEFINES DCAHPRMF.
  5262         10  DCAHPRMA PIC  X(0001).
  5263     05  DCAHPRMI PIC  X(0011).
  5264*    -------------------------------
  5265     05  DCCANCL PIC S9(0004) COMP.
  5266     05  DCCANCF PIC  X(0001).
  5267     05  FILLER REDEFINES DCCANCF.
  5268         10  DCCANCA PIC  X(0001).
  5269     05  DCCANCI PIC  X(0005).
  5270*    -------------------------------
  5271     05  DCLFRFDL PIC S9(0004) COMP.
  5272     05  DCLFRFDF PIC  X(0001).
  5273     05  FILLER REDEFINES DCLFRFDF.
  5274         10  DCLFRFDA PIC  X(0001).
  5275     05  DCLFRFDI PIC  X(0011).
  5276*    -------------------------------
  5277     05  DCAHRFDL PIC S9(0004) COMP.
  5278     05  DCAHRFDF PIC  X(0001).
  5279     05  FILLER REDEFINES DCAHRFDF.
  5280         10  DCAHRFDA PIC  X(0001).
  5281     05  DCAHRFDI PIC  X(0011).
  5282*    -------------------------------
  5283     05  DOISSL PIC S9(0004) COMP.
  5284     05  DOISSF PIC  X(0001).
  5285     05  FILLER REDEFINES DOISSF.
  5286         10  DOISSA PIC  X(0001).
  5287     05  DOISSI PIC  X(0005).
  5288*    -------------------------------
  5289     05  DOLFPRML PIC S9(0004) COMP.
  5290     05  DOLFPRMF PIC  X(0001).
  5291     05  FILLER REDEFINES DOLFPRMF.
  5292         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page  99
* EL6311.cbl
  5293     05  DOLFPRMI PIC  X(0011).
  5294*    -------------------------------
  5295     05  DOAHPRML PIC S9(0004) COMP.
  5296     05  DOAHPRMF PIC  X(0001).
  5297     05  FILLER REDEFINES DOAHPRMF.
  5298         10  DOAHPRMA PIC  X(0001).
  5299     05  DOAHPRMI PIC  X(0011).
  5300*    -------------------------------
  5301     05  DOCANCL PIC S9(0004) COMP.
  5302     05  DOCANCF PIC  X(0001).
  5303     05  FILLER REDEFINES DOCANCF.
  5304         10  DOCANCA PIC  X(0001).
  5305     05  DOCANCI PIC  X(0005).
  5306*    -------------------------------
  5307     05  DOLFRFDL PIC S9(0004) COMP.
  5308     05  DOLFRFDF PIC  X(0001).
  5309     05  FILLER REDEFINES DOLFRFDF.
  5310         10  DOLFRFDA PIC  X(0001).
  5311     05  DOLFRFDI PIC  X(0011).
  5312*    -------------------------------
  5313     05  DOAHRFDL PIC S9(0004) COMP.
  5314     05  DOAHRFDF PIC  X(0001).
  5315     05  FILLER REDEFINES DOAHRFDF.
  5316         10  DOAHRFDA PIC  X(0001).
  5317     05  DOAHRFDI PIC  X(0011).
  5318*    -------------------------------
  5319     05  DITOTALL PIC S9(0004) COMP.
  5320     05  DITOTALF PIC  X(0001).
  5321     05  FILLER REDEFINES DITOTALF.
  5322         10  DITOTALA PIC  X(0001).
  5323     05  DITOTALI PIC  X(0005).
  5324*    -------------------------------
  5325     05  DIFATALL PIC S9(0004) COMP.
  5326     05  DIFATALF PIC  X(0001).
  5327     05  FILLER REDEFINES DIFATALF.
  5328         10  DIFATALA PIC  X(0001).
  5329     05  DIFATALI PIC  X(0005).
  5330*    -------------------------------
  5331     05  DIFORCEL PIC S9(0004) COMP.
  5332     05  DIFORCEF PIC  X(0001).
  5333     05  FILLER REDEFINES DIFORCEF.
  5334         10  DIFORCEA PIC  X(0001).
  5335     05  DIFORCEI PIC  X(0005).
  5336*    -------------------------------
  5337     05  DIHOLDL PIC S9(0004) COMP.
  5338     05  DIHOLDF PIC  X(0001).
  5339     05  FILLER REDEFINES DIHOLDF.
  5340         10  DIHOLDA PIC  X(0001).
  5341     05  DIHOLDI PIC  X(0005).
  5342*    -------------------------------
  5343     05  DIAVAILL PIC S9(0004) COMP.
  5344     05  DIAVAILF PIC  X(0001).
  5345     05  FILLER REDEFINES DIAVAILF.
  5346         10  DIAVAILA PIC  X(0001).
  5347     05  DIAVAILI PIC  X(0005).
  5348*    -------------------------------
  5349     05  DIGPREML PIC S9(0004) COMP.
  5350     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 100
* EL6311.cbl
  5351     05  FILLER REDEFINES DIGPREMF.
  5352         10  DIGPREMA PIC  X(0001).
  5353     05  DIGPREMI PIC  X(0011).
  5354*    -------------------------------
  5355     05  DIBPREML PIC S9(0004) COMP.
  5356     05  DIBPREMF PIC  X(0001).
  5357     05  FILLER REDEFINES DIBPREMF.
  5358         10  DIBPREMA PIC  X(0001).
  5359     05  DIBPREMI PIC  X(0011).
  5360*    -------------------------------
  5361     05  DCTOTALL PIC S9(0004) COMP.
  5362     05  DCTOTALF PIC  X(0001).
  5363     05  FILLER REDEFINES DCTOTALF.
  5364         10  DCTOTALA PIC  X(0001).
  5365     05  DCTOTALI PIC  X(0005).
  5366*    -------------------------------
  5367     05  DCFATALL PIC S9(0004) COMP.
  5368     05  DCFATALF PIC  X(0001).
  5369     05  FILLER REDEFINES DCFATALF.
  5370         10  DCFATALA PIC  X(0001).
  5371     05  DCFATALI PIC  X(0005).
  5372*    -------------------------------
  5373     05  DCFORCEL PIC S9(0004) COMP.
  5374     05  DCFORCEF PIC  X(0001).
  5375     05  FILLER REDEFINES DCFORCEF.
  5376         10  DCFORCEA PIC  X(0001).
  5377     05  DCFORCEI PIC  X(0005).
  5378*    -------------------------------
  5379     05  DCHOLDL PIC S9(0004) COMP.
  5380     05  DCHOLDF PIC  X(0001).
  5381     05  FILLER REDEFINES DCHOLDF.
  5382         10  DCHOLDA PIC  X(0001).
  5383     05  DCHOLDI PIC  X(0005).
  5384*    -------------------------------
  5385     05  DCAVAILL PIC S9(0004) COMP.
  5386     05  DCAVAILF PIC  X(0001).
  5387     05  FILLER REDEFINES DCAVAILF.
  5388         10  DCAVAILA PIC  X(0001).
  5389     05  DCAVAILI PIC  X(0005).
  5390*    -------------------------------
  5391     05  DCGPREML PIC S9(0004) COMP.
  5392     05  DCGPREMF PIC  X(0001).
  5393     05  FILLER REDEFINES DCGPREMF.
  5394         10  DCGPREMA PIC  X(0001).
  5395     05  DCGPREMI PIC  X(0011).
  5396*    -------------------------------
  5397     05  DCBPREML PIC S9(0004) COMP.
  5398     05  DCBPREMF PIC  X(0001).
  5399     05  FILLER REDEFINES DCBPREMF.
  5400         10  DCBPREMA PIC  X(0001).
  5401     05  DCBPREMI PIC  X(0011).
  5402*    -------------------------------
  5403     05  DNTOTALL PIC S9(0004) COMP.
  5404     05  DNTOTALF PIC  X(0001).
  5405     05  FILLER REDEFINES DNTOTALF.
  5406         10  DNTOTALA PIC  X(0001).
  5407     05  DNTOTALI PIC  X(0005).
  5408*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 101
* EL6311.cbl
  5409     05  DNFATALL PIC S9(0004) COMP.
  5410     05  DNFATALF PIC  X(0001).
  5411     05  FILLER REDEFINES DNFATALF.
  5412         10  DNFATALA PIC  X(0001).
  5413     05  DNFATALI PIC  X(0005).
  5414*    -------------------------------
  5415     05  DNFORCEL PIC S9(0004) COMP.
  5416     05  DNFORCEF PIC  X(0001).
  5417     05  FILLER REDEFINES DNFORCEF.
  5418         10  DNFORCEA PIC  X(0001).
  5419     05  DNFORCEI PIC  X(0005).
  5420*    -------------------------------
  5421     05  DNHOLDL PIC S9(0004) COMP.
  5422     05  DNHOLDF PIC  X(0001).
  5423     05  FILLER REDEFINES DNHOLDF.
  5424         10  DNHOLDA PIC  X(0001).
  5425     05  DNHOLDI PIC  X(0005).
  5426*    -------------------------------
  5427     05  DNAVAILL PIC S9(0004) COMP.
  5428     05  DNAVAILF PIC  X(0001).
  5429     05  FILLER REDEFINES DNAVAILF.
  5430         10  DNAVAILA PIC  X(0001).
  5431     05  DNAVAILI PIC  X(0005).
  5432*    -------------------------------
  5433     05  DNGPREML PIC S9(0004) COMP.
  5434     05  DNGPREMF PIC  X(0001).
  5435     05  FILLER REDEFINES DNGPREMF.
  5436         10  DNGPREMA PIC  X(0001).
  5437     05  DNGPREMI PIC  X(0011).
  5438*    -------------------------------
  5439     05  DNBPREML PIC S9(0004) COMP.
  5440     05  DNBPREMF PIC  X(0001).
  5441     05  FILLER REDEFINES DNBPREMF.
  5442         10  DNBPREMA PIC  X(0001).
  5443     05  DNBPREMI PIC  X(0011).
  5444*    -------------------------------
  5445     05  DERMSGL PIC S9(0004) COMP.
  5446     05  DERMSGF PIC  X(0001).
  5447     05  FILLER REDEFINES DERMSGF.
  5448         10  DERMSGA PIC  X(0001).
  5449     05  DERMSGI PIC  X(0075).
  5450*    -------------------------------
  5451     05  DPFENTRL PIC S9(0004) COMP.
  5452     05  DPFENTRF PIC  X(0001).
  5453     05  FILLER REDEFINES DPFENTRF.
  5454         10  DPFENTRA PIC  X(0001).
  5455     05  DPFENTRI PIC  9(2).
  5456 01  EL631DO REDEFINES EL631BI.
  5457     05  FILLER            PIC  X(0012).
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DDATEO PIC  X(0008).
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DTIMEO PIC  99.99.
  5464*    -------------------------------
  5465     05  FILLER            PIC  X(0003).
  5466     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 102
* EL6311.cbl
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DLDATEO PIC  X(0010).
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DBATCHO PIC  X(0011).
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DACCTNMO PIC  X(0030).
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DPROCDTO PIC  X(0008).
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DINPUTO PIC  X(0008).
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DMAINDTO PIC  X(0008).
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DCARRO PIC  X(0001).
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DGROUPO PIC  X(0006).
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DSTATEO PIC  X(0002).
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DACCTO PIC  X(0010).
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DRECVDTO PIC  X(0008).
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DCSRO PIC  X(0004).
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DREFHDGO PIC  X(0010).
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DREFO PIC  X(0012).
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DLFPHDGO PIC  X(0010).
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DAHPHDGO PIC  X(0010).
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DLFRHDGO PIC  X(0009).
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DAHRHDGO PIC  X(0009).
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DRISSO PIC  ZZ99-.
  5524*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 103
* EL6311.cbl
  5525     05  FILLER            PIC  X(0003).
  5526     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DRCANCO PIC  ZZ99-.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DEISSO PIC  ZZ99-.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DECANCO PIC  ZZ99-.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DCISSO PIC  ZZ99-.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DCCANCO PIC  ZZ99-.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DOISSO PIC  ZZ99-.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 104
* EL6311.cbl
  5583     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DOCANCO PIC  ZZ99-.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DITOTALO PIC  ZZZ99.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DIFATALO PIC  ZZZ99.
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
  5601     05  DIFORCEO PIC  ZZZ99.
  5602*    -------------------------------
  5603     05  FILLER            PIC  X(0003).
  5604     05  DIHOLDO PIC  ZZZ99.
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DIAVAILO PIC  ZZZ99.
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DCTOTALO PIC  ZZZ99.
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DCFATALO PIC  ZZZ99.
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DCFORCEO PIC  ZZZ99.
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DCHOLDO PIC  ZZZ99.
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DCAVAILO PIC  ZZZ99.
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DNTOTALO PIC  ---99.
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 105
* EL6311.cbl
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DNFORCEO PIC  ---99.
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DNHOLDO PIC  ---99.
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DNAVAILO PIC  ---99.
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DNGPREMO PIC  -------9.99.
  5653*    -------------------------------
  5654     05  FILLER            PIC  X(0003).
  5655     05  DNBPREMO PIC  -------9.99.
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DERMSGO PIC  X(0075).
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DPFENTRO PIC  X(0002).
  5662*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 106
* EL6311.cbl
  5664 01  MAP-B REDEFINES EL631BI.
  5665     12  FILLER                  PIC X(591).
  5666*    12  FILLER                  PIC X(512).
  5667*    12  FILLER                  PIC X(510).
  5668     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5669         16  BKIND-LEN               PIC S9(4)  COMP.
  5670         16  BKIND-ATTRB             PIC X.
  5671         16  BKIND                   PIC XX.
  5672         16  BTYPE-LEN               PIC S9(4)  COMP.
  5673         16  BTYPE-ATTRB             PIC X.
  5674         16  BTYPE                   PIC X(3).
  5675         16  BTERM-LEN               PIC S9(4)  COMP.
  5676         16  BTERM-ATTRB             PIC X.
  5677         16  BTERMI                  PIC 999.
  5678         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5679         16  BBEN-LEN                PIC S9(4)  COMP.
  5680         16  BBEN-ATTRB              PIC X.
  5681         16  BBENI                   PIC 9(10)V99.
  5682*        16  BBENI                   PIC 9(12).
  5683         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5684         16  BPREM-LEN               PIC S9(4)  COMP.
  5685         16  BPREM-ATTRB             PIC X.
  5686         16  BPREMI                  PIC S9(9)V99.
  5687*        16  BPREMI                  PIC 9(11).
  5688         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5689         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5690         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5691         16  BEXPIRE-ATTRB           PIC X.
  5692         16  BEXPIRE                 PIC X(8).
  5693         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5694         16  BCRIT-PERD-ATTRB        PIC X.
  5695         16  BCRIT-PERDI             PIC 99.
  5696         16  BCRIT-PERDO REDEFINES
  5697                         BCRIT-PERDI PIC ZZ.
  5698         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5699         16  BALT-BEN-ATTRB          PIC X.
  5700         16  BALT-BENI               PIC 9(10)V99.
  5701*        16  BALT-BENI               PIC 9(12).
  5702         16  BALT-BENO REDEFINES
  5703                           BALT-BENI PIC Z(9).ZZ.
  5704         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5705         16  BALT-PREM-ATTRB         PIC X.
  5706         16  BALT-PREMI              PIC 9(9)V99.
  5707*        16  BALT-PREMI              PIC 9(11).
  5708         16  BALT-PREMO REDEFINES
  5709                          BALT-PREMI PIC Z(7).ZZ-.
  5710         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5711         16  BBEN-CD-ATTRB           PIC X.
  5712         16  BBEN-CD                 PIC XXX.
  5713         16  BCPREM-LEN              PIC S9(4)  COMP.
  5714         16  BCPREM-ATTRB            PIC X.
  5715         16  BCPREMI                 PIC S9(9)V99.
  5716*        16  BCPREMI                 PIC X(11).
  5717         16  BCPREMO REDEFINES BCPREMI
  5718                                     PIC Z(7).99-.
  5719         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5720         16  BCALT-PREM-ATTRB        PIC X.
  5721         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 107
* EL6311.cbl
  5722         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5723         16  BBEN-ABBR-ATTRB         PIC X.
  5724         16  BBEN-ABBR               PIC X(5).
  5725         16  BDIFF-LEN               PIC S9(4)  COMP.
  5726         16  BDIFF-ATTRB             PIC X.
  5727         16  BDIFFO                  PIC Z(7).99-.
  5728         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5729         16  BBILL-LIT-ATTRB         PIC X.
  5730         16  BBILL-LIT               PIC X(8).
  5731         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5732         16  BDALT-PREM-ATTRB        PIC X.
  5733         16  BDALT-PREM              PIC Z(7).99-.
  5734
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 108
* EL6311.cbl
  5736
  5737****************************************************************
  5738*
  5739* Copyright (c) 2007 by Clerity Solutions, Inc.
  5740* All rights reserved.
  5741*
  5742****************************************************************
  5743 01  DFHEIV.
  5744   02  DFHEIV0               PIC X(35).
  5745   02  DFHEIV1               PIC X(08).
  5746   02  DFHEIV2               PIC X(08).
  5747   02  DFHEIV3               PIC X(08).
  5748   02  DFHEIV4               PIC X(06).
  5749   02  DFHEIV5               PIC X(04).
  5750   02  DFHEIV6               PIC X(04).
  5751   02  DFHEIV7               PIC X(02).
  5752   02  DFHEIV8               PIC X(02).
  5753   02  DFHEIV9               PIC X(01).
  5754   02  DFHEIV10              PIC S9(7) COMP-3.
  5755   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5756   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5757   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5758   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5759   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5760   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5761   02  DFHEIV17              PIC X(04).
  5762   02  DFHEIV18              PIC X(04).
  5763   02  DFHEIV19              PIC X(04).
  5764   02  DFHEIV20              USAGE IS POINTER.
  5765   02  DFHEIV21              USAGE IS POINTER.
  5766   02  DFHEIV22              USAGE IS POINTER.
  5767   02  DFHEIV23              USAGE IS POINTER.
  5768   02  DFHEIV24              USAGE IS POINTER.
  5769   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5770   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5771   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5772   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5773   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5774   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5775   02  FILLER                PIC X(02).
  5776   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5777   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5778   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5779   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5780   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5781 LINKAGE  SECTION.
  5782*****************************************************************
  5783*                                                               *
  5784* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5785* All rights reserved.                                          *
  5786*                                                               *
  5787*****************************************************************
  5788 01  dfheiblk.
  5789     02  eibtime          pic s9(7) comp-3.
  5790     02  eibdate          pic s9(7) comp-3.
  5791     02  eibtrnid         pic x(4).
  5792     02  eibtaskn         pic s9(7) comp-3.
  5793     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 109
* EL6311.cbl
  5794     02  dfheigdi         pic s9(4) comp.
  5795     02  eibcposn         pic s9(4) comp.
  5796     02  eibcalen         pic s9(4) comp.
  5797     02  eibaid           pic x(1).
  5798     02  eibfiller1       pic x(1).
  5799     02  eibfn            pic x(2).
  5800     02  eibfiller2       pic x(2).
  5801     02  eibrcode         pic x(6).
  5802     02  eibfiller3       pic x(2).
  5803     02  eibds            pic x(8).
  5804     02  eibreqid         pic x(8).
  5805     02  eibrsrce         pic x(8).
  5806     02  eibsync          pic x(1).
  5807     02  eibfree          pic x(1).
  5808     02  eibrecv          pic x(1).
  5809     02  eibsend          pic x(1).
  5810     02  eibatt           pic x(1).
  5811     02  eibeoc           pic x(1).
  5812     02  eibfmh           pic x(1).
  5813     02  eibcompl         pic x(1).
  5814     02  eibsig           pic x(1).
  5815     02  eibconf          pic x(1).
  5816     02  eiberr           pic x(1).
  5817     02  eibrldbk         pic x(1).
  5818     02  eiberrcd         pic x(4).
  5819     02  eibsynrb         pic x(1).
  5820     02  eibnodat         pic x(1).
  5821     02  eibfiller5       pic x(2).
  5822     02  eibresp          pic 9(09) comp.
  5823     02  eibresp2         pic 9(09) comp.
  5824     02  dfheigdj         pic s9(4) comp.
  5825     02  dfheigdk         pic s9(4) comp.
  5826 01  DFHCOMMAREA                 PIC X(1300).
  5827*                                COPY ERCPNDB.
  5828******************************************************************
  5829*                                                                *
  5830*                                                                *
  5831*                            ERCPNDB.                            *
  5832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5833*                            VMOD=2.025                          *
  5834*                                                                *
  5835*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5836*                                                                *
  5837******************************************************************
  5838*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5839*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5840******************************************************************
  5841*                                                                *
  5842*                                                                *
  5843*   FILE TYPE = VSAM,KSDS                                        *
  5844*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5845*                                                                *
  5846*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5847*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5848*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5849*                                                 RKP=13,LEN=36  *
  5850*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5851*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 110
* EL6311.cbl
  5852*                                                RKP=49,LEN=11   *
  5853*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5854*                                      AND CHG-SEQ.)             *
  5855*                                                RKP=60,LEN=15   *
  5856*                                                                *
  5857*   LOG = NO                                                     *
  5858*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5859******************************************************************
  5860******************************************************************
  5861*                   C H A N G E   L O G
  5862*
  5863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5864*-----------------------------------------------------------------
  5865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5866* EFFECTIVE    NUMBER
  5867*-----------------------------------------------------------------
  5868* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5869* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5870* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5871* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5872* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5873* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5874* 032306                   PEMA  ADD BOW LOAN NUMBER
  5875* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5876* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5877* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5878* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5879* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5880* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5881* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5882* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5883* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5884******************************************************************
  5885
  5886 01  PENDING-BUSINESS.
  5887     12  PB-RECORD-ID                     PIC XX.
  5888         88  VALID-PB-ID                        VALUE 'PB'.
  5889
  5890     12  PB-CONTROL-PRIMARY.
  5891         16  PB-COMPANY-CD                PIC X.
  5892         16  PB-ENTRY-BATCH               PIC X(6).
  5893         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5894         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5895
  5896     12  PB-CONTROL-BY-ACCOUNT.
  5897         16  PB-COMPANY-CD-A1             PIC X.
  5898         16  PB-CARRIER                   PIC X.
  5899         16  PB-GROUPING.
  5900             20  PB-GROUPING-PREFIX       PIC XXX.
  5901             20  PB-GROUPING-PRIME        PIC XXX.
  5902         16  PB-STATE                     PIC XX.
  5903         16  PB-ACCOUNT.
  5904             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5905             20  PB-ACCOUNT-PRIME         PIC X(6).
  5906         16  PB-CERT-EFF-DT               PIC XX.
  5907         16  PB-CERT-NO.
  5908             20  PB-CERT-PRIME            PIC X(10).
  5909             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 111
* EL6311.cbl
  5910         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5911
  5912         16  PB-RECORD-TYPE               PIC X.
  5913             88  PB-MAILING-DATA                VALUE '0'.
  5914             88  PB-ISSUE                       VALUE '1'.
  5915             88  PB-CANCELLATION                VALUE '2'.
  5916             88  PB-BATCH-TRAILER               VALUE '9'.
  5917
  5918     12  PB-CONTROL-BY-ORIG-BATCH.
  5919         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5920         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5921         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5922         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5923
  5924     12  PB-CONTROL-BY-CSR.
  5925         16  PB-CSR-COMPANY-CD            PIC X.
  5926         16  PB-CSR-ID                    PIC X(4).
  5927         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5928         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5929         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5930******************************************************************
  5931*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5932******************************************************************
  5933
  5934     12  PB-LAST-MAINT-DT                 PIC XX.
  5935     12  PB-LAST-MAINT-BY                 PIC X(4).
  5936     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5937
  5938     12  PB-RECORD-BODY                   PIC X(375).
  5939
  5940     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5941         16  PB-CERT-ORIGIN               PIC X.
  5942             88  CLASIC-CREATED-CERT         VALUE '1'.
  5943         16  PB-I-NAME.
  5944             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5945             20  PB-I-INSURED-FIRST-NAME.
  5946                 24  PB-I-INSURED-1ST-INIT PIC X.
  5947                 24  FILLER                PIC X(9).
  5948             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5949         16  PB-I-AGE                     PIC S99   COMP-3.
  5950         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5951         16  PB-I-BIRTHDAY                PIC XX.
  5952         16  PB-I-INSURED-SEX             PIC X.
  5953             88  PB-SEX-MALE     VALUE 'M'.
  5954             88  PB-SEX-FEMALE   VALUE 'F'.
  5955
  5956         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5957         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5958         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5959         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5960         16  PB-I-SKIP-CODE               PIC X.
  5961             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5962             88  PB-SKIP-JULY              VALUE '1'.
  5963             88  PB-SKIP-AUGUST            VALUE '2'.
  5964             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5965             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5966             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5967             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 112
* EL6311.cbl
  5968             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5969             88  PB-SKIP-JUNE              VALUE '8'.
  5970             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5971             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5972             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5973         16  PB-I-TERM-TYPE               PIC X.
  5974             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5975             88  PB-PAID-WEEKLY            VALUE 'W'.
  5976             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5977             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5978             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5979         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5980         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5981         16  PB-I-DATA-ENTRY-SW           PIC X.
  5982             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5983             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5984             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5985             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5986         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5987         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5988*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5989         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5990         16  FILLER                       PIC X.
  5991
  5992         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5993             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5994             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5995                                                   '90' THRU '99'.
  5996         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5997                                          PIC XX.
  5998         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5999         16  PB-I-AMOUNT-FINANCED REDEFINES
  6000                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6001         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6002         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6003                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6004         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6005         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6006         16  PB-I-CLP-AMOUNT REDEFINES
  6007                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6008         16  PB-I-LF-CALC-FLAG            PIC X.
  6009             88 PB-COMP-LF-PREM               VALUE '?'.
  6010         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6011         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6012         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6013         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6014         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6015         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6016         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6017         16  PB-I-LF-ABBR                 PIC XXX.
  6018         16  PB-I-LF-INPUT-CD             PIC XX.
  6019
  6020         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6021             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6022             88  PB-INVALID-AH               VALUE '  ' '00'
  6023                                                   '90' THRU '99'.
  6024         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6025         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 113
* EL6311.cbl
  6026         16  PB-I-AH-CALC-FLAG            PIC X.
  6027             88 PB-COMP-AH-PREM                  VALUE '?'.
  6028         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6029         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6030         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6031         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6032         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6033         16  PB-I-AH-ABBR                 PIC XXX.
  6034         16  PB-I-AH-INPUT-CD             PIC XXX.
  6035
  6036         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6037         16  PB-I-REIN-TABLE              PIC XXX.
  6038         16  PB-I-BUSINESS-TYPE           PIC 99.
  6039         16  PB-I-INDV-GRP-CD             PIC X.
  6040         16  PB-I-MORT-CODE.
  6041             20  PB-I-TABLE               PIC X.
  6042             20  PB-I-INTEREST            PIC XX.
  6043             20  PB-I-MORT-TYP            PIC X.
  6044         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6045         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6046         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6047         16  PB-I-INDV-GRP-OVRD           PIC X.
  6048         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6049         16  PB-I-SIG-SW                  PIC X.
  6050             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6051         16  PB-I-RATE-CLASS              PIC XX.
  6052         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6053         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6054         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6055         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6056         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6057         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6058         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6059         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6060         16  PB-I-OB-FLAG                 PIC X.
  6061             88  PB-I-OB                      VALUE 'B'.
  6062             88  PB-I-SUMMARY                 VALUE 'Z'.
  6063         16  PB-I-ENTRY-STATUS            PIC X.
  6064             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6065                                              'M' '5' '9' '2'.
  6066             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6067             88  PB-I-POLICY-PENDING          VALUE '2'.
  6068             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6069             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6070             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6071             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6072             88  PB-I-REIN-ONLY               VALUE '9'.
  6073             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6074             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6075             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6076             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6077         16  PB-I-INT-CODE                PIC X.
  6078             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6079             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6080         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6081         16  PB-I-SOC-SEC-NO              PIC X(11).
  6082         16  PB-I-MEMBER-NO               PIC X(12).
  6083         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 114
* EL6311.cbl
  6084*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6085         16  PB-I-OLD-LOF                 PIC XXX.
  6086         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6087         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6088         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6089         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6090         16  PB-I-LIFE-INDICATOR          PIC X.
  6091             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6092         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6093         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6094                                          PIC S9(5)V99    COMP-3.
  6095         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6096             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6097             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6098         16  PB-I-1ST-PMT-DT              PIC XX.
  6099         16  PB-I-JOINT-INSURED.
  6100             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6101             20 PB-I-JOINT-FIRST-NAME.
  6102                24  PB-I-JOINT-FIRST-INIT PIC X.
  6103                24  FILLER                PIC X(9).
  6104             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6105*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6106         16  PB-I-BENEFICIARY-NAME.
  6107             20  PB-I-BANK-NUMBER         PIC X(10).
  6108             20  FILLER                   PIC X(15).
  6109         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6110         16  PB-I-REFERENCE               PIC X(12).
  6111         16  FILLER REDEFINES PB-I-REFERENCE.
  6112             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6113             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6114             20  PB-I-CLP-STATE           PIC XX.
  6115         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6116             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6117             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6118             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6119         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6120         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6121         16  PB-I-RESIDENT-STATE          PIC XX.
  6122         16  PB-I-RATE-CODE               PIC X(4).
  6123         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6124         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6125         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6126         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6127         16  PB-I-BANK-NOCHRGB            PIC 99.
  6128         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6129         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6130
  6131     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6132         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6133             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6134         16  PB-C-CANCEL-ORIGIN           PIC X.
  6135             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6136         16  PB-C-LF-CANCEL-DT            PIC XX.
  6137         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6138         16  PB-C-LF-CALC-REQ             PIC X.
  6139             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6140         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6141         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 115
* EL6311.cbl
  6142         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6143             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6144         16  PB-C-AH-CANCEL-DT            PIC XX.
  6145         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6146         16  PB-C-AH-CALC-REQ             PIC X.
  6147             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6148         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6149         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6150         16  PB-C-LAST-NAME               PIC X(15).
  6151         16  PB-C-REFUND-SW               PIC X.
  6152             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6153             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6154         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6155         16  PB-C-PAYEE-CODE              PIC X(6).
  6156         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6157         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6158         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6159         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6160         16  PB-C-REFERENCE               PIC X(12).
  6161         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6162         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6163         16  PB-C-POST-CARD-IND           PIC X.
  6164         16  PB-C-CANCEL-REASON           PIC X.
  6165         16  PB-C-REF-INTERFACE-SW        PIC X.
  6166         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6167         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6168         16  FILLER                       PIC X(01).
  6169*        16  FILLER                       PIC X(18).
  6170         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6171*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6172         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6173         16  PB-CANCELED-CERT-DATA.
  6174             20  PB-CI-INSURED-NAME.
  6175                 24  PB-CI-LAST-NAME      PIC X(15).
  6176                 24  PB-CI-INITIALS       PIC XX.
  6177             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6178             20  PB-CI-INSURED-SEX        PIC X.
  6179             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6180             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6181             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6182             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6183             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6184             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6185             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6186             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6187             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6188             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6189             20  PB-CI-RATE-CLASS         PIC XX.
  6190             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6191             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6192             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6193             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6194             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6195             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6196             20  PB-CI-LF-ABBR            PIC X(3).
  6197             20  PB-CI-AH-ABBR            PIC X(3).
  6198             20  PB-CI-OB-FLAG            PIC X.
  6199                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 116
* EL6311.cbl
  6200             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6201                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6202                                           'M' '4' '5' '9' '2'.
  6203                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6204                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6205                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6206                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6207                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6208                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6209                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6210                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6211                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6212                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6213                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6214                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6215                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6216             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6217                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6218                                           'M' '4' '5' '9' '2'.
  6219                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6220                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6221                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6222                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6223                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6224                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6225                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6226                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6227                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6228                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6229                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6230                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6231                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6232             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6233             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6234             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6235             20  PB-CI-MEMBER-NO          PIC X(12).
  6236             20  PB-CI-INT-CODE           PIC X.
  6237                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6238                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6239             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6240             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6241             20  PB-CI-COMP-EXCP-SW       PIC X.
  6242                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6243                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6244             20  PB-CI-ENTRY-STATUS       PIC X.
  6245             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6246             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6247             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6248             20  PB-CI-DEATH-DT           PIC XX.
  6249             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6250             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6251             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6252             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6253             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6254             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6255             20  PB-CI-ENTRY-DT              PIC XX.
  6256             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6257             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 117
* EL6311.cbl
  6258             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6259             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6260             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6261             20  PB-CI-OLD-LOF               PIC XXX.
  6262*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6263             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6264             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6265             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6266             20  PB-CI-INDV-GRP-CD           PIC X.
  6267             20  PB-CI-BENEFICIARY-NAME.
  6268                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6269                 24  FILLER                  PIC X(15).
  6270             20  PB-CI-NOTE-SW               PIC X.
  6271             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6272             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6273             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6274             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6275             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6276             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6277             20  PB-CI-FIRST-NAME            PIC X(10).
  6278             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6279
  6280         16  FILLER                       PIC X(13).
  6281*032306  16  FILLER                       PIC X(27).
  6282*        16  FILLER                       PIC X(46).
  6283
  6284     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6285         16  FILLER                       PIC X(10).
  6286         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6287         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6288         16  PB-M-INSURED-MID-INIT        PIC X.
  6289         16  PB-M-INSURED-AGE             PIC 99.
  6290         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6291         16  PB-M-INSURED-SEX             PIC X.
  6292         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6293         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6294         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6295         16  PB-M-INSURED-CITY-STATE.
  6296             20  PB-M-INSURED-CITY        PIC X(28).
  6297             20  PB-M-INSURED-STATE       PIC XX.
  6298         16  PB-M-INSURED-ZIP-CODE.
  6299             20  PB-M-INSURED-ZIP-PRIME.
  6300                 24  PB-M-INSURED-ZIP-1   PIC X.
  6301                     88  PB-M-CANADIAN-POST-CODE
  6302                                             VALUE 'A' THRU 'Z'.
  6303                 24  FILLER               PIC X(4).
  6304             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6305         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6306                                        PB-M-INSURED-ZIP-CODE.
  6307             20  PM-M-INS-CAN-POST1       PIC XXX.
  6308             20  PM-M-INS-CAN-POST2       PIC XXX.
  6309             20  FILLER                   PIC XXX.
  6310         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6311         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6312         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6313         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6314         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6315         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 118
* EL6311.cbl
  6316             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6317             20  PB-M-CRED-BENE-STATE     PIC XX.
  6318         16  FILLER                       PIC X(92).
  6319
  6320     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6321         16  FILLER                       PIC X(10).
  6322         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6323         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6324         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6325         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6326         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6327         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6328         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6329         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6330         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6331         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6332         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6333         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6334         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6335         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6336         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6337         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6338         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6339         16  PB-ACCOUNT-NAME              PIC X(30).
  6340         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6341         16  PB-REFERENCE                 PIC X(12).
  6342         16  PB-B-RECEIVED-DT             PIC XX.
  6343         16  FILLER                       PIC X(234).
  6344
  6345     12  PB-RECORD-STATUS.
  6346         16  PB-CREDIT-SELECT-DT          PIC XX.
  6347         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6348         16  PB-BILLED-DT                 PIC XX.
  6349         16  PB-BILLING-STATUS            PIC X.
  6350             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6351             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6352             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6353         16  PB-RECORD-BILL               PIC X.
  6354             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6355             88  PB-RECORD-RETURNED           VALUE 'R'.
  6356             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6357             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6358             88  PB-OVERRIDE-AH               VALUE 'A'.
  6359             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6360         16  PB-BATCH-ENTRY               PIC X.
  6361             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6362             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6363             88  PB-REISSUED-CERT             VALUE 'E'.
  6364             88  PB-CASH-CERT                 VALUE 'C'.
  6365             88  PB-MONTHLY-CERT              VALUE 'M'.
  6366             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6367             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6368             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6369         16  PB-FORCE-CODE                PIC X.
  6370             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6371             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6372             88  PB-CANCEL-FORCE              VALUE '8'.
  6373             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 119
* EL6311.cbl
  6374             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6375             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6376             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6377             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6378             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6379             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6380         16  PB-FATAL-FLAG                PIC X.
  6381             88  PB-FATAL-ERRORS              VALUE 'X'.
  6382         16  PB-FORCE-ER-CD               PIC X.
  6383             88  PB-FORCE-ERRORS              VALUE 'F'.
  6384             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6385         16  PB-WARN-ER-CD                PIC X.
  6386             88  PB-WARNING-ERRORS            VALUE 'W'.
  6387         16  FILLER                       PIC X.
  6388         16  PB-OUT-BAL-CD                PIC X.
  6389             88  PB-OUT-OF-BAL                VALUE 'O'.
  6390         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6391         16  PB-AH-OVERRIDE-L1            PIC X.
  6392         16  PB-INPUT-DT                  PIC XX.
  6393         16  PB-INPUT-BY                  PIC X(4).
  6394         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6395         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6396         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6397         16  PB-LF-EARNING-METHOD         PIC X.
  6398         16  PB-AH-EARNING-METHOD         PIC X.
  6399         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6400         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6401         16  PB-REIN-CD                   PIC XXX.
  6402         16  PB-LF-REFUND-TYPE            PIC X.
  6403         16  PB-AH-REFUND-TYPE            PIC X.
  6404         16  PB-ACCT-EFF-DT               PIC XX.
  6405         16  PB-ACCT-EXP-DT               PIC XX.
  6406         16  PB-COMPANY-ID                PIC X(3).
  6407         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6408         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6409         16  PB-SV-CARRIER                PIC X.
  6410         16  PB-SV-GROUPING               PIC X(6).
  6411         16  PB-SV-STATE                  PIC XX.
  6412         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6413         16  PB-GA-BILLING-INFO.
  6414             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6415                                          PIC XX.
  6416         16  PB-SV-REMIT-TO  REDEFINES
  6417             PB-GA-BILLING-INFO           PIC X(10).
  6418         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6419         16  PB-I-LOAN-OFFICER            PIC X(5).
  6420         16  PB-I-VIN                     PIC X(17).
  6421
  6422         16  FILLER                       PIC X(04).
  6423         16  IMNET-BYPASS-SW              PIC X.
  6424
  6425******************************************************************
  6426*                COMMON EDIT ERRORS                              *
  6427******************************************************************
  6428
  6429     12  PB-COMMON-ERRORS.
  6430         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6431                                           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 120
* EL6311.cbl
  6432
  6433******************************************************************
  6434*                                COPY ELCCERT.
  6435******************************************************************
  6436*                                                                *
  6437*                            ELCCERT.                            *
  6438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6439*                            VMOD=2.013                          *
  6440*                                                                *
  6441*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6442*                                                                *
  6443*   FILE TYPE = VSAM,KSDS                                        *
  6444*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6445*                                                                *
  6446*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6447*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6448*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6449*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6450*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6451*                                                                *
  6452*   LOG = YES                                                    *
  6453*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6454******************************************************************
  6455*                   C H A N G E   L O G
  6456*
  6457* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6458*-----------------------------------------------------------------
  6459*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6460* EFFECTIVE    NUMBER
  6461*-----------------------------------------------------------------
  6462* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6463* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6464* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6465* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6466* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6467* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6468* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6469* 032612  CR2011110200001  PEMA  AHL CHANGES
  6470* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6471******************************************************************
  6472
  6473 01  CERTIFICATE-MASTER.
  6474     12  CM-RECORD-ID                      PIC XX.
  6475         88  VALID-CM-ID                      VALUE 'CM'.
  6476
  6477     12  CM-CONTROL-PRIMARY.
  6478         16  CM-COMPANY-CD                 PIC X.
  6479         16  CM-CARRIER                    PIC X.
  6480         16  CM-GROUPING.
  6481             20  CM-GROUPING-PREFIX        PIC X(3).
  6482             20  CM-GROUPING-PRIME         PIC X(3).
  6483         16  CM-STATE                      PIC XX.
  6484         16  CM-ACCOUNT.
  6485             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6486             20  CM-ACCOUNT-PRIME          PIC X(6).
  6487         16  CM-CERT-EFF-DT                PIC XX.
  6488         16  CM-CERT-NO.
  6489             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 121
* EL6311.cbl
  6490             20  CM-CERT-SFX               PIC X.
  6491
  6492     12  CM-CONTROL-BY-NAME.
  6493         16  CM-COMPANY-CD-A1              PIC X.
  6494         16  CM-INSURED-LAST-NAME          PIC X(15).
  6495         16  CM-INSURED-INITIALS.
  6496             20  CM-INSURED-INITIAL1       PIC X.
  6497             20  CM-INSURED-INITIAL2       PIC X.
  6498
  6499     12  CM-CONTROL-BY-SSN.
  6500         16  CM-COMPANY-CD-A2              PIC X.
  6501         16  CM-SOC-SEC-NO.
  6502             20  CM-SSN-STATE              PIC XX.
  6503             20  CM-SSN-ACCOUNT            PIC X(6).
  6504             20  CM-SSN-LN3.
  6505                 25  CM-INSURED-INITIALS-A2.
  6506                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6507                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6508                 25 CM-PART-LAST-NAME-A2         PIC X.
  6509
  6510     12  CM-CONTROL-BY-CERT-NO.
  6511         16  CM-COMPANY-CD-A4              PIC X.
  6512         16  CM-CERT-NO-A4                 PIC X(11).
  6513
  6514     12  CM-CONTROL-BY-MEMB.
  6515         16  CM-COMPANY-CD-A5              PIC X.
  6516         16  CM-MEMBER-NO.
  6517             20  CM-MEMB-STATE             PIC XX.
  6518             20  CM-MEMB-ACCOUNT           PIC X(6).
  6519             20  CM-MEMB-LN4.
  6520                 25  CM-INSURED-INITIALS-A5.
  6521                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6522                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6523                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6524
  6525     12  CM-INSURED-PROFILE-DATA.
  6526         16  CM-INSURED-FIRST-NAME.
  6527             20  CM-INSURED-1ST-INIT       PIC X.
  6528             20  FILLER                    PIC X(9).
  6529         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6530         16  CM-INSURED-SEX                PIC X.
  6531             88  CM-SEX-MALE                  VALUE 'M'.
  6532             88  CM-SEX-FEMAL                 VALUE 'F'.
  6533         16  CM-INSURED-JOINT-AGE          PIC 99.
  6534         16  CM-JOINT-INSURED-NAME.
  6535             20  CM-JT-LAST-NAME           PIC X(15).
  6536             20  CM-JT-FIRST-NAME.
  6537                 24  CM-JT-1ST-INIT        PIC X.
  6538                 24  FILLER                PIC X(9).
  6539             20  CM-JT-INITIAL             PIC X.
  6540
  6541     12  CM-LIFE-DATA.
  6542         16  CM-LF-BENEFIT-CD              PIC XX.
  6543         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6544         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6545         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6546         16  CM-LF-DEV-CODE                PIC XXX.
  6547         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 122
* EL6311.cbl
  6548         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6549         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6550         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6551         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6552         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6553         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6554         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6555         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6556         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6557         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6558         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6559         16  cm-temp-epiq                  pic xx.
  6560             88  EPIQ-CLASS                  value 'EQ'.
  6561*        16  FILLER                        PIC XX.
  6562
  6563     12  CM-AH-DATA.
  6564         16  CM-AH-BENEFIT-CD              PIC XX.
  6565         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6566         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6567         16  CM-AH-DEV-CODE                PIC XXX.
  6568         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6569         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6570         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6571         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6572         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6573         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6574         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6575         16  CM-AH-PAID-THRU-DT            PIC XX.
  6576             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6577         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6578         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6579         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6580         16  FILLER                        PIC X.
  6581
  6582     12  CM-LOAN-INFORMATION.
  6583         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6584         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6585                                           PIC S9(5)V99  COMP-3.
  6586         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6587         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6588         16  CM-PAY-FREQUENCY              PIC S99.
  6589         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6590         16  CM-RATE-CLASS                 PIC XX.
  6591         16  CM-BENEFICIARY                PIC X(25).
  6592         16  CM-POLICY-FORM-NO             PIC X(12).
  6593         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6594         16  CM-LAST-ADD-ON-DT             PIC XX.
  6595         16  CM-DEDUCTIBLE-AMOUNTS.
  6596             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6597             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6598         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6599             20  CM-RESIDENT-STATE         PIC XX.
  6600             20  CM-RATE-CODE              PIC X(4).
  6601             20  FILLER                    PIC XX.
  6602         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6603             20  CM-LOAN-OFFICER           PIC X(5).
  6604             20  FILLER                    PIC XXX.
  6605         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 123
* EL6311.cbl
  6606         16  CM-UNDERWRITING-CODE          PIC X.
  6607             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6608         16  CM-POST-CARD-IND              PIC X.
  6609         16  CM-NH-INTERFACE-SW            PIC X.
  6610         16  CM-PREMIUM-TYPE               PIC X.
  6611             88  CM-SING-PRM                  VALUE '1'.
  6612             88  CM-O-B-COVERAGE              VALUE '2'.
  6613             88  CM-OPEN-END                  VALUE '3'.
  6614         16  CM-IND-GRP-TYPE               PIC X.
  6615             88  CM-INDIVIDUAL                VALUE 'I'.
  6616             88  CM-GROUP                     VALUE 'G'.
  6617         16  CM-SKIP-CODE                  PIC X.
  6618             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6619             88  SKIP-JULY                    VALUE '1'.
  6620             88  SKIP-AUGUST                  VALUE '2'.
  6621             88  SKIP-SEPTEMBER               VALUE '3'.
  6622             88  SKIP-JULY-AUG                VALUE '4'.
  6623             88  SKIP-AUG-SEPT                VALUE '5'.
  6624             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6625             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6626             88  SKIP-JUNE                    VALUE '8'.
  6627             88  SKIP-JUNE-JULY               VALUE '9'.
  6628             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6629             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6630         16  CM-PAYMENT-MODE               PIC X.
  6631             88  PAY-MONTHLY                  VALUE SPACE.
  6632             88  PAY-WEEKLY                   VALUE '1'.
  6633             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6634             88  PAY-BI-WEEKLY                VALUE '3'.
  6635             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6636         16  CM-LOAN-NUMBER                PIC X(8).
  6637         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6638         16  CM-OLD-LOF                    PIC XXX.
  6639*        16  CM-LOAN-OFFICER               PIC XXX.
  6640         16  CM-REIN-TABLE                 PIC XXX.
  6641         16  CM-SPECIAL-REIN-CODE          PIC X.
  6642         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6643         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6644         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6645
  6646     12  CM-STATUS-DATA.
  6647         16  CM-ENTRY-STATUS               PIC X.
  6648         16  CM-ENTRY-DT                   PIC XX.
  6649
  6650         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6651         16  CM-LF-CANCEL-DT               PIC XX.
  6652         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6653
  6654         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6655         16  CM-LF-DEATH-DT                PIC XX.
  6656         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6657
  6658         16  CM-LF-CURRENT-STATUS          PIC X.
  6659             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6660                                                'M' '4' '5' '9'.
  6661             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6662             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6663             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 124
* EL6311.cbl
  6664             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6665             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6666             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6667             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6668             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6669             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6670             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6671             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6672             88  CM-LF-DECLINED               VALUE 'D'.
  6673             88  CM-LF-VOIDED                 VALUE 'V'.
  6674
  6675         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6676         16  CM-AH-CANCEL-DT               PIC XX.
  6677         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6678
  6679         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6680         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6681         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6682
  6683         16  CM-AH-CURRENT-STATUS          PIC X.
  6684             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6685                                                'M' '4' '5' '9'.
  6686             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6687             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6688             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6689             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6690             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6691             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6692             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6693             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6694             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6695             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6696             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6697             88  CM-AH-DECLINED               VALUE 'D'.
  6698             88  CM-AH-VOIDED                 VALUE 'V'.
  6699
  6700         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6701             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6702             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6703             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6704         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6705
  6706         16  CM-ENTRY-BATCH                PIC X(6).
  6707         16  CM-LF-EXIT-BATCH              PIC X(6).
  6708         16  CM-AH-EXIT-BATCH              PIC X(6).
  6709         16  CM-LAST-MONTH-END             PIC XX.
  6710
  6711     12  CM-NOTE-SW                        PIC X.
  6712         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6713         88  CERT-NOTES-PRESENT               VALUE '1'.
  6714         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6715         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6716         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6717         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6718         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6719         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6720     12  CM-COMP-EXCP-SW                   PIC X.
  6721         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 125
* EL6311.cbl
  6722         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6723     12  CM-INSURED-ADDRESS-SW             PIC X.
  6724         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6725         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6726
  6727*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6728     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6729     12  FILLER                            PIC X.
  6730
  6731*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6732     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6733     12  FILLER                            PIC X.
  6734*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6735     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6736
  6737     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6738         88  CERT-ADDED-BATCH                 VALUE ' '.
  6739         88  CERT-ADDED-ONLINE                VALUE '1'.
  6740         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6741         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6742         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6743     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6744         88  CERT-AS-LOADED                   VALUE ' '.
  6745         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6746         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6747         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6748         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6749         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6750         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6751         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6752
  6753     12  CM-ACCOUNT-COMM-PCTS.
  6754         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6755         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6756
  6757     12  CM-USER-FIELD                     PIC X.
  6758     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6759     12  CM-CLP-STATE                      PIC XX.
  6760     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6761     12  CM-USER-RESERVED                  PIC XXX.
  6762     12  FILLER REDEFINES CM-USER-RESERVED.
  6763         16  CM-AH-CLASS-CD                PIC XX.
  6764         16  F                             PIC X.
  6765******************************************************************
  6766*                                COPY ERCNOTE.
  6767******************************************************************
  6768*                                                                *
  6769*                                                                *
  6770*                            ERCNOTE                             *
  6771*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6772*                            VMOD=2.003                          *
  6773*                                                                *
  6774*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6775*                                                                *
  6776*        FILE TYPE= VSAM,KSDS                                    *
  6777*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6778*                                                                *
  6779*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 126
* EL6311.cbl
  6780*                                                                *
  6781*        LOG = YES                                               *
  6782*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6783*                                                                *
  6784******************************************************************
  6785*                   C H A N G E   L O G
  6786*
  6787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6788*-----------------------------------------------------------------
  6789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6790* EFFECTIVE    NUMBER
  6791*-----------------------------------------------------------------
  6792* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6793*                                FILE WILL CONTAIN BILLING NOTES O
  6794******************************************************************
  6795
  6796 01  CERTIFICATE-NOTE.
  6797     12  CN-RECORD-ID                PIC  XX.
  6798         88  VALID-CN-ID                  VALUE 'CN'.
  6799
  6800     12  CN-CONTROL-PRIMARY.
  6801         16  CN-COMPANY-CD           PIC X.
  6802         16  CN-CARRIER              PIC X.
  6803         16  CN-GROUPING.
  6804             20 CN-GROUPING-PREFIX   PIC XXX.
  6805             20 CN-GROUPING-PRIME    PIC XXX.
  6806         16  CN-STATE                PIC XX.
  6807         16  CN-ACCOUNT.
  6808             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6809             20 CN-ACCOUNT-PRIME     PIC X(6).
  6810         16  CN-CERT-EFF-DT          PIC XX.
  6811         16  CN-CERT-NO.
  6812             20  CN-CERT-PRIME       PIC X(10).
  6813             20  CN-CERT-SFX         PIC X.
  6814
  6815     12  CN-BILLING-START-LINE-NO    PIC 99.
  6816     12  CN-BILLING-END-LINE-NO      PIC 99.
  6817
  6818     12  CN-LINES.
  6819         16  CN-LINE OCCURS 10       PIC X(77).
  6820
  6821     12  CN-LAST-MAINT-DT            PIC XX.
  6822     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6823     12  CN-LAST-MAINT-USER          PIC X(4).
  6824     12  FILLER                      PIC X(6).
  6825******************************************************************
  6826*                                COPY ERCPNDM.
  6827******************************************************************
  6828*                                                                *
  6829*                                                                *
  6830*                            ERCPNDM                             *
  6831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6832*                            VMOD=2.003                          *
  6833*                                                                *
  6834*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6835*                                                                *
  6836*   FILE TYPE = VSAM,KSDS                                        *
  6837*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 127
* EL6311.cbl
  6838*                                                                *
  6839*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6840*   ALTERNATE PATH    = NOT USED                                 *
  6841*                                                                *
  6842*   LOG = YES                                                    *
  6843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6844******************************************************************
  6845*                   C H A N G E   L O G
  6846*
  6847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6848*-----------------------------------------------------------------
  6849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6850* EFFECTIVE    NUMBER
  6851*-----------------------------------------------------------------
  6852* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6853* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6854* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6855******************************************************************
  6856
  6857 01  PENDING-MAILING-DATA.
  6858     12  PM-RECORD-ID                      PIC XX.
  6859         88  VALID-MA-ID                       VALUE 'PM'.
  6860
  6861     12  PM-CONTROL-PRIMARY.
  6862         16  PM-COMPANY-CD                 PIC X.
  6863         16  PM-ENTRY-BATCH                PIC X(6).
  6864         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6865         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6866
  6867     12  FILLER                            PIC X(14).
  6868
  6869     12  PM-ACCESS-CONTROL.
  6870         16  PM-SOURCE-SYSTEM              PIC XX.
  6871             88  PM-FROM-CREDIT                VALUE 'CR'.
  6872             88  PM-FROM-VSI                   VALUE 'VS'.
  6873             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6874             88  PM-FROM-OTHER                 VALUE 'OT'.
  6875         16  PM-RECORD-ADD-DT              PIC XX.
  6876         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6877         16  PM-LAST-MAINT-DT              PIC XX.
  6878         16  PM-LAST-MAINT-BY              PIC XXXX.
  6879         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6880
  6881     12  PM-PROFILE-INFO.
  6882         16  PM-QUALIFY-CODE-1             PIC XX.
  6883         16  PM-QUALIFY-CODE-2             PIC XX.
  6884         16  PM-QUALIFY-CODE-3             PIC XX.
  6885         16  PM-QUALIFY-CODE-4             PIC XX.
  6886         16  PM-QUALIFY-CODE-5             PIC XX.
  6887
  6888         16  PM-INSURED-LAST-NAME          PIC X(15).
  6889         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6890         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6891         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6892         16  PM-INSURED-BIRTH-DT           PIC XX.
  6893         16  PM-INSURED-SEX                PIC X.
  6894             88  PM-SEX-MALE                   VALUE 'M'.
  6895             88  PM-SEX-FEMALE                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 128
* EL6311.cbl
  6896         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6897
  6898         16  PM-ADDRESS-CORRECTED          PIC X.
  6899         16  PM-JOINT-BIRTH-DT             PIC XX.
  6900*        16  FILLER                        PIC X(12).
  6901
  6902         16  PM-ADDRESS-LINE-1             PIC X(30).
  6903         16  PM-ADDRESS-LINE-2             PIC X(30).
  6904         16  PM-CITY-STATE.
  6905             20  PM-CITY                   PIC X(28).
  6906             20  PM-STATE                  PIC XX.
  6907         16  PM-ZIP.
  6908             20  PM-ZIP-CODE.
  6909                 24  PM-ZIP-1              PIC X.
  6910                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6911                 24  FILLER                PIC X(4).
  6912             20  PM-ZIP-PLUS4              PIC X(4).
  6913         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6914             20  PM-CAN-POST1              PIC XXX.
  6915             20  PM-CAN-POST2              PIC XXX.
  6916             20  FILLER                    PIC XXX.
  6917
  6918         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6919
  6920         16  FILLER                        PIC X(03).
  6921
  6922     12  PM-CRED-BENE-INFO.
  6923         16  PM-CRED-BENE-NAME             PIC X(25).
  6924         16  PM-CRED-BENE-ADDR             PIC X(30).
  6925         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6926         16  PM-CRED-BENE-CTYST.
  6927             20  PM-CRED-BENE-CITY         PIC X(28).
  6928             20  PM-CRED-BENE-STATE        PIC XX.
  6929         16  PM-CRED-BENE-ZIP.
  6930             20  PM-CB-ZIP-CODE.
  6931                 24  PM-CB-ZIP-1           PIC X.
  6932                     88  PM-CB-CANADIAN-POST-CODE
  6933                                  VALUE 'A' THRU 'Z'.
  6934                 24  FILLER                PIC X(4).
  6935             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6936         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6937             20  PM-CB-CAN-POST1           PIC XXX.
  6938             20  PM-CB-CAN-POST2           PIC XXX.
  6939             20  FILLER                    PIC XXX.
  6940     12  PM-POST-CARD-MAIL-DATA.
  6941         16  PM-MAIL-DATA OCCURS 7.
  6942             20  PM-MAIL-TYPE              PIC X.
  6943                 88  PM-12MO-MAILING           VALUE '1'.
  6944                 88  PM-EXP-MAILING            VALUE '2'.
  6945             20  PM-MAIL-STATUS            PIC X.
  6946                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6947                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6948                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6949             20  PM-MAIL-DATE              PIC XX.
  6950     12  FILLER                            PIC XX.
  6951     12  FILLER                            PIC X(12).
  6952*    12  FILLER                            PIC X(30).
  6953
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 129
* EL6311.cbl
  6954******************************************************************
  6955*                                COPY ERCMAIL.
  6956******************************************************************
  6957*                                                                *
  6958*                                                                *
  6959*                            ERCMAIL                             *
  6960*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6961*                            VMOD=2.003                          *
  6962*                                                                *
  6963*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6964*                                                                *
  6965*   FILE TYPE = VSAM,KSDS                                        *
  6966*   RECORD SIZE = 374   RECFORM = FIX                            *
  6967*                                                                *
  6968*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6969*   ALTERNATE PATH    = NOT USED                                 *
  6970*                                                                *
  6971*   LOG = YES                                                    *
  6972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6973******************************************************************
  6974*                   C H A N G E   L O G
  6975*
  6976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6977*-----------------------------------------------------------------
  6978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6979* EFFECTIVE    NUMBER
  6980*-----------------------------------------------------------------
  6981* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6982* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6983* 111108                   PEMA  ADD CRED BENE ADDR2
  6984******************************************************************
  6985
  6986 01  MAILING-DATA.
  6987     12  MA-RECORD-ID                      PIC XX.
  6988         88  VALID-MA-ID                       VALUE 'MA'.
  6989
  6990     12  MA-CONTROL-PRIMARY.
  6991         16  MA-COMPANY-CD                 PIC X.
  6992         16  MA-CARRIER                    PIC X.
  6993         16  MA-GROUPING.
  6994             20  MA-GROUPING-PREFIX        PIC XXX.
  6995             20  MA-GROUPING-PRIME         PIC XXX.
  6996         16  MA-STATE                      PIC XX.
  6997         16  MA-ACCOUNT.
  6998             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6999             20  MA-ACCOUNT-PRIME          PIC X(6).
  7000         16  MA-CERT-EFF-DT                PIC XX.
  7001         16  MA-CERT-NO.
  7002             20  MA-CERT-PRIME             PIC X(10).
  7003             20  MA-CERT-SFX               PIC X.
  7004
  7005     12  FILLER                            PIC XX.
  7006
  7007     12  MA-ACCESS-CONTROL.
  7008         16  MA-SOURCE-SYSTEM              PIC XX.
  7009             88  MA-FROM-CREDIT                VALUE 'CR'.
  7010             88  MA-FROM-VSI                   VALUE 'VS'.
  7011             88  MA-FROM-WARRANTY              VALUE 'WA'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 130
* EL6311.cbl
  7012             88  MA-FROM-OTHER                 VALUE 'OT'.
  7013         16  MA-RECORD-ADD-DT              PIC XX.
  7014         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7015         16  MA-LAST-MAINT-DT              PIC XX.
  7016         16  MA-LAST-MAINT-BY              PIC XXXX.
  7017         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7018
  7019     12  MA-PROFILE-INFO.
  7020         16  MA-QUALIFY-CODE-1             PIC XX.
  7021         16  MA-QUALIFY-CODE-2             PIC XX.
  7022         16  MA-QUALIFY-CODE-3             PIC XX.
  7023         16  MA-QUALIFY-CODE-4             PIC XX.
  7024         16  MA-QUALIFY-CODE-5             PIC XX.
  7025
  7026         16  MA-INSURED-LAST-NAME          PIC X(15).
  7027         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7028         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7029         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7030         16  MA-INSURED-BIRTH-DT           PIC XX.
  7031         16  MA-INSURED-SEX                PIC X.
  7032             88  MA-SEX-MALE                   VALUE 'M'.
  7033             88  MA-SEX-FEMALE                 VALUE 'F'.
  7034         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7035
  7036         16  MA-ADDRESS-CORRECTED          PIC X.
  7037         16  MA-JOINT-BIRTH-DT             PIC XX.
  7038*        16  FILLER                        PIC X(12).
  7039
  7040         16  MA-ADDRESS-LINE-1             PIC X(30).
  7041         16  MA-ADDRESS-LINE-2             PIC X(30).
  7042         16  MA-CITY-STATE.
  7043             20  MA-CITY                   PIC X(28).
  7044             20  MA-ADDR-STATE             PIC XX.
  7045         16  MA-ZIP.
  7046             20  MA-ZIP-CODE.
  7047                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7048                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7049                 24  FILLER                PIC X(4).
  7050             20  MA-ZIP-PLUS4              PIC X(4).
  7051         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7052             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7053             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7054             20  FILLER                    PIC X(3).
  7055
  7056         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7057
  7058         16  FILLER                        PIC XXX.
  7059*        16  FILLER                        PIC X(10).
  7060
  7061     12  MA-CRED-BENE-INFO.
  7062         16  MA-CRED-BENE-NAME                 PIC X(25).
  7063         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7064         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7065         16  MA-CRED-BENE-CTYST.
  7066             20  MA-CRED-BENE-CITY             PIC X(28).
  7067             20  MA-CRED-BENE-STATE            PIC XX.
  7068         16  MA-CRED-BENE-ZIP.
  7069             20  MA-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 131
* EL6311.cbl
  7070                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7071                     88  MA-CB-CANADIAN-POST-CODE
  7072                                           VALUE 'A' THRU 'Z'.
  7073                 24  FILLER                    PIC X(4).
  7074             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7075         16  MA-CB-CANADIAN-POSTAL-CODE
  7076                            REDEFINES MA-CRED-BENE-ZIP.
  7077             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7078             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7079             20  FILLER                        PIC X(3).
  7080     12  MA-POST-CARD-MAIL-DATA.
  7081         16  MA-MAIL-DATA OCCURS 7.
  7082             20  MA-MAIL-TYPE              PIC X.
  7083                 88  MA-12MO-MAILING           VALUE '1'.
  7084                 88  MA-EXP-MAILING            VALUE '2'.
  7085             20  MA-MAIL-STATUS            PIC X.
  7086                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7087                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7088                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7089             20  MA-MAIL-DATE              PIC XX.
  7090     12  FILLER                            PIC XX.
  7091     12  FILLER                            PIC XX.
  7092*    12  FILLER                            PIC X(30).
  7093******************************************************************
  7094*                                COPY ERCRQST.
  7095******************************************************************
  7096*                                                                *
  7097*                                                                *
  7098*                            ERCRQST.                            *
  7099*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7100*                            VMOD=2.002                          *
  7101*                                                                *
  7102*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7103*                                                                *
  7104*   FILE TYPE = VSAM,KSDS                                        *
  7105*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7106*                                                                *
  7107*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7108*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7109*                                   ACCOUNT, REF, BATCH)         *
  7110*                                                RKP=9, LEN=38   *
  7111*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7112*                                   ACCOUNT, REF, BATCH)         *
  7113*                                                RKP=47, LEN=46  *
  7114*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7115*                                   BATCH)                       *
  7116*                                                RKP=93, LEN=24  *
  7117*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7118*                                   REF, BATCH)                  *
  7119*                                                RKP=117, LEN=35 *
  7120*   LOG = NO                                                     *
  7121*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7122******************************************************************
  7123
  7124 01  AR-REQUEST-RECORD.
  7125     12  RQ-RECORD-ID                     PIC XX.
  7126         88  VALID-RQ-ID                        VALUE 'RQ'.
  7127
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 132
* EL6311.cbl
  7128     12  RQ-CONTROL-PRIMARY.
  7129         16  RQ-COMPANY-CD                PIC X.
  7130         16  RQ-ENTRY-BATCH               PIC X(6).
  7131
  7132     12  RQ-CONTROL-BY-ACCT-REF.
  7133         16  RQ-COMPANY-CD-A1             PIC X.
  7134         16  RQ-CARRIER-A1                PIC X.
  7135         16  RQ-GROUPING-A1               PIC X(6).
  7136         16  RQ-STATE-A1                  PIC XX.
  7137         16  RQ-ACCOUNT-A1                PIC X(10).
  7138         16  RQ-REFERENCE-A1              PIC X(12).
  7139         16  RQ-BATCH-A1                  PIC X(6).
  7140
  7141     12  RQ-CONTROL-BY-FIN-RESP.
  7142         16  RQ-COMPANY-CD-A2             PIC X.
  7143         16  RQ-CARRIER-A2                PIC X.
  7144         16  RQ-GROUPING-A2               PIC X(6).
  7145         16  RQ-FIN-RESP-A2               PIC X(10).
  7146         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7147         16  RQ-REFERENCE-A2              PIC X(12).
  7148         16  RQ-BATCH-A2                  PIC X(6).
  7149
  7150     12  RQ-CONTROL-BY-ACCT-AGENT.
  7151         16  RQ-COMPANY-CD-A3             PIC X.
  7152         16  RQ-CARRIER-A3                PIC X.
  7153         16  RQ-GROUPING-A3               PIC X(6).
  7154         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7155         16  RQ-BATCH-A3                  PIC X(6).
  7156
  7157     12  RQ-CONTROL-BY-SUMMARY.
  7158         16  RQ-COMPANY-CD-A4             PIC X.
  7159         16  RQ-SUMMARY-CODE              PIC X(6).
  7160         16  RQ-ACCOUNT-A4                PIC X(10).
  7161         16  RQ-REFERENCE-A4              PIC X(12).
  7162         16  RQ-BATCH-A4                  PIC X(6).
  7163
  7164     12  RQ-REQUEST-METHOD                PIC X.
  7165         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7166         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7167         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7168         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7169     12  FILLER                           PIC X.
  7170     12  RQ-STATUS                        PIC X.
  7171         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7172         88  RQ-RESUBMIT                      VALUE 'R'.
  7173     12  RQ-PROCESSOR-ID                  PIC X(4).
  7174     12  RQ-ENTRY-DT                      PIC XX.
  7175     12  RQ-MO-END-DT                     PIC XX.
  7176     12  RQ-REQUEST-DT                    PIC XX.
  7177     12  RQ-STMT-DT                       PIC XX.
  7178     12  RQ-REVERSAL-DT                   PIC XX.
  7179     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7180     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7181
  7182     12  FILLER                           PIC X(27).
  7183
  7184******************************************************************
  7185
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 133
* EL6311.cbl
  7186*                                COPY ERCLOFC.
  7187******************************************************************
  7188*                                                                *
  7189*                                                                *
  7190*                            ERCLOFC                             *
  7191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7192*                            VMOD=2.003                          *
  7193*                                                                *
  7194*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7195*                                                                *
  7196*   FILE TYPE = VSAM,KSDS                                        *
  7197*   RECORD SIZE = 670   RECFORM = FIX                            *
  7198*                                                                *
  7199*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7200*                                                                *
  7201*   LOG = YES                                                    *
  7202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7203*                                                                *
  7204******************************************************************
  7205
  7206 01  LOAN-OFFICER-MASTER.
  7207     12  LO-RECORD-ID                PIC XX.
  7208         88  VALID-LO-ID                VALUE 'LO'.
  7209
  7210     12  LO-CONTROL-PRIMARY.
  7211         16  LO-COMPANY-CD           PIC X.
  7212         16  LO-CARRIER              PIC X.
  7213         16  LO-GROUPING.
  7214             20  LO-GROUPING-PREFIX  PIC XXX.
  7215             20  LO-GROUPING-PRIME   PIC XXX.
  7216         16  LO-STATE                PIC XX.
  7217         16  LO-ACCOUNT.
  7218             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7219             20  LO-ACCOUNT-PRIME    PIC X(6).
  7220         16  LO-OFFICER-CODE         PIC X(5).
  7221
  7222     12  LO-OFFICER-NAME             PIC X(30).
  7223
  7224     12  LO-LAST-MAINT-DT            PIC XX.
  7225     12  LO-LAST-USER                PIC X(4).
  7226     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7227
  7228     12  LO-COMP-CONTROL             PIC X.
  7229             88  LO-SHOW-COMP           VALUE 'Y'.
  7230             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7231     12  LO-DETAIL-CONTROL           PIC X.
  7232             88  LO-PRINT-DETAIL        VALUE 'D'.
  7233             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7234
  7235     12  LO-SV-CARRIER               PIC X.
  7236     12  LO-SV-GROUPING              PIC X(6).
  7237     12  LO-SV-STATE                 PIC XX.
  7238
  7239     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7240     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7241
  7242     12  LO-OFFICER-INFO.
  7243         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 134
* EL6311.cbl
  7244             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7245             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7246             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7247             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7248             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7249             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7250             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7251             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7252     12  FILLER                      PIC X(198).
  7253******************************************************************
  7254*                                COPY ERCPYAJ.
  7255******************************************************************
  7256*                                                                *
  7257*                            ERCPYAJ                             *
  7258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7259*                            VMOD=2.015                          *
  7260*                                                                *
  7261*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7262*                                                                *
  7263*                                                                *
  7264*   FILE TYPE = VSAM,KSDS                                        *
  7265*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7266*                                                                *
  7267*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7268*       ALTERNATE PATHS = NONE                                   *
  7269*                                                                *
  7270*   LOG = YES                                                    *
  7271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7272******************************************************************
  7273******************************************************************
  7274*                   C H A N G E   L O G
  7275*
  7276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7277*-----------------------------------------------------------------
  7278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7279* EFFECTIVE    NUMBER
  7280*-----------------------------------------------------------------
  7281* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7282* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7283******************************************************************
  7284
  7285 01  PENDING-PAY-ADJ.
  7286     12  PY-RECORD-ID                     PIC XX.
  7287         88  VALID-PY-ID                        VALUE 'PY'.
  7288
  7289     12  PY-CONTROL-PRIMARY.
  7290         16  PY-COMPANY-CD                PIC X.
  7291         16  PY-CARRIER                   PIC X.
  7292         16  PY-GROUPING                  PIC X(6).
  7293         16  PY-FIN-RESP                  PIC X(10).
  7294         16  PY-ACCOUNT                   PIC X(10).
  7295         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7296                                          PIC X(10).
  7297         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7298         16  PY-RECORD-TYPE               PIC X.
  7299             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7300             88  PY-DEPOSIT                   VALUE 'D'.
  7301             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 135
* EL6311.cbl
  7302             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7303             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7304             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7305             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7306             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7307             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7308             88  PY-FICA-ENTRY                VALUE 'F'.
  7309             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7310             88  PY-POLICY-FEE                VALUE 'W'.
  7311             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7312
  7313     12  PY-PYMT-TYPE                     PIC X.
  7314             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7315             88  PY-REINS-PYMT                VALUE 'R'.
  7316             88  PY-EXP-PYMT                  VALUE 'E'.
  7317
  7318     12  PY-BIL-INV                       PIC X(6).
  7319     12  PY-REF-NO                        PIC X(12).
  7320
  7321     12  PY-LAST-MAINT-DT                 PIC XX.
  7322     12  PY-LAST-MAINT-BY                 PIC X(4).
  7323     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7324
  7325     12  PY-PYADJ-RECORD.
  7326         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7327         16  PY-ENTRY-COMMENT             PIC X(30).
  7328         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7329             20  PY-GL-ACCOUNT            PIC X(10).
  7330             20  PY-GL-STATE              PIC X(02).
  7331             20  PY-GL-CANC-SW            PIC X(01).
  7332                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7333                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7334             20  PY-GL-COMMENT            PIC X(10).
  7335             20  FILLER      REDEFINES PY-GL-COMMENT.
  7336                 24  PY-GL-CHECK-NO       PIC 9(06).
  7337                 24  FILLER               PIC X(04).
  7338             20  FILLER                   PIC X(07).
  7339         16  PY-SAVE-ACCOUNT              PIC X(10).
  7340         16  PY-SAVE-TYPE                 PIC X(01).
  7341
  7342         16  PY-LETTERS.
  7343             20  PY-LETTER OCCURS 3 TIMES
  7344                           INDEXED BY PY-LET-NDX
  7345                                          PIC X(04).
  7346
  7347         16  PY-ERCOMP-TYPE               PIC X.
  7348             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7349             88  PY-GA-TYPE                   VALUE 'G'.
  7350             88  PY-BANK-TYPE                 VALUE 'B'.
  7351         16  FILLER                       PIC X(05).
  7352
  7353     12  PY-RECORD-STATUS.
  7354         16  PY-CREDIT-SELECT-DT          PIC XX.
  7355         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7356         16  PY-BILLED-DATE               PIC XX.
  7357         16  PY-REPORTED-DT               PIC XX.
  7358         16  PY-PMT-APPLIED               PIC X.
  7359             88  PY-ACCOUNT-PMT               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 136
* EL6311.cbl
  7360             88  PY-GA-PMT                    VALUE 'G'.
  7361             88  PY-OVWRITE-PMT               VALUE 'O'.
  7362             88  PY-NON-AR-PMT                VALUE 'N'.
  7363         16  FILLER                       PIC X(5).
  7364         16  PY-INPUT-DT                  PIC XX.
  7365         16  PY-CHECK-NUMBER              PIC X(6).
  7366         16  PY-VOID-SW                   PIC X.
  7367             88  PY-CHECK-VOIDED              VALUE 'V'.
  7368         16  PY-CHECK-ORIGIN-SW           PIC X.
  7369             88  PY-BILLING-CHECK             VALUE 'B'.
  7370             88  PY-REFUND-CHECK              VALUE 'R'.
  7371             88  PY-GA-CHECK                  VALUE 'G'.
  7372             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7373             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7374         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7375         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7376         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7377         16  PY-BILL-FLAG                 PIC X.
  7378             88  PY-BILLED                    VALUE 'B'.
  7379         16  PY-AR-FLAG                   PIC X.
  7380             88  PY-AR-CYCLE                  VALUE 'C'.
  7381             88  PY-AR-MONTH-END              VALUE 'M'.
  7382         16  PY-AR-DATE                   PIC XX.
  7383
  7384     12  PY-GL-CODES.
  7385         16  PY-GL-DB                     PIC X(14).
  7386         16  PY-GL-CR                     PIC X(14).
  7387         16  PY-GL-FLAG                   PIC X.
  7388         16  PY-GL-DATE                   PIC XX.
  7389
  7390     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7391     12  FILLER                           PIC X(3).
  7392******************************************************************
  7393*                                COPY ERCCNOT.
  7394******************************************************************
  7395*                                                                *
  7396*                            ERCCNOT                             *
  7397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7398*                            VMOD=2.003                          *
  7399*                                                                *
  7400*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7401*                                                                *
  7402*        FILE TYPE= VSAM,KSDS                                    *
  7403*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7404*                                                                *
  7405*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7406*                                                                *
  7407*        LOG = YES                                               *
  7408*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7409*                                                                *
  7410******************************************************************
  7411*                   C H A N G E   L O G
  7412*
  7413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7414*-----------------------------------------------------------------
  7415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7416* EFFECTIVE    NUMBER
  7417*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 137
* EL6311.cbl
  7418* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7419******************************************************************
  7420
  7421 01  CERT-NOTE-FILE.
  7422     12  CZ-RECORD-ID                PIC  XX.
  7423         88  VALID-CZ-ID                  VALUE 'CZ'.
  7424
  7425     12  CZ-CONTROL-PRIMARY.
  7426         16  CZ-COMPANY-CD           PIC X.
  7427         16  CZ-CARRIER              PIC X.
  7428         16  CZ-GROUPING.
  7429             20 CZ-GROUPING-PREFIX   PIC XXX.
  7430             20 CZ-GROUPING-PRIME    PIC XXX.
  7431         16  CZ-STATE                PIC XX.
  7432         16  CZ-ACCOUNT.
  7433             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7434             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7435         16  CZ-CERT-EFF-DT          PIC XX.
  7436         16  CZ-CERT-NO.
  7437             20  CZ-CERT-PRIME       PIC X(10).
  7438             20  CZ-CERT-SFX         PIC X.
  7439         16  CZ-RECORD-TYPE          PIC X.
  7440             88  CERT-NOTE           VALUE '1'.
  7441             88  CLAIM-CERT-NOTE     VALUE '2'.
  7442         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7443
  7444     12  CZ-LAST-MAINT-DT            PIC XX.
  7445     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7446     12  CZ-LAST-MAINT-USER          PIC X(4).
  7447
  7448     12  CZ-NOTE-INFORMATION.
  7449         16  CZ-NOTE                 PIC X(63).
  7450         16  FILLER                  PIC X(39).
  7451******************************************************************
  7452*                                COPY ELCMSTR.
  7453******************************************************************
  7454*                                                                *
  7455*                            ELCMSTR.                            *
  7456*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7457*                            VMOD=2.012                          *
  7458*                                                                *
  7459*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7460*                                                                *
  7461*   FILE TYPE = VSAM,KSDS                                        *
  7462*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7463*                                                                *
  7464*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7465*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7466*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7467*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7468*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7469*                                                 RKP=75,LEN=21  *
  7470*                                                                *
  7471*   **** NOTE ****                                               *
  7472*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7473*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7474*                                                                *
  7475*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 138
* EL6311.cbl
  7476*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7477******************************************************************
  7478*                   C H A N G E   L O G
  7479*
  7480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7481*-----------------------------------------------------------------
  7482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7483* EFFECTIVE    NUMBER
  7484*-----------------------------------------------------------------
  7485* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7486* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7487* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7488* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7489* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7490******************************************************************
  7491 01  CLAIM-MASTER.
  7492     12  CL-RECORD-ID                PIC XX.
  7493         88  VALID-CL-ID         VALUE 'CL'.
  7494
  7495     12  CL-CONTROL-PRIMARY.
  7496         16  CL-COMPANY-CD           PIC X.
  7497         16  CL-CARRIER              PIC X.
  7498         16  CL-CLAIM-NO             PIC X(7).
  7499         16  CL-CERT-NO.
  7500             20  CL-CERT-PRIME       PIC X(10).
  7501             20  CL-CERT-SFX         PIC X.
  7502
  7503     12  CL-CONTROL-BY-NAME.
  7504         16  CL-COMPANY-CD-A1        PIC X.
  7505         16  CL-INSURED-LAST-NAME    PIC X(15).
  7506         16  CL-INSURED-NAME.
  7507             20  CL-INSURED-1ST-NAME PIC X(12).
  7508             20  CL-INSURED-MID-INIT PIC X.
  7509
  7510     12  CL-CONTROL-BY-SSN.
  7511         16  CL-COMPANY-CD-A2        PIC X.
  7512         16  CL-SOC-SEC-NO.
  7513             20  CL-SSN-STATE        PIC XX.
  7514             20  CL-SSN-ACCOUNT      PIC X(6).
  7515             20  CL-SSN-LN3          PIC X(3).
  7516
  7517     12  CL-CONTROL-BY-CERT-NO.
  7518         16  CL-COMPANY-CD-A4        PIC X.
  7519         16  CL-CERT-NO-A4.
  7520             20  CL-CERT-A4-PRIME    PIC X(10).
  7521             20  CL-CERT-A4-SFX      PIC X.
  7522
  7523     12  CL-CONTROL-BY-CCN.
  7524         16  CL-COMPANY-CD-A5        PIC X.
  7525         16  CL-CCN-A5.
  7526             20  CL-CCN.
  7527                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7528                 24  CL-CCN-PRIME-A5 PIC X(12).
  7529             20  CL-CCN-FILLER-A5    PIC X(4).
  7530
  7531     12  CL-INSURED-PROFILE-DATA.
  7532         16  CL-INSURED-BIRTH-DT     PIC XX.
  7533         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 139
* EL6311.cbl
  7534             88  INSURED-IS-MALE        VALUE 'M'.
  7535             88  INSURED-IS-FEMALE      VALUE 'F'.
  7536             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7537         16  CL-INSURED-OCC-CD       PIC X(6).
  7538         16  FILLER                  PIC X(5).
  7539
  7540     12  CL-PROCESSING-INFO.
  7541         16  CL-PROCESSOR-ID         PIC X(4).
  7542         16  CL-CLAIM-STATUS         PIC X.
  7543             88  CLAIM-IS-OPEN          VALUE 'O'.
  7544             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7545         16  CL-CLAIM-TYPE           PIC X.
  7546*            88  AH-CLAIM               VALUE 'A'.
  7547*            88  LIFE-CLAIM             VALUE 'L'.
  7548*            88  PROPERTY-CLAIM         VALUE 'P'.
  7549*            88  IUI-CLAIM              VALUE 'I'.
  7550*            88  GAP-CLAIM              VALUE 'G'.
  7551*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7552         16  CL-CLAIM-PREM-TYPE      PIC X.
  7553             88  SINGLE-PREMIUM         VALUE '1'.
  7554             88  O-B-COVERAGE           VALUE '2'.
  7555             88  OPEN-END-COVERAGE      VALUE '3'.
  7556         16  CL-INCURRED-DT          PIC XX.
  7557         16  CL-REPORTED-DT          PIC XX.
  7558         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7559         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7560         16  CL-LAST-PMT-DT          PIC XX.
  7561         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7562         16  CL-PAID-THRU-DT         PIC XX.
  7563         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7564         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7565         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7566         16  CL-PMT-CALC-METHOD      PIC X.
  7567             88  CL-360-DAY-YR          VALUE '1'.
  7568             88  CL-365-DAY-YR          VALUE '2'.
  7569             88  CL-FULL-MONTHS         VALUE '3'.
  7570         16  CL-CAUSE-CD             PIC X(6).
  7571
  7572         16  CL-PRIME-CERT-NO.
  7573             20  CL-PRIME-CERT-PRIME PIC X(10).
  7574             20  CL-PRIME-CERT-SFX   PIC X.
  7575
  7576         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7577             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7578             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7579
  7580         16  CL-MICROFILM-NO         PIC X(10).
  7581         16  FILLER REDEFINES CL-MICROFILM-NO.
  7582             20  CL-BENEFIT-PERIOD   PIC 99.
  7583             20  FILLER              PIC X(8).
  7584         16  CL-PROG-FORM-TYPE       PIC X.
  7585         16  CL-LAST-ADD-ON-DT       PIC XX.
  7586
  7587         16  CL-LAST-REOPEN-DT       PIC XX.
  7588         16  CL-LAST-CLOSE-DT        PIC XX.
  7589         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7590             88  FINAL-PAID             VALUE '1'.
  7591             88  CLAIM-DENIED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 140
* EL6311.cbl
  7592             88  AUTO-CLOSE             VALUE '3'.
  7593             88  MANUAL-CLOSE           VALUE '4'.
  7594             88  BENEFITS-CHANGED       VALUE 'C'.
  7595             88  SETUP-ERRORS           VALUE 'E'.
  7596         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7597         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7598         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7599             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7600         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7601         16  FILLER                  PIC X.
  7602
  7603     12  CL-CERTIFICATE-DATA.
  7604         16  CL-CERT-ORIGIN          PIC X.
  7605             88  CERT-WAS-ONLINE        VALUE '1'.
  7606             88  CERT-WAS-CREATED       VALUE '2'.
  7607             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7608         16  CL-CERT-KEY-DATA.
  7609             20  CL-CERT-CARRIER     PIC X.
  7610             20  CL-CERT-GROUPING    PIC X(6).
  7611             20  CL-CERT-STATE       PIC XX.
  7612             20  CL-CERT-ACCOUNT.
  7613                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7614                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7615             20  CL-CERT-EFF-DT      PIC XX.
  7616
  7617     12  CL-STATUS-CONTROLS.
  7618         16  CL-PRIORITY-CD          PIC X.
  7619             88  CONFIDENTIAL-DATA      VALUE '8'.
  7620             88  HIGHEST-PRIORITY       VALUE '9'.
  7621         16  CL-SUPV-ATTN-CD         PIC X.
  7622             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7623             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7624         16  CL-PURGED-DT            PIC XX.
  7625         16  CL-RESTORED-DT          PIC XX.
  7626         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7627         16  CL-NEXT-RESEND-DT       PIC XX.
  7628         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7629         16  CL-CRITICAL-PERIOD      PIC 99.
  7630*        16  FILLER                  PIC XX.
  7631         16  CL-LAST-MAINT-DT        PIC XX.
  7632         16  CL-LAST-MAINT-USER      PIC X(4).
  7633         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7634         16  CL-LAST-MAINT-TYPE      PIC X.
  7635             88  CLAIM-SET-UP           VALUE ' '.
  7636             88  PAYMENT-MADE           VALUE '1'.
  7637             88  LETTER-SENT            VALUE '2'.
  7638             88  MASTER-WAS-ALTERED     VALUE '3'.
  7639             88  MASTER-WAS-RESTORED    VALUE '4'.
  7640             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7641             88  FILE-CONVERTED         VALUE '6'.
  7642             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7643             88  ERROR-CORRECTION       VALUE 'E'.
  7644         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7645         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7646         16  CL-BENEFICIARY          PIC X(10).
  7647         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7648         16  CL-DENIAL-TYPE          PIC X.
  7649             88  CL-TYPE-DENIAL          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 141
* EL6311.cbl
  7650             88  CL-TYPE-RESCISSION      VALUE '2'.
  7651             88  CL-TYPE-REFORMATION     VALUE '3'.
  7652             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7653             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7654         16  filler                  pic x(5).
  7655*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7656*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7657*        16  CL-RTW-DT               PIC XX.
  7658
  7659     12  CL-TRAILER-CONTROLS.
  7660         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7661             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7662             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7663             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7664         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7665         16  FILLER                  PIC XX.
  7666         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7667         16  CL-ADDRESS-TRAILER-CNT.
  7668             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7669                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7670             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7671                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7672             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7673                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7674             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7675                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7676             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7677                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7678             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7679                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7680             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7681                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7682
  7683     12  CL-CV-REFERENCE-NO.
  7684         16  CL-CV-REFNO-PRIME       PIC X(18).
  7685         16  CL-CV-REFNO-SFX         PIC XX.
  7686
  7687     12  CL-FILE-LOCATION            PIC X(4).
  7688
  7689     12  CL-PROCESS-ERRORS.
  7690         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7691             88  NO-FATAL-ERRORS        VALUE ZERO.
  7692         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7693             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7694
  7695     12  CL-PRODUCT-CD               PIC X.
  7696
  7697     12  CL-CURRENT-KEY-DATA.
  7698         16  CL-CURRENT-CARRIER      PIC X.
  7699         16  CL-CURRENT-GROUPING     PIC X(6).
  7700         16  CL-CURRENT-STATE        PIC XX.
  7701         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7702
  7703     12  CL-ASSOCIATES               PIC X.
  7704         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7705         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7706         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7707         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 142
* EL6311.cbl
  7708
  7709     12  CL-ACTIVITY-CODE            PIC 99.
  7710     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7711     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7712
  7713     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7714     12  CL-LAG-REPORT-CODE          PIC 9.
  7715     12  CL-LOAN-TYPE                PIC XX.
  7716     12  CL-LEGAL-STATE              PIC XX.
  7717
  7718     12  CL-YESNOSW                  PIC X.
  7719     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7720         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7721         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7722         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7723     12  cl-insured-type             pic x.
  7724         88  cl-claim-on-primary         value 'P'.
  7725         88  cl-claim-on-co-borrower     value 'C'.
  7726     12  cl-benefit-expiration-dt    PIC XX.
  7727*                                COPY ERCENDT.
  7728******************************************************************
  7729*                                                                *
  7730*                                                                *
  7731*                            ERCENDT.                            *
  7732*                            VMOD=2.001                          *
  7733*                                                                *
  7734*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7735*                                                                *
  7736*   FILE TYPE = VSAM,KSDS                                        *
  7737*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7738*                                                                *
  7739*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7740*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7741*                                                                *
  7742*   LOG = NO                                                     *
  7743*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7744******************************************************************
  7745*-----------------------------------------------------------------
  7746*                   C H A N G E   L O G
  7747*
  7748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7749*-----------------------------------------------------------------
  7750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7751* EFFECTIVE    NUMBER
  7752*-----------------------------------------------------------------
  7753* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7754*                                WITH OPEN CLAIMS
  7755* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7756* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7757* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7758*-----------------------------------------------------------------
  7759 01  ENDORSEMENT-RECORD.
  7760     12  EN-RECORD-ID                PIC XX.
  7761         88  VALID-EN-ID                VALUE 'EN'.
  7762     12  EN-CONTROL-PRIMARY.
  7763         16  EN-COMPANY-CD           PIC X.
  7764         16  EN-CARRIER              PIC X.
  7765         16  EN-GROUPING             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 143
* EL6311.cbl
  7766         16  EN-STATE                PIC XX.
  7767         16  EN-ACCOUNT              PIC X(10).
  7768         16  EN-CERT-EFF-DT          PIC XX.
  7769         16  EN-CERT-NO.
  7770             20  EN-CERT-PRIME       PIC X(10).
  7771             20  EN-CERT-SFX         PIC X.
  7772         16  EN-REC-TYPE             PIC X.
  7773             88  EN-ISSUE               VALUE 'I'.
  7774             88  EN-CANCELLATION        VALUE 'C'.
  7775         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7776     12  EN-CONTROL-BY-ARCH-NO.
  7777         16  EN-COMPANY-CD-A1              PIC X.
  7778         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7779     12  EN-LAST-MAINT-DT            PIC XX.
  7780     12  EN-LAST-MAINT-BY            PIC X(4).
  7781     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7782     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7783     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7784         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7785         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7786         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7787         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7788         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7789         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7790         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7791         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7792         16  EN-LF-ORIG-BENCD        PIC XX.
  7793         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7794         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7795         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7796         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7797         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7798         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7799*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7800         16  EN-ORIG-CRED-BENE       PIC X(25).
  7801         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7802         16  FILLER                  PIC X.
  7803         16  EN-AH-ORIG-BENCD        PIC XX.
  7804         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7805         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7806         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7807         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7808*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7809*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7810         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7811         16  F                       PIC X(09).
  7812         16  EN-AH-ORIG-CP           PIC 99.
  7813         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7814         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7815         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7816         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7817         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7818         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7819         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7820         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7821         16  EN-LF-NEW-BENCD         PIC XX.
  7822         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7823         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 144
* EL6311.cbl
  7824         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7825         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7826         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7827         16  EN-LF-NEW-EXP-DT        PIC XX.
  7828         16  EN-NEW-CRED-BENE        PIC X(25).
  7829         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7830         16  FILLER                  PIC X.
  7831         16  EN-AH-NEW-BENCD         PIC XX.
  7832         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7833         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7834         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7835         16  EN-AH-NEW-EXP-DT        PIC XX.
  7836*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7837*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7838*        16  F                       PIC X(12).
  7839         16  EN-AH-NEW-CP            PIC 99.
  7840         16  EN-SIG-SW               PIC X.
  7841         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7842         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7843         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7844         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7845         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7846         16  FILLER                  PIC X(33).
  7847     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7848         16  EN-LF-ORIG-REF-DT       PIC XX.
  7849         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7850         16  EN-AH-ORIG-REF-DT       PIC XX.
  7851         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7852         16  EN-LF-NEW-REF-DT        PIC XX.
  7853         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7854         16  EN-AH-NEW-REF-DT        PIC XX.
  7855         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7856         16  EN-FLAG-CERT            PIC X.
  7857         16  EN-INS-LAST-NAME        PIC X(15).
  7858         16  EN-INS-FIRST-NAME       PIC X(10).
  7859         16  EN-INS-MIDDLE-INIT      PIC X.
  7860         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7861         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7862         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7863         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7864         16  FILLER                  PIC X(262).
  7865     12  EN-MONEY-SW             PIC X.
  7866     12  EN-HEALTH-APP           PIC X.
  7867     12  EN-VOUCHER-SW           PIC X.
  7868     12  EN-PAYEE                PIC X(14).
  7869     12  EN-INPUT-DT             PIC XX.
  7870     12  EN-PROCESS-DT           PIC XX.
  7871     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7872     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7873     12  EN-REASON-CODES.
  7874         16  F OCCURS 12.
  7875             20  EN-REASON-CODE  PIC X(4).
  7876     12  EN-TEMPLATE-USED        PIC X(8).
  7877     12  EN-DOCU-TYPE            PIC X.
  7878         88  EN-VERI-DOCU          VALUE 'V'.
  7879         88  EN-GCE-DOCU           VALUE 'G'.
  7880         88  EN-CANC-DOCU          VALUE 'C'.
  7881     12  EN-COMMENTS1            PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 145
* EL6311.cbl
  7882     12  EN-COMMENTS2            PIC X(70).
  7883     12  EN-COMM-CHGBK           PIC X.
  7884         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7885         88  EN-CHG-ACCT           VALUE 'Y'.
  7886     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7887     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7888     12  EN-BATCH-NUMBER         PIC X(6).
  7889     12  EN-ACCT-SUMM            PIC X.
  7890     12  EN-CSO-SUMM             PIC X.
  7891     12  FILLER                  PIC X(13).
  7892******************************************************************
  7893*                                COPY ELCCRTT.
  7894******************************************************************
  7895*                                                                *
  7896*                            ELCCRTT.                            *
  7897*                                                                *
  7898*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7899*                                                                *
  7900*   FILE TYPE = VSAM,KSDS                                        *
  7901*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7902*                                                                *
  7903*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7904*                                                                *
  7905*   LOG = YES                                                    *
  7906*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7907******************************************************************
  7908*                   C H A N G E   L O G
  7909*
  7910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7911*-----------------------------------------------------------------
  7912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7913* EFFECTIVE    NUMBER
  7914*-----------------------------------------------------------------
  7915* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7916* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7917* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7918* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7919* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7920* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7921* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7922* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7923******************************************************************
  7924
  7925 01  CERTIFICATE-TRAILERS.
  7926     12  CS-RECORD-ID                      PIC XX.
  7927         88  VALID-CS-ID                      VALUE 'CS'.
  7928
  7929     12  CS-CONTROL-PRIMARY.
  7930         16  CS-COMPANY-CD                 PIC X.
  7931         16  CS-CARRIER                    PIC X.
  7932         16  CS-GROUPING                   PIC X(6).
  7933         16  CS-STATE                      PIC XX.
  7934         16  CS-ACCOUNT                    PIC X(10).
  7935         16  CS-CERT-EFF-DT                PIC XX.
  7936         16  CS-CERT-NO.
  7937             20  CS-CERT-PRIME             PIC X(10).
  7938             20  CS-CERT-SFX               PIC X.
  7939         16  CS-TRAILER-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 146
* EL6311.cbl
  7940             88  COMM-TRLR           VALUE 'A'.
  7941             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7942             88  CERT-DATA-TRLR      VALUE 'C'.
  7943
  7944     12  CS-DATA-AREA                      PIC X(516).
  7945
  7946     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7947         16  CS-BANK-COMMISSION-AREA.
  7948             20  CS-BANK-COMMS       OCCURS 10.
  7949                 24  CS-AGT                PIC X(10).
  7950                 24  CS-COM-TYP            PIC X.
  7951                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7952                 24  CS-RECALC-LV-INDIC    PIC X.
  7953                 24  FILLER                PIC X(10).
  7954         16  FILLER                        PIC X(256).
  7955
  7956     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7957****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7958         16  CS-MB-CLAIM-DATA OCCURS 24.
  7959             20  CS-CLAIM-NO               PIC X(7).
  7960             20  CS-CLAIM-TYPE             PIC X.
  7961                 88  CS-AH-CLM               VALUE 'A'.
  7962                 88  CS-IU-CLM               VALUE 'I'.
  7963                 88  CS-GP-CLM               VALUE 'G'.
  7964                 88  CS-LF-CLM               VALUE 'L'.
  7965                 88  CS-PR-CLM               VALUE 'P'.
  7966                 88  CS-FL-CLM               VALUE 'F'.
  7967             20  CS-INSURED-TYPE           PIC X.
  7968                 88  CS-PRIM-INSURED          VALUE 'P'.
  7969                 88  CS-CO-BORROWER           VALUE 'C'.
  7970             20  CS-BENEFIT-PERIOD         PIC 99.
  7971             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7972             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7973             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7974         16  FILLER                        PIC X(12).
  7975     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7976         16  CS-VIN-NUMBER                 PIC X(17).
  7977         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7978         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7979         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7980         16  cs-agent-name.
  7981             20  cs-agent-fname            pic x(20).
  7982             20  cs-agent-mi               pic x.
  7983             20  cs-agent-lname            pic x(25).
  7984         16  cs-license-no                 pic x(15).
  7985         16  cs-npn-number                 pic x(10).
  7986         16  cs-agent-edit-status          pic x.
  7987             88  cs-ae-refer-to-manager      value 'M'.
  7988             88  cs-ae-cover-sheet           value 'C'.
  7989             88  cs-ae-sig-form              value 'S'.
  7990             88  cs-ae-verified              value 'V'.
  7991             88  cs-unidentified-signature   value 'U'.
  7992             88  cs-cert-returned            value 'R'.
  7993             88  cs-accept-no-commission     value 'N'.
  7994         16  FILLER                        PIC X(424).
  7995*        16  FILLER                        PIC X(496).
  7996*                                COPY ERCCHEK.
  7997******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 147
* EL6311.cbl
  7998*                                                                *
  7999*                                                                *
  8000*                            ERCCHEK                             *
  8001*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8002*                            VMOD=2.008                          *
  8003*                                                                *
  8004*   FILE DESCRIPTION = CHECK RECORDS                             *
  8005*                                                                *
  8006*   FILE TYPE = VSAM,KSDS                                        *
  8007*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8008*                                                                *
  8009*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8010*       ALTERNATE INDEX = NONE                                   *
  8011*                                                                *
  8012*   LOG = YES                                                    *
  8013*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8014******************************************************************
  8015*                   C H A N G E   L O G
  8016*
  8017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8018*-----------------------------------------------------------------
  8019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8020* EFFECTIVE    NUMBER
  8021*-----------------------------------------------------------------
  8022* 021414    2003053000001  PEMA  changes for auto chk request
  8023******************************************************************
  8024 01  CHECK-RECORDS.
  8025     12  CH-RECORD-ID                      PIC XX.
  8026         88  VALID-CH-ID                      VALUE 'CH'.
  8027
  8028     12  CH-CONTROL-PRIMARY.
  8029         16  CH-COMPANY-CD                 PIC X.
  8030         16  CH-CARRIER                    PIC X.
  8031         16  CH-GROUPING                   PIC X(6).
  8032         16  CH-STATE                      PIC XX.
  8033         16  CH-ACCOUNT                    PIC X(10).
  8034         16  CH-CERT-EFF-DT                PIC XX.
  8035         16  CH-CERT-NO.
  8036             20  CH-CERT-PRIME             PIC X(10).
  8037             20  CH-CERT-SFX               PIC X.
  8038         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8039
  8040     12  CH-RECORDED-DT                    PIC XX.
  8041     12  CH-RECORDED-BY                    PIC X(4).
  8042     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8043
  8044     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8045     12  CH-CHECK-NO                       PIC X(7).
  8046     12  CH-REASON-FOR-CHECK               PIC X(25).
  8047     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8048     12  FILLER                            PIC X.
  8049
  8050     12  CH-PAYEE-INFO.
  8051         16  CH-PAYEE-NAME-1               PIC X(30).
  8052         16  CH-PAYEE-NAME-2               PIC X(30).
  8053         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8054         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8055         16  CH-PAYEE-CITY-ST.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 148
* EL6311.cbl
  8056             20  CH-PAYEE-CITY             PIC X(28).
  8057             20  CH-PAYEE-STATE            PIC XX.
  8058         16  CH-PAYEE-ZIP-CODE.
  8059             20  CH-PAYEE-ZIP.
  8060                 24  CH-ZIP-PRI-1ST        PIC X.
  8061                     88  CH-CANADIAN-POST-CODE
  8062                                           VALUES 'A' THRU 'Z'.
  8063                 24  FILLER                PIC X(4).
  8064             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8065         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8066             20  CH-CAN-POSTAL-1           PIC XXX.
  8067             20  CH-CAN-POSTAL-2           PIC XXX.
  8068             20  FILLER                    PIC XXX.
  8069
  8070     12  CH-CHECK-STUB-TEXT.
  8071         16  CH-STUB-LINE-1                PIC X(30).
  8072         16  CH-TEXT-LINE-1                PIC X(50).
  8073         16  CH-TEXT-LINE-2                PIC X(50).
  8074         16  CH-TEXT-LINE-3                PIC X(40).
  8075     12  CH-RETURN-TO                      PIC X(30).
  8076
  8077     12  CH-COMPENSATION-CONTROL.
  8078         16  CH-COMP-CARRIER               PIC X.
  8079         16  CH-COMP-GROUPING              PIC X(6).
  8080         16  CH-COMP-FIN-RESP              PIC X(10).
  8081         16  CH-COMP-ACCOUNT               PIC X(10).
  8082
  8083     12  CH-CREDIT-SELECT-DT               PIC XX.
  8084     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8085     12  CH-PAYEE-CODE                     PIC X(6).
  8086
  8087     12  CH-VOID-DATA.
  8088         20  CH-VOID-DT                    PIC XX.
  8089         20  CH-VOID-BY                    PIC X(4).
  8090         20  CH-VOID-REASON                PIC X(25).
  8091
  8092     12  CH-APPROVAL-DATA.
  8093         20  CH-APPROVAL-DT                PIC XX.
  8094         20  CH-APPROVAL-STATUS            PIC X.
  8095             88  CH-IN-LIMBO                  VALUE ' '.
  8096             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8097             88  CH-APPROVED                  VALUE 'A'.
  8098             88  CH-DENIED                    VALUE 'D'.
  8099         20  CH-APPROVED-BY                PIC XXXX.
  8100     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8101             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8102     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8103
  8104     12  ch-released-dt                    pic xx.
  8105     12  ch-check-cashed-dt                pic xx.
  8106     12  FILLER                            PIC X.
  8107*    12  CH-CHECK-REFERENCE                PIC X(12).
  8108     12  CH-CHECK-ORIGIN-SW                PIC X.
  8109             88  CH-REFUND-CHECK              VALUE 'R'.
  8110             88  CH-MAINT-CHECK               VALUE 'M'.
  8111
  8112     12  CH-CANC-DT                        PIC XX.
  8113     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 149
* EL6311.cbl
  8114     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8115
  8116     12  CH-INSURED-NAME                   PIC X(28).
  8117
  8118     12  ch-released-by                    pic x(4).
  8119     12  ch-csr                            pic x(4).
  8120     12  ch-deduct-commission              pic x.
  8121         88  ch-deduct-comm                  value 'Y'.
  8122         88  ch-do-not-deduct-comm           value 'N'.
  8123
  8124     12  FILLER                            PIC X(11).
  8125*    12  CH-LETTER-TABLE.
  8126*        16  CH-LETTERS OCCURS 3 TIMES
  8127*                       INDEXED BY CH-LT-NDX
  8128*                                          PIC X(04).
  8129
  8130     12  FILLER                            PIC X(07).
  8131
  8132 01  var                         pic x(30).
  8133 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8134                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8135                          PENDING-MAILING-DATA MAILING-DATA
  8136                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8137                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8138                          CLAIM-MASTER ENDORSEMENT-RECORD
  8139                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8140                          VAR.
  8141 0000-DFHEXIT SECTION.
  8142     MOVE '9#                    $   ' TO DFHEIV0.
  8143     MOVE 'EL6311' TO DFHEIV1.
  8144     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8145
  8146     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8147     MOVE EIBTRMID               TO QID-TERM.
  8148     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8149     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8150     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8151     MOVE 2                      TO EMI-SWITCH2.
  8152
  8153     move spaces to ws-kix-myenv
  8154     set P to address of KIXSYS
  8155     CALL "getenv" using by value P returning var-ptr
  8156     if var-ptr = null then
  8157        display ' kixsys not set '
  8158     else
  8159        set address of var to var-ptr
  8160        move 0 to env-var-len
  8161        inspect var tallying env-var-len
  8162          for characters before X'00'
  8163        unstring var (1:env-var-len) delimited by '/'
  8164           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8165              WS-KIX-SYS
  8166        end-unstring
  8167     end-if
  8168     perform varying a1 from +1 by +1 until a1 > +10
  8169        if ws-kix-myenv (a1:1) = low-values or high-values
  8170           display ' found low or hi val '
  8171           move spaces to ws-kix-myenv (a1:1)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 150
* EL6311.cbl
  8172        end-if
  8173     end-perform
  8174*    display ' env *' ws-kix-myenv '*'
  8175     IF EIBCALEN = 0
  8176         GO TO 8800-UNAUTHORIZED-ACCESS.
  8177
  8178     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8179     MOVE '5'                   TO DC-OPTION-CODE.
  8180     PERFORM 9700-DATE-LINK.
  8181     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8182     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8183
  8184     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8185     MOVE SPACE                  TO DC-OPTION-CODE.
  8186     PERFORM 9700-DATE-LINK.
  8187     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8188     MOVE LOW-VALUES             TO EL631BI.
  8189
  8190
  8191* EXEC CICS HANDLE CONDITION
  8192*        PGMIDERR  (9600-PGMID-ERROR)
  8193*        ERROR     (9990-ABEND)
  8194*        INVREQ    (9990-ABEND)
  8195*        QIDERR    (0010-MAIN-LOGIC)
  8196*    END-EXEC.
  8197*    MOVE '"$L.8N                ! " #00008186' TO DFHEIV0
  8198     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8200     MOVE X'2220233030303038313836' TO DFHEIV0(25:11)
  8201     CALL 'kxdfhei1' USING DFHEIV0
  8202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8203
  8204
  8205     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8206         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8207             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8208             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8209             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8210             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8211             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8212             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8213             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8214             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8215
  8216             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8217                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8218
  8219             ELSE
  8220                 NEXT SENTENCE
  8221
  8222         ELSE
  8223             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8224             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8225             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8226             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8227             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8228             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8229             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 151
* EL6311.cbl
  8230             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8231             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8232             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8233             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8234             GO TO 3900-RE-DISPLAY-RECORD
  8235     ELSE
  8236         GO TO 0020-MAIN-LOGIC.
  8237
  8238 0010-MAIN-LOGIC.
  8239     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8240                                    WS-FIRST-ENTRY-SW.
  8241
  8242     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8243
  8244     MOVE LOW-VALUES             TO EC-NEW-CERT
  8245                                    EC-NEW-STATE.
  8246
  8247     IF PI-DISPLAY-ORIGINAL-BATCH
  8248         NEXT SENTENCE
  8249     ELSE
  8250         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8251             GO TO 5000-BROWSE-BATCH-HEADERS.
  8252
  8253     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8254         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8255
  8256     IF PI-CSR-BROWSE
  8257        GO TO 4200-BROWSE-CSR-FORWARD.
  8258
  8259     IF PI-FILE-BROWSE
  8260         GO TO 4300-BROWSE-FILE-FORWARD.
  8261
  8262     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8263
  8264 0020-MAIN-LOGIC.
  8265     IF EIBAID = DFHCLEAR
  8266         GO TO 9400-CLEAR.
  8267
  8268     MOVE LOW-VALUES             TO EC-NEW-CERT
  8269                                    EC-NEW-STATE.
  8270
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 152
* EL6311.cbl
  8272
  8273******************************************************************
  8274*                                                                *
  8275*              R E C E I V E   M A P                             *
  8276*                                                                *
  8277******************************************************************
  8278
  8279 0200-RECEIVE.
  8280     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8281         MOVE ER-0008            TO EMI-ERROR
  8282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8283         IF PI-MAP-NAME = EL631B
  8284             MOVE -1                 TO BMAINTL
  8285             GO TO 8200-SEND-DATAONLY
  8286         ELSE
  8287             IF PI-MAP-NAME = EL631C
  8288                 MOVE -1                 TO CMAINTL
  8289                 GO TO 8200-SEND-DATAONLY
  8290             ELSE
  8291                 IF PI-MAP-NAME = EL631D
  8292                     MOVE -1                 TO DPFENTRL
  8293                     GO TO 8200-SEND-DATAONLY.
  8294
  8295
  8296* EXEC CICS RECEIVE
  8297*        MAP      (PI-MAP-NAME)
  8298*        MAPSET   (MAPSET-EL6311S)
  8299*        INTO     (EL631BI)
  8300*    END-EXEC.
  8301     MOVE LENGTH OF
  8302      EL631BI
  8303       TO DFHEIV11
  8304*    MOVE '8"T I  L              ''   #00008283' TO DFHEIV0
  8305     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8307     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  8308     CALL 'kxdfhei1' USING DFHEIV0,
  8309           PI-MAP-NAME,
  8310           EL631BI,
  8311           DFHEIV11,
  8312           MAPSET-EL6311S,
  8313           DFHEIV99,
  8314           DFHEIV99
  8315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8316
  8317
  8318******************************************************************
  8319*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8320******************************************************************
  8321
  8322     IF BTYPE-LEN (1) EQUAL +3
  8323        IF BTYPE (1) EQUAL ALL ' '
  8324            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8325
  8326     IF BTYPE-LEN (2) EQUAL +3
  8327        IF BTYPE (2) EQUAL ALL ' '
  8328            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8329
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 153
* EL6311.cbl
  8330     INSPECT EL631BI CONVERTING '_' TO ' '.
  8331
  8332     IF PI-MAP-NAME = EL631B
  8333         IF BPFENTRL GREATER THAN ZEROS
  8334             IF EIBAID NOT = DFHENTER
  8335                 MOVE ER-0004       TO EMI-ERROR
  8336                 MOVE -1            TO BPFENTRL
  8337                 MOVE AL-UNBOF      TO BPFENTRA
  8338                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8339                 GO TO 8200-SEND-DATAONLY
  8340             ELSE
  8341                 IF BPFENTRI NUMERIC AND
  8342                   (BPFENTRI GREATER 0 AND LESS 25)
  8343                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8344                 ELSE
  8345                     MOVE ER-0029  TO EMI-ERROR
  8346                     MOVE AL-UNBON TO BPFENTRA
  8347                     MOVE -1       TO BPFENTRL
  8348                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8349                     GO TO 8200-SEND-DATAONLY
  8350         ELSE
  8351             NEXT SENTENCE
  8352     ELSE
  8353         IF PI-MAP-NAME = EL631C
  8354            IF CPFENTRL GREATER THAN ZEROS
  8355                IF EIBAID NOT = DFHENTER
  8356                 MOVE ER-0004         TO EMI-ERROR
  8357                 MOVE -1              TO CPFENTRL
  8358                 MOVE AL-UNBOF        TO CPFENTRA
  8359                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8360                 GO TO 8200-SEND-DATAONLY
  8361             ELSE
  8362                 IF CPFENTRI NUMERIC AND
  8363                   (CPFENTRI GREATER 0 AND LESS 25)
  8364                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8365                 ELSE
  8366                     MOVE ER-0029      TO EMI-ERROR
  8367                     MOVE AL-UNBON     TO CPFENTRA
  8368                     MOVE -1           TO CPFENTRL
  8369                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8370                     GO TO 8200-SEND-DATAONLY
  8371         ELSE
  8372             NEXT SENTENCE
  8373     ELSE
  8374     IF PI-MAP-NAME = EL631D
  8375         IF DPFENTRL GREATER THAN ZEROS
  8376             IF EIBAID NOT = DFHENTER
  8377                 MOVE ER-0004         TO EMI-ERROR
  8378                 MOVE -1              TO DPFENTRL
  8379                 MOVE AL-UNBOF        TO DPFENTRA
  8380                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8381                 GO TO 8200-SEND-DATAONLY
  8382             ELSE
  8383                 IF DPFENTRI NUMERIC AND
  8384                   (DPFENTRI GREATER 0 AND LESS 25)
  8385                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8386                 ELSE
  8387                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 154
* EL6311.cbl
  8388                     MOVE AL-UNBON     TO DPFENTRA
  8389                     MOVE -1           TO DPFENTRL
  8390                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391                     GO TO 8200-SEND-DATAONLY.
  8392
  8393     IF EIBAID = DFHPF23
  8394         GO TO 8810-PF23.
  8395
  8396     IF EIBAID = DFHPF24
  8397         GO TO 9200-RETURN-MAIN-MENU.
  8398
  8399     IF EIBAID = DFHPF12
  8400         GO TO 9500-PF12.
  8401
  8402     IF PI-MAP-NAME = EL631B
  8403        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8404
  8405     IF PI-MAP-NAME = EL631C
  8406        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8407
  8408     IF PI-MAP-NAME = EL631D
  8409        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8410
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 155
* EL6311.cbl
  8412
  8413******************************************************************
  8414*                                                                *
  8415*      ISSUE SCREEN PF KEY CHECKING                              *
  8416*                                                                *
  8417******************************************************************
  8418
  8419******************************************************************
  8420*                                                                *
  8421*      PF KEY FUNCTIONS:                                         *
  8422*                                                                *
  8423*      PF1  = BROWSE FORWARD                                     *
  8424*      PF2  = BROWSE BACKWARD                                    *
  8425*      PF3  = CERTIFICATE LOOKUP                                 *
  8426*      PF4  = DISPLAY BATCH HEADER                               *
  8427*      PF5  = ADD ISSUE  SCREEN                                  *
  8428*      PF6  = ADD CANCEL SCREEN                                  *
  8429*      PF7  = CERTIFICATE DISPLAY                                *
  8430*      PF8  = CERTIFICATE NOTES                                  *
  8431*      PF9  = EDIT CONTROL                                       *
  8432*      PF10 = DISPLAY LETTER SCREEN                              *
  8433*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8434*      PF12 = HELP SCREEN                                        *
  8435*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8436*      PF14 = ACCOUNT MASTER                                     *
  8437*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8438*      PF16 = DISPLAY LETTER REVIEW                              *
  8439*                                                                *
  8440******************************************************************
  8441
  8442 0300-CHECK-ISSUE-PF-KEYS.
  8443     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8444        MOVE ER-2337            TO EMI-ERROR
  8445        MOVE -1                  TO BMAINTL
  8446        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8447        GO TO 8200-SEND-DATAONLY.
  8448
  8449     IF EIBAID = DFHPF1
  8450        MOVE '0'                TO PI-EDIT-SW
  8451        IF PI-PRIMARY-BROWSE
  8452           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8453        ELSE
  8454           IF PI-PRIMARY-WITH-SELECT
  8455              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8456           ELSE
  8457              IF PI-FILE-BROWSE
  8458                 GO TO 4300-BROWSE-FILE-FORWARD
  8459              ELSE
  8460                 IF PI-CSR-BROWSE
  8461                    GO TO 4200-BROWSE-CSR-FORWARD
  8462                 ELSE
  8463                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8464
  8465     IF EIBAID = DFHPF2
  8466        MOVE '0'                TO PI-EDIT-SW
  8467        IF PI-PRIMARY-BROWSE
  8468           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8469        ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 156
* EL6311.cbl
  8470           IF PI-PRIMARY-WITH-SELECT
  8471              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8472           ELSE
  8473              IF PI-FILE-BROWSE
  8474                 GO TO 4800-BROWSE-FILE-BACKWARD
  8475              ELSE
  8476                 IF PI-CSR-BROWSE
  8477                    GO TO 4900-BROWSE-CSR-BACKWARD
  8478                 ELSE
  8479                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8480
  8481     IF EIBAID = DFHPF3
  8482        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8483        MOVE XCTL-EL127         TO PGM-NAME
  8484        GO TO 9300-XCTL.
  8485
  8486     IF (EIBAID = DFHPF15 OR DFHPF6)
  8487        AND (CSR-EDIT-SESSION)
  8488*       AND (FATAL-OR-UNFORCED)
  8489        AND (FATAL-ERRORS)
  8490        MOVE ER-1819             TO EMI-ERROR
  8491        MOVE -1                  TO BMAINTL
  8492        MOVE AL-UANON            TO BMAINTA
  8493        PERFORM 9900-ERROR-FORMAT
  8494                                 THRU 9900-EXIT
  8495        GO TO 8200-SEND-DATAONLY
  8496     END-IF
  8497     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8498      OR (EIBAID = DFHPF10)
  8499        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8500        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8501        IF (RESP-NORMAL)
  8502           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8503              AM-CONTROL-PRIMARY (1:20))
  8504            IF AM-NAME NOT GREATER THAN SPACES OR
  8505               AM-ADDRS NOT GREATER THAN SPACES  OR
  8506               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8507               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8508               AM-ZIP NOT GREATER THAN SPACES
  8509               MOVE ER-3834             TO EMI-ERROR
  8510               MOVE -1                  TO BMAINTL
  8511               MOVE AL-UANON            TO BMAINTA
  8512               PERFORM 9900-ERROR-FORMAT
  8513                                 THRU 9900-EXIT
  8514               GO TO 8200-SEND-DATAONLY
  8515            END-IF
  8516        ELSE
  8517           MOVE ER-1609             TO EMI-ERROR
  8518           MOVE -1                  TO BMAINTL
  8519           MOVE AL-UANON            TO BMAINTA
  8520           PERFORM 9900-ERROR-FORMAT
  8521                                THRU 9900-EXIT
  8522           GO TO 8200-SEND-DATAONLY
  8523        END-IF
  8524
  8525        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8526        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8527        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 157
* EL6311.cbl
  8528            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8529               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8530               MA-CITY NOT GREATER THAN SPACES OR
  8531               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8532               MA-ZIP-CODE NOT GREATER THAN SPACES
  8533               MOVE ER-3835             TO EMI-ERROR
  8534               MOVE -1                  TO BMAINTL
  8535               MOVE AL-UANON            TO BMAINTA
  8536               PERFORM 9900-ERROR-FORMAT
  8537                                 THRU 9900-EXIT
  8538               GO TO 8200-SEND-DATAONLY
  8539            END-IF
  8540        ELSE
  8541           MOVE ER-3000             TO EMI-ERROR
  8542           MOVE -1                  TO BMAINTL
  8543           MOVE AL-UANON            TO BMAINTA
  8544           PERFORM 9900-ERROR-FORMAT
  8545                                THRU 9900-EXIT
  8546           GO TO 8200-SEND-DATAONLY
  8547        END-IF
  8548
  8549     END-IF
  8550     IF (EIBAID = DFHPF15)
  8551        AND (CSR-EDIT-SESSION)
  8552        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8553        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8554        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8555        MOVE PI-SV-STATE         TO PI-STATE
  8556        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8557        MOVE BCERTNOI            TO PI-CERT-PRIME
  8558        MOVE BSUFIXI             TO PI-CERT-SFX
  8559        MOVE BEFFDTI             TO DEEDIT-FIELD
  8560        PERFORM 8600-DEEDIT
  8561        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8562        MOVE '4'                 TO DC-OPTION-CODE
  8563        PERFORM 9700-DATE-LINK
  8564        IF DATE-CONVERSION-ERROR
  8565           MOVE ER-0348          TO EMI-ERROR
  8566           MOVE -1               TO BEFFDTL
  8567           MOVE AL-UABON         TO BEFFDTA
  8568           PERFORM 9900-ERROR-FORMAT
  8569                                 THRU 9900-EXIT
  8570           GO TO 8200-SEND-DATAONLY
  8571        ELSE
  8572           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8573           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8574           MOVE XCTL-EL6315      TO PGM-NAME
  8575           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8576           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8577           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8578           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8579           GO TO 9300-XCTL
  8580        END-IF
  8581     END-IF
  8582
  8583     IF EIBAID = DFHPF4
  8584        MOVE '0'                TO PI-EDIT-SW
  8585        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 158
* EL6311.cbl
  8586           NEXT SENTENCE
  8587        ELSE
  8588           GO TO 7200-DISPLAY-BATCHES.
  8589
  8590     IF EIBAID = DFHPF5
  8591        MOVE ER-0029                TO EMI-ERROR
  8592        MOVE -1                     TO BPFENTRL
  8593        MOVE AL-UNBON               TO BPFENTRA
  8594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8595        GO TO 8200-SEND-DATAONLY.
  8596*        MOVE '0'                TO PI-EDIT-SW
  8597*        IF PI-DISPLAY-ORIGINAL-BATCH
  8598*           NEXT SENTENCE
  8599*        ELSE
  8600*           MOVE EL631B              TO PI-MAP-NAME
  8601*           MOVE LOW-VALUES          TO EL631BI
  8602*           MOVE 'A'                 TO BMAINTO
  8603*           MOVE AL-UANON            TO BMAINTA
  8604*           MOVE -1                  TO BMAINTL
  8605*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8606*           GO TO 8100-SEND-INITIAL-MAP.
  8607
  8608     IF EIBAID = DFHPF6
  8609        IF NOT CSR-EDIT-SESSION
  8610           MOVE ER-0029                TO EMI-ERROR
  8611           MOVE -1                     TO BPFENTRL
  8612           MOVE AL-UNBON               TO BPFENTRA
  8613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8614           GO TO 8200-SEND-DATAONLY
  8615*           MOVE '0'              TO PI-EDIT-SW
  8616*           IF PI-DISPLAY-ORIGINAL-BATCH
  8617*              NEXT SENTENCE
  8618*           ELSE
  8619*              MOVE EL631C        TO PI-MAP-NAME
  8620*              MOVE LOW-VALUES    TO EL631CI
  8621*              MOVE 'A'           TO CMAINTO
  8622*              MOVE AL-UANON      TO CMAINTA
  8623*              MOVE -1            TO CMAINTL
  8624*              MOVE '6'           TO PI-MAINT-FUNCTION
  8625*              GO TO 8100-SEND-INITIAL-MAP
  8626*           END-IF
  8627        ELSE
  8628           PERFORM 5100-PROCESS-POL-RESC
  8629                                 THRU 5100-EXIT
  8630           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8631           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8632                                    PI-PREV-SEQ-NO
  8633           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8634*                                    WS-CANCEL-LETTER-SW
  8635                                    PI-ALL-ISSUES-SW
  8636                                    PI-ALL-CANCELS-SW
  8637           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8638        END-IF
  8639     END-IF
  8640     IF EIBAID = DFHPF7
  8641        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8642        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8643        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 159
* EL6311.cbl
  8644        MOVE PI-SV-STATE            TO PI-STATE
  8645        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8646        MOVE BCERTNOI               TO PI-CERT-PRIME
  8647        MOVE BSUFIXI                TO PI-CERT-SFX
  8648        MOVE BEFFDTI                TO DEEDIT-FIELD
  8649        PERFORM 8600-DEEDIT
  8650        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8651        MOVE '4'                    TO DC-OPTION-CODE
  8652        PERFORM 9700-DATE-LINK
  8653        IF DATE-CONVERSION-ERROR
  8654           MOVE ER-0348            TO EMI-ERROR
  8655           MOVE -1                  TO BEFFDTL
  8656           MOVE AL-UABON            TO BEFFDTA
  8657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658           GO TO 8200-SEND-DATAONLY
  8659        ELSE
  8660           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8661           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8662           MOVE XCTL-EL1273        TO PGM-NAME
  8663           GO TO 9300-XCTL.
  8664
  8665     IF EIBAID = DFHPF8
  8666        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8667        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8668        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8669        MOVE PI-SV-STATE            TO PI-STATE
  8670        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8671        MOVE BCERTNOI               TO PI-CERT-PRIME
  8672        MOVE BSUFIXI                TO PI-CERT-SFX
  8673        MOVE BEFFDTI                TO DEEDIT-FIELD
  8674        PERFORM 8600-DEEDIT
  8675        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8676        MOVE '4'                    TO DC-OPTION-CODE
  8677        PERFORM 9700-DATE-LINK
  8678        IF DATE-CONVERSION-ERROR
  8679           MOVE ER-0348            TO EMI-ERROR
  8680           MOVE -1                  TO BEFFDTL
  8681           MOVE AL-UABON            TO BEFFDTA
  8682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8683           GO TO 8200-SEND-DATAONLY
  8684        ELSE
  8685           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8686           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8687           IF PI-COMPANY-ID = 'DMD'
  8688               MOVE XCTL-EL401DMD      TO PGM-NAME
  8689             ELSE
  8690               MOVE XCTL-EL1279        TO PGM-NAME
  8691           END-IF
  8692           GO TO 9300-XCTL.
  8693
  8694     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8695        MOVE XCTL-EL6312         TO PGM-NAME
  8696
  8697* EXEC CICS XCTL
  8698*           PROGRAM   (PGM-NAME)
  8699*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8700*           LENGTH    (WS-COMM-LENGTH)
  8701*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 160
* EL6311.cbl
  8702*    MOVE '.$C                   %   #00008667' TO DFHEIV0
  8703     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
  8707           PGM-NAME,
  8708           PROGRAM-INTERFACE-BLOCK,
  8709           WS-COMM-LENGTH,
  8710           DFHEIV99
  8711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8712     ELSE
  8713        MOVE '0'                 TO  PI-EDIT-SW.
  8714
  8715     IF  EIBAID = DFHPF10
  8716         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8717         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8718         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8719                                    PI-1042-WA
  8720         MOVE 4                  TO PI-689-DATA-SOURCE
  8721         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8722         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8723         MOVE PI-SV-STATE        TO PI-689-STATE
  8724         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8725         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8726         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8727         MOVE PI-PB-ALT-CHG-SEQ-NO
  8728                                 TO PI-689-ALT-SEQ-NO
  8729         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8730         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8731         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8732         MOVE +0                 TO PI-689-CONTROL
  8733         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8734                                    PI-689-EXP-DATE
  8735                                    PI-689-RESP-PERSON
  8736                                    PI-689-TYPE
  8737                                    PI-689-FOLLOW-UP-EDIT
  8738                                    PI-689-RESEND1-EDIT
  8739                                    PI-689-SEQ-EDIT
  8740                                    PI-689-BCSEQ-EDIT
  8741                                    PI-689-LBL-OVERRIDE
  8742         MOVE W-LETTER-COMMUNICATION-AREAS
  8743                                 TO PI-PROGRAM-WORK-AREA
  8744         MOVE XCTL-EL689         TO PGM-NAME
  8745         GO TO 9300-XCTL.
  8746
  8747     IF  EIBAID = DFHPF16
  8748         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8749         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8750         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8751                                    PI-1042-WA
  8752         MOVE 4                  TO PI-689-DATA-SOURCE
  8753         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8754         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8755         MOVE PI-SV-STATE        TO PI-689-STATE
  8756         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8757         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8758         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8759         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 161
* EL6311.cbl
  8760                                 TO PI-689-ALT-SEQ-NO
  8761         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8762         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8763         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8764         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8765         MOVE W-LETTER-COMMUNICATION-AREAS
  8766                                 TO PI-PROGRAM-WORK-AREA
  8767         MOVE XCTL-EL690         TO PGM-NAME
  8768         GO TO 9300-XCTL.
  8769
  8770     IF EIBAID = DFHPF13
  8771         MOVE XCTL-EL6313        TO PGM-NAME
  8772         GO TO 9300-XCTL.
  8773
  8774     IF EIBAID = DFHPF17
  8775        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8776        IF (PB-I-LOAN-APR numeric)
  8777           and (pb-i-loan-apr < 99.9999)
  8778           AND (PB-I-BENEFICIARY-NAME NOT
  8779              = SPACES AND LOW-VALUES)
  8780
  8781           MOVE LINK-ELVADS          TO PGM-NAME
  8782
  8783* EXEC CICS LINK
  8784*              PROGRAM    (PGM-NAME)
  8785*              COMMAREA   (WS-PASS-AREA)
  8786*              LENGTH     (WS-PASS-AREA-LENGTH)
  8787*          END-EXEC
  8788*    MOVE '."C                   (   #00008742' TO DFHEIV0
  8789     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8790     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8791     MOVE X'2020233030303038373432' TO DFHEIV0(25:11)
  8792     CALL 'kxdfhei1' USING DFHEIV0,
  8793           PGM-NAME,
  8794           WS-PASS-AREA,
  8795           WS-PASS-AREA-LENGTH,
  8796           DFHEIV99,
  8797           DFHEIV99,
  8798           DFHEIV99,
  8799           DFHEIV99
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8801
  8802           MOVE 0000             TO EMI-ERROR
  8803           MOVE -1               TO BMAINTL
  8804           PERFORM 9900-ERROR-FORMAT
  8805                                 THRU 9900-EXIT
  8806           GO TO 8200-SEND-DATAONLY
  8807        ELSE
  8808           MOVE ER-0877            TO EMI-ERROR
  8809           MOVE -1                  TO BEFFDTL
  8810           MOVE AL-UABON            TO BEFFDTA
  8811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8812           GO TO 8200-SEND-DATAONLY
  8813        END-IF
  8814     END-IF
  8815     IF EIBAID = DFHPF14
  8816        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8817        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 162
* EL6311.cbl
  8818        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8819        MOVE PI-SV-STATE            TO PI-CR-STATE
  8820        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8821        MOVE SPACE                  TO PI-EDIT-SW
  8822        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8823        MOVE XCTL-EL650             TO PGM-NAME
  8824        GO TO 9300-XCTL.
  8825
  8826     IF EIBAID = DFHPF15
  8827        IF PI-COMPANY-ID  =  'HER'
  8828            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8829            MOVE XCTL-EL680         TO PGM-NAME
  8830            GO TO 9300-XCTL.
  8831
  8832     IF EIBAID = DFHENTER OR DFHPF11
  8833        GO TO 1000-ISSUE-MAINLINE.
  8834
  8835     MOVE ER-0029                TO EMI-ERROR
  8836     MOVE -1                     TO BPFENTRL
  8837     MOVE AL-UNBON               TO BPFENTRA
  8838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8839     GO TO 8200-SEND-DATAONLY.
  8840
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 163
* EL6311.cbl
  8842
  8843******************************************************************
  8844*                                                                *
  8845*      CANCEL SCREEN PF KEY CHECKING                             *
  8846*                                                                *
  8847******************************************************************
  8848
  8849******************************************************************
  8850*                                                                *
  8851*      PF KEY FUNCTIONS:                                         *
  8852*                                                                *
  8853*      PF1  = BROWSE FORWARD                                     *
  8854*      PF2  = BROWSE BACKWARD                                    *
  8855*      PF3  = CERTIFICATE LOOKUP                                 *
  8856*      PF4  = DISPLAY BATCH HEADER                               *
  8857*      PF5  = ADD ISSUE SCREEN                                   *
  8858*      PF6  = ADD CANCEL SCREEN                                  *
  8859*      PF7  = CERTIFICATE DISPLAY                                *
  8860*      PF8  = CERTIFICATE NOTES                                  *
  8861*      PF9  = EDIT CONTROL                                       *
  8862*      PF10 = DISPLAY LETTER SCREEN                              *
  8863*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8864*      PF12 = DISPLAY HELP SCREEN                                *
  8865*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8866*      PF14 = ACCOUNT MASTER                                     *
  8867*      PF16 = LETTER REVIEW                                      *
  8868*                                                                *
  8869******************************************************************
  8870
  8871 0400-CHECK-CANCEL-PF-KEYS.
  8872     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8873        MOVE ER-2337             TO EMI-ERROR
  8874        MOVE -1                  TO CMAINTL
  8875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8876        GO TO 8200-SEND-DATAONLY.
  8877
  8878     IF EIBAID = DFHPF1
  8879        MOVE '0'                TO PI-EDIT-SW
  8880        IF PI-PRIMARY-BROWSE
  8881           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8882        ELSE
  8883           IF PI-PRIMARY-WITH-SELECT
  8884              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8885           ELSE
  8886              IF PI-FILE-BROWSE
  8887                 GO TO 4300-BROWSE-FILE-FORWARD
  8888              ELSE
  8889                 IF PI-CSR-BROWSE
  8890                    GO TO 4200-BROWSE-CSR-FORWARD
  8891                 ELSE
  8892                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8893
  8894     IF EIBAID = DFHPF2
  8895        MOVE '0'                TO PI-EDIT-SW
  8896        IF PI-PRIMARY-BROWSE
  8897           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8898        ELSE
  8899           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 164
* EL6311.cbl
  8900              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8901           ELSE
  8902              IF PI-FILE-BROWSE
  8903                 GO TO 4800-BROWSE-FILE-BACKWARD
  8904              ELSE
  8905                 IF PI-CSR-BROWSE
  8906                    GO TO 4900-BROWSE-CSR-BACKWARD
  8907                 ELSE
  8908                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8909
  8910     IF EIBAID = DFHPF3
  8911        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8912        MOVE XCTL-EL127         TO PGM-NAME
  8913        GO TO 9300-XCTL.
  8914
  8915     IF (EIBAID = DFHPF15 OR DFHPF17)
  8916        AND (CSR-EDIT-SESSION)
  8917*       AND (FATAL-OR-UNFORCED)
  8918        AND (FATAL-ERRORS)
  8919        MOVE ER-1819             TO EMI-ERROR
  8920        MOVE -1                  TO CMAINTL
  8921        MOVE AL-UANON            TO CMAINTA
  8922        PERFORM 9900-ERROR-FORMAT
  8923                                 THRU 9900-EXIT
  8924        GO TO 8200-SEND-DATAONLY
  8925     END-IF
  8926     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8927       AND (CSR-EDIT-SESSION)
  8928        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8929        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8930        IF (RESP-NORMAL)
  8931           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8932              AM-CONTROL-PRIMARY (1:20))
  8933            IF AM-NAME NOT GREATER THAN SPACES OR
  8934               AM-ADDRS NOT GREATER THAN SPACES  OR
  8935               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8936               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8937               AM-ZIP NOT GREATER THAN SPACES
  8938               MOVE ER-3834             TO EMI-ERROR
  8939               MOVE -1                  TO BMAINTL
  8940               MOVE AL-UANON            TO BMAINTA
  8941               PERFORM 9900-ERROR-FORMAT
  8942                                 THRU 9900-EXIT
  8943               GO TO 8200-SEND-DATAONLY
  8944            END-IF
  8945        ELSE
  8946           MOVE ER-1609             TO EMI-ERROR
  8947           MOVE -1                  TO BMAINTL
  8948           MOVE AL-UANON            TO BMAINTA
  8949           PERFORM 9900-ERROR-FORMAT
  8950                                THRU 9900-EXIT
  8951           GO TO 8200-SEND-DATAONLY
  8952        END-IF
  8953
  8954        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8955        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8956        IF (ERMAIL-FOUND)
  8957            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 165
* EL6311.cbl
  8958               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8959               MA-CITY NOT GREATER THAN SPACES OR
  8960               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8961               MA-ZIP-CODE NOT GREATER THAN SPACES
  8962               MOVE ER-3835             TO EMI-ERROR
  8963               MOVE -1                  TO BMAINTL
  8964               MOVE AL-UANON            TO BMAINTA
  8965               PERFORM 9900-ERROR-FORMAT
  8966                                 THRU 9900-EXIT
  8967               GO TO 8200-SEND-DATAONLY
  8968            END-IF
  8969        ELSE
  8970           MOVE ER-3000             TO EMI-ERROR
  8971           MOVE -1                  TO BMAINTL
  8972           MOVE AL-UANON            TO BMAINTA
  8973           PERFORM 9900-ERROR-FORMAT
  8974                                THRU 9900-EXIT
  8975           GO TO 8200-SEND-DATAONLY
  8976        END-IF
  8977
  8978     END-IF
  8979     IF (EIBAID = DFHPF15 OR DFHPF17)
  8980        AND (CSR-EDIT-SESSION)
  8981        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8982        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8983        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8984        MOVE PI-SV-STATE         TO PI-STATE
  8985        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8986        MOVE CCERTNOI            TO PI-CERT-PRIME
  8987        MOVE CSUFIXI             TO PI-CERT-SFX
  8988        MOVE CEFFDTI             TO DEEDIT-FIELD
  8989        PERFORM 8600-DEEDIT
  8990        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8991        MOVE '4'                 TO DC-OPTION-CODE
  8992        PERFORM 9700-DATE-LINK
  8993        IF DATE-CONVERSION-ERROR
  8994           MOVE ER-0348          TO EMI-ERROR
  8995           MOVE -1               TO CEFFDTL
  8996           MOVE AL-UABON         TO CEFFDTA
  8997           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8998           GO TO 8200-SEND-DATAONLY
  8999        ELSE
  9000           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9001           PERFORM 6000-CREATE-TEMP-STORAGE
  9002                                 THRU 6000-EXIT
  9003           IF EIBAID = DFHPF17
  9004               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9005                                  THRU 6400-EXIT
  9006               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9007                                 '2' AND '3' AND '4'
  9008                  MOVE ER-3831     TO  EMI-ERROR
  9009                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9010                  GO TO 8200-SEND-DATAONLY
  9011               END-IF
  9012               MOVE 'Y'          TO PI-CLM-RESC-IND
  9013           ELSE
  9014               MOVE 'N'          TO PI-CLM-RESC-IND
  9015           END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 166
* EL6311.cbl
  9016           MOVE XCTL-EL6316      TO PGM-NAME
  9017           MOVE '2'              TO PI-ISS-CAN-SW
  9018           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9019           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9020           GO TO 9300-XCTL
  9021        END-IF
  9022     END-IF
  9023
  9024     IF EIBAID = DFHPF4
  9025        MOVE '0'                TO PI-EDIT-SW
  9026        IF PI-DISPLAY-ORIGINAL-BATCH
  9027           NEXT SENTENCE
  9028        ELSE
  9029           GO TO 7200-DISPLAY-BATCHES.
  9030
  9031     IF EIBAID = DFHPF5
  9032        MOVE ER-0029                TO EMI-ERROR
  9033        MOVE -1                     TO BPFENTRL
  9034        MOVE AL-UNBON               TO BPFENTRA
  9035        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9036        GO TO 8200-SEND-DATAONLY.
  9037*        MOVE '0'                TO PI-EDIT-SW
  9038*        IF PI-DISPLAY-ORIGINAL-BATCH
  9039*           NEXT SENTENCE
  9040*        ELSE
  9041*           MOVE EL631B              TO PI-MAP-NAME
  9042*           MOVE LOW-VALUES          TO EL631BI
  9043*           MOVE 'A'                 TO BMAINTO
  9044*           MOVE AL-UANON            TO BMAINTA
  9045*           MOVE -1                  TO BMAINTL
  9046*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9047*           GO TO 8100-SEND-INITIAL-MAP.
  9048
  9049     IF EIBAID = DFHPF6
  9050        MOVE ER-0029                TO EMI-ERROR
  9051        MOVE -1                     TO BPFENTRL
  9052        MOVE AL-UNBON               TO BPFENTRA
  9053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054        GO TO 8200-SEND-DATAONLY.
  9055*        MOVE '0'                TO PI-EDIT-SW
  9056*        IF PI-DISPLAY-ORIGINAL-BATCH
  9057*           NEXT SENTENCE
  9058*        ELSE
  9059*           MOVE EL631C              TO PI-MAP-NAME
  9060*           MOVE LOW-VALUES          TO EL631CI
  9061*           MOVE 'A'                 TO CMAINTO
  9062*           MOVE AL-UANON            TO CMAINTA
  9063*           MOVE -1                  TO CMAINTL
  9064*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9065*           GO TO 8100-SEND-INITIAL-MAP.
  9066
  9067     IF EIBAID = DFHPF7
  9068        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9069        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9070        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9071        MOVE PI-SV-STATE            TO PI-STATE
  9072        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9073        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 167
* EL6311.cbl
  9074        MOVE CSUFIXI                TO PI-CERT-SFX
  9075        MOVE CEFFDTI                TO DEEDIT-FIELD
  9076        PERFORM 8600-DEEDIT
  9077        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9078        MOVE '4'                    TO DC-OPTION-CODE
  9079        PERFORM 9700-DATE-LINK
  9080        IF DATE-CONVERSION-ERROR
  9081           MOVE ER-0348            TO EMI-ERROR
  9082           MOVE -1                  TO BEFFDTL
  9083           MOVE AL-UABON            TO BEFFDTA
  9084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9085           GO TO 8200-SEND-DATAONLY
  9086        ELSE
  9087           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9088           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9089           MOVE XCTL-EL1273        TO PGM-NAME
  9090           GO TO 9300-XCTL.
  9091
  9092     IF EIBAID = DFHPF8
  9093        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9094        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9095        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9096        MOVE PI-SV-STATE            TO PI-STATE
  9097        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9098        MOVE CCERTNOI               TO PI-CERT-PRIME
  9099        MOVE CSUFIXI                TO PI-CERT-SFX
  9100        MOVE CEFFDTI                TO DEEDIT-FIELD
  9101        PERFORM 8600-DEEDIT
  9102        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9103        MOVE '4'                    TO DC-OPTION-CODE
  9104        PERFORM 9700-DATE-LINK
  9105        IF DATE-CONVERSION-ERROR
  9106           MOVE ER-0348             TO EMI-ERROR
  9107           MOVE -1                  TO BEFFDTL
  9108           MOVE AL-UABON            TO BEFFDTA
  9109           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110           GO TO 8200-SEND-DATAONLY
  9111        ELSE
  9112           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9113           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9114           IF PI-COMPANY-ID = 'DMD'
  9115               MOVE XCTL-EL401DMD      TO PGM-NAME
  9116             ELSE
  9117               MOVE XCTL-EL1279        TO PGM-NAME
  9118           END-IF
  9119           GO TO 9300-XCTL.
  9120
  9121     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9122        MOVE XCTL-EL6312     TO PGM-NAME
  9123
  9124* EXEC CICS XCTL
  9125*           PROGRAM  (PGM-NAME)
  9126*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9127*           LENGTH   (WS-COMM-LENGTH)
  9128*       END-EXEC
  9129*    MOVE '.$C                   %   #00009069' TO DFHEIV0
  9130     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9131     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 168
* EL6311.cbl
  9132     MOVE X'2020233030303039303639' TO DFHEIV0(25:11)
  9133     CALL 'kxdfhei1' USING DFHEIV0,
  9134           PGM-NAME,
  9135           PROGRAM-INTERFACE-BLOCK,
  9136           WS-COMM-LENGTH,
  9137           DFHEIV99
  9138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9139     ELSE
  9140        MOVE '0'                 TO  PI-EDIT-SW.
  9141
  9142     IF EIBAID = DFHPF10
  9143         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9144         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9145         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9146         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9147                                    PI-1042-WA
  9148         MOVE 4                  TO PI-689-DATA-SOURCE
  9149         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9150         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9151         MOVE PI-SV-STATE        TO PI-689-STATE
  9152         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9153         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9154         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9155         MOVE PI-PB-ALT-CHG-SEQ-NO
  9156                                 TO PI-689-ALT-SEQ-NO
  9157         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9158         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9159         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9160         MOVE +0                 TO PI-689-CONTROL
  9161         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9162                                    PI-689-EXP-DATE
  9163                                    PI-689-RESP-PERSON
  9164                                    PI-689-TYPE
  9165                                    PI-689-FOLLOW-UP-EDIT
  9166                                    PI-689-RESEND1-EDIT
  9167                                    PI-689-SEQ-EDIT
  9168                                    PI-689-BCSEQ-EDIT
  9169                                    PI-689-LBL-OVERRIDE
  9170         MOVE W-LETTER-COMMUNICATION-AREAS
  9171                                 TO PI-PROGRAM-WORK-AREA
  9172         MOVE XCTL-EL689         TO PGM-NAME
  9173         GO TO 9300-XCTL.
  9174
  9175     IF  EIBAID = DFHPF16
  9176         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9177         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9178         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9179                                    PI-1042-WA
  9180         MOVE 4                  TO PI-689-DATA-SOURCE
  9181         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9182         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9183         MOVE PI-SV-STATE        TO PI-689-STATE
  9184         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9185         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9186         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9187         MOVE PI-PB-ALT-CHG-SEQ-NO
  9188                                 TO PI-689-ALT-SEQ-NO
  9189         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 169
* EL6311.cbl
  9190         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9191         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9192         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9193         MOVE W-LETTER-COMMUNICATION-AREAS
  9194                                 TO PI-PROGRAM-WORK-AREA
  9195         MOVE XCTL-EL690         TO PGM-NAME
  9196         GO TO 9300-XCTL.
  9197     IF (EIBAID = DFHPF13)
  9198        if (not fatal-errors)
  9199           and (not unforced-errors)
  9200           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9201           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9202           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9203           MOVE PI-SV-STATE      TO PI-STATE
  9204           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9205           MOVE CCERTNOI         TO PI-CERT-PRIME
  9206           MOVE CSUFIXI          TO PI-CERT-SFX
  9207           MOVE CEFFDTI          TO DEEDIT-FIELD
  9208           PERFORM 8600-DEEDIT
  9209           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9210           MOVE '4'              TO DC-OPTION-CODE
  9211           PERFORM 9700-DATE-LINK
  9212           IF DATE-CONVERSION-ERROR
  9213              MOVE ER-0348       TO EMI-ERROR
  9214              MOVE -1            TO CEFFDTL
  9215              MOVE AL-UABON      TO CEFFDTA
  9216              PERFORM 9900-ERROR-FORMAT
  9217                                 THRU 9900-EXIT
  9218              GO TO 8200-SEND-DATAONLY
  9219           ELSE
  9220              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9221              MOVE AL-UANON      TO CEFFDTA
  9222              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9223              PERFORM 6000-CREATE-TEMP-STORAGE
  9224                                 THRU 6000-EXIT
  9225              MOVE XCTL-EL677    TO PGM-NAME
  9226              GO TO 9300-XCTL
  9227           end-if
  9228        else
  9229           MOVE ER-3444          TO EMI-ERROR
  9230           MOVE -1               TO CPFENTRL
  9231           MOVE AL-UNBON         TO CPFENTRA
  9232           PERFORM 9900-ERROR-FORMAT
  9233                                 THRU 9900-EXIT
  9234           GO TO 8200-SEND-DATAONLY
  9235        end-if
  9236     end-if
  9237
  9238     IF EIBAID = DFHPF14
  9239        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9240        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9241        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9242        MOVE PI-SV-STATE            TO PI-CR-STATE
  9243        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9244        MOVE SPACE                  TO PI-EDIT-SW
  9245        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9246        MOVE XCTL-EL650             TO PGM-NAME
  9247        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 170
* EL6311.cbl
  9248
  9249     IF EIBAID = DFHENTER OR DFHPF11
  9250        GO TO 2000-CANCEL-MAINLINE.
  9251
  9252     MOVE ER-0029                TO EMI-ERROR.
  9253     MOVE -1                     TO CPFENTRL.
  9254     MOVE AL-UNBON               TO CPFENTRA.
  9255     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9256     GO TO 8200-SEND-DATAONLY.
  9257
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 171
* EL6311.cbl
  9259
  9260******************************************************************
  9261*                                                                *
  9262*      BATCH SCREEN PF KEY CHECKING                              *
  9263*                                                                *
  9264******************************************************************
  9265
  9266******************************************************************
  9267*                                                                *
  9268*      PF KEY FUNCTIONS:                                         *
  9269*                                                                *
  9270*      PF1 = BROWSE FORWARD                                      *
  9271*      PF2 = BROWSE BACKWARD                                     *
  9272*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9273*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9274*                                                                *
  9275*                                                                *
  9276******************************************************************
  9277
  9278 0500-CHECK-BATCH-PF-KEYS.
  9279     IF EIBAID = DFHPF1
  9280        MOVE '0'                TO PI-EDIT-SW
  9281        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9282           GO TO 5000-BROWSE-BATCH-HEADERS
  9283        ELSE
  9284           IF PI-GOOD-BROWSE
  9285              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9286                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9287              ELSE
  9288                 IF PI-FILE-BROWSE
  9289                    GO TO 4300-BROWSE-FILE-FORWARD
  9290                 ELSE
  9291                    IF PI-CSR-BROWSE
  9292                       GO TO 4200-BROWSE-CSR-FORWARD
  9293                    ELSE
  9294                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9295           ELSE
  9296              GO TO 0800-BROWSE-ERROR.
  9297
  9298     IF EIBAID = DFHPF2
  9299        MOVE '0'                TO PI-EDIT-SW
  9300        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9301           GO TO 5500-BROWSE-BATCH-BACKWARD
  9302        ELSE
  9303           IF PI-GOOD-BROWSE
  9304              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9305                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9306              ELSE
  9307                 IF PI-FILE-BROWSE
  9308                    GO TO 4800-BROWSE-FILE-BACKWARD
  9309                 ELSE
  9310                    IF PI-CSR-BROWSE
  9311                       GO TO 4900-BROWSE-CSR-BACKWARD
  9312                    ELSE
  9313                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9314           ELSE
  9315              GO TO 0800-BROWSE-ERROR.
  9316
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 172
* EL6311.cbl
  9317     IF EIBAID = DFHPF3
  9318        GO TO 3000-BATCH-MAINLINE.
  9319
  9320     IF  EIBAID = DFHPF4
  9321        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9322        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9323        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9324        MOVE PI-SV-STATE            TO PI-CR-STATE
  9325        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9326                                       PI-CR-FIN-RESP
  9327        MOVE 'A'                    TO PI-CR-TYPE
  9328        MOVE SPACE                  TO PI-EDIT-SW
  9329        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9330        MOVE XCTL-EL640             TO PGM-NAME
  9331        GO TO 9300-XCTL.
  9332
  9333     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9334       AND
  9335        (EIBAID = DFHENTER)
  9336           GO TO 3500-EDIT-BATCH-DATA.
  9337
  9338     IF EIBAID = DFHENTER
  9339        GO TO 3500-EDIT-BATCH-DATA.
  9340
  9341     MOVE ER-0029             TO EMI-ERROR.
  9342     MOVE -1                  TO DPFENTRL.
  9343     MOVE AL-UNBON            TO DPFENTRA.
  9344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9345     GO TO 8200-SEND-DATAONLY.
  9346
  9347 0800-BROWSE-ERROR.
  9348     MOVE ER-2258                TO EMI-ERROR.
  9349     MOVE -1                     TO DPFENTRL.
  9350     MOVE AL-UNBON               TO DPFENTRA.
  9351     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9352     GO TO 8200-SEND-DATAONLY.
  9353
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 173
* EL6311.cbl
  9355
  9356******************************************************************
  9357*                                                                *
  9358*                I S S U E   M A I N L I N E                     *
  9359*                                                                *
  9360******************************************************************
  9361
  9362 1000-ISSUE-MAINLINE.
  9363     IF PI-DISPLAY-ORIGINAL-BATCH
  9364        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9365           MOVE ER-0023             TO EMI-ERROR
  9366           MOVE -1                  TO BMAINTL
  9367           MOVE AL-UABON            TO BMAINTA
  9368           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9369           GO TO 8200-SEND-DATAONLY
  9370        ELSE
  9371           NEXT SENTENCE
  9372     ELSE
  9373        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9374           MOVE ER-0023             TO EMI-ERROR
  9375           MOVE -1                  TO BMAINTL
  9376           MOVE AL-UABON            TO BMAINTA
  9377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9378           GO TO 8200-SEND-DATAONLY.
  9379
  9380     IF BMAINTI = 'S'
  9381        GO TO 1100-SHOW-REQUEST.
  9382
  9383     IF NOT MODIFY-CAP
  9384         MOVE 'UPDATE'       TO SM-READ
  9385         PERFORM 9995-SECURITY-VIOLATION
  9386         MOVE ER-0070        TO EMI-ERROR
  9387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9388         GO TO 8100-SEND-INITIAL-MAP.
  9389
  9390     IF BMAINTL GREATER THAN ZEROS
  9391        IF PI-PF5-FUNCTION
  9392           IF BMAINTI NOT = 'A'
  9393              MOVE AL-UABON  TO BMAINTA
  9394              MOVE -1        TO BMAINTL
  9395              MOVE ER-2260   TO EMI-ERROR
  9396              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397              GO TO 8200-SEND-DATAONLY.
  9398
  9399     IF BCERTNOL = ZEROS
  9400       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9401         NEXT SENTENCE
  9402     ELSE
  9403         IF BCERTNOL NOT = ZEROS
  9404             MOVE AL-UANON       TO BCERTNOA
  9405         ELSE
  9406             MOVE -1             TO BCERTNOL
  9407             MOVE  1             TO SET-CURSOR-SW
  9408             MOVE ER-2218        TO EMI-ERROR
  9409             MOVE AL-UABON       TO BCERTNOA
  9410             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9411
  9412     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 174
* EL6311.cbl
  9413         MOVE AL-UANON       TO BSUFIXA
  9414     ELSE
  9415         MOVE AL-SANOF       TO BSUFIXA.
  9416
  9417     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9418        NEXT SENTENCE
  9419     ELSE
  9420        IF BEFFDTL NOT = ZEROS
  9421           MOVE AL-UNNON             TO BEFFDTA
  9422           MOVE BEFFDTI              TO DEEDIT-FIELD
  9423           PERFORM 8600-DEEDIT
  9424           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9425           MOVE 4                    TO DC-OPTION-CODE
  9426           PERFORM 9700-DATE-LINK
  9427           IF NO-CONVERSION-ERROR
  9428              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9429              ELSE
  9430              MOVE -1                TO BEFFDTL
  9431              MOVE  1                TO SET-CURSOR-SW
  9432              MOVE ER-2226           TO EMI-ERROR
  9433              MOVE AL-UNBON          TO BEFFDTA
  9434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435           ELSE
  9436              MOVE -1                TO BEFFDTL
  9437              MOVE  1                TO SET-CURSOR-SW
  9438              MOVE ER-2220           TO EMI-ERROR
  9439              MOVE AL-UNBON          TO BEFFDTA
  9440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441
  9442     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9443
  9444     IF BCERTNOL NOT = ZEROS
  9445        MOVE BCERTNOI                TO WS-NEW-PRIME
  9446     ELSE
  9447        MOVE SPACES                  TO WS-NEW-PRIME.
  9448
  9449     IF BSUFIXL NOT = ZEROS
  9450        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9451     ELSE
  9452        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9453
  9454     IF BEFFDTL NOT = ZEROS
  9455        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9456     ELSE
  9457        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9458
  9459     IF BMAINTI = 'A' OR 'K' OR 'S'
  9460        NEXT SENTENCE
  9461     ELSE
  9462        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9463        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9464           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9465           WS-PB-RECORD-TYPE NOT = '1'
  9466           IF BMAINTI = 'C'
  9467               MOVE ER-2287          TO EMI-ERROR
  9468               MOVE -1               TO BCERTNOL
  9469               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9470               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 175
* EL6311.cbl
  9471               GO TO 8200-SEND-DATAONLY
  9472             ELSE
  9473               MOVE ER-2260          TO EMI-ERROR
  9474               MOVE -1               TO BCERTNOL
  9475               MOVE AL-UABON         TO BCERTNOA
  9476               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9477               GO TO 8200-SEND-DATAONLY.
  9478
  9479     IF BMAINTI = 'D'
  9480         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9481
  9482*    IF BMICRNOL  NOT =  ZEROS
  9483*        IF BMICRNOI  NUMERIC
  9484*            MOVE AL-UNNON       TO  BMICRNOA
  9485*        ELSE
  9486*            MOVE -1             TO  BMICRNOL
  9487*            MOVE 1              TO  SET-CURSOR-SW
  9488*            MOVE AL-UNBON       TO  BMICRNOA
  9489*            MOVE ER-2701        TO  EMI-ERROR
  9490*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9491     IF BVINL NOT = ZEROS
  9492        MOVE AL-UANON            TO BVINA
  9493     END-IF
  9494     IF B1STNML NOT = ZEROS
  9495         MOVE AL-UANON                TO B1STNMA.
  9496
  9497     IF BINITL  NOT = ZEROS
  9498        MOVE AL-UANON                TO BINITA.
  9499
  9500     IF BSEXL NOT = ZEROS
  9501        IF BSEXI = 'M' OR 'F'
  9502           MOVE AL-UANON             TO BSEXA
  9503        ELSE
  9504           MOVE -1               TO BSEXL
  9505           MOVE ER-2629          TO EMI-ERROR
  9506           MOVE AL-UABON         TO BSEXA
  9507           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508
  9509     IF BAGEL NOT = ZEROS
  9510         IF BAGEI NUMERIC
  9511             MOVE BAGEI              TO WS-BAGE
  9512             MOVE AL-UNNON           TO BAGEA
  9513         ELSE
  9514             MOVE -1                 TO BAGEL
  9515             MOVE  1                 TO SET-CURSOR-SW
  9516             MOVE ER-2223            TO EMI-ERROR
  9517             MOVE AL-UNBON           TO BAGEA
  9518             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9519
  9520     IF BLSTNML NOT = ZERO  OR
  9521        B1STNML NOT = ZERO  OR
  9522        BINITL NOT = ZERO
  9523         IF BAGEL = ZEROS
  9524             MOVE -1                 TO BAGEL
  9525             MOVE  1                 TO SET-CURSOR-SW
  9526             MOVE ER-3269            TO EMI-ERROR
  9527             MOVE AL-UNBON           TO BAGEA
  9528             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 176
* EL6311.cbl
  9529         END-IF
  9530     END-IF.
  9531
  9532     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9533
  9534     IF (BBIRTHL GREATER THAN +0) AND
  9535        (BBIRTHI NOT EQUAL SPACES)
  9536        NEXT SENTENCE
  9537     ELSE
  9538        GO TO 1010-CHECK-AGE.
  9539
  9540     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9541     PERFORM 8600-DEEDIT.
  9542     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9543     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9544     MOVE AL-UNNON               TO BBIRTHA.
  9545     MOVE '4'                    TO DC-OPTION-CODE.
  9546     PERFORM 9700-DATE-LINK.
  9547     IF DATE-CONVERSION-ERROR
  9548        MOVE -1                  TO BBIRTHL
  9549        MOVE  1                  TO SET-CURSOR-SW
  9550        MOVE ER-2228             TO EMI-ERROR
  9551        MOVE AL-UNBON            TO BBIRTHA
  9552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9553        GO TO 1010-CHECK-AGE.
  9554
  9555     IF (NO-CONVERSION-ERROR) AND
  9556        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9557        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9558        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9559        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9560                                    WS-CONVERTED-BIRTH
  9561        MOVE AL-UANON            TO BBIRTHA
  9562     ELSE
  9563        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9564        MOVE AL-UANON            TO BBIRTHA.
  9565
  9566 1010-CHECK-AGE.
  9567
  9568*    IF BAGEL = ZERO
  9569*       IF BBIRTHL GREATER THAN ZERO
  9570*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9571
  9572     IF B1STPMTL NOT = ZEROS
  9573        IF B1STPMTI = SPACES
  9574           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9575        ELSE
  9576           MOVE B1STPMTI             TO DEEDIT-FIELD
  9577           PERFORM 8600-DEEDIT
  9578           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9579           MOVE AL-UNNON             TO B1STPMTA
  9580           MOVE 4                    TO DC-OPTION-CODE
  9581           PERFORM 9700-DATE-LINK
  9582           IF NO-CONVERSION-ERROR
  9583              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9584              MOVE AL-UANON          TO B1STPMTA
  9585           ELSE
  9586              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 177
* EL6311.cbl
  9587              MOVE  1                TO SET-CURSOR-SW
  9588              MOVE ER-2200           TO EMI-ERROR
  9589              MOVE AL-UNBON          TO B1STPMTA
  9590              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9591
  9592     IF BDAYSL NOT = ZEROS
  9593         IF BDAYSI NUMERIC
  9594             MOVE AL-UNNON           TO BDAYSA
  9595         ELSE
  9596             MOVE -1                 TO BDAYSL
  9597             MOVE ER-2530            TO EMI-ERROR
  9598             MOVE AL-UNBON           TO BDAYSA
  9599             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9600
  9601     IF BLNTRML NOT = ZEROS
  9602         IF BLNTRMI NUMERIC
  9603             MOVE AL-UNNON       TO BLNTRMA
  9604         ELSE
  9605             MOVE -1             TO BLNTRML
  9606             MOVE ER-2533        TO EMI-ERROR
  9607             MOVE AL-UNBON       TO BLNTRMA
  9608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9609
  9610**   IF PI-COMPANY-ID = 'DMD'
  9611     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9612        NEXT SENTENCE
  9613     ELSE
  9614         IF BLNOFCRL NOT = ZEROS
  9615            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9616            IF LOAN-OFFICER-FOUND
  9617                MOVE AL-UANON        TO BLNOFCRA
  9618             ELSE
  9619                 MOVE SPACE          TO WS-LOAN-OFFICER
  9620                 MOVE -1             TO BLNOFCRL
  9621                 MOVE  1             TO SET-CURSOR-SW
  9622                 MOVE ER-3006        TO EMI-ERROR
  9623                 MOVE AL-UNBON       TO BLNOFCRA
  9624                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9625
  9626     IF BFREQL NOT = ZEROS
  9627         IF BFREQI NUMERIC
  9628             MOVE AL-UNNON       TO BFREQA
  9629         ELSE
  9630             MOVE -1             TO BFREQL
  9631             MOVE  1             TO SET-CURSOR-SW
  9632             MOVE ER-2223        TO EMI-ERROR
  9633             MOVE AL-UNBON       TO BFREQA
  9634             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9635
  9636     IF BMODEL NOT = ZEROS
  9637         MOVE BMODEI             TO WS-MODE-CODE
  9638                                    PI-BMODE
  9639         IF WS-MODE-CODE-VALID
  9640             MOVE AL-UANON       TO BMODEA
  9641         ELSE
  9642             MOVE -1             TO BMODEL
  9643             MOVE ER-2591        TO EMI-ERROR
  9644             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 178
* EL6311.cbl
  9645             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9646
  9647     IF BPMTSL NOT = ZEROS
  9648         IF BPMTSI NUMERIC
  9649             MOVE AL-UNNON           TO BPMTSA
  9650             MOVE BPMTSI             TO PI-BPMTS
  9651         ELSE
  9652             MOVE -1                 TO BPMTSL
  9653             MOVE ER-2592            TO EMI-ERROR
  9654             MOVE AL-UNBON           TO BPMTSA
  9655             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9656
  9657     IF BPMTAMTL NOT = ZEROS
  9658
  9659* EXEC CICS BIF DEEDIT
  9660*            FIELD  (BPMTAMTI)
  9661*            LENGTH (9)
  9662*       END-EXEC
  9663     MOVE 9
  9664       TO DFHEIV11
  9665*    MOVE '@"L                   #   #00009593' TO DFHEIV0
  9666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9668     MOVE X'2020233030303039353933' TO DFHEIV0(25:11)
  9669     CALL 'kxdfhei1' USING DFHEIV0,
  9670           BPMTAMTI,
  9671           DFHEIV11
  9672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9673        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9674*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9675*        PERFORM 8600-DEEDIT
  9676*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9677
  9678*    IF BAPRL NOT = ZEROS
  9679*        EXEC CICS BIF DEEDIT
  9680*            FIELD  (BAPRI)
  9681*            LENGTH (7)
  9682*        END-EXEC
  9683*        MOVE BAPRI              TO WS-BAPR.
  9684
  9685     IF BAPRL > 0
  9686        MOVE +0                  TO  WS-BAPR
  9687        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9688           (WS-SUB > 7)
  9689           OR (BAPRI (WS-SUB:1) NUMERIC)
  9690           OR (BAPRI (WS-SUB:1) = '.')
  9691        END-PERFORM
  9692        IF WS-SUB > 7
  9693           MOVE ER-2471       TO EMI-ERROR
  9694           MOVE -1            TO BAPRL
  9695           MOVE AL-UNBON      TO BAPRA
  9696           PERFORM 9900-ERROR-FORMAT
  9697                                 THRU 9900-EXIT
  9698        ELSE
  9699           IF BAPRI (WS-SUB:1) NUMERIC
  9700              MOVE WS-SUB           TO WS-BEG
  9701              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9702                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 179
* EL6311.cbl
  9703                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9704              END-PERFORM
  9705              COMPUTE WS-END = WS-SUB - WS-BEG
  9706              MOVE BAPRI (WS-BEG:WS-END)
  9707                                 TO WS-APR-WHOLE-NUM
  9708           END-IF
  9709           IF BAPRI (WS-SUB:1) = '.'
  9710              COMPUTE WS-BEG = WS-SUB + 1
  9711              IF (WS-BEG < 8)
  9712                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9713                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9714                    (WS-SUB > 7)
  9715                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9716                 END-PERFORM
  9717                 COMPUTE WS-END = WS-SUB - WS-BEG
  9718                 MOVE BAPRI (WS-BEG:WS-END)
  9719                                 TO WS-APR-DEC (1:WS-END)
  9720              END-IF
  9721           END-IF
  9722           MOVE AL-UNNON      TO BAPRA
  9723           MOVE WS-BAPR       TO BAPRO
  9724        END-IF
  9725     END-IF
  9726*     IF BAPRL NOT = ZEROS
  9727*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9728*        PERFORM 8600-DEEDIT
  9729*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9730
  9731     IF BLIVESL NOT = ZEROS
  9732        MOVE BLIVESI             TO DEEDIT-FIELD
  9733        PERFORM 8600-DEEDIT
  9734        IF DEEDIT-FIELD-V0 NUMERIC
  9735           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9736           MOVE AL-UNNON         TO BLIVESA
  9737        ELSE
  9738           MOVE -1               TO BLIVESL
  9739           MOVE AL-UNBON         TO BLIVESA
  9740           MOVE ER-2223          TO EMI-ERROR
  9741           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742
  9743*DMD CUSTOM CODING*************START
  9744*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9745     IF PI-COMPANY-ID NOT = 'DMD'
  9746         MOVE ZEROS               TO BBILLEDL
  9747         GO TO 1010-EDIT-CONT.
  9748
  9749     IF BBILLEDL NOT = ZEROS
  9750        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9751        MOVE 'Y'                 TO WS-NUMERIC-SW
  9752        MOVE +1                  TO WS-CSO-SUB
  9753        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9754        IF CSO-NUMERIC-FIELD
  9755
  9756* EXEC CICS BIF DEEDIT
  9757*              FIELD  (BBILLEDI)
  9758*              LENGTH (9)
  9759*          END-EXEC
  9760     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 180
* EL6311.cbl
  9761       TO DFHEIV11
  9762*    MOVE '@"L                   #   #00009679' TO DFHEIV0
  9763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9765     MOVE X'2020233030303039363739' TO DFHEIV0(25:11)
  9766     CALL 'kxdfhei1' USING DFHEIV0,
  9767           BBILLEDI,
  9768           DFHEIV11
  9769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9770           MOVE BBILLEDI         TO WS-BILLED
  9771           MOVE AL-UNNON         TO BBILLEDA
  9772        ELSE
  9773           MOVE -1               TO BBILLEDL
  9774           MOVE AL-UNBON         TO BBILLEDA
  9775           MOVE ER-2547          TO EMI-ERROR
  9776           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9777     ELSE
  9778        IF BMAINTI EQUAL 'A'
  9779           MOVE -1               TO BBILLEDL
  9780           MOVE AL-UNBON         TO BBILLEDA
  9781           MOVE ER-8148          TO EMI-ERROR
  9782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9783
  9784 1010-EDIT-CONT.
  9785
  9786     IF BFORCEL  NOT = ZEROS
  9787         IF FORCE-CAP
  9788            MOVE AL-UANON            TO BFORCEA
  9789         ELSE
  9790            MOVE ER-2945             TO EMI-ERROR
  9791            MOVE AL-UABON            TO BFORCEA
  9792            MOVE -1                  TO BFORCEL
  9793            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9794
  9795     IF BENTRYL NOT = ZEROS
  9796        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9797                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9798           MOVE ER-2224              TO EMI-ERROR
  9799           MOVE AL-UABON             TO BENTRYA
  9800           MOVE -1                   TO BENTRYL
  9801           MOVE  1                   TO SET-CURSOR-SW
  9802           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9803        ELSE
  9804           MOVE AL-UANON             TO BENTRYA.
  9805
  9806     IF BUNWRITL NOT = ZEROS
  9807        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9808           MOVE ER-7574              TO EMI-ERROR
  9809           MOVE AL-UABON             TO BUNWRITA
  9810           MOVE -1                   TO BUNWRITL
  9811           MOVE  1                   TO SET-CURSOR-SW
  9812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9813        ELSE
  9814           MOVE AL-UANON             TO BUNWRITA.
  9815
  9816     IF BREINL  NOT = ZEROS
  9817         MOVE AL-UANON               TO BREINA.
  9818
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 181
* EL6311.cbl
  9819     IF BBILCDL NOT = ZEROS
  9820        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9821                             AND 'A' AND 'B' AND 'E'
  9822           MOVE ER-2225              TO EMI-ERROR
  9823           MOVE AL-UABON             TO BBILCDA
  9824           MOVE -1                   TO BBILCDL
  9825           MOVE  1                   TO SET-CURSOR-SW
  9826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9827        ELSE
  9828           MOVE AL-UANON             TO BBILCDA.
  9829
  9830     IF BSKPCDL NOT = ZEROS
  9831         MOVE AL-UANON               TO BSKPCDA.
  9832
  9833     IF BINDGRPL NOT = ZEROS
  9834         MOVE AL-UANON               TO BINDGRPA.
  9835
  9836     IF BSIGL   NOT = ZEROS
  9837         MOVE AL-UANON               TO BSIGA.
  9838
  9839     IF BRTCLSL NOT = ZEROS
  9840         MOVE AL-UANON               TO BRTCLSA.
  9841
  9842     IF BMEMBERL NOT = ZEROS
  9843         MOVE AL-UANON               TO BMEMBERA.
  9844
  9845     MOVE +0                         TO WS-SUB1.
  9846
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 182
* EL6311.cbl
  9848
  9849******************************************************************
  9850*                                                                *
  9851*           E D I T   I S S U E   C O V E R A G E S              *
  9852*                                                                *
  9853******************************************************************
  9854
  9855 1020-EDIT-COVERAGES.
  9856     ADD +1                      TO WS-SUB1.
  9857
  9858     IF WS-SUB1 GREATER +2
  9859        GO TO 1025-EDIT-COMPLETE.
  9860
  9861     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9862       IF (BMODEL   GREATER ZERO  OR
  9863            BPMTSL   GREATER ZERO  OR
  9864            BPMTAMTL GREATER ZERO)
  9865          AND
  9866            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9867               GO TO 1021-CONT-EDIT.
  9868
  9869     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9870        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9871        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9872        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9873        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9874        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9875        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9876        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9877        NEXT SENTENCE
  9878         ELSE
  9879            GO TO 1020-EDIT-COVERAGES.
  9880
  9881 1021-CONT-EDIT.
  9882
  9883     IF BMAINTI = 'A'
  9884        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9885           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9886        ELSE
  9887           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9888           MOVE ER-7404          TO EMI-ERROR
  9889           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9890           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9891     ELSE
  9892        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9893           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9894
  9895     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9896        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9897        PERFORM 8600-DEEDIT
  9898        IF DEEDIT-FIELD-V0 NUMERIC
  9899           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9900        ELSE
  9901           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9902
  9903     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9904*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9905        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 183
* EL6311.cbl
  9906           BPMTSL  GREATER THAN ZEROS
  9907           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9908
  9909     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9910         IF BMODEL   GREATER THAN ZEROS  OR
  9911            BPMTSL   GREATER THAN ZEROS  OR
  9912            BPMTAMTL GREATER THAN ZEROS
  9913             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9914
  9915     IF BMAINTI = ('C' OR 'K')
  9916        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9917           NEXT SENTENCE
  9918        ELSE
  9919           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9920           PERFORM 8600-DEEDIT
  9921           IF DEEDIT-FIELD-V0 NUMERIC
  9922              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9923              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9924                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9925              ELSE
  9926                    MOVE ER-2241      TO EMI-ERROR
  9927                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9928                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9929                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9930           ELSE
  9931              MOVE ER-2223          TO EMI-ERROR
  9932              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9933              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9934              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9935     ELSE
  9936        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9937            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9938            PERFORM 8600-DEEDIT
  9939            IF DEEDIT-FIELD-V0      NUMERIC
  9940               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9941                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9942                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9943               ELSE
  9944                  MOVE ER-2241         TO EMI-ERROR
  9945                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9946                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9947                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9948            ELSE
  9949              MOVE ER-2223             TO EMI-ERROR
  9950              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9951              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9952              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9953        ELSE
  9954            MOVE ER-2240               TO EMI-ERROR
  9955            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9956            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9957*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9958*        IF BMODEL  GREATER THAN ZEROS  AND
  9959*           BPMTSL  GREATER THAN ZEROS
  9960*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9961
  9962     IF BBEN-LEN (WS-SUB1) = ZEROS
  9963        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 184
* EL6311.cbl
  9964           NEXT SENTENCE
  9965     ELSE
  9966        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9967           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9968
  9969* EXEC CICS BIF DEEDIT
  9970*              FIELD  (BBENI (WS-SUB1))
  9971*              LENGTH (12)
  9972*          END-EXEC
  9973     MOVE 12
  9974       TO DFHEIV11
  9975*    MOVE '@"L                   #   #00009881' TO DFHEIV0
  9976     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9977     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9978     MOVE X'2020233030303039383831' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0,
  9980           BBENI(WS-SUB1),
  9981           DFHEIV11
  9982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9983           IF BBENI (WS-SUB1)  NUMERIC
  9984              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9985                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9986*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9987*          PERFORM 8600-DEEDIT
  9988*          IF DEEDIT-FIELD-V2  NUMERIC
  9989*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9990*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9991              ELSE
  9992                 MOVE ER-7632    TO EMI-ERROR
  9993                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9994                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9995                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9996           ELSE
  9997              MOVE ER-2223         TO EMI-ERROR
  9998              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9999              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10000              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10001        ELSE
 10002           MOVE ER-7632    TO EMI-ERROR
 10003           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10004           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10005           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10006
 10007     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10008        AND (BMAINTI = ('C' OR 'K'))
 10009        CONTINUE
 10010     ELSE
 10011        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10012           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10013           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10014              FOR ALL '.'
 10015           IF WS-TALLY > 1
 10016              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10017                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10018              END-PERFORM
 10019              IF A1 < 9
 10020                 ADD 3 TO A1
 10021                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 185
* EL6311.cbl
 10022              END-IF
 10023           ELSE
 10024              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10025                (A1 > 11)
 10026                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10027                  LOW-VALUES OR SPACES)
 10028              END-PERFORM
 10029              IF A1 > 1 AND < 12
 10030                 MOVE SPACES
 10031                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10032              END-IF
 10033           END-IF
 10034
 10035* EXEC CICS BIF DEEDIT
 10036*              FIELD  (BPREMI (WS-SUB1))
 10037*              LENGTH (11)
 10038*          END-EXEC
 10039     MOVE 11
 10040       TO DFHEIV11
 10041*    MOVE '@"L                   #   #00009936' TO DFHEIV0
 10042     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10043     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10044     MOVE X'2020233030303039393336' TO DFHEIV0(25:11)
 10045     CALL 'kxdfhei1' USING DFHEIV0,
 10046           BPREMI(WS-SUB1),
 10047           DFHEIV11
 10048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10049           IF BPREMI (WS-SUB1) NUMERIC
 10050              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10051                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10052*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10053*          PERFORM 8600-DEEDIT
 10054*          IF DEEDIT-FIELD-V2  NUMERIC
 10055*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10056*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10057              ELSE
 10058                 IF PI-COMPANY-ID NOT = 'DCC'
 10059                    MOVE ER-7633    TO EMI-ERROR
 10060                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10061                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10062                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10063                 END-IF
 10064              END-IF
 10065           ELSE
 10066              MOVE ER-2223         TO EMI-ERROR
 10067              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10068              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10069              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10070           END-IF
 10071        ELSE
 10072           IF PI-COMPANY-ID NOT = 'DCC'
 10073              MOVE ER-7633         TO EMI-ERROR
 10074              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10075              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10076              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10077           END-IF
 10078        END-IF
 10079     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 186
* EL6311.cbl
 10080
 10081     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10082        NEXT SENTENCE
 10083     ELSE
 10084        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10085
 10086* EXEC CICS BIF DEEDIT
 10087*           FIELD  (BCPREMI (WS-SUB1))
 10088*           LENGTH (11)
 10089*       END-EXEC
 10090     MOVE 11
 10091       TO DFHEIV11
 10092*    MOVE '@"L                   #   #00009976' TO DFHEIV0
 10093     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10094     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10095     MOVE X'2020233030303039393736' TO DFHEIV0(25:11)
 10096     CALL 'kxdfhei1' USING DFHEIV0,
 10097           BCPREMI(WS-SUB1),
 10098           DFHEIV11
 10099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10100        IF BCPREMI (WS-SUB1) NUMERIC
 10101           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10102*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10103*       PERFORM 8600-DEEDIT
 10104*       IF DEEDIT-FIELD-V2  NUMERIC
 10105*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10106        ELSE
 10107           MOVE ER-2223         TO EMI-ERROR
 10108           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10109           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10110           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10111
 10112     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10113        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10114        PERFORM 8600-DEEDIT
 10115        IF DEEDIT-FIELD-V0 NUMERIC
 10116           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10117           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10118         ELSE
 10119           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10120           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10121           MOVE ER-2223              TO EMI-ERROR
 10122           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10123
 10124     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10125        IF BEXPIRE   (WS-SUB1) = SPACES
 10126           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10127        ELSE
 10128           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10129           PERFORM 8600-DEEDIT
 10130           IF DEEDIT-FIELD-V0        NUMERIC
 10131              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10132              MOVE 4                TO DC-OPTION-CODE
 10133              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10134              PERFORM 9700-DATE-LINK
 10135              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10136                                                        (WS-SUB1)
 10137              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 187
* EL6311.cbl
 10138                 NEXT SENTENCE
 10139              ELSE
 10140                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10141                 MOVE ER-2531    TO EMI-ERROR
 10142                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10143                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10144           ELSE
 10145             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10146             MOVE ER-2532        TO EMI-ERROR
 10147             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10149
 10150     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10151        NEXT SENTENCE
 10152     ELSE
 10153
 10154* EXEC CICS BIF DEEDIT
 10155*           FIELD  (BALT-BENI (WS-SUB1))
 10156*           LENGTH (12)
 10157*       END-EXEC
 10158     MOVE 12
 10159       TO DFHEIV11
 10160*    MOVE '@"L                   #   #00010033' TO DFHEIV0
 10161     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10162     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10163     MOVE X'2020233030303130303333' TO DFHEIV0(25:11)
 10164     CALL 'kxdfhei1' USING DFHEIV0,
 10165           BALT-BENI(WS-SUB1),
 10166           DFHEIV11
 10167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10168        IF BALT-BENI (WS-SUB1) NUMERIC
 10169           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10170*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10171*       PERFORM 8600-DEEDIT
 10172*       IF DEEDIT-FIELD-V0 NUMERIC
 10173*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10174        ELSE
 10175           MOVE ER-2223         TO EMI-ERROR
 10176           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10177           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10179
 10180     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10181        NEXT SENTENCE
 10182     ELSE
 10183
 10184* EXEC CICS BIF DEEDIT
 10185*           FIELD  (BALT-PREMI (WS-SUB1))
 10186*           LENGTH (11)
 10187*       END-EXEC
 10188     MOVE 11
 10189       TO DFHEIV11
 10190*    MOVE '@"L                   #   #00010052' TO DFHEIV0
 10191     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10192     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10193     MOVE X'2020233030303130303532' TO DFHEIV0(25:11)
 10194     CALL 'kxdfhei1' USING DFHEIV0,
 10195           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 188
* EL6311.cbl
 10196           DFHEIV11
 10197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10198        IF BALT-PREMI (WS-SUB1) NUMERIC
 10199           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10200*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10201*       PERFORM 8600-DEEDIT
 10202*       IF DEEDIT-FIELD-V0 NUMERIC
 10203*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10204        ELSE
 10205           MOVE ER-2223         TO EMI-ERROR
 10206           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10207           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10209
 10210      GO TO 1020-EDIT-COVERAGES.
 10211
 10212 1025-EDIT-COMPLETE.
 10213     IF PI-COMPANY-ID  =  'DMD'
 10214        MOVE LOW-VALUES             TO BNCERTI
 10215                                       BNSTATI.
 10216
 10217     IF EMI-ERROR = ZEROS
 10218         NEXT SENTENCE
 10219     ELSE
 10220         GO TO 8200-SEND-DATAONLY.
 10221
 10222     IF BMAINTI = 'A'
 10223         GO TO 1200-ADD-ISSUE-ROUTINE.
 10224
 10225     IF BMAINTI = 'C'
 10226         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10227
 10228     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10229
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 189
* EL6311.cbl
 10231
 10232 1030-EDIT-FOR-NUMERICS.
 10233     IF WS-CSO-SUB EQUAL 10
 10234        GO TO 1030-EDIT-EXIT.
 10235
 10236     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10237        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10238        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10239           ADD +1               TO WS-CSO-SUB
 10240           GO TO 1030-EDIT-FOR-NUMERICS.
 10241
 10242     MOVE 'N'                   TO WS-NUMERIC-SW.
 10243
 10244 1030-EDIT-EXIT.
 10245******************************************************************
 10246*                                                                *
 10247*                 C A L C U L A T E   A G E                      *
 10248*                                                                *
 10249******************************************************************
 10250
 10251
 10252 1095-CALC-AGE.
 10253
 10254     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10255     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10256     MOVE 1                  TO DC-OPTION-CODE.
 10257     PERFORM 9700-DATE-LINK
 10258     IF NO-CONVERSION-ERROR
 10259         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10260         MOVE WS-BAGE            TO BAGEI
 10261         MOVE +2                 TO BAGEL
 10262         MOVE AL-UNNON TO BAGEA.
 10263
 10264 1099-EXIT.
 10265     EXIT.
 10266
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 190
* EL6311.cbl
 10268
 10269******************************************************************
 10270*                                                                *
 10271*                   S H O W   I S S U E                          *
 10272*                                                                *
 10273******************************************************************
 10274
 10275 1100-SHOW-REQUEST.
 10276     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10277
 10278     IF BCERTNOL = ZEROS AND
 10279        BEFFDTL  = ZEROS
 10280        MOVE -1                  TO BMAINTL
 10281        GO TO 8200-SEND-DATAONLY.
 10282
 10283     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10284
 10285     IF BSUFIXL NOT = ZEROS
 10286        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10287     ELSE
 10288        MOVE SPACE               TO WS-NEW-SUFFIX.
 10289
 10290     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10291     PERFORM 8600-DEEDIT.
 10292     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10293     MOVE '4'                    TO DC-OPTION-CODE.
 10294     PERFORM 9700-DATE-LINK.
 10295     IF DATE-CONVERSION-ERROR
 10296        MOVE ER-0348             TO EMI-ERROR
 10297        MOVE -1                  TO BEFFDTL
 10298        MOVE AL-UABON            TO BEFFDTA
 10299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10300        GO TO 8200-SEND-DATAONLY
 10301     ELSE
 10302        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10303        MOVE AL-UANON            TO BEFFDTA
 10304        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10305
 10306     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10307
 10308     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10309        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10310          MOVE 'Y'                    TO WS-SHOW-SW
 10311          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10312             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10313           ELSE
 10314             IF PI-FILE-BROWSE
 10315                GO TO 4300-BROWSE-FILE-FORWARD
 10316              ELSE
 10317                IF PI-CSR-BROWSE
 10318                   GO TO 4200-BROWSE-CSR-FORWARD
 10319                ELSE
 10320                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10321        ELSE
 10322           GO TO 3900-RE-DISPLAY-RECORD.
 10323
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 191
* EL6311.cbl
 10325
 10326******************************************************************
 10327*                                                                *
 10328*            A D D   I S S U E   R O U T I N E                   *
 10329*                                                                *
 10330******************************************************************
 10331
 10332***************************************************************
 10333*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10334*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10335*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10336*     4. LINK TO THE EDIT ROUTINE.                            *
 10337*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10338*     6. WRITE THE NEW ISSUE RECORD.                          *
 10339*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10340*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10341*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10342*        ELSE                                                 *
 10343*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10344***************************************************************
 10345
 10346 1200-ADD-ISSUE-ROUTINE.
 10347     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10348
 10349
 10350* EXEC CICS GETMAIN
 10351*        SET     (ADDRESS OF PENDING-BUSINESS)
 10352*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10353*    END-EXEC.
 10354*    MOVE '," L                  $   #00010207' TO DFHEIV0
 10355     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10357     MOVE X'2020233030303130323037' TO DFHEIV0(25:11)
 10358     CALL 'kxdfhei1' USING DFHEIV0,
 10359           DFHEIV20,
 10360           ERPNDB-RECORD-LENGTH,
 10361           DFHEIV99
 10362     SET ADDRESS OF PENDING-BUSINESS TO
 10363         DFHEIV20
 10364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10365
 10366
 10367
 10368* EXEC CICS HANDLE CONDITION
 10369*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10370*    END-EXEC.
 10371*    MOVE '"$I                   ! # #00010212' TO DFHEIV0
 10372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10374     MOVE X'2320233030303130323132' TO DFHEIV0(25:11)
 10375     CALL 'kxdfhei1' USING DFHEIV0
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10377
 10378
 10379     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10380     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10381     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10382
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 192
* EL6311.cbl
 10383
 10384* EXEC CICS READ
 10385*        INTO    (PENDING-BUSINESS)
 10386*        DATASET (FILE-ID-ERPNDB)
 10387*        RIDFLD  (ERPNDB-KEY)
 10388*    END-EXEC.
 10389     MOVE LENGTH OF
 10390      PENDING-BUSINESS
 10391       TO DFHEIV11
 10392*    MOVE '&"IL       E          (   #00010220' TO DFHEIV0
 10393     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10395     MOVE X'2020233030303130323230' TO DFHEIV0(25:11)
 10396     CALL 'kxdfhei1' USING DFHEIV0,
 10397           FILE-ID-ERPNDB,
 10398           PENDING-BUSINESS,
 10399           DFHEIV11,
 10400           ERPNDB-KEY,
 10401           DFHEIV99,
 10402           DFHEIV99,
 10403           DFHEIV99
 10404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10405
 10406
 10407     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10408
 10409     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10410     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10411     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10412     MOVE SPACES                 TO PENDING-BUSINESS.
 10413     MOVE 'PB'                   TO PB-RECORD-ID.
 10414     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10415     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10416     MOVE SPACES                 TO PB-CERT-SFX.
 10417     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10418     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10419                                    PB-ALT-CHG-SEQ-NO.
 10420
 10421     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10422     MOVE '1'                    TO PB-RECORD-TYPE.
 10423
 10424     IF BSUFIXL NOT = ZEROS
 10425        MOVE BSUFIXI             TO PB-CERT-SFX.
 10426
 10427     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10428
 10429     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10430     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10431
 10432     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10433                                    PB-I-LF-PREM-CALC
 10434                                    PB-I-LF-ALT-PREM-CALC
 10435                                    PB-I-LF-RATE
 10436                                    PB-I-LF-ALT-RATE
 10437                                    PB-I-LF-REI-RATE
 10438                                    PB-I-LF-ALT-REI-RATE
 10439                                    PB-I-RATE-DEV-PCT-LF
 10440                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 193
* EL6311.cbl
 10441                                    PB-I-AH-RATE
 10442                                    PB-I-AH-REI-RATE
 10443                                    PB-I-AH-RATE-TRM
 10444                                    PB-I-RATE-DEV-PCT-AH
 10445                                    PB-I-BUSINESS-TYPE
 10446                                    PB-I-LIFE-COMMISSION
 10447                                    PB-I-JOINT-COMMISSION
 10448                                    PB-I-JOINT-AGE
 10449                                    PB-I-AH-COMMISSION
 10450                                    PB-I-CURR-SEQ
 10451                                    PB-CHG-COUNT
 10452                                    PB-LF-BILLED-AMTS
 10453                                    PB-AH-BILLED-AMTS
 10454                                    PB-CALC-TOLERANCE
 10455                                    PB-I-EXTENTION-DAYS
 10456*                                   PB-I-MICROFILM-NO
 10457                                    PB-I-TERM-IN-DAYS.
 10458
 10459     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10460                                    PB-I-LF-EXPIRE-DT
 10461                                    PB-I-AH-EXPIRE-DT
 10462                                    PB-BILLED-DT
 10463                                    PB-ACCT-EFF-DT
 10464                                    PB-ACCT-EXP-DT
 10465                                    PB-I-1ST-PMT-DT.
 10466
 10467     MOVE 'X'                    TO PB-FATAL-FLAG.
 10468
 10469     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10470
 10471     IF BLSTNML GREATER THAN ZEROS
 10472         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10473
 10474*    IF BMICRNOL  GREATER  ZEROS
 10475*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10476*    ELSE
 10477*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10478     IF BVINL > ZEROS
 10479        MOVE BVINI               TO PB-I-VIN
 10480     END-IF
 10481     IF B1STNML GREATER THAN ZEROS
 10482         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10483
 10484     IF BINITL  GREATER THAN ZEROS
 10485         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10486
 10487     IF BBIRTHL GREATER THAN ZERO
 10488         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10489     ELSE
 10490         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10491
 10492     IF B1STPMTL GREATER THAN ZERO
 10493         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10494     ELSE
 10495         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10496
 10497     IF BAGEL    GREATER THAN ZEROS
 10498         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 194
* EL6311.cbl
 10499        ELSE
 10500         MOVE ZEROS              TO PB-I-AGE.
 10501
 10502     IF BSEXL    GREATER THAN ZEROS
 10503         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10504
 10505     IF BTERM-LEN (1) GREATER THAN ZEROS
 10506        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10507     ELSE
 10508        MOVE ZEROS               TO PB-I-LF-TERM.
 10509
 10510     IF BTERM-LEN (2) GREATER THAN ZEROS
 10511        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10512     ELSE
 10513        MOVE ZEROS               TO PB-I-AH-TERM.
 10514
 10515     IF BLNTRML       GREATER THAN ZEROS
 10516         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10517        ELSE
 10518         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10519
 10520     IF BFREQL        GREATER THAN ZEROS
 10521         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10522        ELSE
 10523         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10524
 10525     IF BSKPCDL       GREATER THAN ZEROS
 10526         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10527
 10528     IF BMODEL        GREATER THAN ZEROS
 10529         MOVE BMODEI             TO PB-I-TERM-TYPE
 10530                                    PI-BMODE.
 10531
 10532     IF BPMTSL        GREATER THAN ZEROS
 10533         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10534                                    PI-BPMTS
 10535        ELSE
 10536         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10537                                    PI-BPMTS.
 10538
 10539     IF BPMTAMTL      GREATER THAN ZEROS
 10540         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10541        ELSE
 10542         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10543
 10544     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10545        IF BTYPE  (1)   NOT = ZEROS
 10546           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10547                                    PI-BTYPE (1)
 10548           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10549           MOVE SPACES           TO PB-I-LF-ABBR
 10550        ELSE
 10551           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10552                                    PB-I-LF-ABBR
 10553           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10554     ELSE
 10555        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10556                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 195
* EL6311.cbl
 10557        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10558
 10559     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10560         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10561     ELSE
 10562         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10563
 10564     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10565         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10566     ELSE
 10567         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10568
 10569     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10570         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10571            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10572            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10573         ELSE
 10574            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10575*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10576*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10577         END-IF
 10578     ELSE
 10579         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10580
 10581     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10582         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10583
 10584     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10585         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10586         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10587     ELSE
 10588         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10589
 10590     IF  BALT-PREM-LEN     (2) > ZEROS
 10591         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10592     ELSE
 10593         MOVE ZEROS            TO PB-I-TOT-FEES.
 10594
 10595     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10596        IF BTYPE      (2)   NOT = ZEROS
 10597           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10598                                  PI-BTYPE (2)
 10599           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10600           MOVE SPACES         TO PB-I-AH-ABBR
 10601        ELSE
 10602           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10603                                  PB-I-AH-ABBR
 10604           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10605     ELSE
 10606        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10607                                  PB-I-AH-ABBR
 10608        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10609
 10610     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10611         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10612     ELSE
 10613         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10614
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 196
* EL6311.cbl
 10615     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10616         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10617            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10618            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10619         ELSE
 10620            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10621*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10622*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10623         END-IF
 10624     ELSE
 10625         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10626
 10627     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10628         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10629
 10630     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10631        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10632     ELSE
 10633        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10634
 10635     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10636        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10637     ELSE
 10638        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10639
 10640     IF BINDGRPL  GREATER THAN ZEROS
 10641         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10642
 10643     IF BRTCLSL   GREATER THAN ZEROS
 10644         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10645
 10646     IF BSIGL     GREATER THAN ZEROS
 10647         MOVE BSIGI              TO PB-I-SIG-SW.
 10648     IF BAPRL > ZEROS
 10649         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10650     ELSE
 10651        if pi-company-id = 'CID'
 10652           move +99.9999         to pb-i-loan-apr
 10653        else
 10654           MOVE ZEROS            TO PB-I-LOAN-APR
 10655        end-if
 10656     end-if
 10657     IF BMEMBERL  GREATER THAN ZEROS
 10658         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10659
 10660     IF BLNOFCRL  GREATER THAN ZEROS
 10661         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10662
 10663     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10664        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10665     ELSE
 10666        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10667
 10668     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10669        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10670     ELSE
 10671        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10672
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 197
* EL6311.cbl
 10673     IF BDAYSL   GREATER THAN ZEROS
 10674        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10675                                    PB-I-EXTENTION-DAYS
 10676     ELSE
 10677        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10678                                    PB-I-EXTENTION-DAYS.
 10679
 10680     IF BDAYSL GREATER THAN ZEROS
 10681        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10682
 10683     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10684        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10685           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10686
 10687     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10688        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10689           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10690
 10691     IF B1STPMTL GREATER THAN ZEROS
 10692        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10693
 10694     IF PB-EXT-DAYS-PROCESSING
 10695        IF PB-I-EXTENTION-DAYS = ZEROS
 10696           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10697
 10698     IF PB-EXPIRE-DT-PROCESSING
 10699        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10700           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10701             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10702
 10703     IF PB-1ST-PMT-DT-PROCESSING
 10704        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10705           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10706
 10707     IF BREINL GREATER THAN ZEROS
 10708        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10709
 10710     IF BENTRYL NOT = ZEROS
 10711        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10712        IF PI-COMPANY-ID = 'CID'
 10713           AND (PB-BATCH-ENTRY = 'P')
 10714           AND (PB-STATE = 'VA')
 10715           PERFORM 1500-UPDATE-ERNOTE
 10716                                 THRU 1500-EXIT
 10717        END-IF
 10718     END-IF
 10719     IF BUNWRITL NOT = ZEROS
 10720        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10721
 10722     IF BFORCEL NOT = ZEROS
 10723        MOVE BFORCEI             TO PB-FORCE-CODE.
 10724
 10725     IF BBILCDL NOT = ZEROS
 10726        MOVE BBILCDI             TO PB-RECORD-BILL.
 10727
 10728     IF BLIVESL GREATER THAN ZEROS
 10729        MOVE WS-BLIVES           TO PB-I-LIVES
 10730     ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 198
* EL6311.cbl
 10731        MOVE ZEROS               TO PB-I-LIVES.
 10732
 10733     IF BBILLEDL GREATER THAN ZEROS
 10734        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10735     ELSE
 10736        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10737
 10738*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10739
 10740 1260-WRITE-PB-RECORD.
 10741     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10742                                    PB-INPUT-BY.
 10743     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10744     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10745                                    PB-INPUT-DT.
 10746
 10747     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10748     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10749                                    PB-CONTROL-BY-ORIG-BATCH.
 10750
 10751
 10752     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10753     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10754     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10755     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10756     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10757
 10758     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10759
 10760     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10761
 10762     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10763     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10764     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10765
 10766     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10767     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10768
 10769 1275-WRITE-PENDING-BUSINESS.
 10770     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10771     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10772     MOVE 'A'                    TO JP-RECORD-TYPE.
 10773     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10774
 10775
 10776* EXEC CICS HANDLE CONDITION
 10777*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10778*    END-EXEC.
 10779*    MOVE '"$%                   ! $ #00010594' TO DFHEIV0
 10780     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10781     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10782     MOVE X'2420233030303130353934' TO DFHEIV0(25:11)
 10783     CALL 'kxdfhei1' USING DFHEIV0
 10784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10785
 10786
 10787
 10788* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 199
* EL6311.cbl
 10789*        DATASET (FILE-ID-ERPNDB)
 10790*        FROM    (PENDING-BUSINESS)
 10791*        RIDFLD  (PB-CONTROL-PRIMARY)
 10792*    END-EXEC.
 10793     MOVE LENGTH OF
 10794      PENDING-BUSINESS
 10795       TO DFHEIV11
 10796*    MOVE '&$ L                  ''   #00010598' TO DFHEIV0
 10797     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10798     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10799     MOVE X'2020233030303130353938' TO DFHEIV0(25:11)
 10800     CALL 'kxdfhei1' USING DFHEIV0,
 10801           FILE-ID-ERPNDB,
 10802           PENDING-BUSINESS,
 10803           DFHEIV11,
 10804           PB-CONTROL-PRIMARY,
 10805           DFHEIV99,
 10806           DFHEIV99
 10807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10808
 10809
 10810     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10811
 10812     PERFORM 8400-LOG-JOURNAL-RECORD.
 10813
 10814******************************************************************
 10815*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10816******************************************************************
 10817*    display ' made it to add orig cert '
 10818     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10819     MOVE ' '                    TO WS-ERMAIL-SW
 10820
 10821* EXEC CICS READ
 10822*       DATASET   (FILE-ID-ERMAIL)
 10823*       SET       (ADDRESS OF MAILING-DATA)
 10824*       RIDFLD    (ERMAIL-KEY)
 10825*       RESP      (WS-RESPONSE)
 10826*    END-EXEC
 10827*    MOVE '&"S        E          (  N#00010614' TO DFHEIV0
 10828     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10830     MOVE X'204E233030303130363134' TO DFHEIV0(25:11)
 10831     CALL 'kxdfhei1' USING DFHEIV0,
 10832           FILE-ID-ERMAIL,
 10833           DFHEIV20,
 10834           DFHEIV99,
 10835           ERMAIL-KEY,
 10836           DFHEIV99,
 10837           DFHEIV99,
 10838           DFHEIV99
 10839     SET ADDRESS OF MAILING-DATA TO
 10840         DFHEIV20
 10841     MOVE EIBRESP  TO WS-RESPONSE
 10842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10843     IF RESP-NORMAL
 10844        SET ERMAIL-FOUND TO TRUE
 10845     END-IF
 10846
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 200
* EL6311.cbl
 10847     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10848     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10849     MOVE 'OC'                   TO OC-RECORD-ID
 10850     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10851                                 TO OC-CONTROL-PRIMARY (1:33)
 10852     MOVE 'I'                    TO OC-RECORD-TYPE
 10853     MOVE +4096                  TO OC-KEY-SEQ-NO
 10854     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10855     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10856     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10857     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10858     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10859     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10860     MOVE PB-I-AGE               TO OC-INS-AGE
 10861     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10862     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10863     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10864     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10865     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10866     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10867     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10868     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10869     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10870     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10871     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10872     IF PB-I-JOINT-COMMISSION > +0
 10873         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10874     ELSE
 10875         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10876     END-IF
 10877     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10878     MOVE +0                     TO OC-LF-CANCEL-AMT
 10879                                    OC-LF-ITD-CANCEL-AMT
 10880     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10881     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10882     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10883     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10884     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10885     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10886     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10887     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10888     MOVE +0                     TO OC-AH-CANCEL-AMT
 10889                                    OC-AH-ITD-CANCEL-AMT
 10890     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10891     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10892     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10893     IF ERMAIL-FOUND
 10894        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10895     END-IF
 10896     IF NOT CERT-TRL-REC-NOT-FOUND
 10897        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10898                           OC-INS-AGE-DEFAULT-FLAG
 10899        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10900                           OC-JNT-AGE-DEFAULT-FLAG
 10901     END-IF
 10902     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10903     .
 10904 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 201
* EL6311.cbl
 10905
 10906* EXEC CICS WRITE
 10907*       DATASET   ('ELCRTO')
 10908*       FROM      (ORIGINAL-CERTIFICATE)
 10909*       RIDFLD    (OC-CONTROL-PRIMARY)
 10910*       RESP      (WS-RESPONSE)
 10911*    END-EXEC
 10912     MOVE LENGTH OF
 10913      ORIGINAL-CERTIFICATE
 10914       TO DFHEIV11
 10915     MOVE 'ELCRTO' TO DFHEIV1
 10916*    MOVE '&$ L                  ''  N#00010682' TO DFHEIV0
 10917     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10918     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10919     MOVE X'204E233030303130363832' TO DFHEIV0(25:11)
 10920     CALL 'kxdfhei1' USING DFHEIV0,
 10921           DFHEIV1,
 10922           ORIGINAL-CERTIFICATE,
 10923           DFHEIV11,
 10924           OC-CONTROL-PRIMARY,
 10925           DFHEIV99,
 10926           DFHEIV99
 10927     MOVE EIBRESP  TO WS-RESPONSE
 10928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10929*    display ' just wrote 1275 ' ws-response
 10930     IF RESP-DUPKEY
 10931        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10932        GO TO 1275-WRITE-ELCRTO
 10933     ELSE
 10934        IF NOT RESP-NORMAL
 10935           MOVE -1               TO BMAINTL
 10936           MOVE ER-7450          TO EMI-ERROR
 10937           PERFORM 9900-ERROR-FORMAT
 10938                                 THRU 9900-EXIT
 10939           GO TO 8200-SEND-DATAONLY
 10940        END-IF
 10941     END-IF
 10942******************************************************************
 10943*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10944******************************************************************
 10945
 10946
 10947* EXEC CICS READ
 10948*        INTO    (PENDING-BUSINESS)
 10949*        DATASET (FILE-ID-ERPNDB)
 10950*        RIDFLD  (ERPNDB-KEY)
 10951*        UPDATE
 10952*    END-EXEC.
 10953     MOVE LENGTH OF
 10954      PENDING-BUSINESS
 10955       TO DFHEIV11
 10956*    MOVE '&"IL       EU         (   #00010705' TO DFHEIV0
 10957     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10958     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10959     MOVE X'2020233030303130373035' TO DFHEIV0(25:11)
 10960     CALL 'kxdfhei1' USING DFHEIV0,
 10961           FILE-ID-ERPNDB,
 10962           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 202
* EL6311.cbl
 10963           DFHEIV11,
 10964           ERPNDB-KEY,
 10965           DFHEIV99,
 10966           DFHEIV99,
 10967           DFHEIV99
 10968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10969
 10970
 10971     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10972     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10973     MOVE 'B'                    TO JP-RECORD-TYPE.
 10974     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10975
 10976     PERFORM 8400-LOG-JOURNAL-RECORD.
 10977
 10978     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10979
 10980
 10981* EXEC CICS REWRITE
 10982*        DATASET (FILE-ID-ERPNDB)
 10983*        FROM    (PENDING-BUSINESS)
 10984*    END-EXEC.
 10985     MOVE LENGTH OF
 10986      PENDING-BUSINESS
 10987       TO DFHEIV11
 10988*    MOVE '&& L                  %   #00010721' TO DFHEIV0
 10989     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10990     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10991     MOVE X'2020233030303130373231' TO DFHEIV0(25:11)
 10992     CALL 'kxdfhei1' USING DFHEIV0,
 10993           FILE-ID-ERPNDB,
 10994           PENDING-BUSINESS,
 10995           DFHEIV11,
 10996           DFHEIV99
 10997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10998
 10999
 11000     MOVE 'C'                    TO JP-RECORD-TYPE.
 11001     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11002
 11003     PERFORM 8400-LOG-JOURNAL-RECORD.
 11004
 11005     IF WS-ERRORS-PRESENT
 11006         GO TO 3900-RE-DISPLAY-RECORD.
 11007
 11008     MOVE ZEROS                  TO EMI-ERROR.
 11009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11010     MOVE LOW-VALUES             TO EL631BI.
 11011     MOVE  -1                    TO BMAINTL.
 11012     GO TO 8100-SEND-INITIAL-MAP.
 11013
 11014 1280-BATCH-HDR-NOT-FOUND.
 11015     MOVE -1                     TO BMAINTL.
 11016     MOVE ER-7450                TO EMI-ERROR.
 11017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11018     GO TO 8200-SEND-DATAONLY.
 11019
 11020 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 203
* EL6311.cbl
 11021
 11022******************************************************************
 11023*                                                                *
 11024*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11025*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11026*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11027*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11028*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11029*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11030*                                                                *
 11031******************************************************************
 11032
 11033     IF LCP-ONCTR-01 =  0
 11034         ADD 1 TO LCP-ONCTR-01
 11035        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11036
 11037     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11038
 11039     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11040         NEXT SENTENCE
 11041     ELSE
 11042         ADD +1 TO PB-BATCH-SEQ-NO
 11043                   PB-CSR-BATCH-SEQ-NO
 11044         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11045         GO TO 1275-WRITE-PENDING-BUSINESS.
 11046
 11047     MOVE -1                     TO BCERTNOL.
 11048     MOVE AL-UABON               TO BCERTNOA.
 11049     MOVE AL-UNBON               TO BEFFDTA.
 11050
 11051     MOVE 1                      TO EMI-SUB
 11052                                    EMI-SWITCH1
 11053                                    EMI-SWITCH-AREA-1
 11054                                    EMI-SWITCH-AREA-2.
 11055
 11056     MOVE SPACES                 TO EMI-ERROR-LINES.
 11057
 11058
 11059* EXEC CICS SYNCPOINT ROLLBACK
 11060*    END-EXEC.
 11061*    MOVE '6"R                   !   #00010784' TO DFHEIV0
 11062     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11063     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11064     MOVE X'2020233030303130373834' TO DFHEIV0(25:11)
 11065     CALL 'kxdfhei1' USING DFHEIV0
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069     MOVE ER-2247                TO EMI-ERROR.
 11070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11071     GO TO 8200-SEND-DATAONLY.
 11072
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 204
* EL6311.cbl
 11074
 11075
 11076 1295-READ-CERT-TRAILER.
 11077
 11078
 11079* EXEC CICS GETMAIN
 11080*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11081*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11082*        INITIMG (GETMAIN-SPACE)
 11083*    END-EXEC
 11084*    MOVE ',"IL                  $   #00010796' TO DFHEIV0
 11085     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11087     MOVE X'2020233030303130373936' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0,
 11089           DFHEIV20,
 11090           ELCRTT-RECORD-LENGTH,
 11091           GETMAIN-SPACE
 11092     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11093         DFHEIV20
 11094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11095
 11096     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11097     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11098     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11099
 11100
 11101* EXEC CICS HANDLE CONDITION
 11102*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11103*    END-EXEC.
 11104*    MOVE '"$I                   ! % #00010806' TO DFHEIV0
 11105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11107     MOVE X'2520233030303130383036' TO DFHEIV0(25:11)
 11108     CALL 'kxdfhei1' USING DFHEIV0
 11109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11110
 11111
 11112
 11113* EXEC CICS READ
 11114*        DATASET  (CRTT-ID)
 11115*        RIDFLD   (ELCRTT-KEY)
 11116*        INTO     (CERTIFICATE-TRAILERS)
 11117*    END-EXEC.
 11118     MOVE LENGTH OF
 11119      CERTIFICATE-TRAILERS
 11120       TO DFHEIV11
 11121*    MOVE '&"IL       E          (   #00010810' TO DFHEIV0
 11122     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11123     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11124     MOVE X'2020233030303130383130' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0,
 11126           CRTT-ID,
 11127           CERTIFICATE-TRAILERS,
 11128           DFHEIV11,
 11129           ELCRTT-KEY,
 11130           DFHEIV99,
 11131           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 205
* EL6311.cbl
 11132           DFHEIV99
 11133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11134
 11135
 11136     GO TO 1295-EXIT.
 11137
 11138 1295-CERT-TRL-REC-NOTFND.
 11139     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11140
 11141 1295-EXIT.
 11142     EXIT.
 11143
 11144******************************************************************
 11145*                                                                *
 11146*          C H A N G E   I S S U E   R O U T I N E               *
 11147*                                                                *
 11148******************************************************************
 11149
 11150***************************************************************
 11151*                                                             *
 11152*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11153*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11154*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11155*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11156*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11157*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11158*     5. LINK TO THE EDIT ROUTINE.                            *
 11159*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11160*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11161*              THE EDIT ROUTINE.                              *
 11162*     7. REWRITE THE NEW ISSUE                                *
 11163*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11164*                                                             *
 11165***************************************************************
 11166
 11167 1300-CHANGE-ISSUE-ROUTINE.
 11168     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11169
 11170     IF BCHGL NOT = ZEROS
 11171        MOVE ER-2196             TO EMI-ERROR
 11172        MOVE AL-UABON            TO BMAINTA
 11173        MOVE -1                  TO BMAINTL
 11174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11175        GO TO 8200-SEND-DATAONLY.
 11176
 11177     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11178
 11179     IF BSUFIXL NOT = ZEROS
 11180        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11181     ELSE
 11182        MOVE SPACE               TO WS-NEW-SUFFIX.
 11183
 11184     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11185     PERFORM 8600-DEEDIT.
 11186     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11187     MOVE '4'                    TO DC-OPTION-CODE.
 11188     PERFORM 9700-DATE-LINK.
 11189     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 206
* EL6311.cbl
 11190        MOVE ER-0348             TO EMI-ERROR
 11191        MOVE -1                  TO BEFFDTL
 11192        MOVE AL-UABON            TO BEFFDTA
 11193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11194        GO TO 8200-SEND-DATAONLY
 11195     ELSE
 11196        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11197        MOVE AL-UANON            TO BEFFDTA
 11198        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11199
 11200 1325-PROCESS-ISSUE-CHANGES.
 11201
 11202* EXEC CICS HANDLE CONDITION
 11203*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11204*    END-EXEC.
 11205*    MOVE '"$I                   ! & #00010881' TO DFHEIV0
 11206     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11208     MOVE X'2620233030303130383831' TO DFHEIV0(25:11)
 11209     CALL 'kxdfhei1' USING DFHEIV0
 11210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11211
 11212
 11213     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11214     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11215     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11216
 11217
 11218* EXEC CICS GETMAIN
 11219*        SET      (ADDRESS OF PENDING-BUSINESS)
 11220*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11221*        INITIMG  (GETMAIN-SPACE)
 11222*     END-EXEC.
 11223*    MOVE ',"IL                  $   #00010889' TO DFHEIV0
 11224     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11225     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11226     MOVE X'2020233030303130383839' TO DFHEIV0(25:11)
 11227     CALL 'kxdfhei1' USING DFHEIV0,
 11228           DFHEIV20,
 11229           ERPNDB-RECORD-LENGTH,
 11230           GETMAIN-SPACE
 11231     SET ADDRESS OF PENDING-BUSINESS TO
 11232         DFHEIV20
 11233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11234
 11235
 11236
 11237* EXEC CICS READ
 11238*        INTO    (PENDING-BUSINESS)
 11239*        DATASET (FILE-ID-ERPNDB)
 11240*        RIDFLD  (ERPNDB-KEY)
 11241*    END-EXEC.
 11242     MOVE LENGTH OF
 11243      PENDING-BUSINESS
 11244       TO DFHEIV11
 11245*    MOVE '&"IL       E          (   #00010895' TO DFHEIV0
 11246     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11247     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 207
* EL6311.cbl
 11248     MOVE X'2020233030303130383935' TO DFHEIV0(25:11)
 11249     CALL 'kxdfhei1' USING DFHEIV0,
 11250           FILE-ID-ERPNDB,
 11251           PENDING-BUSINESS,
 11252           DFHEIV11,
 11253           ERPNDB-KEY,
 11254           DFHEIV99,
 11255           DFHEIV99,
 11256           DFHEIV99
 11257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11258
 11259
 11260     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11261
 11262
 11263* EXEC CICS HANDLE CONDITION
 11264*         NOTFND     (1385-REC-NOT-FOUND)
 11265*    END-EXEC.
 11266*    MOVE '"$I                   ! '' #00010903' TO DFHEIV0
 11267     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11269     MOVE X'2720233030303130393033' TO DFHEIV0(25:11)
 11270     CALL 'kxdfhei1' USING DFHEIV0
 11271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11272
 11273
 11274**********************************************************
 11275*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11276*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11277**********************************************************
 11278
 11279
 11280* EXEC CICS READ
 11281*        DATASET (FILE-ID-ERPNDB)
 11282*        INTO    (PENDING-BUSINESS)
 11283*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11284*    END-EXEC.
 11285     MOVE LENGTH OF
 11286      PENDING-BUSINESS
 11287       TO DFHEIV11
 11288*    MOVE '&"IL       E          (   #00010912' TO DFHEIV0
 11289     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11291     MOVE X'2020233030303130393132' TO DFHEIV0(25:11)
 11292     CALL 'kxdfhei1' USING DFHEIV0,
 11293           FILE-ID-ERPNDB,
 11294           PENDING-BUSINESS,
 11295           DFHEIV11,
 11296           PI-PREV-CONTROL-PRIMARY,
 11297           DFHEIV99,
 11298           DFHEIV99,
 11299           DFHEIV99
 11300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11301
 11302
 11303********** DO NOT ALLOW CHANGES IF THRU A/R
 11304     IF BMAINTI = 'C'
 11305         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 208
* EL6311.cbl
 11306             MOVE ER-4005          TO EMI-ERROR
 11307             MOVE -1               TO BMAINTL
 11308             MOVE AL-UABON         TO BMAINTA
 11309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11310             GO TO 8200-SEND-DATAONLY.
 11311**********
 11312
 11313     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11314        MOVE -1                 TO BMAINTL
 11315        MOVE ER-2197            TO EMI-ERROR
 11316        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11317        GO TO 8200-SEND-DATAONLY.
 11318
 11319     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11320        MOVE ER-2196             TO EMI-ERROR
 11321        MOVE AL-UABON            TO BMAINTA
 11322        MOVE -1                  TO BMAINTL
 11323        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11324        GO TO 8200-SEND-DATAONLY.
 11325
 11326     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11327
 11328     IF PB-BILLED-DT = LOW-VALUES AND
 11329        PB-CHG-COUNT = ZEROS
 11330        NEXT SENTENCE
 11331     ELSE
 11332        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11333            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11334           OR
 11335           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11336            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11337           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11338
 11339
 11340* EXEC CICS READ
 11341*        DATASET (FILE-ID-ERPNDB)
 11342*        INTO    (PENDING-BUSINESS)
 11343*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11344*        UPDATE
 11345*    END-EXEC.
 11346     MOVE LENGTH OF
 11347      PENDING-BUSINESS
 11348       TO DFHEIV11
 11349*    MOVE '&"IL       EU         (   #00010954' TO DFHEIV0
 11350     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11351     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11352     MOVE X'2020233030303130393534' TO DFHEIV0(25:11)
 11353     CALL 'kxdfhei1' USING DFHEIV0,
 11354           FILE-ID-ERPNDB,
 11355           PENDING-BUSINESS,
 11356           DFHEIV11,
 11357           PI-PREV-CONTROL-PRIMARY,
 11358           DFHEIV99,
 11359           DFHEIV99,
 11360           DFHEIV99
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 209
* EL6311.cbl
 11364     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11365     MOVE 'B'                    TO JP-RECORD-TYPE
 11366     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11367     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11368
 11369     PERFORM 8400-LOG-JOURNAL-RECORD.
 11370
 11371     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11372        PB-CHG-COUNT NOT = ZEROS
 11373        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11374            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11375           OR
 11376           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11377            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11378            MOVE LOW-VALUES             TO PB-BILLED-DT
 11379            ADD +1                      TO PB-CHG-COUNT.
 11380
 11381     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11382     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11383     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11384     MOVE '5'                    TO DC-OPTION-CODE.
 11385     PERFORM 9700-DATE-LINK
 11386     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11387
 11388*    IF BMICRNOL  GREATER  ZEROS
 11389*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11390
 11391     IF BVINL > ZEROS
 11392        MOVE BVINI               TO PB-I-VIN
 11393     END-IF
 11394     IF (BFORCEL NOT = ZEROS)
 11395        AND (PB-COMPANY-ID = 'DCC')
 11396        AND (BFORCEI = ' ')
 11397        AND (PB-FORCE-CODE = 'O')
 11398        COMPUTE PB-I-AH-PREMIUM-AMT =
 11399           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11400        PERFORM 1800-REMOVE-CERT-NOTES
 11401                                 THRU 1800-EXIT
 11402        PERFORM 1900-DELETE-ERPYAJ
 11403                                 THRU 1900-EXIT
 11404        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11405     END-IF
 11406     IF (BFORCEL NOT = ZEROS)
 11407        AND (PB-COMPANY-ID = 'DCC')
 11408        AND (BFORCEI = 'O')
 11409        AND (PB-FORCE-CODE NOT = 'O')
 11410        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11411           PB-I-AH-PREM-CALC
 11412        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11413        MOVE SPACE               TO DC-OPTION-CODE
 11414        PERFORM 9700-DATE-LINK
 11415        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11416        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11417        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11418        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11419        PERFORM 1500-UPDATE-ERNOTE
 11420                                 THRU 1500-EXIT
 11421        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 210
* EL6311.cbl
 11422                                 THRU 1600-EXIT
 11423     END-IF
 11424     IF BLSTNML  GREATER THAN ZEROS
 11425         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11426
 11427     IF B1STNML  GREATER THAN ZEROS
 11428         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11429
 11430     IF BINITL   GREATER THAN ZEROS
 11431         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11432
 11433     IF BBIRTHL  GREATER THAN ZERO
 11434         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11435
 11436     IF B1STPMTL GREATER THAN ZERO
 11437         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11438
 11439     IF BAGEL    GREATER THAN ZEROS
 11440         MOVE BAGEI              TO PB-I-AGE.
 11441
 11442     MOVE 'N'                    TO WS-INS-AGE-SET
 11443                                    WS-JNT-AGE-SET.
 11444     IF BAGEL    GREATER THAN ZEROS
 11445        MOVE 'Y'                TO WS-INS-AGE-SET
 11446        IF BAGEI = ZERO AND
 11447             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11448           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11449           MOVE 'AGE*'          TO BAGEDEFO
 11450        ELSE
 11451           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11452           MOVE 'AGE '          TO BAGEDEFO
 11453        END-IF
 11454        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11455     END-IF.
 11456
 11457     IF BSEXL    GREATER THAN ZEROS
 11458         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11459
 11460     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11461        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11462
 11463     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11464        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11465
 11466     IF BLNTRML  GREATER THAN ZEROS
 11467         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11468
 11469     IF BFREQL   GREATER THAN ZEROS
 11470         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11471
 11472     IF BSKPCDL  GREATER THAN ZEROS
 11473         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11474
 11475     IF BMODEL   GREATER THAN ZEROS
 11476         MOVE BMODEI             TO PB-I-TERM-TYPE
 11477                                    PI-BMODE.
 11478
 11479     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 211
* EL6311.cbl
 11480         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11481                                    PI-BPMTS.
 11482
 11483     IF BPMTAMTL GREATER THAN ZEROS
 11484         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11485
 11486     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11487         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11488
 11489     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11490         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11491
 11492     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11493
 11494     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11495         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11496            SUBTRACT PB-I-LF-PREMIUM-AMT
 11497                     FROM WS-B-LF-ISS-PRM-ENTERED
 11498            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11499            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11500            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11501         ELSE
 11502            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11503*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11504*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11505         END-IF
 11506     END-IF.
 11507
 11508     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11509            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11510                     FROM WS-B-LF-ISS-PRM-ENTERED
 11511         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11512         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11513
 11514     IF  BALT-PREM-LEN     (2)  > ZEROS
 11515         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11516
 11517     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11518         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11519
 11520     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11521         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11522            SUBTRACT PB-I-AH-PREMIUM-AMT
 11523                     FROM WS-B-AH-ISS-PRM-ENTERED
 11524            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11525            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11526            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11527         ELSE
 11528            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11529*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11530*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11531         END-IF
 11532     END-IF
 11533
 11534     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11535        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11536
 11537     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 212
* EL6311.cbl
 11538        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11539
 11540     IF BINDGRPL            GREATER THAN ZEROS
 11541         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11542
 11543     IF BRTCLSL             GREATER THAN ZEROS
 11544         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11545
 11546     IF BSIGL               GREATER THAN ZEROS
 11547         MOVE BSIGI              TO PB-I-SIG-SW.
 11548
 11549     IF BAPRL               GREATER THAN ZEROS
 11550         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11551
 11552     IF BMEMBERL            GREATER THAN ZEROS
 11553         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11554
 11555     IF BLNOFCRL            GREATER THAN ZEROS
 11556         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11557
 11558     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11559        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11560
 11561     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11562        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11563
 11564     IF BDAYSL              GREATER THAN ZEROS
 11565        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11566                                    PB-I-EXTENTION-DAYS.
 11567
 11568     IF BDAYSL GREATER THAN ZEROS
 11569        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11570
 11571     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11572        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11573           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11574
 11575     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11576        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11577           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11578
 11579     IF B1STPMTL GREATER THAN ZEROS
 11580        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11581
 11582     IF PB-EXT-DAYS-PROCESSING
 11583        IF PB-I-EXTENTION-DAYS = ZEROS
 11584           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11585
 11586     IF PB-EXPIRE-DT-PROCESSING
 11587        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11588           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11589             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11590
 11591     IF PB-1ST-PMT-DT-PROCESSING
 11592        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11593           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11594
 11595     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 213
* EL6311.cbl
 11596        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11597
 11598     IF BFORCEL NOT = ZEROS
 11599        MOVE BFORCEI             TO PB-FORCE-CODE.
 11600     IF (BENTRYL NOT = ZEROS)
 11601        AND (PB-COMPANY-ID = 'CID')
 11602        AND (PB-STATE = 'VA')
 11603        AND (BENTRYI NOT = 'P')
 11604        AND (PB-BATCH-ENTRY = 'P')
 11605        PERFORM 1800-REMOVE-CERT-NOTES
 11606                                 THRU 1800-EXIT
 11607     END-IF
 11608     IF BENTRYL NOT = ZEROS
 11609        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11610        IF PI-COMPANY-ID = 'CID'
 11611           AND (PB-BATCH-ENTRY = 'P')
 11612           AND (PB-STATE = 'VA')
 11613           PERFORM 1500-UPDATE-ERNOTE
 11614                                 THRU 1500-EXIT
 11615        END-IF
 11616     END-IF
 11617
 11618     IF BUNWRITL NOT = ZEROS
 11619        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11620
 11621     IF BBILCDL NOT = ZEROS
 11622        MOVE BBILCDI             TO PB-RECORD-BILL.
 11623
 11624     IF BLIVESL GREATER THAN ZEROS
 11625        MOVE WS-BLIVES           TO PB-I-LIVES.
 11626
 11627
 11628*DMD CUSTOM CODING*************START
 11629     IF PI-COMPANY-ID NOT = 'DMD'
 11630         MOVE ZEROS               TO BBILLEDL.
 11631*DMD CUSTOM CODING*************END
 11632
 11633     IF BBILLEDL GREATER THAN ZEROS
 11634        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11635
 11636
 11637*****************************************************************
 11638*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11639*****************************************************************
 11640
 11641     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11642        IF BTYPE  (1)   = ZEROS OR SPACES
 11643           IF REMOVE-LF-COVERAGE
 11644               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11645                                        PI-BTYPE (1)
 11646               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11647                                        WS-B-LF-ISS-PRM-ENTERED
 11648               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11649                                        WS-B-LF-ISS-PRM-ENTERED
 11650               SUBTRACT PB-I-LF-PREM-CALC FROM
 11651                                        WS-B-LF-ISS-PRM-COMPUTED
 11652               MOVE ZEROS            TO PB-I-LF-TERM
 11653                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 214
* EL6311.cbl
 11654                                        PB-I-LF-PREMIUM-AMT
 11655                                        PB-I-LF-BENEFIT-CD
 11656                                        PB-I-LF-PREM-CALC
 11657                                        PB-I-LF-CRIT-PER
 11658                                        PB-I-LF-ALT-BENEFIT-AMT
 11659                                        PB-I-LF-ALT-PREMIUM-AMT
 11660               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11661           ELSE
 11662               NEXT SENTENCE
 11663        ELSE
 11664           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11665                                    PI-BTYPE (1).
 11666     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11667        IF BTYPE  (2)   = ZEROS OR SPACES
 11668           IF  REMOVE-AH-COVERAGE
 11669               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11670                                        PI-BTYPE (2)
 11671               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11672                                        WS-B-AH-ISS-PRM-ENTERED
 11673               SUBTRACT PB-I-AH-PREM-CALC FROM
 11674                                        WS-B-AH-ISS-PRM-COMPUTED
 11675               MOVE ZEROS            TO PB-I-AH-TERM
 11676                                        PB-I-AH-BENEFIT-AMT
 11677                                        PB-I-AH-PREMIUM-AMT
 11678                                        PB-I-AH-BENEFIT-CD
 11679                                        PB-I-AH-PREM-CALC
 11680                                        PB-I-AH-CRIT-PER
 11681               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11682           ELSE
 11683               NEXT SENTENCE
 11684        ELSE
 11685           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11686                                    PI-BTYPE (2).
 11687 1360-REWRITE-PB-RECORD.
 11688     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11689
 11690     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11691     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11692
 11693     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11694
 11695     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11696     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11697
 11698     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11699         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11700
 11701     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11702         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11703
 11704     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11705
 11706     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11707
 11708     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11709
 11710     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11711     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 215
* EL6311.cbl
 11712     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11713
 11714     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11715     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11716
 11717 1375-REWRITE-PB-RECORD.
 11718     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11719     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11720     MOVE 'C'                    TO JP-RECORD-TYPE.
 11721     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11722
 11723
 11724* EXEC CICS REWRITE
 11725*        DATASET (FILE-ID-ERPNDB)
 11726*        FROM    (PENDING-BUSINESS)
 11727*    END-EXEC.
 11728     MOVE LENGTH OF
 11729      PENDING-BUSINESS
 11730       TO DFHEIV11
 11731*    MOVE '&& L                  %   #00011320' TO DFHEIV0
 11732     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11733     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11734     MOVE X'2020233030303131333230' TO DFHEIV0(25:11)
 11735     CALL 'kxdfhei1' USING DFHEIV0,
 11736           FILE-ID-ERPNDB,
 11737           PENDING-BUSINESS,
 11738           DFHEIV11,
 11739           DFHEIV99
 11740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11741
 11742
 11743     PERFORM 8400-LOG-JOURNAL-RECORD.
 11744******************************************************************
 11745*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11746******************************************************************
 11747*    display ' made it to update orig cert '
 11748     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11749     MOVE ' '                    TO WS-ERMAIL-SW
 11750
 11751* EXEC CICS READ
 11752*       DATASET   (FILE-ID-ERMAIL)
 11753*       SET       (ADDRESS OF MAILING-DATA)
 11754*       RIDFLD    (ERMAIL-KEY)
 11755*       RESP      (WS-RESPONSE)
 11756*    END-EXEC
 11757*    MOVE '&"S        E          (  N#00011332' TO DFHEIV0
 11758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11760     MOVE X'204E233030303131333332' TO DFHEIV0(25:11)
 11761     CALL 'kxdfhei1' USING DFHEIV0,
 11762           FILE-ID-ERMAIL,
 11763           DFHEIV20,
 11764           DFHEIV99,
 11765           ERMAIL-KEY,
 11766           DFHEIV99,
 11767           DFHEIV99,
 11768           DFHEIV99
 11769     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 216
* EL6311.cbl
 11770         DFHEIV20
 11771     MOVE EIBRESP  TO WS-RESPONSE
 11772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11773     IF RESP-NORMAL
 11774        SET ERMAIL-FOUND TO TRUE
 11775     END-IF
 11776
 11777     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11778     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11779                                 TO ELCRTO-KEY
 11780     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11781     MOVE +0                     TO ELCRTO-SEQ-NO
 11782
 11783* EXEC CICS READ
 11784*       DATASET   ('ELCRTO')
 11785*       INTO      (ORIGINAL-CERTIFICATE)
 11786*       RIDFLD    (ELCRTO-KEY)
 11787*       GTEQ
 11788*       RESP      (WS-RESPONSE)
 11789*    END-EXEC
 11790     MOVE LENGTH OF
 11791      ORIGINAL-CERTIFICATE
 11792       TO DFHEIV11
 11793     MOVE 'ELCRTO' TO DFHEIV1
 11794*    MOVE '&"IL       G          (  N#00011347' TO DFHEIV0
 11795     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11797     MOVE X'204E233030303131333437' TO DFHEIV0(25:11)
 11798     CALL 'kxdfhei1' USING DFHEIV0,
 11799           DFHEIV1,
 11800           ORIGINAL-CERTIFICATE,
 11801           DFHEIV11,
 11802           ELCRTO-KEY,
 11803           DFHEIV99,
 11804           DFHEIV99,
 11805           DFHEIV99
 11806     MOVE EIBRESP  TO WS-RESPONSE
 11807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11808*    display ' just read gteq ' ws-response
 11809     IF RESP-NORMAL
 11810        AND (OC-CONTROL-PRIMARY (1:33) =
 11811                 PB-CONTROL-BY-ACCOUNT (1:33))
 11812        AND (OC-RECORD-TYPE = 'I')
 11813*       display ' resp norm, key =, type i '
 11814        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11815*          display ' end proc blank '
 11816           display ' csr edit session ' PI-CSR-SESSION-SW
 11817           IF NOT CSR-EDIT-SESSION
 11818
 11819* EXEC CICS READ
 11820*                DATASET   ('ELCRTO')
 11821*                INTO      (ORIGINAL-CERTIFICATE)
 11822*                RIDFLD    (OC-CONTROL-PRIMARY)
 11823*                UPDATE
 11824*                RESP      (WS-RESPONSE)
 11825*             END-EXEC
 11826     MOVE LENGTH OF
 11827      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 217
* EL6311.cbl
 11828       TO DFHEIV11
 11829     MOVE 'ELCRTO' TO DFHEIV1
 11830*    MOVE '&"IL       EU         (  N#00011364' TO DFHEIV0
 11831     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11832     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11833     MOVE X'204E233030303131333634' TO DFHEIV0(25:11)
 11834     CALL 'kxdfhei1' USING DFHEIV0,
 11835           DFHEIV1,
 11836           ORIGINAL-CERTIFICATE,
 11837           DFHEIV11,
 11838           OC-CONTROL-PRIMARY,
 11839           DFHEIV99,
 11840           DFHEIV99,
 11841           DFHEIV99
 11842     MOVE EIBRESP  TO WS-RESPONSE
 11843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11844              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11845              IF RESP-NORMAL
 11846                 display ' good read upd '
 11847                 MOVE PB-I-INSURED-LAST-NAME TO
 11848                         OC-INS-LAST-NAME
 11849                 MOVE PB-I-INSURED-FIRST-NAME TO
 11850                         OC-INS-FIRST-NAME
 11851                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11852                         OC-INS-MIDDLE-INIT
 11853                 MOVE PB-I-AGE         TO OC-INS-AGE
 11854                 MOVE PB-I-JOINT-LAST-NAME   TO
 11855                         OC-JNT-LAST-NAME
 11856                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11857                         OC-JNT-FIRST-NAME
 11858                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11859                         OC-JNT-MIDDLE-INIT
 11860                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11861                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11862                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11863                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11864                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11865                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11866                         OC-LF-ALT-BEN-AMT
 11867                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11868                         OC-LF-ALT-PRM-AMT
 11869                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11870                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11871                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11872                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11873                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11874                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11875                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11876                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11877                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11878                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11879                 IF OC-CANCEL-TRAN-IND = 'N'
 11880                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11881                    MOVE +0            TO OC-LF-CANCEL-AMT
 11882                                          OC-LF-ITD-CANCEL-AMT
 11883                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11884                    MOVE +0            TO OC-AH-CANCEL-AMT
 11885                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 218
* EL6311.cbl
 11886                 END-IF
 11887                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11888                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11889                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11890                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11891                 IF ERMAIL-FOUND
 11892                    MOVE MA-CRED-BENE-NAME
 11893                                 TO OC-CRED-BENE-NAME
 11894                 END-IF
 11895                 IF NOT CERT-TRL-REC-NOT-FOUND
 11896                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11897                           OC-INS-AGE-DEFAULT-FLAG
 11898                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11899                           OC-JNT-AGE-DEFAULT-FLAG
 11900                 END-IF
 11901
 11902* EXEC CICS REWRITE
 11903*                   DATASET   ('ELCRTO')
 11904*                   FROM      (ORIGINAL-CERTIFICATE)
 11905*                   RESP      (WS-RESPONSE)
 11906*                END-EXEC
 11907     MOVE LENGTH OF
 11908      ORIGINAL-CERTIFICATE
 11909       TO DFHEIV11
 11910     MOVE 'ELCRTO' TO DFHEIV1
 11911*    MOVE '&& L                  %  N#00011428' TO DFHEIV0
 11912     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11913     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11914     MOVE X'204E233030303131343238' TO DFHEIV0(25:11)
 11915     CALL 'kxdfhei1' USING DFHEIV0,
 11916           DFHEIV1,
 11917           ORIGINAL-CERTIFICATE,
 11918           DFHEIV11,
 11919           DFHEIV99
 11920     MOVE EIBRESP  TO WS-RESPONSE
 11921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11922                 display ' just rewrote ' ws-response
 11923              END-IF
 11924           END-IF
 11925        ELSE
 11926           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11927           MOVE 'OC'             TO OC-RECORD-ID
 11928           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11929           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11930           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11931           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11932           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11933           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11934           MOVE PB-I-AGE         TO OC-INS-AGE
 11935           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11936           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11937           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11938           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11939           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11940           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11941           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11942           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11943           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 219
* EL6311.cbl
 11944           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11945           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11946           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11947           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11948           MOVE +0               TO OC-LF-CANCEL-AMT
 11949                                    OC-LF-ITD-CANCEL-AMT
 11950           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11951           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11952           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11953           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11954           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11955           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11956           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11957           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11958           MOVE +0               TO OC-AH-CANCEL-AMT
 11959                                    OC-AH-ITD-CANCEL-AMT
 11960           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11961           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11962           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11963           IF ERMAIL-FOUND
 11964              MOVE MA-CRED-BENE-NAME
 11965                                 TO OC-CRED-BENE-NAME
 11966           END-IF
 11967           IF NOT CERT-TRL-REC-NOT-FOUND
 11968              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11969                           OC-INS-AGE-DEFAULT-FLAG
 11970              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11971                           OC-JNT-AGE-DEFAULT-FLAG
 11972           END-IF
 11973           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11974
 11975* EXEC CICS WRITE
 11976*             DATASET   ('ELCRTO')
 11977*             FROM      (ORIGINAL-CERTIFICATE)
 11978*             RIDFLD    (OC-CONTROL-PRIMARY)
 11979*             RESP      (WS-RESPONSE)
 11980*          END-EXEC
 11981     MOVE LENGTH OF
 11982      ORIGINAL-CERTIFICATE
 11983       TO DFHEIV11
 11984     MOVE 'ELCRTO' TO DFHEIV1
 11985*    MOVE '&$ L                  ''  N#00011485' TO DFHEIV0
 11986     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11988     MOVE X'204E233030303131343835' TO DFHEIV0(25:11)
 11989     CALL 'kxdfhei1' USING DFHEIV0,
 11990           DFHEIV1,
 11991           ORIGINAL-CERTIFICATE,
 11992           DFHEIV11,
 11993           OC-CONTROL-PRIMARY,
 11994           DFHEIV99,
 11995           DFHEIV99
 11996     MOVE EIBRESP  TO WS-RESPONSE
 11997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11998        END-IF
 11999     ELSE
 12000        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12001        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 220
* EL6311.cbl
 12002        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12003                                 TO OC-CONTROL-PRIMARY (1:33)
 12004        MOVE 'I'                 TO OC-RECORD-TYPE
 12005        MOVE +4096               TO OC-KEY-SEQ-NO
 12006        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12007        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12008        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12009        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12010        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12011        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12012        MOVE PB-I-AGE            TO OC-INS-AGE
 12013        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12014        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12015        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12016        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12017        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12018        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12019        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12020        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12021        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12022        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12023        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12024        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12025        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12026        MOVE +0                  TO OC-LF-CANCEL-AMT
 12027                                    OC-LF-ITD-CANCEL-AMT
 12028        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12029        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12030        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12031        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12032        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12033        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12034        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12035        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12036        MOVE +0                  TO OC-AH-CANCEL-AMT
 12037                                    OC-AH-ITD-CANCEL-AMT
 12038        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12039        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12040        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12041        IF ERMAIL-FOUND
 12042           MOVE MA-CRED-BENE-NAME
 12043                                 TO OC-CRED-BENE-NAME
 12044        END-IF
 12045        IF NOT CERT-TRL-REC-NOT-FOUND
 12046           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12047                           OC-INS-AGE-DEFAULT-FLAG
 12048           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12049                           OC-JNT-AGE-DEFAULT-FLAG
 12050        END-IF
 12051        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12052
 12053* EXEC CICS WRITE
 12054*          DATASET   ('ELCRTO')
 12055*          FROM      (ORIGINAL-CERTIFICATE)
 12056*          RIDFLD    (OC-CONTROL-PRIMARY)
 12057*          RESP      (WS-RESPONSE)
 12058*       END-EXEC
 12059     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 221
* EL6311.cbl
 12060      ORIGINAL-CERTIFICATE
 12061       TO DFHEIV11
 12062     MOVE 'ELCRTO' TO DFHEIV1
 12063*    MOVE '&$ L                  ''  N#00011545' TO DFHEIV0
 12064     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12065     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12066     MOVE X'204E233030303131353435' TO DFHEIV0(25:11)
 12067     CALL 'kxdfhei1' USING DFHEIV0,
 12068           DFHEIV1,
 12069           ORIGINAL-CERTIFICATE,
 12070           DFHEIV11,
 12071           OC-CONTROL-PRIMARY,
 12072           DFHEIV99,
 12073           DFHEIV99
 12074     MOVE EIBRESP  TO WS-RESPONSE
 12075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12076     END-IF
 12077******************************************************************
 12078*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12079******************************************************************
 12080
 12081     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12082     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12083
 12084
 12085* EXEC CICS READ
 12086*        INTO    (PENDING-BUSINESS)
 12087*        DATASET (FILE-ID-ERPNDB)
 12088*        RIDFLD  (ERPNDB-KEY)
 12089*        UPDATE
 12090*    END-EXEC.
 12091     MOVE LENGTH OF
 12092      PENDING-BUSINESS
 12093       TO DFHEIV11
 12094*    MOVE '&"IL       EU         (   #00011559' TO DFHEIV0
 12095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12097     MOVE X'2020233030303131353539' TO DFHEIV0(25:11)
 12098     CALL 'kxdfhei1' USING DFHEIV0,
 12099           FILE-ID-ERPNDB,
 12100           PENDING-BUSINESS,
 12101           DFHEIV11,
 12102           ERPNDB-KEY,
 12103           DFHEIV99,
 12104           DFHEIV99,
 12105           DFHEIV99
 12106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12107
 12108
 12109     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12110     MOVE 'B'                    TO JP-RECORD-TYPE.
 12111     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12112
 12113     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12114
 12115     PERFORM 8400-LOG-JOURNAL-RECORD.
 12116
 12117     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 222
* EL6311.cbl
 12118
 12119     MOVE 'C'                    TO JP-RECORD-TYPE.
 12120     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12121
 12122
 12123* EXEC CICS REWRITE
 12124*        DATASET    (FILE-ID-ERPNDB)
 12125*        FROM       (PENDING-BUSINESS)
 12126*    END-EXEC.
 12127     MOVE LENGTH OF
 12128      PENDING-BUSINESS
 12129       TO DFHEIV11
 12130*    MOVE '&& L                  %   #00011579' TO DFHEIV0
 12131     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12133     MOVE X'2020233030303131353739' TO DFHEIV0(25:11)
 12134     CALL 'kxdfhei1' USING DFHEIV0,
 12135           FILE-ID-ERPNDB,
 12136           PENDING-BUSINESS,
 12137           DFHEIV11,
 12138           DFHEIV99
 12139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12140
 12141
 12142     PERFORM 8400-LOG-JOURNAL-RECORD.
 12143
 12144     IF WS-ERRORS-PRESENT
 12145        GO TO 3900-RE-DISPLAY-RECORD.
 12146
 12147     MOVE ZEROS                  TO EMI-ERROR.
 12148     MOVE -1                     TO BMAINTL.
 12149     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12150     GO TO 3900-RE-DISPLAY-RECORD.
 12151
 12152 1380-BATCH-HDR-NOT-FOUND.
 12153     MOVE -1                     TO BMAINTL.
 12154     MOVE ER-7450                TO EMI-ERROR.
 12155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12156     GO TO 8200-SEND-DATAONLY.
 12157
 12158 1385-REC-NOT-FOUND.
 12159     MOVE -1                     TO BMAINTL.
 12160     MOVE ER-7451                TO EMI-ERROR.
 12161     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12162     GO TO 8200-SEND-DATAONLY.
 12163
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 223
* EL6311.cbl
 12165
 12166 1386-UPDATE-AGE-FLAGS.
 12167
 12168
 12169* EXEC CICS GETMAIN
 12170*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12171*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12172*        INITIMG (GETMAIN-SPACE)
 12173*    END-EXEC
 12174*    MOVE ',"IL                  $   #00011610' TO DFHEIV0
 12175     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12177     MOVE X'2020233030303131363130' TO DFHEIV0(25:11)
 12178     CALL 'kxdfhei1' USING DFHEIV0,
 12179           DFHEIV20,
 12180           ELCRTT-RECORD-LENGTH,
 12181           GETMAIN-SPACE
 12182     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12183         DFHEIV20
 12184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12185
 12186
 12187* EXEC CICS HANDLE CONDITION
 12188*        NOTFND   (1386-NOTFND)
 12189*    END-EXEC.
 12190*    MOVE '"$I                   ! ( #00011616' TO DFHEIV0
 12191     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12193     MOVE X'2820233030303131363136' TO DFHEIV0(25:11)
 12194     CALL 'kxdfhei1' USING DFHEIV0
 12195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12196
 12197
 12198     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12199     MOVE 'C'                TO ELCRTT-REC-TYPE
 12200
 12201
 12202* EXEC CICS READ
 12203*        UPDATE
 12204*        DATASET  (CRTT-ID)
 12205*        RIDFLD   (ELCRTT-KEY)
 12206*        INTO     (CERTIFICATE-TRAILERS)
 12207*    END-EXEC.
 12208     MOVE LENGTH OF
 12209      CERTIFICATE-TRAILERS
 12210       TO DFHEIV11
 12211*    MOVE '&"IL       EU         (   #00011623' TO DFHEIV0
 12212     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12213     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12214     MOVE X'2020233030303131363233' TO DFHEIV0(25:11)
 12215     CALL 'kxdfhei1' USING DFHEIV0,
 12216           CRTT-ID,
 12217           CERTIFICATE-TRAILERS,
 12218           DFHEIV11,
 12219           ELCRTT-KEY,
 12220           DFHEIV99,
 12221           DFHEIV99,
 12222           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 224
* EL6311.cbl
 12223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12224
 12225
 12226     IF WS-INS-AGE-SET = 'Y'
 12227        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12228     END-IF
 12229     IF WS-JNT-AGE-SET = 'Y'
 12230        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12231     END-IF
 12232
 12233
 12234* EXEC CICS REWRITE
 12235*       DATASET  (CRTT-ID)
 12236*       FROM     (CERTIFICATE-TRAILERS)
 12237*    END-EXEC.
 12238     MOVE LENGTH OF
 12239      CERTIFICATE-TRAILERS
 12240       TO DFHEIV11
 12241*    MOVE '&& L                  %   #00011637' TO DFHEIV0
 12242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12244     MOVE X'2020233030303131363337' TO DFHEIV0(25:11)
 12245     CALL 'kxdfhei1' USING DFHEIV0,
 12246           CRTT-ID,
 12247           CERTIFICATE-TRAILERS,
 12248           DFHEIV11,
 12249           DFHEIV99
 12250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12251
 12252
 12253     GO TO 1386-EXIT.
 12254
 12255 1386-NOTFND.
 12256
 12257     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12258     MOVE 'CS'         TO CS-RECORD-ID.
 12259     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12260     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12261     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12262     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12263     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12264
 12265* EXEC CICS WRITE
 12266*       DATASET  (CRTT-ID)
 12267*       RIDFLD   (ELCRTT-KEY)
 12268*       FROM     (CERTIFICATE-TRAILERS)
 12269*    END-EXEC.
 12270     MOVE LENGTH OF
 12271      CERTIFICATE-TRAILERS
 12272       TO DFHEIV11
 12273*    MOVE '&$ L                  ''   #00011653' TO DFHEIV0
 12274     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12275     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12276     MOVE X'2020233030303131363533' TO DFHEIV0(25:11)
 12277     CALL 'kxdfhei1' USING DFHEIV0,
 12278           CRTT-ID,
 12279           CERTIFICATE-TRAILERS,
 12280           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 225
* EL6311.cbl
 12281           ELCRTT-KEY,
 12282           DFHEIV99,
 12283           DFHEIV99
 12284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12285
 12286
 12287 1386-EXIT.
 12288     EXIT.
 12289
 12290 1390-UPDATE-ERPNDM.
 12291
 12292
 12293* EXEC CICS HANDLE CONDITION
 12294*        NOTFND (1399-EXIT)
 12295*    END-EXEC.
 12296*    MOVE '"$I                   ! ) #00011664' TO DFHEIV0
 12297     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12299     MOVE X'2920233030303131363634' TO DFHEIV0(25:11)
 12300     CALL 'kxdfhei1' USING DFHEIV0
 12301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12302
 12303
 12304     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12305
 12306
 12307* EXEC CICS READ
 12308*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12309*        DATASET (FILE-ID-ERPNDM)
 12310*        RIDFLD  (ERPNDM-KEY)
 12311*        UPDATE
 12312*    END-EXEC.
 12313*    MOVE '&"S        EU         (   #00011670' TO DFHEIV0
 12314     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12315     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12316     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0,
 12318           FILE-ID-ERPNDM,
 12319           DFHEIV20,
 12320           DFHEIV99,
 12321           ERPNDM-KEY,
 12322           DFHEIV99,
 12323           DFHEIV99,
 12324           DFHEIV99
 12325     SET ADDRESS OF PENDING-MAILING-DATA TO
 12326         DFHEIV20
 12327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12328
 12329
 12330     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12331     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12332     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12333
 12334     IF BLSTNML GREATER THAN ZEROS
 12335         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12336
 12337     IF B1STNML GREATER  THAN ZEROS
 12338         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 226
* EL6311.cbl
 12339
 12340     IF BINITL GREATER THAN ZEROS
 12341         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12342
 12343     IF BAGEL GREATER THAN ZEROS
 12344         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12345
 12346     IF BBIRTHL GREATER THAN ZEROS
 12347         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12348
 12349     IF BSEXL GREATER THAN ZEROS
 12350         MOVE  BSEXI             TO PM-INSURED-SEX.
 12351
 12352
 12353* EXEC CICS REWRITE
 12354*        DATASET (FILE-ID-ERPNDM)
 12355*        FROM    (PENDING-MAILING-DATA)
 12356*    END-EXEC.
 12357     MOVE LENGTH OF
 12358      PENDING-MAILING-DATA
 12359       TO DFHEIV11
 12360*    MOVE '&& L                  %   #00011699' TO DFHEIV0
 12361     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12363     MOVE X'2020233030303131363939' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           FILE-ID-ERPNDM,
 12366           PENDING-MAILING-DATA,
 12367           DFHEIV11,
 12368           DFHEIV99
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372 1399-EXIT.
 12373     EXIT.
 12374
 12375******************************************************************
 12376*                                                                *
 12377*          D E L E T E   I S S U E   R O U T I N E               *
 12378*                                                                *
 12379******************************************************************
 12380
 12381 1400-DELETE-ISSUE-ROUTINE.
 12382     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12383
 12384     IF BCHGL NOT = ZEROS
 12385        MOVE ER-2196             TO EMI-ERROR
 12386        MOVE AL-UABON            TO BMAINTA
 12387        MOVE -1                  TO BMAINTL
 12388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12389        GO TO 8200-SEND-DATAONLY.
 12390
 12391
 12392* EXEC CICS HANDLE CONDITION
 12393*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12394*    END-EXEC.
 12395*    MOVE '"$I                   ! * #00011723' TO DFHEIV0
 12396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 227
* EL6311.cbl
 12397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12398     MOVE X'2A20233030303131373233' TO DFHEIV0(25:11)
 12399     CALL 'kxdfhei1' USING DFHEIV0
 12400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12401
 12402
 12403     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12404     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12405     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12406
 12407
 12408* EXEC CICS READ
 12409*        SET     (ADDRESS OF PENDING-BUSINESS)
 12410*        DATASET (FILE-ID-ERPNDB)
 12411*        RIDFLD  (ERPNDB-KEY)
 12412*    END-EXEC.
 12413*    MOVE '&"S        E          (   #00011731' TO DFHEIV0
 12414     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12416     MOVE X'2020233030303131373331' TO DFHEIV0(25:11)
 12417     CALL 'kxdfhei1' USING DFHEIV0,
 12418           FILE-ID-ERPNDB,
 12419           DFHEIV20,
 12420           DFHEIV99,
 12421           ERPNDB-KEY,
 12422           DFHEIV99,
 12423           DFHEIV99,
 12424           DFHEIV99
 12425     SET ADDRESS OF PENDING-BUSINESS TO
 12426         DFHEIV20
 12427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12428
 12429
 12430     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12431
 12432     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12433
 12434     IF BSUFIXL NOT = ZEROS
 12435        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12436     ELSE
 12437        MOVE SPACE               TO WS-NEW-SUFFIX.
 12438
 12439     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12440     PERFORM 8600-DEEDIT.
 12441     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12442     MOVE '4'                    TO DC-OPTION-CODE.
 12443     PERFORM 9700-DATE-LINK.
 12444     IF DATE-CONVERSION-ERROR
 12445        MOVE ER-0348             TO EMI-ERROR
 12446        MOVE -1                  TO BEFFDTL
 12447        MOVE AL-UABON            TO BEFFDTA
 12448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12449        GO TO 8200-SEND-DATAONLY
 12450     ELSE
 12451        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12452        MOVE AL-UANON            TO BEFFDTA
 12453        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12454
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 228
* EL6311.cbl
 12455
 12456* EXEC CICS HANDLE CONDITION
 12457*         NOTFND    (1490-RECORD-NOT-FOUND)
 12458*    END-EXEC.
 12459*    MOVE '"$I                   ! + #00011762' TO DFHEIV0
 12460     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12462     MOVE X'2B20233030303131373632' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0
 12464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12465
 12466
 12467
 12468* EXEC CICS READ
 12469*        SET     (ADDRESS OF PENDING-BUSINESS)
 12470*        DATASET (FILE-ID-ERPNDB)
 12471*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12472*        UPDATE
 12473*    END-EXEC.
 12474*    MOVE '&"S        EU         (   #00011766' TO DFHEIV0
 12475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12476     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303131373636' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           FILE-ID-ERPNDB,
 12480           DFHEIV20,
 12481           DFHEIV99,
 12482           PI-PREV-CONTROL-PRIMARY,
 12483           DFHEIV99,
 12484           DFHEIV99,
 12485           DFHEIV99
 12486     SET ADDRESS OF PENDING-BUSINESS TO
 12487         DFHEIV20
 12488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12489
 12490
 12491     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12492        MOVE -1                 TO BMAINTL
 12493        MOVE ER-2197            TO EMI-ERROR
 12494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12495        GO TO 8200-SEND-DATAONLY.
 12496
 12497     IF PB-BILLED-DT NOT = LOW-VALUES
 12498        MOVE -1                 TO BMAINTL
 12499        MOVE ER-2129            TO EMI-ERROR
 12500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12501        GO TO 8200-SEND-DATAONLY.
 12502
 12503     IF PB-CHG-COUNT NOT = ZEROS
 12504        MOVE ER-2336            TO EMI-ERROR
 12505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12506        MOVE AL-UABON            TO BMAINTA
 12507        MOVE -1                  TO BMAINTL
 12508        GO TO 8200-SEND-DATAONLY.
 12509
 12510     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12511        PB-CHG-COUNT NOT = ZEROS
 12512        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 229
* EL6311.cbl
 12513        MOVE AL-UABON            TO BMAINTA
 12514        MOVE -1                  TO BMAINTL
 12515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12516        GO TO 8200-SEND-DATAONLY.
 12517******************************************************************
 12518*                                                                *
 12519*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12520*                                                                *
 12521******************************************************************
 12522     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12523     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12524     MOVE +0                     TO ELCRTO-SEQ-NO
 12525
 12526* EXEC CICS READ
 12527*       DATASET   ('ELCRTO')
 12528*       INTO      (ORIGINAL-CERTIFICATE)
 12529*       RIDFLD    (ELCRTO-KEY)
 12530*       GTEQ
 12531*       RESP      (WS-RESPONSE)
 12532*    END-EXEC
 12533     MOVE LENGTH OF
 12534      ORIGINAL-CERTIFICATE
 12535       TO DFHEIV11
 12536     MOVE 'ELCRTO' TO DFHEIV1
 12537*    MOVE '&"IL       G          (  N#00011807' TO DFHEIV0
 12538     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12540     MOVE X'204E233030303131383037' TO DFHEIV0(25:11)
 12541     CALL 'kxdfhei1' USING DFHEIV0,
 12542           DFHEIV1,
 12543           ORIGINAL-CERTIFICATE,
 12544           DFHEIV11,
 12545           ELCRTO-KEY,
 12546           DFHEIV99,
 12547           DFHEIV99,
 12548           DFHEIV99
 12549     MOVE EIBRESP  TO WS-RESPONSE
 12550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12551     IF RESP-NORMAL
 12552        AND (OC-CONTROL-PRIMARY (1:33) =
 12553                 PB-CONTROL-BY-ACCOUNT (1:33))
 12554        AND (OC-RECORD-TYPE = 'I')
 12555
 12556* EXEC CICS READ
 12557*          DATASET   ('ELCRTO')
 12558*          INTO      (ORIGINAL-CERTIFICATE)
 12559*          RIDFLD    (ELCRTO-KEY)
 12560*          UPDATE
 12561*          RESP      (WS-RESPONSE)
 12562*       END-EXEC
 12563     MOVE LENGTH OF
 12564      ORIGINAL-CERTIFICATE
 12565       TO DFHEIV11
 12566     MOVE 'ELCRTO' TO DFHEIV1
 12567*    MOVE '&"IL       EU         (  N#00011818' TO DFHEIV0
 12568     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12570     MOVE X'204E233030303131383138' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 230
* EL6311.cbl
 12571     CALL 'kxdfhei1' USING DFHEIV0,
 12572           DFHEIV1,
 12573           ORIGINAL-CERTIFICATE,
 12574           DFHEIV11,
 12575           ELCRTO-KEY,
 12576           DFHEIV99,
 12577           DFHEIV99,
 12578           DFHEIV99
 12579     MOVE EIBRESP  TO WS-RESPONSE
 12580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12581        IF RESP-NORMAL
 12582
 12583* EXEC CICS DELETE
 12584*             DATASET   ('ELCRTO')
 12585*          END-EXEC
 12586     MOVE 'ELCRTO' TO DFHEIV1
 12587*    MOVE '&(                    &   #00011826' TO DFHEIV0
 12588     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12589     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12590     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 12591     CALL 'kxdfhei1' USING DFHEIV0,
 12592           DFHEIV1,
 12593           DFHEIV99,
 12594           DFHEIV99,
 12595           DFHEIV99,
 12596           DFHEIV99
 12597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12598        END-IF
 12599     END-IF
 12600******************************************************************
 12601*                                                                *
 12602*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12603*                                                                *
 12604******************************************************************
 12605
 12606* EXEC CICS HANDLE CONDITION
 12607*        NOTFND    (1405-DELETE-CERTIFICATE)
 12608*    END-EXEC.
 12609*    MOVE '"$I                   ! , #00011836' TO DFHEIV0
 12610     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12612     MOVE X'2C20233030303131383336' TO DFHEIV0(25:11)
 12613     CALL 'kxdfhei1' USING DFHEIV0
 12614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12615
 12616
 12617
 12618* EXEC CICS READ
 12619*        EQUAL
 12620*        DATASET   (FILE-ID-ERPNDM)
 12621*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12622*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12623*        UPDATE
 12624*    END-EXEC.
 12625*    MOVE '&"S        EU         (   #00011840' TO DFHEIV0
 12626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12628     MOVE X'2020233030303131383430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 231
* EL6311.cbl
 12629     CALL 'kxdfhei1' USING DFHEIV0,
 12630           FILE-ID-ERPNDM,
 12631           DFHEIV20,
 12632           DFHEIV99,
 12633           PI-PREV-CONTROL-PRIMARY,
 12634           DFHEIV99,
 12635           DFHEIV99,
 12636           DFHEIV99
 12637     SET ADDRESS OF PENDING-MAILING-DATA TO
 12638         DFHEIV20
 12639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12640
 12641
 12642     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12643     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12644     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12645
 12646     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12647
 12648
 12649* EXEC CICS DELETE
 12650*        DATASET   (FILE-ID-ERPNDM)
 12651*    END-EXEC.
 12652*    MOVE '&(                    &   #00011854' TO DFHEIV0
 12653     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12655     MOVE X'2020233030303131383534' TO DFHEIV0(25:11)
 12656     CALL 'kxdfhei1' USING DFHEIV0,
 12657           FILE-ID-ERPNDM,
 12658           DFHEIV99,
 12659           DFHEIV99,
 12660           DFHEIV99,
 12661           DFHEIV99
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665******************************************************************
 12666*                PROCESS   CERTIFICATE                           *
 12667******************************************************************
 12668
 12669 1405-DELETE-CERTIFICATE.
 12670
 12671* EXEC CICS HANDLE CONDITION
 12672*         NOTFND  (1420-CONTINUE-DELETE)
 12673*    END-EXEC.
 12674*    MOVE '"$I                   ! - #00011863' TO DFHEIV0
 12675     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12677     MOVE X'2D20233030303131383633' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12683     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12684     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12685     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12686
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 232
* EL6311.cbl
 12687
 12688* EXEC CICS READ
 12689*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12690*        DATASET (FILE-ID-ELCERT)
 12691*        RIDFLD  (ELCERT-KEY)
 12692*        UPDATE
 12693*    END-EXEC.
 12694*    MOVE '&"S        EU         (   #00011872' TO DFHEIV0
 12695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12696     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12697     MOVE X'2020233030303131383732' TO DFHEIV0(25:11)
 12698     CALL 'kxdfhei1' USING DFHEIV0,
 12699           FILE-ID-ELCERT,
 12700           DFHEIV20,
 12701           DFHEIV99,
 12702           ELCERT-KEY,
 12703           DFHEIV99,
 12704           DFHEIV99,
 12705           DFHEIV99
 12706     SET ADDRESS OF CERTIFICATE-MASTER TO
 12707         DFHEIV20
 12708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12709
 12710
 12711     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12712
 12713     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12714     MOVE 'B'                    TO JP-RECORD-TYPE
 12715     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12716
 12717     PERFORM 8400-LOG-JOURNAL-RECORD.
 12718
 12719     IF CERT-NOTES-ARE-NOT-PRESENT
 12720        MOVE ' '                 TO WS-CERT-NOTE-SW
 12721     ELSE
 12722        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12723
 12724     IF INSURED-ADDR-PRESENT
 12725        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12726
 12727******************************************************************
 12728******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12729******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12730******************************************************************
 12731******************************************************************
 12732
 12733     IF CERT-ADDED-BATCH AND
 12734        (NOT NO-CLAIM-ATTACHED
 12735         OR
 12736         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12737        GO TO 1410-REWRITE-CERT.
 12738
 12739******************************************************************
 12740******************************************************************
 12741
 12742     IF CERT-ADDED-BATCH  AND
 12743        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12744        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 233
* EL6311.cbl
 12745
 12746     IF NO-CLAIM-ATTACHED
 12747        NEXT SENTENCE
 12748     ELSE
 12749        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12750        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12751        GO TO 1410-REWRITE-CERT.
 12752
 12753     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12754     MOVE 'D'                      TO JP-RECORD-TYPE.
 12755     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12756
 12757
 12758* EXEC CICS DELETE
 12759*         DATASET    (FILE-ID-ELCERT)
 12760*    END-EXEC.
 12761*    MOVE '&(                    &   #00011925' TO DFHEIV0
 12762     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12763     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12764     MOVE X'2020233030303131393235' TO DFHEIV0(25:11)
 12765     CALL 'kxdfhei1' USING DFHEIV0,
 12766           FILE-ID-ELCERT,
 12767           DFHEIV99,
 12768           DFHEIV99,
 12769           DFHEIV99,
 12770           DFHEIV99
 12771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12772
 12773
 12774     PERFORM 8400-LOG-JOURNAL-RECORD.
 12775
 12776******************************************************************
 12777*                                                                *
 12778*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12779*                                                                *
 12780******************************************************************
 12781
 12782     IF  CERT-NOTES-ARE-PRESENT
 12783         NEXT SENTENCE
 12784     ELSE
 12785         GO TO 1407-DELETE-MAILING.
 12786
 12787
 12788* EXEC CICS HANDLE CONDITION
 12789*         NOTFND  (1406-DELETE-ERNOTE)
 12790*    END-EXEC.
 12791*    MOVE '"$I                   ! . #00011942' TO DFHEIV0
 12792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12794     MOVE X'2E20233030303131393432' TO DFHEIV0(25:11)
 12795     CALL 'kxdfhei1' USING DFHEIV0
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12800     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12801     MOVE 0                     TO ERCNOT-SEQUENCE.
 12802
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 234
* EL6311.cbl
 12803 1406-DELETE-ERCNOT-LOOP.
 12804
 12805
 12806* EXEC CICS READ
 12807*        GTEQ
 12808*        DATASET   (FILE-ID-ERCNOT)
 12809*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12810*        RIDFLD    (ERCNOT-KEY)
 12811*    END-EXEC.
 12812*    MOVE '&"S        G          (   #00011952' TO DFHEIV0
 12813     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12815     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
 12816     CALL 'kxdfhei1' USING DFHEIV0,
 12817           FILE-ID-ERCNOT,
 12818           DFHEIV20,
 12819           DFHEIV99,
 12820           ERCNOT-KEY,
 12821           DFHEIV99,
 12822           DFHEIV99,
 12823           DFHEIV99
 12824     SET ADDRESS OF CERT-NOTE-FILE TO
 12825         DFHEIV20
 12826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12827
 12828
 12829     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12830     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12831         GO TO 1406-DELETE-ERNOTE
 12832     END-IF.
 12833
 12834     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12835     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12836     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12837
 12838     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12839
 12840
 12841* EXEC CICS DELETE
 12842*        DATASET   (FILE-ID-ERCNOT)
 12843*        RIDFLD    (ERCNOT-KEY)
 12844*        END-EXEC.
 12845*    MOVE '&(  R                 &   #00011970' TO DFHEIV0
 12846     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12847     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12848     MOVE X'2020233030303131393730' TO DFHEIV0(25:11)
 12849     CALL 'kxdfhei1' USING DFHEIV0,
 12850           FILE-ID-ERCNOT,
 12851           ERCNOT-KEY,
 12852           DFHEIV99,
 12853           DFHEIV99,
 12854           DFHEIV99
 12855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12856
 12857
 12858     PERFORM 8400-LOG-JOURNAL-RECORD.
 12859
 12860     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 235
* EL6311.cbl
 12861
 12862 1406-DELETE-ERNOTE.
 12863
 12864
 12865* EXEC CICS HANDLE CONDITION
 12866*         NOTFND  (1407-DELETE-MAILING)
 12867*    END-EXEC.
 12868*    MOVE '"$I                   ! / #00011981' TO DFHEIV0
 12869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12871     MOVE X'2F20233030303131393831' TO DFHEIV0(25:11)
 12872     CALL 'kxdfhei1' USING DFHEIV0
 12873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12874
 12875
 12876
 12877* EXEC CICS READ
 12878*        EQUAL
 12879*        DATASET   (FILE-ID-ERNOTE)
 12880*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12881*        RIDFLD    (ELCERT-KEY)
 12882*        UPDATE
 12883*    END-EXEC.
 12884*    MOVE '&"S        EU         (   #00011985' TO DFHEIV0
 12885     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12886     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12887     MOVE X'2020233030303131393835' TO DFHEIV0(25:11)
 12888     CALL 'kxdfhei1' USING DFHEIV0,
 12889           FILE-ID-ERNOTE,
 12890           DFHEIV20,
 12891           DFHEIV99,
 12892           ELCERT-KEY,
 12893           DFHEIV99,
 12894           DFHEIV99,
 12895           DFHEIV99
 12896     SET ADDRESS OF CERTIFICATE-NOTE TO
 12897         DFHEIV20
 12898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12899
 12900
 12901     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12902     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12903     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12904
 12905     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12906
 12907
 12908* EXEC CICS DELETE
 12909*        DATASET   (FILE-ID-ERNOTE)
 12910*        END-EXEC.
 12911*    MOVE '&(                    &   #00011999' TO DFHEIV0
 12912     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12914     MOVE X'2020233030303131393939' TO DFHEIV0(25:11)
 12915     CALL 'kxdfhei1' USING DFHEIV0,
 12916           FILE-ID-ERNOTE,
 12917           DFHEIV99,
 12918           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 236
* EL6311.cbl
 12919           DFHEIV99,
 12920           DFHEIV99
 12921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12922
 12923
 12924     PERFORM 8400-LOG-JOURNAL-RECORD.
 12925
 12926******************************************************************
 12927*                                                                *
 12928*                DELETE MAILING ADDRESS RECORDS                  *
 12929*                                                                *
 12930******************************************************************
 12931
 12932 1407-DELETE-MAILING.
 12933     IF CERT-ADDRESS-PRESENT
 12934        NEXT SENTENCE
 12935     ELSE
 12936        GO TO 1420-CONTINUE-DELETE.
 12937
 12938
 12939* EXEC CICS HANDLE CONDITION
 12940*         NOTFND  (1420-CONTINUE-DELETE)
 12941*    END-EXEC.
 12942*    MOVE '"$I                   ! 0 #00012017' TO DFHEIV0
 12943     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12945     MOVE X'3020233030303132303137' TO DFHEIV0(25:11)
 12946     CALL 'kxdfhei1' USING DFHEIV0
 12947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12948
 12949
 12950
 12951* EXEC CICS READ
 12952*        EQUAL
 12953*        DATASET   (FILE-ID-ERMAIL)
 12954*        SET       (ADDRESS OF MAILING-DATA)
 12955*        RIDFLD    (ELCERT-KEY)
 12956*        UPDATE
 12957*    END-EXEC.
 12958*    MOVE '&"S        EU         (   #00012021' TO DFHEIV0
 12959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12961     MOVE X'2020233030303132303231' TO DFHEIV0(25:11)
 12962     CALL 'kxdfhei1' USING DFHEIV0,
 12963           FILE-ID-ERMAIL,
 12964           DFHEIV20,
 12965           DFHEIV99,
 12966           ELCERT-KEY,
 12967           DFHEIV99,
 12968           DFHEIV99,
 12969           DFHEIV99
 12970     SET ADDRESS OF MAILING-DATA TO
 12971         DFHEIV20
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12973
 12974
 12975     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12976     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 237
* EL6311.cbl
 12977     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12978
 12979     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12980
 12981
 12982* EXEC CICS DELETE
 12983*        DATASET   (FILE-ID-ERMAIL)
 12984*    END-EXEC.
 12985*    MOVE '&(                    &   #00012035' TO DFHEIV0
 12986     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303132303335' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           FILE-ID-ERMAIL,
 12991           DFHEIV99,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12996
 12997
 12998     GO TO 1420-CONTINUE-DELETE.
 12999
 13000 1410-REWRITE-CERT.
 13001     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13002     MOVE 'C'                      TO JP-RECORD-TYPE.
 13003     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13004     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13005
 13006
 13007* EXEC CICS REWRITE
 13008*         DATASET    (FILE-ID-ELCERT)
 13009*         FROM       (CERTIFICATE-MASTER)
 13010*         END-EXEC.
 13011     MOVE LENGTH OF
 13012      CERTIFICATE-MASTER
 13013       TO DFHEIV11
 13014*    MOVE '&& L                  %   #00012047' TO DFHEIV0
 13015     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13017     MOVE X'2020233030303132303437' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0,
 13019           FILE-ID-ELCERT,
 13020           CERTIFICATE-MASTER,
 13021           DFHEIV11,
 13022           DFHEIV99
 13023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13024
 13025
 13026     PERFORM 8400-LOG-JOURNAL-RECORD.
 13027
 13028 1420-CONTINUE-DELETE.
 13029     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13030     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13031
 13032     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13033     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13034
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 238
* EL6311.cbl
 13035     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13036
 13037 1450-DELETE-PB-RECORD.
 13038     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13039     MOVE 'D'                      TO JP-RECORD-TYPE
 13040     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13041
 13042
 13043* EXEC CICS DELETE
 13044*        DATASET    (FILE-ID-ERPNDB)
 13045*    END-EXEC.
 13046*    MOVE '&(                    &   #00012068' TO DFHEIV0
 13047     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13049     MOVE X'2020233030303132303638' TO DFHEIV0(25:11)
 13050     CALL 'kxdfhei1' USING DFHEIV0,
 13051           FILE-ID-ERPNDB,
 13052           DFHEIV99,
 13053           DFHEIV99,
 13054           DFHEIV99,
 13055           DFHEIV99
 13056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13057
 13058
 13059     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13060
 13061     PERFORM 8400-LOG-JOURNAL-RECORD.
 13062
 13063     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13064     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13065     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13066
 13067
 13068* EXEC CICS HANDLE CONDITION
 13069*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13070*    END-EXEC.
 13071*    MOVE '"$I                   ! 1 #00012080' TO DFHEIV0
 13072     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13074     MOVE X'3120233030303132303830' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0
 13076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13077
 13078
 13079
 13080* EXEC CICS READ
 13081*        SET     (ADDRESS OF PENDING-BUSINESS)
 13082*        DATASET (FILE-ID-ERPNDB)
 13083*        RIDFLD  (ERPNDB-KEY)
 13084*        UPDATE
 13085*    END-EXEC.
 13086*    MOVE '&"S        EU         (   #00012084' TO DFHEIV0
 13087     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13088     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13089     MOVE X'2020233030303132303834' TO DFHEIV0(25:11)
 13090     CALL 'kxdfhei1' USING DFHEIV0,
 13091           FILE-ID-ERPNDB,
 13092           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 239
* EL6311.cbl
 13093           DFHEIV99,
 13094           ERPNDB-KEY,
 13095           DFHEIV99,
 13096           DFHEIV99,
 13097           DFHEIV99
 13098     SET ADDRESS OF PENDING-BUSINESS TO
 13099         DFHEIV20
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13101
 13102
 13103     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13104
 13105     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13106
 13107     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13108        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13109        MOVE 'D'                   TO JP-RECORD-TYPE
 13110        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13111
 13112* EXEC CICS DELETE
 13113*            DATASET    (FILE-ID-ERPNDB)
 13114*       END-EXEC
 13115*    MOVE '&(                    &   #00012099' TO DFHEIV0
 13116     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13117     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13118     MOVE X'2020233030303132303939' TO DFHEIV0(25:11)
 13119     CALL 'kxdfhei1' USING DFHEIV0,
 13120           FILE-ID-ERPNDB,
 13121           DFHEIV99,
 13122           DFHEIV99,
 13123           DFHEIV99,
 13124           DFHEIV99
 13125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13126        PERFORM 8400-LOG-JOURNAL-RECORD
 13127     ELSE
 13128        MOVE 'B'                 TO JP-RECORD-TYPE
 13129        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13130        PERFORM 8400-LOG-JOURNAL-RECORD
 13131        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13132        MOVE 'C'                 TO JP-RECORD-TYPE
 13133        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13134
 13135* EXEC CICS REWRITE
 13136*            DATASET    (FILE-ID-ERPNDB)
 13137*            FROM       (PENDING-BUSINESS)
 13138*       END-EXEC
 13139     MOVE LENGTH OF
 13140      PENDING-BUSINESS
 13141       TO DFHEIV11
 13142*    MOVE '&& L                  %   #00012110' TO DFHEIV0
 13143     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13144     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13145     MOVE X'2020233030303132313130' TO DFHEIV0(25:11)
 13146     CALL 'kxdfhei1' USING DFHEIV0,
 13147           FILE-ID-ERPNDB,
 13148           PENDING-BUSINESS,
 13149           DFHEIV11,
 13150           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 240
* EL6311.cbl
 13151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13152        PERFORM 8400-LOG-JOURNAL-RECORD.
 13153
 13154******************************************************************
 13155*                                                                *
 13156*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13157*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13158*                                                                *
 13159******************************************************************
 13160
 13161     IF NOT PI-AR-PROCESSING
 13162        GO TO 1475-DELETE-FINISHED.
 13163
 13164     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13165        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13166        NEXT SENTENCE
 13167     ELSE
 13168        GO TO 1475-DELETE-FINISHED.
 13169
 13170
 13171* EXEC CICS HANDLE CONDITION
 13172*         NOTFND    (1475-DELETE-FINISHED)
 13173*         END-EXEC.
 13174*    MOVE '"$I                   ! 2 #00012132' TO DFHEIV0
 13175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13177     MOVE X'3220233030303132313332' TO DFHEIV0(25:11)
 13178     CALL 'kxdfhei1' USING DFHEIV0
 13179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13180
 13181
 13182     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13183     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13184
 13185
 13186* EXEC CICS READ
 13187*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13188*        DATASET (FILE-ID-ERRQST)
 13189*        RIDFLD  (ERRQST-KEY)
 13190*        UPDATE
 13191*    END-EXEC.
 13192*    MOVE '&"S        EU         (   #00012139' TO DFHEIV0
 13193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13195     MOVE X'2020233030303132313339' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           FILE-ID-ERRQST,
 13198           DFHEIV20,
 13199           DFHEIV99,
 13200           ERRQST-KEY,
 13201           DFHEIV99,
 13202           DFHEIV99,
 13203           DFHEIV99
 13204     SET ADDRESS OF AR-REQUEST-RECORD TO
 13205         DFHEIV20
 13206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13207
 13208
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 241
* EL6311.cbl
 13209     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13210
 13211     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13212
 13213     MOVE 'D'                      TO JP-RECORD-TYPE.
 13214     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13215
 13216
 13217* EXEC CICS DELETE
 13218*         DATASET    (FILE-ID-ERRQST)
 13219*    END-EXEC.
 13220*    MOVE '&(                    &   #00012153' TO DFHEIV0
 13221     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13223     MOVE X'2020233030303132313533' TO DFHEIV0(25:11)
 13224     CALL 'kxdfhei1' USING DFHEIV0,
 13225           FILE-ID-ERRQST,
 13226           DFHEIV99,
 13227           DFHEIV99,
 13228           DFHEIV99,
 13229           DFHEIV99
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13231
 13232
 13233     PERFORM 8400-LOG-JOURNAL-RECORD.
 13234
 13235 1475-DELETE-FINISHED.
 13236     MOVE ZEROS                  TO EMI-ERROR.
 13237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13238     MOVE LOW-VALUES             TO EL631BI.
 13239     MOVE -1                     TO BMAINTL.
 13240     GO TO 8100-SEND-INITIAL-MAP.
 13241
 13242 1480-BATCH-HDR-NOT-FOUND.
 13243     MOVE -1                     TO BMAINTL.
 13244     MOVE ER-7450                TO EMI-ERROR.
 13245     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13246     GO TO 8200-SEND-DATAONLY.
 13247
 13248 1490-RECORD-NOT-FOUND.
 13249     MOVE -1                     TO BMAINTL.
 13250     MOVE ER-7451                TO EMI-ERROR.
 13251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13252     GO TO 8200-SEND-DATAONLY.
 13253
 13254******************************************************************
 13255*            O V E R   C H A R G E   P R O C E S S I N G         *
 13256******************************************************************
 13257 1500-UPDATE-ERNOTE.
 13258     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13259     MOVE 'A'                    TO WS-NOTE-SW
 13260     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13261     .
 13262 1500-EXIT.
 13263     EXIT.
 13264 1510-ADD-ERNOTE-REC.
 13265
 13266* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 242
* EL6311.cbl
 13267*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13268*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13269*        INITIMG (GETMAIN-SPACE)
 13270*    END-EXEC
 13271*    MOVE ',"IL                  $   #00012189' TO DFHEIV0
 13272     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13274     MOVE X'2020233030303132313839' TO DFHEIV0(25:11)
 13275     CALL 'kxdfhei1' USING DFHEIV0,
 13276           DFHEIV20,
 13277           ERNOTE-RECORD-LENGTH,
 13278           GETMAIN-SPACE
 13279     SET ADDRESS OF CERTIFICATE-NOTE TO
 13280         DFHEIV20
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13282     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13283                                 TO ERNOTE-KEY
 13284
 13285* EXEC CICS READ
 13286*       DATASET    (FILE-ID-ERNOTE)
 13287*       RIDFLD     (ERNOTE-KEY)
 13288*       INTO       (CERTIFICATE-NOTE)
 13289*       RESP       (WS-RESPONSE)
 13290*       UPDATE
 13291*    END-EXEC
 13292     MOVE LENGTH OF
 13293      CERTIFICATE-NOTE
 13294       TO DFHEIV11
 13295*    MOVE '&"IL       EU         (  N#00012196' TO DFHEIV0
 13296     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13297     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13298     MOVE X'204E233030303132313936' TO DFHEIV0(25:11)
 13299     CALL 'kxdfhei1' USING DFHEIV0,
 13300           FILE-ID-ERNOTE,
 13301           CERTIFICATE-NOTE,
 13302           DFHEIV11,
 13303           ERNOTE-KEY,
 13304           DFHEIV99,
 13305           DFHEIV99,
 13306           DFHEIV99
 13307     MOVE EIBRESP  TO WS-RESPONSE
 13308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13309     IF RESP-NORMAL
 13310        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13311           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13312        END-IF
 13313        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13314           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13315        END-IF
 13316        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13317           (N1 > +10)
 13318           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13319           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13320        END-PERFORM
 13321        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13322          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13323
 13324* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 243
* EL6311.cbl
 13325*            DATASET    (FILE-ID-ERNOTE)
 13326*          END-EXEC
 13327*    MOVE '&*                    #   #00012217' TO DFHEIV0
 13328     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13329     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13330     MOVE X'2020233030303132323137' TO DFHEIV0(25:11)
 13331     CALL 'kxdfhei1' USING DFHEIV0,
 13332           FILE-ID-ERNOTE,
 13333           DFHEIV99
 13334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13335        ELSE
 13336          PERFORM VARYING N1 FROM +1 BY +1
 13337           UNTIL (N1 > +10)
 13338           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13339          END-PERFORM
 13340          IF (N1 < +11)
 13341            IF N1 >= CN-BILLING-START-LINE-NO AND
 13342              N1 <= CN-BILLING-END-LINE-NO
 13343              IF PI-COMPANY-ID = 'DCC'
 13344                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13345              ELSE
 13346                 MOVE WS-VA-NO-COMM-MESS
 13347                                    TO CN-LINE (N1)
 13348              END-IF
 13349            ELSE
 13350              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13351               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13352                IF PI-COMPANY-ID = 'DCC'
 13353                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13354                ELSE
 13355                  MOVE WS-VA-NO-COMM-MESS
 13356                                    TO CN-LINE (N1)
 13357                END-IF
 13358                MOVE N1             TO CN-BILLING-END-LINE-NO
 13359              ELSE
 13360                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13361                  IF PI-COMPANY-ID = 'DCC'
 13362                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13363                  ELSE
 13364                     MOVE WS-VA-NO-COMM-MESS
 13365                                    TO CN-LINE (N1)
 13366                  END-IF
 13367                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13368                                      CN-BILLING-START-LINE-NO
 13369                ELSE
 13370                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13371                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13372                     IF PI-COMPANY-ID = 'DCC'
 13373                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13374                     ELSE
 13375                       MOVE WS-VA-NO-COMM-MESS
 13376                                    TO CN-LINE (N1)
 13377                     END-IF
 13378                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13379                  ELSE
 13380                     PERFORM 1700-SQUEEZE-IT-IN
 13381                                 THRU 1700-EXIT
 13382                  END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 244
* EL6311.cbl
 13383                END-IF
 13384              END-IF
 13385            END-IF
 13386            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13387            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13388            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13389
 13390* EXEC CICS REWRITE
 13391*              DATASET    (FILE-ID-ERNOTE)
 13392*              FROM       (CERTIFICATE-NOTE)
 13393*              RESP       (WS-RESPONSE)
 13394*           END-EXEC
 13395     MOVE LENGTH OF
 13396      CERTIFICATE-NOTE
 13397       TO DFHEIV11
 13398*    MOVE '&& L                  %  N#00012274' TO DFHEIV0
 13399     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13400     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13401     MOVE X'204E233030303132323734' TO DFHEIV0(25:11)
 13402     CALL 'kxdfhei1' USING DFHEIV0,
 13403           FILE-ID-ERNOTE,
 13404           CERTIFICATE-NOTE,
 13405           DFHEIV11,
 13406           DFHEIV99
 13407     MOVE EIBRESP  TO WS-RESPONSE
 13408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13409          END-IF
 13410        END-IF
 13411     ELSE
 13412        MOVE SPACES              TO CERTIFICATE-NOTE
 13413        MOVE 'CN'                TO CN-RECORD-ID
 13414        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13415                                 TO CN-CONTROL-PRIMARY
 13416                                    ERNOTE-KEY
 13417        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13418                                    CN-BILLING-END-LINE-NO
 13419        IF PI-COMPANY-ID = 'DCC'
 13420           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13421        ELSE
 13422           MOVE WS-VA-NO-COMM-MESS
 13423                                 TO CN-LINE (1)
 13424        END-IF
 13425        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13426        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13427        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13428
 13429* EXEC CICS WRITE
 13430*          DATASET    (FILE-ID-ERNOTE)
 13431*          FROM       (CERTIFICATE-NOTE)
 13432*          RIDFLD     (ERNOTE-KEY)
 13433*          RESP       (WS-RESPONSE)
 13434*       END-EXEC
 13435     MOVE LENGTH OF
 13436      CERTIFICATE-NOTE
 13437       TO DFHEIV11
 13438*    MOVE '&$ L                  ''  N#00012298' TO DFHEIV0
 13439     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13440     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 245
* EL6311.cbl
 13441     MOVE X'204E233030303132323938' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           FILE-ID-ERNOTE,
 13444           CERTIFICATE-NOTE,
 13445           DFHEIV11,
 13446           ERNOTE-KEY,
 13447           DFHEIV99,
 13448           DFHEIV99
 13449     MOVE EIBRESP  TO WS-RESPONSE
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13451     END-IF
 13452     .
 13453 1510-EXIT.
 13454     EXIT.
 13455 1520-UPDATE-ELCERT.
 13456     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13457                                 TO ELCERT-KEY
 13458
 13459* EXEC CICS READ
 13460*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13461*        DATASET (FILE-ID-ELCERT)
 13462*        RIDFLD  (ELCERT-KEY)
 13463*        UPDATE
 13464*        RESP    (WS-RESPONSE)
 13465*    END-EXEC
 13466*    MOVE '&"S        EU         (  N#00012311' TO DFHEIV0
 13467     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13469     MOVE X'204E233030303132333131' TO DFHEIV0(25:11)
 13470     CALL 'kxdfhei1' USING DFHEIV0,
 13471           FILE-ID-ELCERT,
 13472           DFHEIV20,
 13473           DFHEIV99,
 13474           ELCERT-KEY,
 13475           DFHEIV99,
 13476           DFHEIV99,
 13477           DFHEIV99
 13478     SET ADDRESS OF CERTIFICATE-MASTER TO
 13479         DFHEIV20
 13480     MOVE EIBRESP  TO WS-RESPONSE
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13482     IF RESP-NORMAL
 13483        IF WS-NOTE-SW = 'A'
 13484           IF CM-NOTE-SW = ' '
 13485              MOVE '2'             TO CM-NOTE-SW
 13486           ELSE
 13487             IF CM-NOTE-SW = '1'
 13488                MOVE '3'           TO CM-NOTE-SW
 13489             ELSE
 13490               IF CM-NOTE-SW = '4'
 13491                  MOVE '6'         TO CM-NOTE-SW
 13492               ELSE
 13493                 IF CM-NOTE-SW = '5'
 13494                    MOVE '7'       TO CM-NOTE-SW
 13495                 END-IF
 13496               END-IF
 13497             END-IF
 13498           END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 246
* EL6311.cbl
 13499        ELSE
 13500           IF CM-NOTE-SW = '2'
 13501              MOVE ' '             TO CM-NOTE-SW
 13502           ELSE
 13503             IF CM-NOTE-SW = '3'
 13504                MOVE '1'           TO CM-NOTE-SW
 13505             ELSE
 13506               IF CM-NOTE-SW = '6'
 13507                  MOVE '4'         TO CM-NOTE-SW
 13508               ELSE
 13509                 IF CM-NOTE-SW = '7'
 13510                    MOVE '5'       TO CM-NOTE-SW
 13511                 END-IF
 13512               END-IF
 13513             END-IF
 13514           END-IF
 13515        END-IF
 13516
 13517* EXEC CICS REWRITE
 13518*          DATASET    (FILE-ID-ELCERT)
 13519*          FROM       (CERTIFICATE-MASTER)
 13520*          RESP       (WS-RESPONSE)
 13521*       END-EXEC
 13522     MOVE LENGTH OF
 13523      CERTIFICATE-MASTER
 13524       TO DFHEIV11
 13525*    MOVE '&& L                  %  N#00012352' TO DFHEIV0
 13526     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13527     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13528     MOVE X'204E233030303132333532' TO DFHEIV0(25:11)
 13529     CALL 'kxdfhei1' USING DFHEIV0,
 13530           FILE-ID-ELCERT,
 13531           CERTIFICATE-MASTER,
 13532           DFHEIV11,
 13533           DFHEIV99
 13534     MOVE EIBRESP  TO WS-RESPONSE
 13535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13536        IF RESP-NORMAL
 13537           CONTINUE
 13538        ELSE
 13539           MOVE WS-RESPONSE TO EMI-ERROR
 13540           PERFORM 9900-ERROR-FORMAT
 13541                                 THRU 9900-EXIT
 13542           GO TO 8200-SEND-DATAONLY
 13543        END-IF
 13544     ELSE
 13545        MOVE -1                  TO BMAINTL
 13546        MOVE 0249                TO EMI-ERROR
 13547        PERFORM 9900-ERROR-FORMAT
 13548                                 THRU 9900-EXIT
 13549        GO TO 8200-SEND-DATAONLY
 13550     END-IF
 13551     .
 13552 1520-EXIT.
 13553     EXIT.
 13554 1600-UPDATE-ERPYAJ.
 13555     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13556                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 247
* EL6311.cbl
 13557     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13558                                 THRU 1620-EXIT
 13559     .
 13560 1600-EXIT.
 13561     EXIT.
 13562 1610-ADD-ERPYAJ-BANK-REC.
 13563
 13564* EXEC CICS GETMAIN
 13565*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13566*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13567*        INITIMG (GETMAIN-SPACE)
 13568*    END-EXEC
 13569*    MOVE ',"IL                  $   #00012384' TO DFHEIV0
 13570     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13571     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13572     MOVE X'2020233030303132333834' TO DFHEIV0(25:11)
 13573     CALL 'kxdfhei1' USING DFHEIV0,
 13574           DFHEIV20,
 13575           ERPYAJ-RECORD-LENGTH,
 13576           GETMAIN-SPACE
 13577     SET ADDRESS OF PENDING-PAY-ADJ TO
 13578         DFHEIV20
 13579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13580     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13581     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13582     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13583     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13584     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13585     MOVE +10                    TO ERPYAJ-SEQ-NO
 13586     MOVE 'R'                    TO ERPYAJ-TYPE
 13587     IF REVERSAL
 13588        MOVE 'C'                 TO ERPYAJ-TYPE
 13589     END-IF
 13590     MOVE SPACES                 TO PENDING-PAY-ADJ
 13591     MOVE 'PY'                   TO PY-RECORD-ID
 13592     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13593     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13594     IF REVERSAL
 13595        MOVE PB-I-DCC-OVER-CHG-AMT
 13596                                 TO PY-ENTRY-AMT
 13597     END-IF
 13598     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13599                                    PY-INPUT-DT
 13600*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13601*                                   PY-INPUT-DT
 13602     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13603     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13604     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13605     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13606     IF PB-CARRIER = '2'
 13607        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13608     ELSE
 13609        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13610     END-IF
 13611     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13612                                    PY-BILLED-DATE
 13613                                    PY-AR-DATE
 13614                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 248
* EL6311.cbl
 13615                                    PY-CHECK-WRITTEN-DT
 13616     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13617                                    PY-CHECK-QUE-SEQUENCE
 13618     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13619     PERFORM WITH TEST AFTER
 13620        UNTIL (NOT RESP-DUPKEY)
 13621           AND (NOT RESP-DUPREC)
 13622
 13623* EXEC CICS WRITE
 13624*          DATASET    (FILE-ID-ERPYAJ)
 13625*          FROM       (PENDING-PAY-ADJ)
 13626*          RIDFLD     (ERPYAJ-KEY)
 13627*          RESP       (WS-RESPONSE)
 13628*       END-EXEC
 13629     MOVE LENGTH OF
 13630      PENDING-PAY-ADJ
 13631       TO DFHEIV11
 13632*    MOVE '&$ L                  ''  N#00012431' TO DFHEIV0
 13633     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13635     MOVE X'204E233030303132343331' TO DFHEIV0(25:11)
 13636     CALL 'kxdfhei1' USING DFHEIV0,
 13637           FILE-ID-ERPYAJ,
 13638           PENDING-PAY-ADJ,
 13639           DFHEIV11,
 13640           ERPYAJ-KEY,
 13641           DFHEIV99,
 13642           DFHEIV99
 13643     MOVE EIBRESP  TO WS-RESPONSE
 13644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13645        IF RESP-DUPKEY OR RESP-DUPREC
 13646           ADD +1                TO ERPYAJ-SEQ-NO
 13647           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13648        END-IF
 13649     END-PERFORM
 13650     .
 13651 1610-EXIT.
 13652     EXIT.
 13653 1620-ADD-ERPYAJ-DLR-REC.
 13654     MOVE 'C'                    TO ERPYAJ-TYPE
 13655     IF REVERSAL
 13656        MOVE 'R'                 TO ERPYAJ-TYPE
 13657     END-IF
 13658     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13659                                    ERPYAJ-ACCOUNT
 13660     ADD +1                      TO ERPYAJ-SEQ-NO
 13661     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13662     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13663     IF PB-CARRIER = '2'
 13664        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13665     ELSE
 13666        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13667     END-IF
 13668     PERFORM WITH TEST AFTER
 13669        UNTIL (NOT RESP-DUPKEY)
 13670           AND (NOT RESP-DUPREC)
 13671
 13672* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 249
* EL6311.cbl
 13673*          DATASET    (FILE-ID-ERPYAJ)
 13674*          FROM       (PENDING-PAY-ADJ)
 13675*          RIDFLD     (ERPYAJ-KEY)
 13676*          RESP       (WS-RESPONSE)
 13677*       END-EXEC
 13678     MOVE LENGTH OF
 13679      PENDING-PAY-ADJ
 13680       TO DFHEIV11
 13681*    MOVE '&$ L                  ''  N#00012463' TO DFHEIV0
 13682     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13684     MOVE X'204E233030303132343633' TO DFHEIV0(25:11)
 13685     CALL 'kxdfhei1' USING DFHEIV0,
 13686           FILE-ID-ERPYAJ,
 13687           PENDING-PAY-ADJ,
 13688           DFHEIV11,
 13689           ERPYAJ-KEY,
 13690           DFHEIV99,
 13691           DFHEIV99
 13692     MOVE EIBRESP  TO WS-RESPONSE
 13693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13694        IF RESP-DUPKEY OR RESP-DUPREC
 13695           ADD +1                TO ERPYAJ-SEQ-NO
 13696           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13697        END-IF
 13698     END-PERFORM
 13699     .
 13700 1620-EXIT.
 13701     EXIT.
 13702 1700-SQUEEZE-IT-IN.
 13703     IF (N1 > CN-BILLING-END-LINE-NO)
 13704        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13705           N1 = +1
 13706           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13707           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13708              IF PI-COMPANY-ID = 'DCC'
 13709                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13710              ELSE
 13711                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13712              END-IF
 13713              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13714              MOVE +2 TO N1
 13715           END-IF
 13716        END-PERFORM
 13717     ELSE
 13718        IF (N1 < CN-BILLING-START-LINE-NO)
 13719           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13720              N1 = +10
 13721              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13722              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13723                 IF PI-COMPANY-ID = 'DCC'
 13724                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13725                 ELSE
 13726                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13727                 END-IF
 13728                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13729                 MOVE +9 TO N1
 13730              END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 250
* EL6311.cbl
 13731           END-PERFORM
 13732        END-IF
 13733     END-IF
 13734     .
 13735 1700-EXIT.
 13736     EXIT.
 13737 1800-REMOVE-CERT-NOTES.
 13738     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13739                                 TO ERNOTE-KEY
 13740
 13741* EXEC CICS READ
 13742*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13743*       DATASET    (FILE-ID-ERNOTE)
 13744*       RIDFLD     (ERNOTE-KEY)
 13745*       RESP       (WS-RESPONSE)
 13746*       UPDATE
 13747*    END-EXEC
 13748*    MOVE '&"S        EU         (  N#00012515' TO DFHEIV0
 13749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13751     MOVE X'204E233030303132353135' TO DFHEIV0(25:11)
 13752     CALL 'kxdfhei1' USING DFHEIV0,
 13753           FILE-ID-ERNOTE,
 13754           DFHEIV20,
 13755           DFHEIV99,
 13756           ERNOTE-KEY,
 13757           DFHEIV99,
 13758           DFHEIV99,
 13759           DFHEIV99
 13760     SET ADDRESS OF CERTIFICATE-NOTE TO
 13761         DFHEIV20
 13762     MOVE EIBRESP  TO WS-RESPONSE
 13763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13764     IF RESP-NORMAL
 13765        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13766           (N1 > +10)
 13767           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13768           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13769        END-PERFORM
 13770        IF N1 < +11
 13771           MOVE SPACES              TO CN-LINE (N1)
 13772           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13773              N1 <= CN-BILLING-END-LINE-NO
 13774              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13775              IF CN-BILLING-END-LINE-NO <
 13776                               CN-BILLING-START-LINE-NO
 13777                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13778                                     CN-BILLING-START-LINE-NO
 13779              END-IF
 13780              PERFORM 1820-SQUEEZE-ERNOTE
 13781                                  THRU 1820-EXIT
 13782           END-IF
 13783           IF CN-LINES = SPACES
 13784
 13785* EXEC CICS DELETE
 13786*                DATASET    (FILE-ID-ERNOTE)
 13787*                RESP       (WS-RESPONSE)
 13788*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 251
* EL6311.cbl
 13789*    MOVE '&(                    &  N#00012542' TO DFHEIV0
 13790     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13791     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13792     MOVE X'204E233030303132353432' TO DFHEIV0(25:11)
 13793     CALL 'kxdfhei1' USING DFHEIV0,
 13794           FILE-ID-ERNOTE,
 13795           DFHEIV99,
 13796           DFHEIV99,
 13797           DFHEIV99,
 13798           DFHEIV99
 13799     MOVE EIBRESP  TO WS-RESPONSE
 13800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13801              IF RESP-NORMAL
 13802                 MOVE 'D'        TO WS-NOTE-SW
 13803                 PERFORM 1520-UPDATE-ELCERT
 13804                                 THRU 1520-EXIT
 13805              END-IF
 13806           ELSE
 13807
 13808* EXEC CICS REWRITE
 13809*                DATASET    (FILE-ID-ERNOTE)
 13810*                FROM       (CERTIFICATE-NOTE)
 13811*                RESP       (WS-RESPONSE)
 13812*             END-EXEC
 13813     MOVE LENGTH OF
 13814      CERTIFICATE-NOTE
 13815       TO DFHEIV11
 13816*    MOVE '&& L                  %  N#00012552' TO DFHEIV0
 13817     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13818     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13819     MOVE X'204E233030303132353532' TO DFHEIV0(25:11)
 13820     CALL 'kxdfhei1' USING DFHEIV0,
 13821           FILE-ID-ERNOTE,
 13822           CERTIFICATE-NOTE,
 13823           DFHEIV11,
 13824           DFHEIV99
 13825     MOVE EIBRESP  TO WS-RESPONSE
 13826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13827           END-IF
 13828        END-IF
 13829     END-IF
 13830     .
 13831 1800-EXIT.
 13832     EXIT.
 13833 1820-SQUEEZE-ERNOTE.
 13834     MOVE CN-BILLING-START-LINE-NO TO N2
 13835     IF N2 = 0
 13836         MOVE +1                 TO N2
 13837     END-IF
 13838     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13839        (N1 > +9)
 13840        IF CN-LINE (N1) = SPACES
 13841           MOVE CN-LINE (N1 + +1)
 13842                                 TO CN-LINE (N1)
 13843           MOVE SPACES           TO CN-LINE (N1 + +1)
 13844        END-IF
 13845     END-PERFORM
 13846     .
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 252
* EL6311.cbl
 13847 1820-EXIT.
 13848     EXIT.
 13849 1900-DELETE-ERPYAJ.
 13850     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13851     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13852     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13853     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13854     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13855     MOVE +10                    TO ERPYAJ-SEQ-NO
 13856     MOVE 'R'                    TO ERPYAJ-TYPE
 13857     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13858
 13859* EXEC CICS STARTBR
 13860*       DATASET    (FILE-ID-ERPYAJ)
 13861*       RIDFLD     (ERPYAJ-KEY)
 13862*       RESP       (WS-RESPONSE)
 13863*    END-EXEC
 13864     MOVE 0
 13865       TO DFHEIV11
 13866*    MOVE '&,         G          &  N#00012588' TO DFHEIV0
 13867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13869     MOVE X'204E233030303132353838' TO DFHEIV0(25:11)
 13870     CALL 'kxdfhei1' USING DFHEIV0,
 13871           FILE-ID-ERPYAJ,
 13872           ERPYAJ-KEY,
 13873           DFHEIV99,
 13874           DFHEIV11,
 13875           DFHEIV99
 13876     MOVE EIBRESP  TO WS-RESPONSE
 13877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13878     IF RESP-NORMAL
 13879        CONTINUE
 13880     ELSE
 13881        GO TO 1900-GET-DEALER
 13882     END-IF
 13883     .
 13884 1900-READNEXT-ERPYAJ-B.
 13885*  GET THE BANK ERPYAJ RECORD
 13886
 13887* EXEC CICS READNEXT
 13888*       DATASET    (FILE-ID-ERPYAJ)
 13889*       RIDFLD     (ERPYAJ-KEY)
 13890*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13891*       RESP       (WS-RESPONSE)
 13892*    END-EXEC
 13893     MOVE 0
 13894       TO DFHEIV11
 13895*    MOVE '&.S                   )  N#00012601' TO DFHEIV0
 13896     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13897     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13898     MOVE X'204E233030303132363031' TO DFHEIV0(25:11)
 13899     CALL 'kxdfhei1' USING DFHEIV0,
 13900           FILE-ID-ERPYAJ,
 13901           DFHEIV20,
 13902           DFHEIV99,
 13903           ERPYAJ-KEY,
 13904           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 253
* EL6311.cbl
 13905           DFHEIV11,
 13906           DFHEIV99,
 13907           DFHEIV99
 13908     SET ADDRESS OF PENDING-PAY-ADJ TO
 13909         DFHEIV20
 13910     MOVE EIBRESP  TO WS-RESPONSE
 13911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13912     IF RESP-NORMAL
 13913        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13914           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13915              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13916                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13917
 13918* EXEC CICS READ
 13919*                   DATASET    (FILE-ID-ERPYAJ)
 13920*                   RIDFLD     (ERPYAJ-KEY)
 13921*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13922*                   RESP       (WS-RESPONSE)
 13923*                   UPDATE
 13924*                END-EXEC
 13925*    MOVE '&"S        EU         (  N#00012612' TO DFHEIV0
 13926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13927     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13928     MOVE X'204E233030303132363132' TO DFHEIV0(25:11)
 13929     CALL 'kxdfhei1' USING DFHEIV0,
 13930           FILE-ID-ERPYAJ,
 13931           DFHEIV20,
 13932           DFHEIV99,
 13933           ERPYAJ-KEY,
 13934           DFHEIV99,
 13935           DFHEIV99,
 13936           DFHEIV99
 13937     SET ADDRESS OF PENDING-PAY-ADJ TO
 13938         DFHEIV20
 13939     MOVE EIBRESP  TO WS-RESPONSE
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13941                 IF RESP-NORMAL
 13942
 13943* EXEC CICS DELETE
 13944*                      DATASET   (FILE-ID-ERPYAJ)
 13945*                      RESP      (WS-RESPONSE)
 13946*                   END-EXEC
 13947*    MOVE '&(                    &  N#00012620' TO DFHEIV0
 13948     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13950     MOVE X'204E233030303132363230' TO DFHEIV0(25:11)
 13951     CALL 'kxdfhei1' USING DFHEIV0,
 13952           FILE-ID-ERPYAJ,
 13953           DFHEIV99,
 13954           DFHEIV99,
 13955           DFHEIV99,
 13956           DFHEIV99
 13957     MOVE EIBRESP  TO WS-RESPONSE
 13958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13959                 END-IF
 13960              ELSE
 13961                 SET REVERSAL    TO TRUE
 13962                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 254
* EL6311.cbl
 13963                                 THRU 1600-EXIT
 13964                 GO TO 1900-EXIT
 13965              END-IF
 13966           ELSE
 13967              GO TO 1900-READNEXT-ERPYAJ-B
 13968           END-IF
 13969        END-IF
 13970
 13971* EXEC CICS ENDBR
 13972*          DATASET   (FILE-ID-ERPYAJ)
 13973*       END-EXEC
 13974     MOVE 0
 13975       TO DFHEIV11
 13976*    MOVE '&2                    $   #00012635' TO DFHEIV0
 13977     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13978     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13979     MOVE X'2020233030303132363335' TO DFHEIV0(25:11)
 13980     CALL 'kxdfhei1' USING DFHEIV0,
 13981           FILE-ID-ERPYAJ,
 13982           DFHEIV11,
 13983           DFHEIV99
 13984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13985     END-IF
 13986     .
 13987 1900-GET-DEALER.
 13988     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13989     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13990     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13991     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13992     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13993     MOVE +10                    TO ERPYAJ-SEQ-NO
 13994     MOVE 'C'                    TO ERPYAJ-TYPE
 13995     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13996
 13997* EXEC CICS STARTBR
 13998*       DATASET    (FILE-ID-ERPYAJ)
 13999*       RIDFLD     (ERPYAJ-KEY)
 14000*       RESP       (WS-RESPONSE)
 14001*    END-EXEC
 14002     MOVE 0
 14003       TO DFHEIV11
 14004*    MOVE '&,         G          &  N#00012649' TO DFHEIV0
 14005     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14007     MOVE X'204E233030303132363439' TO DFHEIV0(25:11)
 14008     CALL 'kxdfhei1' USING DFHEIV0,
 14009           FILE-ID-ERPYAJ,
 14010           ERPYAJ-KEY,
 14011           DFHEIV99,
 14012           DFHEIV11,
 14013           DFHEIV99
 14014     MOVE EIBRESP  TO WS-RESPONSE
 14015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14016     IF RESP-NORMAL
 14017        CONTINUE
 14018     ELSE
 14019        GO TO 1900-EXIT
 14020     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 255
* EL6311.cbl
 14021     .
 14022 1900-READNEXT-ERPYAJ-D.
 14023*  GET THE DEALER ERPYAJ RECORD
 14024
 14025* EXEC CICS READNEXT
 14026*       DATASET    (FILE-ID-ERPYAJ)
 14027*       RIDFLD     (ERPYAJ-KEY)
 14028*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14029*       RESP       (WS-RESPONSE)
 14030*    END-EXEC
 14031     MOVE 0
 14032       TO DFHEIV11
 14033*    MOVE '&.S                   )  N#00012662' TO DFHEIV0
 14034     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14036     MOVE X'204E233030303132363632' TO DFHEIV0(25:11)
 14037     CALL 'kxdfhei1' USING DFHEIV0,
 14038           FILE-ID-ERPYAJ,
 14039           DFHEIV20,
 14040           DFHEIV99,
 14041           ERPYAJ-KEY,
 14042           DFHEIV99,
 14043           DFHEIV11,
 14044           DFHEIV99,
 14045           DFHEIV99
 14046     SET ADDRESS OF PENDING-PAY-ADJ TO
 14047         DFHEIV20
 14048     MOVE EIBRESP  TO WS-RESPONSE
 14049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14050     IF RESP-NORMAL
 14051        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14052           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14053              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14054                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14055
 14056* EXEC CICS READ
 14057*                   DATASET    (FILE-ID-ERPYAJ)
 14058*                   RIDFLD     (ERPYAJ-KEY)
 14059*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14060*                   RESP       (WS-RESPONSE)
 14061*                   UPDATE
 14062*                END-EXEC
 14063*    MOVE '&"S        EU         (  N#00012673' TO DFHEIV0
 14064     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14065     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14066     MOVE X'204E233030303132363733' TO DFHEIV0(25:11)
 14067     CALL 'kxdfhei1' USING DFHEIV0,
 14068           FILE-ID-ERPYAJ,
 14069           DFHEIV20,
 14070           DFHEIV99,
 14071           ERPYAJ-KEY,
 14072           DFHEIV99,
 14073           DFHEIV99,
 14074           DFHEIV99
 14075     SET ADDRESS OF PENDING-PAY-ADJ TO
 14076         DFHEIV20
 14077     MOVE EIBRESP  TO WS-RESPONSE
 14078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 256
* EL6311.cbl
 14079                 IF RESP-NORMAL
 14080
 14081* EXEC CICS DELETE
 14082*                      DATASET   (FILE-ID-ERPYAJ)
 14083*                      RESP      (WS-RESPONSE)
 14084*                   END-EXEC
 14085*    MOVE '&(                    &  N#00012681' TO DFHEIV0
 14086     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14087     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14088     MOVE X'204E233030303132363831' TO DFHEIV0(25:11)
 14089     CALL 'kxdfhei1' USING DFHEIV0,
 14090           FILE-ID-ERPYAJ,
 14091           DFHEIV99,
 14092           DFHEIV99,
 14093           DFHEIV99,
 14094           DFHEIV99
 14095     MOVE EIBRESP  TO WS-RESPONSE
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14097                 END-IF
 14098              ELSE
 14099                 SET REVERSAL    TO TRUE
 14100              END-IF
 14101           ELSE
 14102              GO TO 1900-READNEXT-ERPYAJ-D
 14103           END-IF
 14104        END-IF
 14105
 14106* EXEC CICS ENDBR
 14107*          DATASET   (FILE-ID-ERPYAJ)
 14108*       END-EXEC
 14109     MOVE 0
 14110       TO DFHEIV11
 14111*    MOVE '&2                    $   #00012693' TO DFHEIV0
 14112     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14114     MOVE X'2020233030303132363933' TO DFHEIV0(25:11)
 14115     CALL 'kxdfhei1' USING DFHEIV0,
 14116           FILE-ID-ERPYAJ,
 14117           DFHEIV11,
 14118           DFHEIV99
 14119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14120     END-IF
 14121     .
 14122 1900-EXIT.
 14123     EXIT.
 14124******************************************************************
 14125*            C A N C E L   M A I N L I N E                       *
 14126******************************************************************
 14127
 14128 2000-CANCEL-MAINLINE.
 14129     IF PI-DISPLAY-ORIGINAL-BATCH
 14130        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14131           MOVE ER-0023             TO EMI-ERROR
 14132           MOVE -1                  TO CMAINTL
 14133           MOVE AL-UABON            TO CMAINTA
 14134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14135           GO TO 8200-SEND-DATAONLY
 14136        ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 257
* EL6311.cbl
 14137           NEXT SENTENCE
 14138     ELSE
 14139        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14140           MOVE ER-0023             TO EMI-ERROR
 14141           MOVE -1                  TO CMAINTL
 14142           MOVE AL-UABON            TO CMAINTA
 14143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144           GO TO 8200-SEND-DATAONLY.
 14145
 14146     IF CMAINTI = 'S'
 14147        GO TO 2100-SHOW-REQUEST.
 14148
 14149     IF NOT MODIFY-CAP
 14150         MOVE 'UPDATE'       TO SM-READ
 14151         PERFORM 9995-SECURITY-VIOLATION
 14152         MOVE ER-0070        TO EMI-ERROR
 14153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14154         GO TO 8100-SEND-INITIAL-MAP.
 14155
 14156     IF CMAINTL GREATER THAN ZEROS
 14157        IF PI-PF6-FUNCTION
 14158           IF CMAINTI NOT = 'A'
 14159              MOVE AL-UABON  TO CMAINTA
 14160              MOVE -1        TO CMAINTL
 14161              MOVE ER-2260   TO EMI-ERROR
 14162              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14163              GO TO 8200-SEND-DATAONLY.
 14164
 14165     IF CCERTNOL = ZEROS
 14166       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14167         NEXT SENTENCE
 14168     ELSE
 14169         IF CCERTNOL NOT = ZEROS
 14170             MOVE AL-UANON       TO CCERTNOA
 14171         ELSE
 14172             MOVE -1             TO CCERTNOL
 14173             MOVE  1             TO SET-CURSOR-SW
 14174             MOVE ER-2218       TO EMI-ERROR
 14175             MOVE AL-UABON       TO CCERTNOA
 14176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14177
 14178     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14179        NEXT SENTENCE
 14180     ELSE
 14181        IF CEFFDTL NOT = ZEROS
 14182           MOVE AL-UNNON         TO CEFFDTA
 14183           MOVE CEFFDTI TO DEEDIT-FIELD
 14184           PERFORM 8600-DEEDIT
 14185           MOVE 4                TO DC-OPTION-CODE
 14186           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14187           PERFORM 9700-DATE-LINK
 14188           IF NO-CONVERSION-ERROR
 14189              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14190              ELSE
 14191              MOVE -1            TO CEFFDTL
 14192              MOVE  1            TO SET-CURSOR-SW
 14193              MOVE ER-2226      TO EMI-ERROR
 14194              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 258
* EL6311.cbl
 14195              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14196          ELSE
 14197          MOVE -1                 TO CEFFDTL
 14198          MOVE  1                 TO SET-CURSOR-SW
 14199          MOVE ER-2220            TO EMI-ERROR
 14200          MOVE AL-UNBON           TO CEFFDTA
 14201          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14202
 14203     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14204
 14205     IF CCERTNOL NOT = ZEROS
 14206        MOVE CCERTNOI                TO WS-NEW-PRIME
 14207     ELSE
 14208        MOVE SPACES                  TO WS-NEW-PRIME.
 14209
 14210     IF CSUFIXL NOT = ZEROS
 14211        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14212     ELSE
 14213        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14214
 14215     IF CEFFDTL NOT = ZEROS
 14216        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14217     ELSE
 14218        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14219
 14220     IF CMAINTI = 'A' OR 'K' OR 'S'
 14221        NEXT SENTENCE
 14222     ELSE
 14223        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14224        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14225           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14226           WS-PB-RECORD-TYPE NOT = '2'
 14227           IF CMAINTI = 'C'
 14228              MOVE ER-2287          TO EMI-ERROR
 14229              MOVE -1               TO CCERTNOL
 14230              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14231              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14232              GO TO 8200-SEND-DATAONLY
 14233             ELSE
 14234              MOVE ER-2260          TO EMI-ERROR
 14235              MOVE -1               TO CCERTNOL
 14236              MOVE AL-UABON         TO CCERTNOA
 14237              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238              GO TO 8200-SEND-DATAONLY.
 14239
 14240     IF CMAINTI = 'D'
 14241        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14242
 14243     IF CLSTNML GREATER THAN ZEROS
 14244         MOVE AL-UANON           TO CLSTNMA.
 14245
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 259
* EL6311.cbl
 14247
 14248******************************************************************
 14249*                                                                *
 14250*           E D I T   C A N C E L   C O V E R A G E S            *
 14251*                                                                *
 14252******************************************************************
 14253
 14254 2015-EDIT-COVERAGES.
 14255     IF CCANDT1L      GREATER THAN ZEROS OR
 14256        CREFND1L      GREATER THAN ZEROS OR
 14257        CCANDT2L      GREATER THAN ZEROS OR
 14258        CREFND2L      GREATER THAN ZEROS OR
 14259        CMTHD1L       GREATER THAN ZEROS OR
 14260        CMTHD2L       GREATER THAN ZEROS OR
 14261        CLIVESL       GREATER THAN ZEROS OR
 14262        CPAYEEL       GREATER THAN ZEROS OR
 14263        CFORCEL       GREATER THAN ZEROS OR
 14264        CBILCDL       GREATER THAN ZEROS OR
 14265        CCANREAL      GREATER THAN ZEROS
 14266            NEXT SENTENCE
 14267         ELSE
 14268            GO TO 2030-EDIT-COMPLETE.
 14269
 14270     IF CCANDT1L = ZEROS
 14271        AND (CMAINTI = 'C' OR 'K')
 14272        NEXT SENTENCE
 14273     ELSE
 14274        IF CCANDT1L      GREATER THAN ZEROS
 14275            MOVE AL-UNNON            TO CCANDT1A
 14276            IF CCANDT1I = SPACES
 14277               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14278            ELSE
 14279               MOVE CCANDT1I            TO DEEDIT-FIELD
 14280               PERFORM 8600-DEEDIT
 14281               IF DEEDIT-FIELD-V0   NUMERIC
 14282                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14283                  MOVE 4                TO DC-OPTION-CODE
 14284                  PERFORM 9700-DATE-LINK
 14285                  IF NO-CONVERSION-ERROR
 14286                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14287                  ELSE
 14288                      MOVE -1        TO CCANDT1L
 14289                      MOVE ER-2227   TO EMI-ERROR
 14290                      MOVE AL-UNBON  TO CCANDT1A
 14291                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14292               ELSE
 14293                  MOVE -1         TO CCANDT1L
 14294                  MOVE ER-2223    TO EMI-ERROR
 14295                  MOVE AL-UNBON   TO CCANDT1A
 14296                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14297        ELSE
 14298            IF CREFND1L GREATER THAN ZEROS
 14299               MOVE -1             TO CCANDT1L
 14300               MOVE ER-2222        TO EMI-ERROR
 14301               MOVE AL-UNBOF       TO CCANDT1A
 14302               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14303
 14304     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 260
* EL6311.cbl
 14305        AND (CMAINTI = 'C' OR 'K')
 14306         NEXT SENTENCE
 14307     ELSE
 14308         IF CREFND1L NOT = ZEROS
 14309            MOVE AL-UNNON        TO CREFND1A
 14310
 14311* EXEC CICS BIF DEEDIT
 14312*               FIELD  (CREFND1I)
 14313*               LENGTH (11)
 14314*           END-EXEC
 14315     MOVE 11
 14316       TO DFHEIV11
 14317*    MOVE '@"L                   #   #00012886' TO DFHEIV0
 14318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14320     MOVE X'2020233030303132383836' TO DFHEIV0(25:11)
 14321     CALL 'kxdfhei1' USING DFHEIV0,
 14322           CREFND1I,
 14323           DFHEIV11
 14324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14325            MOVE CREFND1I        TO WS-CREFND1
 14326*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14327*           PERFORM 8600-DEEDIT
 14328*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14329            IF WS-CREFND1  = ZEROS
 14330               AND CMAINTI = 'A'
 14331             MOVE ER-2437        TO EMI-ERROR
 14332             MOVE -1             TO CREFND1L
 14333             MOVE AL-UNBON       TO CREFND1A
 14334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14335
 14336     IF CCANREAL > +0
 14337        MOVE AL-UANON            TO CCANREAA
 14338        IF CCANREAI = 'R' OR ' '
 14339           CONTINUE
 14340        ELSE
 14341           MOVE ER-9841        TO EMI-ERROR
 14342           MOVE -1             TO CCANREAL
 14343           MOVE AL-UABON       TO CCANREAA
 14344           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14345        END-IF
 14346     END-IF
 14347     IF CMTHD1L EQUAL +0
 14348        NEXT SENTENCE
 14349     ELSE
 14350        IF CMTHD1L NOT = +0
 14351           MOVE AL-UNNON        TO CMTHD1A
 14352           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14353                         OR '5' OR '6' OR '8' OR '9'
 14354                         OR 'R' OR ' '
 14355              NEXT SENTENCE
 14356           ELSE
 14357              MOVE ER-0582        TO EMI-ERROR
 14358              MOVE -1             TO CMTHD1L
 14359              MOVE AL-UNBON       TO CMTHD1A
 14360              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14361
 14362     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 261
* EL6311.cbl
 14363        AND (CMAINTI = 'C' OR 'K')
 14364         NEXT SENTENCE
 14365     ELSE
 14366         IF CCANDT2L  GREATER THAN ZEROS
 14367             MOVE AL-UNNON       TO CCANDT2A
 14368             IF CCANDT2I = SPACES
 14369                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14370             ELSE
 14371                MOVE CCANDT2I       TO DEEDIT-FIELD
 14372                PERFORM 8600-DEEDIT
 14373                IF DEEDIT-FIELD-V0   NUMERIC
 14374                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14375                   MOVE 4                TO DC-OPTION-CODE
 14376                   PERFORM 9700-DATE-LINK
 14377                   IF NO-CONVERSION-ERROR
 14378                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14379                   ELSE
 14380                      MOVE -1       TO CCANDT2L
 14381                      MOVE ER-2227  TO EMI-ERROR
 14382                      MOVE AL-UNBON TO CCANDT2A
 14383                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14384                ELSE
 14385                   MOVE -1         TO CCANDT2L
 14386                   MOVE ER-2223    TO EMI-ERROR
 14387                   MOVE AL-UNBON   TO CCANDT2A
 14388                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14389         ELSE
 14390            IF CREFND2L GREATER THAN ZEROS
 14391               MOVE -1             TO CCANDT2L
 14392               MOVE ER-2222        TO EMI-ERROR
 14393               MOVE AL-UNBOF       TO CCANDT2A
 14394               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14395
 14396     IF CREFND2L = ZEROS
 14397        AND (CMAINTI = 'C' OR 'K')
 14398         NEXT SENTENCE
 14399     ELSE
 14400         IF CREFND2L NOT = ZEROS
 14401            MOVE AL-UNNON        TO CREFND2A
 14402
 14403* EXEC CICS BIF DEEDIT
 14404*               FIELD  (CREFND2I)
 14405*               LENGTH (11)
 14406*           END-EXEC
 14407     MOVE 11
 14408       TO DFHEIV11
 14409*    MOVE '@"L                   #   #00012967' TO DFHEIV0
 14410     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14411     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14412     MOVE X'2020233030303132393637' TO DFHEIV0(25:11)
 14413     CALL 'kxdfhei1' USING DFHEIV0,
 14414           CREFND2I,
 14415           DFHEIV11
 14416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14417            MOVE CREFND2I        TO WS-CREFND2
 14418*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14419*           PERFORM 8600-DEEDIT
 14420*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 262
* EL6311.cbl
 14421            IF WS-CREFND2  = ZEROS
 14422               AND CMAINTI = 'A'
 14423             MOVE ER-2437        TO EMI-ERROR
 14424             MOVE -1             TO CREFND2L
 14425             MOVE AL-UNBON       TO CREFND2A
 14426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14427
 14428     IF CMTHD2L EQUAL +0
 14429        NEXT SENTENCE
 14430     ELSE
 14431        IF CMTHD2L NOT = +0
 14432           MOVE AL-UNNON        TO CMTHD2A
 14433           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14434                         OR '5' OR '6' OR '8' OR '9'
 14435                         OR ' ' OR 'R'
 14436              NEXT SENTENCE
 14437           ELSE
 14438              MOVE ER-0582        TO EMI-ERROR
 14439              MOVE -1             TO CMTHD2L
 14440              MOVE AL-UNBON       TO CMTHD2A
 14441              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14442
 14443     IF CLIVESL GREATER THAN ZEROS
 14444         MOVE CLIVESI            TO DEEDIT-FIELD
 14445         PERFORM 8600-DEEDIT
 14446         IF DEEDIT-FIELD-V0 NUMERIC
 14447             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14448             MOVE AL-UNNON       TO CLIVESA
 14449         ELSE
 14450             MOVE -1             TO CLIVESL
 14451             MOVE AL-UNBON       TO CLIVESA
 14452             MOVE ER-2223        TO EMI-ERROR
 14453             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14454
 14455     IF CFORCEL  NOT = ZEROS
 14456         IF FORCE-CAP
 14457            MOVE AL-UANON            TO CFORCEA
 14458         ELSE
 14459            MOVE ER-2945             TO EMI-ERROR
 14460            MOVE AL-UABON            TO CFORCEA
 14461            MOVE -1                  TO CFORCEL
 14462            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14463
 14464     IF CPAYEEL GREATER THAN ZEROS
 14465        MOVE AL-UANON            TO CPAYEEA.
 14466
 14467     IF CBILCDL NOT = ZEROS
 14468        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14469                             AND 'A' AND 'B' AND 'E'
 14470           MOVE ER-2225              TO EMI-ERROR
 14471           MOVE AL-UABON             TO CBILCDA
 14472           MOVE -1                   TO CBILCDL
 14473           MOVE  1                   TO SET-CURSOR-SW
 14474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14475        ELSE
 14476           MOVE AL-UANON             TO CBILCDA.
 14477
 14478 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 263
* EL6311.cbl
 14479     IF EMI-ERROR = ZEROS
 14480         NEXT SENTENCE
 14481     ELSE
 14482         GO TO 8200-SEND-DATAONLY.
 14483
 14484     IF CMAINTI = 'A'
 14485        GO TO 2200-ADD-CANCEL-ROUTINE.
 14486
 14487     IF CMAINTI = 'C'
 14488        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14489
 14490     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14491
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 264
* EL6311.cbl
 14493
 14494******************************************************************
 14495*                                                                *
 14496*                   S H O W   C A N C E L                        *
 14497*                                                                *
 14498******************************************************************
 14499
 14500 2100-SHOW-REQUEST.
 14501     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14502
 14503     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14504        MOVE -1                  TO CMAINTL
 14505        GO TO 8200-SEND-DATAONLY.
 14506
 14507     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14508
 14509     IF CSUFIXL NOT = ZEROS
 14510        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14511       ELSE
 14512        MOVE SPACE            TO WS-NEW-SUFFIX.
 14513
 14514     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14515     PERFORM 8600-DEEDIT.
 14516     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14517     MOVE '4'                    TO DC-OPTION-CODE.
 14518     PERFORM 9700-DATE-LINK.
 14519     IF DATE-CONVERSION-ERROR
 14520        MOVE ER-0348             TO EMI-ERROR
 14521        MOVE -1                  TO CEFFDTL
 14522        MOVE AL-UABON            TO CEFFDTA
 14523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14524        GO TO 8200-SEND-DATAONLY
 14525     ELSE
 14526        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14527        MOVE AL-UANON            TO CEFFDTA
 14528        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14529
 14530     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14531
 14532     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14533        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14534        MOVE 'Y'                    TO WS-SHOW-SW
 14535        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14536           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14537        ELSE
 14538           IF PI-FILE-BROWSE
 14539              GO TO 4300-BROWSE-FILE-FORWARD
 14540           ELSE
 14541              IF PI-CSR-BROWSE
 14542                 GO TO 4200-BROWSE-CSR-FORWARD
 14543              ELSE
 14544                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14545     ELSE
 14546        GO TO 3900-RE-DISPLAY-RECORD.
 14547
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 265
* EL6311.cbl
 14549
 14550
 14551******************************************************************
 14552*                                                                *
 14553*            A D D   C A N C E L   R O U T I N E                 *
 14554*                                                                *
 14555******************************************************************
 14556
 14557 2200-ADD-CANCEL-ROUTINE.
 14558     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14559
 14560
 14561* EXEC CICS GETMAIN
 14562*        SET     (ADDRESS OF PENDING-BUSINESS)
 14563*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14564*    END-EXEC.
 14565*    MOVE '," L                  $   #00013114' TO DFHEIV0
 14566     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14567     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14568     MOVE X'2020233030303133313134' TO DFHEIV0(25:11)
 14569     CALL 'kxdfhei1' USING DFHEIV0,
 14570           DFHEIV20,
 14571           ERPNDB-RECORD-LENGTH,
 14572           DFHEIV99
 14573     SET ADDRESS OF PENDING-BUSINESS TO
 14574         DFHEIV20
 14575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14576
 14577
 14578
 14579* EXEC CICS HANDLE CONDITION
 14580*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14581*    END-EXEC.
 14582*    MOVE '"$I                   ! 3 #00013119' TO DFHEIV0
 14583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14585     MOVE X'3320233030303133313139' TO DFHEIV0(25:11)
 14586     CALL 'kxdfhei1' USING DFHEIV0
 14587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14588
 14589
 14590     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14591     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14592     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14593
 14594
 14595* EXEC CICS READ
 14596*        INTO    (PENDING-BUSINESS)
 14597*        DATASET (FILE-ID-ERPNDB)
 14598*        RIDFLD  (ERPNDB-KEY)
 14599*    END-EXEC.
 14600     MOVE LENGTH OF
 14601      PENDING-BUSINESS
 14602       TO DFHEIV11
 14603*    MOVE '&"IL       E          (   #00013127' TO DFHEIV0
 14604     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14606     MOVE X'2020233030303133313237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 266
* EL6311.cbl
 14607     CALL 'kxdfhei1' USING DFHEIV0,
 14608           FILE-ID-ERPNDB,
 14609           PENDING-BUSINESS,
 14610           DFHEIV11,
 14611           ERPNDB-KEY,
 14612           DFHEIV99,
 14613           DFHEIV99,
 14614           DFHEIV99
 14615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14616
 14617
 14618     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14619
 14620     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14621     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14622     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14623     MOVE SPACES                 TO PENDING-BUSINESS.
 14624     MOVE 'PB'                   TO PB-RECORD-ID.
 14625     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14626     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14627     MOVE SPACES                 TO PB-CERT-SFX.
 14628     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14629     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14630                                    PB-ALT-CHG-SEQ-NO.
 14631
 14632     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14633     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14634     MOVE '2'                    TO PB-RECORD-TYPE.
 14635
 14636     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14637     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14638
 14639
 14640     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14641                                    PB-ALT-CHG-SEQ-NO
 14642                                    PB-C-LF-REF-CALC
 14643                                    PB-C-AH-REF-CALC
 14644                                    PB-C-LF-RFND-CLP
 14645                                    PB-C-AH-RFND-CLP
 14646                                    PB-CI-INSURED-AGE
 14647                                    PB-CI-LF-TERM
 14648                                    PB-CI-AH-TERM
 14649                                    PB-CI-LF-BENEFIT-CD
 14650                                    PB-CI-LF-BENEFIT-AMT
 14651                                    PB-CI-LF-ALT-BENEFIT-AMT
 14652                                    PB-CI-LF-PREMIUM-AMT
 14653                                    PB-CI-LF-ALT-PREMIUM-AMT
 14654                                    PB-CI-AH-BENEFIT-CD
 14655                                    PB-CI-AH-BENEFIT-AMT
 14656                                    PB-CI-AH-PREMIUM-AMT
 14657                                    PB-CI-PAY-FREQUENCY
 14658                                    PB-CI-LOAN-APR
 14659                                    PB-CI-LOAN-TERM
 14660                                    PB-CI-LIFE-COMMISSION
 14661                                    PB-CI-AH-COMMISSION
 14662                                    PB-CI-CURR-SEQ
 14663                                    PB-CI-AH-CANCEL-AMT
 14664                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 267
* EL6311.cbl
 14665                                    PB-CI-RATE-DEV-PCT-LF
 14666                                    PB-CI-RATE-DEV-PCT-AH
 14667                                    PB-CI-EXTENTION-DAYS
 14668                                    PB-CI-TERM-IN-DAYS
 14669                                    PB-CI-LIVES
 14670                                    PB-CI-LF-CRIT-PER
 14671                                    PB-CI-AH-CRIT-PER
 14672                                    PB-C-LF-REM-TERM
 14673                                    PB-C-AH-REM-TERM
 14674                                    PB-CHG-COUNT
 14675                                    PB-LF-BILLED-AMTS
 14676                                    PB-AH-BILLED-AMTS
 14677                                    PB-C-NH-INT-ON-REFS
 14678*                                   PB-C-MICROFILM-NO
 14679                                    PB-CALC-TOLERANCE.
 14680
 14681     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14682                                    PB-CI-AH-SETTLEMENT-DT
 14683                                    PB-CI-DEATH-DT
 14684                                    PB-CI-LF-PRIOR-CANCEL-DT
 14685                                    PB-CI-AH-PRIOR-CANCEL-DT
 14686                                    PB-CI-ENTRY-DT
 14687                                    PB-CI-LF-EXPIRE-DT
 14688                                    PB-CI-AH-EXPIRE-DT
 14689                                    PB-CI-LOAN-1ST-PMT-DT
 14690                                    PB-C-LF-CANCEL-DT
 14691                                    PB-C-AH-CANCEL-DT
 14692                                    PB-CREDIT-ACCEPT-DT
 14693                                    PB-BILLED-DT
 14694                                    PB-ACCT-EFF-DT
 14695                                    PB-ACCT-EXP-DT.
 14696
 14697     MOVE 'X'                    TO PB-FATAL-FLAG.
 14698
 14699     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14700
 14701     IF CSUFIXL     GREATER THAN ZEROS
 14702        MOVE CSUFIXI             TO PB-CERT-SFX.
 14703
 14704*    IF CMICRNOL  GREATER  ZEROS
 14705*        IF CMICRNOI  NUMERIC
 14706*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14707*            MOVE AL-UNNON       TO  CMICRNOA
 14708*        ELSE
 14709*            MOVE -1             TO  CMICRNOL
 14710*            MOVE AL-UNBON       TO  CMICRNOA
 14711*            MOVE ER-2701        TO  EMI-ERROR
 14712*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14713
 14714     IF CLSTNML     GREATER THAN ZEROS
 14715        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14716
 14717     IF CCANREAL > ZEROS
 14718        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14719     END-IF
 14720     IF CPCYNL > ZEROS
 14721        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14722     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 268
* EL6311.cbl
 14723     IF CCANDT1L    GREATER THAN ZEROS
 14724        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14725
 14726     IF CCANDT2L    GREATER THAN ZEROS
 14727        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14728
 14729     IF CMTHD1L    GREATER THAN +0
 14730        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14731
 14732     IF CMTHD2L    GREATER THAN +0
 14733        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14734
 14735     IF CREFND1L    GREATER THAN ZEROS
 14736        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14737        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14738     ELSE
 14739        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14740
 14741     IF CREFND2L    GREATER THAN ZEROS
 14742        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14743        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14744     ELSE
 14745        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14746
 14747     IF CLIVESL     GREATER THAN ZEROS
 14748        MOVE WS-CLIVES           TO PB-C-LIVES
 14749     ELSE
 14750        MOVE ZEROS               TO PB-C-LIVES.
 14751
 14752     IF CPAYEEL     GREATER THAN ZEROS
 14753        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14754
 14755     IF CFORCEL     GREATER THAN ZEROS
 14756        MOVE CFORCEI             TO PB-FORCE-CODE.
 14757
 14758     IF CBILCDL     GREATER THAN ZEROS
 14759        MOVE CBILCDI             TO PB-RECORD-BILL.
 14760
 14761*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14762
 14763 2260-WRITE-PB-RECORD.
 14764     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14765                                    PB-INPUT-BY.
 14766     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14767     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14768                                    PB-INPUT-DT.
 14769
 14770     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14771     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14772                                    PB-CONTROL-BY-ORIG-BATCH.
 14773
 14774     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14775     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14776     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14777     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14778     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14779
 14780     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 269
* EL6311.cbl
 14781
 14782     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14783
 14784     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14785     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14786     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14787
 14788     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14789     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14790
 14791 2275-WRITE-PENDING-BUSINESS.
 14792     MOVE 'A'                    TO JP-RECORD-TYPE.
 14793     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14794     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14795     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14796
 14797
 14798* EXEC CICS HANDLE CONDITION
 14799*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14800*    END-EXEC.
 14801*    MOVE '"$%                   ! 4 #00013312' TO DFHEIV0
 14802     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14804     MOVE X'3420233030303133333132' TO DFHEIV0(25:11)
 14805     CALL 'kxdfhei1' USING DFHEIV0
 14806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14807
 14808
 14809
 14810* EXEC CICS WRITE
 14811*        DATASET (FILE-ID-ERPNDB)
 14812*        FROM    (PENDING-BUSINESS)
 14813*        RIDFLD  (PB-CONTROL-PRIMARY)
 14814*    END-EXEC.
 14815     MOVE LENGTH OF
 14816      PENDING-BUSINESS
 14817       TO DFHEIV11
 14818*    MOVE '&$ L                  ''   #00013316' TO DFHEIV0
 14819     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14821     MOVE X'2020233030303133333136' TO DFHEIV0(25:11)
 14822     CALL 'kxdfhei1' USING DFHEIV0,
 14823           FILE-ID-ERPNDB,
 14824           PENDING-BUSINESS,
 14825           DFHEIV11,
 14826           PB-CONTROL-PRIMARY,
 14827           DFHEIV99,
 14828           DFHEIV99
 14829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14830
 14831
 14832     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14833
 14834     PERFORM 8400-LOG-JOURNAL-RECORD.
 14835
 14836******************************************************************
 14837*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14838******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 270
* EL6311.cbl
 14839
 14840     display ' made it to add orig CANCEL cert '
 14841     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14842     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14843     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14844     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14845
 14846
 14847* EXEC CICS READ
 14848*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14849*        DATASET (FILE-ID-ELCERT)
 14850*        RIDFLD  (ELCERT-KEY)
 14851*        RESP    (WS-RESPONSE)
 14852*    END-EXEC.
 14853*    MOVE '&"S        E          (  N#00013336' TO DFHEIV0
 14854     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14856     MOVE X'204E233030303133333336' TO DFHEIV0(25:11)
 14857     CALL 'kxdfhei1' USING DFHEIV0,
 14858           FILE-ID-ELCERT,
 14859           DFHEIV20,
 14860           DFHEIV99,
 14861           ELCERT-KEY,
 14862           DFHEIV99,
 14863           DFHEIV99,
 14864           DFHEIV99
 14865     SET ADDRESS OF CERTIFICATE-MASTER TO
 14866         DFHEIV20
 14867     MOVE EIBRESP  TO WS-RESPONSE
 14868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14869
 14870
 14871     IF NOT RESP-NORMAL
 14872        GO TO 2276-BYPASS-CRTO
 14873     END-IF
 14874
 14875     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14876     MOVE ' '                    TO WS-ERMAIL-SW
 14877
 14878
 14879* EXEC CICS READ
 14880*       DATASET   (FILE-ID-ERMAIL)
 14881*       SET       (ADDRESS OF MAILING-DATA)
 14882*       RIDFLD    (ERMAIL-KEY)
 14883*       RESP      (WS-RESPONSE)
 14884*    END-EXEC
 14885*    MOVE '&"S        E          (  N#00013350' TO DFHEIV0
 14886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14888     MOVE X'204E233030303133333530' TO DFHEIV0(25:11)
 14889     CALL 'kxdfhei1' USING DFHEIV0,
 14890           FILE-ID-ERMAIL,
 14891           DFHEIV20,
 14892           DFHEIV99,
 14893           ERMAIL-KEY,
 14894           DFHEIV99,
 14895           DFHEIV99,
 14896           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 271
* EL6311.cbl
 14897     SET ADDRESS OF MAILING-DATA TO
 14898         DFHEIV20
 14899     MOVE EIBRESP  TO WS-RESPONSE
 14900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14901
 14902     IF RESP-NORMAL
 14903        SET ERMAIL-FOUND TO TRUE
 14904     END-IF
 14905
 14906     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14907
 14908     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14909     MOVE 'OC'                   TO OC-RECORD-ID
 14910     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14911                                 TO OC-CONTROL-PRIMARY (1:33)
 14912     MOVE 'I'                    TO OC-RECORD-TYPE
 14913     MOVE +4096                  TO OC-KEY-SEQ-NO
 14914     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14915     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14916     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14917
 14918     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14919     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14920     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14921     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14922     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14923     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14924     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14925     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14926     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14927     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14928     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14929     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14930     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14931     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14932     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14933     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14934     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14935     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14936     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14937     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14938     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14939     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14940     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14941     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14942     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14943     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14944     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14945     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14946     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14947     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14948     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14949     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14950
 14951     IF ERMAIL-FOUND
 14952        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14953     END-IF
 14954     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 272
* EL6311.cbl
 14955        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14956                           OC-INS-AGE-DEFAULT-FLAG
 14957        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14958                           OC-JNT-AGE-DEFAULT-FLAG
 14959     END-IF
 14960     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14961     .
 14962 2275-WRITE-ELCRTO.
 14963
 14964
 14965* EXEC CICS WRITE
 14966*       DATASET   ('ELCRTO')
 14967*       FROM      (ORIGINAL-CERTIFICATE)
 14968*       RIDFLD    (OC-CONTROL-PRIMARY)
 14969*       RESP      (WS-RESPONSE)
 14970*    END-EXEC
 14971     MOVE LENGTH OF
 14972      ORIGINAL-CERTIFICATE
 14973       TO DFHEIV11
 14974     MOVE 'ELCRTO' TO DFHEIV1
 14975*    MOVE '&$ L                  ''  N#00013419' TO DFHEIV0
 14976     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14977     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14978     MOVE X'204E233030303133343139' TO DFHEIV0(25:11)
 14979     CALL 'kxdfhei1' USING DFHEIV0,
 14980           DFHEIV1,
 14981           ORIGINAL-CERTIFICATE,
 14982           DFHEIV11,
 14983           OC-CONTROL-PRIMARY,
 14984           DFHEIV99,
 14985           DFHEIV99
 14986     MOVE EIBRESP  TO WS-RESPONSE
 14987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14988
 14989     display ' just wrote 2275 ' ws-response
 14990     IF RESP-DUPKEY
 14991        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14992        GO TO 2275-WRITE-ELCRTO
 14993     ELSE
 14994        IF NOT RESP-NORMAL
 14995           MOVE -1               TO BMAINTL
 14996           MOVE ER-7450          TO EMI-ERROR
 14997           PERFORM 9900-ERROR-FORMAT
 14998                                 THRU 9900-EXIT
 14999           GO TO 8200-SEND-DATAONLY
 15000        END-IF
 15001     END-IF.
 15002
 15003 2276-BYPASS-CRTO.
 15004******************************************************************
 15005*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15006******************************************************************
 15007
 15008
 15009* EXEC CICS READ
 15010*        INTO    (PENDING-BUSINESS)
 15011*        DATASET (FILE-ID-ERPNDB)
 15012*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 273
* EL6311.cbl
 15013*        UPDATE
 15014*    END-EXEC.
 15015     MOVE LENGTH OF
 15016      PENDING-BUSINESS
 15017       TO DFHEIV11
 15018*    MOVE '&"IL       EU         (   #00013445' TO DFHEIV0
 15019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15020     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15021     MOVE X'2020233030303133343435' TO DFHEIV0(25:11)
 15022     CALL 'kxdfhei1' USING DFHEIV0,
 15023           FILE-ID-ERPNDB,
 15024           PENDING-BUSINESS,
 15025           DFHEIV11,
 15026           ERPNDB-KEY,
 15027           DFHEIV99,
 15028           DFHEIV99,
 15029           DFHEIV99
 15030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15031
 15032
 15033     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15034     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15035     MOVE 'B'                    TO JP-RECORD-TYPE.
 15036     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15037
 15038     PERFORM 8400-LOG-JOURNAL-RECORD.
 15039
 15040     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15041
 15042
 15043* EXEC CICS REWRITE
 15044*        DATASET (FILE-ID-ERPNDB)
 15045*        FROM    (PENDING-BUSINESS)
 15046*    END-EXEC.
 15047     MOVE LENGTH OF
 15048      PENDING-BUSINESS
 15049       TO DFHEIV11
 15050*    MOVE '&& L                  %   #00013461' TO DFHEIV0
 15051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15053     MOVE X'2020233030303133343631' TO DFHEIV0(25:11)
 15054     CALL 'kxdfhei1' USING DFHEIV0,
 15055           FILE-ID-ERPNDB,
 15056           PENDING-BUSINESS,
 15057           DFHEIV11,
 15058           DFHEIV99
 15059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15060
 15061
 15062     MOVE 'C'                    TO JP-RECORD-TYPE.
 15063     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15064
 15065     PERFORM 8400-LOG-JOURNAL-RECORD.
 15066
 15067     IF WS-ERRORS-PRESENT
 15068        GO TO 3900-RE-DISPLAY-RECORD.
 15069
 15070     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 274
* EL6311.cbl
 15071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15072     MOVE LOW-VALUES             TO EL631CI.
 15073     MOVE  -1                    TO CMAINTL.
 15074     GO TO 8100-SEND-INITIAL-MAP.
 15075
 15076 2280-BATCH-HDR-NOT-FOUND.
 15077     MOVE -1                     TO BMAINTL.
 15078     MOVE ER-7450                TO EMI-ERROR.
 15079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15080     GO TO 8200-SEND-DATAONLY.
 15081
 15082 2290-DUPLICATE-ALT-INDEX.
 15083
 15084******************************************************************
 15085*                                                                *
 15086*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15087*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15088*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15089*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15090*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15091*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15092*                                                                *
 15093******************************************************************
 15094
 15095     IF LCP-ONCTR-02 =  0
 15096         ADD 1 TO LCP-ONCTR-02
 15097        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15098
 15099     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15100
 15101     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15102         NEXT SENTENCE
 15103     ELSE
 15104         ADD +1 TO PB-BATCH-SEQ-NO
 15105                   PB-CSR-BATCH-SEQ-NO
 15106         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15107         GO TO 2275-WRITE-PENDING-BUSINESS.
 15108
 15109     MOVE -1                     TO CCERTNOL.
 15110     MOVE AL-UABON               TO CCERTNOA.
 15111     MOVE AL-UNBON               TO CEFFDTA.
 15112
 15113     MOVE 1                      TO EMI-SUB
 15114                                    EMI-SWITCH1
 15115                                    EMI-SWITCH-AREA-1
 15116                                    EMI-SWITCH-AREA-2.
 15117
 15118     MOVE SPACES                 TO EMI-ERROR-LINES.
 15119
 15120
 15121* EXEC CICS SYNCPOINT ROLLBACK
 15122*    END-EXEC.
 15123*    MOVE '6"R                   !   #00013524' TO DFHEIV0
 15124     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15126     MOVE X'2020233030303133353234' TO DFHEIV0(25:11)
 15127     CALL 'kxdfhei1' USING DFHEIV0
 15128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 275
* EL6311.cbl
 15129
 15130
 15131     MOVE ER-2247                TO EMI-ERROR.
 15132     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15133     GO TO 8200-SEND-DATAONLY.
 15134
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 276
* EL6311.cbl
 15136
 15137******************************************************************
 15138*                                                                *
 15139*          C H A N G E   C A N C E L   R O U T I N E             *
 15140*                                                                *
 15141******************************************************************
 15142
 15143***************************************************************
 15144*                                                             *
 15145*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15146*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15147*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15148*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15149*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15150*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15151*     5. LINK TO THE EDIT ROUTINE.                            *
 15152*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15153*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15154*              THE EDIT ROUTINE.                              *
 15155*     7. REWRITE THE NEW ISSUE                                *
 15156*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15157*                                                             *
 15158***************************************************************
 15159 2300-CHANGE-CANCEL-ROUTINE.
 15160     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15161
 15162     IF CCHGL NOT = ZEROS
 15163        MOVE ER-2196             TO EMI-ERROR
 15164        MOVE AL-UABON            TO CMAINTA
 15165        MOVE -1                  TO CMAINTL
 15166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15167        GO TO 8200-SEND-DATAONLY.
 15168
 15169     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15170
 15171     IF CSUFIXL NOT = ZEROS
 15172        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15173     ELSE
 15174        MOVE SPACE               TO WS-NEW-SUFFIX.
 15175
 15176     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15177     PERFORM 8600-DEEDIT.
 15178     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15179     MOVE '4'                    TO DC-OPTION-CODE.
 15180
 15181     PERFORM 9700-DATE-LINK.
 15182
 15183     IF DATE-CONVERSION-ERROR
 15184        MOVE ER-0348             TO EMI-ERROR
 15185        MOVE -1                  TO CEFFDTL
 15186        MOVE AL-UABON            TO CEFFDTA
 15187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15188        GO TO 8200-SEND-DATAONLY
 15189     ELSE
 15190        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15191        MOVE AL-UANON            TO CEFFDTA
 15192        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15193
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 277
* EL6311.cbl
 15194 2325-PROCESS-CANCEL-CHANGES.
 15195
 15196* EXEC CICS HANDLE CONDITION
 15197*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15198*    END-EXEC.
 15199*    MOVE '"$I                   ! 5 #00013591' TO DFHEIV0
 15200     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15201     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15202     MOVE X'3520233030303133353931' TO DFHEIV0(25:11)
 15203     CALL 'kxdfhei1' USING DFHEIV0
 15204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15205
 15206
 15207     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15208     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15209     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15210
 15211
 15212* EXEC CICS GETMAIN
 15213*        SET      (ADDRESS OF PENDING-BUSINESS)
 15214*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15215*        INITIMG  (GETMAIN-SPACE)
 15216*     END-EXEC.
 15217*    MOVE ',"IL                  $   #00013599' TO DFHEIV0
 15218     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15220     MOVE X'2020233030303133353939' TO DFHEIV0(25:11)
 15221     CALL 'kxdfhei1' USING DFHEIV0,
 15222           DFHEIV20,
 15223           ERPNDB-RECORD-LENGTH,
 15224           GETMAIN-SPACE
 15225     SET ADDRESS OF PENDING-BUSINESS TO
 15226         DFHEIV20
 15227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15228
 15229
 15230
 15231* EXEC CICS READ
 15232*        INTO    (PENDING-BUSINESS)
 15233*        DATASET (FILE-ID-ERPNDB)
 15234*        RIDFLD  (ERPNDB-KEY)
 15235*    END-EXEC.
 15236     MOVE LENGTH OF
 15237      PENDING-BUSINESS
 15238       TO DFHEIV11
 15239*    MOVE '&"IL       E          (   #00013605' TO DFHEIV0
 15240     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15242     MOVE X'2020233030303133363035' TO DFHEIV0(25:11)
 15243     CALL 'kxdfhei1' USING DFHEIV0,
 15244           FILE-ID-ERPNDB,
 15245           PENDING-BUSINESS,
 15246           DFHEIV11,
 15247           ERPNDB-KEY,
 15248           DFHEIV99,
 15249           DFHEIV99,
 15250           DFHEIV99
 15251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 278
* EL6311.cbl
 15252
 15253
 15254     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15255
 15256
 15257* EXEC CICS HANDLE CONDITION
 15258*         NOTFND     (2385-REC-NOT-FOUND)
 15259*    END-EXEC.
 15260*    MOVE '"$I                   ! 6 #00013613' TO DFHEIV0
 15261     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15263     MOVE X'3620233030303133363133' TO DFHEIV0(25:11)
 15264     CALL 'kxdfhei1' USING DFHEIV0
 15265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15266
 15267
 15268**********************************************************
 15269*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15270*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15271**********************************************************
 15272
 15273
 15274* EXEC CICS READ
 15275*        DATASET (FILE-ID-ERPNDB)
 15276*        INTO    (PENDING-BUSINESS)
 15277*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15278*    END-EXEC.
 15279     MOVE LENGTH OF
 15280      PENDING-BUSINESS
 15281       TO DFHEIV11
 15282*    MOVE '&"IL       E          (   #00013622' TO DFHEIV0
 15283     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15285     MOVE X'2020233030303133363232' TO DFHEIV0(25:11)
 15286     CALL 'kxdfhei1' USING DFHEIV0,
 15287           FILE-ID-ERPNDB,
 15288           PENDING-BUSINESS,
 15289           DFHEIV11,
 15290           PI-PREV-CONTROL-PRIMARY,
 15291           DFHEIV99,
 15292           DFHEIV99,
 15293           DFHEIV99
 15294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15295
 15296
 15297********** DO NOT ALLOW CHANGES IF THRU A/R
 15298     IF BMAINTI = 'C'
 15299         IF PB-EL860-INTERNAL-PROCESS
 15300             MOVE ER-4005          TO EMI-ERROR
 15301             MOVE -1               TO BMAINTL
 15302             MOVE AL-UABON         TO BMAINTA
 15303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15304             GO TO 8200-SEND-DATAONLY.
 15305**********
 15306
 15307     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15308        MOVE -1                 TO CMAINTL
 15309        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 279
* EL6311.cbl
 15310        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15311        GO TO 8200-SEND-DATAONLY.
 15312
 15313     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15314        MOVE ER-2196             TO EMI-ERROR
 15315        MOVE AL-UABON            TO CMAINTA
 15316        MOVE -1                  TO CMAINTL
 15317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15318        GO TO 8200-SEND-DATAONLY.
 15319     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15320
 15321     IF PB-BILLED-DT = LOW-VALUES AND
 15322        PB-CHG-COUNT = ZEROS
 15323        NEXT SENTENCE
 15324     ELSE
 15325        IF (CREFND1L GREATER THAN ZEROS AND
 15326            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15327           OR
 15328           (CREFND2L GREATER THAN ZEROS AND
 15329            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15330           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15331     if ((crefnd1l <> zeros)
 15332        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15333                      or
 15334        ((crefnd2l <> zeros)
 15335        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15336        continue
 15337     else
 15338        go to 2330-continue-change
 15339     end-if
 15340
 15341     move zeros                  to ws-check-amts
 15342     move ' '                    to ws-stop-sw
 15343                                    ws-check-sw
 15344                                    ws-proc-check-sw
 15345                                    ws-chek-browse-sw
 15346
 15347     perform 2500-browse-checks  thru 2500-exit
 15348
 15349     if i-have-processed-checks
 15350        or i-have-checks
 15351        continue
 15352     else
 15353        go to 2330-continue-change
 15354     end-if
 15355
 15356     display ' pb lf can ' pb-c-lf-cancel-amt
 15357     display ' ws lf can ' ws-crefnd1
 15358     if crefnd1l <> zeros
 15359        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15360        move ws-crefnd1 to ws-new-ref-total
 15361     else
 15362        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15363     end-if
 15364     display ' pb ah can ' pb-c-ah-cancel-amt
 15365     display ' ws ah can ' ws-crefnd2
 15366     display ' chk amts  ' ws-check-amts
 15367     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 280
* EL6311.cbl
 15368        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15369        compute ws-new-ref-total = ws-new-ref-total +
 15370           ws-crefnd2
 15371     else
 15372        compute ws-new-ref-total = ws-new-ref-total +
 15373           pb-c-ah-cancel-amt
 15374     end-if
 15375
 15376     if zeros = (ws-lf-diff + ws-ah-diff)
 15377        move er-3449             to emi-error
 15378        perform 9900-error-format thru 9900-exit
 15379        go to 2330-continue-change
 15380     end-if
 15381
 15382     if (ws-new-ref-total < ws-check-amts)
 15383        and (pb-c-refund-sw = 'Y')
 15384        move er-3447             to emi-error
 15385        perform 9900-error-format thru 9900-exit
 15386        move al-uabon            to cmainta
 15387        move -1                  to cmaintl
 15388        go to 8200-send-dataonly
 15389     end-if
 15390
 15391     if (ws-new-ref-total > ws-check-amts)
 15392        and (ws-check-amts not = zeros)
 15393        move er-3448             to emi-error
 15394        move al-uabon            to crefnd1a
 15395                                    crefnd2a
 15396        perform 9900-error-format thru 9900-exit
 15397     end-if
 15398
 15399*     if (ws-lf-diff + ws-ah-diff) < zeros
 15400*        move er-3447             to emi-error
 15401*        perform 9900-error-format thru 9900-exit
 15402*        move al-uabon            to cmainta
 15403*        move -1                  to cmaintl
 15404*        go to 8200-send-dataonly
 15405*     end-if
 15406     .
 15407 2330-continue-change.
 15408
 15409
 15410* EXEC CICS READ
 15411*        DATASET (FILE-ID-ERPNDB)
 15412*        INTO    (PENDING-BUSINESS)
 15413*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15414*        UPDATE
 15415*    END-EXEC.
 15416     MOVE LENGTH OF
 15417      PENDING-BUSINESS
 15418       TO DFHEIV11
 15419*    MOVE '&"IL       EU         (   #00013740' TO DFHEIV0
 15420     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15421     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15422     MOVE X'2020233030303133373430' TO DFHEIV0(25:11)
 15423     CALL 'kxdfhei1' USING DFHEIV0,
 15424           FILE-ID-ERPNDB,
 15425           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 281
* EL6311.cbl
 15426           DFHEIV11,
 15427           PI-PREV-CONTROL-PRIMARY,
 15428           DFHEIV99,
 15429           DFHEIV99,
 15430           DFHEIV99
 15431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15432
 15433
 15434     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15435     MOVE 'B'                    TO JP-RECORD-TYPE
 15436     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15437     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15438
 15439     PERFORM 8400-LOG-JOURNAL-RECORD.
 15440
 15441     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15442          PB-CHG-COUNT NOT = ZEROS
 15443        IF (CREFND1L GREATER THAN ZEROS AND
 15444            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15445           OR
 15446           (CREFND2L GREATER THAN ZEROS AND
 15447            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15448            ADD +1                      TO PB-CHG-COUNT
 15449            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15450
 15451*    IF CMICRNOL  GREATER  ZEROS
 15452*        IF CMICRNOI  NUMERIC
 15453*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15454*            MOVE AL-UNNON       TO  CMICRNOA
 15455*        ELSE
 15456*            MOVE -1             TO  CMICRNOL
 15457*            MOVE AL-UNBON       TO  CMICRNOA
 15458*            MOVE ER-2701        TO  EMI-ERROR
 15459*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15460
 15461     IF CSUFIXL GREATER THAN ZEROS
 15462        MOVE CSUFIXI             TO PB-CERT-SFX.
 15463
 15464     IF CLSTNML GREATER THAN ZEROS
 15465         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15466
 15467     IF CCANREAL > ZEROS
 15468        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15469     END-IF
 15470     IF CPCYNL > ZEROS
 15471        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15472     END-IF
 15473     IF CCANDT1L    GREATER THAN ZEROS
 15474        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15475
 15476     IF CCANDT2L    GREATER THAN ZEROS
 15477        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15478
 15479     IF CMTHD1L    GREATER THAN +0
 15480        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15481
 15482     IF CMTHD2L    GREATER THAN +0
 15483        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 282
* EL6311.cbl
 15484
 15485     IF CREFND1L    GREATER THAN ZEROS
 15486        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15487        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15488        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15489        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15490
 15491     IF CREFND2L    GREATER THAN ZEROS
 15492        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15493        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15494        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15495        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15496
 15497     IF CLIVESL     GREATER THAN ZEROS
 15498        MOVE WS-CLIVES           TO PB-C-LIVES.
 15499
 15500     IF CPAYEEL     GREATER THAN ZEROS
 15501        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15502
 15503     IF CFORCEL     GREATER THAN ZEROS
 15504        MOVE CFORCEI             TO PB-FORCE-CODE.
 15505
 15506     IF CBILCDL     GREATER THAN ZEROS
 15507        MOVE CBILCDI             TO PB-RECORD-BILL.
 15508
 15509 2360-REWRITE-PB-RECORD.
 15510     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15511     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15512     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15513     MOVE 'C'                    TO JP-RECORD-TYPE.
 15514     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15515     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15516     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15517
 15518     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15519
 15520     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15521     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15522
 15523     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15524
 15525     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15526
 15527     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15528     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15529     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15530
 15531     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15532     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15533
 15534 2375-REWRITE-PENDING-BUSINESS.
 15535     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15536     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15537     MOVE 'C'                    TO JP-RECORD-TYPE.
 15538     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15539
 15540
 15541* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 283
* EL6311.cbl
 15542*        DATASET (FILE-ID-ERPNDB)
 15543*        FROM    (PENDING-BUSINESS)
 15544*    END-EXEC.
 15545     MOVE LENGTH OF
 15546      PENDING-BUSINESS
 15547       TO DFHEIV11
 15548*    MOVE '&& L                  %   #00013853' TO DFHEIV0
 15549     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15550     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15551     MOVE X'2020233030303133383533' TO DFHEIV0(25:11)
 15552     CALL 'kxdfhei1' USING DFHEIV0,
 15553           FILE-ID-ERPNDB,
 15554           PENDING-BUSINESS,
 15555           DFHEIV11,
 15556           DFHEIV99
 15557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15558
 15559
 15560     PERFORM 8400-LOG-JOURNAL-RECORD.
 15561
 15562******************************************************************
 15563*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15564******************************************************************
 15565
 15566     display ' made it to update orig cancel cert '
 15567
 15568     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15569     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15570     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15571     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15572
 15573
 15574* EXEC CICS READ
 15575*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15576*        DATASET (FILE-ID-ELCERT)
 15577*        RIDFLD  (ELCERT-KEY)
 15578*        RESP    (WS-RESPONSE)
 15579*    END-EXEC.
 15580*    MOVE '&"S        E          (  N#00013871' TO DFHEIV0
 15581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15583     MOVE X'204E233030303133383731' TO DFHEIV0(25:11)
 15584     CALL 'kxdfhei1' USING DFHEIV0,
 15585           FILE-ID-ELCERT,
 15586           DFHEIV20,
 15587           DFHEIV99,
 15588           ELCERT-KEY,
 15589           DFHEIV99,
 15590           DFHEIV99,
 15591           DFHEIV99
 15592     SET ADDRESS OF CERTIFICATE-MASTER TO
 15593         DFHEIV20
 15594     MOVE EIBRESP  TO WS-RESPONSE
 15595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15596
 15597
 15598     IF NOT RESP-NORMAL
 15599        GO TO 2376-BYPASS-CRTO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 284
* EL6311.cbl
 15600     END-IF
 15601
 15602
 15603     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15604     MOVE ' '                    TO WS-ERMAIL-SW
 15605
 15606
 15607* EXEC CICS READ
 15608*       DATASET   (FILE-ID-ERMAIL)
 15609*       SET       (ADDRESS OF MAILING-DATA)
 15610*       RIDFLD    (ERMAIL-KEY)
 15611*       RESP      (WS-RESPONSE)
 15612*    END-EXEC
 15613*    MOVE '&"S        E          (  N#00013886' TO DFHEIV0
 15614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15616     MOVE X'204E233030303133383836' TO DFHEIV0(25:11)
 15617     CALL 'kxdfhei1' USING DFHEIV0,
 15618           FILE-ID-ERMAIL,
 15619           DFHEIV20,
 15620           DFHEIV99,
 15621           ERMAIL-KEY,
 15622           DFHEIV99,
 15623           DFHEIV99,
 15624           DFHEIV99
 15625     SET ADDRESS OF MAILING-DATA TO
 15626         DFHEIV20
 15627     MOVE EIBRESP  TO WS-RESPONSE
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15629
 15630     IF RESP-NORMAL
 15631        SET ERMAIL-FOUND TO TRUE
 15632     END-IF
 15633
 15634     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15635
 15636     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15637                                 TO ELCRTO-KEY
 15638     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15639     MOVE +0                     TO ELCRTO-SEQ-NO
 15640
 15641
 15642* EXEC CICS READ
 15643*       DATASET   ('ELCRTO')
 15644*       INTO      (ORIGINAL-CERTIFICATE)
 15645*       RIDFLD    (ELCRTO-KEY)
 15646*       GTEQ
 15647*       RESP      (WS-RESPONSE)
 15648*    END-EXEC
 15649     MOVE LENGTH OF
 15650      ORIGINAL-CERTIFICATE
 15651       TO DFHEIV11
 15652     MOVE 'ELCRTO' TO DFHEIV1
 15653*    MOVE '&"IL       G          (  N#00013904' TO DFHEIV0
 15654     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15656     MOVE X'204E233030303133393034' TO DFHEIV0(25:11)
 15657     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 285
* EL6311.cbl
 15658           DFHEIV1,
 15659           ORIGINAL-CERTIFICATE,
 15660           DFHEIV11,
 15661           ELCRTO-KEY,
 15662           DFHEIV99,
 15663           DFHEIV99,
 15664           DFHEIV99
 15665     MOVE EIBRESP  TO WS-RESPONSE
 15666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15667
 15668     display ' just read gteq ' ws-response
 15669     IF RESP-NORMAL
 15670        AND (OC-CONTROL-PRIMARY (1:33) =
 15671                 PB-CONTROL-BY-ACCOUNT (1:33))
 15672        AND (OC-RECORD-TYPE = 'I')
 15673        display ' resp norm, key =, type i '
 15674        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15675           display ' end proc blank '
 15676           display ' csr edit session ' PI-CSR-SESSION-SW
 15677           IF NOT CSR-EDIT-SESSION
 15678
 15679* EXEC CICS READ
 15680*                DATASET   ('ELCRTO')
 15681*                INTO      (ORIGINAL-CERTIFICATE)
 15682*                RIDFLD    (OC-CONTROL-PRIMARY)
 15683*                UPDATE
 15684*                RESP      (WS-RESPONSE)
 15685*             END-EXEC
 15686     MOVE LENGTH OF
 15687      ORIGINAL-CERTIFICATE
 15688       TO DFHEIV11
 15689     MOVE 'ELCRTO' TO DFHEIV1
 15690*    MOVE '&"IL       EU         (  N#00013922' TO DFHEIV0
 15691     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15692     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15693     MOVE X'204E233030303133393232' TO DFHEIV0(25:11)
 15694     CALL 'kxdfhei1' USING DFHEIV0,
 15695           DFHEIV1,
 15696           ORIGINAL-CERTIFICATE,
 15697           DFHEIV11,
 15698           OC-CONTROL-PRIMARY,
 15699           DFHEIV99,
 15700           DFHEIV99,
 15701           DFHEIV99
 15702     MOVE EIBRESP  TO WS-RESPONSE
 15703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15704              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15705              IF RESP-NORMAL
 15706                 display ' good read upd '
 15707                 IF OC-ISSUE-TRAN-IND = 'N'
 15708                    MOVE CM-INSURED-LAST-NAME   TO
 15709                         OC-INS-LAST-NAME
 15710                    MOVE CM-INSURED-FIRST-NAME  TO
 15711                         OC-INS-FIRST-NAME
 15712                    MOVE CM-INSURED-INITIAL2    TO
 15713                         OC-INS-MIDDLE-INIT
 15714                    MOVE CM-INSURED-ISSUE-AGE   TO
 15715                         OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 286
* EL6311.cbl
 15716                    MOVE CM-JT-LAST-NAME        TO
 15717                         OC-JNT-LAST-NAME
 15718                    MOVE CM-JT-FIRST-NAME       TO
 15719                         OC-JNT-FIRST-NAME
 15720                    MOVE CM-JT-INITIAL          TO
 15721                         OC-JNT-MIDDLE-INIT
 15722                    MOVE CM-INSURED-JOINT-AGE   TO
 15723                         OC-JNT-AGE
 15724                    MOVE CM-LF-BENEFIT-CD       TO
 15725                         OC-LF-BENCD
 15726                    MOVE CM-LF-ORIG-TERM        TO
 15727                         OC-LF-TERM
 15728                    MOVE CM-LF-BENEFIT-AMT      TO
 15729                         OC-LF-BEN-AMT
 15730                    MOVE CM-LF-PREMIUM-AMT      TO
 15731                         OC-LF-PRM-AMT
 15732                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15733                         OC-LF-ALT-BEN-AMT
 15734                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15735                         OC-LF-ALT-PRM-AMT
 15736                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15737                         OC-LF-EXP-DT
 15738                    MOVE CM-LIFE-COMM-PCT       TO
 15739                         OC-LF-COMM-PCT
 15740                    MOVE CM-AH-BENEFIT-CD       TO
 15741                         OC-AH-BENCD
 15742                    MOVE CM-AH-ORIG-TERM        TO
 15743                         OC-AH-TERM
 15744                    MOVE CM-AH-BENEFIT-AMT      TO
 15745                         OC-AH-BEN-AMT
 15746                    MOVE CM-AH-PREMIUM-AMT      TO
 15747                         OC-AH-PRM-AMT
 15748                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15749                         OC-AH-EXP-DT
 15750                    MOVE CM-AH-COMM-PCT         TO
 15751                         OC-AH-COMM-PCT
 15752                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15753                         OC-AH-CP
 15754                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15755                         OC-1ST-PMT-DT
 15756                 END-IF
 15757                 MOVE PB-C-LF-CANCEL-DT      TO
 15758                         OC-LF-CANCEL-DT
 15759                 MOVE PB-C-LF-CANCEL-AMT     TO
 15760                         OC-LF-CANCEL-AMT
 15761                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15762                         OC-LF-ITD-CANCEL-AMT
 15763                 MOVE PB-C-AH-CANCEL-DT      TO
 15764                         OC-AH-CANCEL-DT
 15765                 MOVE PB-C-AH-CANCEL-AMT     TO
 15766                         OC-AH-CANCEL-AMT
 15767                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15768                         OC-AH-ITD-CANCEL-AMT
 15769                 MOVE 'Y'                    TO
 15770                         OC-CANCEL-TRAN-IND
 15771                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15772                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15773                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 287
* EL6311.cbl
 15774                 IF ERMAIL-FOUND
 15775                    MOVE MA-CRED-BENE-NAME
 15776                                 TO OC-CRED-BENE-NAME
 15777                 END-IF
 15778                 IF NOT CERT-TRL-REC-NOT-FOUND
 15779                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15780                           OC-INS-AGE-DEFAULT-FLAG
 15781                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15782                           OC-JNT-AGE-DEFAULT-FLAG
 15783                 END-IF
 15784
 15785* EXEC CICS REWRITE
 15786*                   DATASET   ('ELCRTO')
 15787*                   FROM      (ORIGINAL-CERTIFICATE)
 15788*                   RESP      (WS-RESPONSE)
 15789*                END-EXEC
 15790     MOVE LENGTH OF
 15791      ORIGINAL-CERTIFICATE
 15792       TO DFHEIV11
 15793     MOVE 'ELCRTO' TO DFHEIV1
 15794*    MOVE '&& L                  %  N#00014009' TO DFHEIV0
 15795     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15796     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15797     MOVE X'204E233030303134303039' TO DFHEIV0(25:11)
 15798     CALL 'kxdfhei1' USING DFHEIV0,
 15799           DFHEIV1,
 15800           ORIGINAL-CERTIFICATE,
 15801           DFHEIV11,
 15802           DFHEIV99
 15803     MOVE EIBRESP  TO WS-RESPONSE
 15804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15805                 display ' just rewrote ' ws-response
 15806              END-IF
 15807           END-IF
 15808        ELSE
 15809           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15810           MOVE 'OC'             TO OC-RECORD-ID
 15811           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15812           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15813           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15814           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15815           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15816           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15817           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15818           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15819           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15820           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15821           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15822           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15823           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15824           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15825           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15826           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15827           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15828           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15829           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15830           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15831           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 288
* EL6311.cbl
 15832           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15833           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15834           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15835           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15836           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15837           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15838           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15839           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15840           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15841           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15842           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15843           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15844           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15845           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15846           IF ERMAIL-FOUND
 15847              MOVE MA-CRED-BENE-NAME
 15848                                 TO OC-CRED-BENE-NAME
 15849           END-IF
 15850           IF NOT CERT-TRL-REC-NOT-FOUND
 15851              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15852                           OC-INS-AGE-DEFAULT-FLAG
 15853              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15854                           OC-JNT-AGE-DEFAULT-FLAG
 15855           END-IF
 15856           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15857
 15858* EXEC CICS WRITE
 15859*             DATASET   ('ELCRTO')
 15860*             FROM      (ORIGINAL-CERTIFICATE)
 15861*             RIDFLD    (OC-CONTROL-PRIMARY)
 15862*             RESP      (WS-RESPONSE)
 15863*          END-EXEC
 15864     MOVE LENGTH OF
 15865      ORIGINAL-CERTIFICATE
 15866       TO DFHEIV11
 15867     MOVE 'ELCRTO' TO DFHEIV1
 15868*    MOVE '&$ L                  ''  N#00014066' TO DFHEIV0
 15869     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15870     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15871     MOVE X'204E233030303134303636' TO DFHEIV0(25:11)
 15872     CALL 'kxdfhei1' USING DFHEIV0,
 15873           DFHEIV1,
 15874           ORIGINAL-CERTIFICATE,
 15875           DFHEIV11,
 15876           OC-CONTROL-PRIMARY,
 15877           DFHEIV99,
 15878           DFHEIV99
 15879     MOVE EIBRESP  TO WS-RESPONSE
 15880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15881        END-IF
 15882     ELSE
 15883        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15884        MOVE 'OC'                TO OC-RECORD-ID
 15885        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15886                                 TO OC-CONTROL-PRIMARY (1:33)
 15887        MOVE 'I'                 TO OC-RECORD-TYPE
 15888        MOVE +4096               TO OC-KEY-SEQ-NO
 15889        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 289
* EL6311.cbl
 15890        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15891        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15892        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15893        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15894        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15895        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15896        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15897        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15898        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15899        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15900        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15901        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15902        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15903        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15904        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15905        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15906        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15907        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15908        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15909        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15910        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15911        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15912        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15913        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15914        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15915        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15916        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15917        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15918        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15919        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15920        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15921        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15922        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15923        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15924        IF ERMAIL-FOUND
 15925           MOVE MA-CRED-BENE-NAME
 15926                                 TO OC-CRED-BENE-NAME
 15927        END-IF
 15928        IF NOT CERT-TRL-REC-NOT-FOUND
 15929           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15930                           OC-INS-AGE-DEFAULT-FLAG
 15931           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15932                           OC-JNT-AGE-DEFAULT-FLAG
 15933        END-IF
 15934        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15935
 15936
 15937* EXEC CICS WRITE
 15938*          DATASET   ('ELCRTO')
 15939*          FROM      (ORIGINAL-CERTIFICATE)
 15940*          RIDFLD    (OC-CONTROL-PRIMARY)
 15941*          RESP      (WS-RESPONSE)
 15942*       END-EXEC
 15943     MOVE LENGTH OF
 15944      ORIGINAL-CERTIFICATE
 15945       TO DFHEIV11
 15946     MOVE 'ELCRTO' TO DFHEIV1
 15947*    MOVE '&$ L                  ''  N#00014127' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 290
* EL6311.cbl
 15948     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15950     MOVE X'204E233030303134313237' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0,
 15952           DFHEIV1,
 15953           ORIGINAL-CERTIFICATE,
 15954           DFHEIV11,
 15955           OC-CONTROL-PRIMARY,
 15956           DFHEIV99,
 15957           DFHEIV99
 15958     MOVE EIBRESP  TO WS-RESPONSE
 15959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15960     END-IF.
 15961
 15962 2376-BYPASS-CRTO.
 15963******************************************************************
 15964*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15965******************************************************************
 15966
 15967
 15968* EXEC CICS HANDLE CONDITION
 15969*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15970*    END-EXEC.
 15971*    MOVE '"$I                   ! 7 #00014140' TO DFHEIV0
 15972     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15974     MOVE X'3720233030303134313430' TO DFHEIV0(25:11)
 15975     CALL 'kxdfhei1' USING DFHEIV0
 15976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15977
 15978
 15979
 15980* EXEC CICS READ
 15981*        INTO    (PENDING-BUSINESS)
 15982*        DATASET (FILE-ID-ERPNDB)
 15983*        RIDFLD  (ERPNDB-KEY)
 15984*        UPDATE
 15985*    END-EXEC.
 15986     MOVE LENGTH OF
 15987      PENDING-BUSINESS
 15988       TO DFHEIV11
 15989*    MOVE '&"IL       EU         (   #00014144' TO DFHEIV0
 15990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15991     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15992     MOVE X'2020233030303134313434' TO DFHEIV0(25:11)
 15993     CALL 'kxdfhei1' USING DFHEIV0,
 15994           FILE-ID-ERPNDB,
 15995           PENDING-BUSINESS,
 15996           DFHEIV11,
 15997           ERPNDB-KEY,
 15998           DFHEIV99,
 15999           DFHEIV99,
 16000           DFHEIV99
 16001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16002
 16003
 16004     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16005     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 291
* EL6311.cbl
 16006     MOVE 'B'                    TO JP-RECORD-TYPE.
 16007     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16008
 16009     PERFORM 8400-LOG-JOURNAL-RECORD.
 16010
 16011     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16012
 16013
 16014* EXEC CICS REWRITE
 16015*        DATASET (FILE-ID-ERPNDB)
 16016*        FROM    (PENDING-BUSINESS)
 16017*    END-EXEC.
 16018     MOVE LENGTH OF
 16019      PENDING-BUSINESS
 16020       TO DFHEIV11
 16021*    MOVE '&& L                  %   #00014160' TO DFHEIV0
 16022     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16023     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16024     MOVE X'2020233030303134313630' TO DFHEIV0(25:11)
 16025     CALL 'kxdfhei1' USING DFHEIV0,
 16026           FILE-ID-ERPNDB,
 16027           PENDING-BUSINESS,
 16028           DFHEIV11,
 16029           DFHEIV99
 16030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16031
 16032
 16033     MOVE 'C'                    TO JP-RECORD-TYPE.
 16034     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16035
 16036     PERFORM 8400-LOG-JOURNAL-RECORD.
 16037
 16038     IF WS-ERRORS-PRESENT
 16039         GO TO 3900-RE-DISPLAY-RECORD.
 16040
 16041     MOVE ZEROS                  TO EMI-ERROR
 16042     MOVE -1                     TO CMAINTL
 16043     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16044     GO TO 3900-RE-DISPLAY-RECORD.
 16045
 16046 2380-BATCH-HDR-NOT-FOUND.
 16047     MOVE -1                     TO BMAINTL.
 16048     MOVE ER-7450                TO EMI-ERROR.
 16049     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16050     GO TO 8200-SEND-DATAONLY.
 16051
 16052 2385-REC-NOT-FOUND.
 16053     MOVE -1                     TO BMAINTL.
 16054     MOVE ER-7451                TO EMI-ERROR.
 16055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16056     GO TO 8200-SEND-DATAONLY.
 16057
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 292
* EL6311.cbl
 16059
 16060******************************************************************
 16061*                                                                *
 16062*          D E L E T E   C A N C E L   R O U T I N E             *
 16063*                                                                *
 16064******************************************************************
 16065
 16066 2400-DELETE-CANCEL-ROUTINE.
 16067     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16068
 16069     IF CCHGL NOT = ZEROS
 16070        MOVE ER-2196             TO EMI-ERROR
 16071        MOVE AL-UABON            TO CMAINTA
 16072        MOVE -1                  TO CMAINTL
 16073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16074        GO TO 8200-SEND-DATAONLY.
 16075
 16076
 16077* EXEC CICS HANDLE CONDITION
 16078*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16079*    END-EXEC.
 16080*    MOVE '"$I                   ! 8 #00014208' TO DFHEIV0
 16081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16083     MOVE X'3820233030303134323038' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0
 16085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16086
 16087
 16088     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16089     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16090     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16091
 16092
 16093* EXEC CICS READ
 16094*        SET     (ADDRESS OF PENDING-BUSINESS)
 16095*        DATASET (FILE-ID-ERPNDB)
 16096*        RIDFLD  (ERPNDB-KEY)
 16097*    END-EXEC.
 16098*    MOVE '&"S        E          (   #00014216' TO DFHEIV0
 16099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16101     MOVE X'2020233030303134323136' TO DFHEIV0(25:11)
 16102     CALL 'kxdfhei1' USING DFHEIV0,
 16103           FILE-ID-ERPNDB,
 16104           DFHEIV20,
 16105           DFHEIV99,
 16106           ERPNDB-KEY,
 16107           DFHEIV99,
 16108           DFHEIV99,
 16109           DFHEIV99
 16110     SET ADDRESS OF PENDING-BUSINESS TO
 16111         DFHEIV20
 16112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16113
 16114
 16115     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16116
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 293
* EL6311.cbl
 16117     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16118
 16119     IF CSUFIXL NOT = ZEROS
 16120        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16121     ELSE
 16122        MOVE SPACE               TO WS-NEW-SUFFIX.
 16123
 16124     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16125
 16126     PERFORM 8600-DEEDIT.
 16127     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16128     MOVE '4'                    TO DC-OPTION-CODE.
 16129     PERFORM 9700-DATE-LINK.
 16130
 16131     IF DATE-CONVERSION-ERROR
 16132        MOVE ER-0348             TO EMI-ERROR
 16133        MOVE -1                  TO CEFFDTL
 16134        MOVE AL-UABON            TO CEFFDTA
 16135        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16136        GO TO 8200-SEND-DATAONLY
 16137     ELSE
 16138        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16139        MOVE AL-UANON            TO CEFFDTA
 16140        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16141
 16142
 16143* EXEC CICS HANDLE CONDITION
 16144*         NOTFND    (2490-RECORD-NOT-FOUND)
 16145*    END-EXEC.
 16146*    MOVE '"$I                   ! 9 #00014249' TO DFHEIV0
 16147     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16149     MOVE X'3920233030303134323439' TO DFHEIV0(25:11)
 16150     CALL 'kxdfhei1' USING DFHEIV0
 16151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16152
 16153
 16154
 16155* EXEC CICS READ
 16156*        SET     (ADDRESS OF PENDING-BUSINESS)
 16157*        DATASET (FILE-ID-ERPNDB)
 16158*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16159*        UPDATE
 16160*    END-EXEC.
 16161*    MOVE '&"S        EU         (   #00014253' TO DFHEIV0
 16162     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16163     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16164     MOVE X'2020233030303134323533' TO DFHEIV0(25:11)
 16165     CALL 'kxdfhei1' USING DFHEIV0,
 16166           FILE-ID-ERPNDB,
 16167           DFHEIV20,
 16168           DFHEIV99,
 16169           PI-PREV-CONTROL-PRIMARY,
 16170           DFHEIV99,
 16171           DFHEIV99,
 16172           DFHEIV99
 16173     SET ADDRESS OF PENDING-BUSINESS TO
 16174         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 294
* EL6311.cbl
 16175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16176
 16177
 16178     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16179        MOVE -1                 TO CMAINTL
 16180        MOVE ER-2197            TO EMI-ERROR
 16181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16182        GO TO 8200-SEND-DATAONLY.
 16183
 16184     IF PB-BILLED-DT NOT = LOW-VALUES
 16185        MOVE -1                 TO CMAINTL
 16186        MOVE ER-2129            TO EMI-ERROR
 16187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16188        GO TO 8200-SEND-DATAONLY.
 16189
 16190     IF PB-CHG-COUNT NOT = ZEROS
 16191        MOVE ER-2336            TO EMI-ERROR
 16192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16193        MOVE AL-UABON            TO CMAINTA
 16194        MOVE -1                  TO CMAINTL
 16195        GO TO 8200-SEND-DATAONLY.
 16196
 16197     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16198        PB-CHG-COUNT NOT = ZEROS
 16199        MOVE ER-2196             TO EMI-ERROR
 16200        MOVE AL-UABON            TO CMAINTA
 16201        MOVE -1                  TO CMAINTL
 16202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16203        GO TO 8200-SEND-DATAONLY.
 16204
 16205     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16206        MOVE ER-2900 TO EMI-ERROR
 16207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16208        MOVE AL-UABON         TO CMAINTA
 16209        MOVE -1               TO CMAINTL
 16210        GO TO 8200-SEND-DATAONLY.
 16211     move ' '                    to ws-stop-sw
 16212                                    ws-check-sw
 16213                                    ws-proc-check-sw
 16214                                    ws-chek-browse-sw
 16215
 16216     perform 2500-browse-checks  thru 2500-exit
 16217     if (i-have-processed-checks)
 16218        and (pb-c-refund-sw = 'Y')
 16219        move er-3446             to emi-error
 16220        perform 9900-error-format thru 9900-exit
 16221        move al-uabon            to cmainta
 16222        move -1                  to cmaintl
 16223        go to 8200-send-dataonly
 16224     end-if
 16225
 16226* EXEC CICS HANDLE CONDITION
 16227*         NOTFND  (2475-CONTINUE-DELETE)
 16228*    END-EXEC
 16229*    MOVE '"$I                   ! : #00014307' TO DFHEIV0
 16230     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16232     MOVE X'3A20233030303134333037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 295
* EL6311.cbl
 16233     CALL 'kxdfhei1' USING DFHEIV0
 16234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16235
 16236     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16237     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16238     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16239     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16240
 16241
 16242* EXEC CICS READ
 16243*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16244*        DATASET (FILE-ID-ELCERT)
 16245*        RIDFLD  (ELCERT-KEY)
 16246*        UPDATE
 16247*    END-EXEC.
 16248*    MOVE '&"S        EU         (   #00014316' TO DFHEIV0
 16249     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16250     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16251     MOVE X'2020233030303134333136' TO DFHEIV0(25:11)
 16252     CALL 'kxdfhei1' USING DFHEIV0,
 16253           FILE-ID-ELCERT,
 16254           DFHEIV20,
 16255           DFHEIV99,
 16256           ELCERT-KEY,
 16257           DFHEIV99,
 16258           DFHEIV99,
 16259           DFHEIV99
 16260     SET ADDRESS OF CERTIFICATE-MASTER TO
 16261         DFHEIV20
 16262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16263
 16264
 16265     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16266
 16267     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16268     MOVE 'B'                    TO JP-RECORD-TYPE.
 16269     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16270     PERFORM 8400-LOG-JOURNAL-RECORD.
 16271
 16272     IF PB-CI-LIVES NOT NUMERIC
 16273         MOVE ZERO                    TO PB-CI-LIVES.
 16274
 16275     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16276        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16277           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16278           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16279           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16280                                            CM-LF-CANCEL-DT
 16281           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16282        ELSE
 16283           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16284           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16285           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16286           MOVE PB-CI-LIVES              TO CM-LIVES.
 16287
 16288     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16289        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16290           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 296
* EL6311.cbl
 16291               MOVE CM-LF-STATUS-AT-CANCEL
 16292                                        TO CM-LF-CURRENT-STATUS
 16293               MOVE SPACE
 16294                                        TO CM-LF-STATUS-AT-CANCEL
 16295           ELSE
 16296               MOVE PB-CI-LF-POLICY-STATUS
 16297                                        TO CM-LF-CURRENT-STATUS
 16298        ELSE
 16299           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16300
 16301
 16302     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16303        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16304           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16305           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16306           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16307                                            CM-AH-CANCEL-DT
 16308           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16309        ELSE
 16310           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16311           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16312           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16313           MOVE PB-CI-LIVES              TO CM-LIVES.
 16314
 16315     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16316        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16317           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16318               MOVE CM-AH-STATUS-AT-CANCEL
 16319                                        TO CM-AH-CURRENT-STATUS
 16320               MOVE SPACE
 16321                                        TO CM-AH-STATUS-AT-CANCEL
 16322           ELSE
 16323               MOVE PB-CI-AH-POLICY-STATUS
 16324                                        TO CM-AH-CURRENT-STATUS
 16325        ELSE
 16326           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16327
 16328 2450-REWRITE-CERT.
 16329     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16330     MOVE 'C'                      TO JP-RECORD-TYPE.
 16331     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16332
 16333
 16334* EXEC CICS REWRITE
 16335*        DATASET  (FILE-ID-ELCERT)
 16336*        FROM     (CERTIFICATE-MASTER)
 16337*    END-EXEC.
 16338     MOVE LENGTH OF
 16339      CERTIFICATE-MASTER
 16340       TO DFHEIV11
 16341*    MOVE '&& L                  %   #00014391' TO DFHEIV0
 16342     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16343     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16344     MOVE X'2020233030303134333931' TO DFHEIV0(25:11)
 16345     CALL 'kxdfhei1' USING DFHEIV0,
 16346           FILE-ID-ELCERT,
 16347           CERTIFICATE-MASTER,
 16348           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 297
* EL6311.cbl
 16349           DFHEIV99
 16350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16351
 16352
 16353     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16354
 16355     PERFORM 8400-LOG-JOURNAL-RECORD.
 16356
 16357     move ' '                    to ws-stop-sw
 16358                                    ws-proc-check-sw
 16359                                    ws-chek-browse-sw
 16360
 16361     if i-have-checks
 16362        perform until i-say-stop
 16363           perform 2510-startbr-erchek
 16364                                 thru 2510-exit
 16365           if resp-normal
 16366              perform 2520-readnext-erchek
 16367                                 thru 2520-exit
 16368           end-if
 16369           if (not resp-normal)
 16370              or (pb-control-by-account (1:33) not =
 16371                 ch-control-primary (1:33))
 16372                 set i-say-stop to true
 16373           else
 16374              perform 2530-readupd-erchek
 16375                                 thru 2530-exit
 16376              if resp-normal
 16377                 perform 2540-delete-erchek
 16378                                 thru 2540-exit
 16379              end-if
 16380              if ws-chek-browse-sw = 'Y'
 16381                 perform 2525-endbr-erchek
 16382                                 thru 2525-exit
 16383                 move ' '        to ws-chek-browse-sw
 16384              end-if
 16385           end-if
 16386        end-perform
 16387     end-if
 16388
 16389     if ws-chek-browse-sw = 'Y'
 16390        perform 2525-endbr-erchek thru 2525-exit
 16391     end-if
 16392     .
 16393 2475-CONTINUE-DELETE.
 16394     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16395     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16396
 16397     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16398     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16399
 16400     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16401
 16402     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16403     MOVE 'D'                    TO JP-RECORD-TYPE
 16404     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16405
 16406
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 298
* EL6311.cbl
 16407* EXEC CICS DELETE
 16408*        DATASET    (FILE-ID-ERPNDB)
 16409*    END-EXEC.
 16410*    MOVE '&(                    &   #00014449' TO DFHEIV0
 16411     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16412     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16413     MOVE X'2020233030303134343439' TO DFHEIV0(25:11)
 16414     CALL 'kxdfhei1' USING DFHEIV0,
 16415           FILE-ID-ERPNDB,
 16416           DFHEIV99,
 16417           DFHEIV99,
 16418           DFHEIV99,
 16419           DFHEIV99
 16420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16421
 16422
 16423     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16424
 16425     PERFORM 8400-LOG-JOURNAL-RECORD.
 16426
 16427     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16428     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16429
 16430
 16431* EXEC CICS HANDLE CONDITION
 16432*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16433*    END-EXEC.
 16434*    MOVE '"$I                   ! ; #00014460' TO DFHEIV0
 16435     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16437     MOVE X'3B20233030303134343630' TO DFHEIV0(25:11)
 16438     CALL 'kxdfhei1' USING DFHEIV0
 16439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16440
 16441
 16442
 16443* EXEC CICS READ
 16444*        SET     (ADDRESS OF PENDING-BUSINESS)
 16445*        DATASET (FILE-ID-ERPNDB)
 16446*        RIDFLD  (ERPNDB-KEY)
 16447*        UPDATE
 16448*    END-EXEC.
 16449*    MOVE '&"S        EU         (   #00014464' TO DFHEIV0
 16450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16451     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16452     MOVE X'2020233030303134343634' TO DFHEIV0(25:11)
 16453     CALL 'kxdfhei1' USING DFHEIV0,
 16454           FILE-ID-ERPNDB,
 16455           DFHEIV20,
 16456           DFHEIV99,
 16457           ERPNDB-KEY,
 16458           DFHEIV99,
 16459           DFHEIV99,
 16460           DFHEIV99
 16461     SET ADDRESS OF PENDING-BUSINESS TO
 16462         DFHEIV20
 16463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16464
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 299
* EL6311.cbl
 16465
 16466     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16467     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16468
 16469     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16470        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16471        MOVE 'D'                 TO JP-RECORD-TYPE
 16472        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16473
 16474* EXEC CICS DELETE
 16475*            DATASET    (FILE-ID-ERPNDB)
 16476*       END-EXEC
 16477*    MOVE '&(                    &   #00014478' TO DFHEIV0
 16478     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16479     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16480     MOVE X'2020233030303134343738' TO DFHEIV0(25:11)
 16481     CALL 'kxdfhei1' USING DFHEIV0,
 16482           FILE-ID-ERPNDB,
 16483           DFHEIV99,
 16484           DFHEIV99,
 16485           DFHEIV99,
 16486           DFHEIV99
 16487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16488        PERFORM 8400-LOG-JOURNAL-RECORD
 16489     ELSE
 16490        MOVE 'B'                 TO JP-RECORD-TYPE
 16491        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16492        PERFORM 8400-LOG-JOURNAL-RECORD
 16493        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16494        MOVE 'C'                 TO JP-RECORD-TYPE
 16495        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16496
 16497* EXEC CICS REWRITE
 16498*            DATASET    (FILE-ID-ERPNDB)
 16499*            FROM       (PENDING-BUSINESS)
 16500*       END-EXEC
 16501     MOVE LENGTH OF
 16502      PENDING-BUSINESS
 16503       TO DFHEIV11
 16504*    MOVE '&& L                  %   #00014489' TO DFHEIV0
 16505     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16506     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16507     MOVE X'2020233030303134343839' TO DFHEIV0(25:11)
 16508     CALL 'kxdfhei1' USING DFHEIV0,
 16509           FILE-ID-ERPNDB,
 16510           PENDING-BUSINESS,
 16511           DFHEIV11,
 16512           DFHEIV99
 16513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16514        PERFORM 8400-LOG-JOURNAL-RECORD.
 16515
 16516******************************************************************
 16517*                                                                *
 16518*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16519*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16520*                                                                *
 16521******************************************************************
 16522
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 300
* EL6311.cbl
 16523     IF NOT PI-AR-PROCESSING
 16524        GO TO 2480-DELETE-FINISHED.
 16525
 16526     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16527        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16528        NEXT SENTENCE
 16529     ELSE
 16530        GO TO 2480-DELETE-FINISHED.
 16531
 16532
 16533* EXEC CICS HANDLE CONDITION
 16534*         NOTFND    (2480-DELETE-FINISHED)
 16535*    END-EXEC.
 16536*    MOVE '"$I                   ! < #00014511' TO DFHEIV0
 16537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16539     MOVE X'3C20233030303134353131' TO DFHEIV0(25:11)
 16540     CALL 'kxdfhei1' USING DFHEIV0
 16541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16542
 16543
 16544     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16545     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16546
 16547
 16548* EXEC CICS READ
 16549*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16550*        DATASET (FILE-ID-ERRQST)
 16551*        RIDFLD  (ERRQST-KEY)
 16552*        UPDATE
 16553*    END-EXEC.
 16554*    MOVE '&"S        EU         (   #00014518' TO DFHEIV0
 16555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16556     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16557     MOVE X'2020233030303134353138' TO DFHEIV0(25:11)
 16558     CALL 'kxdfhei1' USING DFHEIV0,
 16559           FILE-ID-ERRQST,
 16560           DFHEIV20,
 16561           DFHEIV99,
 16562           ERRQST-KEY,
 16563           DFHEIV99,
 16564           DFHEIV99,
 16565           DFHEIV99
 16566     SET ADDRESS OF AR-REQUEST-RECORD TO
 16567         DFHEIV20
 16568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16569
 16570
 16571     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16572
 16573     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16574
 16575     MOVE 'D'                      TO JP-RECORD-TYPE.
 16576     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16577
 16578
 16579* EXEC CICS DELETE
 16580*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 301
* EL6311.cbl
 16581*    END-EXEC.
 16582*    MOVE '&(                    &   #00014532' TO DFHEIV0
 16583     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16585     MOVE X'2020233030303134353332' TO DFHEIV0(25:11)
 16586     CALL 'kxdfhei1' USING DFHEIV0,
 16587           FILE-ID-ERRQST,
 16588           DFHEIV99,
 16589           DFHEIV99,
 16590           DFHEIV99,
 16591           DFHEIV99
 16592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16593
 16594
 16595     PERFORM 8400-LOG-JOURNAL-RECORD.
 16596
 16597 2480-DELETE-FINISHED.
 16598     MOVE ZEROS                  TO EMI-ERROR.
 16599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16600     MOVE LOW-VALUES             TO EL631CI.
 16601     MOVE -1                     TO CMAINTL.
 16602     GO TO 8100-SEND-INITIAL-MAP.
 16603
 16604 2485-BATCH-HDR-NOT-FOUND.
 16605     MOVE -1                     TO CMAINTL
 16606     MOVE AL-UABON               TO CMAINTA.
 16607     MOVE ER-7450                TO EMI-ERROR.
 16608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16609     GO TO 8200-SEND-DATAONLY.
 16610
 16611 2490-RECORD-NOT-FOUND.
 16612     MOVE -1                     TO CMAINTL
 16613     MOVE AL-UABON               TO CMAINTA.
 16614     MOVE ER-7451                TO EMI-ERROR.
 16615     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16616     GO TO 8200-SEND-DATAONLY.
 16617***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16618***                                                            ***
 16619***     2500  B R O W S E   C H E C K S                        ***
 16620***  We perform this routine from 2 different places.          ***
 16621***  1. If the user changes the refund amount on a cancel, we  ***
 16622***    want to.........                                        ***
 16623***    a. determine if prior checks have been processed        ***
 16624***    b. If the amt is larger, display message instructing    ***
 16625***     them to create another check to make up the difference.***
 16626***    c. If the amt is less, do not allow the change and      ***
 16627***     display a FATAL error suggesting they deal with check  ***
 16628***     records befor continuing.                              ***
 16629***  2. If the user wants to delete a cancel record we......   ***
 16630***    a. browse through all the checks and if there is a      ***
 16631***     processed check, send FATAL message.                   ***
 16632***    b. If there is a non-released check, then delete that   ***
 16633***     check after you delete the pending cancel record.      ***
 16634***                                                            ***
 16635***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16636
 16637 2500-browse-checks.
 16638
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 302
* EL6311.cbl
 16639     perform 2510-startbr-erchek thru 2510-exit
 16640
 16641     if not resp-normal
 16642        go to 2500-exit
 16643     end-if
 16644
 16645     perform until i-say-stop
 16646        perform 2520-readnext-erchek
 16647                                 thru 2520-exit
 16648        if (not resp-normal)
 16649           or (pb-control-by-account (1:33) not =
 16650              ch-control-primary (1:33))
 16651              set i-say-stop to true
 16652        else
 16653           if (ch-approval-status) = ' '
 16654              and (ch-void-dt = low-values)
 16655              and (ch-released-dt = low-values)
 16656              set i-have-checks to true
 16657           else
 16658              if ch-void-dt = low-values
 16659                 set i-have-processed-checks to true
 16660              end-if
 16661           end-if
 16662           if (ch-credit-accept-dt = low-values)
 16663              and (ch-void-dt = low-values)
 16664              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16665              compute ws-check-amts = ws-check-amts +
 16666                 ch-amount-paid
 16667           end-if
 16668        end-if
 16669     end-perform
 16670
 16671     if ws-chek-browse-sw = 'Y'
 16672        perform 2525-endbr-erchek thru 2525-exit
 16673     end-if
 16674
 16675    .
 16676 2500-exit.
 16677     exit.
 16678
 16679 2510-startbr-erchek.
 16680
 16681     move pb-control-by-account  to erchek-key
 16682     move +0                     to chek-record-seq
 16683
 16684
 16685* exec cics startbr
 16686*       dataset   ('ERCHEK')
 16687*       ridfld    (erchek-key)
 16688*       gteq
 16689*       resp      (ws-response)
 16690*    end-exec
 16691     MOVE 'ERCHEK' TO DFHEIV1
 16692     MOVE 0
 16693       TO DFHEIV11
 16694*    MOVE '&,         G          &  N#00014625' TO DFHEIV0
 16695     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 303
* EL6311.cbl
 16697     MOVE X'204E233030303134363235' TO DFHEIV0(25:11)
 16698     CALL 'kxdfhei1' USING DFHEIV0,
 16699           DFHEIV1,
 16700           erchek-key,
 16701           DFHEIV99,
 16702           DFHEIV11,
 16703           DFHEIV99
 16704     MOVE EIBRESP  TO ws-response
 16705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16706
 16707     IF RESP-NORMAL
 16708        move 'Y'                 to ws-chek-browse-sw
 16709     end-if
 16710
 16711     .
 16712 2510-exit.
 16713     exit.
 16714
 16715 2520-readnext-erchek.
 16716
 16717
 16718* EXEC CICS READNEXT
 16719*       SET     (ADDRESS OF CHECK-RECORDS)
 16720*       DATASET ('ERCHEK')
 16721*       RIDFLD  (ERCHEK-KEY)
 16722*       RESP    (WS-RESPONSE)
 16723*    END-EXEC
 16724     MOVE 'ERCHEK' TO DFHEIV1
 16725     MOVE 0
 16726       TO DFHEIV11
 16727*    MOVE '&.S                   )  N#00014642' TO DFHEIV0
 16728     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16730     MOVE X'204E233030303134363432' TO DFHEIV0(25:11)
 16731     CALL 'kxdfhei1' USING DFHEIV0,
 16732           DFHEIV1,
 16733           DFHEIV20,
 16734           DFHEIV99,
 16735           ERCHEK-KEY,
 16736           DFHEIV99,
 16737           DFHEIV11,
 16738           DFHEIV99,
 16739           DFHEIV99
 16740     SET ADDRESS OF CHECK-RECORDS TO
 16741         DFHEIV20
 16742     MOVE EIBRESP  TO WS-RESPONSE
 16743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16744
 16745     .
 16746 2520-exit.
 16747     exit.
 16748
 16749 2525-endbr-erchek.
 16750
 16751
 16752* exec cics endbr
 16753*       dataset  ('ERCHEK')
 16754*    end-exec
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 304
* EL6311.cbl
 16755     MOVE 'ERCHEK' TO DFHEIV1
 16756     MOVE 0
 16757       TO DFHEIV11
 16758*    MOVE '&2                    $   #00014655' TO DFHEIV0
 16759     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16760     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16761     MOVE X'2020233030303134363535' TO DFHEIV0(25:11)
 16762     CALL 'kxdfhei1' USING DFHEIV0,
 16763           DFHEIV1,
 16764           DFHEIV11,
 16765           DFHEIV99
 16766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16767
 16768     .
 16769 2525-exit.
 16770     exit.
 16771
 16772 2530-readupd-erchek.
 16773
 16774
 16775* EXEC CICS READ
 16776*       UPDATE
 16777*       SET     (ADDRESS OF CHECK-RECORDS)
 16778*       DATASET ('ERCHEK')
 16779*       RIDFLD  (ERCHEK-KEY)
 16780*       RESP    (WS-RESPONSE)
 16781*    END-EXEC
 16782     MOVE 'ERCHEK' TO DFHEIV1
 16783*    MOVE '&"S        EU         (  N#00014665' TO DFHEIV0
 16784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16785     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16786     MOVE X'204E233030303134363635' TO DFHEIV0(25:11)
 16787     CALL 'kxdfhei1' USING DFHEIV0,
 16788           DFHEIV1,
 16789           DFHEIV20,
 16790           DFHEIV99,
 16791           ERCHEK-KEY,
 16792           DFHEIV99,
 16793           DFHEIV99,
 16794           DFHEIV99
 16795     SET ADDRESS OF CHECK-RECORDS TO
 16796         DFHEIV20
 16797     MOVE EIBRESP  TO WS-RESPONSE
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16799
 16800     .
 16801 2530-exit.
 16802     exit.
 16803
 16804 2540-delete-erchek.
 16805
 16806
 16807* EXEC CICS DELETE
 16808*       DATASET ('ERCHEK')
 16809*       RESP    (WS-RESPONSE)
 16810*    END-EXEC
 16811     MOVE 'ERCHEK' TO DFHEIV1
 16812*    MOVE '&(                    &  N#00014679' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 305
* EL6311.cbl
 16813     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16815     MOVE X'204E233030303134363739' TO DFHEIV0(25:11)
 16816     CALL 'kxdfhei1' USING DFHEIV0,
 16817           DFHEIV1,
 16818           DFHEIV99,
 16819           DFHEIV99,
 16820           DFHEIV99,
 16821           DFHEIV99
 16822     MOVE EIBRESP  TO WS-RESPONSE
 16823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16824
 16825     .
 16826 2540-exit.
 16827     exit.
 16828***************************************************************
 16829*                                                             *
 16830*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16831*                                                             *
 16832***************************************************************
 16833
 16834***************************************************************
 16835*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16836*     AN ALREADY BILLED RECORD.                               *
 16837***************************************************************
 16838
 16839 2700-BUILD-CORRECTION-RECORD.
 16840     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16841     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16842     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16843     MOVE '5'                    TO DC-OPTION-CODE.
 16844     PERFORM 9700-DATE-LINK.
 16845     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16846
 16847     IF PB-CHG-COUNT = ZEROS
 16848        MOVE +1                  TO WS-SEQ-SAVE
 16849     ELSE
 16850        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16851
 16852     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16853     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16854
 16855     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16856
 16857     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16858     MOVE 'A'                    TO JP-RECORD-TYPE.
 16859     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16860
 16861
 16862* EXEC CICS WRITE
 16863*        DATASET    (FILE-ID-ERPNDB)
 16864*        FROM       (PENDING-BUSINESS)
 16865*        RIDFLD     (PB-CONTROL-PRIMARY)
 16866*    END-EXEC.
 16867     MOVE LENGTH OF
 16868      PENDING-BUSINESS
 16869       TO DFHEIV11
 16870*    MOVE '&$ L                  ''   #00014720' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 306
* EL6311.cbl
 16871     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16872     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16873     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 16874     CALL 'kxdfhei1' USING DFHEIV0,
 16875           FILE-ID-ERPNDB,
 16876           PENDING-BUSINESS,
 16877           DFHEIV11,
 16878           PB-CONTROL-PRIMARY,
 16879           DFHEIV99,
 16880           DFHEIV99
 16881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16882
 16883
 16884     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16885
 16886     PERFORM 8400-LOG-JOURNAL-RECORD.
 16887
 16888 2799-EXIT.
 16889      EXIT.
 16890
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 307
* EL6311.cbl
 16892
 16893******************************************************************
 16894*                                                                *
 16895*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16896*                                                                *
 16897******************************************************************
 16898
 16899 2800-REWRITE-ISSUE-CERT-KEY.
 16900     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16901
 16902     IF  BCERTNOL GREATER THAN ZEROS
 16903         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16904
 16905     IF  BSUFIXL  GREATER THAN ZEROS
 16906         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16907
 16908     IF  BEFFDTL  GREATER THAN ZEROS
 16909         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16910
 16911 2810-READ-BY-ACCOUNT.
 16912
 16913* EXEC CICS HANDLE CONDITION
 16914*         NOTFND    (2820-PROCESS-REWRITE)
 16915*    END-EXEC.
 16916*    MOVE '"$I                   ! = #00014754' TO DFHEIV0
 16917     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16919     MOVE X'3D20233030303134373534' TO DFHEIV0(25:11)
 16920     CALL 'kxdfhei1' USING DFHEIV0
 16921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16922
 16923
 16924
 16925* EXEC CICS READ
 16926*        SET     (ADDRESS OF PENDING-BUSINESS)
 16927*        DATASET (FILE-ID-ERPNDB2)
 16928*        RIDFLD  (ERPNDB-ALT-KEY)
 16929*    END-EXEC.
 16930*    MOVE '&"S        E          (   #00014758' TO DFHEIV0
 16931     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16933     MOVE X'2020233030303134373538' TO DFHEIV0(25:11)
 16934     CALL 'kxdfhei1' USING DFHEIV0,
 16935           FILE-ID-ERPNDB2,
 16936           DFHEIV20,
 16937           DFHEIV99,
 16938           ERPNDB-ALT-KEY,
 16939           DFHEIV99,
 16940           DFHEIV99,
 16941           DFHEIV99
 16942     SET ADDRESS OF PENDING-BUSINESS TO
 16943         DFHEIV20
 16944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16945
 16946
 16947     GO TO 2890-DUPLICATE-RECORD.
 16948
 16949  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 308
* EL6311.cbl
 16950
 16951* EXEC CICS HANDLE CONDITION
 16952*         NOTFND    (2885-RECORD-MISSING)
 16953*    END-EXEC.
 16954*    MOVE '"$I                   ! > #00014767' TO DFHEIV0
 16955     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16957     MOVE X'3E20233030303134373637' TO DFHEIV0(25:11)
 16958     CALL 'kxdfhei1' USING DFHEIV0
 16959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16960
 16961
 16962     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16963
 16964
 16965* EXEC CICS READ
 16966*        SET     (ADDRESS OF PENDING-BUSINESS)
 16967*        DATASET (FILE-ID-ERPNDB)
 16968*        RIDFLD  (ERPNDB-KEY)
 16969*        UPDATE
 16970*    END-EXEC.
 16971*    MOVE '&"S        EU         (   #00014773' TO DFHEIV0
 16972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16974     MOVE X'2020233030303134373733' TO DFHEIV0(25:11)
 16975     CALL 'kxdfhei1' USING DFHEIV0,
 16976           FILE-ID-ERPNDB,
 16977           DFHEIV20,
 16978           DFHEIV99,
 16979           ERPNDB-KEY,
 16980           DFHEIV99,
 16981           DFHEIV99,
 16982           DFHEIV99
 16983     SET ADDRESS OF PENDING-BUSINESS TO
 16984         DFHEIV20
 16985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16986
 16987
 16988     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16989     MOVE 'D'                    TO JP-RECORD-TYPE.
 16990     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16991     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16992
 16993     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16994
 16995     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16996     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16997     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16998
 16999
 17000* EXEC CICS DELETE
 17001*        DATASET    (FILE-ID-ERPNDB)
 17002*    END-EXEC.
 17003*    MOVE '&(                    &   #00014791' TO DFHEIV0
 17004     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17005     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17006     MOVE X'2020233030303134373931' TO DFHEIV0(25:11)
 17007     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 309
* EL6311.cbl
 17008           FILE-ID-ERPNDB,
 17009           DFHEIV99,
 17010           DFHEIV99,
 17011           DFHEIV99,
 17012           DFHEIV99
 17013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17014
 17015
 17016     PERFORM 8400-LOG-JOURNAL-RECORD.
 17017
 17018
 17019* EXEC CICS GETMAIN
 17020*        SET      (ADDRESS OF PENDING-BUSINESS)
 17021*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17022*        INITIMG  (GETMAIN-SPACE)
 17023*    END-EXEC.
 17024*    MOVE ',"IL                  $   #00014797' TO DFHEIV0
 17025     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17026     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17027     MOVE X'2020233030303134373937' TO DFHEIV0(25:11)
 17028     CALL 'kxdfhei1' USING DFHEIV0,
 17029           DFHEIV20,
 17030           ERPNDB-RECORD-LENGTH,
 17031           GETMAIN-SPACE
 17032     SET ADDRESS OF PENDING-BUSINESS TO
 17033         DFHEIV20
 17034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17035
 17036
 17037     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17038
 17039
 17040* EXEC CICS HANDLE CONDITION
 17041*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17042*    END-EXEC.
 17043*    MOVE '"$I                   ! ? #00014805' TO DFHEIV0
 17044     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17046     MOVE X'3F20233030303134383035' TO DFHEIV0(25:11)
 17047     CALL 'kxdfhei1' USING DFHEIV0
 17048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17049
 17050
 17051
 17052* EXEC CICS READ
 17053*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17054*        DATASET (FILE-ID-ELCERT)
 17055*        RIDFLD  (ELCERT-KEY)
 17056*        UPDATE
 17057*    END-EXEC.
 17058*    MOVE '&"S        EU         (   #00014809' TO DFHEIV0
 17059     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17060     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17061     MOVE X'2020233030303134383039' TO DFHEIV0(25:11)
 17062     CALL 'kxdfhei1' USING DFHEIV0,
 17063           FILE-ID-ELCERT,
 17064           DFHEIV20,
 17065           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 310
* EL6311.cbl
 17066           ELCERT-KEY,
 17067           DFHEIV99,
 17068           DFHEIV99,
 17069           DFHEIV99
 17070     SET ADDRESS OF CERTIFICATE-MASTER TO
 17071         DFHEIV20
 17072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17073
 17074
 17075     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17076     MOVE 'B'                    TO JP-RECORD-TYPE
 17077     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17078     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17079
 17080     IF INSURED-ADDR-PRESENT
 17081        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17082
 17083     IF CERT-NOTES-ARE-NOT-PRESENT
 17084        MOVE SPACE               TO WS-CERT-NOTE-SW
 17085     ELSE
 17086        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17087
 17088     IF CERT-ADDED-BATCH      OR
 17089        CERT-AND-CLAIM-ONLINE OR
 17090        CERT-WAS-CREATED-FOR-CLAIM
 17091        NEXT SENTENCE
 17092     ELSE
 17093        GO TO 2825-DELETE-CERTIFICATE.
 17094
 17095     PERFORM 8400-LOG-JOURNAL-RECORD.
 17096
 17097*********************************************************
 17098** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17099     IF CERT-ADDED-BATCH
 17100         GO TO 2822-REWRITE-ELCERT.
 17101*********************************************************
 17102
 17103     IF NO-CLAIM-ATTACHED
 17104        NEXT SENTENCE
 17105     ELSE
 17106        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17107        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17108
 17109 2822-REWRITE-ELCERT.
 17110     MOVE 'C'                    TO JP-RECORD-TYPE
 17111     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17112
 17113     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17114
 17115
 17116* EXEC CICS REWRITE
 17117*         DATASET    (FILE-ID-ELCERT)
 17118*         FROM       (CERTIFICATE-MASTER)
 17119*    END-EXEC.
 17120     MOVE LENGTH OF
 17121      CERTIFICATE-MASTER
 17122       TO DFHEIV11
 17123*    MOVE '&& L                  %   #00014856' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 311
* EL6311.cbl
 17124     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17125     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17126     MOVE X'2020233030303134383536' TO DFHEIV0(25:11)
 17127     CALL 'kxdfhei1' USING DFHEIV0,
 17128           FILE-ID-ELCERT,
 17129           CERTIFICATE-MASTER,
 17130           DFHEIV11,
 17131           DFHEIV99
 17132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17133
 17134
 17135     PERFORM 8400-LOG-JOURNAL-RECORD.
 17136
 17137     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17138
 17139 2825-DELETE-CERTIFICATE.
 17140     MOVE 'D'                      TO JP-RECORD-TYPE.
 17141     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17142
 17143     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17144
 17145
 17146* EXEC CICS DELETE
 17147*         DATASET    (FILE-ID-ELCERT)
 17148*    END-EXEC.
 17149*    MOVE '&(                    &   #00014871' TO DFHEIV0
 17150     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17151     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17152     MOVE X'2020233030303134383731' TO DFHEIV0(25:11)
 17153     CALL 'kxdfhei1' USING DFHEIV0,
 17154           FILE-ID-ELCERT,
 17155           DFHEIV99,
 17156           DFHEIV99,
 17157           DFHEIV99,
 17158           DFHEIV99
 17159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17160
 17161
 17162     PERFORM 8400-LOG-JOURNAL-RECORD.
 17163
 17164******************************************************************
 17165*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17166******************************************************************
 17167
 17168     IF CERT-NOTES-ARE-PRESENT
 17169        NEXT SENTENCE
 17170     ELSE
 17171        GO TO 2827-DELETE-MAILING.
 17172
 17173
 17174* EXEC CICS HANDLE CONDITION
 17175*         NOTFND  (2827-DELETE-MAILING)
 17176*    END-EXEC.
 17177*    MOVE '"$I                   ! @ #00014886' TO DFHEIV0
 17178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17180     MOVE X'4020233030303134383836' TO DFHEIV0(25:11)
 17181     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 312
* EL6311.cbl
 17182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17183
 17184
 17185
 17186* EXEC CICS READ
 17187*        EQUAL
 17188*        DATASET   (FILE-ID-ERNOTE)
 17189*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17190*        RIDFLD    (ELCERT-KEY)
 17191*        UPDATE
 17192*    END-EXEC.
 17193*    MOVE '&"S        EU         (   #00014890' TO DFHEIV0
 17194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17195     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17196     MOVE X'2020233030303134383930' TO DFHEIV0(25:11)
 17197     CALL 'kxdfhei1' USING DFHEIV0,
 17198           FILE-ID-ERNOTE,
 17199           DFHEIV20,
 17200           DFHEIV99,
 17201           ELCERT-KEY,
 17202           DFHEIV99,
 17203           DFHEIV99,
 17204           DFHEIV99
 17205     SET ADDRESS OF CERTIFICATE-NOTE TO
 17206         DFHEIV20
 17207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17208
 17209
 17210     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17211     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17212     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17213
 17214     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17215
 17216
 17217* EXEC CICS DELETE
 17218*        DATASET   (FILE-ID-ERNOTE)
 17219*    END-EXEC.
 17220*    MOVE '&(                    &   #00014904' TO DFHEIV0
 17221     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17223     MOVE X'2020233030303134393034' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           FILE-ID-ERNOTE,
 17226           DFHEIV99,
 17227           DFHEIV99,
 17228           DFHEIV99,
 17229           DFHEIV99
 17230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17231
 17232
 17233     PERFORM 8400-LOG-JOURNAL-RECORD.
 17234
 17235******************************************************************
 17236*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17237******************************************************************
 17238
 17239 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 313
* EL6311.cbl
 17240     IF CERT-ADDRESS-PRESENT
 17241        NEXT SENTENCE
 17242     ELSE
 17243        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17244
 17245
 17246* EXEC CICS HANDLE CONDITION
 17247*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17248*    END-EXEC.
 17249*    MOVE '"$I                   ! A #00014920' TO DFHEIV0
 17250     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17252     MOVE X'4120233030303134393230' TO DFHEIV0(25:11)
 17253     CALL 'kxdfhei1' USING DFHEIV0
 17254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17255
 17256
 17257     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17258
 17259
 17260* EXEC CICS READ
 17261*        EQUAL
 17262*        DATASET   (FILE-ID-ERMAIL)
 17263*        SET       (ADDRESS OF MAILING-DATA)
 17264*        RIDFLD    (ERMAIL-KEY)
 17265*        UPDATE
 17266*    END-EXEC.
 17267*    MOVE '&"S        EU         (   #00014926' TO DFHEIV0
 17268     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17269     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17270     MOVE X'2020233030303134393236' TO DFHEIV0(25:11)
 17271     CALL 'kxdfhei1' USING DFHEIV0,
 17272           FILE-ID-ERMAIL,
 17273           DFHEIV20,
 17274           DFHEIV99,
 17275           ERMAIL-KEY,
 17276           DFHEIV99,
 17277           DFHEIV99,
 17278           DFHEIV99
 17279     SET ADDRESS OF MAILING-DATA TO
 17280         DFHEIV20
 17281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17282
 17283
 17284     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17285     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17286     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17287
 17288     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17289
 17290
 17291* EXEC CICS DELETE
 17292*        DATASET   (FILE-ID-ERMAIL)
 17293*    END-EXEC.
 17294*    MOVE '&(                    &   #00014940' TO DFHEIV0
 17295     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17297     MOVE X'2020233030303134393430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 314
* EL6311.cbl
 17298     CALL 'kxdfhei1' USING DFHEIV0,
 17299           FILE-ID-ERMAIL,
 17300           DFHEIV99,
 17301           DFHEIV99,
 17302           DFHEIV99,
 17303           DFHEIV99
 17304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17305
 17306
 17307     PERFORM 8400-LOG-JOURNAL-RECORD.
 17308
 17309 2830-BUILD-NEW-ISSUE-RECORD.
 17310     MOVE SPACES                 TO ELCERT-KEY.
 17311
 17312     IF  BCERTNOL GREATER THAN ZEROS
 17313         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17314
 17315     IF  BSUFIXL  GREATER THAN ZEROS
 17316         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17317
 17318     IF BEFFDTL GREATER THAN ZEROS
 17319        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17320
 17321 2870-WRITE-PENDING-BUSINESS.
 17322     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17323     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17324     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17325     MOVE '5'                    TO DC-OPTION-CODE.
 17326     PERFORM 9700-DATE-LINK.
 17327     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17328
 17329     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17330
 17331     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17332     MOVE 'A'                    TO JP-RECORD-TYPE.
 17333     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17334
 17335
 17336* EXEC CICS WRITE
 17337*        DATASET  (FILE-ID-ERPNDB)
 17338*        FROM     (PENDING-BUSINESS)
 17339*        RIDFLD   (PB-CONTROL-PRIMARY)
 17340*    END-EXEC.
 17341     MOVE LENGTH OF
 17342      PENDING-BUSINESS
 17343       TO DFHEIV11
 17344*    MOVE '&$ L                  ''   #00014972' TO DFHEIV0
 17345     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17347     MOVE X'2020233030303134393732' TO DFHEIV0(25:11)
 17348     CALL 'kxdfhei1' USING DFHEIV0,
 17349           FILE-ID-ERPNDB,
 17350           PENDING-BUSINESS,
 17351           DFHEIV11,
 17352           PB-CONTROL-PRIMARY,
 17353           DFHEIV99,
 17354           DFHEIV99
 17355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 315
* EL6311.cbl
 17356
 17357
 17358     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17359
 17360     PERFORM 8400-LOG-JOURNAL-RECORD.
 17361
 17362     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17363
 17364 2885-RECORD-MISSING.
 17365     MOVE -1                     TO BMAINTL
 17366     MOVE AL-UABON               TO BMAINTA
 17367     MOVE ER-2902                TO EMI-ERROR.
 17368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17369     GO TO 8200-SEND-DATAONLY.
 17370
 17371 2890-DUPLICATE-RECORD.
 17372     MOVE -1                     TO BMAINTL.
 17373     MOVE AL-UABON               TO BCERTNOA.
 17374     MOVE AL-UNBON               TO BEFFDTA.
 17375     MOVE SPACE                  TO BMAINTI.
 17376
 17377     MOVE 1                      TO EMI-SUB
 17378                                    EMI-SWITCH1
 17379                                    EMI-SWITCH-AREA-1
 17380                                    EMI-SWITCH-AREA-2.
 17381
 17382     MOVE SPACES                 TO EMI-ERROR-LINES.
 17383
 17384
 17385* EXEC CICS SYNCPOINT ROLLBACK
 17386*    END-EXEC.
 17387*    MOVE '6"R                   !   #00015004' TO DFHEIV0
 17388     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17390     MOVE X'2020233030303135303034' TO DFHEIV0(25:11)
 17391     CALL 'kxdfhei1' USING DFHEIV0
 17392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17393
 17394
 17395     MOVE ER-2247                TO EMI-ERROR.
 17396     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17397     GO TO 8200-SEND-DATAONLY.
 17398
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 316
* EL6311.cbl
 17400
 17401******************************************************************
 17402*                                                                *
 17403*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17404*                                                                *
 17405******************************************************************
 17406
 17407 2900-REWRITE-CAN-CERT-KEY.
 17408     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17409
 17410     IF  CCERTNOL GREATER THAN ZEROS
 17411         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17412
 17413     IF  CSUFIXL  GREATER THAN ZEROS
 17414         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17415
 17416     IF  CEFFDTL  GREATER THAN ZEROS
 17417         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17418
 17419 2910-READ-BY-ACCOUNT.
 17420
 17421* EXEC CICS HANDLE CONDITION
 17422*         NOTFND    (2920-PROCESS-REWRITE)
 17423*    END-EXEC.
 17424*    MOVE '"$I                   ! B #00015032' TO DFHEIV0
 17425     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17427     MOVE X'4220233030303135303332' TO DFHEIV0(25:11)
 17428     CALL 'kxdfhei1' USING DFHEIV0
 17429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17430
 17431
 17432
 17433* EXEC CICS READ
 17434*        SET     (ADDRESS OF PENDING-BUSINESS)
 17435*        DATASET (FILE-ID-ERPNDB2)
 17436*        RIDFLD  (ERPNDB-ALT-KEY)
 17437*    END-EXEC.
 17438*    MOVE '&"S        E          (   #00015036' TO DFHEIV0
 17439     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17440     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17441     MOVE X'2020233030303135303336' TO DFHEIV0(25:11)
 17442     CALL 'kxdfhei1' USING DFHEIV0,
 17443           FILE-ID-ERPNDB2,
 17444           DFHEIV20,
 17445           DFHEIV99,
 17446           ERPNDB-ALT-KEY,
 17447           DFHEIV99,
 17448           DFHEIV99,
 17449           DFHEIV99
 17450     SET ADDRESS OF PENDING-BUSINESS TO
 17451         DFHEIV20
 17452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17453
 17454
 17455     GO TO 2990-DUPLICATE-RECORD.
 17456
 17457  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 317
* EL6311.cbl
 17458
 17459* EXEC CICS HANDLE CONDITION
 17460*         NOTFND    (2985-RECORD-MISSING)
 17461*    END-EXEC.
 17462*    MOVE '"$I                   ! C #00015045' TO DFHEIV0
 17463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17465     MOVE X'4320233030303135303435' TO DFHEIV0(25:11)
 17466     CALL 'kxdfhei1' USING DFHEIV0
 17467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17468
 17469
 17470     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17471
 17472
 17473* EXEC CICS READ
 17474*        SET     (ADDRESS OF PENDING-BUSINESS)
 17475*        DATASET (FILE-ID-ERPNDB)
 17476*        RIDFLD  (ERPNDB-KEY)
 17477*        UPDATE
 17478*    END-EXEC.
 17479*    MOVE '&"S        EU         (   #00015051' TO DFHEIV0
 17480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17481     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17482     MOVE X'2020233030303135303531' TO DFHEIV0(25:11)
 17483     CALL 'kxdfhei1' USING DFHEIV0,
 17484           FILE-ID-ERPNDB,
 17485           DFHEIV20,
 17486           DFHEIV99,
 17487           ERPNDB-KEY,
 17488           DFHEIV99,
 17489           DFHEIV99,
 17490           DFHEIV99
 17491     SET ADDRESS OF PENDING-BUSINESS TO
 17492         DFHEIV20
 17493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17494
 17495
 17496     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17497     MOVE 'D'                    TO JP-RECORD-TYPE.
 17498     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17499     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17500
 17501     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17502
 17503     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17504     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17505     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17506
 17507
 17508* EXEC CICS DELETE
 17509*        DATASET    (FILE-ID-ERPNDB)
 17510*    END-EXEC.
 17511*    MOVE '&(                    &   #00015069' TO DFHEIV0
 17512     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17513     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17514     MOVE X'2020233030303135303639' TO DFHEIV0(25:11)
 17515     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 318
* EL6311.cbl
 17516           FILE-ID-ERPNDB,
 17517           DFHEIV99,
 17518           DFHEIV99,
 17519           DFHEIV99,
 17520           DFHEIV99
 17521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17522
 17523
 17524     PERFORM 8400-LOG-JOURNAL-RECORD.
 17525
 17526
 17527* EXEC CICS GETMAIN
 17528*        SET      (ADDRESS OF PENDING-BUSINESS)
 17529*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17530*        INITIMG  (GETMAIN-SPACE)
 17531*    END-EXEC.
 17532*    MOVE ',"IL                  $   #00015075' TO DFHEIV0
 17533     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17534     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17535     MOVE X'2020233030303135303735' TO DFHEIV0(25:11)
 17536     CALL 'kxdfhei1' USING DFHEIV0,
 17537           DFHEIV20,
 17538           ERPNDB-RECORD-LENGTH,
 17539           GETMAIN-SPACE
 17540     SET ADDRESS OF PENDING-BUSINESS TO
 17541         DFHEIV20
 17542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17543
 17544
 17545     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17546
 17547 2950-PROCESS-CANCELS.
 17548
 17549
 17550* EXEC CICS HANDLE CONDITION
 17551*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17552*    END-EXEC.
 17553*    MOVE '"$I                   ! D #00015085' TO DFHEIV0
 17554     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17556     MOVE X'4420233030303135303835' TO DFHEIV0(25:11)
 17557     CALL 'kxdfhei1' USING DFHEIV0
 17558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17559
 17560
 17561
 17562* EXEC CICS READ
 17563*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17564*        DATASET (FILE-ID-ELCERT)
 17565*        RIDFLD  (ELCERT-KEY)
 17566*        UPDATE
 17567*    END-EXEC.
 17568*    MOVE '&"S        EU         (   #00015089' TO DFHEIV0
 17569     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17571     MOVE X'2020233030303135303839' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0,
 17573           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 319
* EL6311.cbl
 17574           DFHEIV20,
 17575           DFHEIV99,
 17576           ELCERT-KEY,
 17577           DFHEIV99,
 17578           DFHEIV99,
 17579           DFHEIV99
 17580     SET ADDRESS OF CERTIFICATE-MASTER TO
 17581         DFHEIV20
 17582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17583
 17584
 17585     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17586
 17587     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17588     MOVE 'B'                      TO JP-RECORD-TYPE.
 17589     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17590     PERFORM 8400-LOG-JOURNAL-RECORD.
 17591
 17592     IF PB-CI-LIVES NOT NUMERIC
 17593         MOVE ZERO                    TO PB-CI-LIVES.
 17594
 17595     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17596        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17597        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17598        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17599                                         CM-LF-CANCEL-DT
 17600     ELSE
 17601        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17602        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17603        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17604        MOVE PB-CI-LIVES              TO CM-LIVES.
 17605
 17606     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17607        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17608            MOVE CM-LF-STATUS-AT-CANCEL
 17609                                     TO CM-LF-CURRENT-STATUS
 17610            MOVE SPACE
 17611                                     TO CM-LF-STATUS-AT-CANCEL
 17612        ELSE
 17613            MOVE PB-CI-LF-POLICY-STATUS
 17614                                     TO CM-LF-CURRENT-STATUS
 17615     ELSE
 17616        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17617
 17618     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17619        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17620        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17621        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17622                                         CM-AH-CANCEL-DT
 17623     ELSE
 17624        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17625        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17626        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17627        MOVE PB-CI-LIVES              TO CM-LIVES.
 17628
 17629     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17630        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17631            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 320
* EL6311.cbl
 17632                                     TO CM-AH-CURRENT-STATUS
 17633            MOVE SPACE
 17634                                     TO CM-AH-STATUS-AT-CANCEL
 17635        ELSE
 17636            MOVE PB-CI-AH-POLICY-STATUS
 17637                                     TO CM-AH-CURRENT-STATUS
 17638     ELSE
 17639        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17640
 17641 2975-REWRITE-CERT.
 17642     MOVE 'C'                      TO JP-RECORD-TYPE.
 17643     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17644
 17645
 17646* EXEC CICS REWRITE
 17647*        DATASET    (FILE-ID-ELCERT)
 17648*        FROM       (CERTIFICATE-MASTER)
 17649*    END-EXEC.
 17650     MOVE LENGTH OF
 17651      CERTIFICATE-MASTER
 17652       TO DFHEIV11
 17653*    MOVE '&& L                  %   #00015156' TO DFHEIV0
 17654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17656     MOVE X'2020233030303135313536' TO DFHEIV0(25:11)
 17657     CALL 'kxdfhei1' USING DFHEIV0,
 17658           FILE-ID-ELCERT,
 17659           CERTIFICATE-MASTER,
 17660           DFHEIV11,
 17661           DFHEIV99
 17662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17663
 17664
 17665     PERFORM 8400-LOG-JOURNAL-RECORD.
 17666
 17667 2960-BUILD-NEW-CANCEL-RECORD.
 17668     IF  CCERTNOL GREATER THAN ZEROS
 17669         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17670
 17671     IF  CSUFIXL  GREATER THAN ZEROS
 17672         MOVE CSUFIXI             TO PB-CERT-SFX.
 17673
 17674     IF  CEFFDTL  GREATER  THAN ZEROS
 17675         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17676
 17677 2970-WRITE-PENDING-BUSINESS.
 17678     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17679     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17680     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17681     MOVE '5'                    TO DC-OPTION-CODE.
 17682     PERFORM 9700-DATE-LINK.
 17683     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17684
 17685     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17686
 17687     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17688                                    PB-CI-INSURED-SEX
 17689                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 321
* EL6311.cbl
 17690                                    PB-CI-AH-BENEFIT-CD
 17691                                    PB-CI-RATE-CLASS
 17692                                    PB-CI-RATE-DEV-LF
 17693                                    PB-CI-RATE-DEV-AH
 17694                                    PB-CI-LF-ABBR
 17695                                    PB-CI-AH-ABBR
 17696                                    PB-CI-OB-FLAG
 17697                                    PB-CI-LF-POLICY-STATUS
 17698                                    PB-CI-AH-POLICY-STATUS
 17699                                    PB-CI-INDV-GRP-CD
 17700                                    PB-CI-BENEFICIARY-NAME
 17701                                    PB-CI-NOTE-SW
 17702                                    PB-CI-SOC-SEC-NO
 17703                                    PB-CI-MEMBER-NO
 17704                                    PB-CI-INT-CODE
 17705                                    PB-CI-COMP-EXCP-SW
 17706                                    PB-CI-ENTRY-STATUS
 17707                                    PB-CI-CREDIT-INTERFACE-SW-1
 17708                                    PB-CI-CREDIT-INTERFACE-SW-2
 17709                                    PB-CI-ENTRY-BATCH.
 17710
 17711     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17712                                    PB-CI-AH-SETTLEMENT-DT
 17713                                    PB-CI-DEATH-DT
 17714                                    PB-CI-LF-PRIOR-CANCEL-DT
 17715                                    PB-CI-AH-PRIOR-CANCEL-DT
 17716                                    PB-CI-LOAN-1ST-PMT-DT
 17717                                    PB-CI-ENTRY-DT
 17718                                    PB-CI-LF-EXPIRE-DT
 17719                                    PB-CI-AH-EXPIRE-DT.
 17720
 17721     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17722                                    PB-CI-LF-TERM
 17723                                    PB-CI-LF-BENEFIT-AMT
 17724                                    PB-CI-LF-ALT-BENEFIT-AMT
 17725                                    PB-CI-LF-PREMIUM-AMT
 17726                                    PB-CI-LF-ALT-PREMIUM-AMT
 17727                                    PB-CI-AH-TERM
 17728                                    PB-CI-AH-BENEFIT-AMT
 17729                                    PB-CI-AH-PREMIUM-AMT
 17730                                    PB-CI-RATE-DEV-PCT-LF
 17731                                    PB-CI-RATE-DEV-PCT-AH
 17732                                    PB-CI-LIFE-COMMISSION
 17733                                    PB-CI-AH-COMMISSION
 17734                                    PB-CI-PAY-FREQUENCY
 17735                                    PB-CI-LOAN-APR
 17736                                    PB-CI-LOAN-TERM
 17737                                    PB-CI-CURR-SEQ
 17738                                    PB-CI-AH-CANCEL-AMT
 17739                                    PB-CI-LF-CANCEL-AMT
 17740                                    PB-CI-EXTENTION-DAYS
 17741                                    PB-CI-TERM-IN-DAYS
 17742                                    PB-CI-LOAN-OFFICER
 17743                                    PB-CI-LIVES
 17744                                    PB-CI-LF-CRIT-PER
 17745                                    PB-CI-AH-CRIT-PER
 17746                                    PB-C-LF-REM-TERM
 17747                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 322
* EL6311.cbl
 17748
 17749     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17750     MOVE 'A'                    TO JP-RECORD-TYPE.
 17751     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17752
 17753
 17754* EXEC CICS HANDLE CONDITION
 17755*        DUPREC   (2990-DUPLICATE-RECORD)
 17756*    END-EXEC.
 17757*    MOVE '"$%                   ! E #00015249' TO DFHEIV0
 17758     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17760     MOVE X'4520233030303135323439' TO DFHEIV0(25:11)
 17761     CALL 'kxdfhei1' USING DFHEIV0
 17762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17763
 17764
 17765
 17766* EXEC CICS WRITE
 17767*        DATASET  (FILE-ID-ERPNDB)
 17768*        FROM     (PENDING-BUSINESS)
 17769*        RIDFLD   (PB-CONTROL-PRIMARY)
 17770*    END-EXEC.
 17771     MOVE LENGTH OF
 17772      PENDING-BUSINESS
 17773       TO DFHEIV11
 17774*    MOVE '&$ L                  ''   #00015253' TO DFHEIV0
 17775     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17776     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17777     MOVE X'2020233030303135323533' TO DFHEIV0(25:11)
 17778     CALL 'kxdfhei1' USING DFHEIV0,
 17779           FILE-ID-ERPNDB,
 17780           PENDING-BUSINESS,
 17781           DFHEIV11,
 17782           PB-CONTROL-PRIMARY,
 17783           DFHEIV99,
 17784           DFHEIV99
 17785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17786
 17787
 17788     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17789
 17790     PERFORM 8400-LOG-JOURNAL-RECORD.
 17791
 17792     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17793
 17794 2985-RECORD-MISSING.
 17795     MOVE -1                     TO CMAINTL
 17796     MOVE AL-UABON               TO CMAINTA.
 17797
 17798     MOVE ER-2902                TO EMI-ERROR.
 17799     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17800     GO TO 8200-SEND-DATAONLY.
 17801
 17802 2990-DUPLICATE-RECORD.
 17803     MOVE SPACE                  TO CMAINTI.
 17804     MOVE -1                     TO CMAINTL.
 17805     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 323
* EL6311.cbl
 17806     MOVE AL-UNBON               TO CEFFDTA.
 17807
 17808     MOVE 1                      TO EMI-SUB
 17809                                    EMI-SWITCH1
 17810                                    EMI-SWITCH-AREA-1
 17811                                    EMI-SWITCH-AREA-2.
 17812     MOVE SPACES                 TO EMI-ERROR-LINES.
 17813
 17814
 17815* EXEC CICS SYNCPOINT ROLLBACK
 17816*    END-EXEC.
 17817*    MOVE '6"R                   !   #00015285' TO DFHEIV0
 17818     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17820     MOVE X'2020233030303135323835' TO DFHEIV0(25:11)
 17821     CALL 'kxdfhei1' USING DFHEIV0
 17822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17823
 17824
 17825     MOVE ER-2247                TO EMI-ERROR.
 17826     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17827     GO TO 8200-SEND-DATAONLY.
 17828
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 324
* EL6311.cbl
 17830
 17831***************************************************************
 17832*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17833*     PREMIUM FOR A SINGLE BATCH.                             *
 17834*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17835***************************************************************
 17836
 17837 3000-BATCH-MAINLINE.
 17838     IF PI-PREV-KEY NOT = SPACES
 17839         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17840     ELSE
 17841         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17842
 17843     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17844
 17845 3010-READNEXT.
 17846
 17847* EXEC CICS READ
 17848*         DATASET    (FILE-ID-ERPNDB)
 17849*         SET        (ADDRESS OF PENDING-BUSINESS)
 17850*         RIDFLD     (ERPNDB-KEY)
 17851*         GTEQ
 17852*    END-EXEC.
 17853*    MOVE '&"S        G          (   #00015309' TO DFHEIV0
 17854     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17856     MOVE X'2020233030303135333039' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0,
 17858           FILE-ID-ERPNDB,
 17859           DFHEIV20,
 17860           DFHEIV99,
 17861           ERPNDB-KEY,
 17862           DFHEIV99,
 17863           DFHEIV99,
 17864           DFHEIV99
 17865     SET ADDRESS OF PENDING-BUSINESS TO
 17866         DFHEIV20
 17867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17868
 17869
 17870     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17871        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17872          GO TO 3030-END-BATCH.
 17873
 17874     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17875
 17876     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17877        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17878          GO TO 3020-BUMP-SEQ.
 17879
 17880     IF PB-ISSUE
 17881        ADD +1                   TO WS-ISS-TOTAL-CNT
 17882        IF PB-FATAL-ERRORS
 17883           ADD +1                      TO WS-ISS-FATAL-CNT
 17884           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17885           GO TO 3020-BUMP-SEQ
 17886        ELSE
 17887           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 325
* EL6311.cbl
 17888              ADD +1                      TO WS-ISS-FORCE-CNT
 17889              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17890              GO TO 3020-BUMP-SEQ
 17891           ELSE
 17892              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17893                 ADD +1                      TO WS-ISS-HOLD-CNT
 17894                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17895                 GO TO 3020-BUMP-SEQ
 17896              ELSE
 17897                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17898                     THRU  3299-EXIT
 17899                 GO TO 3020-BUMP-SEQ.
 17900
 17901     IF PB-CANCELLATION
 17902        ADD +1                   TO WS-CAN-TOTAL-CNT
 17903        IF PB-FATAL-ERRORS
 17904           ADD +1                 TO WS-CAN-FATAL-CNT
 17905           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17906           GO TO 3020-BUMP-SEQ
 17907        ELSE
 17908           IF PB-UNFORCED-ERRORS
 17909              ADD +1                 TO WS-CAN-FORCE-CNT
 17910              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17911              GO TO 3020-BUMP-SEQ
 17912           ELSE
 17913              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17914                 ADD +1                 TO WS-CAN-HOLD-CNT
 17915                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17916                 GO TO 3020-BUMP-SEQ
 17917              ELSE
 17918                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17919                     THRU  3499-EXIT
 17920                 GO TO 3020-BUMP-SEQ.
 17921
 17922     IF PB-BATCH-TRAILER
 17923         GO TO 3030-END-BATCH.
 17924
 17925 3020-BUMP-SEQ.
 17926     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17927     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17928     GO TO 3010-READNEXT.
 17929
 17930 3030-END-BATCH.
 17931     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17932     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17933     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17934     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17935
 17936     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17937                                          - WS-ISS-FORCE-CNT
 17938                                          - WS-ISS-HOLD-CNT).
 17939
 17940     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17941     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17942
 17943     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17944     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17945     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 326
* EL6311.cbl
 17946     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17947     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17948                                          - WS-CAN-FORCE-CNT
 17949                                          - WS-CAN-HOLD-CNT).
 17950     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17951     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17952
 17953     COMPUTE WS-NET-TOTAL-CNT
 17954         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17955     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17956     COMPUTE WS-NET-FATAL-CNT
 17957         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17958     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17959     COMPUTE WS-NET-FORCE-CNT
 17960         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17961     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17962     COMPUTE WS-NET-HOLD-CNT
 17963         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17964     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17965
 17966     COMPUTE WS-NET-AVAIL-CNT
 17967          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17968                              - WS-ISS-FORCE-CNT
 17969                              - WS-ISS-HOLD-CNT)
 17970          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17971                              - WS-CAN-FORCE-CNT
 17972                              - WS-CAN-HOLD-CNT).
 17973     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17974
 17975     COMPUTE WS-NET-GOOD-PREM
 17976         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17977     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17978     COMPUTE WS-NET-BAD-PREM
 17979         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17980     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17981
 17982     MOVE 0000                   TO EMI-ERROR.
 17983     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17984     MOVE -1                     TO DPFENTRL.
 17985     GO TO 8200-SEND-DATAONLY.
 17986
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 327
* EL6311.cbl
 17988
 17989******************************************************************
 17990*                                                                *
 17991*           A D D    B A D   I S S U E   P R E M I U M           *
 17992*                                                                *
 17993******************************************************************
 17994
 17995 3100-ADD-BAD-ISSUE-PREM.
 17996     IF PB-OVERRIDE-LIFE
 17997       OR PB-OVERRIDE-BOTH
 17998           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17999           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18000       ELSE
 18001           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18002           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18003
 18004     IF PB-OVERRIDE-AH
 18005       OR PB-OVERRIDE-BOTH
 18006           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18007       ELSE
 18008           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18009
 18010 3199-EXIT.
 18011     EXIT.
 18012
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 328
* EL6311.cbl
 18014
 18015******************************************************************
 18016*                                                                *
 18017*       A D D   G O O D   I S S U E   P R E M I U M              *
 18018*                                                                *
 18019******************************************************************
 18020
 18021 3200-ADD-GOOD-ISSUE-PREM.
 18022     IF PB-OVERRIDE-LIFE
 18023       OR PB-OVERRIDE-BOTH
 18024           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18025           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18026       ELSE
 18027           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18028           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18029
 18030     IF PB-OVERRIDE-AH
 18031       OR PB-OVERRIDE-BOTH
 18032           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18033       ELSE
 18034           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18035
 18036 3299-EXIT.
 18037     EXIT.
 18038
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 329
* EL6311.cbl
 18040
 18041
 18042******************************************************************
 18043*                                                                *
 18044*        A D D   B A D   C A N C E L   P R E M I U M             *
 18045*                                                                *
 18046******************************************************************
 18047
 18048 3300-ADD-BAD-CANCEL-PREM.
 18049     IF PB-OVERRIDE-LIFE
 18050       OR PB-OVERRIDE-BOTH
 18051           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18052       ELSE
 18053           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18054
 18055     IF PB-OVERRIDE-AH
 18056       OR PB-OVERRIDE-BOTH
 18057           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18058       ELSE
 18059           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18060
 18061 3399-EXIT.
 18062     EXIT.
 18063
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 330
* EL6311.cbl
 18065
 18066******************************************************************
 18067*                                                                *
 18068*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18069*                                                                *
 18070******************************************************************
 18071
 18072 3400-ADD-GOOD-CANCEL-PREM.
 18073     IF PB-OVERRIDE-LIFE
 18074       OR PB-OVERRIDE-BOTH
 18075           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18076       ELSE
 18077           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18078
 18079     IF PB-OVERRIDE-AH
 18080       OR PB-OVERRIDE-BOTH
 18081           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18082       ELSE
 18083           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18084
 18085 3499-EXIT.
 18086     EXIT.
 18087
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 331
* EL6311.cbl
 18089
 18090******************************************************************
 18091*                                                                *
 18092*           E D I T   B A T C H   D A T A                        *
 18093*                                                                *
 18094******************************************************************
 18095
 18096 3500-EDIT-BATCH-DATA.
 18097     IF PI-PREV-KEY NOT = SPACES
 18098        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18099     ELSE
 18100        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18101
 18102     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18103     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18104
 18105
 18106* EXEC CICS HANDLE CONDITION
 18107*         NOTFND      (3590-NOT-FOUND)
 18108*    END-EXEC.
 18109*    MOVE '"$I                   ! F #00015551' TO DFHEIV0
 18110     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18112     MOVE X'4620233030303135353531' TO DFHEIV0(25:11)
 18113     CALL 'kxdfhei1' USING DFHEIV0
 18114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18115
 18116
 18117     IF DRISSL   GREATER THAN ZEROS OR
 18118        DRISSL   GREATER THAN ZEROS OR
 18119        DRLFPRML GREATER THAN ZEROS OR
 18120        DRAHPRML GREATER THAN ZEROS OR
 18121        DRCANCL  GREATER THAN ZEROS OR
 18122        DRLFRFDL GREATER THAN ZEROS OR
 18123        DRAHRFDL GREATER THAN ZEROS
 18124              NEXT SENTENCE
 18125          ELSE
 18126              MOVE ER-3224    TO EMI-ERROR
 18127              MOVE -1         TO DPFENTRL
 18128              MOVE AL-UNBON   TO DPFENTRA
 18129              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18130              GO TO 8200-SEND-DATAONLY.
 18131
 18132     IF NOT MODIFY-CAP
 18133         MOVE 'UPDATE'       TO SM-READ
 18134         PERFORM 9995-SECURITY-VIOLATION
 18135         MOVE ER-0070        TO EMI-ERROR
 18136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18137         GO TO 8100-SEND-INITIAL-MAP.
 18138
 18139        IF DRISSL GREATER THAN ZEROS
 18140           MOVE AL-UNNON         TO DRISSA
 18141           MOVE DRISSI           TO DEEDIT-FIELD
 18142           PERFORM 8600-DEEDIT
 18143           IF DEEDIT-FIELD-V0  NUMERIC
 18144              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18145           ELSE
 18146              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 332
* EL6311.cbl
 18147              MOVE -1         TO DRISSL
 18148              MOVE AL-UNBON   TO DRISSA
 18149              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18150
 18151        IF DRLFPRML GREATER THAN ZEROS
 18152           MOVE AL-UNNON         TO DRLFPRMA
 18153
 18154* EXEC CICS BIF DEEDIT
 18155*              FIELD  (DRLFPRMI)
 18156*              LENGTH (11)
 18157*          END-EXEC
 18158     MOVE 11
 18159       TO DFHEIV11
 18160*    MOVE '@"L                   #   #00015591' TO DFHEIV0
 18161     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18162     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18163     MOVE X'2020233030303135353931' TO DFHEIV0(25:11)
 18164     CALL 'kxdfhei1' USING DFHEIV0,
 18165           DRLFPRMI,
 18166           DFHEIV11
 18167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18168           IF DRLFPRMI NUMERIC
 18169              MOVE DRLFPRMI   TO WS-DRLFPRM
 18170*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18171*          PERFORM 8600-DEEDIT
 18172*          IF DEEDIT-FIELD-V2  NUMERIC
 18173*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18174           ELSE
 18175              MOVE ER-2223    TO EMI-ERROR
 18176              MOVE -1         TO DRLFPRML
 18177              MOVE AL-UNBON   TO DRLFPRMA
 18178              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18179
 18180        IF DRAHPRML GREATER THAN ZEROS
 18181           MOVE AL-UNNON         TO DRAHPRMA
 18182
 18183* EXEC CICS BIF DEEDIT
 18184*              FIELD  (DRAHPRMI)
 18185*              LENGTH (11)
 18186*          END-EXEC
 18187     MOVE 11
 18188       TO DFHEIV11
 18189*    MOVE '@"L                   #   #00015609' TO DFHEIV0
 18190     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18191     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18192     MOVE X'2020233030303135363039' TO DFHEIV0(25:11)
 18193     CALL 'kxdfhei1' USING DFHEIV0,
 18194           DRAHPRMI,
 18195           DFHEIV11
 18196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18197           IF DRAHPRMI NUMERIC
 18198              MOVE DRAHPRMI   TO WS-DRAHPRM
 18199*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18200*          PERFORM 8600-DEEDIT
 18201*          IF DEEDIT-FIELD-V2  NUMERIC
 18202*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18203           ELSE
 18204              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 333
* EL6311.cbl
 18205              MOVE -1         TO DRAHPRML
 18206              MOVE AL-UNBON   TO DRAHPRMA
 18207              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18208
 18209        IF DRCANCL GREATER THAN ZEROS
 18210           MOVE AL-UNNON         TO DRCANCA
 18211           MOVE DRCANCI          TO DEEDIT-FIELD
 18212           PERFORM 8600-DEEDIT
 18213           IF DEEDIT-FIELD-V0  NUMERIC
 18214              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18215           ELSE
 18216              MOVE ER-2223    TO EMI-ERROR
 18217              MOVE -1         TO DRCANCL
 18218              MOVE AL-UNBON   TO DRCANCL
 18219              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18220
 18221        IF DRLFRFDL GREATER THAN ZEROS
 18222           MOVE AL-UNNON         TO DRLFRFDA
 18223
 18224* EXEC CICS BIF DEEDIT
 18225*              FIELD  (DRLFRFDI)
 18226*              LENGTH (11)
 18227*          END-EXEC
 18228     MOVE 11
 18229       TO DFHEIV11
 18230*    MOVE '@"L                   #   #00015639' TO DFHEIV0
 18231     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18232     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18233     MOVE X'2020233030303135363339' TO DFHEIV0(25:11)
 18234     CALL 'kxdfhei1' USING DFHEIV0,
 18235           DRLFRFDI,
 18236           DFHEIV11
 18237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18238           IF DRLFRFDI NUMERIC
 18239              MOVE DRLFRFDI   TO WS-DRLFRFD
 18240*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18241*          PERFORM 8600-DEEDIT
 18242*          IF DEEDIT-FIELD-V2  NUMERIC
 18243*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18244           ELSE
 18245              MOVE ER-2223    TO EMI-ERROR
 18246              MOVE -1         TO DRLFRFDL
 18247              MOVE AL-UNBON   TO DRLFRFDA
 18248              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18249
 18250        IF DRAHRFDL GREATER THAN ZEROS
 18251           MOVE AL-UNNON         TO DRAHRFDA
 18252
 18253* EXEC CICS BIF DEEDIT
 18254*              FIELD  (DRAHRFDI)
 18255*              LENGTH (11)
 18256*          END-EXEC
 18257     MOVE 11
 18258       TO DFHEIV11
 18259*    MOVE '@"L                   #   #00015657' TO DFHEIV0
 18260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18262     MOVE X'2020233030303135363537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 334
* EL6311.cbl
 18263     CALL 'kxdfhei1' USING DFHEIV0,
 18264           DRAHRFDI,
 18265           DFHEIV11
 18266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18267           IF DRAHRFDI NUMERIC
 18268              MOVE DRAHRFDI   TO WS-DRAHRFD
 18269*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18270*          PERFORM 8600-DEEDIT
 18271*          IF DEEDIT-FIELD-V2  NUMERIC
 18272*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18273           ELSE
 18274              MOVE ER-2223    TO EMI-ERROR
 18275              MOVE -1         TO DRAHRFDL
 18276              MOVE AL-UNBON   TO DRAHRFDA
 18277              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18278
 18279     IF EMI-ERROR = ZEROS
 18280        GO 3600-UPDATE-BATCH-HEADER.
 18281
 18282     GO TO 8200-SEND-DATAONLY.
 18283
 18284 3590-NOT-FOUND.
 18285     MOVE ER-2192                TO EMI-ERROR.
 18286     MOVE -1                     TO DPFENTRL.
 18287     MOVE AL-UNBON               TO DPFENTRA.
 18288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18289     GO TO 8200-SEND-DATAONLY.
 18290
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 335
* EL6311.cbl
 18292
 18293******************************************************************
 18294*                                                                *
 18295*           U P D A T E   B A T C H   H E A D E R                *
 18296*                                                                *
 18297******************************************************************
 18298
 18299 3600-UPDATE-BATCH-HEADER.
 18300
 18301* EXEC CICS HANDLE CONDITION
 18302*         NOTFND      (3690-NOT-FOUND)
 18303*    END-EXEC.
 18304*    MOVE '"$I                   ! G #00015694' TO DFHEIV0
 18305     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18307     MOVE X'4720233030303135363934' TO DFHEIV0(25:11)
 18308     CALL 'kxdfhei1' USING DFHEIV0
 18309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18310
 18311
 18312
 18313* EXEC CICS READ
 18314*        DATASET (FILE-ID-ERPNDB)
 18315*        RIDFLD  (ERPNDB-KEY)
 18316*        SET     (ADDRESS OF PENDING-BUSINESS)
 18317*        UPDATE
 18318*    END-EXEC.
 18319*    MOVE '&"S        EU         (   #00015698' TO DFHEIV0
 18320     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18321     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18322     MOVE X'2020233030303135363938' TO DFHEIV0(25:11)
 18323     CALL 'kxdfhei1' USING DFHEIV0,
 18324           FILE-ID-ERPNDB,
 18325           DFHEIV20,
 18326           DFHEIV99,
 18327           ERPNDB-KEY,
 18328           DFHEIV99,
 18329           DFHEIV99,
 18330           DFHEIV99
 18331     SET ADDRESS OF PENDING-BUSINESS TO
 18332         DFHEIV20
 18333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18334
 18335
 18336     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18337     MOVE 'B'                    TO JP-RECORD-TYPE.
 18338     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18339
 18340     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18341
 18342     PERFORM 8400-LOG-JOURNAL-RECORD.
 18343
 18344     IF DRISSL GREATER THAN ZEROS
 18345        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18346
 18347     IF DRCANCL GREATER THAN ZEROS
 18348        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18349
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 336
* EL6311.cbl
 18350
 18351     IF DRLFPRML GREATER THAN ZEROS
 18352        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18353
 18354     IF DRAHPRML GREATER THAN ZEROS
 18355        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18356
 18357     IF DRLFRFDL GREATER THAN ZEROS
 18358        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18359
 18360     IF DRAHRFDL GREATER THAN ZEROS
 18361        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18362
 18363 3670-REWRITE-BATCH-HEADER.
 18364     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18365        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18366        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18367        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18368        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18369        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18370        MOVE SPACE               TO PB-OUT-BAL-CD
 18371     ELSE
 18372        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18373
 18374     MOVE 'C'                    TO JP-RECORD-TYPE.
 18375     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18376
 18377
 18378* EXEC CICS REWRITE
 18379*         DATASET      (FILE-ID-ERPNDB)
 18380*         FROM         (PENDING-BUSINESS)
 18381*    END-EXEC.
 18382     MOVE LENGTH OF
 18383      PENDING-BUSINESS
 18384       TO DFHEIV11
 18385*    MOVE '&& L                  %   #00015746' TO DFHEIV0
 18386     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18388     MOVE X'2020233030303135373436' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0,
 18390           FILE-ID-ERPNDB,
 18391           PENDING-BUSINESS,
 18392           DFHEIV11,
 18393           DFHEIV99
 18394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18395
 18396
 18397     PERFORM 8400-LOG-JOURNAL-RECORD.
 18398
 18399     GO TO 7200-DISPLAY-BATCHES.
 18400
 18401 3690-NOT-FOUND.
 18402     MOVE ER-2192                TO EMI-ERROR.
 18403     MOVE -1                     TO DPFENTRL.
 18404     MOVE AL-UNBON               TO DPFENTRA.
 18405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18406     GO TO 8200-SEND-DATAONLY.
 18407
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 337
* EL6311.cbl
 18409
 18410******************************************************************
 18411*                                                                *
 18412*           R E - D I S P L A Y   R E C O R D                    *
 18413*                                                                *
 18414******************************************************************
 18415
 18416 3900-RE-DISPLAY-RECORD.
 18417
 18418* EXEC CICS HANDLE CONDITION
 18419*         NOTFND   (3990-NOT-FOUND)
 18420*    END-EXEC.
 18421*    MOVE '"$I                   ! H #00015771' TO DFHEIV0
 18422     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18424     MOVE X'4820233030303135373731' TO DFHEIV0(25:11)
 18425     CALL 'kxdfhei1' USING DFHEIV0
 18426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18427
 18428
 18429     IF PI-DISPLAY-ORIGINAL-BATCH
 18430         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18431     ELSE
 18432         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18433
 18434
 18435* EXEC CICS READ
 18436*         DATASET   (FILE-ID)
 18437*         RIDFLD    (PI-PREV-KEY)
 18438*         SET       (ADDRESS OF PENDING-BUSINESS)
 18439*    END-EXEC.
 18440*    MOVE '&"S        E          (   #00015780' TO DFHEIV0
 18441     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18443     MOVE X'2020233030303135373830' TO DFHEIV0(25:11)
 18444     CALL 'kxdfhei1' USING DFHEIV0,
 18445           FILE-ID,
 18446           DFHEIV20,
 18447           DFHEIV99,
 18448           PI-PREV-KEY,
 18449           DFHEIV99,
 18450           DFHEIV99,
 18451           DFHEIV99
 18452     SET ADDRESS OF PENDING-BUSINESS TO
 18453         DFHEIV20
 18454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18455
 18456
 18457     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18458
 18459     IF PB-ISSUE
 18460         GO TO 7000-DISPLAY-ISSUES.
 18461
 18462     IF PB-CANCELLATION
 18463         GO TO 7100-DISPLAY-CANCELS.
 18464
 18465     IF PB-BATCH-TRAILER
 18466         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 338
* EL6311.cbl
 18467
 18468 3990-NOT-FOUND.
 18469     MOVE LOW-VALUES             TO EL631BI.
 18470
 18471     IF PI-MAP-NAME = EL631B
 18472         MOVE -1                  TO BMAINTL
 18473     ELSE
 18474         MOVE -1                  TO CMAINTL.
 18475
 18476     GO TO 8100-SEND-INITIAL-MAP.
 18477
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 339
* EL6311.cbl
 18479
 18480***************************************************************
 18481*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18482*                                                             *
 18483*      1. START BROWSE WITH                                   *
 18484*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18485*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18486*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18487*                                                             *
 18488*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18489*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18490*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18491*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18492*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18493*               AND IS IT TO BE DISPLAYED.                    *
 18494*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18495*               DISPLAYED.                                    *
 18496*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18497*               DISPLAYED.                                    *
 18498*                                                             *
 18499*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18500*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18501***************************************************************
 18502
 18503 4000-BROWSE-DETAIL-FORWARD.
 18504     IF FIRST-TIME
 18505        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18506     ELSE
 18507        IF SHOW-RECORD
 18508           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18509           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18510           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18511           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18512           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18513        ELSE
 18514           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18515
 18516
 18517* EXEC CICS HANDLE CONDITION
 18518*         NOTFND   (4050-END-RECORDS)
 18519*         ENDFILE  (4050-END-RECORDS)
 18520*    END-EXEC.
 18521*    MOVE '"$I''                  ! I #00015845' TO DFHEIV0
 18522     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18523     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18524     MOVE X'4920233030303135383435' TO DFHEIV0(25:11)
 18525     CALL 'kxdfhei1' USING DFHEIV0
 18526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18527
 18528
 18529
 18530* EXEC CICS STARTBR
 18531*         DATASET   (FILE-ID-ERPNDB2)
 18532*         RIDFLD    (ERPNDB-ALT-KEY)
 18533*    END-EXEC.
 18534     MOVE 0
 18535       TO DFHEIV11
 18536*    MOVE '&,         G          &   #00015850' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 340
* EL6311.cbl
 18537     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18539     MOVE X'2020233030303135383530' TO DFHEIV0(25:11)
 18540     CALL 'kxdfhei1' USING DFHEIV0,
 18541           FILE-ID-ERPNDB2,
 18542           ERPNDB-ALT-KEY,
 18543           DFHEIV99,
 18544           DFHEIV11,
 18545           DFHEIV99
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18547
 18548
 18549     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18550
 18551     IF FIRST-TIME OR SHOW-RECORD
 18552        MOVE SPACE               TO WS-FIRST-TIME-SW
 18553        GO TO 4005-READ-NEXT-RECORD.
 18554
 18555
 18556* EXEC CICS READNEXT
 18557*         DATASET    (FILE-ID-ERPNDB2)
 18558*         SET        (ADDRESS OF PENDING-BUSINESS)
 18559*         RIDFLD     (ERPNDB-ALT-KEY)
 18560*    END-EXEC.
 18561     MOVE 0
 18562       TO DFHEIV11
 18563*    MOVE '&.S                   )   #00015861' TO DFHEIV0
 18564     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18566     MOVE X'2020233030303135383631' TO DFHEIV0(25:11)
 18567     CALL 'kxdfhei1' USING DFHEIV0,
 18568           FILE-ID-ERPNDB2,
 18569           DFHEIV20,
 18570           DFHEIV99,
 18571           ERPNDB-ALT-KEY,
 18572           DFHEIV99,
 18573           DFHEIV11,
 18574           DFHEIV99,
 18575           DFHEIV99
 18576     SET ADDRESS OF PENDING-BUSINESS TO
 18577         DFHEIV20
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18579
 18580
 18581 4005-READ-NEXT-RECORD.
 18582
 18583* EXEC CICS READNEXT
 18584*         DATASET    (FILE-ID-ERPNDB2)
 18585*         SET        (ADDRESS OF PENDING-BUSINESS)
 18586*         RIDFLD     (ERPNDB-ALT-KEY)
 18587*    END-EXEC.
 18588     MOVE 0
 18589       TO DFHEIV11
 18590*    MOVE '&.S                   )   #00015868' TO DFHEIV0
 18591     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18592     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18593     MOVE X'2020233030303135383638' TO DFHEIV0(25:11)
 18594     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 341
* EL6311.cbl
 18595           FILE-ID-ERPNDB2,
 18596           DFHEIV20,
 18597           DFHEIV99,
 18598           ERPNDB-ALT-KEY,
 18599           DFHEIV99,
 18600           DFHEIV11,
 18601           DFHEIV99,
 18602           DFHEIV99
 18603     SET ADDRESS OF PENDING-BUSINESS TO
 18604         DFHEIV20
 18605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18606
 18607
 18608     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18609
 18610     IF WS-BATCH-PREFIX = '#CL'
 18611        GO TO 4005-READ-NEXT-RECORD.
 18612
 18613     IF SHOW-RECORD
 18614        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18615           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18616           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18617           PB-STATE         NOT = PI-PB-STATE          OR
 18618           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18619           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18620           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18621           GO TO 4050-END-RECORDS
 18622        ELSE
 18623           GO TO 4010-CHECK-REC-TYPE.
 18624
 18625     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18626        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18627        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18628        PB-STATE            NOT = PI-PB-STATE          OR
 18629        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18630        GO TO 4050-END-RECORDS.
 18631
 18632     IF PB-BATCH-TRAILER
 18633        GO TO 4005-READ-NEXT-RECORD.
 18634
 18635     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18636        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18637           GO TO 4005-READ-NEXT-RECORD
 18638        ELSE
 18639           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18640              GO TO 4010-CHECK-REC-TYPE
 18641           ELSE
 18642              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18643                 GO TO 4010-CHECK-REC-TYPE
 18644              ELSE
 18645                 GO TO 4005-READ-NEXT-RECORD.
 18646
 18647     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18648        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18649           GO TO 4005-READ-NEXT-RECORD.
 18650
 18651 4010-CHECK-REC-TYPE.
 18652     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 342
* EL6311.cbl
 18653         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18654             NEXT SENTENCE
 18655         ELSE
 18656             GO TO 4005-READ-NEXT-RECORD.
 18657
 18658     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18659         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18660             NEXT SENTENCE
 18661        ELSE
 18662             GO TO 4005-READ-NEXT-RECORD.
 18663
 18664     IF NOT DISPLAY-CHANGE-RECORDS AND
 18665            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18666        GO TO 4005-READ-NEXT-RECORD.
 18667
 18668     IF DISPLAY-HOLD-RECORDS AND
 18669        NOT PB-RECORD-ON-HOLD
 18670          GO TO 4005-READ-NEXT-RECORD.
 18671
 18672     IF PB-ISSUE
 18673        IF DISPLAY-CHK-REQ-RECORDS
 18674            GO TO 4005-READ-NEXT-RECORD.
 18675
 18676     IF PB-ISSUE
 18677        IF ISSUE-WITH-WARNING
 18678           IF PB-WARNING-ERRORS
 18679              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18680                  GO TO 4005-READ-NEXT-RECORD
 18681              ELSE
 18682                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18683                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18684                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18685                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18686                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18687                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18688                 GO TO 7000-DISPLAY-ISSUES
 18689           ELSE
 18690              GO TO 4005-READ-NEXT-RECORD.
 18691
 18692     IF PB-ISSUE
 18693        IF (ISSUES-IN-ERROR AND
 18694            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18695            ALL-ISSUES
 18696            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18697            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18698            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18699            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18700            MOVE PB-SV-STATE            TO PI-SV-STATE
 18701            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18702            GO TO 7000-DISPLAY-ISSUES
 18703        ELSE
 18704            GO TO 4005-READ-NEXT-RECORD.
 18705
 18706     IF PB-CANCELLATION
 18707        IF DISPLAY-CHK-REQ-RECORDS
 18708           IF PB-C-REFUND-REQUESTED
 18709              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18710              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 343
* EL6311.cbl
 18711              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18712              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18713              MOVE PB-SV-STATE            TO PI-SV-STATE
 18714              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18715              GO TO 7100-DISPLAY-CANCELS
 18716           ELSE
 18717               GO TO 4005-READ-NEXT-RECORD.
 18718
 18719     IF PB-CANCELLATION
 18720        IF CANCEL-WITH-WARNING
 18721           IF PB-WARNING-ERRORS
 18722              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18723                  GO TO 4005-READ-NEXT-RECORD
 18724              ELSE
 18725                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18726                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18727                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18728                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18729                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18730                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18731                 GO TO 7100-DISPLAY-CANCELS
 18732           ELSE
 18733              GO TO 4005-READ-NEXT-RECORD.
 18734
 18735     IF PB-CANCELLATION
 18736        IF (CANCEL-IN-ERROR  AND
 18737            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18738            ALL-CANCELS
 18739            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18740            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18741            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18742            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18743            MOVE PB-SV-STATE            TO PI-SV-STATE
 18744            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18745            GO TO 7100-DISPLAY-CANCELS.
 18746
 18747     GO TO 4005-READ-NEXT-RECORD.
 18748
 18749 4050-END-RECORDS.
 18750******************************************************************
 18751*                                                                *
 18752*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18753*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18754*         PROGRAM.                                               *
 18755*                                                                *
 18756******************************************************************
 18757
 18758     IF BROWSE-STARTED
 18759        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18760
 18761* EXEC CICS ENDBR
 18762*            DATASET  (FILE-ID-ERPNDB2)
 18763*       END-EXEC.
 18764     MOVE 0
 18765       TO DFHEIV11
 18766*    MOVE '&2                    $   #00016026' TO DFHEIV0
 18767     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18768     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 344
* EL6311.cbl
 18769     MOVE X'2020233030303136303236' TO DFHEIV0(25:11)
 18770     CALL 'kxdfhei1' USING DFHEIV0,
 18771           FILE-ID-ERPNDB2,
 18772           DFHEIV11,
 18773           DFHEIV99
 18774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18775
 18776
 18777     IF  EIBTRNID NOT = TRANS-EXB1
 18778         IF PENDING-BUS-RECS-FOUND
 18779             NEXT SENTENCE
 18780           ELSE
 18781             MOVE '9'            TO PI-BROWSE-SW
 18782             GO TO 9400-CLEAR.
 18783
 18784     IF SHOW-RECORD
 18785        MOVE ER-2253            TO EMI-ERROR
 18786       ELSE
 18787        MOVE ER-2254            TO EMI-ERROR.
 18788
 18789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18790
 18791     IF PI-MAP-NAME = SPACES
 18792        MOVE -1                  TO DPFENTRL
 18793        MOVE EL631D               TO PI-MAP-NAME
 18794        GO TO 8100-SEND-INITIAL-MAP.
 18795
 18796     IF PI-MAP-NAME = EL631B
 18797        MOVE -1                  TO BMAINTL
 18798     ELSE
 18799        IF PI-MAP-NAME = EL631C
 18800           MOVE -1               TO CMAINTL
 18801        ELSE
 18802           MOVE -1               TO DPFENTRL.
 18803
 18804     GO TO 8200-SEND-DATAONLY.
 18805
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 345
* EL6311.cbl
 18807
 18808***************************************************************
 18809*                                                             *
 18810*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18811*                                                             *
 18812*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18813*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18814*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18815*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18816*                                                             *
 18817*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18818*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18819*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18820*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18821*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18822*                AND IS IT TO BE DISPLAYED.                   *
 18823*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18824*                DISPLAYED.                                   *
 18825*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18826*                DISPLAYED.                                   *
 18827*                                                             *
 18828*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18829*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18830*                                                             *
 18831*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18832*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18833*                THEY ARE NOT TO BE DISPLAYED.                *
 18834*                                                             *
 18835***************************************************************
 18836
 18837 4100-BROWSE-PRIMARY-FORWARD.
 18838     IF FIRST-TIME  OR SHOW-RECORD
 18839        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18840        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18841        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18842     ELSE
 18843        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18844        IF ERPNDB-BATCH-SEQ-NO = +9999
 18845           GO TO 4150-END-BATCH
 18846        ELSE
 18847           IF DISPLAY-CHANGE-RECORDS
 18848              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18849           ELSE
 18850              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18851              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18852
 18853     IF FIRST-TIME
 18854         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18855            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18856              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18857
 18858
 18859* EXEC CICS HANDLE CONDITION
 18860*         ENDFILE  (4150-END-BATCH)
 18861*    END-EXEC.
 18862*    MOVE '"$''                   ! J #00016111' TO DFHEIV0
 18863     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18864     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 346
* EL6311.cbl
 18865     MOVE X'4A20233030303136313131' TO DFHEIV0(25:11)
 18866     CALL 'kxdfhei1' USING DFHEIV0
 18867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18868
 18869
 18870 4105-READ-NEXT.
 18871
 18872* EXEC CICS HANDLE CONDITION
 18873*         NOTFND    (4150-END-BATCH)
 18874*    END-EXEC.
 18875*    MOVE '"$I                   ! K #00016116' TO DFHEIV0
 18876     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18878     MOVE X'4B20233030303136313136' TO DFHEIV0(25:11)
 18879     CALL 'kxdfhei1' USING DFHEIV0
 18880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18881
 18882
 18883     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18884
 18885     IF PI-DISPLAY-ORIGINAL-BATCH
 18886        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18887     ELSE
 18888        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18889
 18890
 18891* EXEC CICS READ
 18892*         DATASET   (FILE-ID)
 18893*         SET       (ADDRESS OF PENDING-BUSINESS)
 18894*         RIDFLD    (ERPNDB-KEY)
 18895*         GTEQ
 18896*    END-EXEC.
 18897*    MOVE '&"S        G          (   #00016127' TO DFHEIV0
 18898     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18900     MOVE X'2020233030303136313237' TO DFHEIV0(25:11)
 18901     CALL 'kxdfhei1' USING DFHEIV0,
 18902           FILE-ID,
 18903           DFHEIV20,
 18904           DFHEIV99,
 18905           ERPNDB-KEY,
 18906           DFHEIV99,
 18907           DFHEIV99,
 18908           DFHEIV99
 18909     SET ADDRESS OF PENDING-BUSINESS TO
 18910         DFHEIV20
 18911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18912
 18913
 18914     IF PI-DISPLAY-ORIGINAL-BATCH
 18915        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18916           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18917           GO TO 4150-END-BATCH
 18918        ELSE
 18919           IF PB-BATCH-TRAILER
 18920              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18921              GO TO 4105-READ-NEXT
 18922           ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 347
* EL6311.cbl
 18923              NEXT SENTENCE
 18924     ELSE
 18925        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18926           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18927           GO TO 4150-END-BATCH.
 18928
 18929     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18930
 18931     IF WS-BATCH-PREFIX = '#CL'
 18932         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18933         GO TO 4105-READ-NEXT.
 18934
 18935     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18936     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18937     MOVE PB-STATE               TO PI-PB-STATE.
 18938     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18939
 18940     IF PB-BATCH-TRAILER
 18941        IF SHOW-RECORD
 18942           GO TO 4150-END-BATCH
 18943        ELSE
 18944           MOVE ER-2251         TO EMI-ERROR
 18945           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18946           MOVE 1               TO PI-BROWSE-TYPE
 18947           GO TO 7200-DISPLAY-BATCHES.
 18948
 18949     IF SHOW-RECORD
 18950           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18951              GO TO 4110-BUMP-SEQ
 18952           ELSE
 18953              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18954                 GO TO 4110-BUMP-SEQ
 18955              ELSE
 18956                 GO TO 4107-CHECK-REC-TYPE.
 18957
 18958     IF NOT  PI-PRIMARY-WITH-SELECT
 18959        GO TO 4107-CHECK-REC-TYPE.
 18960
 18961     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18962        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18963           GO TO 4110-BUMP-SEQ
 18964        ELSE
 18965           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18966              GO TO 4107-CHECK-REC-TYPE
 18967           ELSE
 18968              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18969                 GO TO 4107-CHECK-REC-TYPE
 18970              ELSE
 18971                 GO TO 4110-BUMP-SEQ.
 18972
 18973     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18974        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18975           GO TO 4110-BUMP-SEQ.
 18976
 18977 4107-CHECK-REC-TYPE.
 18978     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18979         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18980             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 348
* EL6311.cbl
 18981           ELSE
 18982             GO TO 4110-BUMP-SEQ.
 18983
 18984     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18985         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18986             NEXT SENTENCE
 18987           ELSE
 18988             GO TO 4110-BUMP-SEQ.
 18989
 18990     IF NOT DISPLAY-CHANGE-RECORDS AND
 18991        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18992           GO TO 4110-BUMP-SEQ.
 18993
 18994     IF DISPLAY-HOLD-RECORDS AND
 18995        NOT PB-RECORD-ON-HOLD
 18996          GO TO 4110-BUMP-SEQ.
 18997
 18998     IF PB-ISSUE
 18999        IF DISPLAY-CHK-REQ-RECORDS
 19000            GO TO 4110-BUMP-SEQ.
 19001
 19002     IF PB-ISSUE
 19003        IF ISSUE-WITH-WARNING
 19004           IF PB-WARNING-ERRORS
 19005              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19006                  GO TO 4110-BUMP-SEQ
 19007              ELSE
 19008                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19009                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19010                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19011                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19012                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19013                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19014                 GO TO 7000-DISPLAY-ISSUES
 19015        ELSE
 19016            GO TO 4110-BUMP-SEQ.
 19017
 19018     IF PB-ISSUE
 19019        IF (ISSUES-IN-ERROR AND
 19020            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19021            ALL-ISSUES
 19022            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19023            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19024            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19025            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19026            MOVE PB-SV-STATE            TO PI-SV-STATE
 19027            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19028            GO TO 7000-DISPLAY-ISSUES
 19029        ELSE
 19030            GO TO 4110-BUMP-SEQ.
 19031
 19032     IF PB-CANCELLATION
 19033        IF DISPLAY-CHK-REQ-RECORDS
 19034           IF PB-C-REFUND-REQUESTED
 19035              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19036              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19037              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19038              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 349
* EL6311.cbl
 19039              MOVE PB-SV-STATE            TO PI-SV-STATE
 19040              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19041              GO TO 7100-DISPLAY-CANCELS
 19042           ELSE
 19043              GO TO 4110-BUMP-SEQ.
 19044
 19045     IF PB-CANCELLATION
 19046        IF CANCEL-WITH-WARNING
 19047           IF PB-WARNING-ERRORS
 19048              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19049                  GO TO 4110-BUMP-SEQ
 19050              ELSE
 19051                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19052                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19053                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19054                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19055                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19056                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19057                 GO TO 7100-DISPLAY-CANCELS
 19058           ELSE
 19059              GO TO 4110-BUMP-SEQ.
 19060
 19061     IF PB-CANCELLATION
 19062        IF (CANCEL-IN-ERROR  AND
 19063            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19064            ALL-CANCELS
 19065            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19066            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19067            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19068            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19069            MOVE PB-SV-STATE            TO PI-SV-STATE
 19070            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19071            GO TO 7100-DISPLAY-CANCELS.
 19072
 19073 4110-BUMP-SEQ.
 19074     IF NOT DISPLAY-CHANGE-RECORDS
 19075        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19076        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19077     ELSE
 19078        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19079           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19080           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19081        ELSE
 19082           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19083           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19084
 19085     GO TO 4105-READ-NEXT.
 19086
 19087 4150-END-BATCH.
 19088******************************************************************
 19089*                                                                *
 19090*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19091*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19092*         PROGRAM.                                               *
 19093*                                                                *
 19094******************************************************************
 19095
 19096     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 350
* EL6311.cbl
 19097         IF PENDING-BUS-RECS-FOUND
 19098             NEXT SENTENCE
 19099           ELSE
 19100             MOVE '9'            TO PI-BROWSE-SW
 19101             GO TO 9400-CLEAR.
 19102
 19103     IF SHOW-RECORD
 19104        MOVE ER-2253             TO EMI-ERROR
 19105     ELSE
 19106        MOVE ER-2251             TO EMI-ERROR.
 19107
 19108     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19109
 19110     IF PI-MAP-NAME = SPACES
 19111        MOVE -1                  TO BMAINTL
 19112        MOVE EL631B              TO PI-MAP-NAME
 19113        GO TO 8100-SEND-INITIAL-MAP.
 19114
 19115     IF PI-MAP-NAME = EL631B
 19116        MOVE -1                  TO BMAINTL
 19117     ELSE
 19118        IF PI-MAP-NAME = EL631C
 19119           MOVE -1               TO CMAINTL
 19120        ELSE
 19121           MOVE -1               TO DPFENTRL.
 19122
 19123     GO TO 8200-SEND-DATAONLY.
 19124
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 351
* EL6311.cbl
 19126
 19127***************************************************************
 19128*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19129*                                                             *
 19130*      1. START BROWSE WITH                                   *
 19131*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19132*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19133*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19134*                                                             *
 19135*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19136*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19137*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19138*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19139*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19140*               AND IS IT TO BE DISPLAYED.                    *
 19141*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19142*               DISPLAYED.                                    *
 19143*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19144*               DISPLAYED.                                    *
 19145*                                                             *
 19146*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19147*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19148***************************************************************
 19149
 19150 4200-BROWSE-CSR-FORWARD.
 19151
 19152     IF FIRST-TIME
 19153        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19154     ELSE
 19155        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19156
 19157
 19158* EXEC CICS HANDLE CONDITION
 19159*         NOTFND   (4250-END-RECORDS)
 19160*         ENDFILE  (4250-END-RECORDS)
 19161*    END-EXEC.
 19162*    MOVE '"$I''                  ! L #00016377' TO DFHEIV0
 19163     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19165     MOVE X'4C20233030303136333737' TO DFHEIV0(25:11)
 19166     CALL 'kxdfhei1' USING DFHEIV0
 19167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19168
 19169
 19170
 19171* EXEC CICS STARTBR
 19172*         DATASET   (FILE-ID-ERPNDB4)
 19173*         RIDFLD    (ERPNDB-CSR-KEY)
 19174*    END-EXEC.
 19175     MOVE 0
 19176       TO DFHEIV11
 19177*    MOVE '&,         G          &   #00016382' TO DFHEIV0
 19178     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19179     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19180     MOVE X'2020233030303136333832' TO DFHEIV0(25:11)
 19181     CALL 'kxdfhei1' USING DFHEIV0,
 19182           FILE-ID-ERPNDB4,
 19183           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 352
* EL6311.cbl
 19184           DFHEIV99,
 19185           DFHEIV11,
 19186           DFHEIV99
 19187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19188
 19189
 19190     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19191
 19192     IF FIRST-TIME
 19193        MOVE SPACE               TO WS-FIRST-TIME-SW
 19194        GO TO 4205-READ-NEXT-RECORD.
 19195
 19196
 19197* EXEC CICS READNEXT
 19198*         DATASET    (FILE-ID-ERPNDB4)
 19199*         SET        (ADDRESS OF PENDING-BUSINESS)
 19200*         RIDFLD     (ERPNDB-CSR-KEY)
 19201*    END-EXEC.
 19202     MOVE 0
 19203       TO DFHEIV11
 19204*    MOVE '&.S                   )   #00016393' TO DFHEIV0
 19205     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19207     MOVE X'2020233030303136333933' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0,
 19209           FILE-ID-ERPNDB4,
 19210           DFHEIV20,
 19211           DFHEIV99,
 19212           ERPNDB-CSR-KEY,
 19213           DFHEIV99,
 19214           DFHEIV11,
 19215           DFHEIV99,
 19216           DFHEIV99
 19217     SET ADDRESS OF PENDING-BUSINESS TO
 19218         DFHEIV20
 19219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19220
 19221
 19222 4205-READ-NEXT-RECORD.
 19223
 19224
 19225* EXEC CICS READNEXT
 19226*         DATASET    (FILE-ID-ERPNDB4)
 19227*         SET        (ADDRESS OF PENDING-BUSINESS)
 19228*         RIDFLD     (ERPNDB-CSR-KEY)
 19229*    END-EXEC.
 19230     MOVE 0
 19231       TO DFHEIV11
 19232*    MOVE '&.S                   )   #00016401' TO DFHEIV0
 19233     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19234     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19235     MOVE X'2020233030303136343031' TO DFHEIV0(25:11)
 19236     CALL 'kxdfhei1' USING DFHEIV0,
 19237           FILE-ID-ERPNDB4,
 19238           DFHEIV20,
 19239           DFHEIV99,
 19240           ERPNDB-CSR-KEY,
 19241           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 353
* EL6311.cbl
 19242           DFHEIV11,
 19243           DFHEIV99,
 19244           DFHEIV99
 19245     SET ADDRESS OF PENDING-BUSINESS TO
 19246         DFHEIV20
 19247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19248
 19249
 19250     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19251
 19252     IF WS-BATCH-PREFIX = '#CL'
 19253        GO TO 4205-READ-NEXT-RECORD.
 19254
 19255     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19256        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19257        GO TO 4250-END-RECORDS.
 19258
 19259     IF PB-BATCH-TRAILER
 19260        GO TO 4205-READ-NEXT-RECORD.
 19261
 19262     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19263        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19264           GO TO 4205-READ-NEXT-RECORD
 19265        ELSE
 19266           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19267              GO TO 4210-CHECK-REC-TYPE
 19268           ELSE
 19269              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19270                 GO TO 4210-CHECK-REC-TYPE
 19271              ELSE
 19272                 GO TO 4205-READ-NEXT-RECORD.
 19273
 19274     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19275        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19276           GO TO 4205-READ-NEXT-RECORD.
 19277
 19278 4210-CHECK-REC-TYPE.
 19279     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19280         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19281             NEXT SENTENCE
 19282         ELSE
 19283             GO TO 4205-READ-NEXT-RECORD.
 19284
 19285     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19286         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19287             NEXT SENTENCE
 19288        ELSE
 19289             GO TO 4205-READ-NEXT-RECORD.
 19290
 19291     IF NOT DISPLAY-CHANGE-RECORDS AND
 19292            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19293        GO TO 4205-READ-NEXT-RECORD.
 19294
 19295     IF DISPLAY-HOLD-RECORDS AND
 19296        NOT PB-RECORD-ON-HOLD
 19297          GO TO 4205-READ-NEXT-RECORD.
 19298
 19299     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 354
* EL6311.cbl
 19300        IF DISPLAY-CHK-REQ-RECORDS
 19301            GO TO 4205-READ-NEXT-RECORD.
 19302
 19303     IF PB-ISSUE
 19304        IF ISSUE-WITH-WARNING
 19305           IF PB-WARNING-ERRORS
 19306              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19307                  GO TO 4205-READ-NEXT-RECORD
 19308              ELSE
 19309                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19310                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19311                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19312                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19313                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19314                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19315                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19316                 GO TO 7000-DISPLAY-ISSUES
 19317           ELSE
 19318              GO TO 4205-READ-NEXT-RECORD.
 19319
 19320     IF PB-ISSUE
 19321        IF (ISSUES-IN-ERROR AND
 19322            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19323            ALL-ISSUES
 19324            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19325            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19326            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19327            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19328            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19329            MOVE PB-SV-STATE            TO PI-SV-STATE
 19330            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19331            GO TO 7000-DISPLAY-ISSUES
 19332        ELSE
 19333            GO TO 4205-READ-NEXT-RECORD.
 19334
 19335     IF PB-CANCELLATION
 19336        IF DISPLAY-CHK-REQ-RECORDS
 19337           IF PB-C-REFUND-REQUESTED
 19338              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19339              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19340              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19341              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19342              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19343              MOVE PB-SV-STATE            TO PI-SV-STATE
 19344              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19345              GO TO 7100-DISPLAY-CANCELS
 19346           ELSE
 19347               GO TO 4205-READ-NEXT-RECORD.
 19348
 19349     IF PB-CANCELLATION
 19350        IF CANCEL-WITH-WARNING
 19351           IF PB-WARNING-ERRORS
 19352              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19353                  GO TO 4205-READ-NEXT-RECORD
 19354              ELSE
 19355                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19356                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19357                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 355
* EL6311.cbl
 19358                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19359                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19360                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19361                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19362                 GO TO 7100-DISPLAY-CANCELS
 19363           ELSE
 19364              GO TO 4205-READ-NEXT-RECORD.
 19365
 19366     IF PB-CANCELLATION
 19367        IF (CANCEL-IN-ERROR  AND
 19368            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19369            ALL-CANCELS
 19370            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19371            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19372            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19373            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19374            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19375            MOVE PB-SV-STATE            TO PI-SV-STATE
 19376            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19377            GO TO 7100-DISPLAY-CANCELS.
 19378
 19379     GO TO 4205-READ-NEXT-RECORD.
 19380
 19381 4250-END-RECORDS.
 19382******************************************************************
 19383*                                                                *
 19384*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19385*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19386*         PROGRAM.                                               *
 19387*                                                                *
 19388******************************************************************
 19389
 19390     IF BROWSE-STARTED
 19391        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19392
 19393* EXEC CICS ENDBR
 19394*            DATASET  (FILE-ID-ERPNDB4)
 19395*       END-EXEC.
 19396     MOVE 0
 19397       TO DFHEIV11
 19398*    MOVE '&2                    $   #00016549' TO DFHEIV0
 19399     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19400     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19401     MOVE X'2020233030303136353439' TO DFHEIV0(25:11)
 19402     CALL 'kxdfhei1' USING DFHEIV0,
 19403           FILE-ID-ERPNDB4,
 19404           DFHEIV11,
 19405           DFHEIV99
 19406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19407
 19408
 19409     IF  EIBTRNID NOT = TRANS-EXB1
 19410         IF PENDING-BUS-RECS-FOUND
 19411             NEXT SENTENCE
 19412           ELSE
 19413             MOVE '9'            TO PI-BROWSE-SW
 19414             GO TO 9400-CLEAR.
 19415
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 356
* EL6311.cbl
 19416     IF SHOW-RECORD
 19417        MOVE ER-2253            TO EMI-ERROR
 19418       ELSE
 19419        MOVE ER-2254            TO EMI-ERROR.
 19420
 19421     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19422
 19423     IF PI-MAP-NAME = SPACES
 19424        MOVE -1                  TO DPFENTRL
 19425        MOVE EL631D               TO PI-MAP-NAME
 19426        GO TO 8100-SEND-INITIAL-MAP.
 19427
 19428     IF PI-MAP-NAME = EL631B
 19429        MOVE -1                  TO BMAINTL
 19430     ELSE
 19431        IF PI-MAP-NAME = EL631C
 19432           MOVE -1               TO CMAINTL
 19433        ELSE
 19434           MOVE -1               TO DPFENTRL.
 19435
 19436     GO TO 8200-SEND-DATAONLY.
 19437
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 357
* EL6311.cbl
 19439
 19440***************************************************************
 19441*                                                             *
 19442*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19443*                                                             *
 19444*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19445*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19446*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19447*                                                             *
 19448*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19449*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19450*          A. IS IT WITHIN THE SAME COMPANY                   *
 19451*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19452*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19453*                AND IS IT TO BE DISPLAYED.                   *
 19454*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19455*                DISPLAYED.                                   *
 19456*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19457*                DISPLAYED.                                   *
 19458*                                                             *
 19459*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19460*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19461*                                                             *
 19462*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19463*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19464*                THEY ARE NOT TO BE DISPLAYED.                *
 19465*                                                             *
 19466***************************************************************
 19467
 19468 4300-BROWSE-FILE-FORWARD.
 19469     IF FIRST-TIME OR SHOW-RECORD
 19470        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19471        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19472        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19473     ELSE
 19474        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19475        IF ERPNDB-BATCH-SEQ-NO = +9999
 19476           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19477        ELSE
 19478           IF DISPLAY-CHANGE-RECORDS
 19479              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19480           ELSE
 19481              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19482              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19483
 19484
 19485* EXEC CICS HANDLE CONDITION
 19486*         ENDFILE  (4350-END-BATCH)
 19487*         NOTFND   (4350-END-BATCH)
 19488*    END-EXEC.
 19489*    MOVE '"$''I                  ! M #00016628' TO DFHEIV0
 19490     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19492     MOVE X'4D20233030303136363238' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0
 19494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19495
 19496
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 358
* EL6311.cbl
 19497 4305-READ-NEXT.
 19498     IF PI-DISPLAY-ORIGINAL-BATCH
 19499        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19500     ELSE
 19501        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19502
 19503
 19504* EXEC CICS READ
 19505*         DATASET   (FILE-ID)
 19506*         SET       (ADDRESS OF PENDING-BUSINESS)
 19507*         RIDFLD    (ERPNDB-KEY)
 19508*         GTEQ
 19509*    END-EXEC.
 19510*    MOVE '&"S        G          (   #00016639' TO DFHEIV0
 19511     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19513     MOVE X'2020233030303136363339' TO DFHEIV0(25:11)
 19514     CALL 'kxdfhei1' USING DFHEIV0,
 19515           FILE-ID,
 19516           DFHEIV20,
 19517           DFHEIV99,
 19518           ERPNDB-KEY,
 19519           DFHEIV99,
 19520           DFHEIV99,
 19521           DFHEIV99
 19522     SET ADDRESS OF PENDING-BUSINESS TO
 19523         DFHEIV20
 19524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19525
 19526
 19527     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19528        GO TO 4350-END-BATCH.
 19529
 19530     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19531                                    WS-BATCH-NO.
 19532
 19533     IF  WS-BATCH-PREFIX = '#CL'
 19534         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19535         GO TO 4305-READ-NEXT.
 19536
 19537     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19538     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19539     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19540     MOVE PB-STATE               TO PI-PB-STATE.
 19541     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19542
 19543     IF PB-BATCH-TRAILER
 19544        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19545        GO TO 4305-READ-NEXT.
 19546
 19547     IF SHOW-RECORD
 19548           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19549              GO TO 4310-BUMP-SEQ
 19550           ELSE
 19551              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19552                 GO TO 4310-BUMP-SEQ
 19553              ELSE
 19554                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 359
* EL6311.cbl
 19555
 19556     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19557        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19558           GO TO 4310-BUMP-SEQ
 19559        ELSE
 19560           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19561              GO TO 4307-CHECK-REC-TYPE
 19562           ELSE
 19563              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19564                 GO TO 4307-CHECK-REC-TYPE
 19565              ELSE
 19566                 GO TO 4310-BUMP-SEQ.
 19567
 19568     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19569        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19570           GO TO 4310-BUMP-SEQ.
 19571
 19572 4307-CHECK-REC-TYPE.
 19573     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19574         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19575             NEXT SENTENCE
 19576         ELSE
 19577             GO TO 4310-BUMP-SEQ.
 19578
 19579     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19580         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19581             NEXT SENTENCE
 19582        ELSE
 19583             GO TO 4310-BUMP-SEQ.
 19584
 19585     IF NOT DISPLAY-CHANGE-RECORDS AND
 19586            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19587        GO TO 4310-BUMP-SEQ.
 19588
 19589     IF DISPLAY-HOLD-RECORDS AND
 19590        NOT PB-RECORD-ON-HOLD
 19591          GO TO 4310-BUMP-SEQ.
 19592
 19593     IF PB-ISSUE
 19594        IF DISPLAY-CHK-REQ-RECORDS
 19595           GO TO 4310-BUMP-SEQ.
 19596
 19597     IF PB-ISSUE
 19598        IF ISSUE-WITH-WARNING
 19599           IF PB-WARNING-ERRORS
 19600              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19601                  GO TO 4310-BUMP-SEQ
 19602              ELSE
 19603                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19604                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19605                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19606                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19607                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19608                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19609                 GO TO 7000-DISPLAY-ISSUES
 19610           ELSE
 19611              GO TO 4310-BUMP-SEQ.
 19612
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 360
* EL6311.cbl
 19613     IF PB-ISSUE
 19614        IF (ISSUES-IN-ERROR AND
 19615            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19616            ALL-ISSUES
 19617            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19618            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19619            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19620            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19621            MOVE PB-SV-STATE            TO PI-SV-STATE
 19622            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19623            GO TO 7000-DISPLAY-ISSUES
 19624        ELSE
 19625            GO TO 4310-BUMP-SEQ.
 19626
 19627     IF PB-CANCELLATION
 19628        IF DISPLAY-CHK-REQ-RECORDS
 19629           IF PB-C-REFUND-REQUESTED
 19630              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19631              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19632              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19633              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19634              MOVE PB-SV-STATE            TO PI-SV-STATE
 19635              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19636              GO TO 7100-DISPLAY-CANCELS
 19637           ELSE
 19638              GO TO 4310-BUMP-SEQ.
 19639
 19640     IF PB-CANCELLATION
 19641        IF CANCEL-WITH-WARNING
 19642           IF PB-WARNING-ERRORS
 19643              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19644                  GO TO 4310-BUMP-SEQ
 19645              ELSE
 19646                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19647                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19648                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19649                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19650                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19651                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19652                 GO TO 7100-DISPLAY-CANCELS
 19653           ELSE
 19654              GO TO 4310-BUMP-SEQ.
 19655
 19656     IF PB-CANCELLATION
 19657        IF (CANCEL-IN-ERROR  AND
 19658            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19659            ALL-CANCELS
 19660            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19661            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19662            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19663            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19664            MOVE PB-SV-STATE            TO PI-SV-STATE
 19665            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19666            GO TO 7100-DISPLAY-CANCELS.
 19667
 19668 4310-BUMP-SEQ.
 19669     IF NOT DISPLAY-CHANGE-RECORDS
 19670        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 361
* EL6311.cbl
 19671        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19672     ELSE
 19673        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19674           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19675           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19676        ELSE
 19677           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19678           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19679
 19680     GO TO 4305-READ-NEXT.
 19681
 19682 4350-END-BATCH.
 19683
 19684******************************************************************
 19685*                                                                *
 19686*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19687*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19688*         PROGRAM.                                               *
 19689*                                                                *
 19690******************************************************************
 19691
 19692     IF  EIBTRNID NOT = TRANS-EXB1
 19693         IF PENDING-BUS-RECS-FOUND
 19694             NEXT SENTENCE
 19695           ELSE
 19696             MOVE '9'            TO PI-BROWSE-SW
 19697             GO TO 9400-CLEAR.
 19698
 19699     IF SHOW-RECORD
 19700        MOVE ER-2253            TO EMI-ERROR
 19701     ELSE
 19702        MOVE ER-2251            TO EMI-ERROR.
 19703
 19704     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19705
 19706     IF PI-MAP-NAME = SPACES
 19707        MOVE -1                  TO BMAINTL
 19708        MOVE EL631B               TO PI-MAP-NAME
 19709        GO TO 8100-SEND-INITIAL-MAP.
 19710
 19711     IF PI-MAP-NAME = EL631B
 19712        MOVE -1                  TO BMAINTL
 19713     ELSE
 19714        IF PI-MAP-NAME = EL631C
 19715           MOVE -1               TO CMAINTL
 19716        ELSE
 19717           MOVE -1               TO DPFENTRL.
 19718
 19719     GO TO 8200-SEND-DATAONLY.
 19720
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 362
* EL6311.cbl
 19722
 19723******************************************************************
 19724*                                                                *
 19725*        B R O W S E   D E T A I L   B A C K W A R D             *
 19726*                                                                *
 19727******************************************************************
 19728
 19729 4500-BROWSE-DETAIL-BACKWARD.
 19730
 19731     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19732
 19733
 19734* EXEC CICS HANDLE CONDITION
 19735*         NOTFND   (4570-NOT-FOUND)
 19736*         ENDFILE  (4550-END-RECORDS)
 19737*    END-EXEC
 19738*    MOVE '"$I''                  ! N #00016852' TO DFHEIV0
 19739     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19741     MOVE X'4E20233030303136383532' TO DFHEIV0(25:11)
 19742     CALL 'kxdfhei1' USING DFHEIV0
 19743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19744
 19745
 19746* EXEC CICS STARTBR
 19747*         DATASET   (FILE-ID-ERPNDB2)
 19748*         RIDFLD    (ERPNDB-ALT-KEY)
 19749*    END-EXEC.
 19750     MOVE 0
 19751       TO DFHEIV11
 19752*    MOVE '&,         G          &   #00016857' TO DFHEIV0
 19753     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19755     MOVE X'2020233030303136383537' TO DFHEIV0(25:11)
 19756     CALL 'kxdfhei1' USING DFHEIV0,
 19757           FILE-ID-ERPNDB2,
 19758           ERPNDB-ALT-KEY,
 19759           DFHEIV99,
 19760           DFHEIV11,
 19761           DFHEIV99
 19762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19763
 19764
 19765     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19766                                    WS-FIRST-TIME-SW.
 19767
 19768 4505-READ-PREV-RECORD.
 19769
 19770* EXEC CICS READPREV
 19771*         DATASET    (FILE-ID-ERPNDB2)
 19772*         SET        (ADDRESS OF PENDING-BUSINESS)
 19773*         RIDFLD     (ERPNDB-ALT-KEY)
 19774*    END-EXEC.
 19775     MOVE 0
 19776       TO DFHEIV11
 19777*    MOVE '&0S                   )   #00016866' TO DFHEIV0
 19778     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19779     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 363
* EL6311.cbl
 19780     MOVE X'2020233030303136383636' TO DFHEIV0(25:11)
 19781     CALL 'kxdfhei1' USING DFHEIV0,
 19782           FILE-ID-ERPNDB2,
 19783           DFHEIV20,
 19784           DFHEIV99,
 19785           ERPNDB-ALT-KEY,
 19786           DFHEIV99,
 19787           DFHEIV11,
 19788           DFHEIV99,
 19789           DFHEIV99
 19790     SET ADDRESS OF PENDING-BUSINESS TO
 19791         DFHEIV20
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19796
 19797     IF WS-BATCH-PREFIX = '#CL'
 19798         GO TO 4505-READ-PREV-RECORD.
 19799
 19800     IF FIRST-TIME
 19801         MOVE SPACE               TO WS-FIRST-TIME-SW
 19802         GO TO 4505-READ-PREV-RECORD.
 19803
 19804     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19805        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19806        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19807        PB-STATE         NOT = PI-PB-STATE    OR
 19808        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19809          GO TO 4550-END-RECORDS.
 19810
 19811
 19812     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19813
 19814     IF PB-BATCH-TRAILER
 19815        GO TO 4505-READ-PREV-RECORD.
 19816
 19817     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19818
 19819     IF  WS-BATCH-PREFIX = '#CL'
 19820         GO TO 4505-READ-PREV-RECORD.
 19821
 19822     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19823        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19824           GO TO 4505-READ-PREV-RECORD
 19825        ELSE
 19826           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19827              GO TO 4510-CHECK-REC-TYPE
 19828           ELSE
 19829              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19830                 GO TO 4510-CHECK-REC-TYPE
 19831              ELSE
 19832                 GO TO 4505-READ-PREV-RECORD.
 19833
 19834     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19835        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19836           GO TO 4505-READ-PREV-RECORD.
 19837
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 364
* EL6311.cbl
 19838 4510-CHECK-REC-TYPE.
 19839     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19840         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19841             NEXT SENTENCE
 19842         ELSE
 19843             GO TO 4505-READ-PREV-RECORD.
 19844
 19845     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19846         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19847             NEXT SENTENCE
 19848        ELSE
 19849             GO TO 4505-READ-PREV-RECORD.
 19850
 19851     IF NOT DISPLAY-CHANGE-RECORDS AND
 19852            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19853        GO TO 4505-READ-PREV-RECORD.
 19854
 19855     IF DISPLAY-HOLD-RECORDS AND
 19856        NOT PB-RECORD-ON-HOLD
 19857          GO TO 4505-READ-PREV-RECORD.
 19858
 19859     IF PB-ISSUE
 19860        IF DISPLAY-CHK-REQ-RECORDS
 19861           GO TO 4505-READ-PREV-RECORD.
 19862
 19863     IF PB-ISSUE
 19864        IF ISSUE-WITH-WARNING
 19865           IF PB-WARNING-ERRORS
 19866              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19867                  GO TO 4505-READ-PREV-RECORD
 19868              ELSE
 19869                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19870                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19871                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19872                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19873                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19874                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19875                 GO TO 7000-DISPLAY-ISSUES
 19876           ELSE
 19877              GO TO 4505-READ-PREV-RECORD.
 19878
 19879     IF PB-ISSUE
 19880        IF (ISSUES-IN-ERROR AND
 19881            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19882            ALL-ISSUES
 19883            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19884            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19885            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19886            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19887            MOVE PB-SV-STATE            TO PI-SV-STATE
 19888            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19889            GO TO 7000-DISPLAY-ISSUES
 19890        ELSE
 19891            GO TO 4505-READ-PREV-RECORD.
 19892
 19893     IF PB-CANCELLATION
 19894        IF DISPLAY-CHK-REQ-RECORDS
 19895           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 365
* EL6311.cbl
 19896              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19897              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19898              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19899              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19900              MOVE PB-SV-STATE            TO PI-SV-STATE
 19901              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19902              GO TO 7100-DISPLAY-CANCELS
 19903           ELSE
 19904              GO TO 4505-READ-PREV-RECORD.
 19905
 19906     IF PB-CANCELLATION
 19907        IF CANCEL-WITH-WARNING
 19908           IF PB-WARNING-ERRORS
 19909              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19910                  GO TO 4505-READ-PREV-RECORD
 19911              ELSE
 19912                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19913                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19914                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19915                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19916                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19917                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19918                 GO TO 7100-DISPLAY-CANCELS
 19919           ELSE
 19920              GO TO 4505-READ-PREV-RECORD.
 19921
 19922     IF PB-CANCELLATION
 19923        IF (CANCEL-IN-ERROR  AND
 19924            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19925            ALL-CANCELS
 19926            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19927            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19928            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19929            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19930            MOVE PB-SV-STATE            TO PI-SV-STATE
 19931            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19932            GO TO 7100-DISPLAY-CANCELS.
 19933
 19934     GO TO 4505-READ-PREV-RECORD.
 19935
 19936 4550-END-RECORDS.
 19937     IF PI-MAP-NAME = EL631B
 19938        MOVE -1                  TO BMAINTL
 19939     ELSE
 19940        IF PI-MAP-NAME = EL631C
 19941           MOVE -1               TO CMAINTL
 19942        ELSE
 19943           MOVE -1               TO DPFENTRL.
 19944
 19945     MOVE ER-2255               TO EMI-ERROR.
 19946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19947     GO TO 8200-SEND-DATAONLY.
 19948
 19949 4570-NOT-FOUND.
 19950
 19951******************************************************************
 19952*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19953******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 366
* EL6311.cbl
 19954
 19955
 19956* EXEC CICS RESETBR
 19957*         DATASET    (FILE-ID-ERPNDB2)
 19958*         RIDFLD     (ERPNDB-ALT-KEY)
 19959*    END-EXEC.
 19960     MOVE 0
 19961       TO DFHEIV11
 19962*    MOVE '&4         G          &   #00017032' TO DFHEIV0
 19963     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19964     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19965     MOVE X'2020233030303137303332' TO DFHEIV0(25:11)
 19966     CALL 'kxdfhei1' USING DFHEIV0,
 19967           FILE-ID-ERPNDB2,
 19968           ERPNDB-ALT-KEY,
 19969           DFHEIV99,
 19970           DFHEIV11,
 19971           DFHEIV99
 19972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19973
 19974
 19975
 19976* EXEC CICS READNEXT
 19977*         DATASET    (FILE-ID-ERPNDB2)
 19978*         SET        (ADDRESS OF PENDING-BUSINESS)
 19979*         RIDFLD     (ERPNDB-ALT-KEY)
 19980*    END-EXEC.
 19981     MOVE 0
 19982       TO DFHEIV11
 19983*    MOVE '&.S                   )   #00017037' TO DFHEIV0
 19984     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19985     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19986     MOVE X'2020233030303137303337' TO DFHEIV0(25:11)
 19987     CALL 'kxdfhei1' USING DFHEIV0,
 19988           FILE-ID-ERPNDB2,
 19989           DFHEIV20,
 19990           DFHEIV99,
 19991           ERPNDB-ALT-KEY,
 19992           DFHEIV99,
 19993           DFHEIV11,
 19994           DFHEIV99,
 19995           DFHEIV99
 19996     SET ADDRESS OF PENDING-BUSINESS TO
 19997         DFHEIV20
 19998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19999
 20000
 20001
 20002* EXEC CICS READPREV
 20003*         DATASET    (FILE-ID-ERPNDB2)
 20004*         SET        (ADDRESS OF PENDING-BUSINESS)
 20005*         RIDFLD     (ERPNDB-ALT-KEY)
 20006*    END-EXEC.
 20007     MOVE 0
 20008       TO DFHEIV11
 20009*    MOVE '&0S                   )   #00017043' TO DFHEIV0
 20010     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20011     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 367
* EL6311.cbl
 20012     MOVE X'2020233030303137303433' TO DFHEIV0(25:11)
 20013     CALL 'kxdfhei1' USING DFHEIV0,
 20014           FILE-ID-ERPNDB2,
 20015           DFHEIV20,
 20016           DFHEIV99,
 20017           ERPNDB-ALT-KEY,
 20018           DFHEIV99,
 20019           DFHEIV11,
 20020           DFHEIV99,
 20021           DFHEIV99
 20022     SET ADDRESS OF PENDING-BUSINESS TO
 20023         DFHEIV20
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20025
 20026
 20027 4580-READ-PREV-RECORD.
 20028
 20029* EXEC CICS READPREV
 20030*         DATASET    (FILE-ID-ERPNDB2)
 20031*         SET        (ADDRESS OF PENDING-BUSINESS)
 20032*         RIDFLD     (ERPNDB-ALT-KEY)
 20033*    END-EXEC.
 20034     MOVE 0
 20035       TO DFHEIV11
 20036*    MOVE '&0S                   )   #00017050' TO DFHEIV0
 20037     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20038     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20039     MOVE X'2020233030303137303530' TO DFHEIV0(25:11)
 20040     CALL 'kxdfhei1' USING DFHEIV0,
 20041           FILE-ID-ERPNDB2,
 20042           DFHEIV20,
 20043           DFHEIV99,
 20044           ERPNDB-ALT-KEY,
 20045           DFHEIV99,
 20046           DFHEIV11,
 20047           DFHEIV99,
 20048           DFHEIV99
 20049     SET ADDRESS OF PENDING-BUSINESS TO
 20050         DFHEIV20
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20055
 20056     IF WS-BATCH-PREFIX = '#CL'
 20057        GO TO 4580-READ-PREV-RECORD.
 20058
 20059     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20060     GO TO 4505-READ-PREV-RECORD.
 20061
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 368
* EL6311.cbl
 20063
 20064******************************************************************
 20065*                                                                *
 20066*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20067*                                                                *
 20068******************************************************************
 20069
 20070 4600-BROWSE-PRIMARY-BACKWARD.
 20071        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20072
 20073     IF ERPNDB-BATCH-SEQ-NO = +9999
 20074        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20075
 20076        IF ERPNDB-BATCH-SEQ-NO = +0000
 20077           GO TO 4650-END-BATCH
 20078        ELSE
 20079           IF PI-MAP-NAME NOT = EL631D
 20080              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20081                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20082              ELSE
 20083                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20084                 IF DISPLAY-CHANGE-RECORDS
 20085                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20086                 ELSE
 20087                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20088
 20089
 20090* EXEC CICS HANDLE CONDITION
 20091*         NOTFND    (4680-NOT-FOUND)
 20092*         ENDFILE   (4680-NOT-FOUND)
 20093*    END-EXEC.
 20094*    MOVE '"$I''                  ! O #00017091' TO DFHEIV0
 20095     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20097     MOVE X'4F20233030303137303931' TO DFHEIV0(25:11)
 20098     CALL 'kxdfhei1' USING DFHEIV0
 20099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20100
 20101
 20102 4605-READ-NEXT.
 20103     IF ERPNDB-BATCH-SEQ-NO = +0000
 20104        GO TO 4650-END-BATCH.
 20105
 20106     IF PI-DISPLAY-ORIGINAL-BATCH
 20107        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20108     ELSE
 20109        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20110
 20111
 20112* EXEC CICS READ
 20113*         DATASET   (FILE-ID)
 20114*         SET       (ADDRESS OF PENDING-BUSINESS)
 20115*         RIDFLD    (ERPNDB-KEY)
 20116*    END-EXEC.
 20117*    MOVE '&"S        E          (   #00017105' TO DFHEIV0
 20118     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20119     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20120     MOVE X'2020233030303137313035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 369
* EL6311.cbl
 20121     CALL 'kxdfhei1' USING DFHEIV0,
 20122           FILE-ID,
 20123           DFHEIV20,
 20124           DFHEIV99,
 20125           ERPNDB-KEY,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99
 20129     SET ADDRESS OF PENDING-BUSINESS TO
 20130         DFHEIV20
 20131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20132
 20133
 20134     IF NOT  PI-PRIMARY-WITH-SELECT
 20135        GO TO 4607-CHECK-REC-TYPE.
 20136
 20137     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20138
 20139     IF  WS-BATCH-PREFIX = '#CL'
 20140         GO TO 4610-BUMP-SEQ.
 20141
 20142     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20143        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20144           GO TO 4610-BUMP-SEQ
 20145        ELSE
 20146           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20147              GO TO 4607-CHECK-REC-TYPE
 20148           ELSE
 20149              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20150                 GO TO 4607-CHECK-REC-TYPE
 20151              ELSE
 20152                 GO TO 4610-BUMP-SEQ.
 20153
 20154     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20155        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20156           GO TO 4610-BUMP-SEQ.
 20157
 20158 4607-CHECK-REC-TYPE.
 20159     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20160         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20161             NEXT SENTENCE
 20162         ELSE
 20163             GO TO 4610-BUMP-SEQ.
 20164
 20165     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20166         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20167             NEXT SENTENCE
 20168        ELSE
 20169             GO TO 4610-BUMP-SEQ.
 20170
 20171     IF NOT DISPLAY-CHANGE-RECORDS AND
 20172            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20173        GO TO 4610-BUMP-SEQ.
 20174
 20175     IF DISPLAY-HOLD-RECORDS AND
 20176        NOT PB-RECORD-ON-HOLD
 20177          GO TO 4610-BUMP-SEQ.
 20178
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 370
* EL6311.cbl
 20179     IF PB-ISSUE
 20180        IF DISPLAY-CHK-REQ-RECORDS
 20181           GO TO 4610-BUMP-SEQ.
 20182
 20183     IF PB-ISSUE
 20184        IF ISSUE-WITH-WARNING
 20185           IF PB-WARNING-ERRORS
 20186              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20187                  GO TO 4610-BUMP-SEQ
 20188              ELSE
 20189                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20190                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20191                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20192                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20193                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20194                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20195                 GO TO 7000-DISPLAY-ISSUES
 20196           ELSE
 20197              GO TO 4610-BUMP-SEQ.
 20198
 20199     IF PB-ISSUE
 20200        IF (ISSUES-IN-ERROR AND
 20201            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20202            ALL-ISSUES
 20203            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20204            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20205            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20206            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20207            MOVE PB-SV-STATE            TO PI-SV-STATE
 20208            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20209            GO TO 7000-DISPLAY-ISSUES
 20210        ELSE
 20211            GO TO 4610-BUMP-SEQ.
 20212
 20213     IF PB-CANCELLATION
 20214        IF DISPLAY-CHK-REQ-RECORDS
 20215           IF PB-C-REFUND-REQUESTED
 20216              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20217              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20218              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20219              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20220              MOVE PB-SV-STATE            TO PI-SV-STATE
 20221              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20222              GO TO 7100-DISPLAY-CANCELS
 20223           ELSE
 20224              GO TO 4610-BUMP-SEQ.
 20225
 20226     IF PB-CANCELLATION
 20227        IF CANCEL-WITH-WARNING
 20228           IF PB-WARNING-ERRORS
 20229              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20230                  GO TO 4610-BUMP-SEQ
 20231              ELSE
 20232                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20233                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20234                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20235                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20236                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 371
* EL6311.cbl
 20237                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20238                 GO TO 7100-DISPLAY-CANCELS
 20239           ELSE
 20240              GO TO 4610-BUMP-SEQ.
 20241
 20242     IF PB-CANCELLATION
 20243        IF (CANCEL-IN-ERROR  AND
 20244            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20245            ALL-CANCELS
 20246            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20247            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20248            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20249            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20250            MOVE PB-SV-STATE            TO PI-SV-STATE
 20251            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20252            GO TO 7100-DISPLAY-CANCELS.
 20253
 20254 4610-BUMP-SEQ.
 20255     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20256        GO TO 4650-END-BATCH.
 20257
 20258     IF DISPLAY-CHANGE-RECORDS
 20259        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20260           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20261        ELSE
 20262           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20263           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20264        ELSE
 20265           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20266           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20267
 20268        GO TO 4605-READ-NEXT.
 20269
 20270 4650-END-BATCH.
 20271     IF PI-MAP-NAME = EL631B
 20272        MOVE -1                  TO BMAINTL
 20273     ELSE
 20274        IF PI-MAP-NAME = EL631C
 20275           MOVE -1               TO CMAINTL
 20276        ELSE
 20277           MOVE -1               TO DPFENTRL.
 20278
 20279     MOVE ER-2252               TO EMI-ERROR.
 20280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20281     GO TO 8200-SEND-DATAONLY.
 20282
 20283 4680-NOT-FOUND.
 20284     IF DISPLAY-CHANGE-RECORDS
 20285        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20286           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20287        ELSE
 20288           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20289           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20290     ELSE
 20291        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20292
 20293     GO TO 4605-READ-NEXT.
 20294
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 372
* EL6311.cbl
 20296
 20297******************************************************************
 20298*                                                                *
 20299*        B R O W S E   F I L E   B A C K W A R D S               *
 20300*                                                                *
 20301******************************************************************
 20302
 20303 4800-BROWSE-FILE-BACKWARD.
 20304
 20305* EXEC CICS HANDLE CONDITION
 20306*         NOTFND   (4860-NOT-FOUND)
 20307*         ENDFILE  (4850-END-RECORDS)
 20308*    END-EXEC.
 20309*    MOVE '"$I''                  ! P #00017281' TO DFHEIV0
 20310     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20312     MOVE X'5020233030303137323831' TO DFHEIV0(25:11)
 20313     CALL 'kxdfhei1' USING DFHEIV0
 20314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20315
 20316
 20317     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20318
 20319     IF PI-DISPLAY-ORIGINAL-BATCH
 20320        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20321     ELSE
 20322        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20323
 20324
 20325* EXEC CICS STARTBR
 20326*         DATASET   (FILE-ID)
 20327*         RIDFLD    (ERPNDB-KEY)
 20328*    END-EXEC.
 20329     MOVE 0
 20330       TO DFHEIV11
 20331*    MOVE '&,         G          &   #00017293' TO DFHEIV0
 20332     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303137323933' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           FILE-ID,
 20337           ERPNDB-KEY,
 20338           DFHEIV99,
 20339           DFHEIV11,
 20340           DFHEIV99
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20345
 20346
 20347* EXEC CICS READPREV
 20348*         DATASET    (FILE-ID-ERPNDB)
 20349*         SET        (ADDRESS OF PENDING-BUSINESS)
 20350*         RIDFLD     (ERPNDB-KEY)
 20351*    END-EXEC.
 20352     MOVE 0
 20353       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 373
* EL6311.cbl
 20354*    MOVE '&0S                   )   #00017300' TO DFHEIV0
 20355     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20356     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20357     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 20358     CALL 'kxdfhei1' USING DFHEIV0,
 20359           FILE-ID-ERPNDB,
 20360           DFHEIV20,
 20361           DFHEIV99,
 20362           ERPNDB-KEY,
 20363           DFHEIV99,
 20364           DFHEIV11,
 20365           DFHEIV99,
 20366           DFHEIV99
 20367     SET ADDRESS OF PENDING-BUSINESS TO
 20368         DFHEIV20
 20369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20370
 20371
 20372 4810-READ-PREV-RECORD.
 20373
 20374* EXEC CICS READPREV
 20375*         DATASET    (FILE-ID-ERPNDB)
 20376*         SET        (ADDRESS OF PENDING-BUSINESS)
 20377*         RIDFLD     (ERPNDB-KEY)
 20378*    END-EXEC.
 20379     MOVE 0
 20380       TO DFHEIV11
 20381*    MOVE '&0S                   )   #00017307' TO DFHEIV0
 20382     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20384     MOVE X'2020233030303137333037' TO DFHEIV0(25:11)
 20385     CALL 'kxdfhei1' USING DFHEIV0,
 20386           FILE-ID-ERPNDB,
 20387           DFHEIV20,
 20388           DFHEIV99,
 20389           ERPNDB-KEY,
 20390           DFHEIV99,
 20391           DFHEIV11,
 20392           DFHEIV99,
 20393           DFHEIV99
 20394     SET ADDRESS OF PENDING-BUSINESS TO
 20395         DFHEIV20
 20396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20397
 20398
 20399     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20400        GO TO 4850-END-RECORDS.
 20401
 20402     IF PB-BATCH-TRAILER
 20403        GO TO 4810-READ-PREV-RECORD.
 20404
 20405     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20406
 20407     IF  WS-BATCH-PREFIX = '#CL'
 20408         GO TO 4810-READ-PREV-RECORD.
 20409
 20410     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20411        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 374
* EL6311.cbl
 20412           GO TO 4810-READ-PREV-RECORD
 20413        ELSE
 20414           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20415              GO TO 4820-CHECK-REC-TYPE
 20416           ELSE
 20417              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20418                 GO TO 4820-CHECK-REC-TYPE
 20419              ELSE
 20420                 GO TO 4810-READ-PREV-RECORD.
 20421
 20422     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20423        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20424           GO TO 4810-READ-PREV-RECORD.
 20425
 20426 4820-CHECK-REC-TYPE.
 20427     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20428         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20429             NEXT SENTENCE
 20430         ELSE
 20431             GO TO 4810-READ-PREV-RECORD.
 20432
 20433     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20434         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20435             NEXT SENTENCE
 20436        ELSE
 20437             GO TO 4810-READ-PREV-RECORD.
 20438
 20439     IF NOT DISPLAY-CHANGE-RECORDS AND
 20440            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20441        GO TO 4810-READ-PREV-RECORD.
 20442
 20443     IF DISPLAY-HOLD-RECORDS AND
 20444        NOT PB-RECORD-ON-HOLD
 20445          GO TO 4810-READ-PREV-RECORD.
 20446
 20447     IF PB-ISSUE
 20448        IF DISPLAY-CHK-REQ-RECORDS
 20449           GO TO 4810-READ-PREV-RECORD.
 20450
 20451     IF PB-ISSUE
 20452        IF ISSUE-WITH-WARNING
 20453           IF PB-WARNING-ERRORS
 20454              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20455                  GO TO 4810-READ-PREV-RECORD
 20456              ELSE
 20457                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20458                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20459                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20460                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20461                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20462                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20463                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20464                 GO TO 7000-DISPLAY-ISSUES
 20465           ELSE
 20466              GO TO 4810-READ-PREV-RECORD.
 20467
 20468     IF PB-ISSUE
 20469        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 375
* EL6311.cbl
 20470            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20471            ALL-ISSUES
 20472            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20473            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20474            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20475            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20476            MOVE PB-SV-STATE            TO PI-SV-STATE
 20477            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20478            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20479            GO TO 7000-DISPLAY-ISSUES
 20480        ELSE
 20481            GO TO 4810-READ-PREV-RECORD.
 20482
 20483     IF PB-CANCELLATION
 20484        IF DISPLAY-CHK-REQ-RECORDS
 20485           IF PB-C-REFUND-REQUESTED
 20486              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20487              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20488              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20489              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20490              MOVE PB-SV-STATE            TO PI-SV-STATE
 20491              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20492              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20493              GO TO 7100-DISPLAY-CANCELS
 20494           ELSE
 20495              GO TO 4810-READ-PREV-RECORD.
 20496
 20497     IF PB-CANCELLATION
 20498        IF CANCEL-WITH-WARNING
 20499           IF PB-WARNING-ERRORS
 20500              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20501                  GO TO 4810-READ-PREV-RECORD
 20502              ELSE
 20503                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20504                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20505                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20506                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20507                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20508                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20509                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20510                 GO TO 7100-DISPLAY-CANCELS
 20511           ELSE
 20512              GO TO 4810-READ-PREV-RECORD.
 20513
 20514     IF PB-CANCELLATION
 20515        IF (CANCEL-IN-ERROR  AND
 20516            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20517            ALL-CANCELS
 20518            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20519            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20520            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20521            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20522            MOVE PB-SV-STATE            TO PI-SV-STATE
 20523            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20524            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20525            GO TO 7100-DISPLAY-CANCELS.
 20526
 20527     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 376
* EL6311.cbl
 20528
 20529 4850-END-RECORDS.
 20530     MOVE ER-2252                TO EMI-ERROR.
 20531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20532
 20533     IF PI-MAP-NAME = EL631B
 20534        MOVE -1                  TO BPFENTRL
 20535     ELSE
 20536        MOVE -1                  TO CPFENTRL.
 20537
 20538     GO TO 8200-SEND-DATAONLY.
 20539
 20540 4860-NOT-FOUND.
 20541
 20542******************************************************************
 20543*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20544******************************************************************
 20545
 20546
 20547* EXEC CICS RESETBR
 20548*         DATASET    (FILE-ID-ERPNDB)
 20549*         RIDFLD     (ERPNDB-KEY)
 20550*     END-EXEC.
 20551     MOVE 0
 20552       TO DFHEIV11
 20553*    MOVE '&4         G          &   #00017460' TO DFHEIV0
 20554     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20555     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20556     MOVE X'2020233030303137343630' TO DFHEIV0(25:11)
 20557     CALL 'kxdfhei1' USING DFHEIV0,
 20558           FILE-ID-ERPNDB,
 20559           ERPNDB-KEY,
 20560           DFHEIV99,
 20561           DFHEIV11,
 20562           DFHEIV99
 20563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20564
 20565
 20566
 20567* EXEC CICS READNEXT
 20568*         DATASET    (FILE-ID-ERPNDB)
 20569*         SET        (ADDRESS OF PENDING-BUSINESS)
 20570*         RIDFLD     (ERPNDB-KEY)
 20571*    END-EXEC.
 20572     MOVE 0
 20573       TO DFHEIV11
 20574*    MOVE '&.S                   )   #00017465' TO DFHEIV0
 20575     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20576     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20577     MOVE X'2020233030303137343635' TO DFHEIV0(25:11)
 20578     CALL 'kxdfhei1' USING DFHEIV0,
 20579           FILE-ID-ERPNDB,
 20580           DFHEIV20,
 20581           DFHEIV99,
 20582           ERPNDB-KEY,
 20583           DFHEIV99,
 20584           DFHEIV11,
 20585           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 377
* EL6311.cbl
 20586           DFHEIV99
 20587     SET ADDRESS OF PENDING-BUSINESS TO
 20588         DFHEIV20
 20589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20590
 20591
 20592
 20593* EXEC CICS READPREV
 20594*         DATASET    (FILE-ID-ERPNDB)
 20595*         SET        (ADDRESS OF PENDING-BUSINESS)
 20596*         RIDFLD     (ERPNDB-KEY)
 20597*    END-EXEC.
 20598     MOVE 0
 20599       TO DFHEIV11
 20600*    MOVE '&0S                   )   #00017471' TO DFHEIV0
 20601     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20602     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20603     MOVE X'2020233030303137343731' TO DFHEIV0(25:11)
 20604     CALL 'kxdfhei1' USING DFHEIV0,
 20605           FILE-ID-ERPNDB,
 20606           DFHEIV20,
 20607           DFHEIV99,
 20608           ERPNDB-KEY,
 20609           DFHEIV99,
 20610           DFHEIV11,
 20611           DFHEIV99,
 20612           DFHEIV99
 20613     SET ADDRESS OF PENDING-BUSINESS TO
 20614         DFHEIV20
 20615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20616
 20617
 20618     GO TO 4810-READ-PREV-RECORD.
 20619
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 378
* EL6311.cbl
 20621
 20622******************************************************************
 20623*                                                                *
 20624*           B R O W S E   C S R   B A C K W A R D                *
 20625*                                                                *
 20626******************************************************************
 20627
 20628 4900-BROWSE-CSR-BACKWARD.
 20629
 20630     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20631
 20632
 20633* EXEC CICS HANDLE CONDITION
 20634*         NOTFND   (4970-NOT-FOUND)
 20635*         ENDFILE  (4950-END-RECORDS)
 20636*    END-EXEC
 20637*    MOVE '"$I''                  ! Q #00017491' TO DFHEIV0
 20638     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20640     MOVE X'5120233030303137343931' TO DFHEIV0(25:11)
 20641     CALL 'kxdfhei1' USING DFHEIV0
 20642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20643
 20644
 20645* EXEC CICS STARTBR
 20646*         DATASET   (FILE-ID-ERPNDB4)
 20647*         RIDFLD    (ERPNDB-CSR-KEY)
 20648*    END-EXEC.
 20649     MOVE 0
 20650       TO DFHEIV11
 20651*    MOVE '&,         G          &   #00017496' TO DFHEIV0
 20652     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20653     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20654     MOVE X'2020233030303137343936' TO DFHEIV0(25:11)
 20655     CALL 'kxdfhei1' USING DFHEIV0,
 20656           FILE-ID-ERPNDB4,
 20657           ERPNDB-CSR-KEY,
 20658           DFHEIV99,
 20659           DFHEIV11,
 20660           DFHEIV99
 20661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20662
 20663
 20664     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20665                                    WS-FIRST-TIME-SW.
 20666
 20667 4905-READ-PREV-RECORD.
 20668
 20669* EXEC CICS READPREV
 20670*         DATASET    (FILE-ID-ERPNDB4)
 20671*         SET        (ADDRESS OF PENDING-BUSINESS)
 20672*         RIDFLD     (ERPNDB-CSR-KEY)
 20673*    END-EXEC.
 20674     MOVE 0
 20675       TO DFHEIV11
 20676*    MOVE '&0S                   )   #00017505' TO DFHEIV0
 20677     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20678     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 379
* EL6311.cbl
 20679     MOVE X'2020233030303137353035' TO DFHEIV0(25:11)
 20680     CALL 'kxdfhei1' USING DFHEIV0,
 20681           FILE-ID-ERPNDB4,
 20682           DFHEIV20,
 20683           DFHEIV99,
 20684           ERPNDB-CSR-KEY,
 20685           DFHEIV99,
 20686           DFHEIV11,
 20687           DFHEIV99,
 20688           DFHEIV99
 20689     SET ADDRESS OF PENDING-BUSINESS TO
 20690         DFHEIV20
 20691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20692
 20693
 20694     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20695
 20696     IF WS-BATCH-PREFIX = '#CL'
 20697         GO TO 4905-READ-PREV-RECORD.
 20698
 20699     IF FIRST-TIME
 20700         MOVE SPACE               TO WS-FIRST-TIME-SW
 20701         GO TO 4905-READ-PREV-RECORD.
 20702
 20703     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20704        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20705        GO TO 4950-END-RECORDS.
 20706
 20707     IF PB-BATCH-TRAILER
 20708        GO TO 4905-READ-PREV-RECORD.
 20709
 20710     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20711
 20712     IF  WS-BATCH-PREFIX = '#CL'
 20713         GO TO 4905-READ-PREV-RECORD.
 20714
 20715     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20716        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20717           GO TO 4905-READ-PREV-RECORD
 20718        ELSE
 20719           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20720              GO TO 4910-CHECK-REC-TYPE
 20721           ELSE
 20722              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20723                 GO TO 4910-CHECK-REC-TYPE
 20724              ELSE
 20725                 GO TO 4905-READ-PREV-RECORD.
 20726
 20727     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20728        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20729           GO TO 4905-READ-PREV-RECORD.
 20730
 20731 4910-CHECK-REC-TYPE.
 20732     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20733         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20734             NEXT SENTENCE
 20735         ELSE
 20736             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 380
* EL6311.cbl
 20737
 20738     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20739         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20740             NEXT SENTENCE
 20741        ELSE
 20742             GO TO 4905-READ-PREV-RECORD.
 20743
 20744     IF NOT DISPLAY-CHANGE-RECORDS AND
 20745            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20746        GO TO 4905-READ-PREV-RECORD.
 20747
 20748     IF DISPLAY-HOLD-RECORDS AND
 20749        NOT PB-RECORD-ON-HOLD
 20750          GO TO 4905-READ-PREV-RECORD.
 20751
 20752     IF PB-ISSUE
 20753        IF DISPLAY-CHK-REQ-RECORDS
 20754           GO TO 4905-READ-PREV-RECORD.
 20755
 20756     IF PB-ISSUE
 20757        IF ISSUE-WITH-WARNING
 20758           IF PB-WARNING-ERRORS
 20759              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20760                  GO TO 4505-READ-PREV-RECORD
 20761              ELSE
 20762                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20763                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20764                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20765                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20766                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20767                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20768                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20769                 GO TO 7000-DISPLAY-ISSUES
 20770           ELSE
 20771              GO TO 4905-READ-PREV-RECORD.
 20772
 20773     IF PB-ISSUE
 20774        IF (ISSUES-IN-ERROR AND
 20775            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20776            ALL-ISSUES
 20777            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20778            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20779            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20780            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20781            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20782            MOVE PB-SV-STATE            TO PI-SV-STATE
 20783            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20784            GO TO 7000-DISPLAY-ISSUES
 20785        ELSE
 20786            GO TO 4905-READ-PREV-RECORD.
 20787
 20788     IF PB-CANCELLATION
 20789        IF DISPLAY-CHK-REQ-RECORDS
 20790           IF PB-C-REFUND-REQUESTED
 20791              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20792              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20793              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20794              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 381
* EL6311.cbl
 20795              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20796              MOVE PB-SV-STATE            TO PI-SV-STATE
 20797              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20798              GO TO 7100-DISPLAY-CANCELS
 20799           ELSE
 20800              GO TO 4905-READ-PREV-RECORD.
 20801
 20802     IF PB-CANCELLATION
 20803        IF CANCEL-WITH-WARNING
 20804           IF PB-WARNING-ERRORS
 20805              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20806                  GO TO 4505-READ-PREV-RECORD
 20807              ELSE
 20808                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20809                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20810                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20811                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20812                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20813                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20814                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20815                 GO TO 7100-DISPLAY-CANCELS
 20816           ELSE
 20817              GO TO 4905-READ-PREV-RECORD.
 20818
 20819     IF PB-CANCELLATION
 20820        IF (CANCEL-IN-ERROR  AND
 20821            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20822            ALL-CANCELS
 20823            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20824            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20825            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20826            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20827            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20828            MOVE PB-SV-STATE            TO PI-SV-STATE
 20829            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20830            GO TO 7100-DISPLAY-CANCELS.
 20831
 20832     GO TO 4905-READ-PREV-RECORD.
 20833
 20834 4950-END-RECORDS.
 20835     IF PI-MAP-NAME = EL631B
 20836        MOVE -1                  TO BMAINTL
 20837     ELSE
 20838        IF PI-MAP-NAME = EL631C
 20839           MOVE -1               TO CMAINTL
 20840        ELSE
 20841           MOVE -1               TO DPFENTRL.
 20842
 20843     MOVE ER-2255               TO EMI-ERROR.
 20844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20845     GO TO 8200-SEND-DATAONLY.
 20846
 20847 4970-NOT-FOUND.
 20848
 20849******************************************************************
 20850*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20851******************************************************************
 20852
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 382
* EL6311.cbl
 20853
 20854* EXEC CICS RESETBR
 20855*         DATASET    (FILE-ID-ERPNDB4)
 20856*         RIDFLD     (ERPNDB-CSR-KEY)
 20857*    END-EXEC.
 20858     MOVE 0
 20859       TO DFHEIV11
 20860*    MOVE '&4         G          &   #00017670' TO DFHEIV0
 20861     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20863     MOVE X'2020233030303137363730' TO DFHEIV0(25:11)
 20864     CALL 'kxdfhei1' USING DFHEIV0,
 20865           FILE-ID-ERPNDB4,
 20866           ERPNDB-CSR-KEY,
 20867           DFHEIV99,
 20868           DFHEIV11,
 20869           DFHEIV99
 20870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20871
 20872
 20873
 20874* EXEC CICS READNEXT
 20875*         DATASET    (FILE-ID-ERPNDB4)
 20876*         SET        (ADDRESS OF PENDING-BUSINESS)
 20877*         RIDFLD     (ERPNDB-CSR-KEY)
 20878*    END-EXEC.
 20879     MOVE 0
 20880       TO DFHEIV11
 20881*    MOVE '&.S                   )   #00017675' TO DFHEIV0
 20882     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20883     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20884     MOVE X'2020233030303137363735' TO DFHEIV0(25:11)
 20885     CALL 'kxdfhei1' USING DFHEIV0,
 20886           FILE-ID-ERPNDB4,
 20887           DFHEIV20,
 20888           DFHEIV99,
 20889           ERPNDB-CSR-KEY,
 20890           DFHEIV99,
 20891           DFHEIV11,
 20892           DFHEIV99,
 20893           DFHEIV99
 20894     SET ADDRESS OF PENDING-BUSINESS TO
 20895         DFHEIV20
 20896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20897
 20898
 20899
 20900* EXEC CICS READPREV
 20901*         DATASET    (FILE-ID-ERPNDB4)
 20902*         SET        (ADDRESS OF PENDING-BUSINESS)
 20903*         RIDFLD     (ERPNDB-CSR-KEY)
 20904*    END-EXEC.
 20905     MOVE 0
 20906       TO DFHEIV11
 20907*    MOVE '&0S                   )   #00017681' TO DFHEIV0
 20908     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20909     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20910     MOVE X'2020233030303137363831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 383
* EL6311.cbl
 20911     CALL 'kxdfhei1' USING DFHEIV0,
 20912           FILE-ID-ERPNDB4,
 20913           DFHEIV20,
 20914           DFHEIV99,
 20915           ERPNDB-CSR-KEY,
 20916           DFHEIV99,
 20917           DFHEIV11,
 20918           DFHEIV99,
 20919           DFHEIV99
 20920     SET ADDRESS OF PENDING-BUSINESS TO
 20921         DFHEIV20
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925 4980-READ-PREV-RECORD.
 20926
 20927* EXEC CICS READPREV
 20928*         DATASET    (FILE-ID-ERPNDB4)
 20929*         SET        (ADDRESS OF PENDING-BUSINESS)
 20930*         RIDFLD     (ERPNDB-CSR-KEY)
 20931*    END-EXEC.
 20932     MOVE 0
 20933       TO DFHEIV11
 20934*    MOVE '&0S                   )   #00017688' TO DFHEIV0
 20935     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20937     MOVE X'2020233030303137363838' TO DFHEIV0(25:11)
 20938     CALL 'kxdfhei1' USING DFHEIV0,
 20939           FILE-ID-ERPNDB4,
 20940           DFHEIV20,
 20941           DFHEIV99,
 20942           ERPNDB-CSR-KEY,
 20943           DFHEIV99,
 20944           DFHEIV11,
 20945           DFHEIV99,
 20946           DFHEIV99
 20947     SET ADDRESS OF PENDING-BUSINESS TO
 20948         DFHEIV20
 20949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20950
 20951
 20952     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20953
 20954     IF WS-BATCH-PREFIX = '#CL'
 20955        GO TO 4980-READ-PREV-RECORD.
 20956
 20957     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20958     GO TO 4905-READ-PREV-RECORD.
 20959
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 384
* EL6311.cbl
 20961
 20962
 20963******************************************************************
 20964*                                                                *
 20965*        B R O W S E   B A T C H   H E A D E R S                 *
 20966*                                                                *
 20967******************************************************************
 20968
 20969 5000-BROWSE-BATCH-HEADERS.
 20970
 20971     IF EIBTRNID NOT = TRANS-EXB1
 20972        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20973        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20974        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20975        GO TO 5010-READ-NEXT-RECORD.
 20976
 20977     IF EIBAID = DFHPF4
 20978        MOVE '0'                TO PI-EDIT-SW
 20979        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20980        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20981        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20982        GO TO 5010-READ-NEXT-RECORD.
 20983
 20984     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20985     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20986     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20987
 20988
 20989* EXEC CICS HANDLE CONDITION
 20990*         ENDFILE  (5050-NOT-FOUND)
 20991*    END-EXEC.
 20992*    MOVE '"$''                   ! R #00017730' TO DFHEIV0
 20993     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20995     MOVE X'5220233030303137373330' TO DFHEIV0(25:11)
 20996     CALL 'kxdfhei1' USING DFHEIV0
 20997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20998
 20999
 21000 5010-READ-NEXT-RECORD.
 21001
 21002* EXEC CICS HANDLE CONDITION
 21003*         NOTFND    (5050-NOT-FOUND)
 21004*    END-EXEC.
 21005*    MOVE '"$I                   ! S #00017735' TO DFHEIV0
 21006     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21008     MOVE X'5320233030303137373335' TO DFHEIV0(25:11)
 21009     CALL 'kxdfhei1' USING DFHEIV0
 21010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21011
 21012
 21013
 21014* EXEC CICS READ
 21015*         DATASET   (FILE-ID-ERPNDB)
 21016*         SET       (ADDRESS OF PENDING-BUSINESS)
 21017*         RIDFLD    (ERPNDB-KEY)
 21018*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 385
* EL6311.cbl
 21019*    END-EXEC.
 21020*    MOVE '&"S        G          (   #00017739' TO DFHEIV0
 21021     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21023     MOVE X'2020233030303137373339' TO DFHEIV0(25:11)
 21024     CALL 'kxdfhei1' USING DFHEIV0,
 21025           FILE-ID-ERPNDB,
 21026           DFHEIV20,
 21027           DFHEIV99,
 21028           ERPNDB-KEY,
 21029           DFHEIV99,
 21030           DFHEIV99,
 21031           DFHEIV99
 21032     SET ADDRESS OF PENDING-BUSINESS TO
 21033         DFHEIV20
 21034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21035
 21036
 21037     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21038         GO TO 5050-NOT-FOUND.
 21039
 21040     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21041
 21042     IF WS-BATCH-PREFIX = '#CL'
 21043         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21044         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21045         GO TO 5010-READ-NEXT-RECORD.
 21046
 21047     IF NOT PB-BATCH-TRAILER
 21048         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21049         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21050         GO TO 5010-READ-NEXT-RECORD.
 21051
 21052     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21053         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21054             NEXT SENTENCE
 21055         ELSE
 21056             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21057             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21058             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21059             GO TO 5010-READ-NEXT-RECORD.
 21060
 21061     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21062         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21063             NEXT SENTENCE
 21064        ELSE
 21065             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21066             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21067             GO TO 5010-READ-NEXT-RECORD.
 21068
 21069     IF EIBAID = DFHPF4
 21070        MOVE '0'                TO PI-EDIT-SW
 21071        GO TO 7200-DISPLAY-BATCHES.
 21072
 21073     IF PI-CSR-BROWSE
 21074        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21075           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21076           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 386
* EL6311.cbl
 21077           GO TO 5010-READ-NEXT-RECORD.
 21078
 21079     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21080       IF PI-PB-CARRIER    = SPACES AND
 21081          PI-PB-GROUPING   = SPACES AND
 21082          PI-PB-STATE      = SPACES AND
 21083          PI-PB-ACCOUNT    = SPACES
 21084            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21085            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21086            GO TO 7200-DISPLAY-BATCHES
 21087         ELSE
 21088           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21089              PI-PB-GROUPING   = PB-GROUPING AND
 21090              PI-PB-STATE      = PB-STATE    AND
 21091              PI-PB-ACCOUNT    = PB-ACCOUNT
 21092              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21093              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21094              GO TO 7200-DISPLAY-BATCHES.
 21095
 21096     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21097     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21098
 21099
 21100* EXEC CICS HANDLE CONDITION
 21101*         NOTFND    (5050-NOT-FOUND)
 21102*    END-EXEC.
 21103*    MOVE '"$I                   ! T #00017808' TO DFHEIV0
 21104     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21105     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21106     MOVE X'5420233030303137383038' TO DFHEIV0(25:11)
 21107     CALL 'kxdfhei1' USING DFHEIV0
 21108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21109
 21110
 21111
 21112* EXEC CICS READ
 21113*         DATASET   (FILE-ID-ERPNDB)
 21114*         SET       (ADDRESS OF PENDING-BUSINESS)
 21115*         RIDFLD    (ERPNDB-KEY)
 21116*         GTEQ
 21117*    END-EXEC.
 21118*    MOVE '&"S        G          (   #00017812' TO DFHEIV0
 21119     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21120     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21121     MOVE X'2020233030303137383132' TO DFHEIV0(25:11)
 21122     CALL 'kxdfhei1' USING DFHEIV0,
 21123           FILE-ID-ERPNDB,
 21124           DFHEIV20,
 21125           DFHEIV99,
 21126           ERPNDB-KEY,
 21127           DFHEIV99,
 21128           DFHEIV99,
 21129           DFHEIV99
 21130     SET ADDRESS OF PENDING-BUSINESS TO
 21131         DFHEIV20
 21132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21133
 21134
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 387
* EL6311.cbl
 21135     GO TO 5010-READ-NEXT-RECORD.
 21136
 21137 5050-NOT-FOUND.
 21138
 21139******************************************************************
 21140*                                                                *
 21141*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21142*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21143*         PROGRAM.                                               *
 21144*                                                                *
 21145******************************************************************
 21146
 21147     IF EIBTRNID NOT = TRANS-EXB1
 21148        IF PENDING-BUS-RECS-FOUND
 21149            NEXT SENTENCE
 21150          ELSE
 21151            MOVE '9'            TO PI-BROWSE-SW
 21152            GO TO 9400-CLEAR.
 21153
 21154     MOVE ER-2256                TO EMI-ERROR.
 21155     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21156
 21157     IF PI-MAP-NAME = SPACES
 21158        MOVE EL631D              TO PI-MAP-NAME
 21159        MOVE -1                  TO DPFENTRL
 21160        GO TO 8100-SEND-INITIAL-MAP.
 21161
 21162     IF PI-MAP-NAME = EL631B
 21163        MOVE -1                  TO BMAINTL
 21164     ELSE
 21165        IF PI-MAP-NAME = EL631C
 21166           MOVE -1               TO CMAINTL
 21167        ELSE
 21168           MOVE -1               TO DPFENTRL
 21169           GO TO 8200-SEND-DATAONLY.
 21170
 21171     GO TO 8100-SEND-INITIAL-MAP.
 21172
 21173     .
 21174 5100-PROCESS-POL-RESC.
 21175     MOVE ZEROS                  TO CG-LF-BENCD
 21176                                    CG-AH-BENCD
 21177                                    CG-LF-CAN-AMT
 21178                                    CG-AH-CAN-AMT
 21179     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21180                                    CG-AH-CAN-DT
 21181     MOVE SPACES                 TO CG-BATCH-NO
 21182     MOVE '4'                    TO CG-OPTION-CODE
 21183     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21184     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21185     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21186     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21187     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21188     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21189     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21190     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21191     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21192     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 388
* EL6311.cbl
 21193     MOVE PI-PREV-ALT-KEY (1:33)
 21194                                 TO CG-CERT-KEY
 21195     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21196     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21197                                    CG-AH-CAN-AMT
 21198     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21199                                    CG-AH-CAN-DT
 21200     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21201     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21202      display 'about to cancel ' cg-cert-key
 21203
 21204* EXEC CICS LINK
 21205*        PROGRAM  ('ELCANC')
 21206*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21207*    END-EXEC
 21208     MOVE LENGTH OF
 21209      CANCEL-GEN-PASS-AREA
 21210       TO DFHEIV11
 21211     MOVE 'ELCANC' TO DFHEIV1
 21212*    MOVE '."C                   (   #00017887' TO DFHEIV0
 21213     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21215     MOVE X'2020233030303137383837' TO DFHEIV0(25:11)
 21216     CALL 'kxdfhei1' USING DFHEIV0,
 21217           DFHEIV1,
 21218           CANCEL-GEN-PASS-AREA,
 21219           DFHEIV11,
 21220           DFHEIV99,
 21221           DFHEIV99,
 21222           DFHEIV99,
 21223           DFHEIV99
 21224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21225     IF CG-SUCCESS
 21226        CONTINUE
 21227     ELSE
 21228        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21229        MOVE '3'                 TO EMI-SWITCH1
 21230        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21231        EVALUATE TRUE
 21232           WHEN CG-DATE-ERROR
 21233             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21234           WHEN CG-CERT-NOT-FOUND
 21235             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21236           WHEN CG-AMOUNT-ERROR
 21237             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21238           WHEN CG-OPTION-ERROR
 21239             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21240           WHEN CG-PREV-CAN
 21241             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21242           WHEN CG-INVALID-DATA
 21243             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21244           WHEN CG-NO-ACCT-MSTR
 21245             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21246           WHEN CG-SFX-A-EXIST
 21247             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21248           WHEN CG-MISC-ERROR
 21249             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21250           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 389
* EL6311.cbl
 21251             MOVE ' ERROR - ELCANC - RETURN '
 21252                                 TO EMI-ERROR-TEXT (1) (12:25)
 21253        END-EVALUATE
 21254        GO TO 8200-SEND-DATAONLY
 21255     END-IF
 21256     .
 21257 5100-EXIT.
 21258     EXIT.
 21259
 21260******************************************************************
 21261*                                                                *
 21262*        B R O W S E   B A T C H   B A C K W A R D S             *
 21263*                                                                *
 21264******************************************************************
 21265
 21266 5500-BROWSE-BATCH-BACKWARD.
 21267
 21268* EXEC CICS HANDLE CONDITION
 21269*         NOTFND   (5550-END-RECORDS)
 21270*         ENDFILE  (5550-END-RECORDS)
 21271*    END-EXEC.
 21272*    MOVE '"$I''                  ! U #00017933' TO DFHEIV0
 21273     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21275     MOVE X'5520233030303137393333' TO DFHEIV0(25:11)
 21276     CALL 'kxdfhei1' USING DFHEIV0
 21277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21278
 21279
 21280 5505-START-BROWSE.
 21281     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21282     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21283     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21284
 21285
 21286* EXEC CICS STARTBR
 21287*         DATASET   (FILE-ID-ERPNDB)
 21288*         RIDFLD    (ERPNDB-ALT-KEY)
 21289*    END-EXEC.
 21290     MOVE 0
 21291       TO DFHEIV11
 21292*    MOVE '&,         G          &   #00017943' TO DFHEIV0
 21293     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21295     MOVE X'2020233030303137393433' TO DFHEIV0(25:11)
 21296     CALL 'kxdfhei1' USING DFHEIV0,
 21297           FILE-ID-ERPNDB,
 21298           ERPNDB-ALT-KEY,
 21299           DFHEIV99,
 21300           DFHEIV11,
 21301           DFHEIV99
 21302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21303
 21304
 21305     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21306
 21307
 21308* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 390
* EL6311.cbl
 21309*         DATASET    (FILE-ID-ERPNDB)
 21310*         SET        (ADDRESS OF PENDING-BUSINESS)
 21311*         RIDFLD     (ERPNDB-KEY)
 21312*    END-EXEC.
 21313     MOVE 0
 21314       TO DFHEIV11
 21315*    MOVE '&.S                   )   #00017950' TO DFHEIV0
 21316     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21317     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21318     MOVE X'2020233030303137393530' TO DFHEIV0(25:11)
 21319     CALL 'kxdfhei1' USING DFHEIV0,
 21320           FILE-ID-ERPNDB,
 21321           DFHEIV20,
 21322           DFHEIV99,
 21323           ERPNDB-KEY,
 21324           DFHEIV99,
 21325           DFHEIV11,
 21326           DFHEIV99,
 21327           DFHEIV99
 21328     SET ADDRESS OF PENDING-BUSINESS TO
 21329         DFHEIV20
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21331
 21332
 21333
 21334* EXEC CICS READPREV
 21335*         DATASET    (FILE-ID-ERPNDB)
 21336*         SET        (ADDRESS OF PENDING-BUSINESS)
 21337*         RIDFLD     (ERPNDB-KEY)
 21338*    END-EXEC.
 21339     MOVE 0
 21340       TO DFHEIV11
 21341*    MOVE '&0S                   )   #00017956' TO DFHEIV0
 21342     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21343     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21344     MOVE X'2020233030303137393536' TO DFHEIV0(25:11)
 21345     CALL 'kxdfhei1' USING DFHEIV0,
 21346           FILE-ID-ERPNDB,
 21347           DFHEIV20,
 21348           DFHEIV99,
 21349           ERPNDB-KEY,
 21350           DFHEIV99,
 21351           DFHEIV11,
 21352           DFHEIV99,
 21353           DFHEIV99
 21354     SET ADDRESS OF PENDING-BUSINESS TO
 21355         DFHEIV20
 21356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21357
 21358
 21359
 21360* EXEC CICS READPREV
 21361*         DATASET    (FILE-ID-ERPNDB)
 21362*         SET        (ADDRESS OF PENDING-BUSINESS)
 21363*         RIDFLD     (ERPNDB-KEY)
 21364*    END-EXEC.
 21365     MOVE 0
 21366       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 391
* EL6311.cbl
 21367*    MOVE '&0S                   )   #00017962' TO DFHEIV0
 21368     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21370     MOVE X'2020233030303137393632' TO DFHEIV0(25:11)
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           FILE-ID-ERPNDB,
 21373           DFHEIV20,
 21374           DFHEIV99,
 21375           ERPNDB-KEY,
 21376           DFHEIV99,
 21377           DFHEIV11,
 21378           DFHEIV99,
 21379           DFHEIV99
 21380     SET ADDRESS OF PENDING-BUSINESS TO
 21381         DFHEIV20
 21382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21383
 21384
 21385     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21386        GO TO 5550-END-RECORDS.
 21387
 21388     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21389
 21390     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21391
 21392     IF  WS-BATCH-PREFIX = '#CL'
 21393             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21394
 21395* EXEC CICS ENDBR
 21396*                 DATASET  (FILE-ID-ERPNDB)
 21397*            END-EXEC
 21398     MOVE 0
 21399       TO DFHEIV11
 21400*    MOVE '&2                    $   #00017977' TO DFHEIV0
 21401     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21402     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21403     MOVE X'2020233030303137393737' TO DFHEIV0(25:11)
 21404     CALL 'kxdfhei1' USING DFHEIV0,
 21405           FILE-ID-ERPNDB,
 21406           DFHEIV11,
 21407           DFHEIV99
 21408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21409         GO TO 5505-START-BROWSE.
 21410
 21411     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21412         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21413             NEXT SENTENCE
 21414         ELSE
 21415             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21416
 21417* EXEC CICS ENDBR
 21418*                 DATASET  (FILE-ID-ERPNDB)
 21419*            END-EXEC
 21420     MOVE 0
 21421       TO DFHEIV11
 21422*    MOVE '&2                    $   #00017987' TO DFHEIV0
 21423     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 392
* EL6311.cbl
 21425     MOVE X'2020233030303137393837' TO DFHEIV0(25:11)
 21426     CALL 'kxdfhei1' USING DFHEIV0,
 21427           FILE-ID-ERPNDB,
 21428           DFHEIV11,
 21429           DFHEIV99
 21430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21431             GO TO 5505-START-BROWSE.
 21432
 21433
 21434     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21435         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21436             NEXT SENTENCE
 21437        ELSE
 21438             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21439
 21440* EXEC CICS ENDBR
 21441*                 DATASET  (FILE-ID-ERPNDB)
 21442*            END-EXEC
 21443     MOVE 0
 21444       TO DFHEIV11
 21445*    MOVE '&2                    $   #00017998' TO DFHEIV0
 21446     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21448     MOVE X'2020233030303137393938' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0,
 21450           FILE-ID-ERPNDB,
 21451           DFHEIV11,
 21452           DFHEIV99
 21453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21454             GO TO 5505-START-BROWSE.
 21455
 21456     IF NOT PB-BATCH-TRAILER
 21457        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21458
 21459* EXEC CICS ENDBR
 21460*            DATASET  (FILE-ID-ERPNDB)
 21461*       END-EXEC
 21462     MOVE 0
 21463       TO DFHEIV11
 21464*    MOVE '&2                    $   #00018005' TO DFHEIV0
 21465     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21466     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21467     MOVE X'2020233030303138303035' TO DFHEIV0(25:11)
 21468     CALL 'kxdfhei1' USING DFHEIV0,
 21469           FILE-ID-ERPNDB,
 21470           DFHEIV11,
 21471           DFHEIV99
 21472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21473        GO TO 5505-START-BROWSE.
 21474
 21475     IF PI-CSR-BROWSE
 21476        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21477           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21478
 21479* EXEC CICS ENDBR
 21480*               DATASET  (FILE-ID-ERPNDB)
 21481*          END-EXEC
 21482     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 393
* EL6311.cbl
 21483       TO DFHEIV11
 21484*    MOVE '&2                    $   #00018013' TO DFHEIV0
 21485     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21486     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21487     MOVE X'2020233030303138303133' TO DFHEIV0(25:11)
 21488     CALL 'kxdfhei1' USING DFHEIV0,
 21489           FILE-ID-ERPNDB,
 21490           DFHEIV11,
 21491           DFHEIV99
 21492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21493           GO TO 5505-START-BROWSE.
 21494
 21495     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21496        IF PI-PB-CARRIER    = SPACES AND
 21497           PI-PB-GROUPING   = SPACES AND
 21498           PI-PB-STATE      = SPACES AND
 21499           PI-PB-ACCOUNT    = SPACES
 21500             GO TO 7200-DISPLAY-BATCHES
 21501          ELSE
 21502            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21503               PI-PB-GROUPING   = PB-GROUPING AND
 21504               PI-PB-STATE      = PB-STATE    AND
 21505               PI-PB-ACCOUNT    = PB-ACCOUNT
 21506                 GO TO 7200-DISPLAY-BATCHES.
 21507
 21508     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21509
 21510
 21511* EXEC CICS ENDBR
 21512*         DATASET  (FILE-ID-ERPNDB)
 21513*    END-EXEC.
 21514     MOVE 0
 21515       TO DFHEIV11
 21516*    MOVE '&2                    $   #00018033' TO DFHEIV0
 21517     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21519     MOVE X'2020233030303138303333' TO DFHEIV0(25:11)
 21520     CALL 'kxdfhei1' USING DFHEIV0,
 21521           FILE-ID-ERPNDB,
 21522           DFHEIV11,
 21523           DFHEIV99
 21524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21525
 21526
 21527     GO TO 5505-START-BROWSE.
 21528
 21529 5550-END-RECORDS.
 21530     MOVE ER-2257                TO EMI-ERROR.
 21531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21532     MOVE -1                     TO DPFENTRL.
 21533
 21534     GO TO 8200-SEND-DATAONLY.
 21535
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 394
* EL6311.cbl
 21537
 21538******************************************************************
 21539*                                                                *
 21540*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21541*                                                                *
 21542******************************************************************
 21543
 21544 6000-CREATE-TEMP-STORAGE.
 21545
 21546
 21547* EXEC CICS HANDLE CONDITION
 21548*        QIDERR  (6050-QID-ERROR)
 21549*    END-EXEC.
 21550*    MOVE '"$N                   ! V #00018056' TO DFHEIV0
 21551     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21553     MOVE X'5620233030303138303536' TO DFHEIV0(25:11)
 21554     CALL 'kxdfhei1' USING DFHEIV0
 21555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21556
 21557
 21558
 21559* EXEC CICS WRITEQ TS
 21560*        QUEUE    (QID)
 21561*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21562*        LENGTH   (WS-COMM-LENGTH)
 21563*        ITEM     (W-ONE)
 21564*    END-EXEC.
 21565*    MOVE '*" I                  ''   #00018060' TO DFHEIV0
 21566     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21567     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21568     MOVE X'2020233030303138303630' TO DFHEIV0(25:11)
 21569     CALL 'kxdfhei1' USING DFHEIV0,
 21570           QID,
 21571           PROGRAM-INTERFACE-BLOCK,
 21572           WS-COMM-LENGTH,
 21573           W-ONE,
 21574           DFHEIV99,
 21575           DFHEIV99
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21577
 21578
 21579 6000-EXIT.
 21580      EXIT.
 21581
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 395
* EL6311.cbl
 21583
 21584******************************************************************
 21585*                                                                *
 21586*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21587*                                                                *
 21588******************************************************************
 21589
 21590 6050-RECOVER-TEMP-STORAGE.
 21591     IF PGM-NAME = XCTL-EL6312
 21592        GO TO 6050-EXIT.
 21593
 21594     IF PGM-NAME = XCTL-EL6313
 21595        GO TO 6050-EXIT.
 21596
 21597     IF PGM-NAME = XCTL-EL6315
 21598         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21599     END-IF
 21600
 21601     IF PGM-NAME = XCTL-EL6316
 21602         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21603     END-IF
 21604
 21605
 21606* EXEC CICS HANDLE CONDITION
 21607*        QIDERR  (6050-QID-ERROR)
 21608*    END-EXEC.
 21609*    MOVE '"$N                   ! W #00018093' TO DFHEIV0
 21610     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21612     MOVE X'5720233030303138303933' TO DFHEIV0(25:11)
 21613     CALL 'kxdfhei1' USING DFHEIV0
 21614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21615
 21616
 21617
 21618* EXEC CICS READQ TS
 21619*         QUEUE   (QID)
 21620*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21621*         LENGTH  (WS-COMM-LENGTH)
 21622*         ITEM    (W-ONE)
 21623*     END-EXEC.
 21624*    MOVE '*$II   L              ''   #00018097' TO DFHEIV0
 21625     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21626     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21627     MOVE X'2020233030303138303937' TO DFHEIV0(25:11)
 21628     CALL 'kxdfhei1' USING DFHEIV0,
 21629           QID,
 21630           PROGRAM-INTERFACE-BLOCK,
 21631           WS-COMM-LENGTH,
 21632           W-ONE,
 21633           DFHEIV99,
 21634           DFHEIV99
 21635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21636
 21637
 21638 6050-DELETE-TEMP-STORAGE.
 21639
 21640
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 396
* EL6311.cbl
 21641* EXEC CICS DELETEQ TS
 21642*        QUEUE   (QID)
 21643*    END-EXEC.
 21644*    MOVE '*&                    #   #00018106' TO DFHEIV0
 21645     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21646     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21647     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 21648     CALL 'kxdfhei1' USING DFHEIV0,
 21649           QID,
 21650           DFHEIV99
 21651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21652
 21653
 21654     GO TO 6050-EXIT.
 21655
 21656 6050-QID-ERROR.
 21657     MOVE ER-0033                TO EMI-ERROR
 21658     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21659
 21660 6050-EXIT.
 21661      EXIT.
 21662
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 397
* EL6311.cbl
 21664
 21665******************************************************************
 21666*                                                                *
 21667*            T E R M   C O N V E R S I O N                       *
 21668*                                                                *
 21669******************************************************************
 21670
 21671 6100-TERM-CONVERSION.
 21672
 21673     IF PI-BPMTS = ZERO
 21674         GO TO 6199-EXIT.
 21675
 21676     IF PI-BMODE = ' ' OR 'M'
 21677         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21678         GO TO 6105-ROUND-TERM.
 21679
 21680     IF PI-BMODE = 'S'
 21681         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21682         GO TO 6105-ROUND-TERM.
 21683
 21684     IF PI-BMODE = 'W'
 21685         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21686         GO TO 6105-ROUND-TERM.
 21687
 21688     IF PI-BMODE = 'B'
 21689         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21690         GO TO 6105-ROUND-TERM.
 21691
 21692     IF PI-BMODE = 'T'
 21693         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21694
 21695 6105-ROUND-TERM.
 21696
 21697     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21698         ADD +1                  TO WS-CALC-TERM-WHOLE
 21699         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21700
 21701     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21702         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21703
 21704     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21705         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21706                                      WS-BTERM    (WS-SUB1)
 21707         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21708
 21709     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21710         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21711             MOVE -1               TO BMODEL
 21712             MOVE ER-2593          TO EMI-ERROR
 21713             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21715
 21716 6124-CHECK-BENEFIT.
 21717
 21718     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21719        GO TO 6126-COMPUTE-BENEFIT.
 21720
 21721     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 398
* EL6311.cbl
 21722
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 399
* EL6311.cbl
 21724******************************************************************
 21725**         COMPUTE TERM AND BENEFIT
 21726******************************************************************
 21727 6125-COMPUTE-TERM-BENEFIT.
 21728
 21729     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21730        PI-BPMTAMT = ZERO
 21731         GO TO 6199-EXIT.
 21732
 21733     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21734                                     WS-BTERM  (WS-SUB1).
 21735     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21736
 21737 6126-COMPUTE-BENEFIT.
 21738
 21739     IF PI-BMODE = 'M' OR  ' '
 21740         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21741
 21742     IF PI-BMODE = 'W'
 21743         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21744
 21745     IF PI-BMODE = 'S'
 21746         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21747
 21748     IF PI-BMODE = 'B'
 21749         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21750
 21751     IF PI-BMODE = 'T'
 21752         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21753
 21754     IF WS-SUB1 = +1
 21755        COMPUTE WS-BBEN (WS-SUB1) =
 21756                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21757
 21758     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21759     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21760     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21761
 21762 6199-EXIT.
 21763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 400
* EL6311.cbl
 21765
 21766******************************************************************
 21767*                                                                *
 21768*             D I S P L A Y   I S S U E S                        *
 21769*                                                                *
 21770******************************************************************
 21771
 21772 6200-CREATE-VADS.
 21773     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21774     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21775     MOVE SPACES                 TO WS-PASS-VADS-REC
 21776
 21777* EXEC CICS GETMAIN
 21778*       SET      (ADDRESS OF PENDING-BUSINESS)
 21779*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21780*       INITIMG  (GETMAIN-SPACE)
 21781*       RESP     (WS-RESPONSE)
 21782*    END-EXEC
 21783*    MOVE ',"IL                  $  N#00018232' TO DFHEIV0
 21784     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21786     MOVE X'204E233030303138323332' TO DFHEIV0(25:11)
 21787     CALL 'kxdfhei1' USING DFHEIV0,
 21788           DFHEIV20,
 21789           ERPNDB-RECORD-LENGTH,
 21790           GETMAIN-SPACE
 21791     SET ADDRESS OF PENDING-BUSINESS TO
 21792         DFHEIV20
 21793     MOVE EIBRESP  TO WS-RESPONSE
 21794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21795
 21796* EXEC CICS READ
 21797*       INTO    (PENDING-BUSINESS)
 21798*       DATASET (FILE-ID-ERPNDB)
 21799*       RIDFLD  (ERPNDB-KEY)
 21800*       RESP    (WS-RESPONSE)
 21801*    END-EXEC
 21802     MOVE LENGTH OF
 21803      PENDING-BUSINESS
 21804       TO DFHEIV11
 21805*    MOVE '&"IL       E          (  N#00018238' TO DFHEIV0
 21806     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21808     MOVE X'204E233030303138323338' TO DFHEIV0(25:11)
 21809     CALL 'kxdfhei1' USING DFHEIV0,
 21810           FILE-ID-ERPNDB,
 21811           PENDING-BUSINESS,
 21812           DFHEIV11,
 21813           ERPNDB-KEY,
 21814           DFHEIV99,
 21815           DFHEIV99,
 21816           DFHEIV99
 21817     MOVE EIBRESP  TO WS-RESPONSE
 21818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21819     IF RESP-NORMAL
 21820        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21821        IF (RESP-NORMAL)
 21822           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 401
* EL6311.cbl
 21823              AM-CONTROL-PRIMARY (1:20))
 21824           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21825        ELSE
 21826           MOVE 'ACCOUNT NOT FOUND'
 21827                                 TO VD-ACCOUNT-NAME
 21828        END-IF
 21829        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21830                                    TO M1
 21831        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21832        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21833           (A2 > M1)
 21834           OR (WS-WORK-FIELD (A2:1) = '*')
 21835           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21836           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21837        END-PERFORM
 21838        IF A2 > M1
 21839           CONTINUE
 21840        ELSE
 21841           MOVE WS-WORK-FIELD (1:A2 - 1)
 21842                                    TO VD-ACCOUNT-NAME
 21843        END-IF
 21844        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21845        MOVE PB-CARRIER          TO VD-CARRIER
 21846        MOVE PB-GROUPING         TO VD-GROUPING
 21847        MOVE PB-STATE            TO VD-STATE
 21848        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21849        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21850        MOVE PB-CERT-NO          TO VD-CERT-NO
 21851        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21852        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21853        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21854        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21855        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21856        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21857        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21858        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21859        MOVE PB-CSR-ID           TO VD-CSR-ID
 21860        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21861        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21862        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21863        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21864        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21865        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21866        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21867        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21868        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21869        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21870        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21871        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21872        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21873     END-IF
 21874     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21875
 21876
 21877* EXEC CICS GETMAIN
 21878*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21879*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21880*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 402
* EL6311.cbl
 21881*       RESP     (WS-RESPONSE)
 21882*    END-EXEC
 21883*    MOVE ',"IL                  $  N#00018301' TO DFHEIV0
 21884     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21885     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21886     MOVE X'204E233030303138333031' TO DFHEIV0(25:11)
 21887     CALL 'kxdfhei1' USING DFHEIV0,
 21888           DFHEIV20,
 21889           ERPNDM-RECORD-LENGTH,
 21890           GETMAIN-SPACE
 21891     SET ADDRESS OF PENDING-MAILING-DATA TO
 21892         DFHEIV20
 21893     MOVE EIBRESP  TO WS-RESPONSE
 21894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21895
 21896
 21897* EXEC CICS READ
 21898*       INTO    (PENDING-MAILING-DATA)
 21899*       DATASET (FILE-ID-ERPNDM)
 21900*       RIDFLD  (ERPNDM-KEY)
 21901*       RESP    (WS-RESPONSE)
 21902*    END-EXEC
 21903     MOVE LENGTH OF
 21904      PENDING-MAILING-DATA
 21905       TO DFHEIV11
 21906*    MOVE '&"IL       E          (  N#00018308' TO DFHEIV0
 21907     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21909     MOVE X'204E233030303138333038' TO DFHEIV0(25:11)
 21910     CALL 'kxdfhei1' USING DFHEIV0,
 21911           FILE-ID-ERPNDM,
 21912           PENDING-MAILING-DATA,
 21913           DFHEIV11,
 21914           ERPNDM-KEY,
 21915           DFHEIV99,
 21916           DFHEIV99,
 21917           DFHEIV99
 21918     MOVE EIBRESP  TO WS-RESPONSE
 21919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21920
 21921     IF RESP-NORMAL
 21922        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21923        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21924        MOVE PM-CITY              TO VD-INSURED-CITY
 21925        MOVE PM-STATE             TO VD-INSURED-STATE
 21926        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21927     END-IF
 21928
 21929     MOVE 'VAC1'                  TO VD-LETTER-ID
 21930     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21931     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21932     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21933     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21934     MOVE +0                      TO VD-ARCHIVE-NO
 21935     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21936     .
 21937 6200-EXIT.
 21938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 403
* EL6311.cbl
 21939 6210-READ-ERACCT.
 21940     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21941     MOVE LOW-VALUES             TO ERACCT-FILL
 21942
 21943* EXEC CICS READ
 21944*         DATASET   ('ERACCT')
 21945*         INTO      (ACCOUNT-MASTER)
 21946*         RIDFLD    (ERACCT-KEY)
 21947*         GTEQ
 21948*         RESP      (WS-RESPONSE)
 21949*    END-EXEC
 21950     MOVE LENGTH OF
 21951      ACCOUNT-MASTER
 21952       TO DFHEIV11
 21953     MOVE 'ERACCT' TO DFHEIV1
 21954*    MOVE '&"IL       G          (  N#00018336' TO DFHEIV0
 21955     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21957     MOVE X'204E233030303138333336' TO DFHEIV0(25:11)
 21958     CALL 'kxdfhei1' USING DFHEIV0,
 21959           DFHEIV1,
 21960           ACCOUNT-MASTER,
 21961           DFHEIV11,
 21962           ERACCT-KEY,
 21963           DFHEIV99,
 21964           DFHEIV99,
 21965           DFHEIV99
 21966     MOVE EIBRESP  TO WS-RESPONSE
 21967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21968     .
 21969 6210-EXIT.
 21970     EXIT.
 21971
 21972 6220-READ-ERMAIL.
 21973
 21974     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21975     MOVE ' '                    TO WS-ERMAIL-SW
 21976
 21977
 21978* EXEC CICS READ
 21979*       DATASET   (FILE-ID-ERMAIL)
 21980*       SET       (ADDRESS OF MAILING-DATA)
 21981*       RIDFLD    (ERMAIL-KEY)
 21982*       RESP      (WS-RESPONSE)
 21983*    END-EXEC
 21984*    MOVE '&"S        E          (  N#00018352' TO DFHEIV0
 21985     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21986     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21987     MOVE X'204E233030303138333532' TO DFHEIV0(25:11)
 21988     CALL 'kxdfhei1' USING DFHEIV0,
 21989           FILE-ID-ERMAIL,
 21990           DFHEIV20,
 21991           DFHEIV99,
 21992           ERMAIL-KEY,
 21993           DFHEIV99,
 21994           DFHEIV99,
 21995           DFHEIV99
 21996     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 404
* EL6311.cbl
 21997         DFHEIV20
 21998     MOVE EIBRESP  TO WS-RESPONSE
 21999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22000
 22001     IF RESP-NORMAL
 22002        SET ERMAIL-FOUND TO TRUE
 22003     END-IF
 22004     .
 22005 6220-EXIT.
 22006     EXIT.
 22007
 22008 6400-CHECK-FOR-RES-REF-CLAIM.
 22009     display 'made it to 6400- for ' pi-cert-no
 22010     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22011
 22012     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22013                                    W-CL-COMP-CD.
 22014     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22015                                    W-CL-CERT-NO.
 22016     MOVE SPACES                 TO MSTR-CERT-SFX.
 22017
 22018
 22019* EXEC CICS HANDLE CONDITION
 22020*        NOTFND  (6400-CONTINUE)
 22021*        ENDFILE (6400-CONTINUE)
 22022*    END-EXEC.
 22023*    MOVE '"$I''                  ! X #00018376' TO DFHEIV0
 22024     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22026     MOVE X'5820233030303138333736' TO DFHEIV0(25:11)
 22027     CALL 'kxdfhei1' USING DFHEIV0
 22028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22029
 22030
 22031
 22032* EXEC CICS IGNORE CONDITION
 22033*        DUPKEY
 22034*    END-EXEC.
 22035*    MOVE '"*$                   !   #00018381' TO DFHEIV0
 22036     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22038     MOVE X'2020233030303138333831' TO DFHEIV0(25:11)
 22039     CALL 'kxdfhei1' USING DFHEIV0
 22040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22041
 22042
 22043
 22044* EXEC CICS STARTBR
 22045*        DATASET   (CLMS-ID)
 22046*        RIDFLD    (ELMSTR-KEY)
 22047*        GENERIC   EQUAL
 22048*        KEYLENGTH (ELMSTR-LENGTH)
 22049*    END-EXEC.
 22050     MOVE 0
 22051       TO DFHEIV11
 22052*    MOVE '&,   KG    E          &   #00018385' TO DFHEIV0
 22053     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 405
* EL6311.cbl
 22055     MOVE X'2020233030303138333835' TO DFHEIV0(25:11)
 22056     CALL 'kxdfhei1' USING DFHEIV0,
 22057           CLMS-ID,
 22058           ELMSTR-KEY,
 22059           ELMSTR-LENGTH,
 22060           DFHEIV11,
 22061           DFHEIV99
 22062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22063
 22064
 22065     display 'browse started'
 22066     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22067
 22068 6400-NEXT-CLAIM.
 22069
 22070
 22071* EXEC CICS READNEXT
 22072*        DATASET   (CLMS-ID)
 22073*        RIDFLD    (ELMSTR-KEY)
 22074*        SET       (ADDRESS OF CLAIM-MASTER)
 22075*    END-EXEC.
 22076     MOVE 0
 22077       TO DFHEIV11
 22078*    MOVE '&.S                   )   #00018397' TO DFHEIV0
 22079     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22081     MOVE X'2020233030303138333937' TO DFHEIV0(25:11)
 22082     CALL 'kxdfhei1' USING DFHEIV0,
 22083           CLMS-ID,
 22084           DFHEIV20,
 22085           DFHEIV99,
 22086           ELMSTR-KEY,
 22087           DFHEIV99,
 22088           DFHEIV11,
 22089           DFHEIV99,
 22090           DFHEIV99
 22091     SET ADDRESS OF CLAIM-MASTER TO
 22092         DFHEIV20
 22093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22094
 22095
 22096     display 'read claim for ' mstr-cert-no
 22097     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22098        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22099         GO TO 6400-CONTINUE
 22100     END-IF.
 22101
 22102     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22103        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22104        PI-STATE       NOT = CL-CERT-STATE     OR
 22105        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22106        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22107         GO TO 6400-NEXT-CLAIM
 22108     END-IF.
 22109
 22110     display 'found claim ' cl-claim-no
 22111        ' with denial type ' cl-denial-type
 22112     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 406
* EL6311.cbl
 22113         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22114         GO TO 6400-CONTINUE
 22115     END-IF.
 22116
 22117     GO TO 6400-NEXT-CLAIM.
 22118
 22119 6400-CONTINUE.
 22120
 22121     IF WS-BROWSE-STARTED-SW = 'Y'
 22122
 22123* EXEC CICS ENDBR
 22124*            DATASET   (CLMS-ID)
 22125*        END-EXEC
 22126     MOVE 0
 22127       TO DFHEIV11
 22128*    MOVE '&2                    $   #00018429' TO DFHEIV0
 22129     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22130     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22131     MOVE X'2020233030303138343239' TO DFHEIV0(25:11)
 22132     CALL 'kxdfhei1' USING DFHEIV0,
 22133           CLMS-ID,
 22134           DFHEIV11,
 22135           DFHEIV99
 22136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22137         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22138     END-IF.
 22139
 22140 6400-EXIT.
 22141     EXIT.
 22142
 22143 7000-DISPLAY-ISSUES.
 22144
 22145     IF PI-DISPLAY-ORIGINAL-BATCH
 22146        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22147        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22148     ELSE
 22149        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22150
 22151     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22152
 22153     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22154     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22155
 22156     MOVE LOW-VALUES                 TO EL631BI.
 22157     MOVE ZEROS                      TO PI-BPMTAMT
 22158                                        PI-BPMTS.
 22159     MOVE SPACE                      TO PI-BMODE
 22160                                        PI-BTYPE (1)
 22161                                        PI-BTYPE (2).
 22162     MOVE EL631B                     TO PI-MAP-NAME.
 22163     MOVE 'Y'                        TO PI-BROWSE-SW.
 22164     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22165                                        PI-HIGH-SEQ-NO.
 22166
 22167     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22168        MOVE AL-SABOF                TO BCHGTA
 22169        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22170        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 407
* EL6311.cbl
 22171     ELSE
 22172        MOVE AL-SADOF                TO BCHGTA
 22173                                        BCHGA
 22174        MOVE PB-CHG-COUNT            TO BCHGO.
 22175
 22176     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22177     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22178     MOVE WS-HR-MINS                 TO BMANTATO.
 22179
 22180     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22181        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22182        MOVE SPACE                   TO DC-OPTION-CODE
 22183        PERFORM 9700-DATE-LINK
 22184        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22185        MOVE 'INACTIVE'              TO BMOENDTO
 22186     ELSE
 22187        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22188        MOVE SPACE                   TO DC-OPTION-CODE
 22189        PERFORM 9700-DATE-LINK
 22190        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22191        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22192        MOVE SPACE                   TO DC-OPTION-CODE
 22193        PERFORM 9700-DATE-LINK
 22194        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22195
 22196*    MOVE PB-I-REFERENCE             TO BREFO.
 22197
 22198*    IF PI-COMPANY-ID EQUAL 'HER'
 22199*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22200*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22201*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22202*                MOVE WS-MEMBER-NO-1-8
 22203*                                TO  BMICRNOO.
 22204
 22205*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22206*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22207*            MOVE PB-I-MICROFILM-NO
 22208*                                TO  BMICRNOO.
 22209     IF PB-I-VIN NOT = SPACES
 22210        MOVE PB-I-VIN            TO BVINO
 22211     END-IF
 22212
 22213     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22214     MOVE PB-CERT-SFX                TO BSUFIXO.
 22215     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22216     MOVE SPACE                      TO DC-OPTION-CODE.
 22217     PERFORM 9700-DATE-LINK.
 22218     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22219
 22220     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22221     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22222     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22223     MOVE PB-I-INSURED-SEX           TO BSEXO
 22224
 22225     IF PB-I-AGE NOT = ZEROS
 22226         MOVE PB-I-AGE               TO BAGEO.
 22227
 22228     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 408
* EL6311.cbl
 22229                                 TO ELCERT-KEY
 22230     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22231     IF NOT CERT-TRL-REC-NOT-FOUND
 22232         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22233             MOVE 'AGE*'             TO BAGEDEFO
 22234         ELSE
 22235             MOVE 'AGE '             TO BAGEDEFO
 22236         END-IF
 22237     ELSE
 22238         MOVE 'AGE '             TO BAGEDEFO
 22239     END-IF
 22240
 22241     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22242         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22243         MOVE SPACE                  TO DC-OPTION-CODE
 22244         PERFORM 9700-DATE-LINK
 22245         IF NO-CONVERSION-ERROR
 22246            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22247
 22248     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22249         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22250         MOVE SPACE                  TO DC-OPTION-CODE
 22251         PERFORM 9700-DATE-LINK
 22252         IF NO-CONVERSION-ERROR
 22253            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22254
 22255     IF PB-I-EXTENTION-DAYS NUMERIC
 22256        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22257           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22258        ELSE
 22259           IF PB-I-TERM-IN-DAYS NUMERIC
 22260              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22261                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22262
 22263     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22264        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22265
 22266     MOVE PB-FORCE-CODE              TO BFORCEO.
 22267     MOVE PB-I-TERM-TYPE             TO BMODEO
 22268                                        PI-BMODE.
 22269
 22270     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22271        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22272
 22273     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22274         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22275                                        PI-BPMTS.
 22276
 22277     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22278         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22279           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22280                                        PI-BPMTAMT.
 22281
 22282     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22283     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22284     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22285     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22286     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 409
* EL6311.cbl
 22287     MOVE PB-I-SIG-SW                TO BSIGO.
 22288     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22289     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22290     MOVE PB-RECORD-BILL             TO BBILCDO.
 22291     MOVE PB-FORCE-CODE              TO BFORCEO.
 22292
 22293     IF (PB-I-LIVES NUMERIC)
 22294        AND (PB-I-LIVES > ZEROS)
 22295        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22296        IF (RESP-NORMAL)
 22297           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22298           CONTINUE
 22299        ELSE
 22300           MOVE PB-I-LIVES       TO BLIVESO
 22301        END-IF
 22302     END-IF
 22303
 22304     IF PB-I-NUM-BILLED NUMERIC AND
 22305        PB-I-NUM-BILLED GREATER THAN ZEROS
 22306        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22307*    ELSE
 22308*       MOVE ZEROS                   TO BBILLEDO.
 22309
 22310     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22311
 22312     IF PB-I-LOAN-APR NOT = +99.9999
 22313        MOVE PB-I-LOAN-APR           TO BAPRO.
 22314
 22315     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22316        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22317
 22318     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22319        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22320           MOVE AL-SANOF                TO BORIGHDA
 22321           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22322           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22323
 22324     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22325
 22326     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22327        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22328
 22329     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22330        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22331                                        PI-BTYPE (1).
 22332
 22333     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22334        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22335
 22336     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22337        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22338
 22339     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22340        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22341
 22342     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22343        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22344
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 410
* EL6311.cbl
 22345     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22346        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22347
 22348     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22349         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22350         MOVE SPACE                  TO DC-OPTION-CODE
 22351         PERFORM 9700-DATE-LINK
 22352         IF NO-CONVERSION-ERROR
 22353            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22354
 22355     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22356        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22357        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22358        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22359        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22360                 GIVING BDIFFO (1)
 22361     ELSE
 22362        MOVE SPACES                  TO BBEN-CD     (1)
 22363                                        BBEN-ABBR   (1).
 22364
 22365     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22366        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22367        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22368                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22369
 22370     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22371       IF PB-RECORD-ON-HOLD
 22372          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22373
 22374     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22375       IF PB-RECORD-RETURNED
 22376          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22377
 22378     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22379        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22380             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22381
 22382     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22383
 22384     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22385        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22386
 22387     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22388        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22389                                        PI-BTYPE (2).
 22390
 22391     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22392        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22393
 22394     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22395        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22396
 22397     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22398        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22399
 22400     IF PB-I-TOT-FEES NOT NUMERIC
 22401        MOVE ZEROS               TO PB-I-TOT-FEES
 22402     END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 411
* EL6311.cbl
 22403     IF PB-I-TOT-FEES > ZEROS
 22404        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22405
 22406     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22407         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22408         MOVE SPACE                  TO DC-OPTION-CODE
 22409         PERFORM 9700-DATE-LINK
 22410         IF NO-CONVERSION-ERROR
 22411            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22412
 22413     IF PB-I-TOT-FEES > ZEROS
 22414        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22415        SUBTRACT PB-I-TOT-FEES FROM
 22416                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22417
 22418     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22419        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22420        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22421        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22422        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22423                 GIVING BDIFFO (2)
 22424     ELSE
 22425        MOVE SPACES                  TO BBEN-CD     (2)
 22426                                        BBEN-ABBR   (2).
 22427
 22428     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22429       IF PB-RECORD-ON-HOLD
 22430          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22431
 22432     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22433       IF PB-RECORD-RETURNED
 22434          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22435
 22436     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22437        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22438             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22439
 22440     MOVE PB-CSR-ID                  TO BCSRO.
 22441
 22442     IF PI-COMPANY-ID  =  'DMD'
 22443        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22444            NEXT SENTENCE
 22445        ELSE
 22446            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22447               MOVE 'NEW CERT'       TO BNCERTLI
 22448               MOVE EC-NEW-CERT      TO BNCERTO.
 22449
 22450     IF PI-COMPANY-ID  =  'DMD'
 22451        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22452            NEXT SENTENCE
 22453        ELSE
 22454           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22455               MOVE 'NEW STATE'      TO BNSTATLI
 22456               MOVE EC-NEW-STATE     TO BNSTATO.
 22457
 22458 7000-CONTINUE.
 22459     MOVE 'C'                        TO BMAINTI.
 22460     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 412
* EL6311.cbl
 22461
 22462     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22463        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22464
 22465     IF PI-6315-FINALIZED = 'Y'   AND
 22466        PB-UNFORCED-ERRORS
 22467          MOVE -1                TO BFORCEL
 22468          MOVE  1                TO SET-CURSOR-SW
 22469     END-IF
 22470
 22471     IF NO-CURSOR-SET
 22472        MOVE -1                      TO BMAINTL.
 22473
 22474     GO TO 8100-SEND-INITIAL-MAP.
 22475
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 413
* EL6311.cbl
 22477
 22478******************************************************************
 22479*                                                                *
 22480*             D I S P L A Y   C A N C E L S                      *
 22481*                                                                *
 22482******************************************************************
 22483
 22484 7100-DISPLAY-CANCELS.
 22485     IF PI-DISPLAY-ORIGINAL-BATCH
 22486        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22487        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22488     ELSE
 22489        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22490
 22491     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22492
 22493     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22494     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22495
 22496     MOVE LOW-VALUES                 TO EL631CI.
 22497     MOVE EL631C                     TO PI-MAP-NAME.
 22498     MOVE 'Y'                        TO PI-BROWSE-SW.
 22499     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22500                                        PI-HIGH-SEQ-NO.
 22501
 22502     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22503        MOVE AL-SABOF                TO CCHGTA
 22504        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22505        MOVE AL-SANON                TO CCHGA
 22506      ELSE
 22507        MOVE AL-SADOF                TO CCHGTA
 22508                                        CCHGA
 22509        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22510
 22511*    MOVE PB-C-REFERENCE             TO CREFO.
 22512
 22513*    IF PB-C-MICROFILM-NO IS NUMERIC
 22514*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22515*          MOVE PB-C-MICROFILM-NO
 22516*                                TO CMICRNOO
 22517*          MOVE AL-UNNON         TO CMICRNOA
 22518*       END-IF
 22519*    END-IF
 22520     IF PB-C-NH-INT-ON-REFS NUMERIC
 22521        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22522           MOVE PB-C-NH-INT-ON-REFS
 22523                                 TO CNHINTO
 22524           MOVE AL-SANOF         TO CNHINTA
 22525        END-IF
 22526     END-IF
 22527     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22528     MOVE PB-CERT-SFX                TO CSUFIXO.
 22529     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22530     MOVE SPACE                      TO DC-OPTION-CODE.
 22531     PERFORM 9700-DATE-LINK.
 22532     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22533
 22534     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 414
* EL6311.cbl
 22535        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22536        MOVE SPACE                   TO DC-OPTION-CODE
 22537        PERFORM 9700-DATE-LINK
 22538        IF NO-CONVERSION-ERROR
 22539           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22540
 22541     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22542        NEXT SENTENCE
 22543     ELSE
 22544        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22545
 22546     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22547        NEXT SENTENCE
 22548     ELSE
 22549        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22550
 22551     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22552        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22553        MOVE SPACE                   TO DC-OPTION-CODE
 22554        PERFORM 9700-DATE-LINK
 22555        IF NO-CONVERSION-ERROR
 22556           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22557
 22558     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22559         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22560
 22561     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22562         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22563
 22564     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22565        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22566        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22567                 GIVING CDRFND1O.
 22568
 22569     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22570        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22571        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22572                 GIVING CDRFND2O.
 22573
 22574     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22575       IF PB-RECORD-ON-HOLD
 22576          MOVE 'ON HOLD'             TO CBILIT1O.
 22577
 22578     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22579       IF PB-RECORD-RETURNED
 22580          MOVE 'RETURNED'            TO CBILIT1O.
 22581
 22582     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22583        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22584             MOVE 'OVERRIDE'         TO CBILIT1O.
 22585
 22586     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22587       IF PB-RECORD-ON-HOLD
 22588          MOVE 'ON HOLD'             TO CBILIT2O.
 22589
 22590     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22591       IF PB-RECORD-RETURNED
 22592          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 415
* EL6311.cbl
 22593
 22594     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22595        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22596             MOVE 'OVERRIDE'         TO CBILIT2O.
 22597
 22598     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22599     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22600     IF PB-C-POST-CARD-IND = 'Y'
 22601        MOVE 'Y'                     TO CPCYNO
 22602     ELSE
 22603        MOVE 'N'                     TO CPCYNO
 22604     END-IF
 22605     MOVE PB-FORCE-CODE              TO CFORCEO.
 22606     MOVE PB-RECORD-BILL             TO CBILCDO.
 22607     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22608     MOVE SPACES                     TO CINITSO.
 22609     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22610         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22611     ELSE
 22612         MOVE PB-CI-INITIALS         TO CINITSO
 22613     END-IF.
 22614
 22615     IF PB-CI-CANCEL-FEE NUMERIC
 22616        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22617        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22618     ELSE
 22619        MOVE ZEROES                  TO W-CANCEL-FEE.
 22620
 22621     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22622
 22623     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22624        ADD PB-CI-LF-PREMIUM-AMT
 22625             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22626
 22627     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22628        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22629
 22630     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22631     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22632     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22633     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22634
 22635     IF PB-C-LIVES NUMERIC
 22636        MOVE PB-C-LIVES              TO CLIVESO.
 22637
 22638     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22639        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22640
 22641     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22642        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22643        MOVE SPACE                   TO DC-OPTION-CODE
 22644        PERFORM 9700-DATE-LINK
 22645        IF NO-CONVERSION-ERROR
 22646           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22647
 22648     IF  PB-C-REFUND-CREATED
 22649         MOVE 'YES'                  TO CRFNDSWO
 22650     ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 416
* EL6311.cbl
 22651         IF PB-C-REFUND-REQUESTED
 22652            MOVE 'REQ'               TO CRFNDSWO
 22653         ELSE
 22654            MOVE 'NO'                TO CRFNDSWO.
 22655
 22656     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22657     MOVE SPACE                      TO DC-OPTION-CODE.
 22658     PERFORM 9700-DATE-LINK.
 22659     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22660     MOVE PB-INPUT-BY                TO CENTBYO.
 22661
 22662     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22663        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22664        MOVE SPACE                   TO DC-OPTION-CODE
 22665        PERFORM 9700-DATE-LINK
 22666        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22667        MOVE 'INACTIVE'              TO CMOENDTO
 22668     ELSE
 22669        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22670        MOVE SPACE                   TO DC-OPTION-CODE
 22671        PERFORM 9700-DATE-LINK
 22672        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22673        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22674        MOVE SPACE                   TO DC-OPTION-CODE
 22675        PERFORM 9700-DATE-LINK
 22676        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22677
 22678     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22679
 22680     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22681     MOVE WS-HR-MINS                 TO CMANTATO.
 22682
 22683     EVALUATE PB-LF-REFUND-TYPE
 22684        WHEN '1'
 22685           MOVE 'RULE78'            TO CLFREFNO
 22686        WHEN '2'
 22687           MOVE 'PRORAT'            TO CLFREFNO
 22688        WHEN '3'
 22689           MOVE 'CALIF'             TO CLFREFNO
 22690        WHEN '4'
 22691           MOVE 'IRREG'             TO CLFREFNO
 22692        WHEN '5'
 22693           MOVE 'NETPAY'            TO CLFREFNO
 22694        WHEN '6'
 22695           MOVE 'ATCP'              TO CLFREFNO
 22696        WHEN '7'
 22697           MOVE 'UTAH'              TO CLFREFNO
 22698        WHEN '8'
 22699           MOVE 'MEAN'              TO CLFREFNO
 22700        WHEN '9'
 22701           MOVE 'SUM '              TO CLFREFNO
 22702        WHEN 'B'
 22703           MOVE 'BALN'              TO CLFREFNO
 22704     END-EVALUATE.
 22705
 22706     EVALUATE TRUE
 22707        WHEN PB-AH-REFUND-TYPE =  '1'
 22708           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 417
* EL6311.cbl
 22709        WHEN PB-AH-REFUND-TYPE =  '2'
 22710           MOVE 'PRORAT'            TO CAHREFNO
 22711        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22712           MOVE 'CALIF'             TO CAHREFNO
 22713        WHEN PB-AH-REFUND-TYPE =  '4'
 22714           MOVE 'IRREG'             TO CAHREFNO
 22715        WHEN PB-AH-REFUND-TYPE =  '5'
 22716           MOVE 'NETPAY'            TO CAHREFNO
 22717        WHEN PB-AH-REFUND-TYPE =  '6'
 22718           MOVE 'ATCP'              TO CAHREFNO
 22719        WHEN PB-AH-REFUND-TYPE =  '7'
 22720           MOVE 'UTAH'              TO CAHREFNO
 22721        WHEN PB-AH-REFUND-TYPE =  '8'
 22722           MOVE 'MEAN'              TO CAHREFNO
 22723        WHEN PB-AH-REFUND-TYPE =  '9'
 22724           MOVE 'SUM '              TO CAHREFNO
 22725        WHEN PB-AH-REFUND-TYPE =  'B'
 22726           MOVE 'BALN'              TO CAHREFNO
 22727     END-EVALUATE.
 22728
 22729     MOVE PB-REIN-CD                 TO CREINCDO.
 22730
 22731     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22732        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22733        MOVE SPACE                   TO DC-OPTION-CODE
 22734        PERFORM 9700-DATE-LINK
 22735        IF NO-CONVERSION-ERROR
 22736           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22737
 22738     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22739        MOVE 999999                  TO WS-EXP-DT-EDIT
 22740        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22741        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22742     ELSE
 22743        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22744           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22745           MOVE SPACE                   TO DC-OPTION-CODE
 22746           PERFORM 9700-DATE-LINK
 22747           IF NO-CONVERSION-ERROR
 22748              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22749
 22750     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22751        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22752           MOVE AL-SANOF                TO CORIGHDA
 22753           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22754           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22755
 22756     MOVE PB-CSR-ID              TO CCSRO.
 22757
 22758     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22759     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22760
 22761     MOVE 'C'                    TO CMAINTI.
 22762     MOVE AL-UANON               TO CMAINTA.
 22763
 22764     IF PI-6316-FINALIZED = 'Y'  AND
 22765        PB-UNFORCED-ERRORS
 22766          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 418
* EL6311.cbl
 22767          MOVE  1                TO SET-CURSOR-SW
 22768     END-IF
 22769
 22770     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22771        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22772
 22773     IF NO-CURSOR-SET
 22774        MOVE -1                  TO CMAINTL.
 22775
 22776     GO TO 8100-SEND-INITIAL-MAP.
 22777
 22778
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 419
* EL6311.cbl
 22780***************************************************************
 22781*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22782*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22783***************************************************************
 22784
 22785 7200-DISPLAY-BATCHES.
 22786     MOVE EL631D                 TO PI-MAP-NAME.
 22787     MOVE LOW-VALUES             TO EL631DI.
 22788
 22789     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22790
 22791
 22792* EXEC CICS HANDLE CONDITION
 22793*         NOTFND   (3690-NOT-FOUND)
 22794*    END-EXEC.
 22795*    MOVE '"$I                   ! Y #00019086' TO DFHEIV0
 22796     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22798     MOVE X'5920233030303139303836' TO DFHEIV0(25:11)
 22799     CALL 'kxdfhei1' USING DFHEIV0
 22800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22801
 22802
 22803     IF PI-DISPLAY-SCREEN
 22804        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22805     ELSE
 22806        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22807
 22808     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22809     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22810
 22811
 22812* EXEC CICS READ
 22813*         DATASET   (FILE-ID-ERPNDB)
 22814*         RIDFLD    (ERPNDB-KEY)
 22815*         SET       (ADDRESS OF PENDING-BUSINESS)
 22816*    END-EXEC.
 22817*    MOVE '&"S        E          (   #00019098' TO DFHEIV0
 22818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22820     MOVE X'2020233030303139303938' TO DFHEIV0(25:11)
 22821     CALL 'kxdfhei1' USING DFHEIV0,
 22822           FILE-ID-ERPNDB,
 22823           DFHEIV20,
 22824           DFHEIV99,
 22825           ERPNDB-KEY,
 22826           DFHEIV99,
 22827           DFHEIV99,
 22828           DFHEIV99
 22829     SET ADDRESS OF PENDING-BUSINESS TO
 22830         DFHEIV20
 22831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22832
 22833
 22834     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22835     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22836     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22837     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 420
* EL6311.cbl
 22838     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22839
 22840     MOVE EL631D                 TO PI-MAP-NAME.
 22841     MOVE LOW-VALUES             TO EL631DI.
 22842     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22843
 22844*    IF PI-AR-PROCESSING
 22845*       MOVE PB-REFERENCE        TO DREFO.
 22846
 22847     MOVE PB-CSR-ID              TO DCSRO.
 22848
 22849     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22850        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22851        MOVE SPACE               TO DC-OPTION-CODE
 22852        PERFORM 9700-DATE-LINK
 22853        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22854        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22855        MOVE 'INACTIVE'          TO DLDATEO
 22856     ELSE
 22857        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22858        MOVE SPACE               TO DC-OPTION-CODE
 22859        PERFORM 9700-DATE-LINK
 22860        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22861
 22862     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22863     MOVE SPACE                  TO DC-OPTION-CODE.
 22864     PERFORM 9700-DATE-LINK.
 22865     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22866
 22867     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22868        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22869     ELSE
 22870        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22871        MOVE SPACE               TO DC-OPTION-CODE
 22872        PERFORM 9700-DATE-LINK
 22873        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22874
 22875     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22876     MOVE SPACE                  TO DC-OPTION-CODE.
 22877     PERFORM 9700-DATE-LINK.
 22878     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22879
 22880     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22881     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22882
 22883     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22884        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22885                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22886
 22887     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22888     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22889     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22890
 22891     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22892        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22893                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22894
 22895     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 421
* EL6311.cbl
 22896     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22897     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22898
 22899     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22900        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22901                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22902
 22903     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22904     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22905
 22906     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22907        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22908                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22909
 22910     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22911     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22912     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22913
 22914     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22915        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22916                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22917
 22918     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22919     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22920     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22921
 22922     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22923        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22924                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22925
 22926     MOVE -1                     TO DPFENTRL.
 22927     GO TO 8100-SEND-INITIAL-MAP.
 22928
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 422
* EL6311.cbl
 22930
 22931***************************************************************
 22932*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22933*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22934*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22935*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22936*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22937*     ARE THEN SET ACCORDINGLY.                               *
 22938*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22939*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22940*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22941***************************************************************
 22942
 22943******************************************************************
 22944*                                                                *
 22945*            E R R O R   A N A L Y S I S                         *
 22946*                                                                *
 22947******************************************************************
 22948
 22949******************************************************************
 22950*                                                                *
 22951*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22952*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22953*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22954*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22955*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22956*                                                                *
 22957*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22958*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22959*                                                                *
 22960******************************************************************
 22961
 22962 7300-FORMAT-ERRORS.
 22963     MOVE ' '                    TO PI-ERRORS-SW
 22964     IF PB-COMMON-ERRORS = LOW-VALUES
 22965        IF PB-FATAL-ERRORS
 22966           MOVE ER-2695          TO EMI-ERROR
 22967           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22968           GO TO 7399-EXIT.
 22969
 22970     MOVE +0                     TO WS-SUB4.
 22971
 22972 7310-ERROR-LOOP.
 22973
 22974     ADD +1                      TO WS-SUB4.
 22975
 22976     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22977        GO TO 7350-SET-ERROR-FLAGS.
 22978
 22979     IF PI-COMPANY-ID = 'UCL'
 22980         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22981             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22982             MOVE ' '                   TO DC-OPTION-CODE
 22983             PERFORM 9700-DATE-LINK
 22984             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22985
 22986     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 423
* EL6311.cbl
 22988     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22989
 22990     GO TO 7310-ERROR-LOOP.
 22991
 22992
 22993 7350-SET-ERROR-FLAGS.
 22994
 22995     IF EMI-FATAL-CTR NOT = ZEROS
 22996        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22997        MOVE 'X'                 TO PB-FATAL-FLAG
 22998                                    PI-ERRORS-SW
 22999        GO TO 7355-SET-ERROR-FLAGS.
 23000
 23001     move ' ' to pi-unforced-sw
 23002     IF EMI-FORCABLE-CTR NOT = ZEROS
 23003        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23004        IF PB-ISSUE
 23005           IF PB-ISSUE-FORCE
 23006              MOVE 'F'           TO PB-FORCE-ER-CD
 23007              MOVE ER-2600       TO EMI-ERROR
 23008              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23009             ELSE
 23010              MOVE 'X'           TO PB-FORCE-ER-CD
 23011*                                   PI-ERRORS-SW
 23012          ELSE
 23013           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23014              MOVE 'F'           TO PB-FORCE-ER-CD
 23015                                    pi-unforced-sw
 23016              MOVE ER-2600       TO EMI-ERROR
 23017              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23018             ELSE
 23019              MOVE 'X'           TO PB-FORCE-ER-CD
 23020                                    pi-unforced-sw.
 23021*                                   PI-ERRORS-SW.
 23022
 23023     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23024     IF PB-ISSUE
 23025         MOVE 'I'                TO ENDT-RECORD-TYPE
 23026     ELSE
 23027         MOVE 'C'                TO ENDT-RECORD-TYPE
 23028     END-IF
 23029     MOVE +0                     TO ENDT-SEQ-NO
 23030
 23031
 23032* EXEC CICS READ
 23033*        DATASET   (FILE-ID-ERENDT)
 23034*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23035*        RIDFLD    (ERENDT-KEY)
 23036*        RESP      (WS-RESPONSE)
 23037*        GTEQ
 23038*    END-EXEC
 23039*    MOVE '&"S        G          (  N#00019301' TO DFHEIV0
 23040     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23042     MOVE X'204E233030303139333031' TO DFHEIV0(25:11)
 23043     CALL 'kxdfhei1' USING DFHEIV0,
 23044           FILE-ID-ERENDT,
 23045           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 424
* EL6311.cbl
 23046           DFHEIV99,
 23047           ERENDT-KEY,
 23048           DFHEIV99,
 23049           DFHEIV99,
 23050           DFHEIV99
 23051     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23052         DFHEIV20
 23053     MOVE EIBRESP  TO WS-RESPONSE
 23054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23055
 23056     IF RESP-NORMAL
 23057        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23058        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23059            MOVE ER-0280          TO EMI-ERROR
 23060            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23061            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23062            EVALUATE TRUE
 23063              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23064                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23065              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23066                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23067              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23068                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23069            END-EVALUATE
 23070        END-IF
 23071     END-IF
 23072
 23073
 23074
 23075     IF FIRST-ENTRY OR
 23076        EIBAID = DFHPF1 OR DFHPF2
 23077        MOVE '0'                TO PI-EDIT-SW
 23078        GO TO 7399-EXIT.
 23079
 23080 7355-SET-ERROR-FLAGS.
 23081
 23082     IF EMI-WARNING-CTR NOT = ZEROS
 23083        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23084        MOVE 'W'                 TO PB-WARN-ER-CD.
 23085
 23086     IF PB-UNFORCED-ERRORS OR
 23087        PB-FATAL-ERRORS    OR
 23088        PB-RECORD-ON-HOLD  OR
 23089        PB-RECORD-RETURNED OR
 23090        PB-CANCELLATION
 23091          NEXT SENTENCE
 23092        ELSE
 23093          GO TO 7399-EXIT.
 23094
 23095
 23096* EXEC CICS  HANDLE CONDITION
 23097*           NOTFND   (7399-EXIT)
 23098*    END-EXEC.
 23099*    MOVE '"$I                   ! Z #00019348' TO DFHEIV0
 23100     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23102     MOVE X'5A20233030303139333438' TO DFHEIV0(25:11)
 23103     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 425
* EL6311.cbl
 23104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23105
 23106
 23107     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23108     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23109     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23110     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23111
 23112
 23113* EXEC CICS READ
 23114*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23115*        DATASET (FILE-ID-ELCERT)
 23116*        RIDFLD  (ELCERT-KEY)
 23117*        UPDATE
 23118*    END-EXEC.
 23119*    MOVE '&"S        EU         (   #00019357' TO DFHEIV0
 23120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23121     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23122     MOVE X'2020233030303139333537' TO DFHEIV0(25:11)
 23123     CALL 'kxdfhei1' USING DFHEIV0,
 23124           FILE-ID-ELCERT,
 23125           DFHEIV20,
 23126           DFHEIV99,
 23127           ELCERT-KEY,
 23128           DFHEIV99,
 23129           DFHEIV99,
 23130           DFHEIV99
 23131     SET ADDRESS OF CERTIFICATE-MASTER TO
 23132         DFHEIV20
 23133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23134
 23135
 23136
 23137     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23138     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23139
 23140     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23141        GO TO 7360-REWRITE-CERT-MASTER.
 23142
 23143     IF PB-ISSUE
 23144        IF PB-RECORD-RETURNED
 23145            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23146            GO TO 7360-REWRITE-CERT-MASTER
 23147        ELSE
 23148            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23149            GO TO 7360-REWRITE-CERT-MASTER.
 23150
 23151     IF PB-RECORD-RETURNED
 23152         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23153         GO TO 7360-REWRITE-CERT-MASTER.
 23154
 23155     IF (PB-C-LF-CANCEL-VOIDED)
 23156        or (pb-c-ah-cancel-voided)
 23157        IF (PB-UNFORCED-ERRORS OR
 23158            PB-FATAL-ERRORS    OR
 23159            PB-RECORD-ON-HOLD)
 23160            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23161            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 426
* EL6311.cbl
 23162        ELSE
 23163            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23164            GO TO 7360-REWRITE-CERT-MASTER.
 23165
 23166     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23167                            OR PB-RECORD-ON-HOLD)
 23168        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23169     ELSE
 23170        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23171
 23172 7360-REWRITE-CERT-MASTER.
 23173
 23174     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23175        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23176
 23177* EXEC CICS UNLOCK
 23178*            DATASET    (FILE-ID-ELCERT)
 23179*       END-EXEC
 23180*    MOVE '&*                    #   #00019404' TO DFHEIV0
 23181     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23182     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23183     MOVE X'2020233030303139343034' TO DFHEIV0(25:11)
 23184     CALL 'kxdfhei1' USING DFHEIV0,
 23185           FILE-ID-ELCERT,
 23186           DFHEIV99
 23187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23188        GO TO 7399-EXIT.
 23189
 23190
 23191* EXEC CICS REWRITE
 23192*         DATASET    (FILE-ID-ELCERT)
 23193*         FROM       (CERTIFICATE-MASTER)
 23194*    END-EXEC.
 23195     MOVE LENGTH OF
 23196      CERTIFICATE-MASTER
 23197       TO DFHEIV11
 23198*    MOVE '&& L                  %   #00019409' TO DFHEIV0
 23199     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23200     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23201     MOVE X'2020233030303139343039' TO DFHEIV0(25:11)
 23202     CALL 'kxdfhei1' USING DFHEIV0,
 23203           FILE-ID-ELCERT,
 23204           CERTIFICATE-MASTER,
 23205           DFHEIV11,
 23206           DFHEIV99
 23207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23208
 23209
 23210 7399-EXIT.
 23211      EXIT.
 23212
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 427
* EL6311.cbl
 23214
 23215*************************************************************
 23216*                                                           *
 23217*              S E T   A T T R I B U T E S                  *
 23218*                                                           *
 23219*************************************************************
 23220
 23221 7400-SET-ATTRIBUTES.
 23222
 23223     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23224        GO TO 7499-EXIT.
 23225
 23226**2601**
 23227
 23228     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23229        IF PB-ISSUE
 23230           MOVE AL-UABON         TO BEFFDTA
 23231           GO TO 7499-EXIT
 23232         ELSE
 23233           MOVE AL-UABON         TO CEFFDTA
 23234           GO TO 7499-EXIT.
 23235
 23236**2604**
 23237
 23238     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23239        IF PB-ISSUE
 23240           MOVE AL-UABON         TO BTYPE1A
 23241           MOVE -1               TO BTYPE1L
 23242           MOVE  1               TO SET-CURSOR-SW
 23243           GO TO 7499-EXIT.
 23244
 23245**2605**
 23246
 23247     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23248        IF PB-ISSUE
 23249           MOVE AL-UABON         TO BTYPE2A
 23250           MOVE -1               TO BTYPE2L
 23251           MOVE  1               TO SET-CURSOR-SW
 23252           GO TO 7499-EXIT.
 23253
 23254**2606**
 23255
 23256     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23257        IF PB-ISSUE
 23258           MOVE AL-UABON         TO BSIGA
 23259           MOVE -1               TO BSIGL
 23260           MOVE  1               TO SET-CURSOR-SW
 23261           GO TO 7499-EXIT.
 23262
 23263**2607**
 23264
 23265     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23266        IF PB-ISSUE
 23267           MOVE AL-UABON         TO BSIGA
 23268           MOVE -1               TO BSIGL
 23269           MOVE  1               TO SET-CURSOR-SW
 23270           GO TO 7499-EXIT.
 23271
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 428
* EL6311.cbl
 23272**2615**
 23273
 23274     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23275        IF PB-ISSUE
 23276           MOVE AL-UABOF         TO BREINA
 23277           MOVE -1               TO BREINL
 23278           GO TO 7499-EXIT.
 23279
 23280**2622**
 23281
 23282     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23283        IF PB-ISSUE
 23284           MOVE AL-UABON         TO BEFFDTA
 23285           GO TO 7499-EXIT
 23286        ELSE
 23287           MOVE AL-UABON         TO CEFFDTA
 23288           GO TO 7499-EXIT.
 23289
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 429
* EL6311.cbl
 23291
 23292*************************************************************
 23293*                                                           *
 23294*              I S S U E   E R R O R S                      *
 23295*                                                           *
 23296*************************************************************
 23297
 23298 7420-ISSUE-ERRORS.
 23299
 23300**2626**
 23301
 23302     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23303        MOVE AL-UABON            TO BCERTNOA
 23304        GO TO 7499-EXIT.
 23305
 23306**2627**
 23307
 23308     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23309        MOVE AL-UNBON            TO BAGEA
 23310        MOVE -1                  TO BAGEL
 23311        MOVE  1                  TO SET-CURSOR-SW
 23312        GO TO 7499-EXIT.
 23313
 23314**2628**
 23315
 23316     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23317        MOVE AL-UNBON            TO BAGEA
 23318        MOVE -1                  TO BAGEL
 23319        MOVE  1                  TO SET-CURSOR-SW
 23320        GO TO 7499-EXIT.
 23321
 23322**2629**
 23323
 23324     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23325        MOVE AL-UABON            TO BSEXA
 23326        MOVE -1                  TO BSEXL
 23327        MOVE  1                  TO SET-CURSOR-SW
 23328        GO TO 7499-EXIT.
 23329
 23330**2630**
 23331
 23332     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23333        MOVE -1                  TO BTYPE1L
 23334        MOVE  1                  TO SET-CURSOR-SW
 23335        GO TO 7499-EXIT.
 23336
 23337**2631**
 23338
 23339     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23340        MOVE -1                  TO BTYPE1L
 23341        MOVE  1                  TO SET-CURSOR-SW
 23342        GO TO 7499-EXIT.
 23343
 23344**2632**
 23345
 23346     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23347        MOVE AL-UNBON            TO BBEN1A
 23348        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 430
* EL6311.cbl
 23349        MOVE  1                  TO SET-CURSOR-SW
 23350        GO TO 7499-EXIT.
 23351
 23352**2633**
 23353
 23354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23355        MOVE AL-UNBON            TO BPREM1A
 23356        MOVE -1                  TO BPREM1L
 23357        MOVE  1                  TO SET-CURSOR-SW
 23358        GO TO 7499-EXIT.
 23359
 23360**2634**
 23361
 23362     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23363        MOVE -1                  TO BTYPE2L
 23364        MOVE  1                  TO SET-CURSOR-SW
 23365        GO TO 7499-EXIT.
 23366
 23367**2635**
 23368
 23369     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23370        MOVE AL-UNBON            TO BBEN2A
 23371        MOVE -1                  TO BBEN2L
 23372        MOVE  1                  TO SET-CURSOR-SW
 23373        GO TO 7499-EXIT.
 23374
 23375**2636**
 23376
 23377     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23378        MOVE AL-UNBON            TO BPREM2A
 23379        MOVE -1                  TO BPREM2L
 23380        MOVE  1                  TO SET-CURSOR-SW
 23381        GO TO 7499-EXIT.
 23382
 23383**2639**
 23384
 23385     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23386        MOVE AL-UNBON            TO BBEN1A
 23387        MOVE -1                  TO BBEN1L
 23388        MOVE  1                  TO SET-CURSOR-SW
 23389        GO TO 7499-EXIT.
 23390
 23391**2640**
 23392
 23393     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23394        MOVE AL-UNBON            TO BBEN2A
 23395        MOVE -1                  TO BBEN2L
 23396        MOVE  1                  TO SET-CURSOR-SW
 23397        GO TO 7499-EXIT.
 23398
 23399**2647**
 23400
 23401     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23402        MOVE AL-UNBON            TO BTERM1A
 23403        MOVE -1                  TO BTERM1L
 23404        MOVE  1                  TO SET-CURSOR-SW
 23405        GO TO 7499-EXIT.
 23406
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 431
* EL6311.cbl
 23407**2648**
 23408
 23409     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23410        MOVE AL-UNBON            TO BLNTRMA
 23411        MOVE -1                  TO BLNTRML
 23412        MOVE  1                  TO SET-CURSOR-SW
 23413        GO TO 7499-EXIT.
 23414
 23415**2649**
 23416
 23417     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23418        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23419            MOVE AL-UNBON            TO BPREM1A
 23420            MOVE -1                  TO BPREM1L
 23421            MOVE  1                  TO SET-CURSOR-SW
 23422            GO TO 7499-EXIT
 23423     ELSE
 23424        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23425           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23426            MOVE AL-UNBON            TO BPREM2A
 23427            MOVE -1                  TO BPREM2L
 23428            MOVE  1                  TO SET-CURSOR-SW
 23429            GO TO 7499-EXIT.
 23430
 23431**2650**
 23432
 23433     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23434        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23435            MOVE AL-UNBON        TO BPREM1A
 23436            MOVE -1              TO BPREM1L
 23437            MOVE  1              TO SET-CURSOR-SW
 23438            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23439                MOVE AL-UNBON        TO BPREM2A
 23440                MOVE -1              TO BPREM2L
 23441                MOVE  1              TO SET-CURSOR-SW
 23442                GO TO 7499-EXIT
 23443            ELSE
 23444                GO TO 7499-EXIT
 23445        ELSE
 23446            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23447                MOVE AL-UNBON        TO BPREM2A
 23448                MOVE -1              TO BPREM2L
 23449                MOVE  1              TO SET-CURSOR-SW
 23450                GO TO 7499-EXIT
 23451            ELSE
 23452                GO TO 7499-EXIT.
 23453
 23454**2651**
 23455
 23456     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23457        MOVE AL-UABON            TO BSIGA
 23458        MOVE -1                  TO BSIGL
 23459        MOVE  1                  TO SET-CURSOR-SW
 23460        GO TO 7499-EXIT.
 23461
 23462**2653**
 23463
 23464     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 432
* EL6311.cbl
 23465        MOVE AL-UABON            TO BFREQA
 23466        MOVE -1                  TO BFREQL
 23467        MOVE  1                  TO SET-CURSOR-SW
 23468        GO TO 7499-EXIT.
 23469
 23470**2654**
 23471
 23472     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23473        MOVE AL-UABON            TO BFREQA
 23474        MOVE -1                  TO BFREQL
 23475        MOVE  1                  TO SET-CURSOR-SW
 23476        GO TO 7499-EXIT.
 23477
 23478**2655**
 23479
 23480     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23481        MOVE AL-UABON            TO BFREQA
 23482        MOVE -1                  TO BFREQL
 23483        MOVE  1                  TO SET-CURSOR-SW
 23484        GO TO 7499-EXIT.
 23485
 23486**2656**
 23487
 23488     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23489        MOVE AL-UNBON            TO BAPRA
 23490        MOVE -1                  TO BAPRL
 23491        MOVE  1                  TO SET-CURSOR-SW
 23492        GO TO 7499-EXIT.
 23493
 23494**2657**
 23495
 23496     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23497        MOVE AL-UNBON            TO BAPRA
 23498        MOVE -1                  TO BAPRL
 23499        MOVE  1                  TO SET-CURSOR-SW
 23500        GO TO 7499-EXIT.
 23501
 23502**2658**
 23503
 23504     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23505        MOVE AL-UNBON            TO BTERM2A
 23506        MOVE -1                  TO BTERM2L
 23507        MOVE  1                  TO SET-CURSOR-SW
 23508        GO TO 7499-EXIT.
 23509
 23510**2660**
 23511
 23512     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23513        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23514        MOVE -1                  TO BLSTNML
 23515        MOVE  1                  TO SET-CURSOR-SW
 23516        GO TO 7499-EXIT.
 23517
 23518
 23519**2662**
 23520
 23521     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23522        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 433
* EL6311.cbl
 23523        MOVE -1                  TO BAGEL
 23524        MOVE  1                  TO SET-CURSOR-SW
 23525        GO TO 7499-EXIT.
 23526
 23527**2663**
 23528
 23529     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23530        MOVE AL-UNBON            TO BAGEA
 23531        MOVE -1                  TO BAGEL
 23532        MOVE  1                  TO SET-CURSOR-SW
 23533        GO TO 7499-EXIT.
 23534
 23535**2664**
 23536
 23537     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23538        MOVE AL-UABON            TO BREINA
 23539        MOVE -1                  TO BREINL
 23540        MOVE  1                  TO SET-CURSOR-SW
 23541        GO TO 7499-EXIT.
 23542
 23543**2667**
 23544
 23545     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23546        MOVE AL-UNBON            TO BBEN2A
 23547        MOVE -1                  TO BBEN2L
 23548        MOVE  1                  TO SET-CURSOR-SW
 23549        GO TO 7499-EXIT.
 23550
 23551**2668**
 23552
 23553     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23554        MOVE AL-UABON            TO BEFFDTA
 23555        GO TO 7499-EXIT.
 23556
 23557**2669**
 23558
 23559     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23560       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23561       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23562        MOVE AL-UNBON            TO BAGEA
 23563        MOVE -1                  TO BAGEL
 23564        MOVE  1                  TO SET-CURSOR-SW
 23565        GO TO 7499-EXIT.
 23566
 23567**2670**
 23568
 23569     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23570        MOVE AL-UABON            TO BFORCEA
 23571        MOVE -1                  TO BFORCEL
 23572        MOVE  1                  TO SET-CURSOR-SW
 23573        GO TO 7499-EXIT.
 23574
 23575**2671**
 23576
 23577     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23578        MOVE AL-UABON            TO BEFFDTA
 23579        GO TO 7499-EXIT.
 23580
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 434
* EL6311.cbl
 23581**2672**
 23582
 23583     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23584        MOVE AL-UABON            TO BEFFDTA
 23585        GO TO 7499-EXIT.
 23586
 23587**2673**
 23588
 23589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23590        MOVE AL-UABON            TO BEFFDTA
 23591        GO TO 7499-EXIT.
 23592
 23593**2674**
 23594
 23595     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23596        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23597        MOVE -1                  TO BTYPE1L
 23598        MOVE  1                  TO SET-CURSOR-SW
 23599        GO TO 7499-EXIT.
 23600
 23601**2677**
 23602
 23603     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23604        MOVE AL-UNBON            TO BTERM1A
 23605        MOVE -1                  TO BTERM1L
 23606        MOVE  1                  TO SET-CURSOR-SW
 23607        GO TO 7499-EXIT.
 23608
 23609**2678**
 23610
 23611     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23612        MOVE AL-UNBON            TO BTERM2A
 23613        MOVE -1                  TO BTERM2L
 23614        MOVE  1                  TO SET-CURSOR-SW
 23615        GO TO 7499-EXIT.
 23616
 23617**2679**
 23618
 23619     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23620        MOVE AL-UABON            TO BTYPE1A
 23621        MOVE -1                  TO BTYPE1L
 23622        MOVE  1                  TO SET-CURSOR-SW
 23623        GO TO 7499-EXIT.
 23624
 23625**2680**
 23626
 23627     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23628        MOVE AL-UABOF            TO B1STPMTA
 23629        MOVE -1                  TO B1STPMTL
 23630        MOVE  1                  TO SET-CURSOR-SW
 23631        GO TO 7499-EXIT.
 23632
 23633**2681**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23636        MOVE AL-UABON            TO BDAYSA
 23637        MOVE -1                  TO BDAYSL
 23638        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 435
* EL6311.cbl
 23639        GO TO 7499-EXIT.
 23640
 23641**2682**
 23642
 23643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23644        MOVE AL-UABON            TO BTERM1A
 23645        MOVE -1                  TO BTERM1L
 23646        MOVE  1                  TO SET-CURSOR-SW
 23647        GO TO 7499-EXIT.
 23648
 23649**2683**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23652        MOVE AL-UABON            TO BSKPCDA
 23653        MOVE -1                  TO BSKPCDL
 23654        MOVE  1                  TO SET-CURSOR-SW
 23655        GO TO 7499-EXIT.
 23656
 23657**2684**
 23658
 23659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23660        MOVE AL-UABON            TO BTYPE2A
 23661        MOVE -1                  TO BTYPE2L
 23662        MOVE  1                  TO SET-CURSOR-SW
 23663        GO TO 7499-EXIT.
 23664
 23665**2686**
 23666
 23667     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23668        MOVE AL-UABON            TO BTYPE2A
 23669        MOVE -1                  TO BTYPE2L
 23670        MOVE  1                  TO SET-CURSOR-SW
 23671        GO TO 7499-EXIT.
 23672
 23673**2689**
 23674
 23675     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23676        MOVE AL-UABON            TO BSIGA
 23677        MOVE -1                  TO BSIGL
 23678        MOVE  1                  TO SET-CURSOR-SW
 23679        GO TO 7499-EXIT.
 23680
 23681**2690**
 23682
 23683     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23684        MOVE AL-UABOF            TO BLNOFCRA
 23685        MOVE -1                  TO BLNOFCRL
 23686        MOVE  1                  TO SET-CURSOR-SW
 23687        GO TO 7499-EXIT.
 23688
 23689**2693**
 23690
 23691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23692        MOVE AL-UABOF            TO BLNOFCRA
 23693        MOVE AL-UNBON            TO BBEN1A
 23694        MOVE -1                  TO BBEN1L
 23695        MOVE  1                  TO SET-CURSOR-SW
 23696        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 436
* EL6311.cbl
 23697
 23698**2720**
 23699
 23700     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23701        MOVE AL-UNBON            TO BBEN1A
 23702        MOVE -1                  TO BBEN1L
 23703        MOVE  1                  TO SET-CURSOR-SW
 23704        GO TO 7499-EXIT.
 23705
 23706**2709**
 23707
 23708*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23709*       MOVE AL-UNBON            TO BBEN1A
 23710*       MOVE -1                  TO BBEN1L
 23711*       MOVE  1                  TO SET-CURSOR-SW
 23712*       GO TO 7499-EXIT.
 23713
 23714*************************************************************
 23715*                                                           *
 23716*            C A N C E L   E R R O R S                      *
 23717*                                                           *
 23718*************************************************************
 23719
 23720**2726**
 23721
 23722     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23723        MOVE AL-UABON            TO CCERTNOA
 23724        GO TO 7499-EXIT.
 23725
 23726**2728**
 23727
 23728     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23729        MOVE AL-UABON            TO CCERTNOA
 23730        GO TO 7499-EXIT.
 23731
 23732**2729**
 23733
 23734     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23735        MOVE AL-UABON            TO CCERTNOA
 23736        GO TO 7499-EXIT.
 23737
 23738**2730**
 23739
 23740     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23741        MOVE AL-UABON            TO CCERTNOA
 23742        GO TO 7499-EXIT.
 23743
 23744**2731**
 23745
 23746     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23747        MOVE AL-UABON            TO CCANDT1A
 23748        MOVE -1                  TO CCANDT1L
 23749        MOVE  1                  TO SET-CURSOR-SW
 23750        GO TO 7499-EXIT.
 23751
 23752**2732**
 23753
 23754     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 437
* EL6311.cbl
 23755        MOVE AL-UABON            TO CCANDT1A
 23756        MOVE -1                  TO CCANDT1L
 23757        MOVE  1                  TO SET-CURSOR-SW
 23758        GO TO 7499-EXIT.
 23759
 23760**2733**
 23761
 23762     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23763        MOVE AL-UABON            TO CCANDT1A
 23764        MOVE -1                  TO CCANDT1L
 23765        MOVE  1                  TO SET-CURSOR-SW
 23766        GO TO 7499-EXIT.
 23767
 23768**2734**
 23769
 23770     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23771        MOVE AL-UNBON            TO CREFND1A
 23772        MOVE -1                  TO CREFND1L
 23773        MOVE  1                  TO SET-CURSOR-SW
 23774        GO TO 7499-EXIT.
 23775
 23776**2735**
 23777
 23778     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23779        MOVE AL-UABON            TO CCANDT2A
 23780        MOVE -1                  TO CCANDT2L
 23781        MOVE  1                  TO SET-CURSOR-SW
 23782        GO TO 7499-EXIT.
 23783
 23784**2736**
 23785
 23786     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23787        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23788            MOVE AL-UNBON        TO CREFND1A
 23789            MOVE -1              TO CREFND1L
 23790            MOVE  1              TO SET-CURSOR-SW
 23791            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23792                MOVE AL-UNBON        TO CREFND2A
 23793                MOVE -1              TO CREFND2L
 23794                MOVE  1              TO SET-CURSOR-SW
 23795                GO TO 7499-EXIT
 23796            ELSE
 23797                GO TO 7499-EXIT
 23798        ELSE
 23799            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23800                MOVE AL-UNBON        TO CREFND2A
 23801                MOVE -1              TO CREFND2L
 23802                MOVE  1              TO SET-CURSOR-SW
 23803                GO TO 7499-EXIT
 23804            ELSE
 23805                GO TO 7499-EXIT.
 23806
 23807**2738**
 23808
 23809     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23810        MOVE -1                  TO CREFND2L
 23811        MOVE  1                  TO SET-CURSOR-SW
 23812        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 438
* EL6311.cbl
 23813
 23814**2739**
 23815
 23816     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23817        MOVE -1                  TO CREFND1L
 23818        MOVE  1                  TO SET-CURSOR-SW
 23819        GO TO 7499-EXIT.
 23820
 23821**2741**
 23822
 23823     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23824        MOVE -1                  TO CREFND1L
 23825        MOVE  1                  TO SET-CURSOR-SW
 23826        GO TO 7499-EXIT.
 23827
 23828**2743**
 23829
 23830     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23831        MOVE AL-UNBON            TO CCANDT1A
 23832        MOVE -1                  TO CCANDT1L
 23833        MOVE  1                  TO SET-CURSOR-SW
 23834        GO TO 7499-EXIT.
 23835
 23836**2744**
 23837
 23838     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23839        MOVE AL-UNBON            TO CCANDT2A
 23840        MOVE -1                  TO CCANDT2L
 23841        MOVE  1                  TO SET-CURSOR-SW
 23842        GO TO 7499-EXIT.
 23843
 23844**2747**
 23845
 23846     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23847        MOVE AL-UABON            TO CLSTNMA
 23848        MOVE -1                  TO CLSTNML
 23849        MOVE  1                  TO SET-CURSOR-SW
 23850        GO TO 7499-EXIT.
 23851
 23852**2749**
 23853
 23854     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23855        MOVE AL-UABON            TO CFORCEA
 23856        MOVE -1                  TO CFORCEL
 23857        MOVE  1                  TO SET-CURSOR-SW
 23858        GO TO 7499-EXIT.
 23859
 23860**2753**
 23861
 23862     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23863        MOVE AL-UNBON            TO CCANDT1A
 23864        MOVE -1                  TO CCANDT1L
 23865        MOVE  1                  TO SET-CURSOR-SW
 23866        GO TO 7499-EXIT.
 23867
 23868**2755**
 23869
 23870     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 439
* EL6311.cbl
 23871        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23872            MOVE AL-UNBON        TO CREFND1A
 23873            MOVE -1              TO CREFND1L
 23874            MOVE  1              TO SET-CURSOR-SW
 23875            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23876                MOVE AL-UNBON        TO CREFND2A
 23877                MOVE -1              TO CREFND2L
 23878                MOVE  1              TO SET-CURSOR-SW
 23879                GO TO 7499-EXIT
 23880            ELSE
 23881                GO TO 7499-EXIT
 23882        ELSE
 23883            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23884                MOVE AL-UNBON        TO CREFND2A
 23885                MOVE -1              TO CREFND2L
 23886                MOVE  1              TO SET-CURSOR-SW
 23887            ELSE
 23888                GO TO 7499-EXIT.
 23889
 23890**2757**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23893        MOVE AL-UNBON            TO CLIVESA
 23894        MOVE -1                  TO CLIVESL
 23895        MOVE  1                  TO SET-CURSOR-SW
 23896        GO TO 7499-EXIT.
 23897
 23898**2771**
 23899
 23900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23901        MOVE AL-UABON            TO CCANDT2A
 23902        MOVE -1                  TO CCANDT2L
 23903        MOVE  1                  TO SET-CURSOR-SW
 23904        GO TO 7499-EXIT.
 23905
 23906**2774**
 23907
 23908     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23909        MOVE AL-UABON            TO CCANDT1A
 23910        MOVE -1                  TO CCANDT1L
 23911        MOVE  1                  TO SET-CURSOR-SW
 23912        GO TO 7499-EXIT.
 23913
 23914**2775**
 23915
 23916     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23917        MOVE AL-UABON            TO CCANDT2A
 23918        MOVE -1                  TO CCANDT2L
 23919        MOVE  1                  TO SET-CURSOR-SW
 23920        GO TO 7499-EXIT.
 23921
 23922**2776**
 23923
 23924     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23925        MOVE AL-UABON            TO CCANDT1A
 23926        MOVE -1                  TO CCANDT1L
 23927        MOVE  1                  TO SET-CURSOR-SW
 23928        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 440
* EL6311.cbl
 23929
 23930
 23931**2777**
 23932
 23933     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23934        MOVE AL-UABON            TO CCANDT2A
 23935        MOVE -1                  TO CCANDT2L
 23936        MOVE  1                  TO SET-CURSOR-SW
 23937        GO TO 7499-EXIT.
 23938
 23939**2794**
 23940
 23941     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23942        MOVE AL-UABON            TO CFORCEA
 23943        MOVE -1                  TO CFORCEL
 23944        MOVE  1                  TO SET-CURSOR-SW
 23945        GO TO 7499-EXIT.
 23946
 23947**2799**
 23948
 23949     IF PI-COMPANY-ID = 'UCL'
 23950         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23951             MOVE AL-UNBON            TO BEFFDTA
 23952             MOVE -1                  TO BEFFDTL
 23953             MOVE  1                  TO SET-CURSOR-SW
 23954             GO TO 7499-EXIT.
 23955
 23956 7499-EXIT.
 23957      EXIT.
 23958
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 441
* EL6311.cbl
 23960
 23961 7500-READ-ERLOFC.
 23962     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23963                                     ERLOFC-KEY.
 23964
 23965     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23966
 23967     IF ST-ACCNT-CNTL
 23968         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23969
 23970     IF CARR-GROUP-ST-ACCNT-CNTL
 23971         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23972         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23973         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23974
 23975     IF CARR-ST-ACCNT-CNTL
 23976         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23977         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23978
 23979     IF CARR-ACCNT-CNTL
 23980         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23981
 23982     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23983
 23984     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23985
 23986
 23987* EXEC CICS HANDLE CONDITION
 23988*        NOTFND   (7550-OFFICER-NOTFND)
 23989*    END-EXEC.
 23990*    MOVE '"$I                   ! [ #00020190' TO DFHEIV0
 23991     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23993     MOVE X'5B20233030303230313930' TO DFHEIV0(25:11)
 23994     CALL 'kxdfhei1' USING DFHEIV0
 23995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23996
 23997
 23998
 23999* EXEC CICS READ
 24000*        DATASET   (FILE-ID-ERLOFC)
 24001*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24002*        RIDFLD    (ERLOFC-KEY)
 24003*        EQUAL
 24004*    END-EXEC.
 24005*    MOVE '&"S        E          (   #00020194' TO DFHEIV0
 24006     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24008     MOVE X'2020233030303230313934' TO DFHEIV0(25:11)
 24009     CALL 'kxdfhei1' USING DFHEIV0,
 24010           FILE-ID-ERLOFC,
 24011           DFHEIV20,
 24012           DFHEIV99,
 24013           ERLOFC-KEY,
 24014           DFHEIV99,
 24015           DFHEIV99,
 24016           DFHEIV99
 24017     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 442
* EL6311.cbl
 24018         DFHEIV20
 24019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24020
 24021
 24022     GO TO 7599-EXIT.
 24023
 24024 7550-OFFICER-NOTFND.
 24025     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24026
 24027 7599-EXIT.
 24028      EXIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 443
* EL6311.cbl
 24030******************************************************************
 24031*                                                                *
 24032*            S  E N D    I N I T I A L   M A P                   *
 24033*                                                                *
 24034******************************************************************
 24035
 24036 8100-SEND-INITIAL-MAP.
 24037     MOVE EIBTIME                TO TIME-IN.
 24038
 24039     IF EIBAID = DFHPF11
 24040        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24042
 24043
 24044     IF PI-COMPANY-ID = CLIENT-GIC
 24045        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24046                                       BCPREM-ATTRB (2).
 24047
 24048     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24049                         CLIENT-PEM OR
 24050                         CLIENT-CSO)
 24051        AND PI-DISPLAY-ORIGINAL-BATCH
 24052          IF PI-MAP-NAME = EL631B
 24053             MOVE AL-SADOF               TO BPF5HDRA
 24054                                            BPF4HDRA
 24055          ELSE
 24056             IF PI-MAP-NAME = EL631C
 24057                MOVE AL-SADOF            TO CPF5HDRA
 24058                                            CPF4HDRA.
 24059
 24060     IF PI-MAP-NAME = EL631B
 24061        MOVE AL-SADOF               TO BPF5HDRA
 24062     ELSE
 24063        MOVE AL-SADOF               TO CPF5HDRA
 24064     END-IF
 24065
 24066*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24067     IF PI-MAP-NAME = EL631B
 24068          IF PI-COMPANY-ID NOT = 'DMD'
 24069             MOVE AL-SANOF            TO BBILLEDA
 24070             MOVE AL-SADOF            TO DMDBILA.
 24071*DMD CUSTOM CODING*************END
 24072
 24073     IF PI-PROCESSOR-ID = 'LGXX'
 24074        IF PI-MAP-NAME = EL631B
 24075           MOVE AL-SABOF                    TO BREFHDGA
 24076           MOVE AL-SANOF                    TO BREFA
 24077        ELSE
 24078           IF PI-MAP-NAME = EL631C
 24079              MOVE AL-SABOF                 TO CREFHDGA
 24080              MOVE AL-SANOF                 TO CREFA.
 24081
 24082*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 24083     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 24084        NEXT SENTENCE
 24085     ELSE
 24086        IF PI-MAP-NAME = EL631C
 24087           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 444
* EL6311.cbl
 24088                                       CCANFEEA.
 24089
 24090     IF PI-MAP-NAME = EL631D
 24091        IF PI-AR-PROCESSING
 24092           MOVE AL-SANOF            TO DREFHDGA
 24093        ELSE
 24094           MOVE AL-SADOF            TO DREFHDGA.
 24095
 24096     IF (PI-COMPANY-ID NOT = 'DCC')
 24097        AND (PI-MAP-NAME = EL631B)
 24098        MOVE AL-SADOF            TO BVINHA
 24099                                    BVINA
 24100     END-IF
 24101     IF PI-MAP-NAME = EL631B
 24102        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24103        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24104                                 TO BREGIONO
 24105        MOVE PI-PROCESSOR-ID     TO BUSERO
 24106        IF CSR-EDIT-SESSION
 24107           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24108                                 TO BHEADO
 24109           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24110        ELSE
 24111           MOVE AL-SADOF         TO BF15HDRA
 24112           MOVE '4=B-HDR      '  TO BPF4HDRO
 24113        END-IF
 24114        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24115        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24116        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24117        MOVE WS-CURRENT-DT          TO BDATEO
 24118        MOVE TIME-OUT               TO BTIMEO
 24119        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24120        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24121        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24122        IF   WS-DISPLAY-SCREEN
 24123             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24124             MOVE PB-SV-CARRIER     TO BCARRO
 24125             MOVE PB-SV-GROUPING    TO BGROUPO
 24126             MOVE PB-SV-STATE       TO BSTATEO
 24127             MOVE PB-ACCOUNT        TO BACCTO
 24128        ELSE
 24129             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24130     ELSE
 24131        IF PI-MAP-NAME = EL631C
 24132           MOVE '4=B-HDR      '     TO CPF4HDRO
 24133           IF CSR-EDIT-SESSION
 24134              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24135                                 TO CHEADO
 24136           ELSE
 24137              MOVE AL-SADOF      TO CF15HDRA
 24138           END-IF
 24139           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24140           MOVE WS-CURRENT-DT          TO CDATEO
 24141           MOVE TIME-OUT               TO CTIMEO
 24142           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24143           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24144           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24145           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 445
* EL6311.cbl
 24146           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24147           MOVE WS-C-HDG               TO CAHHDGO
 24148           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24149           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24150           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24151           IF   WS-DISPLAY-SCREEN
 24152                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24153                MOVE PB-SV-CARRIER     TO CCARRO
 24154                MOVE PB-SV-GROUPING    TO CGROUPO
 24155                MOVE PB-SV-STATE       TO CSTATEO
 24156                MOVE PB-ACCOUNT        TO CACCTO
 24157           ELSE
 24158                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24159        ELSE
 24160           MOVE WS-CURRENT-DT          TO DDATEO
 24161           MOVE TIME-OUT               TO DTIMEO
 24162           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24163                                          WS-REFUND-HDG-OVERRIDE
 24164           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24165           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24166           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24167                                          WS-REFUND-HDG-OVERRIDE
 24168           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24169           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24170           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24171           IF CSR-EDIT-SESSION
 24172              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24173                                 TO DHEADO
 24174           END-IF
 24175           IF  WS-DISPLAY-SCREEN
 24176               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24177               MOVE PB-CARRIER         TO DCARRO
 24178               MOVE PB-GROUPING        TO DGROUPO
 24179               MOVE PB-STATE           TO DSTATEO
 24180               MOVE PB-ACCOUNT         TO DACCTO
 24181               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24182           ELSE
 24183               MOVE EL631D             TO PI-MAP-NAME
 24184               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24185               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24186
 24187     MOVE SPACE                        TO WS-DISPLAY-SW.
 24188
 24189
 24190* EXEC CICS SEND
 24191*        MAP      (PI-MAP-NAME)
 24192*        MAPSET   (MAPSET-EL6311S)
 24193*        FROM     (EL631BI)
 24194*        ERASE
 24195*        CURSOR
 24196*    END-EXEC.
 24197     MOVE LENGTH OF
 24198      EL631BI
 24199       TO DFHEIV12
 24200     MOVE -1
 24201       TO DFHEIV11
 24202*    MOVE '8$     CT  E    H L F ,   #00020368' TO DFHEIV0
 24203     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 446
* EL6311.cbl
 24204     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24205     MOVE X'2020233030303230333638' TO DFHEIV0(25:11)
 24206     CALL 'kxdfhei1' USING DFHEIV0,
 24207           PI-MAP-NAME,
 24208           EL631BI,
 24209           DFHEIV12,
 24210           MAPSET-EL6311S,
 24211           DFHEIV99,
 24212           DFHEIV99,
 24213           DFHEIV99,
 24214           DFHEIV11,
 24215           DFHEIV99,
 24216           DFHEIV99,
 24217           DFHEIV99
 24218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24219
 24220
 24221     GO TO 9100-RETURN-TRAN.
 24222
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 447
* EL6311.cbl
 24224
 24225******************************************************************
 24226*                                                                *
 24227*              S E N D    D A T A O N L Y                        *
 24228*                                                                *
 24229******************************************************************
 24230
 24231 8200-SEND-DATAONLY.
 24232     MOVE EIBTIME                TO TIME-IN.
 24233
 24234     IF PI-COMPANY-ID = CLIENT-GIC
 24235        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24236                                       BCPREM-ATTRB (2).
 24237
 24238     IF PI-MAP-NAME = EL631B
 24239        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24240        MOVE WS-CURRENT-DT          TO BDATEO
 24241        MOVE TIME-OUT               TO BTIMEO
 24242        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24243        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24244        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24245        MOVE SPACES                 TO BPFENTRO
 24246        MOVE AL-UANOF               TO BPFENTRA
 24247
 24248*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24249        IF PI-COMPANY-ID NOT = 'DMD'
 24250             MOVE AL-SANOF            TO BBILLEDA
 24251             MOVE AL-SADOF            TO DMDBILA
 24252         ELSE
 24253            NEXT SENTENCE
 24254*DMD CUSTOM CODING*************END
 24255     ELSE
 24256        IF PI-MAP-NAME = EL631C
 24257           MOVE WS-CURRENT-DT          TO CDATEO
 24258           MOVE TIME-OUT               TO CTIMEO
 24259           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24260           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24261           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24262           MOVE SPACES                 TO CPFENTRO
 24263           MOVE AL-UANOF               TO CPFENTRA
 24264        ELSE
 24265           MOVE WS-CURRENT-DT          TO DDATEO
 24266           MOVE TIME-OUT               TO DTIMEO
 24267           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24268
 24269
 24270* EXEC CICS SEND
 24271*        MAP      (PI-MAP-NAME)
 24272*        MAPSET   (MAPSET-EL6311S)
 24273*        FROM     (EL631BI)
 24274*        DATAONLY
 24275*        CURSOR
 24276*    END-EXEC.
 24277     MOVE LENGTH OF
 24278      EL631BI
 24279       TO DFHEIV12
 24280     MOVE -1
 24281       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 448
* EL6311.cbl
 24282*    MOVE '8$D    CT       H L F ,   #00020424' TO DFHEIV0
 24283     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24284     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24285     MOVE X'2020233030303230343234' TO DFHEIV0(25:11)
 24286     CALL 'kxdfhei1' USING DFHEIV0,
 24287           PI-MAP-NAME,
 24288           EL631BI,
 24289           DFHEIV12,
 24290           MAPSET-EL6311S,
 24291           DFHEIV99,
 24292           DFHEIV99,
 24293           DFHEIV99,
 24294           DFHEIV11,
 24295           DFHEIV99,
 24296           DFHEIV99,
 24297           DFHEIV99
 24298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24299
 24300
 24301     GO TO 9100-RETURN-TRAN.
 24302
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 449
* EL6311.cbl
 24304
 24305******************************************************************
 24306*                                                                *
 24307*           U T I L I T Y   R O U T I N E S                      *
 24308*                                                                *
 24309******************************************************************
 24310
 24311 8300-SEND-TEXT.
 24312
 24313* EXEC CICS SEND TEXT
 24314*        FROM     (LOGOFF-TEXT)
 24315*        LENGTH   (LOGOFF-LENGTH)
 24316*        ERASE
 24317*        FREEKB
 24318*    END-EXEC.
 24319*    MOVE '8&      T  E F  H   F -   #00020443' TO DFHEIV0
 24320     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24321     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24322     MOVE X'2020233030303230343433' TO DFHEIV0(25:11)
 24323     CALL 'kxdfhei1' USING DFHEIV0,
 24324           LOGOFF-TEXT,
 24325           LOGOFF-LENGTH,
 24326           DFHEIV99,
 24327           DFHEIV99,
 24328           DFHEIV99,
 24329           DFHEIV99,
 24330           DFHEIV99,
 24331           DFHEIV99,
 24332           DFHEIV99,
 24333           DFHEIV99,
 24334           DFHEIV99,
 24335           DFHEIV99
 24336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24337
 24338
 24339
 24340* EXEC CICS RETURN
 24341*    END-EXEC.
 24342*    MOVE '.(                    ''   #00020450' TO DFHEIV0
 24343     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24344     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24345     MOVE X'2020233030303230343530' TO DFHEIV0(25:11)
 24346     CALL 'kxdfhei1' USING DFHEIV0,
 24347           DFHEIV99,
 24348           DFHEIV99,
 24349           DFHEIV99,
 24350           DFHEIV99,
 24351           DFHEIV99,
 24352           DFHEIV99
 24353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24354
 24355
 24356 8400-LOG-JOURNAL-RECORD.
 24357     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24358     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24359
 24360*    EXEC CICS JOURNAL
 24361*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 450
* EL6311.cbl
 24362*        JTYPEID     ('EL')
 24363*        FROM        (JOURNAL-RECORD)
 24364*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24365*    END-EXEC.
 24366
 24367 8600-DEEDIT.
 24368
 24369* EXEC CICS BIF DEEDIT
 24370*         FIELD   (DEEDIT-FIELD)
 24371*         LENGTH  (15)
 24372*    END-EXEC.
 24373     MOVE 15
 24374       TO DFHEIV11
 24375*    MOVE '@"L                   #   #00020465' TO DFHEIV0
 24376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24378     MOVE X'2020233030303230343635' TO DFHEIV0(25:11)
 24379     CALL 'kxdfhei1' USING DFHEIV0,
 24380           DEEDIT-FIELD,
 24381           DFHEIV11
 24382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24383
 24384
 24385 8800-UNAUTHORIZED-ACCESS.
 24386     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24387     GO TO 8300-SEND-TEXT.
 24388
 24389 8810-PF23.
 24390     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24391     MOVE XCTL-EL005             TO PGM-NAME.
 24392     GO TO 9300-XCTL.
 24393
 24394 9100-RETURN-TRAN.
 24395     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24396
 24397     IF  PI-MAP-NAME =  EL631B
 24398         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24399
 24400     IF  PI-MAP-NAME =  EL631C
 24401         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24402
 24403     IF  PI-MAP-NAME =  EL631D
 24404         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24405
 24406
 24407* EXEC CICS RETURN
 24408*        TRANSID    (TRANS-EXB1)
 24409*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24410*        LENGTH     (1300)
 24411*    END-EXEC.
 24412     MOVE 1300
 24413       TO DFHEIV11
 24414*    MOVE '.(CT                  ''   #00020491' TO DFHEIV0
 24415     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24417     MOVE X'2020233030303230343931' TO DFHEIV0(25:11)
 24418     CALL 'kxdfhei1' USING DFHEIV0,
 24419           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 451
* EL6311.cbl
 24420           PROGRAM-INTERFACE-BLOCK,
 24421           DFHEIV11,
 24422           DFHEIV99,
 24423           DFHEIV99,
 24424           DFHEIV99
 24425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24426
 24427
 24428 9200-RETURN-MAIN-MENU.
 24429     MOVE XCTL-EL626             TO PGM-NAME.
 24430     GO TO 9300-XCTL.
 24431
 24432 9300-XCTL.
 24433
 24434* EXEC CICS XCTL
 24435*        PROGRAM    (PGM-NAME)
 24436*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24437*        LENGTH     (PI-COMM-LENGTH)
 24438*    END-EXEC.
 24439*    MOVE '.$C                   %   #00020502' TO DFHEIV0
 24440     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24441     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24442     MOVE X'2020233030303230353032' TO DFHEIV0(25:11)
 24443     CALL 'kxdfhei1' USING DFHEIV0,
 24444           PGM-NAME,
 24445           PROGRAM-INTERFACE-BLOCK,
 24446           PI-COMM-LENGTH,
 24447           DFHEIV99
 24448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24449
 24450
 24451 9400-CLEAR.
 24452     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24453     GO TO 9300-XCTL.
 24454
 24455 9500-PF12.
 24456     MOVE XCTL-EL010             TO PGM-NAME.
 24457     GO TO 9300-XCTL.
 24458
 24459 9600-PGMID-ERROR.
 24460
 24461* EXEC CICS HANDLE CONDITION
 24462*        PGMIDERR    (8300-SEND-TEXT)
 24463*    END-EXEC.
 24464*    MOVE '"$L                   ! \ #00020517' TO DFHEIV0
 24465     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24467     MOVE X'5C20233030303230353137' TO DFHEIV0(25:11)
 24468     CALL 'kxdfhei1' USING DFHEIV0
 24469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24470
 24471
 24472     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24473     MOVE ' '                    TO PI-ENTRY-CD-1.
 24474     MOVE XCTL-EL005             TO PGM-NAME.
 24475     MOVE PGM-NAME               TO LOGOFF-PGM.
 24476     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24477     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 452
* EL6311.cbl
 24478
 24479 9700-DATE-LINK.
 24480     MOVE LINK-ELDATCV           TO PGM-NAME.
 24481
 24482* EXEC CICS LINK
 24483*        PROGRAM    (PGM-NAME)
 24484*        COMMAREA   (DATE-CONVERSION-DATA)
 24485*        LENGTH     (DC-COMM-LENGTH)
 24486*    END-EXEC.
 24487*    MOVE '."C                   (   #00020530' TO DFHEIV0
 24488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24490     MOVE X'2020233030303230353330' TO DFHEIV0(25:11)
 24491     CALL 'kxdfhei1' USING DFHEIV0,
 24492           PGM-NAME,
 24493           DATE-CONVERSION-DATA,
 24494           DC-COMM-LENGTH,
 24495           DFHEIV99,
 24496           DFHEIV99,
 24497           DFHEIV99,
 24498           DFHEIV99
 24499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24500
 24501
 24502 9800-LINK-PENDING-EDIT.
 24503     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24504     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24505
 24506     MOVE LINK-EL050             TO PGM-NAME
 24507     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24508     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24509                                    WK-CO-TOL-CLAIM
 24510                                    WK-CO-TOL-PREM
 24511                                    WK-CO-TOL-REFUND
 24512                                    WK-CO-TOL-PREM-PCT
 24513                                    WK-CO-TOL-REFUND-PCT
 24514                                    WK-REFUND-OVS-AMT
 24515                                    WK-REFUND-OVS-PCT
 24516                                    WK-ACCT-ADDR
 24517                                    WK-LIFE-EDIT-ADDR
 24518                                    WK-AH-EDIT-ADDR
 24519                                    WK-LIFE-BEN-ADDR
 24520                                    WK-AH-BEN-ADDR
 24521                                    WK-STATE-ADDR
 24522                                    WK-PLAN-ADDR
 24523                                    WK-FORM-ADDR
 24524     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24525
 24526     MOVE '6'                    TO WK-ENTRY-SW.
 24527
 24528     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24529
 24530     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24531                                    EC-AM-EXPIRATION-DT
 24532                                    EC-AM-EFFECTIVE-DT
 24533                                    EC-CM-LF-CANCEL-DT
 24534                                    EC-CM-AH-CANCEL-DT
 24535                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 453
* EL6311.cbl
 24536
 24537     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24538                                    EC-CO-TOL-REFUND
 24539                                    EC-CO-MIN-AGE
 24540                                    EC-CO-MIN-PREMIUM
 24541                                    EC-CO-MIN-TERM
 24542                                    EC-CO-MAX-TERM
 24543                                    EC-ST-TOL-PREM
 24544                                    EC-ST-TOL-REFUND
 24545                                    EC-AM-LF-TOL-PREM
 24546                                    EC-AM-AH-TOL-PREM
 24547                                    EC-AM-LF-MAX-ATT-AGE
 24548                                    EC-AM-LF-MAX-AGE
 24549                                    EC-AM-LF-MAX-TERM
 24550                                    EC-AM-LF-MAX-TOT-BEN
 24551                                    EC-AM-AH-MAX-ATT-AGE
 24552                                    EC-AM-AH-MAX-AGE
 24553                                    EC-AM-AH-MAX-TERM
 24554                                    EC-AM-AH-MAX-TOT-BEN
 24555                                    EC-AM-AH-MAX-MON-BEN
 24556                                    EC-RT-LF-MAX-ATT-AGE
 24557                                    EC-RT-LF-MAX-AGE
 24558                                    EC-RT-LF-MAX-TERM
 24559                                    EC-RT-LF-MAX-TOT-BEN
 24560                                    EC-RT-AH-MAX-ATT-AGE
 24561                                    EC-RT-AH-MAX-AGE
 24562                                    EC-RT-AH-MAX-TERM
 24563                                    EC-RT-AH-MAX-TOT-BEN
 24564                                    EC-RT-AH-MAX-MON-BEN
 24565                                    EC-RT-AH-RATE
 24566                                    EC-RT-LF-RATE
 24567                                    EC-RT-LF-NSP-RATE
 24568                                    EC-RT-AH-NSP-RATE
 24569                                    EC-CM-LF-PRIOR-REFUND
 24570                                    EC-CM-AH-PRIOR-REFUND.
 24571
 24572     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24573                                    EC-ST-TOL-PREM-PCT
 24574                                    EC-AM-LF-TOL-REFUND
 24575                                    EC-AM-LF-DEV-PERCENT
 24576                                    EC-CO-TOL-REFUND-PCT
 24577                                    EC-ST-TOL-REFUND-PCT
 24578                                    EC-AM-AH-TOL-REFUND
 24579                                    EC-AM-AH-DEV-PERCENT.
 24580
 24581
 24582* EXEC CICS LINK
 24583*         PROGRAM   (PGM-NAME)
 24584*         COMMAREA  (PASSED-RECORD)
 24585*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24586*    END-EXEC.
 24587*    MOVE '."C                   (   #00020615' TO DFHEIV0
 24588     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24590     MOVE X'2020233030303230363135' TO DFHEIV0(25:11)
 24591     CALL 'kxdfhei1' USING DFHEIV0,
 24592           PGM-NAME,
 24593           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 454
* EL6311.cbl
 24594           WS-EDIT-PASS-LENGTH,
 24595           DFHEIV99,
 24596           DFHEIV99,
 24597           DFHEIV99,
 24598           DFHEIV99
 24599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24600
 24601
 24602     MOVE '1'                    TO PI-EDIT-SW.
 24603     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24604
 24605     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24606
 24607     IF PI-COMPANY-ID = 'UCL'
 24608         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24609
 24610     IF VALID-PB-ID
 24611        GO TO 9800-EXIT.
 24612
 24613     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24614
 24615     IF PI-MAP-NAME = EL631B
 24616        MOVE -1                  TO BMAINTL
 24617       ELSE
 24618        MOVE -1                  TO CMAINTL.
 24619
 24620     GO TO 8200-SEND-DATAONLY.
 24621
 24622 9800-EXIT.
 24623      EXIT.
 24624
 24625 9900-ERROR-FORMAT.
 24626
 24627     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24628
 24629     IF NOT EMI-ERRORS-COMPLETE
 24630         MOVE LINK-EL001         TO PGM-NAME
 24631
 24632* EXEC CICS LINK
 24633*            PROGRAM    (PGM-NAME)
 24634*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24635*            LENGTH     (EMI-COMM-LENGTH)
 24636*        END-EXEC.
 24637*    MOVE '."C                   (   #00020650' TO DFHEIV0
 24638     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24640     MOVE X'2020233030303230363530' TO DFHEIV0(25:11)
 24641     CALL 'kxdfhei1' USING DFHEIV0,
 24642           PGM-NAME,
 24643           ERROR-MESSAGE-INTERFACE-BLOCK,
 24644           EMI-COMM-LENGTH,
 24645           DFHEIV99,
 24646           DFHEIV99,
 24647           DFHEIV99,
 24648           DFHEIV99
 24649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24650
 24651
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 455
* EL6311.cbl
 24652 9900-EXIT.
 24653     EXIT.
 24654
 24655 9990-ABEND.
 24656     MOVE LINK-EL004             TO PGM-NAME.
 24657     MOVE DFHEIBLK               TO EMI-LINE1.
 24658
 24659* EXEC CICS LINK
 24660*        PROGRAM   (PGM-NAME)
 24661*        COMMAREA  (EMI-LINE1)
 24662*        LENGTH    (72)
 24663*    END-EXEC.
 24664     MOVE 72
 24665       TO DFHEIV11
 24666*    MOVE '."C                   (   #00020662' TO DFHEIV0
 24667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24669     MOVE X'2020233030303230363632' TO DFHEIV0(25:11)
 24670     CALL 'kxdfhei1' USING DFHEIV0,
 24671           PGM-NAME,
 24672           EMI-LINE1,
 24673           DFHEIV11,
 24674           DFHEIV99,
 24675           DFHEIV99,
 24676           DFHEIV99,
 24677           DFHEIV99
 24678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24679
 24680
 24681     IF PI-MAP-NAME = EL631B
 24682        MOVE -1                  TO BMAINTL
 24683       ELSE
 24684        MOVE -1                  TO CMAINTL.
 24685
 24686     IF EIBTRNID NOT = TRANS-EXB1
 24687        GO TO 8100-SEND-INITIAL-MAP
 24688       ELSE
 24689        GO TO 8200-SEND-DATAONLY.
 24690
 24691 9995-SECURITY-VIOLATION.
 24692*                            COPY ELCSCTP.
 24693******************************************************************
 24694*                                                                *
 24695*                            ELCSCTP                             *
 24696*                            VMOD=2.001                          *
 24697*                                                                *
 24698*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24699******************************************************************
 24700
 24701
 24702     MOVE EIBDATE          TO SM-JUL-DATE.
 24703     MOVE EIBTRMID         TO SM-TERMID.
 24704     MOVE THIS-PGM         TO SM-PGM.
 24705     MOVE EIBTIME          TO TIME-IN.
 24706     MOVE TIME-OUT         TO SM-TIME.
 24707     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24708
 24709
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 456
* EL6311.cbl
 24710* EXEC CICS LINK
 24711*         PROGRAM  ('EL003')
 24712*         COMMAREA (SECURITY-MESSAGE)
 24713*         LENGTH   (80)
 24714*    END-EXEC.
 24715     MOVE 'EL003' TO DFHEIV1
 24716     MOVE 80
 24717       TO DFHEIV11
 24718*    MOVE '."C                   (   #00020696' TO DFHEIV0
 24719     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24721     MOVE X'2020233030303230363936' TO DFHEIV0(25:11)
 24722     CALL 'kxdfhei1' USING DFHEIV0,
 24723           DFHEIV1,
 24724           SECURITY-MESSAGE,
 24725           DFHEIV11,
 24726           DFHEIV99,
 24727           DFHEIV99,
 24728           DFHEIV99,
 24729           DFHEIV99
 24730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24731
 24732
 24733******************************************************************
 24734
 24735
 24736 9999-DFHBACK SECTION.
 24737     MOVE '9%                    "   ' TO DFHEIV0
 24738     MOVE 'EL6311' TO DFHEIV1
 24739     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24740     GOBACK.
 24741 9999-DFHEXIT.
 24742     IF DFHEIGDJ EQUAL 0001
 24743         NEXT SENTENCE
 24744     ELSE IF DFHEIGDJ EQUAL 2
 24745         GO TO 9600-PGMID-ERROR,
 24746               9990-ABEND,
 24747               9990-ABEND,
 24748               0010-MAIN-LOGIC
 24749         DEPENDING ON DFHEIGDI
 24750     ELSE IF DFHEIGDJ EQUAL 3
 24751         GO TO 1280-BATCH-HDR-NOT-FOUND
 24752         DEPENDING ON DFHEIGDI
 24753     ELSE IF DFHEIGDJ EQUAL 4
 24754         GO TO 1290-DUPLICATE-ALT-INDEX
 24755         DEPENDING ON DFHEIGDI
 24756     ELSE IF DFHEIGDJ EQUAL 5
 24757         GO TO 1295-CERT-TRL-REC-NOTFND
 24758         DEPENDING ON DFHEIGDI
 24759     ELSE IF DFHEIGDJ EQUAL 6
 24760         GO TO 1380-BATCH-HDR-NOT-FOUND
 24761         DEPENDING ON DFHEIGDI
 24762     ELSE IF DFHEIGDJ EQUAL 7
 24763         GO TO 1385-REC-NOT-FOUND
 24764         DEPENDING ON DFHEIGDI
 24765     ELSE IF DFHEIGDJ EQUAL 8
 24766         GO TO 1386-NOTFND
 24767         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 457
* EL6311.cbl
 24768     ELSE IF DFHEIGDJ EQUAL 9
 24769         GO TO 1399-EXIT
 24770         DEPENDING ON DFHEIGDI
 24771     ELSE IF DFHEIGDJ EQUAL 10
 24772         GO TO 1480-BATCH-HDR-NOT-FOUND
 24773         DEPENDING ON DFHEIGDI
 24774     ELSE IF DFHEIGDJ EQUAL 11
 24775         GO TO 1490-RECORD-NOT-FOUND
 24776         DEPENDING ON DFHEIGDI
 24777     ELSE IF DFHEIGDJ EQUAL 12
 24778         GO TO 1405-DELETE-CERTIFICATE
 24779         DEPENDING ON DFHEIGDI
 24780     ELSE IF DFHEIGDJ EQUAL 13
 24781         GO TO 1420-CONTINUE-DELETE
 24782         DEPENDING ON DFHEIGDI
 24783     ELSE IF DFHEIGDJ EQUAL 14
 24784         GO TO 1406-DELETE-ERNOTE
 24785         DEPENDING ON DFHEIGDI
 24786     ELSE IF DFHEIGDJ EQUAL 15
 24787         GO TO 1407-DELETE-MAILING
 24788         DEPENDING ON DFHEIGDI
 24789     ELSE IF DFHEIGDJ EQUAL 16
 24790         GO TO 1420-CONTINUE-DELETE
 24791         DEPENDING ON DFHEIGDI
 24792     ELSE IF DFHEIGDJ EQUAL 17
 24793         GO TO 1480-BATCH-HDR-NOT-FOUND
 24794         DEPENDING ON DFHEIGDI
 24795     ELSE IF DFHEIGDJ EQUAL 18
 24796         GO TO 1475-DELETE-FINISHED
 24797         DEPENDING ON DFHEIGDI
 24798     ELSE IF DFHEIGDJ EQUAL 19
 24799         GO TO 2280-BATCH-HDR-NOT-FOUND
 24800         DEPENDING ON DFHEIGDI
 24801     ELSE IF DFHEIGDJ EQUAL 20
 24802         GO TO 2290-DUPLICATE-ALT-INDEX
 24803         DEPENDING ON DFHEIGDI
 24804     ELSE IF DFHEIGDJ EQUAL 21
 24805         GO TO 2380-BATCH-HDR-NOT-FOUND
 24806         DEPENDING ON DFHEIGDI
 24807     ELSE IF DFHEIGDJ EQUAL 22
 24808         GO TO 2385-REC-NOT-FOUND
 24809         DEPENDING ON DFHEIGDI
 24810     ELSE IF DFHEIGDJ EQUAL 23
 24811         GO TO 2380-BATCH-HDR-NOT-FOUND
 24812         DEPENDING ON DFHEIGDI
 24813     ELSE IF DFHEIGDJ EQUAL 24
 24814         GO TO 2485-BATCH-HDR-NOT-FOUND
 24815         DEPENDING ON DFHEIGDI
 24816     ELSE IF DFHEIGDJ EQUAL 25
 24817         GO TO 2490-RECORD-NOT-FOUND
 24818         DEPENDING ON DFHEIGDI
 24819     ELSE IF DFHEIGDJ EQUAL 26
 24820         GO TO 2475-CONTINUE-DELETE
 24821         DEPENDING ON DFHEIGDI
 24822     ELSE IF DFHEIGDJ EQUAL 27
 24823         GO TO 2485-BATCH-HDR-NOT-FOUND
 24824         DEPENDING ON DFHEIGDI
 24825     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 458
* EL6311.cbl
 24826         GO TO 2480-DELETE-FINISHED
 24827         DEPENDING ON DFHEIGDI
 24828     ELSE IF DFHEIGDJ EQUAL 29
 24829         GO TO 2820-PROCESS-REWRITE
 24830         DEPENDING ON DFHEIGDI
 24831     ELSE IF DFHEIGDJ EQUAL 30
 24832         GO TO 2885-RECORD-MISSING
 24833         DEPENDING ON DFHEIGDI
 24834     ELSE IF DFHEIGDJ EQUAL 31
 24835         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24836         DEPENDING ON DFHEIGDI
 24837     ELSE IF DFHEIGDJ EQUAL 32
 24838         GO TO 2827-DELETE-MAILING
 24839         DEPENDING ON DFHEIGDI
 24840     ELSE IF DFHEIGDJ EQUAL 33
 24841         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24842         DEPENDING ON DFHEIGDI
 24843     ELSE IF DFHEIGDJ EQUAL 34
 24844         GO TO 2920-PROCESS-REWRITE
 24845         DEPENDING ON DFHEIGDI
 24846     ELSE IF DFHEIGDJ EQUAL 35
 24847         GO TO 2985-RECORD-MISSING
 24848         DEPENDING ON DFHEIGDI
 24849     ELSE IF DFHEIGDJ EQUAL 36
 24850         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24851         DEPENDING ON DFHEIGDI
 24852     ELSE IF DFHEIGDJ EQUAL 37
 24853         GO TO 2990-DUPLICATE-RECORD
 24854         DEPENDING ON DFHEIGDI
 24855     ELSE IF DFHEIGDJ EQUAL 38
 24856         GO TO 3590-NOT-FOUND
 24857         DEPENDING ON DFHEIGDI
 24858     ELSE IF DFHEIGDJ EQUAL 39
 24859         GO TO 3690-NOT-FOUND
 24860         DEPENDING ON DFHEIGDI
 24861     ELSE IF DFHEIGDJ EQUAL 40
 24862         GO TO 3990-NOT-FOUND
 24863         DEPENDING ON DFHEIGDI
 24864     ELSE IF DFHEIGDJ EQUAL 41
 24865         GO TO 4050-END-RECORDS,
 24866               4050-END-RECORDS
 24867         DEPENDING ON DFHEIGDI
 24868     ELSE IF DFHEIGDJ EQUAL 42
 24869         GO TO 4150-END-BATCH
 24870         DEPENDING ON DFHEIGDI
 24871     ELSE IF DFHEIGDJ EQUAL 43
 24872         GO TO 4150-END-BATCH
 24873         DEPENDING ON DFHEIGDI
 24874     ELSE IF DFHEIGDJ EQUAL 44
 24875         GO TO 4250-END-RECORDS,
 24876               4250-END-RECORDS
 24877         DEPENDING ON DFHEIGDI
 24878     ELSE IF DFHEIGDJ EQUAL 45
 24879         GO TO 4350-END-BATCH,
 24880               4350-END-BATCH
 24881         DEPENDING ON DFHEIGDI
 24882     ELSE IF DFHEIGDJ EQUAL 46
 24883         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:41 Page 459
* EL6311.cbl
 24884               4550-END-RECORDS
 24885         DEPENDING ON DFHEIGDI
 24886     ELSE IF DFHEIGDJ EQUAL 47
 24887         GO TO 4680-NOT-FOUND,
 24888               4680-NOT-FOUND
 24889         DEPENDING ON DFHEIGDI
 24890     ELSE IF DFHEIGDJ EQUAL 48
 24891         GO TO 4860-NOT-FOUND,
 24892               4850-END-RECORDS
 24893         DEPENDING ON DFHEIGDI
 24894     ELSE IF DFHEIGDJ EQUAL 49
 24895         GO TO 4970-NOT-FOUND,
 24896               4950-END-RECORDS
 24897         DEPENDING ON DFHEIGDI
 24898     ELSE IF DFHEIGDJ EQUAL 50
 24899         GO TO 5050-NOT-FOUND
 24900         DEPENDING ON DFHEIGDI
 24901     ELSE IF DFHEIGDJ EQUAL 51
 24902         GO TO 5050-NOT-FOUND
 24903         DEPENDING ON DFHEIGDI
 24904     ELSE IF DFHEIGDJ EQUAL 52
 24905         GO TO 5050-NOT-FOUND
 24906         DEPENDING ON DFHEIGDI
 24907     ELSE IF DFHEIGDJ EQUAL 53
 24908         GO TO 5550-END-RECORDS,
 24909               5550-END-RECORDS
 24910         DEPENDING ON DFHEIGDI
 24911     ELSE IF DFHEIGDJ EQUAL 54
 24912         GO TO 6050-QID-ERROR
 24913         DEPENDING ON DFHEIGDI
 24914     ELSE IF DFHEIGDJ EQUAL 55
 24915         GO TO 6050-QID-ERROR
 24916         DEPENDING ON DFHEIGDI
 24917     ELSE IF DFHEIGDJ EQUAL 56
 24918         GO TO 6400-CONTINUE,
 24919               6400-CONTINUE
 24920         DEPENDING ON DFHEIGDI
 24921     ELSE IF DFHEIGDJ EQUAL 57
 24922         GO TO 3690-NOT-FOUND
 24923         DEPENDING ON DFHEIGDI
 24924     ELSE IF DFHEIGDJ EQUAL 58
 24925         GO TO 7399-EXIT
 24926         DEPENDING ON DFHEIGDI
 24927     ELSE IF DFHEIGDJ EQUAL 59
 24928         GO TO 7550-OFFICER-NOTFND
 24929         DEPENDING ON DFHEIGDI
 24930     ELSE IF DFHEIGDJ EQUAL 60
 24931         GO TO 8300-SEND-TEXT
 24932         DEPENDING ON DFHEIGDI.
 24933     MOVE '9%                    "   ' TO DFHEIV0
 24934     MOVE 'EL6311' TO DFHEIV1
 24935     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24936     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15028     Code:       98735
