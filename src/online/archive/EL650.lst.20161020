* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44* 111513  IR2013110500003  PEMA  CORRECT MAINT FUNC OF "N"
    45* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    46* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    47* 052716  CR2016052600003  PEMA  Correct "D" delete processing
    48******************************************************************
    49
    50 ENVIRONMENT DIVISION.
    51 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   3
* EL650.cbl
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC  X(32) VALUE '********************************'.
    56 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    57 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    58 77  d1                      pic s999 value +0 comp-3.
    59
    60 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    61
    62 01  ws-display-eff-date     pic x(10) value spaces.
    63 01  ws-display-exp-date     pic x(10) value spaces.
    64 01  WS-DATE-AREA.
    65     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    66     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    67
    68 01  STANDARD-AREAS.
    69     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    70     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    71     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    72     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    73     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    74     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    75     12  vp6311-trans-id         pic  x(4)   value 'VPB1'.
    76     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    77     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    78     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    79     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    80     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    81     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    82     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    83     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    84     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    85     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    86     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    87     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    88     12  PGM-NAME                PIC  X(8).
    89     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    90     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    91     12  TIME-OUT-R  REDEFINES  TIME-IN.
    92         16  FILLER              PIC  X.
    93         16  TIME-OUT            PIC  99V99.
    94         16  FILLER              PIC  XX.
    95     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    96     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    97     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    98     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    99     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
   100     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
   101     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
   102     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
   103     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
   104     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
   105     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
   106     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
   107     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   108     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   109     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   110     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   4
* EL650.cbl
   111     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
   112     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   113     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   114     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
   115     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   116     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   117     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   118     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   119     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   120     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   121     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   122     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   123     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   124     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   125     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   126     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   127     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   128     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   129     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   130     12  B4-ACCT-KEY.
   131         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   132         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   133         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   134         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   135         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   136         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   137         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   138     12  AF-ACCT-KEY.
   139         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   140         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   141         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   142         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   143         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   144         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   145         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   146     12  GX-AM-CONTROL-PRIMARY.
   147         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   148         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   149         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   5
* EL650.cbl
   151*                                copy ERCGXRF.
   152******************************************************************
   153*                                                                *
   154*                                                                *
   155*                            ERCGXRF                             *
   156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   157*                            VMOD=2.002                          *
   158*                                                                *
   159*   ONLINE CREDIT SYSTEM                                         *
   160*                                                                *
   161*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   162*                                                                *
   163*   FILE TYPE = VSAM,KSDS                                        *
   164*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   165*                                                                *
   166*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   167*       ALTERNATE PATH = NONE                                    *
   168*                                                                *
   169*   LOG = NO                                                     *
   170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   171*                                                                *
   172******************************************************************
   173
   174 01  AGENT-CROSS-REFERENCE.
   175     12  GX-RECORD-ID                PIC XX.
   176         88  VALID-GX-ID             VALUE 'GX'.
   177
   178     12  GX-CONTROL-PRIMARY.
   179         16  GX-COMPANY-CD           PIC X.
   180         16  GX-CARRIER              PIC X.
   181         16  GX-GROUPING             PIC X(6).
   182         16  GX-AGENT-NO             PIC X(10).
   183
   184     12  GX-MAINT-INFORMATION.
   185         16  GX-LAST-MAINT-DT        PIC XX.
   186         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   187         16  GX-LAST-MAINT-USER      PIC X(4).
   188         16  FILLER                  PIC X(9).
   189
   190     12  FILLER                      PIC X(37).
   191
   192     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   193
   194     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   195                            DEPENDING ON GX-AGENT-POINTER-CNT.
   196         16  GX-AM-CARRIER           PIC X.
   197         16  GX-AM-GROUPING          PIC X(6).
   198         16  GX-AM-STATE             PIC XX.
   199         16  GX-AM-ACCOUNT           PIC X(10).
   200         16  GX-AM-EXPIRATION-DT     PIC XX.
   201         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   202         16  GX-LAST-BILL-DT         PIC XX.
   203         16  GX-AM-EFF-DT            PIC XX.
   204         16  FILLER                  PIC X(4).
   205
   206******************************************************************
   207 01  WORK-AREAS-AND-SWITCHES.
   208     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   6
* EL650.cbl
   209     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   210     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   211     12  NEW-KEY-SAVE.
   212         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   213         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   214     12  WS-PLAN-KEY.
   215         16  EK-CCGSA-KEY.
   216           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   217           18  EK-CARRIER            PIC  X     VALUE SPACES.
   218           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   219           18  EK-STATE              PIC  XX    VALUE SPACES.
   220           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   221         16  EK-BTYPE                PIC  X     VALUE SPACES.
   222         16  EK-BCODE                PIC  XX    VALUE SPACES.
   223         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   224     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   225     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   226     12  SAVE-ACCT-KEY               PIC  X(26).
   227     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   228     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   229     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   230     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   231     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   232     12  WS-VERIFY-AREA.
   233         16  FILLER      OCCURS  33  TIMES
   234                             INDEXED  BY  WS-INDEX.
   235             20  WS-ACCT-KEY         PIC  X(20).
   236             20  WS-ACCT-EXP-DT      PIC  XX.
   237             20  WS-ACCT-EFF-DT      PIC  XX.
   238             20  WS-ACCT-HI-CERT     PIC  XX.
   239             20  WS-ACCT-LO-CERT     PIC  XX.
   240     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   241     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   242     12  WS-ACCT-VERIFY-KEY.
   243         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   244         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   245         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   246         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   247         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   248         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   249     12  filler                      pic x(10)   value spaces.
   250     12  KEY-SAVE.
   251         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   252         16  SV-CARRIER              PIC  X      VALUE SPACES.
   253         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   254         16  SV-STATE                PIC  XX     VALUE SPACES.
   255         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   256
   257     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   258     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   259                                      PIC X(10).
   260     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   261         16  FILLER                   PIC X(4).
   262         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   263
   264     12  WS-AXRF-KEY.
   265         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   266         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   7
* EL650.cbl
   267         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   268         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   269     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   270     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   271     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   272     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   273     12  ELCNTL-KEY.
   274         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   275         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   276         16  CNTL-ACCESS.
   277             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   278             20  FILLER              PIC  X    VALUE SPACES.
   279             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   280         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   281     12  ERPNDB-KEY.
   282         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   283         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   284         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   285         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   286         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   287         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   288         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   289         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   290         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   291     12  REC-SW                      PIC  9          VALUE 0.
   292         88  REC-FOUND                               VALUE 1.
   293     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   294         88  K-WITH-LINE-NO                          VALUE 1.
   295     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   296         88  RETURNING-FROM-6501                     VALUE 1.
   297     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   298         88  BROWSE-STARTED                          VALUE 'Y'.
   299     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   300         88  FIRST-TIME                              VALUE 'Y'.
   301     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   302         88  FROM-DELETE                             VALUE '1'.
   303         88  FROM-CHANGE                             VALUE '2'.
   304     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   305     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   306         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   307     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   308         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   309     12  TS-QUEUE.
   310         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   311         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   312     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   313     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   314     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   315     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   316
   317 01  ERROR-MESSAGES.
   318     12  ER-0000             PIC  X(4)       VALUE '0000'.
   319     12  ER-0004             PIC  X(4)       VALUE '0004'.
   320     12  ER-0008             PIC  X(4)       VALUE '0008'.
   321     12  ER-0022             PIC  X(4)       VALUE '0022'.
   322     12  ER-0023             PIC  X(4)       VALUE '0023'.
   323     12  ER-0029             PIC  X(4)       VALUE '0029'.
   324     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   8
* EL650.cbl
   325     12  ER-0050             PIC  X(4)       VALUE '0050'.
   326     12  ER-0052             PIC  X(4)       VALUE '0052'.
   327     12  ER-0066             PIC  X(4)       VALUE '0066'.
   328     12  ER-0067             PIC  X(4)       VALUE '0067'.
   329     12  ER-0070             PIC  X(4)       VALUE '0070'.
   330     12  ER-0144             PIC  X(4)       VALUE '0144'.
   331     12  ER-0168             PIC  X(4)       VALUE '0168'.
   332     12  ER-0193             PIC  X(4)       VALUE '0193'.
   333     12  ER-0195             PIC  X(4)       VALUE '0195'.
   334     12  ER-0216             PIC  X(4)       VALUE '0216'.
   335     12  ER-0226             PIC  X(4)       VALUE '0226'.
   336     12  ER-0348             PIC  X(4)       VALUE '0348'.
   337     12  ER-0453             PIC  X(4)       VALUE '0453'.
   338     12  ER-0454             PIC  X(4)       VALUE '0454'.
   339     12  ER-0455             PIC  X(4)       VALUE '0455'.
   340     12  ER-0456             PIC  X(4)       VALUE '0456'.
   341     12  ER-0457             PIC  X(4)       VALUE '0457'.
   342     12  ER-0470             PIC  X(4)       VALUE '0470'.
   343     12  ER-0471             PIC  X(4)       VALUE '0471'.
   344     12  ER-0472             PIC  X(4)       VALUE '0472'.
   345     12  ER-0482             PIC  X(4)       VALUE '0482'.
   346     12  ER-0561             PIC  X(4)       VALUE '0561'.
   347     12  ER-0619             PIC  X(4)       VALUE '0619'.
   348     12  ER-0630             PIC  X(4)       VALUE '0630'.
   349     12  ER-0668             PIC  X(4)       VALUE '0668'.
   350     12  ER-0899             PIC  X(4)       VALUE '0899'.
   351     12  ER-1220             PIC  X(4)       VALUE '1220'.
   352     12  ER-1228             PIC  X(4)       VALUE '1228'.
   353     12  ER-1238             PIC  X(4)       VALUE '1238'.
   354     12  ER-1299             PIC  X(4)       VALUE '1299'.
   355     12  ER-1612             PIC  X(4)       VALUE '1612'.
   356     12  ER-2051             PIC  X(4)       VALUE '2051'.
   357     12  ER-2052             PIC  X(4)       VALUE '2052'.
   358     12  ER-2053             PIC  X(4)       VALUE '2053'.
   359     12  ER-2054             PIC  X(4)       VALUE '2054'.
   360     12  ER-2058             PIC  X(4)       VALUE '2058'.
   361     12  ER-2059             PIC  X(4)       VALUE '2059'.
   362     12  ER-2060             PIC  X(4)       VALUE '2060'.
   363     12  ER-2061             PIC  X(4)       VALUE '2061'.
   364     12  ER-2062             PIC  X(4)       VALUE '2062'.
   365     12  ER-2063             PIC  X(4)       VALUE '2063'.
   366     12  ER-2064             PIC  X(4)       VALUE '2064'.
   367     12  ER-2065             PIC  X(4)       VALUE '2065'.
   368     12  ER-2066             PIC  X(4)       VALUE '2066'.
   369     12  ER-2068             PIC  X(4)       VALUE '2068'.
   370     12  ER-2069             PIC  X(4)       VALUE '2069'.
   371     12  ER-2070             PIC  X(4)       VALUE '2070'.
   372     12  ER-2072             PIC  X(4)       VALUE '2072'.
   373     12  ER-2073             PIC  X(4)       VALUE '2073'.
   374     12  ER-2074             PIC  X(4)       VALUE '2074'.
   375     12  ER-2075             PIC  X(4)       VALUE '2075'.
   376     12  ER-2087             PIC  X(4)       VALUE '2087'.
   377     12  ER-2113             PIC  X(4)       VALUE '2113'.
   378     12  ER-2151             PIC  X(4)       VALUE '2151'.
   379     12  ER-2370             PIC  X(4)       VALUE '2370'.
   380     12  ER-2572             PIC  X(4)       VALUE '2572'.
   381     12  ER-3155             PIC  X(4)       VALUE '3155'.
   382     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page   9
* EL650.cbl
   383     12  ER-9638             PIC  X(4)       VALUE '9638'.
   384     12  ER-9999             PIC  X(4)       VALUE '9999'.
   385
   386 01  TEMP-STORAGE-RECORD.
   387     12  TS-ACCT-KEY     OCCURS  32  TIMES
   388                             INDEXED  BY  TS-INDEX
   389                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  10
* EL650.cbl
   391*    COPY ELCSCTM.
   392******************************************************************
   393*                                                                *
   394*                                                                *
   395*                            ELCSCTM                             *
   396*                            VMOD=2.001                          *
   397*                                                                *
   398*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   399*                                                                *
   400******************************************************************
   401 01  SECURITY-MESSAGE.
   402     12  FILLER                          PIC X(30)
   403            VALUE '** LOGIC SECURITY VIOLATION -'.
   404     12  SM-READ                         PIC X(6).
   405     12  FILLER                          PIC X(5)
   406            VALUE ' PGM='.
   407     12  SM-PGM                          PIC X(6).
   408     12  FILLER                          PIC X(5)
   409            VALUE ' OPR='.
   410     12  SM-PROCESSOR-ID                 PIC X(4).
   411     12  FILLER                          PIC X(6)
   412            VALUE ' TERM='.
   413     12  SM-TERMID                       PIC X(4).
   414     12  FILLER                          PIC XX   VALUE SPACE.
   415     12  SM-JUL-DATE                     PIC 9(5).
   416     12  FILLER                          PIC X    VALUE SPACE.
   417     12  SM-TIME                         PIC 99.99.
   418
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  11
* EL650.cbl
   420*    COPY ELCSCRTY.
   421******************************************************************
   422*                                                                *
   423*                                                                *
   424*                            ELCSCRTY                            *
   425*                            VMOD=2.001                          *
   426*                                                                *
   427*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   428*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   429*        SAVED IN PI-SECURITY-ADDRESS.                           *
   430*                                                                *
   431******************************************************************
   432 01  SECURITY-CONTROL.
   433     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   434     12  FILLER                       PIC XX    VALUE 'SC'.
   435     12  SC-CREDIT-CODES.
   436         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   437             20  SC-CREDIT-DISPLAY    PIC X.
   438             20  SC-CREDIT-UPDATE     PIC X.
   439     12  SC-CLAIMS-CODES.
   440         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   441             20  SC-CLAIMS-DISPLAY    PIC X.
   442             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  12
* EL650.cbl
   444*    COPY ELCLOGOF.
   445******************************************************************
   446*                                                                *
   447*                                                                *
   448*                            ELCLOGOF.                           *
   449*                            VMOD=2.001                          *
   450*                                                                *
   451*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   452*                                                                *
   453******************************************************************
   454 01  CLASIC-LOGOFF.
   455     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   456     12  LOGOFF-TEXT.
   457         16  FILLER          PIC X(5)    VALUE SPACES.
   458         16  LOGOFF-MSG.
   459             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   460             20  FILLER      PIC X       VALUE SPACES.
   461             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   462         16  FILLER          PIC X(80)
   463           VALUE '* YOU ARE NOW LOGGED OFF'.
   464         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   465         16  FILLER          PIC X       VALUE QUOTE.
   466         16  LOGOFF-SYS-MSG  PIC X(17)
   467           VALUE 'S CLAS-IC SYSTEM '.
   468     12  TEXT-MESSAGES.
   469         16  UNACCESS-MSG    PIC X(29)
   470             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   471         16  PGMIDERR-MSG    PIC X(17)
   472             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  13
* EL650.cbl
   474*    COPY ELCDATE.
   475******************************************************************
   476*                                                                *
   477*                                                                *
   478*                            ELCDATE.                            *
   479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   480*                            VMOD=2.003
   481*                                                                *
   482*                                                                *
   483*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   484*                 LENGTH = 200                                   *
   485******************************************************************
   486
   487 01  DATE-CONVERSION-DATA.
   488     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   489     12  DC-OPTION-CODE                PIC X.
   490         88  BIN-TO-GREG                VALUE ' '.
   491         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   492         88  EDIT-GREG-TO-BIN           VALUE '2'.
   493         88  YMD-GREG-TO-BIN            VALUE '3'.
   494         88  MDY-GREG-TO-BIN            VALUE '4'.
   495         88  JULIAN-TO-BIN              VALUE '5'.
   496         88  BIN-PLUS-ELAPSED           VALUE '6'.
   497         88  FIND-CENTURY               VALUE '7'.
   498         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   499         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   500         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   501         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   502         88  JULIAN-TO-BIN-3            VALUE 'C'.
   503         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   504         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   505         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   506         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   507         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   508         88  CHECK-LEAP-YEAR            VALUE 'H'.
   509         88  BIN-3-TO-GREG              VALUE 'I'.
   510         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   511         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   512         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   513         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   514         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   515         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   516         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   517         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   518         88  THREE-CHARACTER-BIN
   519                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   520         88  GREGORIAN-TO-BIN
   521                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   522         88  BIN-TO-GREGORIAN
   523                  VALUES ' ' '1' 'I' '8' 'G'.
   524         88  JULIAN-TO-BINARY
   525                  VALUES '5' 'C' 'E' 'F'.
   526     12  DC-ERROR-CODE                 PIC X.
   527         88  NO-CONVERSION-ERROR        VALUE ' '.
   528         88  DATE-CONVERSION-ERROR
   529                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   530         88  DATE-IS-ZERO               VALUE '1'.
   531         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  14
* EL650.cbl
   532         88  DATE-IS-INVALID            VALUE '3'.
   533         88  DATE1-GREATER-DATE2        VALUE '4'.
   534         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   535         88  DATE-INVALID-OPTION        VALUE '9'.
   536         88  INVALID-CENTURY            VALUE 'A'.
   537         88  ONLY-CENTURY               VALUE 'B'.
   538         88  ONLY-LEAP-YEAR             VALUE 'C'.
   539         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   540     12  DC-END-OF-MONTH               PIC X.
   541         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   542     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   543         88  USE-NORMAL-PROCESS         VALUE ' '.
   544         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   545         88  ADJUST-UP-100-YRS          VALUE '2'.
   546     12  FILLER                        PIC X.
   547     12  DC-CONVERSION-DATES.
   548         16  DC-BIN-DATE-1             PIC XX.
   549         16  DC-BIN-DATE-2             PIC XX.
   550         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   551         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   552                       DC-GREG-DATE-1-EDIT.
   553             20  DC-EDIT1-MONTH        PIC 99.
   554             20  SLASH1-1              PIC X.
   555             20  DC-EDIT1-DAY          PIC 99.
   556             20  SLASH1-2              PIC X.
   557             20  DC-EDIT1-YEAR         PIC 99.
   558         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   559         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   560                     DC-GREG-DATE-2-EDIT.
   561             20  DC-EDIT2-MONTH        PIC 99.
   562             20  SLASH2-1              PIC X.
   563             20  DC-EDIT2-DAY          PIC 99.
   564             20  SLASH2-2              PIC X.
   565             20  DC-EDIT2-YEAR         PIC 99.
   566         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   567         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   568                     DC-GREG-DATE-1-YMD.
   569             20  DC-YMD-YEAR           PIC 99.
   570             20  DC-YMD-MONTH          PIC 99.
   571             20  DC-YMD-DAY            PIC 99.
   572         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   573         16  DC-GREG-DATE-1-MDY-R REDEFINES
   574                      DC-GREG-DATE-1-MDY.
   575             20  DC-MDY-MONTH          PIC 99.
   576             20  DC-MDY-DAY            PIC 99.
   577             20  DC-MDY-YEAR           PIC 99.
   578         16  DC-GREG-DATE-1-ALPHA.
   579             20  DC-ALPHA-MONTH        PIC X(10).
   580             20  DC-ALPHA-DAY          PIC 99.
   581             20  FILLER                PIC XX.
   582             20  DC-ALPHA-CENTURY.
   583                 24 DC-ALPHA-CEN-N     PIC 99.
   584             20  DC-ALPHA-YEAR         PIC 99.
   585         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   586         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   587         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   588         16  DC-JULIAN-DATE            PIC 9(05).
   589         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  15
* EL650.cbl
   590                                       PIC 9(05).
   591         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   592             20  DC-JULIAN-YEAR        PIC 99.
   593             20  DC-JULIAN-DAYS        PIC 999.
   594         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   595         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   596         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   597     12  DATE-CONVERSION-VARIBLES.
   598         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   599         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   600             20  FILLER                PIC 9(3).
   601             20  HOLD-CEN-1-CCYY.
   602                 24  HOLD-CEN-1-CC     PIC 99.
   603                 24  HOLD-CEN-1-YY     PIC 99.
   604             20  HOLD-CEN-1-MO         PIC 99.
   605             20  HOLD-CEN-1-DA         PIC 99.
   606         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   607             20  HOLD-CEN-1-R-MO       PIC 99.
   608             20  HOLD-CEN-1-R-DA       PIC 99.
   609             20  HOLD-CEN-1-R-CCYY.
   610                 24  HOLD-CEN-1-R-CC   PIC 99.
   611                 24  HOLD-CEN-1-R-YY   PIC 99.
   612             20  FILLER                PIC 9(3).
   613         16  HOLD-CENTURY-1-X.
   614             20  FILLER                PIC X(3)  VALUE SPACES.
   615             20  HOLD-CEN-1-X-CCYY.
   616                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   617                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   618             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   619             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   620         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   621             20  HOLD-CEN-1-R-X-MO     PIC XX.
   622             20  HOLD-CEN-1-R-X-DA     PIC XX.
   623             20  HOLD-CEN-1-R-X-CCYY.
   624                 24  HOLD-CEN-1-R-X-CC PIC XX.
   625                 24  HOLD-CEN-1-R-X-YY PIC XX.
   626             20  FILLER                PIC XXX.
   627         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   628         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   629         16  DC-JULIAN-DATE-1          PIC 9(07).
   630         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   631             20  DC-JULIAN-1-CCYY.
   632                 24  DC-JULIAN-1-CC    PIC 99.
   633                 24  DC-JULIAN-1-YR    PIC 99.
   634             20  DC-JULIAN-DA-1        PIC 999.
   635         16  DC-JULIAN-DATE-2          PIC 9(07).
   636         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   637             20  DC-JULIAN-2-CCYY.
   638                 24  DC-JULIAN-2-CC    PIC 99.
   639                 24  DC-JULIAN-2-YR    PIC 99.
   640             20  DC-JULIAN-DA-2        PIC 999.
   641         16  DC-GREG-DATE-A-EDIT.
   642             20  DC-EDITA-MONTH        PIC 99.
   643             20  SLASHA-1              PIC X VALUE '/'.
   644             20  DC-EDITA-DAY          PIC 99.
   645             20  SLASHA-2              PIC X VALUE '/'.
   646             20  DC-EDITA-CCYY.
   647                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  16
* EL650.cbl
   648                 24  DC-EDITA-YEAR     PIC 99.
   649         16  DC-GREG-DATE-B-EDIT.
   650             20  DC-EDITB-MONTH        PIC 99.
   651             20  SLASHB-1              PIC X VALUE '/'.
   652             20  DC-EDITB-DAY          PIC 99.
   653             20  SLASHB-2              PIC X VALUE '/'.
   654             20  DC-EDITB-CCYY.
   655                 24  DC-EDITB-CENT     PIC 99.
   656                 24  DC-EDITB-YEAR     PIC 99.
   657         16  DC-GREG-DATE-CYMD         PIC 9(08).
   658         16  DC-GREG-DATE-CYMD-R REDEFINES
   659                              DC-GREG-DATE-CYMD.
   660             20  DC-CYMD-CEN           PIC 99.
   661             20  DC-CYMD-YEAR          PIC 99.
   662             20  DC-CYMD-MONTH         PIC 99.
   663             20  DC-CYMD-DAY           PIC 99.
   664         16  DC-GREG-DATE-MDCY         PIC 9(08).
   665         16  DC-GREG-DATE-MDCY-R REDEFINES
   666                              DC-GREG-DATE-MDCY.
   667             20  DC-MDCY-MONTH         PIC 99.
   668             20  DC-MDCY-DAY           PIC 99.
   669             20  DC-MDCY-CEN           PIC 99.
   670             20  DC-MDCY-YEAR          PIC 99.
   671    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   672        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   673    12  DC-EL310-DATE                  PIC X(21).
   674    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  17
* EL650.cbl
   676*    COPY ELCATTR.
   677******************************************************************
   678*                                                                *
   679*                            ELCATTR.                            *
   680*                            VMOD=2.001                          *
   681*                                                                *
   682*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   683*                                                                *
   684*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   685*                                                                *
   686*                   POS 1   P=PROTECTED                          *
   687*                           U=UNPROTECTED                        *
   688*                           S=ASKIP                              *
   689*                   POS 2   A=ALPHA/NUMERIC                      *
   690*                           N=NUMERIC                            *
   691*                   POS 3   N=NORMAL                             *
   692*                           B=BRIGHT                             *
   693*                           D=DARK                               *
   694*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   695*                           OF=MODIFIED DATA TAG OFF             *
   696*                                                                *
   697*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   698******************************************************************
   699 01  ATTRIBUTE-LIST.
   700     12  AL-PABOF            PIC X       VALUE 'Y'.
   701     12  AL-PABON            PIC X       VALUE 'Z'.
   702     12  AL-PADOF            PIC X       VALUE '%'.
   703     12  AL-PADON            PIC X       VALUE '_'.
   704     12  AL-PANOF            PIC X       VALUE '-'.
   705     12  AL-PANON            PIC X       VALUE '/'.
   706     12  AL-SABOF            PIC X       VALUE '8'.
   707     12  AL-SABON            PIC X       VALUE '9'.
   708     12  AL-SADOF            PIC X       VALUE '@'.
   709     12  AL-SADON            PIC X       VALUE QUOTE.
   710     12  AL-SANOF            PIC X       VALUE '0'.
   711     12  AL-SANON            PIC X       VALUE '1'.
   712     12  AL-UABOF            PIC X       VALUE 'H'.
   713     12  AL-UABON            PIC X       VALUE 'I'.
   714     12  AL-UADOF            PIC X       VALUE '<'.
   715     12  AL-UADON            PIC X       VALUE '('.
   716     12  AL-UANOF            PIC X       VALUE ' '.
   717     12  AL-UANON            PIC X       VALUE 'A'.
   718     12  AL-UNBOF            PIC X       VALUE 'Q'.
   719     12  AL-UNBON            PIC X       VALUE 'R'.
   720     12  AL-UNDOF            PIC X       VALUE '*'.
   721     12  AL-UNDON            PIC X       VALUE ')'.
   722     12  AL-UNNOF            PIC X       VALUE '&'.
   723     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  18
* EL650.cbl
   725*    COPY ELCEMIB.
   726******************************************************************
   727*                                                                *
   728*                                                                *
   729*                            ELCEMIB.                            *
   730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   731*                            VMOD=2.005                          *
   732*                                                                *
   733*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   734*                                                                *
   735******************************************************************
   736 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   737     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   738     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   739     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   740     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   741     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   742     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   743     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   744     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   745     12  EMI-SWITCH1             PIC X        VALUE '1'.
   746         88  EMI-NO-ERRORS                    VALUE '1'.
   747         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   748         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   749     12  EMI-SWITCH2             PIC X        VALUE '1'.
   750         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   751     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   752         88  EMI-AREA1-EMPTY                  VALUE '1'.
   753         88  EMI-AREA1-FULL                   VALUE '2'.
   754     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   755         88  EMI-AREA2-EMPTY                  VALUE '1'.
   756         88  EMI-AREA2-FULL                   VALUE '2'.
   757     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   758         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   759         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   760         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   761         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   762         88  EMI-BYPASS-FATALS                VALUE 'X'.
   763     12  EMI-ERROR-LINES.
   764         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   765         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   766         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   767         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   768             20  EMI-ERR-CODES OCCURS 10 TIMES.
   769                 24  EMI-ERR-NUM         PIC X(4).
   770                 24  EMI-FILLER          PIC X.
   771                 24  EMI-SEV             PIC X.
   772                 24  FILLER              PIC X.
   773             20  FILLER                  PIC X(02).
   774     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   775         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   776             20  EMI-ERROR-NUMBER    PIC X(4).
   777             20  EMI-FILL            PIC X.
   778             20  EMI-SEVERITY        PIC X.
   779             20  FILLER              PIC X.
   780             20  EMI-ERROR-TEXT.
   781                 24  EMI-TEXT-VARIABLE   PIC X(10).
   782                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  19
* EL650.cbl
   783     12  EMI-SEVERITY-SAVE           PIC X.
   784         88  EMI-NOTE                    VALUE 'N'.
   785         88  EMI-WARNING                 VALUE 'W'.
   786         88  EMI-FORCABLE                VALUE 'F'.
   787         88  EMI-FATAL                   VALUE 'X'.
   788     12  EMI-MESSAGE-FLAG            PIC X.
   789         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   790         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   791     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   792     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   793         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   794         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   795         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   796     12  emi-claim-no                pic x(7).
   797     12  emi-claim-type              pic x(6).
   798     12  FILLER                      PIC X(124)  VALUE SPACES.
   799     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   800     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   801     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   802     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  20
* EL650.cbl
   804*    COPY ELCINTF.
   805******************************************************************
   806*                                                                *
   807*                                                                *
   808*                            ELCINTF.                            *
   809*                            VMOD=2.017                          *
   810*                                                                *
   811*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   812*                                                                *
   813*       LENGTH = 1024                                            *
   814*                                                                *
   815******************************************************************
   816*                   C H A N G E   L O G
   817*
   818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   819*-----------------------------------------------------------------
   820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   821* EFFECTIVE    NUMBER
   822*-----------------------------------------------------------------
   823* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   824******************************************************************
   825 01  PROGRAM-INTERFACE-BLOCK.
   826     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   827     12  PI-CALLING-PROGRAM              PIC X(8).
   828     12  PI-SAVED-PROGRAM-1              PIC X(8).
   829     12  PI-SAVED-PROGRAM-2              PIC X(8).
   830     12  PI-SAVED-PROGRAM-3              PIC X(8).
   831     12  PI-SAVED-PROGRAM-4              PIC X(8).
   832     12  PI-SAVED-PROGRAM-5              PIC X(8).
   833     12  PI-SAVED-PROGRAM-6              PIC X(8).
   834     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   835     12  PI-COMPANY-ID                   PIC XXX.
   836     12  PI-COMPANY-CD                   PIC X.
   837
   838     12  PI-COMPANY-PASSWORD             PIC X(8).
   839
   840     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   841
   842     12  PI-CONTROL-IN-PROGRESS.
   843         16  PI-CARRIER                  PIC X.
   844         16  PI-GROUPING                 PIC X(6).
   845         16  PI-STATE                    PIC XX.
   846         16  PI-ACCOUNT                  PIC X(10).
   847         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   848                                         PIC X(10).
   849         16  PI-CLAIM-CERT-GRP.
   850             20  PI-CLAIM-NO             PIC X(7).
   851             20  PI-CERT-NO.
   852                 25  PI-CERT-PRIME       PIC X(10).
   853                 25  PI-CERT-SFX         PIC X.
   854             20  PI-CERT-EFF-DT          PIC XX.
   855         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   856             20  PI-PLAN-CODE            PIC X(2).
   857             20  PI-REVISION-NUMBER      PIC X(3).
   858             20  PI-PLAN-EFF-DT          PIC X(2).
   859             20  PI-PLAN-EXP-DT          PIC X(2).
   860             20  FILLER                  PIC X(11).
   861         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  21
* EL650.cbl
   862             20  PI-OE-REFERENCE-1.
   863                 25  PI-OE-REF-1-PRIME   PIC X(18).
   864                 25  PI-OE-REF-1-SUFF    PIC XX.
   865
   866     12  PI-SESSION-IN-PROGRESS          PIC X.
   867         88  CLAIM-SESSION                   VALUE '1'.
   868         88  CREDIT-SESSION                  VALUE '2'.
   869         88  WARRANTY-SESSION                VALUE '3'.
   870         88  MORTGAGE-SESSION                VALUE '4'.
   871         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   872
   873
   874*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   875
   876     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   877     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   878
   879     12  PI-CREDIT-USER                  PIC X.
   880         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   881         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   882
   883     12  PI-CLAIM-USER                   PIC X.
   884         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   885         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   886
   887     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   888         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   889         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   890         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   891         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   892         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   893
   894     12  PI-PROCESSOR-ID                 PIC X(4).
   895
   896     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   897
   898     12  PI-MEMBER-CAPTION               PIC X(10).
   899
   900     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   901         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   902
   903     12  PI-LIFE-OVERRIDE-L1             PIC X.
   904     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   905     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   906     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   907
   908     12  PI-AH-OVERRIDE-L1               PIC X.
   909     12  PI-AH-OVERRIDE-L2               PIC XX.
   910     12  PI-AH-OVERRIDE-L6               PIC X(6).
   911     12  PI-AH-OVERRIDE-L12              PIC X(12).
   912
   913     12  PI-NEW-SYSTEM                   PIC X(2).
   914
   915     12  PI-PRIMARY-CERT-NO              PIC X(11).
   916     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   917         88  PI-USES-PAID-TO                 VALUE '1'.
   918     12  PI-CRDTCRD-SYSTEM.
   919         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  22
* EL650.cbl
   920             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   921             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   922         16  PI-CC-MONTH-END-DT          PIC XX.
   923     12  PI-PROCESSOR-PRINTER            PIC X(4).
   924
   925     12  PI-OE-REFERENCE-2.
   926         16  PI-OE-REF-2-PRIME           PIC X(10).
   927         16  PI-OE-REF-2-SUFF            PIC X.
   928
   929     12  PI-REM-TRM-CALC-OPTION          PIC X.
   930
   931     12  PI-LANGUAGE-TYPE                PIC X.
   932             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   933             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   934             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   935
   936     12  PI-POLICY-LINKAGE-IND           PIC X.
   937         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   938         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   939                                                   LOW-VALUES.
   940
   941     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   942     12  PI-CLAIM-PW-SESSION             PIC X(1).
   943         88  PI-CLAIM-CREDIT                 VALUE '1'.
   944         88  PI-CLAIM-CONVEN                 VALUE '2'.
   945
   946     12  PI-PROCESSOR-CSR-IND            PIC X.
   947         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   948         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   949
   950     12  FILLER                          PIC X(3).
   951
   952     12  PI-SYSTEM-LEVEL                 PIC X(145).
   953
   954     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   955         PI-SYSTEM-LEVEL.
   956
   957         16  PI-ENTRY-CODES.
   958             20  PI-ENTRY-CD-1           PIC X.
   959             20  PI-ENTRY-CD-2           PIC X.
   960
   961         16  PI-RETURN-CODES.
   962             20  PI-RETURN-CD-1          PIC X.
   963             20  PI-RETURN-CD-2          PIC X.
   964
   965         16  PI-UPDATE-STATUS-SAVE.
   966             20  PI-UPDATE-BY            PIC X(4).
   967             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   968
   969         16  PI-LOWER-CASE-LETTERS       PIC X.
   970             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   971
   972*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   973*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   974*            88  CARRIER-CLM-CNTL            VALUE '2'.
   975
   976         16  PI-CERT-ACCESS-CONTROL      PIC X.
   977             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  23
* EL650.cbl
   978             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   979             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   980             88  ACCNT-CNTL                  VALUE '3'.
   981             88  CARR-ACCNT-CNTL             VALUE '4'.
   982
   983         16  PI-PROCESSOR-CAP-LIST.
   984             20  PI-SYSTEM-CONTROLS.
   985                24 PI-SYSTEM-DISPLAY     PIC X.
   986                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   987                24 PI-SYSTEM-MODIFY      PIC X.
   988                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   989             20  FILLER                  PIC XX.
   990             20  PI-DISPLAY-CAP          PIC X.
   991                 88  DISPLAY-CAP             VALUE 'Y'.
   992             20  PI-MODIFY-CAP           PIC X.
   993                 88  MODIFY-CAP              VALUE 'Y'.
   994             20  PI-MSG-AT-LOGON-CAP     PIC X.
   995                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   996             20  PI-FORCE-CAP            PIC X.
   997                 88  FORCE-CAP               VALUE 'Y'.
   998
   999         16  PI-PROGRAM-CONTROLS.
  1000             20  PI-PGM-PRINT-OPT        PIC X.
  1001             20  PI-PGM-FORMAT-OPT       PIC X.
  1002             20  PI-PGM-PROCESS-OPT      PIC X.
  1003             20  PI-PGM-TOTALS-OPT       PIC X.
  1004
  1005         16  PI-HELP-INTERFACE.
  1006             20  PI-LAST-ERROR-NO        PIC X(4).
  1007             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1008
  1009         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1010             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1011
  1012         16  PI-CR-CONTROL-IN-PROGRESS.
  1013             20  PI-CR-CARRIER           PIC X.
  1014             20  PI-CR-GROUPING          PIC X(6).
  1015             20  PI-CR-STATE             PIC XX.
  1016             20  PI-CR-ACCOUNT           PIC X(10).
  1017             20  PI-CR-FIN-RESP          PIC X(10).
  1018             20  PI-CR-TYPE              PIC X.
  1019
  1020         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1021
  1022         16  PI-CR-MONTH-END-DT          PIC XX.
  1023
  1024         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1025             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1026             88  PI-ZERO-CARRIER             VALUE '1'.
  1027             88  PI-ZERO-GROUPING            VALUE '2'.
  1028             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1029
  1030         16  PI-CARRIER-SECURITY         PIC X.
  1031             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1032
  1033         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1034             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1035             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  24
* EL650.cbl
  1036
  1037         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1038             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1039                                         INDEXED BY PI-ACCESS-NDX
  1040                                         PIC X.
  1041
  1042         16  PI-GA-BILLING-CONTROL       PIC X.
  1043             88  PI-GA-BILLING               VALUE '1'.
  1044
  1045         16  PI-MAIL-PROCESSING          PIC X.
  1046             88  PI-MAIL-YES                 VALUE 'Y'.
  1047
  1048         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1049
  1050         16  PI-AR-SYSTEM.
  1051             20  PI-AR-PROCESSING-CNTL   PIC X.
  1052                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1053             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1054             20  PI-AR-MONTH-END-DT      PIC XX.
  1055
  1056         16  PI-MP-SYSTEM.
  1057             20  PI-MORTGAGE-USER            PIC X.
  1058                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1059                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1060             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1061                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1062                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1063                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1064                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1065                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1066             20  PI-MP-MONTH-END-DT          PIC XX.
  1067             20  PI-MP-REFERENCE-NO.
  1068                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1069                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1070
  1071         16  PI-LABEL-CONTROL            PIC X(01).
  1072             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1073             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1074
  1075         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1076             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1077
  1078         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1079             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1080             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1081
  1082         16  FILLER                      PIC X(14).
  1083
  1084     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1085******************************************************************
  1086*    COPY ELC650PI.
  1087******************************************************************
  1088*
  1089*                            ELC650PI.
  1090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1091*                            VMOD=2.007
  1092*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1093*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  25
* EL650.cbl
  1094* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1095*
  1096******************************************************************
  1097
  1098     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1099         16  PI-MAINT                   PIC X.
  1100         16  PI-PREV-ACCOUNT            PIC X(20).
  1101         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1102         16  PI-ACCT-KEY.
  1103             20  PI-ACCT-CCGSA-KEY.
  1104                 24  PI-ACCT-CO             PIC X.
  1105                 24  PI-ACCT-CARRIER        PIC X.
  1106                 24  PI-ACCT-GROUPING       PIC X(6).
  1107                 24  PI-ACCT-STATE          PIC XX.
  1108                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1109             20  PI-ACCT-EXP-DT           PIC XX.
  1110             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1111         16  PI-ACCT-ID                 PIC X(8).
  1112         16  PI-PLAN-KEY.
  1113             20  PI-PLAN-ACCT-KEY.
  1114                 24  PI-PLAN-COMPANY-CD PIC X.
  1115                 24  PI-PLAN-CARRIER    PIC X.
  1116                 24  PI-PLAN-GROUP      PIC X(6).
  1117                 24  PI-PLAN-STATE      PIC X(2).
  1118                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1119             20  PI-PLAN-BEN-TYPE       PIC X.
  1120             20  PI-PLAN-BEN            PIC XX.
  1121             20  PI-PLAN-REVISION       PIC X(3).
  1122         16  PI-WS-STATE                PIC XX.
  1123         16  PI-WS-CLASS                PIC XX.
  1124         16  PI-WS-DEV                  PIC X(3).
  1125         16  PI-WS-TYPE                 PIC X.
  1126         16  PI-WS-PLAN                 PIC XX.
  1127
  1128         16  PI-ERPNDB-ALT-KEY.
  1129             20  PI-PB-COMPANY-CD-A1    PIC X.
  1130             20  PI-PB-CARRIER          PIC X.
  1131             20  PI-PB-GROUPING         PIC X(6).
  1132             20  PI-PB-STATE            PIC XX.
  1133             20  PI-PB-ACCOUNT          PIC X(10).
  1134             20  PI-PB-CERT-EFF-DT      PIC XX.
  1135             20  PI-PB-CERT-NO          PIC X(10).
  1136             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1137             20  PI-PB-RECORD-TYPE      PIC X.
  1138
  1139         16  PI-DATE-RANGE-TABLE.
  1140             20  PI-TABLE-ENT OCCURS 32 TIMES
  1141                            INDEXED BY T-INDEX.
  1142                 24  PI-BIN-EFF-DT          PIC XX.
  1143                 24  PI-BIN-EXP-DT          PIC XX.
  1144                 24  PI-BIN-MAINT-DT        PIC XX.
  1145                 24  PI-BIN-LO-CERT         PIC XX.
  1146                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1147                 24  PI-BIN-HI-CERT         PIC XX.
  1148         16  PI-PAGE-NUMBER             PIC S9.
  1149             88  PI-FST-PAGE               VALUE +1.
  1150             88  PI-2ND-PAGE               VALUE +2.
  1151             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  26
* EL650.cbl
  1152             88  PI-LST-PAGE               VALUE +4.
  1153         16  PI-TOTAL-LINES             PIC S99.
  1154         16  PI-LINE-SELECTED    PIC S9.
  1155***  Y2K PROJ 7744
  1156         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1157         16  BIN-EFFCHG-SAVE     PIC XX.
  1158         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1159***  Y2K PROJ 7744
  1160         16  BIN-EXPCHG-SAVE     PIC XX.
  1161         16  PI-RECORD-ADDED-SW  PIC X.
  1162             88  PI-RECORD-ADDED            VALUE '1'.
  1163             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1164         16  PI-ACCNAME          PIC X(30).
  1165         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1166         16  PI-SV-MAINT         PIC X.
  1167         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1168         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1169         16  PI-UPDATE-SW        PIC X.
  1170             88  PI-CHANGES-MADE             VALUE '1'.
  1171         16  PI-NOTE-TYPE        PIC X.
  1172             88  PI-ACCT-NOTE                VALUE '1'.
  1173         16  PI-DMD-FILE-SW      PIC X.
  1174             88  END-OF-FILE                 VALUE 'E'.
  1175             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1176             88  FIRST-OCCURS                VALUE 'F'.
  1177         16  PI-DMD-OCCURS       PIC S999.
  1178         16  PI-DMD-SCREEN       PIC X.
  1179             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1180             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1181             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1182         16  PI-NAMEFLG          PIC X.
  1183         16  PI-EL650-DEL-SW     PIC X.
  1184         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1185         16  PI-DCC-PROD-CODE    PIC XXX.
  1186         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  27
* EL650.cbl
  1188*          16  PI-NAMEFLG       PIC X.
  1189
  1190*    COPY ELCJPFX.
  1191******************************************************************
  1192*                                                                *
  1193*                                                                *
  1194*                            ELCJPFX.                            *
  1195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1196*                            VMOD=2.002                          *
  1197*                                                                *
  1198*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1199*                                                                *
  1200*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1201*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1202*        ELCNTL - CONTROL FILE                                   *
  1203*        ELMSTR - CLAIM MASTERS                                  *
  1204*        ELTRLR - ACTIVITY TRAILERS                              *
  1205*        ELCHKQ - CHECK QUE                                      *
  1206******************************************************************
  1207 01  JOURNAL-RECORD.
  1208     12  jp-date                     pic s9(5) comp-3.
  1209     12  jp-time                     pic s9(7) comp-3.
  1210     12  JP-USER-ID                  PIC X(4).
  1211     12  JP-FILE-ID                  PIC X(8).
  1212     12  JP-PROGRAM-ID               PIC X(8).
  1213     12  JP-RECORD-TYPE              PIC X.
  1214         88 JP-ADD              VALUE 'A'.
  1215         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1216         88 JP-AFTER-CHANGE     VALUE 'C'.
  1217         88 JP-DELETE           VALUE 'D'.
  1218         88 JP-GENERIC-DELETE   VALUE 'G'.
  1219         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1220         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1221     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1222     12  JP-RECORD-AREA
  1223
  1224
  1225                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  28
* EL650.cbl
  1227*    COPY ELCAID.
  1228******************************************************************
  1229*                                                                *
  1230*                            ELCAID.                             *
  1231*                            VMOD=2.001                          *
  1232*                                                                *
  1233*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1234*                                                                *
  1235*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1236*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1237******************************************************************
  1238
  1239 01  DFHAID.
  1240   02  DFHNULL   PIC  X  VALUE  ' '.
  1241   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1242   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1243   02  DFHPEN    PIC  X  VALUE  '='.
  1244   02  DFHOPID   PIC  X  VALUE  'W'.
  1245   02  DFHPA1    PIC  X  VALUE  '%'.
  1246   02  DFHPA2    PIC  X  VALUE  '>'.
  1247   02  DFHPA3    PIC  X  VALUE  ','.
  1248   02  DFHPF1    PIC  X  VALUE  '1'.
  1249   02  DFHPF2    PIC  X  VALUE  '2'.
  1250   02  DFHPF3    PIC  X  VALUE  '3'.
  1251   02  DFHPF4    PIC  X  VALUE  '4'.
  1252   02  DFHPF5    PIC  X  VALUE  '5'.
  1253   02  DFHPF6    PIC  X  VALUE  '6'.
  1254   02  DFHPF7    PIC  X  VALUE  '7'.
  1255   02  DFHPF8    PIC  X  VALUE  '8'.
  1256   02  DFHPF9    PIC  X  VALUE  '9'.
  1257   02  DFHPF10   PIC  X  VALUE  ':'.
  1258   02  DFHPF11   PIC  X  VALUE  '#'.
  1259   02  DFHPF12   PIC  X  VALUE  '@'.
  1260   02  DFHPF13   PIC  X  VALUE  'A'.
  1261   02  DFHPF14   PIC  X  VALUE  'B'.
  1262   02  DFHPF15   PIC  X  VALUE  'C'.
  1263   02  DFHPF16   PIC  X  VALUE  'D'.
  1264   02  DFHPF17   PIC  X  VALUE  'E'.
  1265   02  DFHPF18   PIC  X  VALUE  'F'.
  1266   02  DFHPF19   PIC  X  VALUE  'G'.
  1267   02  DFHPF20   PIC  X  VALUE  'H'.
  1268   02  DFHPF21   PIC  X  VALUE  'I'.
  1269*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1270   02  DFHPF22   PIC  X  VALUE  '['.
  1271   02  DFHPF23   PIC  X  VALUE  '.'.
  1272   02  DFHPF24   PIC  X  VALUE  '<'.
  1273   02  DFHMSRE   PIC  X  VALUE  'X'.
  1274   02  DFHSTRF   PIC  X  VALUE  'h'.
  1275   02  DFHTRIG   PIC  X  VALUE  '"'.
  1276
  1277 01  FILLER  REDEFINES  DFHAID.
  1278     12  FILLER              PIC  X(8).
  1279     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1280     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  29
* EL650.cbl
  1282*    COPY EL650S.
  1283 01  EL650AI.
  1284     05  FILLER            PIC  X(0012).
  1285*    -------------------------------
  1286     05  DATEL PIC S9(0004) COMP.
  1287     05  DATEF PIC  X(0001).
  1288     05  FILLER REDEFINES DATEF.
  1289         10  DATEA PIC  X(0001).
  1290     05  DATEI PIC  X(0008).
  1291*    -------------------------------
  1292     05  TIMEL PIC S9(0004) COMP.
  1293     05  TIMEF PIC  X(0001).
  1294     05  FILLER REDEFINES TIMEF.
  1295         10  TIMEA PIC  X(0001).
  1296     05  TIMEI PIC  X(0005).
  1297*    -------------------------------
  1298     05  CMPNYIDL PIC S9(0004) COMP.
  1299     05  CMPNYIDF PIC  X(0001).
  1300     05  FILLER REDEFINES CMPNYIDF.
  1301         10  CMPNYIDA PIC  X(0001).
  1302     05  CMPNYIDI PIC  X(0003).
  1303*    -------------------------------
  1304     05  USERIDL PIC S9(0004) COMP.
  1305     05  USERIDF PIC  X(0001).
  1306     05  FILLER REDEFINES USERIDF.
  1307         10  USERIDA PIC  X(0001).
  1308     05  USERIDI PIC  X(0004).
  1309*    -------------------------------
  1310     05  MAINTL PIC S9(0004) COMP.
  1311     05  MAINTF PIC  X(0001).
  1312     05  FILLER REDEFINES MAINTF.
  1313         10  MAINTA PIC  X(0001).
  1314     05  MAINTI PIC  X(0001).
  1315*    -------------------------------
  1316     05  TRNMSG1L PIC S9(0004) COMP.
  1317     05  TRNMSG1F PIC  X(0001).
  1318     05  FILLER REDEFINES TRNMSG1F.
  1319         10  TRNMSG1A PIC  X(0001).
  1320     05  TRNMSG1I PIC  X(0017).
  1321*    -------------------------------
  1322     05  LINEL PIC S9(0004) COMP.
  1323     05  LINEF PIC  X(0001).
  1324     05  FILLER REDEFINES LINEF.
  1325         10  LINEA PIC  X(0001).
  1326     05  LINEI PIC  9.
  1327*    -------------------------------
  1328     05  ACARIERL PIC S9(0004) COMP.
  1329     05  ACARIERF PIC  X(0001).
  1330     05  FILLER REDEFINES ACARIERF.
  1331         10  ACARIERA PIC  X(0001).
  1332     05  ACARIERI PIC  X(0001).
  1333*    -------------------------------
  1334     05  AGROUPL PIC S9(0004) COMP.
  1335     05  AGROUPF PIC  X(0001).
  1336     05  FILLER REDEFINES AGROUPF.
  1337         10  AGROUPA PIC  X(0001).
  1338     05  AGROUPI PIC  X(0006).
  1339*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  30
* EL650.cbl
  1340     05  ASTATEL PIC S9(0004) COMP.
  1341     05  ASTATEF PIC  X(0001).
  1342     05  FILLER REDEFINES ASTATEF.
  1343         10  ASTATEA PIC  X(0001).
  1344     05  ASTATEI PIC  X(0002).
  1345*    -------------------------------
  1346     05  AACCTL PIC S9(0004) COMP.
  1347     05  AACCTF PIC  X(0001).
  1348     05  FILLER REDEFINES AACCTF.
  1349         10  AACCTA PIC  X(0001).
  1350     05  AACCTI PIC  X(0010).
  1351*    -------------------------------
  1352     05  NAMEFLGL PIC S9(0004) COMP.
  1353     05  NAMEFLGF PIC  X(0001).
  1354     05  FILLER REDEFINES NAMEFLGF.
  1355         10  NAMEFLGA PIC  X(0001).
  1356     05  NAMEFLGI PIC  X(0001).
  1357*    -------------------------------
  1358     05  NAMEL PIC S9(0004) COMP.
  1359     05  NAMEF PIC  X(0001).
  1360     05  FILLER REDEFINES NAMEF.
  1361         10  NAMEA PIC  X(0001).
  1362     05  NAMEI PIC  X(0030).
  1363*    -------------------------------
  1364     05  ARHDGL PIC S9(0004) COMP.
  1365     05  ARHDGF PIC  X(0001).
  1366     05  FILLER REDEFINES ARHDGF.
  1367         10  ARHDGA PIC  X(0001).
  1368     05  ARHDGI PIC  X(0010).
  1369*    -------------------------------
  1370     05  DET1L PIC S9(0004) COMP.
  1371     05  DET1F PIC  X(0001).
  1372     05  FILLER REDEFINES DET1F.
  1373         10  DET1A PIC  X(0001).
  1374     05  DET1I PIC  X(0070).
  1375*    -------------------------------
  1376     05  DET2L PIC S9(0004) COMP.
  1377     05  DET2F PIC  X(0001).
  1378     05  FILLER REDEFINES DET2F.
  1379         10  DET2A PIC  X(0001).
  1380     05  DET2I PIC  X(0070).
  1381*    -------------------------------
  1382     05  DET3L PIC S9(0004) COMP.
  1383     05  DET3F PIC  X(0001).
  1384     05  FILLER REDEFINES DET3F.
  1385         10  DET3A PIC  X(0001).
  1386     05  DET3I PIC  X(0070).
  1387*    -------------------------------
  1388     05  DET4L PIC S9(0004) COMP.
  1389     05  DET4F PIC  X(0001).
  1390     05  FILLER REDEFINES DET4F.
  1391         10  DET4A PIC  X(0001).
  1392     05  DET4I PIC  X(0070).
  1393*    -------------------------------
  1394     05  DET5L PIC S9(0004) COMP.
  1395     05  DET5F PIC  X(0001).
  1396     05  FILLER REDEFINES DET5F.
  1397         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  31
* EL650.cbl
  1398     05  DET5I PIC  X(0070).
  1399*    -------------------------------
  1400     05  DET6L PIC S9(0004) COMP.
  1401     05  DET6F PIC  X(0001).
  1402     05  FILLER REDEFINES DET6F.
  1403         10  DET6A PIC  X(0001).
  1404     05  DET6I PIC  X(0070).
  1405*    -------------------------------
  1406     05  DET7L PIC S9(0004) COMP.
  1407     05  DET7F PIC  X(0001).
  1408     05  FILLER REDEFINES DET7F.
  1409         10  DET7A PIC  X(0001).
  1410     05  DET7I PIC  X(0070).
  1411*    -------------------------------
  1412     05  DET8L PIC S9(0004) COMP.
  1413     05  DET8F PIC  X(0001).
  1414     05  FILLER REDEFINES DET8F.
  1415         10  DET8A PIC  X(0001).
  1416     05  DET8I PIC  X(0070).
  1417*    -------------------------------
  1418     05  TRNMSG2L PIC S9(0004) COMP.
  1419     05  TRNMSG2F PIC  X(0001).
  1420     05  FILLER REDEFINES TRNMSG2F.
  1421         10  TRNMSG2A PIC  X(0001).
  1422     05  TRNMSG2I PIC  X(0020).
  1423*    -------------------------------
  1424     05  EFFCHGL PIC S9(0004) COMP.
  1425     05  EFFCHGF PIC  X(0001).
  1426     05  FILLER REDEFINES EFFCHGF.
  1427         10  EFFCHGA PIC  X(0001).
  1428     05  EFFCHGI PIC  X(0008).
  1429*    -------------------------------
  1430     05  EXPCHGL PIC S9(0004) COMP.
  1431     05  EXPCHGF PIC  X(0001).
  1432     05  FILLER REDEFINES EXPCHGF.
  1433         10  EXPCHGA PIC  X(0001).
  1434     05  EXPCHGI PIC  X(0008).
  1435*    -------------------------------
  1436     05  TRNMSG3L PIC S9(0004) COMP.
  1437     05  TRNMSG3F PIC  X(0001).
  1438     05  FILLER REDEFINES TRNMSG3F.
  1439         10  TRNMSG3A PIC  X(0001).
  1440     05  TRNMSG3I PIC  X(0003).
  1441*    -------------------------------
  1442     05  TRNTOL PIC S9(0004) COMP.
  1443     05  TRNTOF PIC  X(0001).
  1444     05  FILLER REDEFINES TRNTOF.
  1445         10  TRNTOA PIC  X(0001).
  1446     05  TRNTOI PIC  X(0019).
  1447*    -------------------------------
  1448     05  TRNTODTL PIC S9(0004) COMP.
  1449     05  TRNTODTF PIC  X(0001).
  1450     05  FILLER REDEFINES TRNTODTF.
  1451         10  TRNTODTA PIC  X(0001).
  1452     05  TRNTODTI PIC  X(0008).
  1453*    -------------------------------
  1454     05  TRNMSG4L PIC S9(0004) COMP.
  1455     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  32
* EL650.cbl
  1456     05  FILLER REDEFINES TRNMSG4F.
  1457         10  TRNMSG4A PIC  X(0001).
  1458     05  TRNMSG4I PIC  X(0005).
  1459*    -------------------------------
  1460     05  TRNFROML PIC S9(0004) COMP.
  1461     05  TRNFROMF PIC  X(0001).
  1462     05  FILLER REDEFINES TRNFROMF.
  1463         10  TRNFROMA PIC  X(0001).
  1464     05  TRNFROMI PIC  X(0019).
  1465*    -------------------------------
  1466     05  TRNFRDTL PIC S9(0004) COMP.
  1467     05  TRNFRDTF PIC  X(0001).
  1468     05  FILLER REDEFINES TRNFRDTF.
  1469         10  TRNFRDTA PIC  X(0001).
  1470     05  TRNFRDTI PIC  X(0008).
  1471*    -------------------------------
  1472     05  ERRMSG1L PIC S9(0004) COMP.
  1473     05  ERRMSG1F PIC  X(0001).
  1474     05  FILLER REDEFINES ERRMSG1F.
  1475         10  ERRMSG1A PIC  X(0001).
  1476     05  ERRMSG1I PIC  X(0075).
  1477*    -------------------------------
  1478     05  ERRMSG2L PIC S9(0004) COMP.
  1479     05  ERRMSG2F PIC  X(0001).
  1480     05  FILLER REDEFINES ERRMSG2F.
  1481         10  ERRMSG2A PIC  X(0001).
  1482     05  ERRMSG2I PIC  X(0075).
  1483*    -------------------------------
  1484     05  PFENTERL PIC S9(0004) COMP.
  1485     05  PFENTERF PIC  X(0001).
  1486     05  FILLER REDEFINES PFENTERF.
  1487         10  PFENTERA PIC  X(0001).
  1488     05  PFENTERI PIC  9(2).
  1489 01  EL650AO REDEFINES EL650AI.
  1490     05  FILLER            PIC  X(0012).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  DATEO PIC  X(0008).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  TIMEO PIC  99.99.
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  CMPNYIDO PIC  X(0003).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  USERIDO PIC  X(0004).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  MAINTO PIC  X(0001).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  TRNMSG1O PIC  X(0017).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  LINEO PIC  X(0001).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  33
* EL650.cbl
  1514     05  ACARIERO PIC  X(0001).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  AGROUPO PIC  X(0006).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  ASTATEO PIC  X(0002).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  AACCTO PIC  X(0010).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  NAMEFLGO PIC  X(0001).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  NAMEO PIC  X(0030).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  ARHDGO PIC  X(0010).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  DET1O PIC  X(0070).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  DET2O PIC  X(0070).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  DET3O PIC  X(0070).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  DET4O PIC  X(0070).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  DET5O PIC  X(0070).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  DET6O PIC  X(0070).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  DET7O PIC  X(0070).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  DET8O PIC  X(0070).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  TRNMSG2O PIC  X(0020).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  EFFCHGO PIC  X(0008).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  EXPCHGO PIC  99B99B99.
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  TRNMSG3O PIC  X(0003).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  34
* EL650.cbl
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  TRNTODTO PIC  X(0008).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  TRNMSG4O PIC  X(0005).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  TRNFROMO PIC  X(0019).
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  TRNFRDTO PIC  X(0008).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  ERRMSG1O PIC  X(0075).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  ERRMSG2O PIC  X(0075).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  PFENTERO PIC  X(0002).
  1593*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  35
* EL650.cbl
  1595 01  EL650R  REDEFINES  EL650AI.
  1596     12  FILLER                      PIC  X(153).
  1597     12  MAP-RECORD-AREA.
  1598         16  DATE-RANGES     OCCURS  8  TIMES
  1599                                 INDEXED  BY  M-INDEX.
  1600             20  FILLER              PIC  X(3).
  1601             20  MAP-EFF-DT          PIC  X(8).
  1602             20  FILLER              PIC  X(6).
  1603             20  MAP-EXP-DT          PIC  X(8).
  1604             20  MAP-EXP-DT-ED  REDEFINES
  1605                 MAP-EXP-DT          PIC 99B99B99.
  1606             20  FILLER              PIC  X(4).
  1607             20  MAP-LST-MAINT-DT    PIC  X(8).
  1608             20  FILLER              PIC  X(3).
  1609             20  MAP-LOW-CERT        PIC  X(8).
  1610             20  FILLER              PIC  X(3).
  1611             20  MAP-HIGH-CERT       PIC  X(8).
  1612             20  FILLER              PIC  X(4).
  1613             20  MAP-AR-DATE         PIC  X(8).
  1614             20  FILLER              PIC  XX.
  1615     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  36
* EL650.cbl
  1617****************************************************************
  1618*
  1619* Copyright (c) 2007 by Clerity Solutions, Inc.
  1620* All rights reserved.
  1621*
  1622****************************************************************
  1623 01  DFHEIV.
  1624   02  DFHEIV0               PIC X(35).
  1625   02  DFHEIV1               PIC X(08).
  1626   02  DFHEIV2               PIC X(08).
  1627   02  DFHEIV3               PIC X(08).
  1628   02  DFHEIV4               PIC X(06).
  1629   02  DFHEIV5               PIC X(04).
  1630   02  DFHEIV6               PIC X(04).
  1631   02  DFHEIV7               PIC X(02).
  1632   02  DFHEIV8               PIC X(02).
  1633   02  DFHEIV9               PIC X(01).
  1634   02  DFHEIV10              PIC S9(7) COMP-3.
  1635   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1637   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1638   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1639   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1640   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1641   02  DFHEIV17              PIC X(04).
  1642   02  DFHEIV18              PIC X(04).
  1643   02  DFHEIV19              PIC X(04).
  1644   02  DFHEIV20              USAGE IS POINTER.
  1645   02  DFHEIV21              USAGE IS POINTER.
  1646   02  DFHEIV22              USAGE IS POINTER.
  1647   02  DFHEIV23              USAGE IS POINTER.
  1648   02  DFHEIV24              USAGE IS POINTER.
  1649   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1651   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1652   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1653   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1654   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1655   02  FILLER                PIC X(02).
  1656   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1657   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1658   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1659   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1660   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1661 LINKAGE  SECTION.
  1662*****************************************************************
  1663*                                                               *
  1664* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1665* All rights reserved.                                          *
  1666*                                                               *
  1667*****************************************************************
  1668 01  dfheiblk.
  1669     02  eibtime          pic s9(7) comp-3.
  1670     02  eibdate          pic s9(7) comp-3.
  1671     02  eibtrnid         pic x(4).
  1672     02  eibtaskn         pic s9(7) comp-3.
  1673     02  eibtrmid         pic x(4).
  1674     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  37
* EL650.cbl
  1675     02  eibcposn         pic s9(4) comp.
  1676     02  eibcalen         pic s9(4) comp.
  1677     02  eibaid           pic x(1).
  1678     02  eibfiller1       pic x(1).
  1679     02  eibfn            pic x(2).
  1680     02  eibfiller2       pic x(2).
  1681     02  eibrcode         pic x(6).
  1682     02  eibfiller3       pic x(2).
  1683     02  eibds            pic x(8).
  1684     02  eibreqid         pic x(8).
  1685     02  eibrsrce         pic x(8).
  1686     02  eibsync          pic x(1).
  1687     02  eibfree          pic x(1).
  1688     02  eibrecv          pic x(1).
  1689     02  eibsend          pic x(1).
  1690     02  eibatt           pic x(1).
  1691     02  eibeoc           pic x(1).
  1692     02  eibfmh           pic x(1).
  1693     02  eibcompl         pic x(1).
  1694     02  eibsig           pic x(1).
  1695     02  eibconf          pic x(1).
  1696     02  eiberr           pic x(1).
  1697     02  eibrldbk         pic x(1).
  1698     02  eiberrcd         pic x(4).
  1699     02  eibsynrb         pic x(1).
  1700     02  eibnodat         pic x(1).
  1701     02  eibfiller5       pic x(2).
  1702     02  eibresp          pic 9(09) comp.
  1703     02  eibresp2         pic 9(09) comp.
  1704     02  dfheigdj         pic s9(4) comp.
  1705     02  dfheigdk         pic s9(4) comp.
  1706 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  38
* EL650.cbl
  1708*01 PARMLIST .
  1709*    12  FILLER              PIC S9(8)   COMP.
  1710*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1711*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1712*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1713*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1714*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1715*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1716*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1717*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1718*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1719*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1720*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1721*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1722*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1723*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  39
* EL650.cbl
  1725*    COPY ERCACCT.
  1726******************************************************************
  1727*                                                                *
  1728*                                                                *
  1729*                            ERCACCT                             *
  1730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1731*                            VMOD=2.031                          *
  1732*                                                                *
  1733*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1734*                                                                *
  1735*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1736*   VSAM ACCOUNT MASTER FILES.                                   *
  1737*                                                                *
  1738*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1739*                                                                *
  1740*   FILE TYPE = VSAM,KSDS                                        *
  1741*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1742*                                                                *
  1743*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1744*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1745*                                                                *
  1746*   LOG = NO                                                     *
  1747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1748*                                                                *
  1749*                                                                *
  1750******************************************************************
  1751*                   C H A N G E   L O G
  1752*
  1753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1754*-----------------------------------------------------------------
  1755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1756* EFFECTIVE    NUMBER
  1757*-----------------------------------------------------------------
  1758* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1759* 092705    2005050300006  PEMA  ADD SPP LEASES
  1760* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1761* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1762* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1763* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1764* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1765* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1766******************************************************************
  1767
  1768 01  ACCOUNT-MASTER.
  1769     12  AM-RECORD-ID                      PIC XX.
  1770         88  VALID-AM-ID                      VALUE 'AM'.
  1771
  1772     12  AM-CONTROL-PRIMARY.
  1773         16  AM-COMPANY-CD                 PIC X.
  1774         16  AM-MSTR-CNTRL.
  1775             20  AM-CONTROL-A.
  1776                 24  AM-CARRIER            PIC X.
  1777                 24  AM-GROUPING.
  1778                     28 AM-GROUPING-PREFIX PIC XXX.
  1779                     28 AM-GROUPING-PRIME  PIC XXX.
  1780                 24  AM-STATE              PIC XX.
  1781                 24  AM-ACCOUNT.
  1782                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  40
* EL650.cbl
  1783                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1784             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1785                                           PIC X(19).
  1786             20  AM-CNTRL-B.
  1787                 24  AM-EXPIRATION-DT      PIC XX.
  1788                 24  FILLER                PIC X(4).
  1789             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1790                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1791
  1792     12  AM-CONTROL-BY-VAR-GRP.
  1793         16  AM-COMPANY-CD-A1              PIC X.
  1794         16  AM-VG-CARRIER                 PIC X.
  1795         16  AM-VG-GROUPING                PIC X(6).
  1796         16  AM-VG-STATE                   PIC XX.
  1797         16  AM-VG-ACCOUNT                 PIC X(10).
  1798         16  AM-VG-DATE.
  1799             20  AM-VG-EXPIRATION-DT       PIC XX.
  1800             20  FILLER                    PIC X(4).
  1801         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1802                                           PIC 9(11)      COMP-3.
  1803     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1804         16  FILLER                        PIC X(10).
  1805         16  AM-VG-KEY3.
  1806             20  AM-VG3-ACCOUNT            PIC X(10).
  1807             20  AM-VG3-EXP-DT             PIC XX.
  1808         16  FILLER                        PIC X(4).
  1809     12  AM-MAINT-INFORMATION.
  1810         16  AM-LAST-MAINT-DT              PIC XX.
  1811         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1812         16  AM-LAST-MAINT-USER            PIC X(4).
  1813         16  FILLER                        PIC XX.
  1814
  1815     12  AM-EFFECTIVE-DT                   PIC XX.
  1816     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1817
  1818     12  AM-PREV-DATES  COMP-3.
  1819         16  AM-PREV-EXP-DT                PIC 9(11).
  1820         16  AM-PREV-EFF-DT                PIC 9(11).
  1821
  1822     12  AM-REPORT-CODE-1                  PIC X(10).
  1823     12  AM-REPORT-CODE-2                  PIC X(10).
  1824
  1825     12  AM-CITY-CODE                      PIC X(4).
  1826     12  AM-COUNTY-PARISH                  PIC X(6).
  1827
  1828     12  AM-NAME                           PIC X(30).
  1829     12  AM-PERSON                         PIC X(30).
  1830     12  AM-ADDRS                          PIC X(30).
  1831     12  AM-CITY.
  1832         16  AM-ADDR-CITY                  PIC X(28).
  1833         16  AM-ADDR-STATE                 PIC XX.
  1834     12  AM-ZIP.
  1835         16  AM-ZIP-PRIME.
  1836             20  AM-ZIP-PRI-1ST            PIC X.
  1837                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1838             20  FILLER                    PIC X(4).
  1839         16  AM-ZIP-PLUS4                  PIC X(4).
  1840     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  41
* EL650.cbl
  1841         16  AM-CAN-POSTAL-1               PIC XXX.
  1842         16  AM-CAN-POSTAL-2               PIC XXX.
  1843         16  FILLER                        PIC XXX.
  1844     12  AM-TEL-NO.
  1845         16  AM-AREA-CODE                  PIC 999.
  1846         16  AM-TEL-PRE                    PIC 999.
  1847         16  AM-TEL-NBR                    PIC 9(4).
  1848     12  AM-TEL-LOC                        PIC X.
  1849         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1850         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1851
  1852     12  AM-COMM-STRUCTURE.
  1853         16  AM-DEFN-1.
  1854             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1855                 24  AM-AGT.
  1856                     28  AM-AGT-PREFIX     PIC X(4).
  1857                     28  AM-AGT-PRIME      PIC X(6).
  1858                 24  AM-COM-TYP            PIC X.
  1859                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1860                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1861                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1862                 24  AM-RECALC-LV-INDIC    PIC X.
  1863                 24  AM-RETRO-LV-INDIC     PIC X.
  1864                 24  AM-GL-CODES           PIC X.
  1865                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1866                 24  FILLER                PIC X(01).
  1867         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1868             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1869                 24  FILLER                PIC X(11).
  1870                 24  AM-L-COMA             PIC XXX.
  1871                 24  AM-J-COMA             PIC XXX.
  1872                 24  AM-A-COMA             PIC XXX.
  1873                 24  FILLER                PIC X(6).
  1874
  1875     12  AM-COMM-CHANGE-STATUS             PIC X.
  1876         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1877
  1878     12  AM-CSR-CODE                       PIC X(4).
  1879
  1880     12  AM-BILLING-STATUS                 PIC X.
  1881         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1882         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1883     12  AM-AUTO-REFUND-SW                 PIC X.
  1884         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1885         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1886     12  AM-GPCD                           PIC 99.
  1887     12  AM-IG                             PIC X.
  1888         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1889         88  AM-HAS-GROUP                     VALUE '2'.
  1890     12  AM-STATUS                         PIC X.
  1891         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1892         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1893         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1894         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1895         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1896         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1897         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1898         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  42
* EL650.cbl
  1899         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1900         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1901     12  AM-REMIT-TO                       PIC 99.
  1902     12  AM-ID-NO                          PIC X(11).
  1903
  1904     12  AM-CAL-TABLE                      PIC XX.
  1905     12  AM-LF-DEVIATION                   PIC XXX.
  1906     12  AM-AH-DEVIATION                   PIC XXX.
  1907     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1908     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1909     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1910     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1911     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1912     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1913
  1914     12  AM-USER-FIELDS.
  1915         16  AM-FLD-1                      PIC XX.
  1916         16  AM-FLD-2                      PIC XX.
  1917         16  AM-FLD-3                      PIC XX.
  1918         16  AM-FLD-4                      PIC XX.
  1919         16  AM-FLD-5                      PIC XX.
  1920
  1921     12  AM-1ST-PROD-DATE.
  1922         16  AM-1ST-PROD-YR                PIC XX.
  1923         16  AM-1ST-PROD-MO                PIC XX.
  1924         16  AM-1ST-PROD-DA                PIC XX.
  1925     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1926     12  AM-CERTS-PURGED-DATE.
  1927         16  AM-PUR-YR                     PIC XX.
  1928         16  AM-PUR-MO                     PIC XX.
  1929         16  AM-PUR-DA                     PIC XX.
  1930     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1931     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1932     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1933     12  AM-INACTIVE-DATE.
  1934         16  AM-INA-MO                     PIC 99.
  1935         16  AM-INA-DA                     PIC 99.
  1936         16  AM-INA-YR                     PIC 99.
  1937     12  AM-AR-HI-CERT-DATE                PIC XX.
  1938
  1939     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1940     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1941
  1942     12  AM-OB-PAYMENT-MODE                PIC X.
  1943         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1944         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1945         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1946         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1947
  1948     12  AM-AH-ONLY-INDICATOR              PIC X.
  1949         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1950         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1951
  1952     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1953
  1954     12  AM-OVER-SHORT.
  1955         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1956         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  43
* EL650.cbl
  1957
  1958     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1959     12  AM-DCC-CLP-STATE                  PIC XX.
  1960
  1961     12  AM-RECALC-COMM                    PIC X.
  1962     12  AM-RECALC-REIN                    PIC X.
  1963
  1964     12  AM-REI-TABLE                      PIC XXX.
  1965     12  AM-REI-ET-LF                      PIC X.
  1966     12  AM-REI-ET-AH                      PIC X.
  1967     12  AM-REI-PE-LF                      PIC X.
  1968     12  AM-REI-PE-AH                      PIC X.
  1969     12  AM-REI-PRT-ST                     PIC X.
  1970     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1971     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1972     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1973     12  AM-REI-GROUP-A                    PIC X(6).
  1974     12  AM-REI-MORT                       PIC X(4).
  1975     12  AM-REI-PRT-OW                     PIC X.
  1976     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1977     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1978     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1979     12  AM-REI-GROUP-B                    PIC X(6).
  1980
  1981     12  AM-TRUST-TYPE                     PIC X(2).
  1982
  1983     12  AM-EMPLOYER-STMT-USED             PIC X.
  1984     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1985
  1986     12  AM-STD-AH-TYPE                    PIC XX.
  1987     12  AM-EARN-METHODS.
  1988         16  AM-EARN-METHOD-R              PIC X.
  1989             88 AM-REF-RL-R78                 VALUE 'R'.
  1990             88 AM-REF-RL-PR                  VALUE 'P'.
  1991             88 AM-REF-RL-MEAN                VALUE 'M'.
  1992             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1993         16  AM-EARN-METHOD-L              PIC X.
  1994             88 AM-REF-LL-R78                 VALUE 'R'.
  1995             88 AM-REF-LL-PR                  VALUE 'P'.
  1996             88 AM-REF-LL-MEAN                VALUE 'M'.
  1997             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1998         16  AM-EARN-METHOD-A              PIC X.
  1999             88 AM-REF-AH-R78                 VALUE 'R'.
  2000             88 AM-REF-AH-PR                  VALUE 'P'.
  2001             88 AM-REF-AH-MEAN                VALUE 'M'.
  2002             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2003             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2004             88 AM-REF-AH-NET                 VALUE 'N'.
  2005
  2006     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2007     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2008     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2009
  2010     12  AM-RET-Y-N                        PIC X.
  2011     12  AM-RET-P-E                        PIC X.
  2012     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2013     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2014     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  44
* EL650.cbl
  2015     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2016         16  AM-POOL-PRIME                 PIC XXX.
  2017         16  AM-POOL-SUB                   PIC XXX.
  2018     12  AM-RETRO-EARNINGS.
  2019         16  AM-RET-EARN-R                 PIC X.
  2020         16  AM-RET-EARN-L                 PIC X.
  2021         16  AM-RET-EARN-A                 PIC X.
  2022     12  AM-RET-ST-TAX-USE                 PIC X.
  2023         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2024         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2025     12  AM-RETRO-BEG-EARNINGS.
  2026         16  AM-RET-BEG-EARN-R             PIC X.
  2027         16  AM-RET-BEG-EARN-L             PIC X.
  2028         16  AM-RET-BEG-EARN-A             PIC X.
  2029     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2030     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2031
  2032     12  AM-USER-SELECT-OPTIONS.
  2033         16  AM-USER-SELECT-1              PIC X(10).
  2034         16  AM-USER-SELECT-2              PIC X(10).
  2035         16  AM-USER-SELECT-3              PIC X(10).
  2036         16  AM-USER-SELECT-4              PIC X(10).
  2037         16  AM-USER-SELECT-5              PIC X(10).
  2038
  2039     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2040
  2041     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2042
  2043     12  AM-RPT045A-SWITCH                 PIC X.
  2044         88  RPT045A-OFF                   VALUE 'N'.
  2045
  2046     12  AM-INSURANCE-LIMITS.
  2047         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2048         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2049
  2050     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2051         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2052
  2053     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2054         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2055         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2056
  2057     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2058
  2059     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2060     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2061     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2062     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2063     12  AM-DCC-UEF-STATE                  PIC XX.
  2064     12  FILLER                            PIC XXX.
  2065     12  AM-REPORT-CODE-3                  PIC X(10).
  2066*    12  FILLER                            PIC X(22).
  2067
  2068     12  AM-RESERVE-DATE.
  2069         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2070         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2071         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2072
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  45
* EL650.cbl
  2073     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2074     12  AM-NOTIFICATION-TYPES.
  2075         16  AM-NOTIF-OF-LETTERS           PIC X.
  2076         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2077         16  AM-NOTIF-OF-REPORTS           PIC X.
  2078         16  AM-NOTIF-OF-STATUS            PIC X.
  2079
  2080     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2081         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2082         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2083         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2084         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2085
  2086     12  AM-BENEFIT-CONTROLS.
  2087         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2088             20  AM-BENEFIT-CODE           PIC XX.
  2089             20  AM-BENEFIT-TYPE           PIC X.
  2090             20  AM-BENEFIT-REVISION       PIC XXX.
  2091             20  AM-BENEFIT-REM-TERM       PIC X.
  2092             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2093             20  FILLER                    PIC XX.
  2094         16  FILLER                        PIC X(80).
  2095
  2096     12  AM-TRANSFER-DATA.
  2097         16  AM-TRANSFERRED-FROM.
  2098             20  AM-TRNFROM-CARRIER        PIC X.
  2099             20  AM-TRNFROM-GROUPING.
  2100                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2101                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2102             20  AM-TRNFROM-STATE          PIC XX.
  2103             20  AM-TRNFROM-ACCOUNT.
  2104                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2105                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2106             20  AM-TRNFROM-DTE            PIC XX.
  2107         16  AM-TRANSFERRED-TO.
  2108             20  AM-TRNTO-CARRIER          PIC X.
  2109             20  AM-TRNTO-GROUPING.
  2110                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2111                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2112             20  AM-TRNTO-STATE            PIC XX.
  2113             20  AM-TRNTO-ACCOUNT.
  2114                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2115                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2116             20  AM-TRNTO-DTE              PIC XX.
  2117         16  FILLER                        PIC X(10).
  2118
  2119     12  AM-SAVED-REMIT-TO                 PIC 99.
  2120
  2121     12  AM-COMM-STRUCTURE-SAVED.
  2122         16  AM-DEFN-1-SAVED.
  2123             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2124                 24  AM-AGT-SV             PIC X(10).
  2125                 24  AM-COM-TYP-SV         PIC X.
  2126                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2127                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2128                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2129                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2130                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  46
* EL650.cbl
  2131                 24  AM-GL-CODES-SV        PIC X.
  2132                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2133                 24  FILLER                PIC X.
  2134         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2135             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2136                 24  FILLER                PIC X(11).
  2137                 24  AM-L-COMA-SV          PIC XXX.
  2138                 24  AM-J-COMA-SV          PIC XXX.
  2139                 24  AM-A-COMA-SV          PIC XXX.
  2140                 24  FILLER                PIC X(6).
  2141
  2142     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2143         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2144            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2145            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2146            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2147
  2148     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2149     12  FILLER                            PIC X(120).
  2150
  2151     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2152         16  AM-CONTROL-NAME               PIC X(30).
  2153         16  AM-EXECUTIVE-ONE.
  2154             20  AM-EXEC1-NAME             PIC X(15).
  2155             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2156                                                          COMP-3.
  2157             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2158                                                          COMP-3.
  2159         16  AM-EXECUTIVE-TWO.
  2160             20  AM-EXEC2-NAME             PIC X(15).
  2161             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2162                                                          COMP-3.
  2163             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2164                                                          COMP-3.
  2165
  2166     12  AM-RETRO-ADDITIONAL-DATA.
  2167         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2168         16  AM-RETRO-PREM-P-E             PIC X.
  2169         16  AM-RETRO-CLMS-P-I             PIC X.
  2170         16  AM-RETRO-RET-BRACKET-LF.
  2171             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2172                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2173                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2174             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2175                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2176                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2177             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2178                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2179                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2180         16  AM-RETRO-RET-BRACKET-AH.
  2181             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2182                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2183                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2184                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2185             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2186                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2187                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2188             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  47
* EL650.cbl
  2189                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2190                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2191
  2192     12  AM-COMMENTS.
  2193         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2194
  2195     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2196         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2197         16  AM-FLI-BILLING-CODE           PIC X.
  2198         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2199         16  AM-FLI-UNITED-IDENT           PIC X.
  2200         16  AM-FLI-INTEREST-LOST-DATA.
  2201             20  AM-FLI-BANK-NO            PIC X(5).
  2202             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2203             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2204             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2205         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2206             20  AM-FLI-AGT                PIC X(9).
  2207             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2208             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2209         16  FILLER                        PIC X(102).
  2210
  2211     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2212         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2213             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2214             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2215             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2216             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2217             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2218         16  FILLER                          PIC X(10).
  2219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  48
* EL650.cbl
  2221*    COPY ERCCOMP.
  2222******************************************************************
  2223*                                                                *
  2224*                                                                *
  2225*                            ERCCOMP                             *
  2226*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2227*                            VMOD=2.019                          *
  2228*                                                                *
  2229*   ONLINE CREDIT SYSTEM                                         *
  2230*                                                                *
  2231*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2232*                                                                *
  2233*   FILE TYPE = VSAM,KSDS                                        *
  2234*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2235*                                                                *
  2236*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2237*       ALTERNATE PATH = NONE                                    *
  2238*                                                                *
  2239*   LOG = NO                                                     *
  2240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2241*                                                                *
  2242******************************************************************
  2243*                   C H A N G E   L O G
  2244*
  2245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2246*-----------------------------------------------------------------
  2247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2248* EFFECTIVE    NUMBER
  2249*-----------------------------------------------------------------
  2250* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2251* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2252* 092205    2005050300006  PEMA  ADD LEASE FEE
  2253* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2254* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2255* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2256* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2257* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2258* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2259******************************************************************
  2260
  2261 01  COMPENSATION-MASTER.
  2262     12  CO-RECORD-ID                          PIC XX.
  2263         88  VALID-CO-ID                          VALUE 'CO'.
  2264
  2265     12  CO-CONTROL-PRIMARY.
  2266         16  CO-COMPANY-CD                     PIC X.
  2267         16  CO-CONTROL.
  2268             20  CO-CTL-1.
  2269                 24  CO-CARR-GROUP.
  2270                     28  CO-CARRIER            PIC X.
  2271                     28  CO-GROUPING.
  2272                         32  CO-GROUP-PREFIX   PIC XXX.
  2273                         32  CO-GROUP-PRIME    PIC XXX.
  2274                 24  CO-RESP-NO.
  2275                     28  CO-RESP-PREFIX        PIC X(4).
  2276                     28  CO-RESP-PRIME         PIC X(6).
  2277             20  CO-CTL-2.
  2278                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  49
* EL650.cbl
  2279                     28  CO-ACCT-PREFIX        PIC X(4).
  2280                     28  CO-ACCT-PRIME         PIC X(6).
  2281         16  CO-TYPE                           PIC X.
  2282             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2283             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2284             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2285
  2286     12  CO-MAINT-INFORMATION.
  2287         16  CO-LAST-MAINT-DT                  PIC XX.
  2288         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2289         16  CO-LAST-MAINT-USER                PIC X(4).
  2290     12  FILLER                                PIC XX.
  2291     12  CO-STMT-TYPE                          PIC XXX.
  2292     12  CO-COMP-TYPE                          PIC X.
  2293         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2294     12  CO-STMT-OWNER                         PIC X(4).
  2295     12  CO-BALANCE-CONTROL                    PIC X.
  2296         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2297         88  CO-NO-BALANCE                        VALUE 'N'.
  2298
  2299     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2300         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2301         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2302         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2303
  2304     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2305         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2306         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2307
  2308     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2309     12  CO-GA-DIRECT-DEP                      PIC X.
  2310     12  CO-FUTURE-SPACE                       PIC X.
  2311         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2312
  2313     12  CO-ACCT-NAME                          PIC X(30).
  2314     12  CO-MAIL-NAME                          PIC X(30).
  2315     12  CO-ADDR-1                             PIC X(30).
  2316     12  CO-ADDR-2                             PIC X(30).
  2317     12  CO-ADDR-3.
  2318         16  CO-ADDR-CITY                      PIC X(27).
  2319         16  CO-ADDR-STATE                     PIC XX.
  2320     12  CO-CSO-1099                           PIC X.
  2321     12  CO-ZIP.
  2322         16  CO-ZIP-PRIME.
  2323             20  CO-ZIP-PRI-1ST                PIC X.
  2324                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2325             20  FILLER                        PIC X(4).
  2326         16  CO-ZIP-PLUS4                      PIC X(4).
  2327     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2328         16  CO-CAN-POSTAL-1                   PIC XXX.
  2329         16  CO-CAN-POSTAL-2                   PIC XXX.
  2330         16  FILLER                            PIC XXX.
  2331     12  CO-SOC-SEC                            PIC X(13).
  2332     12  CO-TELEPHONE.
  2333         16  CO-AREA-CODE                      PIC XXX.
  2334         16  CO-PREFIX                         PIC XXX.
  2335         16  CO-PHONE                          PIC X(4).
  2336
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  50
* EL650.cbl
  2337     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2338
  2339     12  CO-AR-BAL-LEVEL                       PIC X.
  2340         88  CO-AR-REF-LVL                        VALUE '1'.
  2341         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2342         88  CO-AR-BILL-LVL                       VALUE '2'.
  2343         88  CO-AR-AGT-LVL                        VALUE '3'.
  2344         88  CO-AR-FR-LVL                         VALUE '4'.
  2345
  2346     12  CO-AR-NORMAL-PRINT                    PIC X.
  2347         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2348         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2349
  2350     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2351
  2352     12  CO-AR-REPORTING                       PIC X.
  2353         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2354         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2355
  2356     12  CO-AR-PULL-CHECK                      PIC X.
  2357         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2358         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2359
  2360     12  CO-AR-BALANCE-PRINT                   PIC X.
  2361         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2362
  2363     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2364         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2365         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2366         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2367
  2368     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2369
  2370     12  CO-USER-CODE                          PIC X.
  2371     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2372
  2373******************************************************************
  2374*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2375*    THE LAST MONTH END RUN.
  2376******************************************************************
  2377
  2378     12  CO-LAST-ACTIVITY-DATE.
  2379         16  CO-ACT-YEAR                       PIC 99.
  2380         16  CO-ACT-MONTH                      PIC 99.
  2381         16  CO-ACT-DAY                        PIC 99.
  2382
  2383     12  CO-LAST-STMT-DT.
  2384         16  CO-LAST-STMT-YEAR                 PIC 99.
  2385         16  CO-LAST-STMT-MONTH                PIC 99.
  2386         16  CO-LAST-STMT-DAY                  PIC 99.
  2387
  2388     12  CO-MO-END-TOTALS.
  2389         16  CO-MONTHLY-TOTALS.
  2390             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2391             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2392             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2393             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2394             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  51
* EL650.cbl
  2395
  2396         16  CO-AGING-TOTALS.
  2397             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2398             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2399             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2400             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2401
  2402         16  CO-YTD-TOTALS.
  2403             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2404             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2405
  2406         16  CO-OVER-UNDER-TOTALS.
  2407             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2408             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2409
  2410     12  CO-MISCELLANEOUS-TOTALS.
  2411         16  CO-FICA-TOTALS.
  2412             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2413             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2414
  2415         16  CO-CLAIM-TOTALS.
  2416             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2417             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2418
  2419******************************************************************
  2420*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2421*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2422******************************************************************
  2423
  2424     12  CO-CURRENT-TOTALS.
  2425         16  CO-CURRENT-LAST-STMT-DT.
  2426             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2427             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2428             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2429
  2430         16  CO-CURRENT-MONTHLY-TOTALS.
  2431             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2432             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2433             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2434             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2435             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2436
  2437         16  CO-CURRENT-AGING-TOTALS.
  2438             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2439             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2440             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2441             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2442
  2443         16  CO-CURRENT-YTD-TOTALS.
  2444             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2445             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2446
  2447     12  CO-PAID-COMM-TOTALS.
  2448         16  CO-YTD-PAID-COMMS.
  2449             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2450             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2451
  2452     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  52
* EL650.cbl
  2453         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2454         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2455
  2456     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2457         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2458         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2459         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2460         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2461         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2462         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2463         88  CO-FINAL-LETTER                  VALUE 'F'.
  2464         88  CO-RECONCILING                   VALUE 'R'.
  2465         88  CO-PHONE-CALL                    VALUE 'P'.
  2466         88  CO-LEGAL                         VALUE 'L'.
  2467         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2468         88  CO-WRITE-OFF                     VALUE 'W'.
  2469         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2470
  2471     12  CO-CSR-CODE                       PIC X(4).
  2472
  2473     12  CO-GA-STATUS-INFO.
  2474         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2475         16  CO-GA-TERMINATION-DT          PIC XX.
  2476         16  CO-GA-STATUS-CODE             PIC X.
  2477             88  CO-GA-ACTIVE                 VALUE 'A'.
  2478             88  CO-GA-INACTIVE               VALUE 'I'.
  2479             88  CO-GA-PENDING                VALUE 'P'.
  2480         16  CO-GA-COMMENTS.
  2481             20  CO-GA-COMMENT-1           PIC X(40).
  2482             20  CO-GA-COMMENT-2           PIC X(40).
  2483             20  CO-GA-COMMENT-3           PIC X(40).
  2484             20  CO-GA-COMMENT-4           PIC X(40).
  2485
  2486     12  CO-RPTCD2                         PIC X(10).
  2487     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2488         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2489         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2490
  2491     12  CO-TYPE-AGENT                     PIC X(01).
  2492         88  CO-CORPORATION                   VALUE 'C'.
  2493         88  CO-PARTNERSHIP                   VALUE 'P'.
  2494         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2495         88  CO-TRUST                         VALUE 'T'.
  2496         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2497
  2498     12  CO-FAXNO.
  2499         16  CO-FAX-AREA-CODE                  PIC XXX.
  2500         16  CO-FAX-PREFIX                     PIC XXX.
  2501         16  CO-FAX-PHONE                      PIC X(4).
  2502
  2503     12  CO-BANK-INFORMATION.
  2504         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2505         16  CO-BANK-TRANSIT-NON REDEFINES
  2506             CO-BANK-TRANSIT-NO                PIC 9(8).
  2507
  2508         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2509     12  CO-MISC-DEDUCT-INFO REDEFINES
  2510                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  53
* EL650.cbl
  2511         16  CO-MD-GL-ACCT                     PIC X(10).
  2512         16  CO-MD-DIV                         PIC XX.
  2513         16  CO-MD-CENTER                      PIC X(4).
  2514         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2515         16  CO-CREATE-AP-CHECK                PIC X.
  2516         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2517         16  FILLER                            PIC XXX.
  2518     12  CO-ACH-STATUS                         PIC X.
  2519         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2520         88  CO-ACH-PENDING                        VALUE 'P'.
  2521
  2522     12  CO-BILL-SW                            PIC X.
  2523     12  CO-CONTROL-NAME                       PIC X(30).
  2524     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2525     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2526     12  CO-CLP-STATE                          PIC XX.
  2527     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2528     12  CO-SPP-REFUND-EDIT                    PIC X.
  2529
  2530******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  54
* EL650.cbl
  2532*    COPY ERCNAME.
  2533******************************************************************
  2534*                                                                *
  2535*                                                                *
  2536*                            ERCNAME                             *
  2537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2538*                            VMOD=2.003                          *
  2539*                                                                *
  2540*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2541*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2542*                                                                *
  2543*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2544*                                                                *
  2545*   FILE TYPE = VSAM,KSDS                                        *
  2546*   RECORD SIZE = 160   RECFORM = FIX                            *
  2547*                                                                *
  2548*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2549*                                                                *
  2550*   LOG = NO                                                     *
  2551*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2552*                                                                *
  2553*                                                                *
  2554******************************************************************
  2555
  2556 01  NAME-LOOKUP-MASTER.
  2557     12  NL-RECORD-ID                PIC  X(02).
  2558         88  VALID-NL-ID                         VALUE 'NL'.
  2559
  2560     12  NL-RECORD-KEY.
  2561         16  NL-CONTROL-PRIMARY.
  2562             20  NL-COMPANY-CD       PIC  X(01).
  2563             20  NL-NAME             PIC  X(30).
  2564             20  NL-RECORD-TYPE      PIC  X(01).
  2565                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2566                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2567                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2568
  2569         16  NL-ACCOUNT-MASTER.
  2570             20  NL-AM-COMPANY-CD    PIC  X(01).
  2571             20  NL-AM-CARRIER       PIC  X(01).
  2572             20  NL-AM-GROUPING      PIC  X(06).
  2573             20  NL-AM-STATE         PIC  X(02).
  2574             20  NL-AM-ACCOUNT       PIC  X(10).
  2575             20  FILLER              PIC  X(09).
  2576
  2577         16  NL-COMPENSATION-MASTER
  2578                                 REDEFINES  NL-ACCOUNT-MASTER.
  2579             20  NL-CO-COMPANY-CD    PIC  X(01).
  2580             20  NL-CO-CARRIER       PIC  X(01).
  2581             20  NL-CO-GROUPING      PIC  X(06).
  2582             20  NL-CO-RESP-NO       PIC  X(10).
  2583             20  NL-CO-ACCOUNT       PIC  X(10).
  2584             20  NL-CO-TYPE          PIC  X(01).
  2585
  2586         16  NL-REINSURANCE-RECORD
  2587                                 REDEFINES  NL-ACCOUNT-MASTER.
  2588             20  NL-RE-COMPANY-CD    PIC  X(01).
  2589             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  55
* EL650.cbl
  2590             20  NL-RE-COMPANY.
  2591                 24  NL-RE-COMP      PIC  X(03).
  2592                 24  NL-RE-CO-SUB    PIC  X(03).
  2593             20  NL-RE-TABLE         PIC  X(03).
  2594             20  FILLER              PIC  X(18).
  2595
  2596     12  NL-MAINT-INFORMATION.
  2597         16  NL-LAST-MAINT-DT        PIC  X(02).
  2598         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2599         16  NL-LAST-MAINT-USER      PIC  X(04).
  2600         16  FILLER                  PIC  X(10).
  2601
  2602     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2603         16  NL-RE-LEVEL             PIC  9(02).
  2604
  2605     12  NL-CITY                     PIC  X(15).
  2606     12  NL-ST                       PIC  XX.
  2607
  2608******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  56
* EL650.cbl
  2610*    COPY ERCPLAN.
  2611******************************************************************
  2612*                                                                *
  2613*                                                                *
  2614*                            ERCPLAN                             *
  2615*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2616*                            VMOD=2.003                          *
  2617*                                                                *
  2618*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2619*                                                                *
  2620*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2621*   PLAN MASTER                                                  *
  2622*                                                                *
  2623*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2624*                                                                *
  2625*   FILE TYPE = VSAM,KSDS                                        *
  2626*   RECORD SIZE = 420   RECFORM = FIX                            *
  2627*                                                                *
  2628*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2629*       ALTERNATE PATH1 = N/A                                    *
  2630*                                                                *
  2631*   LOG = NO                                                     *
  2632*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2633*                                                                *
  2634*                                                                *
  2635******************************************************************
  2636
  2637 01  PLAN-MASTER.
  2638     12  PL-RECORD-ID                      PIC XX.
  2639         88  VALID-PL-ID                      VALUE 'PL'.
  2640
  2641     12  PL-CONTROL-PRIMARY.
  2642         16  PL-COMPANY-CD                 PIC X.
  2643         16  PL-MSTR-CNTRL.
  2644             20  PL-CONTROL-A.
  2645                 24  PL-CARRIER            PIC X.
  2646                 24  PL-GROUPING           PIC X(6).
  2647                 24  PL-STATE              PIC XX.
  2648                 24  PL-ACCOUNT            PIC X(10).
  2649             20  PL-BENEFIT-TYPE           PIC X.
  2650             20  PL-BENEFIT-CODE           PIC XX.
  2651             20  PL-REVISION-NO            PIC X(3).
  2652
  2653     12  PL-CONTROL-BY-VAR-GRP.
  2654         16  PL-COMPANY-CD-A1              PIC X.
  2655         16  PL-VG-CARRIER                 PIC X.
  2656         16  PL-VG-GROUPING                PIC X(6).
  2657         16  PL-VG-STATE                   PIC XX.
  2658         16  PL-VG-ACCOUNT                 PIC X(10).
  2659         16  PL-BENEFIT-TYPE-A1            PIC X.
  2660         16  PL-BENEFIT-CODE-A1            PIC XX.
  2661         16  PL-REVISION-NO-A1             PIC 999.
  2662
  2663     12  PL-MAINT-INFORMATION.
  2664         16  PL-LAST-MAINT-DT              PIC XX.
  2665         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2666         16  PL-LAST-MAINT-USER            PIC X(4).
  2667         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  57
* EL650.cbl
  2668
  2669     12  PL-LIABILITY-LIMITS.
  2670         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2671         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2672             20  PL-LM-AGE                 PIC S99        COMP-3.
  2673             20  PL-LM-DUR                 PIC S999       COMP-3.
  2674             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2675             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2676
  2677     12  FILLER                            PIC X(30).
  2678
  2679     12  PL-GL-ACCOUNT-NOS.
  2680         16  PL-PREMIUM-GL                 PIC X(8).
  2681         16  PL-COMM-GL                    PIC X(8).
  2682         16  PL-CLAIM-GL                   PIC X(8).
  2683     12  FILLER                            PIC X(24).
  2684     12  PL-TOLERANCES.
  2685         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2686         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2687         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2688         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2689         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2690         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2691     12  PL-OVER-SHORT.
  2692         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2693         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2694     12  FILLER                            PIC X(24).
  2695     12  PLAN-MISC.
  2696         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2697         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2698         16  PL-IG                         PIC X.
  2699         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2700         16  PL-POLICY-FORM                PIC X(12).
  2701         16  PL-EDIT-FOR-FORM              PIC X(01).
  2702         16  PL-DEV-CODE                   PIC XXX.
  2703         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2704         16  PL-CALC-METHOD                PIC X.
  2705         16  PL-BENEFIT-GROUP              PIC X(05).
  2706         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2707
  2708         16  FILLER                        PIC X(99).
  2709******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  58
* EL650.cbl
  2711*    COPY ELCCNTL.
  2712******************************************************************
  2713*                                                                *
  2714*                                                                *
  2715*                            ELCCNTL.                            *
  2716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2717*                            VMOD=2.059                          *
  2718*                                                                *
  2719*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2720*                                                                *
  2721*   FILE TYPE = VSAM,KSDS                                        *
  2722*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2723*                                                                *
  2724*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2725*       ALTERNATE INDEX = NONE                                   *
  2726*                                                                *
  2727*   LOG = YES                                                    *
  2728*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2729******************************************************************
  2730*                   C H A N G E   L O G
  2731*
  2732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2733*-----------------------------------------------------------------
  2734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2735* EFFECTIVE    NUMBER
  2736*-----------------------------------------------------------------
  2737* 082503                   PEMA  ADD BENEFIT GROUP
  2738* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2739* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2740* 092705    2005050300006  PEMA  ADD SPP LEASES
  2741* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2742* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2743* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2744* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2745* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2746* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2747* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2748* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2749* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2750* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2751******************************************************************
  2752*
  2753 01  CONTROL-FILE.
  2754     12  CF-RECORD-ID                       PIC XX.
  2755         88  VALID-CF-ID                        VALUE 'CF'.
  2756
  2757     12  CF-CONTROL-PRIMARY.
  2758         16  CF-COMPANY-ID                  PIC XXX.
  2759         16  CF-RECORD-TYPE                 PIC X.
  2760             88  CF-COMPANY-MASTER              VALUE '1'.
  2761             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2762             88  CF-STATE-MASTER                VALUE '3'.
  2763             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2764             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2765             88  CF-CARRIER-MASTER              VALUE '6'.
  2766             88  CF-MORTALITY-MASTER            VALUE '7'.
  2767             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2768             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  59
* EL650.cbl
  2769             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2770             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2771             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2772             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2773             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2774             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2775             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2776             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2777             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2778         16  CF-ACCESS-CD-GENL              PIC X(4).
  2779         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2780             20  CF-PROCESSOR               PIC X(4).
  2781         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2782             20  CF-STATE-CODE              PIC XX.
  2783             20  FILLER                     PIC XX.
  2784         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2785             20  FILLER                     PIC XX.
  2786             20  CF-HI-BEN-IN-REC           PIC XX.
  2787         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2788             20  FILLER                     PIC XXX.
  2789             20  CF-CARRIER-CNTL            PIC X.
  2790         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2791             20  FILLER                     PIC XX.
  2792             20  CF-HI-TYPE-IN-REC          PIC 99.
  2793         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2794             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2795                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2796             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2797             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2798         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2799             20  FILLER                     PIC X.
  2800             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2801         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2802             20  FILLER                     PIC XX.
  2803             20  CF-MORTGAGE-PLAN           PIC XX.
  2804         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2805
  2806     12  CF-LAST-MAINT-DT                   PIC XX.
  2807     12  CF-LAST-MAINT-BY                   PIC X(4).
  2808     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2809
  2810     12  CF-RECORD-BODY                     PIC X(728).
  2811
  2812
  2813****************************************************************
  2814*             COMPANY MASTER RECORD                            *
  2815****************************************************************
  2816
  2817     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2818         16  CF-COMPANY-ADDRESS.
  2819             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2820             20  CF-CL-IN-CARE-OF           PIC X(30).
  2821             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2822             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2823             20  CF-CL-CITY-STATE           PIC X(30).
  2824             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2825             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2826         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  60
* EL650.cbl
  2827         16  CF-COMPANY-PASSWORD            PIC X(8).
  2828         16  CF-SECURITY-OPTION             PIC X.
  2829             88  ALL-SECURITY                   VALUE '1'.
  2830             88  COMPANY-VERIFY                 VALUE '2'.
  2831             88  PROCESSOR-VERIFY               VALUE '3'.
  2832             88  NO-SECURITY                    VALUE '4'.
  2833             88  ALL-BUT-TERM                   VALUE '5'.
  2834         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2835             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2836         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2837             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2838         16  CF-INFORCE-LOCATION            PIC X.
  2839             88  CERTS-ARE-ONLINE               VALUE '1'.
  2840             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2841             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2842         16  CF-LOWER-CASE-LETTERS          PIC X.
  2843         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2844             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2845             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2846             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2847             88  CF-ACCNT-CNTL                  VALUE '3'.
  2848             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2849
  2850         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2851         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2852
  2853         16  CF-LGX-CREDIT-USER             PIC X.
  2854             88  CO-IS-NOT-USER                 VALUE 'N'.
  2855             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2856
  2857         16 CF-CREDIT-CALC-CODES.
  2858             20  CF-CR-REM-TERM-CALC PIC X.
  2859               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2860               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2861               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2862               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2863               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2864               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2865               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2866             20  CF-CR-R78-METHOD           PIC X.
  2867               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2868               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2869
  2870         16  CF-CLAIM-CONTROL-COUNTS.
  2871             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2872                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2873
  2874             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2875                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2876
  2877             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2878                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2879
  2880             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2881                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2882
  2883         16  CF-CURRENT-MONTH-END           PIC XX.
  2884
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  61
* EL650.cbl
  2885         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2886             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2887             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2888             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2889             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2890                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2891                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2892             20  CF-CO-PREM-REJECT-SW       PIC X.
  2893                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2894                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2895             20  CF-CO-REF-REJECT-SW        PIC X.
  2896                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2897                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2898
  2899         16  CF-CO-REPORTING-DT             PIC XX.
  2900         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2901         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2902           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2903           88  CF-CO-MONTH-END                  VALUE '1'.
  2904
  2905         16  CF-LGX-CLAIM-USER              PIC X.
  2906             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2907             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2908
  2909         16  CF-CREDIT-EDIT-CONTROLS.
  2910             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2911             20  CF-MIN-AGE                 PIC 99.
  2912             20  CF-DEFAULT-AGE             PIC 99.
  2913             20  CF-MIN-TERM                PIC S999      COMP-3.
  2914             20  CF-MAX-TERM                PIC S999      COMP-3.
  2915             20  CF-DEFAULT-SEX             PIC X.
  2916             20  CF-JOINT-AGE-INPUT         PIC X.
  2917                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2918             20  CF-BIRTH-DATE-INPUT        PIC X.
  2919                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2920             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2921                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2922                 88  CF-ZERO-CARRIER            VALUE '1'.
  2923                 88  CF-ZERO-GROUPING           VALUE '2'.
  2924                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2925             20  CF-EDIT-SW                 PIC X.
  2926                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2927             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2928             20  CF-CR-PR-METHOD            PIC X.
  2929               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2930               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2931             20  FILLER                     PIC X.
  2932
  2933         16  CF-CREDIT-MISC-CONTROLS.
  2934             20  CF-REIN-TABLE-SW           PIC X.
  2935                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2936             20  CF-COMP-TABLE-SW           PIC X.
  2937                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2938             20  CF-EXPERIENCE-RETENTION-AGE
  2939                                            PIC S9        COMP-3.
  2940             20  CF-CONVERSION-DT           PIC XX.
  2941             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2942             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  62
* EL650.cbl
  2943                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2944                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2945
  2946             20  CF-CR-CHECK-NO-CONTROL.
  2947                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2948                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2949                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2950                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2951                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2952                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2953
  2954                 24  CF-CR-CHECK-COUNT       REDEFINES
  2955                     CF-CR-CHECK-COUNTER      PIC X(4).
  2956
  2957                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2958                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2959
  2960                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2961                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2962                 24  CF-MAIL-PROCESSING       PIC X.
  2963                     88  MAIL-PROCESSING          VALUE 'Y'.
  2964
  2965         16  CF-MISC-SYSTEM-CONTROL.
  2966             20  CF-SYSTEM-C                 PIC X.
  2967                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2968             20  CF-SYSTEM-D                 PIC X.
  2969                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2970             20  CF-SOC-SEC-NO-SW            PIC X.
  2971                 88  SOC-SEC-NO-USED             VALUE '1'.
  2972             20  CF-MEMBER-NO-SW             PIC X.
  2973                 88  MEMBER-NO-USED              VALUE '1'.
  2974             20  CF-TAX-ID-NUMBER            PIC X(11).
  2975             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2976             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2977                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2978                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2979                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2980                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2981             20  CF-SYSTEM-E                 PIC X.
  2982                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2983
  2984         16  CF-LGX-LIFE-USER               PIC X.
  2985             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2986             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2987
  2988         16  CF-CR-MONTH-END-DT             PIC XX.
  2989
  2990         16  CF-FILE-MAINT-DATES.
  2991             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2992                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2993             20  CF-LAST-BATCH       REDEFINES
  2994                 CF-LAST-BATCH-NO               PIC X(4).
  2995             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2996             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2997             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2998             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2999             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3000             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  63
* EL650.cbl
  3001             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3002             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3003             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3004             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3005
  3006         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3007         16  FILLER                         PIC X.
  3008
  3009         16  CF-ALT-MORT-CODE               PIC X(4).
  3010         16  CF-MEMBER-CAPTION              PIC X(10).
  3011
  3012         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3013             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3014             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3015             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3016             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3017             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3018
  3019         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3020
  3021         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3022         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3023         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3024         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3025
  3026         16  CF-AH-OVERRIDE-L1              PIC X.
  3027         16  CF-AH-OVERRIDE-L2              PIC XX.
  3028         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3029         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3030
  3031         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3032         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3033
  3034         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3035         16  CF-AR-LAST-EL860-DT            PIC XX.
  3036         16  CF-MP-MONTH-END-DT             PIC XX.
  3037
  3038         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3039         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3040             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3041
  3042         16  CF-AR-MONTH-END-DT             PIC XX.
  3043
  3044         16  CF-CRDTCRD-USER                PIC X.
  3045             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3046             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3047
  3048         16  CF-CC-MONTH-END-DT             PIC XX.
  3049
  3050         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3051
  3052         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3053             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3054             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3055             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3056         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3057         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3058         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  64
* EL650.cbl
  3059         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3060             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3061             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3062         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3063         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3064         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3065             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3066         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3067
  3068         16  CF-CL-ZIP-CODE.
  3069             20  CF-CL-ZIP-PRIME.
  3070                 24  CF-CL-ZIP-1ST          PIC X.
  3071                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3072                 24  FILLER                 PIC X(4).
  3073             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3074         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3075             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3076             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3077             20  FILLER                     PIC XXX.
  3078
  3079         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3080         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3081         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3082         16  CF-CO-OPTION-START-DATE        PIC XX.
  3083         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3084           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3085                                                      '3' '4'.
  3086           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3087           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3088           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3089           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3090           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3091           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3092
  3093         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3094
  3095         16  CF-PAYMENT-APPROVAL-LEVELS.
  3096             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3097             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3098             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3099             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3100             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3101             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3102
  3103         16  CF-END-USER-REPORTING-USER     PIC X.
  3104             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3105             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3106
  3107         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3108             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3109             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3110
  3111         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3112
  3113         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3114         16  FILLER                         PIC X.
  3115
  3116         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  65
* EL650.cbl
  3117             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3118             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3119             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3120
  3121         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3122
  3123         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3124             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3125             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3126
  3127         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3128             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3129             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3130
  3131         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3132
  3133         16  CF-CO-ACH-ID-CODE              PIC  X.
  3134             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3135             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3136             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3137         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3138         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3139         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3140         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3141         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3142         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3143         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3144         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3145         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3146                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3147         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3148                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3149
  3150         16  CF-CO-OVER-SHORT.
  3151             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3152             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3153
  3154*         16  FILLER                         PIC X(102).
  3155         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3156             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3157             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3158
  3159         16  CF-AH-APPROVAL-DAYS.
  3160             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3161             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3162             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3163             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3164
  3165         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3166
  3167         16  CF-APPROV-LEV-5.
  3168             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3169             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3170             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3171
  3172         16  FILLER                         PIC X(68).
  3173****************************************************************
  3174*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  66
* EL650.cbl
  3175****************************************************************
  3176
  3177     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3178         16  CF-PROCESSOR-NAME              PIC X(30).
  3179         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3180         16  CF-PROCESSOR-TITLE             PIC X(26).
  3181         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3182                 88  MESSAGE-YES                VALUE 'Y'.
  3183                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3184
  3185*****************************************************
  3186****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3187****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3188****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3189****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3190*****************************************************
  3191
  3192         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3193             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3194             20  CF-APPLICATION-FORCE       PIC X.
  3195             20  CF-INDIVIDUAL-APP.
  3196                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3197                     28  CF-BROWSE-APP      PIC X.
  3198                     28  CF-UPDATE-APP      PIC X.
  3199
  3200         16  CF-CURRENT-TERM-ON             PIC X(4).
  3201         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3202             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3203             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3204             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3205             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3206             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3207             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3208             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3209         16  CF-PROCESSOR-CARRIER           PIC X.
  3210             88  NO-CARRIER-SECURITY            VALUE ' '.
  3211         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3212             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3213         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3214             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3215         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3216             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3217
  3218         16  CF-PROC-SYS-ACCESS-SW.
  3219             20  CF-PROC-CREDIT-CLAIMS-SW.
  3220                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3221                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3222                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3223                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3224             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3225                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3226                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3227             20  CF-PROC-LIFE-GNRLDGR-SW.
  3228                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3229                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3230                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3231                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3232             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  67
* EL650.cbl
  3233                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3234                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3235         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3236             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3237             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3238         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3239
  3240         16  CF-APPROVAL-LEVEL                  PIC X.
  3241             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3242             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3243             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3244             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3245             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3246
  3247         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3248
  3249         16  CF-LANGUAGE-TYPE                   PIC X.
  3250             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3251             88  CF-LANG-IS-FR                      VALUE 'F'.
  3252
  3253         16  CF-CSR-IND                         PIC X.
  3254         16  FILLER                             PIC X(239).
  3255
  3256****************************************************************
  3257*             PROCESSOR/REMINDERS RECORD                       *
  3258****************************************************************
  3259
  3260     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3261         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3262             20  CF-START-REMIND-DT         PIC XX.
  3263             20  CF-END-REMIND-DT           PIC XX.
  3264             20  CF-REMINDER-TEXT           PIC X(50).
  3265         16  FILLER                         PIC X(296).
  3266
  3267
  3268****************************************************************
  3269*             STATE MASTER RECORD                              *
  3270****************************************************************
  3271
  3272     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3273         16  CF-STATE-ABBREVIATION          PIC XX.
  3274         16  CF-STATE-NAME                  PIC X(25).
  3275         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3276         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3277             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3278             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3279             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3280             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3281                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3282                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3283             20  CF-ST-PREM-REJECT-SW       PIC X.
  3284                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3285                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3286             20  CF-ST-REF-REJECT-SW        PIC X.
  3287                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3288                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3289         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3290         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  68
* EL650.cbl
  3291         16  CF-ST-REFUND-RULES.
  3292             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3293             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3294             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3295         16  CF-ST-FST-PMT-EXTENSION.
  3296             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3297             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3298                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3299                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3300                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3301                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3302         16  CF-ST-STATE-CALL.
  3303             20  CF-ST-CALL-UNEARNED        PIC X.
  3304             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3305             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3306         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3307             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3308             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3309         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3310         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3311         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3312         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3313         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3314         16  FILLER                         PIC X.
  3315         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3316             20  CF-ST-BENEFIT-CD           PIC XX.
  3317             20  CF-ST-BENEFIT-KIND         PIC X.
  3318                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3319                 88  CF-ST-AH-KIND              VALUE 'A'.
  3320             20  CF-ST-REM-TERM-CALC        PIC X.
  3321                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3322                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3323                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3324                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3325                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3326                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3327                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3328                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3329
  3330             20  CF-ST-REFUND-CALC          PIC X.
  3331                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3332                 88  ST-REFD-BY-R78             VALUE '1'.
  3333                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3334                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3335                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3336                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3337                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3338                 88  ST-REFD-UTAH               VALUE '7'.
  3339                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3340                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3341                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3342
  3343             20  CF-ST-EARNING-CALC         PIC X.
  3344                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3345                 88  ST-EARN-BY-R78             VALUE '1'.
  3346                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3347                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3348                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  69
* EL650.cbl
  3349                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3350                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3351                 88  ST-EARN-MEAN               VALUE '8'.
  3352                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3353
  3354             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3355                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3356                 88  ST-OVRD-BY-R78             VALUE '1'.
  3357                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3358                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3359                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3360                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3361                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3362                 88  ST-OVRD-MEAN               VALUE '8'.
  3363                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3364             20  cf-st-extra-periods        pic 9.
  3365*            20  FILLER                     PIC X.
  3366
  3367         16  CF-ST-COMMISSION-CAPS.
  3368             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3369             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3370             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3371             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3372         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3373                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3374
  3375         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3376
  3377         16  CF-ST-STATUTORY-INTEREST.
  3378             20  CF-ST-STAT-DATE-FROM       PIC X.
  3379                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3380                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3381             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3382             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3383             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3384             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3385             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3386
  3387         16  CF-ST-OVER-SHORT.
  3388             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3389             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3390
  3391         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3392
  3393         16  CF-ST-RT-CALC                  PIC X.
  3394
  3395         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3396         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3397         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3398         16  CF-ST-RF-LR-CALC               PIC X.
  3399         16  CF-ST-RF-LL-CALC               PIC X.
  3400         16  CF-ST-RF-LN-CALC               PIC X.
  3401         16  CF-ST-RF-AH-CALC               PIC X.
  3402         16  CF-ST-RF-CP-CALC               PIC X.
  3403*        16  FILLER                         PIC X(206).
  3404*CIDMOD         16  FILLER                         PIC X(192).
  3405         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3406             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  70
* EL650.cbl
  3407         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3408         16  CF-ST-VFY-2ND-BENE             PIC X.
  3409         16  CF-ST-CAUSAL-STATE             PIC X.
  3410         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3411         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3412         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3413             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3414         16  CF-ST-NET-ONLY-STATE           PIC X.
  3415             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3416         16  FILLER                         PIC X(181).
  3417
  3418****************************************************************
  3419*             BENEFIT MASTER RECORD                            *
  3420****************************************************************
  3421
  3422     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3423         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3424             20  CF-BENEFIT-CODE            PIC XX.
  3425             20  CF-BENEFIT-NUMERIC  REDEFINES
  3426                 CF-BENEFIT-CODE            PIC XX.
  3427             20  CF-BENEFIT-ALPHA           PIC XXX.
  3428             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3429             20  CF-BENEFIT-COMMENT         PIC X(10).
  3430
  3431             20  CF-LF-COVERAGE-TYPE        PIC X.
  3432                 88  CF-REDUCING                VALUE 'R'.
  3433                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3434
  3435             20  CF-SPECIAL-CALC-CD         PIC X.
  3436                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3437                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3438                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3439                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3440                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3441                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3442                 88  CF-FARM-PLAN               VALUE 'F'.
  3443                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3444                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3445                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3446                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3447                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3448                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3449                 88  CF-PRUDENTIAL              VALUE 'P'.
  3450                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3451                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3452                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3453                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3454                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3455                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3456
  3457             20  CF-JOINT-INDICATOR         PIC X.
  3458                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3459
  3460*            20  FILLER                     PIC X(12).
  3461             20  cf-maximum-benefits        pic s999 comp-3.
  3462             20  FILLER                     PIC X(09).
  3463             20  CF-BENEFIT-CATEGORY        PIC X.
  3464             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  71
* EL650.cbl
  3465
  3466             20  CF-CO-REM-TERM-CALC        PIC X.
  3467                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3468                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3469                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3470                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3471                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3472
  3473             20  CF-CO-EARNINGS-CALC        PIC X.
  3474                 88  CO-EARN-BY-R78             VALUE '1'.
  3475                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3476                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3477                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3478                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3479                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3480                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3481                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3482
  3483             20  CF-CO-REFUND-CALC          PIC X.
  3484                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3485                 88  CO-REFD-BY-R78             VALUE '1'.
  3486                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3487                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3488                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3489                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3490                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3491                 88  CO-REFD-MEAN               VALUE '8'.
  3492                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3493                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3494                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3495
  3496             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3497                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3498                 88  CO-OVRD-BY-R78             VALUE '1'.
  3499                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3500                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3501                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3502                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3503                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3504                 88  CO-OVRD-MEAN               VALUE '8'.
  3505                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3506
  3507             20  CF-CO-BEN-I-G-CD           PIC X.
  3508                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3509                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3510                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3511
  3512         16  FILLER                         PIC X(304).
  3513
  3514
  3515****************************************************************
  3516*             CARRIER MASTER RECORD                            *
  3517****************************************************************
  3518
  3519     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3520         16  CF-ADDRESS-DATA.
  3521             20  CF-MAIL-TO-NAME            PIC X(30).
  3522             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  72
* EL650.cbl
  3523             20  CF-ADDRESS-LINE-1          PIC X(30).
  3524             20  CF-ADDRESS-LINE-2          PIC X(30).
  3525             20  CF-CITY-STATE              PIC X(30).
  3526             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3527             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3528
  3529         16  CF-CLAIM-NO-CONTROL.
  3530             20  CF-CLAIM-NO-METHOD         PIC X.
  3531                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3532                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3533                 88  CLAIM-NO-SEQ               VALUE '3'.
  3534                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3535             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3536                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3537                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3538                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3539
  3540         16  CF-CHECK-NO-CONTROL.
  3541             20  CF-CHECK-NO-METHOD         PIC X.
  3542                 88  CHECK-NO-MANUAL            VALUE '1'.
  3543                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3544                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3545                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3546             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3547                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3548
  3549         16  CF-DOMICILE-STATE              PIC XX.
  3550
  3551         16  CF-EXPENSE-CONTROLS.
  3552             20  CF-EXPENSE-METHOD          PIC X.
  3553                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3554                 88  DOLLARS-PER-PMT            VALUE '2'.
  3555                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3556                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3557             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3558             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3559
  3560         16  CF-CORRESPONDENCE-CONTROL.
  3561             20  CF-LETTER-RESEND-OPT       PIC X.
  3562                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3563                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3564             20  FILLER                     PIC X(4).
  3565
  3566         16  CF-RESERVE-CONTROLS.
  3567             20  CF-MANUAL-SW               PIC X.
  3568                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3569             20  CF-FUTURE-SW               PIC X.
  3570                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3571             20  CF-PTC-SW                  PIC X.
  3572                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3573             20  CF-IBNR-SW                 PIC X.
  3574                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3575             20  CF-PTC-LF-SW               PIC X.
  3576                 88  CF-LF-PTC-USED             VALUE '1'.
  3577             20  CF-CDT-ACCESS-METHOD       PIC X.
  3578                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3579                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3580                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  73
* EL650.cbl
  3581             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3582
  3583         16  CF-CLAIM-CALC-METHOD           PIC X.
  3584             88  360-PLUS-MONTHS                VALUE '1'.
  3585             88  365-PLUS-MONTHS                VALUE '2'.
  3586             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3587             88  360-DAILY                      VALUE '4'.
  3588             88  365-DAILY                      VALUE '5'.
  3589
  3590         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3591         16  FILLER                         PIC X(11).
  3592
  3593         16  CF-LIMIT-AMOUNTS.
  3594             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3595             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3596             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3597             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3598             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3599             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3600             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3601             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3602             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3603             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3604
  3605         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3606         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3607         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3608
  3609         16  CF-ZIP-CODE.
  3610             20  CF-ZIP-PRIME.
  3611                 24  CF-ZIP-1ST             PIC X.
  3612                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3613                 24  FILLER                 PIC X(4).
  3614             20  CF-ZIP-PLUS4               PIC X(4).
  3615         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3616             20  CF-CAN-POSTAL-1            PIC XXX.
  3617             20  CF-CAN-POSTAL-2            PIC XXX.
  3618             20  FILLER                     PIC XXX.
  3619
  3620         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3621         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3622         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3623
  3624         16  CF-RATING-SWITCH               PIC X.
  3625             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3626             88  CF-NO-RATING                   VALUE 'N'.
  3627
  3628         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3629
  3630         16  CF-CARRIER-OVER-SHORT.
  3631             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3632             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3633
  3634         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3635         16  CF-SECPAY-SWITCH               PIC X.
  3636             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3637             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3638         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  74
* EL650.cbl
  3639         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3640         16  FILLER                         PIC X(444).
  3641*        16  FILLER                         PIC X(452).
  3642
  3643
  3644****************************************************************
  3645*             MORTALITY MASTER RECORD                          *
  3646****************************************************************
  3647
  3648     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3649         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3650                                INDEXED BY CF-MORT-NDX.
  3651             20  CF-MORT-TABLE              PIC X(5).
  3652             20  CF-MORT-TABLE-TYPE         PIC X.
  3653                 88  CF-MORT-JOINT              VALUE 'J'.
  3654                 88  CF-MORT-SINGLE             VALUE 'S'.
  3655                 88  CF-MORT-COMBINED           VALUE 'C'.
  3656                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3657                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3658             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3659             20  CF-MORT-AGE-METHOD         PIC XX.
  3660                 88  CF-AGE-LAST                VALUE 'AL'.
  3661                 88  CF-AGE-NEAR                VALUE 'AN'.
  3662             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3663             20  CF-MORT-ADJUSTMENT-DIRECTION
  3664                                            PIC X.
  3665                 88  CF-MINUS                   VALUE '-'.
  3666                 88  CF-PLUS                    VALUE '+'.
  3667             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3668             20  CF-MORT-JOINT-CODE         PIC X.
  3669                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3670             20  CF-MORT-PC-Q               PIC X.
  3671                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3672             20  CF-MORT-TABLE-CODE         PIC X(4).
  3673             20  CF-MORT-COMMENTS           PIC X(15).
  3674             20  FILLER                     PIC X(14).
  3675
  3676         16  FILLER                         PIC X(251).
  3677
  3678
  3679****************************************************************
  3680*             BUSSINESS TYPE MASTER RECORD                     *
  3681****************************************************************
  3682
  3683     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3684* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3685* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3686* AND RECORD 05 IS TYPES 81-99
  3687         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3688             20  CF-BUSINESS-TITLE          PIC  X(19).
  3689             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3690                                            PIC S9V9(4) COMP-3.
  3691             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3692             20  FILLER                     PIC  X.
  3693         16  FILLER                         PIC  X(248).
  3694
  3695
  3696****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  75
* EL650.cbl
  3697*             TERMINAL MASTER RECORD                           *
  3698****************************************************************
  3699
  3700     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3701
  3702         16  CF-COMPANY-TERMINALS.
  3703             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3704                                  PIC X(4).
  3705         16  FILLER               PIC X(248).
  3706
  3707
  3708****************************************************************
  3709*             LIFE EDIT MASTER RECORD                          *
  3710****************************************************************
  3711
  3712     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3713         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3714             20  CF-LIFE-CODE-IN            PIC XX.
  3715             20  CF-LIFE-CODE-OUT           PIC XX.
  3716         16  FILLER                         PIC X(248).
  3717
  3718
  3719****************************************************************
  3720*             AH EDIT MASTER RECORD                            *
  3721****************************************************************
  3722
  3723     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3724         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3725             20  CF-AH-CODE-IN              PIC XXX.
  3726             20  CF-AH-CODE-OUT             PIC XX.
  3727         16  FILLER                         PIC X(248).
  3728
  3729
  3730****************************************************************
  3731*             CREDIBILITY TABLES                               *
  3732****************************************************************
  3733
  3734     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3735         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3736                             INDEXED BY CF-CRDB-NDX.
  3737             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3738             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3739             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3740         16  FILLER                         PIC  X(332).
  3741
  3742
  3743****************************************************************
  3744*             REPORT CUSTOMIZATION RECORD                      *
  3745****************************************************************
  3746
  3747     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3748         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3749             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3750             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3751             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3752**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3753****       A T-TRANSFER.                                   ****
  3754             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  76
* EL650.cbl
  3755
  3756         16  FILLER                         PIC XX.
  3757
  3758         16  CF-CARRIER-CNTL-OPT.
  3759             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3760                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3761                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3762             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3763                                            PIC X.
  3764         16  CF-GROUP-CNTL-OPT.
  3765             20  CF-GROUP-OPT-SEQ           PIC 9.
  3766                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3767                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3768             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3769                                            PIC X(6).
  3770         16  CF-STATE-CNTL-OPT.
  3771             20  CF-STATE-OPT-SEQ           PIC 9.
  3772                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3773                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3774             20  CF-STATE-SELECT OCCURS 3 TIMES
  3775                                            PIC XX.
  3776         16  CF-ACCOUNT-CNTL-OPT.
  3777             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3778                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3779                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3780             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3781                                            PIC X(10).
  3782         16  CF-BUS-TYP-CNTL-OPT.
  3783             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3784                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3785                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3786             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3787                                            PIC XX.
  3788         16  CF-LF-TYP-CNTL-OPT.
  3789             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3790                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3791                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3792             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3793                                            PIC XX.
  3794         16  CF-AH-TYP-CNTL-OPT.
  3795             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3796                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3797                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3798             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3799                                            PIC XX.
  3800         16  CF-REPTCD1-CNTL-OPT.
  3801             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3802                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3803                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3804             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3805                                            PIC X(10).
  3806         16  CF-REPTCD2-CNTL-OPT.
  3807             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3808                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3809                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3810             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3811                                            PIC X(10).
  3812         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  77
* EL650.cbl
  3813             20  CF-USER1-OPT-SEQ           PIC 9.
  3814                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3815                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3816             20  CF-USER1-SELECT OCCURS 3 TIMES
  3817                                            PIC X(10).
  3818         16  CF-USER2-CNTL-OPT.
  3819             20  CF-USER2-OPT-SEQ           PIC 9.
  3820                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3821                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3822             20  CF-USER2-SELECT OCCURS 3 TIMES
  3823                                            PIC X(10).
  3824         16  CF-USER3-CNTL-OPT.
  3825             20  CF-USER3-OPT-SEQ           PIC 9.
  3826                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3827                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3828             20  CF-USER3-SELECT OCCURS 3 TIMES
  3829                                            PIC X(10).
  3830         16  CF-USER4-CNTL-OPT.
  3831             20  CF-USER4-OPT-SEQ           PIC 9.
  3832                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3833                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3834             20  CF-USER4-SELECT OCCURS 3 TIMES
  3835                                            PIC X(10).
  3836         16  CF-USER5-CNTL-OPT.
  3837             20  CF-USER5-OPT-SEQ           PIC 9.
  3838                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3839                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3840             20  CF-USER5-SELECT OCCURS 3 TIMES
  3841                                            PIC X(10).
  3842         16  CF-REINS-CNTL-OPT.
  3843             20  CF-REINS-OPT-SEQ           PIC 9.
  3844                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3845                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3846             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3847                 24  CF-REINS-PRIME         PIC XXX.
  3848                 24  CF-REINS-SUB           PIC XXX.
  3849
  3850         16  CF-AGENT-CNTL-OPT.
  3851             20  CF-AGENT-OPT-SEQ           PIC 9.
  3852                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3853                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3854             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3855                                            PIC X(10).
  3856
  3857         16  FILLER                         PIC X(43).
  3858
  3859         16  CF-LOSS-RATIO-SELECT.
  3860             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3861             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3862         16  CF-ENTRY-DATE-SELECT.
  3863             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3864             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3865         16  CF-EFFECTIVE-DATE-SELECT.
  3866             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3867             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3868
  3869         16  CF-EXCEPTION-LIST-IND          PIC X.
  3870             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  78
* EL650.cbl
  3871
  3872         16  FILLER                         PIC X(318).
  3873
  3874****************************************************************
  3875*                  EXCEPTION REPORTING RECORD                  *
  3876****************************************************************
  3877
  3878     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3879         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3880             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3881
  3882         16  CF-COMBINED-LIFE-AH-OPT.
  3883             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3884             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3885             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3886             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3887
  3888         16  CF-LIFE-OPT.
  3889             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3890             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3891             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3892             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3893             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3894             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3895             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3896             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3897             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3898             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3899
  3900         16  CF-AH-OPT.
  3901             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3902             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3903             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3904             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3905             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3906             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3907             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3908             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3909             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3910             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3911
  3912         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3913             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3914             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3915             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3916
  3917         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3918
  3919         16  FILLER                         PIC X(673).
  3920
  3921
  3922****************************************************************
  3923*             MORTGAGE SYSTEM PLAN RECORD                      *
  3924****************************************************************
  3925
  3926     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3927         16  CF-PLAN-TYPE                   PIC X.
  3928             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  79
* EL650.cbl
  3929             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3930             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3931         16  CF-PLAN-ABBREV                 PIC XXX.
  3932         16  CF-PLAN-DESCRIPT               PIC X(10).
  3933         16  CF-PLAN-NOTES                  PIC X(20).
  3934         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3935         16  CF-PLAN-UNDERWRITING.
  3936             20  CF-PLAN-TERM-DATA.
  3937                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3938                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3939             20  CF-PLAN-AGE-DATA.
  3940                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3941                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3942                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3943             20  CF-PLAN-BENEFIT-DATA.
  3944                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3945                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3946                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3947                                            PIC S9(7)V99  COMP-3.
  3948         16  CF-PLAN-POLICY-FORMS.
  3949             20  CF-POLICY-FORM             PIC X(12).
  3950             20  CF-MASTER-APPLICATION      PIC X(12).
  3951             20  CF-MASTER-POLICY           PIC X(12).
  3952         16  CF-PLAN-RATING.
  3953             20  CF-RATE-CODE               PIC X(5).
  3954             20  CF-SEX-RATING              PIC X.
  3955                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3956                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3957             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3958             20  CF-SUB-STD-TYPE            PIC X.
  3959                 88  CF-PCT-OF-PREM            VALUE '1'.
  3960                 88  CF-PCT-OF-BENE            VALUE '2'.
  3961         16  CF-PLAN-PREM-TOLERANCES.
  3962             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3963             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3964         16  CF-PLAN-PYMT-TOLERANCES.
  3965             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3966             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3967         16  CF-PLAN-MISC-DATA.
  3968             20  FILLER                     PIC X.
  3969             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3970             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3971         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3972         16  CF-PLAN-IND-GRP                PIC X.
  3973             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3974                                                     '1'.
  3975             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3976                                                     '2'.
  3977         16  CF-MIB-SEARCH-SW               PIC X.
  3978             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3979             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3980             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3981             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3982         16  CF-ALPHA-SEARCH-SW             PIC X.
  3983             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3984             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3985             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3986             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  80
* EL650.cbl
  3987             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3988             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3989             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3990             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3991             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3992             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3993                                                     'A' 'B' 'C'
  3994                                                     'X' 'Y' 'Z'.
  3995         16  CF-EFF-DT-RULE-SW              PIC X.
  3996             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3997             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3998             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3999             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4000             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4001         16  FILLER                         PIC X(4).
  4002         16  CF-HEALTH-QUESTIONS            PIC X.
  4003             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4004         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4005         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4006         16  CF-PLAN-SNGL-JNT               PIC X.
  4007             88  CF-COMBINED-PLAN              VALUE 'C'.
  4008             88  CF-JNT-PLAN                   VALUE 'J'.
  4009             88  CF-SNGL-PLAN                  VALUE 'S'.
  4010         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4011         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4012         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4013         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4014         16  CF-RERATE-CNTL                 PIC  X.
  4015             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4016             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4017             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4018             88  CF-AUTO-RECALC                 VALUE '4'.
  4019         16  CF-BENEFIT-TYPE                PIC  X.
  4020             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4021             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4022         16  CF-POLICY-FEE                  PIC S999V99
  4023                                                    COMP-3.
  4024         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4025         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4026         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4027         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4028         16  FILLER                         PIC  X(32).
  4029         16  CF-TERMINATION-FORM            PIC  X(04).
  4030         16  FILLER                         PIC  X(08).
  4031         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4032                                                       COMP-3.
  4033         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4034         16  CF-ISSUE-LETTER                PIC  X(4).
  4035         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4036         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4037             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4038             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4039         16  CF-MP-REFUND-CALC              PIC X.
  4040             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4041             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4042             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4043             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4044             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  81
* EL650.cbl
  4045             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4046             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4047             88  CF-MP-REFD-MEAN                VALUE '8'.
  4048         16  CF-ALT-RATE-CODE               PIC  X(5).
  4049
  4050
  4051         16  FILLER                         PIC X(498).
  4052****************************************************************
  4053*             MORTGAGE COMPANY MASTER RECORD                   *
  4054****************************************************************
  4055
  4056     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4057         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4058         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4059             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4060             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4061             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4062             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4063             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4064
  4065         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4066         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4067         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4068         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4069         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4070
  4071         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4072             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4073         16  CF-MP-RECON-USE-IND            PIC X(1).
  4074             88  CF-MP-USE-RECON             VALUE 'Y'.
  4075         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4076             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4077         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4078             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4079             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4080         16  FILLER                         PIC X(1).
  4081         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4082             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4083         16  CF-MORTG-MIB-VERSION           PIC X.
  4084             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4085             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4086             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4087         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4088             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4089                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4090             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4091                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4092             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4093                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4094             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4095                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4096             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4097                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4098             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4099                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4100         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4101         16  FILLER                         PIC X(7).
  4102         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  82
* EL650.cbl
  4103             20  CF-MORTG-MIB-COMM          PIC X(5).
  4104             20  CF-MORTG-MIB-TERM          PIC X(5).
  4105         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4106             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4107         16  FILLER                         PIC X(03).
  4108         16  CF-MP-CHECK-NO-CONTROL.
  4109             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4110                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4111                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4112                                                ' ' LOW-VALUES.
  4113                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4114                                               VALUE '3'.
  4115         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4116         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4117         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4118             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4119                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4120             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4121                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4122             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4123                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4124             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4125                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4126             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4127                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4128             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4129                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4130         16  CF-MORTG-BILLING-AREA.
  4131             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4132                                            PIC X.
  4133         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4134         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4135         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4136         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4137             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4138             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4139         16  FILLER                         PIC X.
  4140         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4141             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4142             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4143         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4144         16  FILLER                         PIC X(8).
  4145         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4146         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4147         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4148         16  CF-ACH-COMPANY-ID.
  4149             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4150                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4151                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4152                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4153             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4154         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4155             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4156         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4157             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4158             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4159         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4160         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  83
* EL650.cbl
  4161         16  FILLER                         PIC X(536).
  4162
  4163****************************************************************
  4164*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4165****************************************************************
  4166
  4167     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4168         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4169             20  CF-FEMALE-HEIGHT.
  4170                 24  CF-FEMALE-FT           PIC 99.
  4171                 24  CF-FEMALE-IN           PIC 99.
  4172             20  CF-FEMALE-MIN-WT           PIC 999.
  4173             20  CF-FEMALE-MAX-WT           PIC 999.
  4174         16  FILLER                         PIC X(428).
  4175
  4176     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4177         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4178             20  CF-MALE-HEIGHT.
  4179                 24  CF-MALE-FT             PIC 99.
  4180                 24  CF-MALE-IN             PIC 99.
  4181             20  CF-MALE-MIN-WT             PIC 999.
  4182             20  CF-MALE-MAX-WT             PIC 999.
  4183         16  FILLER                         PIC X(428).
  4184******************************************************************
  4185*             AUTOMATIC ACTIVITY RECORD                          *
  4186******************************************************************
  4187     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4188         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4189             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4190             20  CF-SYS-LETTER-ID           PIC X(04).
  4191             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4192             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4193             20  CF-SYS-RESET-SW            PIC X(01).
  4194             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4195             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4196
  4197         16  FILLER                         PIC X(50).
  4198
  4199         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4200             20  CF-USER-ACTIVE-SW          PIC X(01).
  4201             20  CF-USER-LETTER-ID          PIC X(04).
  4202             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4203             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4204             20  CF-USER-RESET-SW           PIC X(01).
  4205             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4206             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4207             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4208
  4209         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  84
* EL650.cbl
  4211*    COPY ERCPNDB.
  4212******************************************************************
  4213*                                                                *
  4214*                                                                *
  4215*                            ERCPNDB.                            *
  4216*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4217*                            VMOD=2.025                          *
  4218*                                                                *
  4219*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4220*                                                                *
  4221******************************************************************
  4222*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4223*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4224******************************************************************
  4225*                                                                *
  4226*                                                                *
  4227*   FILE TYPE = VSAM,KSDS                                        *
  4228*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4229*                                                                *
  4230*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4231*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4232*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4233*                                                 RKP=13,LEN=36  *
  4234*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4235*                                      AND CHG-SEQ.)             *
  4236*                                                RKP=49,LEN=11   *
  4237*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4238*                                      AND CHG-SEQ.)             *
  4239*                                                RKP=60,LEN=15   *
  4240*                                                                *
  4241*   LOG = NO                                                     *
  4242*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4243******************************************************************
  4244******************************************************************
  4245*                   C H A N G E   L O G
  4246*
  4247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4248*-----------------------------------------------------------------
  4249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4250* EFFECTIVE    NUMBER
  4251*-----------------------------------------------------------------
  4252* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4253* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4254* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4255* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4256* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4257* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4258* 032306                   PEMA  ADD BOW LOAN NUMBER
  4259* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4260* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4261* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4262* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4263* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4264* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4265* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4266* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4267* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4268* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  85
* EL650.cbl
  4269******************************************************************
  4270
  4271 01  PENDING-BUSINESS.
  4272     12  PB-RECORD-ID                     PIC XX.
  4273         88  VALID-PB-ID                        VALUE 'PB'.
  4274
  4275     12  PB-CONTROL-PRIMARY.
  4276         16  PB-COMPANY-CD                PIC X.
  4277         16  PB-ENTRY-BATCH               PIC X(6).
  4278         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4279         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4280
  4281     12  PB-CONTROL-BY-ACCOUNT.
  4282         16  PB-COMPANY-CD-A1             PIC X.
  4283         16  PB-CARRIER                   PIC X.
  4284         16  PB-GROUPING.
  4285             20  PB-GROUPING-PREFIX       PIC XXX.
  4286             20  PB-GROUPING-PRIME        PIC XXX.
  4287         16  PB-STATE                     PIC XX.
  4288         16  PB-ACCOUNT.
  4289             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4290             20  PB-ACCOUNT-PRIME         PIC X(6).
  4291         16  PB-CERT-EFF-DT               PIC XX.
  4292         16  PB-CERT-NO.
  4293             20  PB-CERT-PRIME            PIC X(10).
  4294             20  PB-CERT-SFX              PIC X.
  4295         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4296
  4297         16  PB-RECORD-TYPE               PIC X.
  4298             88  PB-MAILING-DATA                VALUE '0'.
  4299             88  PB-ISSUE                       VALUE '1'.
  4300             88  PB-CANCELLATION                VALUE '2'.
  4301             88  PB-BATCH-TRAILER               VALUE '9'.
  4302
  4303     12  PB-CONTROL-BY-ORIG-BATCH.
  4304         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4305         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4306         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4307         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4308
  4309     12  PB-CONTROL-BY-CSR.
  4310         16  PB-CSR-COMPANY-CD            PIC X.
  4311         16  PB-CSR-ID                    PIC X(4).
  4312         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4313         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4314         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4315******************************************************************
  4316*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4317******************************************************************
  4318
  4319     12  PB-LAST-MAINT-DT                 PIC XX.
  4320     12  PB-LAST-MAINT-BY                 PIC X(4).
  4321     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4322
  4323     12  PB-RECORD-BODY                   PIC X(375).
  4324
  4325     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4326         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  86
* EL650.cbl
  4327             88  CLASIC-CREATED-CERT         VALUE '1'.
  4328         16  PB-I-NAME.
  4329             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4330             20  PB-I-INSURED-FIRST-NAME.
  4331                 24  PB-I-INSURED-1ST-INIT PIC X.
  4332                 24  FILLER                PIC X(9).
  4333             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4334         16  PB-I-AGE                     PIC S99   COMP-3.
  4335         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4336         16  PB-I-BIRTHDAY                PIC XX.
  4337         16  PB-I-INSURED-SEX             PIC X.
  4338             88  PB-SEX-MALE     VALUE 'M'.
  4339             88  PB-SEX-FEMALE   VALUE 'F'.
  4340
  4341         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4342         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4343         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4344         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4345         16  PB-I-SKIP-CODE               PIC X.
  4346             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4347             88  PB-SKIP-JULY              VALUE '1'.
  4348             88  PB-SKIP-AUGUST            VALUE '2'.
  4349             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4350             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4351             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4352             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4353             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4354             88  PB-SKIP-JUNE              VALUE '8'.
  4355             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4356             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4357             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4358         16  PB-I-TERM-TYPE               PIC X.
  4359             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4360             88  PB-PAID-WEEKLY            VALUE 'W'.
  4361             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4362             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4363             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4364         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4365         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4366         16  PB-I-DATA-ENTRY-SW           PIC X.
  4367             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4368             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4369             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4370             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4371         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4372         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4373*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4374         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4375         16  FILLER                       PIC X.
  4376
  4377         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4378             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4379             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4380                                                   '90' THRU '99'.
  4381         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4382                                          PIC XX.
  4383         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4384         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  87
* EL650.cbl
  4385                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4386         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4387         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4388                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4389         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4390         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4391         16  PB-I-CLP-AMOUNT REDEFINES
  4392                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4393         16  PB-I-LF-CALC-FLAG            PIC X.
  4394             88 PB-COMP-LF-PREM               VALUE '?'.
  4395         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4396         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4397         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4398         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4399         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4400         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4401         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4402         16  PB-I-LF-ABBR                 PIC XXX.
  4403         16  PB-I-LF-INPUT-CD             PIC XX.
  4404
  4405         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4406             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4407             88  PB-INVALID-AH               VALUE '  ' '00'
  4408                                                   '90' THRU '99'.
  4409         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4410         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4411         16  PB-I-AH-CALC-FLAG            PIC X.
  4412             88 PB-COMP-AH-PREM                  VALUE '?'.
  4413         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4414         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4415         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4416         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4417         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4418         16  PB-I-AH-ABBR                 PIC XXX.
  4419         16  PB-I-AH-INPUT-CD             PIC XXX.
  4420
  4421         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4422         16  PB-I-REIN-TABLE              PIC XXX.
  4423         16  PB-I-BUSINESS-TYPE           PIC 99.
  4424         16  PB-I-INDV-GRP-CD             PIC X.
  4425         16  PB-I-MORT-CODE.
  4426             20  PB-I-TABLE               PIC X.
  4427             20  PB-I-INTEREST            PIC XX.
  4428             20  PB-I-MORT-TYP            PIC X.
  4429         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4430         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4431         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4432         16  PB-I-INDV-GRP-OVRD           PIC X.
  4433         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4434         16  PB-I-SIG-SW                  PIC X.
  4435             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4436         16  PB-I-RATE-CLASS              PIC XX.
  4437         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4438         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4439         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4440         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4441         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4442         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  88
* EL650.cbl
  4443         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4444         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4445         16  PB-I-OB-FLAG                 PIC X.
  4446             88  PB-I-OB                      VALUE 'B'.
  4447             88  PB-I-SUMMARY                 VALUE 'Z'.
  4448         16  PB-I-ENTRY-STATUS            PIC X.
  4449             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4450                                              'M' '5' '9' '2'.
  4451             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4452             88  PB-I-POLICY-PENDING          VALUE '2'.
  4453             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4454             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4455             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4456             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4457             88  PB-I-REIN-ONLY               VALUE '9'.
  4458             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4459             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4460             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4461             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4462         16  PB-I-INT-CODE                PIC X.
  4463             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4464             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4465         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4466         16  PB-I-SOC-SEC-NO              PIC X(11).
  4467         16  PB-I-MEMBER-NO               PIC X(12).
  4468         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4469*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4470         16  PB-I-OLD-LOF                 PIC XXX.
  4471         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4472         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4473         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4474         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4475         16  PB-I-LIFE-INDICATOR          PIC X.
  4476             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4477         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4478         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4479                                          PIC S9(5)V99    COMP-3.
  4480         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4481             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4482             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4483         16  PB-I-1ST-PMT-DT              PIC XX.
  4484         16  PB-I-JOINT-INSURED.
  4485             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4486             20 PB-I-JOINT-FIRST-NAME.
  4487                24  PB-I-JOINT-FIRST-INIT PIC X.
  4488                24  FILLER                PIC X(9).
  4489             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4490*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4491         16  PB-I-BENEFICIARY-NAME.
  4492             20  PB-I-BANK-NUMBER         PIC X(10).
  4493             20  FILLER                   PIC X(15).
  4494         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4495         16  PB-I-REFERENCE               PIC X(12).
  4496         16  FILLER REDEFINES PB-I-REFERENCE.
  4497             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4498             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4499             20  PB-I-CLP-STATE           PIC XX.
  4500         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  89
* EL650.cbl
  4501             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4502             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4503             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4504         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4505         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4506         16  PB-I-RESIDENT-STATE          PIC XX.
  4507         16  PB-I-RATE-CODE               PIC X(4).
  4508         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4509         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4510         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4511         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4512         16  PB-I-BANK-NOCHRGB            PIC 99.
  4513         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4514         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4515
  4516     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4517         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4518             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4519         16  PB-C-CANCEL-ORIGIN           PIC X.
  4520             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4521         16  PB-C-LF-CANCEL-DT            PIC XX.
  4522         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4523         16  PB-C-LF-CALC-REQ             PIC X.
  4524             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4525         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4526         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4527         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4528             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4529         16  PB-C-AH-CANCEL-DT            PIC XX.
  4530         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4531         16  PB-C-AH-CALC-REQ             PIC X.
  4532             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4533         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4534         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4535         16  PB-C-LAST-NAME               PIC X(15).
  4536         16  PB-C-REFUND-SW               PIC X.
  4537             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4538             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4539         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4540         16  PB-C-PAYEE-CODE              PIC X(6).
  4541         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4542         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4543         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4544         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4545         16  PB-C-REFERENCE               PIC X(12).
  4546         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4547         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4548         16  PB-C-POST-CARD-IND           PIC X.
  4549         16  PB-C-CANCEL-REASON           PIC X.
  4550         16  PB-C-REF-INTERFACE-SW        PIC X.
  4551         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4552         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4553         16  FILLER                       PIC X(01).
  4554*        16  FILLER                       PIC X(18).
  4555         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4556*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4557         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4558         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  90
* EL650.cbl
  4559             20  PB-CI-INSURED-NAME.
  4560                 24  PB-CI-LAST-NAME      PIC X(15).
  4561                 24  PB-CI-INITIALS       PIC XX.
  4562             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4563             20  PB-CI-INSURED-SEX        PIC X.
  4564             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4565             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4566             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4567             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4568             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4569             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4570             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4571             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4572             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4573             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4574             20  PB-CI-RATE-CLASS         PIC XX.
  4575             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4576             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4577             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4578             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4579             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4580             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4581             20  PB-CI-LF-ABBR            PIC X(3).
  4582             20  PB-CI-AH-ABBR            PIC X(3).
  4583             20  PB-CI-OB-FLAG            PIC X.
  4584                 88  PB-CI-OB                VALUE 'B'.
  4585             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4586                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4587                                           'M' '4' '5' '9' '2'.
  4588                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4589                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4590                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4591                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4592                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4593                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4594                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4595                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4596                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4597                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4598                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4599                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4600                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4601             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4602                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4603                                           'M' '4' '5' '9' '2'.
  4604                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4605                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4606                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4607                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4608                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4609                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4610                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4611                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4612                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4613                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4614                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4615                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4616                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  91
* EL650.cbl
  4617             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4618             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4619             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4620             20  PB-CI-MEMBER-NO          PIC X(12).
  4621             20  PB-CI-INT-CODE           PIC X.
  4622                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4623                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4624             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4625             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4626             20  PB-CI-COMP-EXCP-SW       PIC X.
  4627                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4628                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4629             20  PB-CI-ENTRY-STATUS       PIC X.
  4630             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4631             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4632             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4633             20  PB-CI-DEATH-DT           PIC XX.
  4634             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4635             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4636             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4637             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4638             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4639             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4640             20  PB-CI-ENTRY-DT              PIC XX.
  4641             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4642             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4643             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4644             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4645             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4646             20  PB-CI-OLD-LOF               PIC XXX.
  4647*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4648             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4649             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4650             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4651             20  PB-CI-INDV-GRP-CD           PIC X.
  4652             20  PB-CI-BENEFICIARY-NAME.
  4653                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4654                 24  FILLER                  PIC X(15).
  4655             20  PB-CI-NOTE-SW               PIC X.
  4656             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4657             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4658             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4659             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4660             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4661             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4662             20  PB-CI-FIRST-NAME            PIC X(10).
  4663             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4664
  4665         16  FILLER                       PIC X(13).
  4666*032306  16  FILLER                       PIC X(27).
  4667*        16  FILLER                       PIC X(46).
  4668
  4669     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4670         16  FILLER                       PIC X(10).
  4671         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4672         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4673         16  PB-M-INSURED-MID-INIT        PIC X.
  4674         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  92
* EL650.cbl
  4675         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4676         16  PB-M-INSURED-SEX             PIC X.
  4677         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4678         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4679         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4680         16  PB-M-INSURED-CITY-STATE.
  4681             20  PB-M-INSURED-CITY        PIC X(28).
  4682             20  PB-M-INSURED-STATE       PIC XX.
  4683         16  PB-M-INSURED-ZIP-CODE.
  4684             20  PB-M-INSURED-ZIP-PRIME.
  4685                 24  PB-M-INSURED-ZIP-1   PIC X.
  4686                     88  PB-M-CANADIAN-POST-CODE
  4687                                             VALUE 'A' THRU 'Z'.
  4688                 24  FILLER               PIC X(4).
  4689             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4690         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4691                                        PB-M-INSURED-ZIP-CODE.
  4692             20  PM-M-INS-CAN-POST1       PIC XXX.
  4693             20  PM-M-INS-CAN-POST2       PIC XXX.
  4694             20  FILLER                   PIC XXX.
  4695         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4696         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4697         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4698         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4699         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4700         16  PB-M-CRED-BENE-CITYST.
  4701             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4702             20  PB-M-CRED-BENE-STATE     PIC XX.
  4703         16  FILLER                       PIC X(92).
  4704
  4705     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4706         16  FILLER                       PIC X(10).
  4707         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4708         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4709         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4710         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4711         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4712         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4713         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4714         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4715         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4716         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4717         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4718         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4719         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4720         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4721         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4722         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4723         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4724         16  PB-ACCOUNT-NAME              PIC X(30).
  4725         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4726         16  PB-REFERENCE                 PIC X(12).
  4727         16  PB-B-RECEIVED-DT             PIC XX.
  4728         16  FILLER                       PIC X(234).
  4729
  4730     12  PB-RECORD-STATUS.
  4731         16  PB-CREDIT-SELECT-DT          PIC XX.
  4732         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  93
* EL650.cbl
  4733         16  PB-BILLED-DT                 PIC XX.
  4734         16  PB-BILLING-STATUS            PIC X.
  4735             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4736             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4737             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4738         16  PB-RECORD-BILL               PIC X.
  4739             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4740             88  PB-RECORD-RETURNED           VALUE 'R'.
  4741             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4742             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4743             88  PB-OVERRIDE-AH               VALUE 'A'.
  4744             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4745         16  PB-BATCH-ENTRY               PIC X.
  4746             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4747             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4748             88  PB-REISSUED-CERT             VALUE 'E'.
  4749             88  PB-CASH-CERT                 VALUE 'C'.
  4750             88  PB-MONTHLY-CERT              VALUE 'M'.
  4751             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4752             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4753             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4754         16  PB-FORCE-CODE                PIC X.
  4755             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4756             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4757             88  PB-CANCEL-FORCE              VALUE '8'.
  4758             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4759             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4760             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4761             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4762             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4763             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4764             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4765         16  PB-FATAL-FLAG                PIC X.
  4766             88  PB-FATAL-ERRORS              VALUE 'X'.
  4767         16  PB-FORCE-ER-CD               PIC X.
  4768             88  PB-FORCE-ERRORS              VALUE 'F'.
  4769             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4770         16  PB-WARN-ER-CD                PIC X.
  4771             88  PB-WARNING-ERRORS            VALUE 'W'.
  4772         16  FILLER                       PIC X.
  4773         16  PB-OUT-BAL-CD                PIC X.
  4774             88  PB-OUT-OF-BAL                VALUE 'O'.
  4775         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4776         16  PB-AH-OVERRIDE-L1            PIC X.
  4777         16  PB-INPUT-DT                  PIC XX.
  4778         16  PB-INPUT-BY                  PIC X(4).
  4779         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4780         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4781         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4782         16  PB-LF-EARNING-METHOD         PIC X.
  4783         16  PB-AH-EARNING-METHOD         PIC X.
  4784         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4785         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4786         16  PB-REIN-CD                   PIC XXX.
  4787         16  PB-LF-REFUND-TYPE            PIC X.
  4788         16  PB-AH-REFUND-TYPE            PIC X.
  4789         16  PB-ACCT-EFF-DT               PIC XX.
  4790         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  94
* EL650.cbl
  4791         16  PB-COMPANY-ID                PIC X(3).
  4792         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4793         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4794         16  PB-SV-CARRIER                PIC X.
  4795         16  PB-SV-GROUPING               PIC X(6).
  4796         16  PB-SV-STATE                  PIC XX.
  4797         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4798         16  PB-GA-BILLING-INFO.
  4799             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4800                                          PIC XX.
  4801         16  PB-SV-REMIT-TO  REDEFINES
  4802             PB-GA-BILLING-INFO           PIC X(10).
  4803         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4804         16  PB-I-LOAN-OFFICER            PIC X(5).
  4805         16  PB-I-VIN                     PIC X(17).
  4806
  4807         16  FILLER                       PIC X(04).
  4808         16  IMNET-BYPASS-SW              PIC X.
  4809
  4810******************************************************************
  4811*                COMMON EDIT ERRORS                              *
  4812******************************************************************
  4813
  4814     12  PB-COMMON-ERRORS.
  4815         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4816                                           PIC S9(4)     COMP.
  4817
  4818******************************************************************
  4819*EJECT
  4820*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  95
* EL650.cbl
  4822 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4823                          COMPENSATION-MASTER
  4824                          NAME-LOOKUP-MASTER PLAN-MASTER
  4825                          CONTROL-FILE PENDING-BUSINESS.
  4826 0000-DFHEXIT SECTION.
  4827     MOVE '9#                    $   ' TO DFHEIV0.
  4828     MOVE 'EL650' TO DFHEIV1.
  4829     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4830
  4831     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4832     INITIALIZE  TEMP-STORAGE-RECORD.
  4833
  4834     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4835     MOVE '5'                    TO  DC-OPTION-CODE.
  4836
  4837     PERFORM 9700-DATE-CONVERSION.
  4838
  4839     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4840     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4841     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4842     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4843*    display ' beginning of program el650   '
  4844
  4845     IF EIBCALEN  =  0
  4846         GO TO 8800-UNAUTHORIZED-ACCESS.
  4847
  4848     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4849     MOVE EIBTRMID               TO  TS-TERM.
  4850     MOVE LOW-VALUES             TO  EL650AI.
  4851
  4852     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4853         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4854
  4855     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4856         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4857             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4858             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4859             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4860             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4861             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4862             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4863             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4864             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4865             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4866             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4867                                            PI-LINE-SELECTED
  4868             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4869             MOVE 1                     TO  PI-PAGE-NUMBER
  4870         ELSE
  4871             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4872             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4873             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4874             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4875             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4876             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4877             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4878             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4879
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  96
* EL650.cbl
  4880**************************************************************
  4881*               CLIENT "DMD" CUSTOM CODE
  4882* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4883* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4884*              CSO CR# 6475
  4885     IF EIBTRNID  =  EL608-TRANS-ID
  4886         MOVE 1                     TO RETURN-FROM-SW
  4887         MOVE 'Y'                   TO FROM-EL608-SW
  4888         MOVE TRANS-ID              TO EIBTRNID
  4889         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4890         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4891                                       KEY-SAVE
  4892         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4893                                       PI-ACCT-REST-OF-EXP
  4894                                       PI-DATE-RANGE-TABLE
  4895
  4896* EXEC CICS  HANDLE CONDITION
  4897*            NOTFND   (5340-END)
  4898*            ENDFILE  (5330-NOT-FOUND)
  4899*        END-EXEC
  4900*    MOVE '"$I''                  ! " #00004891' TO DFHEIV0
  4901     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4903     MOVE X'2220233030303034383931' TO DFHEIV0(25:11)
  4904     CALL 'kxdfhei1' USING DFHEIV0
  4905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4906         MOVE 'Y'                   TO FIRST-TIME-SW
  4907         MOVE ZEROS                 TO PI-TOTAL-LINES
  4908         SET T-INDEX
  4909             TS-INDEX  TO  +1
  4910         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4911         MOVE 1                     TO PI-PAGE-NUMBER
  4912         MOVE 'S'                   TO PI-MAINT
  4913         MOVE DFHPF1                TO EIBAID
  4914         GO TO 1002-SHOW-NEW-RECORDS.
  4915*    END OF CLIENT "DMD" CUSTOM CODE
  4916**************************************************************
  4917
  4918     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4919                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4920                        XCTL-6508
  4921         MOVE 1                     TO  RETURN-FROM-SW
  4922         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4923         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4924         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4925         GO TO 1002-SHOW-NEW-RECORDS.
  4926
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  97
* EL650.cbl
  4928     IF EIBTRNID  NOT =  TRANS-ID
  4929         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4930            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4931            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4932            EIBTRNID  NOT = VP6311-TRANS-ID AND
  4933            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4934            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4935            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4936            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4937            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4938            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4939            EIBTRNID  NOT = EL6509-TRANS-ID
  4940            AND EIBTRNID NOT = EL6503-TRANS-ID
  4941             GO TO 8100-SEND-INITIAL-MAP
  4942         ELSE
  4943             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4944                 GO TO 8100-SEND-INITIAL-MAP
  4945             ELSE
  4946                 MOVE 'S'             TO  MAINTI
  4947                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4948                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4949                 MOVE PI-CR-STATE     TO  ASTATEI
  4950                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4951                 MOVE +1              TO  ACARIERL
  4952                                          MAINTL
  4953                 MOVE +6              TO  AGROUPL
  4954                 MOVE +2              TO  ASTATEL
  4955                 MOVE +10             TO  AACCTL
  4956                 GO TO 0330-EDIT-DATA.
  4957
  4958
  4959* EXEC CICS  HANDLE CONDITION
  4960*        PGMIDERR  (9600-PGMID-ERROR)
  4961*        ERROR     (9990-ABEND)
  4962*    END-EXEC.
  4963*    MOVE '"$L.                  ! # #00004947' TO DFHEIV0
  4964     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4966     MOVE X'2320233030303034393437' TO DFHEIV0(25:11)
  4967     CALL 'kxdfhei1' USING DFHEIV0
  4968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4969
  4970
  4971     IF EIBAID  = DFHCLEAR
  4972         GO TO 9400-CLEAR.
  4973
  4974     IF PI-PROCESSOR-ID  =  'LGXX'
  4975         GO TO 0200-RECEIVE.
  4976
  4977
  4978* EXEC CICS  READQ TS
  4979*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4980*        INTO    (SECURITY-CONTROL)
  4981*        LENGTH  (SC-COMM-LENGTH)
  4982*        ITEM    (SC-ITEM)
  4983*    END-EXEC.
  4984*    MOVE '*$II   L              ''   #00004958' TO DFHEIV0
  4985     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  98
* EL650.cbl
  4986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4987     MOVE X'2020233030303034393538' TO DFHEIV0(25:11)
  4988     CALL 'kxdfhei1' USING DFHEIV0,
  4989           PI-SECURITY-TEMP-STORE-ID,
  4990           SECURITY-CONTROL,
  4991           SC-COMM-LENGTH,
  4992           SC-ITEM,
  4993           DFHEIV99,
  4994           DFHEIV99
  4995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4996
  4997
  4998     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4999     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  5000
  5001     IF NOT DISPLAY-CAP
  5002         MOVE 'READ'             TO  SM-READ
  5003         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5004         MOVE ER-0070            TO  EMI-ERROR
  5005         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5006         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page  99
* EL650.cbl
  5008 0200-RECEIVE.
  5009     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  5010         MOVE ER-0008            TO  EMI-ERROR
  5011         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5012         MOVE -1                 TO  MAINTL
  5013         GO TO 8200-SEND-DATAONLY.
  5014
  5015
  5016* EXEC CICS  RECEIVE
  5017*        MAP     (MAP-NAME)
  5018*        MAPSET  (MAPSET-NAME)
  5019*        INTO    (EL650AI)
  5020*    END-EXEC.
  5021     MOVE LENGTH OF
  5022      EL650AI
  5023       TO DFHEIV11
  5024*    MOVE '8"T I  L              ''   #00004982' TO DFHEIV0
  5025     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5027     MOVE X'2020233030303034393832' TO DFHEIV0(25:11)
  5028     CALL 'kxdfhei1' USING DFHEIV0,
  5029           MAP-NAME,
  5030           EL650AI,
  5031           DFHEIV11,
  5032           MAPSET-NAME,
  5033           DFHEIV99,
  5034           DFHEIV99
  5035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5036
  5037
  5038     IF PFENTERL  = ZERO
  5039         GO TO 0300-CHECK-PFKEYS.
  5040
  5041     IF EIBAID  NOT = DFHENTER
  5042         MOVE ER-0004            TO  EMI-ERROR
  5043         GO TO 0320-INPUT-ERROR.
  5044
  5045     IF (PFENTERI NUMERIC)
  5046       AND  (PFENTERI GREATER ZERO AND LESS 25)
  5047         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  5048     ELSE
  5049         MOVE ER-0029               TO  EMI-ERROR
  5050         GO TO 0320-INPUT-ERROR.
  5051
  5052 0300-CHECK-PFKEYS.
  5053     IF EIBAID  = DFHPF23
  5054         GO TO 8810-PF23.
  5055
  5056     IF EIBAID  = DFHPF24
  5057         GO TO 9200-RETURN-MAIN-MENU.
  5058
  5059     IF EIBAID  = DFHPF12
  5060         GO TO 9500-PF12.
  5061
  5062     IF MAINTL  NOT = ZERO   AND
  5063        MAINTI  NOT = SPACE  AND
  5064        EIBAID  NOT = DFHENTER
  5065          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 100
* EL650.cbl
  5066          GO TO 0320-INPUT-ERROR.
  5067
  5068     if (maintl not = zeros)
  5069        and (mainti not = 'D')
  5070        move spaces              to pi-el650-del-sw
  5071     end-if
  5072     IF EIBAID  = DFHPF1
  5073         GO TO 5300-FIND-NEXT-ACCOUNT.
  5074
  5075     IF EIBAID  = DFHPF2
  5076         GO TO 5400-FIND-PREV-ACCOUNT.
  5077
  5078     IF EIBAID  = DFHPF3
  5079         GO TO 5100-FIND-NEXT-RANGE.
  5080
  5081     IF EIBAID  = DFHPF4
  5082         GO TO 5200-FIND-PREV-RANGE.
  5083
  5084     IF EIBAID  = DFHPF5
  5085         GO TO 8900-PF5.
  5086
  5087     IF EIBAID  = DFHPF6
  5088        GO TO 8910-PF6
  5089     END-IF
  5090     IF EIBAID  = DFHENTER
  5091         GO TO 0330-EDIT-DATA.
  5092
  5093     MOVE ER-0029                TO  EMI-ERROR.
  5094
  5095 0320-INPUT-ERROR.
  5096     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5097
  5098     MOVE AL-UNBON               TO  PFENTERA.
  5099
  5100     IF PFENTERL  = ZERO
  5101         MOVE -1                 TO  MAINTL
  5102     ELSE
  5103         MOVE -1                 TO  PFENTERL.
  5104
  5105     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 101
* EL650.cbl
  5107 0330-EDIT-DATA.
  5108     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5109     MOVE '5'                    TO  DC-OPTION-CODE.
  5110
  5111     PERFORM 9700-DATE-CONVERSION.
  5112
  5113     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5114     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5115
  5116     IF ACARIERL GREATER ZEROS
  5117         IF PI-CARRIER-SECURITY GREATER SPACES
  5118             IF ACARIERI = PI-CARRIER-SECURITY
  5119                 NEXT SENTENCE
  5120             ELSE
  5121                 MOVE -1         TO  ACARIERL
  5122                 MOVE ER-2370    TO  EMI-ERROR
  5123                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5124                 MOVE AL-UABON   TO  ACARIERA
  5125                 GO TO 8200-SEND-DATAONLY.
  5126
  5127     IF MAINTI  = 'S'
  5128       IF LINEL = ZEROS
  5129           MOVE 1 TO PI-PAGE-NUMBER
  5130           GO TO 1000-SHOW-ACCOUNT
  5131       ELSE
  5132           GO TO 1000-SHOW-ACCOUNT.
  5133
  5134     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5135
  5136     IF EMI-ERROR  NOT = ZEROS
  5137         MOVE -1                 TO  MAINTL
  5138         GO TO 8200-SEND-DATAONLY.
  5139
  5140     IF NOT  MODIFY-CAP
  5141         MOVE 'UPDATE'           TO  SM-READ
  5142         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5143         MOVE ER-0070            TO  EMI-ERROR
  5144         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5145         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5146                                     ASTATEA   AACCTA
  5147         GO TO 8100-SEND-INITIAL-MAP.
  5148
  5149     IF MAINTI  = 'A'
  5150         GO TO 1500-ADD-ACCOUNT.
  5151
  5152     IF MAINTI  = 'C'
  5153         IF PI-SV-MAINT IS EQUAL TO 'L'
  5154            MOVE -1              TO  MAINTL
  5155            MOVE AL-UABON        TO  MAINTA
  5156            MOVE ER-0899         TO  EMI-ERROR
  5157            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5158            GO TO 8200-SEND-DATAONLY
  5159         ELSE
  5160            GO TO 2000-CHANGE-ACCOUNT.
  5161
  5162     IF MAINTI  = 'D'
  5163         GO TO 2500-DELETE-ACCOUNT.
  5164
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 102
* EL650.cbl
  5165     IF MAINTI  = 'X'
  5166         GO TO 3000-CHANGE-EXPIRATION.
  5167
  5168     IF MAINTI  = 'E'
  5169         GO TO 3500-CHANGE-EFFECTIVE.
  5170
  5171     IF MAINTI  = 'L'
  5172         MOVE 'L'             TO  PI-SV-MAINT
  5173         GO TO 4000-CHANGE-ALL.
  5174
  5175     IF MAINTI  = 'K'
  5176       IF LINEL GREATER ZERO
  5177           GO TO 4900-CREATE-NEW-ACCOUNT
  5178        ELSE
  5179           GO TO 4500-CREATE-NEW-ACCOUNT.
  5180
  5181     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5182         IF MAINTI  = 'T'
  5183             GO TO 4500-CREATE-NEW-ACCOUNT.
  5184
  5185     IF MAINTI  = 'N'
  5186         GO TO 5000-CREATE-NEW-RANGE.
  5187
  5188     MOVE ER-0023                TO  EMI-ERROR.
  5189
  5190     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5191
  5192     MOVE -1                     TO  MAINTL.
  5193     MOVE AL-UABON               TO  MAINTA.
  5194
  5195     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 103
* EL650.cbl
  5197 1000-SHOW-ACCOUNT.
  5198     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5199
  5200     IF LINEL GREATER ZEROS   AND
  5201        PI-TOTAL-LINES  NOT =  ZEROS
  5202         NEXT SENTENCE
  5203     ELSE
  5204         GO TO 1002-SHOW-NEW-RECORDS.
  5205
  5206     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5207
  5208     IF EMI-ERROR  NOT = ZEROS
  5209         GO TO 8200-SEND-DATAONLY.
  5210
  5211     SET T-INDEX                 TO  LINEI.
  5212
  5213     IF PI-2ND-PAGE
  5214         SET T-INDEX  UP  BY  8
  5215     ELSE
  5216     IF PI-3RD-PAGE
  5217         SET T-INDEX  UP  BY  16
  5218     ELSE
  5219     IF PI-LST-PAGE
  5220         SET T-INDEX  UP  BY  24.
  5221
  5222     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5223     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5224
  5225     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5226         MOVE MAINTI             TO  PI-MAINT
  5227         MOVE XCTL-6501          TO  PGM-NAME
  5228         GO TO 9300-XCTL
  5229     ELSE
  5230         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5231             MOVE MAINTI         TO  PI-MAINT
  5232             MOVE XCTL-6501      TO  PGM-NAME
  5233             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5234             SET TS-INDEX        TO  T-INDEX
  5235             MOVE TS-ACCT-KEY (TS-INDEX)
  5236                                 TO  PI-ACCT-CCGSA-KEY
  5237             GO TO 9300-XCTL.
  5238
  5239 1002-SHOW-NEW-RECORDS.
  5240
  5241* EXEC CICS  HANDLE CONDITION
  5242*         NOTFND   (1010-NOT-FOUND)
  5243*         ENDFILE  (1010-NOT-FOUND)
  5244*    END-EXEC.
  5245*    MOVE '"$I''                  ! $ #00005190' TO DFHEIV0
  5246     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5248     MOVE X'2420233030303035313930' TO DFHEIV0(25:11)
  5249     CALL 'kxdfhei1' USING DFHEIV0
  5250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5251
  5252
  5253     SET T-INDEX
  5254        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 104
* EL650.cbl
  5255
  5256     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5257
  5258     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5259
  5260     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5261
  5262     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5263
  5264     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5265
  5266 1005-READ-ACCT.
  5267     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5268
  5269     IF K-WITH-LINE-NO
  5270       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5271          SV-GROUPING  NOT = AM-GROUPING OR
  5272          SV-STATE     NOT = AM-STATE    OR
  5273          SV-ACCOUNT   NOT = AM-ACCOUNT
  5274            GO TO 1010-NOT-FOUND.
  5275
  5276     IF SV-CO  NOT = AM-COMPANY-CD
  5277         GO TO 1010-NOT-FOUND.
  5278
  5279     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5280         GO TO 1010-NOT-FOUND.
  5281
  5282     IF SV-STATE  NOT = AM-STATE
  5283       AND  (ST-ACCNT-CNTL
  5284       OR  CARR-ST-ACCNT-CNTL
  5285       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5286         GO TO 1010-NOT-FOUND.
  5287
  5288     IF SV-CARRIER  NOT =  AM-CARRIER
  5289       AND  (CARR-ACCNT-CNTL
  5290       OR  CARR-ST-ACCNT-CNTL
  5291       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5292         GO TO 1010-NOT-FOUND.
  5293
  5294     IF SV-GROUPING  NOT = AM-GROUPING
  5295       AND  CARR-GROUP-ST-ACCNT-CNTL
  5296         GO TO 1010-NOT-FOUND.
  5297
  5298     IF AM-TRNTO-DTE  =  SPACES
  5299         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5300
  5301     IF AM-TRNFROM-DTE  = SPACES
  5302         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5303
  5304     IF T-INDEX  = 1
  5305         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5306             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5307             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5308             MOVE SPACE              TO  DC-OPTION-CODE
  5309             PERFORM 9700-DATE-CONVERSION
  5310             IF DATE-CONVERSION-ERROR
  5311                 MOVE SPACES         TO  TRNTODTO
  5312             ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 105
* EL650.cbl
  5313                 MOVE DC-GREG-DATE-1-EDIT
  5314                                     TO  TRNTODTO.
  5315
  5316     IF T-INDEX  =  1
  5317         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5318             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5319             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5320             MOVE SPACE                TO  DC-OPTION-CODE
  5321             PERFORM 9700-DATE-CONVERSION
  5322             IF DATE-CONVERSION-ERROR
  5323                 MOVE SPACES           TO  TRNFRDTO
  5324             ELSE
  5325                 MOVE DC-GREG-DATE-1-EDIT
  5326                                       TO  TRNFRDTO.
  5327
  5328     IF T-INDEX  = 1
  5329         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5330         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5331         MOVE AM-NAME             TO  NAMEO
  5332                                      PI-ACCNAME
  5333         MOVE SPACE               TO  NAMEFLGO
  5334                                      PI-NAMEFLG.
  5335
  5336     IF AM-NAME  NOT = NAMEO
  5337         MOVE '*'                TO  NAMEFLGO
  5338                                     PI-NAMEFLG.
  5339
  5340     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5341
  5342     GO TO 1005-READ-ACCT.
  5343
  5344 1010-NOT-FOUND.
  5345     IF BROWSE-STARTED
  5346
  5347* EXEC CICS  ENDBR
  5348*            DATASET  (PI-ACCT-ID)
  5349*        END-EXEC.
  5350     MOVE 0
  5351       TO DFHEIV11
  5352*    MOVE '&2                    $   #00005288' TO DFHEIV0
  5353     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5354     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5355     MOVE X'2020233030303035323838' TO DFHEIV0(25:11)
  5356     CALL 'kxdfhei1' USING DFHEIV0,
  5357           PI-ACCT-ID,
  5358           DFHEIV11,
  5359           DFHEIV99
  5360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5361
  5362
  5363     IF T-INDEX  NOT = 1
  5364         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5365         GO TO 7000-BUILD-OUTPUT-MAP.
  5366
  5367     MOVE ER-0226                TO  EMI-ERROR.
  5368
  5369     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5370
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 106
* EL650.cbl
  5371     MOVE -1                     TO  ACARIERL.
  5372     MOVE AL-UABON               TO  ACARIERA
  5373                                     AGROUPA
  5374                                     ASTATEA
  5375                                     AACCTA.
  5376
  5377     IF FROM-EL608-SW = 'Y'
  5378         MOVE SV-CARRIER     TO  ACARIERO
  5379         MOVE SV-GROUPING    TO  AGROUPO
  5380         MOVE SV-STATE       TO  ASTATEO
  5381         MOVE SV-ACCOUNT     TO  AACCTO
  5382         MOVE 'N'            TO  FROM-EL608-SW.
  5383
  5384     IF PI-MAINT = 'A'
  5385         IF PI-RECORD-NOT-CREATED
  5386             MOVE SV-CARRIER     TO  ACARIERO
  5387             MOVE SV-GROUPING    TO  AGROUPO
  5388             MOVE SV-STATE       TO  ASTATEO
  5389             MOVE SV-ACCOUNT     TO  AACCTO
  5390             MOVE ER-2151        TO  EMI-ERROR
  5391             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5392             MOVE 'S'            TO  PI-MAINT.
  5393
  5394     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 107
* EL650.cbl
  5396 1020-MOVE-TO-TABLE.
  5397     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5398     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5399     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5400     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5401     MOVE '3'                    TO  DC-OPTION-CODE.
  5402
  5403     PERFORM 9700-DATE-CONVERSION.
  5404
  5405     IF DATE-CONVERSION-ERROR
  5406         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5407     ELSE
  5408         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5409
  5410     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5411     MOVE '3'                    TO  DC-OPTION-CODE.
  5412
  5413     PERFORM 9700-DATE-CONVERSION.
  5414
  5415     IF DATE-CONVERSION-ERROR
  5416         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5417     ELSE
  5418         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5419
  5420     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5421     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5422
  5423     ADD 1                       TO  PI-TOTAL-LINES.
  5424
  5425     SET T-INDEX
  5426        TS-INDEX  UP  BY  +1.
  5427
  5428     IF T-INDEX  = +33
  5429         GO TO 7000-BUILD-OUTPUT-MAP.
  5430
  5431
  5432 1020-EXIT.
  5433     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 108
* EL650.cbl
  5435 1500-ADD-ACCOUNT.
  5436     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5437
  5438     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5439
  5440     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5441                                     PI-ACCT-REST-OF-EXP.
  5442
  5443     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5444
  5445     IF REC-FOUND
  5446         MOVE -1                 TO  ACARIERL
  5447         MOVE ER-0561            TO  EMI-ERROR
  5448         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5449         GO TO 8200-SEND-DATAONLY.
  5450
  5451     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5452
  5453     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5454
  5455     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5456
  5457     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5458
  5459     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5460         MOVE -1                 TO  EXPCHGL
  5461         MOVE ER-1228            TO  EMI-ERROR
  5462         MOVE AL-UABON           TO  EXPCHGA
  5463         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5464
  5465     IF NOT EMI-NO-ERRORS
  5466         GO TO 8200-SEND-DATAONLY.
  5467
  5468     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5469
  5470     IF WS-ACCT2-FOUND  = 'Y'
  5471         PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  5472             VARYING  WS-INDEX  FROM  +1  BY  +1
  5473                UNTIL WS-INDEX GREATER +32.
  5474
  5475     IF NOT EMI-NO-ERRORS
  5476         GO TO 8200-SEND-DATAONLY.
  5477
  5478     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5479
  5480     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5481                                     PI-PREV-ACCOUNT
  5482                                     PI-PREV-VG-ACCOUNT.
  5483     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5484                                     PI-ACCT-REST-OF-EXP.
  5485     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5486                                     PI-BIN-EXP-DT (1)
  5487     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5488     MOVE 1                      TO  PI-TOTAL-LINES
  5489                                     PI-PAGE-NUMBER
  5490                                     PI-LINE-SELECTED.
  5491     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5492     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 109
* EL650.cbl
  5493     MOVE XCTL-6501              TO  PGM-NAME.
  5494
  5495     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 110
* EL650.cbl
  5497 2000-CHANGE-ACCOUNT.
  5498     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5499
  5500     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5501
  5502     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5503
  5504     IF NOT EMI-NO-ERRORS
  5505         GO TO 8200-SEND-DATAONLY.
  5506
  5507     SET T-INDEX TO LINEI.
  5508
  5509     IF PI-2ND-PAGE
  5510         SET T-INDEX  UP  BY  8
  5511     ELSE
  5512     IF PI-3RD-PAGE
  5513         SET T-INDEX  UP  BY  16
  5514     ELSE
  5515     IF PI-LST-PAGE
  5516         SET T-INDEX  UP  BY  24.
  5517
  5518     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5519     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5520     MOVE MAINTI                   TO  PI-MAINT.
  5521     MOVE XCTL-6501                TO  PGM-NAME.
  5522
  5523     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 111
* EL650.cbl
  5525 2500-DELETE-ACCOUNT.
  5526     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5527
  5528     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5529
  5530     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5531
  5532     IF NOT EMI-NO-ERRORS
  5533         GO TO 8200-SEND-DATAONLY.
  5534
  5535     SET T-INDEX                 TO  LINEI.
  5536
  5537     IF PI-2ND-PAGE
  5538         SET T-INDEX  UP  BY  8
  5539     ELSE
  5540     IF PI-3RD-PAGE
  5541         SET T-INDEX  UP  BY  16
  5542     ELSE
  5543     IF PI-LST-PAGE
  5544         SET T-INDEX  UP  BY  24.
  5545
  5546     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5547                                       BIN-MAX-DATE.
  5548     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5549     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5550     MOVE '1'                      TO  FROM-WHERE-SW.
  5551
  5552     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5553       VARYING  T-INDEX  FROM  +1  BY  +1
  5554         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5555
  5556     MOVE SPACE                  TO  FROM-WHERE-SW.
  5557
  5558     IF NOT EMI-NO-ERRORS
  5559         GO TO 8200-SEND-DATAONLY.
  5560
  5561     SET T-INDEX TO LINEI.
  5562
  5563     IF PI-2ND-PAGE
  5564         SET T-INDEX  UP  BY  8
  5565     ELSE
  5566     IF PI-3RD-PAGE
  5567         SET T-INDEX  UP  BY  16
  5568     ELSE
  5569     IF PI-LST-PAGE
  5570         SET T-INDEX  UP  BY  24.
  5571
  5572
  5573* EXEC CICS  READ
  5574*        UPDATE
  5575*        DATASET  (PI-ACCT-ID)
  5576*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5577*        RIDFLD   (PI-ACCT-KEY)
  5578*    END-EXEC.
  5579*    MOVE '&"S        EU         (   #00005501' TO DFHEIV0
  5580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5581     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5582     MOVE X'2020233030303035353031' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 112
* EL650.cbl
  5583     CALL 'kxdfhei1' USING DFHEIV0,
  5584           PI-ACCT-ID,
  5585           DFHEIV20,
  5586           DFHEIV99,
  5587           PI-ACCT-KEY,
  5588           DFHEIV99,
  5589           DFHEIV99,
  5590           DFHEIV99
  5591     SET ADDRESS OF ACCOUNT-MASTER TO
  5592         DFHEIV20
  5593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5594
  5595
  5596     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5597        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5598         MOVE ER-2070            TO  EMI-ERROR
  5599         MOVE -1                 TO  MAINTL
  5600         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5601         GO TO 8200-SEND-DATAONLY.
  5602
  5603     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5604         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5605     ELSE
  5606         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5607
  5608     IF THERE-IS-PENDING-BUSINESS
  5609         MOVE ER-1612            TO  EMI-ERROR
  5610         MOVE -1                 TO  MAINTL
  5611         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5612         GO TO 8200-SEND-DATAONLY.
  5613
  5614     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5615     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5616
  5617     if pi-el650-del-sw = 'Y'
  5618        move ' '                 to pi-el650-del-sw
  5619     else
  5620        move 'Y'                 to pi-el650-del-sw
  5621        move er-1299             to emi-error
  5622        perform 9900-error-format thru 9900-exit
  5623*       MOVE 1 TO PI-PAGE-NUMBER
  5624        move spaces              to mainto
  5625        MOVE -1                  TO MAINTL
  5626        GO TO 1000-SHOW-ACCOUNT
  5627     end-if
  5628     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5629
  5630****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5631     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5632         NEXT SENTENCE
  5633     ELSE
  5634         IF PI-TOTAL-LINES  = 1
  5635             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5636         end-if
  5637     end-if
  5638
  5639     MOVE 'D'                    TO  JP-RECORD-TYPE
  5640     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 113
* EL650.cbl
  5641
  5642
  5643* EXEC CICS  DELETE
  5644*        DATASET  (PI-ACCT-ID)
  5645*    END-EXEC
  5646*    MOVE '&(                    &   #00005554' TO DFHEIV0
  5647     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5648     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5649     MOVE X'2020233030303035353534' TO DFHEIV0(25:11)
  5650     CALL 'kxdfhei1' USING DFHEIV0,
  5651           PI-ACCT-ID,
  5652           DFHEIV99,
  5653           DFHEIV99,
  5654           DFHEIV99,
  5655           DFHEIV99
  5656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5657
  5658     PERFORM 8400-LOG-JOURNAL-RECORD
  5659
  5660     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5661
  5662     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5663                                     PI-ACCT-REST-OF-EXP
  5664                                     LINEO
  5665     MOVE ER-0000                TO  EMI-ERROR
  5666
  5667     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5668
  5669     IF PI-TOTAL-LINES  = 1
  5670         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5671         MOVE ZEROS              TO  PI-TOTAL-LINES
  5672         MOVE 1                  TO  PI-PAGE-NUMBER
  5673         GO TO 7000-BUILD-OUTPUT-MAP
  5674     end-if
  5675     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 114
* EL650.cbl
  5677 2550-CHECK-HI-LO-DATES.
  5678     IF FROM-CHANGE
  5679         GO TO 2550-CHECK-CHANGE.
  5680
  5681     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5682        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5683         GO TO 2550-CHECK-AR-DELETE.
  5684
  5685     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5686          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5687       OR
  5688         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5689          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5690       AND
  5691            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5692         MOVE ER-2087            TO  EMI-ERROR
  5693         MOVE -1                 TO  MAINTL
  5694         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5695
  5696 2550-CHECK-AR-DELETE.
  5697     IF NOT PI-AR-PROCESSING
  5698         GO TO 2550-EXIT.
  5699
  5700     IF T-INDEX NOT = LINEI
  5701         GO TO 2550-EXIT.
  5702
  5703     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5704        GO TO 2550-EXIT.
  5705
  5706     MOVE ER-3155                TO  EMI-ERROR
  5707     MOVE -1                     TO  MAINTL
  5708     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5709
  5710 2550-CHECK-CHANGE.
  5711     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5712         GO TO 2550-CHECK-AR-CHANGE.
  5713
  5714     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5715         MOVE ER-2113            TO  EMI-ERROR
  5716         MOVE -1                 TO  MAINTL
  5717         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5718
  5719 2550-CHECK-AR-CHANGE.
  5720      IF NOT PI-AR-PROCESSING
  5721          GO TO 2550-EXIT.
  5722
  5723      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5724          GO TO 2550-EXIT.
  5725
  5726      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5727         MOVE ER-3155            TO  EMI-ERROR
  5728         MOVE -1                 TO  MAINTL
  5729         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5730
  5731 2550-EXIT.
  5732     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 115
* EL650.cbl
  5734 2560-CHECK-PENDING-BUSINESS.
  5735     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5736     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5737                                     PI-ERPNDB-ALT-KEY.
  5738     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5739                                     PI-PB-COMPANY-CD-A1.
  5740     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5741                                     PI-PB-CARRIER.
  5742     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5743                                     PI-PB-GROUPING.
  5744     MOVE AM-VG-STATE            TO  PNDB-STATE
  5745                                     PI-PB-STATE.
  5746     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5747                                     PI-PB-ACCOUNT.
  5748
  5749
  5750* EXEC CICS  HANDLE CONDITION
  5751*         NOTFND   (2568-NO-RECORDS)
  5752*         ENDFILE  (2568-NO-RECORDS)
  5753*    END-EXEC.
  5754*    MOVE '"$I''                  ! % #00005649' TO DFHEIV0
  5755     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5757     MOVE X'2520233030303035363439' TO DFHEIV0(25:11)
  5758     CALL 'kxdfhei1' USING DFHEIV0
  5759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5760
  5761
  5762
  5763* EXEC CICS  STARTBR
  5764*        DATASET  (PEND2-FILE-ID)
  5765*        RIDFLD   (ERPNDB-KEY)
  5766*    END-EXEC.
  5767     MOVE 0
  5768       TO DFHEIV11
  5769*    MOVE '&,         G          &   #00005654' TO DFHEIV0
  5770     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5771     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5772     MOVE X'2020233030303035363534' TO DFHEIV0(25:11)
  5773     CALL 'kxdfhei1' USING DFHEIV0,
  5774           PEND2-FILE-ID,
  5775           ERPNDB-KEY,
  5776           DFHEIV99,
  5777           DFHEIV11,
  5778           DFHEIV99
  5779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5780
  5781
  5782     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5783
  5784 2562-READ-NEXT-PENDING.
  5785
  5786* EXEC CICS  READNEXT
  5787*        DATASET  (PEND2-FILE-ID)
  5788*        RIDFLD   (ERPNDB-KEY)
  5789*        SET      (ADDRESS OF PENDING-BUSINESS)
  5790*    END-EXEC.
  5791     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 116
* EL650.cbl
  5792       TO DFHEIV11
  5793*    MOVE '&.S                   )   #00005662' TO DFHEIV0
  5794     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5795     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5796     MOVE X'2020233030303035363632' TO DFHEIV0(25:11)
  5797     CALL 'kxdfhei1' USING DFHEIV0,
  5798           PEND2-FILE-ID,
  5799           DFHEIV20,
  5800           DFHEIV99,
  5801           ERPNDB-KEY,
  5802           DFHEIV99,
  5803           DFHEIV11,
  5804           DFHEIV99,
  5805           DFHEIV99
  5806     SET ADDRESS OF PENDING-BUSINESS TO
  5807         DFHEIV20
  5808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5809
  5810
  5811     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5812        PB-CARRIER       = PI-PB-CARRIER       AND
  5813        PB-GROUPING      = PI-PB-GROUPING      AND
  5814        PB-STATE         = PI-PB-STATE         AND
  5815        PB-ACCOUNT       = PI-PB-ACCOUNT
  5816            NEXT SENTENCE
  5817          ELSE
  5818            GO TO 2568-NO-RECORDS.
  5819
  5820     IF PB-ISSUE
  5821       OR  PB-CANCELLATION
  5822         NEXT SENTENCE
  5823     ELSE
  5824         GO TO 2562-READ-NEXT-PENDING.
  5825
  5826     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5827         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5828         GO TO 2568-NO-RECORDS.
  5829
  5830     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5831       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5832         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5833         GO TO 2568-NO-RECORDS.
  5834
  5835     GO TO 2562-READ-NEXT-PENDING.
  5836
  5837 2568-NO-RECORDS.
  5838     IF PENDING-BROWSE-STARTED
  5839         MOVE ' '                TO  PENDING-BROWSE-SW
  5840
  5841* EXEC CICS ENDBR
  5842*           DATASET  (PEND2-FILE-ID)
  5843*       END-EXEC.
  5844     MOVE 0
  5845       TO DFHEIV11
  5846*    MOVE '&2                    $   #00005697' TO DFHEIV0
  5847     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5848     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5849     MOVE X'2020233030303035363937' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 117
* EL650.cbl
  5850     CALL 'kxdfhei1' USING DFHEIV0,
  5851           PEND2-FILE-ID,
  5852           DFHEIV11,
  5853           DFHEIV99
  5854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5855
  5856
  5857 2569-EXIT.
  5858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 118
* EL650.cbl
  5860 3000-CHANGE-EXPIRATION.
  5861     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5862     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5863     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5864     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5865
  5866     SET T-INDEX  TO  PI-TOTAL-LINES.
  5867
  5868     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5869             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5870                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5871                 OR  WS-INDEX GREATER +32
  5872     END-PERFORM.
  5873
  5874     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5875         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5876         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5877             VARYING  WS-INDEX  FROM  +1  BY  +1
  5878               UNTIL  WS-INDEX GREATER +32
  5879     ELSE
  5880         MOVE ER-0453            TO  EMI-ERROR
  5881         MOVE -1                 TO  MAINTL
  5882         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5883
  5884     IF NOT EMI-NO-ERRORS
  5885         GO TO 8200-SEND-DATAONLY.
  5886
  5887     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5888     MOVE '2'                    TO  FROM-WHERE-SW.
  5889
  5890     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5891       VARYING  T-INDEX  FROM  +1  BY  +1
  5892         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5893
  5894     MOVE SPACE                  TO  FROM-WHERE-SW.
  5895
  5896     IF NOT EMI-NO-ERRORS
  5897         GO TO 8200-SEND-DATAONLY.
  5898
  5899     SET T-INDEX  TO  PI-TOTAL-LINES.
  5900     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5901
  5902     IF NOT EMI-NO-ERRORS
  5903         GO TO 8200-SEND-DATAONLY.
  5904
  5905     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5906     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5907     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5908     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5909
  5910     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5911
  5912     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5913                                     AM-VG-EXPIRATION-DT
  5914                                     PI-BIN-EXP-DT (T-INDEX).
  5915     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5916                                     PI-BIN-MAINT-DT (T-INDEX).
  5917     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 119
* EL650.cbl
  5918     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5919
  5920     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5921
  5922     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5923
  5924     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5925
  5926     MOVE SPACES                 TO  EXPCHGI.
  5927     MOVE AL-UANOF               TO  EXPCHGA.
  5928     MOVE ER-0000                TO  EMI-ERROR.
  5929
  5930     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5931
  5932     GO TO 7000-BUILD-OUTPUT-MAP.
  5933
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 120
* EL650.cbl
  5935 3100-DELETE-DATE-RANGE.
  5936
  5937* EXEC CICS GETMAIN
  5938*        LENGTH   (ACCT-REC-LEN)
  5939*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5940*        INITIMG  (GETMAIN-SPACE)
  5941*    END-EXEC.
  5942*    MOVE ',"IL                  $   #00005780' TO DFHEIV0
  5943     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5945     MOVE X'2020233030303035373830' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0,
  5947           DFHEIV20,
  5948           ACCT-REC-LEN,
  5949           GETMAIN-SPACE
  5950     SET ADDRESS OF ACCOUNT-MASTER TO
  5951         DFHEIV20
  5952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5953
  5954
  5955
  5956* EXEC CICS  HANDLE CONDITION
  5957*        NOTFND   (3175-CONTINUE)
  5958*        ENDFILE  (3175-CONTINUE)
  5959*    END-EXEC.
  5960*    MOVE '"$I''                  ! & #00005786' TO DFHEIV0
  5961     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5963     MOVE X'2620233030303035373836' TO DFHEIV0(25:11)
  5964     CALL 'kxdfhei1' USING DFHEIV0
  5965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5966
  5967
  5968
  5969
  5970* EXEC CICS  READ
  5971*        UPDATE
  5972*        DATASET  (PI-ACCT-ID)
  5973*        INTO     (ACCOUNT-MASTER)
  5974*        RIDFLD   (PI-ACCT-KEY)
  5975*    END-EXEC.
  5976     MOVE LENGTH OF
  5977      ACCOUNT-MASTER
  5978       TO DFHEIV11
  5979*    MOVE '&"IL       EU         (   #00005792' TO DFHEIV0
  5980     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5981     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5982     MOVE X'2020233030303035373932' TO DFHEIV0(25:11)
  5983     CALL 'kxdfhei1' USING DFHEIV0,
  5984           PI-ACCT-ID,
  5985           ACCOUNT-MASTER,
  5986           DFHEIV11,
  5987           PI-ACCT-KEY,
  5988           DFHEIV99,
  5989           DFHEIV99,
  5990           DFHEIV99
  5991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5992
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 121
* EL650.cbl
  5993
  5994     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5995     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5996     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5997
  5998
  5999* EXEC CICS  DELETE
  6000*        DATASET  (PI-ACCT-ID)
  6001*    END-EXEC.
  6002*    MOVE '&(                    &   #00005803' TO DFHEIV0
  6003     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6004     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6005     MOVE X'2020233030303035383033' TO DFHEIV0(25:11)
  6006     CALL 'kxdfhei1' USING DFHEIV0,
  6007           PI-ACCT-ID,
  6008           DFHEIV99,
  6009           DFHEIV99,
  6010           DFHEIV99,
  6011           DFHEIV99
  6012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6013
  6014
  6015     PERFORM 8400-LOG-JOURNAL-RECORD.
  6016
  6017     GO TO 3199-EXIT.
  6018
  6019 3175-CONTINUE.
  6020     IF BROWSE-STARTED
  6021         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6022
  6023     MOVE ER-0226                TO  EMI-ERROR.
  6024
  6025     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6026
  6027     MOVE -1                     TO  MAINTL.
  6028
  6029     GO TO 8200-SEND-DATAONLY.
  6030
  6031 3199-EXIT.
  6032     EXIT.
  6033
  6034 3200-ADD-DATE-RANGE.
  6035     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6036     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6037
  6038
  6039* EXEC CICS  WRITE
  6040*        FROM     (ACCOUNT-MASTER)
  6041*        RIDFLD   (AM-CONTROL-PRIMARY)
  6042*        DATASET  (PI-ACCT-ID)
  6043*    END-EXEC.
  6044     MOVE LENGTH OF
  6045      ACCOUNT-MASTER
  6046       TO DFHEIV11
  6047*    MOVE '&$ L                  ''   #00005830' TO DFHEIV0
  6048     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6049     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6050     MOVE X'2020233030303035383330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 122
* EL650.cbl
  6051     CALL 'kxdfhei1' USING DFHEIV0,
  6052           PI-ACCT-ID,
  6053           ACCOUNT-MASTER,
  6054           DFHEIV11,
  6055           AM-CONTROL-PRIMARY,
  6056           DFHEIV99,
  6057           DFHEIV99
  6058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6059
  6060
  6061     PERFORM 8400-LOG-JOURNAL-RECORD.
  6062
  6063 3299-EXIT.
  6064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 123
* EL650.cbl
  6066 3500-CHANGE-EFFECTIVE.
  6067     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6068
  6069     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6070
  6071     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6072
  6073     IF NOT EMI-NO-ERRORS
  6074         GO TO 8200-SEND-DATAONLY.
  6075
  6076     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6077
  6078     SET T-INDEX                 TO  +1.
  6079
  6080     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6081             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6082                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6083                 OR  WS-INDEX GREATER +32
  6084     END-PERFORM.
  6085
  6086     IF PI-BIN-EFF-DT (T-INDEX)
  6087                 = WS-ACCT-EFF-DT (WS-INDEX)
  6088         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6089         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6090             VARYING  WS-INDEX  FROM  +1  BY  +1
  6091               UNTIL  WS-INDEX GREATER +32
  6092     ELSE
  6093         MOVE ER-0453            TO  EMI-ERROR
  6094         MOVE -1                 TO  MAINTL
  6095         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6096
  6097     IF NOT EMI-NO-ERRORS
  6098         GO TO 8200-SEND-DATAONLY.
  6099
  6100     SET T-INDEX TO  1.
  6101
  6102     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6103
  6104     IF NOT EMI-NO-ERRORS
  6105         GO TO 8200-SEND-DATAONLY.
  6106
  6107     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6108     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6109     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6110     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6111
  6112
  6113* EXEC CICS  READ
  6114*        UPDATE
  6115*        DATASET  (PI-ACCT-ID)
  6116*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6117*        RIDFLD   (PI-ACCT-KEY)
  6118*    END-EXEC.
  6119*    MOVE '&"S        EU         (   #00005887' TO DFHEIV0
  6120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6121     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6122     MOVE X'2020233030303035383837' TO DFHEIV0(25:11)
  6123     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 124
* EL650.cbl
  6124           PI-ACCT-ID,
  6125           DFHEIV20,
  6126           DFHEIV99,
  6127           PI-ACCT-KEY,
  6128           DFHEIV99,
  6129           DFHEIV99,
  6130           DFHEIV99
  6131     SET ADDRESS OF ACCOUNT-MASTER TO
  6132         DFHEIV20
  6133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6134
  6135
  6136     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6137     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6138     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6139
  6140     PERFORM 8400-LOG-JOURNAL-RECORD.
  6141
  6142     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6143                                     PI-BIN-EFF-DT (T-INDEX).
  6144     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6145     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6146                                     PI-BIN-MAINT-DT (T-INDEX).
  6147     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6148     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6149     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6150     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6151
  6152     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6153
  6154
  6155* EXEC CICS  REWRITE
  6156*        FROM     (ACCOUNT-MASTER)
  6157*        DATASET  (PI-ACCT-ID)
  6158*    END-EXEC.
  6159     MOVE LENGTH OF
  6160      ACCOUNT-MASTER
  6161       TO DFHEIV11
  6162*    MOVE '&& L                  %   #00005912' TO DFHEIV0
  6163     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6164     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6165     MOVE X'2020233030303035393132' TO DFHEIV0(25:11)
  6166     CALL 'kxdfhei1' USING DFHEIV0,
  6167           PI-ACCT-ID,
  6168           ACCOUNT-MASTER,
  6169           DFHEIV11,
  6170           DFHEIV99
  6171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6172
  6173
  6174     PERFORM 8400-LOG-JOURNAL-RECORD.
  6175
  6176     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6177
  6178     MOVE SPACES                 TO  EFFCHGO.
  6179
  6180     MOVE ZERO                   TO  EFFCHGL
  6181                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 125
* EL650.cbl
  6182
  6183     MOVE AL-UANOF               TO  EFFCHGA.
  6184
  6185     MOVE ER-0000                TO  EMI-ERROR.
  6186
  6187     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6188
  6189     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 126
* EL650.cbl
  6191 4000-CHANGE-ALL.
  6192     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6193
  6194     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6195
  6196     IF NOT EMI-NO-ERRORS
  6197         GO TO 8200-SEND-DATAONLY.
  6198
  6199     MOVE 1                      TO  PI-LINE-SELECTED.
  6200     MOVE MAINTI                 TO  PI-MAINT.
  6201     MOVE XCTL-6501              TO  PGM-NAME.
  6202
  6203     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 127
* EL650.cbl
  6205 4100-BUILD-VERIFICATION.
  6206     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6207
  6208     SET WS-INDEX  TO  +1.
  6209
  6210     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6211     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6212     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6213                                     WS-VERIFY-AREA.
  6214
  6215     IF ST-ACCNT-CNTL  OR
  6216        ACCNT-CNTL
  6217          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6218
  6219     IF ST-ACCNT-CNTL      OR
  6220        CARR-ST-ACCNT-CNTL OR
  6221        ACCNT-CNTL         OR
  6222        CARR-ACCNT-CNTL
  6223          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6224
  6225     IF ACCNT-CNTL OR
  6226        CARR-ACCNT-CNTL
  6227          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6228
  6229     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6230
  6231
  6232* EXEC CICS  HANDLE CONDITION
  6233*        NOTFND   (4175-CONTINUE)
  6234*        ENDFILE  (4175-CONTINUE)
  6235*    END-EXEC.
  6236*    MOVE '"$I''                  ! '' #00005974' TO DFHEIV0
  6237     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6239     MOVE X'2720233030303035393734' TO DFHEIV0(25:11)
  6240     CALL 'kxdfhei1' USING DFHEIV0
  6241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6242
  6243
  6244
  6245* EXEC CICS  STARTBR
  6246*        DATASET  (ACCT2-FILE-ID)
  6247*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6248*        GTEQ
  6249*    END-EXEC.
  6250     MOVE 0
  6251       TO DFHEIV11
  6252*    MOVE '&,         G          &   #00005979' TO DFHEIV0
  6253     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6254     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6255     MOVE X'2020233030303035393739' TO DFHEIV0(25:11)
  6256     CALL 'kxdfhei1' USING DFHEIV0,
  6257           ACCT2-FILE-ID,
  6258           WS-ACCT-VERIFY-KEY,
  6259           DFHEIV99,
  6260           DFHEIV11,
  6261           DFHEIV99
  6262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 128
* EL650.cbl
  6263
  6264
  6265     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6266
  6267 4150-READ-NEXT.
  6268
  6269* EXEC CICS  READNEXT
  6270*        DATASET  (ACCT2-FILE-ID)
  6271*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6272*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6273*    END-EXEC.
  6274     MOVE 0
  6275       TO DFHEIV11
  6276*    MOVE '&.S                   )   #00005988' TO DFHEIV0
  6277     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6278     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6279     MOVE X'2020233030303035393838' TO DFHEIV0(25:11)
  6280     CALL 'kxdfhei1' USING DFHEIV0,
  6281           ACCT2-FILE-ID,
  6282           DFHEIV20,
  6283           DFHEIV99,
  6284           WS-ACCT-VERIFY-KEY,
  6285           DFHEIV99,
  6286           DFHEIV11,
  6287           DFHEIV99,
  6288           DFHEIV99
  6289     SET ADDRESS OF ACCOUNT-MASTER TO
  6290         DFHEIV20
  6291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6292
  6293
  6294     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6295
  6296     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6297         GO TO 4175-CONTINUE.
  6298
  6299     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6300     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6301     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6302     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6303     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6304     MOVE '3'                    TO  DC-OPTION-CODE.
  6305
  6306     PERFORM 9700-DATE-CONVERSION.
  6307
  6308     IF DATE-CONVERSION-ERROR
  6309         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6310     ELSE
  6311         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6312
  6313     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6314     MOVE '3'                    TO  DC-OPTION-CODE.
  6315
  6316     PERFORM 9700-DATE-CONVERSION.
  6317
  6318     IF DATE-CONVERSION-ERROR
  6319         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6320     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 129
* EL650.cbl
  6321         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6322
  6323     SET WS-INDEX  UP  BY  +1.
  6324
  6325     GO TO 4150-READ-NEXT.
  6326
  6327 4175-CONTINUE.
  6328     IF BROWSE-STARTED
  6329
  6330* EXEC CICS  ENDBR
  6331*            DATASET  (ACCT2-FILE-ID)
  6332*        END-EXEC
  6333     MOVE 0
  6334       TO DFHEIV11
  6335*    MOVE '&2                    $   #00006029' TO DFHEIV0
  6336     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6337     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6338     MOVE X'2020233030303036303239' TO DFHEIV0(25:11)
  6339     CALL 'kxdfhei1' USING DFHEIV0,
  6340           ACCT2-FILE-ID,
  6341           DFHEIV11,
  6342           DFHEIV99
  6343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6344         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6345
  6346 4199-EXIT.
  6347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 130
* EL650.cbl
  6349 4200-CHECK-VALIDITY.
  6350     IF (BIN-EXPCHG-SAVE GREATER
  6351                    WS-ACCT-EFF-DT (WS-INDEX))
  6352       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6353                    WS-ACCT-EXP-DT (WS-INDEX))
  6354         MOVE ER-2051            TO  EMI-ERROR
  6355         MOVE -1                 TO  EXPCHGL
  6356         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6357
  6358     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6359        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6360          MOVE ER-2051            TO  EMI-ERROR
  6361          MOVE -1                 TO  EFFCHGL
  6362          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6363
  6364 4200-EXIT.
  6365     EXIT.
  6366 4220-DISPLAY-VERI-TABLE.
  6367
  6368     perform varying d1 from +1 by +1 until
  6369        (d1 > +32)
  6370        or (ws-acct-eff-dt (d1) = low-values)
  6371        move ws-acct-eff-dt (d1) to dc-bin-date-1
  6372        move ' '                 to dc-option-code
  6373        perform 9700-date-conversion
  6374        move dc-greg-date-1-edit to ws-display-eff-date
  6375
  6376        move ws-acct-exp-dt (d1) to dc-bin-date-1
  6377        move ' '                 to dc-option-code
  6378        perform 9700-date-conversion
  6379        move dc-greg-date-1-edit to ws-display-exp-date
  6380
  6381        display ' date range ' d1 ' ' ws-display-eff-date
  6382                                  ' ' ws-display-exp-date
  6383     end-perform
  6384
  6385     .
  6386 4220-EXIT.
  6387     EXIT.
  6388
  6389 4300-VERIFY-INTEGRITY.
  6390     set d1 to ws-index
  6391     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6392         SET WS-INDEX  TO  +32
  6393         GO TO 4399-EXIT.
  6394
  6395     IF ((WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6396        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE))
  6397                  AND
  6398        (WS-ACCT-EXP-DT (WS-INDEX) > WS-ACCT-EFF-DT (WS-INDEX))
  6399         SET WS-INDEX  TO  +33
  6400         GO TO 4399-EXIT.
  6401
  6402     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6403                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6404       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6405                    WS-ACCT-EFF-DT (WS-INDEX))
  6406         GO TO 4399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 131
* EL650.cbl
  6407
  6408     MOVE ER-2051                TO  EMI-ERROR.
  6409     MOVE -1                     TO  EXPCHGL.
  6410
  6411     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6412
  6413 4399-EXIT.
  6414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 132
* EL650.cbl
  6416 4500-CREATE-NEW-ACCOUNT.
  6417     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6418
  6419     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6420
  6421     IF MAINTI = 'T'
  6422         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6423
  6424     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6425
  6426     IF WS-ACCT2-FOUND = 'Y'
  6427         MOVE ER-0561            TO  EMI-ERROR
  6428         MOVE -1                 TO  MAINTL
  6429         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6430
  6431     MOVE SPACES                 TO  GETMAIN-SW.
  6432
  6433     IF NOT EMI-NO-ERRORS
  6434         GO TO 8200-SEND-DATAONLY.
  6435
  6436     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6437         MOVE ER-0453            TO  EMI-ERROR
  6438         MOVE -1                 TO  MAINTL
  6439         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6440         GO TO 8200-SEND-DATAONLY.
  6441
  6442     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6443
  6444     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6445                                     PI-ACCT-REST-OF-EXP.
  6446
  6447     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6448
  6449     IF REC-FOUND
  6450         MOVE -1                 TO  ACARIERL
  6451         MOVE ER-0561            TO  EMI-ERROR
  6452         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6453         GO TO 8200-SEND-DATAONLY.
  6454
  6455     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6456     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6457                                     PI-ACCT-REST-OF-EXP.
  6458
  6459
  6460* EXEC CICS  HANDLE CONDITION
  6461*        NOTFND   (4530-NOT-FOUND)
  6462*        ENDFILE  (4530-NOT-FOUND)
  6463*    END-EXEC.
  6464*    MOVE '"$I''                  ! ( #00006147' TO DFHEIV0
  6465     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6466     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6467     MOVE X'2820233030303036313437' TO DFHEIV0(25:11)
  6468     CALL 'kxdfhei1' USING DFHEIV0
  6469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6470
  6471
  6472     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6473
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 133
* EL650.cbl
  6474 4510-READ-NEXT.
  6475     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6476
  6477     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6478         GO TO 4540-END-COPY.
  6479
  6480     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6481     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6482     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6483     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6484
  6485     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6486
  6487     IF MAINTI  = 'T'
  6488         MOVE '2'                TO  AM-STATUS
  6489         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6490         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6491         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6492         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6493         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6494         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6495     ELSE
  6496         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6497         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6498                                     AM-LO-CERT-DATE
  6499         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6500                                     AM-PREV-DATES
  6501                                     AM-ORIG-DEALER-NO
  6502     END-IF
  6503
  6504     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6505     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6506     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6507     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6508
  6509     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6510
  6511     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6512     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6513
  6514     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6515
  6516
  6517* EXEC CICS GETMAIN
  6518*        LENGTH   (ACCT-REC-LEN)
  6519*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6520*        INITIMG  (GETMAIN-SPACE)
  6521*    END-EXEC.
  6522*    MOVE ',"IL                  $   #00006196' TO DFHEIV0
  6523     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6524     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6525     MOVE X'2020233030303036313936' TO DFHEIV0(25:11)
  6526     CALL 'kxdfhei1' USING DFHEIV0,
  6527           DFHEIV20,
  6528           ACCT-REC-LEN,
  6529           GETMAIN-SPACE
  6530     SET ADDRESS OF ACCOUNT-MASTER TO
  6531         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 134
* EL650.cbl
  6532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6533
  6534
  6535     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6536
  6537
  6538* EXEC CICS  WRITE
  6539*        DATASET  (PI-ACCT-ID)
  6540*        RIDFLD   (AM-CONTROL-PRIMARY)
  6541*        FROM     (ACCOUNT-MASTER)
  6542*    END-EXEC.
  6543     MOVE LENGTH OF
  6544      ACCOUNT-MASTER
  6545       TO DFHEIV11
  6546*    MOVE '&$ L                  ''   #00006204' TO DFHEIV0
  6547     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6549     MOVE X'2020233030303036323034' TO DFHEIV0(25:11)
  6550     CALL 'kxdfhei1' USING DFHEIV0,
  6551           PI-ACCT-ID,
  6552           ACCOUNT-MASTER,
  6553           DFHEIV11,
  6554           AM-CONTROL-PRIMARY,
  6555           DFHEIV99,
  6556           DFHEIV99
  6557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6558
  6559
  6560     MOVE PI-ACCT-ID             TO  FILE-ID.
  6561
  6562     PERFORM 8400-LOG-JOURNAL-RECORD.
  6563
  6564     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6565     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6566
  6567     GO TO 4510-READ-NEXT.
  6568
  6569 4530-NOT-FOUND.
  6570     IF BROWSE-STARTED
  6571         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6572
  6573     MOVE ER-0226                TO  EMI-ERROR.
  6574
  6575     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6576
  6577     MOVE -1                     TO  MAINTL.
  6578
  6579     GO TO 8200-SEND-DATAONLY.
  6580
  6581 4540-END-COPY.
  6582     IF MAINTI = 'K'
  6583         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6584             NEXT SENTENCE
  6585         ELSE
  6586             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6587
  6588     IF BROWSE-STARTED
  6589         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 135
* EL650.cbl
  6590
  6591     IF MAINTI  NOT = 'T'
  6592         GO TO 4590-SHOW-NEW-ACCOUNT.
  6593
  6594     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6595     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6596                                     PI-ACCT-REST-OF-EXP.
  6597
  6598     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6599
  6600 4550-READ-NEXT.
  6601     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6602
  6603     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6604         GO TO 4570-END-REWRITE.
  6605
  6606
  6607* EXEC CICS  READ
  6608*        UPDATE
  6609*        DATASET  (PI-ACCT-ID)
  6610*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6611*        RIDFLD   (PI-ACCT-KEY)
  6612*    END-EXEC.
  6613*    MOVE '&"S        EU         (   #00006256' TO DFHEIV0
  6614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6616     MOVE X'2020233030303036323536' TO DFHEIV0(25:11)
  6617     CALL 'kxdfhei1' USING DFHEIV0,
  6618           PI-ACCT-ID,
  6619           DFHEIV20,
  6620           DFHEIV99,
  6621           PI-ACCT-KEY,
  6622           DFHEIV99,
  6623           DFHEIV99,
  6624           DFHEIV99
  6625     SET ADDRESS OF ACCOUNT-MASTER TO
  6626         DFHEIV20
  6627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6628
  6629
  6630     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6631     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6632     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6633
  6634     PERFORM 8400-LOG-JOURNAL-RECORD.
  6635
  6636     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6637     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6638     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6639     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6640     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6641     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6642     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6643
  6644
  6645* EXEC CICS  REWRITE
  6646*        DATASET  (PI-ACCT-ID)
  6647*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 136
* EL650.cbl
  6648*    END-EXEC.
  6649     MOVE LENGTH OF
  6650      ACCOUNT-MASTER
  6651       TO DFHEIV11
  6652*    MOVE '&& L                  %   #00006277' TO DFHEIV0
  6653     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6654     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6655     MOVE X'2020233030303036323737' TO DFHEIV0(25:11)
  6656     CALL 'kxdfhei1' USING DFHEIV0,
  6657           PI-ACCT-ID,
  6658           ACCOUNT-MASTER,
  6659           DFHEIV11,
  6660           DFHEIV99
  6661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6662
  6663
  6664     MOVE PI-ACCT-ID             TO  FILE-ID.
  6665
  6666     PERFORM 8400-LOG-JOURNAL-RECORD.
  6667
  6668     GO TO 4550-READ-NEXT.
  6669
  6670 4570-END-REWRITE.
  6671     IF BROWSE-STARTED
  6672         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6673
  6674     MOVE SPACES                 TO  MAINTI
  6675                                     EFFCHGI.
  6676     MOVE AL-UANOF               TO  EFFCHGA.
  6677
  6678 4590-SHOW-NEW-ACCOUNT.
  6679     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6680
  6681     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6682                                     PI-ACCT-CCGSA-KEY.
  6683
  6684     MOVE -1                     TO  MAINTL.
  6685     MOVE ER-0000                TO  EMI-ERROR.
  6686
  6687     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6688
  6689     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6690
  6691     GO TO 1002-SHOW-NEW-RECORDS.
  6692
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 137
* EL650.cbl
  6694 4600-ADD-ERPLAN-RECORD.
  6695
  6696* EXEC CICS  HANDLE CONDITION
  6697*        NOTFND   (4699-EXIT)
  6698*        ENDFILE  (4689-EOF)
  6699*    END-EXEC.
  6700*    MOVE '"$I''                  ! ) #00006313' TO DFHEIV0
  6701     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6703     MOVE X'2920233030303036333133' TO DFHEIV0(25:11)
  6704     CALL 'kxdfhei1' USING DFHEIV0
  6705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6706
  6707
  6708     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6709     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6710
  6711     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6712
  6713 4610-READ-NEXT.
  6714     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6715
  6716     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6717         GO TO 4689-EOF.
  6718
  6719     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6720
  6721     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6722     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6723     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6724
  6725     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6726
  6727     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6728
  6729
  6730* EXEC CICS  ENDBR
  6731*        DATASET  (PLAN-FILE-ID)
  6732*    END-EXEC.
  6733     MOVE 0
  6734       TO DFHEIV11
  6735*    MOVE '&2                    $   #00006339' TO DFHEIV0
  6736     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6738     MOVE X'2020233030303036333339' TO DFHEIV0(25:11)
  6739     CALL 'kxdfhei1' USING DFHEIV0,
  6740           PLAN-FILE-ID,
  6741           DFHEIV11,
  6742           DFHEIV99
  6743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6744
  6745
  6746
  6747* EXEC CICS GETMAIN
  6748*        LENGTH   (PLAN-REC-LEN)
  6749*        SET      (ADDRESS OF PLAN-MASTER)
  6750*        INITIMG  (GETMAIN-SPACE)
  6751*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 138
* EL650.cbl
  6752*    MOVE ',"IL                  $   #00006343' TO DFHEIV0
  6753     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6755     MOVE X'2020233030303036333433' TO DFHEIV0(25:11)
  6756     CALL 'kxdfhei1' USING DFHEIV0,
  6757           DFHEIV20,
  6758           PLAN-REC-LEN,
  6759           GETMAIN-SPACE
  6760     SET ADDRESS OF PLAN-MASTER TO
  6761         DFHEIV20
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6763
  6764
  6765     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6766
  6767
  6768* EXEC CICS  WRITE
  6769*        DATASET  (PLAN-FILE-ID)
  6770*        RIDFLD   (PL-CONTROL-PRIMARY)
  6771*        FROM     (PLAN-MASTER)
  6772*    END-EXEC.
  6773     MOVE LENGTH OF
  6774      PLAN-MASTER
  6775       TO DFHEIV11
  6776*    MOVE '&$ L                  ''   #00006351' TO DFHEIV0
  6777     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6778     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6779     MOVE X'2020233030303036333531' TO DFHEIV0(25:11)
  6780     CALL 'kxdfhei1' USING DFHEIV0,
  6781           PLAN-FILE-ID,
  6782           PLAN-MASTER,
  6783           DFHEIV11,
  6784           PL-CONTROL-PRIMARY,
  6785           DFHEIV99,
  6786           DFHEIV99
  6787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6788
  6789
  6790     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6791     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6792
  6793     GO TO 4610-READ-NEXT.
  6794
  6795 4689-EOF.
  6796
  6797* EXEC CICS  ENDBR
  6798*        DATASET  (PLAN-FILE-ID)
  6799*    END-EXEC.
  6800     MOVE 0
  6801       TO DFHEIV11
  6802*    MOVE '&2                    $   #00006363' TO DFHEIV0
  6803     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6804     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6805     MOVE X'2020233030303036333633' TO DFHEIV0(25:11)
  6806     CALL 'kxdfhei1' USING DFHEIV0,
  6807           PLAN-FILE-ID,
  6808           DFHEIV11,
  6809           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 139
* EL650.cbl
  6810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6811
  6812
  6813 4699-EXIT.
  6814      EXIT.
  6815
  6816 4700-STARTBR-PLAN.
  6817
  6818* EXEC CICS  STARTBR
  6819*        DATASET  (PLAN-FILE-ID)
  6820*        RIDFLD   (WS-PLAN-KEY)
  6821*    END-EXEC.
  6822     MOVE 0
  6823       TO DFHEIV11
  6824*    MOVE '&,         G          &   #00006371' TO DFHEIV0
  6825     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6826     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6827     MOVE X'2020233030303036333731' TO DFHEIV0(25:11)
  6828     CALL 'kxdfhei1' USING DFHEIV0,
  6829           PLAN-FILE-ID,
  6830           WS-PLAN-KEY,
  6831           DFHEIV99,
  6832           DFHEIV11,
  6833           DFHEIV99
  6834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6835
  6836
  6837 4700-EXIT.
  6838      EXIT.
  6839
  6840 4710-READNEXT-PLAN.
  6841
  6842* EXEC CICS  READNEXT
  6843*        DATASET  (PLAN-FILE-ID)
  6844*        SET      (ADDRESS OF PLAN-MASTER)
  6845*        RIDFLD   (WS-PLAN-KEY)
  6846*    END-EXEC.
  6847     MOVE 0
  6848       TO DFHEIV11
  6849*    MOVE '&.S                   )   #00006380' TO DFHEIV0
  6850     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6851     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6852     MOVE X'2020233030303036333830' TO DFHEIV0(25:11)
  6853     CALL 'kxdfhei1' USING DFHEIV0,
  6854           PLAN-FILE-ID,
  6855           DFHEIV20,
  6856           DFHEIV99,
  6857           WS-PLAN-KEY,
  6858           DFHEIV99,
  6859           DFHEIV11,
  6860           DFHEIV99,
  6861           DFHEIV99
  6862     SET ADDRESS OF PLAN-MASTER TO
  6863         DFHEIV20
  6864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6865
  6866
  6867 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 140
* EL650.cbl
  6868      EXIT.
  6869
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 141
* EL650.cbl
  6871 4800-DELETE-PLAN-REC.
  6872
  6873* EXEC CICS  HANDLE CONDITION
  6874*        NOTFND   (4899-EXIT)
  6875*        ENDFILE  (4889-EOF)
  6876*    END-EXEC.
  6877*    MOVE '"$I''                  ! * #00006391' TO DFHEIV0
  6878     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6880     MOVE X'2A20233030303036333931' TO DFHEIV0(25:11)
  6881     CALL 'kxdfhei1' USING DFHEIV0
  6882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6883
  6884
  6885     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6886     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6887                                   PI-PREV-ACCOUNT.
  6888
  6889 4805-STARTBR.
  6890     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6891
  6892 4810-READ-NEXT.
  6893     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6894
  6895     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6896         GO TO 4889-EOF.
  6897
  6898
  6899* EXEC CICS  ENDBR
  6900*        DATASET  (PLAN-FILE-ID)
  6901*    END-EXEC.
  6902     MOVE 0
  6903       TO DFHEIV11
  6904*    MOVE '&2                    $   #00006409' TO DFHEIV0
  6905     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6906     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6907     MOVE X'2020233030303036343039' TO DFHEIV0(25:11)
  6908     CALL 'kxdfhei1' USING DFHEIV0,
  6909           PLAN-FILE-ID,
  6910           DFHEIV11,
  6911           DFHEIV99
  6912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6913
  6914
  6915
  6916* EXEC CICS  READ
  6917*        UPDATE
  6918*        DATASET  (PLAN-FILE-ID)
  6919*        SET      (ADDRESS OF PLAN-MASTER)
  6920*        RIDFLD   (WS-PLAN-KEY)
  6921*    END-EXEC.
  6922*    MOVE '&"S        EU         (   #00006413' TO DFHEIV0
  6923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6925     MOVE X'2020233030303036343133' TO DFHEIV0(25:11)
  6926     CALL 'kxdfhei1' USING DFHEIV0,
  6927           PLAN-FILE-ID,
  6928           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 142
* EL650.cbl
  6929           DFHEIV99,
  6930           WS-PLAN-KEY,
  6931           DFHEIV99,
  6932           DFHEIV99,
  6933           DFHEIV99
  6934     SET ADDRESS OF PLAN-MASTER TO
  6935         DFHEIV20
  6936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6937
  6938
  6939
  6940* EXEC CICS  DELETE
  6941*        DATASET  (PLAN-FILE-ID)
  6942*    END-EXEC.
  6943*    MOVE '&(                    &   #00006420' TO DFHEIV0
  6944     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6946     MOVE X'2020233030303036343230' TO DFHEIV0(25:11)
  6947     CALL 'kxdfhei1' USING DFHEIV0,
  6948           PLAN-FILE-ID,
  6949           DFHEIV99,
  6950           DFHEIV99,
  6951           DFHEIV99,
  6952           DFHEIV99
  6953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6954
  6955
  6956     GO TO 4805-STARTBR.
  6957
  6958 4889-EOF.
  6959
  6960* EXEC CICS  ENDBR
  6961*        DATASET  (PLAN-FILE-ID)
  6962*    END-EXEC.
  6963     MOVE 0
  6964       TO DFHEIV11
  6965*    MOVE '&2                    $   #00006427' TO DFHEIV0
  6966     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6967     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6968     MOVE X'2020233030303036343237' TO DFHEIV0(25:11)
  6969     CALL 'kxdfhei1' USING DFHEIV0,
  6970           PLAN-FILE-ID,
  6971           DFHEIV11,
  6972           DFHEIV99
  6973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6974
  6975
  6976 4899-EXIT.
  6977      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 143
* EL650.cbl
  6979 4900-CREATE-NEW-ACCOUNT.
  6980     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6981
  6982     SET T-INDEX                 TO  LINEI.
  6983
  6984     IF PI-2ND-PAGE
  6985         SET T-INDEX  UP  BY  8
  6986     ELSE
  6987     IF PI-3RD-PAGE
  6988         SET T-INDEX  UP  BY  16
  6989     ELSE
  6990     IF PI-LST-PAGE
  6991         SET T-INDEX  UP  BY  24.
  6992
  6993     IF EFFCHGL NOT =  ZERO
  6994         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6995       ELSE
  6996         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6997
  6998     IF EXPCHGL NOT =  ZERO
  6999         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  7000       ELSE
  7001         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  7002
  7003     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  7004
  7005     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  7006         MOVE -1                 TO  EXPCHGL
  7007         MOVE ER-1228            TO  EMI-ERROR
  7008         MOVE AL-UABON           TO  EXPCHGA
  7009         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7010
  7011     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  7012
  7013     IF EMI-ERROR  NOT = ZEROS
  7014         GO TO 8200-SEND-DATAONLY.
  7015
  7016     MOVE SPACES                 TO  GETMAIN-SW.
  7017
  7018     IF NOT EMI-NO-ERRORS
  7019         GO TO 8200-SEND-DATAONLY.
  7020
  7021     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  7022         MOVE ER-0453            TO  EMI-ERROR
  7023         MOVE -1                 TO  MAINTL
  7024         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7025         GO TO 8200-SEND-DATAONLY.
  7026
  7027     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  7028
  7029     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7030
  7031     PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  7032         VARYING  WS-INDEX  FROM  +1  BY  +1
  7033            UNTIL WS-INDEX GREATER +32.
  7034
  7035     IF NOT EMI-NO-ERRORS
  7036         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 144
* EL650.cbl
  7037
  7038     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  7039     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7040     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7041
  7042     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  7043
  7044     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  7045     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7046                                     AM-LO-CERT-DATE
  7047     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  7048     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  7049                                     AM-PREV-DATES
  7050                                     AM-ORIG-DEALER-NO
  7051
  7052     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  7053     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7054     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7055     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7056
  7057     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  7058
  7059     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7060     MOVE 'A'                    TO  JP-RECORD-TYPE.
  7061
  7062
  7063* EXEC CICS GETMAIN
  7064*        LENGTH   (ACCT-REC-LEN)
  7065*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7066*        INITIMG  (GETMAIN-SPACE)
  7067*    END-EXEC.
  7068*    MOVE ',"IL                  $   #00006517' TO DFHEIV0
  7069     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7070     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7071     MOVE X'2020233030303036353137' TO DFHEIV0(25:11)
  7072     CALL 'kxdfhei1' USING DFHEIV0,
  7073           DFHEIV20,
  7074           ACCT-REC-LEN,
  7075           GETMAIN-SPACE
  7076     SET ADDRESS OF ACCOUNT-MASTER TO
  7077         DFHEIV20
  7078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7079
  7080
  7081     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  7082     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  7083     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  7084     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7085     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7086                                     AM-VG-EXPIRATION-DT.
  7087
  7088     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7089
  7090
  7091* EXEC CICS  HANDLE CONDITION
  7092*        DUPREC   (4580-DUPREC)
  7093*        DUPKEY   (4580-DUPREC)
  7094*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 145
* EL650.cbl
  7095*    MOVE '"$%$                  ! + #00006532' TO DFHEIV0
  7096     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7098     MOVE X'2B20233030303036353332' TO DFHEIV0(25:11)
  7099     CALL 'kxdfhei1' USING DFHEIV0
  7100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7101
  7102
  7103
  7104* EXEC CICS  WRITE
  7105*        DATASET  (PI-ACCT-ID)
  7106*        RIDFLD   (AM-CONTROL-PRIMARY)
  7107*        FROM     (ACCOUNT-MASTER)
  7108*    END-EXEC.
  7109     MOVE LENGTH OF
  7110      ACCOUNT-MASTER
  7111       TO DFHEIV11
  7112*    MOVE '&$ L                  ''   #00006537' TO DFHEIV0
  7113     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7115     MOVE X'2020233030303036353337' TO DFHEIV0(25:11)
  7116     CALL 'kxdfhei1' USING DFHEIV0,
  7117           PI-ACCT-ID,
  7118           ACCOUNT-MASTER,
  7119           DFHEIV11,
  7120           AM-CONTROL-PRIMARY,
  7121           DFHEIV99,
  7122           DFHEIV99
  7123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7124
  7125
  7126     MOVE PI-ACCT-ID             TO  FILE-ID.
  7127
  7128     PERFORM 8400-LOG-JOURNAL-RECORD.
  7129
  7130     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7131         NEXT SENTENCE
  7132     ELSE
  7133         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7134         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7135
  7136 4580-DUPREC.
  7137     MOVE 1                  TO K-WITH-LINE-USED.
  7138     MOVE LOW-VALUES         TO EL650AI.
  7139
  7140     GO TO 4590-SHOW-NEW-ACCOUNT.
  7141
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 146
* EL650.cbl
  7143 4950-ADD-ERPLAN-RECORD.
  7144
  7145* EXEC CICS GETMAIN
  7146*        LENGTH   (PLAN-REC-LEN)
  7147*        SET      (ADDRESS OF PLAN-MASTER)
  7148*        INITIMG  (GETMAIN-SPACE)
  7149*    END-EXEC.
  7150*    MOVE ',"IL                  $   #00006561' TO DFHEIV0
  7151     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7152     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7153     MOVE X'2020233030303036353631' TO DFHEIV0(25:11)
  7154     CALL 'kxdfhei1' USING DFHEIV0,
  7155           DFHEIV20,
  7156           PLAN-REC-LEN,
  7157           GETMAIN-SPACE
  7158     SET ADDRESS OF PLAN-MASTER TO
  7159         DFHEIV20
  7160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7161
  7162
  7163
  7164* EXEC CICS  HANDLE CONDITION
  7165*        DUPREC   (4959-EXIT)
  7166*        DUPKEY   (4959-EXIT)
  7167*    END-EXEC.
  7168*    MOVE '"$%$                  ! , #00006567' TO DFHEIV0
  7169     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7171     MOVE X'2C20233030303036353637' TO DFHEIV0(25:11)
  7172     CALL 'kxdfhei1' USING DFHEIV0
  7173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7174
  7175
  7176     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7177
  7178     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7179     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7180     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7181
  7182     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7183
  7184
  7185* EXEC CICS  WRITE
  7186*        DATASET  (PLAN-FILE-ID)
  7187*        RIDFLD   (PL-CONTROL-PRIMARY)
  7188*        FROM     (PLAN-MASTER)
  7189*    END-EXEC.
  7190     MOVE LENGTH OF
  7191      PLAN-MASTER
  7192       TO DFHEIV11
  7193*    MOVE '&$ L                  ''   #00006580' TO DFHEIV0
  7194     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7196     MOVE X'2020233030303036353830' TO DFHEIV0(25:11)
  7197     CALL 'kxdfhei1' USING DFHEIV0,
  7198           PLAN-FILE-ID,
  7199           PLAN-MASTER,
  7200           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 147
* EL650.cbl
  7201           PL-CONTROL-PRIMARY,
  7202           DFHEIV99,
  7203           DFHEIV99
  7204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7205
  7206
  7207 4959-EXIT.
  7208     EXIT.
  7209
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 148
* EL650.cbl
  7211 4960-ADD-ERCOMP-RECORD.
  7212
  7213* EXEC CICS GETMAIN
  7214*         LENGTH   (COMP-REC-LEN)
  7215*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7216*         INITIMG  (GETMAIN-SPACE)
  7217*    END-EXEC.
  7218*    MOVE ',"IL                  $   #00006591' TO DFHEIV0
  7219     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7221     MOVE X'2020233030303036353931' TO DFHEIV0(25:11)
  7222     CALL 'kxdfhei1' USING DFHEIV0,
  7223           DFHEIV20,
  7224           COMP-REC-LEN,
  7225           GETMAIN-SPACE
  7226     SET ADDRESS OF COMPENSATION-MASTER TO
  7227         DFHEIV20
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7229
  7230
  7231     MOVE SPACES                 TO COMPENSATION-MASTER.
  7232     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7233                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7234                   CO-OV30         CO-OV60      CO-OV90
  7235                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7236                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7237                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7238                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7239                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7240                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7241                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7242                   CO-CURRENT-CUR-PMT
  7243                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7244                   CO-ACT-YEAR        CO-ACT-MONTH
  7245                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7246                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7247                   CO-CURRENT-LAST-STMT-YEAR
  7248                   CO-CURRENT-LAST-STMT-MONTH
  7249                   CO-CURRENT-LAST-STMT-DAY
  7250                   CO-YTD-PAID-COM
  7251                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7252     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7253     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7254     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7255     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7256     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7257
  7258     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7259         MOVE ZEROS              TO CO-CARRIER
  7260     ELSE
  7261         MOVE AM-CARRIER         TO CO-CARRIER.
  7262
  7263     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7264         MOVE ZEROS              TO CO-GROUPING
  7265     ELSE
  7266         MOVE AM-GROUPING        TO CO-GROUPING.
  7267
  7268     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 149
* EL650.cbl
  7269     MOVE AM-NAME                TO CO-ACCT-NAME.
  7270     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7271     MOVE AM-ADDRS               TO CO-ADDR-1.
  7272*    MOVE AM-CITY                TO CO-ADDR-3.
  7273     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7274     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7275     MOVE AM-ZIP                 TO CO-ZIP.
  7276     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7277     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7278     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7279
  7280     IF AM-REMIT-TO NOT = ZERO
  7281         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7282       ELSE
  7283         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7284
  7285     MOVE +0                      TO AGT-SUB.
  7286
  7287     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7288
  7289     IF VALID-AGT-SW = 'Y'
  7290         NEXT SENTENCE
  7291     ELSE
  7292         GO TO 4969-EXIT.
  7293
  7294     IF CO-RESP-NO = CO-ACCOUNT
  7295         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7296     ELSE
  7297         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7298
  7299     IF PI-AR-PROCESSING
  7300        MOVE 'G'                   TO CO-AR-REPORTING
  7301        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7302        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7303        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7304
  7305     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7306        MOVE 'N'                   TO CO-AR-REPORTING.
  7307
  7308     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7309        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7310
  7311     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7312
  7313
  7314* EXEC CICS HANDLE CONDITION
  7315*         DUPREC   (4969-EXIT)
  7316*         DUPKEY   (4969-EXIT)
  7317*    END-EXEC.
  7318*    MOVE '"$%$                  ! - #00006679' TO DFHEIV0
  7319     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7320     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7321     MOVE X'2D20233030303036363739' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0
  7323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7324
  7325
  7326
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 150
* EL650.cbl
  7327* EXEC CICS WRITE
  7328*        FROM      (COMPENSATION-MASTER)
  7329*        RIDFLD    (CO-CONTROL-PRIMARY)
  7330*        DATASET   (COMP-FILE-ID)
  7331*    END-EXEC.
  7332     MOVE LENGTH OF
  7333      COMPENSATION-MASTER
  7334       TO DFHEIV11
  7335*    MOVE '&$ L                  ''   #00006684' TO DFHEIV0
  7336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7338     MOVE X'2020233030303036363834' TO DFHEIV0(25:11)
  7339     CALL 'kxdfhei1' USING DFHEIV0,
  7340           COMP-FILE-ID,
  7341           COMPENSATION-MASTER,
  7342           DFHEIV11,
  7343           CO-CONTROL-PRIMARY,
  7344           DFHEIV99,
  7345           DFHEIV99
  7346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7347
  7348
  7349 4969-EXIT.
  7350     EXIT.
  7351
  7352 4970-FIND-C-AGT.
  7353     ADD 1 TO  AGT-SUB.
  7354     IF AGT-SUB GREATER 10
  7355         MOVE 'N'                TO  VALID-AGT-SW
  7356         GO TO 4970-EXIT.
  7357
  7358     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F')
  7359         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7360         MOVE 'Y'                TO  VALID-AGT-SW
  7361         GO TO 4970-EXIT
  7362     ELSE
  7363         GO TO 4970-FIND-C-AGT.
  7364
  7365 4970-EXIT.
  7366     EXIT.
  7367
  7368 4980-ADD-COMPENSATION-NAME.
  7369
  7370* EXEC CICS HANDLE CONDITION
  7371*         DUPREC   (4980-EXIT)
  7372*    END-EXEC.
  7373*    MOVE '"$%                   ! . #00006710' TO DFHEIV0
  7374     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7376     MOVE X'2E20233030303036373130' TO DFHEIV0(25:11)
  7377     CALL 'kxdfhei1' USING DFHEIV0
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7379
  7380
  7381
  7382* EXEC CICS GETMAIN
  7383*         LENGTH   (NAME-REC-LEN)
  7384*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 151
* EL650.cbl
  7385*         INITIMG  (GETMAIN-SPACE)
  7386*    END-EXEC.
  7387*    MOVE ',"IL                  $   #00006714' TO DFHEIV0
  7388     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7389     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7390     MOVE X'2020233030303036373134' TO DFHEIV0(25:11)
  7391     CALL 'kxdfhei1' USING DFHEIV0,
  7392           DFHEIV20,
  7393           NAME-REC-LEN,
  7394           GETMAIN-SPACE
  7395     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7396         DFHEIV20
  7397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7398
  7399
  7400     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7401     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7402     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7403     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7404     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7405     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7406     MOVE CO-ADDR-CITY           TO  NL-CITY
  7407     MOVE CO-ADDR-STATE          TO  NL-ST
  7408     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7409     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7410     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7411     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7412     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7413     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7414     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7415
  7416
  7417* EXEC CICS WRITE
  7418*        FROM      (NAME-LOOKUP-MASTER)
  7419*        RIDFLD    (NL-CONTROL-PRIMARY)
  7420*        DATASET   (NAME-FILE-ID)
  7421*    END-EXEC.
  7422     MOVE LENGTH OF
  7423      NAME-LOOKUP-MASTER
  7424       TO DFHEIV11
  7425*    MOVE '&$ L                  ''   #00006736' TO DFHEIV0
  7426     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7428     MOVE X'2020233030303036373336' TO DFHEIV0(25:11)
  7429     CALL 'kxdfhei1' USING DFHEIV0,
  7430           NAME-FILE-ID,
  7431           NAME-LOOKUP-MASTER,
  7432           DFHEIV11,
  7433           NL-CONTROL-PRIMARY,
  7434           DFHEIV99,
  7435           DFHEIV99
  7436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7437
  7438
  7439 4980-EXIT.
  7440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 152
* EL650.cbl
  7442 5000-CREATE-NEW-RANGE.
  7443
  7444     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7445     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7446
  7447     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7448     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7449
  7450     SET T-INDEX TO PI-TOTAL-LINES.
  7451
  7452     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7453        VARYING T-INDEX FROM T-INDEX BY +1
  7454         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7455
  7456     IF NOT EMI-NO-ERRORS
  7457         GO TO 8200-SEND-DATAONLY.
  7458
  7459     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7460     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7461
  7462     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7463         MOVE -1                 TO  EFFCHGL EXPCHGL
  7464         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7465         MOVE ER-2053            TO  EMI-ERROR
  7466         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7467
  7468     IF NOT EMI-NO-ERRORS
  7469         GO TO 8200-SEND-DATAONLY.
  7470
  7471***************************************************************
  7472*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7473*    DATE IF WITHIN LIMITS                                    *
  7474***************************************************************
  7475
  7476     IF EFFCHGL = ZERO
  7477         SET T-INDEX             TO  PI-TOTAL-LINES
  7478         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7479             MOVE ER-2060        TO  EMI-ERROR
  7480             MOVE -1             TO  EFFCHGL
  7481             MOVE AL-UABON       TO  EFFCHGA
  7482             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7483             GO TO 8200-SEND-DATAONLY
  7484         ELSE
  7485             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7486                    BIN-EXPCHG-SAVE
  7487                 MOVE ER-2061    TO  EMI-ERROR
  7488                 MOVE -1         TO  EXPCHGL
  7489                 MOVE AL-UABON   TO  EXPCHGA
  7490                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7491                 GO TO 8200-SEND-DATAONLY.
  7492
  7493     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7494
  7495*    display ' VERI TABLE BEFORE '
  7496*    perform 4220-DISPLAY-VERI-TABLE
  7497*                                thru 4220-exit
  7498     IF EFFCHGL = ZERO
  7499         MOVE PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 153
* EL650.cbl
  7500                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7501         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7502     ELSE
  7503         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7504                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7505         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7506
  7507*    display ' VERI TABLE AFTER  '
  7508*    perform 4220-DISPLAY-VERI-TABLE
  7509*                                thru 4220-exit
  7510     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7511         VARYING  WS-INDEX  FROM  +1  BY  +1
  7512           UNTIL  WS-INDEX  GREATER +32.
  7513
  7514     IF NOT EMI-NO-ERRORS
  7515         GO TO 8200-SEND-DATAONLY.
  7516
  7517     IF EFFCHGL  =  ZEROS
  7518         MOVE PI-BIN-EXP-DT (T-INDEX)
  7519                                  TO  PI-ACCT-EXP-DT
  7520                                      BIN-EFFCHG-SAVE
  7521                                      DC-BIN-DATE-1
  7522         MOVE SPACE               TO  DC-OPTION-CODE
  7523         PERFORM 9700-DATE-CONVERSION
  7524***  Y2K PROJ 7744
  7525         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7526         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7527         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7528
  7529         PERFORM 5020-READ-PREV-REC
  7530         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7531         GO TO 5005-EXIT
  7532     END-IF.
  7533***  Y2K PROJ 7744
  7534
  7535     IF NOT EMI-NO-ERRORS
  7536         GO TO 8200-SEND-DATAONLY.
  7537
  7538     SET T-INDEX  TO  PI-TOTAL-LINES.
  7539
  7540*    IF (EFFCHGL GREATER THAN +0) AND
  7541*       (EXPCHGL GREATER THAN +0)
  7542*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7543*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7544*          NEXT SENTENCE
  7545*       ELSE
  7546*          GO TO 5006-FIND-EXP-DATE.
  7547*
  7548
  7549
  7550***************************************************************
  7551*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7552*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7553***************************************************************
  7554     SET T-INDEX  TO  PI-TOTAL-LINES.
  7555
  7556     IF BROWSE-STARTED-SW EQUAL 'Y'
  7557        PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 154
* EL650.cbl
  7558
  7559     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7560         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7561             MOVE ER-2063             TO  EMI-ERROR
  7562             MOVE -1                  TO  EFFCHGL
  7563             MOVE AL-UABON            TO  EFFCHGA
  7564             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7565             GO TO 8200-SEND-DATAONLY
  7566         ELSE
  7567             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7568             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7569             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7570             MOVE PI-BIN-EFF-DT (T-INDEX)
  7571                                      TO  B4-ACCT-EFF-DT
  7572             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7573             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7574                                          AM-VG-EXPIRATION-DT
  7575                                          PI-BIN-EXP-DT
  7576                                                    (T-INDEX)
  7577             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7578             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7579             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7580             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7581             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7582             GO TO 5005-EXIT.
  7583
  7584***************************************************************
  7585*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7586*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7587***************************************************************
  7588     SET T-INDEX  TO  PI-TOTAL-LINES.
  7589
  7590     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7591     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7592
  7593     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7594         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7595     ELSE
  7596         PERFORM 5020-READ-PREV-REC
  7597         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7598
  7599 5005-EXIT.
  7600     MOVE SPACES                 TO  EFFCHGO
  7601                                     EXPCHGI.
  7602     MOVE AL-UANOF               TO  EFFCHGA
  7603                                     EXPCHGA.
  7604     MOVE ER-0000                TO  EMI-ERROR.
  7605
  7606     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7607
  7608     GO TO 7000-BUILD-OUTPUT-MAP.
  7609
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 155
* EL650.cbl
  7611 5006-FIND-EXP-DATE.
  7612     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7613                                     PI-ACCT-REST-OF-EXP.
  7614     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7615
  7616     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7617         VARYING  T-INDEX  FROM  +1  BY  +1
  7618           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7619
  7620     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7621        MOVE ER-1220             TO  EMI-ERROR
  7622        MOVE -1                  TO  EFFCHGL
  7623        MOVE AL-UABON            TO  EFFCHGA
  7624        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7625        GO TO         8200-SEND-DATAONLY.
  7626
  7627     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7628        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7629        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7630        MOVE 1 TO PI-PAGE-NUMBER
  7631        GO TO 1000-SHOW-ACCOUNT
  7632     ELSE
  7633     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7634        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7635        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7636        MOVE 1 TO PI-PAGE-NUMBER
  7637        GO TO 1000-SHOW-ACCOUNT
  7638     ELSE
  7639        MOVE ER-2051             TO  EMI-ERROR
  7640        MOVE -1                  TO  EFFCHGL
  7641        MOVE AL-UABON            TO  EFFCHGA
  7642        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7643        GO TO 8200-SEND-DATAONLY.
  7644
  7645 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 156
* EL650.cbl
  7647 5007-CREATE-SUB-DATE-RANGES.
  7648
  7649     IF BROWSE-STARTED-SW EQUAL 'Y'
  7650        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7651
  7652     IF NOT SYSTEM-MODIFY-CAP
  7653         MOVE 'UPDATE'           TO  SM-READ
  7654         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7655         MOVE ER-0070            TO  EMI-ERROR
  7656         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7657         GO TO 8100-SEND-INITIAL-MAP.
  7658
  7659
  7660* EXEC CICS GETMAIN
  7661*        LENGTH   (ACCT-REC-LEN)
  7662*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7663*        INITIMG  (GETMAIN-SPACE)
  7664*    END-EXEC.
  7665*    MOVE ',"IL                  $   #00006962' TO DFHEIV0
  7666     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7668     MOVE X'2020233030303036393632' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0,
  7670           DFHEIV20,
  7671           ACCT-REC-LEN,
  7672           GETMAIN-SPACE
  7673     SET ADDRESS OF ACCOUNT-MASTER TO
  7674         DFHEIV20
  7675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7676
  7677
  7678
  7679* EXEC CICS  HANDLE CONDITION
  7680*        ENDFILE  (5007-EXIT)
  7681*        NOTFND   (5007-EXIT)
  7682*    END-EXEC.
  7683*    MOVE '"$''I                  ! / #00006968' TO DFHEIV0
  7684     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7686     MOVE X'2F20233030303036393638' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0
  7688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7689
  7690
  7691     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7692     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7693
  7694
  7695* EXEC CICS  READ
  7696*        UPDATE
  7697*        DATASET  (PI-ACCT-ID)
  7698*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7699*        RIDFLD   (PI-ACCT-KEY)
  7700*    END-EXEC.
  7701*    MOVE '&"S        EU         (   #00006976' TO DFHEIV0
  7702     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7703     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7704     MOVE X'2020233030303036393736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 157
* EL650.cbl
  7705     CALL 'kxdfhei1' USING DFHEIV0,
  7706           PI-ACCT-ID,
  7707           DFHEIV20,
  7708           DFHEIV99,
  7709           PI-ACCT-KEY,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99
  7713     SET ADDRESS OF ACCOUNT-MASTER TO
  7714         DFHEIV20
  7715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7716
  7717
  7718     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7719     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7720     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7721     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7722     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7723     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7724     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7725     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7726     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7727
  7728     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7729                                  PI-BIN-EFF-DT (T-INDEX).
  7730
  7731* EXEC CICS  REWRITE
  7732*        FROM     (ACCOUNT-MASTER)
  7733*        DATASET  (PI-ACCT-ID)
  7734*    END-EXEC.
  7735     MOVE LENGTH OF
  7736      ACCOUNT-MASTER
  7737       TO DFHEIV11
  7738*    MOVE '&& L                  %   #00006995' TO DFHEIV0
  7739     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7740     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7741     MOVE X'2020233030303036393935' TO DFHEIV0(25:11)
  7742     CALL 'kxdfhei1' USING DFHEIV0,
  7743           PI-ACCT-ID,
  7744           ACCOUNT-MASTER,
  7745           DFHEIV11,
  7746           DFHEIV99
  7747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7748
  7749
  7750
  7751* EXEC CICS SYNCPOINT
  7752*    END-EXEC.
  7753*    MOVE '6"                    !   #00007000' TO DFHEIV0
  7754     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7756     MOVE X'2020233030303037303030' TO DFHEIV0(25:11)
  7757     CALL 'kxdfhei1' USING DFHEIV0
  7758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7759
  7760
  7761     PERFORM 8400-LOG-JOURNAL-RECORD.
  7762     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 158
* EL650.cbl
  7763     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7764     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7765     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7766                                  AM-EFFECTIVE-DT.
  7767     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7768                                  AM-EXPIRATION-DT
  7769                                  AM-VG-EXPIRATION-DT.
  7770     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7771                                  PI-BIN-MAINT-DT (T-INDEX).
  7772     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7773     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7774     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7775     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7776                                  AM-PREV-DATES.
  7777     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7778
  7779
  7780* EXEC CICS  HANDLE CONDITION
  7781*        ENDFILE  (5007-EXIT)
  7782*        NOTFND   (5007-EXIT)
  7783*        DUPREC   (5007-EXIT)
  7784*        ILLOGIC  (5007-EXIT)
  7785*        INVREQ   (5007-EXIT)
  7786*    END-EXEC.
  7787*    MOVE '"$''I%38               ! 0 #00007021' TO DFHEIV0
  7788     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7790     MOVE X'3020233030303037303231' TO DFHEIV0(25:11)
  7791     CALL 'kxdfhei1' USING DFHEIV0
  7792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7793
  7794
  7795     MOVE 'AM'                TO AM-RECORD-ID.
  7796
  7797     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7798     PERFORM 8400-LOG-JOURNAL-RECORD.
  7799     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7800
  7801     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7802     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7803                                  PI-BIN-EFF-DT (T-INDEX).
  7804     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7805                                  AM-EXPIRATION-DT
  7806                                  AM-VG-EXPIRATION-DT.
  7807     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7808                                  PI-BIN-MAINT-DT (T-INDEX).
  7809     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7810     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7811                                  AM-PREV-DATES.
  7812     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7813     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7814     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7815     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7816     PERFORM 8400-LOG-JOURNAL-RECORD.
  7817     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7818
  7819     MOVE ZERO                TO EFFCHGL
  7820                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 159
* EL650.cbl
  7821
  7822
  7823* EXEC CICS  HANDLE CONDITION
  7824*         NOTFND   (5015-NOT-FOUND)
  7825*         ENDFILE  (5015-NOT-FOUND)
  7826*    END-EXEC.
  7827*    MOVE '"$I''                  ! 1 #00007056' TO DFHEIV0
  7828     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7830     MOVE X'3120233030303037303536' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0
  7832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7833
  7834
  7835 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 160
* EL650.cbl
  7837 5008-CREATE-SUB-DATE-RANGES.
  7838
  7839     IF BROWSE-STARTED-SW EQUAL 'Y'
  7840        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7841
  7842     IF NOT SYSTEM-MODIFY-CAP
  7843         MOVE 'UPDATE'           TO  SM-READ
  7844         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7845         MOVE ER-0070            TO  EMI-ERROR
  7846         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7847         GO TO 8100-SEND-INITIAL-MAP.
  7848
  7849     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7850     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7851     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7852     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7853
  7854     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7855
  7856     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7857                                     AM-VG-EXPIRATION-DT
  7858                                     PI-BIN-EXP-DT (T-INDEX).
  7859     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7860                                     PI-BIN-MAINT-DT (T-INDEX).
  7861     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7862     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7863
  7864     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7865
  7866     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7867
  7868     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7869
  7870     IF T-INDEX = PI-TOTAL-LINES
  7871        MOVE ZERO             TO EFFCHGL
  7872                                 EXPCHGL
  7873        GO TO 5008-EXIT.
  7874
  7875     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7876     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7877     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7878
  7879     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7880
  7881     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7882         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7883           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7884
  7885     IF BROWSE-STARTED-SW EQUAL 'Y'
  7886        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7887
  7888
  7889* EXEC CICS  READ
  7890*        UPDATE
  7891*        DATASET  (PI-ACCT-ID)
  7892*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7893*        RIDFLD   (PI-ACCT-KEY)
  7894*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 161
* EL650.cbl
  7895*    MOVE '&"S        EU         (   #00007114' TO DFHEIV0
  7896     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7897     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7898     MOVE X'2020233030303037313134' TO DFHEIV0(25:11)
  7899     CALL 'kxdfhei1' USING DFHEIV0,
  7900           PI-ACCT-ID,
  7901           DFHEIV20,
  7902           DFHEIV99,
  7903           PI-ACCT-KEY,
  7904           DFHEIV99,
  7905           DFHEIV99,
  7906           DFHEIV99
  7907     SET ADDRESS OF ACCOUNT-MASTER TO
  7908         DFHEIV20
  7909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7910
  7911
  7912     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7913     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7914     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7915
  7916     PERFORM 8400-LOG-JOURNAL-RECORD.
  7917
  7918     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7919                                     PI-BIN-EFF-DT (T-INDEX).
  7920     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7921     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7922                                     PI-BIN-MAINT-DT (T-INDEX).
  7923     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7924     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7925     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7926     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7927
  7928     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7929
  7930
  7931* EXEC CICS  REWRITE
  7932*        FROM     (ACCOUNT-MASTER)
  7933*        DATASET  (PI-ACCT-ID)
  7934*    END-EXEC.
  7935     MOVE LENGTH OF
  7936      ACCOUNT-MASTER
  7937       TO DFHEIV11
  7938*    MOVE '&& L                  %   #00007139' TO DFHEIV0
  7939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7941     MOVE X'2020233030303037313339' TO DFHEIV0(25:11)
  7942     CALL 'kxdfhei1' USING DFHEIV0,
  7943           PI-ACCT-ID,
  7944           ACCOUNT-MASTER,
  7945           DFHEIV11,
  7946           DFHEIV99
  7947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7948
  7949
  7950     PERFORM 8400-LOG-JOURNAL-RECORD.
  7951
  7952     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 162
* EL650.cbl
  7953
  7954
  7955
  7956     MOVE ZERO                TO EFFCHGL
  7957                                 EXPCHGL.
  7958
  7959
  7960* EXEC CICS  HANDLE CONDITION
  7961*         NOTFND   (5015-NOT-FOUND)
  7962*         ENDFILE  (5015-NOT-FOUND)
  7963*    END-EXEC.
  7964*    MOVE '"$I''                  ! 2 #00007153' TO DFHEIV0
  7965     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7967     MOVE X'3220233030303037313533' TO DFHEIV0(25:11)
  7968     CALL 'kxdfhei1' USING DFHEIV0
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7970
  7971
  7972 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 163
* EL650.cbl
  7974 5010-CHECK-VALID-NEW-RANGE.
  7975
  7976***************************************************************
  7977*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7978*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7979***************************************************************
  7980
  7981     IF PI-AR-PROCESSING
  7982        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7983
  7984     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7985                        GREATER BIN-EFFCHG-SAVE          AND
  7986                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7987         MOVE PI-BIN-EXP-DT (T-INDEX)
  7988                                  TO  PI-ACCT-EXP-DT
  7989         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7990         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7991         MOVE PI-BIN-EFF-DT (T-INDEX)
  7992                                  TO  B4-ACCT-EFF-DT
  7993         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7994         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7995                                      AM-VG-EXPIRATION-DT
  7996                                      PI-BIN-EXP-DT (T-INDEX)
  7997         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7998         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7999         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8000         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8001         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8002         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8003     ELSE
  8004         MOVE ER-2051             TO  EMI-ERROR
  8005         MOVE -1                  TO  EFFCHGL
  8006         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8007         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8008         GO TO 8200-SEND-DATAONLY.
  8009
  8010     GO TO 5010-EXIT.
  8011
  8012 5010-CHECK-AR-VALID-NEW-RANGE.
  8013
  8014***************************************************************
  8015*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  8016*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  8017***************************************************************
  8018
  8019     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  8020                        GREATER BIN-EFFCHG-SAVE          AND
  8021                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  8022         MOVE PI-BIN-EXP-DT (T-INDEX)
  8023                                  TO  PI-ACCT-EXP-DT
  8024         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  8025         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8026         MOVE PI-BIN-EFF-DT (T-INDEX)
  8027                                  TO  B4-ACCT-EFF-DT
  8028         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8029         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8030                                      AM-VG-EXPIRATION-DT
  8031                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 164
* EL650.cbl
  8032         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8033         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8034         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8035         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8036         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8037         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8038     ELSE
  8039         MOVE ER-2051             TO  EMI-ERROR
  8040         MOVE -1                  TO  EFFCHGL
  8041         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8042         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8043         GO TO 8200-SEND-DATAONLY.
  8044
  8045 5010-EXIT.
  8046     EXIT.
  8047
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 165
* EL650.cbl
  8049 5015-NOT-FOUND.
  8050     MOVE ER-0226                TO  EMI-ERROR.
  8051     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8052     MOVE -1                 TO  MAINTL.
  8053     GO TO 8200-SEND-DATAONLY.
  8054
  8055 5015-EXIT.
  8056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 166
* EL650.cbl
  8058 5020-READ-PREV-REC.
  8059
  8060* EXEC CICS  READ
  8061*        DATASET  (PI-ACCT-ID)
  8062*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8063*        RIDFLD   (PI-ACCT-KEY)
  8064*    END-EXEC.
  8065*    MOVE '&"S        E          (   #00007245' TO DFHEIV0
  8066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8068     MOVE X'2020233030303037323435' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0,
  8070           PI-ACCT-ID,
  8071           DFHEIV20,
  8072           DFHEIV99,
  8073           PI-ACCT-KEY,
  8074           DFHEIV99,
  8075           DFHEIV99,
  8076           DFHEIV99
  8077     SET ADDRESS OF ACCOUNT-MASTER TO
  8078         DFHEIV20
  8079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8080
  8081
  8082 5050-CREATE-NEW-REC.
  8083     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  8084     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  8085                                     AM-VG-EXPIRATION-DT.
  8086     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  8087     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  8088                                     AM-1ST-PROD-DATE
  8089                                     AM-PREV-DATES
  8090                                     AM-BILLING-STATUS.
  8091     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  8092                                     AM-LO-CERT-DATE.
  8093
  8094     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8095        NEXT SENTENCE
  8096     ELSE
  8097        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8098
  8099     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8100     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8101     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8102
  8103     SET T-INDEX  UP  BY  1.
  8104     IF T-INDEX  GREATER 32
  8105         MOVE ER-2062            TO  EMI-ERROR
  8106         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8107         MOVE -1                 TO  MAINTL
  8108         GO TO 8200-SEND-DATAONLY.
  8109
  8110     ADD 1                       TO  PI-TOTAL-LINES.
  8111
  8112     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8113     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8114     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8115     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 167
* EL650.cbl
  8116     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8117
  8118     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8119
  8120     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8121     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8122     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8123
  8124
  8125* EXEC CICS  WRITE
  8126*        RIDFLD   (AM-CONTROL-PRIMARY)
  8127*        FROM     (ACCOUNT-MASTER)
  8128*        DATASET  (PI-ACCT-ID)
  8129*    END-EXEC.
  8130     MOVE LENGTH OF
  8131      ACCOUNT-MASTER
  8132       TO DFHEIV11
  8133*    MOVE '&$ L                  ''   #00007293' TO DFHEIV0
  8134     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8136     MOVE X'2020233030303037323933' TO DFHEIV0(25:11)
  8137     CALL 'kxdfhei1' USING DFHEIV0,
  8138           PI-ACCT-ID,
  8139           ACCOUNT-MASTER,
  8140           DFHEIV11,
  8141           AM-CONTROL-PRIMARY,
  8142           DFHEIV99,
  8143           DFHEIV99
  8144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8145
  8146
  8147     PERFORM 8400-LOG-JOURNAL-RECORD.
  8148
  8149     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8150
  8151 5050-EXIT.
  8152     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 168
* EL650.cbl
  8154 5100-FIND-NEXT-RANGE.
  8155     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8156
  8157     IF PI-TOTAL-LINES  = ZERO
  8158         GO TO 5210-NO-DATA.
  8159
  8160     IF PI-LST-PAGE
  8161       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8162       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8163       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8164         MOVE ER-2065            TO  EMI-ERROR
  8165         MOVE -1                 TO  MAINTL
  8166         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8167         GO TO 8200-SEND-DATAONLY.
  8168
  8169     IF PI-FST-PAGE
  8170         MOVE 2                  TO  PI-PAGE-NUMBER
  8171     ELSE
  8172     IF PI-2ND-PAGE
  8173         MOVE 3                  TO  PI-PAGE-NUMBER
  8174     ELSE
  8175     IF PI-3RD-PAGE
  8176         MOVE 4                  TO  PI-PAGE-NUMBER.
  8177
  8178     GO TO 7000-BUILD-OUTPUT-MAP.
  8179
  8180 5200-FIND-PREV-RANGE.
  8181     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8182
  8183     IF PI-TOTAL-LINES  =  ZERO
  8184         GO TO 5210-NO-DATA.
  8185
  8186     IF PI-FST-PAGE
  8187         MOVE ER-2066            TO  EMI-ERROR
  8188         MOVE -1                 TO  MAINTL
  8189         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8190         GO TO 8200-SEND-DATAONLY.
  8191
  8192     IF PI-2ND-PAGE
  8193         MOVE 1                  TO  PI-PAGE-NUMBER
  8194     ELSE
  8195     IF PI-3RD-PAGE
  8196         MOVE 2                  TO  PI-PAGE-NUMBER
  8197     ELSE
  8198     IF PI-LST-PAGE
  8199         MOVE 3                  TO  PI-PAGE-NUMBER.
  8200
  8201     GO TO 7000-BUILD-OUTPUT-MAP.
  8202
  8203 5210-NO-DATA.
  8204     MOVE ER-2069                TO  EMI-ERROR.
  8205     MOVE -1                     TO  MAINTL.
  8206
  8207     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8208
  8209     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 169
* EL650.cbl
  8211 5300-FIND-NEXT-ACCOUNT.
  8212     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8213     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8214
  8215     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8216         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8217     ELSE
  8218         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8219         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8220         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8221
  8222     IF NOT EMI-NO-ERRORS
  8223         GO TO 8200-SEND-DATAONLY.
  8224
  8225
  8226* EXEC CICS  HANDLE CONDITION
  8227*        NOTFND   (5340-END)
  8228*        ENDFILE  (5330-NOT-FOUND)
  8229*    END-EXEC.
  8230*    MOVE '"$I''                  ! 3 #00007377' TO DFHEIV0
  8231     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8233     MOVE X'3320233030303037333737' TO DFHEIV0(25:11)
  8234     CALL 'kxdfhei1' USING DFHEIV0
  8235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8236
  8237
  8238 5305-START-BR.
  8239     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8240
  8241     SET T-INDEX
  8242        TS-INDEX  TO  +1.
  8243
  8244     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8245
  8246 5310-READ-NEXT.
  8247     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8248
  8249     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8250         GO TO 5330-NOT-FOUND.
  8251
  8252     IF PI-CARRIER-SECURITY GREATER SPACES
  8253         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8254             NEXT SENTENCE
  8255         ELSE
  8256             GO TO 5310-READ-NEXT.
  8257
  8258     IF FIRST-TIME
  8259         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8260             MOVE SPACES             TO  FIRST-TIME-SW
  8261             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8262                                         PI-PREV-VG-ACCOUNT
  8263         ELSE
  8264             GO TO 5310-READ-NEXT.
  8265
  8266     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8267         IF PI-COMPANY-CD  = PI-ACCT-CO
  8268             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 170
* EL650.cbl
  8269         ELSE
  8270             MOVE ER-0066        TO  EMI-ERROR
  8271             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8272             MOVE -1             TO  MAINTL
  8273             GO TO 8200-SEND-DATAONLY.
  8274
  8275     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8276         GO TO 5320-DISPLAY-RECORD
  8277     ELSE
  8278         MOVE 1                  TO  PI-PAGE-NUMBER
  8279         GO TO 7000-BUILD-OUTPUT-MAP.
  8280
  8281 5320-DISPLAY-RECORD.
  8282     IF T-INDEX  = 1
  8283         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8284         MOVE SPACE              TO  NAMEFLGO
  8285                                     PI-NAMEFLG.
  8286
  8287     IF AM-TRNTO-DTE  =  SPACES
  8288         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8289
  8290     IF AM-TRNFROM-DTE  = SPACES
  8291         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8292
  8293     IF T-INDEX  = 1
  8294         IF PI-COMPANY-ID  = 'LGX'  OR
  8295                             'MIC'  OR  'MCC'
  8296             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8297             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8298             MOVE SPACE              TO  DC-OPTION-CODE
  8299             PERFORM 9700-DATE-CONVERSION
  8300             IF DATE-CONVERSION-ERROR
  8301                 MOVE SPACES         TO  TRNTODTO
  8302             ELSE
  8303                 MOVE DC-GREG-DATE-1-EDIT
  8304                                     TO  TRNTODTO.
  8305
  8306     IF T-INDEX  = 1
  8307         IF PI-COMPANY-ID  =  'LGX'  OR
  8308                              'MIC'  OR  'MCC'
  8309             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8310             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8311             MOVE SPACE                TO  DC-OPTION-CODE
  8312             PERFORM 9700-DATE-CONVERSION
  8313             IF DATE-CONVERSION-ERROR
  8314                 MOVE SPACES           TO  TRNFRDTO
  8315             ELSE
  8316                 MOVE DC-GREG-DATE-1-EDIT
  8317                                       TO  TRNFRDTO.
  8318
  8319     IF NAMEO  NOT = LOW-VALUES
  8320         IF AM-NAME  NOT = NAMEO
  8321             MOVE '*'            TO  NAMEFLGO
  8322                                     PI-NAMEFLG.
  8323
  8324     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8325
  8326     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 171
* EL650.cbl
  8327         MOVE AM-NAME                TO  NAMEO
  8328                                         PI-ACCNAME
  8329        ELSE
  8330         MOVE PI-ACCNAME             TO  NAMEO.
  8331
  8332     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8333
  8334     GO TO 5310-READ-NEXT.
  8335
  8336 5330-NOT-FOUND.
  8337     IF BROWSE-STARTED
  8338         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8339     ELSE
  8340         GO TO 5340-END.
  8341
  8342     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8343         MOVE ER-0472            TO  EMI-ERROR
  8344         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8345         MOVE -1                 TO  MAINTL
  8346         GO TO 8200-SEND-DATAONLY.
  8347
  8348     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8349       AND  T-INDEX  NOT = 1
  8350         MOVE 1                  TO  PI-PAGE-NUMBER
  8351         GO TO 7000-BUILD-OUTPUT-MAP
  8352     ELSE
  8353         IF T-INDEX  NOT = 1
  8354             MOVE ER-0066        TO  EMI-ERROR
  8355             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8356             MOVE 1              TO  PI-PAGE-NUMBER
  8357             GO TO 7000-BUILD-OUTPUT-MAP.
  8358
  8359 5340-END.
  8360     MOVE ER-0066                TO  EMI-ERROR.
  8361
  8362     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8363
  8364     MOVE -1                     TO  MAINTL.
  8365
  8366     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 172
* EL650.cbl
  8368 5400-FIND-PREV-ACCOUNT.
  8369     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8370         GO TO 5430-NOT-FOUND.
  8371
  8372     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8373     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8374     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8375
  8376
  8377* EXEC CICS  HANDLE CONDITION
  8378*        NOTFND   (5440-NOT-FOUND)
  8379*        ENDFILE  (5430-NOT-FOUND)
  8380*    END-EXEC.
  8381*    MOVE '"$I''                  ! 4 #00007520' TO DFHEIV0
  8382     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8384     MOVE X'3420233030303037353230' TO DFHEIV0(25:11)
  8385     CALL 'kxdfhei1' USING DFHEIV0
  8386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8387
  8388
  8389
  8390* EXEC CICS  STARTBR
  8391*        DATASET  (PI-ACCT-ID)
  8392*        RIDFLD   (PI-ACCT-KEY)
  8393*    END-EXEC.
  8394     MOVE 0
  8395       TO DFHEIV11
  8396*    MOVE '&,         G          &   #00007525' TO DFHEIV0
  8397     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8399     MOVE X'2020233030303037353235' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           PI-ACCT-ID,
  8402           PI-ACCT-KEY,
  8403           DFHEIV99,
  8404           DFHEIV11,
  8405           DFHEIV99
  8406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8407
  8408
  8409     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8410                                     FIRST-TIME-SW.
  8411 5410-READ-PREV.
  8412
  8413* EXEC CICS  READPREV
  8414*        DATASET  (PI-ACCT-ID)
  8415*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8416*        RIDFLD   (PI-ACCT-KEY)
  8417*    END-EXEC.
  8418     MOVE 0
  8419       TO DFHEIV11
  8420*    MOVE '&0S                   )   #00007533' TO DFHEIV0
  8421     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8422     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8423     MOVE X'2020233030303037353333' TO DFHEIV0(25:11)
  8424     CALL 'kxdfhei1' USING DFHEIV0,
  8425           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 173
* EL650.cbl
  8426           DFHEIV20,
  8427           DFHEIV99,
  8428           PI-ACCT-KEY,
  8429           DFHEIV99,
  8430           DFHEIV11,
  8431           DFHEIV99,
  8432           DFHEIV99
  8433     SET ADDRESS OF ACCOUNT-MASTER TO
  8434         DFHEIV20
  8435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8436
  8437
  8438     IF FIRST-TIME
  8439         MOVE SPACE              TO  FIRST-TIME-SW
  8440         GO TO 5410-READ-PREV.
  8441
  8442     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8443         GO TO 5430-NOT-FOUND.
  8444
  8445     IF PI-CARRIER-SECURITY GREATER SPACES
  8446         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8447             NEXT SENTENCE
  8448         ELSE
  8449             GO TO 5410-READ-PREV.
  8450
  8451     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8452     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8453                                     PI-PREV-VG-ACCOUNT.
  8454     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8455                                     PI-ACCT-REST-OF-EXP
  8456                                     PI-DATE-RANGE-TABLE.
  8457
  8458     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8459
  8460
  8461* EXEC CICS  ENDBR
  8462*        DATASET  (PI-ACCT-ID)
  8463*    END-EXEC.
  8464     MOVE 0
  8465       TO DFHEIV11
  8466*    MOVE '&2                    $   #00007561' TO DFHEIV0
  8467     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8469     MOVE X'2020233030303037353631' TO DFHEIV0(25:11)
  8470     CALL 'kxdfhei1' USING DFHEIV0,
  8471           PI-ACCT-ID,
  8472           DFHEIV11,
  8473           DFHEIV99
  8474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8475
  8476
  8477     GO TO 5305-START-BR.
  8478
  8479 5430-NOT-FOUND.
  8480     IF BROWSE-STARTED
  8481         MOVE SPACE              TO  BROWSE-STARTED-SW
  8482
  8483* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 174
* EL650.cbl
  8484*            DATASET  (PI-ACCT-ID)
  8485*        END-EXEC.
  8486     MOVE 0
  8487       TO DFHEIV11
  8488*    MOVE '&2                    $   #00007570' TO DFHEIV0
  8489     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8490     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8491     MOVE X'2020233030303037353730' TO DFHEIV0(25:11)
  8492     CALL 'kxdfhei1' USING DFHEIV0,
  8493           PI-ACCT-ID,
  8494           DFHEIV11,
  8495           DFHEIV99
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499     MOVE ER-0067                TO  EMI-ERROR.
  8500
  8501     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8502
  8503     MOVE -1                     TO  MAINTL.
  8504
  8505     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8506         GO TO 5300-FIND-NEXT-ACCOUNT.
  8507
  8508     GO TO 8200-SEND-DATAONLY.
  8509
  8510 5440-NOT-FOUND.
  8511     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8512
  8513     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8514
  8515     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 175
* EL650.cbl
  8517 5500-ADD-NEW-AXRF-RECORD.
  8518     IF NOT PI-GA-BILLING
  8519         GO TO 5599-EXIT.
  8520
  8521     MOVE +1                     TO  AXRF-SUB.
  8522
  8523*    IF MAINTI  = 'K'
  8524*        IF GETMAIN-SW  = 'X'
  8525*            GO TO 5510-BUILD-AXRF-KEY.
  8526
  8527     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8528
  8529*    EXEC CICS  GETMAIN
  8530*        LENGTH   (ERGXRF-REC-LEN)
  8531*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8532*        INITIMG  (GETMAIN-SPACE)
  8533*    END-EXEC.
  8534*    display ' beginning of CP displays  '
  8535*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8536*    display ' address         ==   '
  8537*              address of agent-cross-reference
  8538*    display ' contents        ==   '  agent-cross-reference (1:1)
  8539*    display ' end       of CP displays  '
  8540
  8541*    MOVE 'X'                    TO  GETMAIN-SW.
  8542
  8543 5510-BUILD-AXRF-KEY.
  8544     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8545
  8546     IF AXRF-SUB  =  +11
  8547         GO TO 5599-EXIT.
  8548
  8549     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8550         ADD +1 TO AXRF-SUB
  8551         GO TO 5510-BUILD-AXRF-KEY.
  8552
  8553     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P' AND 'S'
  8554         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8555         ADD +1 TO AXRF-SUB
  8556         GO TO 5510-BUILD-AXRF-KEY.
  8557
  8558     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8559
  8560     IF PI-ZERO-CARRIER  OR
  8561        PI-ZERO-CAR-GROUP
  8562         MOVE ZERO               TO  WS-AXRF-CARRIER
  8563     ELSE
  8564         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8565
  8566     IF PI-ZERO-GROUPING  OR
  8567        PI-ZERO-CAR-GROUP
  8568         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8569     ELSE
  8570         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8571
  8572     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8573
  8574
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 176
* EL650.cbl
  8575* EXEC CICS  HANDLE CONDITION
  8576*        ENDFILE  (5525-SKIP-REWRITE)
  8577*        NOTFND   (5525-SKIP-REWRITE)
  8578*    END-EXEC.
  8579*    MOVE '"$''I                  ! 5 #00007649' TO DFHEIV0
  8580     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8581     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8582     MOVE X'3520233030303037363439' TO DFHEIV0(25:11)
  8583     CALL 'kxdfhei1' USING DFHEIV0
  8584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8585
  8586
  8587
  8588* EXEC CICS  READ
  8589*        DATASET  (ERGXRF-FILE-ID)
  8590*        LENGTH   (ERGXRF-REC-LEN)
  8591*        INTO     (AGENT-CROSS-REFERENCE)
  8592*        RIDFLD   (WS-AXRF-KEY)
  8593*        EQUAL
  8594*        UPDATE
  8595*    END-EXEC.
  8596*    MOVE '&"IL       EU         (   #00007654' TO DFHEIV0
  8597     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8598     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8599     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  8600     CALL 'kxdfhei1' USING DFHEIV0,
  8601           ERGXRF-FILE-ID,
  8602           AGENT-CROSS-REFERENCE,
  8603           ERGXRF-REC-LEN,
  8604           WS-AXRF-KEY,
  8605           DFHEIV99,
  8606           DFHEIV99,
  8607           DFHEIV99
  8608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8609
  8610
  8611     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8612     MOVE +1                     TO  GX-AGENT-SUB.
  8613
  8614     IF GX-AGENT-POINTER-CNT = +1006
  8615         GO TO 5525-SKIP-REWRITE.
  8616
  8617
  8618 5520-FIND-REC-LOCATION.
  8619     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8620     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8621                                 TO  GX-REST-OF-KEY.
  8622     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8623
  8624     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8625        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8626         NEXT SENTENCE
  8627     ELSE
  8628         ADD +1 TO GX-AGENT-SUB
  8629         GO TO 5520-FIND-REC-LOCATION.
  8630
  8631     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8632                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 177
* EL650.cbl
  8633
  8634     ADD +1 TO COMM-WORK-SUB2.
  8635
  8636     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8637         NEXT SENTENCE
  8638      ELSE
  8639         PERFORM 5530-BUMP-AXRF-REC
  8640             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8641               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8642
  8643     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8644     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8645
  8646     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8647     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8648     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8649     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8650     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8651                                                (COMM-WORK-SUB2).
  8652     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8653     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8654     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8655     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8656     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8657     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8658     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8659     if ergxrf-rec-len > +31264
  8660        move +31264          to ergxrf-rec-len
  8661        move +1006           to gx-agent-pointer-cnt
  8662     end-if
  8663
  8664
  8665* EXEC CICS  REWRITE
  8666*        FROM     (AGENT-CROSS-REFERENCE)
  8667*        LENGTH   (ERGXRF-REC-LEN)
  8668*        DATASET  (ERGXRF-FILE-ID)
  8669*    END-EXEC.
  8670*    MOVE '&& L                  %   #00007716' TO DFHEIV0
  8671     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8672     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8673     MOVE X'2020233030303037373136' TO DFHEIV0(25:11)
  8674     CALL 'kxdfhei1' USING DFHEIV0,
  8675           ERGXRF-FILE-ID,
  8676           AGENT-CROSS-REFERENCE,
  8677           ERGXRF-REC-LEN,
  8678           DFHEIV99
  8679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8680
  8681
  8682 5525-SKIP-REWRITE.
  8683
  8684     ADD +1 TO AXRF-SUB.
  8685
  8686     GO TO 5510-BUILD-AXRF-KEY.
  8687
  8688 5530-BUMP-AXRF-REC.
  8689     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8690                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 178
* EL650.cbl
  8691
  8692     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8693
  8694 5599-EXIT.
  8695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 179
* EL650.cbl
  8697 5600-CHG-AXRF-RECORDS.
  8698     IF NOT PI-GA-BILLING
  8699         GO TO 5699-EXIT.
  8700
  8701     MOVE +1                     TO  AXRF-SUB.
  8702     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8703
  8704*    IF GETMAIN-SW  = 'X'
  8705*        GO TO 5610-BUILD-AXRF-KEY.
  8706
  8707*    EXEC CICS  GETMAIN
  8708*        LENGTH   (ERGXRF-REC-LEN)
  8709*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8710*        INITIMG  (GETMAIN-SPACE)
  8711*    END-EXEC.
  8712*
  8713*    display ' beginning of CP displays  '
  8714*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8715*    display ' address         ==   '
  8716*              address of agent-cross-reference
  8717*    display ' contents        ==   '  agent-cross-reference (1:1)
  8718*    display ' end       of CP displays  '
  8719
  8720*    MOVE 'X'                    TO  GETMAIN-SW.
  8721
  8722 5610-BUILD-AXRF-KEY.
  8723     IF AXRF-SUB  = +11
  8724         GO TO 5699-EXIT.
  8725
  8726     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8727         ADD +1 TO AXRF-SUB
  8728         GO TO 5610-BUILD-AXRF-KEY.
  8729
  8730     IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'S'
  8731         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8732         ADD +1 TO AXRF-SUB
  8733         GO TO 5610-BUILD-AXRF-KEY.
  8734
  8735     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8736     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8737
  8738     IF PI-ZERO-CARRIER OR
  8739        PI-ZERO-CAR-GROUP
  8740         MOVE ZERO               TO  WS-AXRF-CARRIER
  8741     ELSE
  8742         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8743
  8744     IF PI-ZERO-GROUPING  OR
  8745        PI-ZERO-CAR-GROUP
  8746         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8747     ELSE
  8748         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8749
  8750     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8751
  8752
  8753* EXEC CICS  HANDLE CONDITION
  8754*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 180
* EL650.cbl
  8755*        NOTFND   (5615-SKIP-REWRITE)
  8756*    END-EXEC.
  8757*    MOVE '"$''I                  ! 6 #00007792' TO DFHEIV0
  8758     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8760     MOVE X'3620233030303037373932' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0
  8762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8763
  8764
  8765
  8766* EXEC CICS  READ
  8767*        DATASET  (ERGXRF-FILE-ID)
  8768*        LENGTH   (ERGXRF-REC-LEN)
  8769*        INTO     (AGENT-CROSS-REFERENCE)
  8770*        RIDFLD   (WS-AXRF-KEY)
  8771*        EQUAL
  8772*        UPDATE
  8773*    END-EXEC.
  8774*    MOVE '&"IL       EU         (   #00007797' TO DFHEIV0
  8775     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8776     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8777     MOVE X'2020233030303037373937' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0,
  8779           ERGXRF-FILE-ID,
  8780           AGENT-CROSS-REFERENCE,
  8781           ERGXRF-REC-LEN,
  8782           WS-AXRF-KEY,
  8783           DFHEIV99,
  8784           DFHEIV99,
  8785           DFHEIV99
  8786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8787
  8788
  8789     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8790
  8791     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8792             UNTIL
  8793       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8794            OR
  8795       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8796        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8797        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8798        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8799        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8800        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8801     END-PERFORM.
  8802
  8803     IF MAINTI  = 'D'
  8804        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8805            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8806            PERFORM 5630-BUMP-RECORDS
  8807                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8808                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8809            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8810            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8811            GO TO 5615-REWRITE-AXRF-RECORD.
  8812
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 181
* EL650.cbl
  8813     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8814        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8815        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8816        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8817        GO TO 5615-REWRITE-AXRF-RECORD.
  8818
  8819
  8820* EXEC CICS  UNLOCK
  8821*        DATASET  (ERGXRF-FILE-ID)
  8822*    END-EXEC.
  8823*    MOVE '&*                    #   #00007836' TO DFHEIV0
  8824     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8825     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8826     MOVE X'2020233030303037383336' TO DFHEIV0(25:11)
  8827     CALL 'kxdfhei1' USING DFHEIV0,
  8828           ERGXRF-FILE-ID,
  8829           DFHEIV99
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8831
  8832
  8833     GO TO 5615-SKIP-REWRITE.
  8834
  8835 5615-REWRITE-AXRF-RECORD.
  8836     IF MAINTI  = 'D'
  8837       AND  GX-AGENT-POINTER-CNT  =  +0
  8838
  8839* EXEC CICS  DELETE
  8840*            DATASET  (ERGXRF-FILE-ID)
  8841*        END-EXEC
  8842*    MOVE '&(                    &   #00007845' TO DFHEIV0
  8843     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8845     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8846     CALL 'kxdfhei1' USING DFHEIV0,
  8847           ERGXRF-FILE-ID,
  8848           DFHEIV99,
  8849           DFHEIV99,
  8850           DFHEIV99,
  8851           DFHEIV99
  8852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8853     ELSE
  8854         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8855         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8856         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8857         compute ergxrf-rec-len =
  8858              (gx-agent-pointer-cnt * +31) + +78
  8859         if ergxrf-rec-len > +31264
  8860            move +31264          to ergxrf-rec-len
  8861            move +1006           to gx-agent-pointer-cnt
  8862         end-if
  8863
  8864* EXEC CICS  REWRITE
  8865*            FROM     (AGENT-CROSS-REFERENCE)
  8866*            LENGTH   (ERGXRF-REC-LEN)
  8867*            DATASET  (ERGXRF-FILE-ID)
  8868*        END-EXEC.
  8869*    MOVE '&& L                  %   #00007858' TO DFHEIV0
  8870     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 182
* EL650.cbl
  8871     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8872     MOVE X'2020233030303037383538' TO DFHEIV0(25:11)
  8873     CALL 'kxdfhei1' USING DFHEIV0,
  8874           ERGXRF-FILE-ID,
  8875           AGENT-CROSS-REFERENCE,
  8876           ERGXRF-REC-LEN,
  8877           DFHEIV99
  8878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8879
  8880
  8881 5615-SKIP-REWRITE.
  8882     ADD +1  TO  AXRF-SUB.
  8883
  8884     GO TO 5610-BUILD-AXRF-KEY.
  8885
  8886 5630-BUMP-RECORDS.
  8887     ADD +1  TO  COMM-WORK-SUB.
  8888
  8889     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8890                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8891
  8892 5699-EXIT.
  8893     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 183
* EL650.cbl
  8895 6000-EDIT-EFFECTIVE-DATE.
  8896     IF EFFCHGL  NOT =  ZEROS
  8897         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8898         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8899         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8900         MOVE '4'                      TO  DC-OPTION-CODE
  8901         PERFORM 9700-DATE-CONVERSION
  8902         IF DATE-CONVERSION-ERROR
  8903             MOVE ER-0348              TO  EMI-ERROR
  8904             MOVE -1                   TO  EFFCHGL
  8905             MOVE AL-UABON             TO  EFFCHGA
  8906             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8907         ELSE
  8908             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8909             MOVE AL-UANON             TO  EFFCHGA
  8910***  Y2K PROJ 7744
  8911             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8912             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8913             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8914             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8915         END-IF
  8916***  Y2K PROJ 7744
  8917     ELSE
  8918         IF MAINTI  NOT = 'N'
  8919             MOVE ER-0216              TO  EMI-ERROR
  8920             MOVE -1                   TO  EFFCHGL
  8921             MOVE AL-UABON             TO  EFFCHGA
  8922             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8923
  8924 6000-EFF-EXIT.
  8925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 184
* EL650.cbl
  8927 6000-EDIT-EXPIRATION-DATE.
  8928***  Y2K PROJ 7744
  8929     IF EXPCHGL  NOT = ZEROS
  8930         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8931         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8932         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8933             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8934             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8935             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8936             MOVE 99999999999              TO  EXPCHG-SAVE
  8937         ELSE
  8938             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8939             MOVE '4'                      TO  DC-OPTION-CODE
  8940             PERFORM 9700-DATE-CONVERSION
  8941             IF DATE-CONVERSION-ERROR
  8942                 MOVE ER-0454              TO  EMI-ERROR
  8943                 MOVE -1                   TO  EXPCHGL
  8944                 MOVE AL-UABON             TO  EXPCHGA
  8945                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8946             ELSE
  8947                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8948                 MOVE AL-UANON             TO  EXPCHGA
  8949                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8950                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8951                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8952                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8953             END-IF
  8954         END-IF
  8955     ELSE
  8956         IF MAINTI  NOT =  'N'
  8957             MOVE ER-2058                  TO  EMI-ERROR
  8958             MOVE -1                       TO  EXPCHGL
  8959             MOVE AL-UABON                 TO  EXPCHGA
  8960             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8961         ELSE
  8962             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8963             MOVE 99999999999              TO  EXPCHG-SAVE
  8964         END-IF
  8965     END-IF.
  8966***  Y2K PROJ 7744
  8967
  8968 6000-EXP-EXIT.
  8969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 185
* EL650.cbl
  8971 6000-EDIT-LINE.
  8972     IF LINEL  = ZEROS
  8973         GO TO 6000-NO-LINE.
  8974
  8975     MOVE AL-UNNON               TO  LINEA.
  8976
  8977     IF LINEI NOT NUMERIC
  8978         GO TO 6000-LINE-ERROR.
  8979
  8980     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8981         GO TO 6000-LINE-ERROR.
  8982
  8983     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8984
  8985     IF PI-2ND-PAGE
  8986         SUBTRACT 8 FROM WS-PAGE-LINES
  8987     ELSE
  8988     IF PI-3RD-PAGE
  8989         SUBTRACT 16 FROM WS-PAGE-LINES
  8990     ELSE
  8991     IF PI-LST-PAGE
  8992         SUBTRACT 24 FROM WS-PAGE-LINES.
  8993
  8994     IF LINEI GREATER WS-PAGE-LINES
  8995         GO TO 6000-LINE-ERROR.
  8996
  8997     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8998
  8999     GO TO 6000-LIN-EXIT.
  9000
  9001 6000-NO-LINE.
  9002     IF PI-TOTAL-LINES  = 1
  9003         MOVE 1                  TO  PI-LINE-SELECTED
  9004                                     LINEI
  9005         MOVE AL-UNNON           TO  LINEA
  9006         GO TO 6000-LIN-EXIT.
  9007
  9008 6000-LINE-ERROR.
  9009     MOVE ER-2064                TO  EMI-ERROR.
  9010     MOVE -1                     TO  LINEL.
  9011     MOVE AL-UABON               TO  LINEA.
  9012
  9013     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9014
  9015 6000-LIN-EXIT.
  9016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 186
* EL650.cbl
  9018 600A-CHECK-HI-LO-DATES.
  9019
  9020     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9021         GO TO 600A-CHECK-AR-DATES.
  9022
  9023     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  9024     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9025         MOVE ER-2113            TO  EMI-ERROR
  9026         MOVE -1                 TO  MAINTL
  9027         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9028
  9029*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9030*        MOVE ER-2113            TO  EMI-ERROR
  9031*        MOVE -1                 TO  MAINTL
  9032*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9033
  9034 600A-CHECK-AR-DATES.
  9035     IF NOT PI-AR-PROCESSING
  9036         GO TO 600A-EXIT.
  9037
  9038     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  9039        GO TO 600A-EXIT.
  9040
  9041     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9042         MOVE ER-2113            TO  EMI-ERROR
  9043         MOVE -1                 TO  MAINTL
  9044         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9045
  9046 600A-EXIT.
  9047     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 187
* EL650.cbl
  9049 6010-DATE-CHECK.
  9050     IF MAINTI  = 'E'
  9051         GO TO 6010-CHECK-EFF.
  9052
  9053     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  9054         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  9055             MOVE ER-2072        TO  EMI-ERROR
  9056             MOVE -1             TO  EXPCHGL
  9057             MOVE AL-UABON       TO  EXPCHGA
  9058             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9059
  9060     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  9061         MOVE ER-2074            TO  EMI-ERROR
  9062         MOVE -1                 TO  EXPCHGL
  9063         MOVE AL-UABON           TO  EXPCHGA
  9064         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9065
  9066     GO TO 6010-EXIT.
  9067
  9068 6010-CHECK-EFF.
  9069     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  9070        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  9071           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  9072           MOVE ER-2073          TO EMI-ERROR
  9073           MOVE -1               TO EFFCHGL
  9074           MOVE AL-UABON         TO EFFCHGA
  9075           PERFORM 9900-ERROR-FORMAT
  9076                                 THRU 9900-EXIT
  9077        END-IF
  9078     END-IF
  9079
  9080     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  9081         MOVE ER-2075            TO  EMI-ERROR
  9082         MOVE -1                 TO  EFFCHGL
  9083         MOVE AL-UABON           TO  EFFCHGA
  9084         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9085
  9086 6010-EXIT.
  9087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 188
* EL650.cbl
  9089 6100-BUILD-KEY.
  9090     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  9091     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  9092
  9093     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9094         IF MAINTI  = 'S'
  9095           OR  FIRST-TIME
  9096             MOVE SPACES         TO  PI-ACCT-CARRIER
  9097         ELSE
  9098             MOVE -1             TO  ACARIERL
  9099             MOVE ER-2059        TO  EMI-ERROR
  9100             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9101     ELSE
  9102         MOVE AL-UANON           TO  ACARIERA
  9103         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9104
  9105     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9106         IF MAINTI  = 'S'
  9107           OR  FIRST-TIME
  9108             MOVE SPACES         TO  PI-ACCT-GROUPING
  9109         ELSE
  9110             MOVE -1             TO  AGROUPL
  9111             MOVE ER-2059        TO  EMI-ERROR
  9112             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9113     ELSE
  9114         IF AGROUPI  =  '0     '
  9115             MOVE -1             TO  AGROUPL
  9116             MOVE ER-0195        TO  EMI-ERROR
  9117             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9118         ELSE
  9119             MOVE AL-UANON       TO  AGROUPA
  9120             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9121
  9122     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9123         IF MAINTI  =  'S'
  9124           OR  FIRST-TIME
  9125             MOVE SPACES         TO  PI-ACCT-STATE
  9126         ELSE
  9127             MOVE -1             TO  ASTATEL
  9128             MOVE ER-2059        TO  EMI-ERROR
  9129             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9130     ELSE
  9131         MOVE AL-UANON           TO  ASTATEA
  9132         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9133
  9134     IF AACCTI  = SPACES  OR  LOW-VALUES
  9135        IF MAINTI  = 'S'
  9136          OR  FIRST-TIME
  9137            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9138        ELSE
  9139            MOVE -1              TO  AACCTL
  9140            MOVE ER-2059         TO  EMI-ERROR
  9141            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9142     ELSE
  9143         MOVE AL-UANON           TO  AACCTA
  9144         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9145
  9146     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 189
* EL650.cbl
  9147       AND  (CARR-ACCNT-CNTL
  9148       OR   CARR-ST-ACCNT-CNTL
  9149       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9150         MOVE ER-0193            TO  EMI-ERROR
  9151         MOVE -1                 TO  ACARIERL
  9152         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9153
  9154     IF PI-ACCT-GROUPING  =  SPACES
  9155       AND  CARR-GROUP-ST-ACCNT-CNTL
  9156         MOVE ER-0195            TO  EMI-ERROR
  9157         MOVE -1                 TO  AGROUPL
  9158         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9159
  9160     IF PI-ACCT-STATE  = SPACES
  9161       AND  (ST-ACCNT-CNTL
  9162       OR   CARR-ST-ACCNT-CNTL
  9163       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9164         MOVE ER-0144            TO  EMI-ERROR
  9165         MOVE -1                 TO  ASTATEL
  9166         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9167
  9168     IF MAINTI  =  'S'
  9169       OR  FIRST-TIME
  9170         NEXT SENTENCE
  9171     ELSE
  9172         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9173
  9174     IF NOT EMI-NO-ERRORS
  9175         IF EIBTRNID = EL6311-TRANS-ID OR VP6311-TRANS-ID
  9176             GO TO 8100-SEND-INITIAL-MAP
  9177           ELSE
  9178             GO TO 8200-SEND-DATAONLY.
  9179
  9180     IF PI-ACCT-CARRIER   = SPACES  OR
  9181        PI-ACCT-STATE     = SPACES  OR
  9182        PI-ACCT-GROUPING  = SPACES
  9183         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9184     ELSE
  9185         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9186
  9187     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9188                                     PI-ACCT-REST-OF-EXP.
  9189
  9190 6199-EXIT.
  9191     EXIT.
  9192
  9193 6200-CHECK-KEY.
  9194     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9195         MOVE ER-0453            TO  EMI-ERROR
  9196         MOVE -1                 TO  MAINTL
  9197         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9198
  9199 6200-EXIT.
  9200     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 190
* EL650.cbl
  9202 6300-STARTBR.
  9203     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9204
  9205
  9206* EXEC CICS  STARTBR
  9207*        DATASET  (PI-ACCT-ID)
  9208*        RIDFLD   (PI-ACCT-KEY)
  9209*    END-EXEC.
  9210     MOVE 0
  9211       TO DFHEIV11
  9212*    MOVE '&,         G          &   #00008188' TO DFHEIV0
  9213     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9215     MOVE X'2020233030303038313838' TO DFHEIV0(25:11)
  9216     CALL 'kxdfhei1' USING DFHEIV0,
  9217           PI-ACCT-ID,
  9218           PI-ACCT-KEY,
  9219           DFHEIV99,
  9220           DFHEIV11,
  9221           DFHEIV99
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9223
  9224
  9225     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9226     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9227
  9228 6300-EXIT.
  9229     EXIT.
  9230
  9231 6310-READNEXT.
  9232
  9233* EXEC CICS  READNEXT
  9234*        DATASET  (PI-ACCT-ID)
  9235*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9236*        RIDFLD   (PI-ACCT-KEY)
  9237*    END-EXEC.
  9238     MOVE 0
  9239       TO DFHEIV11
  9240*    MOVE '&.S                   )   #00008200' TO DFHEIV0
  9241     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9243     MOVE X'2020233030303038323030' TO DFHEIV0(25:11)
  9244     CALL 'kxdfhei1' USING DFHEIV0,
  9245           PI-ACCT-ID,
  9246           DFHEIV20,
  9247           DFHEIV99,
  9248           PI-ACCT-KEY,
  9249           DFHEIV99,
  9250           DFHEIV11,
  9251           DFHEIV99,
  9252           DFHEIV99
  9253     SET ADDRESS OF ACCOUNT-MASTER TO
  9254         DFHEIV20
  9255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9256
  9257
  9258 6310-EXIT.
  9259     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 191
* EL650.cbl
  9260
  9261 6320-ENDBR.
  9262     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9263
  9264
  9265* EXEC CICS  ENDBR
  9266*        DATASET  (PI-ACCT-ID)
  9267*    END-EXEC.
  9268     MOVE 0
  9269       TO DFHEIV11
  9270*    MOVE '&2                    $   #00008212' TO DFHEIV0
  9271     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9273     MOVE X'2020233030303038323132' TO DFHEIV0(25:11)
  9274     CALL 'kxdfhei1' USING DFHEIV0,
  9275           PI-ACCT-ID,
  9276           DFHEIV11,
  9277           DFHEIV99
  9278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9279
  9280
  9281 6320-EXIT.
  9282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 192
* EL650.cbl
  9284 6400-BUILD-VG-KEY.
  9285     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9286
  9287     IF ST-ACCNT-CNTL
  9288         MOVE SPACES             TO  AM-VG-CARRIER
  9289                                     AM-VG-GROUPING.
  9290
  9291     IF CARR-ST-ACCNT-CNTL
  9292         MOVE SPACES             TO  AM-VG-GROUPING.
  9293
  9294     IF ACCNT-CNTL
  9295         MOVE SPACES             TO  AM-VG-CARRIER
  9296                                     AM-VG-STATE
  9297                                     AM-VG-GROUPING.
  9298
  9299     IF CARR-ACCNT-CNTL
  9300         MOVE SPACES             TO  AM-VG-STATE
  9301                                     AM-VG-GROUPING.
  9302
  9303 6499-EXIT.
  9304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 193
* EL650.cbl
  9306 6500-READ-ACCT.
  9307
  9308* EXEC CICS  HANDLE CONDITION
  9309*        NOTFND  (6599-EXIT)
  9310*    END-EXEC.
  9311*    MOVE '"$I                   ! 7 #00008242' TO DFHEIV0
  9312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9314     MOVE X'3720233030303038323432' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9317
  9318
  9319     MOVE ZERO                   TO  REC-SW.
  9320
  9321
  9322* EXEC CICS  READ
  9323*        GTEQ
  9324*        DATASET  (ACCT-FILE-ID)
  9325*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9326*        RIDFLD   (PI-ACCT-KEY)
  9327*    END-EXEC.
  9328*    MOVE '&"S        G          (   #00008248' TO DFHEIV0
  9329     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9331     MOVE X'2020233030303038323438' TO DFHEIV0(25:11)
  9332     CALL 'kxdfhei1' USING DFHEIV0,
  9333           ACCT-FILE-ID,
  9334           DFHEIV20,
  9335           DFHEIV99,
  9336           PI-ACCT-KEY,
  9337           DFHEIV99,
  9338           DFHEIV99,
  9339           DFHEIV99
  9340     SET ADDRESS OF ACCOUNT-MASTER TO
  9341         DFHEIV20
  9342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9343
  9344
  9345     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9346     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9347
  9348     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9349         MOVE 1                  TO  REC-SW.
  9350
  9351 6599-EXIT.
  9352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 194
* EL650.cbl
  9354 6600-UPDATE-MAINT-DT.
  9355     MOVE SPACES                 TO  ELCNTL-KEY.
  9356     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9357     MOVE '1'                    TO  CNTL-REC-TYPE.
  9358     MOVE +0                     TO  CNTL-SEQ-NO.
  9359
  9360
  9361* EXEC CICS  HANDLE CONDITION
  9362*        NOTFND  (6699-EXIT)
  9363*    END-EXEC.
  9364*    MOVE '"$I                   ! 8 #00008270' TO DFHEIV0
  9365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9367     MOVE X'3820233030303038323730' TO DFHEIV0(25:11)
  9368     CALL 'kxdfhei1' USING DFHEIV0
  9369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9370
  9371
  9372
  9373* EXEC CICS  READ
  9374*        UPDATE
  9375*        DATASET  (CNTL-FILE-ID)
  9376*        SET      (ADDRESS OF CONTROL-FILE)
  9377*        RIDFLD   (ELCNTL-KEY)
  9378*    END-EXEC.
  9379*    MOVE '&"S        EU         (   #00008274' TO DFHEIV0
  9380     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9381     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9382     MOVE X'2020233030303038323734' TO DFHEIV0(25:11)
  9383     CALL 'kxdfhei1' USING DFHEIV0,
  9384           CNTL-FILE-ID,
  9385           DFHEIV20,
  9386           DFHEIV99,
  9387           ELCNTL-KEY,
  9388           DFHEIV99,
  9389           DFHEIV99,
  9390           DFHEIV99
  9391     SET ADDRESS OF CONTROL-FILE TO
  9392         DFHEIV20
  9393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9394
  9395
  9396     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9397     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9398     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9399
  9400     PERFORM 8400-LOG-JOURNAL-RECORD.
  9401
  9402     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9403     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9404     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9405     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9406
  9407
  9408* EXEC CICS  REWRITE
  9409*        DATASET  (CNTL-FILE-ID)
  9410*        FROM     (CONTROL-FILE)
  9411*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 195
* EL650.cbl
  9412     MOVE LENGTH OF
  9413      CONTROL-FILE
  9414       TO DFHEIV11
  9415*    MOVE '&& L                  %   #00008292' TO DFHEIV0
  9416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9418     MOVE X'2020233030303038323932' TO DFHEIV0(25:11)
  9419     CALL 'kxdfhei1' USING DFHEIV0,
  9420           CNTL-FILE-ID,
  9421           CONTROL-FILE,
  9422           DFHEIV11,
  9423           DFHEIV99
  9424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9425
  9426
  9427     PERFORM 8400-LOG-JOURNAL-RECORD.
  9428
  9429 6699-EXIT.
  9430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 196
* EL650.cbl
  9432 6700-VERIFY-STATE-CARRIER.
  9433     IF PI-ACCT-CARRIER  = SPACES
  9434         GO TO 6750-CHECK-STATE.
  9435
  9436     MOVE SPACES                 TO  ELCNTL-KEY.
  9437     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9438     MOVE '6'                    TO  CNTL-REC-TYPE.
  9439     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9440     MOVE +0                     TO  CNTL-SEQ-NO.
  9441
  9442
  9443* EXEC CICS  HANDLE CONDITION
  9444*        NOTFND  (6720-NO-CARRIER)
  9445*    END-EXEC.
  9446*    MOVE '"$I                   ! 9 #00008312' TO DFHEIV0
  9447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9449     MOVE X'3920233030303038333132' TO DFHEIV0(25:11)
  9450     CALL 'kxdfhei1' USING DFHEIV0
  9451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9452
  9453
  9454
  9455* EXEC CICS  READ
  9456*        DATASET  (CNTL-FILE-ID)
  9457*        SET      (ADDRESS OF CONTROL-FILE)
  9458*        RIDFLD   (ELCNTL-KEY)
  9459*    END-EXEC.
  9460*    MOVE '&"S        E          (   #00008316' TO DFHEIV0
  9461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9463     MOVE X'2020233030303038333136' TO DFHEIV0(25:11)
  9464     CALL 'kxdfhei1' USING DFHEIV0,
  9465           CNTL-FILE-ID,
  9466           DFHEIV20,
  9467           DFHEIV99,
  9468           ELCNTL-KEY,
  9469           DFHEIV99,
  9470           DFHEIV99,
  9471           DFHEIV99
  9472     SET ADDRESS OF CONTROL-FILE TO
  9473         DFHEIV20
  9474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9475
  9476
  9477     GO TO 6750-CHECK-STATE.
  9478
  9479 6720-NO-CARRIER.
  9480     MOVE ER-0193                TO  EMI-ERROR.
  9481     MOVE -1                     TO  ACARIERL.
  9482     MOVE AL-UABON               TO  ACARIERA.
  9483
  9484     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9485
  9486 6750-CHECK-STATE.
  9487     IF PI-ACCT-STATE  =  SPACES
  9488         GO TO 6799-EXIT.
  9489
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 197
* EL650.cbl
  9490     MOVE SPACES                 TO  ELCNTL-KEY.
  9491     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9492     MOVE '3'                    TO  CNTL-REC-TYPE.
  9493     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9494     MOVE +0                     TO  CNTL-SEQ-NO.
  9495
  9496
  9497* EXEC CICS  HANDLE CONDITION
  9498*        NOTFND  (6780-NO-STATE)
  9499*    END-EXEC.
  9500*    MOVE '"$I                   ! : #00008341' TO DFHEIV0
  9501     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9503     MOVE X'3A20233030303038333431' TO DFHEIV0(25:11)
  9504     CALL 'kxdfhei1' USING DFHEIV0
  9505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9506
  9507
  9508
  9509* EXEC CICS  READ
  9510*        DATASET  (CNTL-FILE-ID)
  9511*        SET      (ADDRESS OF CONTROL-FILE)
  9512*        RIDFLD   (ELCNTL-KEY)
  9513*    END-EXEC.
  9514*    MOVE '&"S        E          (   #00008345' TO DFHEIV0
  9515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9517     MOVE X'2020233030303038333435' TO DFHEIV0(25:11)
  9518     CALL 'kxdfhei1' USING DFHEIV0,
  9519           CNTL-FILE-ID,
  9520           DFHEIV20,
  9521           DFHEIV99,
  9522           ELCNTL-KEY,
  9523           DFHEIV99,
  9524           DFHEIV99,
  9525           DFHEIV99
  9526     SET ADDRESS OF CONTROL-FILE TO
  9527         DFHEIV20
  9528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9529
  9530
  9531     GO TO 6799-EXIT.
  9532
  9533 6780-NO-STATE.
  9534     MOVE ER-0144                TO  EMI-ERROR.
  9535     MOVE -1                     TO  ASTATEL.
  9536     MOVE AL-UABON               TO  ASTATEA.
  9537
  9538     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9539
  9540 6799-EXIT.
  9541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 198
* EL650.cbl
  9543 6800-COMPANY-REC-READ.
  9544     MOVE SPACES                 TO  ELCNTL-KEY.
  9545     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9546     MOVE '1'                    TO  CNTL-REC-TYPE.
  9547     MOVE +0                     TO  CNTL-SEQ-NO.
  9548
  9549
  9550* EXEC CICS  HANDLE CONDITION
  9551*        NOTFND  (6880-NO-COMP)
  9552*    END-EXEC.
  9553*    MOVE '"$I                   ! ; #00008369' TO DFHEIV0
  9554     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9556     MOVE X'3B20233030303038333639' TO DFHEIV0(25:11)
  9557     CALL 'kxdfhei1' USING DFHEIV0
  9558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9559
  9560
  9561
  9562* EXEC CICS  READ
  9563*        DATASET  (CNTL-FILE-ID)
  9564*        SET      (ADDRESS OF CONTROL-FILE)
  9565*        RIDFLD   (ELCNTL-KEY)
  9566*    END-EXEC.
  9567*    MOVE '&"S        E          (   #00008373' TO DFHEIV0
  9568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9570     MOVE X'2020233030303038333733' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0,
  9572           CNTL-FILE-ID,
  9573           DFHEIV20,
  9574           DFHEIV99,
  9575           ELCNTL-KEY,
  9576           DFHEIV99,
  9577           DFHEIV99,
  9578           DFHEIV99
  9579     SET ADDRESS OF CONTROL-FILE TO
  9580         DFHEIV20
  9581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9582
  9583
  9584     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9585         MOVE ER-2572            TO  EMI-ERROR
  9586         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9587
  9588     GO TO 6899-EXIT.
  9589
  9590 6880-NO-COMP.
  9591     MOVE ER-0022                TO  EMI-ERROR.
  9592
  9593     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9594
  9595 6899-EXIT.
  9596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 199
* EL650.cbl
  9598 7000-BUILD-OUTPUT-MAP.
  9599     IF RETURNING-FROM-6501
  9600         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9601
  9602     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9603         MOVE AL-SANOF           TO  TRNMSG1A
  9604                                     TRNMSG2A
  9605                                     TRNMSG3A
  9606                                     TRNMSG4A.
  9607
  9608     MOVE AL-UANON               TO  ACARIERA
  9609                                     AGROUPA
  9610                                     ASTATEA
  9611                                     AACCTA.
  9612     MOVE SV-CARRIER             TO  ACARIERO.
  9613     MOVE SV-GROUPING            TO  AGROUPO.
  9614     MOVE SV-STATE               TO  ASTATEO.
  9615     MOVE SV-ACCOUNT             TO  AACCTO.
  9616
  9617     SET M-INDEX  TO  1.
  9618
  9619     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9620
  9621     IF PI-MAINT  = 'A'
  9622       AND  PI-RECORD-NOT-CREATED
  9623         MOVE ER-2151            TO  EMI-ERROR
  9624         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9625         GO TO 7000-END.
  9626
  9627     IF PI-FST-PAGE
  9628         SET T-INDEX   TO  1
  9629     ELSE
  9630     IF PI-2ND-PAGE
  9631         SET T-INDEX   TO  9
  9632     ELSE
  9633     IF PI-3RD-PAGE
  9634         SET T-INDEX   TO  17
  9635     ELSE
  9636         SET T-INDEX   TO  25.
  9637
  9638 7000-LOOP.
  9639     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9640         MOVE PI-BIN-EXP-DT (T-INDEX)
  9641                                 TO  DC-BIN-DATE-1
  9642         MOVE SPACE              TO  DC-OPTION-CODE
  9643         PERFORM 9700-DATE-CONVERSION
  9644         IF DATE-CONVERSION-ERROR
  9645             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9646         ELSE
  9647             MOVE DC-GREG-DATE-1-EDIT
  9648                                 TO  MAP-EXP-DT (M-INDEX)
  9649     ELSE
  9650         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9651         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9652
  9653     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9654     MOVE SPACE                    TO  DC-OPTION-CODE.
  9655
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 200
* EL650.cbl
  9656     PERFORM 9700-DATE-CONVERSION.
  9657
  9658     IF DATE-CONVERSION-ERROR
  9659         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9660     ELSE
  9661         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9662
  9663     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9664         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9665     ELSE
  9666         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9667                                 TO  DC-BIN-DATE-1
  9668         MOVE SPACE              TO  DC-OPTION-CODE
  9669         PERFORM 9700-DATE-CONVERSION
  9670         IF DATE-CONVERSION-ERROR
  9671             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9672         ELSE
  9673             MOVE DC-GREG-DATE-1-EDIT
  9674                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9675
  9676     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9677         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9678     ELSE
  9679         MOVE PI-BIN-HI-CERT (T-INDEX)
  9680                                 TO  DC-BIN-DATE-1
  9681         MOVE SPACE              TO  DC-OPTION-CODE
  9682         PERFORM 9700-DATE-CONVERSION
  9683         IF DATE-CONVERSION-ERROR
  9684             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9685         ELSE
  9686             MOVE DC-GREG-DATE-1-EDIT
  9687                                 TO  MAP-HIGH-CERT (M-INDEX).
  9688
  9689     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9690         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9691     ELSE
  9692         MOVE PI-BIN-LO-CERT (T-INDEX)
  9693                                 TO  DC-BIN-DATE-1
  9694         MOVE SPACE              TO  DC-OPTION-CODE
  9695         PERFORM 9700-DATE-CONVERSION
  9696         IF DATE-CONVERSION-ERROR
  9697             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9698         ELSE
  9699             MOVE DC-GREG-DATE-1-EDIT
  9700                                 TO  MAP-LOW-CERT (M-INDEX).
  9701
  9702     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9703         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9704     ELSE
  9705         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9706                                 TO  DC-BIN-DATE-1
  9707         MOVE SPACE              TO  DC-OPTION-CODE
  9708         PERFORM 9700-DATE-CONVERSION
  9709         IF DATE-CONVERSION-ERROR
  9710             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9711         ELSE
  9712             MOVE DC-GREG-DATE-1-EDIT
  9713                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 201
* EL650.cbl
  9714
  9715     IF M-INDEX  =  8  OR
  9716        T-INDEX  =  PI-TOTAL-LINES
  9717         NEXT SENTENCE
  9718     ELSE
  9719         SET M-INDEX
  9720             T-INDEX  UP  BY  1
  9721         GO TO 7000-LOOP.
  9722
  9723     IF M-INDEX  =  8
  9724       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9725         MOVE ER-0668            TO  EMI-ERROR
  9726         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9727
  9728     IF T-INDEX  =  PI-TOTAL-LINES
  9729         MOVE ER-0630            TO  EMI-ERROR
  9730         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9731
  9732 7000-END.
  9733     MOVE -1                     TO  MAINTL.
  9734     MOVE MAINTI                 TO  PI-MAINT.
  9735
  9736     IF MAINTI  = 'S'  OR  'D'
  9737       OR  RETURNING-FROM-6501
  9738         MOVE LOW-VALUES         TO  MAINTI
  9739         MOVE PI-ACCNAME         TO  NAMEO
  9740         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9741         GO TO 8100-SEND-INITIAL-MAP.
  9742
  9743     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9744                   DFHPF3  OR  DFHPF4
  9745         MOVE 'S'                TO  PI-MAINT
  9746         MOVE PI-ACCNAME         TO  NAMEO
  9747         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9748         GO TO 8100-SEND-INITIAL-MAP.
  9749
  9750     IF MAINTI  = 'N' OR 'E' OR 'X'
  9751        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9752                                        BIN-EFFCHG-SAVE
  9753        MOVE SPACES                 TO  EFFCHGI
  9754                                        EXPCHGI
  9755        MOVE AL-UANOF               TO  EFFCHGA
  9756                                        EXPCHGA
  9757        MOVE SPACES                 TO  PI-MAINT
  9758        MOVE SPACES                 TO  MAINTI
  9759                                        MAINTO
  9760        MOVE AL-UANOF               TO  MAINTA.
  9761
  9762     IF K-WITH-LINE-NO
  9763         MOVE ZERO         TO K-WITH-LINE-USED
  9764         GO TO 8100-SEND-INITIAL-MAP.
  9765
  9766     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 202
* EL650.cbl
  9768 7100-START-BROWSE.
  9769
  9770* EXEC CICS  STARTBR
  9771*        DATASET  (PI-ACCT-ID)
  9772*        RIDFLD   (PI-ACCT-KEY)
  9773*    END-EXEC.
  9774     MOVE 0
  9775       TO DFHEIV11
  9776*    MOVE '&,         G          &   #00008564' TO DFHEIV0
  9777     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9778     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9779     MOVE X'2020233030303038353634' TO DFHEIV0(25:11)
  9780     CALL 'kxdfhei1' USING DFHEIV0,
  9781           PI-ACCT-ID,
  9782           PI-ACCT-KEY,
  9783           DFHEIV99,
  9784           DFHEIV11,
  9785           DFHEIV99
  9786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9787
  9788
  9789 7100-EXIT.
  9790     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 203
* EL650.cbl
  9792 7200-WRITE-TEMP-STORAGE.
  9793     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9794
  9795
  9796* EXEC CICS  HANDLE CONDITION
  9797*        ITEMERR  (7200-EXIT)
  9798*        QIDERR   (7200-EXIT)
  9799*    END-EXEC.
  9800*    MOVE '"$<N                  ! < #00008575' TO DFHEIV0
  9801     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9803     MOVE X'3C20233030303038353735' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0
  9805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9806
  9807
  9808     MOVE +0                     TO  TS-ITEM.
  9809
  9810
  9811* EXEC CICS  WRITEQ TS
  9812*        QUEUE   (TS-QUEUE)
  9813*        FROM    (TEMP-STORAGE-RECORD)
  9814*        LENGTH  (TS-LENGTH)
  9815*        ITEM    (TS-ITEM)
  9816*    END-EXEC.
  9817*    MOVE '*" I                  ''   #00008582' TO DFHEIV0
  9818     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9819     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9820     MOVE X'2020233030303038353832' TO DFHEIV0(25:11)
  9821     CALL 'kxdfhei1' USING DFHEIV0,
  9822           TS-QUEUE,
  9823           TEMP-STORAGE-RECORD,
  9824           TS-LENGTH,
  9825           TS-ITEM,
  9826           DFHEIV99,
  9827           DFHEIV99
  9828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9829
  9830
  9831 7200-EXIT.
  9832     EXIT.
  9833
  9834 7300-DELETE-TEMP-STORAGE.
  9835
  9836* EXEC CICS  HANDLE CONDITION
  9837*        ITEMERR  (7300-EXIT)
  9838*        QIDERR   (7300-EXIT)
  9839*    END-EXEC.
  9840*    MOVE '"$<N                  ! = #00008593' TO DFHEIV0
  9841     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9843     MOVE X'3D20233030303038353933' TO DFHEIV0(25:11)
  9844     CALL 'kxdfhei1' USING DFHEIV0
  9845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9846
  9847
  9848
  9849* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 204
* EL650.cbl
  9850*        QUEUE  (TS-QUEUE)
  9851*    END-EXEC.
  9852*    MOVE '*&                    #   #00008598' TO DFHEIV0
  9853     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9854     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9855     MOVE X'2020233030303038353938' TO DFHEIV0(25:11)
  9856     CALL 'kxdfhei1' USING DFHEIV0,
  9857           TS-QUEUE,
  9858           DFHEIV99
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
  9862 7300-EXIT.
  9863     EXIT.
  9864
  9865 7400-READ-TEMP-STORAGE.
  9866
  9867* EXEC CICS  HANDLE CONDITION
  9868*        ITEMERR  (7400-EXIT)
  9869*        QIDERR   (7400-EXIT)
  9870*    END-EXEC.
  9871*    MOVE '"$<N                  ! > #00008606' TO DFHEIV0
  9872     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9874     MOVE X'3E20233030303038363036' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0
  9876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9877
  9878
  9879     MOVE +1                     TO  TS-ITEM.
  9880
  9881
  9882* EXEC CICS  READQ TS
  9883*        QUEUE   (TS-QUEUE)
  9884*        INTO    (TEMP-STORAGE-RECORD)
  9885*        LENGTH  (TS-LENGTH)
  9886*        ITEM    (TS-ITEM)
  9887*    END-EXEC.
  9888*    MOVE '*$II   L              ''   #00008613' TO DFHEIV0
  9889     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9891     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  9892     CALL 'kxdfhei1' USING DFHEIV0,
  9893           TS-QUEUE,
  9894           TEMP-STORAGE-RECORD,
  9895           TS-LENGTH,
  9896           TS-ITEM,
  9897           DFHEIV99,
  9898           DFHEIV99
  9899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9900
  9901
  9902 7400-EXIT.
  9903     EXIT.
  9904
  9905 8100-SEND-INITIAL-MAP.
  9906     MOVE SAVE-DATE              TO  DATEO.
  9907     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 205
* EL650.cbl
  9908     MOVE TIME-OUT               TO  TIMEO.
  9909     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9910     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9911     MOVE -1                     TO  MAINTL.
  9912     MOVE AL-UABON               TO  MAINTA.
  9913     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9914     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9915
  9916     IF PI-AR-PROCESSING
  9917        MOVE AL-PANOF            TO  ARHDGA.
  9918
  9919
  9920* EXEC CICS  SEND
  9921*        MAP     (MAP-NAME)
  9922*        MAPSET  (MAPSET-NAME)
  9923*        FROM    (EL650AO)
  9924*        ERASE
  9925*        CURSOR
  9926*    END-EXEC.
  9927     MOVE LENGTH OF
  9928      EL650AO
  9929       TO DFHEIV12
  9930     MOVE -1
  9931       TO DFHEIV11
  9932*    MOVE '8$     CT  E    H L F ,   #00008637' TO DFHEIV0
  9933     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9934     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9935     MOVE X'2020233030303038363337' TO DFHEIV0(25:11)
  9936     CALL 'kxdfhei1' USING DFHEIV0,
  9937           MAP-NAME,
  9938           EL650AO,
  9939           DFHEIV12,
  9940           MAPSET-NAME,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99,
  9944           DFHEIV11,
  9945           DFHEIV99,
  9946           DFHEIV99,
  9947           DFHEIV99
  9948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9949
  9950
  9951     GO TO 9100-RETURN-TRAN.
  9952
  9953 8200-SEND-DATAONLY.
  9954     MOVE SAVE-DATE              TO  DATEO.
  9955     MOVE EIBTIME                TO  TIME-IN.
  9956     MOVE TIME-OUT               TO  TIMEO.
  9957     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9958     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9959     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9960     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9961
  9962
  9963* EXEC CICS  SEND
  9964*        MAP     (MAP-NAME)
  9965*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 206
* EL650.cbl
  9966*        FROM    (EL650AO)
  9967*        DATAONLY
  9968*        CURSOR
  9969*    END-EXEC.
  9970     MOVE LENGTH OF
  9971      EL650AO
  9972       TO DFHEIV12
  9973     MOVE -1
  9974       TO DFHEIV11
  9975*    MOVE '8$D    CT       H L F ,   #00008656' TO DFHEIV0
  9976     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9977     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9978     MOVE X'2020233030303038363536' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0,
  9980           MAP-NAME,
  9981           EL650AO,
  9982           DFHEIV12,
  9983           MAPSET-NAME,
  9984           DFHEIV99,
  9985           DFHEIV99,
  9986           DFHEIV99,
  9987           DFHEIV11,
  9988           DFHEIV99,
  9989           DFHEIV99,
  9990           DFHEIV99
  9991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9992
  9993
  9994     GO TO 9100-RETURN-TRAN.
  9995
  9996 8300-SEND-TEXT.
  9997
  9998* EXEC CICS  SEND TEXT
  9999*        FROM    (LOGOFF-TEXT)
 10000*        LENGTH  (LOGOFF-LENGTH)
 10001*        ERASE
 10002*        FREEKB
 10003*    END-EXEC.
 10004*    MOVE '8&      T  E F  H   F -   #00008667' TO DFHEIV0
 10005     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10006     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10007     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
 10008     CALL 'kxdfhei1' USING DFHEIV0,
 10009           LOGOFF-TEXT,
 10010           LOGOFF-LENGTH,
 10011           DFHEIV99,
 10012           DFHEIV99,
 10013           DFHEIV99,
 10014           DFHEIV99,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV99,
 10018           DFHEIV99,
 10019           DFHEIV99,
 10020           DFHEIV99
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10022
 10023
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 207
* EL650.cbl
 10024
 10025* EXEC CICS  RETURN
 10026*    END-EXEC.
 10027*    MOVE '.(                    ''   #00008674' TO DFHEIV0
 10028     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10030     MOVE X'2020233030303038363734' TO DFHEIV0(25:11)
 10031     CALL 'kxdfhei1' USING DFHEIV0,
 10032           DFHEIV99,
 10033           DFHEIV99,
 10034           DFHEIV99,
 10035           DFHEIV99,
 10036           DFHEIV99,
 10037           DFHEIV99
 10038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10039
 10040
 10041 8400-LOG-JOURNAL-RECORD.
 10042*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10043*    MOVE FILE-ID                TO  JP-FILE-ID.
 10044*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10045*
 10046*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
 10047*        EXEC CICS  JOURNAL
 10048*            JFILEID  (PI-JOURNAL-FILE-ID)
 10049*            JTYPEID  ('ER')
 10050*            FROM     (JOURNAL-RECORD)
 10051*            LENGTH   (2023)
 10052*        END-EXEC.
 10053
 10054 8600-DEEDIT.
 10055
 10056* EXEC CICS  BIF DEEDIT
 10057*        FIELD   (WS-DEEDIT-FIELD)
 10058*        LENGTH  (10)
 10059*    END-EXEC.
 10060     MOVE 10
 10061       TO DFHEIV11
 10062*    MOVE '@"L                   #   #00008691' TO DFHEIV0
 10063     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10064     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10065     MOVE X'2020233030303038363931' TO DFHEIV0(25:11)
 10066     CALL 'kxdfhei1' USING DFHEIV0,
 10067           WS-DEEDIT-FIELD,
 10068           DFHEIV11
 10069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10070
 10071 8600-EXIT.
 10072      EXIT.
 10073 8800-UNAUTHORIZED-ACCESS.
 10074     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10075
 10076     GO TO 8300-SEND-TEXT.
 10077
 10078 8810-PF23.
 10079     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10080     MOVE XCTL-005               TO  PGM-NAME.
 10081
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 208
* EL650.cbl
 10082     GO TO 9300-XCTL.
 10083
 10084 8900-PF5.
 10085     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10086         MOVE ER-3785            TO  EMI-ERROR
 10087         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 10088         MOVE -1                 TO  MAINTL
 10089         GO TO 8200-SEND-DATAONLY.
 10090
 10091     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
 10092
 10093     MOVE XCTL-6509              TO  PGM-NAME.
 10094
 10095     GO TO 9300-XCTL.
 10096
 10097 8910-PF6.
 10098     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10099        MOVE ER-3785             TO EMI-ERROR
 10100        PERFORM 9900-ERROR-FORMAT
 10101                                 THRU 9900-EXIT
 10102        MOVE -1                  TO MAINTL
 10103        GO TO 8200-SEND-DATAONLY
 10104     END-IF
 10105     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10106     MOVE XCTL-6503              TO PGM-NAME
 10107     GO TO 9300-XCTL
 10108     .
 10109 9100-RETURN-TRAN.
 10110     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10111     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10112
 10113* EXEC CICS  RETURN
 10114*        TRANSID   (TRANS-ID)
 10115*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10116*        LENGTH    (WS-COMM-LENGTH)
 10117*    END-EXEC.
 10118*    MOVE '.(CT                  ''   #00008736' TO DFHEIV0
 10119     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10121     MOVE X'2020233030303038373336' TO DFHEIV0(25:11)
 10122     CALL 'kxdfhei1' USING DFHEIV0,
 10123           TRANS-ID,
 10124           PROGRAM-INTERFACE-BLOCK,
 10125           WS-COMM-LENGTH,
 10126           DFHEIV99,
 10127           DFHEIV99,
 10128           DFHEIV99
 10129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10130
 10131
 10132 9200-RETURN-MAIN-MENU.
 10133     MOVE XCTL-126               TO  PGM-NAME.
 10134
 10135     GO TO 9300-XCTL.
 10136
 10137 9300-XCTL.
 10138
 10139* EXEC CICS  XCTL
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 209
* EL650.cbl
 10140*        PROGRAM   (PGM-NAME)
 10141*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10142*        LENGTH    (WS-COMM-LENGTH)
 10143*    END-EXEC.
 10144*    MOVE '.$C                   %   #00008748' TO DFHEIV0
 10145     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303038373438' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           PGM-NAME,
 10150           PROGRAM-INTERFACE-BLOCK,
 10151           WS-COMM-LENGTH,
 10152           DFHEIV99
 10153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10154
 10155
 10156 9400-CLEAR.
 10157     MOVE SPACES                 TO  PI-SV-MAINT.
 10158     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10159
 10160     GO TO 9300-XCTL.
 10161
 10162 9500-PF12.
 10163     MOVE XCTL-010               TO  PGM-NAME.
 10164
 10165     GO TO 9300-XCTL.
 10166
 10167 9600-PGMID-ERROR.
 10168
 10169* EXEC CICS  HANDLE CONDITION
 10170*        PGMIDERR  (8300-SEND-TEXT)
 10171*    END-EXEC.
 10172*    MOVE '"$L                   ! ? #00008766' TO DFHEIV0
 10173     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10175     MOVE X'3F20233030303038373636' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0
 10177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10178
 10179
 10180     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10181     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10182     MOVE XCTL-005               TO  PGM-NAME.
 10183     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10184     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10185
 10186     GO TO 9300-XCTL.
 10187
 10188 9700-DATE-CONVERSION.
 10189     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10190
 10191
 10192* EXEC CICS  LINK
 10193*        PROGRAM   (PGM-NAME)
 10194*        COMMAREA  (DATE-CONVERSION-DATA)
 10195*        LENGTH    (DC-COMM-LENGTH)
 10196*    END-EXEC.
 10197*    MOVE '."C                   (   #00008781' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 210
* EL650.cbl
 10198     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10199     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10200     MOVE X'2020233030303038373831' TO DFHEIV0(25:11)
 10201     CALL 'kxdfhei1' USING DFHEIV0,
 10202           PGM-NAME,
 10203           DATE-CONVERSION-DATA,
 10204           DC-COMM-LENGTH,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99,
 10208           DFHEIV99
 10209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10210
 10211
 10212 9900-ERROR-FORMAT.
 10213     IF NOT EMI-ERRORS-COMPLETE
 10214         MOVE LINK-001           TO  PGM-NAME
 10215
 10216* EXEC CICS  LINK
 10217*            PROGRAM   (PGM-NAME)
 10218*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10219*            LENGTH    (EMI-COMM-LENGTH)
 10220*        END-EXEC.
 10221*    MOVE '."C                   (   #00008790' TO DFHEIV0
 10222     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10224     MOVE X'2020233030303038373930' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0,
 10226           PGM-NAME,
 10227           ERROR-MESSAGE-INTERFACE-BLOCK,
 10228           EMI-COMM-LENGTH,
 10229           DFHEIV99,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99
 10233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10234
 10235
 10236 9900-EXIT.
 10237     EXIT.
 10238
 10239 9990-ABEND.
 10240     MOVE LINK-004               TO  PGM-NAME.
 10241     MOVE DFHEIBLK               TO  EMI-LINE1.
 10242
 10243
 10244* EXEC CICS  LINK
 10245*        PROGRAM   (PGM-NAME)
 10246*        COMMAREA  (EMI-LINE1)
 10247*        LENGTH    (72)
 10248*    END-EXEC.
 10249     MOVE 72
 10250       TO DFHEIV11
 10251*    MOVE '."C                   (   #00008803' TO DFHEIV0
 10252     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10254     MOVE X'2020233030303038383033' TO DFHEIV0(25:11)
 10255     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 211
* EL650.cbl
 10256           PGM-NAME,
 10257           EMI-LINE1,
 10258           DFHEIV11,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266     MOVE -1                     TO  MAINTL.
 10267
 10268     GO TO 8200-SEND-DATAONLY.
 10269
 10270 9995-SECURITY-VIOLATION.
 10271*                            COPY ELCSCTP.
 10272******************************************************************
 10273*                                                                *
 10274*                            ELCSCTP                             *
 10275*                            VMOD=2.001                          *
 10276*                                                                *
 10277*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10278******************************************************************
 10279
 10280
 10281     MOVE EIBDATE          TO SM-JUL-DATE.
 10282     MOVE EIBTRMID         TO SM-TERMID.
 10283     MOVE THIS-PGM         TO SM-PGM.
 10284     MOVE EIBTIME          TO TIME-IN.
 10285     MOVE TIME-OUT         TO SM-TIME.
 10286     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10287
 10288
 10289* EXEC CICS LINK
 10290*         PROGRAM  ('EL003')
 10291*         COMMAREA (SECURITY-MESSAGE)
 10292*         LENGTH   (80)
 10293*    END-EXEC.
 10294     MOVE 'EL003' TO DFHEIV1
 10295     MOVE 80
 10296       TO DFHEIV11
 10297*    MOVE '."C                   (   #00008831' TO DFHEIV0
 10298     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10300     MOVE X'2020233030303038383331' TO DFHEIV0(25:11)
 10301     CALL 'kxdfhei1' USING DFHEIV0,
 10302           DFHEIV1,
 10303           SECURITY-MESSAGE,
 10304           DFHEIV11,
 10305           DFHEIV99,
 10306           DFHEIV99,
 10307           DFHEIV99,
 10308           DFHEIV99
 10309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10310
 10311
 10312******************************************************************
 10313
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 212
* EL650.cbl
 10314
 10315 9995-EXIT.
 10316     EXIT.
 10317
 10318 9999-DFHBACK SECTION.
 10319     MOVE '9%                    "   ' TO DFHEIV0
 10320     MOVE 'EL650' TO DFHEIV1
 10321     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10322     GOBACK.
 10323 9999-DFHEXIT.
 10324     IF DFHEIGDJ EQUAL 0001
 10325         NEXT SENTENCE
 10326     ELSE IF DFHEIGDJ EQUAL 2
 10327         GO TO 5340-END,
 10328               5330-NOT-FOUND
 10329         DEPENDING ON DFHEIGDI
 10330     ELSE IF DFHEIGDJ EQUAL 3
 10331         GO TO 9600-PGMID-ERROR,
 10332               9990-ABEND
 10333         DEPENDING ON DFHEIGDI
 10334     ELSE IF DFHEIGDJ EQUAL 4
 10335         GO TO 1010-NOT-FOUND,
 10336               1010-NOT-FOUND
 10337         DEPENDING ON DFHEIGDI
 10338     ELSE IF DFHEIGDJ EQUAL 5
 10339         GO TO 2568-NO-RECORDS,
 10340               2568-NO-RECORDS
 10341         DEPENDING ON DFHEIGDI
 10342     ELSE IF DFHEIGDJ EQUAL 6
 10343         GO TO 3175-CONTINUE,
 10344               3175-CONTINUE
 10345         DEPENDING ON DFHEIGDI
 10346     ELSE IF DFHEIGDJ EQUAL 7
 10347         GO TO 4175-CONTINUE,
 10348               4175-CONTINUE
 10349         DEPENDING ON DFHEIGDI
 10350     ELSE IF DFHEIGDJ EQUAL 8
 10351         GO TO 4530-NOT-FOUND,
 10352               4530-NOT-FOUND
 10353         DEPENDING ON DFHEIGDI
 10354     ELSE IF DFHEIGDJ EQUAL 9
 10355         GO TO 4699-EXIT,
 10356               4689-EOF
 10357         DEPENDING ON DFHEIGDI
 10358     ELSE IF DFHEIGDJ EQUAL 10
 10359         GO TO 4899-EXIT,
 10360               4889-EOF
 10361         DEPENDING ON DFHEIGDI
 10362     ELSE IF DFHEIGDJ EQUAL 11
 10363         GO TO 4580-DUPREC,
 10364               4580-DUPREC
 10365         DEPENDING ON DFHEIGDI
 10366     ELSE IF DFHEIGDJ EQUAL 12
 10367         GO TO 4959-EXIT,
 10368               4959-EXIT
 10369         DEPENDING ON DFHEIGDI
 10370     ELSE IF DFHEIGDJ EQUAL 13
 10371         GO TO 4969-EXIT,
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 213
* EL650.cbl
 10372               4969-EXIT
 10373         DEPENDING ON DFHEIGDI
 10374     ELSE IF DFHEIGDJ EQUAL 14
 10375         GO TO 4980-EXIT
 10376         DEPENDING ON DFHEIGDI
 10377     ELSE IF DFHEIGDJ EQUAL 15
 10378         GO TO 5007-EXIT,
 10379               5007-EXIT
 10380         DEPENDING ON DFHEIGDI
 10381     ELSE IF DFHEIGDJ EQUAL 16
 10382         GO TO 5007-EXIT,
 10383               5007-EXIT,
 10384               5007-EXIT,
 10385               5007-EXIT,
 10386               5007-EXIT
 10387         DEPENDING ON DFHEIGDI
 10388     ELSE IF DFHEIGDJ EQUAL 17
 10389         GO TO 5015-NOT-FOUND,
 10390               5015-NOT-FOUND
 10391         DEPENDING ON DFHEIGDI
 10392     ELSE IF DFHEIGDJ EQUAL 18
 10393         GO TO 5015-NOT-FOUND,
 10394               5015-NOT-FOUND
 10395         DEPENDING ON DFHEIGDI
 10396     ELSE IF DFHEIGDJ EQUAL 19
 10397         GO TO 5340-END,
 10398               5330-NOT-FOUND
 10399         DEPENDING ON DFHEIGDI
 10400     ELSE IF DFHEIGDJ EQUAL 20
 10401         GO TO 5440-NOT-FOUND,
 10402               5430-NOT-FOUND
 10403         DEPENDING ON DFHEIGDI
 10404     ELSE IF DFHEIGDJ EQUAL 21
 10405         GO TO 5525-SKIP-REWRITE,
 10406               5525-SKIP-REWRITE
 10407         DEPENDING ON DFHEIGDI
 10408     ELSE IF DFHEIGDJ EQUAL 22
 10409         GO TO 5615-SKIP-REWRITE,
 10410               5615-SKIP-REWRITE
 10411         DEPENDING ON DFHEIGDI
 10412     ELSE IF DFHEIGDJ EQUAL 23
 10413         GO TO 6599-EXIT
 10414         DEPENDING ON DFHEIGDI
 10415     ELSE IF DFHEIGDJ EQUAL 24
 10416         GO TO 6699-EXIT
 10417         DEPENDING ON DFHEIGDI
 10418     ELSE IF DFHEIGDJ EQUAL 25
 10419         GO TO 6720-NO-CARRIER
 10420         DEPENDING ON DFHEIGDI
 10421     ELSE IF DFHEIGDJ EQUAL 26
 10422         GO TO 6780-NO-STATE
 10423         DEPENDING ON DFHEIGDI
 10424     ELSE IF DFHEIGDJ EQUAL 27
 10425         GO TO 6880-NO-COMP
 10426         DEPENDING ON DFHEIGDI
 10427     ELSE IF DFHEIGDJ EQUAL 28
 10428         GO TO 7200-EXIT,
 10429               7200-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-May-16 11:19 Page 214
* EL650.cbl
 10430         DEPENDING ON DFHEIGDI
 10431     ELSE IF DFHEIGDJ EQUAL 29
 10432         GO TO 7300-EXIT,
 10433               7300-EXIT
 10434         DEPENDING ON DFHEIGDI
 10435     ELSE IF DFHEIGDJ EQUAL 30
 10436         GO TO 7400-EXIT,
 10437               7400-EXIT
 10438         DEPENDING ON DFHEIGDI
 10439     ELSE IF DFHEIGDJ EQUAL 31
 10440         GO TO 8300-SEND-TEXT
 10441         DEPENDING ON DFHEIGDI.
 10442     MOVE '9%                    "   ' TO DFHEIV0
 10443     MOVE 'EL650' TO DFHEIV1
 10444     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10445     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40228     Code:       34370
