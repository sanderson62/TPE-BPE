* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37*-----------------------------------------------------------------
    38*REMARKS.
    39*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   3
* EL6317.cbl
    41 ENVIRONMENT DIVISION.
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    47 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    48 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    49 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    50 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    51 77  s1                          pic s999 comp-3 value +0.
    52 77  s2                          pic s999 comp-3 value +0.
    53 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    54 77  WS-REASON-SW                PIC X  VALUE ' '.
    55     88  REASONS-FOUND                  VALUE 'Y'.
    56     88  REASONS-NOT-FOUND              VALUE 'N'.
    57 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    58     88  NO-CERT-RW                 VALUE 'N'.
    59     88  CERT-RW                    VALUE 'Y'.
    60 01  P pointer.
    61 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    62 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    63 01  var-ptr pointer.
    64 01  env-var-len                 pic 9(4)  binary.
    65 01  rc                          pic 9(9)  binary.
    66 01  WS-KIXHOST                  PIC X(10).
    67 01  WS-KIXSYS.
    68     05  WS-KIX-FIL1             PIC X(10).
    69     05  WS-KIX-APPS             PIC X(10).
    70     05  WS-KIX-ENV              PIC X(10).
    71     05  WS-KIX-MYENV            PIC X(10).
    72     05  WS-KIX-SYS              PIC X(10).
    73*                                COPY ELCSCTM.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCSCTM                             *
    78*                            VMOD=2.001                          *
    79*                                                                *
    80*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    81*                                                                *
    82******************************************************************
    83 01  SECURITY-MESSAGE.
    84     12  FILLER                          PIC X(30)
    85            VALUE '** LOGIC SECURITY VIOLATION -'.
    86     12  SM-READ                         PIC X(6).
    87     12  FILLER                          PIC X(5)
    88            VALUE ' PGM='.
    89     12  SM-PGM                          PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' OPR='.
    92     12  SM-PROCESSOR-ID                 PIC X(4).
    93     12  FILLER                          PIC X(6)
    94            VALUE ' TERM='.
    95     12  SM-TERMID                       PIC X(4).
    96     12  FILLER                          PIC XX   VALUE SPACE.
    97     12  SM-JUL-DATE                     PIC 9(5).
    98     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   4
* EL6317.cbl
    99     12  SM-TIME                         PIC 99.99.
   100
   101*                                COPY ELCSCRTY.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCRTY                            *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   109*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   110*        SAVED IN PI-SECURITY-ADDRESS.                           *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-CONTROL.
   114     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   115     12  FILLER                       PIC XX    VALUE 'SC'.
   116     12  SC-CREDIT-CODES.
   117         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   118             20  SC-CREDIT-DISPLAY    PIC X.
   119             20  SC-CREDIT-UPDATE     PIC X.
   120     12  SC-CLAIMS-CODES.
   121         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   122             20  SC-CLAIMS-DISPLAY    PIC X.
   123             20  SC-CLAIMS-UPDATE     PIC X.
   124 01 srch-commarea.
   125*                                copy ELCADLTRSPI.
   126******************************************************************
   127*                   C H A N G E   L O G
   128*
   129* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   130*-----------------------------------------------------------------
   131*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   132* EFFECTIVE    NUMBER
   133*-----------------------------------------------------------------
   134* 060611    2011022800001  PEMA  NEW COPYBOOK
   135* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   136* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   137******************************************************************
   138****************************************
   139*  commarea for NaperSoft On Demand Admin services letters
   140*  (business logic input & output)
   141****************************************
   142     03  BL-INPUT.
   143         05  BL-DATA-SRCE        PIC X.
   144         05  BL-LETTER-ID        PIC XXXX.
   145         05  BL-CARRIER          PIC X.
   146         05  BL-GROUP            PIC X(6).
   147         05  BL-STATE            PIC XX.
   148         05  BL-ACCOUNT          PIC X(10).
   149         05  BL-EFF-DT           PIC X(10).
   150         05  BL-CERT-NO          PIC X(11).
   151         05  BL-BATCH-NO         PIC X(6).
   152         05  BL-BATCH-SEQ        PIC 9(8).
   153         05  BL-RESP-NO          PIC X(10).
   154         05  BL-NO-OF-COPIES     PIC 99.
   155         05  BL-PROC-ID          PIC XXXX.
   156         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   5
* EL6317.cbl
   157         05  BL-PRINT-NOW-SW     PIC X.
   158         05  BL-ENC-CD           PIC XXX.
   159         05  BL-RESEND-DT        PIC X(10).
   160         05  BL-FOLLOW-UP-DT     PIC X(10).
   161         05  BL-ARCHIVE-NO       PIC 9(8).
   162         05  BL-FUNC             PIC X(8).
   163         05  BL-COMMENTS         PIC X(100).
   164         05  FILLER REDEFINES BL-COMMENTS.
   165             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   166             10  BL-LETTER-TO-ACCT PIC X.
   167             10  BL-LETTER-TO-BENE PIC X.
   168             10  BL-WRITE-ERARCH   PIC X.
   169                 88  ERARCH-QWS      VALUE 'Q'.
   170                 88  ERARCH-BATCH    VALUE 'B'.
   171                 88  ERARCH-TEMP     VALUE 'T'.
   172             10  BL-PROCESS-TYPE PIC X(07).
   173             10  BL-CERT-FORM-ID PIC X(05).
   174             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   175             10  BL-SOURCE-SCREEN PIC X(8).
   176             10  FILLER          PIC X(25).
   177     03  BL-OUTPUT.
   178         05  BL-STATUS                   PIC X.
   179             88  BL-OK                      VALUE "P".
   180             88  BL-FAIL                  VALUE "F".
   181         05  BL-MESSAGE          PIC X(50).
   182     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   183     03  FILLER                  PIC X(31).
   184
   185*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   186*                                COPY ELCZREC.
   187******************************************************************
   188*                                                                *
   189*                                                                *
   190*                            ELCZREC.                            *
   191*                                                                *
   192*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   193*                                                                *
   194******************************************************************
   195*-----------------------------------------------------------------
   196*                   C H A N G E   L O G
   197*
   198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   199*-----------------------------------------------------------------
   200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   201* EFFECTIVE    NUMBER
   202*-----------------------------------------------------------------
   203* 122011    2011022800001  AJRA  NEW FILE
   204* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   205* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   206*-----------------------------------------------------------------
   207 01  W-Z-CONTROL-DATA.
   208     05  W-NUMBER-OF-COPIES      PIC  9.
   209     05  FILLER                  PIC  X.
   210     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   211     05  FILLER                  PIC  X.
   212     05  W-DAYS-TO-RESEND        PIC  999.
   213     05  FILLER                  PIC  X.
   214     05  W-FORM-TO-RESEND        PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   6
* EL6317.cbl
   215     05  FILLER                  PIC  X.
   216     05  W-PROMPT-LETTER         PIC  X.
   217     05  FILLER                  PIC  X.
   218     05  W-ENCLOSURE-CD          PIC  XXX.
   219     05  FILLER                  PIC  X.
   220     05  W-AUTO-CLOSE-IND        PIC  X.
   221     05  FILLER                  PIC  X.
   222     05  W-LETTER-TO-BENE        PIC  X.
   223     05  FILLER                  PIC  X.
   224     05  W-LETTER-TO-ACCT        PIC  X.
   225     05  FILLER                  PIC  X.
   226     05  W-LETTER-TYPE           PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-PRINT-CERTIFICATE     PIC  X.
   229     05  FILLER                  PIC  X.
   230     05  W-REFUND-REQUIRED       PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-ONBASE-CODE           PIC  XX.
   233     05  FILLER                  PIC  X.
   234     05  W-ACCT-SUMM             PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-CSO-SUMM              PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-REASONS-REQUIRED      PIC  X.
   239     05  FILLER                  PIC  X(29).
   240 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   241 01  STANDARD-AREAS.
   242     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   243     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   244                                 PIC  X(08).
   245     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   246     12  QID.
   247         16  QID-TERM        PIC X(4)    VALUE SPACES.
   248         16  FILLER          PIC X(4)    VALUE '631J'.
   249     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   250     12  TIME-MT                 PIC S9(7).
   251     12  TIME-MT-R  REDEFINES TIME-MT.
   252         16  FILLER              PIC X.
   253         16  TIME-LMT            PIC 99V99.
   254         16  FILLER              PIC X(2).
   255     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   256     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   257     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   258     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   259     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   260     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   261     12  W-CNTL-KEY.
   262         16  W-CNTL-COMPANY-ID   PIC  X(03).
   263         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   264         16  W-CNTL-GENL.
   265             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   266             20  W-CNTL-GEN2.
   267                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   268                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   269         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   270     12  WS-ELCERT-KEY.
   271         16  W-CERT-COMPANY-CD   PIC X.
   272         16  W-CERT-CARRIER      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   7
* EL6317.cbl
   273         16  W-CERT-GROUPING     PIC X(6).
   274         16  W-CERT-STATE        PIC XX.
   275         16  W-CERT-ACCOUNT      PIC X(10).
   276         16  W-CERT-CERT-EFF-DT  PIC XX.
   277         16  W-CERT-CERT-PRIME   PIC X(10).
   278         16  W-CERT-CERT-SFX     PIC X.
   279
   280     12  WS-ELCRTT-KEY.
   281         16  WS-ELCRTT-PRIMARY   PIC X(33).
   282         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   283     12  ELCRTT-RECORD-LENGTH    PIC S9(4) COMP VALUE +552.
   284     12  ELCRTT-JOURNAL-LENGTH   PIC S9(4) COMP VALUE +575.
   285
   286     12  WS-ELEOBC-KEY.
   287         16  WS-EOBC-COMPANY-CD  PIC X.
   288         16  WS-EOBC-REC-TYPE    PIC X.
   289         16  WS-EOBC-CODE        PIC X(4).
   290         16  FILLER              PIC X(9).
   291     12  WS-ERNOTE-KEY.
   292         16  W-NOTE-COMPANY-CD   PIC X.
   293         16  W-NOTE-CARRIER      PIC X.
   294         16  W-NOTE-GROUPING     PIC X(6).
   295         16  W-NOTE-STATE        PIC XX.
   296         16  W-NOTE-ACCOUNT      PIC X(10).
   297         16  W-NOTE-CERT-EFF-DT  PIC XX.
   298         16  W-NOTE-CERT-PRIME   PIC X(10).
   299         16  W-NOTE-CERT-SFX     PIC X.
   300     12  ELLETR-KEY.
   301         16  LETR-PART-KEY.
   302             20  LETR-COMPANY-CD PIC X.
   303             20  LETR-LETTER-ID  PIC X(4).
   304         16  LETR-FILLER         PIC X(8).
   305         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   306     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   307     12  ERPNDB2-KEY.
   308         16  PNDB2-COMPANY-CD    PIC X.
   309         16  PNDB2-CARRIER       PIC X.
   310         16  PNDB2-GROUPING      PIC X(6).
   311         16  PNDB2-STATE         PIC XX.
   312         16  PNDB2-ACCOUNT       PIC X(10).
   313         16  PNDB2-CERT-EFF-DT   PIC XX.
   314         16  PNDB2-CERT-PRIME    PIC X(10).
   315         16  PNDB2-CERT-SFX      PIC X.
   316         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   317         16  PNDB2-RECORD-TYPE   PIC X.
   318     12  ERPNDB-KEY.
   319         16  PNDB-COMPANY-CD     PIC X.
   320         16  PNDB-BATCH-NO       PIC X(6).
   321         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   322         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   323     12  ERENDT-KEY.
   324         16  ENDT-COMPANY-CD       PIC X.
   325         16  ENDT-CARRIER          PIC X.
   326         16  ENDT-GROUPING         PIC X(6).
   327         16  ENDT-STATE            PIC XX.
   328         16  ENDT-ACCOUNT          PIC X(10).
   329         16  ENDT-CERT-EFF-DT      PIC XX.
   330         16  ENDT-CERT-PRIME       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   8
* EL6317.cbl
   331         16  ENDT-CERT-SFX         PIC X.
   332         16  ENDT-RECORD-TYPE      PIC X.
   333         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   334     12  ELCRTO-KEY.
   335         16  CRTO-COMPANY-CD     PIC X.
   336         16  CRTO-CARRIER        PIC X.
   337         16  CRTO-GROUPING       PIC X(6).
   338         16  CRTO-STATE          PIC XX.
   339         16  CRTO-ACCOUNT        PIC X(10).
   340         16  CRTO-CERT-EFF-DT    PIC XX.
   341         16  CRTO-CERT-PRIME     PIC X(10).
   342         16  CRTO-CERT-SFX       PIC X.
   343         16  CRTO-RECORD-TYPE    PIC X.
   344         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   345     12  WS-ERMAIL-KEY.
   346         16  MAIL-COMPANY-CD     PIC X.
   347         16  MAIL-CARRIER        PIC X.
   348         16  MAIL-GROUPING       PIC X(6).
   349         16  MAIL-STATE          PIC XX.
   350         16  MAIL-ACCOUNT        PIC X(10).
   351         16  MAIL-CERT-EFF-DT    PIC XX.
   352         16  MAIL-CERT-PRIME     PIC X(10).
   353         16  MAIL-CERT-SFX       PIC X.
   354     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   355     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   356     12  WS-CURRENT-DT.
   357         16  FILLER              PIC X(6)    VALUE SPACES.
   358         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   359     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   360     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   361         88  CANCEL-REC            VALUE 'C'.
   362         88  ISSUE-REC             VALUE 'I'.
   363     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   364     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   365     12  ELCNTL-KEY.
   366         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   367         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   368         16  CNTL-ACCESS.
   369             20  CNTL-STATE      PIC XX    VALUE SPACES.
   370             20  FILLER          PIC X     VALUE SPACES.
   371             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   372         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   373     12  ERACCT-KEY.
   374         16  ERACCT-COMP-KEY.
   375             20  ACCT-CO         PIC X     VALUE SPACES.
   376             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   377             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
   378             20  ACCT-STATE      PIC XX    VALUE SPACES.
   379             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   380         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   381         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   382     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   383     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   384     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   385     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   386     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   387     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   388     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page   9
* EL6317.cbl
   389     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   390     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   391     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   392     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   393     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   394     12  WS-RESPONSE             PIC S9(8)   COMP.
   395         88  RESP-NORMAL                  VALUE +00.
   396         88  RESP-NOTFND                  VALUE +13.
   397         88  RESP-DUPREC                  VALUE +14.
   398         88  RESP-DUPKEY                  VALUE +15.
   399         88  RESP-NOTOPEN                 VALUE +19.
   400         88  RESP-ENDFILE                 VALUE +20.
   401     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   402     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   403     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   404     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   405     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   406     12  PGM-NAME            PIC X(8).
   407     12  TIME-IN             PIC S9(7).
   408     12  TIME-OUT-R  REDEFINES TIME-IN.
   409         16  FILLER          PIC X.
   410         16  TIME-OUT        PIC 99V99.
   411         16  FILLER          PIC X(2).
   412     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   413     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   414     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   415     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   416     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   417     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   418     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   419     12  WS-PHONE.
   420         16  WS-PH1              PIC XXX.
   421         16  WS-PH2              PIC XXX.
   422         16  WS-PH3              PIC XXXX.
   423     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   424     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   425
   426     12  WS-BILLING-NOTE.
   427         16  WS-BN-NOTE          PIC X(25).
   428         16  WS-BN-LTRID         PIC X(4).
   429         16  FILLER              PIC X(3).
   430         16  WS-BN-DATE          PIC X(8).
   431         16  FILLER              PIC X(3).
   432         16  WS-BN-USERID        PIC X(4).
   433         16  FILLER              PIC X(30).
   434     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   435         16  WS-MAN-BN-NOTE      PIC X(63).
   436         16  FILLER              PIC X(14).
   437     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   438
   439 01  NEW-ELCRTO-REC.
   440     12  NEW-ELCRTO-KEY.
   441         16  NCRTO-COMPANY-CD      PIC X.
   442         16  NCRTO-CARRIER         PIC X.
   443         16  NCRTO-GROUPING        PIC X(6).
   444         16  NCRTO-STATE           PIC XX.
   445         16  NCRTO-ACCOUNT         PIC X(10).
   446         16  NCRTO-CERT-EFF-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  10
* EL6317.cbl
   447         16  NCRTO-CERT-PRIME      PIC X(10).
   448         16  NCRTO-CERT-SFX        PIC X.
   449         16  NCRTO-RECORD-TYPE     PIC X.
   450         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   451     12  NEW-ORIG-REC.
   452         16  NCRTO-INS-LAST-NAME   PIC X(15).
   453         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   454         16  NCRTO-INS-MIDDLE-INIT PIC X.
   455         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   456         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   457         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   458         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   459         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   460         16  NCRTO-LF-BENCD        PIC XX.
   461         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   462         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   463         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   464         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   465         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   466         16  NCRTO-LF-EXP-DT       PIC XX.
   467         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   468         16  NCRTO-LF-CANCEL-DT    PIC XX.
   469         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   470         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   471         16  NCRTO-AH-BENCD        PIC XX.
   472         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   473         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   474         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   475         16  NCRTO-AH-EXP-DT       PIC XX.
   476         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   477         16  NCRTO-AH-CP           PIC 99.
   478         16  NCRTO-AH-CANCEL-DT    PIC XX.
   479         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   480         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   481         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   482         16  NCRTO-1ST-PMT-DT      PIC XX.
   483         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   484         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   485         16  FILLER                PIC X(237).
   486
   487 01  CERT-NOTE-ENTRIES.
   488     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   489         16  CERT-NT-TEXT                PIC X(63).
   490         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   491         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   492         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   493
   494 01  ERCNOT-AREA.
   495     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   496     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   497     12  ERCNOT-KEY.
   498         16  ERCNOT-PARTIAL-KEY.
   499             20 ERCNOT-COMPANY-CD    PIC X.
   500             20 ERCNOT-CARRIER       PIC X.
   501             20 ERCNOT-GROUPING      PIC X(06).
   502             20 ERCNOT-STATE         PIC XX.
   503             20 ERCNOT-ACCOUNT       PIC X(10).
   504             20 ERCNOT-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  11
* EL6317.cbl
   505             20 ERCNOT-CERT-NO.
   506                25 ERCNOT-CERT-PRIME PIC X(10).
   507                25 ERCNOT-CERT-SFX   PIC X.
   508             20 ERCNOT-REC-TYP       PIC X.
   509         16 ERCNOT-SEQ           PIC S9(4) COMP.
   510     12  SV-PARTIAL-KEY.
   511         20 SV-COMPANY-CD            PIC X.
   512         20 SV-CARRIER               PIC X.
   513         20 SV-GROUPING              PIC X(06).
   514         20 SV-STATE                 PIC XX.
   515         20 SV-ACCOUNT               PIC X(10).
   516         20 SV-EFF-DT                PIC XX.
   517         20 SV-CERT-NO.
   518            25 SV-CERT-PRIME         PIC X(10).
   519            25 SV-CERT-SFX           PIC X(1).
   520         20 SV-REC-TYP               PIC X.
   521 01  ERROR-MESSAGES.
   522     12  ER-0000                 PIC X(4)  VALUE '0000'.
   523     12  ER-0004                 PIC X(4)  VALUE '0004'.
   524     12  ER-0008                 PIC X(4)  VALUE '0008'.
   525     12  ER-0023                 PIC X(4)  VALUE '0023'.
   526     12  ER-0029                 PIC X(4)  VALUE '0029'.
   527     12  ER-0068                 PIC X(4)  VALUE '0068'.
   528     12  ER-0132                 PIC X(4)  VALUE '0132'.
   529     12  ER-0142                 PIC X(4)  VALUE '0142'.
   530     12  ER-0148                 PIC X(4)  VALUE '0148'.
   531     12  ER-0215                 PIC X(4)  VALUE '0215'.
   532     12  ER-0280                 PIC X(4)  VALUE '0280'.
   533     12  ER-0348                 PIC X(4)  VALUE '0348'.
   534     12  ER-0419                 PIC X(4)  VALUE '0419'.
   535     12  ER-0894                 PIC X(4)  VALUE '0894'.
   536     12  ER-1101                 PIC X(4)  VALUE '1101'.
   537     12  ER-1236                 PIC X(4)  VALUE '1236'.
   538     12  ER-1818                 PIC X(4)  VALUE '1818'.
   539     12  ER-1820                 PIC X(4)  VALUE '1820'.
   540     12  ER-2056                 PIC X(4)  VALUE '2056'.
   541     12  ER-2079                 PIC X(4)  VALUE '2079'.
   542     12  ER-2208                 PIC X(4)  VALUE '2208'.
   543     12  ER-2209                 PIC X(4)  VALUE '2209'.
   544     12  ER-2237                 PIC X(4)  VALUE '2237'.
   545     12  ER-2238                 PIC X(4)  VALUE '2238'.
   546     12  ER-2253                 PIC X(4)  VALUE '2253'.
   547     12  ER-2619                 PIC X(4)  VALUE '2619'.
   548     12  ER-2651                 PIC X(4)  VALUE '2651'.
   549     12  ER-2784                 PIC X(4)  VALUE '2784'.
   550     12  ER-2785                 PIC X(4)  VALUE '2785'.
   551     12  ER-2786                 PIC X(4)  VALUE '2786'.
   552     12  ER-2791                 PIC X(4)  VALUE '2791'.
   553     12  ER-2845                 PIC X(4)  VALUE '2845'.
   554     12  ER-2848                 PIC X(4)  VALUE '2848'.
   555     12  ER-2851                 PIC X(4)  VALUE '2851'.
   556     12  ER-3830                 PIC X(4)  VALUE '3830'.
   557     12  ER-3833                 PIC X(4)  VALUE '3833'.
   558     12  ER-7345                 PIC X(4)  VALUE '7345'.
   559     12  ER-7638                 PIC X(4)  VALUE '7638'.
   560     12  ER-8888                 PIC X(4)  VALUE '8888'.
   561     12  ER-9999                 PIC X(4)  VALUE '9999'.
   562*    COPY ELCDATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  12
* EL6317.cbl
   563******************************************************************
   564*                                                                *
   565*                                                                *
   566*                            ELCDATE.                            *
   567*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   568*                            VMOD=2.003
   569*                                                                *
   570*                                                                *
   571*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   572*                 LENGTH = 200                                   *
   573******************************************************************
   574
   575 01  DATE-CONVERSION-DATA.
   576     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   577     12  DC-OPTION-CODE                PIC X.
   578         88  BIN-TO-GREG                VALUE ' '.
   579         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   580         88  EDIT-GREG-TO-BIN           VALUE '2'.
   581         88  YMD-GREG-TO-BIN            VALUE '3'.
   582         88  MDY-GREG-TO-BIN            VALUE '4'.
   583         88  JULIAN-TO-BIN              VALUE '5'.
   584         88  BIN-PLUS-ELAPSED           VALUE '6'.
   585         88  FIND-CENTURY               VALUE '7'.
   586         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   587         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   588         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   589         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   590         88  JULIAN-TO-BIN-3            VALUE 'C'.
   591         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   592         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   593         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   594         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   595         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   596         88  CHECK-LEAP-YEAR            VALUE 'H'.
   597         88  BIN-3-TO-GREG              VALUE 'I'.
   598         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   599         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   600         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   601         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   602         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   603         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   604         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   605         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   606         88  THREE-CHARACTER-BIN
   607                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   608         88  GREGORIAN-TO-BIN
   609                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   610         88  BIN-TO-GREGORIAN
   611                  VALUES ' ' '1' 'I' '8' 'G'.
   612         88  JULIAN-TO-BINARY
   613                  VALUES '5' 'C' 'E' 'F'.
   614     12  DC-ERROR-CODE                 PIC X.
   615         88  NO-CONVERSION-ERROR        VALUE ' '.
   616         88  DATE-CONVERSION-ERROR
   617                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   618         88  DATE-IS-ZERO               VALUE '1'.
   619         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   620         88  DATE-IS-INVALID            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  13
* EL6317.cbl
   621         88  DATE1-GREATER-DATE2        VALUE '4'.
   622         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   623         88  DATE-INVALID-OPTION        VALUE '9'.
   624         88  INVALID-CENTURY            VALUE 'A'.
   625         88  ONLY-CENTURY               VALUE 'B'.
   626         88  ONLY-LEAP-YEAR             VALUE 'C'.
   627         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   628     12  DC-END-OF-MONTH               PIC X.
   629         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   630     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   631         88  USE-NORMAL-PROCESS         VALUE ' '.
   632         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   633         88  ADJUST-UP-100-YRS          VALUE '2'.
   634     12  FILLER                        PIC X.
   635     12  DC-CONVERSION-DATES.
   636         16  DC-BIN-DATE-1             PIC XX.
   637         16  DC-BIN-DATE-2             PIC XX.
   638         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   639         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   640                       DC-GREG-DATE-1-EDIT.
   641             20  DC-EDIT1-MONTH        PIC 99.
   642             20  SLASH1-1              PIC X.
   643             20  DC-EDIT1-DAY          PIC 99.
   644             20  SLASH1-2              PIC X.
   645             20  DC-EDIT1-YEAR         PIC 99.
   646         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   647         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   648                     DC-GREG-DATE-2-EDIT.
   649             20  DC-EDIT2-MONTH        PIC 99.
   650             20  SLASH2-1              PIC X.
   651             20  DC-EDIT2-DAY          PIC 99.
   652             20  SLASH2-2              PIC X.
   653             20  DC-EDIT2-YEAR         PIC 99.
   654         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   655         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   656                     DC-GREG-DATE-1-YMD.
   657             20  DC-YMD-YEAR           PIC 99.
   658             20  DC-YMD-MONTH          PIC 99.
   659             20  DC-YMD-DAY            PIC 99.
   660         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   661         16  DC-GREG-DATE-1-MDY-R REDEFINES
   662                      DC-GREG-DATE-1-MDY.
   663             20  DC-MDY-MONTH          PIC 99.
   664             20  DC-MDY-DAY            PIC 99.
   665             20  DC-MDY-YEAR           PIC 99.
   666         16  DC-GREG-DATE-1-ALPHA.
   667             20  DC-ALPHA-MONTH        PIC X(10).
   668             20  DC-ALPHA-DAY          PIC 99.
   669             20  FILLER                PIC XX.
   670             20  DC-ALPHA-CENTURY.
   671                 24 DC-ALPHA-CEN-N     PIC 99.
   672             20  DC-ALPHA-YEAR         PIC 99.
   673         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   674         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   675         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   676         16  DC-JULIAN-DATE            PIC 9(05).
   677         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   678                                       PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  14
* EL6317.cbl
   679         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   680             20  DC-JULIAN-YEAR        PIC 99.
   681             20  DC-JULIAN-DAYS        PIC 999.
   682         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   683         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   684         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   685     12  DATE-CONVERSION-VARIBLES.
   686         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   687         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   688             20  FILLER                PIC 9(3).
   689             20  HOLD-CEN-1-CCYY.
   690                 24  HOLD-CEN-1-CC     PIC 99.
   691                 24  HOLD-CEN-1-YY     PIC 99.
   692             20  HOLD-CEN-1-MO         PIC 99.
   693             20  HOLD-CEN-1-DA         PIC 99.
   694         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   695             20  HOLD-CEN-1-R-MO       PIC 99.
   696             20  HOLD-CEN-1-R-DA       PIC 99.
   697             20  HOLD-CEN-1-R-CCYY.
   698                 24  HOLD-CEN-1-R-CC   PIC 99.
   699                 24  HOLD-CEN-1-R-YY   PIC 99.
   700             20  FILLER                PIC 9(3).
   701         16  HOLD-CENTURY-1-X.
   702             20  FILLER                PIC X(3)  VALUE SPACES.
   703             20  HOLD-CEN-1-X-CCYY.
   704                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   705                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   706             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   707             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   708         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   709             20  HOLD-CEN-1-R-X-MO     PIC XX.
   710             20  HOLD-CEN-1-R-X-DA     PIC XX.
   711             20  HOLD-CEN-1-R-X-CCYY.
   712                 24  HOLD-CEN-1-R-X-CC PIC XX.
   713                 24  HOLD-CEN-1-R-X-YY PIC XX.
   714             20  FILLER                PIC XXX.
   715         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   716         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   717         16  DC-JULIAN-DATE-1          PIC 9(07).
   718         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   719             20  DC-JULIAN-1-CCYY.
   720                 24  DC-JULIAN-1-CC    PIC 99.
   721                 24  DC-JULIAN-1-YR    PIC 99.
   722             20  DC-JULIAN-DA-1        PIC 999.
   723         16  DC-JULIAN-DATE-2          PIC 9(07).
   724         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   725             20  DC-JULIAN-2-CCYY.
   726                 24  DC-JULIAN-2-CC    PIC 99.
   727                 24  DC-JULIAN-2-YR    PIC 99.
   728             20  DC-JULIAN-DA-2        PIC 999.
   729         16  DC-GREG-DATE-A-EDIT.
   730             20  DC-EDITA-MONTH        PIC 99.
   731             20  SLASHA-1              PIC X VALUE '/'.
   732             20  DC-EDITA-DAY          PIC 99.
   733             20  SLASHA-2              PIC X VALUE '/'.
   734             20  DC-EDITA-CCYY.
   735                 24  DC-EDITA-CENT     PIC 99.
   736                 24  DC-EDITA-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  15
* EL6317.cbl
   737         16  DC-GREG-DATE-B-EDIT.
   738             20  DC-EDITB-MONTH        PIC 99.
   739             20  SLASHB-1              PIC X VALUE '/'.
   740             20  DC-EDITB-DAY          PIC 99.
   741             20  SLASHB-2              PIC X VALUE '/'.
   742             20  DC-EDITB-CCYY.
   743                 24  DC-EDITB-CENT     PIC 99.
   744                 24  DC-EDITB-YEAR     PIC 99.
   745         16  DC-GREG-DATE-CYMD         PIC 9(08).
   746         16  DC-GREG-DATE-CYMD-R REDEFINES
   747                              DC-GREG-DATE-CYMD.
   748             20  DC-CYMD-CEN           PIC 99.
   749             20  DC-CYMD-YEAR          PIC 99.
   750             20  DC-CYMD-MONTH         PIC 99.
   751             20  DC-CYMD-DAY           PIC 99.
   752         16  DC-GREG-DATE-MDCY         PIC 9(08).
   753         16  DC-GREG-DATE-MDCY-R REDEFINES
   754                              DC-GREG-DATE-MDCY.
   755             20  DC-MDCY-MONTH         PIC 99.
   756             20  DC-MDCY-DAY           PIC 99.
   757             20  DC-MDCY-CEN           PIC 99.
   758             20  DC-MDCY-YEAR          PIC 99.
   759    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   760        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   761    12  DC-EL310-DATE                  PIC X(21).
   762    12  FILLER                         PIC X(28).
   763*    COPY ELCTEXT.
   764******************************************************************
   765*                                                                *
   766*                                                                *
   767*                            ELCTEXT.                            *
   768*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   769*                            VMOD=2.008                          *
   770*                                                                *
   771*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   772*                                     FORM LETTERS,              *
   773*                                     CERT FORM DISPLAY.
   774*                                                                *
   775*   FILE TYPE = VSAM,KSDS                                        *
   776*   RECORD SIZE = 100   RECFORM = FIXED                          *
   777*                                                                *
   778*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   779*       ALTERNATE INDEX = NONE                                   *
   780*                                                                *
   781*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   782*       ALTERNATE INDEX = NONE                                   *
   783*                                                                *
   784*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   785*       ALTERNATE INDEX = NONE                                   *
   786*                                                                *
   787*   LOG = NO                                                     *
   788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   789******************************************************************
   790 01  TEXT-FILES.
   791     12  TEXT-FILE-ID                PIC XX.
   792         88  FORMS-FILE-TEXT            VALUE 'TF'.
   793         88  LETTER-FILE-TEXT           VALUE 'TL'.
   794         88  HELP-FILE-TEXT             VALUE 'TH'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  16
* EL6317.cbl
   795
   796     12  TX-CONTROL-PRIMARY.
   797         16  TX-COMPANY-CD           PIC X.
   798             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   799         16  TX-ACCESS-CD-GENL       PIC X(12).
   800
   801         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   802             20  TX-LETTER-NO        PIC X(4).
   803             20  FILLER              PIC X(8).
   804
   805         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   806             20  TX-FORM-NO          PIC X(12).
   807
   808         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   809             20  TX-HELP-TYPE        PIC X.
   810                 88  HELP-FOR-GENERAL   VALUE ' '.
   811                 88  HELP-BY-SCREEN     VALUE 'S'.
   812                 88  HELP-BY-ERROR      VALUE 'E'.
   813             20  TX-SCREEN-OR-ERROR  PIC X(4).
   814                 88  GENERAL-INFO-HELP  VALUE '0000'.
   815             20  TX-HELP-FOR-COMPANY  PIC XXX.
   816                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   817             20  FILLER              PIC X(4).
   818
   819         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   820
   821     12  TX-PROCESS-CONTROL          PIC XX.
   822         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   823
   824     12  TX-TEXT-LINE                PIC X(70).
   825
   826     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   827         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   828         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   829         88  TX-VALID-FORM-SQUEEZE-VALUE
   830                                        VALUE 'Y' ' '.
   831
   832     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   833         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   834         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   835         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   836         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   837         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   838         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   839         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   840                                              'K' 'N' ' '
   841                                              'Z'.
   842
   843     12  TX-ARCHIVE-SW               PIC X.
   844         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   845         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   846         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   847
   848     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   849     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   850
   851     12  TX-BSR-CODE                 PIC X.
   852         88  TX-BSR-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  17
* EL6317.cbl
   853         88  TX-NON-BSR-LETTER          VALUE ' '.
   854
   855     12  FILLER                      PIC X.
   856*****************************************************************
   857*    COPY ELCLOGOF.
   858******************************************************************
   859*                                                                *
   860*                                                                *
   861*                            ELCLOGOF.                           *
   862*                            VMOD=2.001                          *
   863*                                                                *
   864*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   865*                                                                *
   866******************************************************************
   867 01  CLASIC-LOGOFF.
   868     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   869     12  LOGOFF-TEXT.
   870         16  FILLER          PIC X(5)    VALUE SPACES.
   871         16  LOGOFF-MSG.
   872             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   873             20  FILLER      PIC X       VALUE SPACES.
   874             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   875         16  FILLER          PIC X(80)
   876           VALUE '* YOU ARE NOW LOGGED OFF'.
   877         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   878         16  FILLER          PIC X       VALUE QUOTE.
   879         16  LOGOFF-SYS-MSG  PIC X(17)
   880           VALUE 'S CLAS-IC SYSTEM '.
   881     12  TEXT-MESSAGES.
   882         16  UNACCESS-MSG    PIC X(29)
   883             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   884         16  PGMIDERR-MSG    PIC X(17)
   885             VALUE 'PROGRAM NOT FOUND'.
   886*    COPY ELCATTR.
   887******************************************************************
   888*                                                                *
   889*                            ELCATTR.                            *
   890*                            VMOD=2.001                          *
   891*                                                                *
   892*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   893*                                                                *
   894*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   895*                                                                *
   896*                   POS 1   P=PROTECTED                          *
   897*                           U=UNPROTECTED                        *
   898*                           S=ASKIP                              *
   899*                   POS 2   A=ALPHA/NUMERIC                      *
   900*                           N=NUMERIC                            *
   901*                   POS 3   N=NORMAL                             *
   902*                           B=BRIGHT                             *
   903*                           D=DARK                               *
   904*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   905*                           OF=MODIFIED DATA TAG OFF             *
   906*                                                                *
   907*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   908******************************************************************
   909 01  ATTRIBUTE-LIST.
   910     12  AL-PABOF            PIC X       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  18
* EL6317.cbl
   911     12  AL-PABON            PIC X       VALUE 'Z'.
   912     12  AL-PADOF            PIC X       VALUE '%'.
   913     12  AL-PADON            PIC X       VALUE '_'.
   914     12  AL-PANOF            PIC X       VALUE '-'.
   915     12  AL-PANON            PIC X       VALUE '/'.
   916     12  AL-SABOF            PIC X       VALUE '8'.
   917     12  AL-SABON            PIC X       VALUE '9'.
   918     12  AL-SADOF            PIC X       VALUE '@'.
   919     12  AL-SADON            PIC X       VALUE QUOTE.
   920     12  AL-SANOF            PIC X       VALUE '0'.
   921     12  AL-SANON            PIC X       VALUE '1'.
   922     12  AL-UABOF            PIC X       VALUE 'H'.
   923     12  AL-UABON            PIC X       VALUE 'I'.
   924     12  AL-UADOF            PIC X       VALUE '<'.
   925     12  AL-UADON            PIC X       VALUE '('.
   926     12  AL-UANOF            PIC X       VALUE ' '.
   927     12  AL-UANON            PIC X       VALUE 'A'.
   928     12  AL-UNBOF            PIC X       VALUE 'Q'.
   929     12  AL-UNBON            PIC X       VALUE 'R'.
   930     12  AL-UNDOF            PIC X       VALUE '*'.
   931     12  AL-UNDON            PIC X       VALUE ')'.
   932     12  AL-UNNOF            PIC X       VALUE '&'.
   933     12  AL-UNNON            PIC X       VALUE 'J'.
   934*    COPY ELCEMIB.
   935******************************************************************
   936*                                                                *
   937*                                                                *
   938*                            ELCEMIB.                            *
   939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   940*                            VMOD=2.005                          *
   941*                                                                *
   942*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   943*                                                                *
   944******************************************************************
   945 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   946     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   947     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   948     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   949     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   950     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   951     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   952     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   953     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   954     12  EMI-SWITCH1             PIC X        VALUE '1'.
   955         88  EMI-NO-ERRORS                    VALUE '1'.
   956         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   957         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   958     12  EMI-SWITCH2             PIC X        VALUE '1'.
   959         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   960     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   961         88  EMI-AREA1-EMPTY                  VALUE '1'.
   962         88  EMI-AREA1-FULL                   VALUE '2'.
   963     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   964         88  EMI-AREA2-EMPTY                  VALUE '1'.
   965         88  EMI-AREA2-FULL                   VALUE '2'.
   966     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   967         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   968         88  EMI-BYPASS-NOTES                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  19
* EL6317.cbl
   969         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   970         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   971         88  EMI-BYPASS-FATALS                VALUE 'X'.
   972     12  EMI-ERROR-LINES.
   973         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   974         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   975         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   976         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   977             20  EMI-ERR-CODES OCCURS 10 TIMES.
   978                 24  EMI-ERR-NUM         PIC X(4).
   979                 24  EMI-FILLER          PIC X.
   980                 24  EMI-SEV             PIC X.
   981                 24  FILLER              PIC X.
   982             20  FILLER                  PIC X(02).
   983     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   984         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   985             20  EMI-ERROR-NUMBER    PIC X(4).
   986             20  EMI-FILL            PIC X.
   987             20  EMI-SEVERITY        PIC X.
   988             20  FILLER              PIC X.
   989             20  EMI-ERROR-TEXT.
   990                 24  EMI-TEXT-VARIABLE   PIC X(10).
   991                 24  FILLER          PIC X(55).
   992     12  EMI-SEVERITY-SAVE           PIC X.
   993         88  EMI-NOTE                    VALUE 'N'.
   994         88  EMI-WARNING                 VALUE 'W'.
   995         88  EMI-FORCABLE                VALUE 'F'.
   996         88  EMI-FATAL                   VALUE 'X'.
   997     12  EMI-MESSAGE-FLAG            PIC X.
   998         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   999         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1000     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1001     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1002         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1003         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1004         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1005     12  FILLER                      PIC X(137)  VALUE SPACES.
  1006     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1007     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1008     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1009     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1010*    COPY ELCINTF.
  1011******************************************************************
  1012*                                                                *
  1013*                                                                *
  1014*                            ELCINTF.                            *
  1015*                            VMOD=2.017                          *
  1016*                                                                *
  1017*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1018*                                                                *
  1019*       LENGTH = 1024                                            *
  1020*                                                                *
  1021******************************************************************
  1022*                   C H A N G E   L O G
  1023*
  1024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1025*-----------------------------------------------------------------
  1026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  20
* EL6317.cbl
  1027* EFFECTIVE    NUMBER
  1028*-----------------------------------------------------------------
  1029* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1030******************************************************************
  1031 01  PROGRAM-INTERFACE-BLOCK.
  1032     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1033     12  PI-CALLING-PROGRAM              PIC X(8).
  1034     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1035     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1036     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1038     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1039     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1040     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1041     12  PI-COMPANY-ID                   PIC XXX.
  1042     12  PI-COMPANY-CD                   PIC X.
  1043
  1044     12  PI-COMPANY-PASSWORD             PIC X(8).
  1045
  1046     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1047
  1048     12  PI-CONTROL-IN-PROGRESS.
  1049         16  PI-CARRIER                  PIC X.
  1050         16  PI-GROUPING                 PIC X(6).
  1051         16  PI-STATE                    PIC XX.
  1052         16  PI-ACCOUNT                  PIC X(10).
  1053         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1054                                         PIC X(10).
  1055         16  PI-CLAIM-CERT-GRP.
  1056             20  PI-CLAIM-NO             PIC X(7).
  1057             20  PI-CERT-NO.
  1058                 25  PI-CERT-PRIME       PIC X(10).
  1059                 25  PI-CERT-SFX         PIC X.
  1060             20  PI-CERT-EFF-DT          PIC XX.
  1061         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1062             20  PI-PLAN-CODE            PIC X(2).
  1063             20  PI-REVISION-NUMBER      PIC X(3).
  1064             20  PI-PLAN-EFF-DT          PIC X(2).
  1065             20  PI-PLAN-EXP-DT          PIC X(2).
  1066             20  FILLER                  PIC X(11).
  1067         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1068             20  PI-OE-REFERENCE-1.
  1069                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1070                 25  PI-OE-REF-1-SUFF    PIC XX.
  1071
  1072     12  PI-SESSION-IN-PROGRESS          PIC X.
  1073         88  CLAIM-SESSION                   VALUE '1'.
  1074         88  CREDIT-SESSION                  VALUE '2'.
  1075         88  WARRANTY-SESSION                VALUE '3'.
  1076         88  MORTGAGE-SESSION                VALUE '4'.
  1077         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1078
  1079
  1080*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1081
  1082     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1083     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1084
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  21
* EL6317.cbl
  1085     12  PI-CREDIT-USER                  PIC X.
  1086         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1087         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1088
  1089     12  PI-CLAIM-USER                   PIC X.
  1090         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1091         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1092
  1093     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1094         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1095         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1096         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1097         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1098         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1099
  1100     12  PI-PROCESSOR-ID                 PIC X(4).
  1101
  1102     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1103
  1104     12  PI-MEMBER-CAPTION               PIC X(10).
  1105
  1106     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1107         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1108
  1109     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1110     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1111     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1112     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1113
  1114     12  PI-AH-OVERRIDE-L1               PIC X.
  1115     12  PI-AH-OVERRIDE-L2               PIC XX.
  1116     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1117     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1118
  1119     12  PI-NEW-SYSTEM                   PIC X(2).
  1120
  1121     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1122     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1123         88  PI-USES-PAID-TO                 VALUE '1'.
  1124     12  PI-CRDTCRD-SYSTEM.
  1125         16  PI-CRDTCRD-USER             PIC X.
  1126             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1127             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1128         16  PI-CC-MONTH-END-DT          PIC XX.
  1129     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1130
  1131     12  PI-OE-REFERENCE-2.
  1132         16  PI-OE-REF-2-PRIME           PIC X(10).
  1133         16  PI-OE-REF-2-SUFF            PIC X.
  1134
  1135     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1136
  1137     12  PI-LANGUAGE-TYPE                PIC X.
  1138             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1139             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1140             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1141
  1142     12  PI-POLICY-LINKAGE-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  22
* EL6317.cbl
  1143         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1144         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1145                                                   LOW-VALUES.
  1146
  1147     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1148     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1149         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1150         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1151
  1152     12  PI-PROCESSOR-CSR-IND            PIC X.
  1153         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1154         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1155
  1156     12  FILLER                          PIC X(3).
  1157
  1158     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1159
  1160     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1161         PI-SYSTEM-LEVEL.
  1162
  1163         16  PI-ENTRY-CODES.
  1164             20  PI-ENTRY-CD-1           PIC X.
  1165             20  PI-ENTRY-CD-2           PIC X.
  1166
  1167         16  PI-RETURN-CODES.
  1168             20  PI-RETURN-CD-1          PIC X.
  1169             20  PI-RETURN-CD-2          PIC X.
  1170
  1171         16  PI-UPDATE-STATUS-SAVE.
  1172             20  PI-UPDATE-BY            PIC X(4).
  1173             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1174
  1175         16  PI-LOWER-CASE-LETTERS       PIC X.
  1176             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1177
  1178*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1179*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1180*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1181
  1182         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1183             88  ST-ACCNT-CNTL               VALUE ' '.
  1184             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1185             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1186             88  ACCNT-CNTL                  VALUE '3'.
  1187             88  CARR-ACCNT-CNTL             VALUE '4'.
  1188
  1189         16  PI-PROCESSOR-CAP-LIST.
  1190             20  PI-SYSTEM-CONTROLS.
  1191                24 PI-SYSTEM-DISPLAY     PIC X.
  1192                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1193                24 PI-SYSTEM-MODIFY      PIC X.
  1194                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1195             20  FILLER                  PIC XX.
  1196             20  PI-DISPLAY-CAP          PIC X.
  1197                 88  DISPLAY-CAP             VALUE 'Y'.
  1198             20  PI-MODIFY-CAP           PIC X.
  1199                 88  MODIFY-CAP              VALUE 'Y'.
  1200             20  PI-MSG-AT-LOGON-CAP     PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  23
* EL6317.cbl
  1201                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1202             20  PI-FORCE-CAP            PIC X.
  1203                 88  FORCE-CAP               VALUE 'Y'.
  1204
  1205         16  PI-PROGRAM-CONTROLS.
  1206             20  PI-PGM-PRINT-OPT        PIC X.
  1207             20  PI-PGM-FORMAT-OPT       PIC X.
  1208             20  PI-PGM-PROCESS-OPT      PIC X.
  1209             20  PI-PGM-TOTALS-OPT       PIC X.
  1210
  1211         16  PI-HELP-INTERFACE.
  1212             20  PI-LAST-ERROR-NO        PIC X(4).
  1213             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1214
  1215         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1216             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1217
  1218         16  PI-CR-CONTROL-IN-PROGRESS.
  1219             20  PI-CR-CARRIER           PIC X.
  1220             20  PI-CR-GROUPING          PIC X(6).
  1221             20  PI-CR-STATE             PIC XX.
  1222             20  PI-CR-ACCOUNT           PIC X(10).
  1223             20  PI-CR-FIN-RESP          PIC X(10).
  1224             20  PI-CR-TYPE              PIC X.
  1225
  1226         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1227
  1228         16  PI-CR-MONTH-END-DT          PIC XX.
  1229
  1230         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1231             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1232             88  PI-ZERO-CARRIER             VALUE '1'.
  1233             88  PI-ZERO-GROUPING            VALUE '2'.
  1234             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1235
  1236         16  PI-CARRIER-SECURITY         PIC X.
  1237             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1238
  1239         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1240             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1241             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1242
  1243         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1244             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1245                                         INDEXED BY PI-ACCESS-NDX
  1246                                         PIC X.
  1247
  1248         16  PI-GA-BILLING-CONTROL       PIC X.
  1249             88  PI-GA-BILLING               VALUE '1'.
  1250
  1251         16  PI-MAIL-PROCESSING          PIC X.
  1252             88  PI-MAIL-YES                 VALUE 'Y'.
  1253
  1254         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1255
  1256         16  PI-AR-SYSTEM.
  1257             20  PI-AR-PROCESSING-CNTL   PIC X.
  1258                 88  PI-AR-PROCESSING        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  24
* EL6317.cbl
  1259             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1260             20  PI-AR-MONTH-END-DT      PIC XX.
  1261
  1262         16  PI-MP-SYSTEM.
  1263             20  PI-MORTGAGE-USER            PIC X.
  1264                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1265                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1266             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1267                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1268                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1269                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1270                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1271                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1272             20  PI-MP-MONTH-END-DT          PIC XX.
  1273             20  PI-MP-REFERENCE-NO.
  1274                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1275                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1276
  1277         16  PI-LABEL-CONTROL            PIC X(01).
  1278             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1279             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1280
  1281         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1282             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1283
  1284         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1285             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1286             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1287
  1288         16  FILLER                      PIC X(14).
  1289
  1290     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1291******************************************************************
  1292     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1293        16  PI-ISS-CAN-SW           PIC X.
  1294        16  PI-ERENDT-KEY.
  1295            20  PI-ENDT-COMPANY-CD  PIC X.
  1296            20  PI-ENDT-CARRIER     PIC X.
  1297            20  PI-ENDT-GROUPING    PIC X(6).
  1298            20  PI-ENDT-STATE       PIC XX.
  1299            20  PI-ENDT-ACCOUNT     PIC X(10).
  1300            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1301            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1302            20  PI-ENDT-CERT-SFX    PIC X.
  1303            20  PI-ENDT-RECORD-TYPE PIC X.
  1304            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1305        16  PI-ELCRTO-KEY.
  1306            20  PI-CRTO-COMPANY-CD  PIC X.
  1307            20  PI-CRTO-CARRIER     PIC X.
  1308            20  PI-CRTO-GROUPING    PIC X(6).
  1309            20  PI-CRTO-STATE       PIC XX.
  1310            20  PI-CRTO-ACCOUNT     PIC X(10).
  1311            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1312            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1313            20  PI-CRTO-CERT-SFX    PIC X.
  1314            20  PI-CRTO-RECORD-TYPE PIC X.
  1315            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1316        16  PI-ERPNDB-KEY           PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  25
* EL6317.cbl
  1317        16  PI-DOCUMENT-PROCESSED   PIC X.
  1318            88  PI-VERI-PROCESSED      VALUE 'V'.
  1319            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1320        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1321        16  PI-RES-REF-CLM-TYPE     PIC X.
  1322        16  PI-CLM-REFORM-IND       PIC X.
  1323        16  PI-CLEAR-ERROR-SW       PIC X.
  1324            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1325        16  PI-PRINT-CERTIFICATE    PIC X.
  1326        16  PI-ENTERED.
  1327            20  PI-PRTSW-ENTERED    PIC X.
  1328            20  PI-SIGREQ-ENTERED   PIC X.
  1329            20  PI-MONEY-ENTERED    PIC X.
  1330            20  PI-LTRID-ENTERED    PIC X(4).
  1331            20  PI-REASONS-ENTERED  PIC X(84).
  1332            20  PI-CERTNT1-ENTERED  PIC X(63).
  1333            20  PI-CERTNT2-ENTERED  PIC X(63).
  1334        16  FILLER                  PIC X(17).
  1335        16  PI-FINALIZED-IND        PIC X.
  1336        16  PI-BILLNT1-ENTERED      PIC X(63).
  1337        16  PI-BILLNT2-ENTERED      PIC X(63).
  1338        16  FILLER                  PIC X(154).
  1339    12  FILLER                      PIC X(276).
  1340*    COPY ELCAID.
  1341******************************************************************
  1342*                                                                *
  1343*                            ELCAID.                             *
  1344*                            VMOD=2.001                          *
  1345*                                                                *
  1346*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1347*                                                                *
  1348*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1349*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1350******************************************************************
  1351
  1352 01  DFHAID.
  1353   02  DFHNULL   PIC  X  VALUE  ' '.
  1354   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1355   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1356   02  DFHPEN    PIC  X  VALUE  '='.
  1357   02  DFHOPID   PIC  X  VALUE  'W'.
  1358   02  DFHPA1    PIC  X  VALUE  '%'.
  1359   02  DFHPA2    PIC  X  VALUE  '>'.
  1360   02  DFHPA3    PIC  X  VALUE  ','.
  1361   02  DFHPF1    PIC  X  VALUE  '1'.
  1362   02  DFHPF2    PIC  X  VALUE  '2'.
  1363   02  DFHPF3    PIC  X  VALUE  '3'.
  1364   02  DFHPF4    PIC  X  VALUE  '4'.
  1365   02  DFHPF5    PIC  X  VALUE  '5'.
  1366   02  DFHPF6    PIC  X  VALUE  '6'.
  1367   02  DFHPF7    PIC  X  VALUE  '7'.
  1368   02  DFHPF8    PIC  X  VALUE  '8'.
  1369   02  DFHPF9    PIC  X  VALUE  '9'.
  1370   02  DFHPF10   PIC  X  VALUE  ':'.
  1371   02  DFHPF11   PIC  X  VALUE  '#'.
  1372   02  DFHPF12   PIC  X  VALUE  '@'.
  1373   02  DFHPF13   PIC  X  VALUE  'A'.
  1374   02  DFHPF14   PIC  X  VALUE  'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  26
* EL6317.cbl
  1375   02  DFHPF15   PIC  X  VALUE  'C'.
  1376   02  DFHPF16   PIC  X  VALUE  'D'.
  1377   02  DFHPF17   PIC  X  VALUE  'E'.
  1378   02  DFHPF18   PIC  X  VALUE  'F'.
  1379   02  DFHPF19   PIC  X  VALUE  'G'.
  1380   02  DFHPF20   PIC  X  VALUE  'H'.
  1381   02  DFHPF21   PIC  X  VALUE  'I'.
  1382*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1383   02  DFHPF22   PIC  X  VALUE  '['.
  1384   02  DFHPF23   PIC  X  VALUE  '.'.
  1385   02  DFHPF24   PIC  X  VALUE  '<'.
  1386   02  DFHMSRE   PIC  X  VALUE  'X'.
  1387   02  DFHSTRF   PIC  X  VALUE  'h'.
  1388   02  DFHTRIG   PIC  X  VALUE  '"'.
  1389 01  FILLER    REDEFINES DFHAID.
  1390     12  FILLER              PIC X(8).
  1391     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1392*   COPY EL6317S.
  1393 01  EL631JI.
  1394     05  FILLER            PIC  X(0012).
  1395*    -------------------------------
  1396     05  DATEL PIC S9(0004) COMP.
  1397     05  DATEF PIC  X(0001).
  1398     05  FILLER REDEFINES DATEF.
  1399         10  DATEA PIC  X(0001).
  1400     05  DATEI PIC  X(0008).
  1401*    -------------------------------
  1402     05  TIMEL PIC S9(0004) COMP.
  1403     05  TIMEF PIC  X(0001).
  1404     05  FILLER REDEFINES TIMEF.
  1405         10  TIMEA PIC  X(0001).
  1406     05  TIMEI PIC  X(0005).
  1407*    -------------------------------
  1408     05  PROCIDL PIC S9(0004) COMP.
  1409     05  PROCIDF PIC  X(0001).
  1410     05  FILLER REDEFINES PROCIDF.
  1411         10  PROCIDA PIC  X(0001).
  1412     05  PROCIDI PIC  X(0004).
  1413*    -------------------------------
  1414     05  HOSTL PIC S9(0004) COMP.
  1415     05  HOSTF PIC  X(0001).
  1416     05  FILLER REDEFINES HOSTF.
  1417         10  HOSTA PIC  X(0001).
  1418     05  HOSTI PIC  X(0009).
  1419*    -------------------------------
  1420     05  SYSL PIC S9(0004) COMP.
  1421     05  SYSF PIC  X(0001).
  1422     05  FILLER REDEFINES SYSF.
  1423         10  SYSA PIC  X(0001).
  1424     05  SYSI PIC  X(0005).
  1425*    -------------------------------
  1426     05  COMPANYL PIC S9(0004) COMP.
  1427     05  COMPANYF PIC  X(0001).
  1428     05  FILLER REDEFINES COMPANYF.
  1429         10  COMPANYA PIC  X(0001).
  1430     05  COMPANYI PIC  X(0003).
  1431*    -------------------------------
  1432     05  DATASORL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  27
* EL6317.cbl
  1433     05  DATASORF PIC  X(0001).
  1434     05  FILLER REDEFINES DATASORF.
  1435         10  DATASORA PIC  X(0001).
  1436     05  DATASORI PIC  X(0001).
  1437*    -------------------------------
  1438     05  BATCHNOL PIC S9(0004) COMP.
  1439     05  BATCHNOF PIC  X(0001).
  1440     05  FILLER REDEFINES BATCHNOF.
  1441         10  BATCHNOA PIC  X(0001).
  1442     05  BATCHNOI PIC  X(0006).
  1443*    -------------------------------
  1444     05  BSEQNOL PIC S9(0004) COMP.
  1445     05  BSEQNOF PIC  X(0001).
  1446     05  FILLER REDEFINES BSEQNOF.
  1447         10  BSEQNOA PIC  X(0001).
  1448     05  BSEQNOI PIC  X(0008).
  1449*    -------------------------------
  1450     05  ARCHNOL PIC S9(0004) COMP.
  1451     05  ARCHNOF PIC  X(0001).
  1452     05  FILLER REDEFINES ARCHNOF.
  1453         10  ARCHNOA PIC  X(0001).
  1454     05  ARCHNOI PIC  X(0008).
  1455*    -------------------------------
  1456     05  PRTSWL PIC S9(0004) COMP.
  1457     05  PRTSWF PIC  X(0001).
  1458     05  FILLER REDEFINES PRTSWF.
  1459         10  PRTSWA PIC  X(0001).
  1460     05  PRTSWI PIC  X(0001).
  1461*    -------------------------------
  1462     05  CARRL PIC S9(0004) COMP.
  1463     05  CARRF PIC  X(0001).
  1464     05  FILLER REDEFINES CARRF.
  1465         10  CARRA PIC  X(0001).
  1466     05  CARRI PIC  X(0001).
  1467*    -------------------------------
  1468     05  GROUPL PIC S9(0004) COMP.
  1469     05  GROUPF PIC  X(0001).
  1470     05  FILLER REDEFINES GROUPF.
  1471         10  GROUPA PIC  X(0001).
  1472     05  GROUPI PIC  X(0006).
  1473*    -------------------------------
  1474     05  STATEL PIC S9(0004) COMP.
  1475     05  STATEF PIC  X(0001).
  1476     05  FILLER REDEFINES STATEF.
  1477         10  STATEA PIC  X(0001).
  1478     05  STATEI PIC  X(0002).
  1479*    -------------------------------
  1480     05  ACCTL PIC S9(0004) COMP.
  1481     05  ACCTF PIC  X(0001).
  1482     05  FILLER REDEFINES ACCTF.
  1483         10  ACCTA PIC  X(0001).
  1484     05  ACCTI PIC  X(0010).
  1485*    -------------------------------
  1486     05  EFFDTL PIC S9(0004) COMP.
  1487     05  EFFDTF PIC  X(0001).
  1488     05  FILLER REDEFINES EFFDTF.
  1489         10  EFFDTA PIC  X(0001).
  1490     05  EFFDTI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  28
* EL6317.cbl
  1491*    -------------------------------
  1492     05  CERTNOL PIC S9(0004) COMP.
  1493     05  CERTNOF PIC  X(0001).
  1494     05  FILLER REDEFINES CERTNOF.
  1495         10  CERTNOA PIC  X(0001).
  1496     05  CERTNOI PIC  X(0010).
  1497*    -------------------------------
  1498     05  CRTSFXL PIC S9(0004) COMP.
  1499     05  CRTSFXF PIC  X(0001).
  1500     05  FILLER REDEFINES CRTSFXF.
  1501         10  CRTSFXA PIC  X(0001).
  1502     05  CRTSFXI PIC  X(0001).
  1503*    -------------------------------
  1504     05  SEQNOL PIC S9(0004) COMP.
  1505     05  SEQNOF PIC  X(0001).
  1506     05  FILLER REDEFINES SEQNOF.
  1507         10  SEQNOA PIC  X(0001).
  1508     05  SEQNOI PIC  X(0006).
  1509*    -------------------------------
  1510     05  SIGREQL PIC S9(0004) COMP.
  1511     05  SIGREQF PIC  X(0001).
  1512     05  FILLER REDEFINES SIGREQF.
  1513         10  SIGREQA PIC  X(0001).
  1514     05  SIGREQI PIC  X(0001).
  1515*    -------------------------------
  1516     05  LTRIDL PIC S9(0004) COMP.
  1517     05  LTRIDF PIC  X(0001).
  1518     05  FILLER REDEFINES LTRIDF.
  1519         10  LTRIDA PIC  X(0001).
  1520     05  LTRIDI PIC  X(0004).
  1521*    -------------------------------
  1522     05  RCD01L PIC S9(0004) COMP.
  1523     05  RCD01F PIC  X(0001).
  1524     05  FILLER REDEFINES RCD01F.
  1525         10  RCD01A PIC  X(0001).
  1526     05  RCD01I PIC  X(0004).
  1527*    -------------------------------
  1528     05  RCD02L PIC S9(0004) COMP.
  1529     05  RCD02F PIC  X(0001).
  1530     05  FILLER REDEFINES RCD02F.
  1531         10  RCD02A PIC  X(0001).
  1532     05  RCD02I PIC  X(0004).
  1533*    -------------------------------
  1534     05  RCD03L PIC S9(0004) COMP.
  1535     05  RCD03F PIC  X(0001).
  1536     05  FILLER REDEFINES RCD03F.
  1537         10  RCD03A PIC  X(0001).
  1538     05  RCD03I PIC  X(0004).
  1539*    -------------------------------
  1540     05  RCD04L PIC S9(0004) COMP.
  1541     05  RCD04F PIC  X(0001).
  1542     05  FILLER REDEFINES RCD04F.
  1543         10  RCD04A PIC  X(0001).
  1544     05  RCD04I PIC  X(0004).
  1545*    -------------------------------
  1546     05  RCD05L PIC S9(0004) COMP.
  1547     05  RCD05F PIC  X(0001).
  1548     05  FILLER REDEFINES RCD05F.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  29
* EL6317.cbl
  1549         10  RCD05A PIC  X(0001).
  1550     05  RCD05I PIC  X(0004).
  1551*    -------------------------------
  1552     05  RCD06L PIC S9(0004) COMP.
  1553     05  RCD06F PIC  X(0001).
  1554     05  FILLER REDEFINES RCD06F.
  1555         10  RCD06A PIC  X(0001).
  1556     05  RCD06I PIC  X(0004).
  1557*    -------------------------------
  1558     05  RCD07L PIC S9(0004) COMP.
  1559     05  RCD07F PIC  X(0001).
  1560     05  FILLER REDEFINES RCD07F.
  1561         10  RCD07A PIC  X(0001).
  1562     05  RCD07I PIC  X(0004).
  1563*    -------------------------------
  1564     05  RCD08L PIC S9(0004) COMP.
  1565     05  RCD08F PIC  X(0001).
  1566     05  FILLER REDEFINES RCD08F.
  1567         10  RCD08A PIC  X(0001).
  1568     05  RCD08I PIC  X(0004).
  1569*    -------------------------------
  1570     05  RCD09L PIC S9(0004) COMP.
  1571     05  RCD09F PIC  X(0001).
  1572     05  FILLER REDEFINES RCD09F.
  1573         10  RCD09A PIC  X(0001).
  1574     05  RCD09I PIC  X(0004).
  1575*    -------------------------------
  1576     05  RCD10L PIC S9(0004) COMP.
  1577     05  RCD10F PIC  X(0001).
  1578     05  FILLER REDEFINES RCD10F.
  1579         10  RCD10A PIC  X(0001).
  1580     05  RCD10I PIC  X(0004).
  1581*    -------------------------------
  1582     05  RCD11L PIC S9(0004) COMP.
  1583     05  RCD11F PIC  X(0001).
  1584     05  FILLER REDEFINES RCD11F.
  1585         10  RCD11A PIC  X(0001).
  1586     05  RCD11I PIC  X(0004).
  1587*    -------------------------------
  1588     05  RCD12L PIC S9(0004) COMP.
  1589     05  RCD12F PIC  X(0001).
  1590     05  FILLER REDEFINES RCD12F.
  1591         10  RCD12A PIC  X(0001).
  1592     05  RCD12I PIC  X(0004).
  1593*    -------------------------------
  1594     05  CRTNT1L PIC S9(0004) COMP.
  1595     05  CRTNT1F PIC  X(0001).
  1596     05  FILLER REDEFINES CRTNT1F.
  1597         10  CRTNT1A PIC  X(0001).
  1598     05  CRTNT1I PIC  X(0063).
  1599*    -------------------------------
  1600     05  CRTNT2L PIC S9(0004) COMP.
  1601     05  CRTNT2F PIC  X(0001).
  1602     05  FILLER REDEFINES CRTNT2F.
  1603         10  CRTNT2A PIC  X(0001).
  1604     05  CRTNT2I PIC  X(0063).
  1605*    -------------------------------
  1606     05  BILNT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  30
* EL6317.cbl
  1607     05  BILNT1F PIC  X(0001).
  1608     05  FILLER REDEFINES BILNT1F.
  1609         10  BILNT1A PIC  X(0001).
  1610     05  BILNT1I PIC  X(0063).
  1611*    -------------------------------
  1612     05  BILNT2L PIC S9(0004) COMP.
  1613     05  BILNT2F PIC  X(0001).
  1614     05  FILLER REDEFINES BILNT2F.
  1615         10  BILNT2A PIC  X(0001).
  1616     05  BILNT2I PIC  X(0063).
  1617*    -------------------------------
  1618     05  ERRMSG1L PIC S9(0004) COMP.
  1619     05  ERRMSG1F PIC  X(0001).
  1620     05  FILLER REDEFINES ERRMSG1F.
  1621         10  ERRMSG1A PIC  X(0001).
  1622     05  ERRMSG1I PIC  X(0075).
  1623*    -------------------------------
  1624     05  ERRMSG2L PIC S9(0004) COMP.
  1625     05  ERRMSG2F PIC  X(0001).
  1626     05  FILLER REDEFINES ERRMSG2F.
  1627         10  ERRMSG2A PIC  X(0001).
  1628     05  ERRMSG2I PIC  X(0075).
  1629*    -------------------------------
  1630     05  PFENTRL PIC S9(0004) COMP.
  1631     05  PFENTRF PIC  X(0001).
  1632     05  FILLER REDEFINES PFENTRF.
  1633         10  PFENTRA PIC  X(0001).
  1634     05  PFENTRI PIC  9(2).
  1635 01  EL631JO REDEFINES EL631JI.
  1636     05  FILLER            PIC  X(0012).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  DATEO PIC  X(0008).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  TIMEO PIC  99.99.
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  PROCIDO PIC  X(0004).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  HOSTO PIC  X(0009).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  SYSO PIC  X(0005).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  COMPANYO PIC  X(0003).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  DATASORO PIC  X(0001).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  BATCHNOO PIC  X(0006).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  BSEQNOO PIC  X(0008).
  1664*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  31
* EL6317.cbl
  1665     05  FILLER            PIC  X(0003).
  1666     05  ARCHNOO PIC  X(0008).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  PRTSWO PIC  X(0001).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  CARRO PIC  X(0001).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  GROUPO PIC  X(0006).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  STATEO PIC  X(0002).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  ACCTO PIC  X(0010).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  EFFDTO PIC  X(0008).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  CERTNOO PIC  X(0010).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  CRTSFXO PIC  X(0001).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  SEQNOO PIC  999999.
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  SIGREQO PIC  X(0001).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  LTRIDO PIC  X(0004).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  RCD01O PIC  X(0004).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  RCD02O PIC  X(0004).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  RCD03O PIC  X(0004).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  RCD04O PIC  X(0004).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  RCD05O PIC  X(0004).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  RCD06O PIC  X(0004).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  RCD07O PIC  X(0004).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  32
* EL6317.cbl
  1723     05  RCD08O PIC  X(0004).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  RCD09O PIC  X(0004).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RCD10O PIC  X(0004).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  RCD11O PIC  X(0004).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  RCD12O PIC  X(0004).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  CRTNT1O PIC  X(0063).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CRTNT2O PIC  X(0063).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  BILNT1O PIC  X(0063).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  BILNT2O PIC  X(0063).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  ERRMSG1O PIC  X(0075).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  ERRMSG2O PIC  X(0075).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  PFENTRO PIC  X(0002).
  1757*    -------------------------------
  1758 01  filler redefines el631ji.
  1759     12  filler                   pic x(182).
  1760     12  REASONCDS.
  1761         16  filler occurs 12.
  1762             20  reacdl       pic s9(4) comp.
  1763             20  reacda       pic x.
  1764             20  reacd-in     pic x(4).
  1765    12  FILLER                   PIC X(293).
  1766****************************************************************
  1767*
  1768* Copyright (c) 2007 by Clerity Solutions, Inc.
  1769* All rights reserved.
  1770*
  1771****************************************************************
  1772 01  DFHEIV.
  1773   02  DFHEIV0               PIC X(35).
  1774   02  DFHEIV1               PIC X(08).
  1775   02  DFHEIV2               PIC X(08).
  1776   02  DFHEIV3               PIC X(08).
  1777   02  DFHEIV4               PIC X(06).
  1778   02  DFHEIV5               PIC X(04).
  1779   02  DFHEIV6               PIC X(04).
  1780   02  DFHEIV7               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  33
* EL6317.cbl
  1781   02  DFHEIV8               PIC X(02).
  1782   02  DFHEIV9               PIC X(01).
  1783   02  DFHEIV10              PIC S9(7) COMP-3.
  1784   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1785   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1786   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1787   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1788   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1789   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1790   02  DFHEIV17              PIC X(04).
  1791   02  DFHEIV18              PIC X(04).
  1792   02  DFHEIV19              PIC X(04).
  1793   02  DFHEIV20              USAGE IS POINTER.
  1794   02  DFHEIV21              USAGE IS POINTER.
  1795   02  DFHEIV22              USAGE IS POINTER.
  1796   02  DFHEIV23              USAGE IS POINTER.
  1797   02  DFHEIV24              USAGE IS POINTER.
  1798   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1799   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1800   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1801   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1802   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1803   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1804   02  FILLER                PIC X(02).
  1805   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1806   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1807   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1808   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1809   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1810 LINKAGE  SECTION.
  1811*****************************************************************
  1812*                                                               *
  1813* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1814* All rights reserved.                                          *
  1815*                                                               *
  1816*****************************************************************
  1817 01  dfheiblk.
  1818     02  eibtime          pic s9(7) comp-3.
  1819     02  eibdate          pic s9(7) comp-3.
  1820     02  eibtrnid         pic x(4).
  1821     02  eibtaskn         pic s9(7) comp-3.
  1822     02  eibtrmid         pic x(4).
  1823     02  dfheigdi         pic s9(4) comp.
  1824     02  eibcposn         pic s9(4) comp.
  1825     02  eibcalen         pic s9(4) comp.
  1826     02  eibaid           pic x(1).
  1827     02  eibfiller1       pic x(1).
  1828     02  eibfn            pic x(2).
  1829     02  eibfiller2       pic x(2).
  1830     02  eibrcode         pic x(6).
  1831     02  eibfiller3       pic x(2).
  1832     02  eibds            pic x(8).
  1833     02  eibreqid         pic x(8).
  1834     02  eibrsrce         pic x(8).
  1835     02  eibsync          pic x(1).
  1836     02  eibfree          pic x(1).
  1837     02  eibrecv          pic x(1).
  1838     02  eibsend          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  34
* EL6317.cbl
  1839     02  eibatt           pic x(1).
  1840     02  eibeoc           pic x(1).
  1841     02  eibfmh           pic x(1).
  1842     02  eibcompl         pic x(1).
  1843     02  eibsig           pic x(1).
  1844     02  eibconf          pic x(1).
  1845     02  eiberr           pic x(1).
  1846     02  eibrldbk         pic x(1).
  1847     02  eiberrcd         pic x(4).
  1848     02  eibsynrb         pic x(1).
  1849     02  eibnodat         pic x(1).
  1850     02  eibfiller5       pic x(2).
  1851     02  eibresp          pic 9(09) comp.
  1852     02  eibresp2         pic 9(09) comp.
  1853     02  dfheigdj         pic s9(4) comp.
  1854     02  dfheigdk         pic s9(4) comp.
  1855 01  DFHCOMMAREA                 PIC X(1300).
  1856 01  var  pic x(30).
  1857*                                COPY ERCACCT.
  1858******************************************************************
  1859*                                                                *
  1860*                                                                *
  1861*                            ERCACCT                             *
  1862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1863*                            VMOD=2.031                          *
  1864*                                                                *
  1865*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1866*                                                                *
  1867*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1868*   VSAM ACCOUNT MASTER FILES.                                   *
  1869*                                                                *
  1870*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1871*                                                                *
  1872*   FILE TYPE = VSAM,KSDS                                        *
  1873*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1874*                                                                *
  1875*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1876*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1877*                                                                *
  1878*   LOG = NO                                                     *
  1879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1880*                                                                *
  1881*                                                                *
  1882******************************************************************
  1883*                   C H A N G E   L O G
  1884*
  1885* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1886*-----------------------------------------------------------------
  1887*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1888* EFFECTIVE    NUMBER
  1889*-----------------------------------------------------------------
  1890* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1891* 092705    2005050300006  PEMA  ADD SPP LEASES
  1892* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1893* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1894* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1895* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1896* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  35
* EL6317.cbl
  1897******************************************************************
  1898
  1899 01  ACCOUNT-MASTER.
  1900     12  AM-RECORD-ID                      PIC XX.
  1901         88  VALID-AM-ID                      VALUE 'AM'.
  1902
  1903     12  AM-CONTROL-PRIMARY.
  1904         16  AM-COMPANY-CD                 PIC X.
  1905         16  AM-MSTR-CNTRL.
  1906             20  AM-CONTROL-A.
  1907                 24  AM-CARRIER            PIC X.
  1908                 24  AM-GROUPING.
  1909                     28 AM-GROUPING-PREFIX PIC XXX.
  1910                     28 AM-GROUPING-PRIME  PIC XXX.
  1911                 24  AM-STATE              PIC XX.
  1912                 24  AM-ACCOUNT.
  1913                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1914                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1915             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1916                                           PIC X(19).
  1917             20  AM-CNTRL-B.
  1918                 24  AM-EXPIRATION-DT      PIC XX.
  1919                 24  FILLER                PIC X(4).
  1920             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1921                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1922
  1923     12  AM-CONTROL-BY-VAR-GRP.
  1924         16  AM-COMPANY-CD-A1              PIC X.
  1925         16  AM-VG-CARRIER                 PIC X.
  1926         16  AM-VG-GROUPING                PIC X(6).
  1927         16  AM-VG-STATE                   PIC XX.
  1928         16  AM-VG-ACCOUNT                 PIC X(10).
  1929         16  AM-VG-DATE.
  1930             20  AM-VG-EXPIRATION-DT       PIC XX.
  1931             20  FILLER                    PIC X(4).
  1932         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1933                                           PIC 9(11)      COMP-3.
  1934     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1935         16  FILLER                        PIC X(10).
  1936         16  AM-VG-KEY3.
  1937             20  AM-VG3-ACCOUNT            PIC X(10).
  1938             20  AM-VG3-EXP-DT             PIC XX.
  1939         16  FILLER                        PIC X(4).
  1940     12  AM-MAINT-INFORMATION.
  1941         16  AM-LAST-MAINT-DT              PIC XX.
  1942         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1943         16  AM-LAST-MAINT-USER            PIC X(4).
  1944         16  FILLER                        PIC XX.
  1945
  1946     12  AM-EFFECTIVE-DT                   PIC XX.
  1947     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1948
  1949     12  AM-PREV-DATES  COMP-3.
  1950         16  AM-PREV-EXP-DT                PIC 9(11).
  1951         16  AM-PREV-EFF-DT                PIC 9(11).
  1952
  1953     12  AM-REPORT-CODE-1                  PIC X(10).
  1954     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  36
* EL6317.cbl
  1955
  1956     12  AM-CITY-CODE                      PIC X(4).
  1957     12  AM-COUNTY-PARISH                  PIC X(6).
  1958
  1959     12  AM-NAME                           PIC X(30).
  1960     12  AM-PERSON                         PIC X(30).
  1961     12  AM-ADDRS                          PIC X(30).
  1962     12  AM-CITY.
  1963         16  AM-ADDR-CITY                  PIC X(28).
  1964         16  AM-ADDR-STATE                 PIC XX.
  1965     12  AM-ZIP.
  1966         16  AM-ZIP-PRIME.
  1967             20  AM-ZIP-PRI-1ST            PIC X.
  1968                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1969             20  FILLER                    PIC X(4).
  1970         16  AM-ZIP-PLUS4                  PIC X(4).
  1971     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1972         16  AM-CAN-POSTAL-1               PIC XXX.
  1973         16  AM-CAN-POSTAL-2               PIC XXX.
  1974         16  FILLER                        PIC XXX.
  1975     12  AM-TEL-NO.
  1976         16  AM-AREA-CODE                  PIC 999.
  1977         16  AM-TEL-PRE                    PIC 999.
  1978         16  AM-TEL-NBR                    PIC 9(4).
  1979     12  AM-TEL-LOC                        PIC X.
  1980         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1981         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1982
  1983     12  AM-COMM-STRUCTURE.
  1984         16  AM-DEFN-1.
  1985             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1986                 24  AM-AGT.
  1987                     28  AM-AGT-PREFIX     PIC X(4).
  1988                     28  AM-AGT-PRIME      PIC X(6).
  1989                 24  AM-COM-TYP            PIC X.
  1990                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1991                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1992                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1993                 24  AM-RECALC-LV-INDIC    PIC X.
  1994                 24  AM-RETRO-LV-INDIC     PIC X.
  1995                 24  AM-GL-CODES           PIC X.
  1996                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1997                 24  FILLER                PIC X(01).
  1998         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1999             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2000                 24  FILLER                PIC X(11).
  2001                 24  AM-L-COMA             PIC XXX.
  2002                 24  AM-J-COMA             PIC XXX.
  2003                 24  AM-A-COMA             PIC XXX.
  2004                 24  FILLER                PIC X(6).
  2005
  2006     12  AM-COMM-CHANGE-STATUS             PIC X.
  2007         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2008
  2009     12  AM-CSR-CODE                       PIC X(4).
  2010
  2011     12  AM-BILLING-STATUS                 PIC X.
  2012         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  37
* EL6317.cbl
  2013         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2014     12  AM-AUTO-REFUND-SW                 PIC X.
  2015         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2016         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2017     12  AM-GPCD                           PIC 99.
  2018     12  AM-IG                             PIC X.
  2019         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2020         88  AM-HAS-GROUP                     VALUE '2'.
  2021     12  AM-STATUS                         PIC X.
  2022         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2023         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2024         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2025         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2026         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2027         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2028     12  AM-REMIT-TO                       PIC 99.
  2029     12  AM-ID-NO                          PIC X(11).
  2030
  2031     12  AM-CAL-TABLE                      PIC XX.
  2032     12  AM-LF-DEVIATION                   PIC XXX.
  2033     12  AM-AH-DEVIATION                   PIC XXX.
  2034     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2035     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2036     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2037     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2038     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2039     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2040
  2041     12  AM-USER-FIELDS.
  2042         16  AM-FLD-1                      PIC XX.
  2043         16  AM-FLD-2                      PIC XX.
  2044         16  AM-FLD-3                      PIC XX.
  2045         16  AM-FLD-4                      PIC XX.
  2046         16  AM-FLD-5                      PIC XX.
  2047
  2048     12  AM-1ST-PROD-DATE.
  2049         16  AM-1ST-PROD-YR                PIC XX.
  2050         16  AM-1ST-PROD-MO                PIC XX.
  2051         16  AM-1ST-PROD-DA                PIC XX.
  2052     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2053     12  AM-CERTS-PURGED-DATE.
  2054         16  AM-PUR-YR                     PIC XX.
  2055         16  AM-PUR-MO                     PIC XX.
  2056         16  AM-PUR-DA                     PIC XX.
  2057     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2058     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2059     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2060     12  AM-INACTIVE-DATE.
  2061         16  AM-INA-MO                     PIC 99.
  2062         16  AM-INA-DA                     PIC 99.
  2063         16  AM-INA-YR                     PIC 99.
  2064     12  AM-AR-HI-CERT-DATE                PIC XX.
  2065
  2066     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2067     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2068
  2069     12  AM-OB-PAYMENT-MODE                PIC X.
  2070         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  38
* EL6317.cbl
  2071         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2072         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2073         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2074
  2075     12  AM-AH-ONLY-INDICATOR              PIC X.
  2076         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2077         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2078
  2079     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2080
  2081     12  AM-OVER-SHORT.
  2082         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2083         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2084
  2085     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2086     12  AM-DCC-CLP-STATE                  PIC XX.
  2087
  2088     12  AM-RECALC-COMM                    PIC X.
  2089     12  AM-RECALC-REIN                    PIC X.
  2090
  2091     12  AM-REI-TABLE                      PIC XXX.
  2092     12  AM-REI-ET-LF                      PIC X.
  2093     12  AM-REI-ET-AH                      PIC X.
  2094     12  AM-REI-PE-LF                      PIC X.
  2095     12  AM-REI-PE-AH                      PIC X.
  2096     12  AM-REI-PRT-ST                     PIC X.
  2097     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2098     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2099     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2100     12  AM-REI-GROUP-A                    PIC X(6).
  2101     12  AM-REI-MORT                       PIC X(4).
  2102     12  AM-REI-PRT-OW                     PIC X.
  2103     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2104     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2105     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2106     12  AM-REI-GROUP-B                    PIC X(6).
  2107
  2108     12  AM-TRUST-TYPE                     PIC X(2).
  2109
  2110     12  AM-EMPLOYER-STMT-USED             PIC X.
  2111     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2112
  2113     12  AM-STD-AH-TYPE                    PIC XX.
  2114     12  AM-EARN-METHODS.
  2115         16  AM-EARN-METHOD-R              PIC X.
  2116             88 AM-REF-RL-R78                 VALUE 'R'.
  2117             88 AM-REF-RL-PR                  VALUE 'P'.
  2118             88 AM-REF-RL-MEAN                VALUE 'M'.
  2119             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2120         16  AM-EARN-METHOD-L              PIC X.
  2121             88 AM-REF-LL-R78                 VALUE 'R'.
  2122             88 AM-REF-LL-PR                  VALUE 'P'.
  2123             88 AM-REF-LL-MEAN                VALUE 'M'.
  2124             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2125         16  AM-EARN-METHOD-A              PIC X.
  2126             88 AM-REF-AH-R78                 VALUE 'R'.
  2127             88 AM-REF-AH-PR                  VALUE 'P'.
  2128             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  39
* EL6317.cbl
  2129             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2130             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2131             88 AM-REF-AH-NET                 VALUE 'N'.
  2132
  2133     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2134     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2135     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2136
  2137     12  AM-RET-Y-N                        PIC X.
  2138     12  AM-RET-P-E                        PIC X.
  2139     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2140     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2141     12  AM-RET-GRP                        PIC X(6).
  2142     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2143         16  AM-POOL-PRIME                 PIC XXX.
  2144         16  AM-POOL-SUB                   PIC XXX.
  2145     12  AM-RETRO-EARNINGS.
  2146         16  AM-RET-EARN-R                 PIC X.
  2147         16  AM-RET-EARN-L                 PIC X.
  2148         16  AM-RET-EARN-A                 PIC X.
  2149     12  AM-RET-ST-TAX-USE                 PIC X.
  2150         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2151         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2152     12  AM-RETRO-BEG-EARNINGS.
  2153         16  AM-RET-BEG-EARN-R             PIC X.
  2154         16  AM-RET-BEG-EARN-L             PIC X.
  2155         16  AM-RET-BEG-EARN-A             PIC X.
  2156     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2157     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2158
  2159     12  AM-USER-SELECT-OPTIONS.
  2160         16  AM-USER-SELECT-1              PIC X(10).
  2161         16  AM-USER-SELECT-2              PIC X(10).
  2162         16  AM-USER-SELECT-3              PIC X(10).
  2163         16  AM-USER-SELECT-4              PIC X(10).
  2164         16  AM-USER-SELECT-5              PIC X(10).
  2165
  2166     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2167
  2168     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2169
  2170     12  AM-RPT045A-SWITCH                 PIC X.
  2171         88  RPT045A-OFF                   VALUE 'N'.
  2172
  2173     12  AM-INSURANCE-LIMITS.
  2174         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2175         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2176
  2177     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2178         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2179
  2180     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2181         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2182         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2183
  2184     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2185
  2186     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  40
* EL6317.cbl
  2187     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2188     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2189     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2190     12  AM-DCC-UEF-STATE                  PIC XX.
  2191     12  FILLER                            PIC XXX.
  2192     12  AM-REPORT-CODE-3                  PIC X(10).
  2193*    12  FILLER                            PIC X(22).
  2194
  2195     12  AM-RESERVE-DATE.
  2196         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2197         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2198         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2199
  2200     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2201     12  AM-NOTIFICATION-TYPES.
  2202         16  AM-NOTIF-OF-LETTERS           PIC X.
  2203         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2204         16  AM-NOTIF-OF-REPORTS           PIC X.
  2205         16  AM-NOTIF-OF-STATUS            PIC X.
  2206
  2207     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2208         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2209         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2210         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2211         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2212
  2213     12  AM-BENEFIT-CONTROLS.
  2214         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2215             20  AM-BENEFIT-CODE           PIC XX.
  2216             20  AM-BENEFIT-TYPE           PIC X.
  2217             20  AM-BENEFIT-REVISION       PIC XXX.
  2218             20  AM-BENEFIT-REM-TERM       PIC X.
  2219             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2220             20  FILLER                    PIC XX.
  2221         16  FILLER                        PIC X(80).
  2222
  2223     12  AM-TRANSFER-DATA.
  2224         16  AM-TRANSFERRED-FROM.
  2225             20  AM-TRNFROM-CARRIER        PIC X.
  2226             20  AM-TRNFROM-GROUPING.
  2227                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2228                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2229             20  AM-TRNFROM-STATE          PIC XX.
  2230             20  AM-TRNFROM-ACCOUNT.
  2231                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2232                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2233             20  AM-TRNFROM-DTE            PIC XX.
  2234         16  AM-TRANSFERRED-TO.
  2235             20  AM-TRNTO-CARRIER          PIC X.
  2236             20  AM-TRNTO-GROUPING.
  2237                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2238                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2239             20  AM-TRNTO-STATE            PIC XX.
  2240             20  AM-TRNTO-ACCOUNT.
  2241                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2242                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2243             20  AM-TRNTO-DTE              PIC XX.
  2244         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  41
* EL6317.cbl
  2245
  2246     12  AM-SAVED-REMIT-TO                 PIC 99.
  2247
  2248     12  AM-COMM-STRUCTURE-SAVED.
  2249         16  AM-DEFN-1-SAVED.
  2250             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2251                 24  AM-AGT-SV             PIC X(10).
  2252                 24  AM-COM-TYP-SV         PIC X.
  2253                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2254                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2255                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2256                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2257                 24  FILLER                PIC X.
  2258                 24  AM-GL-CODES-SV        PIC X.
  2259                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2260                 24  FILLER                PIC X.
  2261         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2262             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2263                 24  FILLER                PIC X(11).
  2264                 24  AM-L-COMA-SV          PIC XXX.
  2265                 24  AM-J-COMA-SV          PIC XXX.
  2266                 24  AM-A-COMA-SV          PIC XXX.
  2267                 24  FILLER                PIC X(6).
  2268
  2269     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2270         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2271            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2272            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2273            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2274
  2275     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2276     12  FILLER                            PIC X(120).
  2277
  2278     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2279         16  AM-CONTROL-NAME               PIC X(30).
  2280         16  AM-EXECUTIVE-ONE.
  2281             20  AM-EXEC1-NAME             PIC X(15).
  2282             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2283                                                          COMP-3.
  2284             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2285                                                          COMP-3.
  2286         16  AM-EXECUTIVE-TWO.
  2287             20  AM-EXEC2-NAME             PIC X(15).
  2288             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2289                                                          COMP-3.
  2290             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2291                                                          COMP-3.
  2292
  2293     12  AM-RETRO-ADDITIONAL-DATA.
  2294         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2295         16  AM-RETRO-PREM-P-E             PIC X.
  2296         16  AM-RETRO-CLMS-P-I             PIC X.
  2297         16  AM-RETRO-RET-BRACKET-LF.
  2298             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2299                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2300                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2301             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2302                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  42
* EL6317.cbl
  2303                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2304             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2305                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2306                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2307         16  AM-RETRO-RET-BRACKET-AH.
  2308             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2309                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2310                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2311                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2312             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2313                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2314                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2315             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2316                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2317                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2318
  2319     12  AM-COMMENTS.
  2320         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2321
  2322     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2323         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2324         16  AM-FLI-BILLING-CODE           PIC X.
  2325         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2326         16  AM-FLI-UNITED-IDENT           PIC X.
  2327         16  AM-FLI-INTEREST-LOST-DATA.
  2328             20  AM-FLI-BANK-NO            PIC X(5).
  2329             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2330             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2331             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2332         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2333             20  AM-FLI-AGT                PIC X(9).
  2334             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2335             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2336         16  FILLER                        PIC X(102).
  2337
  2338     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2339         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2340             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2341             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2342             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2343             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2344             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2345         16  FILLER                          PIC X(10).
  2346******************************************************************
  2347*                                COPY ELCCNTL.
  2348******************************************************************
  2349*                                                                *
  2350*                                                                *
  2351*                            ELCCNTL.                            *
  2352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2353*                            VMOD=2.059                          *
  2354*                                                                *
  2355*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2356*                                                                *
  2357*   FILE TYPE = VSAM,KSDS                                        *
  2358*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2359*                                                                *
  2360*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  43
* EL6317.cbl
  2361*       ALTERNATE INDEX = NONE                                   *
  2362*                                                                *
  2363*   LOG = YES                                                    *
  2364*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2365******************************************************************
  2366*                   C H A N G E   L O G
  2367*
  2368* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2369*-----------------------------------------------------------------
  2370*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2371* EFFECTIVE    NUMBER
  2372*-----------------------------------------------------------------
  2373* 082503                   PEMA  ADD BENEFIT GROUP
  2374* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2375* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2376* 092705    2005050300006  PEMA  ADD SPP LEASES
  2377* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2378* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2379* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2380* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2381* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2382* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2383******************************************************************
  2384*
  2385 01  CONTROL-FILE.
  2386     12  CF-RECORD-ID                       PIC XX.
  2387         88  VALID-CF-ID                        VALUE 'CF'.
  2388
  2389     12  CF-CONTROL-PRIMARY.
  2390         16  CF-COMPANY-ID                  PIC XXX.
  2391         16  CF-RECORD-TYPE                 PIC X.
  2392             88  CF-COMPANY-MASTER              VALUE '1'.
  2393             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2394             88  CF-STATE-MASTER                VALUE '3'.
  2395             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2396             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2397             88  CF-CARRIER-MASTER              VALUE '6'.
  2398             88  CF-MORTALITY-MASTER            VALUE '7'.
  2399             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2400             88  CF-TERMINAL-MASTER             VALUE '9'.
  2401             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2402             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2403             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2404             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2405             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2406             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2407             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2408             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2409             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2410         16  CF-ACCESS-CD-GENL              PIC X(4).
  2411         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2412             20  CF-PROCESSOR               PIC X(4).
  2413         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2414             20  CF-STATE-CODE              PIC XX.
  2415             20  FILLER                     PIC XX.
  2416         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2417             20  FILLER                     PIC XX.
  2418             20  CF-HI-BEN-IN-REC           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  44
* EL6317.cbl
  2419         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2420             20  FILLER                     PIC XXX.
  2421             20  CF-CARRIER-CNTL            PIC X.
  2422         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2423             20  FILLER                     PIC XX.
  2424             20  CF-HI-TYPE-IN-REC          PIC 99.
  2425         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2426             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2427                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2428             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2429             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2430         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2431             20  FILLER                     PIC X.
  2432             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2433         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2434             20  FILLER                     PIC XX.
  2435             20  CF-MORTGAGE-PLAN           PIC XX.
  2436         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2437
  2438     12  CF-LAST-MAINT-DT                   PIC XX.
  2439     12  CF-LAST-MAINT-BY                   PIC X(4).
  2440     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2441
  2442     12  CF-RECORD-BODY                     PIC X(728).
  2443
  2444
  2445****************************************************************
  2446*             COMPANY MASTER RECORD                            *
  2447****************************************************************
  2448
  2449     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2450         16  CF-COMPANY-ADDRESS.
  2451             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2452             20  CF-CL-IN-CARE-OF           PIC X(30).
  2453             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2454             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2455             20  CF-CL-CITY-STATE           PIC X(30).
  2456             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2457             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2458         16  CF-COMPANY-CD                  PIC X.
  2459         16  CF-COMPANY-PASSWORD            PIC X(8).
  2460         16  CF-SECURITY-OPTION             PIC X.
  2461             88  ALL-SECURITY                   VALUE '1'.
  2462             88  COMPANY-VERIFY                 VALUE '2'.
  2463             88  PROCESSOR-VERIFY               VALUE '3'.
  2464             88  NO-SECURITY                    VALUE '4'.
  2465             88  ALL-BUT-TERM                   VALUE '5'.
  2466         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2467             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2468         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2469             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2470         16  CF-INFORCE-LOCATION            PIC X.
  2471             88  CERTS-ARE-ONLINE               VALUE '1'.
  2472             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2473             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2474         16  CF-LOWER-CASE-LETTERS          PIC X.
  2475         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2476             88  CF-ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  45
* EL6317.cbl
  2477             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2478             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2479             88  CF-ACCNT-CNTL                  VALUE '3'.
  2480             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2481
  2482         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2483         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2484
  2485         16  CF-LGX-CREDIT-USER             PIC X.
  2486             88  CO-IS-NOT-USER                 VALUE 'N'.
  2487             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2488
  2489         16 CF-CREDIT-CALC-CODES.
  2490             20  CF-CR-REM-TERM-CALC PIC X.
  2491               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2492               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2493               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2494               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2495               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2496               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2497               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2498             20  CF-CR-R78-METHOD           PIC X.
  2499               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2500               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2501
  2502         16  CF-CLAIM-CONTROL-COUNTS.
  2503             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2504                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2505
  2506             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2507                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2508
  2509             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2510                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2511
  2512             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2513                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2514
  2515         16  CF-CURRENT-MONTH-END           PIC XX.
  2516
  2517         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2518             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2519             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2520             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2521             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2522                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2523                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2524             20  CF-CO-PREM-REJECT-SW       PIC X.
  2525                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2526                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2527             20  CF-CO-REF-REJECT-SW        PIC X.
  2528                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2529                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2530
  2531         16  CF-CO-REPORTING-DT             PIC XX.
  2532         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2533         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2534           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  46
* EL6317.cbl
  2535           88  CF-CO-MONTH-END                  VALUE '1'.
  2536
  2537         16  CF-LGX-CLAIM-USER              PIC X.
  2538             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2539             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2540
  2541         16  CF-CREDIT-EDIT-CONTROLS.
  2542             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2543             20  CF-MIN-AGE                 PIC 99.
  2544             20  CF-DEFAULT-AGE             PIC 99.
  2545             20  CF-MIN-TERM                PIC S999      COMP-3.
  2546             20  CF-MAX-TERM                PIC S999      COMP-3.
  2547             20  CF-DEFAULT-SEX             PIC X.
  2548             20  CF-JOINT-AGE-INPUT         PIC X.
  2549                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2550             20  CF-BIRTH-DATE-INPUT        PIC X.
  2551                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2552             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2553                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2554                 88  CF-ZERO-CARRIER            VALUE '1'.
  2555                 88  CF-ZERO-GROUPING           VALUE '2'.
  2556                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2557             20  CF-EDIT-SW                 PIC X.
  2558                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2559             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2560             20  CF-CR-PR-METHOD            PIC X.
  2561               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2562               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2563             20  FILLER                     PIC X.
  2564
  2565         16  CF-CREDIT-MISC-CONTROLS.
  2566             20  CF-REIN-TABLE-SW           PIC X.
  2567                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2568             20  CF-COMP-TABLE-SW           PIC X.
  2569                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2570             20  CF-EXPERIENCE-RETENTION-AGE
  2571                                            PIC S9        COMP-3.
  2572             20  CF-CONVERSION-DT           PIC XX.
  2573             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2574             20  CF-RUN-FREQUENCY-SW        PIC X.
  2575                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2576                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2577
  2578             20  CF-CR-CHECK-NO-CONTROL.
  2579                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2580                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2581                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2582                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2583                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2584                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2585
  2586                 24  CF-CR-CHECK-COUNT       REDEFINES
  2587                     CF-CR-CHECK-COUNTER      PIC X(4).
  2588
  2589                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2590                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2591
  2592                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  47
* EL6317.cbl
  2593                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2594                 24  CF-MAIL-PROCESSING       PIC X.
  2595                     88  MAIL-PROCESSING          VALUE 'Y'.
  2596
  2597         16  CF-MISC-SYSTEM-CONTROL.
  2598             20  CF-SYSTEM-C                 PIC X.
  2599                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2600             20  CF-SYSTEM-D                 PIC X.
  2601                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2602             20  CF-SOC-SEC-NO-SW            PIC X.
  2603                 88  SOC-SEC-NO-USED             VALUE '1'.
  2604             20  CF-MEMBER-NO-SW             PIC X.
  2605                 88  MEMBER-NO-USED              VALUE '1'.
  2606             20  CF-TAX-ID-NUMBER            PIC X(11).
  2607             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2608             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2609                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2610                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2611                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2612                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2613             20  CF-SYSTEM-E                 PIC X.
  2614                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2615
  2616         16  CF-LGX-LIFE-USER               PIC X.
  2617             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2618             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2619
  2620         16  CF-CR-MONTH-END-DT             PIC XX.
  2621
  2622         16  CF-FILE-MAINT-DATES.
  2623             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2624                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2625             20  CF-LAST-BATCH       REDEFINES
  2626                 CF-LAST-BATCH-NO               PIC X(4).
  2627             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2628             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2629             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2630             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2631             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2632             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2633             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2634             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2635             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2636             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2637
  2638         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2639         16  FILLER                         PIC X.
  2640
  2641         16  CF-ALT-MORT-CODE               PIC X(4).
  2642         16  CF-MEMBER-CAPTION              PIC X(10).
  2643
  2644         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2645             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2646             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2647             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2648             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2649             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2650
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  48
* EL6317.cbl
  2651         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2652
  2653         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2654         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2655         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2656         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2657
  2658         16  CF-AH-OVERRIDE-L1              PIC X.
  2659         16  CF-AH-OVERRIDE-L2              PIC XX.
  2660         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2661         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2662
  2663         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2664         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2665
  2666         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2667         16  CF-AR-LAST-EL860-DT            PIC XX.
  2668         16  CF-MP-MONTH-END-DT             PIC XX.
  2669
  2670         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2671         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2672             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2673
  2674         16  CF-AR-MONTH-END-DT             PIC XX.
  2675
  2676         16  CF-CRDTCRD-USER                PIC X.
  2677             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2678             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2679
  2680         16  CF-CC-MONTH-END-DT             PIC XX.
  2681
  2682         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2683
  2684         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2685             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2686             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2687             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2688         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2689         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2690         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2691         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2692             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2693             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2694         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2695         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2696         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2697             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2698         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2699
  2700         16  CF-CL-ZIP-CODE.
  2701             20  CF-CL-ZIP-PRIME.
  2702                 24  CF-CL-ZIP-1ST          PIC X.
  2703                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2704                 24  FILLER                 PIC X(4).
  2705             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2706         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2707             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2708             20  CF-CL-CAN-POSTAL-2         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  49
* EL6317.cbl
  2709             20  FILLER                     PIC XXX.
  2710
  2711         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2712         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2713         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2714         16  CF-CO-OPTION-START-DATE        PIC XX.
  2715         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2716           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2717                                                      '3' '4'.
  2718           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2719           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2720           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2721           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2722           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2723           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2724
  2725         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2726
  2727         16  CF-PAYMENT-APPROVAL-LEVELS.
  2728             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2729             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2730             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2731             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2732             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2733             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2734
  2735         16  CF-END-USER-REPORTING-USER     PIC X.
  2736             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2737             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2738
  2739         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2740             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2741             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2742
  2743         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2744
  2745         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2746         16  FILLER                         PIC X.
  2747
  2748         16  CF-CREDIT-ARCHIVE-CNTL.
  2749             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2750             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2751             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2752
  2753         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2754
  2755         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2756             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2757             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2758
  2759         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2760             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2761             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2762
  2763         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2764
  2765         16  CF-CO-ACH-ID-CODE              PIC  X.
  2766             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  50
* EL6317.cbl
  2767             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2768             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2769         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2770         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2771         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2772         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2773         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2774         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2775         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2776         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2777         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2778                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2779         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2780                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2781
  2782         16  CF-CO-OVER-SHORT.
  2783             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2784             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2785
  2786*         16  FILLER                         PIC X(102).
  2787         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2788             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2789             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2790
  2791         16  CF-AH-APPROVAL-DAYS.
  2792             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2793             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2794             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2795             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2796
  2797         16  FILLER                         PIC X(82).
  2798****************************************************************
  2799*             PROCESSOR/USER RECORD                            *
  2800****************************************************************
  2801
  2802     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2803         16  CF-PROCESSOR-NAME              PIC X(30).
  2804         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2805         16  CF-PROCESSOR-TITLE             PIC X(26).
  2806         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2807                 88  MESSAGE-YES                VALUE 'Y'.
  2808                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2809
  2810*****************************************************
  2811****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2812****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2813****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2814****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2815*****************************************************
  2816
  2817         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2818             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2819             20  CF-APPLICATION-FORCE       PIC X.
  2820             20  CF-INDIVIDUAL-APP.
  2821                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2822                     28  CF-BROWSE-APP      PIC X.
  2823                     28  CF-UPDATE-APP      PIC X.
  2824
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  51
* EL6317.cbl
  2825         16  CF-CURRENT-TERM-ON             PIC X(4).
  2826         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2827             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2828             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2829             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2830             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2831             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2832             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2833             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2834         16  CF-PROCESSOR-CARRIER           PIC X.
  2835             88  NO-CARRIER-SECURITY            VALUE ' '.
  2836         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2837             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2838         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2839             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2840         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2841             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2842
  2843         16  CF-PROC-SYS-ACCESS-SW.
  2844             20  CF-PROC-CREDIT-CLAIMS-SW.
  2845                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2846                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2847                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2848                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2849             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2850                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2851                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2852             20  CF-PROC-LIFE-GNRLDGR-SW.
  2853                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2854                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2855                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2856                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2857             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2858                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2859                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2860         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2861             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2862             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2863         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2864
  2865         16  CF-APPROVAL-LEVEL                  PIC X.
  2866             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2867             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2868             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2869             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2870
  2871         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2872
  2873         16  CF-LANGUAGE-TYPE                   PIC X.
  2874             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2875             88  CF-LANG-IS-FR                      VALUE 'F'.
  2876
  2877         16  CF-CSR-IND                         PIC X.
  2878         16  FILLER                             PIC X(239).
  2879
  2880****************************************************************
  2881*             PROCESSOR/REMINDERS RECORD                       *
  2882****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  52
* EL6317.cbl
  2883
  2884     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2885         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2886             20  CF-START-REMIND-DT         PIC XX.
  2887             20  CF-END-REMIND-DT           PIC XX.
  2888             20  CF-REMINDER-TEXT           PIC X(50).
  2889         16  FILLER                         PIC X(296).
  2890
  2891
  2892****************************************************************
  2893*             STATE MASTER RECORD                              *
  2894****************************************************************
  2895
  2896     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2897         16  CF-STATE-ABBREVIATION          PIC XX.
  2898         16  CF-STATE-NAME                  PIC X(25).
  2899         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2900         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2901             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2902             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2903             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2904             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2905                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2906                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2907             20  CF-ST-PREM-REJECT-SW       PIC X.
  2908                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2909                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2910             20  CF-ST-REF-REJECT-SW        PIC X.
  2911                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2912                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2913         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2914         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2915         16  CF-ST-REFUND-RULES.
  2916             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2917             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2918             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2919         16  CF-ST-FST-PMT-EXTENSION.
  2920             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2921             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2922                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2923                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2924                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2925                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2926         16  CF-ST-STATE-CALL.
  2927             20  CF-ST-CALL-UNEARNED        PIC X.
  2928             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2929             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2930         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2931             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2932             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2933         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2934         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2935         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2936         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2937         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2938         16  FILLER                         PIC X.
  2939         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2940             20  CF-ST-BENEFIT-CD           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  53
* EL6317.cbl
  2941             20  CF-ST-BENEFIT-KIND         PIC X.
  2942                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2943                 88  CF-ST-AH-KIND              VALUE 'A'.
  2944             20  CF-ST-REM-TERM-CALC        PIC X.
  2945                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2946                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2947                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2948                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2949                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2950                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2951                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2952                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2953
  2954             20  CF-ST-REFUND-CALC          PIC X.
  2955                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2956                 88  ST-REFD-BY-R78             VALUE '1'.
  2957                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2958                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2959                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2960                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2961                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2962                 88  ST-REFD-UTAH               VALUE '7'.
  2963                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2964                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2965                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2966
  2967             20  CF-ST-EARNING-CALC         PIC X.
  2968                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2969                 88  ST-EARN-BY-R78             VALUE '1'.
  2970                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2971                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2972                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2973                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2974                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2975                 88  ST-EARN-MEAN               VALUE '8'.
  2976                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2977
  2978             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2979                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2980                 88  ST-OVRD-BY-R78             VALUE '1'.
  2981                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2982                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2983                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2984                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2985                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2986                 88  ST-OVRD-MEAN               VALUE '8'.
  2987                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2988             20  FILLER                     PIC X.
  2989
  2990         16  CF-ST-COMMISSION-CAPS.
  2991             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2992             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2993             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2994             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2995         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2996                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2997
  2998         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  54
* EL6317.cbl
  2999
  3000         16  CF-ST-STATUTORY-INTEREST.
  3001             20  CF-ST-STAT-DATE-FROM       PIC X.
  3002                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3003                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3004             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3005             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3006             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3007             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3008             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3009
  3010         16  CF-ST-OVER-SHORT.
  3011             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3012             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3013
  3014         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3015
  3016         16  CF-ST-RT-CALC                  PIC X.
  3017
  3018         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3019         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3020         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3021         16  CF-ST-RF-LR-CALC               PIC X.
  3022         16  CF-ST-RF-LL-CALC               PIC X.
  3023         16  CF-ST-RF-LN-CALC               PIC X.
  3024         16  CF-ST-RF-AH-CALC               PIC X.
  3025         16  CF-ST-RF-CP-CALC               PIC X.
  3026*        16  FILLER                         PIC X(206).
  3027*CIDMOD         16  FILLER                         PIC X(192).
  3028         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3029             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3030         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3031         16  CF-ST-VFY-2ND-BENE             PIC X.
  3032         16  FILLER                         PIC X(186).
  3033
  3034****************************************************************
  3035*             BENEFIT MASTER RECORD                            *
  3036****************************************************************
  3037
  3038     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3039         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3040             20  CF-BENEFIT-CODE            PIC XX.
  3041             20  CF-BENEFIT-NUMERIC  REDEFINES
  3042                 CF-BENEFIT-CODE            PIC XX.
  3043             20  CF-BENEFIT-ALPHA           PIC XXX.
  3044             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3045             20  CF-BENEFIT-COMMENT         PIC X(10).
  3046
  3047             20  CF-LF-COVERAGE-TYPE        PIC X.
  3048                 88  CF-REDUCING                VALUE 'R'.
  3049                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3050
  3051             20  CF-SPECIAL-CALC-CD         PIC X.
  3052                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3053                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3054                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3055                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3056                 88  CF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  55
* EL6317.cbl
  3057                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3058                 88  CF-FARM-PLAN               VALUE 'F'.
  3059                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3060                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3061                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3062                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3063                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3064                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3065                 88  CF-PRUDENTIAL              VALUE 'P'.
  3066                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3067                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3068                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3069                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3070                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3071                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3072
  3073             20  CF-JOINT-INDICATOR         PIC X.
  3074                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3075
  3076*            20  FILLER                     PIC X(12).
  3077             20  FILLER                     PIC X(11).
  3078             20  CF-BENEFIT-CATEGORY        PIC X.
  3079             20  CF-LOAN-TYPE               PIC X(8).
  3080
  3081             20  CF-CO-REM-TERM-CALC        PIC X.
  3082                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3083                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3084                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3085                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3086                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3087
  3088             20  CF-CO-EARNINGS-CALC        PIC X.
  3089                 88  CO-EARN-BY-R78             VALUE '1'.
  3090                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3091                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3092                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3093                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3094                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3095                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3096                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3097
  3098             20  CF-CO-REFUND-CALC          PIC X.
  3099                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3100                 88  CO-REFD-BY-R78             VALUE '1'.
  3101                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3102                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3103                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3104                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3105                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3106                 88  CO-REFD-MEAN               VALUE '8'.
  3107                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3108                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3109                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3110
  3111             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3112                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3113                 88  CO-OVRD-BY-R78             VALUE '1'.
  3114                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  56
* EL6317.cbl
  3115                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3116                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3117                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3118                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3119                 88  CO-OVRD-MEAN               VALUE '8'.
  3120                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3121
  3122             20  CF-CO-BEN-I-G-CD           PIC X.
  3123                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3124                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3125                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3126
  3127         16  FILLER                         PIC X(304).
  3128
  3129
  3130****************************************************************
  3131*             CARRIER MASTER RECORD                            *
  3132****************************************************************
  3133
  3134     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3135         16  CF-ADDRESS-DATA.
  3136             20  CF-MAIL-TO-NAME            PIC X(30).
  3137             20  CF-IN-CARE-OF              PIC X(30).
  3138             20  CF-ADDRESS-LINE-1          PIC X(30).
  3139             20  CF-ADDRESS-LINE-2          PIC X(30).
  3140             20  CF-CITY-STATE              PIC X(30).
  3141             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3142             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3143
  3144         16  CF-CLAIM-NO-CONTROL.
  3145             20  CF-CLAIM-NO-METHOD         PIC X.
  3146                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3147                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3148                 88  CLAIM-NO-SEQ               VALUE '3'.
  3149                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3150             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3151                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3152                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3153                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3154
  3155         16  CF-CHECK-NO-CONTROL.
  3156             20  CF-CHECK-NO-METHOD         PIC X.
  3157                 88  CHECK-NO-MANUAL            VALUE '1'.
  3158                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3159                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3160                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3161             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3162                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3163
  3164         16  CF-DOMICILE-STATE              PIC XX.
  3165
  3166         16  CF-EXPENSE-CONTROLS.
  3167             20  CF-EXPENSE-METHOD          PIC X.
  3168                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3169                 88  DOLLARS-PER-PMT            VALUE '2'.
  3170                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3171                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3172             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  57
* EL6317.cbl
  3173             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3174
  3175         16  CF-CORRESPONDENCE-CONTROL.
  3176             20  CF-LETTER-RESEND-OPT       PIC X.
  3177                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3178                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3179             20  FILLER                     PIC X(4).
  3180
  3181         16  CF-RESERVE-CONTROLS.
  3182             20  CF-MANUAL-SW               PIC X.
  3183                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3184             20  CF-FUTURE-SW               PIC X.
  3185                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3186             20  CF-PTC-SW                  PIC X.
  3187                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3188             20  CF-IBNR-SW                 PIC X.
  3189                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3190             20  CF-PTC-LF-SW               PIC X.
  3191                 88  CF-LF-PTC-USED             VALUE '1'.
  3192             20  CF-CDT-ACCESS-METHOD       PIC X.
  3193                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3194                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3195                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3196             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3197
  3198         16  CF-CLAIM-CALC-METHOD           PIC X.
  3199             88  360-PLUS-MONTHS                VALUE '1'.
  3200             88  365-PLUS-MONTHS                VALUE '2'.
  3201             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3202             88  360-DAILY                      VALUE '4'.
  3203             88  365-DAILY                      VALUE '5'.
  3204
  3205         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3206         16  FILLER                         PIC X(11).
  3207
  3208         16  CF-LIMIT-AMOUNTS.
  3209             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3210             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3211             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3212             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3213             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3214             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3215             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3216             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3217             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3218             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3219
  3220         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3221         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3222         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3223
  3224         16  CF-ZIP-CODE.
  3225             20  CF-ZIP-PRIME.
  3226                 24  CF-ZIP-1ST             PIC X.
  3227                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3228                 24  FILLER                 PIC X(4).
  3229             20  CF-ZIP-PLUS4               PIC X(4).
  3230         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  58
* EL6317.cbl
  3231             20  CF-CAN-POSTAL-1            PIC XXX.
  3232             20  CF-CAN-POSTAL-2            PIC XXX.
  3233             20  FILLER                     PIC XXX.
  3234
  3235         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3236         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3237         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3238
  3239         16  CF-RATING-SWITCH               PIC X.
  3240             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3241             88  CF-NO-RATING                   VALUE 'N'.
  3242
  3243         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3244
  3245         16  CF-CARRIER-OVER-SHORT.
  3246             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3247             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3248
  3249         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3250         16  CF-SECPAY-SWITCH               PIC X.
  3251             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3252             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3253         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3254         16  FILLER                         PIC X(448).
  3255*        16  FILLER                         PIC X(452).
  3256
  3257
  3258****************************************************************
  3259*             MORTALITY MASTER RECORD                          *
  3260****************************************************************
  3261
  3262     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3263         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3264                                INDEXED BY CF-MORT-NDX.
  3265             20  CF-MORT-TABLE              PIC X(5).
  3266             20  CF-MORT-TABLE-TYPE         PIC X.
  3267                 88  CF-MORT-JOINT              VALUE 'J'.
  3268                 88  CF-MORT-SINGLE             VALUE 'S'.
  3269                 88  CF-MORT-COMBINED           VALUE 'C'.
  3270                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3271                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3272             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3273             20  CF-MORT-AGE-METHOD         PIC XX.
  3274                 88  CF-AGE-LAST                VALUE 'AL'.
  3275                 88  CF-AGE-NEAR                VALUE 'AN'.
  3276             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3277             20  CF-MORT-ADJUSTMENT-DIRECTION
  3278                                            PIC X.
  3279                 88  CF-MINUS                   VALUE '-'.
  3280                 88  CF-PLUS                    VALUE '+'.
  3281             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3282             20  CF-MORT-JOINT-CODE         PIC X.
  3283                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3284             20  CF-MORT-PC-Q               PIC X.
  3285                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3286             20  CF-MORT-TABLE-CODE         PIC X(4).
  3287             20  CF-MORT-COMMENTS           PIC X(15).
  3288             20  FILLER                     PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  59
* EL6317.cbl
  3289
  3290         16  FILLER                         PIC X(251).
  3291
  3292
  3293****************************************************************
  3294*             BUSSINESS TYPE MASTER RECORD                     *
  3295****************************************************************
  3296
  3297     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3298* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3299* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3300* AND RECORD 05 IS TYPES 81-99
  3301         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3302             20  CF-BUSINESS-TITLE          PIC  X(19).
  3303             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3304                                            PIC S9V9(4) COMP-3.
  3305             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3306             20  FILLER                     PIC  X.
  3307         16  FILLER                         PIC  X(248).
  3308
  3309
  3310****************************************************************
  3311*             TERMINAL MASTER RECORD                           *
  3312****************************************************************
  3313
  3314     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3315
  3316         16  CF-COMPANY-TERMINALS.
  3317             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3318                                  PIC X(4).
  3319         16  FILLER               PIC X(248).
  3320
  3321
  3322****************************************************************
  3323*             LIFE EDIT MASTER RECORD                          *
  3324****************************************************************
  3325
  3326     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3327         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3328             20  CF-LIFE-CODE-IN            PIC XX.
  3329             20  CF-LIFE-CODE-OUT           PIC XX.
  3330         16  FILLER                         PIC X(248).
  3331
  3332
  3333****************************************************************
  3334*             AH EDIT MASTER RECORD                            *
  3335****************************************************************
  3336
  3337     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3338         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3339             20  CF-AH-CODE-IN              PIC XXX.
  3340             20  CF-AH-CODE-OUT             PIC XX.
  3341         16  FILLER                         PIC X(248).
  3342
  3343
  3344****************************************************************
  3345*             CREDIBILITY TABLES                               *
  3346****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  60
* EL6317.cbl
  3347
  3348     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3349         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3350                             INDEXED BY CF-CRDB-NDX.
  3351             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3352             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3353             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3354         16  FILLER                         PIC  X(332).
  3355
  3356
  3357****************************************************************
  3358*             REPORT CUSTOMIZATION RECORD                      *
  3359****************************************************************
  3360
  3361     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3362         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3363             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3364             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3365             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3366**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3367****       A T-TRANSFER.                                   ****
  3368             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3369
  3370         16  FILLER                         PIC XX.
  3371
  3372         16  CF-CARRIER-CNTL-OPT.
  3373             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3374                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3375                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3376             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3377                                            PIC X.
  3378         16  CF-GROUP-CNTL-OPT.
  3379             20  CF-GROUP-OPT-SEQ           PIC 9.
  3380                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3381                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3382             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3383                                            PIC X(6).
  3384         16  CF-STATE-CNTL-OPT.
  3385             20  CF-STATE-OPT-SEQ           PIC 9.
  3386                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3387                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3388             20  CF-STATE-SELECT OCCURS 3 TIMES
  3389                                            PIC XX.
  3390         16  CF-ACCOUNT-CNTL-OPT.
  3391             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3392                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3393                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3394             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3395                                            PIC X(10).
  3396         16  CF-BUS-TYP-CNTL-OPT.
  3397             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3398                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3399                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3400             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3401                                            PIC XX.
  3402         16  CF-LF-TYP-CNTL-OPT.
  3403             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3404                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  61
* EL6317.cbl
  3405                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3406             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3407                                            PIC XX.
  3408         16  CF-AH-TYP-CNTL-OPT.
  3409             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3410                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3411                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3412             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3413                                            PIC XX.
  3414         16  CF-REPTCD1-CNTL-OPT.
  3415             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3416                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3417                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3418             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3419                                            PIC X(10).
  3420         16  CF-REPTCD2-CNTL-OPT.
  3421             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3422                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3423                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3424             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3425                                            PIC X(10).
  3426         16  CF-USER1-CNTL-OPT.
  3427             20  CF-USER1-OPT-SEQ           PIC 9.
  3428                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3429                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3430             20  CF-USER1-SELECT OCCURS 3 TIMES
  3431                                            PIC X(10).
  3432         16  CF-USER2-CNTL-OPT.
  3433             20  CF-USER2-OPT-SEQ           PIC 9.
  3434                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3435                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3436             20  CF-USER2-SELECT OCCURS 3 TIMES
  3437                                            PIC X(10).
  3438         16  CF-USER3-CNTL-OPT.
  3439             20  CF-USER3-OPT-SEQ           PIC 9.
  3440                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3441                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3442             20  CF-USER3-SELECT OCCURS 3 TIMES
  3443                                            PIC X(10).
  3444         16  CF-USER4-CNTL-OPT.
  3445             20  CF-USER4-OPT-SEQ           PIC 9.
  3446                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3447                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3448             20  CF-USER4-SELECT OCCURS 3 TIMES
  3449                                            PIC X(10).
  3450         16  CF-USER5-CNTL-OPT.
  3451             20  CF-USER5-OPT-SEQ           PIC 9.
  3452                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3453                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3454             20  CF-USER5-SELECT OCCURS 3 TIMES
  3455                                            PIC X(10).
  3456         16  CF-REINS-CNTL-OPT.
  3457             20  CF-REINS-OPT-SEQ           PIC 9.
  3458                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3459                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3460             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3461                 24  CF-REINS-PRIME         PIC XXX.
  3462                 24  CF-REINS-SUB           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  62
* EL6317.cbl
  3463
  3464         16  CF-AGENT-CNTL-OPT.
  3465             20  CF-AGENT-OPT-SEQ           PIC 9.
  3466                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3467                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3468             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3469                                            PIC X(10).
  3470
  3471         16  FILLER                         PIC X(43).
  3472
  3473         16  CF-LOSS-RATIO-SELECT.
  3474             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3475             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3476         16  CF-ENTRY-DATE-SELECT.
  3477             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3478             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3479         16  CF-EFFECTIVE-DATE-SELECT.
  3480             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3481             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3482
  3483         16  CF-EXCEPTION-LIST-IND          PIC X.
  3484             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3485
  3486         16  FILLER                         PIC X(318).
  3487
  3488****************************************************************
  3489*                  EXCEPTION REPORTING RECORD                  *
  3490****************************************************************
  3491
  3492     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3493         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3494             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3495
  3496         16  CF-COMBINED-LIFE-AH-OPT.
  3497             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3498             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3499             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3500             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3501
  3502         16  CF-LIFE-OPT.
  3503             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3504             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3505             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3506             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3507             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3508             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3509             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3510             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3511             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3512             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3513
  3514         16  CF-AH-OPT.
  3515             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3516             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3517             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3518             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3519             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3520             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  63
* EL6317.cbl
  3521             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3522             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3523             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3524             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3525
  3526         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3527             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3528             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3529             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3530
  3531         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3532
  3533         16  FILLER                         PIC X(673).
  3534
  3535
  3536****************************************************************
  3537*             MORTGAGE SYSTEM PLAN RECORD                      *
  3538****************************************************************
  3539
  3540     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3541         16  CF-PLAN-TYPE                   PIC X.
  3542             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3543             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3544             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3545         16  CF-PLAN-ABBREV                 PIC XXX.
  3546         16  CF-PLAN-DESCRIPT               PIC X(10).
  3547         16  CF-PLAN-NOTES                  PIC X(20).
  3548         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3549         16  CF-PLAN-UNDERWRITING.
  3550             20  CF-PLAN-TERM-DATA.
  3551                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3552                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3553             20  CF-PLAN-AGE-DATA.
  3554                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3555                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3556                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3557             20  CF-PLAN-BENEFIT-DATA.
  3558                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3559                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3560                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3561                                            PIC S9(7)V99  COMP-3.
  3562         16  CF-PLAN-POLICY-FORMS.
  3563             20  CF-POLICY-FORM             PIC X(12).
  3564             20  CF-MASTER-APPLICATION      PIC X(12).
  3565             20  CF-MASTER-POLICY           PIC X(12).
  3566         16  CF-PLAN-RATING.
  3567             20  CF-RATE-CODE               PIC X(5).
  3568             20  CF-SEX-RATING              PIC X.
  3569                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3570                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3571             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3572             20  CF-SUB-STD-TYPE            PIC X.
  3573                 88  CF-PCT-OF-PREM            VALUE '1'.
  3574                 88  CF-PCT-OF-BENE            VALUE '2'.
  3575         16  CF-PLAN-PREM-TOLERANCES.
  3576             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3577             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3578         16  CF-PLAN-PYMT-TOLERANCES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  64
* EL6317.cbl
  3579             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3580             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3581         16  CF-PLAN-MISC-DATA.
  3582             20  FILLER                     PIC X.
  3583             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3584             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3585         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3586         16  CF-PLAN-IND-GRP                PIC X.
  3587             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3588                                                     '1'.
  3589             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3590                                                     '2'.
  3591         16  CF-MIB-SEARCH-SW               PIC X.
  3592             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3593             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3594             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3595             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3596         16  CF-ALPHA-SEARCH-SW             PIC X.
  3597             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3598             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3599             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3600             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3601             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3602             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3603             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3604             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3605             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3606             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3607                                                     'A' 'B' 'C'
  3608                                                     'X' 'Y' 'Z'.
  3609         16  CF-EFF-DT-RULE-SW              PIC X.
  3610             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3611             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3612             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3613             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3614             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3615         16  FILLER                         PIC X(4).
  3616         16  CF-HEALTH-QUESTIONS            PIC X.
  3617             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3618         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3619         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3620         16  CF-PLAN-SNGL-JNT               PIC X.
  3621             88  CF-COMBINED-PLAN              VALUE 'C'.
  3622             88  CF-JNT-PLAN                   VALUE 'J'.
  3623             88  CF-SNGL-PLAN                  VALUE 'S'.
  3624         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3625         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3626         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3627         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3628         16  CF-RERATE-CNTL                 PIC  X.
  3629             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3630             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3631             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3632             88  CF-AUTO-RECALC                 VALUE '4'.
  3633         16  CF-BENEFIT-TYPE                PIC  X.
  3634             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3635             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3636         16  CF-POLICY-FEE                  PIC S999V99
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  65
* EL6317.cbl
  3637                                                    COMP-3.
  3638         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3639         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3640         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3641         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3642         16  FILLER                         PIC  X(32).
  3643         16  CF-TERMINATION-FORM            PIC  X(04).
  3644         16  FILLER                         PIC  X(08).
  3645         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3646                                                       COMP-3.
  3647         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3648         16  CF-ISSUE-LETTER                PIC  X(4).
  3649         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3650         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3651             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3652             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3653         16  CF-MP-REFUND-CALC              PIC X.
  3654             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3655             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3656             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3657             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3658             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3659             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3660             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3661             88  CF-MP-REFD-MEAN                VALUE '8'.
  3662         16  CF-ALT-RATE-CODE               PIC  X(5).
  3663
  3664
  3665         16  FILLER                         PIC X(498).
  3666****************************************************************
  3667*             MORTGAGE COMPANY MASTER RECORD                   *
  3668****************************************************************
  3669
  3670     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3671         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3672         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3673             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3674             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3675             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3676             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3677             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3678
  3679         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3680         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3681         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3682         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3683         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3684
  3685         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3686             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3687         16  CF-MP-RECON-USE-IND            PIC X(1).
  3688             88  CF-MP-USE-RECON             VALUE 'Y'.
  3689         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3690             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3691         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3692             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3693             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3694         16  FILLER                         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  66
* EL6317.cbl
  3695         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3696             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3697         16  CF-MORTG-MIB-VERSION           PIC X.
  3698             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3699             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3700             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3701         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3702             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3703                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3704             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3705                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3706             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3707                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3708             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3709                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3710             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3711                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3712             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3713                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3714         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3715         16  FILLER                         PIC X(7).
  3716         16  CF-MORTG-DESTINATION-SYMBOL.
  3717             20  CF-MORTG-MIB-COMM          PIC X(5).
  3718             20  CF-MORTG-MIB-TERM          PIC X(5).
  3719         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3720             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3721         16  FILLER                         PIC X(03).
  3722         16  CF-MP-CHECK-NO-CONTROL.
  3723             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3724                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3725                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3726                                                ' ' LOW-VALUES.
  3727                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3728                                               VALUE '3'.
  3729         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3730         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3731         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3732             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3733                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3734             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3735                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3736             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3737                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3738             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3739                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3740             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3741                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3742             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3743                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3744         16  CF-MORTG-BILLING-AREA.
  3745             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3746                                            PIC X.
  3747         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3748         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3749         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3750         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3751             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3752             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  67
* EL6317.cbl
  3753         16  FILLER                         PIC X.
  3754         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3755             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3756             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3757         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3758         16  FILLER                         PIC X(8).
  3759         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3760         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3761         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3762         16  CF-ACH-COMPANY-ID.
  3763             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3764                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3765                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3766                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3767             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3768         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3769             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3770         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3771             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3772             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3773         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3774         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3775         16  FILLER                         PIC X(536).
  3776
  3777****************************************************************
  3778*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3779****************************************************************
  3780
  3781     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3782         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3783             20  CF-FEMALE-HEIGHT.
  3784                 24  CF-FEMALE-FT           PIC 99.
  3785                 24  CF-FEMALE-IN           PIC 99.
  3786             20  CF-FEMALE-MIN-WT           PIC 999.
  3787             20  CF-FEMALE-MAX-WT           PIC 999.
  3788         16  FILLER                         PIC X(428).
  3789
  3790     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3791         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3792             20  CF-MALE-HEIGHT.
  3793                 24  CF-MALE-FT             PIC 99.
  3794                 24  CF-MALE-IN             PIC 99.
  3795             20  CF-MALE-MIN-WT             PIC 999.
  3796             20  CF-MALE-MAX-WT             PIC 999.
  3797         16  FILLER                         PIC X(428).
  3798******************************************************************
  3799*             AUTOMATIC ACTIVITY RECORD                          *
  3800******************************************************************
  3801     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3802         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3803             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3804             20  CF-SYS-LETTER-ID           PIC X(04).
  3805             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3806             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3807             20  CF-SYS-RESET-SW            PIC X(01).
  3808             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3809             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3810
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  68
* EL6317.cbl
  3811         16  FILLER                         PIC X(50).
  3812
  3813         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3814             20  CF-USER-ACTIVE-SW          PIC X(01).
  3815             20  CF-USER-LETTER-ID          PIC X(04).
  3816             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3817             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3818             20  CF-USER-RESET-SW           PIC X(01).
  3819             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3820             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3821             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3822
  3823         16  FILLER                         PIC X(246).
  3824*                                COPY ERCPNDB.
  3825******************************************************************
  3826*                                                                *
  3827*                                                                *
  3828*                            ERCPNDB.                            *
  3829*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3830*                            VMOD=2.025                          *
  3831*                                                                *
  3832*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3833*                                                                *
  3834******************************************************************
  3835*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3836*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3837******************************************************************
  3838*                                                                *
  3839*                                                                *
  3840*   FILE TYPE = VSAM,KSDS                                        *
  3841*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3842*                                                                *
  3843*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3844*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3845*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3846*                                                 RKP=13,LEN=36  *
  3847*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3848*                                      AND CHG-SEQ.)             *
  3849*                                                RKP=49,LEN=11   *
  3850*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3851*                                      AND CHG-SEQ.)             *
  3852*                                                RKP=60,LEN=15   *
  3853*                                                                *
  3854*   LOG = NO                                                     *
  3855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3856******************************************************************
  3857******************************************************************
  3858*                   C H A N G E   L O G
  3859*
  3860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3861*-----------------------------------------------------------------
  3862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3863* EFFECTIVE    NUMBER
  3864*-----------------------------------------------------------------
  3865* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3866* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3867* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3868* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  69
* EL6317.cbl
  3869* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3870* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3871* 032306                   PEMA  ADD BOW LOAN NUMBER
  3872* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3873* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3874* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3875* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3876* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3877* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3878* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3879* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3880******************************************************************
  3881
  3882 01  PENDING-BUSINESS.
  3883     12  PB-RECORD-ID                     PIC XX.
  3884         88  VALID-PB-ID                        VALUE 'PB'.
  3885
  3886     12  PB-CONTROL-PRIMARY.
  3887         16  PB-COMPANY-CD                PIC X.
  3888         16  PB-ENTRY-BATCH               PIC X(6).
  3889         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3890         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3891
  3892     12  PB-CONTROL-BY-ACCOUNT.
  3893         16  PB-COMPANY-CD-A1             PIC X.
  3894         16  PB-CARRIER                   PIC X.
  3895         16  PB-GROUPING.
  3896             20  PB-GROUPING-PREFIX       PIC XXX.
  3897             20  PB-GROUPING-PRIME        PIC XXX.
  3898         16  PB-STATE                     PIC XX.
  3899         16  PB-ACCOUNT.
  3900             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3901             20  PB-ACCOUNT-PRIME         PIC X(6).
  3902         16  PB-CERT-EFF-DT               PIC XX.
  3903         16  PB-CERT-NO.
  3904             20  PB-CERT-PRIME            PIC X(10).
  3905             20  PB-CERT-SFX              PIC X.
  3906         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3907
  3908         16  PB-RECORD-TYPE               PIC X.
  3909             88  PB-MAILING-DATA                VALUE '0'.
  3910             88  PB-ISSUE                       VALUE '1'.
  3911             88  PB-CANCELLATION                VALUE '2'.
  3912             88  PB-BATCH-TRAILER               VALUE '9'.
  3913
  3914     12  PB-CONTROL-BY-ORIG-BATCH.
  3915         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3916         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3917         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3918         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3919
  3920     12  PB-CONTROL-BY-CSR.
  3921         16  PB-CSR-COMPANY-CD            PIC X.
  3922         16  PB-CSR-ID                    PIC X(4).
  3923         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3924         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3925         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  70
* EL6317.cbl
  3927*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3928******************************************************************
  3929
  3930     12  PB-LAST-MAINT-DT                 PIC XX.
  3931     12  PB-LAST-MAINT-BY                 PIC X(4).
  3932     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3933
  3934     12  PB-RECORD-BODY                   PIC X(375).
  3935
  3936     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3937         16  PB-CERT-ORIGIN               PIC X.
  3938             88  CLASIC-CREATED-CERT         VALUE '1'.
  3939         16  PB-I-NAME.
  3940             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3941             20  PB-I-INSURED-FIRST-NAME.
  3942                 24  PB-I-INSURED-1ST-INIT PIC X.
  3943                 24  FILLER                PIC X(9).
  3944             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3945         16  PB-I-AGE                     PIC S99   COMP-3.
  3946         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3947         16  PB-I-BIRTHDAY                PIC XX.
  3948         16  PB-I-INSURED-SEX             PIC X.
  3949             88  PB-SEX-MALE     VALUE 'M'.
  3950             88  PB-SEX-FEMALE   VALUE 'F'.
  3951
  3952         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3953         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3954         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3955         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3956         16  PB-I-SKIP-CODE               PIC X.
  3957             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3958             88  PB-SKIP-JULY              VALUE '1'.
  3959             88  PB-SKIP-AUGUST            VALUE '2'.
  3960             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3961             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3962             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3963             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3964             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3965             88  PB-SKIP-JUNE              VALUE '8'.
  3966             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3967             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3968             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3969         16  PB-I-TERM-TYPE               PIC X.
  3970             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3971             88  PB-PAID-WEEKLY            VALUE 'W'.
  3972             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3973             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3974             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3975         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3976         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3977         16  PB-I-DATA-ENTRY-SW           PIC X.
  3978             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3979             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3980             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3981             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3982         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3983         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3984*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  71
* EL6317.cbl
  3985         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3986         16  FILLER                       PIC X.
  3987
  3988         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3989             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3990             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3991                                                   '90' THRU '99'.
  3992         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3993                                          PIC XX.
  3994         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3995         16  PB-I-AMOUNT-FINANCED REDEFINES
  3996                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3997         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3998         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3999                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4000         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4001         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4002         16  PB-I-CLP-AMOUNT REDEFINES
  4003                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4004         16  PB-I-LF-CALC-FLAG            PIC X.
  4005             88 PB-COMP-LF-PREM               VALUE '?'.
  4006         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4007         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4008         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4009         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4010         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4011         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4012         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4013         16  PB-I-LF-ABBR                 PIC XXX.
  4014         16  PB-I-LF-INPUT-CD             PIC XX.
  4015
  4016         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4017             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4018             88  PB-INVALID-AH               VALUE '  ' '00'
  4019                                                   '90' THRU '99'.
  4020         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4021         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4022         16  PB-I-AH-CALC-FLAG            PIC X.
  4023             88 PB-COMP-AH-PREM                  VALUE '?'.
  4024         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4025         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4026         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4027         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4028         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4029         16  PB-I-AH-ABBR                 PIC XXX.
  4030         16  PB-I-AH-INPUT-CD             PIC XXX.
  4031
  4032         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4033         16  PB-I-REIN-TABLE              PIC XXX.
  4034         16  PB-I-BUSINESS-TYPE           PIC 99.
  4035         16  PB-I-INDV-GRP-CD             PIC X.
  4036         16  PB-I-MORT-CODE.
  4037             20  PB-I-TABLE               PIC X.
  4038             20  PB-I-INTEREST            PIC XX.
  4039             20  PB-I-MORT-TYP            PIC X.
  4040         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4041         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4042         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  72
* EL6317.cbl
  4043         16  PB-I-INDV-GRP-OVRD           PIC X.
  4044         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4045         16  PB-I-SIG-SW                  PIC X.
  4046             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4047         16  PB-I-RATE-CLASS              PIC XX.
  4048         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4049         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4050         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4051         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4052         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4053         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4054         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4055         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4056         16  PB-I-OB-FLAG                 PIC X.
  4057             88  PB-I-OB                      VALUE 'B'.
  4058             88  PB-I-SUMMARY                 VALUE 'Z'.
  4059         16  PB-I-ENTRY-STATUS            PIC X.
  4060             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4061                                              'M' '5' '9' '2'.
  4062             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4063             88  PB-I-POLICY-PENDING          VALUE '2'.
  4064             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4065             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4066             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4067             88  PB-I-REIN-ONLY               VALUE '9'.
  4068             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4069             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4070             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4071             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4072         16  PB-I-INT-CODE                PIC X.
  4073             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4074             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4075         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4076         16  PB-I-SOC-SEC-NO              PIC X(11).
  4077         16  PB-I-MEMBER-NO               PIC X(12).
  4078         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4079*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4080         16  PB-I-OLD-LOF                 PIC XXX.
  4081         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4082         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4083         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4084         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4085         16  PB-I-LIFE-INDICATOR          PIC X.
  4086             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4087         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4088         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4089                                          PIC S9(5)V99    COMP-3.
  4090         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4091             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4092             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4093         16  PB-I-1ST-PMT-DT              PIC XX.
  4094         16  PB-I-JOINT-INSURED.
  4095             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4096             20 PB-I-JOINT-FIRST-NAME.
  4097                24  PB-I-JOINT-FIRST-INIT PIC X.
  4098                24  FILLER                PIC X(9).
  4099             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4100*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  73
* EL6317.cbl
  4101         16  PB-I-BENEFICIARY-NAME.
  4102             20  PB-I-BANK-NUMBER         PIC X(10).
  4103             20  FILLER                   PIC X(15).
  4104         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4105         16  PB-I-REFERENCE               PIC X(12).
  4106         16  FILLER REDEFINES PB-I-REFERENCE.
  4107             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4108             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4109             20  PB-I-CLP-STATE           PIC XX.
  4110         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4111             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4112             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4113             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4114         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4115         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4116         16  PB-I-RESIDENT-STATE          PIC XX.
  4117         16  PB-I-RATE-CODE               PIC X(4).
  4118         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4119         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4120         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4121         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4122         16  PB-I-BANK-NOCHRGB            PIC 99.
  4123         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4124         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4125
  4126     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4127         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4128             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4129         16  PB-C-CANCEL-ORIGIN           PIC X.
  4130             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4131         16  PB-C-LF-CANCEL-DT            PIC XX.
  4132         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4133         16  PB-C-LF-CALC-REQ             PIC X.
  4134             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4135         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4136         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4137         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4138             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4139         16  PB-C-AH-CANCEL-DT            PIC XX.
  4140         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4141         16  PB-C-AH-CALC-REQ             PIC X.
  4142             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4143         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4144         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4145         16  PB-C-LAST-NAME               PIC X(15).
  4146         16  PB-C-REFUND-SW               PIC X.
  4147             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4148             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4149         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4150         16  PB-C-PAYEE-CODE              PIC X(6).
  4151         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4152         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4153         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4154         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4155         16  PB-C-REFERENCE               PIC X(12).
  4156         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4157         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4158         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  74
* EL6317.cbl
  4159         16  PB-C-CANCEL-REASON           PIC X.
  4160         16  PB-C-REF-INTERFACE-SW        PIC X.
  4161         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4162         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4163         16  FILLER                       PIC X(01).
  4164*        16  FILLER                       PIC X(18).
  4165         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4166*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4167         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4168         16  PB-CANCELED-CERT-DATA.
  4169             20  PB-CI-INSURED-NAME.
  4170                 24  PB-CI-LAST-NAME      PIC X(15).
  4171                 24  PB-CI-INITIALS       PIC XX.
  4172             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4173             20  PB-CI-INSURED-SEX        PIC X.
  4174             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4175             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4176             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4177             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4178             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4179             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4180             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4181             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4182             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4183             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4184             20  PB-CI-RATE-CLASS         PIC XX.
  4185             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4186             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4187             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4188             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4189             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4190             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4191             20  PB-CI-LF-ABBR            PIC X(3).
  4192             20  PB-CI-AH-ABBR            PIC X(3).
  4193             20  PB-CI-OB-FLAG            PIC X.
  4194                 88  PB-CI-OB                VALUE 'B'.
  4195             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4196                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4197                                           'M' '4' '5' '9' '2'.
  4198                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4199                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4200                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4201                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4202                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4203                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4204                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4205                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4206                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4207                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4208                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4209                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4210             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4211                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4212                                           'M' '4' '5' '9' '2'.
  4213                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4214                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4215                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4216                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  75
* EL6317.cbl
  4217                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4218                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4219                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4220                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4221                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4222                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4223                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4224                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4225             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4226             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4227             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4228             20  PB-CI-MEMBER-NO          PIC X(12).
  4229             20  PB-CI-INT-CODE           PIC X.
  4230                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4231                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4232             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4233             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4234             20  PB-CI-COMP-EXCP-SW       PIC X.
  4235                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4236                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4237             20  PB-CI-ENTRY-STATUS       PIC X.
  4238             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4239             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4240             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4241             20  PB-CI-DEATH-DT           PIC XX.
  4242             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4243             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4244             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4245             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4246             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4247             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4248             20  PB-CI-ENTRY-DT              PIC XX.
  4249             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4250             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4251             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4252             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4253             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4254             20  PB-CI-OLD-LOF               PIC XXX.
  4255*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4256             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4257             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4258             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4259             20  PB-CI-INDV-GRP-CD           PIC X.
  4260             20  PB-CI-BENEFICIARY-NAME.
  4261                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4262                 24  FILLER                  PIC X(15).
  4263             20  PB-CI-NOTE-SW               PIC X.
  4264             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4265             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4266             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4267             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4268             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4269             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4270             20  PB-CI-FIRST-NAME            PIC X(10).
  4271             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4272
  4273         16  FILLER                       PIC X(13).
  4274*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  76
* EL6317.cbl
  4275*        16  FILLER                       PIC X(46).
  4276
  4277     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4278         16  FILLER                       PIC X(10).
  4279         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4280         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4281         16  PB-M-INSURED-MID-INIT        PIC X.
  4282         16  PB-M-INSURED-AGE             PIC 99.
  4283         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4284         16  PB-M-INSURED-SEX             PIC X.
  4285         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4286         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4287         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4288         16  PB-M-INSURED-CITY-STATE.
  4289             20  PB-M-INSURED-CITY        PIC X(28).
  4290             20  PB-M-INSURED-STATE       PIC XX.
  4291         16  PB-M-INSURED-ZIP-CODE.
  4292             20  PB-M-INSURED-ZIP-PRIME.
  4293                 24  PB-M-INSURED-ZIP-1   PIC X.
  4294                     88  PB-M-CANADIAN-POST-CODE
  4295                                             VALUE 'A' THRU 'Z'.
  4296                 24  FILLER               PIC X(4).
  4297             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4298         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4299                                        PB-M-INSURED-ZIP-CODE.
  4300             20  PM-M-INS-CAN-POST1       PIC XXX.
  4301             20  PM-M-INS-CAN-POST2       PIC XXX.
  4302             20  FILLER                   PIC XXX.
  4303         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4304         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4305         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4306         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4307         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4308         16  PB-M-CRED-BENE-CITYST.
  4309             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4310             20  PB-M-CRED-BENE-STATE     PIC XX.
  4311         16  FILLER                       PIC X(92).
  4312
  4313     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4314         16  FILLER                       PIC X(10).
  4315         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4316         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4317         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4318         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4319         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4320         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4321         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4322         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4323         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4324         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4325         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4326         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4327         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4328         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4329         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4330         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4331         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4332         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  77
* EL6317.cbl
  4333         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4334         16  PB-REFERENCE                 PIC X(12).
  4335         16  PB-B-RECEIVED-DT             PIC XX.
  4336         16  FILLER                       PIC X(234).
  4337
  4338     12  PB-RECORD-STATUS.
  4339         16  PB-CREDIT-SELECT-DT          PIC XX.
  4340         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4341         16  PB-BILLED-DT                 PIC XX.
  4342         16  PB-BILLING-STATUS            PIC X.
  4343             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4344             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4345             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4346         16  PB-RECORD-BILL               PIC X.
  4347             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4348             88  PB-RECORD-RETURNED           VALUE 'R'.
  4349             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4350             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4351             88  PB-OVERRIDE-AH               VALUE 'A'.
  4352             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4353         16  PB-BATCH-ENTRY               PIC X.
  4354             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4355             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4356             88  PB-REISSUED-CERT             VALUE 'E'.
  4357             88  PB-MONTHLY-CERT              VALUE 'M'.
  4358             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4359             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4360             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4361         16  PB-FORCE-CODE                PIC X.
  4362             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4363             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4364             88  PB-CANCEL-FORCE              VALUE '8'.
  4365             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4366             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4367             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4368             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4369             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4370             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4371             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4372         16  PB-FATAL-FLAG                PIC X.
  4373             88  PB-FATAL-ERRORS              VALUE 'X'.
  4374         16  PB-FORCE-ER-CD               PIC X.
  4375             88  PB-FORCE-ERRORS              VALUE 'F'.
  4376             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4377         16  PB-WARN-ER-CD                PIC X.
  4378             88  PB-WARNING-ERRORS            VALUE 'W'.
  4379         16  FILLER                       PIC X.
  4380         16  PB-OUT-BAL-CD                PIC X.
  4381             88  PB-OUT-OF-BAL                VALUE 'O'.
  4382         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4383         16  PB-AH-OVERRIDE-L1            PIC X.
  4384         16  PB-INPUT-DT                  PIC XX.
  4385         16  PB-INPUT-BY                  PIC X(4).
  4386         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4387         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4388         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4389         16  PB-LF-EARNING-METHOD         PIC X.
  4390         16  PB-AH-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  78
* EL6317.cbl
  4391         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4392         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4393         16  PB-REIN-CD                   PIC XXX.
  4394         16  PB-LF-REFUND-TYPE            PIC X.
  4395         16  PB-AH-REFUND-TYPE            PIC X.
  4396         16  PB-ACCT-EFF-DT               PIC XX.
  4397         16  PB-ACCT-EXP-DT               PIC XX.
  4398         16  PB-COMPANY-ID                PIC X(3).
  4399         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4400         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4401         16  PB-SV-CARRIER                PIC X.
  4402         16  PB-SV-GROUPING               PIC X(6).
  4403         16  PB-SV-STATE                  PIC XX.
  4404         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4405         16  PB-GA-BILLING-INFO.
  4406             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4407                                          PIC XX.
  4408         16  PB-SV-REMIT-TO  REDEFINES
  4409             PB-GA-BILLING-INFO           PIC X(10).
  4410         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4411         16  PB-I-LOAN-OFFICER            PIC X(5).
  4412         16  PB-I-VIN                     PIC X(17).
  4413
  4414         16  FILLER                       PIC X(04).
  4415         16  IMNET-BYPASS-SW              PIC X.
  4416
  4417******************************************************************
  4418*                COMMON EDIT ERRORS                              *
  4419******************************************************************
  4420
  4421     12  PB-COMMON-ERRORS.
  4422         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4423                                           PIC S9(4)     COMP.
  4424
  4425******************************************************************
  4426*                                COPY ELCCERT.
  4427******************************************************************
  4428*                                                                *
  4429*                            ELCCERT.                            *
  4430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4431*                            VMOD=2.013                          *
  4432*                                                                *
  4433*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4434*                                                                *
  4435*   FILE TYPE = VSAM,KSDS                                        *
  4436*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4437*                                                                *
  4438*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4439*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4440*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4441*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4442*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4443*                                                                *
  4444*   LOG = YES                                                    *
  4445*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4446******************************************************************
  4447*                   C H A N G E   L O G
  4448*
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  79
* EL6317.cbl
  4449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4450*-----------------------------------------------------------------
  4451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4452* EFFECTIVE    NUMBER
  4453*-----------------------------------------------------------------
  4454* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4455* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4456* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4457* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4458* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4459* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4460* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4461* 032612  CR2011110200001  PEMA  AHL CHANGES
  4462******************************************************************
  4463
  4464 01  CERTIFICATE-MASTER.
  4465     12  CM-RECORD-ID                      PIC XX.
  4466         88  VALID-CM-ID                      VALUE 'CM'.
  4467
  4468     12  CM-CONTROL-PRIMARY.
  4469         16  CM-COMPANY-CD                 PIC X.
  4470         16  CM-CARRIER                    PIC X.
  4471         16  CM-GROUPING.
  4472             20  CM-GROUPING-PREFIX        PIC X(3).
  4473             20  CM-GROUPING-PRIME         PIC X(3).
  4474         16  CM-STATE                      PIC XX.
  4475         16  CM-ACCOUNT.
  4476             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4477             20  CM-ACCOUNT-PRIME          PIC X(6).
  4478         16  CM-CERT-EFF-DT                PIC XX.
  4479         16  CM-CERT-NO.
  4480             20  CM-CERT-PRIME             PIC X(10).
  4481             20  CM-CERT-SFX               PIC X.
  4482
  4483     12  CM-CONTROL-BY-NAME.
  4484         16  CM-COMPANY-CD-A1              PIC X.
  4485         16  CM-INSURED-LAST-NAME          PIC X(15).
  4486         16  CM-INSURED-INITIALS.
  4487             20  CM-INSURED-INITIAL1       PIC X.
  4488             20  CM-INSURED-INITIAL2       PIC X.
  4489
  4490     12  CM-CONTROL-BY-SSN.
  4491         16  CM-COMPANY-CD-A2              PIC X.
  4492         16  CM-SOC-SEC-NO.
  4493             20  CM-SSN-STATE              PIC XX.
  4494             20  CM-SSN-ACCOUNT            PIC X(6).
  4495             20  CM-SSN-LN3.
  4496                 25  CM-INSURED-INITIALS-A2.
  4497                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4498                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4499                 25 CM-PART-LAST-NAME-A2         PIC X.
  4500
  4501     12  CM-CONTROL-BY-CERT-NO.
  4502         16  CM-COMPANY-CD-A4              PIC X.
  4503         16  CM-CERT-NO-A4                 PIC X(11).
  4504
  4505     12  CM-CONTROL-BY-MEMB.
  4506         16  CM-COMPANY-CD-A5              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  80
* EL6317.cbl
  4507         16  CM-MEMBER-NO.
  4508             20  CM-MEMB-STATE             PIC XX.
  4509             20  CM-MEMB-ACCOUNT           PIC X(6).
  4510             20  CM-MEMB-LN4.
  4511                 25  CM-INSURED-INITIALS-A5.
  4512                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4513                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4514                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4515
  4516     12  CM-INSURED-PROFILE-DATA.
  4517         16  CM-INSURED-FIRST-NAME.
  4518             20  CM-INSURED-1ST-INIT       PIC X.
  4519             20  FILLER                    PIC X(9).
  4520         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4521         16  CM-INSURED-SEX                PIC X.
  4522             88  CM-SEX-MALE                  VALUE 'M'.
  4523             88  CM-SEX-FEMAL                 VALUE 'F'.
  4524         16  CM-INSURED-JOINT-AGE          PIC 99.
  4525         16  CM-JOINT-INSURED-NAME.
  4526             20  CM-JT-LAST-NAME           PIC X(15).
  4527             20  CM-JT-FIRST-NAME.
  4528                 24  CM-JT-1ST-INIT        PIC X.
  4529                 24  FILLER                PIC X(9).
  4530             20  CM-JT-INITIAL             PIC X.
  4531
  4532     12  CM-LIFE-DATA.
  4533         16  CM-LF-BENEFIT-CD              PIC XX.
  4534         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4535         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4536         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4537         16  CM-LF-DEV-CODE                PIC XXX.
  4538         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4539         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4540         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4541         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4542         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4543         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4544         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4545         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4546         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4547         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4548         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4549         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4550         16  FILLER                        PIC XX.
  4551
  4552     12  CM-AH-DATA.
  4553         16  CM-AH-BENEFIT-CD              PIC XX.
  4554         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4555         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4556         16  CM-AH-DEV-CODE                PIC XXX.
  4557         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4558         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4559         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4560         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4561         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4562         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4563         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4564         16  CM-AH-PAID-THRU-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  81
* EL6317.cbl
  4565             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4566         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4567         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4568         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4569         16  FILLER                        PIC X.
  4570
  4571     12  CM-LOAN-INFORMATION.
  4572         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4573         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4574                                           PIC S9(5)V99  COMP-3.
  4575         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4576         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4577         16  CM-PAY-FREQUENCY              PIC S99.
  4578         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4579         16  CM-RATE-CLASS                 PIC XX.
  4580         16  CM-BENEFICIARY                PIC X(25).
  4581         16  CM-POLICY-FORM-NO             PIC X(12).
  4582         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4583         16  CM-LAST-ADD-ON-DT             PIC XX.
  4584         16  CM-DEDUCTIBLE-AMOUNTS.
  4585             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4586             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4587         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4588             20  CM-RESIDENT-STATE         PIC XX.
  4589             20  CM-RATE-CODE              PIC X(4).
  4590             20  FILLER                    PIC XX.
  4591         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4592             20  CM-LOAN-OFFICER           PIC X(5).
  4593             20  FILLER                    PIC XXX.
  4594         16  CM-CSR-CODE                   PIC XXX.
  4595         16  CM-UNDERWRITING-CODE          PIC X.
  4596             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4597         16  CM-POST-CARD-IND              PIC X.
  4598         16  CM-NH-INTERFACE-SW            PIC X.
  4599         16  CM-PREMIUM-TYPE               PIC X.
  4600             88  CM-SING-PRM                  VALUE '1'.
  4601             88  CM-O-B-COVERAGE              VALUE '2'.
  4602             88  CM-OPEN-END                  VALUE '3'.
  4603         16  CM-IND-GRP-TYPE               PIC X.
  4604             88  CM-INDIVIDUAL                VALUE 'I'.
  4605             88  CM-GROUP                     VALUE 'G'.
  4606         16  CM-SKIP-CODE                  PIC X.
  4607             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4608             88  SKIP-JULY                    VALUE '1'.
  4609             88  SKIP-AUGUST                  VALUE '2'.
  4610             88  SKIP-SEPTEMBER               VALUE '3'.
  4611             88  SKIP-JULY-AUG                VALUE '4'.
  4612             88  SKIP-AUG-SEPT                VALUE '5'.
  4613             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4614             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4615             88  SKIP-JUNE                    VALUE '8'.
  4616             88  SKIP-JUNE-JULY               VALUE '9'.
  4617             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4618             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4619         16  CM-PAYMENT-MODE               PIC X.
  4620             88  PAY-MONTHLY                  VALUE SPACE.
  4621             88  PAY-WEEKLY                   VALUE '1'.
  4622             88  PAY-SEMI-MONTHLY             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  82
* EL6317.cbl
  4623             88  PAY-BI-WEEKLY                VALUE '3'.
  4624             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4625         16  CM-LOAN-NUMBER                PIC X(8).
  4626         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4627         16  CM-OLD-LOF                    PIC XXX.
  4628*        16  CM-LOAN-OFFICER               PIC XXX.
  4629         16  CM-REIN-TABLE                 PIC XXX.
  4630         16  CM-SPECIAL-REIN-CODE          PIC X.
  4631         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4632         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4633         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4634
  4635     12  CM-STATUS-DATA.
  4636         16  CM-ENTRY-STATUS               PIC X.
  4637         16  CM-ENTRY-DT                   PIC XX.
  4638
  4639         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4640         16  CM-LF-CANCEL-DT               PIC XX.
  4641         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4642
  4643         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4644         16  CM-LF-DEATH-DT                PIC XX.
  4645         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4646
  4647         16  CM-LF-CURRENT-STATUS          PIC X.
  4648             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4649                                                'M' '4' '5' '9'.
  4650             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4651             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4652             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4653             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4654             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4655             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4656             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4657             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4658             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4659             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4660             88  CM-LF-DECLINED               VALUE 'D'.
  4661             88  CM-LF-VOIDED                 VALUE 'V'.
  4662
  4663         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4664         16  CM-AH-CANCEL-DT               PIC XX.
  4665         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4666
  4667         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4668         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4669         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4670
  4671         16  CM-AH-CURRENT-STATUS          PIC X.
  4672             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4673                                                'M' '4' '5' '9'.
  4674             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4675             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4676             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4677             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4678             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4679             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4680             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  83
* EL6317.cbl
  4681             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4682             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4683             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4684             88  CM-AH-DECLINED               VALUE 'D'.
  4685             88  CM-AH-VOIDED                 VALUE 'V'.
  4686
  4687         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4688             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4689             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4690             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4691         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4692
  4693         16  CM-ENTRY-BATCH                PIC X(6).
  4694         16  CM-LF-EXIT-BATCH              PIC X(6).
  4695         16  CM-AH-EXIT-BATCH              PIC X(6).
  4696         16  CM-LAST-MONTH-END             PIC XX.
  4697
  4698     12  CM-NOTE-SW                        PIC X.
  4699         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4700         88  CERT-NOTES-PRESENT               VALUE '1'.
  4701         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4702         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4703         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4704         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4705         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4706         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4707     12  CM-COMP-EXCP-SW                   PIC X.
  4708         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4709         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4710     12  CM-INSURED-ADDRESS-SW             PIC X.
  4711         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4712         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4713
  4714*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4715     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4716     12  FILLER                            PIC X.
  4717
  4718*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4719     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4720     12  FILLER                            PIC X.
  4721*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4722     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4723
  4724     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4725         88  CERT-ADDED-BATCH                 VALUE ' '.
  4726         88  CERT-ADDED-ONLINE                VALUE '1'.
  4727         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4728         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4729         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4730     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4731         88  CERT-AS-LOADED                   VALUE ' '.
  4732         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4733         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4734         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4735         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4736         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4737         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4738         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  84
* EL6317.cbl
  4739
  4740     12  CM-ACCOUNT-COMM-PCTS.
  4741         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4742         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4743
  4744     12  CM-USER-FIELD                     PIC X.
  4745     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4746     12  CM-CLP-STATE                      PIC XX.
  4747     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4748     12  CM-USER-RESERVED                  PIC XXX.
  4749     12  FILLER REDEFINES CM-USER-RESERVED.
  4750         16  CM-AH-CLASS-CD                PIC XX.
  4751         16  F                             PIC X.
  4752******************************************************************
  4753*                                COPY ELCCRTO.
  4754******************************************************************
  4755*                                                                *
  4756*                            ELCCRTO.                            *
  4757*                                                                *
  4758*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4759*                                                                *
  4760*   FILE TYPE = VSAM,KSDS                                        *
  4761*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4762*                                                                *
  4763*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4764*                                                                *
  4765*   LOG = YES                                                    *
  4766*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4767******************************************************************
  4768*                   C H A N G E   L O G
  4769*
  4770* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4771*-----------------------------------------------------------------
  4772*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4773* EFFECTIVE    NUMBER
  4774*-----------------------------------------------------------------
  4775* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4776* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4777* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4778* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4779******************************************************************
  4780 01  ORIGINAL-CERTIFICATE.
  4781     12  OC-RECORD-ID                      PIC XX.
  4782         88  VALID-OC-ID                      VALUE 'OC'.
  4783     12  OC-CONTROL-PRIMARY.
  4784         16  OC-COMPANY-CD                 PIC X.
  4785         16  OC-CARRIER                    PIC X.
  4786         16  OC-GROUPING                   PIC X(6).
  4787         16  OC-STATE                      PIC XX.
  4788         16  OC-ACCOUNT                    PIC X(10).
  4789         16  OC-CERT-EFF-DT                PIC XX.
  4790         16  OC-CERT-NO.
  4791             20  OC-CERT-PRIME             PIC X(10).
  4792             20  OC-CERT-SFX               PIC X.
  4793         16  OC-RECORD-TYPE                PIC X.
  4794         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4795     12  OC-LAST-MAINT-DT                  PIC XX.
  4796     12  OC-LAST-MAINT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  85
* EL6317.cbl
  4797     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4798     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4799     12  FILLER                            PIC X(49).
  4800     12  OC-ORIG-REC.
  4801         16  OC-INS-LAST-NAME              PIC X(15).
  4802         16  OC-INS-FIRST-NAME             PIC X(10).
  4803         16  OC-INS-MIDDLE-INIT            PIC X.
  4804         16  OC-INS-AGE                    PIC S999     COMP-3.
  4805         16  OC-JNT-LAST-NAME              PIC X(15).
  4806         16  OC-JNT-FIRST-NAME             PIC X(10).
  4807         16  OC-JNT-MIDDLE-INIT            PIC X.
  4808         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4809         16  OC-LF-BENCD                   PIC XX.
  4810         16  OC-LF-TERM                    PIC S999      COMP-3.
  4811         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4812         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4813         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4814         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4815         16  OC-LF-EXP-DT                  PIC XX.
  4816         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4817         16  OC-LF-CANCEL-DT               PIC XX.
  4818         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4819         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4820         16  OC-AH-BENCD                   PIC XX.
  4821         16  OC-AH-TERM                    PIC S999      COMP-3.
  4822         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4823         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4824         16  OC-AH-EXP-DT                  PIC XX.
  4825         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4826         16  OC-AH-CP                      PIC 99.
  4827         16  OC-AH-CANCEL-DT               PIC XX.
  4828         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4829         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4830         16  OC-CRED-BENE-NAME             PIC X(25).
  4831         16  OC-1ST-PMT-DT                 PIC XX.
  4832         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4833         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4834         16  FILLER                        PIC X(213).
  4835
  4836     12  FILLER                            PIC X(50).
  4837******************************************************************
  4838*                                COPY ERCENDT.
  4839******************************************************************
  4840*                                                                *
  4841*                                                                *
  4842*                            ERCENDT.                            *
  4843*                            VMOD=2.001                          *
  4844*                                                                *
  4845*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4846*                                                                *
  4847*   FILE TYPE = VSAM,KSDS                                        *
  4848*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4849*                                                                *
  4850*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4851*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4852*                                                                *
  4853*   LOG = NO                                                     *
  4854*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  86
* EL6317.cbl
  4855******************************************************************
  4856*-----------------------------------------------------------------
  4857*                   C H A N G E   L O G
  4858*
  4859* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4860*-----------------------------------------------------------------
  4861*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4862* EFFECTIVE    NUMBER
  4863*-----------------------------------------------------------------
  4864* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4865*                                WITH OPEN CLAIMS
  4866* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4867* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4868* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4869*-----------------------------------------------------------------
  4870 01  ENDORSEMENT-RECORD.
  4871     12  EN-RECORD-ID                PIC XX.
  4872         88  VALID-EN-ID                VALUE 'EN'.
  4873     12  EN-CONTROL-PRIMARY.
  4874         16  EN-COMPANY-CD           PIC X.
  4875         16  EN-CARRIER              PIC X.
  4876         16  EN-GROUPING             PIC X(6).
  4877         16  EN-STATE                PIC XX.
  4878         16  EN-ACCOUNT              PIC X(10).
  4879         16  EN-CERT-EFF-DT          PIC XX.
  4880         16  EN-CERT-NO.
  4881             20  EN-CERT-PRIME       PIC X(10).
  4882             20  EN-CERT-SFX         PIC X.
  4883         16  EN-REC-TYPE             PIC X.
  4884             88  EN-ISSUE               VALUE 'I'.
  4885             88  EN-CANCELLATION        VALUE 'C'.
  4886         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4887     12  EN-CONTROL-BY-ARCH-NO.
  4888         16  EN-COMPANY-CD-A1              PIC X.
  4889         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4890     12  EN-LAST-MAINT-DT            PIC XX.
  4891     12  EN-LAST-MAINT-BY            PIC X(4).
  4892     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4893     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4894     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4895         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4896         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4897         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  4898         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  4899         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  4900         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  4901         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  4902         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  4903         16  EN-LF-ORIG-BENCD        PIC XX.
  4904         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  4905         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4906         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4907         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  4908         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  4909         16  EN-LF-ORIG-EXP-DT       PIC XX.
  4910*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  4911         16  EN-ORIG-CRED-BENE       PIC X(25).
  4912         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  87
* EL6317.cbl
  4913         16  FILLER                  PIC X.
  4914         16  EN-AH-ORIG-BENCD        PIC XX.
  4915         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  4916         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  4917         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  4918         16  EN-AH-ORIG-EXP-DT       PIC XX.
  4919*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  4920*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  4921         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  4922         16  F                       PIC X(09).
  4923         16  EN-AH-ORIG-CP           PIC 99.
  4924         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  4925         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  4926         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  4927         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  4928         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  4929         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  4930         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  4931         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  4932         16  EN-LF-NEW-BENCD         PIC XX.
  4933         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  4934         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4935         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4936         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  4937         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  4938         16  EN-LF-NEW-EXP-DT        PIC XX.
  4939         16  EN-NEW-CRED-BENE        PIC X(25).
  4940         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4941         16  FILLER                  PIC X.
  4942         16  EN-AH-NEW-BENCD         PIC XX.
  4943         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  4944         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  4945         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  4946         16  EN-AH-NEW-EXP-DT        PIC XX.
  4947*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  4948*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  4949*        16  F                       PIC X(12).
  4950         16  EN-AH-NEW-CP            PIC 99.
  4951         16  EN-SIG-SW               PIC X.
  4952         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  4953         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  4954         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  4955         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  4956         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  4957         16  FILLER                  PIC X(33).
  4958     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4959         16  EN-LF-ORIG-REF-DT       PIC XX.
  4960         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4961         16  EN-AH-ORIG-REF-DT       PIC XX.
  4962         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  4963         16  EN-LF-NEW-REF-DT        PIC XX.
  4964         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4965         16  EN-AH-NEW-REF-DT        PIC XX.
  4966         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  4967         16  EN-FLAG-CERT            PIC X.
  4968         16  EN-INS-LAST-NAME        PIC X(15).
  4969         16  EN-INS-FIRST-NAME       PIC X(10).
  4970         16  EN-INS-MIDDLE-INIT      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  88
* EL6317.cbl
  4971         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4972         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  4973         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4974         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  4975         16  FILLER                  PIC X(262).
  4976     12  EN-MONEY-SW             PIC X.
  4977     12  EN-HEALTH-APP           PIC X.
  4978     12  EN-VOUCHER-SW           PIC X.
  4979     12  EN-PAYEE                PIC X(14).
  4980     12  EN-INPUT-DT             PIC XX.
  4981     12  EN-PROCESS-DT           PIC XX.
  4982     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  4983     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  4984     12  EN-REASON-CODES.
  4985         16  F OCCURS 12.
  4986             20  EN-REASON-CODE  PIC X(4).
  4987     12  EN-TEMPLATE-USED        PIC X(8).
  4988     12  EN-DOCU-TYPE            PIC X.
  4989         88  EN-VERI-DOCU          VALUE 'V'.
  4990         88  EN-GCE-DOCU           VALUE 'G'.
  4991         88  EN-CANC-DOCU          VALUE 'C'.
  4992     12  EN-COMMENTS1            PIC X(13).
  4993     12  EN-COMMENTS2            PIC X(70).
  4994     12  EN-COMM-CHGBK           PIC X.
  4995         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  4996         88  EN-CHG-ACCT           VALUE 'Y'.
  4997     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  4998     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  4999     12  EN-BATCH-NUMBER         PIC X(6).
  5000     12  EN-ACCT-SUMM            PIC X.
  5001     12  EN-CSO-SUMM             PIC X.
  5002     12  FILLER                  PIC X(13).
  5003******************************************************************
  5004*                                COPY ERCNOTE.
  5005******************************************************************
  5006*                                                                *
  5007*                                                                *
  5008*                            ERCNOTE                             *
  5009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5010*                            VMOD=2.003                          *
  5011*                                                                *
  5012*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5013*                                                                *
  5014*        FILE TYPE= VSAM,KSDS                                    *
  5015*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5016*                                                                *
  5017*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5018*                                                                *
  5019*        LOG = YES                                               *
  5020*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5021*                                                                *
  5022******************************************************************
  5023*                   C H A N G E   L O G
  5024*
  5025* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5026*-----------------------------------------------------------------
  5027*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5028* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  89
* EL6317.cbl
  5029*-----------------------------------------------------------------
  5030* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5031*                                FILE WILL CONTAIN BILLING NOTES O
  5032******************************************************************
  5033
  5034 01  CERTIFICATE-NOTE.
  5035     12  CN-RECORD-ID                PIC  XX.
  5036         88  VALID-CN-ID                  VALUE 'CN'.
  5037
  5038     12  CN-CONTROL-PRIMARY.
  5039         16  CN-COMPANY-CD           PIC X.
  5040         16  CN-CARRIER              PIC X.
  5041         16  CN-GROUPING.
  5042             20 CN-GROUPING-PREFIX   PIC XXX.
  5043             20 CN-GROUPING-PRIME    PIC XXX.
  5044         16  CN-STATE                PIC XX.
  5045         16  CN-ACCOUNT.
  5046             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5047             20 CN-ACCOUNT-PRIME     PIC X(6).
  5048         16  CN-CERT-EFF-DT          PIC XX.
  5049         16  CN-CERT-NO.
  5050             20  CN-CERT-PRIME       PIC X(10).
  5051             20  CN-CERT-SFX         PIC X.
  5052
  5053     12  CN-BILLING-START-LINE-NO    PIC 99.
  5054     12  CN-BILLING-END-LINE-NO      PIC 99.
  5055
  5056     12  CN-LINES.
  5057         16  CN-LINE OCCURS 10       PIC X(77).
  5058
  5059     12  CN-LAST-MAINT-DT            PIC XX.
  5060     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5061     12  CN-LAST-MAINT-USER          PIC X(4).
  5062     12  FILLER                      PIC X(6).
  5063******************************************************************
  5064*                                COPY ERCMAIL.
  5065******************************************************************
  5066*                                                                *
  5067*                                                                *
  5068*                            ERCMAIL                             *
  5069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5070*                            VMOD=2.003                          *
  5071*                                                                *
  5072*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5073*                                                                *
  5074*   FILE TYPE = VSAM,KSDS                                        *
  5075*   RECORD SIZE = 374   RECFORM = FIX                            *
  5076*                                                                *
  5077*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5078*   ALTERNATE PATH    = NOT USED                                 *
  5079*                                                                *
  5080*   LOG = YES                                                    *
  5081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5082******************************************************************
  5083*                   C H A N G E   L O G
  5084*
  5085* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5086*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  90
* EL6317.cbl
  5087*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5088* EFFECTIVE    NUMBER
  5089*-----------------------------------------------------------------
  5090* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5091* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5092* 111108                   PEMA  ADD CRED BENE ADDR2
  5093******************************************************************
  5094
  5095 01  MAILING-DATA.
  5096     12  MA-RECORD-ID                      PIC XX.
  5097         88  VALID-MA-ID                       VALUE 'MA'.
  5098
  5099     12  MA-CONTROL-PRIMARY.
  5100         16  MA-COMPANY-CD                 PIC X.
  5101         16  MA-CARRIER                    PIC X.
  5102         16  MA-GROUPING.
  5103             20  MA-GROUPING-PREFIX        PIC XXX.
  5104             20  MA-GROUPING-PRIME         PIC XXX.
  5105         16  MA-STATE                      PIC XX.
  5106         16  MA-ACCOUNT.
  5107             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5108             20  MA-ACCOUNT-PRIME          PIC X(6).
  5109         16  MA-CERT-EFF-DT                PIC XX.
  5110         16  MA-CERT-NO.
  5111             20  MA-CERT-PRIME             PIC X(10).
  5112             20  MA-CERT-SFX               PIC X.
  5113
  5114     12  FILLER                            PIC XX.
  5115
  5116     12  MA-ACCESS-CONTROL.
  5117         16  MA-SOURCE-SYSTEM              PIC XX.
  5118             88  MA-FROM-CREDIT                VALUE 'CR'.
  5119             88  MA-FROM-VSI                   VALUE 'VS'.
  5120             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5121             88  MA-FROM-OTHER                 VALUE 'OT'.
  5122         16  MA-RECORD-ADD-DT              PIC XX.
  5123         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5124         16  MA-LAST-MAINT-DT              PIC XX.
  5125         16  MA-LAST-MAINT-BY              PIC XXXX.
  5126         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5127
  5128     12  MA-PROFILE-INFO.
  5129         16  MA-QUALIFY-CODE-1             PIC XX.
  5130         16  MA-QUALIFY-CODE-2             PIC XX.
  5131         16  MA-QUALIFY-CODE-3             PIC XX.
  5132         16  MA-QUALIFY-CODE-4             PIC XX.
  5133         16  MA-QUALIFY-CODE-5             PIC XX.
  5134
  5135         16  MA-INSURED-LAST-NAME          PIC X(15).
  5136         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5137         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5138         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5139         16  MA-INSURED-BIRTH-DT           PIC XX.
  5140         16  MA-INSURED-SEX                PIC X.
  5141             88  MA-SEX-MALE                   VALUE 'M'.
  5142             88  MA-SEX-FEMALE                 VALUE 'F'.
  5143         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5144
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  91
* EL6317.cbl
  5145         16  MA-ADDRESS-CORRECTED          PIC X.
  5146         16  MA-JOINT-BIRTH-DT             PIC XX.
  5147*        16  FILLER                        PIC X(12).
  5148
  5149         16  MA-ADDRESS-LINE-1             PIC X(30).
  5150         16  MA-ADDRESS-LINE-2             PIC X(30).
  5151         16  MA-CITY-STATE.
  5152             20  MA-CITY                   PIC X(28).
  5153             20  MA-ADDR-STATE             PIC XX.
  5154         16  MA-ZIP.
  5155             20  MA-ZIP-CODE.
  5156                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5157                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5158                 24  FILLER                PIC X(4).
  5159             20  MA-ZIP-PLUS4              PIC X(4).
  5160         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5161             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5162             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5163             20  FILLER                    PIC X(3).
  5164
  5165         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5166
  5167         16  FILLER                        PIC XXX.
  5168*        16  FILLER                        PIC X(10).
  5169
  5170     12  MA-CRED-BENE-INFO.
  5171         16  MA-CRED-BENE-NAME                 PIC X(25).
  5172         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5173         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5174         16  MA-CRED-BENE-CTYST.
  5175             20  MA-CRED-BENE-CITY             PIC X(28).
  5176             20  MA-CRED-BENE-STATE            PIC XX.
  5177         16  MA-CRED-BENE-ZIP.
  5178             20  MA-CB-ZIP-CODE.
  5179                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5180                     88  MA-CB-CANADIAN-POST-CODE
  5181                                           VALUE 'A' THRU 'Z'.
  5182                 24  FILLER                    PIC X(4).
  5183             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5184         16  MA-CB-CANADIAN-POSTAL-CODE
  5185                            REDEFINES MA-CRED-BENE-ZIP.
  5186             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5187             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5188             20  FILLER                        PIC X(3).
  5189     12  MA-POST-CARD-MAIL-DATA.
  5190         16  MA-MAIL-DATA OCCURS 7.
  5191             20  MA-MAIL-TYPE              PIC X.
  5192                 88  MA-12MO-MAILING           VALUE '1'.
  5193                 88  MA-EXP-MAILING            VALUE '2'.
  5194             20  MA-MAIL-STATUS            PIC X.
  5195                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5196                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5197                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5198             20  MA-MAIL-DATE              PIC XX.
  5199     12  FILLER                            PIC XX.
  5200     12  FILLER                            PIC XX.
  5201*    12  FILLER                            PIC X(30).
  5202******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  92
* EL6317.cbl
  5203*                                COPY ERCARCH.
  5204******************************************************************
  5205*                                                                *
  5206*                            ERCARCH.                            *
  5207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5208*                            VMOD=2.002                          *
  5209*                                                                *
  5210*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5211*                                                                *
  5212*   FILE TYPE = VSAM,KSDS                                        *
  5213*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5214*                                                                *
  5215*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5216*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5217*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5218*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5219*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5220*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5221*                                                                *
  5222*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5223******************************************************************
  5224*                   C H A N G E   L O G
  5225*
  5226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5227*-----------------------------------------------------------------
  5228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5229* EFFECTIVE    NUMBER
  5230*-----------------------------------------------------------------
  5231* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5232* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5233* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5234******************************************************************
  5235 01  LETTER-ARCHIVE.
  5236     12  LA-RECORD-ID                PIC  X(02).
  5237         88  LA-VALID-ID                VALUE 'LA'.
  5238
  5239     12  LA-CONTROL-PRIMARY.
  5240         16  LA-COMPANY-CD           PIC  X(01).
  5241         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5242
  5243     12  LA-CONTROL-BY-CERT-RESP.
  5244         16  LA-COMPANY-CD-A2        PIC  X(01).
  5245         16  LA-CERT-NO-A2.
  5246             20  LA-CERT-PRIME-A2    PIC  X(10).
  5247             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5248         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5249             20  LA-RESP-PERSON-A2   PIC  X(10).
  5250             20  LA-TYPE-A2          PIC  X(01).
  5251         16  LA-CARRIER-A2           PIC  X(01).
  5252         16  LA-GROUPING-A2          PIC  X(06).
  5253         16  LA-STATE-A2             PIC  X(02).
  5254         16  LA-ACCOUNT-A2           PIC  X(10).
  5255         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5256         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5257
  5258     12  LA-CONTROL-BY-FORM.
  5259         16  LA-COMPANY-CD-A3        PIC  X(01).
  5260         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  93
* EL6317.cbl
  5261         16  LA-CARRIER-A3           PIC  X(01).
  5262         16  LA-GROUPING-A3          PIC  X(06).
  5263         16  LA-STATE-A3             PIC  X(02).
  5264         16  LA-ACCOUNT-A3           PIC  X(10).
  5265         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5266
  5267     12  LA-CONTROL-BY-PROCESSOR.
  5268         16  LA-COMPANY-CD-A4        PIC  X(01).
  5269         16  LA-PROCESSOR-CD         PIC  X(04).
  5270         16  LA-CARRIER-A4           PIC  X(01).
  5271         16  LA-GROUPING-A4          PIC  X(06).
  5272         16  LA-STATE-A4             PIC  X(02).
  5273         16  LA-ACCOUNT-A4           PIC  X(10).
  5274         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5275
  5276     12  LA-CONTROL-BY-KEY-FIELDS.
  5277         16  LA-COMPANY-CD-A5        PIC  X(01).
  5278         16  LA-CARRIER-A5           PIC  X(01).
  5279         16  LA-GROUPING-A5          PIC  X(06).
  5280         16  LA-STATE-A5             PIC  X(02).
  5281         16  LA-ACCOUNT-A5           PIC  X(10).
  5282         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5283
  5284     12  LA-CONTROL-BY-GROUP-CODE.
  5285         16  LA-COMPANY-CD-A6        PIC  X(01).
  5286         16  LA-ENTRY-A6.
  5287             20  LA-FILLER           PIC  X(02).
  5288             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5289         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5290
  5291     12  FILLER                      PIC  X(09).
  5292
  5293     12  LA-HEADER-RECORD.
  5294         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5295         16  LA-CREATION-DATE        PIC  X(02).
  5296         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5297         16  LA-FINAL-ACT-DATE       REDEFINES
  5298               LA-FOLLOW-UP-DATE     PIC  X(02).
  5299         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5300         16  LA-NO-OF-COPIES         PIC S9(01).
  5301         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5302         16  LA-REPLY-DATE           PIC  X(02).
  5303         16  LA-RESEND-DATES.
  5304             20  LA-RESEND-DATE      PIC  X(02).
  5305             20  LA-SENT-DATE        PIC  X(02).
  5306             20  FILLER              PIC  X(08).
  5307         16  LA-SOURCE-INFORMATION.
  5308             20  LA-DATA-SOURCE      PIC  X(01).
  5309             20  LA-ADDR-SOURCE      PIC  X(01).
  5310         16  LA-STATUS               PIC  X(01).
  5311             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5312             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5313             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5314             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5315             88  LA-STATUS-PURGED         VALUE 'P'.
  5316             88  LA-STATUS-VOIDED         VALUE 'V'.
  5317         16  LA-LAST-RESENT-PRINT-DATE
  5318                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  94
* EL6317.cbl
  5319         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5320             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5321                                          VALUE 'C'.
  5322             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5323                                          VALUE 'F'.
  5324             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5325                                          VALUE 'P'.
  5326         16  LA-PURGED-DATE          PIC  X(02).
  5327         16  LA-VOIDED-DATE          PIC  X(02).
  5328         16  LA-RESEND-LETR          PIC  X(4).
  5329         16  FILLER                  PIC  X(08).
  5330*        16  LA-RESEND-LETR-2        PIC  X(4).
  5331*        16  LA-RESEND-LETR-3        PIC  X(4).
  5332*        16  FILLER                  PIC  X(59).
  5333         16  LA-ARCHIVE-STATUS       PIC  X.
  5334             88  LA-TEMP                VALUE 'T'.
  5335             88  LA-QWS                 VALUE 'Q'.
  5336             88  LA-BATCH               VALUE 'B'.
  5337         16  LA-FINAL-ACT-IND        PIC  X(1).
  5338         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5339         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5340         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5341                                     PIC X(4).
  5342         16  FILLER                  PIC  X(42).
  5343*        16  FILLER                  PIC  X(71).
  5344         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5345         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5346         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5347                                     PIC  X(4).
  5348         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5349
  5350******************************************************************
  5351*                                COPY ERCCNOT.
  5352******************************************************************
  5353*                                                                *
  5354*                            ERCCNOT                             *
  5355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5356*                            VMOD=2.003                          *
  5357*                                                                *
  5358*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5359*                                                                *
  5360*        FILE TYPE= VSAM,KSDS                                    *
  5361*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5362*                                                                *
  5363*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5364*                                                                *
  5365*        LOG = YES                                               *
  5366*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5367*                                                                *
  5368******************************************************************
  5369*                   C H A N G E   L O G
  5370*
  5371* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5372*-----------------------------------------------------------------
  5373*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5374* EFFECTIVE    NUMBER
  5375*-----------------------------------------------------------------
  5376* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  95
* EL6317.cbl
  5377******************************************************************
  5378
  5379 01  CERT-NOTE-FILE.
  5380     12  CZ-RECORD-ID                PIC  XX.
  5381         88  VALID-CZ-ID                  VALUE 'CZ'.
  5382
  5383     12  CZ-CONTROL-PRIMARY.
  5384         16  CZ-COMPANY-CD           PIC X.
  5385         16  CZ-CARRIER              PIC X.
  5386         16  CZ-GROUPING.
  5387             20 CZ-GROUPING-PREFIX   PIC XXX.
  5388             20 CZ-GROUPING-PRIME    PIC XXX.
  5389         16  CZ-STATE                PIC XX.
  5390         16  CZ-ACCOUNT.
  5391             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5392             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5393         16  CZ-CERT-EFF-DT          PIC XX.
  5394         16  CZ-CERT-NO.
  5395             20  CZ-CERT-PRIME       PIC X(10).
  5396             20  CZ-CERT-SFX         PIC X.
  5397         16  CZ-RECORD-TYPE          PIC X.
  5398             88  CERT-NOTE           VALUE '1'.
  5399             88  CLAIM-CERT-NOTE     VALUE '2'.
  5400         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5401
  5402     12  CZ-LAST-MAINT-DT            PIC XX.
  5403     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5404     12  CZ-LAST-MAINT-USER          PIC X(4).
  5405
  5406     12  CZ-NOTE-INFORMATION.
  5407         16  CZ-NOTE                 PIC X(63).
  5408         16  FILLER                  PIC X(39).
  5409******************************************************************
  5410*                                COPY ELCEOBC.
  5411******************************************************************
  5412*                                                                *
  5413*                                                                *
  5414*                            ELCEOBC                             *
  5415*                            VMOD=2.001                          *
  5416*                                                                *
  5417*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5418*                                                                *
  5419*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5420*   VSAM EOB CODE TABLE                                          *
  5421*                                                                *
  5422*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5423*                                                                *
  5424*   FILE TYPE = VSAM,KSDS                                        *
  5425*   RECORD SIZE = 350   RECFORM = FIX                            *
  5426*                                                                *
  5427*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5428*                                                                *
  5429*   LOG = NO                                                     *
  5430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5431*                                                                *
  5432*                                                                *
  5433******************************************************************
  5434*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  96
* EL6317.cbl
  5435*
  5436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5437*-----------------------------------------------------------------
  5438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5439* EFFECTIVE    NUMBER
  5440*-----------------------------------------------------------------
  5441* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5442* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5443******************************************************************
  5444 01  EOB-CODES.
  5445     12  EO-RECORD-ID                      PIC XX.
  5446         88  VALID-DN-ID                      VALUE 'EO'.
  5447     12  EO-CONTROL-PRIMARY.
  5448         16  EO-COMPANY-CD                 PIC X.
  5449         16  EO-RECORD-TYPE                PIC X.
  5450             88  EO-EOB-RECS                  VALUE '1'.
  5451             88  EO-VERIF-RECS                VALUE '2'.
  5452             88  EO-GCE-RECS                  VALUE '3'.
  5453         16  EO-EOB-CODE                   PIC X(4).
  5454         16  FILLER                        PIC X(9).
  5455     12  EO-MAINT-INFORMATION.
  5456         16  EO-LAST-MAINT-DT              PIC XX.
  5457         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5458         16  EO-LAST-MAINT-USER            PIC X(4).
  5459         16  FILLER                        PIC XX.
  5460     12  EO-DESCRIPTION                    PIC X(275).
  5461     12  FILLER                            PIC X(46).
  5462******************************************************************
  5463*                                COPY ELCCRTT.
  5464******************************************************************
  5465*                                                                *
  5466*                            ELCCRTT.                            *
  5467*                                                                *
  5468*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5469*                                                                *
  5470*   FILE TYPE = VSAM,KSDS                                        *
  5471*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5472*                                                                *
  5473*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5474*                                                                *
  5475*   LOG = YES                                                    *
  5476*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5477******************************************************************
  5478*                   C H A N G E   L O G
  5479*
  5480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5481*-----------------------------------------------------------------
  5482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5483* EFFECTIVE    NUMBER
  5484*-----------------------------------------------------------------
  5485* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5486* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5487* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5488* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5489******************************************************************
  5490
  5491 01  CERTIFICATE-TRAILERS.
  5492     12  CS-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  97
* EL6317.cbl
  5493         88  VALID-CS-ID                      VALUE 'CS'.
  5494
  5495     12  CS-CONTROL-PRIMARY.
  5496         16  CS-COMPANY-CD                 PIC X.
  5497         16  CS-CARRIER                    PIC X.
  5498         16  CS-GROUPING                   PIC X(6).
  5499         16  CS-STATE                      PIC XX.
  5500         16  CS-ACCOUNT                    PIC X(10).
  5501         16  CS-CERT-EFF-DT                PIC XX.
  5502         16  CS-CERT-NO.
  5503             20  CS-CERT-PRIME             PIC X(10).
  5504             20  CS-CERT-SFX               PIC X.
  5505         16  CS-TRAILER-TYPE               PIC X.
  5506             88  COMM-TRLR           VALUE 'A'.
  5507             88  FUTURE-TRLR         VALUE 'B'.
  5508             88  CERT-DATA-TRLR      VALUE 'C'.
  5509
  5510     12  CS-DATA-AREA                      PIC X(516).
  5511
  5512     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5513         16  CS-BANK-COMMISSION-AREA.
  5514             20  CS-BANK-COMMS       OCCURS 10.
  5515                 24  CS-AGT                PIC X(10).
  5516                 24  CS-COM-TYP            PIC X.
  5517                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5518                 24  CS-RECALC-LV-INDIC    PIC X.
  5519                 24  FILLER                PIC X(10).
  5520         16  FILLER                        PIC X(256).
  5521
  5522     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5523         16  CS-VIN-NUMBER                 PIC X(17).
  5524         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5525         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5526         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5527         16  FILLER                        PIC X(496).
  5528******************************************************************
  5529 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5530                          ACCOUNT-MASTER CONTROL-FILE
  5531                          PENDING-BUSINESS CERTIFICATE-MASTER
  5532                          ORIGINAL-CERTIFICATE
  5533                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5534                          MAILING-DATA LETTER-ARCHIVE
  5535                          CERT-NOTE-FILE EOB-CODES
  5536                          CERTIFICATE-TRAILERS.
  5537 0000-DFHEXIT SECTION.
  5538     MOVE '9#                    $   ' TO DFHEIV0.
  5539     MOVE 'EL6317' TO DFHEIV1.
  5540     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5541     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5542     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5543     MOVE '5'                    TO DC-OPTION-CODE
  5544     PERFORM 9700-DATE-LINK
  5545     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5546     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5547     MOVE EIBTRMID               TO QID-TERM
  5548     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5549     IF EIBCALEN = 0
  5550        GO TO 8800-UNAUTHORIZED-ACCESS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  98
* EL6317.cbl
  5551     END-IF
  5552     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5553     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5554        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5555           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5556           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5557           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5558           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5559           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5560           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5561           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5562           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5563           MOVE LOW-VALUES           TO EL631JI
  5564           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5565           GO TO 0350-BUILD-INIT-MAP
  5566        END-IF
  5567     END-IF
  5568     IF PI-CALLING-PROGRAM = 'EL614'
  5569        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5570                                 TO WS-PASSED-REASON-CODES
  5571        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5572        IF WS-PASSED-REASON-CODES NOT = SPACES
  5573           MOVE 'Y'              TO WS-SET-CODES-MDT
  5574        ELSE
  5575           MOVE 'N'              TO WS-SET-CODES-MDT
  5576        END-IF
  5577        PERFORM 0600-RECOVER-TEMP-STORAGE
  5578                                 THRU 0600-EXIT
  5579        GO TO 0350-BUILD-INIT-MAP
  5580     END-IF
  5581     IF EIBAID = DFHCLEAR
  5582        IF PI-CLEAR-ERROR
  5583           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5584           MOVE ER-3833           TO EMI-ERROR
  5585           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5586           GO TO 0350-BUILD-INIT-MAP
  5587        ELSE
  5588           GO TO 9400-CLEAR
  5589        END-IF
  5590     END-IF
  5591     .
  5592 0200-RECEIVE.
  5593     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5594        MOVE ER-0008             TO EMI-ERROR
  5595        PERFORM 9900-ERROR-FORMAT
  5596                                 THRU 9900-EXIT
  5597        MOVE -1                  TO PFENTRL
  5598        GO TO 8100-SEND-INITIAL-MAP
  5599     END-IF
  5600
  5601* EXEC CICS RECEIVE
  5602*        MAP      (MAP-NAME)
  5603*        MAPSET   (MAPSET-NAME)
  5604*        INTO     (EL631JI)
  5605*    END-EXEC
  5606     MOVE LENGTH OF
  5607      EL631JI
  5608       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page  99
* EL6317.cbl
  5609*    MOVE '8"T I  L              ''   #00005596' TO DFHEIV0
  5610     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5611     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5612     MOVE X'2020233030303035353936' TO DFHEIV0(25:11)
  5613     CALL 'kxdfhei1' USING DFHEIV0,
  5614           MAP-NAME,
  5615           EL631JI,
  5616           DFHEIV11,
  5617           MAPSET-NAME,
  5618           DFHEIV99,
  5619           DFHEIV99
  5620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5621     IF PFENTRL = 0
  5622         GO TO 0300-CHECK-PFKEYS
  5623     END-IF
  5624     IF EIBAID NOT = DFHENTER
  5625         MOVE ER-0004            TO EMI-ERROR
  5626         GO TO 0320-INPUT-ERROR
  5627     END-IF
  5628     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5629        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5630     ELSE
  5631        MOVE ER-0029            TO EMI-ERROR
  5632        GO TO 0320-INPUT-ERROR
  5633     END-IF
  5634     .
  5635 0300-CHECK-PFKEYS.
  5636     IF EIBAID = DFHPF3
  5637        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5638        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5639        MOVE 'EL614'             TO PGM-NAME
  5640        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5641        move +1                  to s2
  5642        perform varying s1 from +1 by +1 until s1 > +12
  5643           if reacd-in (s1) not = spaces and low-values
  5644              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5645              add +5 to s2
  5646           end-if
  5647        END-perform
  5648        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5649        GO TO 9300-XCTL
  5650     END-IF
  5651     IF EIBAID = DFHPF4 OR DFHPF8
  5652        GO TO 0360-FINALIZE
  5653     END-IF
  5654     IF EIBAID = DFHPF23
  5655        IF PI-CLEAR-ERROR
  5656           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5657           MOVE ER-3833           TO EMI-ERROR
  5658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5659           GO TO 0350-BUILD-INIT-MAP
  5660        ELSE
  5661           GO TO 8810-PF23
  5662        END-IF
  5663     END-IF
  5664     IF EIBAID = DFHPF24
  5665        IF PI-CLEAR-ERROR
  5666           MOVE SPACES            TO PI-CLEAR-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 100
* EL6317.cbl
  5667           MOVE ER-3833           TO EMI-ERROR
  5668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5669           GO TO 0350-BUILD-INIT-MAP
  5670        ELSE
  5671           GO TO 9200-RETURN-MAIN-MENU
  5672        END-IF
  5673     END-IF
  5674     IF EIBAID = DFHPF12
  5675        GO TO 9500-PF12
  5676     END-IF
  5677     IF EIBAID = DFHENTER
  5678        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5679        GO TO 0325-EDIT-SCREEN
  5680     END-IF
  5681     MOVE ER-0029                TO EMI-ERROR
  5682     .
  5683 0320-INPUT-ERROR.
  5684     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5685     MOVE AL-UNBON               TO PFENTRA
  5686     MOVE -1                     TO PFENTRL
  5687     GO TO 8200-SEND-DATAONLY
  5688     .
  5689 0325-EDIT-SCREEN.
  5690     if prtswl > zeros
  5691        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5692*          MOVE AL-UANON       TO PRTSWA
  5693*          IF PRTSWI = ' '
  5694              MOVE 'P'         TO PRTSWI
  5695*          END-IF
  5696*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5697        END-IF
  5698     END-IF
  5699     IF (SIGREQL > ZEROS)
  5700        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5701        MOVE AL-UANON         TO SIGREQA
  5702        IF SIGREQI = ' '
  5703           MOVE 'N'           TO SIGREQI
  5704        END-IF
  5705        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5706     ELSE
  5707        MOVE ER-2651          TO EMI-ERROR
  5708        MOVE -1               TO SIGREQL
  5709        MOVE AL-UABON         TO SIGREQA
  5710        PERFORM 9900-ERROR-FORMAT
  5711                                 THRU 9900-EXIT
  5712     END-IF
  5713     IF LTRIDL > ZEROS
  5714        AND LTRIDI > SPACES
  5715        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5716        MOVE LTRIDI              TO LETR-LETTER-ID
  5717                                    PI-LTRID-ENTERED
  5718        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5719        MOVE SPACES              TO LETR-FILLER
  5720        MOVE 0                   TO LETR-SEQ-NO
  5721        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5722     ELSE
  5723        MOVE ER-1236          TO EMI-ERROR
  5724        MOVE -1               TO LTRIDL
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 101
* EL6317.cbl
  5725        MOVE AL-UABON         TO LTRIDA
  5726        PERFORM 9900-ERROR-FORMAT
  5727                                 THRU 9900-EXIT
  5728     END-IF
  5729
  5730     IF W-PROMPT-LETTER EQUAL 'Y'
  5731         MOVE ER-0894            TO EMI-ERROR
  5732         MOVE -1                 TO LTRIDL
  5733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5734     END-IF
  5735     SET REASONS-NOT-FOUND TO TRUE
  5736     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5737        IF REACDL (S1) = +4 OR
  5738          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5739              MOVE AL-SANON     TO REACDA (S1)
  5740              SET REASONS-FOUND TO TRUE
  5741        END-IF
  5742     END-PERFORM
  5743
  5744     IF REASONS-NOT-FOUND
  5745        MOVE ER-1820             TO EMI-ERROR
  5746        MOVE -1                  TO PFENTRL
  5747        PERFORM 9900-ERROR-FORMAT
  5748                                 THRU 9900-EXIT
  5749     ELSE
  5750        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5751     END-IF
  5752
  5753     IF CRTNT1L > ZEROS
  5754        IF CRTNT1I > SPACES
  5755           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5756        END-IF
  5757     END-IF
  5758
  5759     IF CRTNT2L > ZEROS
  5760        IF CRTNT2I > SPACES
  5761           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5762        END-IF
  5763     END-IF
  5764
  5765     IF BILNT1L > ZEROS
  5766        IF BILNT1I > SPACES
  5767           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5768        END-IF
  5769     END-IF
  5770
  5771     IF BILNT2L > ZEROS
  5772        IF BILNT2I > SPACES
  5773           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  5774        END-IF
  5775     END-IF
  5776
  5777     .
  5778 0325-EXIT.
  5779     EXIT.
  5780
  5781 0326-GET-Z-RECORD.
  5782
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 102
* EL6317.cbl
  5783     MOVE SPACES  TO W-Z-CONTROL-DATA
  5784
  5785
  5786* EXEC CICS STARTBR
  5787*         DATASET    ('ELLETR')
  5788*         RIDFLD     (ELLETR-KEY)
  5789*         GTEQ
  5790*         RESP      (WS-RESPONSE)
  5791*    END-EXEC.
  5792     MOVE 'ELLETR' TO DFHEIV1
  5793     MOVE 0
  5794       TO DFHEIV11
  5795*    MOVE '&,         G          &  N#00005765' TO DFHEIV0
  5796     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5797     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5798     MOVE X'204E233030303035373635' TO DFHEIV0(25:11)
  5799     CALL 'kxdfhei1' USING DFHEIV0,
  5800           DFHEIV1,
  5801           ELLETR-KEY,
  5802           DFHEIV99,
  5803           DFHEIV11,
  5804           DFHEIV99
  5805     MOVE EIBRESP  TO WS-RESPONSE
  5806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5807
  5808     IF NOT RESP-NORMAL
  5809         MOVE ER-1236          TO EMI-ERROR
  5810         MOVE -1               TO LTRIDL
  5811         MOVE AL-UABON         TO LTRIDA
  5812         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5813         GO TO 0326-ENDBR
  5814     END-IF.
  5815
  5816 0326-READNEXT.
  5817
  5818
  5819* EXEC CICS READNEXT
  5820*        DATASET   ('ELLETR')
  5821*        INTO      (TEXT-FILES)
  5822*        RIDFLD    (ELLETR-KEY)
  5823*        RESP      (WS-RESPONSE)
  5824*    END-EXEC
  5825     MOVE LENGTH OF
  5826      TEXT-FILES
  5827       TO DFHEIV12
  5828     MOVE 'ELLETR' TO DFHEIV1
  5829     MOVE 0
  5830       TO DFHEIV11
  5831*    MOVE '&.IL                  )  N#00005781' TO DFHEIV0
  5832     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5834     MOVE X'204E233030303035373831' TO DFHEIV0(25:11)
  5835     CALL 'kxdfhei1' USING DFHEIV0,
  5836           DFHEIV1,
  5837           TEXT-FILES,
  5838           DFHEIV12,
  5839           ELLETR-KEY,
  5840           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 103
* EL6317.cbl
  5841           DFHEIV11,
  5842           DFHEIV99,
  5843           DFHEIV99
  5844     MOVE EIBRESP  TO WS-RESPONSE
  5845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5846     IF RESP-NORMAL
  5847        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  5848           MOVE ER-1236          TO EMI-ERROR
  5849           MOVE -1               TO LTRIDL
  5850           MOVE AL-UABON         TO LTRIDA
  5851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5852           GO TO 0326-ENDBR
  5853        END-IF
  5854
  5855        MOVE AL-UANON         TO LTRIDA
  5856        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  5857           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  5858        ELSE
  5859           GO TO 0326-READNEXT
  5860        END-IF
  5861     ELSE
  5862        MOVE ER-1236          TO EMI-ERROR
  5863        MOVE -1               TO LTRIDL
  5864        MOVE AL-UABON         TO LTRIDA
  5865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5866        GO TO 0326-ENDBR
  5867     END-IF.
  5868
  5869 0326-ENDBR.
  5870
  5871
  5872* EXEC CICS ENDBR
  5873*        DATASET     ('ELLETR')
  5874*    END-EXEC.
  5875     MOVE 'ELLETR' TO DFHEIV1
  5876     MOVE 0
  5877       TO DFHEIV11
  5878*    MOVE '&2                    $   #00005812' TO DFHEIV0
  5879     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5881     MOVE X'2020233030303035383132' TO DFHEIV0(25:11)
  5882     CALL 'kxdfhei1' USING DFHEIV0,
  5883           DFHEIV1,
  5884           DFHEIV11,
  5885           DFHEIV99
  5886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5887
  5888
  5889 0326-EXIT.
  5890      EXIT.
  5891 0330-CHECK-ERRORS.
  5892     IF EMI-NO-ERRORS
  5893        GO TO 0350-BUILD-INIT-MAP
  5894     ELSE
  5895        GO TO 8200-SEND-DATAONLY
  5896     END-IF
  5897     .
  5898 0330-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 104
* EL6317.cbl
  5899     EXIT.
  5900 0350-BUILD-INIT-MAP.
  5901
  5902     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  5903        display 'coming from el1273 '
  5904        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  5905        MOVE PI-CARRIER             TO CRTO-CARRIER
  5906        MOVE PI-GROUPING            TO CRTO-GROUPING
  5907        MOVE PI-STATE               TO CRTO-STATE
  5908        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  5909        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  5910        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  5911        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  5912        MOVE 'I'                    TO CRTO-RECORD-TYPE
  5913        MOVE ZEROS                  TO CRTO-SEQ-NO
  5914        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  5915                                       PI-ERENDT-KEY
  5916     END-IF
  5917     MOVE PI-CRTO-CARRIER        TO CARRO
  5918     MOVE PI-CRTO-GROUPING       TO GROUPO
  5919     MOVE PI-CRTO-STATE          TO STATEO
  5920     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  5921     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  5922     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  5923     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  5924     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  5925     MOVE ' '                    TO DC-OPTION-CODE
  5926     PERFORM 9700-DATE-LINK
  5927     IF NO-CONVERSION-ERROR
  5928        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  5929     END-IF
  5930
  5931*    IF PI-PRTSW-ENTERED > SPACES
  5932*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  5933*       MOVE AL-UANON            TO PRTSWA
  5934*       MOVE +1                  TO PRTSWL
  5935*    END-IF
  5936
  5937     IF PI-SIGREQ-ENTERED > SPACES
  5938        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  5939        MOVE AL-UANON            TO SIGREQA
  5940        MOVE +1                  TO SIGREQL
  5941     END-IF
  5942
  5943     IF PI-LTRID-ENTERED > SPACES
  5944        MOVE PI-LTRID-ENTERED    TO LTRIDI
  5945        MOVE AL-UANON            TO LTRIDA
  5946        MOVE +4                  TO LTRIDL
  5947     END-IF
  5948
  5949     MOVE PI-REASONS-ENTERED     TO REASONCDS
  5950     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5951        IF REACDL (S1) = +4 OR
  5952          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5953              MOVE AL-SANON      TO REACDA (S1)
  5954              MOVE +4            TO REACDL (S1)
  5955              SET REASONS-FOUND  TO TRUE
  5956        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 105
* EL6317.cbl
  5957     END-PERFORM
  5958
  5959     IF PI-CERTNT1-ENTERED > SPACES
  5960        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  5961        MOVE AL-UANON            TO CRTNT1A
  5962        MOVE +63                 TO CRTNT1L
  5963     END-IF
  5964
  5965     IF PI-CERTNT2-ENTERED > SPACES
  5966        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  5967        MOVE AL-UANON            TO CRTNT2A
  5968        MOVE +63                 TO CRTNT2L
  5969     END-IF
  5970
  5971     IF PI-BILLNT1-ENTERED > SPACES
  5972        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  5973        MOVE AL-UANON            TO BILNT1A
  5974        MOVE +63                 TO BILNT1L
  5975     END-IF
  5976
  5977     IF PI-BILLNT2-ENTERED > SPACES
  5978        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  5979        MOVE AL-UANON            TO BILNT2A
  5980        MOVE +63                 TO BILNT2L
  5981     END-IF
  5982
  5983     GO TO 8100-SEND-INITIAL-MAP
  5984     .
  5985 0360-FINALIZE.
  5986     display ' made it to 0360 '
  5987     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  5988     IF NOT EMI-NO-ERRORS
  5989       AND EIBAID = DFHPF4
  5990        GO TO 8200-SEND-DATAONLY
  5991     END-IF
  5992     set P to address of KIXSYS
  5993     CALL "getenv" using by value P returning var-ptr
  5994     if var-ptr = null then
  5995        display ' kixsys not set '
  5996     else
  5997        set address of var to var-ptr
  5998        move 0 to env-var-len
  5999        inspect var tallying env-var-len
  6000          for characters before X'00'
  6001*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6002        unstring var (1:env-var-len) delimited by '/'
  6003           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6004              WS-KIX-SYS
  6005        end-unstring
  6006*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6007*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6008     end-if
  6009     set P to address of KIXHOST
  6010     CALL "getenv" using by value P returning var-ptr
  6011     if var-ptr = null then
  6012        display ' kixhost not set '
  6013     else
  6014        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 106
* EL6317.cbl
  6015        move 0 to env-var-len
  6016        inspect var tallying env-var-len
  6017          for characters before X'00'
  6018*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6019        MOVE var(1:env-var-len)  to ws-kixhost
  6020        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6021     end-if
  6022     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6023     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6024     IF RESP-NORMAL
  6025        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6026        DISPLAY ' RESP NORMAL AND = '
  6027        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  6028                               PI-CRTO-SEQ-NO
  6029        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  6030        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  6031        SUBTRACT +1         FROM NCRTO-SEQ-NO
  6032        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6033*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6034        PERFORM 1100-CALL-NS-BUS-LOGIC
  6035                                 THRU 1100-EXIT
  6036        IF BL-OK
  6037           CONTINUE
  6038        ELSE
  6039           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6040           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6041           MOVE -1               TO CARRL
  6042        END-IF
  6043     ELSE
  6044        MOVE ER-9999             TO EMI-ERROR
  6045        PERFORM 9900-ERROR-FORMAT
  6046                                 THRU 9900-EXIT
  6047        MOVE -1                  TO CARRL
  6048        GO TO 8100-SEND-INITIAL-MAP
  6049     END-IF
  6050     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6051                                 TO SYSO
  6052     MOVE WS-KIXHOST             TO HOSTO
  6053     MOVE PI-COMPANY-ID          TO COMPANYO
  6054     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6055         MOVE '2'                TO DATASORO
  6056     ELSE
  6057         MOVE '4'                TO DATASORO
  6058     END-IF
  6059     MOVE BL-BATCH-NO            TO BATCHNOO
  6060     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6061     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6062     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6063*    MOVE -1                     TO PRTSWL
  6064*    MOVE AL-UANON               TO PRTSWA
  6065     MOVE -1                     TO SIGREQL
  6066     MOVE AL-UANON               TO SIGREQA
  6067     IF EIBAID = DFHPF4
  6068        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6069        MOVE ER-0280             TO EMI-ERROR
  6070        PERFORM 9900-ERROR-FORMAT
  6071                                 THRU 9900-EXIT
  6072        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 107
* EL6317.cbl
  6073        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6074        MOVE 'Y'                 TO PI-FINALIZED-IND
  6075        GO TO 9400-CLEAR
  6076     ELSE
  6077        MOVE ER-1818             TO EMI-ERROR
  6078        PERFORM 9900-ERROR-FORMAT
  6079                                 THRU 9900-EXIT
  6080     END-IF
  6081     GO TO 0350-BUILD-INIT-MAP
  6082     .
  6083 0360-EXIT.
  6084     EXIT.
  6085 0362-READ-ELCRTO.
  6086     display ' made it to 0362 '
  6087
  6088* EXEC CICS READ
  6089*        DATASET   (WS-ELCRTO-FILE-ID)
  6090*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6091*        RIDFLD    (ELCRTO-KEY)
  6092*        GTEQ
  6093*        RESP      (WS-RESPONSE)
  6094*    END-EXEC
  6095*    MOVE '&"S        G          (  N#00006014' TO DFHEIV0
  6096     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6098     MOVE X'204E233030303036303134' TO DFHEIV0(25:11)
  6099     CALL 'kxdfhei1' USING DFHEIV0,
  6100           WS-ELCRTO-FILE-ID,
  6101           DFHEIV20,
  6102           DFHEIV99,
  6103           ELCRTO-KEY,
  6104           DFHEIV99,
  6105           DFHEIV99,
  6106           DFHEIV99
  6107     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6108         DFHEIV20
  6109     MOVE EIBRESP  TO WS-RESPONSE
  6110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6111     .
  6112 0362-EXIT.
  6113     EXIT.
  6114 0363-READ-ELCRTO-UPD.
  6115     display ' made it to 0363 '
  6116
  6117* EXEC CICS READ
  6118*        DATASET   (WS-ELCRTO-FILE-ID)
  6119*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6120*        RIDFLD    (ELCRTO-KEY)
  6121*        UPDATE
  6122*        RESP      (WS-RESPONSE)
  6123*    END-EXEC
  6124*    MOVE '&"S        EU         (  N#00006026' TO DFHEIV0
  6125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6126     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6127     MOVE X'204E233030303036303236' TO DFHEIV0(25:11)
  6128     CALL 'kxdfhei1' USING DFHEIV0,
  6129           WS-ELCRTO-FILE-ID,
  6130           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 108
* EL6317.cbl
  6131           DFHEIV99,
  6132           ELCRTO-KEY,
  6133           DFHEIV99,
  6134           DFHEIV99,
  6135           DFHEIV99
  6136     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6137         DFHEIV20
  6138     MOVE EIBRESP  TO WS-RESPONSE
  6139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6140     .
  6141 0363-EXIT.
  6142     EXIT.
  6143 0365-READ-ERENDT.
  6144
  6145* EXEC CICS READ
  6146*        DATASET   (WS-ERENDT-FILE-ID)
  6147*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6148*        RIDFLD    (ERENDT-KEY)
  6149*        RESP      (WS-RESPONSE)
  6150*    END-EXEC
  6151*    MOVE '&"S        E          (  N#00006037' TO DFHEIV0
  6152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6154     MOVE X'204E233030303036303337' TO DFHEIV0(25:11)
  6155     CALL 'kxdfhei1' USING DFHEIV0,
  6156           WS-ERENDT-FILE-ID,
  6157           DFHEIV20,
  6158           DFHEIV99,
  6159           ERENDT-KEY,
  6160           DFHEIV99,
  6161           DFHEIV99,
  6162           DFHEIV99
  6163     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6164         DFHEIV20
  6165     MOVE EIBRESP  TO WS-RESPONSE
  6166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6167     .
  6168 0365-EXIT.
  6169     EXIT.
  6170 0400-ADD-ERENDT.
  6171     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6172     display ' made it to 0400 '
  6173
  6174* EXEC CICS GETMAIN
  6175*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6176*         LENGTH   (ERENDT-LENGTH)
  6177*         INITIMG  (GETMAIN-SPACE)
  6178*    END-EXEC
  6179*    MOVE ',"IL                  $   #00006049' TO DFHEIV0
  6180     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6181     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6182     MOVE X'2020233030303036303439' TO DFHEIV0(25:11)
  6183     CALL 'kxdfhei1' USING DFHEIV0,
  6184           DFHEIV20,
  6185           ERENDT-LENGTH,
  6186           GETMAIN-SPACE
  6187     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6188         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 109
* EL6317.cbl
  6189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6190     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6191     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6192     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6193     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6194                                    EN-INPUT-DT
  6195                                    EN-PROCESS-DT
  6196
  6197     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6198     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6199     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6200     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6201     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6202     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6203     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6204     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6205     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6206     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6207     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6208     IF OC-LF-BENCD NOT = '00' AND '  '
  6209        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6210        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6211        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6212        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6213        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6214        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6215        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6216     END-IF
  6217     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6218     IF OC-AH-BENCD NOT = '00' AND '  '
  6219        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6220        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6221        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6222        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6223        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6224        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6225     END-IF
  6226     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6227
  6228     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6229         display 'from el1273, using crto for new crto'
  6230
  6231        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6232                                     NCRTO-INS-FIRST-NAME
  6233        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6234                                     NCRTO-INS-MIDDLE-INIT
  6235        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6236                                     NCRTO-INS-LAST-NAME
  6237        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6238                                     NCRTO-INS-AGE
  6239        MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6240                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6241        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6242                                     NCRTO-JNT-FIRST-NAME
  6243        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6244                                     NCRTO-JNT-MIDDLE-INIT
  6245        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6246                                     NCRTO-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 110
* EL6317.cbl
  6247        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6248                                     NCRTO-JNT-AGE
  6249        MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6250                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6251        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6252                                     NCRTO-LF-BENCD
  6253        IF OC-LF-BENCD NOT = '00' AND '  '
  6254           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6255                                       NCRTO-LF-BEN-AMT
  6256           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6257                                       NCRTO-LF-PRM-AMT
  6258           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6259                                       NCRTO-LF-ALT-BEN-AMT
  6260           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6261                                       NCRTO-LF-ALT-PRM-AMT
  6262           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6263                                       NCRTO-LF-TERM
  6264           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6265                                       NCRTO-LF-EXP-DT
  6266           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6267                                       NCRTO-LF-COMM-PCT
  6268           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6269           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6270           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6271        END-IF
  6272        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6273                                     NCRTO-AH-BENCD
  6274        IF OC-AH-BENCD NOT = '00' AND '  '
  6275           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6276                                       NCRTO-AH-BEN-AMT
  6277           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6278                                       NCRTO-AH-PRM-AMT
  6279           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6280                                       NCRTO-AH-TERM
  6281           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6282                                       NCRTO-AH-EXP-DT
  6283           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6284                                       NCRTO-AH-CP
  6285           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6286                                       NCRTO-AH-COMM-PCT
  6287           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6288           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6289           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6290        END-IF
  6291        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6292                                       NCRTO-CRED-BENE-NAME
  6293
  6294        GO TO 0400-WRITE-ENDT
  6295     END-IF
  6296
  6297* EXEC CICS GETMAIN
  6298*         SET      (ADDRESS OF PENDING-BUSINESS)
  6299*         LENGTH   (ERPNDB-LENGTH)
  6300*         INITIMG  (GETMAIN-SPACE)
  6301*    END-EXEC
  6302*    MOVE ',"IL                  $   #00006160' TO DFHEIV0
  6303     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 111
* EL6317.cbl
  6305     MOVE X'2020233030303036313630' TO DFHEIV0(25:11)
  6306     CALL 'kxdfhei1' USING DFHEIV0,
  6307           DFHEIV20,
  6308           ERPNDB-LENGTH,
  6309           GETMAIN-SPACE
  6310     SET ADDRESS OF PENDING-BUSINESS TO
  6311         DFHEIV20
  6312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6313     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6314     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6315
  6316* EXEC CICS READ
  6317*        DATASET   (WS-ERPNDB-FILE-ID)
  6318*        INTO      (PENDING-BUSINESS)
  6319*        RIDFLD    (ERPNDB-KEY)
  6320*        RESP      (WS-RESPONSE)
  6321*    END-EXEC
  6322     MOVE LENGTH OF
  6323      PENDING-BUSINESS
  6324       TO DFHEIV11
  6325*    MOVE '&"IL       E          (  N#00006167' TO DFHEIV0
  6326     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6327     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6328     MOVE X'204E233030303036313637' TO DFHEIV0(25:11)
  6329     CALL 'kxdfhei1' USING DFHEIV0,
  6330           WS-ERPNDB-FILE-ID,
  6331           PENDING-BUSINESS,
  6332           DFHEIV11,
  6333           ERPNDB-KEY,
  6334           DFHEIV99,
  6335           DFHEIV99,
  6336           DFHEIV99
  6337     MOVE EIBRESP  TO WS-RESPONSE
  6338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6339     IF NOT RESP-NORMAL
  6340        GO TO 0400-EXIT
  6341     END-IF
  6342*    set found-pndb to true
  6343     display ' good read on erpndb '
  6344     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6345                                      NCRTO-INS-FIRST-NAME
  6346     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6347                                      NCRTO-INS-MIDDLE-INIT
  6348     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6349                                      NCRTO-INS-LAST-NAME
  6350     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6351                                      NCRTO-INS-AGE
  6352     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6353                                      NCRTO-JNT-FIRST-NAME
  6354     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6355                                      NCRTO-JNT-MIDDLE-INIT
  6356     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6357                                      NCRTO-JNT-LAST-NAME
  6358     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6359                                      NCRTO-JNT-AGE
  6360     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6361                                      NCRTO-LF-BENCD
  6362     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 112
* EL6317.cbl
  6363        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6364                                      NCRTO-LF-BEN-AMT
  6365        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6366                                      NCRTO-LF-PRM-AMT
  6367        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6368                                      NCRTO-LF-ALT-BEN-AMT
  6369        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6370                                      NCRTO-LF-ALT-PRM-AMT
  6371        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6372                                      NCRTO-LF-TERM
  6373        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6374                                      NCRTO-LF-EXP-DT
  6375        IF PB-I-JOINT-COMMISSION > +0
  6376           MOVE PB-I-JOINT-COMMISSION
  6377                                   TO EN-LF-NEW-COMM-PCT
  6378                                      NCRTO-LF-COMM-PCT
  6379        ELSE
  6380           MOVE PB-I-LIFE-COMMISSION
  6381                                   TO EN-LF-NEW-COMM-PCT
  6382                                      NCRTO-LF-COMM-PCT
  6383        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6384        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6385                                      NCRTO-LF-ITD-CANCEL-AMT
  6386        END-IF
  6387     END-IF
  6388     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6389                                      NCRTO-AH-BENCD
  6390     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6391        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6392                                      NCRTO-AH-BEN-AMT
  6393        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6394                                      NCRTO-AH-PRM-AMT
  6395        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6396                                      NCRTO-AH-TERM
  6397        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6398                                      NCRTO-AH-EXP-DT
  6399        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6400                                      NCRTO-AH-CP
  6401        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6402                                      NCRTO-AH-COMM-PCT
  6403        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6404        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6405                                      NCRTO-AH-ITD-CANCEL-AMT
  6406     END-IF
  6407     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6408     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6409     move pb-control-by-account (1:33)
  6410                                 to ws-ermail-key
  6411
  6412* EXEC CICS READ
  6413*        DATASET   ('ERMAIL')
  6414*        SET       (ADDRESS OF MAILING-DATA)
  6415*        RIDFLD    (WS-ERMAIL-KEY)
  6416*        RESP      (WS-RESPONSE)
  6417*    END-EXEC
  6418     MOVE 'ERMAIL' TO DFHEIV1
  6419*    MOVE '&"S        E          (  N#00006245' TO DFHEIV0
  6420     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 113
* EL6317.cbl
  6421     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6422     MOVE X'204E233030303036323435' TO DFHEIV0(25:11)
  6423     CALL 'kxdfhei1' USING DFHEIV0,
  6424           DFHEIV1,
  6425           DFHEIV20,
  6426           DFHEIV99,
  6427           WS-ERMAIL-KEY,
  6428           DFHEIV99,
  6429           DFHEIV99,
  6430           DFHEIV99
  6431     SET ADDRESS OF MAILING-DATA TO
  6432         DFHEIV20
  6433     MOVE EIBRESP  TO WS-RESPONSE
  6434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6435     IF RESP-NORMAL
  6436        DISPLAY ' FOUND ERMAIL '
  6437        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6438                                    NCRTO-CRED-BENE-NAME
  6439     ELSE
  6440        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6441     END-IF
  6442
  6443     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6444     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6445
  6446
  6447* EXEC CICS READ
  6448*         DATASET  (WS-ELCRTT-FILE-ID)
  6449*         RIDFLD   (WS-ELCRTT-KEY)
  6450*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6451*         RESP     (WS-RESPONSE)
  6452*    END-EXEC
  6453*    MOVE '&"S        E          (  N#00006262' TO DFHEIV0
  6454     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6456     MOVE X'204E233030303036323632' TO DFHEIV0(25:11)
  6457     CALL 'kxdfhei1' USING DFHEIV0,
  6458           WS-ELCRTT-FILE-ID,
  6459           DFHEIV20,
  6460           DFHEIV99,
  6461           WS-ELCRTT-KEY,
  6462           DFHEIV99,
  6463           DFHEIV99,
  6464           DFHEIV99
  6465     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6466         DFHEIV20
  6467     MOVE EIBRESP  TO WS-RESPONSE
  6468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6469
  6470     IF RESP-NORMAL
  6471        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6472                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6473        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6474                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6475     END-IF.
  6476      .
  6477 0400-WRITE-ENDT.
  6478
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 114
* EL6317.cbl
  6479     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6480        IF REACD-IN (S1) NOT = LOW-VALUES
  6481           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6482        END-IF
  6483     END-PERFORM
  6484     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6485     MOVE 'V'                    TO EN-DOCU-TYPE
  6486     MOVE ' '                    TO EN-MONEY-SW
  6487     MOVE SIGREQI                TO EN-SIG-SW
  6488     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6489     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6490     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6491*    IF NOT EMI-NO-ERRORS
  6492*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6493*       GO TO 8200-SEND-DATAONLY
  6494*    END-IF
  6495     DISPLAY ' 0400 EXIT '
  6496     .
  6497 0400-EXIT.
  6498     EXIT.
  6499 0410-INIT-ERENDT.
  6500     display ' made it to 0410 '
  6501     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6502     MOVE ZEROS                  TO ENDT-SEQ-NO
  6503
  6504* EXEC CICS READ
  6505*        DATASET    (WS-ERENDT-FILE-ID)
  6506*        RIDFLD     (ERENDT-KEY)
  6507*        INTO       (ENDORSEMENT-RECORD)
  6508*        RESP       (WS-RESPONSE)
  6509*        GTEQ
  6510*    END-EXEC
  6511     MOVE LENGTH OF
  6512      ENDORSEMENT-RECORD
  6513       TO DFHEIV11
  6514*    MOVE '&"IL       G          (  N#00006302' TO DFHEIV0
  6515     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6517     MOVE X'204E233030303036333032' TO DFHEIV0(25:11)
  6518     CALL 'kxdfhei1' USING DFHEIV0,
  6519           WS-ERENDT-FILE-ID,
  6520           ENDORSEMENT-RECORD,
  6521           DFHEIV11,
  6522           ERENDT-KEY,
  6523           DFHEIV99,
  6524           DFHEIV99,
  6525           DFHEIV99
  6526     MOVE EIBRESP  TO WS-RESPONSE
  6527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6528     IF RESP-NORMAL
  6529        AND (EN-CONTROL-PRIMARY (1:34) =
  6530           OC-CONTROL-PRIMARY (1:34))
  6531        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6532     ELSE
  6533        MOVE +4096               TO WS-SEQ-NO
  6534     END-IF
  6535     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6536     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 115
* EL6317.cbl
  6537     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6538     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6539     INITIALIZE EN-ISSUE-RECORD
  6540     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6541                                    EN-AH-ORIG-EXP-DT
  6542                                    EN-LF-NEW-EXP-DT
  6543                                    EN-AH-NEW-EXP-DT
  6544                                    EN-PROCESS-DT
  6545     .
  6546 0410-EXIT.
  6547     EXIT.
  6548 0420-UPDATE-ELCRTO.
  6549     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6550     IF RESP-NORMAL
  6551        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6552                                    OC-LAST-MAINT-DT
  6553        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6554        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6555
  6556* EXEC CICS REWRITE
  6557*          FROM     (ORIGINAL-CERTIFICATE)
  6558*          DATASET  ('ELCRTO')
  6559*       END-EXEC
  6560     MOVE LENGTH OF
  6561      ORIGINAL-CERTIFICATE
  6562       TO DFHEIV11
  6563     MOVE 'ELCRTO' TO DFHEIV1
  6564*    MOVE '&& L                  %   #00006336' TO DFHEIV0
  6565     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6566     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6567     MOVE X'2020233030303036333336' TO DFHEIV0(25:11)
  6568     CALL 'kxdfhei1' USING DFHEIV0,
  6569           DFHEIV1,
  6570           ORIGINAL-CERTIFICATE,
  6571           DFHEIV11,
  6572           DFHEIV99
  6573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6574     END-IF
  6575     .
  6576 0420-EXIT.
  6577     EXIT.
  6578
  6579 0425-ADD-NEW-ELCRTO.
  6580     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6581     MOVE 'OC'                   TO OC-RECORD-ID
  6582     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6583     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6584     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6585     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6586     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6587     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6588     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6589     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6590     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6591     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6592     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6593     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6594     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 116
* EL6317.cbl
  6595     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6596     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6597     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6598     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6599     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6600     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6601     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6602     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6603     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6604     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6605     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6606     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6607     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6608     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6609     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6610     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6611     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6612     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6613     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6614     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6615     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6616     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6617     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6618     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6619     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6620     .
  6621 0425-WRITE-ELCRTO.
  6622
  6623
  6624* EXEC CICS WRITE
  6625*       DATASET   ('ELCRTO')
  6626*       FROM      (ORIGINAL-CERTIFICATE)
  6627*       RIDFLD    (OC-CONTROL-PRIMARY)
  6628*       RESP      (WS-RESPONSE)
  6629*    END-EXEC
  6630     MOVE LENGTH OF
  6631      ORIGINAL-CERTIFICATE
  6632       TO DFHEIV11
  6633     MOVE 'ELCRTO' TO DFHEIV1
  6634*    MOVE '&$ L                  ''  N#00006389' TO DFHEIV0
  6635     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6637     MOVE X'204E233030303036333839' TO DFHEIV0(25:11)
  6638     CALL 'kxdfhei1' USING DFHEIV0,
  6639           DFHEIV1,
  6640           ORIGINAL-CERTIFICATE,
  6641           DFHEIV11,
  6642           OC-CONTROL-PRIMARY,
  6643           DFHEIV99,
  6644           DFHEIV99
  6645     MOVE EIBRESP  TO WS-RESPONSE
  6646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6647
  6648     display ' just wrote new crto ' ws-response
  6649                           ' ' oc-key-seq-no
  6650     IF RESP-DUPKEY
  6651        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6652        GO TO 0425-WRITE-ELCRTO
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 117
* EL6317.cbl
  6653     ELSE
  6654        IF NOT RESP-NORMAL
  6655           MOVE -1               TO SIGREQL
  6656           MOVE ER-3830          TO EMI-ERROR
  6657           PERFORM 9900-ERROR-FORMAT
  6658                                 THRU 9900-EXIT
  6659        ELSE
  6660           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6661        END-IF
  6662     END-IF
  6663
  6664     .
  6665 0425-EXIT.
  6666     EXIT.
  6667
  6668 0426-ADD-CERT-NOTES.
  6669
  6670     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6671     SET TB-INDX TO 1
  6672
  6673     IF PI-CERTNT1-ENTERED > SPACES
  6674         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6675         MOVE PI-PROCESSOR-ID    TO
  6676                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6677         MOVE EIBTIME            TO
  6678                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6679         MOVE WS-CURRENT-BIN-DT  TO
  6680                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6681         SET TB-INDX UP BY +1
  6682     END-IF
  6683
  6684     IF PI-CERTNT2-ENTERED > SPACES
  6685         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6686         MOVE PI-PROCESSOR-ID    TO
  6687                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6688         MOVE EIBTIME            TO
  6689                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6690         MOVE WS-CURRENT-BIN-DT  TO
  6691                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6692         SET TB-INDX UP BY +1
  6693     END-IF
  6694
  6695     IF CERT-NOTE-ENTRIES > SPACES
  6696         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6697         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6698     END-IF
  6699
  6700     IF PI-BILLNT1-ENTERED > SPACES
  6701         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6702         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6703         MOVE +63 TO WS-LEN
  6704         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6705     END-IF
  6706
  6707     IF PI-BILLNT2-ENTERED > SPACES
  6708         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6709         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  6710         MOVE +63 TO WS-LEN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 118
* EL6317.cbl
  6711         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6712     END-IF
  6713
  6714     .
  6715 0426-EXIT.
  6716     EXIT.
  6717
  6718 0427-LOAD-CURRENT-CERT-NOTES.
  6719
  6720     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6721     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6722     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6723     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6724     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6725     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6726     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6727     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6728     MOVE '1'                 TO ERCNOT-REC-TYP
  6729     MOVE +0                  TO ERCNOT-SEQ
  6730     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6731
  6732
  6733* EXEC CICS STARTBR
  6734*         DATASET(WS-ERCNOT-FILE-ID)
  6735*         RIDFLD(ERCNOT-KEY)
  6736*         KEYLENGTH(ERCNOT-START-LENGTH)
  6737*         RESP      (WS-RESPONSE)
  6738*         GENERIC
  6739*         GTEQ
  6740*    END-EXEC.
  6741     MOVE 0
  6742       TO DFHEIV11
  6743*    MOVE '&,   KG    G          &  N#00006480' TO DFHEIV0
  6744     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  6745     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6746     MOVE X'204E233030303036343830' TO DFHEIV0(25:11)
  6747     CALL 'kxdfhei1' USING DFHEIV0,
  6748           WS-ERCNOT-FILE-ID,
  6749           ERCNOT-KEY,
  6750           ERCNOT-START-LENGTH,
  6751           DFHEIV11,
  6752           DFHEIV99
  6753     MOVE EIBRESP  TO WS-RESPONSE
  6754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6755
  6756
  6757     IF NOT RESP-NORMAL
  6758        GO TO 0427-ENDBR
  6759     END-IF.
  6760
  6761 0427-LOOP.
  6762
  6763* EXEC CICS READNEXT
  6764*         SET(ADDRESS OF CERT-NOTE-FILE)
  6765*         DATASET(WS-ERCNOT-FILE-ID)
  6766*         RIDFLD(ERCNOT-KEY)
  6767*    END-EXEC.
  6768     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 119
* EL6317.cbl
  6769       TO DFHEIV11
  6770*    MOVE '&.S                   )   #00006494' TO DFHEIV0
  6771     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6772     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6773     MOVE X'2020233030303036343934' TO DFHEIV0(25:11)
  6774     CALL 'kxdfhei1' USING DFHEIV0,
  6775           WS-ERCNOT-FILE-ID,
  6776           DFHEIV20,
  6777           DFHEIV99,
  6778           ERCNOT-KEY,
  6779           DFHEIV99,
  6780           DFHEIV11,
  6781           DFHEIV99,
  6782           DFHEIV99
  6783     SET ADDRESS OF CERT-NOTE-FILE TO
  6784         DFHEIV20
  6785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6786
  6787
  6788     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  6789         GO TO 0427-ENDBR
  6790     END-IF.
  6791
  6792     IF (CZ-CARRIER = SV-CARRIER)
  6793        AND (CZ-GROUPING = SV-GROUPING)
  6794        AND (CZ-STATE = SV-STATE)
  6795        AND (CZ-ACCOUNT = SV-ACCOUNT)
  6796        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  6797        AND (CZ-CERT-NO = SV-CERT-NO)
  6798        AND (CZ-RECORD-TYPE = '1')
  6799          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  6800          MOVE CZ-LAST-MAINT-USER TO
  6801                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6802          MOVE CZ-LAST-MAINT-DT TO
  6803                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6804          MOVE CZ-LAST-MAINT-HHMMSS TO
  6805                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6806          SET TB-INDX UP BY 1
  6807          GO TO 0427-LOOP
  6808     END-IF.
  6809
  6810 0427-ENDBR.
  6811
  6812
  6813* EXEC CICS ENDBR
  6814*         DATASET(WS-ERCNOT-FILE-ID)
  6815*    END-EXEC.
  6816     MOVE 0
  6817       TO DFHEIV11
  6818*    MOVE '&2                    $   #00006524' TO DFHEIV0
  6819     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6820     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6821     MOVE X'2020233030303036353234' TO DFHEIV0(25:11)
  6822     CALL 'kxdfhei1' USING DFHEIV0,
  6823           WS-ERCNOT-FILE-ID,
  6824           DFHEIV11,
  6825           DFHEIV99
  6826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 120
* EL6317.cbl
  6827
  6828
  6829     .
  6830 0427-EXIT.
  6831     EXIT.
  6832
  6833 0430-WRITE-ERENDT.
  6834     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  6835     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  6836     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  6837
  6838* EXEC CICS WRITE
  6839*         DATASET   (WS-ERENDT-FILE-ID)
  6840*         FROM      (ENDORSEMENT-RECORD)
  6841*         RIDFLD    (EN-CONTROL-PRIMARY)
  6842*         RESP      (WS-RESPONSE)
  6843*    END-EXEC
  6844     MOVE LENGTH OF
  6845      ENDORSEMENT-RECORD
  6846       TO DFHEIV11
  6847*    MOVE '&$ L                  ''  N#00006536' TO DFHEIV0
  6848     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6850     MOVE X'204E233030303036353336' TO DFHEIV0(25:11)
  6851     CALL 'kxdfhei1' USING DFHEIV0,
  6852           WS-ERENDT-FILE-ID,
  6853           ENDORSEMENT-RECORD,
  6854           DFHEIV11,
  6855           EN-CONTROL-PRIMARY,
  6856           DFHEIV99,
  6857           DFHEIV99
  6858     MOVE EIBRESP  TO WS-RESPONSE
  6859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6860     IF RESP-NORMAL
  6861        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  6862        display ' good write erendt '
  6863        IF EIBAID = DFHPF4
  6864           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  6865           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  6866           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  6867           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  6868        END-IF
  6869     ELSE
  6870        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  6871        MOVE -1                  TO CARRL
  6872        MOVE ER-0132             TO EMI-ERROR
  6873        MOVE AL-UABON            TO CARRA
  6874        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6875     END-IF
  6876     .
  6877 0430-EXIT.
  6878     EXIT.
  6879 0440-ADD-BILLING-NOTE.
  6880
  6881* EXEC CICS GETMAIN
  6882*         SET      (ADDRESS OF EOB-CODES)
  6883*         LENGTH   (ELEOBC-LENGTH)
  6884*         INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 121
* EL6317.cbl
  6885*    END-EXEC
  6886*    MOVE ',"IL                  $   #00006562' TO DFHEIV0
  6887     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6888     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6889     MOVE X'2020233030303036353632' TO DFHEIV0(25:11)
  6890     CALL 'kxdfhei1' USING DFHEIV0,
  6891           DFHEIV20,
  6892           ELEOBC-LENGTH,
  6893           GETMAIN-SPACE
  6894     SET ADDRESS OF EOB-CODES TO
  6895         DFHEIV20
  6896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6897
  6898     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  6899     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  6900     MOVE '5'                    TO WS-EOBC-REC-TYPE
  6901
  6902
  6903* EXEC CICS STARTBR
  6904*        DATASET   ('ELEOBC')
  6905*        RIDFLD    (WS-ELEOBC-KEY)
  6906*        GTEQ
  6907*        RESP      (WS-RESPONSE)
  6908*    END-EXEC
  6909     MOVE 'ELEOBC' TO DFHEIV1
  6910     MOVE 0
  6911       TO DFHEIV11
  6912*    MOVE '&,         G          &  N#00006572' TO DFHEIV0
  6913     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6914     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6915     MOVE X'204E233030303036353732' TO DFHEIV0(25:11)
  6916     CALL 'kxdfhei1' USING DFHEIV0,
  6917           DFHEIV1,
  6918           WS-ELEOBC-KEY,
  6919           DFHEIV99,
  6920           DFHEIV11,
  6921           DFHEIV99
  6922     MOVE EIBRESP  TO WS-RESPONSE
  6923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6924
  6925     IF NOT RESP-NORMAL
  6926        GO TO 0440-EXIT
  6927     END-IF
  6928      .
  6929 0440-READNEXT-ELEOBC.
  6930
  6931
  6932* EXEC CICS READNEXT
  6933*       INTO    (EOB-CODES)
  6934*       DATASET ('ELEOBC')
  6935*       RIDFLD  (WS-ELEOBC-KEY)
  6936*       RESP    (WS-RESPONSE)
  6937*    END-EXEC
  6938     MOVE LENGTH OF
  6939      EOB-CODES
  6940       TO DFHEIV12
  6941     MOVE 'ELEOBC' TO DFHEIV1
  6942     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 122
* EL6317.cbl
  6943       TO DFHEIV11
  6944*    MOVE '&.IL                  )  N#00006585' TO DFHEIV0
  6945     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6946     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6947     MOVE X'204E233030303036353835' TO DFHEIV0(25:11)
  6948     CALL 'kxdfhei1' USING DFHEIV0,
  6949           DFHEIV1,
  6950           EOB-CODES,
  6951           DFHEIV12,
  6952           WS-ELEOBC-KEY,
  6953           DFHEIV99,
  6954           DFHEIV11,
  6955           DFHEIV99,
  6956           DFHEIV99
  6957     MOVE EIBRESP  TO WS-RESPONSE
  6958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6959
  6960     IF RESP-NORMAL
  6961         IF EO-RECORD-TYPE NOT = '5'
  6962             GO TO 0440-EXIT
  6963         END-IF
  6964     ELSE
  6965         GO TO 0440-EXIT
  6966     END-IF
  6967
  6968     IF EO-RECORD-TYPE = '5' AND
  6969        EO-EOB-CODE = PI-LTRID-ENTERED
  6970           CONTINUE
  6971     ELSE
  6972         GO TO 0440-READNEXT-ELEOBC
  6973     END-IF
  6974
  6975     MOVE SPACES TO WS-BILLING-NOTE
  6976     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  6977     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  6978     MOVE WS-CURRENT-DT TO WS-BN-DATE
  6979     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  6980     MOVE +25 TO WS-LEN
  6981
  6982     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6983     .
  6984 0440-EXIT.
  6985     EXIT.
  6986
  6987 0441-UPDATE-BILLING-NOTE.
  6988
  6989
  6990* EXEC CICS GETMAIN
  6991*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  6992*         LENGTH   (ERNOTE-LENGTH)
  6993*         INITIMG  (GETMAIN-SPACE)
  6994*    END-EXEC
  6995*    MOVE ',"IL                  $   #00006621' TO DFHEIV0
  6996     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6998     MOVE X'2020233030303036363231' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0,
  7000           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 123
* EL6317.cbl
  7001           ERNOTE-LENGTH,
  7002           GETMAIN-SPACE
  7003     SET ADDRESS OF CERTIFICATE-NOTE TO
  7004         DFHEIV20
  7005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7006
  7007     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7008
  7009
  7010* EXEC CICS READ
  7011*       DATASET    (WS-ERNOTE-FILE-ID)
  7012*       RIDFLD     (WS-ERNOTE-KEY)
  7013*       INTO       (CERTIFICATE-NOTE)
  7014*       RESP       (WS-RESPONSE)
  7015*       UPDATE
  7016*    END-EXEC
  7017     MOVE LENGTH OF
  7018      CERTIFICATE-NOTE
  7019       TO DFHEIV11
  7020*    MOVE '&"IL       EU         (  N#00006629' TO DFHEIV0
  7021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7022     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7023     MOVE X'204E233030303036363239' TO DFHEIV0(25:11)
  7024     CALL 'kxdfhei1' USING DFHEIV0,
  7025           WS-ERNOTE-FILE-ID,
  7026           CERTIFICATE-NOTE,
  7027           DFHEIV11,
  7028           WS-ERNOTE-KEY,
  7029           DFHEIV99,
  7030           DFHEIV99,
  7031           DFHEIV99
  7032     MOVE EIBRESP  TO WS-RESPONSE
  7033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7034
  7035     IF RESP-NORMAL
  7036       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7037          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7038       END-IF
  7039       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7040          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7041       END-IF
  7042       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7043           (NOTE-SUB > +10) OR
  7044           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7045                             WS-BILLING-NOTE (1:WS-LEN))
  7046       END-PERFORM
  7047       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7048                              WS-BILLING-NOTE (1:WS-LEN)
  7049
  7050* EXEC CICS UNLOCK
  7051*           DATASET    (WS-ERNOTE-FILE-ID)
  7052*        END-EXEC
  7053*    MOVE '&*                    #   #00006651' TO DFHEIV0
  7054     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7055     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7056     MOVE X'2020233030303036363531' TO DFHEIV0(25:11)
  7057     CALL 'kxdfhei1' USING DFHEIV0,
  7058           WS-ERNOTE-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 124
* EL6317.cbl
  7059           DFHEIV99
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7061       ELSE
  7062         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7063           (NOTE-SUB > +10) OR
  7064           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7065         END-PERFORM
  7066         IF (NOTE-SUB < +11)
  7067           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7068              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7069                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7070           ELSE
  7071             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7072              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7073                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7074                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7075             ELSE
  7076               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7077                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7078                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7079                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7080               ELSE
  7081                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7082                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7083                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7084                                       CN-BILLING-START-LINE-NO
  7085                 ELSE
  7086                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7087                 END-IF
  7088               END-IF
  7089             END-IF
  7090           END-IF
  7091           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7092           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7093           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7094
  7095* EXEC CICS REWRITE
  7096*             DATASET    (WS-ERNOTE-FILE-ID)
  7097*             FROM       (CERTIFICATE-NOTE)
  7098*             RESP       (WS-RESPONSE)
  7099*          END-EXEC
  7100     MOVE LENGTH OF
  7101      CERTIFICATE-NOTE
  7102       TO DFHEIV11
  7103*    MOVE '&& L                  %  N#00006687' TO DFHEIV0
  7104     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7105     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7106     MOVE X'204E233030303036363837' TO DFHEIV0(25:11)
  7107     CALL 'kxdfhei1' USING DFHEIV0,
  7108           WS-ERNOTE-FILE-ID,
  7109           CERTIFICATE-NOTE,
  7110           DFHEIV11,
  7111           DFHEIV99
  7112     MOVE EIBRESP  TO WS-RESPONSE
  7113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7114           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7115         END-IF
  7116       END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 125
* EL6317.cbl
  7117     ELSE
  7118        MOVE SPACES              TO CERTIFICATE-NOTE
  7119        MOVE 'CN'                TO CN-RECORD-ID
  7120        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7121                                     WS-ERNOTE-KEY
  7122        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7123                                    CN-BILLING-END-LINE-NO
  7124        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7125        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7126        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7127        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7128
  7129* EXEC CICS WRITE
  7130*          DATASET    (WS-ERNOTE-FILE-ID)
  7131*          FROM       (CERTIFICATE-NOTE)
  7132*          RIDFLD     (WS-ERNOTE-KEY)
  7133*          RESP       (WS-RESPONSE)
  7134*       END-EXEC
  7135     MOVE LENGTH OF
  7136      CERTIFICATE-NOTE
  7137       TO DFHEIV11
  7138*    MOVE '&$ L                  ''  N#00006706' TO DFHEIV0
  7139     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7141     MOVE X'204E233030303036373036' TO DFHEIV0(25:11)
  7142     CALL 'kxdfhei1' USING DFHEIV0,
  7143           WS-ERNOTE-FILE-ID,
  7144           CERTIFICATE-NOTE,
  7145           DFHEIV11,
  7146           WS-ERNOTE-KEY,
  7147           DFHEIV99,
  7148           DFHEIV99
  7149     MOVE EIBRESP  TO WS-RESPONSE
  7150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7151
  7152        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7153     END-IF
  7154
  7155     .
  7156 0441-EXIT.
  7157     EXIT.
  7158
  7159
  7160 0442-SQUEEZE-IT-IN.
  7161
  7162     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7163        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7164           NOTE-SUB = +10
  7165           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7166           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7167             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7168             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7169             MOVE +9 TO NOTE-SUB
  7170           END-IF
  7171        END-PERFORM
  7172     ELSE
  7173        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7174           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 126
* EL6317.cbl
  7175             UNTIL NOTE-SUB = +1
  7176             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7177             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7178                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7179                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7180                MOVE +2          TO NOTE-SUB
  7181             END-IF
  7182           END-PERFORM
  7183        END-IF
  7184     END-IF
  7185
  7186     .
  7187 0442-EXIT.
  7188     EXIT.
  7189
  7190 0445-CERTIFICATE-UPDATE.
  7191    display 'billing note written, updating cert'
  7192     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7193     IF RESP-NORMAL
  7194        EVALUATE CM-NOTE-SW
  7195           WHEN '2'
  7196           WHEN '3'
  7197           WHEN '6'
  7198           WHEN '7'
  7199              SET NO-CERT-RW     TO TRUE
  7200           WHEN ' '
  7201              MOVE '2'           TO CM-NOTE-SW
  7202           WHEN '1'
  7203              MOVE '3'           TO CM-NOTE-SW
  7204           WHEN '4'
  7205              MOVE '6'           TO CM-NOTE-SW
  7206           WHEN '5'
  7207              MOVE '7'           TO CM-NOTE-SW
  7208        END-EVALUATE
  7209     END-IF
  7210     IF NOT NO-CERT-RW
  7211        PERFORM 1810-REWRITE-ELCERT
  7212                                 THRU 1810-EXIT
  7213     ELSE
  7214
  7215* EXEC CICS UNLOCK
  7216*          DATASET    (WS-ELCERT-FILE-ID)
  7217*       END-EXEC
  7218*    MOVE '&*                    #   #00006775' TO DFHEIV0
  7219     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7220     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7221     MOVE X'2020233030303036373735' TO DFHEIV0(25:11)
  7222     CALL 'kxdfhei1' USING DFHEIV0,
  7223           WS-ELCERT-FILE-ID,
  7224           DFHEIV99
  7225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7226     END-IF
  7227
  7228     .
  7229 0445-EXIT.
  7230     EXIT.
  7231
  7232 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 127
* EL6317.cbl
  7233     display ' about to write pi ' program-interface-block
  7234
  7235* EXEC CICS WRITEQ TS
  7236*        QUEUE (QID)
  7237*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7238*        LENGTH(PI-COMM-LENGTH)
  7239*    END-EXEC
  7240*    MOVE '*"                    ''   #00006786' TO DFHEIV0
  7241     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7243     MOVE X'2020233030303036373836' TO DFHEIV0(25:11)
  7244     CALL 'kxdfhei1' USING DFHEIV0,
  7245           QID,
  7246           PROGRAM-INTERFACE-BLOCK,
  7247           PI-COMM-LENGTH,
  7248           DFHEIV99,
  7249           DFHEIV99,
  7250           DFHEIV99
  7251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7252     display ' about to write map ' el631ji
  7253
  7254* EXEC CICS WRITEQ TS
  7255*        QUEUE (QID)
  7256*        FROM  (EL631JI)
  7257*        LENGTH(MAP-LENGTH)
  7258*    END-EXEC.
  7259*    MOVE '*"                    ''   #00006792' TO DFHEIV0
  7260     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7261     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7262     MOVE X'2020233030303036373932' TO DFHEIV0(25:11)
  7263     CALL 'kxdfhei1' USING DFHEIV0,
  7264           QID,
  7265           EL631JI,
  7266           MAP-LENGTH,
  7267           DFHEIV99,
  7268           DFHEIV99,
  7269           DFHEIV99
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7271
  7272 0500-EXIT.
  7273      EXIT.
  7274 0600-RECOVER-TEMP-STORAGE.
  7275     display ' about to recover pi '
  7276
  7277* EXEC CICS READQ TS
  7278*        QUEUE (QID)
  7279*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7280*        LENGTH(PI-COMM-LENGTH)
  7281*    END-EXEC
  7282*    MOVE '*$I    L              ''   #00006801' TO DFHEIV0
  7283     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7284     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7285     MOVE X'2020233030303036383031' TO DFHEIV0(25:11)
  7286     CALL 'kxdfhei1' USING DFHEIV0,
  7287           QID,
  7288           PROGRAM-INTERFACE-BLOCK,
  7289           PI-COMM-LENGTH,
  7290           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 128
* EL6317.cbl
  7291           DFHEIV99,
  7292           DFHEIV99
  7293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7294     display ' pi ' pi-program-work-area
  7295     display ' about to recover map '
  7296
  7297* EXEC CICS READQ TS
  7298*        QUEUE (QID)
  7299*        INTO  (EL631JI)
  7300*        LENGTH(MAP-LENGTH)
  7301*    END-EXEC
  7302*    MOVE '*$I    L              ''   #00006808' TO DFHEIV0
  7303     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7305     MOVE X'2020233030303036383038' TO DFHEIV0(25:11)
  7306     CALL 'kxdfhei1' USING DFHEIV0,
  7307           QID,
  7308           EL631JI,
  7309           MAP-LENGTH,
  7310           DFHEIV99,
  7311           DFHEIV99,
  7312           DFHEIV99
  7313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7314     display ' map ' el631ji
  7315     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7316     MOVE AL-UANON            TO SIGREQA
  7317     MOVE AL-UANON            TO LTRIDA
  7318     IF WS-SET-CODES-MDT = 'Y'
  7319        move +1                  to s2
  7320        perform varying s1 from +1 by +5 until s1 > +60
  7321           MOVE WS-PASSED-REASON-CODES (s1:4)
  7322                                 TO reacd-in (s2)
  7323           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7324               MOVE AL-SANON     TO REACDA (S2)
  7325               MOVE +4           TO REACDL (S2)
  7326           END-IF
  7327           add +1                to s2
  7328        end-perform
  7329        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7330     END-IF
  7331
  7332     IF CRTNT1I > SPACES
  7333         MOVE AL-UANON       TO CRTNT1A
  7334     END-IF
  7335
  7336     IF CRTNT2I > SPACES
  7337         MOVE AL-UANON       TO CRTNT2A
  7338     END-IF
  7339
  7340     IF BILNT1I > SPACES
  7341         MOVE AL-UANON       TO BILNT1A
  7342     END-IF
  7343     .
  7344 0600-EXIT.
  7345      EXIT.
  7346 0800-DELETE-TS.
  7347
  7348* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 129
* EL6317.cbl
  7349*        QUEUE(QID)
  7350*    END-EXEC
  7351*    MOVE '*&                    #   #00006846' TO DFHEIV0
  7352     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7353     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7354     MOVE X'2020233030303036383436' TO DFHEIV0(25:11)
  7355     CALL 'kxdfhei1' USING DFHEIV0,
  7356           QID,
  7357           DFHEIV99
  7358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7359     .
  7360 0800-EXIT.
  7361      EXIT.
  7362 1000-BUILD-ERARCH.
  7363     display ' made it to 1000 '
  7364     MOVE SPACES                 TO W-CNTL-KEY
  7365     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7366     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7367     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7368
  7369* EXEC CICS READ
  7370*         DATASET    (WS-ELCNTL-FILE-ID)
  7371*         SET        (ADDRESS OF CONTROL-FILE)
  7372*         RIDFLD     (W-CNTL-KEY)
  7373*         UPDATE
  7374*         RESP       (WS-RESPONSE)
  7375*    END-EXEC
  7376*    MOVE '&"S        EU         (  N#00006858' TO DFHEIV0
  7377     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7378     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7379     MOVE X'204E233030303036383538' TO DFHEIV0(25:11)
  7380     CALL 'kxdfhei1' USING DFHEIV0,
  7381           WS-ELCNTL-FILE-ID,
  7382           DFHEIV20,
  7383           DFHEIV99,
  7384           W-CNTL-KEY,
  7385           DFHEIV99,
  7386           DFHEIV99,
  7387           DFHEIV99
  7388     SET ADDRESS OF CONTROL-FILE TO
  7389         DFHEIV20
  7390     MOVE EIBRESP  TO WS-RESPONSE
  7391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7392     IF RESP-NORMAL
  7393        display ' good read elcntl '
  7394        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7395           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7396        END-IF
  7397        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7398        MOVE CF-CREDIT-LAST-ARCH-NUM
  7399                                 TO W-ARCH-NUMBER
  7400
  7401* EXEC CICS REWRITE
  7402*          FROM      (CONTROL-FILE)
  7403*          DATASET   (WS-ELCNTL-FILE-ID)
  7404*       END-EXEC
  7405     MOVE LENGTH OF
  7406      CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 130
* EL6317.cbl
  7407       TO DFHEIV11
  7408*    MOVE '&& L                  %   #00006873' TO DFHEIV0
  7409     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7410     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7411     MOVE X'2020233030303036383733' TO DFHEIV0(25:11)
  7412     CALL 'kxdfhei1' USING DFHEIV0,
  7413           WS-ELCNTL-FILE-ID,
  7414           CONTROL-FILE,
  7415           DFHEIV11,
  7416           DFHEIV99
  7417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7418     END-IF
  7419
  7420* EXEC CICS GETMAIN
  7421*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7422*       LENGTH   (W-ARCH-LENGTH)
  7423*    END-EXEC
  7424*    MOVE '," L                  $   #00006878' TO DFHEIV0
  7425     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7427     MOVE X'2020233030303036383738' TO DFHEIV0(25:11)
  7428     CALL 'kxdfhei1' USING DFHEIV0,
  7429           DFHEIV20,
  7430           W-ARCH-LENGTH,
  7431           DFHEIV99
  7432     SET ADDRESS OF LETTER-ARCHIVE TO
  7433         DFHEIV20
  7434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7435     MOVE 'LA'                   TO LETTER-ARCHIVE
  7436     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7437                                    LA-ARCHIVE-NO-A2
  7438                                    LA-ARCHIVE-NO-A3
  7439                                    LA-ARCHIVE-NO-A4
  7440                                    LA-ARCHIVE-NO-A5
  7441                                    LA-ARCHIVE-NO-A6
  7442     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7443                                    LA-COMPANY-CD-A2
  7444                                    LA-COMPANY-CD-A3
  7445                                    LA-COMPANY-CD-A4
  7446                                    LA-COMPANY-CD-A5
  7447                                    LA-COMPANY-CD-A6
  7448     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7449                                    LA-CARRIER-A3
  7450                                    LA-CARRIER-A4
  7451                                    LA-CARRIER-A5
  7452     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7453     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7454                                    LA-GROUPING-A3
  7455                                    LA-GROUPING-A4
  7456                                    LA-GROUPING-A5
  7457     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7458                                    LA-ACCOUNT-A3
  7459                                    LA-ACCOUNT-A4
  7460                                    LA-ACCOUNT-A5
  7461     MOVE PB-STATE               TO LA-STATE-A2
  7462                                    LA-STATE-A3
  7463                                    LA-STATE-A4
  7464                                    LA-STATE-A5
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 131
* EL6317.cbl
  7465     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7466     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7467     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7468     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7469     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7470                                    LA-INITIAL-PRINT-DATE
  7471                                    LA-SENT-DATE
  7472                                    LA-REPLY-DATE
  7473                                    LA-RESEND-DATE
  7474                                    LA-FOLLOW-UP-DATE
  7475     MOVE 'A'                    TO LA-STATUS
  7476     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7477     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7478     MOVE LTRIDI                 TO LA-FORM-A3
  7479     MOVE '4'                    TO LA-DATA-SOURCE
  7480     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7481     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7482                                    LA-NO-OF-TEXT-RECORDS
  7483
  7484* EXEC CICS WRITE
  7485*         DATASET   ('ERARCH')
  7486*         FROM      (LETTER-ARCHIVE)
  7487*         RIDFLD    (LA-CONTROL-PRIMARY)
  7488*         RESP      (WS-RESPONSE)
  7489*    END-EXEC
  7490     MOVE LENGTH OF
  7491      LETTER-ARCHIVE
  7492       TO DFHEIV11
  7493     MOVE 'ERARCH' TO DFHEIV1
  7494*    MOVE '&$ L                  ''  N#00006930' TO DFHEIV0
  7495     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7497     MOVE X'204E233030303036393330' TO DFHEIV0(25:11)
  7498     CALL 'kxdfhei1' USING DFHEIV0,
  7499           DFHEIV1,
  7500           LETTER-ARCHIVE,
  7501           DFHEIV11,
  7502           LA-CONTROL-PRIMARY,
  7503           DFHEIV99,
  7504           DFHEIV99
  7505     MOVE EIBRESP  TO WS-RESPONSE
  7506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7507     IF RESP-NORMAL
  7508        display ' good write erarch '
  7509        MOVE ER-0280             TO EMI-ERROR
  7510        MOVE -1                  TO SIGREQL
  7511        PERFORM 9900-ERROR-FORMAT
  7512                                 THRU 9900-EXIT
  7513        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  7514        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7515     ELSE
  7516        MOVE ER-7345             TO EMI-ERROR
  7517        MOVE -1                  TO SIGREQL
  7518        PERFORM 9900-ERROR-FORMAT
  7519                                 THRU 9900-EXIT
  7520     END-IF
  7521     .
  7522 1000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 132
* EL6317.cbl
  7523     EXIT.
  7524 1100-CALL-NS-BUS-LOGIC.
  7525     DISPLAY ' MADE IT TO 1100 '
  7526     MOVE SPACES                 TO BL-INPUT
  7527     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7528     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7529         MOVE '2'                TO BL-DATA-SRCE
  7530         MOVE SPACES             TO BL-BATCH-NO
  7531         MOVE ZEROS              TO BL-BATCH-SEQ
  7532     ELSE
  7533         MOVE '4'                TO BL-DATA-SRCE
  7534         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7535         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7536     END-IF
  7537     MOVE PI-CARRIER             TO BL-CARRIER
  7538     MOVE PI-GROUPING            TO BL-GROUP
  7539     MOVE PI-STATE               TO BL-STATE
  7540     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7541     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7542        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7543        MOVE ' '                 TO DC-OPTION-CODE
  7544        PERFORM 9700-date-link
  7545        IF NO-CONVERSION-ERROR
  7546           MOVE DC-GREG-DATE-1-EDIT
  7547                                 TO BL-EFF-DT
  7548        END-IF
  7549     END-IF
  7550     MOVE PI-CERT-NO             TO BL-CERT-NO
  7551     MOVE SPACES                 TO BL-RESP-NO
  7552     MOVE LTRIDI                 TO BL-LETTER-ID
  7553     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7554     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7555     MOVE 'CrtVerif'               TO BL-FUNC
  7556*    MOVE 'ALWA'                 TO BL-PROC-ID
  7557     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7558*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7559*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7560     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7561     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7562     IF EIBAID = DFHPF4
  7563        MOVE 'B'                 TO BL-WRITE-ERARCH
  7564     ELSE
  7565        MOVE 'T'                 TO BL-WRITE-ERARCH
  7566     END-IF
  7567     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7568        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7569     END-PERFORM
  7570    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7571*****************************************
  7572* Invoke the LETTER business logic
  7573*****************************************
  7574
  7575* exec cics link
  7576*       program('NSRASBL')
  7577*       commarea(srch-commarea)
  7578*    end-exec.
  7579     MOVE LENGTH OF
  7580      srch-commarea
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 133
* EL6317.cbl
  7581       TO DFHEIV11
  7582     MOVE 'NSRASBL' TO DFHEIV1
  7583*    MOVE '."C                   (   #00007003' TO DFHEIV0
  7584     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7586     MOVE X'2020233030303037303033' TO DFHEIV0(25:11)
  7587     CALL 'kxdfhei1' USING DFHEIV0,
  7588           DFHEIV1,
  7589           srch-commarea,
  7590           DFHEIV11,
  7591           DFHEIV99,
  7592           DFHEIV99,
  7593           DFHEIV99,
  7594           DFHEIV99
  7595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7596
  7597     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7598        BL-MESSAGE
  7599     .
  7600 1100-EXIT.
  7601     EXIT.
  7602 1500-GET-ARCH-NO.
  7603     display ' made it to 1500 '
  7604     MOVE SPACES                 TO ELCNTL-KEY
  7605     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7606     MOVE '1'                    TO CNTL-REC-TYPE
  7607     MOVE ZEROS                  TO CNTL-SEQ
  7608
  7609* EXEC CICS READ
  7610*         DATASET    (WS-ELCNTL-FILE-ID)
  7611*         SET        (ADDRESS OF CONTROL-FILE)
  7612*         RIDFLD     (ELCNTL-KEY)
  7613*         UPDATE
  7614*         RESP       (WS-RESPONSE)
  7615*    END-EXEC
  7616*    MOVE '&"S        EU         (  N#00007018' TO DFHEIV0
  7617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7619     MOVE X'204E233030303037303138' TO DFHEIV0(25:11)
  7620     CALL 'kxdfhei1' USING DFHEIV0,
  7621           WS-ELCNTL-FILE-ID,
  7622           DFHEIV20,
  7623           DFHEIV99,
  7624           ELCNTL-KEY,
  7625           DFHEIV99,
  7626           DFHEIV99,
  7627           DFHEIV99
  7628     SET ADDRESS OF CONTROL-FILE TO
  7629         DFHEIV20
  7630     MOVE EIBRESP  TO WS-RESPONSE
  7631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7632     IF RESP-NORMAL
  7633        display ' good read elcntl '
  7634        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7635           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7636        END-IF
  7637        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7638        MOVE CF-CREDIT-LAST-ARCH-NUM
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 134
* EL6317.cbl
  7639                                 TO W-ARCH-NUMBER
  7640        display ' new arch number ' w-arch-number
  7641
  7642* EXEC CICS REWRITE
  7643*          FROM      (CONTROL-FILE)
  7644*          DATASET   (WS-ELCNTL-FILE-ID)
  7645*       END-EXEC
  7646     MOVE LENGTH OF
  7647      CONTROL-FILE
  7648       TO DFHEIV11
  7649*    MOVE '&& L                  %   #00007034' TO DFHEIV0
  7650     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7651     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7652     MOVE X'2020233030303037303334' TO DFHEIV0(25:11)
  7653     CALL 'kxdfhei1' USING DFHEIV0,
  7654           WS-ELCNTL-FILE-ID,
  7655           CONTROL-FILE,
  7656           DFHEIV11,
  7657           DFHEIV99
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7659     END-IF
  7660     .
  7661 1500-EXIT.
  7662     EXIT.
  7663
  7664
  7665 1700-WRITE-CERT-NOTE      SECTION.
  7666
  7667
  7668     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7669     MOVE ZERO           TO ERCNOT-SEQ.
  7670     SET TB-INDX         DOWN BY 1.
  7671     SET TB-INDX1        TO TB-INDX.
  7672
  7673****DELETE CURRENT CERT NOTES
  7674 1700-LOOP.
  7675
  7676* EXEC CICS READ
  7677*        DATASET (WS-ERCNOT-FILE-ID)
  7678*        RIDFLD  (ERCNOT-KEY)
  7679*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7680*        RESP    (WS-RESPONSE)
  7681*        GTEQ
  7682*    END-EXEC.
  7683*    MOVE '&"S        G          (  N#00007054' TO DFHEIV0
  7684     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7686     MOVE X'204E233030303037303534' TO DFHEIV0(25:11)
  7687     CALL 'kxdfhei1' USING DFHEIV0,
  7688           WS-ERCNOT-FILE-ID,
  7689           DFHEIV20,
  7690           DFHEIV99,
  7691           ERCNOT-KEY,
  7692           DFHEIV99,
  7693           DFHEIV99,
  7694           DFHEIV99
  7695     SET ADDRESS OF CERT-NOTE-FILE TO
  7696         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 135
* EL6317.cbl
  7697     MOVE EIBRESP  TO WS-RESPONSE
  7698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7699
  7700
  7701     IF NOT RESP-NORMAL
  7702        GO TO 1700-ENDDEL
  7703     END-IF
  7704
  7705     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  7706
  7707     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  7708         GO TO 1700-ENDDEL
  7709     END-IF.
  7710
  7711
  7712* EXEC CICS DELETE
  7713*        DATASET (WS-ERCNOT-FILE-ID)
  7714*        RIDFLD  (ERCNOT-KEY)
  7715*    END-EXEC.
  7716*    MOVE '&(  R                 &   #00007072' TO DFHEIV0
  7717     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7719     MOVE X'2020233030303037303732' TO DFHEIV0(25:11)
  7720     CALL 'kxdfhei1' USING DFHEIV0,
  7721           WS-ERCNOT-FILE-ID,
  7722           ERCNOT-KEY,
  7723           DFHEIV99,
  7724           DFHEIV99,
  7725           DFHEIV99
  7726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7727
  7728
  7729     GO TO 1700-LOOP.
  7730
  7731 1700-ENDDEL.
  7732
  7733
  7734* EXEC CICS GETMAIN
  7735*         LENGTH(ERCNOT-LENGTH)
  7736*         SET(ADDRESS OF CERT-NOTE-FILE)
  7737*         INITIMG(GETMAIN-SPACE)
  7738*    END-EXEC.
  7739*    MOVE ',"IL                  $   #00007081' TO DFHEIV0
  7740     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7742     MOVE X'2020233030303037303831' TO DFHEIV0(25:11)
  7743     CALL 'kxdfhei1' USING DFHEIV0,
  7744           DFHEIV20,
  7745           ERCNOT-LENGTH,
  7746           GETMAIN-SPACE
  7747     SET ADDRESS OF CERT-NOTE-FILE TO
  7748         DFHEIV20
  7749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7750
  7751
  7752     SET TB-INDX TO 1.
  7753     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  7754     MOVE +0             TO ERCNOT-SEQ
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 136
* EL6317.cbl
  7755
  7756     PERFORM VARYING TB-INDX FROM 1 BY 1
  7757             UNTIL TB-INDX > TB-INDX1
  7758        MOVE SPACES                 TO  CERT-NOTE-FILE
  7759        ADD 1                       TO  ERCNOT-SEQ
  7760        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  7761        MOVE  'CZ'                  TO  CZ-RECORD-ID
  7762        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  7763        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  7764                                    TO  CZ-LAST-MAINT-USER
  7765        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7766                                    TO  CZ-LAST-MAINT-HHMMSS
  7767        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  7768                                    TO  CZ-LAST-MAINT-DT
  7769
  7770
  7771* EXEC CICS WRITE
  7772*            DATASET(WS-ERCNOT-FILE-ID)
  7773*            FROM(CERT-NOTE-FILE)
  7774*            RIDFLD(ERCNOT-KEY)
  7775*       END-EXEC
  7776     MOVE LENGTH OF
  7777      CERT-NOTE-FILE
  7778       TO DFHEIV11
  7779*    MOVE '&$ L                  ''   #00007105' TO DFHEIV0
  7780     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7782     MOVE X'2020233030303037313035' TO DFHEIV0(25:11)
  7783     CALL 'kxdfhei1' USING DFHEIV0,
  7784           WS-ERCNOT-FILE-ID,
  7785           CERT-NOTE-FILE,
  7786           DFHEIV11,
  7787           ERCNOT-KEY,
  7788           DFHEIV99,
  7789           DFHEIV99
  7790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7791     END-PERFORM
  7792
  7793     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7794     IF RESP-NORMAL
  7795        EVALUATE CM-NOTE-SW
  7796           WHEN '1'
  7797           WHEN '3'
  7798           WHEN '5'
  7799           WHEN '7'
  7800              SET NO-CERT-RW     TO TRUE
  7801           WHEN ' '
  7802              MOVE '1'           TO CM-NOTE-SW
  7803           WHEN '2'
  7804              MOVE '3'           TO CM-NOTE-SW
  7805           WHEN '4'
  7806              MOVE '5'           TO CM-NOTE-SW
  7807           WHEN '6'
  7808              MOVE '7'           TO CM-NOTE-SW
  7809        END-EVALUATE
  7810     END-IF
  7811     IF NOT NO-CERT-RW
  7812        PERFORM 1810-REWRITE-ELCERT
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 137
* EL6317.cbl
  7813                                 THRU 1810-EXIT
  7814     ELSE
  7815
  7816* EXEC CICS UNLOCK
  7817*          DATASET    (WS-ELCERT-FILE-ID)
  7818*       END-EXEC
  7819*    MOVE '&*                    #   #00007134' TO DFHEIV0
  7820     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7822     MOVE X'2020233030303037313334' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0,
  7824           WS-ELCERT-FILE-ID,
  7825           DFHEIV99
  7826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7827     END-IF
  7828
  7829     .
  7830 1799-EXIT.
  7831     EXIT.
  7832
  7833 1800-READ-ELCERT-UPDATE.
  7834
  7835     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  7836     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  7837     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  7838     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  7839     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  7840     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  7841     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  7842     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  7843
  7844
  7845* EXEC CICS READ
  7846*        UPDATE
  7847*        DATASET  (WS-ELCERT-FILE-ID)
  7848*        RIDFLD   (WS-ELCERT-KEY)
  7849*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7850*        RESP     (WS-RESPONSE)
  7851*    END-EXEC
  7852*    MOVE '&"S        EU         (  N#00007154' TO DFHEIV0
  7853     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7854     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7855     MOVE X'204E233030303037313534' TO DFHEIV0(25:11)
  7856     CALL 'kxdfhei1' USING DFHEIV0,
  7857           WS-ELCERT-FILE-ID,
  7858           DFHEIV20,
  7859           DFHEIV99,
  7860           WS-ELCERT-KEY,
  7861           DFHEIV99,
  7862           DFHEIV99,
  7863           DFHEIV99
  7864     SET ADDRESS OF CERTIFICATE-MASTER TO
  7865         DFHEIV20
  7866     MOVE EIBRESP  TO WS-RESPONSE
  7867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7868
  7869     .
  7870 1800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 138
* EL6317.cbl
  7871     EXIT.
  7872
  7873 1810-REWRITE-ELCERT.
  7874
  7875
  7876* EXEC CICS REWRITE
  7877*        FROM     (CERTIFICATE-MASTER)
  7878*        DATASET  (WS-ELCERT-FILE-ID)
  7879*        RESP     (WS-RESPONSE)
  7880*    END-EXEC.
  7881     MOVE LENGTH OF
  7882      CERTIFICATE-MASTER
  7883       TO DFHEIV11
  7884*    MOVE '&& L                  %  N#00007168' TO DFHEIV0
  7885     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7886     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7887     MOVE X'204E233030303037313638' TO DFHEIV0(25:11)
  7888     CALL 'kxdfhei1' USING DFHEIV0,
  7889           WS-ELCERT-FILE-ID,
  7890           CERTIFICATE-MASTER,
  7891           DFHEIV11,
  7892           DFHEIV99
  7893     MOVE EIBRESP  TO WS-RESPONSE
  7894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7895
  7896
  7897     .
  7898 1810-EXIT.
  7899     EXIT.
  7900
  7901 8100-SEND-INITIAL-MAP.
  7902     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7903     MOVE '5'                    TO DC-OPTION-CODE.
  7904     PERFORM 9700-DATE-LINK.
  7905     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7906     MOVE EIBTIME                TO TIME-IN.
  7907     MOVE TIME-OUT               TO TIMEO.
  7908     MOVE -1                     TO SIGREQL.
  7909     IF PI-PROCESSOR-IS-CSR-SUPER
  7910        perform varying s1 from +1 by +1 until
  7911           s1 > +12
  7912           MOVE AL-UANON            TO reacda (s1)
  7913        end-perform
  7914     END-IF
  7915     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  7916     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  7917
  7918* EXEC CICS SEND
  7919*        MAP      (MAP-NAME)
  7920*        MAPSET   (MAPSET-NAME)
  7921*        FROM     (EL631JO)
  7922*        ERASE
  7923*        CURSOR
  7924*    END-EXEC.
  7925     MOVE LENGTH OF
  7926      EL631JO
  7927       TO DFHEIV12
  7928     MOVE -1
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 139
* EL6317.cbl
  7929       TO DFHEIV11
  7930*    MOVE '8$     CT  E    H L F ,   #00007194' TO DFHEIV0
  7931     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7932     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7933     MOVE X'2020233030303037313934' TO DFHEIV0(25:11)
  7934     CALL 'kxdfhei1' USING DFHEIV0,
  7935           MAP-NAME,
  7936           EL631JO,
  7937           DFHEIV12,
  7938           MAPSET-NAME,
  7939           DFHEIV99,
  7940           DFHEIV99,
  7941           DFHEIV99,
  7942           DFHEIV11,
  7943           DFHEIV99,
  7944           DFHEIV99,
  7945           DFHEIV99
  7946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7947
  7948     GO TO 9100-RETURN-TRAN.
  7949 8200-SEND-DATAONLY.
  7950     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7951     MOVE '5'                    TO DC-OPTION-CODE.
  7952     PERFORM 9700-DATE-LINK.
  7953     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  7954     MOVE EIBTIME                TO TIME-IN.
  7955     MOVE TIME-OUT               TO TIMEO.
  7956     MOVE -1                     TO PFENTRL
  7957     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  7958     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  7959
  7960* EXEC CICS SEND
  7961*        MAP      (MAP-NAME)
  7962*        MAPSET   (MAPSET-NAME)
  7963*        FROM     (EL631JO)
  7964*        DATAONLY
  7965*        ERASEAUP
  7966*        CURSOR
  7967*    END-EXEC.
  7968     MOVE LENGTH OF
  7969      EL631JO
  7970       TO DFHEIV12
  7971     MOVE -1
  7972       TO DFHEIV11
  7973*    MOVE '8$D    CT  A    H L F ,   #00007212' TO DFHEIV0
  7974     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  7975     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7976     MOVE X'2020233030303037323132' TO DFHEIV0(25:11)
  7977     CALL 'kxdfhei1' USING DFHEIV0,
  7978           MAP-NAME,
  7979           EL631JO,
  7980           DFHEIV12,
  7981           MAPSET-NAME,
  7982           DFHEIV99,
  7983           DFHEIV99,
  7984           DFHEIV99,
  7985           DFHEIV11,
  7986           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 140
* EL6317.cbl
  7987           DFHEIV99,
  7988           DFHEIV99
  7989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7990
  7991     GO TO 9100-RETURN-TRAN.
  7992 8300-SEND-TEXT.
  7993
  7994* EXEC CICS SEND TEXT
  7995*        FROM     (LOGOFF-TEXT)
  7996*        LENGTH   (LOGOFF-LENGTH)
  7997*        ERASE
  7998*        FREEKB
  7999*    END-EXEC.
  8000*    MOVE '8&      T  E F  H   F -   #00007222' TO DFHEIV0
  8001     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8002     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8003     MOVE X'2020233030303037323232' TO DFHEIV0(25:11)
  8004     CALL 'kxdfhei1' USING DFHEIV0,
  8005           LOGOFF-TEXT,
  8006           LOGOFF-LENGTH,
  8007           DFHEIV99,
  8008           DFHEIV99,
  8009           DFHEIV99,
  8010           DFHEIV99,
  8011           DFHEIV99,
  8012           DFHEIV99,
  8013           DFHEIV99,
  8014           DFHEIV99,
  8015           DFHEIV99,
  8016           DFHEIV99
  8017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8018
  8019
  8020* EXEC CICS RETURN
  8021*    END-EXEC.
  8022*    MOVE '.(                    ''   #00007228' TO DFHEIV0
  8023     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8025     MOVE X'2020233030303037323238' TO DFHEIV0(25:11)
  8026     CALL 'kxdfhei1' USING DFHEIV0,
  8027           DFHEIV99,
  8028           DFHEIV99,
  8029           DFHEIV99,
  8030           DFHEIV99,
  8031           DFHEIV99,
  8032           DFHEIV99
  8033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8034
  8035 8800-UNAUTHORIZED-ACCESS.
  8036     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8037     GO TO 8300-SEND-TEXT.
  8038 8810-PF23.
  8039     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8040     MOVE XCTL-005               TO PGM-NAME.
  8041     GO TO 9300-XCTL.
  8042 9000-RETURN-CICS.
  8043
  8044* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 141
* EL6317.cbl
  8045*    END-EXEC.
  8046*    MOVE '.(                    ''   #00007238' TO DFHEIV0
  8047     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8049     MOVE X'2020233030303037323338' TO DFHEIV0(25:11)
  8050     CALL 'kxdfhei1' USING DFHEIV0,
  8051           DFHEIV99,
  8052           DFHEIV99,
  8053           DFHEIV99,
  8054           DFHEIV99,
  8055           DFHEIV99,
  8056           DFHEIV99
  8057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8058
  8059 9100-RETURN-TRAN.
  8060     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8061     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8062
  8063* EXEC CICS RETURN
  8064*        TRANSID    (TRANS-ID)
  8065*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8066*        LENGTH     (PI-COMM-LENGTH)
  8067*    END-EXEC.
  8068*    MOVE '.(CT                  ''   #00007243' TO DFHEIV0
  8069     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8071     MOVE X'2020233030303037323433' TO DFHEIV0(25:11)
  8072     CALL 'kxdfhei1' USING DFHEIV0,
  8073           TRANS-ID,
  8074           PROGRAM-INTERFACE-BLOCK,
  8075           PI-COMM-LENGTH,
  8076           DFHEIV99,
  8077           DFHEIV99,
  8078           DFHEIV99
  8079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8080
  8081 9200-RETURN-MAIN-MENU.
  8082     MOVE XCTL-626               TO PGM-NAME.
  8083     GO TO 9300-XCTL.
  8084 9300-XCTL.
  8085
  8086* EXEC CICS XCTL
  8087*        PROGRAM    (PGM-NAME)
  8088*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8089*        LENGTH     (PI-COMM-LENGTH)
  8090*    END-EXEC.
  8091*    MOVE '.$C                   %   #00007252' TO DFHEIV0
  8092     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8093     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8094     MOVE X'2020233030303037323532' TO DFHEIV0(25:11)
  8095     CALL 'kxdfhei1' USING DFHEIV0,
  8096           PGM-NAME,
  8097           PROGRAM-INTERFACE-BLOCK,
  8098           PI-COMM-LENGTH,
  8099           DFHEIV99
  8100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8101
  8102 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 142
* EL6317.cbl
  8103     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8104
  8105* EXEC CICS XCTL
  8106*        PROGRAM    (PGM-NAME)
  8107*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8108*        LENGTH     (PI-COMM-LENGTH)
  8109*    END-EXEC.
  8110*    MOVE '.$C                   %   #00007259' TO DFHEIV0
  8111     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037323539' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           PGM-NAME,
  8116           PROGRAM-INTERFACE-BLOCK,
  8117           PI-COMM-LENGTH,
  8118           DFHEIV99
  8119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8120
  8121 9500-PF12.
  8122     MOVE XCTL-010               TO PGM-NAME.
  8123     GO TO 9300-XCTL.
  8124 9600-PGMID-ERROR.
  8125
  8126* EXEC CICS HANDLE CONDITION
  8127*        PGMIDERR    (8300-SEND-TEXT)
  8128*    END-EXEC.
  8129*    MOVE '"$L                   ! " #00007268' TO DFHEIV0
  8130     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8132     MOVE X'2220233030303037323638' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0
  8134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8135
  8136     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8137     MOVE ' '                    TO PI-ENTRY-CD-1.
  8138     MOVE XCTL-005               TO PGM-NAME.
  8139     MOVE PGM-NAME               TO LOGOFF-PGM.
  8140     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8141     GO TO 9300-XCTL.
  8142 9700-DATE-LINK.
  8143     MOVE LINK-ELDATCV           TO PGM-NAME.
  8144
  8145* EXEC CICS LINK
  8146*        PROGRAM    (PGM-NAME)
  8147*        COMMAREA   (DATE-CONVERSION-DATA)
  8148*        LENGTH     (DC-COMM-LENGTH)
  8149*    END-EXEC.
  8150*    MOVE '."C                   (   #00007279' TO DFHEIV0
  8151     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8153     MOVE X'2020233030303037323739' TO DFHEIV0(25:11)
  8154     CALL 'kxdfhei1' USING DFHEIV0,
  8155           PGM-NAME,
  8156           DATE-CONVERSION-DATA,
  8157           DC-COMM-LENGTH,
  8158           DFHEIV99,
  8159           DFHEIV99,
  8160           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 143
* EL6317.cbl
  8161           DFHEIV99
  8162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8163
  8164 9900-ERROR-FORMAT.
  8165     IF NOT EMI-ERRORS-COMPLETE
  8166        MOVE LINK-001            TO PGM-NAME
  8167
  8168* EXEC CICS LINK
  8169*           PROGRAM    (PGM-NAME)
  8170*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8171*           LENGTH     (EMI-COMM-LENGTH)
  8172*       END-EXEC
  8173*    MOVE '."C                   (   #00007287' TO DFHEIV0
  8174     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8176     MOVE X'2020233030303037323837' TO DFHEIV0(25:11)
  8177     CALL 'kxdfhei1' USING DFHEIV0,
  8178           PGM-NAME,
  8179           ERROR-MESSAGE-INTERFACE-BLOCK,
  8180           EMI-COMM-LENGTH,
  8181           DFHEIV99,
  8182           DFHEIV99,
  8183           DFHEIV99,
  8184           DFHEIV99
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8186     END-IF
  8187     .
  8188 9900-EXIT.
  8189     EXIT.
  8190 9990-ABEND.
  8191     MOVE LINK-004               TO PGM-NAME.
  8192     MOVE DFHEIBLK               TO EMI-LINE1.
  8193
  8194* EXEC CICS LINK
  8195*        PROGRAM   (PGM-NAME)
  8196*        COMMAREA  (EMI-LINE1)
  8197*        LENGTH    (72)
  8198*    END-EXEC.
  8199     MOVE 72
  8200       TO DFHEIV11
  8201*    MOVE '."C                   (   #00007299' TO DFHEIV0
  8202     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8203     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8204     MOVE X'2020233030303037323939' TO DFHEIV0(25:11)
  8205     CALL 'kxdfhei1' USING DFHEIV0,
  8206           PGM-NAME,
  8207           EMI-LINE1,
  8208           DFHEIV11,
  8209           DFHEIV99,
  8210           DFHEIV99,
  8211           DFHEIV99,
  8212           DFHEIV99
  8213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8214
  8215     GO TO 8200-SEND-DATAONLY.
  8216
  8217* GOBACK.
  8218     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 144
* EL6317.cbl
  8219     MOVE 'EL6317' TO DFHEIV1
  8220     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8221     GOBACK.
  8222 9995-SECURITY-VIOLATION.
  8223*                            COPY ELCSCTP.
  8224******************************************************************
  8225*                                                                *
  8226*                            ELCSCTP                             *
  8227*                            VMOD=2.001                          *
  8228*                                                                *
  8229*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8230******************************************************************
  8231
  8232
  8233     MOVE EIBDATE          TO SM-JUL-DATE.
  8234     MOVE EIBTRMID         TO SM-TERMID.
  8235     MOVE THIS-PGM         TO SM-PGM.
  8236     MOVE EIBTIME          TO TIME-IN.
  8237     MOVE TIME-OUT         TO SM-TIME.
  8238     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8239
  8240
  8241* EXEC CICS LINK
  8242*         PROGRAM  ('EL003')
  8243*         COMMAREA (SECURITY-MESSAGE)
  8244*         LENGTH   (80)
  8245*    END-EXEC.
  8246     MOVE 'EL003' TO DFHEIV1
  8247     MOVE 80
  8248       TO DFHEIV11
  8249*    MOVE '."C                   (   #00007324' TO DFHEIV0
  8250     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8251     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8252     MOVE X'2020233030303037333234' TO DFHEIV0(25:11)
  8253     CALL 'kxdfhei1' USING DFHEIV0,
  8254           DFHEIV1,
  8255           SECURITY-MESSAGE,
  8256           DFHEIV11,
  8257           DFHEIV99,
  8258           DFHEIV99,
  8259           DFHEIV99,
  8260           DFHEIV99
  8261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8262
  8263
  8264******************************************************************
  8265
  8266 9995-EXIT.
  8267     EXIT.
  8268
  8269 9999-DFHBACK SECTION.
  8270     MOVE '9%                    "   ' TO DFHEIV0
  8271     MOVE 'EL6317' TO DFHEIV1
  8272     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8273     GOBACK.
  8274 9999-DFHEXIT.
  8275     IF DFHEIGDJ EQUAL 0001
  8276         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Jan-13 12:09 Page 145
* EL6317.cbl
  8277     ELSE IF DFHEIGDJ EQUAL 2
  8278         GO TO 8300-SEND-TEXT
  8279         DEPENDING ON DFHEIGDI.
  8280     MOVE '9%                    "   ' TO DFHEIV0
  8281     MOVE 'EL6317' TO DFHEIV1
  8282     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8283     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34536     Code:       18509
