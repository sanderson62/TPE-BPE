* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   1
* EL156.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL156.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   2
* EL156.cbl
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38******************************************************************
    39
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   3
* EL156.cbl
    41 ENVIRONMENT DIVISION.
    42
    43 DATA DIVISION.
    44
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    50 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    51 77  WS-SSN  PIC X(9) VALUE ZEROS.
    52 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    53
    54*    COPY ELCSCTM.
    55******************************************************************
    56*                                                                *
    57*                                                                *
    58*                            ELCSCTM                             *
    59*                            VMOD=2.001                          *
    60*                                                                *
    61*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    62*                                                                *
    63******************************************************************
    64 01  SECURITY-MESSAGE.
    65     12  FILLER                          PIC X(30)
    66            VALUE '** LOGIC SECURITY VIOLATION -'.
    67     12  SM-READ                         PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' PGM='.
    70     12  SM-PGM                          PIC X(6).
    71     12  FILLER                          PIC X(5)
    72            VALUE ' OPR='.
    73     12  SM-PROCESSOR-ID                 PIC X(4).
    74     12  FILLER                          PIC X(6)
    75            VALUE ' TERM='.
    76     12  SM-TERMID                       PIC X(4).
    77     12  FILLER                          PIC XX   VALUE SPACE.
    78     12  SM-JUL-DATE                     PIC 9(5).
    79     12  FILLER                          PIC X    VALUE SPACE.
    80     12  SM-TIME                         PIC 99.99.
    81
    82
    83*    COPY ELCSCRTY.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCRTY                            *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    92*        SAVED IN PI-SECURITY-ADDRESS.                           *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-CONTROL.
    96     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    97     12  FILLER                       PIC XX    VALUE 'SC'.
    98     12  SC-CREDIT-CODES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   4
* EL156.cbl
    99         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   100             20  SC-CREDIT-DISPLAY    PIC X.
   101             20  SC-CREDIT-UPDATE     PIC X.
   102     12  SC-CLAIMS-CODES.
   103         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   104             20  SC-CLAIMS-DISPLAY    PIC X.
   105             20  SC-CLAIMS-UPDATE     PIC X.
   106
   107 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   108 01  WS-DATE-AREA.
   109     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   110     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   111     12  SAVE-DATE-CCYYMMDD.
   112         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   113         16  SAVE-DATE-YMD.
   114             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   115             20  FILLER              PIC X(04)   VALUE SPACES.
   116
   117 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   118 01  STANDARD-AREAS.
   119     12  WS-RESPONSE         PIC S9(8)   COMP.
   120         88  WS-RESP-NORMAL              VALUE +00.
   121         88  WS-RESP-ERROR               VALUE +01.
   122         88  WS-RESP-NOTFND              VALUE +13.
   123         88  WS-RESP-DUPREC              VALUE +14.
   124         88  WS-RESP-ENDFILE             VALUE +20.
   125     12  PMT-HEAD-A.
   126         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   127         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   128         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   129-        '     RESERVES  TYPE    AMOUNT'.
   130     12  PMT-HEAD-B.
   131         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   132         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   133         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   134     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   135     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   136     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   137     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   138     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   139     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   140     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   141     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   142     12  PGM-NAME            PIC X(8).
   143     12  TIME-IN             PIC S9(7).
   144     12  TIME-OUT-R  REDEFINES TIME-IN.
   145         16  FILLER          PIC X.
   146         16  TIME-OUT        PIC 99V99.
   147         16  FILLER          PIC XX.
   148     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   149     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   150     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   151     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   152     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   153     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   154     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   155     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   156     12  LINK-001            PIC X(8)    VALUE 'EL001'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   5
* EL156.cbl
   157     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   158     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   159     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   160     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   161     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   162     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   163     12  WS-BLANK            PIC X       VALUE ' '.
   164
   165 01  MISC-WORK-AREAS.
   166     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   167     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   168     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   169     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   170     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   171     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   172     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   173     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   174     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   175     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   176     12  W-CALLED-NAME           PIC X(08).
   177     12  W-EOB-CODES.
   178         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   179             20  W-EOB-CODE      PIC XXX.
   180             20  W-EOB-FILLER    PIC X.
   181     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   182     12  W-NAME-LAST             PIC X(15).
   183     12  W-NAME-FIRST            PIC X(15).
   184     12  W-NAME-MIDDLE.
   185         16  FILLER              PIC X.
   186         16  W-NAME-MIDDLE-2     PIC X.
   187         16  FILLER              PIC X(13).
   188     12  W-DMD-CHECK-NO.
   189         16  W-DMD-CHECK-NO-1    PIC X(4).
   190         16  W-DMD-CHECK-NO-2    PIC X.
   191         16  W-DMD-CHECK-NO-3    PIC XX.
   192
   193     12  WS-COMPUTE-FROM-DT  PIC XX.
   194     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   195     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   196     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   197     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   198     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   199     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   200         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   201         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   202     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   203         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   204     12  WS-UPDATE-SW        PIC X VALUE ' '.
   205     12  WS-GROUPING.
   206         16  WS-GROUP-1      PIC X VALUE SPACES.
   207         16  FILLER          PIC X(05) VALUE SPACES.
   208     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   209     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   210     12  WS-WORK-STATE-ACCT.
   211         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   212         16  FILLER          PIC X       VALUE '/'.
   213         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   214     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   6
* EL156.cbl
   215     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   216     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   217     12  QID.
   218         16  QID-TERM        PIC X(4)    VALUE SPACES.
   219         16  FILLER          PIC X(4)    VALUE '156A'.
   220     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   221     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   222     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   223     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   224     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   225     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   226     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   227     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   228     12  WS-STATUS           PIC X       VALUE SPACES.
   229     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   230     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   231     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   232     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   233     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   234     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   235     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   236     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   237     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   238     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   239     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   240     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   241     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   242     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   243     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   244     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   245     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   246     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   247     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   248     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   249     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   250     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   251     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   252     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   253     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   254     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   255     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   256     12  WORK-DATE-FROM.
   257         16  WDF-MONTH       PIC 99        VALUE ZERO.
   258         16  WDF-DAY         PIC 99        VALUE ZERO.
   259         16  WDF-YEAR        PIC 99        VALUE ZERO.
   260     12  WORK-DATE-THRU.
   261         16  WDT-MONTH       PIC 99        VALUE ZERO.
   262         16  WDT-DAY         PIC 99        VALUE ZERO.
   263         16  WDT-YEAR        PIC 99        VALUE ZERO.
   264     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   265     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   266     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   267     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   268     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   269     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   270     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   271     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   272     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   7
* EL156.cbl
   273     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   274     12  WS-PY-WK REDEFINES WS-PY-WORK.
   275         16  WS-PY-NUM       PIC S9(7)V99.
   276         16  WS-PY-SIGN      PIC X.
   277     12  WS-DY-WORK          PIC S9(5).
   278     12  WS-DY-WK REDEFINES WS-DY-WORK.
   279         16  WS-DY-NUM       PIC S9(4).
   280         16  WS-DY-SIGN      PIC X.
   281     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   282         88  COMP-REC-FOUND              VALUE 'Y'.
   283     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   284         88  BENEFIT-FOUND       VALUE 'Y'.
   285         88  NO-BENEFIT-FOUND    VALUE 'N'.
   286     12  WS-TERMS.
   287         16  WST-ORIG        PIC --9     VALUE ZEROS.
   288         16  FILLER          PIC X       VALUE '/'.
   289         16  WST-REM         PIC --9     VALUE ZEROS.
   290         16  WST-REM-DAYS-GRP.
   291             20  WST-SLASH   PIC X       VALUE '/'.
   292             20  WST-REM-DAYS
   293                             PIC --9.
   294     12  WS-ACCESS.
   295         16  FILLER          PIC XX      VALUE SPACES.
   296         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   297     12  WS-STATE-ACCESS.
   298         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   299         16  FILLER          PIC XX      VALUE SPACES.
   300     12  WS-CARR-ACCESS.
   301         16  FILLER          PIC X(3)    VALUE SPACES.
   302         16  WS-CARR         PIC X       VALUE SPACES.
   303     12  DATE-WORK.
   304         16  FILLER          PIC XX      VALUE SPACES.
   305         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   306     12  WS-SAVE-INPUT.
   307         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   308         16  WS-PAYEE        PIC XX      VALUE SPACE.
   309         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   310         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   311         16  WS-OFFLINE      PIC X       VALUE SPACE.
   312         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   313         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   314         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   315         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   316         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   317         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   318         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   319         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   320         16  WS-ETYPE        PIC X       VALUE SPACE.
   321         16  WS-CASH         PIC X       VALUE SPACE.
   322         16  WS-GROUPED      PIC X       VALUE SPACE.
   323         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   324         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   325         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   326         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   327         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   328     12  LAST-ERROR-LINE.
   329         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   330         16  FILLER              PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   8
* EL156.cbl
   331             VALUE ' FATAL ERRORS ENCOUNTERED'.
   332         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   333         16  FILLER              PIC X(28)
   334             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   335     12  WS-CHECK-AREA.
   336         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   337         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   338     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   339     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   340         16  FILLER              PIC XX.
   341         16  WS-A-CHECK-NUM-5    PIC 9(5).
   342     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   343         16  FILLER              PIC X.
   344         16  WS-A-CHECK-NUM-6    PIC 9(6).
   345     12  OPTION-1-SAVE-AREA.
   346         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   347         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   348     12  WS-WORK-ZIP.
   349         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   350         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   351     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   352                                 PIC 9(9).
   353     12  WS-FLI-PMTNOTE.
   354         16  WS-PMTOPTION        PIC XX.
   355         16  WS-DOCNAME          PIC X(28).
   356         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   357             20  WS-AMOUNT       PIC X(8).
   358             20  FILLER          PIC X(20).
   359         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   360             20  WS-NUM-AMT      PIC 9(6)V99.
   361             20  FILLER          PIC X(20).
   362
   363     12  WS-HAN-PMTNOTE.
   364         16  WS-HAN-PMT-CODE     PIC X.
   365         16  WS-HAN-PMT-NOTE     PIC X(39).
   366
   367     12  WS-NCL-PMT-OPTION       PIC XX.
   368         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   369
   370     12  WS-CLAIM-SEQUENCE.
   371         16  FILLER              PIC X VALUE '('.
   372         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   373         16  FILLER              PIC X(04) VALUE ' OF '.
   374         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   375         16  FILLER              PIC X VALUE ')'.
   376
   377     12  WS-REFUND-AMT           PIC Z(7).99.
   378     12  WS-CALC-INT             PIC S9(7)V99.
   379     12  WS-CRIT-PERIOD-DAYS     PIC S9(4)V999 VALUE +0  COMP-3.
   380
   381     12  SUB                     PIC 99 VALUE ZEROS.
   382
   383     12  WS-BOANOTE1.
   384         16  WS-BOANOTE1-DESC    PIC X(11).
   385         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   386         16  FILLER              PIC X(17).
   387     12  WS-BOANOTE2.
   388         16  WS-BOANOTE2-DESC    PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page   9
* EL156.cbl
   389         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   390         16  FILLER              PIC X(17).
   391
   392     12  WS-NCLNOTE1.
   393         16  WS-NCLNOTE1-DESC    PIC X(11).
   394         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   395         16  FILLER              PIC X(17).
   396     12  WS-NCLNOTE2.
   397         16  WS-NCLNOTE2-DESC    PIC X(11).
   398         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   399         16  FILLER              PIC X(17).
   400
   401     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   402     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   403     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   404     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   405     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   406     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   407     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   408     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   409     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   410     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   411
   412     12  WS-AIG-WORK-AREAS.
   413         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   414             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   415         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   416             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   417         16  WS-FROM-DATE-MDY.
   418             20  WS-FROM-MO      PIC 99.
   419             20  WS-FROM-DA      PIC 99.
   420             20  WS-FROM-YR      PIC 99.
   421         16  WS-TEMP-DATE-MDY.
   422             20  WS-TEMP-MO      PIC 99.
   423             20  WS-TEMP-DA      PIC 99.
   424             20  WS-TEMP-YR      PIC 99.
   425         16  WS-BIN-FROM-DT      PIC XX.
   426         16  WS-TEMP-INC-MDY.
   427             20  WS-TEMP-INC-MO  PIC 99.
   428             20  WS-TEMP-INC-DA  PIC 99.
   429             20  WS-TEMP-INC-YR  PIC 99.
   430         16  WS-PMT-DUE-MDY.
   431             20  WS-PMT-DUE-MO   PIC 99.
   432             20  WS-PMT-DUE-DA   PIC 99.
   433             20  WS-PMT-DUE-YR   PIC 99.
   434         16  WS-PMT-DUE-DT       PIC XX.
   435         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   436         16  WS-RETRO-ELIM-DT    PIC XX.
   437         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   438             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   439         16  WS-SAVE-DUE-DA      PIC 99.
   440         16  WS-CDAYS            PIC S9(05).
   441         16  WS-DAYS-OFF         PIC S9(05).
   442         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   443             88  ELIM-SATISFIED            VALUE 'Y'.
   444         16  WS-AIG-CHECKNO.
   445             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   446             20  WS-A-CHECKNO-3-7.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  10
* EL156.cbl
   447                 24  FILLER              PIC X(3)    VALUE SPACES.
   448                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   449                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   450         16  WS-AIG-GROUPING.
   451             20  WS-A-BENE               PIC XXX.
   452             20  FILLER                  PIC XXX.
   453         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   454             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   455             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   456         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   457                 VALUE 'UNEMPLOYMENT PAYMENT'.
   458         16  WS-CHK-THRU-DT              PIC XX.
   459         16  WS-HOLD-BIN-DATE-1          PIC XX.
   460
   461 01  MISC-CSO-AREA.
   462     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   463         88  APPROVAL-NEEDED                        VALUE 'Y'.
   464     12  WS-APPROV-NOTE                  PIC X(43)
   465         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   466     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   467     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   468     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   469     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   470     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   471     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   472     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   473         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   474     12  WS-PAYEE-CITY-STATE     PIC X(30).
   475     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   476         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   477     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   478
   479 01  ERROR-MESSAGES.
   480     12  ER-0000                 PIC X(4)  VALUE '0000'.
   481     12  ER-0004                 PIC X(4)  VALUE '0004'.
   482     12  ER-0008                 PIC X(4)  VALUE '0008'.
   483     12  ER-0019                 PIC X(4)  VALUE '0019'.
   484     12  ER-0029                 PIC X(4)  VALUE '0029'.
   485     12  ER-0042                 PIC X(4)  VALUE '0042'.
   486     12  ER-0070                 PIC X(4)  VALUE '0070'.
   487     12  ER-0130                 PIC X(4)  VALUE '0130'.
   488     12  ER-0149                 PIC X(4)  VALUE '0149'.
   489     12  ER-0154                 PIC X(4)  VALUE '0154'.
   490     12  ER-0168                 PIC X(4)  VALUE '0168'.
   491     12  ER-0169                 PIC X(4)  VALUE '0169'.
   492     12  ER-0172                 PIC X(4)  VALUE '0174'.
   493     12  ER-0198                 PIC X(4)  VALUE '0198'.
   494     12  ER-0204                 PIC X(4)  VALUE '0204'.
   495     12  ER-0206                 PIC X(4)  VALUE '0206'.
   496     12  ER-0252                 PIC X(4)  VALUE '0252'.
   497     12  ER-0254                 PIC X(4)  VALUE '0254'.
   498     12  ER-0282                 PIC X(4)  VALUE '0282'.
   499     12  ER-0283                 PIC X(4)  VALUE '0283'.
   500     12  ER-0294                 PIC X(4)  VALUE '0294'.
   501     12  ER-0338                 PIC X(4)  VALUE '0338'.
   502     12  ER-0419                 PIC X(4)  VALUE '0419'.
   503     12  ER-0420                 PIC X(4)  VALUE '0420'.
   504     12  ER-0421                 PIC X(4)  VALUE '0421'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  11
* EL156.cbl
   505     12  ER-0422                 PIC X(4)  VALUE '0422'.
   506     12  ER-0433                 PIC X(4)  VALUE '0433'.
   507     12  ER-0436                 PIC X(4)  VALUE '0436'.
   508     12  ER-0437                 PIC X(4)  VALUE '0437'.
   509     12  ER-0438                 PIC X(4)  VALUE '0438'.
   510     12  ER-0439                 PIC X(4)  VALUE '0439'.
   511     12  ER-0440                 PIC X(4)  VALUE '0440'.
   512     12  ER-0441                 PIC X(4)  VALUE '0441'.
   513     12  ER-0442                 PIC X(4)  VALUE '0442'.
   514     12  ER-0443                 PIC X(4)  VALUE '0443'.
   515     12  ER-0444                 PIC X(4)  VALUE '0444'.
   516     12  ER-0445                 PIC X(4)  VALUE '0445'.
   517     12  ER-0446                 PIC X(4)  VALUE '0446'.
   518     12  ER-0447                 PIC X(4)  VALUE '0447'.
   519     12  ER-0448                 PIC X(4)  VALUE '0448'.
   520     12  ER-0449                 PIC X(4)  VALUE '0449'.
   521     12  ER-0452                 PIC X(4)  VALUE '0452'.
   522     12  ER-0458                 PIC X(4)  VALUE '0458'.
   523     12  ER-0459                 PIC X(4)  VALUE '0459'.
   524     12  ER-0460                 PIC X(4)  VALUE '0460'.
   525     12  ER-0461                 PIC X(4)  VALUE '0461'.
   526     12  ER-0462                 PIC X(4)  VALUE '0462'.
   527     12  ER-0463                 PIC X(4)  VALUE '0463'.
   528     12  ER-0464                 PIC X(4)  VALUE '0464'.
   529     12  ER-0465                 PIC X(4)  VALUE '0465'.
   530     12  ER-0466                 PIC X(4)  VALUE '0466'.
   531     12  ER-0467                 PIC X(4)  VALUE '0467'.
   532     12  ER-0468                 PIC X(4)  VALUE '0468'.
   533     12  ER-0469                 PIC X(4)  VALUE '0469'.
   534     12  ER-0473                 PIC X(4)  VALUE '0473'.
   535     12  ER-0474                 PIC X(4)  VALUE '0474'.
   536     12  ER-0475                 PIC X(4)  VALUE '0475'.
   537     12  ER-0476                 PIC X(4)  VALUE '0476'.
   538     12  ER-0477                 PIC X(4)  VALUE '0477'.
   539     12  ER-0478                 PIC X(4)  VALUE '0478'.
   540     12  ER-0479                 PIC X(4)  VALUE '0479'.
   541     12  ER-0481                 PIC X(4)  VALUE '0481'.
   542     12  ER-0491                 PIC X(4)  VALUE '0491'.
   543     12  ER-0492                 PIC X(4)  VALUE '0492'.
   544     12  ER-0493                 PIC X(4)  VALUE '0493'.
   545     12  ER-0494                 PIC X(4)  VALUE '0494'.
   546     12  ER-0495                 PIC X(4)  VALUE '0495'.
   547     12  ER-0499                 PIC X(4)  VALUE '0499'.
   548     12  ER-0500                 PIC X(4)  VALUE '0500'.
   549     12  ER-0501                 PIC X(4)  VALUE '0501'.
   550     12  ER-0502                 PIC X(4)  VALUE '0502'.
   551     12  ER-0508                 PIC X(4)  VALUE '0508'.
   552     12  ER-0513                 PIC X(4)  VALUE '0513'.
   553     12  ER-0518                 PIC X(4)  VALUE '0518'.
   554     12  ER-0524                 PIC X(4)  VALUE '0524'.
   555     12  ER-0525                 PIC X(4)  VALUE '0525'.
   556     12  ER-0526                 PIC X(4)  VALUE '0526'.
   557     12  ER-0530                 PIC X(4)  VALUE '0530'.
   558     12  ER-0540                 PIC X(4)  VALUE '0540'.
   559     12  ER-0541                 PIC X(4)  VALUE '0541'.
   560     12  ER-0542                 PIC X(4)  VALUE '0542'.
   561     12  ER-0543                 PIC X(4)  VALUE '0543'.
   562     12  ER-0545                 PIC X(4)  VALUE '0545'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  12
* EL156.cbl
   563     12  ER-0552                 PIC X(4)  VALUE '0552'.
   564     12  ER-0555                 PIC X(4)  VALUE '0555'.
   565     12  ER-0556                 PIC X(4)  VALUE '0556'.
   566     12  ER-0557                 PIC X(4)  VALUE '0557'.
   567     12  ER-0572                 PIC X(4)  VALUE '0572'.
   568     12  ER-0573                 PIC X(4)  VALUE '0573'.
   569     12  ER-0594                 PIC X(4)  VALUE '0594'.
   570     12  ER-0616                 PIC X(4)  VALUE '0616'.
   571     12  ER-0617                 PIC X(4)  VALUE '0617'.
   572     12  ER-0618                 PIC X(4)  VALUE '0618'.
   573     12  ER-0657                 PIC X(4)  VALUE '0657'.
   574     12  ER-0658                 PIC X(4)  VALUE '0658'.
   575     12  ER-0699                 PIC X(4)  VALUE '0699'.
   576     12  ER-0730                 PIC X(4)  VALUE '0730'.
   577     12  ER-0737                 PIC X(4)  VALUE '0737'.
   578     12  ER-0760                 PIC X(4)  VALUE '0760'.
   579     12  ER-0768                 PIC X(4)  VALUE '0768'.
   580     12  ER-0769                 PIC X(4)  VALUE '0769'.
   581     12  ER-0770                 PIC X(4)  VALUE '0770'.
   582     12  ER-0802                 PIC X(4)  VALUE '0802'.
   583     12  ER-0803                 PIC X(4)  VALUE '0803'.
   584     12  ER-0819                 PIC X(4)  VALUE '0819'.
   585     12  ER-0834                 PIC X(4)  VALUE '0834'.
   586     12  ER-0836                 PIC X(4)  VALUE '0836'.
   587     12  ER-0844                 PIC X(4)  VALUE '0844'.
   588     12  ER-0845                 PIC X(4)  VALUE '0845'.
   589     12  ER-0846                 PIC X(4)  VALUE '0846'.
   590     12  ER-0849                 PIC X(4)  VALUE '0849'.
   591     12  ER-0851                 PIC X(4)  VALUE '0851'.
   592     12  ER-0872                 PIC X(4)  VALUE '0872'.
   593     12  ER-0873                 PIC X(4)  VALUE '0873'.
   594     12  ER-0874                 PIC X(4)  VALUE '0874'.
   595     12  ER-0879                 PIC X(4)  VALUE '0879'.
   596     12  ER-0919                 PIC X(4)  VALUE '0919'.
   597     12  ER-0921                 PIC X(4)  VALUE '0921'.
   598     12  ER-0923                 PIC X(4)  VALUE '0923'.
   599     12  ER-0925                 PIC X(4)  VALUE '0925'.
   600     12  ER-0944                 PIC X(4)  VALUE '0944'.
   601     12  ER-0945                 PIC X(4)  VALUE '0945'.
   602     12  ER-0946                 PIC X(4)  VALUE '0946'.
   603     12  ER-0947                 PIC X(4)  VALUE '0947'.
   604     12  ER-0948                 PIC X(4)  VALUE '0948'.
   605     12  ER-0949                 PIC X(4)  VALUE '0949'.
   606     12  ER-0950                 PIC X(4)  VALUE '0950'.
   607     12  ER-0951                 PIC X(4)  VALUE '0951'.
   608     12  ER-0954                 PIC X(4)  VALUE '0954'.
   609     12  ER-0956                 PIC X(4)  VALUE '0956'.
   610     12  ER-0967                 PIC X(4)  VALUE '0967'.
   611     12  ER-0968                 PIC X(4)  VALUE '0968'.
   612     12  ER-0974                 PIC X(4)  VALUE '0974'.
   613     12  ER-0975                 PIC X(4)  VALUE '0975'.
   614     12  ER-1561                 PIC X(4)  VALUE '1561'.
   615     12  ER-1775                 PIC X(4)  VALUE '1775'.
   616     12  ER-1880                 PIC X(4)  VALUE '1880'.
   617     12  ER-2044                 PIC X(4)  VALUE '2044'.
   618     12  ER-3140                 PIC X(4)  VALUE '3140'.
   619     12  ER-3141                 PIC X(4)  VALUE '3141'.
   620     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  13
* EL156.cbl
   621     12  ER-3516                 PIC X(4)  VALUE '3516'.
   622     12  ER-3527                 PIC X(4)  VALUE '3527'.
   623     12  ER-3528                 PIC X(4)  VALUE '3528'.
   624     12  ER-3529                 PIC X(4)  VALUE '3529'.
   625     12  ER-3530                 PIC X(4)  VALUE '3530'.
   626     12  ER-3531                 PIC X(4)  VALUE '3531'.
   627     12  ER-3532                 PIC X(4)  VALUE '3532'.
   628     12  ER-3533                 PIC X(4)  VALUE '3533'.
   629     12  ER-3534                 PIC X(4)  VALUE '3534'.
   630     12  ER-3535                 PIC X(4)  VALUE '3535'.
   631     12  ER-3536                 PIC X(4)  VALUE '3536'.
   632     12  ER-3537                 PIC X(4)  VALUE '3537'.
   633     12  ER-3538                 PIC X(4)  VALUE '3538'.
   634     12  ER-3539                 PIC X(4)  VALUE '3539'.
   635     12  ER-3540                 PIC X(4)  VALUE '3540'.
   636     12  ER-3541                 PIC X(4)  VALUE '3541'.
   637     12  ER-3542                 PIC X(4)  VALUE '3542'.
   638     12  ER-3543                 PIC X(4)  VALUE '3543'.
   639     12  ER-3546                 PIC X(4)  VALUE '3546'.
   640     12  ER-3549                 PIC X(4)  VALUE '3549'.
   641     12  ER-3818                 PIC X(4)  VALUE '3818'.
   642     12  ER-7540                 PIC X(4)  VALUE '7540'.
   643     12  ER-7576                 PIC X(4)  VALUE '7576'.
   644     12  ER-7830                 PIC X(4)  VALUE '7830'.
   645     12  ER-7831                 PIC X(4)  VALUE '7831'.
   646     12  ER-7832                 PIC X(4)  VALUE '7832'.
   647     12  ER-7833                 PIC X(4)  VALUE '7833'.
   648     12  ER-7834                 PIC X(4)  VALUE '7834'.
   649     12  ER-7835                 PIC X(4)  VALUE '7835'.
   650     12  ER-7836                 PIC X(4)  VALUE '7836'.
   651     12  ER-7837                 PIC X(4)  VALUE '7837'.
   652     12  ER-7838                 PIC X(4)  VALUE '7838'.
   653     12  ER-7841                 PIC X(4)  VALUE '7841'.
   654     12  ER-7844                 PIC X(4)  VALUE '7844'.
   655     12  ER-7845                 PIC X(4)  VALUE '7845'.
   656     12  ER-8000                 PIC X(4)  VALUE '8000'.
   657     12  ER-8051                 PIC X(4)  VALUE '8051'.
   658     12  ER-8052                 PIC X(4)  VALUE '8052'.
   659     12  ER-8053                 PIC X(4)  VALUE '8053'.
   660     12  ER-8054                 PIC X(4)  VALUE '8054'.
   661     12  ER-8055                 PIC X(4)  VALUE '8055'.
   662     12  ER-8056                 PIC X(4)  VALUE '8056'.
   663     12  ER-8057                 PIC X(4)  VALUE '8057'.
   664     12  ER-8058                 PIC X(4)  VALUE '8058'.
   665     12  ER-8059                 PIC X(4)  VALUE '8059'.
   666     12  ER-8060                 PIC X(4)  VALUE '8060'.
   667     12  ER-8061                 PIC X(4)  VALUE '8061'.
   668     12  ER-8062                 PIC X(4)  VALUE '8062'.
   669     12  ER-8063                 PIC X(4)  VALUE '8063'.
   670     12  ER-8064                 PIC X(4)  VALUE '8064'.
   671     12  ER-8065                 PIC X(4)  VALUE '8065'.
   672     12  ER-8066                 PIC X(4)  VALUE '8066'.
   673     12  ER-8146                 PIC X(4)  VALUE '8146'.
   674     12  ER-8147                 PIC X(4)  VALUE '8147'.
   675     12  ER-8152                 PIC X(4)  VALUE '8152'.
   676     12  ER-8153                 PIC X(4)  VALUE '8153'.
   677     12  ER-8154                 PIC X(4)  VALUE '8154'.
   678     12  ER-8155                 PIC X(4)  VALUE '8155'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  14
* EL156.cbl
   679     12  ER-8310                 PIC X(4)  VALUE '8310'.
   680     12  ER-8311                 PIC X(4)  VALUE '8311'.
   681     12  ER-8312                 PIC X(4)  VALUE '8312'.
   682     12  ER-8313                 PIC X(4)  VALUE '8313'.
   683     12  ER-8314                 PIC X(4)  VALUE '8314'.
   684     12  ER-8315                 PIC X(4)  VALUE '8315'.
   685     12  ER-8316                 PIC X(4)  VALUE '8316'.
   686     12  ER-8317                 PIC X(4)  VALUE '8317'.
   687
   688 01  CSO-WORK-FIELDS.
   689     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   690       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   691
   692     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   693     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   694         88  CERT-NOTE-ADDED           VALUE 'Y'.
   695     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   696         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   697     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   698
   699 01  SC-NP6-CERT-NOTE.
   700     12  FILLER                  PIC X(12)
   701               VALUE 'REM BENEFIT '.
   702     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   703     12  FILLER                  PIC X(8)
   704               VALUE ' + 6 MO '.
   705     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   706     12  FILLER                  PIC X(12)
   707               VALUE ' = AMT PAID '.
   708     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   709
   710 01  SC-NP6-ORIG-NOTE.
   711     12  FILLER                  PIC X(63)  VALUE
   712         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   713
   714 01  ACCESS-KEYS.
   715     12  ELARCH-KEY.
   716         16  ARCH-CO             PIC X.
   717         16  ARCH-NUMBER         PIC S9(08) COMP.
   718         16  ARCH-REC-TYPE       PIC X.
   719         16  ARCH-SEQ            PIC S9(04) COMP.
   720     12  ELMSTR-KEY.
   721         16  MSTR-COMP-CD        PIC X.
   722         16  MSTR-CARRIER        PIC X.
   723         16  MSTR-CLAIM-NO       PIC X(7).
   724         16  MSTR-CERT-NO        PIC X(11).
   725     12  ELCNTL-KEY.
   726         16  CNTL-COMP-ID        PIC X(3).
   727         16  CNTL-REC-TYPE       PIC X.
   728         16  CNTL-ACCESS         PIC X(4).
   729         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   730     12  ELCERT-KEY.
   731         16  CERT-COMP-CD        PIC X.
   732         16  CERT-CARRIER        PIC X.
   733         16  CERT-GROUPING       PIC X(6).
   734         16  CERT-STATE          PIC XX.
   735         16  CERT-ACCOUNT        PIC X(10).
   736         16  CERT-EFF-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  15
* EL156.cbl
   737         16  CERT-CERT-NO        PIC X(11).
   738     12  ELTRLR-KEY.
   739         16  TRLR-COMP-CD        PIC X.
   740         16  TRLR-CARRIER        PIC X.
   741         16  TRLR-CLAIM-NO       PIC X(7).
   742         16  TRLR-CERT-NO        PIC X(11).
   743         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   744     12  ELACTQ-KEY.
   745         16  ACTQ-COMP-CD        PIC X.
   746         16  ACTQ-CARRIER        PIC X.
   747         16  ACTQ-CLAIM-NO       PIC X(7).
   748         16  ACTQ-CERT-NO        PIC X(11).
   749     12  W-NOTE-KEY.
   750         16  W-NOTE-COMP-CD      PIC X.
   751         16  W-NOTE-CERT-KEY.
   752             20  W-NOTE-CARRIER  PIC X.
   753             20  W-NOTE-GROUPING PIC X(6).
   754             20  W-NOTE-STATE    PIC XX.
   755             20  W-NOTE-ACCOUNT  PIC X(10).
   756             20  W-NOTE-EFF-DT   PIC XX.
   757             20  W-NOTE-CERT-NO  PIC X(11).
   758     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   759     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   760     12  ERACCT-KEY.
   761         16  ERACCT-PARTIAL-KEY.
   762             20  ACCT-COMP-CD    PIC X.
   763             20  ACCT-CARRIER    PIC X.
   764             20  ACCT-GROUPING   PIC X(6).
   765             20  ACCT-STATE      PIC XX.
   766             20  ACCT-ACCOUNT    PIC X(10).
   767         16  ACCT-EXP-DT         PIC XX.
   768         16  FILLER              PIC X(4) VALUE SPACES.
   769     12  ELCHKQ-KEY.
   770         16  CHKQ-COMP-CD        PIC X.
   771         16  CHKQ-CONTROL        PIC S9(8) COMP.
   772         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   773     12  ELBENE-KEY.
   774         16  BENE-COMP-CD         PIC X.
   775         16  BENE-RECORD-TYPE     PIC X.
   776         16  BENE-NUMBER          PIC X(10).
   777     12  ERCOMP-KEY.
   778         16  COMP-COMP-CD        PIC X.
   779         16  COMP-CARRIER        PIC X.
   780         16  COMP-GROUP          PIC X(06).
   781         16  COMP-FIN-RESP       PIC X(10).
   782         16  COMP-ACCOUNT        PIC X(10).
   783         16  COMP-TYPE           PIC X.
   784
   785     12  DLO035-KEY.
   786         16  DL35-PROCESS-TYPE   PIC X.
   787         16  DL35-CREDIT-CARD    PIC X(20).
   788         16  DL35-BEN-TYPE       PIC XX.
   789         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   790         16  DL35-RETURN-CODE    PIC XX.
   791
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  16
* EL156.cbl
   793*    COPY ELCDATE.
   794******************************************************************
   795*                                                                *
   796*                                                                *
   797*                            ELCDATE.                            *
   798*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   799*                            VMOD=2.003
   800*                                                                *
   801*                                                                *
   802*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   803*                 LENGTH = 200                                   *
   804******************************************************************
   805
   806 01  DATE-CONVERSION-DATA.
   807     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   808     12  DC-OPTION-CODE                PIC X.
   809         88  BIN-TO-GREG                VALUE ' '.
   810         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   811         88  EDIT-GREG-TO-BIN           VALUE '2'.
   812         88  YMD-GREG-TO-BIN            VALUE '3'.
   813         88  MDY-GREG-TO-BIN            VALUE '4'.
   814         88  JULIAN-TO-BIN              VALUE '5'.
   815         88  BIN-PLUS-ELAPSED           VALUE '6'.
   816         88  FIND-CENTURY               VALUE '7'.
   817         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   818         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   819         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   820         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   821         88  JULIAN-TO-BIN-3            VALUE 'C'.
   822         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   823         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   824         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   825         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   826         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   827         88  CHECK-LEAP-YEAR            VALUE 'H'.
   828         88  BIN-3-TO-GREG              VALUE 'I'.
   829         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   830         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   831         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   832         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   833         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   834         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   835         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   836         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   837         88  THREE-CHARACTER-BIN
   838                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   839         88  GREGORIAN-TO-BIN
   840                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   841         88  BIN-TO-GREGORIAN
   842                  VALUES ' ' '1' 'I' '8' 'G'.
   843         88  JULIAN-TO-BINARY
   844                  VALUES '5' 'C' 'E' 'F'.
   845     12  DC-ERROR-CODE                 PIC X.
   846         88  NO-CONVERSION-ERROR        VALUE ' '.
   847         88  DATE-CONVERSION-ERROR
   848                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   849         88  DATE-IS-ZERO               VALUE '1'.
   850         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  17
* EL156.cbl
   851         88  DATE-IS-INVALID            VALUE '3'.
   852         88  DATE1-GREATER-DATE2        VALUE '4'.
   853         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   854         88  DATE-INVALID-OPTION        VALUE '9'.
   855         88  INVALID-CENTURY            VALUE 'A'.
   856         88  ONLY-CENTURY               VALUE 'B'.
   857         88  ONLY-LEAP-YEAR             VALUE 'C'.
   858         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   859     12  DC-END-OF-MONTH               PIC X.
   860         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   861     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   862         88  USE-NORMAL-PROCESS         VALUE ' '.
   863         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   864         88  ADJUST-UP-100-YRS          VALUE '2'.
   865     12  FILLER                        PIC X.
   866     12  DC-CONVERSION-DATES.
   867         16  DC-BIN-DATE-1             PIC XX.
   868         16  DC-BIN-DATE-2             PIC XX.
   869         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   870         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   871                       DC-GREG-DATE-1-EDIT.
   872             20  DC-EDIT1-MONTH        PIC 99.
   873             20  SLASH1-1              PIC X.
   874             20  DC-EDIT1-DAY          PIC 99.
   875             20  SLASH1-2              PIC X.
   876             20  DC-EDIT1-YEAR         PIC 99.
   877         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   878         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   879                     DC-GREG-DATE-2-EDIT.
   880             20  DC-EDIT2-MONTH        PIC 99.
   881             20  SLASH2-1              PIC X.
   882             20  DC-EDIT2-DAY          PIC 99.
   883             20  SLASH2-2              PIC X.
   884             20  DC-EDIT2-YEAR         PIC 99.
   885         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   886         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   887                     DC-GREG-DATE-1-YMD.
   888             20  DC-YMD-YEAR           PIC 99.
   889             20  DC-YMD-MONTH          PIC 99.
   890             20  DC-YMD-DAY            PIC 99.
   891         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   892         16  DC-GREG-DATE-1-MDY-R REDEFINES
   893                      DC-GREG-DATE-1-MDY.
   894             20  DC-MDY-MONTH          PIC 99.
   895             20  DC-MDY-DAY            PIC 99.
   896             20  DC-MDY-YEAR           PIC 99.
   897         16  DC-GREG-DATE-1-ALPHA.
   898             20  DC-ALPHA-MONTH        PIC X(10).
   899             20  DC-ALPHA-DAY          PIC 99.
   900             20  FILLER                PIC XX.
   901             20  DC-ALPHA-CENTURY.
   902                 24 DC-ALPHA-CEN-N     PIC 99.
   903             20  DC-ALPHA-YEAR         PIC 99.
   904         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   905         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   906         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   907         16  DC-JULIAN-DATE            PIC 9(05).
   908         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  18
* EL156.cbl
   909                                       PIC 9(05).
   910         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   911             20  DC-JULIAN-YEAR        PIC 99.
   912             20  DC-JULIAN-DAYS        PIC 999.
   913         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   914         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   915         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   916     12  DATE-CONVERSION-VARIBLES.
   917         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   918         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   919             20  FILLER                PIC 9(3).
   920             20  HOLD-CEN-1-CCYY.
   921                 24  HOLD-CEN-1-CC     PIC 99.
   922                 24  HOLD-CEN-1-YY     PIC 99.
   923             20  HOLD-CEN-1-MO         PIC 99.
   924             20  HOLD-CEN-1-DA         PIC 99.
   925         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   926             20  HOLD-CEN-1-R-MO       PIC 99.
   927             20  HOLD-CEN-1-R-DA       PIC 99.
   928             20  HOLD-CEN-1-R-CCYY.
   929                 24  HOLD-CEN-1-R-CC   PIC 99.
   930                 24  HOLD-CEN-1-R-YY   PIC 99.
   931             20  FILLER                PIC 9(3).
   932         16  HOLD-CENTURY-1-X.
   933             20  FILLER                PIC X(3)  VALUE SPACES.
   934             20  HOLD-CEN-1-X-CCYY.
   935                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   936                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   937             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   938             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   939         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   940             20  HOLD-CEN-1-R-X-MO     PIC XX.
   941             20  HOLD-CEN-1-R-X-DA     PIC XX.
   942             20  HOLD-CEN-1-R-X-CCYY.
   943                 24  HOLD-CEN-1-R-X-CC PIC XX.
   944                 24  HOLD-CEN-1-R-X-YY PIC XX.
   945             20  FILLER                PIC XXX.
   946         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   947         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   948         16  DC-JULIAN-DATE-1          PIC 9(07).
   949         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   950             20  DC-JULIAN-1-CCYY.
   951                 24  DC-JULIAN-1-CC    PIC 99.
   952                 24  DC-JULIAN-1-YR    PIC 99.
   953             20  DC-JULIAN-DA-1        PIC 999.
   954         16  DC-JULIAN-DATE-2          PIC 9(07).
   955         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   956             20  DC-JULIAN-2-CCYY.
   957                 24  DC-JULIAN-2-CC    PIC 99.
   958                 24  DC-JULIAN-2-YR    PIC 99.
   959             20  DC-JULIAN-DA-2        PIC 999.
   960         16  DC-GREG-DATE-A-EDIT.
   961             20  DC-EDITA-MONTH        PIC 99.
   962             20  SLASHA-1              PIC X VALUE '/'.
   963             20  DC-EDITA-DAY          PIC 99.
   964             20  SLASHA-2              PIC X VALUE '/'.
   965             20  DC-EDITA-CCYY.
   966                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  19
* EL156.cbl
   967                 24  DC-EDITA-YEAR     PIC 99.
   968         16  DC-GREG-DATE-B-EDIT.
   969             20  DC-EDITB-MONTH        PIC 99.
   970             20  SLASHB-1              PIC X VALUE '/'.
   971             20  DC-EDITB-DAY          PIC 99.
   972             20  SLASHB-2              PIC X VALUE '/'.
   973             20  DC-EDITB-CCYY.
   974                 24  DC-EDITB-CENT     PIC 99.
   975                 24  DC-EDITB-YEAR     PIC 99.
   976         16  DC-GREG-DATE-CYMD         PIC 9(08).
   977         16  DC-GREG-DATE-CYMD-R REDEFINES
   978                              DC-GREG-DATE-CYMD.
   979             20  DC-CYMD-CEN           PIC 99.
   980             20  DC-CYMD-YEAR          PIC 99.
   981             20  DC-CYMD-MONTH         PIC 99.
   982             20  DC-CYMD-DAY           PIC 99.
   983         16  DC-GREG-DATE-MDCY         PIC 9(08).
   984         16  DC-GREG-DATE-MDCY-R REDEFINES
   985                              DC-GREG-DATE-MDCY.
   986             20  DC-MDCY-MONTH         PIC 99.
   987             20  DC-MDCY-DAY           PIC 99.
   988             20  DC-MDCY-CEN           PIC 99.
   989             20  DC-MDCY-YEAR          PIC 99.
   990    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   991        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   992    12  DC-EL310-DATE                  PIC X(21).
   993    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  20
* EL156.cbl
   995*    COPY ELCLOGOF.
   996******************************************************************
   997*                                                                *
   998*                                                                *
   999*                            ELCLOGOF.                           *
  1000*                            VMOD=2.001                          *
  1001*                                                                *
  1002*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1003*                                                                *
  1004******************************************************************
  1005 01  CLASIC-LOGOFF.
  1006     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1007     12  LOGOFF-TEXT.
  1008         16  FILLER          PIC X(5)    VALUE SPACES.
  1009         16  LOGOFF-MSG.
  1010             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1011             20  FILLER      PIC X       VALUE SPACES.
  1012             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1013         16  FILLER          PIC X(80)
  1014           VALUE '* YOU ARE NOW LOGGED OFF'.
  1015         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1016         16  FILLER          PIC X       VALUE QUOTE.
  1017         16  LOGOFF-SYS-MSG  PIC X(17)
  1018           VALUE 'S CLAS-IC SYSTEM '.
  1019     12  TEXT-MESSAGES.
  1020         16  UNACCESS-MSG    PIC X(29)
  1021             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1022         16  PGMIDERR-MSG    PIC X(17)
  1023             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  21
* EL156.cbl
  1025*    COPY ELCCALC.
  1026******************************************************************
  1027*                                                                *
  1028*                           ELCCALC.                            *
  1029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1030*                            VMOD=2.025                          *
  1031*                                                                *
  1032*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1033*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1034*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1035*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1036*                                                                *
  1037*  PASSED TO ELRTRM                                              *
  1038*  -----------------                                             *
  1039*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1040*  ORIGINAL TERM                                                 *
  1041*  BEGINNING DATE                                                *
  1042*  ENDING DATE                                                   *
  1043*  COMPANY I.D.                                                  *
  1044*  ACCOUNT MASTER USER FIELD                                     *
  1045*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1046*  FREE LOOK DAYS                                                *
  1047*                                                                *
  1048*  RETURNED FROM ELRTRM                                          *
  1049*  ---------------------                                         *
  1050*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1051*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1052*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1053*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1054*----------------------------------------------------------------*
  1055*  PASSED TO ELRAMT                                              *
  1056*  ----------------                                              *
  1057*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1058*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1059*  ORIGINAL AMOUNT                                               *
  1060*  ALTERNATE BENEFIT (BALLON)                                    *
  1061*  A.P.R. - NET PAY ONLY                                         *
  1062*  METHOD
  1063*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1064*  COMPANY I.D.                                                  *
  1065*  BENEFIT TYPE                                                  *
  1066*                                                                *
  1067*  RETURNED FROM ELRAMT                                          *
  1068*  --------------------                                          *
  1069*  REMAINING AMOUNT 1 - CURRENT                                  *
  1070*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1071*  REMAINING AMOUNT FACTOR
  1072*----------------------------------------------------------------*
  1073*  PASSED TO ELRESV                                              *
  1074*  -----------------                                             *
  1075*  CERTIFICATE EFFECTIVE DATE                                    *
  1076*  VALUATION DATE                                                *
  1077*  PAID THRU DATE                                                *
  1078*  BENEFIT                                                       *
  1079*  INCURRED DATE                                                 *
  1080*  REPORTED DATE                                                 *
  1081*  ISSUE AGE                                                     *
  1082*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  22
* EL156.cbl
  1083*  CDT PERCENT                                                   *
  1084*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1085* *CLAIM TYPE (LIFE, A/H)                                        *
  1086* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1087* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1088*                                                                *
  1089*  RETURNED FROM ELRESV                                          *
  1090*  --------------------                                          *
  1091*  CDT TABLE USED                                                *
  1092*  CDT FACTOR USED                                               *
  1093*  PAY TO CURRENT RESERVE                                        *
  1094*  I.B.N.R. - A/H ONLY                                           *
  1095*  FUTURE (ACCRUED) AH ONLY                                      *
  1096*----------------------------------------------------------------*
  1097*  PASSED TO ELRATE                                              *
  1098*  ----------------                                              *
  1099*  CERT ISSUE DATE                                               *
  1100*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1101*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1102*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1103*  STATE CODE (CLIENT DEFINED)                                   *
  1104*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1105*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1106*  DEVIATION CODE                                                *
  1107*  ISSUE AGE                                                     *
  1108*  ORIGINAL BENEFIT AMOUNT                                       *
  1109*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1110*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1111*  BENEFIT KIND (LIFE OR A/H)                                    *
  1112*  A.P.R.                                                        *
  1113*  METHOD
  1114*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1115*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1116*  COMPANY I.D. (3 CHARACTER)                                    *
  1117*  BENEFIT CODE                                                  *
  1118*  BENEFIT OVERRIDE CODE                                         *
  1119*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1120*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1121*  JOINT INDICATOR (CSL ONLY)                                    *
  1122*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1123*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1124*                                                                *
  1125*  RETURNED FROM ELRATE                                          *
  1126*  --------------------                                          *
  1127*  CALCULATED PREMIUM                                            *
  1128*  PREMIUM RATE                                                  *
  1129*  MORTALITY CODE                                                *
  1130*  MAX ATTAINED AGE                                              *
  1131*  MAX AGE                                                       *
  1132*  MAX TERM                                                      *
  1133*  MAX MONTHLY BENEFIT                                           *
  1134*  MAX TOTAL BENIFIT                                             *
  1135*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1136*----------------------------------------------------------------*
  1137*  PASSED TO ELRFND                                              *
  1138*  ----------------                                              *
  1139*  CERT ISSUE DATE                                               *
  1140*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  23
* EL156.cbl
  1141*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1142*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1143*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1144*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1145*  STATE CODE (CLIENT DEFINED)                                   *
  1146*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1147*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1148*  DEVIATION CODE                                                *
  1149*  ISSUE AGE                                                     *
  1150*  ORIGINAL BENEFIT AMOUNT                                       *
  1151*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1152*  PROCESS TYPE (CANCEL)                                         *
  1153*  BENEFIT KIND (LIFE OR A/H)                                    *
  1154*  A.P.R.                                                        *
  1155*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1156*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1157*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1158*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1159*  COMPANY I.D. (3 CHARACTER)                                    *
  1160*  BENEFIT CODE                                                  *
  1161*  BENEFIT OVERRIDE CODE                                         *
  1162*                                                                *
  1163*  RETURNED FROM ELRFND                                          *
  1164*  --------------------                                          *
  1165*  CALCULATED REFUND                                             *
  1166*----------------------------------------------------------------*
  1167*  PASSED TO ELEARN                                              *
  1168*  ----------------                                              *
  1169*  CERT ISSUE DATE                                               *
  1170*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1171*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1172*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1173*  STATE CODE (CLIENT DEFINED)                                   *
  1174*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1175*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1176*  DEVIATION CODE                                                *
  1177*  ISSUE AGE                                                     *
  1178*  ORIGINAL BENEFIT AMOUNT                                       *
  1179*  BENEFIT KIND (LIFE OR A/H)                                    *
  1180*  A.P.R.                                                        *
  1181*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1182*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1183*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1184*  COMPANY I.D. (3 CHARACTER)                                    *
  1185*  BENEFIT CODE                                                  *
  1186*  BENEFIT OVERRIDE CODE                                         *
  1187*                                                                *
  1188*  RETURNED FROM ELEARN                                          *
  1189*  --------------------                                          *
  1190*  INDICATED  EARNINGS                                           *
  1191*----------------------------------------------------------------*
  1192*                 LENGTH = 450                                   *
  1193*                                                                *
  1194******************************************************************
  1195******************************************************************
  1196*                   C H A N G E   L O G
  1197*
  1198* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  24
* EL156.cbl
  1199*-----------------------------------------------------------------
  1200*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1201* EFFECTIVE    NUMBER
  1202*-----------------------------------------------------------------
  1203* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1204* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1205* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1206* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1207* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1208* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1209* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1210* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1211* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1212******************************************************************
  1213
  1214 01  CALCULATION-PASS-AREA.
  1215     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1216                                     COMP.
  1217
  1218     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1219       88  NO-CP-ERROR                             VALUE ZERO.
  1220       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1221                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1222       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1223       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1224       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1225       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1226       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1227       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1228       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1229       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1230       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1231       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1232       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1233       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1234       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1235       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1236       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1237       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1238       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1239
  1240     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1241       88  NO-CP-ERROR-2                           VALUE ZERO.
  1242***********************  INPUT AREAS ****************************
  1243
  1244     12  CP-CALCULATION-AREA.
  1245         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1246         16  CP-CERT-EFF-DT        PIC XX.
  1247         16  CP-VALUATION-DT       PIC XX.
  1248         16  CP-PAID-THRU-DT       PIC XX.
  1249         16  CP-BENEFIT-TYPE       PIC X.
  1250           88  CP-AH                               VALUE 'A' 'D'
  1251                                                   'I' 'U'.
  1252           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1253           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1254         16  CP-INCURRED-DT        PIC XX.
  1255         16  CP-REPORTED-DT        PIC XX.
  1256         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  25
* EL156.cbl
  1257         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1258         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1259                                     COMP-3.
  1260         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1261                                     COMP-3.
  1262         16  CP-CDT-METHOD         PIC X.
  1263           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1264           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1265           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1266         16  CP-CLAIM-TYPE         PIC X.
  1267           88  CP-AH-CLAIM                         VALUE 'A'.
  1268           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1269         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1270                                     COMP-3.
  1271         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1272                                     COMP-3.
  1273         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1274                                     COMP-3.
  1275         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1276                                     COMP-3.
  1277         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1278                                     COMP-3.
  1279         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1280                                     COMP-3.
  1281         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1282                                     COMP-3.
  1283         16  CP-REM-TERM-METHOD    PIC X.
  1284           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1285           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1286           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1287           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1288           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1289           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1290           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1291         16  CP-EARNING-METHOD     PIC X.
  1292           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1293           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1294           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1295           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1296           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1297           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1298           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1299           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1300           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1301           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1302           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1303           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1304           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1305           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1306         16  CP-PROCESS-TYPE       PIC X.
  1307           88  CP-CLAIM                            VALUE '1'.
  1308           88  CP-CANCEL                           VALUE '2'.
  1309           88  CP-ISSUE                            VALUE '3'.
  1310         16  CP-SPECIAL-CALC-CD    PIC X.
  1311           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1312           88  CP-1-MTH-INTEREST               VALUE ' '.
  1313           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1314           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  26
* EL156.cbl
  1315           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1316           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1317           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1318           88  CP-FARM-PLAN                    VALUE 'F'.
  1319           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1320           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1321           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1322           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1323           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1324           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1325           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1326           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1327           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1328           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1329                                                     'W' 'X'.
  1330           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1331           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1332           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1333           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1334           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1335           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1336           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1337           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1338           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1339           88  CP-CSL-METH-1                   VALUE '5'.
  1340           88  CP-CSL-METH-2                   VALUE '6'.
  1341           88  CP-CSL-METH-3                   VALUE '7'.
  1342           88  CP-CSL-METH-4                   VALUE '8'.
  1343
  1344         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1345                                     COMP-3.
  1346         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1347         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1348         16  CP-STATE              PIC XX          VALUE SPACE.
  1349         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1350         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1351           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1352               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1353         16  CP-R78-OPTION         PIC X.
  1354           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1355           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1356
  1357         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1358         16  CP-IBNR-RESERVE-SW    PIC X.
  1359         16  CP-CLAIM-STATUS       PIC X.
  1360         16  CP-RATE-FILE          PIC X.
  1361         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1362                                     COMP-3.
  1363
  1364         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1365         16  CP-AH-OVERRIDE-CODE   PIC X.
  1366
  1367         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1368                                     COMP-3.
  1369         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1372                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  27
* EL156.cbl
  1373         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1374                                     COMP-3.
  1375
  1376         16  CP-PAID-FROM-DATE     PIC X(02).
  1377         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1378         16  CP-EXT-DAYS-CALC      PIC X.
  1379           88  CP-EXT-NO-CHG                   VALUE ' '.
  1380           88  CP-EXT-CHG-LF                   VALUE '1'.
  1381           88  CP-EXT-CHG-AH                   VALUE '2'.
  1382           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1383         16  CP-DOMICILE-STATE     PIC XX.
  1384         16  CP-CARRIER            PIC X.
  1385         16  CP-REIN-FLAG          PIC X.
  1386         16  CP-REM-TRM-CALC-OPTION PIC X.
  1387           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1388                      '2' '3' '4' '5'.
  1389           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1390           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1391           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1392           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1393           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1394           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1395           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1396           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1397         16  CP-SIG-SWITCH         PIC X.
  1398         16  CP-RATING-METHOD      PIC X.
  1399           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1400           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1401           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1402           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1403           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1404           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1405           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1406           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1407           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1408         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1409                                     COMP-3.
  1410         16  CP-BEN-CATEGORY       PIC X.
  1411         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1412         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1413                                   PIC S99V9(5) COMP-3.
  1414         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1415         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1416                                   PIC S99V9(5) COMP-3.
  1417         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1418         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1419         16  CP-EXPIRE-DT          PIC XX.
  1420         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1421         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1422         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1423         16  CP-DDF-ADDL-CLP       PIC S9(5)V99 COMP-3 VALUE +0.
  1424         16  CP-DDF-SPEC-CALC      PIC X.
  1425             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1426             88  CP-CALC-CLP              VALUE 'C'.
  1427         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1428         16  CP-CANCEL-REASON      PIC X.
  1429         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1430         16  CP-PMT-MODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  28
* EL156.cbl
  1431         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1432         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1433         16  FILLER                PIC X(09).
  1434
  1435***************    OUTPUT FROM ELRESV   ************************
  1436
  1437         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1438
  1439         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1440                                     COMP-3.
  1441         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1442                                     COMP-3.
  1443         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1444                                     COMP-3.
  1445         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1446                                     COMP-3.
  1447         16  FILLER                PIC X(09).
  1448***************    OUTPUT FROM ELRTRM   *************************
  1449
  1450         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1451                                     COMP-3.
  1452         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1453                                     COMP-3.
  1454         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1455                                     COMP-3.
  1456         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1457                                     COMP-3.
  1458         16  FILLER                PIC X(12).
  1459
  1460***************    OUTPUT FROM ELRAMT   *************************
  1461
  1462         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1463                                     COMP-3.
  1464         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1465                                     COMP-3.
  1466         16  FILLER                PIC X(12).
  1467
  1468***************    OUTPUT FROM ELRATE   *************************
  1469
  1470         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1471                                     COMP-3.
  1472         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1473                                     COMP-3.
  1474         16  CP-MORTALITY-CODE     PIC X(4).
  1475         16  CP-RATE-EDIT-FLAG     PIC X.
  1476             88  CP-RATES-NEED-APR                  VALUE '1'.
  1477         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1478                                     COMP-3.
  1479         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1480         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1481         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1482                                   PIC S9(7)V99 COMP-3.
  1483         16  FILLER                PIC X(07).
  1484
  1485***************    OUTPUT FROM ELRFND   *************************
  1486
  1487         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1488                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  29
* EL156.cbl
  1489         16  CP-REFUND-TYPE-USED   PIC X.
  1490           88  CP-R-AS-R78                         VALUE '1'.
  1491           88  CP-R-AS-PRORATA                     VALUE '2'.
  1492           88  CP-R-AS-CALIF                       VALUE '3'.
  1493           88  CP-R-AS-TEXAS                       VALUE '4'.
  1494           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1495           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1496           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1497           88  CP-R-AS-MEAN                        VALUE '8'.
  1498           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1499           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1500           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1501           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1502           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1503           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1504         16  FILLER                PIC X(12).
  1505
  1506***************    OUTPUT FROM ELEARN   *************************
  1507
  1508         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1509                                     COMP-3.
  1510         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1511                                     COMP-3.
  1512         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1513                                     COMP-3.
  1514         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1515                                     COMP-3.
  1516         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1517                                     COMP-3.
  1518         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1519                                     COMP-3.
  1520         16  CP-EARNING-TYPE-USED  PIC X.
  1521           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1522           88  CP-E-AS-R78                         VALUE '1'.
  1523           88  CP-E-AS-PRORATA                     VALUE '2'.
  1524           88  CP-E-AS-TEXAS                       VALUE '4'.
  1525           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1526           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1527           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1528           88  CP-E-AS-MEAN                        VALUE '8'.
  1529           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1530         16  FILLER                PIC X(12).
  1531
  1532***************    OUTPUT FROM ELPMNT   *************************
  1533
  1534         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1535                                     COMP-3.
  1536         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1537                                     COMP-3.
  1538         16  FILLER                PIC X(12).
  1539
  1540***************   MISC WORK AREAS    *****************************
  1541         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1542                                     COMP-3.
  1543         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1544                                     COMP-3.
  1545         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1546                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  30
* EL156.cbl
  1547         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1548                                     COMP-3.
  1549         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1550                                     COMP-3.
  1551         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1552                                     COMP-3.
  1553         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1554             88  OPEN-RATE-FILE                   VALUE 'O'.
  1555             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1556             88  IO-ERROR                         VALUE 'E'.
  1557
  1558         16  CP-FIRST-PAY-DATE     PIC XX.
  1559
  1560         16  CP-JOINT-INDICATOR    PIC X.
  1561
  1562         16  CP-RESERVE-REMAINING-TERM
  1563                                   PIC S9(4)V9    VALUE ZERO
  1564                                     COMP-3.
  1565
  1566         16  CP-INSURED-BIRTH-DT   PIC XX.
  1567
  1568         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1569                                     COMP-3.
  1570
  1571         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1572                                     COMP-3.
  1573
  1574         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1575                                     COMP-3.
  1576
  1577         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1578                                     COMP-3.
  1579
  1580         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1581                                     COMP-3.
  1582
  1583         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1584                                     COMP-3.
  1585
  1586         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1587                                     COMP-3.
  1588
  1589         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1590             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1591
  1592         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1593                                     COMP-3.
  1594         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1597         16  FILLER                PIC X(15).
  1598******************************************************************
  1599*    COPY ELCICALC.
  1600******************************************************************
  1601*                                                                *
  1602*                           ELCCICALC.                           *
  1603*                            VMOD=2.001                          *
  1604*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  31
* EL156.cbl
  1605*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1606*                 CALCULATION MODULE                             *
  1607*                                                                *
  1608*  PASSED TO ELCLMI                                              *
  1609*  -----------------                                             *
  1610*  STATE                                                         *
  1611*  PRODUCT                                                       *
  1612*  COVERAGE                                                      *
  1613*  EFFECTIVE DATE                                                *
  1614*  INCURRED DATE                                                 *
  1615*  ESTABLISHED DATE                                              *
  1616*  LAST PAID DATE                                                *
  1617*  REPORTED DATE                                                 *
  1618*  CLAIM PAYMENT AMOUNT                                          *
  1619*                                                                *
  1620*  RETURNED FROM ELRTRM                                          *
  1621*  ---------------------                                         *
  1622*  RETURN CODE                                                   *
  1623*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1624*  CLAIM INTEREST AMOUNT                                         *
  1625*----------------------------------------------------------------*
  1626*----------------------------------------------------------------*
  1627*                 LENGTH = 100                                   *
  1628*                                                                *
  1629******************************************************************
  1630******************************************************************
  1631*                   C H A N G E   L O G
  1632*
  1633* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1634*-----------------------------------------------------------------
  1635*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1636* EFFECTIVE    NUMBER
  1637*-----------------------------------------------------------------
  1638* 120905    2004040700004  PEMA  NEW COPYBOOK
  1639* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1640******************************************************************
  1641
  1642 01  CLAIM-INT-PASS-AREA.
  1643     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1644                                     COMP.
  1645
  1646     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1647       88  NO-CI-ERROR                             VALUE ZERO.
  1648       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1649       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1650       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1651       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1652       88  CP-AMT-LT-5000                          VALUE '4'.
  1653       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1654       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1655       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1656       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1657***********************  INPUT AREAS ****************************
  1658
  1659     12  CP-CALCULATION-AREA.
  1660         16  CP-COMPANY-CD         PIC X.
  1661         16  CP-STATE              PIC XX.
  1662         16  CP-PRODUCT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  32
* EL156.cbl
  1663         16  CP-COVERAGE           PIC XX.
  1664         16  CP-INC-DT             PIC XX.
  1665         16  CP-EST-DT             PIC XX.
  1666         16  CP-LSTPD-DT           PIC XX.
  1667         16  CP-RPT-DT             PIC XX.
  1668         16  CP-PRF-DT             PIC XX.
  1669         16  CP-EFF-DT             PIC XX.
  1670         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1671         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1672         16  FILLER                PIC X(37).
  1673
  1674***************    OUTPUT FROM ELCLMI   ************************
  1675
  1676         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1677
  1678         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1679         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1680         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1681         16  FILLER                PIC X(19).
  1682******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  33
* EL156.cbl
  1684*    COPY ELCATTR.
  1685******************************************************************
  1686*                                                                *
  1687*                            ELCATTR.                            *
  1688*                            VMOD=2.001                          *
  1689*                                                                *
  1690*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1691*                                                                *
  1692*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1693*                                                                *
  1694*                   POS 1   P=PROTECTED                          *
  1695*                           U=UNPROTECTED                        *
  1696*                           S=ASKIP                              *
  1697*                   POS 2   A=ALPHA/NUMERIC                      *
  1698*                           N=NUMERIC                            *
  1699*                   POS 3   N=NORMAL                             *
  1700*                           B=BRIGHT                             *
  1701*                           D=DARK                               *
  1702*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1703*                           OF=MODIFIED DATA TAG OFF             *
  1704*                                                                *
  1705*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1706******************************************************************
  1707 01  ATTRIBUTE-LIST.
  1708     12  AL-PABOF            PIC X       VALUE 'Y'.
  1709     12  AL-PABON            PIC X       VALUE 'Z'.
  1710     12  AL-PADOF            PIC X       VALUE '%'.
  1711     12  AL-PADON            PIC X       VALUE '_'.
  1712     12  AL-PANOF            PIC X       VALUE '-'.
  1713     12  AL-PANON            PIC X       VALUE '/'.
  1714     12  AL-SABOF            PIC X       VALUE '8'.
  1715     12  AL-SABON            PIC X       VALUE '9'.
  1716     12  AL-SADOF            PIC X       VALUE '@'.
  1717     12  AL-SADON            PIC X       VALUE QUOTE.
  1718     12  AL-SANOF            PIC X       VALUE '0'.
  1719     12  AL-SANON            PIC X       VALUE '1'.
  1720     12  AL-UABOF            PIC X       VALUE 'H'.
  1721     12  AL-UABON            PIC X       VALUE 'I'.
  1722     12  AL-UADOF            PIC X       VALUE '<'.
  1723     12  AL-UADON            PIC X       VALUE '('.
  1724     12  AL-UANOF            PIC X       VALUE ' '.
  1725     12  AL-UANON            PIC X       VALUE 'A'.
  1726     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1727     12  AL-UNBON            PIC X       VALUE 'R'.
  1728     12  AL-UNDOF            PIC X       VALUE '*'.
  1729     12  AL-UNDON            PIC X       VALUE ')'.
  1730     12  AL-UNNOF            PIC X       VALUE '&'.
  1731     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  34
* EL156.cbl
  1733*    COPY ELCEMIB.
  1734******************************************************************
  1735*                                                                *
  1736*                                                                *
  1737*                            ELCEMIB.                            *
  1738*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1739*                            VMOD=2.005                          *
  1740*                                                                *
  1741*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1742*                                                                *
  1743******************************************************************
  1744 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1745     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1746     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1747     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1748     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1749     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1750     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1751     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1752     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1753     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1754         88  EMI-NO-ERRORS                    VALUE '1'.
  1755         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1756         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1757     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1758         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1759     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1760         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1761         88  EMI-AREA1-FULL                   VALUE '2'.
  1762     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1763         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1764         88  EMI-AREA2-FULL                   VALUE '2'.
  1765     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1766         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1767         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1768         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1769         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1770         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1771     12  EMI-ERROR-LINES.
  1772         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1773         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1774         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1775         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1776             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1777                 24  EMI-ERR-NUM         PIC X(4).
  1778                 24  EMI-FILLER          PIC X.
  1779                 24  EMI-SEV             PIC X.
  1780                 24  FILLER              PIC X.
  1781             20  FILLER                  PIC X(02).
  1782     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1783         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1784             20  EMI-ERROR-NUMBER    PIC X(4).
  1785             20  EMI-FILL            PIC X.
  1786             20  EMI-SEVERITY        PIC X.
  1787             20  FILLER              PIC X.
  1788             20  EMI-ERROR-TEXT.
  1789                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1790                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  35
* EL156.cbl
  1791     12  EMI-SEVERITY-SAVE           PIC X.
  1792         88  EMI-NOTE                    VALUE 'N'.
  1793         88  EMI-WARNING                 VALUE 'W'.
  1794         88  EMI-FORCABLE                VALUE 'F'.
  1795         88  EMI-FATAL                   VALUE 'X'.
  1796     12  EMI-MESSAGE-FLAG            PIC X.
  1797         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1798         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1799     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1800     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1801         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1802         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1803         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1804     12  FILLER                      PIC X(137)  VALUE SPACES.
  1805     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1806     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1807     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1808     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  36
* EL156.cbl
  1810*    COPY ELCLNKLT.
  1811******************************************************************
  1812*                                                                *
  1813*                                                                *
  1814*                           ELCLNKLT                             *
  1815*                            VMOD=2.003                          *
  1816*                                                                *
  1817*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1818*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1819*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1820*                                                                *
  1821*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1822*   COMPLETING THE REQUIRED FIELDS.                              *
  1823*                                                                *
  1824*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1825*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1826*                              9999 INDICATES AN UNKNOWN ABEND   *
  1827*                                   WAS DETECTED.                *
  1828*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1829*                              CODES FOUND IN THE ERROR FILE.    *
  1830******************************************************************
  1831 01  W-1523-LINKDATA.
  1832     12  W-1523-COMMON-PI-DATA.
  1833         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1834         16  FILLER              PIC  X(67).
  1835         16  W-1523-COMPANY-CD   PIC  X(01).
  1836         16  FILLER              PIC  X(10).
  1837         16  W-1523-CONTROL-IN-PROGRESS.
  1838             20  W-1523-CARRIER  PIC  X(01).
  1839             20  W-1523-GROUPING PIC  X(06).
  1840             20  W-1523-STATE    PIC  X(02).
  1841             20  W-1523-ACCOUNT  PIC  X(10).
  1842             20  W-1523-CLAIM-CERT-GRP.
  1843                 24  W-1523-CLAIM-NO
  1844                                 PIC  X(07).
  1845                 24  W-1523-CERT-NO.
  1846                     28  W-1523-CERT-PRIME
  1847                                 PIC  X(10).
  1848                     28  W-1523-CERT-SFX
  1849                                 PIC  X(01).
  1850                 24  W-1523-CERT-EFF-DT
  1851                                 PIC  X(02).
  1852         16  FILLER              PIC X(265).
  1853
  1854     12  W-1523-WORK-AREA.
  1855         16  W-1523-FORM-NUMBER  PIC  X(04).
  1856         16  W-1523-NUMBER-COPIES
  1857                                 PIC  9(01).
  1858         16  W-1523-ADDR-TYPE    PIC  X(02).
  1859         16  W-1523-FOLLOW-UP-DATE
  1860                                 PIC  X(02).
  1861         16  W-1523-RESEND-DATE  PIC  X(02).
  1862         16  W-1523-ERROR-CODE   PIC  9(04).
  1863             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1864             88  W-1523-FATAL-ERROR
  1865                                    VALUES  0006 0013 0042
  1866                                            0154 0168 0169
  1867                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  37
* EL156.cbl
  1868                                            0179 0186 0281
  1869                                            0332 2055 3697
  1870                                            3698 3699 3770
  1871                                            3771 3772 7675
  1872                                            9106 9808 9883
  1873                                            9887.
  1874             88  W-1523-STOP-ERRORS
  1875                                    VALUES  0013 0042 0154
  1876                                            0168 0169 0172
  1877                                            0281 0332 2055
  1878                                            3698 3699 7675
  1879                                            9106 9808 9883
  1880                                            9999.
  1881         16  W-1523-REASON       PIC  X(70).
  1882         16  W-1523-ARCHIVE-NUMBER
  1883                                 PIC  9(08).
  1884     12  W-1523-POINTER-AREA.
  1885         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1886         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1887         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1888         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1889         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  38
* EL156.cbl
  1891*    COPY ELCNWA.
  1892*****************************************************************
  1893*                                                               *
  1894*                                                               *
  1895*                            ELCNWA.                            *
  1896*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1897*                            VMOD=2.003                         *
  1898*                                                               *
  1899*            M O V E   N A M E   W O R K   A R E A.             *
  1900*                                                               *
  1901*****************************************************************.
  1902
  1903 01  WS-NAME-WORK-AREA.
  1904     05  WS-INSURED-LAST-NAME        PIC X(15).
  1905     05  WS-INSURED-1ST-NAME         PIC X(12).
  1906     05  WS-INSURED-MID-INIT         PIC X.
  1907
  1908     05  WS-NAME-WORK.
  1909         10  WS-NW                   PIC X
  1910             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1911
  1912     05  WS-NAME-WORK2.
  1913         10  WS-NW2                  PIC X
  1914             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1915                                        NWA-INDEX0.
  1916
  1917     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1918                                     COMP-3.
  1919
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  39
* EL156.cbl
  1921*    COPY ELCDMO.
  1922******************************************************************
  1923*                                                                *
  1924*                                                                *
  1925*                            ELCDMO.                             *
  1926*                            VMOD=2.004                          *
  1927*                                                                *
  1928*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  1929*        COMMUNICATION AREA                                      *
  1930*   FILE TYPE = NA                                               *
  1931*   RECORD SIZE = 110    RECFORM = FIXED                         *
  1932*                                                                *
  1933******************************************************************
  1934 01  DMO-COMMUNICATION-AREA.
  1935     12  DM-RECORD-TYPE                  PIC  X(02).
  1936             88  DM-ISSUE-TRAN                VALUE 'CC'.
  1937             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  1938             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  1939     12  DM-DIST-CODE                    PIC  X(04).
  1940     12  DM-MAIL-CODE                    PIC  X(05).
  1941     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  1942     12  DM-INSURED-NAME                 PIC  X(30).
  1943     12  DM-CLAIM-NO                     PIC  X(07).
  1944     12  DM-CLAIM-TYPE                   PIC  X.
  1945
  1946     12  DM-STATUS-DATA-AREA.
  1947         16  DM-CLAIM-STATUS             PIC  X.
  1948             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  1949             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  1950             88  DM-CLOSED                        VALUE '3'.
  1951             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  1952             88  DM-DEFAULT                       VALUE '9'.
  1953         16  DM-STATUS-DATE              PIC  X(08).
  1954******YYYYMMDD
  1955         16  DM-STAT-CHANGE-TYPE         PIC  X.
  1956             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  1957             88  DM-CLAIM-DENIED                  VALUE 'D'.
  1958             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  1959             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  1960             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  1961             88  DM-RE-OPENED                     VALUE 'R'.
  1962             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  1963             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  1964             88  DM-CLAIM-DELETED                 VALUE 'X'.
  1965         16  DM-STAT-CARRIER             PIC X.
  1966
  1967     12  DM-DRAFT-DATA-AREA.
  1968         16  DM-PAYMENT-TYPE             PIC  X.
  1969             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  1970         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  1971         16  DM-PAYMENT-DATE             PIC  X(08).
  1972******YYYYMMDD
  1973         16  DM-CERT-NO                  PIC  X(11).
  1974         16  DM-TRLR-SEQ-NO              PIC  9(04).
  1975         16  DM-CARRIER                  PIC  X.
  1976
  1977     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  40
* EL156.cbl
  1979*    COPY ELCDMDCD.
  1980******************************************************************
  1981*                                                                *
  1982*                                                                *
  1983*                            ELCDMDCD.                           *
  1984*                            VMOD=2.001                          *
  1985*                                                                *
  1986*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  1987*       COMMUNICATIONS AREA                                      *
  1988*                                                                *
  1989******************************************************************
  1990 01  CD-COMMUNICATION-AREA.
  1991     12  CD-SYSTEM-ID            PIC  X(02).
  1992         88 CD-CLAIMS                      VALUE 'CL'.
  1993         88 CD-CREDIT                      VALUE 'CR'.
  1994     12  CD-RECORD-TYPE          PIC  X(02).
  1995         88 CD-DENIAL-CODE                 VALUE 'DN'.
  1996         88 CD-EOB-CODE                    VALUE 'EO'.
  1997         88 CD-ICD9-CODE                   VALUE 'I9'.
  1998         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  1999         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2000         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2001         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2002         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2003     12  CD-RECORD-KEY           PIC  X(06).
  2004         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2005     12  CD-RETURN-CODE          PIC  X(02).
  2006     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2007     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2008     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2009     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  41
* EL156.cbl
  2011*    COPY ELCDCTB.
  2012******************************************************************
  2013*                                                                *
  2014*                                                                *
  2015*                            ELCDCTB.                            *
  2016*                            VMOD=2.002                          *
  2017*                                                                *
  2018*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2019*       COMMUNICATIONS AREA                                      *
  2020*                                                                *
  2021******************************************************************
  2022 01  DCT-COMMUNICATION-AREA.
  2023     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2024     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2025     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2026     12  DCT-PRODUCT-CODE         PIC  X(02).
  2027     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2028     12  DCT-RETURN-CODE          PIC  X(02).
  2029     12  DCT-MAIL-CODE            PIC  X(05).
  2030     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2031     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  42
* EL156.cbl
  2033 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2034 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2035 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2036 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  43
* EL156.cbl
  2038*    COPY ELCINTF.
  2039******************************************************************
  2040*                                                                *
  2041*                                                                *
  2042*                            ELCINTF.                            *
  2043*                            VMOD=2.017                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2046*                                                                *
  2047*       LENGTH = 1024                                            *
  2048*                                                                *
  2049******************************************************************
  2050 01  PROGRAM-INTERFACE-BLOCK.
  2051     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2052     12  PI-CALLING-PROGRAM              PIC X(8).
  2053     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2054     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2055     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2056     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2057     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2058     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2059     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2060     12  PI-COMPANY-ID                   PIC XXX.
  2061     12  PI-COMPANY-CD                   PIC X.
  2062
  2063     12  PI-COMPANY-PASSWORD             PIC X(8).
  2064
  2065     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2066
  2067     12  PI-CONTROL-IN-PROGRESS.
  2068         16  PI-CARRIER                  PIC X.
  2069         16  PI-GROUPING                 PIC X(6).
  2070         16  PI-STATE                    PIC XX.
  2071         16  PI-ACCOUNT                  PIC X(10).
  2072         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2073                                         PIC X(10).
  2074         16  PI-CLAIM-CERT-GRP.
  2075             20  PI-CLAIM-NO             PIC X(7).
  2076             20  PI-CERT-NO.
  2077                 25  PI-CERT-PRIME       PIC X(10).
  2078                 25  PI-CERT-SFX         PIC X.
  2079             20  PI-CERT-EFF-DT          PIC XX.
  2080         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2081             20  PI-PLAN-CODE            PIC X(2).
  2082             20  PI-REVISION-NUMBER      PIC X(3).
  2083             20  PI-PLAN-EFF-DT          PIC X(2).
  2084             20  PI-PLAN-EXP-DT          PIC X(2).
  2085             20  FILLER                  PIC X(11).
  2086         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  2087             20  PI-OE-REFERENCE-1.
  2088                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2089                 25  PI-OE-REF-1-SUFF    PIC XX.
  2090
  2091     12  PI-SESSION-IN-PROGRESS          PIC X.
  2092         88  CLAIM-SESSION                   VALUE '1'.
  2093         88  CREDIT-SESSION                  VALUE '2'.
  2094         88  WARRANTY-SESSION                VALUE '3'.
  2095         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  44
* EL156.cbl
  2096         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2097
  2098
  2099*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2100
  2101     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2102     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2103
  2104     12  PI-CREDIT-USER                  PIC X.
  2105         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2106         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2107
  2108     12  PI-CLAIM-USER                   PIC X.
  2109         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2110         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2111
  2112     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2113         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2114         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2115         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2116         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2117         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2118
  2119     12  PI-PROCESSOR-ID                 PIC X(4).
  2120
  2121     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2122
  2123     12  PI-MEMBER-CAPTION               PIC X(10).
  2124
  2125     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2126         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2127
  2128     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2129     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2130     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2131     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2132
  2133     12  PI-AH-OVERRIDE-L1               PIC X.
  2134     12  PI-AH-OVERRIDE-L2               PIC XX.
  2135     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2136     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2137
  2138     12  PI-NEW-SYSTEM                   PIC X(2).
  2139
  2140     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2141     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2142         88  PI-USES-PAID-TO                 VALUE '1'.
  2143     12  PI-CRDTCRD-SYSTEM.
  2144         16  PI-CRDTCRD-USER             PIC X.
  2145             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2146             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2147         16  PI-CC-MONTH-END-DT          PIC XX.
  2148     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2149
  2150     12  PI-OE-REFERENCE-2.
  2151         16  PI-OE-REF-2-PRIME           PIC X(10).
  2152         16  PI-OE-REF-2-SUFF            PIC X.
  2153
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  45
* EL156.cbl
  2154     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2155
  2156     12  PI-LANGUAGE-TYPE                PIC X.
  2157             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2158             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2159             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2160
  2161     12  PI-POLICY-LINKAGE-IND           PIC X.
  2162         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2163         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2164                                                   LOW-VALUES.
  2165
  2166     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2167     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2168         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2169         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2170     12  FILLER                          PIC X(4).
  2171
  2172     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2173
  2174     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2175         PI-SYSTEM-LEVEL.
  2176
  2177         16  PI-ENTRY-CODES.
  2178             20  PI-ENTRY-CD-1           PIC X.
  2179             20  PI-ENTRY-CD-2           PIC X.
  2180
  2181         16  PI-RETURN-CODES.
  2182             20  PI-RETURN-CD-1          PIC X.
  2183             20  PI-RETURN-CD-2          PIC X.
  2184
  2185         16  PI-UPDATE-STATUS-SAVE.
  2186             20  PI-UPDATE-BY            PIC X(4).
  2187             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2188
  2189         16  PI-LOWER-CASE-LETTERS       PIC X.
  2190             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2191
  2192*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2193*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2194*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2195
  2196         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2197             88  ST-ACCNT-CNTL               VALUE ' '.
  2198             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2199             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2200             88  ACCNT-CNTL                  VALUE '3'.
  2201             88  CARR-ACCNT-CNTL             VALUE '4'.
  2202
  2203         16  PI-PROCESSOR-CAP-LIST.
  2204             20  PI-SYSTEM-CONTROLS.
  2205                24 PI-SYSTEM-DISPLAY     PIC X.
  2206                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2207                24 PI-SYSTEM-MODIFY      PIC X.
  2208                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2209             20  FILLER                  PIC XX.
  2210             20  PI-DISPLAY-CAP          PIC X.
  2211                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  46
* EL156.cbl
  2212             20  PI-MODIFY-CAP           PIC X.
  2213                 88  MODIFY-CAP              VALUE 'Y'.
  2214             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2215                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2216             20  PI-FORCE-CAP            PIC X.
  2217                 88  FORCE-CAP               VALUE 'Y'.
  2218
  2219         16  PI-PROGRAM-CONTROLS.
  2220             20  PI-PGM-PRINT-OPT        PIC X.
  2221             20  PI-PGM-FORMAT-OPT       PIC X.
  2222             20  PI-PGM-PROCESS-OPT      PIC X.
  2223             20  PI-PGM-TOTALS-OPT       PIC X.
  2224
  2225         16  PI-HELP-INTERFACE.
  2226             20  PI-LAST-ERROR-NO        PIC X(4).
  2227             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2228
  2229         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2230             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2231
  2232         16  PI-CR-CONTROL-IN-PROGRESS.
  2233             20  PI-CR-CARRIER           PIC X.
  2234             20  PI-CR-GROUPING          PIC X(6).
  2235             20  PI-CR-STATE             PIC XX.
  2236             20  PI-CR-ACCOUNT           PIC X(10).
  2237             20  PI-CR-FIN-RESP          PIC X(10).
  2238             20  PI-CR-TYPE              PIC X.
  2239
  2240         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2241
  2242         16  PI-CR-MONTH-END-DT          PIC XX.
  2243
  2244         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2245             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2246             88  PI-ZERO-CARRIER             VALUE '1'.
  2247             88  PI-ZERO-GROUPING            VALUE '2'.
  2248             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2249
  2250         16  PI-CARRIER-SECURITY         PIC X.
  2251             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2252
  2253         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2254             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2255             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  2256
  2257         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2258             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2259                                         INDEXED BY PI-ACCESS-NDX
  2260                                         PIC X.
  2261
  2262         16  PI-GA-BILLING-CONTROL       PIC X.
  2263             88  PI-GA-BILLING               VALUE '1'.
  2264
  2265         16  PI-MAIL-PROCESSING          PIC X.
  2266             88  PI-MAIL-YES                 VALUE 'Y'.
  2267
  2268         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2269
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  47
* EL156.cbl
  2270         16  PI-AR-SYSTEM.
  2271             20  PI-AR-PROCESSING-CNTL   PIC X.
  2272                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2273             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2274             20  PI-AR-MONTH-END-DT      PIC XX.
  2275
  2276         16  PI-MP-SYSTEM.
  2277             20  PI-MORTGAGE-USER            PIC X.
  2278                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2279                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2280             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2281                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2282                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2283                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2284                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2285                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2286             20  PI-MP-MONTH-END-DT          PIC XX.
  2287             20  PI-MP-REFERENCE-NO.
  2288                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2289                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2290
  2291         16  PI-LABEL-CONTROL            PIC X(01).
  2292             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2293             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2294
  2295         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2296             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2297
  2298         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2299             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2300             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2301
  2302         16  FILLER                      PIC X(14).
  2303
  2304     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2305******************************************************************
  2306     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2307         16  PI-SAVE-FORM        PIC X(12).
  2308         16  PI-ACCT-KEY         PIC X(26).
  2309         16  PI-PAYEE-NAME       PIC X(30).
  2310         16  PI-DAILY-RATE       PIC S9(3)V99.
  2311         16  PI-MONTH-END-SAVE   PIC XX.
  2312         16  PI-BENEFIT-SAVE.
  2313             20  PI-BEN-DAYS     PIC 99.
  2314             20  PI-BEN-TYPE     PIC X.
  2315         16  PI-MANUAL-SW        PIC 9.
  2316         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2317         16  PI-PASS-SW          PIC X.
  2318         16  PI-PFKEY-USED       PIC X.
  2319         16  PI-CK-ASSIGN        PIC X.
  2320         16  PI-FATAL-COUNT      PIC 99.
  2321         16  PI-FORCE-COUNT      PIC 99.
  2322         16  PI-SAVE-INPUT.
  2323             20  PI-PMTTYPE      PIC X.
  2324             20  PI-PAYEE.
  2325                 24  PI-PAYEE-TYPE PIC X.
  2326                 24  PI-PAYEE-SEQ  PIC X.
  2327                 24  PI-PAYEE-SEQ-NUM REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  48
* EL156.cbl
  2328                   PI-PAYEE-SEQ    PIC S9.
  2329             20  PI-PMTNOTE1     PIC X(60).
  2330             20  PI-PMTNOTE2     PIC X(60).
  2331             20  PI-OFFLINE      PIC X.
  2332             20  PI-ECHECKNO     PIC X(7).
  2333             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2334                 28  PI-ECHECKNO-N     PIC X.
  2335                 28  PI-ECHECKNO-6     PIC X(6).
  2336             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2337                 24  PI-ECHECKNO-CR    PIC XX.
  2338                 24  PI-ECHECKNO-5     PIC X(5).
  2339             20  PI-HOLDTIL      PIC 9(6).
  2340             20  PI-EPYFROM      PIC 9(6).
  2341             20  PI-EPYTHRU      PIC 9(6).
  2342             20  PI-EDAYS        PIC S9(5).
  2343             20  PI-EPYAMT       PIC S9(7)V99.
  2344             20  PI-ERESV        PIC S9(7)V99.
  2345             20  PI-EEXPENS      PIC 9(6)V99.
  2346             20  PI-ETYPE        PIC X.
  2347             20  PI-CASH         PIC X.
  2348             20  PI-GROUPED      PIC X.
  2349             20  PI-INT-RATE     PIC S99V9(5).
  2350             20  PI-AIGFROM      PIC 9(6).
  2351             20  PI-LOAN-NO      PIC X(20).
  2352             20  PI-PROOF-DATE   PIC 9(6).
  2353             20  PI-PRINT-EOB-YN PIC X.
  2354         16  PI-SAVE-COMPUTED.
  2355             20  PI-CCHECKNO     PIC X(7).
  2356             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2357                 28  PI-CCHECKNO-N     PIC X.
  2358                 28  PI-CCHECKNO-6     PIC X(6).
  2359             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2360                 24  PI-CCHECKNO-CR    PIC XX.
  2361                 24  PI-CCHECKNO-5     PIC X(5).
  2362             20  PI-CPYFROM      PIC XX.
  2363             20  PI-CPYTHRU      PIC XX.
  2364             20  PI-CDAYS        PIC S9(5).
  2365             20  PI-CPYAMT       PIC S9(7)V99.
  2366             20  PI-CRESV        PIC 9(6)V99.
  2367             20  PI-CEXPENS      PIC 9(6)V99.
  2368             20  PI-PMT-APPR-SW  PIC X.
  2369                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2370                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2371                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2372         16  PI-PREV-CLMNO       PIC X(7).
  2373         16  PI-LF-COVERAGE-TYPE PIC X.
  2374         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2375         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2376         16  PI-PROVISIONAL-IND  PIC X.
  2377             88 PI-PROV-PMT      VALUE 'P'.
  2378         16  PI-PREV-TRLR-KEY    PIC X(22).
  2379         16  PI-SPLIT-PMT-SW     PIC X.
  2380         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2381         16  PI-ACTIVITY-CODE    PIC 99.
  2382         16  PI-RESET-SW         PIC X.
  2383         16  PI-SPECIAL-BEN-SW   PIC X.
  2384             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2385         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  49
* EL156.cbl
  2386         16  PI-EXP-DT           PIC XX.
  2387         16  PI-LOAN-DUE-DAY     PIC 99.
  2388         16  PI-3RD-PARTY-SW     PIC X.
  2389         16  PI-LOAN-UPDATE-SW   PIC X.
  2390
  2391         16  PI-DMD-DATA.
  2392             20  PI-SV-CERT-KEY       PIC X(21).
  2393             20  PI-SV-CERT-NO        PIC X(11).
  2394             20  PI-SV-BEN            PIC X(10).
  2395             20  PI-SV-CCN            PIC X(16).
  2396             20  PI-INTEREST-PAID-IND PIC X.
  2397                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2398             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2399             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2400             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2401             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2402         16  PI-AT-EOB-CODES.
  2403             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2404         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2405         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2406         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2407         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2408         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2409         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2410         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2411         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2412         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2413         16  PI-LF-BENEFIT-CD         PIC X(2).
  2414         16  PI-EOB-CODES-EXIST PIC X.
  2415         16  PI-SET-NOTE2-MDT   PIC X.
  2416         16  PI-VFY-2ND-BENE          PIC X.
  2417*00781          16  FILLER                   PIC X(176).
  2418*052506         16  FILLER                   PIC X(161).
  2419*031808         16  FILLER                   PIC X(154).
  2420*091808         16  FILLER                   PIC X(152).
  2421*041710         16  FILLER                   PIC X(94).
  2422         16  FILLER                   PIC X(93).
  2423
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  50
* EL156.cbl
  2425*    COPY ELCJPFX.
  2426******************************************************************
  2427*                                                                *
  2428*                                                                *
  2429*                            ELCJPFX.                            *
  2430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2431*                            VMOD=2.002                          *
  2432*                                                                *
  2433*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2434*                                                                *
  2435*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2436*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2437*        ELCNTL - CONTROL FILE                                   *
  2438*        ELMSTR - CLAIM MASTERS                                  *
  2439*        ELTRLR - ACTIVITY TRAILERS                              *
  2440*        ELCHKQ - CHECK QUE                                      *
  2441******************************************************************
  2442 01  JOURNAL-RECORD.
  2443     12  JP-USER-ID                  PIC X(4).
  2444     12  JP-FILE-ID                  PIC X(8).
  2445     12  JP-PROGRAM-ID               PIC X(8).
  2446     12  JP-RECORD-TYPE              PIC X.
  2447         88 JP-ADD              VALUE 'A'.
  2448         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2449         88 JP-AFTER-CHANGE     VALUE 'C'.
  2450         88 JP-DELETE           VALUE 'D'.
  2451         88 JP-GENERIC-DELETE   VALUE 'G'.
  2452         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2453         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2454     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2455     12  JP-RECORD-AREA
  2456
  2457
  2458                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  51
* EL156.cbl
  2460*    COPY ELCAID.
  2461******************************************************************
  2462*                                                                *
  2463*                            ELCAID.                             *
  2464*                            VMOD=2.001                          *
  2465*                                                                *
  2466*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2467*                                                                *
  2468*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2469*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2470******************************************************************
  2471
  2472 01  DFHAID.
  2473   02  DFHNULL   PIC  X  VALUE  ' '.
  2474   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2475   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2476   02  DFHPEN    PIC  X  VALUE  '='.
  2477   02  DFHOPID   PIC  X  VALUE  'W'.
  2478   02  DFHPA1    PIC  X  VALUE  '%'.
  2479   02  DFHPA2    PIC  X  VALUE  '>'.
  2480   02  DFHPA3    PIC  X  VALUE  ','.
  2481   02  DFHPF1    PIC  X  VALUE  '1'.
  2482   02  DFHPF2    PIC  X  VALUE  '2'.
  2483   02  DFHPF3    PIC  X  VALUE  '3'.
  2484   02  DFHPF4    PIC  X  VALUE  '4'.
  2485   02  DFHPF5    PIC  X  VALUE  '5'.
  2486   02  DFHPF6    PIC  X  VALUE  '6'.
  2487   02  DFHPF7    PIC  X  VALUE  '7'.
  2488   02  DFHPF8    PIC  X  VALUE  '8'.
  2489   02  DFHPF9    PIC  X  VALUE  '9'.
  2490   02  DFHPF10   PIC  X  VALUE  ':'.
  2491   02  DFHPF11   PIC  X  VALUE  '#'.
  2492   02  DFHPF12   PIC  X  VALUE  '@'.
  2493   02  DFHPF13   PIC  X  VALUE  'A'.
  2494   02  DFHPF14   PIC  X  VALUE  'B'.
  2495   02  DFHPF15   PIC  X  VALUE  'C'.
  2496   02  DFHPF16   PIC  X  VALUE  'D'.
  2497   02  DFHPF17   PIC  X  VALUE  'E'.
  2498   02  DFHPF18   PIC  X  VALUE  'F'.
  2499   02  DFHPF19   PIC  X  VALUE  'G'.
  2500   02  DFHPF20   PIC  X  VALUE  'H'.
  2501   02  DFHPF21   PIC  X  VALUE  'I'.
  2502*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2503   02  DFHPF22   PIC  X  VALUE  '['.
  2504   02  DFHPF23   PIC  X  VALUE  '.'.
  2505   02  DFHPF24   PIC  X  VALUE  '<'.
  2506   02  DFHMSRE   PIC  X  VALUE  'X'.
  2507   02  DFHSTRF   PIC  X  VALUE  'h'.
  2508   02  DFHTRIG   PIC  X  VALUE  '"'.
  2509 01  FILLER    REDEFINES DFHAID.
  2510     12  FILLER              PIC X(8).
  2511     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  52
* EL156.cbl
  2513*    COPY EL156S.
  2514 01  EL156AI.
  2515     05  FILLER            PIC  X(0012).
  2516*    -------------------------------
  2517     05  RUNDTEAL PIC S9(0004) COMP.
  2518     05  RUNDTEAF PIC  X(0001).
  2519     05  FILLER REDEFINES RUNDTEAF.
  2520         10  RUNDTEAA PIC  X(0001).
  2521     05  RUNDTEAI PIC  X(0008).
  2522*    -------------------------------
  2523     05  RUNTIMAL PIC S9(0004) COMP.
  2524     05  RUNTIMAF PIC  X(0001).
  2525     05  FILLER REDEFINES RUNTIMAF.
  2526         10  RUNTIMAA PIC  X(0001).
  2527     05  RUNTIMAI PIC  X(0005).
  2528*    -------------------------------
  2529     05  SEQUL PIC S9(0004) COMP.
  2530     05  SEQUF PIC  X(0001).
  2531     05  FILLER REDEFINES SEQUF.
  2532         10  SEQUA PIC  X(0001).
  2533     05  SEQUI PIC  X(0010).
  2534*    -------------------------------
  2535     05  CLMNOL PIC S9(0004) COMP.
  2536     05  CLMNOF PIC  X(0001).
  2537     05  FILLER REDEFINES CLMNOF.
  2538         10  CLMNOA PIC  X(0001).
  2539     05  CLMNOI PIC  X(0007).
  2540*    -------------------------------
  2541     05  CARRL PIC S9(0004) COMP.
  2542     05  CARRF PIC  X(0001).
  2543     05  FILLER REDEFINES CARRF.
  2544         10  CARRA PIC  X(0001).
  2545     05  CARRI PIC  X(0001).
  2546*    -------------------------------
  2547     05  CERTNOL PIC S9(0004) COMP.
  2548     05  CERTNOF PIC  X(0001).
  2549     05  FILLER REDEFINES CERTNOF.
  2550         10  CERTNOA PIC  X(0001).
  2551     05  CERTNOI PIC  X(0010).
  2552*    -------------------------------
  2553     05  SUFXL PIC S9(0004) COMP.
  2554     05  SUFXF PIC  X(0001).
  2555     05  FILLER REDEFINES SUFXF.
  2556         10  SUFXA PIC  X(0001).
  2557     05  SUFXI PIC  X(0001).
  2558*    -------------------------------
  2559     05  CLMTYPL PIC S9(0004) COMP.
  2560     05  CLMTYPF PIC  X(0001).
  2561     05  FILLER REDEFINES CLMTYPF.
  2562         10  CLMTYPA PIC  X(0001).
  2563     05  CLMTYPI PIC  X(0006).
  2564*    -------------------------------
  2565     05  CLMSTATL PIC S9(0004) COMP.
  2566     05  CLMSTATF PIC  X(0001).
  2567     05  FILLER REDEFINES CLMSTATF.
  2568         10  CLMSTATA PIC  X(0001).
  2569     05  CLMSTATI PIC  X(0006).
  2570*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  53
* EL156.cbl
  2571     05  LSTNMEL PIC S9(0004) COMP.
  2572     05  LSTNMEF PIC  X(0001).
  2573     05  FILLER REDEFINES LSTNMEF.
  2574         10  LSTNMEA PIC  X(0001).
  2575     05  LSTNMEI PIC  X(0015).
  2576*    -------------------------------
  2577     05  FSTNMEL PIC S9(0004) COMP.
  2578     05  FSTNMEF PIC  X(0001).
  2579     05  FILLER REDEFINES FSTNMEF.
  2580         10  FSTNMEA PIC  X(0001).
  2581     05  FSTNMEI PIC  X(0012).
  2582*    -------------------------------
  2583     05  MINITL PIC S9(0004) COMP.
  2584     05  MINITF PIC  X(0001).
  2585     05  FILLER REDEFINES MINITF.
  2586         10  MINITA PIC  X(0001).
  2587     05  MINITI PIC  X(0001).
  2588*    -------------------------------
  2589     05  PRIMHDGL PIC S9(0004) COMP.
  2590     05  PRIMHDGF PIC  X(0001).
  2591     05  FILLER REDEFINES PRIMHDGF.
  2592         10  PRIMHDGA PIC  X(0001).
  2593     05  PRIMHDGI PIC  X(0012).
  2594*    -------------------------------
  2595     05  PCERTNOL PIC S9(0004) COMP.
  2596     05  PCERTNOF PIC  X(0001).
  2597     05  FILLER REDEFINES PCERTNOF.
  2598         10  PCERTNOA PIC  X(0001).
  2599     05  PCERTNOI PIC  X(0010).
  2600*    -------------------------------
  2601     05  PSUFXL PIC S9(0004) COMP.
  2602     05  PSUFXF PIC  X(0001).
  2603     05  FILLER REDEFINES PSUFXF.
  2604         10  PSUFXA PIC  X(0001).
  2605     05  PSUFXI PIC  X(0001).
  2606*    -------------------------------
  2607     05  STATUSL PIC S9(0004) COMP.
  2608     05  STATUSF PIC  X(0001).
  2609     05  FILLER REDEFINES STATUSF.
  2610         10  STATUSA PIC  X(0001).
  2611     05  STATUSI PIC  X(0010).
  2612*    -------------------------------
  2613     05  LOANHL PIC S9(0004) COMP.
  2614     05  LOANHF PIC  X(0001).
  2615     05  FILLER REDEFINES LOANHF.
  2616         10  LOANHA PIC  X(0001).
  2617     05  LOANHI PIC  X(0014).
  2618*    -------------------------------
  2619     05  LOANNOL PIC S9(0004) COMP.
  2620     05  LOANNOF PIC  X(0001).
  2621     05  FILLER REDEFINES LOANNOF.
  2622         10  LOANNOA PIC  X(0001).
  2623     05  LOANNOI PIC  X(0025).
  2624*    -------------------------------
  2625     05  DUEDAYHL PIC S9(0004) COMP.
  2626     05  DUEDAYHF PIC  X(0001).
  2627     05  FILLER REDEFINES DUEDAYHF.
  2628         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  54
* EL156.cbl
  2629     05  DUEDAYHI PIC  X(0008).
  2630*    -------------------------------
  2631     05  DUEDAYL PIC S9(0004) COMP.
  2632     05  DUEDAYF PIC  X(0001).
  2633     05  FILLER REDEFINES DUEDAYF.
  2634         10  DUEDAYA PIC  X(0001).
  2635     05  DUEDAYI PIC  X(0002).
  2636*    -------------------------------
  2637     05  ZINTHL PIC S9(0004) COMP.
  2638     05  ZINTHF PIC  X(0001).
  2639     05  FILLER REDEFINES ZINTHF.
  2640         10  ZINTHA PIC  X(0001).
  2641     05  ZINTHI PIC  X(0009).
  2642*    -------------------------------
  2643     05  ZINTL PIC S9(0004) COMP.
  2644     05  ZINTF PIC  X(0001).
  2645     05  FILLER REDEFINES ZINTF.
  2646         10  ZINTA PIC  X(0001).
  2647     05  ZINTI PIC  99V99999.
  2648*    -------------------------------
  2649     05  PTHRHDGL PIC S9(0004) COMP.
  2650     05  PTHRHDGF PIC  X(0001).
  2651     05  FILLER REDEFINES PTHRHDGF.
  2652         10  PTHRHDGA PIC  X(0001).
  2653     05  PTHRHDGI PIC  X(0014).
  2654*    -------------------------------
  2655     05  PDTHRUL PIC S9(0004) COMP.
  2656     05  PDTHRUF PIC  X(0001).
  2657     05  FILLER REDEFINES PDTHRUF.
  2658         10  PDTHRUA PIC  X(0001).
  2659     05  PDTHRUI PIC  X(0008).
  2660*    -------------------------------
  2661     05  TOTPAIDL PIC S9(0004) COMP.
  2662     05  TOTPAIDF PIC  X(0001).
  2663     05  FILLER REDEFINES TOTPAIDF.
  2664         10  TOTPAIDA PIC  X(0001).
  2665     05  TOTPAIDI PIC  X(0010).
  2666*    -------------------------------
  2667     05  COVERL PIC S9(0004) COMP.
  2668     05  COVERF PIC  X(0001).
  2669     05  FILLER REDEFINES COVERF.
  2670         10  COVERA PIC  X(0001).
  2671     05  COVERI PIC  X(0010).
  2672*    -------------------------------
  2673     05  INCURL PIC S9(0004) COMP.
  2674     05  INCURF PIC  X(0001).
  2675     05  FILLER REDEFINES INCURF.
  2676         10  INCURA PIC  X(0001).
  2677     05  INCURI PIC  X(0008).
  2678*    -------------------------------
  2679     05  LSTDTEL PIC S9(0004) COMP.
  2680     05  LSTDTEF PIC  X(0001).
  2681     05  FILLER REDEFINES LSTDTEF.
  2682         10  LSTDTEA PIC  X(0001).
  2683     05  LSTDTEI PIC  X(0008).
  2684*    -------------------------------
  2685     05  CRTSTATL PIC S9(0004) COMP.
  2686     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  55
* EL156.cbl
  2687     05  FILLER REDEFINES CRTSTATF.
  2688         10  CRTSTATA PIC  X(0001).
  2689     05  CRTSTATI PIC  X(0010).
  2690*    -------------------------------
  2691     05  EFFECTL PIC S9(0004) COMP.
  2692     05  EFFECTF PIC  X(0001).
  2693     05  FILLER REDEFINES EFFECTF.
  2694         10  EFFECTA PIC  X(0001).
  2695     05  EFFECTI PIC  X(0008).
  2696*    -------------------------------
  2697     05  TERMSL PIC S9(0004) COMP.
  2698     05  TERMSF PIC  X(0001).
  2699     05  FILLER REDEFINES TERMSF.
  2700         10  TERMSA PIC  X(0001).
  2701     05  TERMSI PIC  X(0011).
  2702*    -------------------------------
  2703     05  STACCTL PIC S9(0004) COMP.
  2704     05  STACCTF PIC  X(0001).
  2705     05  FILLER REDEFINES STACCTF.
  2706         10  STACCTA PIC  X(0001).
  2707     05  STACCTI PIC  X(0013).
  2708*    -------------------------------
  2709     05  EXPDTEHL PIC S9(0004) COMP.
  2710     05  EXPDTEHF PIC  X(0001).
  2711     05  FILLER REDEFINES EXPDTEHF.
  2712         10  EXPDTEHA PIC  X(0001).
  2713     05  EXPDTEHI PIC  X(0014).
  2714*    -------------------------------
  2715     05  EXPDTEL PIC S9(0004) COMP.
  2716     05  EXPDTEF PIC  X(0001).
  2717     05  FILLER REDEFINES EXPDTEF.
  2718         10  EXPDTEA PIC  X(0001).
  2719     05  EXPDTEI PIC  X(0008).
  2720*    -------------------------------
  2721     05  BENECAPL PIC S9(0004) COMP.
  2722     05  BENECAPF PIC  X(0001).
  2723     05  FILLER REDEFINES BENECAPF.
  2724         10  BENECAPA PIC  X(0001).
  2725     05  BENECAPI PIC  X(0013).
  2726*    -------------------------------
  2727     05  BENEL PIC S9(0004) COMP.
  2728     05  BENEF PIC  X(0001).
  2729     05  FILLER REDEFINES BENEF.
  2730         10  BENEA PIC  X(0001).
  2731     05  BENEI PIC  X(0009).
  2732*    -------------------------------
  2733     05  FORMTYPL PIC S9(0004) COMP.
  2734     05  FORMTYPF PIC  X(0001).
  2735     05  FILLER REDEFINES FORMTYPF.
  2736         10  FORMTYPA PIC  X(0001).
  2737     05  FORMTYPI PIC  X(0001).
  2738*    -------------------------------
  2739     05  PMTTYPEL PIC S9(0004) COMP.
  2740     05  PMTTYPEF PIC  X(0001).
  2741     05  FILLER REDEFINES PMTTYPEF.
  2742         10  PMTTYPEA PIC  X(0001).
  2743     05  PMTTYPEI PIC  X(0001).
  2744*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  56
* EL156.cbl
  2745     05  PAYEEL PIC S9(0004) COMP.
  2746     05  PAYEEF PIC  X(0001).
  2747     05  FILLER REDEFINES PAYEEF.
  2748         10  PAYEEA PIC  X(0001).
  2749     05  PAYEEI PIC  X(0002).
  2750*    -------------------------------
  2751     05  CHECKNOL PIC S9(0004) COMP.
  2752     05  CHECKNOF PIC  X(0001).
  2753     05  FILLER REDEFINES CHECKNOF.
  2754         10  CHECKNOA PIC  X(0001).
  2755     05  CHECKNOI PIC  X(0007).
  2756*    -------------------------------
  2757     05  OFFLINEL PIC S9(0004) COMP.
  2758     05  OFFLINEF PIC  X(0001).
  2759     05  FILLER REDEFINES OFFLINEF.
  2760         10  OFFLINEA PIC  X(0001).
  2761     05  OFFLINEI PIC  X(0001).
  2762*    -------------------------------
  2763     05  HOLDTILL PIC S9(0004) COMP.
  2764     05  HOLDTILF PIC  X(0001).
  2765     05  FILLER REDEFINES HOLDTILF.
  2766         10  HOLDTILA PIC  X(0001).
  2767     05  HOLDTILI PIC  X(0008).
  2768*    -------------------------------
  2769     05  NOTE1L PIC S9(0004) COMP.
  2770     05  NOTE1F PIC  X(0001).
  2771     05  FILLER REDEFINES NOTE1F.
  2772         10  NOTE1A PIC  X(0001).
  2773     05  NOTE1I PIC  X(0060).
  2774*    -------------------------------
  2775     05  NOTE2L PIC S9(0004) COMP.
  2776     05  NOTE2F PIC  X(0001).
  2777     05  FILLER REDEFINES NOTE2F.
  2778         10  NOTE2A PIC  X(0001).
  2779     05  NOTE2I PIC  X(0060).
  2780*    -------------------------------
  2781     05  EOBYNL PIC S9(0004) COMP.
  2782     05  EOBYNF PIC  X(0001).
  2783     05  FILLER REDEFINES EOBYNF.
  2784         10  EOBYNA PIC  X(0001).
  2785     05  EOBYNI PIC  X(0001).
  2786*    -------------------------------
  2787     05  CASHHL PIC S9(0004) COMP.
  2788     05  CASHHF PIC  X(0001).
  2789     05  FILLER REDEFINES CASHHF.
  2790         10  CASHHA PIC  X(0001).
  2791     05  CASHHI PIC  X(0011).
  2792*    -------------------------------
  2793     05  CASHL PIC S9(0004) COMP.
  2794     05  CASHF PIC  X(0001).
  2795     05  FILLER REDEFINES CASHF.
  2796         10  CASHA PIC  X(0001).
  2797     05  CASHI PIC  X(0001).
  2798*    -------------------------------
  2799     05  GROUPHL PIC S9(0004) COMP.
  2800     05  GROUPHF PIC  X(0001).
  2801     05  FILLER REDEFINES GROUPHF.
  2802         10  GROUPHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  57
* EL156.cbl
  2803     05  GROUPHI PIC  X(0010).
  2804*    -------------------------------
  2805     05  GROUPEDL PIC S9(0004) COMP.
  2806     05  GROUPEDF PIC  X(0001).
  2807     05  FILLER REDEFINES GROUPEDF.
  2808         10  GROUPEDA PIC  X(0001).
  2809     05  GROUPEDI PIC  X(0001).
  2810*    -------------------------------
  2811     05  PINTHL PIC S9(0004) COMP.
  2812     05  PINTHF PIC  X(0001).
  2813     05  FILLER REDEFINES PINTHF.
  2814         10  PINTHA PIC  X(0001).
  2815     05  PINTHI PIC  X(0004).
  2816*    -------------------------------
  2817     05  PINTL PIC S9(0004) COMP.
  2818     05  PINTF PIC  X(0001).
  2819     05  FILLER REDEFINES PINTF.
  2820         10  PINTA PIC  X(0001).
  2821     05  PINTI PIC  X(0008).
  2822*    -------------------------------
  2823     05  PROOFDTL PIC S9(0004) COMP.
  2824     05  PROOFDTF PIC  X(0001).
  2825     05  FILLER REDEFINES PROOFDTF.
  2826         10  PROOFDTA PIC  X(0001).
  2827     05  PROOFDTI PIC  X(0008).
  2828*    -------------------------------
  2829     05  AIGFRMHL PIC S9(0004) COMP.
  2830     05  AIGFRMHF PIC  X(0001).
  2831     05  FILLER REDEFINES AIGFRMHF.
  2832         10  AIGFRMHA PIC  X(0001).
  2833     05  AIGFRMHI PIC  X(0012).
  2834*    -------------------------------
  2835     05  AIGFROML PIC S9(0004) COMP.
  2836     05  AIGFROMF PIC  X(0001).
  2837     05  FILLER REDEFINES AIGFROMF.
  2838         10  AIGFROMA PIC  X(0001).
  2839     05  AIGFROMI PIC  X(0008).
  2840*    -------------------------------
  2841     05  PMTHDGAL PIC S9(0004) COMP.
  2842     05  PMTHDGAF PIC  X(0001).
  2843     05  FILLER REDEFINES PMTHDGAF.
  2844         10  PMTHDGAA PIC  X(0001).
  2845     05  PMTHDGAI PIC  X(0066).
  2846*    -------------------------------
  2847     05  EPYFROML PIC S9(0004) COMP.
  2848     05  EPYFROMF PIC  X(0001).
  2849     05  FILLER REDEFINES EPYFROMF.
  2850         10  EPYFROMA PIC  X(0001).
  2851     05  EPYFROMI PIC  X(0008).
  2852*    -------------------------------
  2853     05  EPYTHRUL PIC S9(0004) COMP.
  2854     05  EPYTHRUF PIC  X(0001).
  2855     05  FILLER REDEFINES EPYTHRUF.
  2856         10  EPYTHRUA PIC  X(0001).
  2857     05  EPYTHRUI PIC  X(0008).
  2858*    -------------------------------
  2859     05  EDAYSL PIC S9(0004) COMP.
  2860     05  EDAYSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  58
* EL156.cbl
  2861     05  FILLER REDEFINES EDAYSF.
  2862         10  EDAYSA PIC  X(0001).
  2863     05  EDAYSI PIC  S9(6).
  2864*    -------------------------------
  2865     05  EPYAMTL PIC S9(0004) COMP.
  2866     05  EPYAMTF PIC  X(0001).
  2867     05  FILLER REDEFINES EPYAMTF.
  2868         10  EPYAMTA PIC  X(0001).
  2869     05  EPYAMTI PIC  S9(8)V99.
  2870*    -------------------------------
  2871     05  ERESVL PIC S9(0004) COMP.
  2872     05  ERESVF PIC  X(0001).
  2873     05  FILLER REDEFINES ERESVF.
  2874         10  ERESVA PIC  X(0001).
  2875     05  ERESVI PIC  S9(7)V99.
  2876*    -------------------------------
  2877     05  ETYPEL PIC S9(0004) COMP.
  2878     05  ETYPEF PIC  X(0001).
  2879     05  FILLER REDEFINES ETYPEF.
  2880         10  ETYPEA PIC  X(0001).
  2881     05  ETYPEI PIC  X(0001).
  2882*    -------------------------------
  2883     05  EEXPENSL PIC S9(0004) COMP.
  2884     05  EEXPENSF PIC  X(0001).
  2885     05  FILLER REDEFINES EEXPENSF.
  2886         10  EEXPENSA PIC  X(0001).
  2887     05  EEXPENSI PIC  9(6)V99.
  2888*    -------------------------------
  2889     05  CPYFROML PIC S9(0004) COMP.
  2890     05  CPYFROMF PIC  X(0001).
  2891     05  FILLER REDEFINES CPYFROMF.
  2892         10  CPYFROMA PIC  X(0001).
  2893     05  CPYFROMI PIC  X(0008).
  2894*    -------------------------------
  2895     05  CPYTHRUL PIC S9(0004) COMP.
  2896     05  CPYTHRUF PIC  X(0001).
  2897     05  FILLER REDEFINES CPYTHRUF.
  2898         10  CPYTHRUA PIC  X(0001).
  2899     05  CPYTHRUI PIC  X(0008).
  2900*    -------------------------------
  2901     05  CDAYSL PIC S9(0004) COMP.
  2902     05  CDAYSF PIC  X(0001).
  2903     05  FILLER REDEFINES CDAYSF.
  2904         10  CDAYSA PIC  X(0001).
  2905     05  CDAYSI PIC  9(6).
  2906*    -------------------------------
  2907     05  CPYAMTL PIC S9(0004) COMP.
  2908     05  CPYAMTF PIC  X(0001).
  2909     05  FILLER REDEFINES CPYAMTF.
  2910         10  CPYAMTA PIC  X(0001).
  2911     05  CPYAMTI PIC  S9(8)V99.
  2912*    -------------------------------
  2913     05  CRESVL PIC S9(0004) COMP.
  2914     05  CRESVF PIC  X(0001).
  2915     05  FILLER REDEFINES CRESVF.
  2916         10  CRESVA PIC  X(0001).
  2917     05  CRESVI PIC  9(6)V99.
  2918*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  59
* EL156.cbl
  2919     05  CEXPENSL PIC S9(0004) COMP.
  2920     05  CEXPENSF PIC  X(0001).
  2921     05  FILLER REDEFINES CEXPENSF.
  2922         10  CEXPENSA PIC  X(0001).
  2923     05  CEXPENSI PIC  9(6)V99.
  2924*    -------------------------------
  2925     05  ERRMSG0L PIC S9(0004) COMP.
  2926     05  ERRMSG0F PIC  X(0001).
  2927     05  FILLER REDEFINES ERRMSG0F.
  2928         10  ERRMSG0A PIC  X(0001).
  2929     05  ERRMSG0I PIC  X(0072).
  2930*    -------------------------------
  2931     05  ERRMSG1L PIC S9(0004) COMP.
  2932     05  ERRMSG1F PIC  X(0001).
  2933     05  FILLER REDEFINES ERRMSG1F.
  2934         10  ERRMSG1A PIC  X(0001).
  2935     05  ERRMSG1I PIC  X(0072).
  2936*    -------------------------------
  2937     05  ERRMSG2L PIC S9(0004) COMP.
  2938     05  ERRMSG2F PIC  X(0001).
  2939     05  FILLER REDEFINES ERRMSG2F.
  2940         10  ERRMSG2A PIC  X(0001).
  2941     05  ERRMSG2I PIC  X(0072).
  2942*    -------------------------------
  2943     05  ENTERPFL PIC S9(0004) COMP.
  2944     05  ENTERPFF PIC  X(0001).
  2945     05  FILLER REDEFINES ENTERPFF.
  2946         10  ENTERPFA PIC  X(0001).
  2947     05  ENTERPFI PIC  99.
  2948*    -------------------------------
  2949     05  PF6TITL PIC S9(0004) COMP.
  2950     05  PF6TITF PIC  X(0001).
  2951     05  FILLER REDEFINES PF6TITF.
  2952         10  PF6TITA PIC  X(0001).
  2953     05  PF6TITI PIC  X(0016).
  2954 01  EL156AO REDEFINES EL156AI.
  2955     05  FILLER            PIC  X(0012).
  2956*    -------------------------------
  2957     05  FILLER            PIC  X(0003).
  2958     05  RUNDTEAO PIC  X(0008).
  2959*    -------------------------------
  2960     05  FILLER            PIC  X(0003).
  2961     05  RUNTIMAO PIC  99.99.
  2962*    -------------------------------
  2963     05  FILLER            PIC  X(0003).
  2964     05  SEQUO PIC  X(0010).
  2965*    -------------------------------
  2966     05  FILLER            PIC  X(0003).
  2967     05  CLMNOO PIC  X(0007).
  2968*    -------------------------------
  2969     05  FILLER            PIC  X(0003).
  2970     05  CARRO PIC  X(0001).
  2971*    -------------------------------
  2972     05  FILLER            PIC  X(0003).
  2973     05  CERTNOO PIC  X(0010).
  2974*    -------------------------------
  2975     05  FILLER            PIC  X(0003).
  2976     05  SUFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  60
* EL156.cbl
  2977*    -------------------------------
  2978     05  FILLER            PIC  X(0003).
  2979     05  CLMTYPO PIC  X(0006).
  2980*    -------------------------------
  2981     05  FILLER            PIC  X(0003).
  2982     05  CLMSTATO PIC  X(0006).
  2983*    -------------------------------
  2984     05  FILLER            PIC  X(0003).
  2985     05  LSTNMEO PIC  X(0015).
  2986*    -------------------------------
  2987     05  FILLER            PIC  X(0003).
  2988     05  FSTNMEO PIC  X(0012).
  2989*    -------------------------------
  2990     05  FILLER            PIC  X(0003).
  2991     05  MINITO PIC  X(0001).
  2992*    -------------------------------
  2993     05  FILLER            PIC  X(0003).
  2994     05  PRIMHDGO PIC  X(0012).
  2995*    -------------------------------
  2996     05  FILLER            PIC  X(0003).
  2997     05  PCERTNOO PIC  X(0010).
  2998*    -------------------------------
  2999     05  FILLER            PIC  X(0003).
  3000     05  PSUFXO PIC  X(0001).
  3001*    -------------------------------
  3002     05  FILLER            PIC  X(0003).
  3003     05  STATUSO PIC  X(0010).
  3004*    -------------------------------
  3005     05  FILLER            PIC  X(0003).
  3006     05  LOANHO PIC  X(0014).
  3007*    -------------------------------
  3008     05  FILLER            PIC  X(0003).
  3009     05  LOANNOO PIC  X(0025).
  3010*    -------------------------------
  3011     05  FILLER            PIC  X(0003).
  3012     05  DUEDAYHO PIC  X(0008).
  3013*    -------------------------------
  3014     05  FILLER            PIC  X(0003).
  3015     05  DUEDAYO PIC  X(0002).
  3016*    -------------------------------
  3017     05  FILLER            PIC  X(0003).
  3018     05  ZINTHO PIC  X(0009).
  3019*    -------------------------------
  3020     05  FILLER            PIC  X(0003).
  3021     05  ZINTO PIC  9.99999.
  3022*    -------------------------------
  3023     05  FILLER            PIC  X(0003).
  3024     05  PTHRHDGO PIC  X(0014).
  3025*    -------------------------------
  3026     05  FILLER            PIC  X(0003).
  3027     05  PDTHRUO PIC  X(0008).
  3028*    -------------------------------
  3029     05  FILLER            PIC  X(0003).
  3030     05  TOTPAIDO PIC  Z(6).99-.
  3031*    -------------------------------
  3032     05  FILLER            PIC  X(0003).
  3033     05  COVERO PIC  X(0010).
  3034*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  61
* EL156.cbl
  3035     05  FILLER            PIC  X(0003).
  3036     05  INCURO PIC  X(0008).
  3037*    -------------------------------
  3038     05  FILLER            PIC  X(0003).
  3039     05  LSTDTEO PIC  X(0008).
  3040*    -------------------------------
  3041     05  FILLER            PIC  X(0003).
  3042     05  CRTSTATO PIC  X(0010).
  3043*    -------------------------------
  3044     05  FILLER            PIC  X(0003).
  3045     05  EFFECTO PIC  X(0008).
  3046*    -------------------------------
  3047     05  FILLER            PIC  X(0003).
  3048     05  TERMSO PIC  X(0011).
  3049*    -------------------------------
  3050     05  FILLER            PIC  X(0003).
  3051     05  STACCTO PIC  X(0013).
  3052*    -------------------------------
  3053     05  FILLER            PIC  X(0003).
  3054     05  EXPDTEHO PIC  X(0014).
  3055*    -------------------------------
  3056     05  FILLER            PIC  X(0003).
  3057     05  EXPDTEO PIC  X(0008).
  3058*    -------------------------------
  3059     05  FILLER            PIC  X(0003).
  3060     05  BENECAPO PIC  X(0013).
  3061*    -------------------------------
  3062     05  FILLER            PIC  X(0003).
  3063     05  BENEO PIC  Z(6).99.
  3064*    -------------------------------
  3065     05  FILLER            PIC  X(0003).
  3066     05  FORMTYPO PIC  X(0001).
  3067*    -------------------------------
  3068     05  FILLER            PIC  X(0003).
  3069     05  PMTTYPEO PIC  X(0001).
  3070*    -------------------------------
  3071     05  FILLER            PIC  X(0003).
  3072     05  PAYEEO PIC  X(0002).
  3073*    -------------------------------
  3074     05  FILLER            PIC  X(0003).
  3075     05  CHECKNOO PIC  X(0007).
  3076*    -------------------------------
  3077     05  FILLER            PIC  X(0003).
  3078     05  OFFLINEO PIC  X(0001).
  3079*    -------------------------------
  3080     05  FILLER            PIC  X(0003).
  3081     05  HOLDTILO PIC  99B99B99.
  3082*    -------------------------------
  3083     05  FILLER            PIC  X(0003).
  3084     05  NOTE1O PIC  X(0060).
  3085*    -------------------------------
  3086     05  FILLER            PIC  X(0003).
  3087     05  NOTE2O PIC  X(0060).
  3088*    -------------------------------
  3089     05  FILLER            PIC  X(0003).
  3090     05  EOBYNO PIC  X(0001).
  3091*    -------------------------------
  3092     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  62
* EL156.cbl
  3093     05  CASHHO PIC  X(0011).
  3094*    -------------------------------
  3095     05  FILLER            PIC  X(0003).
  3096     05  CASHO PIC  X(0001).
  3097*    -------------------------------
  3098     05  FILLER            PIC  X(0003).
  3099     05  GROUPHO PIC  X(0010).
  3100*    -------------------------------
  3101     05  FILLER            PIC  X(0003).
  3102     05  GROUPEDO PIC  X(0001).
  3103*    -------------------------------
  3104     05  FILLER            PIC  X(0003).
  3105     05  PINTHO PIC  X(0004).
  3106*    -------------------------------
  3107     05  FILLER            PIC  X(0003).
  3108     05  PINTO PIC  Z,ZZ9.99.
  3109*    -------------------------------
  3110     05  FILLER            PIC  X(0003).
  3111     05  PROOFDTO PIC  99B99B99.
  3112*    -------------------------------
  3113     05  FILLER            PIC  X(0003).
  3114     05  AIGFRMHO PIC  X(0012).
  3115*    -------------------------------
  3116     05  FILLER            PIC  X(0003).
  3117     05  AIGFROMO PIC  99B99B99.
  3118*    -------------------------------
  3119     05  FILLER            PIC  X(0003).
  3120     05  PMTHDGAO PIC  X(0066).
  3121*    -------------------------------
  3122     05  FILLER            PIC  X(0003).
  3123     05  EPYFROMO PIC  99B99B99.
  3124*    -------------------------------
  3125     05  FILLER            PIC  X(0003).
  3126     05  EPYTHRUO PIC  99B99B99.
  3127*    -------------------------------
  3128     05  FILLER            PIC  X(0003).
  3129     05  EDAYSO PIC  Z(4)9-.
  3130*    -------------------------------
  3131     05  FILLER            PIC  X(0003).
  3132     05  EPYAMTO PIC  Z(6).99-.
  3133*    -------------------------------
  3134     05  FILLER            PIC  X(0003).
  3135     05  ERESVO PIC  Z(5).99-.
  3136*    -------------------------------
  3137     05  FILLER            PIC  X(0003).
  3138     05  ETYPEO PIC  X(0001).
  3139*    -------------------------------
  3140     05  FILLER            PIC  X(0003).
  3141     05  EEXPENSO PIC  Z(5).99.
  3142*    -------------------------------
  3143     05  FILLER            PIC  X(0003).
  3144     05  CPYFROMO PIC  99B99B99.
  3145*    -------------------------------
  3146     05  FILLER            PIC  X(0003).
  3147     05  CPYTHRUO PIC  99B99B99.
  3148*    -------------------------------
  3149     05  FILLER            PIC  X(0003).
  3150     05  CDAYSO PIC  Z(4)9-.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  63
* EL156.cbl
  3151*    -------------------------------
  3152     05  FILLER            PIC  X(0003).
  3153     05  CPYAMTO PIC  Z(6).99-.
  3154*    -------------------------------
  3155     05  FILLER            PIC  X(0003).
  3156     05  CRESVO PIC  Z(5).99.
  3157*    -------------------------------
  3158     05  FILLER            PIC  X(0003).
  3159     05  CEXPENSO PIC  Z(5).99.
  3160*    -------------------------------
  3161     05  FILLER            PIC  X(0003).
  3162     05  ERRMSG0O PIC  X(0072).
  3163*    -------------------------------
  3164     05  FILLER            PIC  X(0003).
  3165     05  ERRMSG1O PIC  X(0072).
  3166*    -------------------------------
  3167     05  FILLER            PIC  X(0003).
  3168     05  ERRMSG2O PIC  X(0072).
  3169*    -------------------------------
  3170     05  FILLER            PIC  X(0003).
  3171     05  ENTERPFO PIC  X(0002).
  3172*    -------------------------------
  3173     05  FILLER            PIC  X(0003).
  3174     05  PF6TITO PIC  X(0016).
  3175*    -------------------------------
  3176 01  EL156BI REDEFINES EL156AI.
  3177     05  FILLER            PIC  X(0012).
  3178*    -------------------------------
  3179     05  RUNDTEBL PIC S9(0004) COMP.
  3180     05  RUNDTEBF PIC  X(0001).
  3181     05  FILLER REDEFINES RUNDTEBF.
  3182         10  RUNDTEBA PIC  X(0001).
  3183     05  RUNDTEBI PIC  X(0008).
  3184*    -------------------------------
  3185     05  RUNTIMBL PIC S9(0004) COMP.
  3186     05  RUNTIMBF PIC  X(0001).
  3187     05  FILLER REDEFINES RUNTIMBF.
  3188         10  RUNTIMBA PIC  X(0001).
  3189     05  RUNTIMBI PIC  X(0005).
  3190*    -------------------------------
  3191     05  PAYDTBL PIC S9(0004) COMP.
  3192     05  PAYDTBF PIC  X(0001).
  3193     05  FILLER REDEFINES PAYDTBF.
  3194         10  PAYDTBA PIC  X(0001).
  3195     05  PAYDTBI PIC  X(0008).
  3196*    -------------------------------
  3197     05  PAYTYPBL PIC S9(0004) COMP.
  3198     05  PAYTYPBF PIC  X(0001).
  3199     05  FILLER REDEFINES PAYTYPBF.
  3200         10  PAYTYPBA PIC  X(0001).
  3201     05  PAYTYPBI PIC  X(0015).
  3202*    -------------------------------
  3203     05  PAYAMTBL PIC S9(0004) COMP.
  3204     05  PAYAMTBF PIC  X(0001).
  3205     05  FILLER REDEFINES PAYAMTBF.
  3206         10  PAYAMTBA PIC  X(0001).
  3207     05  PAYAMTBI PIC  X(0011).
  3208*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  64
* EL156.cbl
  3209     05  LOANHBL PIC S9(0004) COMP.
  3210     05  LOANHBF PIC  X(0001).
  3211     05  FILLER REDEFINES LOANHBF.
  3212         10  LOANHBA PIC  X(0001).
  3213     05  LOANHBI PIC  X(0012).
  3214*    -------------------------------
  3215     05  LOANNBL PIC S9(0004) COMP.
  3216     05  LOANNBF PIC  X(0001).
  3217     05  FILLER REDEFINES LOANNBF.
  3218         10  LOANNBA PIC  X(0001).
  3219     05  LOANNBI PIC  X(0025).
  3220*    -------------------------------
  3221     05  CKNUMHDL PIC S9(0004) COMP.
  3222     05  CKNUMHDF PIC  X(0001).
  3223     05  FILLER REDEFINES CKNUMHDF.
  3224         10  CKNUMHDA PIC  X(0001).
  3225     05  CKNUMHDI PIC  X(0012).
  3226*    -------------------------------
  3227     05  CKNUMBL PIC S9(0004) COMP.
  3228     05  CKNUMBF PIC  X(0001).
  3229     05  FILLER REDEFINES CKNUMBF.
  3230         10  CKNUMBA PIC  X(0001).
  3231     05  CKNUMBI PIC  X(0007).
  3232*    -------------------------------
  3233     05  AGTHDGL PIC S9(0004) COMP.
  3234     05  AGTHDGF PIC  X(0001).
  3235     05  FILLER REDEFINES AGTHDGF.
  3236         10  AGTHDGA PIC  X(0001).
  3237     05  AGTHDGI PIC  X(0016).
  3238*    -------------------------------
  3239     05  NAMEBL PIC S9(0004) COMP.
  3240     05  NAMEBF PIC  X(0001).
  3241     05  FILLER REDEFINES NAMEBF.
  3242         10  NAMEBA PIC  X(0001).
  3243     05  NAMEBI PIC  X(0030).
  3244*    -------------------------------
  3245     05  NAMEB2L PIC S9(0004) COMP.
  3246     05  NAMEB2F PIC  X(0001).
  3247     05  FILLER REDEFINES NAMEB2F.
  3248         10  NAMEB2A PIC  X(0001).
  3249     05  NAMEB2I PIC  X(0030).
  3250*    -------------------------------
  3251     05  ADDR1BL PIC S9(0004) COMP.
  3252     05  ADDR1BF PIC  X(0001).
  3253     05  FILLER REDEFINES ADDR1BF.
  3254         10  ADDR1BA PIC  X(0001).
  3255     05  ADDR1BI PIC  X(0030).
  3256*    -------------------------------
  3257     05  ADDR1B2L PIC S9(0004) COMP.
  3258     05  ADDR1B2F PIC  X(0001).
  3259     05  FILLER REDEFINES ADDR1B2F.
  3260         10  ADDR1B2A PIC  X(0001).
  3261     05  ADDR1B2I PIC  X(0030).
  3262*    -------------------------------
  3263     05  ADDR2BL PIC S9(0004) COMP.
  3264     05  ADDR2BF PIC  X(0001).
  3265     05  FILLER REDEFINES ADDR2BF.
  3266         10  ADDR2BA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  65
* EL156.cbl
  3267     05  ADDR2BI PIC  X(0030).
  3268*    -------------------------------
  3269     05  ADDR2B2L PIC S9(0004) COMP.
  3270     05  ADDR2B2F PIC  X(0001).
  3271     05  FILLER REDEFINES ADDR2B2F.
  3272         10  ADDR2B2A PIC  X(0001).
  3273     05  ADDR2B2I PIC  X(0030).
  3274*    -------------------------------
  3275     05  CITYSTBL PIC S9(0004) COMP.
  3276     05  CITYSTBF PIC  X(0001).
  3277     05  FILLER REDEFINES CITYSTBF.
  3278         10  CITYSTBA PIC  X(0001).
  3279     05  CITYSTBI PIC  X(0030).
  3280*    -------------------------------
  3281     05  CITYST2L PIC S9(0004) COMP.
  3282     05  CITYST2F PIC  X(0001).
  3283     05  FILLER REDEFINES CITYST2F.
  3284         10  CITYST2A PIC  X(0001).
  3285     05  CITYST2I PIC  X(0030).
  3286*    -------------------------------
  3287     05  ZIPBL PIC S9(0004) COMP.
  3288     05  ZIPBF PIC  X(0001).
  3289     05  FILLER REDEFINES ZIPBF.
  3290         10  ZIPBA PIC  X(0001).
  3291     05  ZIPBI PIC  X(0009).
  3292*    -------------------------------
  3293     05  ZIPB2L PIC S9(0004) COMP.
  3294     05  ZIPB2F PIC  X(0001).
  3295     05  FILLER REDEFINES ZIPB2F.
  3296         10  ZIPB2A PIC  X(0001).
  3297     05  ZIPB2I PIC  X(0009).
  3298*    -------------------------------
  3299     05  INTHDBL PIC S9(0004) COMP.
  3300     05  INTHDBF PIC  X(0001).
  3301     05  FILLER REDEFINES INTHDBF.
  3302         10  INTHDBA PIC  X(0001).
  3303     05  INTHDBI PIC  X(0012).
  3304*    -------------------------------
  3305     05  INTAMTBL PIC S9(0004) COMP.
  3306     05  INTAMTBF PIC  X(0001).
  3307     05  FILLER REDEFINES INTAMTBF.
  3308         10  INTAMTBA PIC  X(0001).
  3309     05  INTAMTBI PIC  X(0011).
  3310*    -------------------------------
  3311     05  PMTHDGBL PIC S9(0004) COMP.
  3312     05  PMTHDGBF PIC  X(0001).
  3313     05  FILLER REDEFINES PMTHDGBF.
  3314         10  PMTHDGBA PIC  X(0001).
  3315     05  PMTHDGBI PIC  X(0034).
  3316*    -------------------------------
  3317     05  CLMNOBL PIC S9(0004) COMP.
  3318     05  CLMNOBF PIC  X(0001).
  3319     05  FILLER REDEFINES CLMNOBF.
  3320         10  CLMNOBA PIC  X(0001).
  3321     05  CLMNOBI PIC  X(0007).
  3322*    -------------------------------
  3323     05  CARRBL PIC S9(0004) COMP.
  3324     05  CARRBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  66
* EL156.cbl
  3325     05  FILLER REDEFINES CARRBF.
  3326         10  CARRBA PIC  X(0001).
  3327     05  CARRBI PIC  X(0001).
  3328*    -------------------------------
  3329     05  CERTNOBL PIC S9(0004) COMP.
  3330     05  CERTNOBF PIC  X(0001).
  3331     05  FILLER REDEFINES CERTNOBF.
  3332         10  CERTNOBA PIC  X(0001).
  3333     05  CERTNOBI PIC  X(0010).
  3334*    -------------------------------
  3335     05  SUFXBL PIC S9(0004) COMP.
  3336     05  SUFXBF PIC  X(0001).
  3337     05  FILLER REDEFINES SUFXBF.
  3338         10  SUFXBA PIC  X(0001).
  3339     05  SUFXBI PIC  X(0001).
  3340*    -------------------------------
  3341     05  CLMTYPBL PIC S9(0004) COMP.
  3342     05  CLMTYPBF PIC  X(0001).
  3343     05  FILLER REDEFINES CLMTYPBF.
  3344         10  CLMTYPBA PIC  X(0001).
  3345     05  CLMTYPBI PIC  X(0006).
  3346*    -------------------------------
  3347     05  INCURBL PIC S9(0004) COMP.
  3348     05  INCURBF PIC  X(0001).
  3349     05  FILLER REDEFINES INCURBF.
  3350         10  INCURBA PIC  X(0001).
  3351     05  INCURBI PIC  X(0008).
  3352*    -------------------------------
  3353     05  PYFROMBL PIC S9(0004) COMP.
  3354     05  PYFROMBF PIC  X(0001).
  3355     05  FILLER REDEFINES PYFROMBF.
  3356         10  PYFROMBA PIC  X(0001).
  3357     05  PYFROMBI PIC  X(0008).
  3358*    -------------------------------
  3359     05  PYTHRUBL PIC S9(0004) COMP.
  3360     05  PYTHRUBF PIC  X(0001).
  3361     05  FILLER REDEFINES PYTHRUBF.
  3362         10  PYTHRUBA PIC  X(0001).
  3363     05  PYTHRUBI PIC  X(0008).
  3364*    -------------------------------
  3365     05  DAYSBL PIC S9(0004) COMP.
  3366     05  DAYSBF PIC  X(0001).
  3367     05  FILLER REDEFINES DAYSBF.
  3368         10  DAYSBA PIC  X(0001).
  3369     05  DAYSBI PIC  X(0005).
  3370*    -------------------------------
  3371     05  BYBL PIC S9(0004) COMP.
  3372     05  BYBF PIC  X(0001).
  3373     05  FILLER REDEFINES BYBF.
  3374         10  BYBA PIC  X(0001).
  3375     05  BYBI PIC  X(0004).
  3376*    -------------------------------
  3377     05  PROOFDBL PIC S9(0004) COMP.
  3378     05  PROOFDBF PIC  X(0001).
  3379     05  FILLER REDEFINES PROOFDBF.
  3380         10  PROOFDBA PIC  X(0001).
  3381     05  PROOFDBI PIC  X(0008).
  3382*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  67
* EL156.cbl
  3383     05  ACCTBL PIC S9(0004) COMP.
  3384     05  ACCTBF PIC  X(0001).
  3385     05  FILLER REDEFINES ACCTBF.
  3386         10  ACCTBA PIC  X(0001).
  3387     05  ACCTBI PIC  X(0010).
  3388*    -------------------------------
  3389     05  STATEBL PIC S9(0004) COMP.
  3390     05  STATEBF PIC  X(0001).
  3391     05  FILLER REDEFINES STATEBF.
  3392         10  STATEBA PIC  X(0001).
  3393     05  STATEBI PIC  X(0002).
  3394*    -------------------------------
  3395     05  GROUPBL PIC S9(0004) COMP.
  3396     05  GROUPBF PIC  X(0001).
  3397     05  FILLER REDEFINES GROUPBF.
  3398         10  GROUPBA PIC  X(0001).
  3399     05  GROUPBI PIC  X(0006).
  3400*    -------------------------------
  3401     05  ACARRBL PIC S9(0004) COMP.
  3402     05  ACARRBF PIC  X(0001).
  3403     05  FILLER REDEFINES ACARRBF.
  3404         10  ACARRBA PIC  X(0001).
  3405     05  ACARRBI PIC  X(0001).
  3406*    -------------------------------
  3407     05  ACCTNMBL PIC S9(0004) COMP.
  3408     05  ACCTNMBF PIC  X(0001).
  3409     05  FILLER REDEFINES ACCTNMBF.
  3410         10  ACCTNMBA PIC  X(0001).
  3411     05  ACCTNMBI PIC  X(0030).
  3412*    -------------------------------
  3413     05  UNDISBL PIC S9(0004) COMP.
  3414     05  UNDISBF PIC  X(0001).
  3415     05  FILLER REDEFINES UNDISBF.
  3416         10  UNDISBA PIC  X(0001).
  3417     05  UNDISBI PIC  X(0010).
  3418*    -------------------------------
  3419     05  RATEBL PIC S9(0004) COMP.
  3420     05  RATEBF PIC  X(0001).
  3421     05  FILLER REDEFINES RATEBF.
  3422         10  RATEBA PIC  X(0001).
  3423     05  RATEBI PIC  X(0006).
  3424*    -------------------------------
  3425     05  ERMSG1BL PIC S9(0004) COMP.
  3426     05  ERMSG1BF PIC  X(0001).
  3427     05  FILLER REDEFINES ERMSG1BF.
  3428         10  ERMSG1BA PIC  X(0001).
  3429     05  ERMSG1BI PIC  X(0072).
  3430*    -------------------------------
  3431     05  ENTPFBL PIC S9(0004) COMP.
  3432     05  ENTPFBF PIC  X(0001).
  3433     05  FILLER REDEFINES ENTPFBF.
  3434         10  ENTPFBA PIC  X(0001).
  3435     05  ENTPFBI PIC  99.
  3436 01  EL156BO REDEFINES EL156AI.
  3437     05  FILLER            PIC  X(0012).
  3438*    -------------------------------
  3439     05  FILLER            PIC  X(0003).
  3440     05  RUNDTEBO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  68
* EL156.cbl
  3441*    -------------------------------
  3442     05  FILLER            PIC  X(0003).
  3443     05  RUNTIMBO PIC  99.99.
  3444*    -------------------------------
  3445     05  FILLER            PIC  X(0003).
  3446     05  PAYDTBO PIC  99B99B99.
  3447*    -------------------------------
  3448     05  FILLER            PIC  X(0003).
  3449     05  PAYTYPBO PIC  X(0015).
  3450*    -------------------------------
  3451     05  FILLER            PIC  X(0003).
  3452     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3453*    -------------------------------
  3454     05  FILLER            PIC  X(0003).
  3455     05  LOANHBO PIC  X(0012).
  3456*    -------------------------------
  3457     05  FILLER            PIC  X(0003).
  3458     05  LOANNBO PIC  X(0025).
  3459*    -------------------------------
  3460     05  FILLER            PIC  X(0003).
  3461     05  CKNUMHDO PIC  X(0012).
  3462*    -------------------------------
  3463     05  FILLER            PIC  X(0003).
  3464     05  CKNUMBO PIC  X(0007).
  3465*    -------------------------------
  3466     05  FILLER            PIC  X(0003).
  3467     05  AGTHDGO PIC  X(0016).
  3468*    -------------------------------
  3469     05  FILLER            PIC  X(0003).
  3470     05  NAMEBO PIC  X(0030).
  3471*    -------------------------------
  3472     05  FILLER            PIC  X(0003).
  3473     05  NAMEB2O PIC  X(0030).
  3474*    -------------------------------
  3475     05  FILLER            PIC  X(0003).
  3476     05  ADDR1BO PIC  X(0030).
  3477*    -------------------------------
  3478     05  FILLER            PIC  X(0003).
  3479     05  ADDR1B2O PIC  X(0030).
  3480*    -------------------------------
  3481     05  FILLER            PIC  X(0003).
  3482     05  ADDR2BO PIC  X(0030).
  3483*    -------------------------------
  3484     05  FILLER            PIC  X(0003).
  3485     05  ADDR2B2O PIC  X(0030).
  3486*    -------------------------------
  3487     05  FILLER            PIC  X(0003).
  3488     05  CITYSTBO PIC  X(0030).
  3489*    -------------------------------
  3490     05  FILLER            PIC  X(0003).
  3491     05  CITYST2O PIC  X(0030).
  3492*    -------------------------------
  3493     05  FILLER            PIC  X(0003).
  3494     05  ZIPBO PIC  ZZZZ99999.
  3495*    -------------------------------
  3496     05  FILLER            PIC  X(0003).
  3497     05  ZIPB2O PIC  ZZZZZZZZZ.
  3498*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  69
* EL156.cbl
  3499     05  FILLER            PIC  X(0003).
  3500     05  INTHDBO PIC  X(0012).
  3501*    -------------------------------
  3502     05  FILLER            PIC  X(0003).
  3503     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3504*    -------------------------------
  3505     05  FILLER            PIC  X(0003).
  3506     05  PMTHDGBO PIC  X(0034).
  3507*    -------------------------------
  3508     05  FILLER            PIC  X(0003).
  3509     05  CLMNOBO PIC  X(0007).
  3510*    -------------------------------
  3511     05  FILLER            PIC  X(0003).
  3512     05  CARRBO PIC  X(0001).
  3513*    -------------------------------
  3514     05  FILLER            PIC  X(0003).
  3515     05  CERTNOBO PIC  X(0010).
  3516*    -------------------------------
  3517     05  FILLER            PIC  X(0003).
  3518     05  SUFXBO PIC  X(0001).
  3519*    -------------------------------
  3520     05  FILLER            PIC  X(0003).
  3521     05  CLMTYPBO PIC  X(0006).
  3522*    -------------------------------
  3523     05  FILLER            PIC  X(0003).
  3524     05  INCURBO PIC  X(0008).
  3525*    -------------------------------
  3526     05  FILLER            PIC  X(0003).
  3527     05  PYFROMBO PIC  99B99B99.
  3528*    -------------------------------
  3529     05  FILLER            PIC  X(0003).
  3530     05  PYTHRUBO PIC  99B99B99.
  3531*    -------------------------------
  3532     05  FILLER            PIC  X(0003).
  3533     05  DAYSBO PIC  X(0005).
  3534*    -------------------------------
  3535     05  FILLER            PIC  X(0003).
  3536     05  BYBO PIC  X(0004).
  3537*    -------------------------------
  3538     05  FILLER            PIC  X(0003).
  3539     05  PROOFDBO PIC  99B99B99.
  3540*    -------------------------------
  3541     05  FILLER            PIC  X(0003).
  3542     05  ACCTBO PIC  X(0010).
  3543*    -------------------------------
  3544     05  FILLER            PIC  X(0003).
  3545     05  STATEBO PIC  X(0002).
  3546*    -------------------------------
  3547     05  FILLER            PIC  X(0003).
  3548     05  GROUPBO PIC  X(0006).
  3549*    -------------------------------
  3550     05  FILLER            PIC  X(0003).
  3551     05  ACARRBO PIC  X(0001).
  3552*    -------------------------------
  3553     05  FILLER            PIC  X(0003).
  3554     05  ACCTNMBO PIC  X(0030).
  3555*    -------------------------------
  3556     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  70
* EL156.cbl
  3557     05  UNDISBO PIC  ZZZ,Z99.99.
  3558*    -------------------------------
  3559     05  FILLER            PIC  X(0003).
  3560     05  RATEBO PIC  ZZZ.99.
  3561*    -------------------------------
  3562     05  FILLER            PIC  X(0003).
  3563     05  ERMSG1BO PIC  X(0072).
  3564*    -------------------------------
  3565     05  FILLER            PIC  X(0003).
  3566     05  ENTPFBO PIC  X(0002).
  3567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  71
* EL156.cbl
  3569****************************************************************
  3570*
  3571* Copyright (c) 2007 by Clerity Solutions, Inc.
  3572* All rights reserved.
  3573*
  3574****************************************************************
  3575 01  DFHEIV.
  3576   02  DFHEIV0               PIC X(35).
  3577   02  DFHEIV1               PIC X(08).
  3578   02  DFHEIV2               PIC X(08).
  3579   02  DFHEIV3               PIC X(08).
  3580   02  DFHEIV4               PIC X(06).
  3581   02  DFHEIV5               PIC X(04).
  3582   02  DFHEIV6               PIC X(04).
  3583   02  DFHEIV7               PIC X(02).
  3584   02  DFHEIV8               PIC X(02).
  3585   02  DFHEIV9               PIC X(01).
  3586   02  DFHEIV10              PIC S9(7) COMP-3.
  3587   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3588   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3589   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3590   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3591   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3592   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3593   02  DFHEIV17              PIC X(04).
  3594   02  DFHEIV18              PIC X(04).
  3595   02  DFHEIV19              PIC X(04).
  3596   02  DFHEIV20              USAGE IS POINTER.
  3597   02  DFHEIV21              USAGE IS POINTER.
  3598   02  DFHEIV22              USAGE IS POINTER.
  3599   02  DFHEIV23              USAGE IS POINTER.
  3600   02  DFHEIV24              USAGE IS POINTER.
  3601   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3602   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3603   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3604   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3605   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3606   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3607   02  FILLER                PIC X(02).
  3608   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3609   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3610   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3611   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3612   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3613 LINKAGE  SECTION.
  3614*****************************************************************
  3615*                                                               *
  3616* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3617* All rights reserved.                                          *
  3618*                                                               *
  3619*****************************************************************
  3620 01  dfheiblk.
  3621     02  eibtime          pic s9(7) comp-3.
  3622     02  eibdate          pic s9(7) comp-3.
  3623     02  eibtrnid         pic x(4).
  3624     02  eibtaskn         pic s9(7) comp-3.
  3625     02  eibtrmid         pic x(4).
  3626     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  72
* EL156.cbl
  3627     02  eibcposn         pic s9(4) comp.
  3628     02  eibcalen         pic s9(4) comp.
  3629     02  eibaid           pic x(1).
  3630     02  eibfiller1       pic x(1).
  3631     02  eibfn            pic x(2).
  3632     02  eibfiller2       pic x(2).
  3633     02  eibrcode         pic x(6).
  3634     02  eibfiller3       pic x(2).
  3635     02  eibds            pic x(8).
  3636     02  eibreqid         pic x(8).
  3637     02  eibrsrce         pic x(8).
  3638     02  eibsync          pic x(1).
  3639     02  eibfree          pic x(1).
  3640     02  eibrecv          pic x(1).
  3641     02  eibsend          pic x(1).
  3642     02  eibatt           pic x(1).
  3643     02  eibeoc           pic x(1).
  3644     02  eibfmh           pic x(1).
  3645     02  eibcompl         pic x(1).
  3646     02  eibsig           pic x(1).
  3647     02  eibconf          pic x(1).
  3648     02  eiberr           pic x(1).
  3649     02  eibrldbk         pic x(1).
  3650     02  eiberrcd         pic x(4).
  3651     02  eibsynrb         pic x(1).
  3652     02  eibnodat         pic x(1).
  3653     02  eibfiller5       pic x(2).
  3654     02  eibresp          pic 9(09) comp.
  3655     02  eibresp2         pic 9(09) comp.
  3656     02  dfheigdj         pic s9(4) comp.
  3657     02  dfheigdk         pic s9(4) comp.
  3658 01  DFHCOMMAREA             PIC X(1024).
  3659
  3660*    COPY ELCMSTR.
  3661******************************************************************
  3662*                                                                *
  3663*                            ELCMSTR.                            *
  3664*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3665*                            VMOD=2.012                          *
  3666*                                                                *
  3667*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3668*                                                                *
  3669*   FILE TYPE = VSAM,KSDS                                        *
  3670*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3671*                                                                *
  3672*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3673*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3674*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3675*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3676*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3677*                                                 RKP=75,LEN=21  *
  3678*                                                                *
  3679*   **** NOTE ****                                               *
  3680*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3681*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3682*                                                                *
  3683*   LOG = YES                                                    *
  3684*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  73
* EL156.cbl
  3685******************************************************************
  3686*                   C H A N G E   L O G
  3687*
  3688* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3689*-----------------------------------------------------------------
  3690*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3691* EFFECTIVE    NUMBER
  3692*-----------------------------------------------------------------
  3693* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3694* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3695******************************************************************
  3696 01  CLAIM-MASTER.
  3697     12  CL-RECORD-ID                PIC XX.
  3698         88  VALID-CL-ID         VALUE 'CL'.
  3699
  3700     12  CL-CONTROL-PRIMARY.
  3701         16  CL-COMPANY-CD           PIC X.
  3702         16  CL-CARRIER              PIC X.
  3703         16  CL-CLAIM-NO             PIC X(7).
  3704         16  CL-CERT-NO.
  3705             20  CL-CERT-PRIME       PIC X(10).
  3706             20  CL-CERT-SFX         PIC X.
  3707
  3708     12  CL-CONTROL-BY-NAME.
  3709         16  CL-COMPANY-CD-A1        PIC X.
  3710         16  CL-INSURED-LAST-NAME    PIC X(15).
  3711         16  CL-INSURED-NAME.
  3712             20  CL-INSURED-1ST-NAME PIC X(12).
  3713             20  CL-INSURED-MID-INIT PIC X.
  3714
  3715     12  CL-CONTROL-BY-SSN.
  3716         16  CL-COMPANY-CD-A2        PIC X.
  3717         16  CL-SOC-SEC-NO.
  3718             20  CL-SSN-STATE        PIC XX.
  3719             20  CL-SSN-ACCOUNT      PIC X(6).
  3720             20  CL-SSN-LN3          PIC X(3).
  3721
  3722     12  CL-CONTROL-BY-CERT-NO.
  3723         16  CL-COMPANY-CD-A4        PIC X.
  3724         16  CL-CERT-NO-A4.
  3725             20  CL-CERT-A4-PRIME    PIC X(10).
  3726             20  CL-CERT-A4-SFX      PIC X.
  3727
  3728     12  CL-CONTROL-BY-CCN.
  3729         16  CL-COMPANY-CD-A5        PIC X.
  3730         16  CL-CCN-A5.
  3731             20  CL-CCN.
  3732                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3733                 24  CL-CCN-PRIME-A5 PIC X(12).
  3734             20  CL-CCN-FILLER-A5    PIC X(4).
  3735
  3736     12  CL-INSURED-PROFILE-DATA.
  3737         16  CL-INSURED-BIRTH-DT     PIC XX.
  3738         16  CL-INSURED-SEX-CD       PIC X.
  3739             88  INSURED-IS-MALE        VALUE 'M'.
  3740             88  INSURED-IS-FEMALE      VALUE 'F'.
  3741             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3742         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  74
* EL156.cbl
  3743         16  FILLER                  PIC X(5).
  3744
  3745     12  CL-PROCESSING-INFO.
  3746         16  CL-PROCESSOR-ID         PIC X(4).
  3747         16  CL-CLAIM-STATUS         PIC X.
  3748             88  CLAIM-IS-OPEN          VALUE 'O'.
  3749             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3750         16  CL-CLAIM-TYPE           PIC X.
  3751*            88  AH-CLAIM               VALUE 'A'.
  3752*            88  LIFE-CLAIM             VALUE 'L'.
  3753*            88  PROPERTY-CLAIM         VALUE 'P'.
  3754*            88  IUI-CLAIM              VALUE 'I'.
  3755*            88  GAP-CLAIM              VALUE 'G'.
  3756         16  CL-CLAIM-PREM-TYPE      PIC X.
  3757             88  SINGLE-PREMIUM         VALUE '1'.
  3758             88  O-B-COVERAGE           VALUE '2'.
  3759             88  OPEN-END-COVERAGE      VALUE '3'.
  3760         16  CL-INCURRED-DT          PIC XX.
  3761         16  CL-REPORTED-DT          PIC XX.
  3762         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3763         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3764         16  CL-LAST-PMT-DT          PIC XX.
  3765         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3766         16  CL-PAID-THRU-DT         PIC XX.
  3767         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3768         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3769         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3770         16  CL-PMT-CALC-METHOD      PIC X.
  3771             88  CL-360-DAY-YR          VALUE '1'.
  3772             88  CL-365-DAY-YR          VALUE '2'.
  3773             88  CL-FULL-MONTHS         VALUE '3'.
  3774         16  CL-CAUSE-CD             PIC X(6).
  3775
  3776         16  CL-PRIME-CERT-NO.
  3777             20  CL-PRIME-CERT-PRIME PIC X(10).
  3778             20  CL-PRIME-CERT-SFX   PIC X.
  3779
  3780         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3781             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3782             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3783
  3784         16  CL-MICROFILM-NO         PIC X(10).
  3785         16  CL-PROG-FORM-TYPE       PIC X.
  3786         16  CL-LAST-ADD-ON-DT       PIC XX.
  3787
  3788         16  CL-LAST-REOPEN-DT       PIC XX.
  3789         16  CL-LAST-CLOSE-DT        PIC XX.
  3790         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3791             88  FINAL-PAID             VALUE '1'.
  3792             88  CLAIM-DENIED           VALUE '2'.
  3793             88  AUTO-CLOSE             VALUE '3'.
  3794             88  MANUAL-CLOSE           VALUE '4'.
  3795             88  BENEFITS-CHANGED       VALUE 'C'.
  3796             88  SETUP-ERRORS           VALUE 'E'.
  3797         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3798         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3799         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3800             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  75
* EL156.cbl
  3801         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3802         16  FILLER                  PIC X.
  3803
  3804     12  CL-CERTIFICATE-DATA.
  3805         16  CL-CERT-ORIGIN          PIC X.
  3806             88  CERT-WAS-ONLINE        VALUE '1'.
  3807             88  CERT-WAS-CREATED       VALUE '2'.
  3808             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3809         16  CL-CERT-KEY-DATA.
  3810             20  CL-CERT-CARRIER     PIC X.
  3811             20  CL-CERT-GROUPING    PIC X(6).
  3812             20  CL-CERT-STATE       PIC XX.
  3813             20  CL-CERT-ACCOUNT.
  3814                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3815                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3816             20  CL-CERT-EFF-DT      PIC XX.
  3817
  3818     12  CL-STATUS-CONTROLS.
  3819         16  CL-PRIORITY-CD          PIC X.
  3820             88  CONFIDENTIAL-DATA      VALUE '8'.
  3821             88  HIGHEST-PRIORITY       VALUE '9'.
  3822         16  CL-SUPV-ATTN-CD         PIC X.
  3823             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3824             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3825         16  CL-PURGED-DT            PIC XX.
  3826         16  CL-RESTORED-DT          PIC XX.
  3827         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3828         16  CL-NEXT-RESEND-DT       PIC XX.
  3829         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3830         16  FILLER                  PIC XX.
  3831         16  CL-LAST-MAINT-DT        PIC XX.
  3832         16  CL-LAST-MAINT-USER      PIC X(4).
  3833         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3834         16  CL-LAST-MAINT-TYPE      PIC X.
  3835             88  CLAIM-SET-UP           VALUE ' '.
  3836             88  PAYMENT-MADE           VALUE '1'.
  3837             88  LETTER-SENT            VALUE '2'.
  3838             88  MASTER-WAS-ALTERED     VALUE '3'.
  3839             88  MASTER-WAS-RESTORED    VALUE '4'.
  3840             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3841             88  FILE-CONVERTED         VALUE '6'.
  3842             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3843             88  ERROR-CORRECTION       VALUE 'E'.
  3844         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3845         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3846         16  CL-BENEFICIARY          PIC X(10).
  3847         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3848         16  CL-DENIAL-TYPE          PIC X.
  3849             88  CL-TYPE-DENIAL          VALUE '1'.
  3850             88  CL-TYPE-RESCISSION      VALUE '2'.
  3851             88  CL-TYPE-REFORMATION     VALUE '3'.
  3852             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3853             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3854         16  FILLER                  PIC X(5).
  3855
  3856     12  CL-TRAILER-CONTROLS.
  3857         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3858             88  CL-1ST-TRL-AVAIL       VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  76
* EL156.cbl
  3859             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3860             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3861         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3862         16  FILLER                  PIC XX.
  3863         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3864         16  CL-ADDRESS-TRAILER-CNT.
  3865             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3866                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3867             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3868                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3869             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3870                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3871             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3872                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3873             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3874                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3875             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3876                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3877             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3878                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3879
  3880     12  CL-CV-REFERENCE-NO.
  3881         16  CL-CV-REFNO-PRIME       PIC X(18).
  3882         16  CL-CV-REFNO-SFX         PIC XX.
  3883
  3884     12  CL-FILE-LOCATION            PIC X(4).
  3885
  3886     12  CL-PROCESS-ERRORS.
  3887         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3888             88  NO-FATAL-ERRORS        VALUE ZERO.
  3889         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3890             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3891
  3892     12  CL-PRODUCT-CD               PIC X.
  3893
  3894     12  CL-CURRENT-KEY-DATA.
  3895         16  CL-CURRENT-CARRIER      PIC X.
  3896         16  CL-CURRENT-GROUPING     PIC X(6).
  3897         16  CL-CURRENT-STATE        PIC XX.
  3898         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3899
  3900     12  CL-ASSOCIATES               PIC X.
  3901         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3902         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3903         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3904         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3905
  3906     12  CL-ACTIVITY-CODE            PIC 99.
  3907     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3908     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3909
  3910     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3911     12  CL-LAG-REPORT-CODE          PIC 9.
  3912     12  CL-LOAN-TYPE                PIC XX.
  3913     12  CL-LEGAL-STATE              PIC XX.
  3914
  3915*    12  FILLER                      PIC X(5).
  3916     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  77
* EL156.cbl
  3917     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  78
* EL156.cbl
  3919*    COPY ELCCNTL.
  3920******************************************************************
  3921*                                                                *
  3922*                                                                *
  3923*                            ELCCNTL.                            *
  3924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3925*                            VMOD=2.059                          *
  3926*                                                                *
  3927*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3928*                                                                *
  3929*   FILE TYPE = VSAM,KSDS                                        *
  3930*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3931*                                                                *
  3932*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3933*       ALTERNATE INDEX = NONE                                   *
  3934*                                                                *
  3935*   LOG = YES                                                    *
  3936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3937******************************************************************
  3938*                   C H A N G E   L O G
  3939*
  3940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3941*-----------------------------------------------------------------
  3942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3943* EFFECTIVE    NUMBER
  3944*-----------------------------------------------------------------
  3945* 082503                   PEMA  ADD BENEFIT GROUP
  3946* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3947* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3948* 092705    2005050300006  PEMA  ADD SPP LEASES
  3949* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3950* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3951* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3952* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3953* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3954******************************************************************
  3955*
  3956 01  CONTROL-FILE.
  3957     12  CF-RECORD-ID                       PIC XX.
  3958         88  VALID-CF-ID                        VALUE 'CF'.
  3959
  3960     12  CF-CONTROL-PRIMARY.
  3961         16  CF-COMPANY-ID                  PIC XXX.
  3962         16  CF-RECORD-TYPE                 PIC X.
  3963             88  CF-COMPANY-MASTER              VALUE '1'.
  3964             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3965             88  CF-STATE-MASTER                VALUE '3'.
  3966             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3967             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3968             88  CF-CARRIER-MASTER              VALUE '6'.
  3969             88  CF-MORTALITY-MASTER            VALUE '7'.
  3970             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3971             88  CF-TERMINAL-MASTER             VALUE '9'.
  3972             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3973             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3974             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3975             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3976             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  79
* EL156.cbl
  3977             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3978             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3979             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3980             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3981         16  CF-ACCESS-CD-GENL              PIC X(4).
  3982         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3983             20  CF-PROCESSOR               PIC X(4).
  3984         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3985             20  CF-STATE-CODE              PIC XX.
  3986             20  FILLER                     PIC XX.
  3987         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3988             20  FILLER                     PIC XX.
  3989             20  CF-HI-BEN-IN-REC           PIC XX.
  3990         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3991             20  FILLER                     PIC XXX.
  3992             20  CF-CARRIER-CNTL            PIC X.
  3993         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3994             20  FILLER                     PIC XX.
  3995             20  CF-HI-TYPE-IN-REC          PIC 99.
  3996         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3997             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3998                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3999             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4000             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4001         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4002             20  FILLER                     PIC X.
  4003             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4004         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4005             20  FILLER                     PIC XX.
  4006             20  CF-MORTGAGE-PLAN           PIC XX.
  4007         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4008
  4009     12  CF-LAST-MAINT-DT                   PIC XX.
  4010     12  CF-LAST-MAINT-BY                   PIC X(4).
  4011     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4012
  4013     12  CF-RECORD-BODY                     PIC X(728).
  4014
  4015
  4016****************************************************************
  4017*             COMPANY MASTER RECORD                            *
  4018****************************************************************
  4019
  4020     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4021         16  CF-COMPANY-ADDRESS.
  4022             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4023             20  CF-CL-IN-CARE-OF           PIC X(30).
  4024             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4025             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4026             20  CF-CL-CITY-STATE           PIC X(30).
  4027             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4028             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4029         16  CF-COMPANY-CD                  PIC X.
  4030         16  CF-COMPANY-PASSWORD            PIC X(8).
  4031         16  CF-SECURITY-OPTION             PIC X.
  4032             88  ALL-SECURITY                   VALUE '1'.
  4033             88  COMPANY-VERIFY                 VALUE '2'.
  4034             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  80
* EL156.cbl
  4035             88  NO-SECURITY                    VALUE '4'.
  4036             88  ALL-BUT-TERM                   VALUE '5'.
  4037         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4038             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4039         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4040             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4041         16  CF-INFORCE-LOCATION            PIC X.
  4042             88  CERTS-ARE-ONLINE               VALUE '1'.
  4043             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4044             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4045         16  CF-LOWER-CASE-LETTERS          PIC X.
  4046         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4047             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4048             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4049             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4050             88  CF-ACCNT-CNTL                  VALUE '3'.
  4051             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4052
  4053         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4054         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4055
  4056         16  CF-LGX-CREDIT-USER             PIC X.
  4057             88  CO-IS-NOT-USER                 VALUE 'N'.
  4058             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4059
  4060         16 CF-CREDIT-CALC-CODES.
  4061             20  CF-CR-REM-TERM-CALC PIC X.
  4062               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4063               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4064               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4065               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4066               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4067               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4068               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4069             20  CF-CR-R78-METHOD           PIC X.
  4070               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4071               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4072
  4073         16  CF-CLAIM-CONTROL-COUNTS.
  4074             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4075                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4076
  4077             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4078                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4079
  4080             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4081                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4082
  4083             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4084                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4085
  4086         16  CF-CURRENT-MONTH-END           PIC XX.
  4087
  4088         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4089             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4090             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4091             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4092             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  81
* EL156.cbl
  4093                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4094                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4095             20  CF-CO-PREM-REJECT-SW       PIC X.
  4096                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4097                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4098             20  CF-CO-REF-REJECT-SW        PIC X.
  4099                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4100                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4101
  4102         16  CF-CO-REPORTING-DT             PIC XX.
  4103         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4104         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4105           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4106           88  CF-CO-MONTH-END                  VALUE '1'.
  4107
  4108         16  CF-LGX-CLAIM-USER              PIC X.
  4109             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4110             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4111
  4112         16  CF-CREDIT-EDIT-CONTROLS.
  4113             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4114             20  CF-MIN-AGE                 PIC 99.
  4115             20  CF-DEFAULT-AGE             PIC 99.
  4116             20  CF-MIN-TERM                PIC S999      COMP-3.
  4117             20  CF-MAX-TERM                PIC S999      COMP-3.
  4118             20  CF-DEFAULT-SEX             PIC X.
  4119             20  CF-JOINT-AGE-INPUT         PIC X.
  4120                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4121             20  CF-BIRTH-DATE-INPUT        PIC X.
  4122                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4123             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4124                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4125                 88  CF-ZERO-CARRIER            VALUE '1'.
  4126                 88  CF-ZERO-GROUPING           VALUE '2'.
  4127                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4128             20  CF-EDIT-SW                 PIC X.
  4129                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4130             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4131             20  CF-CR-PR-METHOD            PIC X.
  4132               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4133               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4134             20  FILLER                     PIC X.
  4135
  4136         16  CF-CREDIT-MISC-CONTROLS.
  4137             20  CF-REIN-TABLE-SW           PIC X.
  4138                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4139             20  CF-COMP-TABLE-SW           PIC X.
  4140                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4141             20  CF-EXPERIENCE-RETENTION-AGE
  4142                                            PIC S9        COMP-3.
  4143             20  CF-CONVERSION-DT           PIC XX.
  4144             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4145             20  CF-RUN-FREQUENCY-SW        PIC X.
  4146                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4147                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4148
  4149             20  CF-CR-CHECK-NO-CONTROL.
  4150                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  82
* EL156.cbl
  4151                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4152                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4153                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4154                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4155                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4156
  4157                 24  CF-CR-CHECK-COUNT       REDEFINES
  4158                     CF-CR-CHECK-COUNTER      PIC X(4).
  4159
  4160                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4161                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4162
  4163                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4164                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4165                 24  CF-MAIL-PROCESSING       PIC X.
  4166                     88  MAIL-PROCESSING          VALUE 'Y'.
  4167
  4168         16  CF-MISC-SYSTEM-CONTROL.
  4169             20  CF-SYSTEM-C                 PIC X.
  4170                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4171             20  CF-SYSTEM-D                 PIC X.
  4172                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4173             20  CF-SOC-SEC-NO-SW            PIC X.
  4174                 88  SOC-SEC-NO-USED             VALUE '1'.
  4175             20  CF-MEMBER-NO-SW             PIC X.
  4176                 88  MEMBER-NO-USED              VALUE '1'.
  4177             20  CF-TAX-ID-NUMBER            PIC X(11).
  4178             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4179             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4180                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4181                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4182                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4183                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4184             20  CF-SYSTEM-E                 PIC X.
  4185                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4186
  4187         16  CF-LGX-LIFE-USER               PIC X.
  4188             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4189             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4190
  4191         16  CF-CR-MONTH-END-DT             PIC XX.
  4192
  4193         16  CF-FILE-MAINT-DATES.
  4194             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4195                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4196             20  CF-LAST-BATCH       REDEFINES
  4197                 CF-LAST-BATCH-NO               PIC X(4).
  4198             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4199             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4200             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4201             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4202             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4203             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4204             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4205             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4206             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4207             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4208
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  83
* EL156.cbl
  4209         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4210         16  FILLER                         PIC X.
  4211
  4212         16  CF-ALT-MORT-CODE               PIC X(4).
  4213         16  CF-MEMBER-CAPTION              PIC X(10).
  4214
  4215         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4216             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4217             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4218             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4219             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4220             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4221
  4222         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4223
  4224         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4225         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4226         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4227         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4228
  4229         16  CF-AH-OVERRIDE-L1              PIC X.
  4230         16  CF-AH-OVERRIDE-L2              PIC XX.
  4231         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4232         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4233
  4234         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4235         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4236
  4237         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4238         16  CF-AR-LAST-EL860-DT            PIC XX.
  4239         16  CF-MP-MONTH-END-DT             PIC XX.
  4240
  4241         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4242         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4243             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4244
  4245         16  CF-AR-MONTH-END-DT             PIC XX.
  4246
  4247         16  CF-CRDTCRD-USER                PIC X.
  4248             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4249             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4250
  4251         16  CF-CC-MONTH-END-DT             PIC XX.
  4252
  4253         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4254
  4255         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4256             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4257             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4258             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4259         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4260         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4261         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4262         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4263             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4264             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4265         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4266         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  84
* EL156.cbl
  4267         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4268             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4269         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4270
  4271         16  CF-CL-ZIP-CODE.
  4272             20  CF-CL-ZIP-PRIME.
  4273                 24  CF-CL-ZIP-1ST          PIC X.
  4274                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4275                 24  FILLER                 PIC X(4).
  4276             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4277         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4278             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4279             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4280             20  FILLER                     PIC XXX.
  4281
  4282         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4283         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4284         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4285         16  CF-CO-OPTION-START-DATE        PIC XX.
  4286         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4287           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4288                                                      '3' '4'.
  4289           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4290           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4291           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4292           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4293           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4294           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4295
  4296         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4297
  4298         16  CF-PAYMENT-APPROVAL-LEVELS.
  4299             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4300             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4301             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4302             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4303             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4304             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4305
  4306         16  CF-END-USER-REPORTING-USER     PIC X.
  4307             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4308             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4309
  4310         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4311             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4312             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4313
  4314         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4315
  4316         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4317         16  FILLER                         PIC X.
  4318
  4319         16  CF-CREDIT-ARCHIVE-CNTL.
  4320             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4321             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4322             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4323
  4324         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  85
* EL156.cbl
  4325
  4326         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4327             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4328             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4329
  4330         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4331             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4332             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4333
  4334         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4335
  4336         16  CF-CO-ACH-ID-CODE              PIC  X.
  4337             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4338             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4339             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4340         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4341         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4342         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4343         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4344         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4345         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4346         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4347         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4348         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4349                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4350         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4351                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4352
  4353         16  CF-CO-OVER-SHORT.
  4354             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4355             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4356
  4357*         16  FILLER                         PIC X(102).
  4358         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4359             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4360             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4361
  4362         16  CF-AH-APPROVAL-DAYS.
  4363             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4364             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4365             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4366             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4367
  4368         16  FILLER                         PIC X(82).
  4369****************************************************************
  4370*             PROCESSOR/USER RECORD                            *
  4371****************************************************************
  4372
  4373     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4374         16  CF-PROCESSOR-NAME              PIC X(30).
  4375         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4376         16  CF-PROCESSOR-TITLE             PIC X(26).
  4377         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4378                 88  MESSAGE-YES                VALUE 'Y'.
  4379                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4380
  4381*****************************************************
  4382****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  86
* EL156.cbl
  4383****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4384****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4385****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4386*****************************************************
  4387
  4388         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4389             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4390             20  CF-APPLICATION-FORCE       PIC X.
  4391             20  CF-INDIVIDUAL-APP.
  4392                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4393                     28  CF-BROWSE-APP      PIC X.
  4394                     28  CF-UPDATE-APP      PIC X.
  4395
  4396         16  CF-CURRENT-TERM-ON             PIC X(4).
  4397         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4398             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4399             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4400             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4401             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4402             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4403             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4404             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4405         16  CF-PROCESSOR-CARRIER           PIC X.
  4406             88  NO-CARRIER-SECURITY            VALUE ' '.
  4407         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4408             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4409         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4410             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4411         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4412             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4413
  4414         16  CF-PROC-SYS-ACCESS-SW.
  4415             20  CF-PROC-CREDIT-CLAIMS-SW.
  4416                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4417                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4418                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4419                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4420             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4421                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4422                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4423             20  CF-PROC-LIFE-GNRLDGR-SW.
  4424                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4425                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4426                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4427                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4428             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4429                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4430                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4431         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4432             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4433             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4434         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4435
  4436         16  CF-APPROVAL-LEVEL                  PIC X.
  4437             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4438             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4439             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4440             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  87
* EL156.cbl
  4441
  4442         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4443
  4444         16  CF-LANGUAGE-TYPE                   PIC X.
  4445             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4446             88  CF-LANG-IS-FR                      VALUE 'F'.
  4447         16  FILLER                             PIC  X(240).
  4448
  4449****************************************************************
  4450*             PROCESSOR/REMINDERS RECORD                       *
  4451****************************************************************
  4452
  4453     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4454         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4455             20  CF-START-REMIND-DT         PIC XX.
  4456             20  CF-END-REMIND-DT           PIC XX.
  4457             20  CF-REMINDER-TEXT           PIC X(50).
  4458         16  FILLER                         PIC X(296).
  4459
  4460
  4461****************************************************************
  4462*             STATE MASTER RECORD                              *
  4463****************************************************************
  4464
  4465     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4466         16  CF-STATE-ABBREVIATION          PIC XX.
  4467         16  CF-STATE-NAME                  PIC X(25).
  4468         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4469         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4470             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4471             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4472             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4473             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4474                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4475                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4476             20  CF-ST-PREM-REJECT-SW       PIC X.
  4477                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4478                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4479             20  CF-ST-REF-REJECT-SW        PIC X.
  4480                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4481                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4482         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4483         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4484         16  CF-ST-REFUND-RULES.
  4485             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4486             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4487             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4488         16  CF-ST-FST-PMT-EXTENSION.
  4489             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4490             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4491                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4492                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4493                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4494                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4495         16  CF-ST-STATE-CALL.
  4496             20  CF-ST-CALL-UNEARNED        PIC X.
  4497             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4498             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  88
* EL156.cbl
  4499         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4500             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4501             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4502         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4503         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4504         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4505         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4506         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4507         16  FILLER                         PIC X.
  4508         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4509             20  CF-ST-BENEFIT-CD           PIC XX.
  4510             20  CF-ST-BENEFIT-KIND         PIC X.
  4511                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4512                 88  CF-ST-AH-KIND              VALUE 'A'.
  4513             20  CF-ST-REM-TERM-CALC        PIC X.
  4514                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4515                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4516                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4517                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4518                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4519                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4520                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4521                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4522
  4523             20  CF-ST-REFUND-CALC          PIC X.
  4524                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4525                 88  ST-REFD-BY-R78             VALUE '1'.
  4526                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4527                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4528                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4529                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4530                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4531                 88  ST-REFD-UTAH               VALUE '7'.
  4532                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4533                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4534                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4535
  4536             20  CF-ST-EARNING-CALC         PIC X.
  4537                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4538                 88  ST-EARN-BY-R78             VALUE '1'.
  4539                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4540                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4541                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4542                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4543                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4544                 88  ST-EARN-MEAN               VALUE '8'.
  4545                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4546
  4547             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4548                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4549                 88  ST-OVRD-BY-R78             VALUE '1'.
  4550                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4551                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4552                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4553                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4554                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4555                 88  ST-OVRD-MEAN               VALUE '8'.
  4556                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  89
* EL156.cbl
  4557             20  FILLER                     PIC X.
  4558
  4559         16  CF-ST-COMMISSION-CAPS.
  4560             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4561             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4562             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4563             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4564         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4565                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4566
  4567         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4568
  4569         16  CF-ST-STATUTORY-INTEREST.
  4570             20  CF-ST-STAT-DATE-FROM       PIC X.
  4571                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4572                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4573             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4574             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4575             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4576             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4577             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4578
  4579         16  CF-ST-OVER-SHORT.
  4580             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4581             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4582
  4583         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4584
  4585         16  CF-ST-RT-CALC                  PIC X.
  4586
  4587         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4588         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4589         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4590         16  CF-ST-RF-LR-CALC               PIC X.
  4591         16  CF-ST-RF-LL-CALC               PIC X.
  4592         16  CF-ST-RF-LN-CALC               PIC X.
  4593         16  CF-ST-RF-AH-CALC               PIC X.
  4594         16  CF-ST-RF-CP-CALC               PIC X.
  4595*        16  FILLER                         PIC X(206).
  4596*CIDMOD         16  FILLER                         PIC X(192).
  4597         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4598             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4599         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4600         16  CF-ST-VFY-2ND-BENE             PIC X.
  4601         16  FILLER                         PIC X(186).
  4602
  4603****************************************************************
  4604*             BENEFIT MASTER RECORD                            *
  4605****************************************************************
  4606
  4607     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4608         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4609             20  CF-BENEFIT-CODE            PIC XX.
  4610             20  CF-BENEFIT-NUMERIC  REDEFINES
  4611                 CF-BENEFIT-CODE            PIC XX.
  4612             20  CF-BENEFIT-ALPHA           PIC XXX.
  4613             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4614             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  90
* EL156.cbl
  4615
  4616             20  CF-LF-COVERAGE-TYPE        PIC X.
  4617                 88  CF-REDUCING                VALUE 'R'.
  4618                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4619
  4620             20  CF-SPECIAL-CALC-CD         PIC X.
  4621                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4622                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4623                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4624                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4625                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4626                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4627                 88  CF-FARM-PLAN               VALUE 'F'.
  4628                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4629                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4630                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4631                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4632                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4633                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4634                 88  CF-PRUDENTIAL              VALUE 'P'.
  4635                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4636                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4637                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4638                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4639                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4640                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4641
  4642             20  CF-JOINT-INDICATOR         PIC X.
  4643                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4644
  4645*            20  FILLER                     PIC X(12).
  4646             20  FILLER                     PIC X(11).
  4647             20  CF-BENEFIT-CATEGORY        PIC X.
  4648             20  CF-LOAN-TYPE               PIC X(8).
  4649
  4650             20  CF-CO-REM-TERM-CALC        PIC X.
  4651                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4652                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4653                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4654                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4655                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4656
  4657             20  CF-CO-EARNINGS-CALC        PIC X.
  4658                 88  CO-EARN-BY-R78             VALUE '1'.
  4659                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4660                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4661                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4662                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4663                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4664                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4665                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4666
  4667             20  CF-CO-REFUND-CALC          PIC X.
  4668                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4669                 88  CO-REFD-BY-R78             VALUE '1'.
  4670                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4671                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4672                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  91
* EL156.cbl
  4673                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4674                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4675                 88  CO-REFD-MEAN               VALUE '8'.
  4676                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4677                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4678                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4679
  4680             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4681                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4682                 88  CO-OVRD-BY-R78             VALUE '1'.
  4683                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4684                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4685                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4686                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4687                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4688                 88  CO-OVRD-MEAN               VALUE '8'.
  4689                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4690
  4691             20  CF-CO-BEN-I-G-CD           PIC X.
  4692                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4693                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4694                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4695
  4696         16  FILLER                         PIC X(304).
  4697
  4698
  4699****************************************************************
  4700*             CARRIER MASTER RECORD                            *
  4701****************************************************************
  4702
  4703     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4704         16  CF-ADDRESS-DATA.
  4705             20  CF-MAIL-TO-NAME            PIC X(30).
  4706             20  CF-IN-CARE-OF              PIC X(30).
  4707             20  CF-ADDRESS-LINE-1          PIC X(30).
  4708             20  CF-ADDRESS-LINE-2          PIC X(30).
  4709             20  CF-CITY-STATE              PIC X(30).
  4710             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4711             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4712
  4713         16  CF-CLAIM-NO-CONTROL.
  4714             20  CF-CLAIM-NO-METHOD         PIC X.
  4715                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4716                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4717                 88  CLAIM-NO-SEQ               VALUE '3'.
  4718                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4719             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4720                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4721                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4722                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4723
  4724         16  CF-CHECK-NO-CONTROL.
  4725             20  CF-CHECK-NO-METHOD         PIC X.
  4726                 88  CHECK-NO-MANUAL            VALUE '1'.
  4727                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4728                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4729                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4730             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  92
* EL156.cbl
  4731                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4732
  4733         16  CF-DOMICILE-STATE              PIC XX.
  4734
  4735         16  CF-EXPENSE-CONTROLS.
  4736             20  CF-EXPENSE-METHOD          PIC X.
  4737                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4738                 88  DOLLARS-PER-PMT            VALUE '2'.
  4739                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4740                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4741             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4742             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4743
  4744         16  CF-CORRESPONDENCE-CONTROL.
  4745             20  CF-LETTER-RESEND-OPT       PIC X.
  4746                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4747                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4748             20  FILLER                     PIC X(4).
  4749
  4750         16  CF-RESERVE-CONTROLS.
  4751             20  CF-MANUAL-SW               PIC X.
  4752                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4753             20  CF-FUTURE-SW               PIC X.
  4754                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4755             20  CF-PTC-SW                  PIC X.
  4756                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4757             20  CF-IBNR-SW                 PIC X.
  4758                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4759             20  CF-PTC-LF-SW               PIC X.
  4760                 88  CF-LF-PTC-USED             VALUE '1'.
  4761             20  CF-CDT-ACCESS-METHOD       PIC X.
  4762                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4763                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4764                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4765             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4766
  4767         16  CF-CLAIM-CALC-METHOD           PIC X.
  4768             88  360-PLUS-MONTHS                VALUE '1'.
  4769             88  365-PLUS-MONTHS                VALUE '2'.
  4770             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4771             88  360-DAILY                      VALUE '4'.
  4772             88  365-DAILY                      VALUE '5'.
  4773
  4774         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4775         16  FILLER                         PIC X(11).
  4776
  4777         16  CF-LIMIT-AMOUNTS.
  4778             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4779             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4780             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4781             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4782             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4783             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4784             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4785             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4786             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4787             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4788
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  93
* EL156.cbl
  4789         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4790         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4791         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4792
  4793         16  CF-ZIP-CODE.
  4794             20  CF-ZIP-PRIME.
  4795                 24  CF-ZIP-1ST             PIC X.
  4796                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4797                 24  FILLER                 PIC X(4).
  4798             20  CF-ZIP-PLUS4               PIC X(4).
  4799         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4800             20  CF-CAN-POSTAL-1            PIC XXX.
  4801             20  CF-CAN-POSTAL-2            PIC XXX.
  4802             20  FILLER                     PIC XXX.
  4803
  4804         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4805         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4806         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4807
  4808         16  CF-RATING-SWITCH               PIC X.
  4809             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4810             88  CF-NO-RATING                   VALUE 'N'.
  4811
  4812         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4813
  4814         16  CF-CARRIER-OVER-SHORT.
  4815             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4816             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4817
  4818         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4819         16  CF-SECPAY-SWITCH               PIC X.
  4820             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4821             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4822         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4823         16  FILLER                         PIC X(448).
  4824*        16  FILLER                         PIC X(452).
  4825
  4826
  4827****************************************************************
  4828*             MORTALITY MASTER RECORD                          *
  4829****************************************************************
  4830
  4831     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4832         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4833                                INDEXED BY CF-MORT-NDX.
  4834             20  CF-MORT-TABLE              PIC X(5).
  4835             20  CF-MORT-TABLE-TYPE         PIC X.
  4836                 88  CF-MORT-JOINT              VALUE 'J'.
  4837                 88  CF-MORT-SINGLE             VALUE 'S'.
  4838                 88  CF-MORT-COMBINED           VALUE 'C'.
  4839                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4840                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4841             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4842             20  CF-MORT-AGE-METHOD         PIC XX.
  4843                 88  CF-AGE-LAST                VALUE 'AL'.
  4844                 88  CF-AGE-NEAR                VALUE 'AN'.
  4845             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4846             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  94
* EL156.cbl
  4847                                            PIC X.
  4848                 88  CF-MINUS                   VALUE '-'.
  4849                 88  CF-PLUS                    VALUE '+'.
  4850             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4851             20  CF-MORT-JOINT-CODE         PIC X.
  4852                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4853             20  CF-MORT-PC-Q               PIC X.
  4854                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4855             20  CF-MORT-TABLE-CODE         PIC X(4).
  4856             20  CF-MORT-COMMENTS           PIC X(15).
  4857             20  FILLER                     PIC X(14).
  4858
  4859         16  FILLER                         PIC X(251).
  4860
  4861
  4862****************************************************************
  4863*             BUSSINESS TYPE MASTER RECORD                     *
  4864****************************************************************
  4865
  4866     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4867* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4868* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4869* AND RECORD 05 IS TYPES 81-99
  4870         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4871             20  CF-BUSINESS-TITLE          PIC  X(19).
  4872             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4873                                            PIC S9V9(4) COMP-3.
  4874             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4875             20  FILLER                     PIC  X.
  4876         16  FILLER                         PIC  X(248).
  4877
  4878
  4879****************************************************************
  4880*             TERMINAL MASTER RECORD                           *
  4881****************************************************************
  4882
  4883     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4884
  4885         16  CF-COMPANY-TERMINALS.
  4886             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4887                                  PIC X(4).
  4888         16  FILLER               PIC X(248).
  4889
  4890
  4891****************************************************************
  4892*             LIFE EDIT MASTER RECORD                          *
  4893****************************************************************
  4894
  4895     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4896         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4897             20  CF-LIFE-CODE-IN            PIC XX.
  4898             20  CF-LIFE-CODE-OUT           PIC XX.
  4899         16  FILLER                         PIC X(248).
  4900
  4901
  4902****************************************************************
  4903*             AH EDIT MASTER RECORD                            *
  4904****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  95
* EL156.cbl
  4905
  4906     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4907         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4908             20  CF-AH-CODE-IN              PIC XXX.
  4909             20  CF-AH-CODE-OUT             PIC XX.
  4910         16  FILLER                         PIC X(248).
  4911
  4912
  4913****************************************************************
  4914*             CREDIBILITY TABLES                               *
  4915****************************************************************
  4916
  4917     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4918         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4919                             INDEXED BY CF-CRDB-NDX.
  4920             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4921             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4922             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4923         16  FILLER                         PIC  X(332).
  4924
  4925
  4926****************************************************************
  4927*             REPORT CUSTOMIZATION RECORD                      *
  4928****************************************************************
  4929
  4930     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4931         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4932             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4933             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4934             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4935**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4936****       A T-TRANSFER.                                   ****
  4937             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4938
  4939         16  FILLER                         PIC XX.
  4940
  4941         16  CF-CARRIER-CNTL-OPT.
  4942             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4943                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4944                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4945             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4946                                            PIC X.
  4947         16  CF-GROUP-CNTL-OPT.
  4948             20  CF-GROUP-OPT-SEQ           PIC 9.
  4949                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4950                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4951             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4952                                            PIC X(6).
  4953         16  CF-STATE-CNTL-OPT.
  4954             20  CF-STATE-OPT-SEQ           PIC 9.
  4955                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4956                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4957             20  CF-STATE-SELECT OCCURS 3 TIMES
  4958                                            PIC XX.
  4959         16  CF-ACCOUNT-CNTL-OPT.
  4960             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4961                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4962                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  96
* EL156.cbl
  4963             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4964                                            PIC X(10).
  4965         16  CF-BUS-TYP-CNTL-OPT.
  4966             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4967                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4968                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4969             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4970                                            PIC XX.
  4971         16  CF-LF-TYP-CNTL-OPT.
  4972             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4973                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4974                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4975             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4976                                            PIC XX.
  4977         16  CF-AH-TYP-CNTL-OPT.
  4978             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4979                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4980                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4981             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4982                                            PIC XX.
  4983         16  CF-REPTCD1-CNTL-OPT.
  4984             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4985                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4986                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4987             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4988                                            PIC X(10).
  4989         16  CF-REPTCD2-CNTL-OPT.
  4990             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4991                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4992                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4993             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4994                                            PIC X(10).
  4995         16  CF-USER1-CNTL-OPT.
  4996             20  CF-USER1-OPT-SEQ           PIC 9.
  4997                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4998                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4999             20  CF-USER1-SELECT OCCURS 3 TIMES
  5000                                            PIC X(10).
  5001         16  CF-USER2-CNTL-OPT.
  5002             20  CF-USER2-OPT-SEQ           PIC 9.
  5003                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5004                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5005             20  CF-USER2-SELECT OCCURS 3 TIMES
  5006                                            PIC X(10).
  5007         16  CF-USER3-CNTL-OPT.
  5008             20  CF-USER3-OPT-SEQ           PIC 9.
  5009                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5010                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5011             20  CF-USER3-SELECT OCCURS 3 TIMES
  5012                                            PIC X(10).
  5013         16  CF-USER4-CNTL-OPT.
  5014             20  CF-USER4-OPT-SEQ           PIC 9.
  5015                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5016                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5017             20  CF-USER4-SELECT OCCURS 3 TIMES
  5018                                            PIC X(10).
  5019         16  CF-USER5-CNTL-OPT.
  5020             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  97
* EL156.cbl
  5021                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5022                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5023             20  CF-USER5-SELECT OCCURS 3 TIMES
  5024                                            PIC X(10).
  5025         16  CF-REINS-CNTL-OPT.
  5026             20  CF-REINS-OPT-SEQ           PIC 9.
  5027                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5028                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5029             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5030                 24  CF-REINS-PRIME         PIC XXX.
  5031                 24  CF-REINS-SUB           PIC XXX.
  5032
  5033         16  CF-AGENT-CNTL-OPT.
  5034             20  CF-AGENT-OPT-SEQ           PIC 9.
  5035                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5036                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5037             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5038                                            PIC X(10).
  5039
  5040         16  FILLER                         PIC X(43).
  5041
  5042         16  CF-LOSS-RATIO-SELECT.
  5043             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5044             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5045         16  CF-ENTRY-DATE-SELECT.
  5046             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5047             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5048         16  CF-EFFECTIVE-DATE-SELECT.
  5049             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5050             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5051
  5052         16  CF-EXCEPTION-LIST-IND          PIC X.
  5053             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5054
  5055         16  FILLER                         PIC X(318).
  5056
  5057****************************************************************
  5058*                  EXCEPTION REPORTING RECORD                  *
  5059****************************************************************
  5060
  5061     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5062         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5063             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5064
  5065         16  CF-COMBINED-LIFE-AH-OPT.
  5066             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5067             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5068             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5069             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5070
  5071         16  CF-LIFE-OPT.
  5072             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5073             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5074             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5075             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5076             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5077             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5078             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  98
* EL156.cbl
  5079             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5080             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5081             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5082
  5083         16  CF-AH-OPT.
  5084             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5085             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5086             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5087             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5088             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5089             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5090             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5091             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5092             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5093             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5094
  5095         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5096             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5097             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5098             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5099
  5100         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5101
  5102         16  FILLER                         PIC X(673).
  5103
  5104
  5105****************************************************************
  5106*             MORTGAGE SYSTEM PLAN RECORD                      *
  5107****************************************************************
  5108
  5109     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5110         16  CF-PLAN-TYPE                   PIC X.
  5111             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5112             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5113             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5114         16  CF-PLAN-ABBREV                 PIC XXX.
  5115         16  CF-PLAN-DESCRIPT               PIC X(10).
  5116         16  CF-PLAN-NOTES                  PIC X(20).
  5117         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5118         16  CF-PLAN-UNDERWRITING.
  5119             20  CF-PLAN-TERM-DATA.
  5120                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5121                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5122             20  CF-PLAN-AGE-DATA.
  5123                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5124                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5125                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5126             20  CF-PLAN-BENEFIT-DATA.
  5127                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5128                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5129                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5130                                            PIC S9(7)V99  COMP-3.
  5131         16  CF-PLAN-POLICY-FORMS.
  5132             20  CF-POLICY-FORM             PIC X(12).
  5133             20  CF-MASTER-APPLICATION      PIC X(12).
  5134             20  CF-MASTER-POLICY           PIC X(12).
  5135         16  CF-PLAN-RATING.
  5136             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page  99
* EL156.cbl
  5137             20  CF-SEX-RATING              PIC X.
  5138                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5139                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5140             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5141             20  CF-SUB-STD-TYPE            PIC X.
  5142                 88  CF-PCT-OF-PREM            VALUE '1'.
  5143                 88  CF-PCT-OF-BENE            VALUE '2'.
  5144         16  CF-PLAN-PREM-TOLERANCES.
  5145             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5146             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5147         16  CF-PLAN-PYMT-TOLERANCES.
  5148             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5149             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5150         16  CF-PLAN-MISC-DATA.
  5151             20  FILLER                     PIC X.
  5152             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5153             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5154         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5155         16  CF-PLAN-IND-GRP                PIC X.
  5156             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5157                                                     '1'.
  5158             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5159                                                     '2'.
  5160         16  CF-MIB-SEARCH-SW               PIC X.
  5161             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5162             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5163             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5164             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5165         16  CF-ALPHA-SEARCH-SW             PIC X.
  5166             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5167             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5168             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5169             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5170             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5171             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5172             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5173             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5174             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5175             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5176                                                     'A' 'B' 'C'
  5177                                                     'X' 'Y' 'Z'.
  5178         16  CF-EFF-DT-RULE-SW              PIC X.
  5179             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5180             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5181             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5182             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5183             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5184         16  FILLER                         PIC X(4).
  5185         16  CF-HEALTH-QUESTIONS            PIC X.
  5186             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5187         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5188         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5189         16  CF-PLAN-SNGL-JNT               PIC X.
  5190             88  CF-COMBINED-PLAN              VALUE 'C'.
  5191             88  CF-JNT-PLAN                   VALUE 'J'.
  5192             88  CF-SNGL-PLAN                  VALUE 'S'.
  5193         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5194         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 100
* EL156.cbl
  5195         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5196         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5197         16  CF-RERATE-CNTL                 PIC  X.
  5198             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5199             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5200             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5201             88  CF-AUTO-RECALC                 VALUE '4'.
  5202         16  CF-BENEFIT-TYPE                PIC  X.
  5203             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5204             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5205         16  CF-POLICY-FEE                  PIC S999V99
  5206                                                    COMP-3.
  5207         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5208         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5209         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5210         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5211         16  FILLER                         PIC  X(32).
  5212         16  CF-TERMINATION-FORM            PIC  X(04).
  5213         16  FILLER                         PIC  X(08).
  5214         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5215                                                       COMP-3.
  5216         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5217         16  CF-ISSUE-LETTER                PIC  X(4).
  5218         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5219         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5220             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5221             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5222         16  CF-MP-REFUND-CALC              PIC X.
  5223             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5224             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5225             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5226             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5227             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5228             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5229             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5230             88  CF-MP-REFD-MEAN                VALUE '8'.
  5231         16  CF-ALT-RATE-CODE               PIC  X(5).
  5232
  5233
  5234         16  FILLER                         PIC X(498).
  5235****************************************************************
  5236*             MORTGAGE COMPANY MASTER RECORD                   *
  5237****************************************************************
  5238
  5239     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5240         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5241         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5242             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5243             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5244             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5245             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5246             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5247
  5248         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5249         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5250         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5251         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5252         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 101
* EL156.cbl
  5253
  5254         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5255             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5256         16  CF-MP-RECON-USE-IND            PIC X(1).
  5257             88  CF-MP-USE-RECON             VALUE 'Y'.
  5258         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5259             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5260         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5261             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5262             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5263         16  FILLER                         PIC X(1).
  5264         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5265             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5266         16  CF-MORTG-MIB-VERSION           PIC X.
  5267             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5268             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5269             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5270         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5271             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5272                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5273             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5274                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5275             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5276                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5277             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5278                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5279             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5280                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5281             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5282                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5283         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5284         16  FILLER                         PIC X(7).
  5285         16  CF-MORTG-DESTINATION-SYMBOL.
  5286             20  CF-MORTG-MIB-COMM          PIC X(5).
  5287             20  CF-MORTG-MIB-TERM          PIC X(5).
  5288         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5289             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5290         16  FILLER                         PIC X(03).
  5291         16  CF-MP-CHECK-NO-CONTROL.
  5292             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5293                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5294                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5295                                                ' ' LOW-VALUES.
  5296                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5297                                               VALUE '3'.
  5298         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5299         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5300         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5301             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5302                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5303             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5304                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5305             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5306                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5307             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5308                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5309             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5310                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 102
* EL156.cbl
  5311             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5312                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5313         16  CF-MORTG-BILLING-AREA.
  5314             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5315                                            PIC X.
  5316         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5317         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5318         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5319         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5320             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5321             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5322         16  FILLER                         PIC X.
  5323         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5324             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5325             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5326         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5327         16  FILLER                         PIC X(8).
  5328         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5329         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5330         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5331         16  CF-ACH-COMPANY-ID.
  5332             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5333                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5334                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5335                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5336             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5337         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5338             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5339         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5340             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5341             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5342         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5343         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5344         16  FILLER                         PIC X(536).
  5345
  5346****************************************************************
  5347*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5348****************************************************************
  5349
  5350     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5351         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5352             20  CF-FEMALE-HEIGHT.
  5353                 24  CF-FEMALE-FT           PIC 99.
  5354                 24  CF-FEMALE-IN           PIC 99.
  5355             20  CF-FEMALE-MIN-WT           PIC 999.
  5356             20  CF-FEMALE-MAX-WT           PIC 999.
  5357         16  FILLER                         PIC X(428).
  5358
  5359     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5360         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5361             20  CF-MALE-HEIGHT.
  5362                 24  CF-MALE-FT             PIC 99.
  5363                 24  CF-MALE-IN             PIC 99.
  5364             20  CF-MALE-MIN-WT             PIC 999.
  5365             20  CF-MALE-MAX-WT             PIC 999.
  5366         16  FILLER                         PIC X(428).
  5367******************************************************************
  5368*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 103
* EL156.cbl
  5369******************************************************************
  5370     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5371         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5372             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5373             20  CF-SYS-LETTER-ID           PIC X(04).
  5374             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5375             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5376             20  CF-SYS-RESET-SW            PIC X(01).
  5377             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5378             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5379
  5380         16  FILLER                         PIC X(50).
  5381
  5382         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5383             20  CF-USER-ACTIVE-SW          PIC X(01).
  5384             20  CF-USER-LETTER-ID          PIC X(04).
  5385             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5386             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5387             20  CF-USER-RESET-SW           PIC X(01).
  5388             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5389             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5390             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5391
  5392         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 104
* EL156.cbl
  5394*    COPY ELCCERT.
  5395******************************************************************
  5396*                                                                *
  5397*                            ELCCERT.                            *
  5398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5399*                            VMOD=2.013                          *
  5400*                                                                *
  5401*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5402*                                                                *
  5403*   FILE TYPE = VSAM,KSDS                                        *
  5404*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5405*                                                                *
  5406*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5407*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5408*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5409*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5410*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5411*                                                                *
  5412*   LOG = YES                                                    *
  5413*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5414******************************************************************
  5415*                   C H A N G E   L O G
  5416*
  5417* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5418*-----------------------------------------------------------------
  5419*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5420* EFFECTIVE    NUMBER
  5421*-----------------------------------------------------------------
  5422* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5423* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5424* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5425* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5426* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5427* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5428* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5429******************************************************************
  5430
  5431 01  CERTIFICATE-MASTER.
  5432     12  CM-RECORD-ID                      PIC XX.
  5433         88  VALID-CM-ID                      VALUE 'CM'.
  5434
  5435     12  CM-CONTROL-PRIMARY.
  5436         16  CM-COMPANY-CD                 PIC X.
  5437         16  CM-CARRIER                    PIC X.
  5438         16  CM-GROUPING.
  5439             20  CM-GROUPING-PREFIX        PIC X(3).
  5440             20  CM-GROUPING-PRIME         PIC X(3).
  5441         16  CM-STATE                      PIC XX.
  5442         16  CM-ACCOUNT.
  5443             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5444             20  CM-ACCOUNT-PRIME          PIC X(6).
  5445         16  CM-CERT-EFF-DT                PIC XX.
  5446         16  CM-CERT-NO.
  5447             20  CM-CERT-PRIME             PIC X(10).
  5448             20  CM-CERT-SFX               PIC X.
  5449
  5450     12  CM-CONTROL-BY-NAME.
  5451         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 105
* EL156.cbl
  5452         16  CM-INSURED-LAST-NAME          PIC X(15).
  5453         16  CM-INSURED-INITIALS.
  5454             20  CM-INSURED-INITIAL1       PIC X.
  5455             20  CM-INSURED-INITIAL2       PIC X.
  5456
  5457     12  CM-CONTROL-BY-SSN.
  5458         16  CM-COMPANY-CD-A2              PIC X.
  5459         16  CM-SOC-SEC-NO.
  5460             20  CM-SSN-STATE              PIC XX.
  5461             20  CM-SSN-ACCOUNT            PIC X(6).
  5462             20  CM-SSN-LN3.
  5463                 25  CM-INSURED-INITIALS-A2.
  5464                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5465                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5466                 25 CM-PART-LAST-NAME-A2         PIC X.
  5467
  5468     12  CM-CONTROL-BY-CERT-NO.
  5469         16  CM-COMPANY-CD-A4              PIC X.
  5470         16  CM-CERT-NO-A4                 PIC X(11).
  5471
  5472     12  CM-CONTROL-BY-MEMB.
  5473         16  CM-COMPANY-CD-A5              PIC X.
  5474         16  CM-MEMBER-NO.
  5475             20  CM-MEMB-STATE             PIC XX.
  5476             20  CM-MEMB-ACCOUNT           PIC X(6).
  5477             20  CM-MEMB-LN4.
  5478                 25  CM-INSURED-INITIALS-A5.
  5479                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5480                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5481                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5482
  5483     12  CM-INSURED-PROFILE-DATA.
  5484         16  CM-INSURED-FIRST-NAME.
  5485             20  CM-INSURED-1ST-INIT       PIC X.
  5486             20  FILLER                    PIC X(9).
  5487         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5488         16  CM-INSURED-SEX                PIC X.
  5489             88  CM-SEX-MALE                  VALUE 'M'.
  5490             88  CM-SEX-FEMAL                 VALUE 'F'.
  5491         16  CM-INSURED-JOINT-AGE          PIC 99.
  5492         16  CM-JOINT-INSURED-NAME.
  5493             20  CM-JT-LAST-NAME           PIC X(15).
  5494             20  CM-JT-FIRST-NAME.
  5495                 24  CM-JT-1ST-INIT        PIC X.
  5496                 24  FILLER                PIC X(9).
  5497             20  CM-JT-INITIAL             PIC X.
  5498
  5499     12  CM-LIFE-DATA.
  5500         16  CM-LF-BENEFIT-CD              PIC XX.
  5501         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5502         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5503         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5504         16  CM-LF-DEV-CODE                PIC XXX.
  5505         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5506         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5507         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5508         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5509         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 106
* EL156.cbl
  5510         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5511         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5512         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5513         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5514         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5515         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5516         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5517         16  FILLER                        PIC XX.
  5518
  5519     12  CM-AH-DATA.
  5520         16  CM-AH-BENEFIT-CD              PIC XX.
  5521         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5522         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5523         16  CM-AH-DEV-CODE                PIC XXX.
  5524         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5525         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5526         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5527         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5528         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5529         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5530         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5531         16  CM-AH-PAID-THRU-DT            PIC XX.
  5532             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5533         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5534         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5535         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5536         16  FILLER                        PIC X.
  5537
  5538     12  CM-LOAN-INFORMATION.
  5539         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5540         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5541                                           PIC S9(5)V99  COMP-3.
  5542         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5543         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5544         16  CM-PAY-FREQUENCY              PIC S99.
  5545         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5546         16  CM-RATE-CLASS                 PIC XX.
  5547         16  CM-BENEFICIARY                PIC X(25).
  5548         16  CM-POLICY-FORM-NO             PIC X(12).
  5549         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5550         16  CM-LAST-ADD-ON-DT             PIC XX.
  5551         16  CM-DEDUCTIBLE-AMOUNTS.
  5552             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5553             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5554         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5555             20  CM-RESIDENT-STATE         PIC XX.
  5556             20  CM-RATE-CODE              PIC X(4).
  5557             20  FILLER                    PIC XX.
  5558         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5559             20  CM-LOAN-OFFICER           PIC X(5).
  5560             20  FILLER                    PIC XXX.
  5561         16  CM-CSR-CODE                   PIC XXX.
  5562         16  CM-UNDERWRITING-CODE          PIC X.
  5563             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5564         16  CM-POST-CARD-IND              PIC X.
  5565         16  CM-NH-INTERFACE-SW            PIC X.
  5566         16  CM-PREMIUM-TYPE               PIC X.
  5567             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 107
* EL156.cbl
  5568             88  CM-O-B-COVERAGE              VALUE '2'.
  5569             88  CM-OPEN-END                  VALUE '3'.
  5570         16  CM-IND-GRP-TYPE               PIC X.
  5571             88  CM-INDIVIDUAL                VALUE 'I'.
  5572             88  CM-GROUP                     VALUE 'G'.
  5573         16  CM-SKIP-CODE                  PIC X.
  5574             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5575             88  SKIP-JULY                    VALUE '1'.
  5576             88  SKIP-AUGUST                  VALUE '2'.
  5577             88  SKIP-SEPTEMBER               VALUE '3'.
  5578             88  SKIP-JULY-AUG                VALUE '4'.
  5579             88  SKIP-AUG-SEPT                VALUE '5'.
  5580             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5581             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5582             88  SKIP-JUNE                    VALUE '8'.
  5583             88  SKIP-JUNE-JULY               VALUE '9'.
  5584             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5585             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5586         16  CM-PAYMENT-MODE               PIC X.
  5587             88  PAY-MONTHLY                  VALUE SPACE.
  5588             88  PAY-WEEKLY                   VALUE '1'.
  5589             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5590             88  PAY-BI-WEEKLY                VALUE '3'.
  5591             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5592         16  CM-LOAN-NUMBER                PIC X(8).
  5593         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5594         16  CM-OLD-LOF                    PIC XXX.
  5595*        16  CM-LOAN-OFFICER               PIC XXX.
  5596         16  CM-REIN-TABLE                 PIC XXX.
  5597         16  CM-SPECIAL-REIN-CODE          PIC X.
  5598         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5599         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5600         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5601
  5602     12  CM-STATUS-DATA.
  5603         16  CM-ENTRY-STATUS               PIC X.
  5604         16  CM-ENTRY-DT                   PIC XX.
  5605
  5606         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5607         16  CM-LF-CANCEL-DT               PIC XX.
  5608         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5609
  5610         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5611         16  CM-LF-DEATH-DT                PIC XX.
  5612         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5613
  5614         16  CM-LF-CURRENT-STATUS          PIC X.
  5615             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5616                                                'M' '4' '5' '9'.
  5617             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5618             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5619             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5620             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5621             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5622             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5623             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5624             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5625             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 108
* EL156.cbl
  5626             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5627             88  CM-LF-DECLINED               VALUE 'D'.
  5628             88  CM-LF-VOIDED                 VALUE 'V'.
  5629
  5630         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5631         16  CM-AH-CANCEL-DT               PIC XX.
  5632         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5633
  5634         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5635         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5636         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5637
  5638         16  CM-AH-CURRENT-STATUS          PIC X.
  5639             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5640                                                'M' '4' '5' '9'.
  5641             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5642             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5643             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5644             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5645             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5646             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5647             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5648             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5649             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5650             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5651             88  CM-AH-DECLINED               VALUE 'D'.
  5652             88  CM-AH-VOIDED                 VALUE 'V'.
  5653
  5654         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5655             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5656             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5657             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5658         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5659
  5660         16  CM-ENTRY-BATCH                PIC X(6).
  5661         16  CM-LF-EXIT-BATCH              PIC X(6).
  5662         16  CM-AH-EXIT-BATCH              PIC X(6).
  5663         16  CM-LAST-MONTH-END             PIC XX.
  5664
  5665     12  CM-NOTE-SW                        PIC X.
  5666         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5667         88  CERT-NOTES-PRESENT               VALUE '1'.
  5668         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5669         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5670         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5671         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5672         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5673         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5674     12  CM-COMP-EXCP-SW                   PIC X.
  5675         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5676         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5677     12  CM-INSURED-ADDRESS-SW             PIC X.
  5678         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5679         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5680
  5681*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5682     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5683     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 109
* EL156.cbl
  5684
  5685*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5686     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5687     12  FILLER                            PIC X.
  5688*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5689     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5690
  5691     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5692         88  CERT-ADDED-BATCH                 VALUE ' '.
  5693         88  CERT-ADDED-ONLINE                VALUE '1'.
  5694         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5695         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5696         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5697     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5698         88  CERT-AS-LOADED                   VALUE ' '.
  5699         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5700         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5701         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5702         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5703         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5704         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5705         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5706
  5707     12  CM-ACCOUNT-COMM-PCTS.
  5708         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5709         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5710
  5711     12  CM-USER-FIELD                     PIC X.
  5712     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5713     12  CM-CLP-STATE                      PIC XX.
  5714     12  CM-USER-RESERVED                  PIC XXX.
  5715******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 110
* EL156.cbl
  5717*    COPY ELCTRLR.
  5718******************************************************************
  5719*                                                                *
  5720*                            ELCTRLR.                            *
  5721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5722*                            VMOD=2.014                          *
  5723*                                                                *
  5724*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5725*                                                                *
  5726*   FILE TYPE = VSAM,KSDS                                        *
  5727*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5728*                                                                *
  5729*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5730*       ALTERNATE INDEX = NONE                                   *
  5731*                                                                *
  5732*   LOG = YES                                                    *
  5733*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5734******************************************************************
  5735*                   C H A N G E   L O G
  5736*
  5737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5738*-----------------------------------------------------------------
  5739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5740* EFFECTIVE    NUMBER
  5741*-----------------------------------------------------------------
  5742* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5743* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5744* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5745* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5746* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5747* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5748* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5749* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5750* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5751* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5752* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5753* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5754* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5755******************************************************************
  5756 01  ACTIVITY-TRAILERS.
  5757     12  AT-RECORD-ID                    PIC XX.
  5758         88  VALID-AT-ID                       VALUE 'AT'.
  5759
  5760     12  AT-CONTROL-PRIMARY.
  5761         16  AT-COMPANY-CD               PIC X.
  5762         16  AT-CARRIER                  PIC X.
  5763         16  AT-CLAIM-NO                 PIC X(7).
  5764         16  AT-CERT-NO.
  5765             20  AT-CERT-PRIME           PIC X(10).
  5766             20  AT-CERT-SFX             PIC X.
  5767         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5768             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5769             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5770             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5771             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5772             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5773             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5774             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 111
* EL156.cbl
  5775             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5776             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5777             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5778             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5779             88  AT-BENEFICIARY-TRL           VALUE +91.
  5780             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5781             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5782
  5783     12  AT-TRAILER-TYPE                 PIC X.
  5784         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5785         88  PAYMENT-TR                       VALUE '2'.
  5786         88  AUTO-PAY-TR                      VALUE '3'.
  5787         88  CORRESPONDENCE-TR                VALUE '4'.
  5788         88  ADDRESS-TR                       VALUE '5'.
  5789         88  GENERAL-INFO-TR                  VALUE '6'.
  5790         88  AUTO-PROMPT-TR                   VALUE '7'.
  5791         88  DENIAL-TR                        VALUE '8'.
  5792         88  INCURRED-CHG-TR                  VALUE '9'.
  5793         88  FORM-CONTROL-TR                  VALUE 'A'.
  5794
  5795     12  AT-RECORDED-DT                  PIC XX.
  5796     12  AT-RECORDED-BY                  PIC X(4).
  5797     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5798
  5799     12  AT-TRAILER-BODY                 PIC X(165).
  5800
  5801     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5802         16  AT-RESERVE-CONTROLS.
  5803             20  AT-MANUAL-SW            PIC X.
  5804                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5805             20  AT-FUTURE-SW            PIC X.
  5806                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5807             20  AT-PTC-SW               PIC X.
  5808                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5809             20  AT-IBNR-SW              PIC X.
  5810                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5811             20  AT-PTC-LF-SW            PIC X.
  5812                 88  AT-LF-PTC-USED          VALUE '1'.
  5813             20  AT-CDT-ACCESS-METHOD    PIC X.
  5814                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5815                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5816                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5817             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5818         16  AT-LAST-COMPUTED-DT         PIC XX.
  5819         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5820         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5821         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5822         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5823         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5824         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5825         16  AT-EXPENSE-CONTROLS.
  5826             20  AT-EXPENSE-METHOD       PIC X.
  5827                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5828                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5829                 88  PERCENT-OF-PMT           VALUE '3'.
  5830                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5831             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5832             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 112
* EL156.cbl
  5833         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5834         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5835
  5836         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5837         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5838
  5839*        16  FILLER                      PIC X(53).
  5840         16  FILLER                      PIC X(47).
  5841
  5842         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5843         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5844
  5845         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5846             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5847             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5848*                    C = CLOSED
  5849*                    O = OPEN
  5850             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5851*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5852
  5853     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5854         16  AT-PAYMENT-TYPE             PIC X.
  5855             88  PARTIAL-PAYMENT                VALUE '1'.
  5856             88  FINAL-PAYMENT                  VALUE '2'.
  5857             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5858             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5859             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5860             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5861             88  VOIDED-PAYMENT                 VALUE '9'.
  5862             88  TRANSFER                       VALUE 'T'.
  5863             88  LIFE-INTEREST                  VALUE 'I'.
  5864
  5865         16  AT-CLAIM-TYPE               PIC X.
  5866             88  PAID-FOR-AH                    VALUE 'A'.
  5867             88  PAID-FOR-LIFE                  VALUE 'L'.
  5868             88  PAID-FOR-IUI                   VALUE 'I'.
  5869             88  PAID-FOR-GAP                   VALUE 'G'.
  5870         16  AT-CLAIM-PREM-TYPE          PIC X.
  5871             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5872             88  AT-O-B-COVERAGE                VALUE '2'.
  5873             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5874         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5875         16  AT-CHECK-NO                 PIC X(7).
  5876         16  AT-PAID-FROM-DT             PIC XX.
  5877         16  AT-PAID-THRU-DT             PIC XX.
  5878         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5879         16  FILLER                      PIC X.
  5880         16  AT-PAYEES-NAME              PIC X(30).
  5881         16  AT-PAYMENT-ORIGIN           PIC X.
  5882             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5883             88  ONLINE-AUTO-PMT                VALUE '2'.
  5884             88  OFFLINE-PMT                    VALUE '3'.
  5885         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5886         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5887         16  AT-VOID-DATA.
  5888             20  AT-VOID-DT              PIC XX.
  5889*00144       20  AT-VOID-REASON          PIC X(30).
  5890             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 113
* EL156.cbl
  5891         16  AT-PMT-APPROVED-BY          PIC X(04).
  5892         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5893         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5894         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5895                                         PIC S99V9(5)  COMP-3.
  5896         16  AT-CREDIT-INTERFACE.
  5897             20  AT-PMT-SELECT-DT        PIC XX.
  5898                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5899             20  AT-PMT-ACCEPT-DT        PIC XX.
  5900                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5901             20  AT-VOID-SELECT-DT       PIC XX.
  5902                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5903             20  AT-VOID-ACCEPT-DT       PIC XX.
  5904                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5905
  5906         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5907                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5908                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5909         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5910
  5911         16  AT-FORCE-CONTROL            PIC X.
  5912             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5913         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5914         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5915         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5916         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5917         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5918         16  AT-BENEFIT-TYPE             PIC X.
  5919
  5920         16  AT-EXPENSE-TYPE             PIC X.
  5921         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5922
  5923         16  AT-PAYEE-TYPE-CD.
  5924             20  AT-PAYEE-TYPE           PIC X.
  5925                 88  INSURED-PAID           VALUE 'I'.
  5926                 88  BENEFICIARY-PAID       VALUE 'B'.
  5927                 88  ACCOUNT-PAID           VALUE 'A'.
  5928                 88  OTHER-1-PAID           VALUE 'O'.
  5929                 88  OTHER-2-PAID           VALUE 'Q'.
  5930                 88  DOCTOR-PAID            VALUE 'P'.
  5931                 88  EMPLOYER-PAID          VALUE 'E'.
  5932             20  AT-PAYEE-SEQ            PIC X.
  5933
  5934         16  AT-CASH-PAYMENT             PIC X.
  5935         16  AT-GROUPED-PAYMENT          PIC X.
  5936         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5937         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5938         16  AT-APPROVED-LEVEL           PIC X.
  5939         16  AT-VOID-TYPE                PIC X.
  5940             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5941             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5942         16  AT-AIG-UNEMP-IND            PIC X.
  5943             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5944         16  AT-ASSOCIATES               PIC X.
  5945             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5946             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5947
  5948         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 114
* EL156.cbl
  5949         16  AT-CV-PMT-CODE              PIC X.
  5950             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5951             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5952             88  FULL-ADD-PAYMENT           VALUE '3'.
  5953             88  HALF-ADD-PAYMENT           VALUE '4'.
  5954             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5955             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5956             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5957             88  ADDL-PAYMENT               VALUE '8'.
  5958
  5959         16  AT-EOB-CODE1                PIC XXX.
  5960         16  AT-EOB-CODE2                PIC XXX.
  5961         16  AT-EOB-CODE3                PIC XXX.
  5962         16  AT-EOB-CODE4                PIC XXX.
  5963         16  FILLER REDEFINES AT-EOB-CODE4.
  5964             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5965             20  FILLER                  PIC X.
  5966         16  AT-EOB-CODE5                PIC XXX.
  5967         16  FILLER REDEFINES AT-EOB-CODE5.
  5968             20  AT-PMT-PROOF-DT         PIC XX.
  5969             20  FILLER                  PIC X.
  5970
  5971         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5972             88  AT-PRINT-EOB            VALUE 'Y'.
  5973
  5974         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5975         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5976
  5977     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5978         16  AT-SCHEDULE-START-DT        PIC XX.
  5979         16  AT-SCHEDULE-END-DT          PIC XX.
  5980         16  AT-TERMINATED-DT            PIC XX.
  5981         16  AT-LAST-PMT-TYPE            PIC X.
  5982             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5983             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5984         16  AT-FIRST-PMT-DATA.
  5985             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5986             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5987             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5988         16  AT-REGULAR-PMT-DATA.
  5989             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5990             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5991             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5992         16  AT-AUTO-PAYEE-CD.
  5993             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5994                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5995                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5996                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5997                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5998                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5999             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6000         16  AT-AUTO-PAY-DAY             PIC 99.
  6001         16  AT-AUTO-CASH                PIC X.
  6002             88  AT-CASH                      VALUE 'Y'.
  6003             88  AT-NON-CASH                  VALUE 'N'.
  6004*        16  FILLER                      PIC X(129).
  6005         16  AT-AUTO-END-LETTER          PIC X(4).
  6006         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 115
* EL156.cbl
  6007
  6008         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6009         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6010
  6011     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6012         16  AT-LETTER-SENT-DT           PIC XX.
  6013         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6014         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6015         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6016         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6017         16  AT-LETTER-ORIGIN            PIC X.
  6018             88  ONLINE-CREATION              VALUE '1' '3'.
  6019             88  OFFLINE-CREATION             VALUE '2' '4'.
  6020             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6021             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6022         16  AT-STD-LETTER-FORM          PIC X(4).
  6023         16  AT-REASON-TEXT              PIC X(70).
  6024         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6025         16  AT-ADDRESEE-TYPE            PIC X.
  6026              88  INSURED-ADDRESEE            VALUE 'I'.
  6027              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6028              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6029              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6030              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6031              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6032              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6033         16  AT-ADDRESSEE-NAME           PIC X(30).
  6034         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6035         16  AT-RESEND-PRINT-DATE        PIC XX.
  6036         16  AT-CORR-SOL-UNSOL           PIC X.
  6037         16  AT-LETTER-PURGED-DT         PIC XX.
  6038*
  6039*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6040*
  6041         16  AT-CSO-REDEFINITION.
  6042             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6043             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6044             20  AT-LETTER-TO-BENE       PIC X(1).
  6045             20  AT-STOP-LETTER-DT       PIC X(2).
  6046             20  FILLER                  PIC X(19).
  6047*             20  FILLER                  PIC X(27).
  6048             20  AT-CSO-LETTER-STATUS    PIC X.
  6049                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6050                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6051                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6052             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6053             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6054*
  6055*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6056*
  6057*        16  FILLER                      PIC X(26).
  6058*
  6059*        16  AT-DMD-BSR-CODE             PIC X.
  6060*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6061*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6062*
  6063*        16  AT-DMD-LETTER-STATUS        PIC X.
  6064*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 116
* EL156.cbl
  6065*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6066*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6067*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6068*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6069
  6070         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6071         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6072
  6073     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6074         16  AT-ADDRESS-TYPE             PIC X.
  6075             88  INSURED-ADDRESS               VALUE 'I'.
  6076             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6077             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6078             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6079             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6080             88  OTHER-ADDRESS-1               VALUE 'O'.
  6081             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6082         16  AT-MAIL-TO-NAME             PIC X(30).
  6083         16  AT-ADDRESS-LINE-1           PIC X(30).
  6084         16  AT-ADDRESS-LINE-2           PIC X(30).
  6085         16  AT-CITY-STATE.
  6086             20  AT-CITY                 PIC X(28).
  6087             20  AT-STATE                PIC XX.
  6088         16  AT-ZIP.
  6089             20  AT-ZIP-CODE.
  6090                 24  AT-ZIP-1ST          PIC X.
  6091                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6092                 24  FILLER              PIC X(4).
  6093             20  AT-ZIP-PLUS4            PIC X(4).
  6094         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6095             20  AT-CAN-POSTAL-1         PIC XXX.
  6096             20  AT-CAN-POSTAL-2         PIC XXX.
  6097             20  FILLER                  PIC XXX.
  6098         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6099*         16  FILLER                      PIC X(23).
  6100         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6101         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6102         16  FILLER                      PIC X(13).
  6103         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6104         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6105
  6106     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6107         16  AT-INFO-LINE-1              PIC X(60).
  6108         16  AT-INFO-LINE-2              PIC X(60).
  6109         16  AT-INFO-TRAILER-TYPE        PIC X.
  6110             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6111             88  AT-CALL-NOTE            VALUE 'C'.
  6112             88  AT-MAINT-NOTE           VALUE 'M'.
  6113             88  AT-CERT-CHANGE          VALUE 'X'.
  6114             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6115             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6116         16  AT-CALL-TYPE                PIC X.
  6117             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6118             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6119         16  AT-NOTE-CONTINUATION        PIC X.
  6120             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6121         16  AT-EOB-CODES-EXIST          PIC X.
  6122             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 117
* EL156.cbl
  6123         16  FILLER                      PIC X(35).
  6124         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6125         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6126
  6127     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6128         16  AT-PROMPT-LINE-1            PIC X(60).
  6129         16  AT-PROMPT-LINE-2            PIC X(60).
  6130         16  AT-PROMPT-START-DT          PIC XX.
  6131         16  AT-PROMPT-END-DT            PIC XX.
  6132         16  FILLER                      PIC X(35).
  6133         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6134         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6135
  6136     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6137         16  AT-DENIAL-INFO-1            PIC X(60).
  6138         16  AT-DENIAL-INFO-2            PIC X(60).
  6139         16  AT-DENIAL-DT                PIC XX.
  6140         16  AT-RETRACTION-DT            PIC XX.
  6141         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6142*         16  FILLER                      PIC X(31).
  6143         16  AT-DENIAL-PROOF-DT          PIC XX.
  6144         16  FILLER                      PIC X(29).
  6145         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6146         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6147
  6148     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6149         16  AT-OLD-INCURRED-DT          PIC XX.
  6150         16  AT-OLD-REPORTED-DT          PIC XX.
  6151         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6152         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6153         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6154         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6155         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6156         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6157         16  FILLER                      PIC X(26).
  6158         16  AT-OLD-DIAG-CODE            PIC X(6).
  6159         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6160         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6161         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6162         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6163         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6164         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6165         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6166         16  FILLER                      PIC X(25).
  6167         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6168
  6169     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6170         16  AT-FORM-SEND-ON-DT          PIC XX.
  6171         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6172         16  AT-FORM-RE-SEND-DT          PIC XX.
  6173         16  AT-FORM-ANSWERED-DT         PIC XX.
  6174         16  AT-FORM-PRINTED-DT          PIC XX.
  6175         16  AT-FORM-REPRINT-DT          PIC XX.
  6176         16  AT-FORM-TYPE                PIC X.
  6177             88  INITIAL-FORM                  VALUE '1'.
  6178             88  PROGRESS-FORM                 VALUE '2'.
  6179         16  AT-INSTRUCT-LN-1            PIC X(28).
  6180         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 118
* EL156.cbl
  6181         16  AT-INSTRUCT-LN-3            PIC X(28).
  6182         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6183         16  AT-FORM-ADDRESS             PIC X.
  6184             88  FORM-TO-INSURED              VALUE 'I'.
  6185             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6186             88  FORM-TO-OTHER-1              VALUE 'O'.
  6187             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6188         16  AT-RELATED-1.
  6189             20 AT-REL-CARR-1            PIC X.
  6190             20 AT-REL-CLAIM-1           PIC X(7).
  6191             20 AT-REL-CERT-1            PIC X(11).
  6192         16  AT-RELATED-2.
  6193             20 AT-REL-CARR-2            PIC X.
  6194             20 AT-REL-CLAIM-2           PIC X(7).
  6195             20 AT-REL-CERT-2            PIC X(11).
  6196         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6197         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6198         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6199         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6200         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6201         16  AT-STOP-FORM-DT             PIC X(2).
  6202
  6203         16  FILLER                      PIC X(09).
  6204         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6205         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6206******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 119
* EL156.cbl
  6208*    COPY ELCACTQ.
  6209******************************************************************
  6210*                                                                *
  6211*                            ELCACTQ.                            *
  6212*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6213*                            VMOD=2.004                          *
  6214*                                                                *
  6215*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6216*                                                                *
  6217*   FILE TYPE = VSAM,KSDS                                        *
  6218*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6219*                                                                *
  6220*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6221*       ALTERNATE INDEX = NONE                                   *
  6222*                                                                *
  6223*   LOG = YES                                                    *
  6224*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6225*                                                                *
  6226*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6227******************************************************************
  6228
  6229 01  ACTIVITY-QUE.
  6230     12  AQ-RECORD-ID                PIC XX.
  6231         88  VALID-AQ-ID                VALUE 'AQ'.
  6232
  6233     12  AQ-CONTROL-PRIMARY.
  6234         16  AQ-COMPANY-CD           PIC X.
  6235         16  AQ-CARRIER              PIC X.
  6236         16  AQ-CLAIM-NO             PIC X(7).
  6237         16  AQ-CERT-NO.
  6238             20  AQ-CERT-PRIME       PIC X(10).
  6239             20  AQ-CERT-SFX         PIC X.
  6240
  6241     12  AQ-PENDING-ACTIVITY-FLAGS.
  6242         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6243         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6244             88  PENDING-PAYMENTS       VALUE '1'.
  6245         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6246             88  PENDING-FULL-PRINT     VALUE '1'.
  6247             88  PENDING-PART-PRINT     VALUE '2'.
  6248         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6249             88  PENDING-LETTERS        VALUE '1'.
  6250         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6251             88  PENDING-RESTORE        VALUE 'C'.
  6252             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6253
  6254     12  FILLER                      PIC X(20).
  6255
  6256     12  AQ-RESEND-DATE              PIC XX.
  6257     12  AQ-FOLLOWUP-DATE            PIC XX.
  6258     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6259     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6260     12  AQ-AUTO-LETTER              PIC X(4).
  6261     12  FILLER                      PIC XX.
  6262     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6263*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 120
* EL156.cbl
  6265*    COPY ERCACCT.
  6266******************************************************************
  6267*                                                                *
  6268*                                                                *
  6269*                            ERCACCT                             *
  6270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6271*                            VMOD=2.031                          *
  6272*                                                                *
  6273*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6274*                                                                *
  6275*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6276*   VSAM ACCOUNT MASTER FILES.                                   *
  6277*                                                                *
  6278*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6279*                                                                *
  6280*   FILE TYPE = VSAM,KSDS                                        *
  6281*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6282*                                                                *
  6283*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6284*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6285*                                                                *
  6286*   LOG = NO                                                     *
  6287*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6288*                                                                *
  6289*                                                                *
  6290******************************************************************
  6291*                   C H A N G E   L O G
  6292*
  6293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6294*-----------------------------------------------------------------
  6295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6296* EFFECTIVE    NUMBER
  6297*-----------------------------------------------------------------
  6298* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6299* 092705    2005050300006  PEMA  ADD SPP LEASES
  6300* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6301* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6302* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6303* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6304******************************************************************
  6305
  6306 01  ACCOUNT-MASTER.
  6307     12  AM-RECORD-ID                      PIC XX.
  6308         88  VALID-AM-ID                      VALUE 'AM'.
  6309
  6310     12  AM-CONTROL-PRIMARY.
  6311         16  AM-COMPANY-CD                 PIC X.
  6312         16  AM-MSTR-CNTRL.
  6313             20  AM-CONTROL-A.
  6314                 24  AM-CARRIER            PIC X.
  6315                 24  AM-GROUPING.
  6316                     28 AM-GROUPING-PREFIX PIC XXX.
  6317                     28 AM-GROUPING-PRIME  PIC XXX.
  6318                 24  AM-STATE              PIC XX.
  6319                 24  AM-ACCOUNT.
  6320                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6321                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6322             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 121
* EL156.cbl
  6323                                           PIC X(19).
  6324             20  AM-CNTRL-B.
  6325                 24  AM-EXPIRATION-DT      PIC XX.
  6326                 24  FILLER                PIC X(4).
  6327             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6328                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6329
  6330     12  AM-CONTROL-BY-VAR-GRP.
  6331         16  AM-COMPANY-CD-A1              PIC X.
  6332         16  AM-VG-CARRIER                 PIC X.
  6333         16  AM-VG-GROUPING                PIC X(6).
  6334         16  AM-VG-STATE                   PIC XX.
  6335         16  AM-VG-ACCOUNT                 PIC X(10).
  6336         16  AM-VG-DATE.
  6337             20  AM-VG-EXPIRATION-DT       PIC XX.
  6338             20  FILLER                    PIC X(4).
  6339         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6340                                           PIC 9(11)      COMP-3.
  6341     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6342         16  FILLER                        PIC X(10).
  6343         16  AM-VG-KEY3.
  6344             20  AM-VG3-ACCOUNT            PIC X(10).
  6345             20  AM-VG3-EXP-DT             PIC XX.
  6346         16  FILLER                        PIC X(4).
  6347     12  AM-MAINT-INFORMATION.
  6348         16  AM-LAST-MAINT-DT              PIC XX.
  6349         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6350         16  AM-LAST-MAINT-USER            PIC X(4).
  6351         16  FILLER                        PIC XX.
  6352
  6353     12  AM-EFFECTIVE-DT                   PIC XX.
  6354     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6355
  6356     12  AM-PREV-DATES  COMP-3.
  6357         16  AM-PREV-EXP-DT                PIC 9(11).
  6358         16  AM-PREV-EFF-DT                PIC 9(11).
  6359
  6360     12  AM-REPORT-CODE-1                  PIC X(10).
  6361     12  AM-REPORT-CODE-2                  PIC X(10).
  6362
  6363     12  AM-CITY-CODE                      PIC X(4).
  6364     12  AM-COUNTY-PARISH                  PIC X(6).
  6365
  6366     12  AM-NAME                           PIC X(30).
  6367     12  AM-PERSON                         PIC X(30).
  6368     12  AM-ADDRS                          PIC X(30).
  6369     12  AM-CITY.
  6370         16  AM-ADDR-CITY                  PIC X(28).
  6371         16  AM-ADDR-STATE                 PIC XX.
  6372     12  AM-ZIP.
  6373         16  AM-ZIP-PRIME.
  6374             20  AM-ZIP-PRI-1ST            PIC X.
  6375                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6376             20  FILLER                    PIC X(4).
  6377         16  AM-ZIP-PLUS4                  PIC X(4).
  6378     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6379         16  AM-CAN-POSTAL-1               PIC XXX.
  6380         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 122
* EL156.cbl
  6381         16  FILLER                        PIC XXX.
  6382     12  AM-TEL-NO.
  6383         16  AM-AREA-CODE                  PIC 999.
  6384         16  AM-TEL-PRE                    PIC 999.
  6385         16  AM-TEL-NBR                    PIC 9(4).
  6386     12  AM-TEL-LOC                        PIC X.
  6387         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6388         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6389
  6390     12  AM-COMM-STRUCTURE.
  6391         16  AM-DEFN-1.
  6392             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6393                 24  AM-AGT.
  6394                     28  AM-AGT-PREFIX     PIC X(4).
  6395                     28  AM-AGT-PRIME      PIC X(6).
  6396                 24  AM-COM-TYP            PIC X.
  6397                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6398                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6399                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6400                 24  AM-RECALC-LV-INDIC    PIC X.
  6401                 24  AM-RETRO-LV-INDIC     PIC X.
  6402                 24  AM-GL-CODES           PIC X.
  6403                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6404                 24  FILLER                PIC X(01).
  6405         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6406             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6407                 24  FILLER                PIC X(11).
  6408                 24  AM-L-COMA             PIC XXX.
  6409                 24  AM-J-COMA             PIC XXX.
  6410                 24  AM-A-COMA             PIC XXX.
  6411                 24  FILLER                PIC X(6).
  6412
  6413     12  AM-COMM-CHANGE-STATUS             PIC X.
  6414         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6415
  6416     12  AM-CSR-CODE                       PIC X(4).
  6417
  6418     12  AM-BILLING-STATUS                 PIC X.
  6419         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6420         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6421     12  AM-AUTO-REFUND-SW                 PIC X.
  6422         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6423         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6424     12  AM-GPCD                           PIC 99.
  6425     12  AM-IG                             PIC X.
  6426         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6427         88  AM-HAS-GROUP                     VALUE '2'.
  6428     12  AM-STATUS                         PIC X.
  6429         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6430         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6431         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6432         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6433         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6434         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6435     12  AM-REMIT-TO                       PIC 99.
  6436     12  AM-ID-NO                          PIC X(11).
  6437
  6438     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 123
* EL156.cbl
  6439     12  AM-LF-DEVIATION                   PIC XXX.
  6440     12  AM-AH-DEVIATION                   PIC XXX.
  6441     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6442     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6443     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6444     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6445     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6446     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6447
  6448     12  AM-USER-FIELDS.
  6449         16  AM-FLD-1                      PIC XX.
  6450         16  AM-FLD-2                      PIC XX.
  6451         16  AM-FLD-3                      PIC XX.
  6452         16  AM-FLD-4                      PIC XX.
  6453         16  AM-FLD-5                      PIC XX.
  6454
  6455     12  AM-1ST-PROD-DATE.
  6456         16  AM-1ST-PROD-YR                PIC XX.
  6457         16  AM-1ST-PROD-MO                PIC XX.
  6458         16  AM-1ST-PROD-DA                PIC XX.
  6459     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6460     12  AM-CERTS-PURGED-DATE.
  6461         16  AM-PUR-YR                     PIC XX.
  6462         16  AM-PUR-MO                     PIC XX.
  6463         16  AM-PUR-DA                     PIC XX.
  6464     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6465     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6466     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6467     12  AM-INACTIVE-DATE.
  6468         16  AM-INA-MO                     PIC 99.
  6469         16  AM-INA-DA                     PIC 99.
  6470         16  AM-INA-YR                     PIC 99.
  6471     12  AM-AR-HI-CERT-DATE                PIC XX.
  6472
  6473     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6474     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6475
  6476     12  AM-OB-PAYMENT-MODE                PIC X.
  6477         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6478         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6479         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6480         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6481
  6482     12  AM-AH-ONLY-INDICATOR              PIC X.
  6483         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6484         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6485
  6486     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6487
  6488     12  AM-OVER-SHORT.
  6489         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6490         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6491
  6492     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6493     12  AM-DCC-CLP-STATE                  PIC XX.
  6494
  6495     12  AM-RECALC-COMM                    PIC X.
  6496     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 124
* EL156.cbl
  6497
  6498     12  AM-REI-TABLE                      PIC XXX.
  6499     12  AM-REI-ET-LF                      PIC X.
  6500     12  AM-REI-ET-AH                      PIC X.
  6501     12  AM-REI-PE-LF                      PIC X.
  6502     12  AM-REI-PE-AH                      PIC X.
  6503     12  AM-REI-PRT-ST                     PIC X.
  6504     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6505     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6506     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6507     12  AM-REI-GROUP-A                    PIC X(6).
  6508     12  AM-REI-MORT                       PIC X(4).
  6509     12  AM-REI-PRT-OW                     PIC X.
  6510     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6511     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6512     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6513     12  AM-REI-GROUP-B                    PIC X(6).
  6514
  6515     12  AM-TRUST-TYPE                     PIC X(2).
  6516
  6517     12  AM-EMPLOYER-STMT-USED             PIC X.
  6518     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6519
  6520     12  AM-STD-AH-TYPE                    PIC XX.
  6521     12  AM-EARN-METHODS.
  6522         16  AM-EARN-METHOD-R              PIC X.
  6523             88 AM-REF-RL-R78                 VALUE 'R'.
  6524             88 AM-REF-RL-PR                  VALUE 'P'.
  6525             88 AM-REF-RL-MEAN                VALUE 'M'.
  6526             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6527         16  AM-EARN-METHOD-L              PIC X.
  6528             88 AM-REF-LL-R78                 VALUE 'R'.
  6529             88 AM-REF-LL-PR                  VALUE 'P'.
  6530             88 AM-REF-LL-MEAN                VALUE 'M'.
  6531             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6532         16  AM-EARN-METHOD-A              PIC X.
  6533             88 AM-REF-AH-R78                 VALUE 'R'.
  6534             88 AM-REF-AH-PR                  VALUE 'P'.
  6535             88 AM-REF-AH-MEAN                VALUE 'M'.
  6536             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6537             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6538             88 AM-REF-AH-NET                 VALUE 'N'.
  6539
  6540     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6541     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6542     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6543
  6544     12  AM-RET-Y-N                        PIC X.
  6545     12  AM-RET-P-E                        PIC X.
  6546     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6547     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6548     12  AM-RET-GRP                        PIC X(6).
  6549     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6550         16  AM-POOL-PRIME                 PIC XXX.
  6551         16  AM-POOL-SUB                   PIC XXX.
  6552     12  AM-RETRO-EARNINGS.
  6553         16  AM-RET-EARN-R                 PIC X.
  6554         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 125
* EL156.cbl
  6555         16  AM-RET-EARN-A                 PIC X.
  6556     12  AM-RET-ST-TAX-USE                 PIC X.
  6557         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6558         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6559     12  AM-RETRO-BEG-EARNINGS.
  6560         16  AM-RET-BEG-EARN-R             PIC X.
  6561         16  AM-RET-BEG-EARN-L             PIC X.
  6562         16  AM-RET-BEG-EARN-A             PIC X.
  6563     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6564     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6565
  6566     12  AM-USER-SELECT-OPTIONS.
  6567         16  AM-USER-SELECT-1              PIC X(10).
  6568         16  AM-USER-SELECT-2              PIC X(10).
  6569         16  AM-USER-SELECT-3              PIC X(10).
  6570         16  AM-USER-SELECT-4              PIC X(10).
  6571         16  AM-USER-SELECT-5              PIC X(10).
  6572
  6573     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6574
  6575     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6576
  6577     12  AM-RPT045A-SWITCH                 PIC X.
  6578         88  RPT045A-OFF                   VALUE 'N'.
  6579
  6580     12  AM-INSURANCE-LIMITS.
  6581         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6582         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6583
  6584     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6585         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6586
  6587     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6588         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6589         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6590
  6591     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6592
  6593     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6594     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6595     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6596     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6597     12  FILLER                            PIC X(5).
  6598     12  AM-REPORT-CODE-3                  PIC X(10).
  6599*    12  FILLER                            PIC X(22).
  6600
  6601     12  AM-RESERVE-DATE.
  6602         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6603         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6604         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6605
  6606     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6607     12  AM-NOTIFICATION-TYPES.
  6608         16  AM-NOTIF-OF-LETTERS           PIC X.
  6609         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6610         16  AM-NOTIF-OF-REPORTS           PIC X.
  6611         16  AM-NOTIF-OF-STATUS            PIC X.
  6612
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 126
* EL156.cbl
  6613     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6614         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6615         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6616         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6617         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6618
  6619     12  AM-BENEFIT-CONTROLS.
  6620         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6621             20  AM-BENEFIT-CODE           PIC XX.
  6622             20  AM-BENEFIT-TYPE           PIC X.
  6623             20  AM-BENEFIT-REVISION       PIC XXX.
  6624             20  AM-BENEFIT-REM-TERM       PIC X.
  6625             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6626             20  FILLER                    PIC XX.
  6627         16  FILLER                        PIC X(80).
  6628
  6629     12  AM-TRANSFER-DATA.
  6630         16  AM-TRANSFERRED-FROM.
  6631             20  AM-TRNFROM-CARRIER        PIC X.
  6632             20  AM-TRNFROM-GROUPING.
  6633                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6634                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6635             20  AM-TRNFROM-STATE          PIC XX.
  6636             20  AM-TRNFROM-ACCOUNT.
  6637                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6638                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6639             20  AM-TRNFROM-DTE            PIC XX.
  6640         16  AM-TRANSFERRED-TO.
  6641             20  AM-TRNTO-CARRIER          PIC X.
  6642             20  AM-TRNTO-GROUPING.
  6643                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6644                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6645             20  AM-TRNTO-STATE            PIC XX.
  6646             20  AM-TRNTO-ACCOUNT.
  6647                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6648                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6649             20  AM-TRNTO-DTE              PIC XX.
  6650         16  FILLER                        PIC X(10).
  6651
  6652     12  AM-SAVED-REMIT-TO                 PIC 99.
  6653
  6654     12  AM-COMM-STRUCTURE-SAVED.
  6655         16  AM-DEFN-1-SAVED.
  6656             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6657                 24  AM-AGT-SV             PIC X(10).
  6658                 24  AM-COM-TYP-SV         PIC X.
  6659                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6660                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6661                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6662                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6663                 24  FILLER                PIC X.
  6664                 24  AM-GL-CODES-SV        PIC X.
  6665                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6666                 24  FILLER                PIC X.
  6667         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6668             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6669                 24  FILLER                PIC X(11).
  6670                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 127
* EL156.cbl
  6671                 24  AM-J-COMA-SV          PIC XXX.
  6672                 24  AM-A-COMA-SV          PIC XXX.
  6673                 24  FILLER                PIC X(6).
  6674
  6675     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6676         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6677            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6678            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6679            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6680
  6681     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6682     12  FILLER                            PIC X(120).
  6683
  6684     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6685         16  AM-CONTROL-NAME               PIC X(30).
  6686         16  AM-EXECUTIVE-ONE.
  6687             20  AM-EXEC1-NAME             PIC X(15).
  6688             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6689                                                          COMP-3.
  6690             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6691                                                          COMP-3.
  6692         16  AM-EXECUTIVE-TWO.
  6693             20  AM-EXEC2-NAME             PIC X(15).
  6694             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6695                                                          COMP-3.
  6696             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6697                                                          COMP-3.
  6698
  6699     12  AM-RETRO-ADDITIONAL-DATA.
  6700         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6701         16  AM-RETRO-PREM-P-E             PIC X.
  6702         16  AM-RETRO-CLMS-P-I             PIC X.
  6703         16  AM-RETRO-RET-BRACKET-LF.
  6704             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6705                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6706                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6707             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6708                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6709                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6710             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6711                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6712                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6713         16  AM-RETRO-RET-BRACKET-AH.
  6714             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6715                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6716                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6717                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6718             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6719                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6720                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6721             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6722                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6723                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6724
  6725     12  AM-COMMENTS.
  6726         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6727
  6728     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 128
* EL156.cbl
  6729         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6730         16  AM-FLI-BILLING-CODE           PIC X.
  6731         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6732         16  AM-FLI-UNITED-IDENT           PIC X.
  6733         16  AM-FLI-INTEREST-LOST-DATA.
  6734             20  AM-FLI-BANK-NO            PIC X(5).
  6735             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6736             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6737             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6738         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6739             20  AM-FLI-AGT                PIC X(9).
  6740             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6741             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6742         16  FILLER                        PIC X(102).
  6743
  6744     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6745         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6746             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6747             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6748             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6749             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6750             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6751         16  FILLER                          PIC X(10).
  6752******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 129
* EL156.cbl
  6754*    COPY ELCCHKQ.
  6755******************************************************************
  6756*                                                                *
  6757*                                                                *
  6758*                            ELCCHKQ.                            *
  6759*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6760*                            VMOD=2.007                          *
  6761*                                                                *
  6762*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6763*                                                                *
  6764*   FILE TYPE = VSAM,KSDS                                        *
  6765*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6766*                                                                *
  6767*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6768*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6769*                                                                *
  6770*   LOG = YES                                                    *
  6771*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6772******************************************************************
  6773 01  CHECK-QUE.
  6774     12  CQ-RECORD-ID                PIC XX.
  6775         88  VALID-CQ-ID         VALUE 'CQ'.
  6776
  6777     12  CQ-CONTROL-PRIMARY.
  6778         16  CQ-COMPANY-CD           PIC X.
  6779         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6780         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6781
  6782     12  CQ-CONTROL-BY-PAYEE.
  6783         16  CQ-CONTROL-BY-NUMBER.
  6784             20  CQ-COMPANY-CD-A1     PIC X.
  6785             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6786         16  CQ-PAYEE-CARRIER        PIC X.
  6787         16  CQ-PAYEE-GROUPING       PIC X(6).
  6788         16  CQ-PAYEE-STATE          PIC XX.
  6789         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6790         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6791
  6792     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6793         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6794         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6795         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6796         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6797         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6798         16  FILLER                  PIC X(3).
  6799
  6800     12  CQ-ENTRY-TYPE               PIC X.
  6801             88  CHECK-ON-QUE           VALUE 'Q'.
  6802             88  ALIGNMENT-CHECK        VALUE 'A'.
  6803             88  SPOILED-CHECK          VALUE 'S'.
  6804             88  PAYMENT-ABORTED        VALUE 'X'.
  6805
  6806     12  CQ-CLAIM-MAST-CNTL.
  6807         16  CQ-CARRIER              PIC X.
  6808         16  CQ-CLAIM-NO             PIC X(7).
  6809         16  CQ-CERT-NO.
  6810             20  CQ-CERT-PRIME       PIC X(10).
  6811             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 130
* EL156.cbl
  6812         16  CQ-CLAIM-TYPE           PIC X.
  6813             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6814             88  CQ-AH-CLAIM            VALUE 'A'.
  6815         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6816             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6817             88  CQ-O-B-COVERAGE        VALUE '2'.
  6818             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6819
  6820     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6821     12  CQ-CHECK-NUMBER             PIC X(7).
  6822     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6823     12  CQ-PAYMENT-TYPE             PIC X.
  6824             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6825             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6826             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6827             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6828             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6829             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6830             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6831             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6832     12  CQ-VOID-INDICATOR           PIC X.
  6833             88  CHECK-IS-STOPPED          VALUE 'S'.
  6834             88  CHECK-IS-VOID             VALUE 'V'.
  6835     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6836     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6837     12  CQ-CHECK-BY-USER            PIC X(4).
  6838     12  CQ-PRE-NUMBERING-SW         PIC X.
  6839       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6840       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6841
  6842     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6843     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6844     12  CQ-LEDGER-FLAG              PIC X(01).
  6845     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6846     12  CQ-LAST-UPDATED-DT          PIC XX.
  6847     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6848     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6849
  6850     12  FILLER                      PIC X(04).
  6851
  6852******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 131
* EL156.cbl
  6854*    COPY ELCBENE.
  6855******************************************************************
  6856*                                                                *
  6857*                            ELCBENE.                            *
  6858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6859*                            VMOD=2.006                          *
  6860*                                                                *
  6861*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6862*                                                                *
  6863*   FILE TYPE = VSAM,KSDS                                        *
  6864*   RECORD SIZE = 500   RECFORM = FIX                            *
  6865*                                                                *
  6866*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6867*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6868*                                                                *
  6869*   LOG = YES                                                    *
  6870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6871*                                                                *
  6872*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6873******************************************************************
  6874
  6875 01  BENEFICIARY-MASTER.
  6876     12  BE-RECORD-ID                PIC XX.
  6877         88  VALID-BE-ID                VALUE 'BE'.
  6878
  6879     12  BE-CONTROL-PRIMARY.
  6880         16  BE-COMPANY-CD           PIC X.
  6881         16  BE-RECORD-TYPE          PIC X.
  6882             88  BENEFICIARY-RECORD  VALUE 'B'.
  6883             88  ADJUSTOR-RECORD     VALUE 'A'.
  6884         16  BE-BENEFICIARY          PIC X(10).
  6885     12  BE-CONTROL-BY-NAME.
  6886         16  BE-COMPANY-CD-A1        PIC X.
  6887         16  BE-RECORD-TYPE-A1       PIC X.
  6888         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6889         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6890
  6891     12  BE-LAST-MAINT-DT            PIC XX.
  6892     12  BE-LAST-MAINT-BY            PIC X(4).
  6893     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6894
  6895     12  BE-ADDRESS-DATA.
  6896         16  BE-MAIL-TO-NAME         PIC X(30).
  6897         16  BE-ADDRESS-LINE-1       PIC X(30).
  6898         16  BE-ADDRESS-LINE-2       PIC X(30).
  6899         16  BE-ADDRESS-LINE-3       PIC X(30).
  6900         16  BE-CITY-STATE.
  6901             20  BE-CITY             PIC X(28).
  6902             20  BE-STATE            PIC XX.
  6903         16  BE-ZIP-CODE.
  6904             20  BE-ZIP-PRIME.
  6905                 24  BE-ZIP-1ST      PIC X.
  6906                     88  BE-CANADIAN-POST-CODE
  6907                                         VALUE 'A' THRU 'Z'.
  6908                 24  FILLER          PIC X(4).
  6909             20  BE-ZIP-PLUS4        PIC X(4).
  6910         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6911             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 132
* EL156.cbl
  6912             20  BE-CAN-POSTAL-2     PIC XXX.
  6913             20  FILLER              PIC XXX.
  6914         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6915         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6916
  6917******************************************************************
  6918*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6919*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6920******************************************************************
  6921     12  BE-CARRIER                  PIC X.
  6922
  6923     12  BE-ADDRESS-DATA2.
  6924         16  BE-MAIL-TO-NAME2        PIC X(30).
  6925         16  BE-ADDRESS-LINE-12      PIC X(30).
  6926         16  BE-ADDRESS-LINE-22      PIC X(30).
  6927         16  BE-ADDRESS-LINE-32      PIC X(30).
  6928         16  BE-CITY-STATE2.
  6929             20  BE-CITY2            PIC X(28).
  6930             20  BE-STATE2           PIC XX.
  6931         16  BE-ZIP-CODE2.
  6932             20  BE-ZIP-PRIME2.
  6933                 24  BE-ZIP-1ST2     PIC X.
  6934                     88  BE-CANADIAN-POST-CODE2
  6935                                         VALUE 'A' THRU 'Z'.
  6936                 24  FILLER          PIC X(4).
  6937             20  BE-ZIP-PLUS42       PIC X(4).
  6938         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6939             20  BE-CAN-POSTAL-12    PIC XXX.
  6940             20  BE-CAN-POSTAL-22    PIC XXX.
  6941             20  FILLER              PIC XXX.
  6942         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6943         16  BE-BILLING-STMT-DATA.
  6944             20  BE-BSR              PIC X.
  6945                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6946                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6947             20  BE-BSR-FROM         PIC X(30).
  6948             20  BE-BSR-DEPT         PIC X(30).
  6949             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6950             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6951             20  BE-OUTPUT-TYPE      PIC X.
  6952                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6953                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6954
  6955     12  FILLER                      PIC X(28).
  6956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 133
* EL156.cbl
  6958*    COPY ELCARCH.
  6959******************************************************************
  6960*                                                                *
  6961*                            ELCARCH.                            *
  6962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6963*                            VMOD=2.007                          *
  6964*                                                                *
  6965*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6966*                                                                *
  6967*   FILE TYPE = VSAM,KSDS                                        *
  6968*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6969*                                                                *
  6970*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6971*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6972*                                                                *
  6973*   LOG = NO                                                     *
  6974*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6975*                                                                *
  6976*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6977******************************************************************
  6978 01  LETTER-ARCHIVE.
  6979     12  LA-RECORD-ID                PIC XX.
  6980         88  VALID-LA-ID                VALUE 'LA'.
  6981
  6982     12  LA-CONTROL-PRIMARY.
  6983         16  LA-COMPANY-CD           PIC X.
  6984         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6985         16  LA-RECORD-TYPE          PIC X.
  6986             88  LA-HEADER-DATA         VALUE '1'.
  6987             88  LA-ADDRESS-DATA        VALUE '2'.
  6988             88  LA-TEXT-DATA           VALUE '3'.
  6989             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6990         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6991
  6992     12  LA-CONTROL-BY-TYPE.
  6993         16  LA-COMPANY-CD-A1        PIC X.
  6994         16  LA-RECORD-TYPE-A1       PIC X.
  6995         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6996         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6997
  6998     12  LA-TEXT-RECORD.
  6999         16  LA-SKIP-CONTROL         PIC XX.
  7000             88  NO-LINES-SKIPPED       VALUE SPACES.
  7001             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7002         16  LA-TEXT-LINE            PIC X(70).
  7003
  7004     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7005         16  FILLER                  PIC XX.
  7006         16  LA-ADDRESS-LINE         PIC X(30).
  7007         16  FILLER                  PIC X(40).
  7008
  7009     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7010         16  FILLER                  PIC XX.
  7011         16  LA-CARRIER              PIC X.
  7012         16  LA-CLAIM-NO             PIC X(7).
  7013         16  LA-CERT-NO.
  7014             20  LA-CERT-PRIME       PIC X(10).
  7015             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 134
* EL156.cbl
  7016         16  LA-NO-OF-COPIES         PIC S9.
  7017         16  LA-RESEND-DATE          PIC XX.
  7018         16  LA-PROCESSOR-CD         PIC X(4).
  7019         16  LA-CREATION-DT          PIC XX.
  7020         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7021         16  LA-RESEND-PRINT-DATE    PIC XX.
  7022         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7023         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7024*
  7025* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7026*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7027*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7028*   I        20  LA-DMD-RES-ST           PIC XX.
  7029*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7030*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7031*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7032*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7033*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7034*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7035*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7036*   I        20  LA-DMD-UND-CODE         PIC XX.
  7037*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7038*   V    16  FILLER                  PIC X(15).
  7039* -----
  7040*
  7041* REINSERTED  CSO  MODS
  7042*
  7043         16  FILLER.
  7044             20  FILLER                  PIC X(29).
  7045             20  LA-CSO-LETTER-STATUS    PIC X.
  7046                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7047                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7048                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7049             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7050             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7051*
  7052
  7053     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7054         16  FILLER                  PIC XX.
  7055         16  LA4-CARRIER             PIC X.
  7056         16  LA4-CLAIM-NO            PIC X(7).
  7057         16  LA4-CERT-NO.
  7058             20  LA4-CERT-PRIME      PIC X(10).
  7059             20  LA4-CERT-SFX        PIC X.
  7060         16  LA4-NO-OF-COPIES        PIC S9.
  7061         16  LA4-RESEND-DATE         PIC XX.
  7062         16  LA4-PROCESSOR-CD        PIC X(4).
  7063         16  LA4-CREATION-DT         PIC XX.
  7064         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7065         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7066         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7067         16  LA4-FORM-TYPE           PIC X.
  7068             88  LA4-INITIAL-FORM    VALUE '1'.
  7069             88  LA4-PROGRESS-FORM   VALUE '2'.
  7070         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7071         16  LA4-STATE               PIC X(02).
  7072         16  FILLER                  PIC X(31).
  7073******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 135
* EL156.cbl
  7075*    COPY ELCDAR.
  7076******************************************************************
  7077*                                                                *
  7078*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7079*   FILE TYPE = VSAM,KSDS                                        *
  7080*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7081*   BASE CLUSTER = DLYACTV                                       *
  7082*   LOG = YES                                                    *
  7083*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7084*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7085*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7086*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7087*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7088*               BY PROGRAM "LGINFCE".                            *
  7089*                                                                *
  7090******************************************************************
  7091 01  DAILY-ACTIVITY-RECORD.
  7092     05  DA-KEY.
  7093         10  DA-COMP-CD          PIC X.
  7094         10  DA-CARRIER          PIC X.
  7095         10  DA-CLAIM-NO         PIC X(7).
  7096         10  DA-CERT-NO.
  7097             15  DA-CERT-PRIME   PIC X(10).
  7098             15  DA-CERT-SFX     PIC X.
  7099     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7100     05  DA-RECORD-TYPE          PIC X.
  7101     05  FILLER                  PIC X(2).
  7102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 136
* EL156.cbl
  7104*    COPY ERCCOMP.
  7105******************************************************************
  7106*                                                                *
  7107*                                                                *
  7108*                            ERCCOMP                             *
  7109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7110*                            VMOD=2.019                          *
  7111*                                                                *
  7112*   ONLINE CREDIT SYSTEM                                         *
  7113*                                                                *
  7114*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7115*                                                                *
  7116*   FILE TYPE = VSAM,KSDS                                        *
  7117*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7118*                                                                *
  7119*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7120*       ALTERNATE PATH = NONE                                    *
  7121*                                                                *
  7122*   LOG = NO                                                     *
  7123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7124*                                                                *
  7125******************************************************************
  7126*                   C H A N G E   L O G
  7127*
  7128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7129*-----------------------------------------------------------------
  7130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7131* EFFECTIVE    NUMBER
  7132*-----------------------------------------------------------------
  7133* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7134* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7135* 092205    2005050300006  PEMA  ADD LEASE FEE
  7136* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7137* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7138* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7139* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7140* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7141******************************************************************
  7142
  7143 01  COMPENSATION-MASTER.
  7144     12  CO-RECORD-ID                          PIC XX.
  7145         88  VALID-CO-ID                          VALUE 'CO'.
  7146
  7147     12  CO-CONTROL-PRIMARY.
  7148         16  CO-COMPANY-CD                     PIC X.
  7149         16  CO-CONTROL.
  7150             20  CO-CTL-1.
  7151                 24  CO-CARR-GROUP.
  7152                     28  CO-CARRIER            PIC X.
  7153                     28  CO-GROUPING.
  7154                         32  CO-GROUP-PREFIX   PIC XXX.
  7155                         32  CO-GROUP-PRIME    PIC XXX.
  7156                 24  CO-RESP-NO.
  7157                     28  CO-RESP-PREFIX        PIC X(4).
  7158                     28  CO-RESP-PRIME         PIC X(6).
  7159             20  CO-CTL-2.
  7160                 24  CO-ACCOUNT.
  7161                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 137
* EL156.cbl
  7162                     28  CO-ACCT-PRIME         PIC X(6).
  7163         16  CO-TYPE                           PIC X.
  7164             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7165             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7166             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7167
  7168     12  CO-MAINT-INFORMATION.
  7169         16  CO-LAST-MAINT-DT                  PIC XX.
  7170         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7171         16  CO-LAST-MAINT-USER                PIC X(4).
  7172     12  FILLER                                PIC XX.
  7173     12  CO-STMT-TYPE                          PIC XXX.
  7174     12  CO-COMP-TYPE                          PIC X.
  7175         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7176     12  CO-STMT-OWNER                         PIC X(4).
  7177     12  CO-BALANCE-CONTROL                    PIC X.
  7178         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7179         88  CO-NO-BALANCE                        VALUE 'N'.
  7180
  7181     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7182         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7183         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7184         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7185
  7186     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7187         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7188         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7189
  7190     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7191     12  CO-GA-DIRECT-DEP                      PIC X.
  7192     12  CO-FUTURE-SPACE                       PIC X.
  7193         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7194
  7195     12  CO-ACCT-NAME                          PIC X(30).
  7196     12  CO-MAIL-NAME                          PIC X(30).
  7197     12  CO-ADDR-1                             PIC X(30).
  7198     12  CO-ADDR-2                             PIC X(30).
  7199     12  CO-ADDR-3.
  7200         16  CO-ADDR-CITY                      PIC X(27).
  7201         16  CO-ADDR-STATE                     PIC XX.
  7202     12  CO-CSO-1099                           PIC X.
  7203     12  CO-ZIP.
  7204         16  CO-ZIP-PRIME.
  7205             20  CO-ZIP-PRI-1ST                PIC X.
  7206                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7207             20  FILLER                        PIC X(4).
  7208         16  CO-ZIP-PLUS4                      PIC X(4).
  7209     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7210         16  CO-CAN-POSTAL-1                   PIC XXX.
  7211         16  CO-CAN-POSTAL-2                   PIC XXX.
  7212         16  FILLER                            PIC XXX.
  7213     12  CO-SOC-SEC                            PIC X(13).
  7214     12  CO-TELEPHONE.
  7215         16  CO-AREA-CODE                      PIC XXX.
  7216         16  CO-PREFIX                         PIC XXX.
  7217         16  CO-PHONE                          PIC X(4).
  7218
  7219     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 138
* EL156.cbl
  7220
  7221     12  CO-AR-BAL-LEVEL                       PIC X.
  7222         88  CO-AR-REF-LVL                        VALUE '1'.
  7223         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7224         88  CO-AR-BILL-LVL                       VALUE '2'.
  7225         88  CO-AR-AGT-LVL                        VALUE '3'.
  7226         88  CO-AR-FR-LVL                         VALUE '4'.
  7227
  7228     12  CO-AR-NORMAL-PRINT                    PIC X.
  7229         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7230         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7231
  7232     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7233
  7234     12  CO-AR-REPORTING                       PIC X.
  7235         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7236         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7237
  7238     12  CO-AR-PULL-CHECK                      PIC X.
  7239         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7240         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7241
  7242     12  CO-AR-BALANCE-PRINT                   PIC X.
  7243         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7244
  7245     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7246         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7247         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7248         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7249
  7250     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7251
  7252     12  CO-USER-CODE                          PIC X.
  7253     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7254
  7255******************************************************************
  7256*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7257*    THE LAST MONTH END RUN.
  7258******************************************************************
  7259
  7260     12  CO-LAST-ACTIVITY-DATE.
  7261         16  CO-ACT-YEAR                       PIC 99.
  7262         16  CO-ACT-MONTH                      PIC 99.
  7263         16  CO-ACT-DAY                        PIC 99.
  7264
  7265     12  CO-LAST-STMT-DT.
  7266         16  CO-LAST-STMT-YEAR                 PIC 99.
  7267         16  CO-LAST-STMT-MONTH                PIC 99.
  7268         16  CO-LAST-STMT-DAY                  PIC 99.
  7269
  7270     12  CO-MO-END-TOTALS.
  7271         16  CO-MONTHLY-TOTALS.
  7272             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7273             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7274             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7275             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7276             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  7277
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 139
* EL156.cbl
  7278         16  CO-AGING-TOTALS.
  7279             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7280             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7281             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7282             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7283
  7284         16  CO-YTD-TOTALS.
  7285             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7286             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7287
  7288         16  CO-OVER-UNDER-TOTALS.
  7289             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7290             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7291
  7292     12  CO-MISCELLANEOUS-TOTALS.
  7293         16  CO-FICA-TOTALS.
  7294             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7295             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7296
  7297         16  CO-CLAIM-TOTALS.
  7298             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7299             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7300
  7301******************************************************************
  7302*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7303*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7304******************************************************************
  7305
  7306     12  CO-CURRENT-TOTALS.
  7307         16  CO-CURRENT-LAST-STMT-DT.
  7308             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7309             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7310             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7311
  7312         16  CO-CURRENT-MONTHLY-TOTALS.
  7313             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7314             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7315             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7316             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7317             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7318
  7319         16  CO-CURRENT-AGING-TOTALS.
  7320             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7321             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7322             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7323             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7324
  7325         16  CO-CURRENT-YTD-TOTALS.
  7326             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7327             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7328
  7329     12  CO-PAID-COMM-TOTALS.
  7330         16  CO-YTD-PAID-COMMS.
  7331             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7332             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7333
  7334     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  7335         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 140
* EL156.cbl
  7336         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7337
  7338     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7339         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7340         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7341         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7342         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7343         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7344         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7345         88  CO-FINAL-LETTER                  VALUE 'F'.
  7346         88  CO-RECONCILING                   VALUE 'R'.
  7347         88  CO-PHONE-CALL                    VALUE 'P'.
  7348         88  CO-LEGAL                         VALUE 'L'.
  7349         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7350         88  CO-WRITE-OFF                     VALUE 'W'.
  7351         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7352
  7353     12  CO-CSR-CODE                       PIC X(4).
  7354
  7355     12  CO-GA-STATUS-INFO.
  7356         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7357         16  CO-GA-TERMINATION-DT          PIC XX.
  7358         16  CO-GA-STATUS-CODE             PIC X.
  7359             88  CO-GA-ACTIVE                 VALUE 'A'.
  7360             88  CO-GA-INACTIVE               VALUE 'I'.
  7361             88  CO-GA-PENDING                VALUE 'P'.
  7362         16  CO-GA-COMMENTS.
  7363             20  CO-GA-COMMENT-1           PIC X(40).
  7364             20  CO-GA-COMMENT-2           PIC X(40).
  7365             20  CO-GA-COMMENT-3           PIC X(40).
  7366             20  CO-GA-COMMENT-4           PIC X(40).
  7367
  7368     12  CO-RPTCD2                         PIC X(10).
  7369
  7370     12  CO-TYPE-AGENT                     PIC X(01).
  7371         88  CO-CORPORATION                   VALUE 'C'.
  7372         88  CO-PARTNERSHIP                   VALUE 'P'.
  7373         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7374         88  CO-TRUST                         VALUE 'T'.
  7375         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7376
  7377     12  CO-FAXNO.
  7378         16  CO-FAX-AREA-CODE                  PIC XXX.
  7379         16  CO-FAX-PREFIX                     PIC XXX.
  7380         16  CO-FAX-PHONE                      PIC X(4).
  7381
  7382     12  CO-BANK-INFORMATION.
  7383         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7384         16  CO-BANK-TRANSIT-NON REDEFINES
  7385             CO-BANK-TRANSIT-NO                PIC 9(8).
  7386
  7387         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7388     12  CO-MISC-DEDUCT-INFO REDEFINES
  7389                  CO-BANK-INFORMATION.
  7390         16  CO-MD-GL-ACCT                     PIC X(10).
  7391         16  CO-MD-DIV                         PIC XX.
  7392         16  CO-MD-CENTER                      PIC X(4).
  7393         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 141
* EL156.cbl
  7394         16  CO-CREATE-AP-CHECK                PIC X.
  7395         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7396         16  FILLER                            PIC XXX.
  7397     12  CO-ACH-STATUS                         PIC X.
  7398         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7399         88  CO-ACH-PENDING                        VALUE 'P'.
  7400
  7401     12  CO-BILL-SW                            PIC X.
  7402     12  CO-CONTROL-NAME                       PIC X(30).
  7403     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7404     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7405     12  CO-CLP-STATE                          PIC XX.
  7406     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7407     12  CO-SPP-REFUND-EDIT                    PIC X.
  7408
  7409******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 142
* EL156.cbl
  7411*    COPY ERCDMDNT.
  7412******************************************************************
  7413*                                                                *
  7414*                            ERCDMDNT                            *
  7415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7416*                            VMOD=2.005                          *
  7417*                                                                *
  7418*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7419*                                                                *
  7420*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7421*                                                                *
  7422*        FILE TYPE= VSAM,KSDS                                    *
  7423*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7424*                                                                *
  7425*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7426*                                                                *
  7427*        LOG = YES                                               *
  7428*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7429*                                                                *
  7430******************************************************************
  7431
  7432 01  CERTIFICATE-NOTE.
  7433     12  CN-RECORD-ID                     PIC  XX.
  7434         88  VALID-CN-ID                      VALUE 'CN'.
  7435
  7436     12  CN-CONTROL-PRIMARY.
  7437         16  CN-COMPANY-CD                PIC X.
  7438         16  CN-CERT-KEY.
  7439             20  CN-CARRIER               PIC X.
  7440             20  CN-GROUPING.
  7441                 24  CN-GROUPING-PREFIX   PIC XXX.
  7442                 24  CN-GROUPING-PRIME    PIC XXX.
  7443             20  CN-STATE                 PIC XX.
  7444             20  CN-ACCOUNT.
  7445                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7446                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7447             20  CN-CERT-EFF-DT           PIC XX.
  7448             20  CN-CERT-NO.
  7449                 24  CN-CERT-PRIME        PIC X(10).
  7450                 24  CN-CERT-SFX          PIC X.
  7451
  7452     12  CN-BILLING-START-LINE-NO         PIC 99.
  7453     12  CN-BILLING-END-LINE-NO           PIC 99.
  7454
  7455     12  CN-LINES.
  7456         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7457
  7458     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7459         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7460         16  CN-CSI-GENERAL-DATA-AREA.
  7461             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7462
  7463         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7464             CN-CSI-GENERAL-DATA-AREA.
  7465             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7466             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7467             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7468             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 143
* EL156.cbl
  7469             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7470             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7471             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7472             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7473             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7474             20  FILLER                       PIC XX.
  7475             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7476             20  FILLER                       PIC X(38).
  7477
  7478         16  CN-CSI-PRODUCT-DATA-AREA.
  7479             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7480
  7481         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7482             CN-CSI-PRODUCT-DATA-AREA.
  7483             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7484             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7485             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7486             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7487             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7488             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7489             20  FILLER                   PIC XX.
  7490             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7491             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7492             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7493             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7494             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7495             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7496             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7497             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7498             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7499             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7500             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7501             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7502             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7503             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7504             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7505             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7506             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7507             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7508             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7509             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7510             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7511             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7512             20  FILLER                   PIC X(25).
  7513
  7514         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7515             CN-CSI-CREDIT-CARD-DATA.
  7516             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7517             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7518             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7519             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7520             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7521             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7522             20  FILLER                   PIC XX.
  7523             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7524             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7525             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7526             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 144
* EL156.cbl
  7527             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7528             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7529             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7530             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7531             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7532             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7533             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7534             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7535             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7536             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7537             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7538             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7539             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7540             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7541             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7542             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7543             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7544             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7545             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7546             20  FILLER                   PIC X(17).
  7547
  7548         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7549             CN-CSI-FAMILY-LEAVE-DATA.
  7550             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7551             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7552             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7553             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7554             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7555             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7556             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7557             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7558             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7559             20  CN-CSI-SL-INT-ON-PROCEEDS
  7560                                          PIC S9(5)V99  COMP-3.
  7561             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7562             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7563             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7564             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7565             20  CN-CSI-SL-POLICY-BENEFITS
  7566                                          PIC S9(5)V99  COMP-3.
  7567             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7568             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7569             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7570             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7571             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7572             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7573             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7574             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7575             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7576             20  CN-CSI-SL-STATE-NOT      PIC X.
  7577             20  FILLER                   PIC XX.
  7578
  7579         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7580             CN-CSI-SENIOR-LIFE-DATA.
  7581             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7582             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7583             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7584                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 145
* EL156.cbl
  7585             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7586             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7587             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7588             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7589             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7590             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7591             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7592             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7593             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7594             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7595             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7596             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7597             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7598             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7599             20  CN-CSI-PP-REPAIR         PIC X.
  7600             20  CN-CSI-PP-REPLACE        PIC X.
  7601             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7602             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7603             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7604             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7605             20  FILLER                   PIC X(5).
  7606
  7607         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7608             CN-CSI-PURCH-PROP-DATA.
  7609             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7610             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7611             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7612             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7613             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7614             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7615             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7616             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7617             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7618             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7619             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7620             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7621             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7622             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7623             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7624             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7625             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7626             20  CN-CSI-EW-REPLACE        PIC X.
  7627             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7628             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7629             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7630             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7631             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7632             20  FILLER                   PIC X(4).
  7633
  7634     12  CN-LAST-MAINT-DT                 PIC XX.
  7635     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7636     12  CN-LAST-MAINT-USER               PIC X(4).
  7637     12  FILLER                           PIC X(6).
  7638
  7639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 146
* EL156.cbl
  7641*    COPY ERCCNOT.
  7642******************************************************************
  7643*                                                                *
  7644*                            ERCCNOT                             *
  7645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7646*                            VMOD=2.003                          *
  7647*                                                                *
  7648*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7649*                                                                *
  7650*        FILE TYPE= VSAM,KSDS                                    *
  7651*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7652*                                                                *
  7653*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7654*                                                                *
  7655*        LOG = YES                                               *
  7656*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7657*                                                                *
  7658******************************************************************
  7659*                   C H A N G E   L O G
  7660*
  7661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7662*-----------------------------------------------------------------
  7663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7664* EFFECTIVE    NUMBER
  7665*-----------------------------------------------------------------
  7666* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7667******************************************************************
  7668
  7669 01  CERT-NOTE-FILE.
  7670     12  CZ-RECORD-ID                PIC  XX.
  7671         88  VALID-CZ-ID                  VALUE 'CZ'.
  7672
  7673     12  CZ-CONTROL-PRIMARY.
  7674         16  CZ-COMPANY-CD           PIC X.
  7675         16  CZ-CARRIER              PIC X.
  7676         16  CZ-GROUPING.
  7677             20 CZ-GROUPING-PREFIX   PIC XXX.
  7678             20 CZ-GROUPING-PRIME    PIC XXX.
  7679         16  CZ-STATE                PIC XX.
  7680         16  CZ-ACCOUNT.
  7681             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7682             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7683         16  CZ-CERT-EFF-DT          PIC XX.
  7684         16  CZ-CERT-NO.
  7685             20  CZ-CERT-PRIME       PIC X(10).
  7686             20  CZ-CERT-SFX         PIC X.
  7687         16  CZ-RECORD-TYPE          PIC X.
  7688             88  CERT-NOTE           VALUE '1'.
  7689             88  CLAIM-CERT-NOTE     VALUE '2'.
  7690         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7691
  7692     12  CZ-LAST-MAINT-DT            PIC XX.
  7693     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7694     12  CZ-LAST-MAINT-USER          PIC X(4).
  7695
  7696     12  CZ-NOTE-INFORMATION.
  7697         16  CZ-NOTE                 PIC X(63).
  7698         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 147
* EL156.cbl
  7699******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 148
* EL156.cbl
  7701 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7702                          CONTROL-FILE CERTIFICATE-MASTER
  7703                          ACTIVITY-TRAILERS ACTIVITY-QUE
  7704                          ACCOUNT-MASTER CHECK-QUE
  7705                          BENEFICIARY-MASTER LETTER-ARCHIVE
  7706                          DAILY-ACTIVITY-RECORD
  7707                          COMPENSATION-MASTER CERTIFICATE-NOTE
  7708                          CERT-NOTE-FILE.
  7709 0000-DFHEXIT SECTION.
  7710     MOVE '9#                    $   ' TO DFHEIV0.
  7711     MOVE 'EL156' TO DFHEIV1.
  7712     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7713
  7714     IF EIBCALEN = 0
  7715         GO TO 8800-UNAUTHORIZED-ACCESS.
  7716
  7717     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7718     MOVE EIBTRMID               TO QID-TERM.
  7719     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7720     MOVE '2'                    TO EMI-SWITCH2.
  7721     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7722     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7723
  7724     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7725     MOVE '5'                    TO DC-OPTION-CODE.
  7726     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7727     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  7728                                    SAVE-BIN-DATE.
  7729     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  7730     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  7731
  7732     IF SAVE-DATE-YY > 70
  7733         MOVE 19                 TO SAVE-DATE-CC
  7734     ELSE
  7735         MOVE 20                 TO SAVE-DATE-CC.
  7736
  7737     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  7738         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  7739     END-IF.
  7740
  7741     IF PI-PRINT-EOB-YN = 'Y'
  7742        MOVE 'Y'                 TO WS-PRINT-EOB-YN
  7743     ELSE
  7744        MOVE 'N'                 TO WS-PRINT-EOB-YN
  7745     END-IF
  7746
  7747* EXEC CICS HANDLE CONDITION
  7748*        NOTOPEN   (9990-ABEND)
  7749*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  7750*        MAPFAIL   (0400-FIRST-TIME)
  7751*        DUPREC    (6180-DUPREC)
  7752*        ERROR     (9990-ABEND)
  7753*    END-EXEC.
  7754*    MOVE '"$JL?%.               ! " #00007742' TO DFHEIV0
  7755     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7757     MOVE X'2220233030303037373432' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 149
* EL156.cbl
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7760
  7761
  7762     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7763         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  7764
  7765     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7766         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7767             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7768             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7769             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7770             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7771             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7772             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7773             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7774             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7775             MOVE LOW-VALUES           TO EL156AI
  7776             MOVE 'Y'                  TO FIRST-ENTRY
  7777         ELSE
  7778             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7779             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7780             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7781             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7782             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7783             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7784             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7785             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  7786
  7787     IF RETURNED-FROM NOT = SPACES
  7788        IF (RETURNED-FROM = 'EL614')
  7789           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  7790           IF WS-SAVED-EOB-CODES NOT = SPACES
  7791              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  7792           ELSE
  7793              MOVE 'N'                TO WS-SET-NOTE2-MDT
  7794           END-IF
  7795        END-IF
  7796         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7797            MOVE 'Y'             TO FIRST-ENTRY
  7798            IF RETURNED-FROM = 'EL614'
  7799               AND (PI-PASS-SW NOT = 'C')
  7800               IF WS-SAVED-EOB-CODES NOT = SPACES
  7801                  MOVE WS-SAVED-EOB-CODES
  7802                                 TO PI-PMTNOTE2
  7803                                    WS-PMTNOTE2
  7804                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  7805               ELSE
  7806                  MOVE SPACES    TO PI-PMTNOTE2
  7807                                    WS-PMTNOTE2
  7808                                    PI-EOB-CODES-EXIST
  7809               END-IF
  7810            END-IF
  7811            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  7812            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  7813            IF RETURNED-FROM = 'EL614'
  7814               GO TO 1000-EDIT-DATA
  7815            END-IF
  7816            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 150
* EL156.cbl
  7817               (PAYEEI   = LOW-VALUES OR SPACES)
  7818               GO TO 8100-SEND-INITIAL-MAP
  7819            ELSE
  7820               GO TO 1000-EDIT-DATA.
  7821
  7822     IF EIBTRNID NOT = TRANS-ID
  7823         GO TO 0400-FIRST-TIME.
  7824
  7825     IF EIBAID = DFHCLEAR
  7826        IF PI-PASS-SW = 'C'
  7827           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  7828           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  7829           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  7830           MOVE 'Y'            TO RETURNED-FROM-B
  7831           GO TO 1000-EDIT-DATA
  7832        ELSE
  7833           GO TO 9400-CLEAR.
  7834
  7835     IF PI-PASS-SW = 'C'
  7836         MOVE MAP-NAMEB          TO MAP-NAME
  7837         IF EIBAID = DFHPF1 OR DFHPF13
  7838             GO TO 5000-UPDATE
  7839           ELSE
  7840             IF EIBAID NOT = DFHENTER
  7841                 MOVE LOW-VALUES TO EL156BI
  7842                 MOVE MAP-NAMEB  TO MAP-NAME
  7843                 MOVE ER-0029    TO EMI-ERROR
  7844                 MOVE -1         TO  ENTPFBL
  7845                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7846                 GO TO 8200-SEND-DATAONLY.
  7847
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 151
* EL156.cbl
  7849 0200-RECEIVE.
  7850     MOVE LOW-VALUES             TO EL156AI.
  7851     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7852         MOVE ER-0008            TO EMI-ERROR
  7853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7854         IF PI-PASS-SW = 'C'
  7855             MOVE -1             TO ENTPFBL
  7856             GO TO 8200-SEND-DATAONLY
  7857         ELSE
  7858             MOVE -1             TO PMTTYPEL
  7859             GO TO 8200-SEND-DATAONLY.
  7860
  7861     IF PI-COMPANY-ID = 'DMD'
  7862         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  7863
  7864     IF PI-PASS-SW = 'C'
  7865         MOVE MAP-NAMEB          TO MAP-NAME.
  7866
  7867
  7868* EXEC CICS RECEIVE
  7869*        MAP   (MAP-NAME)
  7870*        MAPSET(MAPSET-NAME)
  7871*        ASIS
  7872*        INTO  (EL156AI)
  7873*    END-EXEC.
  7874     MOVE LENGTH OF
  7875      EL156AI
  7876       TO DFHEIV11
  7877*    MOVE '8"TAI  L              ''   #00007855' TO DFHEIV0
  7878     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7880     MOVE X'2020233030303037383535' TO DFHEIV0(25:11)
  7881     CALL 'kxdfhei1' USING DFHEIV0,
  7882           MAP-NAME,
  7883           EL156AI,
  7884           DFHEIV11,
  7885           MAPSET-NAME,
  7886           DFHEIV99,
  7887           DFHEIV99
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7889
  7890
  7891     IF PI-PASS-SW NOT = 'C'
  7892         GO TO 0250-MAPA.
  7893
  7894     IF ENTPFBL NOT > ZERO
  7895         MOVE MAP-NAMEB          TO MAP-NAME
  7896         MOVE ER-0029            TO EMI-ERROR
  7897         MOVE -1                 TO  ENTPFBL
  7898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7899         GO TO 8200-SEND-DATAONLY.
  7900
  7901     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  7902         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  7903       ELSE
  7904         MOVE MAP-NAMEB           TO MAP-NAME
  7905         MOVE ER-0029             TO EMI-ERROR
  7906         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 152
* EL156.cbl
  7907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7908         GO TO 8200-SEND-DATAONLY.
  7909
  7910     IF EIBAID = DFHPF1 OR DFHPF13
  7911         IF MODIFY-CAP
  7912            GO TO 5000-UPDATE
  7913          ELSE
  7914            MOVE 'UPDATE'           TO SM-READ
  7915            PERFORM 9995-SECURITY-VIOLATION
  7916            MOVE MAP-NAMEB          TO MAP-NAME
  7917            MOVE ER-0070            TO EMI-ERROR
  7918            MOVE -1                 TO  ENTPFBL
  7919            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7920            GO TO 8200-SEND-DATAONLY.
  7921
  7922 0250-MAPA.
  7923     IF ENTERPFL = 0
  7924         GO TO 0300-CHECK-PFKEYS.
  7925
  7926     IF EIBAID NOT = DFHENTER
  7927         MOVE ER-0004            TO EMI-ERROR
  7928         GO TO 0320-INPUT-ERROR.
  7929
  7930     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7931         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7932     ELSE
  7933         MOVE ER-0029            TO EMI-ERROR
  7934         GO TO 0320-INPUT-ERROR.
  7935
  7936 0300-CHECK-PFKEYS.
  7937     IF EIBAID = DFHPF7 OR DFHPF8
  7938         GO TO 8820-PF7-8.
  7939
  7940     IF EIBAID = DFHPF23
  7941         GO TO 8810-PF23.
  7942
  7943     IF EIBAID = DFHPF24
  7944         GO TO 9200-RETURN-MAIN-MENU.
  7945
  7946     IF EIBAID = DFHPF12
  7947         GO TO 9500-PF12.
  7948
  7949     IF EIBAID = DFHPF1
  7950        IF PI-PASS-SW = 'A' OR 'B'
  7951          GO TO 0330-BROWSE-FORWARD.
  7952
  7953     IF EIBAID = DFHPF2
  7954        IF PI-PASS-SW = 'A' OR 'B'
  7955          GO TO 0350-BROWSE-BACKWARD.
  7956
  7957     IF EIBAID = DFHPF6
  7958        IF PI-EOB-CODES-EXIST = 'Y'
  7959           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  7960        ELSE
  7961           MOVE SPACES              TO WS-PMTNOTE2
  7962        END-IF
  7963         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  7964         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 153
* EL156.cbl
  7965            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  7966         END-IF
  7967         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7968         IF PI-COMPANY-ID = 'CID' OR 'DCC'
  7969             MOVE 'EL614'        TO PGM-NAME
  7970             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  7971             GO TO 9300-XCTL
  7972         ELSE
  7973             MOVE XCTL-157       TO PGM-NAME
  7974             GO TO 9300-XCTL.
  7975
  7976     IF EIBAID = DFHPF9
  7977        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7978        MOVE XCTL-141            TO PGM-NAME
  7979        GO TO 9300-XCTL.
  7980
  7981     IF EIBAID = DFHPF10
  7982        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  7983        MOVE XCTL-155            TO PGM-NAME
  7984        GO TO 9300-XCTL.
  7985
  7986     MOVE SPACES                 TO ERRMSG0O
  7987                                    ERRMSG1O
  7988                                    ERRMSG2O.
  7989
  7990     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  7991         IF PI-PASS-SW NOT = 'B'
  7992             MOVE ER-0422        TO EMI-ERROR
  7993             GO TO 0320-INPUT-ERROR
  7994           ELSE
  7995             GO TO 0700-TEST-FOR-CHANGES.
  7996
  7997     IF EIBAID = DFHPF11
  7998        IF PI-PASS-SW = 'C'
  7999           MOVE ER-0029          TO EMI-ERROR
  8000           GO TO 0320-INPUT-ERROR.
  8001
  8002     IF EIBAID = DFHENTER OR DFHPF11
  8003        NEXT SENTENCE
  8004     ELSE
  8005        MOVE ER-0029             TO EMI-ERROR
  8006        GO TO 0320-INPUT-ERROR.
  8007
  8008     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8009
  8010     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8011         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8012         GO TO 1000-EDIT-DATA
  8013     ELSE
  8014         IF PI-FATAL-COUNT NOT = 0 OR
  8015            PI-FORCE-COUNT NOT = 0
  8016             GO TO 1000-EDIT-DATA
  8017         ELSE
  8018             GO TO 2000-EDIT-DONE.
  8019
  8020 0320-INPUT-ERROR.
  8021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8022
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 154
* EL156.cbl
  8023     IF ENTERPFL = 0
  8024         MOVE -1                 TO PMTTYPEL
  8025     ELSE
  8026         MOVE AL-UNBON           TO ENTERPFA
  8027         MOVE -1                 TO ENTERPFL.
  8028
  8029     GO TO 8200-SEND-DATAONLY.
  8030
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 155
* EL156.cbl
  8032 0330-BROWSE-FORWARD.
  8033
  8034     MOVE CLMNOI            TO PI-CLAIM-NO.
  8035     MOVE CARRI             TO PI-CARRIER.
  8036     MOVE CERTNOI           TO PI-CERT-PRIME.
  8037     MOVE SUFXI             TO PI-CERT-SFX.
  8038
  8039     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8040     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8041     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8042     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8043
  8044     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8045
  8046
  8047* EXEC CICS HANDLE CONDITION
  8048*         NOTFND   (0380-CLAIM-END-FILE)
  8049*         ENDFILE  (0380-CLAIM-END-FILE)
  8050*    END-EXEC.
  8051*    MOVE '"$I''                  ! # #00008017' TO DFHEIV0
  8052     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8054     MOVE X'2320233030303038303137' TO DFHEIV0(25:11)
  8055     CALL 'kxdfhei1' USING DFHEIV0
  8056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8057
  8058
  8059
  8060* EXEC CICS STARTBR
  8061*         DATASET    ('ELMSTR')
  8062*         RIDFLD     (ELMSTR-KEY)
  8063*         GTEQ
  8064*    END-EXEC.
  8065     MOVE 'ELMSTR' TO DFHEIV1
  8066     MOVE 0
  8067       TO DFHEIV11
  8068*    MOVE '&,         G          &   #00008022' TO DFHEIV0
  8069     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8070     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8071     MOVE X'2020233030303038303232' TO DFHEIV0(25:11)
  8072     CALL 'kxdfhei1' USING DFHEIV0,
  8073           DFHEIV1,
  8074           ELMSTR-KEY,
  8075           DFHEIV99,
  8076           DFHEIV11,
  8077           DFHEIV99
  8078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8079
  8080
  8081     MOVE 'Y' TO WS-BROWSE-START-SW.
  8082
  8083 0335-READNEXT.
  8084
  8085
  8086* EXEC CICS READNEXT
  8087*         DATASET    ('ELMSTR')
  8088*         RIDFLD     (ELMSTR-KEY)
  8089*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 156
* EL156.cbl
  8090*    END-EXEC.
  8091     MOVE 'ELMSTR' TO DFHEIV1
  8092     MOVE 0
  8093       TO DFHEIV11
  8094*    MOVE '&.S                   )   #00008032' TO DFHEIV0
  8095     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8096     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8097     MOVE X'2020233030303038303332' TO DFHEIV0(25:11)
  8098     CALL 'kxdfhei1' USING DFHEIV0,
  8099           DFHEIV1,
  8100           DFHEIV20,
  8101           DFHEIV99,
  8102           ELMSTR-KEY,
  8103           DFHEIV99,
  8104           DFHEIV11,
  8105           DFHEIV99,
  8106           DFHEIV99
  8107     SET ADDRESS OF CLAIM-MASTER TO
  8108         DFHEIV20
  8109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8110
  8111
  8112     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8113        GO TO 0380-CLAIM-END-FILE.
  8114
  8115     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8116        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8117        GO TO 0335-READNEXT.
  8118
  8119     IF PI-COMPANY-ID = 'CRI'
  8120         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8121            GO TO 0380-CLAIM-END-FILE.
  8122
  8123     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8124         GO TO 0335-READNEXT.
  8125
  8126     IF PI-CARRIER-SECURITY > SPACES
  8127         IF CL-CARRIER = PI-CARRIER-SECURITY
  8128             NEXT SENTENCE
  8129         ELSE
  8130             GO TO 0335-READNEXT.
  8131
  8132     IF PI-ACCOUNT-SECURITY > SPACES
  8133         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8134             NEXT SENTENCE
  8135         ELSE
  8136             GO TO 0335-READNEXT.
  8137
  8138     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8139     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8140     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8141
  8142     GO TO 0400-FIRST-TIME.
  8143
  8144 0350-BROWSE-BACKWARD.
  8145
  8146     MOVE CLMNOI            TO PI-CLAIM-NO
  8147                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 157
* EL156.cbl
  8148     MOVE CARRI             TO PI-CARRIER.
  8149     MOVE CERTNOI           TO PI-CERT-PRIME.
  8150     MOVE SUFXI             TO PI-CERT-SFX.
  8151
  8152     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8153
  8154     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8155     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8156     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8157
  8158
  8159* EXEC CICS HANDLE CONDITION
  8160*         NOTFND   (0380-CLAIM-END-FILE)
  8161*         ENDFILE  (0380-CLAIM-END-FILE)
  8162*    END-EXEC.
  8163*    MOVE '"$I''                  ! $ #00008084' TO DFHEIV0
  8164     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8166     MOVE X'2420233030303038303834' TO DFHEIV0(25:11)
  8167     CALL 'kxdfhei1' USING DFHEIV0
  8168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8169
  8170
  8171
  8172* EXEC CICS STARTBR
  8173*         DATASET    ('ELMSTR')
  8174*         RIDFLD     (ELMSTR-KEY)
  8175*         GTEQ
  8176*    END-EXEC.
  8177     MOVE 'ELMSTR' TO DFHEIV1
  8178     MOVE 0
  8179       TO DFHEIV11
  8180*    MOVE '&,         G          &   #00008089' TO DFHEIV0
  8181     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8182     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8183     MOVE X'2020233030303038303839' TO DFHEIV0(25:11)
  8184     CALL 'kxdfhei1' USING DFHEIV0,
  8185           DFHEIV1,
  8186           ELMSTR-KEY,
  8187           DFHEIV99,
  8188           DFHEIV11,
  8189           DFHEIV99
  8190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8191
  8192
  8193     MOVE 'Y' TO WS-BROWSE-START-SW.
  8194
  8195
  8196* EXEC CICS READNEXT
  8197*         DATASET    ('ELMSTR')
  8198*         RIDFLD     (ELMSTR-KEY)
  8199*         SET        (ADDRESS OF CLAIM-MASTER)
  8200*    END-EXEC.
  8201     MOVE 'ELMSTR' TO DFHEIV1
  8202     MOVE 0
  8203       TO DFHEIV11
  8204*    MOVE '&.S                   )   #00008097' TO DFHEIV0
  8205     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 158
* EL156.cbl
  8206     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8207     MOVE X'2020233030303038303937' TO DFHEIV0(25:11)
  8208     CALL 'kxdfhei1' USING DFHEIV0,
  8209           DFHEIV1,
  8210           DFHEIV20,
  8211           DFHEIV99,
  8212           ELMSTR-KEY,
  8213           DFHEIV99,
  8214           DFHEIV11,
  8215           DFHEIV99,
  8216           DFHEIV99
  8217     SET ADDRESS OF CLAIM-MASTER TO
  8218         DFHEIV20
  8219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8220
  8221
  8222
  8223* EXEC CICS READPREV
  8224*         DATASET    ('ELMSTR')
  8225*         RIDFLD     (ELMSTR-KEY)
  8226*         SET        (ADDRESS OF CLAIM-MASTER)
  8227*    END-EXEC.
  8228     MOVE 'ELMSTR' TO DFHEIV1
  8229     MOVE 0
  8230       TO DFHEIV11
  8231*    MOVE '&0S                   )   #00008103' TO DFHEIV0
  8232     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8233     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8234     MOVE X'2020233030303038313033' TO DFHEIV0(25:11)
  8235     CALL 'kxdfhei1' USING DFHEIV0,
  8236           DFHEIV1,
  8237           DFHEIV20,
  8238           DFHEIV99,
  8239           ELMSTR-KEY,
  8240           DFHEIV99,
  8241           DFHEIV11,
  8242           DFHEIV99,
  8243           DFHEIV99
  8244     SET ADDRESS OF CLAIM-MASTER TO
  8245         DFHEIV20
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8247
  8248
  8249 0360-BROWSE-BACKWARD.
  8250
  8251
  8252* EXEC CICS READPREV
  8253*         DATASET    ('ELMSTR')
  8254*         RIDFLD     (ELMSTR-KEY)
  8255*         SET        (ADDRESS OF CLAIM-MASTER)
  8256*    END-EXEC.
  8257     MOVE 'ELMSTR' TO DFHEIV1
  8258     MOVE 0
  8259       TO DFHEIV11
  8260*    MOVE '&0S                   )   #00008111' TO DFHEIV0
  8261     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8262     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8263     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 159
* EL156.cbl
  8264     CALL 'kxdfhei1' USING DFHEIV0,
  8265           DFHEIV1,
  8266           DFHEIV20,
  8267           DFHEIV99,
  8268           ELMSTR-KEY,
  8269           DFHEIV99,
  8270           DFHEIV11,
  8271           DFHEIV99,
  8272           DFHEIV99
  8273     SET ADDRESS OF CLAIM-MASTER TO
  8274         DFHEIV20
  8275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8276
  8277
  8278     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8279        GO TO 0380-CLAIM-END-FILE.
  8280
  8281     IF PI-COMPANY-ID = 'CRI'
  8282         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8283            GO TO 0380-CLAIM-END-FILE.
  8284
  8285     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8286         GO TO 0360-BROWSE-BACKWARD.
  8287
  8288     IF PI-CARRIER-SECURITY > SPACES
  8289         IF CL-CARRIER = PI-CARRIER-SECURITY
  8290             NEXT SENTENCE
  8291         ELSE
  8292             GO TO 0360-BROWSE-BACKWARD.
  8293
  8294     IF PI-ACCOUNT-SECURITY > SPACES
  8295         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8296             NEXT SENTENCE
  8297         ELSE
  8298             GO TO 0360-BROWSE-BACKWARD.
  8299
  8300     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8301     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8302     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8303
  8304     GO TO 0400-FIRST-TIME.
  8305
  8306 0380-CLAIM-END-FILE.
  8307
  8308     MOVE ER-0130     TO EMI-ERROR.
  8309     MOVE -1          TO CLMNOL.
  8310     MOVE AL-UABON    TO CARRA
  8311                         CLMNOA
  8312                         CERTNOA
  8313                         SUFXA.
  8314
  8315     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8316
  8317     GO TO 8200-SEND-DATAONLY.
  8318
  8319 0400-FIRST-TIME.
  8320
  8321     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 160
* EL156.cbl
  8322        MOVE 'N'         TO WS-BROWSE-START-SW
  8323
  8324* EXEC CICS ENDBR
  8325*            DATASET    ('ELMSTR')
  8326*       END-EXEC.
  8327     MOVE 'ELMSTR' TO DFHEIV1
  8328     MOVE 0
  8329       TO DFHEIV11
  8330*    MOVE '&2                    $   #00008162' TO DFHEIV0
  8331     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8332     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8333     MOVE X'2020233030303038313632' TO DFHEIV0(25:11)
  8334     CALL 'kxdfhei1' USING DFHEIV0,
  8335           DFHEIV1,
  8336           DFHEIV11,
  8337           DFHEIV99
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341     IF PI-PROCESSOR-ID = 'LGXX'
  8342         NEXT SENTENCE
  8343     ELSE
  8344
  8345* EXEC CICS READQ TS
  8346*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8347*            INTO    (SECURITY-CONTROL)
  8348*            LENGTH  (SC-COMM-LENGTH)
  8349*            ITEM    (SC-ITEM)
  8350*        END-EXEC
  8351*    MOVE '*$II   L              ''   #00008169' TO DFHEIV0
  8352     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8354     MOVE X'2020233030303038313639' TO DFHEIV0(25:11)
  8355     CALL 'kxdfhei1' USING DFHEIV0,
  8356           PI-SECURITY-TEMP-STORE-ID,
  8357           SECURITY-CONTROL,
  8358           SC-COMM-LENGTH,
  8359           SC-ITEM,
  8360           DFHEIV99,
  8361           DFHEIV99
  8362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8363         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8364         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8365
  8366     MOVE LOW-VALUES             TO EL156AI.
  8367     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8368     MOVE 'Y'                    TO FIRST-ENTRY.
  8369     GO TO 7000-SHOW-CLAIM.
  8370
  8371 0500-CREATE-TEMP-STORAGE.
  8372     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8373
  8374
  8375* EXEC CICS WRITEQ TS
  8376*        QUEUE (QID)
  8377*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8378*        LENGTH(PI-COMM-LENGTH)
  8379*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 161
* EL156.cbl
  8380*    MOVE '*"                    ''   #00008186' TO DFHEIV0
  8381     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8382     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8383     MOVE X'2020233030303038313836' TO DFHEIV0(25:11)
  8384     CALL 'kxdfhei1' USING DFHEIV0,
  8385           QID,
  8386           PROGRAM-INTERFACE-BLOCK,
  8387           PI-COMM-LENGTH,
  8388           DFHEIV99,
  8389           DFHEIV99,
  8390           DFHEIV99
  8391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8392
  8393
  8394
  8395* EXEC CICS WRITEQ TS
  8396*        QUEUE (QID)
  8397*        FROM  (EL156AI)
  8398*        LENGTH(MAP-LENGTH)
  8399*    END-EXEC.
  8400*    MOVE '*"                    ''   #00008192' TO DFHEIV0
  8401     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8403     MOVE X'2020233030303038313932' TO DFHEIV0(25:11)
  8404     CALL 'kxdfhei1' USING DFHEIV0,
  8405           QID,
  8406           EL156AI,
  8407           MAP-LENGTH,
  8408           DFHEIV99,
  8409           DFHEIV99,
  8410           DFHEIV99
  8411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8412
  8413
  8414 0599-EXIT.
  8415      EXIT.
  8416
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 162
* EL156.cbl
  8418 0600-RECOVER-TEMP-STORAGE.
  8419
  8420* EXEC CICS READQ TS
  8421*        QUEUE (QID)
  8422*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8423*        LENGTH(PI-COMM-LENGTH)
  8424*    END-EXEC.
  8425*    MOVE '*$I    L              ''   #00008203' TO DFHEIV0
  8426     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8427     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8428     MOVE X'2020233030303038323033' TO DFHEIV0(25:11)
  8429     CALL 'kxdfhei1' USING DFHEIV0,
  8430           QID,
  8431           PROGRAM-INTERFACE-BLOCK,
  8432           PI-COMM-LENGTH,
  8433           DFHEIV99,
  8434           DFHEIV99,
  8435           DFHEIV99
  8436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8437
  8438
  8439
  8440* EXEC CICS READQ TS
  8441*        QUEUE (QID)
  8442*        INTO  (EL156AI)
  8443*        LENGTH(MAP-LENGTH)
  8444*    END-EXEC.
  8445*    MOVE '*$I    L              ''   #00008209' TO DFHEIV0
  8446     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8447     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8448     MOVE X'2020233030303038323039' TO DFHEIV0(25:11)
  8449     CALL 'kxdfhei1' USING DFHEIV0,
  8450           QID,
  8451           EL156AI,
  8452           MAP-LENGTH,
  8453           DFHEIV99,
  8454           DFHEIV99,
  8455           DFHEIV99
  8456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8457
  8458
  8459     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8460
  8461     IF PMTTYPEI NOT = LOW-VALUES
  8462         MOVE AL-UANON           TO PMTTYPEA.
  8463
  8464     IF PAYEEI NOT = LOW-VALUES
  8465         MOVE AL-UANON           TO PAYEEA.
  8466
  8467     IF NOTE1I NOT = LOW-VALUES
  8468         MOVE AL-UANON           TO NOTE1A.
  8469
  8470     IF (RETURNED-FROM = 'EL614')
  8471        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8472     END-IF
  8473*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8474*       AND (PI-EOB-CODES-EXIST = 'Y')
  8475*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 163
* EL156.cbl
  8476*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8477     IF PI-SET-NOTE2-MDT = 'Y'
  8478         MOVE AL-SANON           TO NOTE2A
  8479     END-IF
  8480
  8481     IF OFFLINEI NOT = LOW-VALUES
  8482         MOVE AL-UANON           TO OFFLINEA.
  8483
  8484     IF GROUPEDI NOT = LOW-VALUES
  8485         MOVE AL-UANON           TO GROUPEDA.
  8486
  8487     IF CASHI NOT = LOW-VALUES
  8488         MOVE AL-UANON           TO CASHA.
  8489
  8490     IF CHECKNOI NOT = LOW-VALUES
  8491         MOVE AL-UANON           TO CHECKNOA.
  8492
  8493     IF HOLDTILI NOT = LOW-VALUES
  8494         MOVE AL-UANON           TO HOLDTILA.
  8495
  8496     IF EPYFROMI NOT = LOW-VALUES
  8497         MOVE AL-UANON           TO EPYFROMA.
  8498
  8499     IF AIGFROMI NOT = LOW-VALUES
  8500         MOVE AL-UANON           TO AIGFROMA.
  8501
  8502     IF EPYTHRUI NOT = LOW-VALUES
  8503         MOVE AL-UANON           TO EPYTHRUA.
  8504
  8505     IF EDAYSI NOT = LOW-VALUES
  8506         MOVE AL-UNNON           TO EDAYSA.
  8507
  8508     IF EPYAMTL NOT = +0
  8509         MOVE AL-UNNON           TO EPYAMTA.
  8510
  8511     IF ERESVL NOT = +0
  8512         MOVE AL-UNNON           TO ERESVA.
  8513
  8514     IF EEXPENSL NOT = +0
  8515         MOVE AL-UNNON           TO EEXPENSA.
  8516
  8517     IF ETYPEI NOT = LOW-VALUES
  8518         MOVE AL-UNNON           TO ETYPEA.
  8519
  8520     IF PROOFDTI NOT = 0
  8521         MOVE AL-UNNON           TO PROOFDTA.
  8522
  8523     IF EOBYNI = 'Y' OR 'N'
  8524        MOVE AL-UANON            TO EOBYNA
  8525     END-IF
  8526     .
  8527 0699-EXIT.
  8528      EXIT.
  8529
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 164
* EL156.cbl
  8531 0700-TEST-FOR-CHANGES.
  8532     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8533         MOVE ER-0433            TO EMI-ERROR
  8534         GO TO 0750-FUNCTION-ERROR.
  8535
  8536     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8537
  8538     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8539         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8540         MOVE 'A'                TO PI-PASS-SW
  8541         GO TO 1000-EDIT-DATA.
  8542
  8543     IF PI-FATAL-COUNT NOT = 0
  8544         MOVE ER-0499            TO EMI-ERROR
  8545         GO TO 0750-FUNCTION-ERROR.
  8546
  8547     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8548         MOVE ER-0500            TO EMI-ERROR
  8549         GO TO 0750-FUNCTION-ERROR.
  8550
  8551     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8552        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8553           MOVE ER-0542          TO EMI-ERROR
  8554           MOVE -1               TO EPYAMTL
  8555           GO TO 0750-FUNCTION-ERROR.
  8556
  8557     IF PI-OFFLINE = 'Y'  OR
  8558        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8559        MOVE EIBAID              TO PI-PFKEY-USED
  8560        GO TO 5000-UPDATE.
  8561
  8562     GO TO 6000-BUILD-SCREEN-B.
  8563
  8564 0750-FUNCTION-ERROR.
  8565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8566
  8567     IF ENTERPFL > 0
  8568         MOVE -1                 TO ENTERPFL
  8569         MOVE AL-UNBON           TO ENTERPFA
  8570         GO TO 8200-SEND-DATAONLY
  8571     ELSE
  8572         MOVE -1                 TO ENTERPFL
  8573         MOVE AL-UNNOF           TO ENTERPFA
  8574         GO TO 8200-SEND-DATAONLY.
  8575
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 165
* EL156.cbl
  8577 0800-DELETE-TS.
  8578
  8579* EXEC CICS HANDLE CONDITION
  8580*        QIDERR(0800-EXIT)
  8581*    END-EXEC.
  8582*    MOVE '"$N                   ! % #00008334' TO DFHEIV0
  8583     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8585     MOVE X'2520233030303038333334' TO DFHEIV0(25:11)
  8586     CALL 'kxdfhei1' USING DFHEIV0
  8587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8588
  8589
  8590
  8591* EXEC CICS DELETEQ TS
  8592*        QUEUE(QID)
  8593*    END-EXEC.
  8594*    MOVE '*&                    #   #00008338' TO DFHEIV0
  8595     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8596     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8597     MOVE X'2020233030303038333338' TO DFHEIV0(25:11)
  8598     CALL 'kxdfhei1' USING DFHEIV0,
  8599           QID,
  8600           DFHEIV99
  8601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8602
  8603
  8604 0800-EXIT.
  8605      EXIT.
  8606
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 166
* EL156.cbl
  8608 1000-EDIT-DATA.
  8609
  8610     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  8611         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  8612         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  8613
  8614     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  8615
  8616     IF NOT MODIFY-CAP
  8617         MOVE ER-0070            TO EMI-ERROR
  8618         MOVE -1                 TO PMTTYPEL
  8619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8620         GO TO 2000-EDIT-DONE.
  8621
  8622     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  8623                         '5' AND '6'
  8624         MOVE ER-0420            TO EMI-ERROR
  8625         MOVE -1                 TO PMTTYPEL
  8626         MOVE AL-UABON           TO PMTTYPEA
  8627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8628     ELSE
  8629         MOVE AL-UANON           TO PMTTYPEA.
  8630
  8631     IF PI-OFFLINE = 'Y'
  8632        IF PI-GROUPED = 'Y'
  8633           MOVE ER-1880         TO EMI-ERROR
  8634           MOVE -1              TO GROUPEDL
  8635           MOVE AL-UABON        TO GROUPEDA
  8636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8637
  8638     IF GROUPEDL > +0
  8639        IF PI-GROUPED = 'Y' OR 'N'
  8640           MOVE AL-UANON TO GROUPEDA
  8641        ELSE
  8642           MOVE ER-3140            TO EMI-ERROR
  8643           MOVE -1                 TO GROUPEDL
  8644           MOVE AL-UABON           TO GROUPEDA
  8645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8646
  8647     IF CASHL > +0
  8648        IF PI-CASH = 'Y' OR 'N'
  8649           MOVE AL-UANON           TO CASHA
  8650        ELSE
  8651           MOVE ER-3141            TO EMI-ERROR
  8652           MOVE -1                 TO CASHL
  8653           MOVE AL-UABON           TO CASHA
  8654           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8655
  8656     IF LOANNOL > +0
  8657         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  8658
  8659 1000-EDIT-PAYEE.
  8660
  8661     IF PI-PAYEE-SEQ NOT NUMERIC
  8662         MOVE ER-0294            TO  EMI-ERROR
  8663         MOVE -1                 TO  PAYEEL
  8664         MOVE AL-UABON           TO  PAYEEA
  8665         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 167
* EL156.cbl
  8666         GO TO 1000-CONT-EDIT.
  8667
  8668     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  8669                         'E' OR 'O' OR 'Q'
  8670         NEXT SENTENCE
  8671     ELSE
  8672         MOVE ER-0294            TO  EMI-ERROR
  8673         MOVE -1                 TO  PAYEEL
  8674         MOVE AL-UABON           TO  PAYEEA
  8675         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8676         GO TO 1000-CONT-EDIT.
  8677
  8678     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  8679        (PI-PAYEE-SEQ NOT < '1' AND
  8680         PI-PAYEE-SEQ NOT > '9'))
  8681      OR
  8682        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  8683         (PI-PAYEE-SEQ NOT > '9'))
  8684         MOVE AL-UANON            TO PAYEEA
  8685     ELSE
  8686         MOVE ER-0294            TO EMI-ERROR
  8687         MOVE -1                 TO PAYEEL
  8688         MOVE AL-UABON           TO PAYEEA
  8689         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8690
  8691     IF PI-COMPANY-ID = 'DMD'
  8692         IF PI-PAYEE-TYPE = 'B' AND
  8693            PI-PAYEE-SEQ NOT = '0'
  8694               MOVE ER-7841            TO EMI-ERROR
  8695               MOVE -1                 TO PAYEEL
  8696               MOVE AL-UABON           TO PAYEEA
  8697               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8698
  8699     IF PI-COMPANY-ID = 'JHL'
  8700         IF PI-PAYEE = 'B0'
  8701             NEXT SENTENCE
  8702           ELSE
  8703
  8704* EXEC CICS HANDLE CONDITION
  8705*            ENDFILE(1950-NOT-FOUND)
  8706*            NOTFND (1950-NOT-FOUND)
  8707*        END-EXEC
  8708*    MOVE '"$''I                  ! & #00008441' TO DFHEIV0
  8709     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8711     MOVE X'2620233030303038343431' TO DFHEIV0(25:11)
  8712     CALL 'kxdfhei1' USING DFHEIV0
  8713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8714         MOVE 'N'                    TO FOUND-TOL-SW
  8715         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8716         MOVE '2'                    TO CNTL-REC-TYPE
  8717         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  8718         MOVE +0                     TO CNTL-SEQ-NO
  8719         MOVE 'PROC'                 TO FILE-SWITCH
  8720         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  8721         IF PI-PAYEE = 'I1' AND
  8722            APPROVAL-LEVEL-2
  8723             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 168
* EL156.cbl
  8724           ELSE
  8725         IF NOT PI-USER-ALMIGHTY-YES
  8726             MOVE ER-3546        TO EMI-ERROR
  8727             MOVE -1             TO PAYEEL
  8728             MOVE AL-UABON       TO PAYEEA
  8729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8730
  8731     IF PI-PAYEE-TYPE = 'E'
  8732        IF PI-PMTTYPE = '5' OR '6'
  8733            NEXT SENTENCE
  8734        ELSE
  8735            MOVE ER-3539            TO EMI-ERROR
  8736            MOVE -1                 TO PAYEEL
  8737            MOVE AL-UABON           TO PAYEEA
  8738            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8739
  8740 1000-CONT-EDIT.
  8741
  8742     IF PI-OFFLINE NOT = 'Y' AND 'N'
  8743        IF PI-EPYAMT NOT NEGATIVE
  8744            MOVE ER-0421         TO EMI-ERROR
  8745            MOVE -1              TO OFFLINEL
  8746            MOVE AL-UABON        TO OFFLINEA
  8747            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8748        ELSE
  8749            MOVE AL-UANON        TO OFFLINEA.
  8750
  8751     IF PI-COMPANY-ID = 'CID' OR 'DCC'
  8752        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  8753           CONTINUE
  8754        ELSE
  8755           MOVE ER-1561          TO EMI-ERROR
  8756           MOVE -1               TO EOBYNL
  8757           MOVE AL-UABON         TO EOBYNA
  8758           PERFORM 9900-ERROR-FORMAT
  8759                                 THRU 9900-EXIT
  8760        END-IF
  8761     END-IF
  8762     IF PI-EPYAMT IS NEGATIVE
  8763         IF PI-OFFLINE NOT = 'Y'
  8764             MOVE ER-0836        TO  EMI-ERROR
  8765             MOVE -1             TO  OFFLINEL
  8766             MOVE AL-UABON       TO  OFFLINEA
  8767             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8768
  8769     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  8770        MOVE ER-0872             TO EMI-ERROR
  8771        MOVE -1                  TO PROOFDTL
  8772        MOVE AL-UABON            TO PROOFDTA
  8773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8774     ELSE
  8775        MOVE '4'                TO DC-OPTION-CODE
  8776        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  8777        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8778        IF DATE-CONVERSION-ERROR
  8779            MOVE ER-0873        TO EMI-ERROR
  8780            MOVE -1                  TO PROOFDTL
  8781            MOVE AL-UABON            TO PROOFDTA
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 169
* EL156.cbl
  8782            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8783        ELSE
  8784            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  8785            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  8786                MOVE ER-0873    TO EMI-ERROR
  8787                MOVE -1                  TO PROOFDTL
  8788                MOVE AL-UABON            TO PROOFDTA
  8789                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8790            END-IF
  8791        END-IF
  8792     END-IF.
  8793
  8794     IF PI-COMPANY-ID = 'DMD'
  8795        IF NOTE1L NOT = ZEROS
  8796            MOVE ER-7844        TO  EMI-ERROR
  8797            MOVE -1             TO  NOTE1L
  8798            MOVE AL-UABON       TO  NOTE1A
  8799            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8800
  8801     IF PI-COMPANY-ID = 'DMD'
  8802        IF NOTE2L NOT = ZEROS
  8803          GO TO 1004-DMD-EOB-CHECKS.
  8804
  8805     IF NOTE1L NOT > +0
  8806         GO TO 1005-CHECK-ERRORS.
  8807
  8808     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  8809         GO TO 1005-CHECK-ERRORS.
  8810
  8811     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  8812         GO TO 1003-HAN-PMT-NOTES.
  8813
  8814     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  8815
  8816     IF WS-PMTOPTION NUMERIC
  8817        IF WS-PMTOPTION > '00' AND < '17'
  8818           NEXT SENTENCE
  8819        ELSE
  8820           MOVE ER-0618          TO EMI-ERROR
  8821           MOVE -1               TO NOTE1L
  8822           MOVE AL-UABON         TO NOTE1A
  8823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8824     ELSE
  8825        GO TO 1005-CHECK-ERRORS.
  8826
  8827     IF WS-PMTOPTION = '05' AND
  8828        WS-DOCNAME = SPACES
  8829          MOVE ER-0616             TO EMI-ERROR
  8830          MOVE -1                  TO NOTE1L
  8831          MOVE AL-UABON            TO NOTE1A
  8832          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8833
  8834     IF WS-PMTOPTION = '15' OR '16'
  8835
  8836* EXEC CICS BIF DEEDIT
  8837*            FIELD (WS-AMOUNT)
  8838*            LENGTH(08)
  8839*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 170
* EL156.cbl
  8840     MOVE 08
  8841       TO DFHEIV11
  8842*    MOVE '@"L                   #   #00008566' TO DFHEIV0
  8843     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8844     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8845     MOVE X'2020233030303038353636' TO DFHEIV0(25:11)
  8846     CALL 'kxdfhei1' USING DFHEIV0,
  8847           WS-AMOUNT,
  8848           DFHEIV11
  8849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8850        IF (WS-NUM-AMT = ZEROS) OR
  8851           (WS-AMOUNT NOT NUMERIC)
  8852           MOVE ER-0617          TO EMI-ERROR
  8853           MOVE -1               TO NOTE1L
  8854           MOVE AL-UABON         TO NOTE1A
  8855           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8856
  8857     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8858
  8859     GO TO 1005-CHECK-ERRORS.
  8860
  8861 1003-HAN-PMT-NOTES.
  8862
  8863     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  8864
  8865     IF WS-HAN-PMT-CODE = SPACE
  8866         MOVE SPACES             TO WS-HAN-PMT-NOTE
  8867     ELSE
  8868     IF WS-HAN-PMT-CODE = 'A'
  8869         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  8870                                 TO WS-HAN-PMT-NOTE
  8871     ELSE
  8872     IF WS-HAN-PMT-CODE = 'B'
  8873         MOVE ':FINAL PAYMENT / DECEASED'
  8874                                 TO WS-HAN-PMT-NOTE
  8875     ELSE
  8876     IF WS-HAN-PMT-CODE = 'C'
  8877         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  8878                                 TO WS-HAN-PMT-NOTE
  8879     ELSE
  8880     IF WS-HAN-PMT-CODE = 'D'
  8881         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  8882                                 TO WS-HAN-PMT-NOTE
  8883     ELSE
  8884     IF WS-HAN-PMT-CODE = 'E'
  8885         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  8886                                 TO WS-HAN-PMT-NOTE
  8887     ELSE
  8888     IF WS-HAN-PMT-CODE = 'F'
  8889         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  8890                                 TO WS-HAN-PMT-NOTE
  8891     ELSE
  8892     IF WS-HAN-PMT-CODE = 'P'
  8893         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  8894
  8895     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  8896     GO TO 1005-CHECK-ERRORS.
  8897
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 171
* EL156.cbl
  8898 1004-DMD-EOB-CHECKS.
  8899
  8900     INITIALIZE PI-AT-EOB-CODES.
  8901
  8902     IF NOTE2I (20:21) > SPACES
  8903         MOVE ER-7845          TO EMI-ERROR
  8904         MOVE -1               TO NOTE2L
  8905         MOVE AL-UABON         TO NOTE2A
  8906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8907         GO TO 1005-CHECK-ERRORS
  8908      ELSE
  8909         MOVE NOTE2I             TO W-EOB-CODES.
  8910
  8911     MOVE +1                     TO W-EOB-NDX.
  8912
  8913 1004-CHECK-EACH-EOB.
  8914
  8915     IF W-EOB-NDX > +5
  8916             OR
  8917        W-EOB-CODE (W-EOB-NDX) = SPACES
  8918         GO TO 1004-CHECK-DUP-EOB.
  8919
  8920     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  8921         MOVE ER-0956            TO EMI-ERROR
  8922         MOVE -1                 TO NOTE2L
  8923         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8924         GO TO 1005-CHECK-ERRORS.
  8925
  8926     MOVE 'CL'                   TO CD-SYSTEM-ID.
  8927     MOVE 'EO'                   TO CD-RECORD-TYPE.
  8928     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  8929     MOVE 'DLO023'               TO PGM-NAME.
  8930
  8931
  8932* EXEC CICS LINK
  8933*        PROGRAM    (PGM-NAME)
  8934*        COMMAREA   (CD-COMMUNICATION-AREA)
  8935*        LENGTH     (CD-RCRD-LENGTH)
  8936*    END-EXEC.
  8937*    MOVE '."C                   ''   #00008651' TO DFHEIV0
  8938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038363531' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           PGM-NAME,
  8943           CD-COMMUNICATION-AREA,
  8944           CD-RCRD-LENGTH,
  8945           DFHEIV99,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951     IF CD-RETURN-CODE = 'OK'
  8952         GO TO 1004-CONT.
  8953
  8954     MOVE -1                     TO NOTE2L.
  8955
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 172
* EL156.cbl
  8956     IF CD-RETURN-CODE = '01'
  8957         MOVE ER-8310            TO EMI-ERROR
  8958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8959         GO TO 1005-CHECK-ERRORS.
  8960
  8961     IF CD-RETURN-CODE = '02'
  8962         MOVE ER-8311            TO EMI-ERROR
  8963         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8964         GO TO 1005-CHECK-ERRORS.
  8965
  8966     IF CD-RETURN-CODE = '03'
  8967         MOVE ER-8312            TO EMI-ERROR
  8968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8969         GO TO 1005-CHECK-ERRORS.
  8970
  8971     IF CD-RETURN-CODE = '04'
  8972         MOVE ER-8313            TO EMI-ERROR
  8973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8974         GO TO 1005-CHECK-ERRORS.
  8975
  8976     IF CD-RETURN-CODE = '05'
  8977         MOVE ER-8314            TO EMI-ERROR
  8978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8979         GO TO 1005-CHECK-ERRORS.
  8980
  8981     IF CD-RETURN-CODE = '06'
  8982         MOVE ER-8315            TO EMI-ERROR
  8983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8984         GO TO 1005-CHECK-ERRORS.
  8985
  8986     IF CD-RETURN-CODE = 'E1'
  8987         MOVE ER-8316            TO EMI-ERROR
  8988         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989         GO TO 1005-CHECK-ERRORS.
  8990
  8991     IF CD-RETURN-CODE = 'N1'
  8992         MOVE ER-8317            TO EMI-ERROR
  8993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8994         GO TO 1005-CHECK-ERRORS.
  8995
  8996 1004-CONT.
  8997     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  8998
  8999     ADD +1 TO W-EOB-NDX.
  9000     GO TO 1004-CHECK-EACH-EOB.
  9001
  9002 1004-CHECK-DUP-EOB.
  9003     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9004         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9005                               PI-AT-EOB-CODE (3) OR
  9006                               PI-AT-EOB-CODE (4) OR
  9007                               PI-AT-EOB-CODE (5)))
  9008                  OR
  9009        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9010         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9011                               PI-AT-EOB-CODE (4) OR
  9012                               PI-AT-EOB-CODE (5)))
  9013                  OR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 173
* EL156.cbl
  9014        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9015         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9016                               PI-AT-EOB-CODE (5)))
  9017                  OR
  9018        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9019         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9020            MOVE ER-8000            TO EMI-ERROR
  9021            MOVE AL-UABON           TO NOTE2A
  9022            MOVE -1                 TO NOTE2L
  9023            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9024            GO TO 1005-CHECK-ERRORS.
  9025
  9026 1005-CHECK-ERRORS.
  9027*    IF PI-COMPANY-ID NOT = 'DMD'
  9028        GO TO 1006-CHECK-ERRORS.
  9029
  9030*********  DMD CODE START ******************
  9031*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9032*       GO TO 1006-CHECK-ERRORS.
  9033*
  9034*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9035*
  9036*    COMPUTE W-PAYMENT-TOTAL
  9037*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9038*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9039*               AND
  9040*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9041*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9042*          MOVE ER-0967    TO EMI-ERROR
  9043*          MOVE -1         TO PMTTYPEL
  9044*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9045*
  9046*    GO TO 1006-CHECK-ERRORS.
  9047*********  DMD CODE END ******************
  9048
  9049 1006-CHECK-ERRORS.
  9050     IF NOT EMI-NO-ERRORS
  9051        GO TO 2000-EDIT-DONE.
  9052
  9053
  9054* EXEC CICS HANDLE CONDITION
  9055*        NOTFND(1950-NOT-FOUND)
  9056*    END-EXEC.
  9057*    MOVE '"$I                   ! '' #00008759' TO DFHEIV0
  9058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9060     MOVE X'2720233030303038373539' TO DFHEIV0(25:11)
  9061     CALL 'kxdfhei1' USING DFHEIV0
  9062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9063
  9064
  9065     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9066     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9067     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9068     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9069     MOVE 'MSTR'                 TO FILE-SWITCH.
  9070
  9071     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 174
* EL156.cbl
  9072
  9073     IF PI-COMPANY-ID = 'DMD'
  9074         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9075
  9076     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9077        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9078           MOVE ER-0873    TO EMI-ERROR
  9079           MOVE -1                  TO PROOFDTL
  9080           MOVE AL-UABON            TO PROOFDTA
  9081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9082        END-IF
  9083     END-IF
  9084     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9085         IF PI-PMTTYPE = '5' OR '6'
  9086             NEXT SENTENCE
  9087         ELSE
  9088             MOVE ER-0555             TO EMI-ERROR
  9089             MOVE -1                  TO PMTTYPEL
  9090             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9091
  9092     IF CL-LAST-CLOSE-REASON = '2'
  9093         IF CL-CLAIM-STATUS = 'C'
  9094             MOVE ER-0760        TO  EMI-ERROR
  9095             MOVE -1             TO  PMTTYPEL
  9096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9097
  9098     IF PI-ACTIVITY-CODE = 9
  9099         MOVE ER-3538            TO  EMI-ERROR
  9100         MOVE -1                 TO  PMTTYPEL
  9101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9102
  9103     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9104         GO TO 1008-READ-CERT.
  9105**********************AIG LOGIC STARTS *********************
  9106     IF CL-CERT-PRIME = 'INCOMPLETE'
  9107         MOVE ER-3540            TO  EMI-ERROR
  9108         MOVE -1                 TO  PMTTYPEL
  9109         MOVE AL-UABON           TO  PMTTYPEA
  9110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111         GO TO 2000-EDIT-DONE.
  9112
  9113     IF PI-PMTTYPE = '4'
  9114         IF PI-EPYAMT IS NEGATIVE
  9115             IF PI-ECHECKNO-CR = 'CR'
  9116                 NEXT SENTENCE
  9117             ELSE
  9118                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9119
  9120     IF PI-PMTTYPE = '4'
  9121         IF PI-ECHECKNO-CR = 'CR'
  9122             IF PI-EPYAMT IS NEGATIVE
  9123                 NEXT SENTENCE
  9124             ELSE
  9125                 MOVE ER-0834    TO  EMI-ERROR
  9126                 MOVE -1         TO  EPYAMTL
  9127                 MOVE AL-UNBON   TO  EPYAMTA
  9128                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9129
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 175
* EL156.cbl
  9130     IF PI-PMTTYPE = '4'
  9131         IF PI-EPYAMT IS NEGATIVE
  9132             IF PI-OFFLINE = 'Y'
  9133                 NEXT SENTENCE
  9134             ELSE
  9135                 MOVE 'Y'        TO  PI-OFFLINE
  9136                                     WS-OFFLINE
  9137                                     OFFLINEO
  9138                 MOVE AL-UANON   TO  OFFLINEA.
  9139
  9140     IF PI-PMTTYPE = '4'
  9141         IF PI-EPYAMT IS NEGATIVE
  9142             IF PI-CASH = 'Y'
  9143                 NEXT SENTENCE
  9144             ELSE
  9145                 MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9146                 MOVE AL-UANON   TO  CASHA
  9147                 GO TO 1007-DEFAULT-AIG-CHECKNO.
  9148
  9149     IF PI-CASH NOT = 'Y' AND 'N'
  9150          IF PI-OFFLINE = 'Y'  AND
  9151             PI-ECHECKNO-CR = 'CR'
  9152               MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9153               MOVE AL-UANON     TO  CASHA
  9154               GO TO 1007-DEFAULT-AIG-CHECKNO.
  9155
  9156     IF PI-CASH NOT = 'Y' AND 'N'
  9157         IF PI-PMTTYPE = '5' OR '6'
  9158             MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9159             MOVE AL-UANON       TO  CASHA
  9160             GO TO 1007-DEFAULT-AIG-CHECKNO.
  9161
  9162     IF PI-CASH NOT = 'Y' AND 'N'
  9163        IF CL-ASSOCIATES = 'N' OR 'A'
  9164            MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9165            MOVE AL-UANON        TO  CASHA
  9166        ELSE
  9167            MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9168            MOVE AL-UANON        TO  CASHA.
  9169
  9170     IF PI-PMTTYPE = '5' OR '6'
  9171         IF PI-CASH = 'N'
  9172             MOVE ER-0819        TO  EMI-ERROR
  9173             MOVE AL-UANON       TO  CASHA
  9174             MOVE -1             TO  CASHL
  9175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9176
  9177     IF CL-ASSOCIATES = 'N' OR 'A'
  9178        IF CASHI = 'N'
  9179         MOVE ER-3537            TO  EMI-ERROR
  9180         MOVE AL-UANON           TO  CASHA
  9181         MOVE -1                 TO  CASHL
  9182         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9183
  9184 1007-DEFAULT-AIG-CHECKNO.
  9185
  9186     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9187         MOVE ER-3532            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 176
* EL156.cbl
  9188         MOVE -1                 TO  PMTTYPEL
  9189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9190**********************AIG LOGIC ENDS ***********************
  9191
  9192 1008-READ-CERT.
  9193
  9194     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9195     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9196     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9197     MOVE CL-CERT-STATE          TO CERT-STATE.
  9198     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9199     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9200     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9201     MOVE 'CERT'                 TO FILE-SWITCH.
  9202
  9203     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9204
  9205     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9206         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9207     ELSE
  9208         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9209
  9210*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9211*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9212
  9213     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9214         MOVE ER-0458            TO EMI-ERROR
  9215         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9216
  9217     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9218         MOVE ER-0459            TO EMI-ERROR
  9219         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9220
  9221     IF CL-REPORTED-DT = LOW-VALUES
  9222        MOVE ER-0530             TO EMI-ERROR
  9223        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9224
  9225     IF PI-COMPANY-ID = 'NCL'
  9226        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9227            MOVE ER-0770            TO EMI-ERROR
  9228            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9229
  9230     IF PI-COMPANY-ID = 'NCL'
  9231        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9232            MOVE ER-0737            TO EMI-ERROR
  9233            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9234
  9235     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9236         MOVE ER-0768            TO  EMI-ERROR
  9237         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9238
  9239     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9240         MOVE ER-0769            TO  EMI-ERROR
  9241         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9242
  9243     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9244         GO TO 1020-DO-LIFE-EDITS
  9245     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 177
* EL156.cbl
  9246         GO TO 1030-DO-AH-EDITS.
  9247
  9248 1010-GENERAL-ERROR.
  9249     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9250
  9251     IF EMI-MESSAGE-FORMATTED
  9252         MOVE -1                 TO PMTTYPEL.
  9253
  9254 1010-EXIT.
  9255     EXIT.
  9256
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 178
* EL156.cbl
  9258 1020-DO-LIFE-EDITS.
  9259     IF CM-LF-BENEFIT-CD = '00'
  9260         IF PI-PMTTYPE = '5' OR '6'
  9261             MOVE ER-0658        TO EMI-ERROR
  9262             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9263         ELSE
  9264             MOVE ER-1775        TO EMI-ERROR
  9265             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9266
  9267     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9268         MOVE ER-0460            TO EMI-ERROR
  9269         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9270
  9271     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9272     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9273     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9274     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9275     MOVE '4'                    TO  CNTL-REC-TYPE.
  9276     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9277     MOVE 'BENE'                 TO  FILE-SWITCH.
  9278     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9279     IF NO-BENEFIT-FOUND
  9280         GO TO 1950-NOT-FOUND.
  9281
  9282     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9283
  9284     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9285         IF PI-PMTTYPE = '4'
  9286             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9287                PI-LF-COVERAGE-TYPE = 'P'
  9288                 NEXT SENTENCE
  9289             ELSE
  9290                 MOVE ER-0461        TO EMI-ERROR
  9291                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9292         ELSE
  9293            NEXT SENTENCE
  9294     ELSE
  9295         IF PI-PMTTYPE = '2'
  9296            IF NOT CM-O-B-COVERAGE
  9297              AND CM-LF-CURRENT-STATUS = '7'
  9298                MOVE ER-0462     TO EMI-ERROR
  9299                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9300
  9301     IF PI-PMTTYPE = '2'
  9302         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9303            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9304             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9305             MOVE ER-0730            TO  EMI-ERROR
  9306             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9307             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9308
  9309     IF PI-PMTTYPE = '2'
  9310         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9311            PI-LF-COVERAGE-TYPE = 'P'
  9312             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9313                 MOVE ER-0462    TO  EMI-ERROR
  9314                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9315
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 179
* EL156.cbl
  9316     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9317       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9318         MOVE ER-0466            TO EMI-ERROR
  9319         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9320
  9321     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9322         IF PI-PMTTYPE = '3'
  9323             MOVE 0436           TO EMI-ERROR
  9324             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9325             GO TO 1045-EDIT-PAYEE-ADDR
  9326         ELSE
  9327             GO TO 1045-EDIT-PAYEE-ADDR.
  9328
  9329     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9330        PI-LF-COVERAGE-TYPE = 'P'
  9331         IF PI-PMTTYPE = '3'
  9332             MOVE ER-0436          TO  EMI-ERROR
  9333             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9334         ELSE
  9335             NEXT SENTENCE
  9336     ELSE
  9337         IF PI-PMTTYPE = '1' OR '3'
  9338             MOVE ER-0436            TO EMI-ERROR
  9339             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9340*
  9341     IF PI-COMPANY-ID = 'CID' AND
  9342        CL-CERT-STATE = 'SC'  AND
  9343        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9344           MOVE ER-0879    TO  EMI-ERROR
  9345           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9346     END-IF.
  9347
  9348     GO TO 1045-EDIT-PAYEE-ADDR.
  9349
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 180
* EL156.cbl
  9351 1030-DO-AH-EDITS.
  9352     IF CM-AH-BENEFIT-CD = '00'
  9353         IF PI-PMTTYPE = '5' OR '6'
  9354             MOVE ER-0658        TO EMI-ERROR
  9355             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9356         ELSE
  9357             MOVE ER-1775        TO EMI-ERROR
  9358             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9359
  9360     IF CL-TOTAL-PAID-AMT = ZEROS
  9361         IF PI-PMTTYPE = '4'
  9362             MOVE ER-0438        TO EMI-ERROR
  9363             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9364
  9365     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9366         IF PI-PMTTYPE = '3'
  9367             MOVE ER-0463        TO EMI-ERROR
  9368             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9369         ELSE
  9370             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
  9371              AND CM-LF-CURRENT-STATUS = '7'
  9372                 MOVE ER-0465    TO EMI-ERROR
  9373                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9374
  9375     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9376         IF PI-PMTTYPE = '3'
  9377             MOVE ER-0464        TO EMI-ERROR
  9378             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9379         ELSE
  9380             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
  9381                 MOVE ER-0469    TO EMI-ERROR
  9382                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9383
  9384     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9385         IF PI-PMTTYPE = '3'
  9386             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
  9387                 MOVE ER-0467    TO EMI-ERROR
  9388                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9389             ELSE
  9390                 NEXT SENTENCE
  9391         ELSE
  9392             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
  9393                 MOVE ER-0468    TO EMI-ERROR
  9394                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9395
  9396     GO TO 1045-EDIT-PAYEE-ADDR.
  9397
  9398 1040-PMTTYPE-ERROR.
  9399     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9400
  9401     IF EMI-MESSAGE-FORMATTED
  9402         MOVE -1                 TO PMTTYPEL
  9403         MOVE AL-UABON           TO PMTTYPEA.
  9404
  9405 1040-EXIT.
  9406     EXIT.
  9407
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 181
* EL156.cbl
  9409 1045-EDIT-PAYEE-ADDR.
  9410
  9411     IF PI-OFFLINE = 'N' AND
  9412        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
  9413           < PI-PAYEE-SEQ-NUM)
  9414        OR
  9415         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
  9416         (PI-PAYEE-TYPE = 'B')                 AND
  9417         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
  9418        OR
  9419         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
  9420           < PI-PAYEE-SEQ-NUM)
  9421        OR
  9422         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
  9423           < PI-PAYEE-SEQ-NUM)
  9424        OR
  9425         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
  9426           < PI-PAYEE-SEQ-NUM)
  9427        OR
  9428         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
  9429           < PI-PAYEE-SEQ-NUM)
  9430        OR
  9431         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
  9432           < PI-PAYEE-SEQ-NUM))
  9433             MOVE ER-0437        TO EMI-ERROR
  9434             MOVE -1             TO PAYEEL
  9435             MOVE AL-UABON       TO PAYEEA
  9436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9437
  9438     IF PI-OFFLINE    = 'N' AND
  9439        PI-PAYEE-TYPE = 'B' AND
  9440        PI-PAYEE-SEQ  = '0'
  9441         PERFORM 7920-READ-BENE THRU 7920-EXIT
  9442         IF BENE-FOUND-SW = 'N'
  9443             MOVE ER-0437        TO EMI-ERROR
  9444             MOVE -1             TO PAYEEL
  9445             MOVE AL-UABON       TO PAYEEA
  9446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9447
  9448     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9449        IF PI-OFFLINE    = 'N'  AND
  9450           PI-PAYEE-TYPE = 'B'  AND
  9451           PI-PAYEE-SEQ  = '9'
  9452             PERFORM 7920-READ-BENE THRU 7920-EXIT
  9453             IF BENE-FOUND-SW = 'N'
  9454                MOVE ER-0437        TO EMI-ERROR
  9455                MOVE -1             TO PAYEEL
  9456                MOVE AL-UABON       TO PAYEEA
  9457                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9458
  9459*    IF PI-COMPANY-ID = 'CRI'
  9460*        IF CL-CLAIM-TYPE = 'L'
  9461*            MOVE 'N'                TO  WS-GROUPED
  9462*                                        PI-GROUPED
  9463*                                        GROUPEDI
  9464*            MOVE AL-UANON           TO  GROUPEDA
  9465*            GO TO 1050-EDIT-CHECK-NO
  9466*        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 182
* EL156.cbl
  9467*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
  9468*            IF WS-GROUP-1 = 'C'
  9469*                NEXT SENTENCE
  9470*            ELSE
  9471*                MOVE 'N'            TO  WS-GROUPED
  9472*                                        PI-GROUPED
  9473*                                        GROUPEDI
  9474*                MOVE AL-UANON       TO  GROUPEDA
  9475*                GO TO 1050-EDIT-CHECK-NO.
  9476
  9477     IF PI-GROUPED = 'Y'
  9478        IF PI-PAYEE-TYPE = 'B' OR 'A'
  9479           NEXT SENTENCE
  9480        ELSE
  9481           MOVE ER-0437        TO EMI-ERROR
  9482           MOVE -1             TO PAYEEL
  9483           MOVE AL-UABON       TO PAYEEA
  9484           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9485
  9486     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
  9487        (PI-GROUPED    = ' ')
  9488        NEXT SENTENCE
  9489     ELSE
  9490        GO TO 1050-EDIT-CHECK-NO.
  9491
  9492     IF PI-COMPANY-ID = 'CRI'
  9493        MOVE 'N'           TO GROUPEDI
  9494                              PI-GROUPED
  9495                              WS-GROUPED
  9496        MOVE AL-UANON      TO GROUPEDA.
  9497
  9498     IF PI-COMPANY-ID = 'CRI'
  9499        IF PI-PAYEE-TYPE = 'B'
  9500           IF BENE-FOUND-SW = 'Y'
  9501              IF BE-GROUP-CHECKS-Y-N = 'Y'
  9502                 MOVE 'Y'           TO GROUPEDI
  9503                                       PI-GROUPED
  9504                                       WS-GROUPED
  9505                 MOVE AL-UANON      TO GROUPEDA
  9506              ELSE
  9507                 NEXT SENTENCE
  9508           ELSE
  9509              PERFORM 7920-READ-BENE THRU 7920-EXIT
  9510              IF BENE-FOUND-SW = 'Y'
  9511                 IF BE-GROUP-CHECKS-Y-N = 'Y'
  9512                    MOVE 'Y'      TO GROUPEDI
  9513                                     PI-GROUPED
  9514                                     WS-GROUPED
  9515                    MOVE AL-UANON TO GROUPEDA.
  9516
  9517     IF PI-COMPANY-ID NOT = 'CRI'
  9518        GO TO 1050-EDIT-CHECK-NO.
  9519
  9520*************** CRI CODE START ******************
  9521     IF PI-PAYEE-TYPE NOT = 'A'
  9522        GO TO 1050-EDIT-CHECK-NO.
  9523
  9524     MOVE LOW-VALUES             TO ERACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 183
* EL156.cbl
  9525     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9526     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9527     MOVE PI-GROUPING            TO ACCT-GROUPING.
  9528     MOVE PI-STATE               TO ACCT-STATE.
  9529     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9530     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
  9531     MOVE 'ACCT'                 TO FILE-SWITCH.
  9532
  9533     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
  9534     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
  9535
  9536
  9537* EXEC CICS HANDLE CONDITION
  9538*         NOTFND   (1950-NOT-FOUND)
  9539*         ENDFILE  (1950-NOT-FOUND)
  9540*    END-EXEC.
  9541*    MOVE '"$I''                  ! ( #00009234' TO DFHEIV0
  9542     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9544     MOVE X'2820233030303039323334' TO DFHEIV0(25:11)
  9545     CALL 'kxdfhei1' USING DFHEIV0
  9546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9547
  9548
  9549
  9550* EXEC CICS STARTBR
  9551*         DATASET   ('ERACCT')
  9552*         RIDFLD    (ERACCT-KEY)
  9553*         GTEQ
  9554*    END-EXEC.
  9555     MOVE 'ERACCT' TO DFHEIV1
  9556     MOVE 0
  9557       TO DFHEIV11
  9558*    MOVE '&,         G          &   #00009239' TO DFHEIV0
  9559     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9560     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9561     MOVE X'2020233030303039323339' TO DFHEIV0(25:11)
  9562     CALL 'kxdfhei1' USING DFHEIV0,
  9563           DFHEIV1,
  9564           ERACCT-KEY,
  9565           DFHEIV99,
  9566           DFHEIV11,
  9567           DFHEIV99
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9569
  9570
  9571 1046-READNEXT-ERACCT.
  9572
  9573
  9574* EXEC CICS READNEXT
  9575*         DATASET   ('ERACCT')
  9576*         RIDFLD    (ERACCT-KEY)
  9577*         SET       (ADDRESS OF ACCOUNT-MASTER)
  9578*    END-EXEC.
  9579     MOVE 'ERACCT' TO DFHEIV1
  9580     MOVE 0
  9581       TO DFHEIV11
  9582*    MOVE '&.S                   )   #00009247' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 184
* EL156.cbl
  9583     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9584     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9585     MOVE X'2020233030303039323437' TO DFHEIV0(25:11)
  9586     CALL 'kxdfhei1' USING DFHEIV0,
  9587           DFHEIV1,
  9588           DFHEIV20,
  9589           DFHEIV99,
  9590           ERACCT-KEY,
  9591           DFHEIV99,
  9592           DFHEIV11,
  9593           DFHEIV99,
  9594           DFHEIV99
  9595     SET ADDRESS OF ACCOUNT-MASTER TO
  9596         DFHEIV20
  9597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9598
  9599
  9600     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
  9601        IF WS-ERACCT-HOLD-RECORD = SPACES
  9602           GO TO 1950-NOT-FOUND
  9603        ELSE
  9604           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
  9605           GO TO 1048-CONTINUE.
  9606
  9607     IF ACCT-EXP-DT = HIGH-VALUES
  9608        NEXT SENTENCE
  9609     ELSE
  9610        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
  9611        GO TO 1046-READNEXT-ERACCT.
  9612
  9613 1048-CONTINUE.
  9614
  9615     IF AM-GROUPED-CHECKS-Y-N = 'Y'
  9616        MOVE 'Y'                 TO GROUPEDI
  9617                                    PI-GROUPED
  9618                                    WS-GROUPED
  9619        MOVE AL-UANON            TO GROUPEDA.
  9620*************** CRI CODE END ******************
  9621
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 185
* EL156.cbl
  9623 1050-EDIT-CHECK-NO.
  9624
  9625     IF PI-OFFLINE = 'Y'
  9626         IF PI-ECHECKNO = SPACES
  9627              MOVE ER-0439        TO EMI-ERROR
  9628              GO TO 1090-CHECK-NO-ERROR
  9629           ELSE
  9630         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9631            IF PI-ECHECKNO-N = 'N' AND
  9632               PI-CASH       = 'Y'
  9633                 MOVE ER-3535        TO EMI-ERROR
  9634                 GO TO 1090-CHECK-NO-ERROR
  9635              ELSE
  9636                 MOVE AL-UANON    TO CHECKNOA
  9637                 GO TO 1100-EDIT-HOLDTIL
  9638          ELSE
  9639            MOVE AL-UANON    TO CHECKNOA
  9640            GO TO 1100-EDIT-HOLDTIL.
  9641
  9642     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9643     MOVE '6'                    TO CNTL-REC-TYPE.
  9644
  9645     IF CONTROL-IS-ACTUAL-CARRIER
  9646         MOVE PI-CARRIER         TO WS-CARR
  9647     ELSE
  9648         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
  9649
  9650     IF PI-COMPANY-ID = 'FIA'
  9651         MOVE PI-CARRIER         TO WS-CARR.
  9652
  9653     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9654     MOVE 0                      TO CNTL-SEQ-NO.
  9655     MOVE 'CARR'                 TO FILE-SWITCH.
  9656
  9657     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
  9658
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 186
* EL156.cbl
  9660     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9661         GO TO 1051-EDIT-CHECKNO-CONT.
  9662
  9663**********************AIG LOGIC STARTS**********************
  9664     IF PI-ECHECKNO = SPACES
  9665         IF CHECK-NO-MANUAL
  9666             MOVE ER-0441        TO EMI-ERROR
  9667             GO TO 1090-CHECK-NO-ERROR
  9668         ELSE
  9669             MOVE AL-UANOF       TO CHECKNOA
  9670             GO TO 1100-EDIT-HOLDTIL.
  9671
  9672     IF PI-ECHECKNO NOT = SPACES
  9673         IF CHECK-NO-MANUAL
  9674             MOVE AL-UANON       TO CHECKNOA
  9675             GO TO 1100-EDIT-HOLDTIL.
  9676
  9677     IF PI-ECHECKNO-CR = 'CR'
  9678        IF PI-OFFLINE = 'Y'
  9679            MOVE AL-UANON       TO CHECKNOA
  9680            GO TO 1100-EDIT-HOLDTIL
  9681        ELSE
  9682            MOVE ER-3534        TO EMI-ERROR
  9683            GO TO 1090-CHECK-NO-ERROR.
  9684
  9685     IF PI-ECHECKNO-N = 'N'
  9686        IF PI-CASH = 'N'
  9687            MOVE AL-UANON       TO CHECKNOA
  9688            GO TO 1100-EDIT-HOLDTIL
  9689        ELSE
  9690            MOVE ER-3535          TO EMI-ERROR
  9691            GO TO 1090-CHECK-NO-ERROR.
  9692
  9693     MOVE ER-0442        TO EMI-ERROR
  9694     GO TO 1090-CHECK-NO-ERROR.
  9695**********************AIG LOGIC ENDS************************
  9696
  9697 1051-EDIT-CHECKNO-CONT.
  9698
  9699     IF PI-COMPANY-ID = 'DMD'
  9700        IF PI-ECHECKNO NOT = SPACES
  9701           IF PI-ECHECKNO (6:2) NOT = 'TP'
  9702              MOVE ER-0442        TO EMI-ERROR
  9703              GO TO 1090-CHECK-NO-ERROR
  9704            ELSE
  9705              GO TO 1100-EDIT-HOLDTIL
  9706          ELSE
  9707           GO TO 1100-EDIT-HOLDTIL.
  9708
  9709     IF PI-ECHECKNO = SPACES
  9710         IF CHECK-NO-MANUAL
  9711             MOVE ER-0441        TO EMI-ERROR
  9712             GO TO 1090-CHECK-NO-ERROR
  9713         ELSE
  9714             MOVE AL-UANOF       TO CHECKNOA
  9715             GO TO 1100-EDIT-HOLDTIL
  9716     ELSE
  9717         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 187
* EL156.cbl
  9718             MOVE AL-UANON       TO CHECKNOA
  9719             GO TO 1100-EDIT-HOLDTIL
  9720         ELSE
  9721             MOVE ER-0442        TO EMI-ERROR
  9722             GO TO 1090-CHECK-NO-ERROR.
  9723
  9724 1090-CHECK-NO-ERROR.
  9725     MOVE -1                     TO CHECKNOL.
  9726     MOVE AL-UABON               TO CHECKNOA.
  9727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9728
  9729     GO TO 2000-EDIT-DONE.
  9730
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 188
* EL156.cbl
  9732 1100-EDIT-HOLDTIL.
  9733     MOVE AL-UANON               TO HOLDTILA.
  9734
  9735     IF PI-HOLDTIL = ZEROS
  9736        IF PI-OFFLINE = 'Y'
  9737           MOVE ER-0572          TO EMI-ERROR
  9738           GO TO 1105-HOLDTIL-ERROR
  9739        ELSE
  9740           GO TO 1110-EDIT-PAID-FROM.
  9741
  9742     MOVE '4'                    TO DC-OPTION-CODE.
  9743     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
  9744     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9745
  9746     IF DATE-CONVERSION-ERROR
  9747         MOVE ER-0446            TO EMI-ERROR
  9748         GO TO 1105-HOLDTIL-ERROR
  9749     END-IF
  9750     IF PI-OFFLINE = 'Y'
  9751        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
  9752           MOVE ER-0446            TO EMI-ERROR
  9753           GO TO 1105-HOLDTIL-ERROR
  9754        END-IF
  9755     END-IF
  9756
  9757     IF PI-OFFLINE = 'Y'
  9758        GO TO 1110-EDIT-PAID-FROM.
  9759
  9760     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
  9761     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
  9762     MOVE '1'                    TO DC-OPTION-CODE.
  9763     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9764
  9765     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
  9766         MOVE ER-0447            TO EMI-ERROR
  9767         GO TO 1105-HOLDTIL-ERROR.
  9768
  9769     GO TO 1110-EDIT-PAID-FROM.
  9770
  9771 1105-HOLDTIL-ERROR.
  9772     MOVE -1                     TO HOLDTILL.
  9773     MOVE AL-UNBON               TO HOLDTILA.
  9774     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9775
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 189
* EL156.cbl
  9777 1110-EDIT-PAID-FROM.
  9778     MOVE AL-UANON               TO EPYFROMA.
  9779
  9780     IF PI-EPYFROM = ZEROS
  9781         GO TO 1120-CALCULATE-PAID-FROM.
  9782
  9783     IF PI-PMTTYPE = '5' OR '6'
  9784         MOVE ER-0448            TO EMI-ERROR
  9785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9786         MOVE AL-UNBON           TO EPYFROMA
  9787         MOVE -1                 TO EPYFROML
  9788         GO TO 1150-EDIT-PAID-THRU.
  9789
  9790     MOVE '4'                    TO DC-OPTION-CODE.
  9791     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
  9792     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9793
  9794     IF DATE-CONVERSION-ERROR
  9795         MOVE ER-0449            TO EMI-ERROR
  9796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9797         MOVE AL-UNBON           TO EPYFROMA
  9798         MOVE -1                 TO EPYFROML
  9799     ELSE
  9800         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
  9801
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 190
* EL156.cbl
  9803 1120-CALCULATE-PAID-FROM.
  9804     IF PI-PMTTYPE = '5' OR '6'
  9805         GO TO 1150-EDIT-PAID-THRU.
  9806
  9807*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9808*       IF PI-PMTTYPE = '4'
  9809*         GO TO 1150-EDIT-PAID-THRU.
  9810
  9811     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9812         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9813         MOVE ' '                TO DC-OPTION-CODE
  9814         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9815         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9816         GO TO 1145-TEST-PAID-FROM.
  9817
  9818     IF PI-PMTTYPE = '4'
  9819        GO TO 1150-EDIT-PAID-THRU.
  9820
  9821     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  9822     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9823     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9824     MOVE '5'                    TO CNTL-REC-TYPE.
  9825     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9826     MOVE 'BENE'                 TO FILE-SWITCH.
  9827
  9828     IF WS-BEN-CD = ZEROS
  9829         GO TO 1950-NOT-FOUND.
  9830
  9831     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9832
  9833     IF NO-BENEFIT-FOUND
  9834         GO TO 1950-NOT-FOUND.
  9835
  9836     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
  9837     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
  9838
  9839     IF PI-BEN-DAYS NOT NUMERIC
  9840        MOVE ZEROS               TO PI-BEN-DAYS.
  9841
  9842     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
  9843
  9844     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
  9845        (CL-TOTAL-PAID-AMT > ZEROS)
  9846         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  9847         MOVE '6'                 TO DC-OPTION-CODE
  9848         MOVE +0                  TO DC-ELAPSED-MONTHS
  9849         MOVE +1                  TO DC-ELAPSED-DAYS
  9850         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9851         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
  9852         GO TO 1145-TEST-PAID-FROM.
  9853
  9854******************************************************************
  9855****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
  9856****** SPECIAL ENTERED DATE.
  9857******************************************************************
  9858
  9859     IF PI-AIGFROM = ZEROS
  9860         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 191
* EL156.cbl
  9861
  9862     MOVE AL-UANON TO AIGFROMA.
  9863
  9864     MOVE '4'                    TO DC-OPTION-CODE.
  9865     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
  9866     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9867
  9868     IF DATE-CONVERSION-ERROR
  9869         MOVE ER-0449            TO EMI-ERROR
  9870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9871         MOVE AL-UNBON           TO AIGFROMA
  9872         MOVE -1                 TO AIGFROML
  9873         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
  9874     ELSE
  9875         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
  9876         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
  9877
  9878     GO TO 1140-CONTINUE-PAID-FROM.
  9879
  9880 1130-CONTINUE-PAID-FROM.
  9881
  9882     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9883        (CL-TOTAL-PAID-AMT = ZEROS)
  9884           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
  9885
  9886 1140-CONTINUE-PAID-FROM.
  9887
  9888     IF PI-BEN-TYPE = 'R'
  9889         IF PI-BEN-DAYS = ZEROS
  9890             NEXT SENTENCE
  9891         ELSE
  9892         IF PI-COMPANY-ID NOT = 'DMD'
  9893             SUBTRACT 1 FROM PI-BEN-DAYS.
  9894
  9895     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
  9896
  9897     IF PI-COMPANY-ID = 'DMD'
  9898         MOVE -1                 TO DC-ELAPSED-DAYS
  9899         MOVE +0                 TO DC-ELAPSED-MONTHS
  9900         MOVE '6'                TO DC-OPTION-CODE
  9901         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9902         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
  9903         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
  9904                               REMAINDER DC-ELAPSED-DAYS
  9905      ELSE
  9906         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
  9907         MOVE +0                 TO DC-ELAPSED-MONTHS.
  9908
  9909     MOVE '6'                    TO DC-OPTION-CODE.
  9910     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9911     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
  9912
  9913     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
  9914
  9915     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
  9916         MOVE ER-0541            TO EMI-ERROR
  9917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9918         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 192
* EL156.cbl
  9919         MOVE AL-UNBON           TO EPYFROMA.
  9920
  9921     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
  9922        (PI-BENEFIT-SAVE = '60E')
  9923        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
  9924           (CL-TOTAL-PAID-AMT = ZEROS)
  9925             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
  9926             MOVE 30                  TO DC-ELAPSED-DAYS
  9927             MOVE +0                  TO DC-ELAPSED-MONTHS
  9928             MOVE '6'                 TO DC-OPTION-CODE
  9929             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9930
  9931     IF PI-BEN-TYPE = 'R'
  9932         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
  9933     ELSE
  9934         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
  9935         IF WS-SV-EPYFROM = LOW-VALUES
  9936            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
  9937
  9938     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
  9939         IF WS-USE-AIG-PAYFROM   OR
  9940            WS-AIG-RECALC-PAYFROM
  9941              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
  9942                                      DC-BIN-DATE-1
  9943              MOVE ' '            TO  DC-OPTION-CODE
  9944              MOVE +0             TO  DC-ELAPSED-MONTHS
  9945                                      DC-ELAPSED-DAYS
  9946              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9947              IF NO-CONVERSION-ERROR
  9948                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
  9949
  9950     IF PI-CPYFROM < CL-INCURRED-DT
  9951        MOVE -1                  TO EPYFROML
  9952        MOVE ER-3542             TO EMI-ERROR
  9953        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9954
  9955     IF CM-ENTRY-DT < CL-INCURRED-DT
  9956        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  9957        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
  9958        MOVE +0                     TO DC-ELAPSED-DAYS
  9959        MOVE +0                     TO DC-ELAPSED-MONTHS
  9960        MOVE '1'                    TO DC-OPTION-CODE
  9961        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9962        ELSE
  9963        MOVE ZEROS TO DC-ELAPSED-MONTHS.
  9964
  9965     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
  9966         NEXT SENTENCE
  9967     ELSE
  9968         IF DC-ELAPSED-MONTHS < 2
  9969             MOVE ER-3255        TO EMI-ERROR
  9970             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9971
  9972 1145-TEST-PAID-FROM.
  9973     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
  9974         GO TO 1150-EDIT-PAID-THRU.
  9975
  9976     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 193
* EL156.cbl
  9977         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
  9978         MOVE ' '                TO DC-OPTION-CODE
  9979         MOVE +0                 TO DC-ELAPSED-MONTHS
  9980                                    DC-ELAPSED-DAYS
  9981         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9982         IF NO-CONVERSION-ERROR
  9983             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
  9984         ELSE
  9985             MOVE SPACES             TO EMI-DATE-FIELD.
  9986
  9987     IF WS-SV-EPYFROM NOT = PI-CPYFROM
  9988         IF CL-TOTAL-PAID-AMT = ZEROS
  9989             MOVE ER-3543            TO EMI-ERROR
  9990             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
  9991             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9992             IF EMI-MESSAGE-FORMATTED
  9993                MOVE -1             TO EPYFROML
  9994                MOVE AL-UNBON       TO EPYFROMA
  9995             ELSE
  9996                NEXT SENTENCE
  9997         ELSE
  9998             MOVE ER-0452            TO EMI-ERROR
  9999             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10001             IF EMI-MESSAGE-FORMATTED
 10002                MOVE -1             TO EPYFROML
 10003                MOVE AL-UNBON       TO EPYFROMA.
 10004
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 194
* EL156.cbl
 10006 1150-EDIT-PAID-THRU.
 10007
 10008     MOVE AL-UANON               TO EPYTHRUA.
 10009
 10010     IF PI-EPYTHRU = ZEROS
 10011         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10012             GO TO 1200-EDIT-FIND-TOLERANCES
 10013         ELSE
 10014            IF (PI-PMTTYPE = '3') OR
 10015               (PI-PMTTYPE = '2' AND
 10016                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10017               GO TO 1152-CHECK-TYPE
 10018            ELSE
 10019               MOVE ER-0473      TO EMI-ERROR
 10020               GO TO 1170-PAID-THRU-FATAL-ERROR
 10021     ELSE
 10022         IF PI-PMTTYPE = '5' OR '6'
 10023             MOVE ER-0474        TO EMI-ERROR
 10024             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10025
 10026     MOVE '4'                    TO DC-OPTION-CODE.
 10027     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10028     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10029
 10030     IF DATE-CONVERSION-ERROR
 10031         MOVE ER-0475            TO EMI-ERROR
 10032         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10033
 10034     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10035
 10036     IF PI-COMPANY-ID = 'DMD'
 10037         IF PI-PMTTYPE NOT = '2'
 10038                 AND
 10039            WS-EXP-DT > WS-SV-EPYTHRU
 10040             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10041             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10042             MOVE '1'              TO DC-OPTION-CODE
 10043             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10044             IF DATE-CONVERSION-ERROR
 10045                 MOVE ER-0944      TO EMI-ERROR
 10046                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10047             ELSE
 10048                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10049                    DC-ELAPSED-DAYS   = 1
 10050                     MOVE ER-0945  TO EMI-ERROR
 10051                     MOVE -1       TO EPYTHRUL
 10052                     MOVE AL-UABON TO EPYTHRUA
 10053                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054
 10055     IF PI-PMTTYPE = '4'
 10056         NEXT SENTENCE
 10057     ELSE
 10058         IF WS-SV-EPYTHRU = WS-EXP-DT
 10059             IF PI-PMTTYPE NOT = '2' AND '3'
 10060                 MOVE ER-3541    TO EMI-ERROR
 10061                 MOVE -1         TO PMTTYPEL
 10062                 MOVE AL-UABON   TO PMTTYPEA
 10063                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 195
* EL156.cbl
 10064
 10065     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10066         MOVE ER-0501            TO EMI-ERROR
 10067         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10068
 10069     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10070        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10071*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10072*              MOVE ER-0540         TO EMI-ERROR
 10073*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10074*              MOVE -1              TO EPYTHRUL
 10075*              MOVE AL-UNBON        TO EPYTHRUA
 10076*          ELSE
 10077*          IF PI-COMPANY-ID = 'DMD'
 10078*              MOVE ER-7540         TO EMI-ERROR
 10079*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10080*              MOVE -1              TO EPYTHRUL
 10081*              MOVE AL-UNBON        TO EPYTHRUA
 10082*          ELSE
 10083               IF PI-PMTTYPE NOT = '2' AND '3'
 10084                  IF PI-COMPANY-ID = '???'
 10085                      MOVE ER-7540  TO EMI-ERROR
 10086                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10087                      MOVE -1       TO EPYTHRUL
 10088                      MOVE AL-UNBON TO EPYTHRUA
 10089                  ELSE
 10090                      MOVE ER-0540  TO EMI-ERROR
 10091                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10092                      MOVE -1       TO EPYTHRUL
 10093                      MOVE AL-UNBON TO EPYTHRUA.
 10094
 10095     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10096            OR
 10097        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10098         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10099            OR
 10100        (PI-CPYFROM NOT = LOW-VALUES AND
 10101         PI-CPYFROM < CL-PAID-THRU-DT)
 10102        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10103
 10104 1152-CHECK-TYPE.
 10105     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10106        OR (PI-PMTTYPE = '5' OR '6')
 10107         GO TO 1160-EDIT-PAID-THRU-AH.
 10108
 10109 1155-EDIT-PAID-THRU-LIFE.
 10110     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10111     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10112     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10113     MOVE '4'                    TO CNTL-REC-TYPE.
 10114     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10115     MOVE 'BENE'                 TO FILE-SWITCH.
 10116
 10117     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10118
 10119     IF NO-BENEFIT-FOUND
 10120         GO TO 1950-NOT-FOUND.
 10121
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 196
* EL156.cbl
 10122     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10123
 10124     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10125
 10126     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10127        PI-LF-COVERAGE-TYPE = 'P'
 10128         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10129         GO TO 1200-EDIT-FIND-TOLERANCES.
 10130
 10131     IF PI-EPYTHRU = ZEROS
 10132        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10133
 10134     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10135         MOVE ER-0476            TO EMI-ERROR
 10136         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10137
 10138     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10139     MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10140     MOVE +0                    TO DC-ELAPSED-DAYS.
 10141     MOVE '6'                   TO DC-OPTION-CODE.
 10142     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10143
 10144     IF (NO-CONVERSION-ERROR AND
 10145         WS-SPECIAL-CALC-CD = 'C')
 10146        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10147            MOVE ER-0657 TO EMI-ERROR
 10148            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10149
 10150     IF PI-COMPANY-ID = 'NCL'
 10151         IF WS-SPECIAL-CALC-CD = 'C' AND
 10152            CM-LF-CRITICAL-PERIOD = +0
 10153             MOVE ER-0844       TO EMI-ERROR
 10154             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10155
 10156     GO TO 1200-EDIT-FIND-TOLERANCES.
 10157
 10158 1160-EDIT-PAID-THRU-AH.
 10159     IF PI-EPYTHRU = ZEROS
 10160        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10161                                    WS-SV-EPYTHRU
 10162     ELSE
 10163        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10164
 10165     IF WS-SV-EPYTHRU < PI-CPYFROM
 10166         MOVE ER-0508            TO EMI-ERROR
 10167         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10168
 10169     IF PI-PMTTYPE = '3'
 10170        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10171         IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10172             MOVE ER-0477        TO EMI-ERROR
 10173             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 10174         ELSE
 10175             NEXT SENTENCE
 10176     ELSE
 10177         IF WS-SV-EPYTHRU > WS-EXP-DT
 10178             MOVE ER-0557        TO EMI-ERROR
 10179             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 197
* EL156.cbl
 10180
 10181     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10182         PI-PMTTYPE NOT = '3'
 10183         MOVE ER-0541        TO EMI-ERROR
 10184         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10185
 10186     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 10187        (PI-PMTTYPE NOT = '3')
 10188         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10189             MOVE ER-0478        TO EMI-ERROR
 10190             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10191
 10192     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10193        (PI-PMTTYPE NOT = '4')
 10194         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10195             MOVE ER-0479        TO EMI-ERROR
 10196             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10197
 10198     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10199         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10200             MOVE ER-0545        TO EMI-ERROR
 10201             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10202
 10203     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10204         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10205             MOVE ER-0481        TO EMI-ERROR
 10206             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10207
 10208*    IF PI-COMPANY-ID = 'NCL'
 10209*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10210*           CM-AH-CRITICAL-PERIOD = +0
 10211*            MOVE ER-0844        TO  EMI-ERROR
 10212*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10213
 10214     IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10215        (WS-SPECIAL-CALC-CD NOT = 'C')
 10216          GO TO 1200-EDIT-FIND-TOLERANCES.
 10217
 10218     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10219     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10220     MOVE '1'        TO DC-OPTION-CODE.
 10221     MOVE +0         TO DC-ELAPSED-DAYS
 10222                        DC-ELAPSED-MONTHS.
 10223     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10224
 10225*    IF NO-CONVERSION-ERROR
 10226*       COMPUTE WS-CRIT-PERIOD-DAYS =
 10227*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10228*       IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 10229*           MOVE ER-0657 TO EMI-ERROR
 10230*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10231
 10232     GO TO 1200-EDIT-FIND-TOLERANCES.
 10233
 10234 1165-PAID-THRU-ERROR.
 10235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10236
 10237     IF EMI-MESSAGE-FORMATTED
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 198
* EL156.cbl
 10238         MOVE -1                 TO EPYTHRUL
 10239         MOVE AL-UNBON           TO EPYTHRUA.
 10240
 10241 1165-EXIT.
 10242     EXIT.
 10243
 10244 1166-CHECK-ALL-TRLRS.
 10245
 10246     IF PI-PMTTYPE = '4'
 10247        GO TO 1166-TRLR-EXIT.
 10248
 10249     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10250
 10251     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10252        WS-SV-EPYFROM = LOW-VALUES
 10253          GO TO 1166-END-CHECK.
 10254
 10255
 10256* EXEC CICS HANDLE CONDITION
 10257*        ENDFILE   (1166-END-CHECK)
 10258*        NOTFND    (1166-END-CHECK)
 10259*    END-EXEC.
 10260*    MOVE '"$''I                  ! ) #00009908' TO DFHEIV0
 10261     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10263     MOVE X'2920233030303039393038' TO DFHEIV0(25:11)
 10264     CALL 'kxdfhei1' USING DFHEIV0
 10265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10266
 10267
 10268     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10269     MOVE +100                   TO TRLR-SEQ-NO.
 10270
 10271
 10272* EXEC CICS STARTBR
 10273*         DATASET    ('ELTRLR')
 10274*         RIDFLD     (ELTRLR-KEY)
 10275*         GTEQ
 10276*    END-EXEC.
 10277     MOVE 'ELTRLR' TO DFHEIV1
 10278     MOVE 0
 10279       TO DFHEIV11
 10280*    MOVE '&,         G          &   #00009916' TO DFHEIV0
 10281     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10282     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10283     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 10284     CALL 'kxdfhei1' USING DFHEIV0,
 10285           DFHEIV1,
 10286           ELTRLR-KEY,
 10287           DFHEIV99,
 10288           DFHEIV11,
 10289           DFHEIV99
 10290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10291
 10292
 10293     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10294
 10295 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 199
* EL156.cbl
 10296
 10297
 10298* EXEC CICS READNEXT
 10299*         DATASET    ('ELTRLR')
 10300*         RIDFLD     (ELTRLR-KEY)
 10301*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10302*    END-EXEC.
 10303     MOVE 'ELTRLR' TO DFHEIV1
 10304     MOVE 0
 10305       TO DFHEIV11
 10306*    MOVE '&.S                   )   #00009926' TO DFHEIV0
 10307     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10308     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10309     MOVE X'2020233030303039393236' TO DFHEIV0(25:11)
 10310     CALL 'kxdfhei1' USING DFHEIV0,
 10311           DFHEIV1,
 10312           DFHEIV20,
 10313           DFHEIV99,
 10314           ELTRLR-KEY,
 10315           DFHEIV99,
 10316           DFHEIV11,
 10317           DFHEIV99,
 10318           DFHEIV99
 10319     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10320         DFHEIV20
 10321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10322
 10323
 10324     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 10325        TRLR-CARRIER  = MSTR-CARRIER  AND
 10326        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 10327        TRLR-CERT-NO  = MSTR-CERT-NO
 10328          NEXT SENTENCE
 10329      ELSE
 10330          GO TO 1166-END-CHECK.
 10331
 10332* **  BYPASS ALL NON-PAYMENT TRAILERS
 10333
 10334     IF AT-TRAILER-TYPE = '2'
 10335        NEXT SENTENCE
 10336     ELSE
 10337        GO TO 1166-READ-TRLR-NEXT.
 10338
 10339* **  BYPASS ALL NON-PARTIAL PAYMENTS
 10340
 10341     IF AT-PAYMENT-TYPE = '1' OR '2'
 10342        NEXT SENTENCE
 10343     ELSE
 10344        GO TO 1166-READ-TRLR-NEXT.
 10345
 10346* **  BYPASS ALL VOID PAYMENTS
 10347
 10348     IF AT-VOID-DT NOT = LOW-VALUES
 10349        GO TO 1166-READ-TRLR-NEXT.
 10350
 10351     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 10352        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 10353          GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 200
* EL156.cbl
 10354
 10355     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 10356         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 10357            OR
 10358        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 10359         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 10360        NEXT SENTENCE
 10361     ELSE
 10362         IF CL-TOTAL-PAID-AMT > ZEROS
 10363             MOVE ER-0502            TO EMI-ERROR
 10364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10365             MOVE -1                 TO EPYTHRUL
 10366             MOVE AL-UNBON           TO EPYTHRUA.
 10367
 10368     GO TO 1166-READ-TRLR-NEXT.
 10369
 10370 1166-END-CHECK.
 10371
 10372     IF WS-BROWSE-TRLR-SW = 'Y'
 10373
 10374* EXEC CICS ENDBR
 10375*            DATASET   ('ELTRLR')
 10376*       END-EXEC.
 10377     MOVE 'ELTRLR' TO DFHEIV1
 10378     MOVE 0
 10379       TO DFHEIV11
 10380*    MOVE '&2                    $   #00009981' TO DFHEIV0
 10381     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10382     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10383     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 10384     CALL 'kxdfhei1' USING DFHEIV0,
 10385           DFHEIV1,
 10386           DFHEIV11,
 10387           DFHEIV99
 10388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10389
 10390
 10391     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10392
 10393 1166-TRLR-EXIT.
 10394     EXIT.
 10395
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 201
* EL156.cbl
 10397 1170-PAID-THRU-FATAL-ERROR.
 10398     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10399
 10400     MOVE -1                     TO EPYTHRUL.
 10401     MOVE AL-UNBON               TO EPYTHRUA.
 10402
 10403 1200-EDIT-FIND-TOLERANCES.
 10404
 10405* EXEC CICS HANDLE CONDITION
 10406*        ENDFILE(1950-NOT-FOUND)
 10407*        NOTFND (1950-NOT-FOUND)
 10408*    END-EXEC.
 10409*    MOVE '"$''I                  ! * #00009998' TO DFHEIV0
 10410     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10412     MOVE X'2A20233030303039393938' TO DFHEIV0(25:11)
 10413     CALL 'kxdfhei1' USING DFHEIV0
 10414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10415
 10416
 10417     IF PI-PROCESSOR-ID = 'LGXX'
 10418        GO TO 1240-FIND-ACCT-TOLERANCES.
 10419
 10420     MOVE 'N'                    TO FOUND-TOL-SW.
 10421     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10422     MOVE '2'                    TO CNTL-REC-TYPE.
 10423     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 10424     MOVE +0                     TO CNTL-SEQ-NO.
 10425     MOVE 'PROC'                 TO FILE-SWITCH.
 10426
 10427     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10428
 10429     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 10430     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 10431                                    PI-MAX-PMT-TOL.
 10432     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 10433
 10434     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10435         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 10436
 10437     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 10438     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 10439                                    PI-MAX-LF-PMT-TOL.
 10440
 10441     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 10442         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 10443
 10444     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 10445                                    PI-MAX-EXP-PMT.
 10446
 10447 1240-FIND-ACCT-TOLERANCES.
 10448
 10449     IF WS-PMT-TOL NOT = +0
 10450         MOVE 'Y'                TO FOUND-TOL-SW.
 10451
 10452     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10453         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10454         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 202
* EL156.cbl
 10455         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 10456         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 10457         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 10458         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 10459     ELSE
 10460         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 10461         MOVE PI-CARRIER             TO ACCT-CARRIER
 10462         MOVE PI-GROUPING            TO ACCT-GROUPING
 10463         MOVE PI-STATE               TO ACCT-STATE
 10464         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 10465         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10466
 10467     MOVE 'ACCT'                 TO FILE-SWITCH.
 10468
 10469     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10470     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10471
 10472
 10473* EXEC CICS HANDLE CONDITION
 10474*         NOTFND   (1950-NOT-FOUND)
 10475*         ENDFILE  (1950-NOT-FOUND)
 10476*    END-EXEC.
 10477*    MOVE '"$I''                  ! + #00010058' TO DFHEIV0
 10478     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10479     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10480     MOVE X'2B20233030303130303538' TO DFHEIV0(25:11)
 10481     CALL 'kxdfhei1' USING DFHEIV0
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485
 10486* EXEC CICS STARTBR
 10487*        DATASET('ERACCT')
 10488*        RIDFLD (ERACCT-KEY)
 10489*        GTEQ
 10490*    END-EXEC.
 10491     MOVE 'ERACCT' TO DFHEIV1
 10492     MOVE 0
 10493       TO DFHEIV11
 10494*    MOVE '&,         G          &   #00010063' TO DFHEIV0
 10495     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10496     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10497     MOVE X'2020233030303130303633' TO DFHEIV0(25:11)
 10498     CALL 'kxdfhei1' USING DFHEIV0,
 10499           DFHEIV1,
 10500           ERACCT-KEY,
 10501           DFHEIV99,
 10502           DFHEIV11,
 10503           DFHEIV99
 10504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10505
 10506
 10507 1245-FIND-ACCT-TOLERANCES-LOOP.
 10508
 10509
 10510* EXEC CICS READNEXT
 10511*        DATASET('ERACCT')
 10512*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 203
* EL156.cbl
 10513*        RIDFLD (ERACCT-KEY)
 10514*    END-EXEC.
 10515     MOVE 'ERACCT' TO DFHEIV1
 10516     MOVE 0
 10517       TO DFHEIV11
 10518*    MOVE '&.S                   )   #00010071' TO DFHEIV0
 10519     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10520     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10521     MOVE X'2020233030303130303731' TO DFHEIV0(25:11)
 10522     CALL 'kxdfhei1' USING DFHEIV0,
 10523           DFHEIV1,
 10524           DFHEIV20,
 10525           DFHEIV99,
 10526           ERACCT-KEY,
 10527           DFHEIV99,
 10528           DFHEIV11,
 10529           DFHEIV99,
 10530           DFHEIV99
 10531     SET ADDRESS OF ACCOUNT-MASTER TO
 10532         DFHEIV20
 10533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10534
 10535
 10536     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10537        IF WS-ERACCT-HOLD-RECORD = SPACES
 10538           GO TO 1950-NOT-FOUND
 10539        ELSE
 10540           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10541           GO TO 1250-CONTINUE.
 10542
 10543     IF ACCT-EXP-DT = HIGH-VALUES
 10544        NEXT SENTENCE
 10545     ELSE
 10546        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10547        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 10548
 10549 1250-CONTINUE.
 10550
 10551     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 10552
 10553     IF FOUND-TOL-SW = 'N'
 10554         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 10555
 10556********* 1260-FIND-STATE-TOLERANCES.
 10557
 10558     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10559     MOVE PI-STATE               TO WS-ST-ACCESS.
 10560     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10561     MOVE '3'                    TO CNTL-REC-TYPE.
 10562     MOVE +0                     TO CNTL-SEQ-NO.
 10563     MOVE 'STAT'                 TO FILE-SWITCH.
 10564
 10565     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10566
 10567     IF WS-PMT-TOL = +0
 10568         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 10569
 10570     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 204
* EL156.cbl
 10571     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 10572     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 10573     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 10574     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 10575
 10576     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1 AND
 10577        PI-VFY-2ND-BENE = 'Y' AND
 10578        PI-PAYEE-TYPE <> 'B'
 10579           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 10580     END-IF.
 10581
 10582     IF PI-PMTTYPE      = '2'  AND
 10583        PI-SPLIT-PMT-SW = 'Y'  AND
 10584        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 10585          MOVE ER-3530                TO EMI-ERROR
 10586          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10587
 10588********* 1280-FIND-BENEFIT-TOLERANCES.
 10589
 10590     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10591        OR (PI-PMTTYPE = '5' OR '6')
 10592         GO TO 1300-FIND-CARR-TOLERANCES.
 10593
 10594     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10595     MOVE '4'                    TO CNTL-REC-TYPE.
 10596     MOVE +0                     TO CNTL-SEQ-NO.
 10597     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10598     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10599     MOVE 'BENE'                 TO FILE-SWITCH.
 10600
 10601     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10602
 10603     IF NO-BENEFIT-FOUND
 10604         GO TO 1950-NOT-FOUND.
 10605
 10606     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 10607     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 10608     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 10609
 10610
 10611* EXEC CICS HANDLE CONDITION
 10612*        NOTFND(1950-NOT-FOUND)
 10613*    END-EXEC.
 10614*    MOVE '"$I                   ! , #00010151' TO DFHEIV0
 10615     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10617     MOVE X'2C20233030303130313531' TO DFHEIV0(25:11)
 10618     CALL 'kxdfhei1' USING DFHEIV0
 10619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10620
 10621
 10622 1300-FIND-CARR-TOLERANCES.
 10623     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10624     MOVE '6'                    TO CNTL-REC-TYPE.
 10625
 10626     IF CONTROL-IS-ACTUAL-CARRIER
 10627         MOVE PI-CARRIER               TO WS-CARR
 10628     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 205
* EL156.cbl
 10629         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10630
 10631     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10632     MOVE +0                     TO CNTL-SEQ-NO.
 10633     MOVE 'CARR'                 TO FILE-SWITCH.
 10634
 10635     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 10636
 10637     IF WS-DAYS-TOL = +0
 10638         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 10639
 10640     IF WS-PMT-TOL = +0
 10641         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 10642
 10643     IF WS-MAX-DAYS-TOL = +0
 10644         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 10645
 10646     IF WS-MAX-PMT-TOL = +0
 10647         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 10648                                    PI-MAX-PMT-TOL.
 10649
 10650     IF WS-MAX-LF-PMT-TOL = +0
 10651        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 10652                                    PI-MAX-LF-PMT-TOL.
 10653
 10654     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 10655
 10656********* 1320-FIND-COMP-TOLERANCES.
 10657
 10658     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10659     MOVE '1'                    TO CNTL-REC-TYPE.
 10660     MOVE SPACES                 TO CNTL-ACCESS.
 10661     MOVE +0                     TO CNTL-SEQ-NO.
 10662     MOVE 'COMP'                 TO FILE-SWITCH.
 10663
 10664     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10665
 10666     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 10667     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 10668
 10669     IF WS-PMT-TOL NOT = +0
 10670        IF WS-TOL-SEVERITY NOT = ' '
 10671         GO TO 1360-EDIT-DAYS.
 10672
 10673     IF WS-PMT-TOL = +0
 10674         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 10675
 10676     IF WS-TOL-SEVERITY = ' '
 10677         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 10678
 10679 1360-EDIT-DAYS.
 10680     IF PI-PMTTYPE NOT = '4'
 10681        IF PI-EDAYS NEGATIVE OR
 10682           PI-EPYAMT NEGATIVE
 10683          MOVE ER-0513             TO EMI-ERROR
 10684          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10685          MOVE -1                  TO PMTTYPEL.
 10686
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 206
* EL156.cbl
 10687     IF PI-PMTTYPE = '5' OR '6'
 10688        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 10689
 10690     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10691        IF PI-PMTTYPE = '4'
 10692          MOVE PI-EDAYS          TO PI-CDAYS.
 10693
 10694     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10695         GO TO 1440-COMPUTE-LIFE-REMAINING.
 10696
 10697     IF PI-PMTTYPE = '4'
 10698        MOVE PI-EDAYS            TO PI-CDAYS
 10699        GO TO 1400-EDIT-PAYMENT.
 10700
 10701     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 10702        GO TO 1500-EDIT-EXPENSES.
 10703
 10704*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10705*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 10706*          CM-AH-BENEFIT-CD = '23'              AND
 10707*          CL-CERT-STATE    = '04'              AND
 10708*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10709*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 10710*            GO TO 1362-CHECK-MAX-DAYS.
 10711
 10712     IF PI-EDAYS = ZEROS
 10713*        IF PI-COMPANY-ID = 'DMD'
 10714*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 10715*            MOVE -1             TO DC-ELAPSED-DAYS
 10716*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 10717*            MOVE '6'            TO DC-OPTION-CODE
 10718*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10719*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 10720*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 10721*            MOVE '1'            TO DC-OPTION-CODE
 10722*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10723*            IF NO-CONVERSION-ERROR
 10724*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 10725*                                 + DC-ODD-DAYS-OVER
 10726*               MOVE 6           TO EDAYSL
 10727*               MOVE AL-UNNON    TO EDAYSA
 10728*            ELSE
 10729*                NEXT SENTENCE
 10730*       ELSE
 10731            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 10732            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 10733            MOVE '1'             TO DC-OPTION-CODE
 10734            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10735            IF NO-CONVERSION-ERROR
 10736                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 10737                ADD 1                 TO PI-EDAYS
 10738                MOVE AL-UNNON         TO EDAYSA.
 10739
 10740*    IF PI-COMPANY-ID = 'DMD'
 10741*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10742*        MOVE -1                 TO DC-ELAPSED-DAYS
 10743*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 10744*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 207
* EL156.cbl
 10745*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10746*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10747*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 10748*        MOVE '1'                TO DC-OPTION-CODE
 10749*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10750*    ELSE
 10751         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 10752         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 10753         MOVE '1'                TO DC-OPTION-CODE.
 10754         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10755
 10756     IF NO-CONVERSION-ERROR
 10757        IF PI-COMPANY-ID = 'DMD'
 10758            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 10759                             + DC-ODD-DAYS-OVER
 10760        ELSE
 10761            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 10762            ADD 1                TO PI-CDAYS.
 10763
 10764     IF DC-ODD-DAYS-OVER NOT = ZEROS
 10765        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 10766        ADD 1                    TO EXPENSE-MONTH-SAVE.
 10767
 10768     IF PI-EDAYS NOT NUMERIC
 10769         MOVE ER-0491            TO EMI-ERROR
 10770         GO TO 1370-DAYS-ERROR.
 10771
 10772     IF CL-NO-OF-PMTS-MADE = 0
 10773        AND PI-COMPANY-ID = 'CID'
 10774        AND CL-CERT-STATE = 'MI'
 10775        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 10776            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 10777     END-IF.
 10778
 10779 1362-CHECK-MAX-DAYS.
 10780
 10781     IF WS-MAX-DAYS-TOL = +999
 10782         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 10783
 10784     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 10785         IF PI-EDAYS = ZEROS
 10786             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 10787         ELSE
 10788             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 10789
 10790     IF WS-MAX-DAYS-TOL NOT = ZERO
 10791        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 10792           PI-CDAYS > WS-MAX-DAYS-TOL
 10793             MOVE ER-0492          TO EMI-ERROR
 10794             GO TO 1370-DAYS-ERROR.
 10795
 10796 1365-SKIP-MAX-DAYS-EDIT.
 10797     IF PI-EDAYS = ZEROS
 10798        GO TO 1400-EDIT-PAYMENT.
 10799
 10800     IF WS-DAYS-TOL NOT = ZERO
 10801        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 10802           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 208
* EL156.cbl
 10803                MOVE ER-0493     TO EMI-ERROR
 10804                GO TO 1370-DAYS-ERROR.
 10805
 10806     GO TO 1400-EDIT-PAYMENT.
 10807
 10808 1370-DAYS-ERROR.
 10809     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10810
 10811     IF EMI-MESSAGE-FORMATTED
 10812         MOVE -1                 TO EDAYSL
 10813         MOVE AL-UABON           TO EDAYSA.
 10814
 10815     GO TO 1400-EDIT-PAYMENT.
 10816
 10817 1380-EDIT-EXPENSE-PMT-AMT.
 10818     IF PI-PMTTYPE = '5' OR '6'
 10819         NEXT SENTENCE
 10820     ELSE
 10821         GO TO 1400-EDIT-PAYMENT.
 10822
 10823     IF WS-MAX-EXP-PMT NOT = ZEROS
 10824        IF PI-EPYAMT > WS-MAX-EXP-PMT
 10825            MOVE ER-3529            TO EMI-ERROR
 10826            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 10827
 10828     GO TO 1500-EDIT-EXPENSES.
 10829
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 209
* EL156.cbl
 10831
 10832 1390-CHECK-PAYMENT-DAYS.
 10833
 10834     IF PI-EDAYS = 0
 10835         MOVE PI-CDAYS TO WS-PD-DAYS
 10836     ELSE
 10837         MOVE PI-EDAYS TO WS-PD-DAYS
 10838     END-IF.
 10839
 10840     IF CM-AH-BENEFIT-CD = '20' OR '21'
 10841         IF WS-PD-DAYS = 14
 10842            GO TO 1390-EXIT
 10843         END-IF
 10844     END-IF.
 10845
 10846     IF WS-PD-DAYS < 30
 10847         MOVE ER-3549              TO EMI-ERROR
 10848         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 10849     END-IF.
 10850
 10851 1390-EXIT.
 10852      EXIT.
 10853
 10854 1400-EDIT-PAYMENT.
 10855*    IF PI-COMPANY-ID = 'DMD'
 10856*       IF CL-CERT-NO (5:2) = '69' OR '70'
 10857*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 10858
 10859     IF PI-PMTTYPE NOT = '4'
 10860        GO TO 1405-CALC-PAYMENT.
 10861
 10862     IF PI-EDAYS NOT NUMERIC
 10863         MOVE PI-EPYAMT           TO PI-CPYAMT
 10864         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 10865         GO TO 1430-CHECK-AH-TOLERANCE.
 10866
 10867*    IF PI-COMPANY-ID = 'FIA'
 10868*       IF CERT-ACCOUNT = '0000011043'
 10869*        COMPUTE PI-DAILY-RATE ROUNDED =
 10870*                      (CM-AH-BENEFIT-AMT * 13) / 365
 10871*        COMPUTE PI-CPYAMT ROUNDED =
 10872*                          PI-DAILY-RATE * PI-EDAYS
 10873*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 10874*        GO TO 1430-CHECK-AH-TOLERANCE.
 10875
 10876     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 10877         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 10878         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 10879         GO TO 1420-CHECK-AIG-BENEFIT.
 10880
 10881     IF WS-CALC-METHOD = '2' OR  '5'
 10882         COMPUTE PI-DAILY-RATE ROUNDED =
 10883                        (CM-AH-BENEFIT-AMT * 12) / 365
 10884         COMPUTE PI-CPYAMT ROUNDED =
 10885                           PI-DAILY-RATE * PI-EDAYS
 10886        GO TO 1420-CHECK-AIG-BENEFIT.
 10887
 10888     IF WS-CALC-METHOD = '3'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 210
* EL156.cbl
 10889         COMPUTE PI-DAILY-RATE =
 10890                         (CM-AH-BENEFIT-AMT * 12) / 365
 10891         COMPUTE PI-CPYAMT ROUNDED =
 10892                           PI-DAILY-RATE * PI-EDAYS
 10893        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 211
* EL156.cbl
 10895*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 10896
 10897****************************************************************
 10898****************************************************************
 10899*                  CALCULATED FROM      PAYMENT      PAYMENT
 10900*   DATES           DATE ROUTINE        OPT  1       OPT  6
 10901* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 10902*1-01-83  1-15-83    0    15     15        15           15
 10903*1-01-83  1-30-83    0    30     30        30           30
 10904*1-01-83  1-31-83    1     0     31        30           30
 10905*1-01-83  2-01-83    1     1     32        31           31
 10906*1-01-83  2-15-83    1    15     46        45           45
 10907*1-01-83  2-28-83    2     0     59        60           60
 10908*1-01-83  3-01-83    2     1     60        61           61
 10909*1-01-83  3-31-83    3     0     90        90           90
 10910*1-15-83  1-31-83    0    17     17        17           16
 10911*1-15-83  2-01-83    0    18     18        18           17
 10912*1-15-83  2-28-83    1    14     45        44           46
 10913*1-21-83  3-09-83    1    20     48        50           49
 10914*2-05-83  3-06-83    1     2     30        32           32
 10915*2-05-83  3-23-83    1    19     47        49           49
 10916*2-15-83  2-28-83    0    14     14        14           16
 10917*2-15-83  3-01-83    0    15     15        15           17
 10918*2-21-83  3-19-83    0    27     27        27           29
 10919*2-21-83  3-20-83    1     0     28        30           30
 10920*2-21-83  4-10-83    1    18     49        30           50
 10921*2-21-83  5-19-83    2    27     88        87           89
 10922*2-21-83  5-22-83    3     2     91        92           92
 10923*3-21-83  5-19-83    1    30     60        60           59
 10924****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 212
* EL156.cbl
 10926 1405-CALC-PAYMENT.
 10927     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10928     MOVE ' '                    TO DC-OPTION-CODE.
 10929     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10930     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 10931     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 10932
 10933     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 10934     MOVE ' '                    TO DC-OPTION-CODE.
 10935     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10936     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 10937     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 10938
 10939     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 10940     MOVE -1                     TO DC-ELAPSED-DAYS.
 10941     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 10942     MOVE '6'                    TO DC-OPTION-CODE.
 10943     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10944     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 10945
 10946     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 10947     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 10948     MOVE '1'                    TO DC-OPTION-CODE.
 10949     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10950
 10951     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 10952     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 10953     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 10954
 10955******************************************************************
 10956*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 10957*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 10958*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 10959******************************************************************
 10960
 10961     IF WS-CALC-METHOD = '1'           AND
 10962        DC-ELAPSED-MONTHS > ZERO AND
 10963        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 10964        WDF-DAY > WDT-DAY
 10965          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 10966          MOVE ZEROS               TO DC-ELAPSED-DAYS
 10967          MOVE -1                  TO DC-ELAPSED-MONTHS
 10968          MOVE '6'                 TO DC-OPTION-CODE
 10969          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10970          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 10971          COMPUTE WS-SAVE-ODD-DAYS =
 10972          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 10973          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 10974
 10975     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 10976     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 10977     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 10978
 10979     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 10980     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 10981
 10982*    IF PI-COMPANY-ID = 'FIA'
 10983*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 213
* EL156.cbl
 10984*        COMPUTE PI-DAILY-RATE ROUNDED =
 10985*                          (CM-AH-BENEFIT-AMT * 13) / 365
 10986*        COMPUTE PI-CPYAMT ROUNDED =
 10987*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 10988*        GO TO 1420-CHECK-AIG-BENEFIT.
 10989
 10990*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10991*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 10992*          CM-AH-BENEFIT-CD = '23'               AND
 10993*          CL-CERT-STATE    = '04'               AND
 10994*         (PI-PMTTYPE = '1' OR '2' OR '3')
 10995*            COMPUTE WS-DAILY-RATE ROUNDED =
 10996*                               CM-AH-BENEFIT-AMT / 30
 10997*            COMPUTE PI-CPYAMT ROUNDED =
 10998*                               (WS-DAILY-RATE * PI-CDAYS)
 10999*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11000*            GO TO 1420-CHECK-AIG-BENEFIT.
 11001
 11002     IF WS-CALC-METHOD = '1'
 11003         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11004         COMPUTE PI-CPYAMT ROUNDED =
 11005             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11006             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11007         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11008         GO TO 1420-CHECK-AIG-BENEFIT.
 11009
 11010     IF WS-CALC-METHOD = '2'
 11011         COMPUTE PI-DAILY-RATE ROUNDED =
 11012                          (CM-AH-BENEFIT-AMT * 12) / 365
 11013         COMPUTE PI-CPYAMT ROUNDED =
 11014             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11015             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11016         GO TO 1420-CHECK-AIG-BENEFIT.
 11017
 11018     IF WS-CALC-METHOD = '4'
 11019         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11020         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11021         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11022         COMPUTE PI-CPYAMT ROUNDED =
 11023                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11024         GO TO 1420-CHECK-AIG-BENEFIT.
 11025
 11026     IF WS-CALC-METHOD = '5'
 11027         COMPUTE PI-DAILY-RATE ROUNDED =
 11028                            (CM-AH-BENEFIT-AMT * 12) / 365
 11029         COMPUTE PI-CPYAMT ROUNDED =
 11030                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11031         GO TO 1420-CHECK-AIG-BENEFIT.
 11032
 11033     IF WS-CALC-METHOD NOT = '3'
 11034        GO TO 1410-CHECK-PAYMENT.
 11035
 11036******   CALCULATION METHOD  3  ROUTINE
 11037     COMPUTE PI-DAILY-RATE =
 11038                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11039
 11040******CHECK TO SEE IF WITHIN SAME MONTH
 11041     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 214
* EL156.cbl
 11042        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11043                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11044         GO TO 1420-CHECK-AIG-BENEFIT.
 11045
 11046******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11047     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11048             SAVE-ODD-DAYS-OVER = ZEROS
 11049      COMPUTE PI-CPYAMT  ROUNDED =
 11050                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11051      GO TO 1420-CHECK-AIG-BENEFIT.
 11052
 11053******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11054******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11055     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11056        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11057        IF WDF-MONTH > 12
 11058           ADD 1                 TO WDF-YEAR
 11059           SUBTRACT 12         FROM WDF-MONTH.
 11060
 11061******CONVERT THE NEW FROM MONTH TO BINARY
 11062     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11063        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11064        MOVE '4'              TO DC-OPTION-CODE
 11065        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11066        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11067
 11068     IF WDF-MONTH = WDT-MONTH AND
 11069        WDF-YEAR  = WDT-YEAR
 11070          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11071                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11072                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11073        ELSE
 11074          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11075          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11076          COMPUTE PI-CPYAMT ROUNDED =
 11077       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11078       +
 11079       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11080       +
 11081       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11082
 11083     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 215
* EL156.cbl
 11085 1410-CHECK-PAYMENT.
 11086******PAYMENT OPTION 6
 11087******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11088     IF SAVE-ELAPSED-MONTHS > ZERO
 11089        IF SAVE-ODD-DAYS-OVER = ZEROS
 11090           GO TO 1412-CHECK-TO-DAY
 11091        ELSE
 11092           IF WDF-DAY > WDT-DAY
 11093              IF WDF-MONTH = 02
 11094                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11095                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11096                  GO TO 1412-CHECK-TO-DAY
 11097              ELSE
 11098                  IF FROM-DAYS-IN-MONTH = 31
 11099                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11100                     GO TO 1412-CHECK-TO-DAY
 11101                  ELSE
 11102                     GO TO 1412-CHECK-TO-DAY
 11103           ELSE
 11104               GO TO 1412-CHECK-TO-DAY.
 11105
 11106     IF WDF-MONTH NOT = WDT-MONTH
 11107        IF WDF-MONTH = 02
 11108           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11109           IF WDF-DAY = 29
 11110              ADD 1              TO SAVE-ODD-DAYS-OVER
 11111           ELSE
 11112              ADD 2              TO SAVE-ODD-DAYS-OVER
 11113        ELSE
 11114           IF FROM-DAYS-IN-MONTH = 31
 11115              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11116
 11117 1412-CHECK-TO-DAY.
 11118        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11119           IF WDT-DAY = 28
 11120              ADD 2              TO SAVE-ODD-DAYS-OVER
 11121           ELSE
 11122              IF WDT-DAY = 29
 11123                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11124              ELSE
 11125                 NEXT SENTENCE
 11126        ELSE
 11127           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11128              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11129
 11130     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11131     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11132     COMPUTE PI-CPYAMT ROUNDED =
 11133         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11134         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11135
 11136     GO TO 1420-CHECK-AIG-BENEFIT.
 11137
 11138 1415-CHECK-LEAP-YEAR.
 11139     IF FROM-DAYS-IN-MONTH = 29
 11140        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11141
 11142 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 216
* EL156.cbl
 11143     EXIT.
 11144
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 217
* EL156.cbl
 11146 1420-CHECK-AIG-BENEFIT.
 11147
 11148     IF WS-SPECIAL-CALC-CD = 'Q'
 11149         GO TO 1425-CHECK-WHOLE-MONTH.
 11150
 11151*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11152*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11153*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11154*       (PI-PMTTYPE = '1' OR '2')
 11155*        NEXT SENTENCE
 11156*    ELSE
 11157         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11158         GO TO 1430-CHECK-AH-TOLERANCE.
 11159
 11160******************AIG LOGIC STARTS**********************
 11161*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11162*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11163*    MOVE ER-3533      TO EMI-ERROR.
 11164*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11165*    GO TO 1430-CHECK-AH-TOLERANCE.
 11166******************AIG LOGIC ENDS************************
 11167
 11168 1425-CHECK-WHOLE-MONTH.
 11169******************************************************************
 11170****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11171****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11172****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11173****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11174****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11175****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11176****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11177****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11178****          PAID * MONTHLY BENEFIT.                         ****
 11179******************************************************************
 11180
 11181     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11182
 11183     IF CL-NO-OF-PMTS-MADE > +0
 11184         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11185
 11186     IF PI-CDAYS < WS-BEN-DAYS
 11187         GO TO 1430-CHECK-AH-TOLERANCE.
 11188
 11189     IF PI-CDAYS = WS-BEN-DAYS
 11190         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11191         GO TO 1430-CHECK-AH-TOLERANCE.
 11192
 11193*    IF PI-COMPANY-ID = 'ACM'
 11194*       NEXT SENTENCE
 11195*    ELSE
 11196        GO TO 1425-NOT-ACM-W15C.
 11197
 11198*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11199*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11200*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11201*    MOVE '6'                    TO  DC-OPTION-CODE.
 11202*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11203*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 218
* EL156.cbl
 11204*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11205*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11206*       MOVE '1'                 TO  DC-OPTION-CODE
 11207*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11208*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11209*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11210*       IF NO-CONVERSION-ERROR
 11211*          IF (DC-ELAPSED-MONTHS > +0) OR
 11212*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11213*             NEXT SENTENCE
 11214*          ELSE
 11215*             MOVE +0            TO  PI-CPYAMT
 11216*             MOVE ER-0846       TO  EMI-ERROR
 11217*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11218*             GO TO 1430-CHECK-AH-TOLERANCE
 11219*       ELSE
 11220*           MOVE ER-0846         TO  EMI-ERROR
 11221*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11222*           GO TO 1430-CHECK-AH-TOLERANCE.
 11223*
 11224*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11225*       ADD +1 TO DC-ELAPSED-MONTHS.
 11226*
 11227*    COMPUTE PI-CPYAMT ROUNDED =
 11228*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11229*
 11230*    GO TO 1430-CHECK-AH-TOLERANCE.
 11231
 11232 1425-NOT-ACM-W15C.
 11233
 11234     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11235     MOVE '6'                        TO  DC-OPTION-CODE.
 11236     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11237     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11238
 11239     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11240     IF NO-CONVERSION-ERROR
 11241         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11242     ELSE
 11243         MOVE ER-0846                TO  EMI-ERROR
 11244         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11245         GO TO 1430-CHECK-AH-TOLERANCE.
 11246
 11247     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 11248     MOVE '1'                        TO  DC-OPTION-CODE.
 11249     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11250     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11251     IF NO-CONVERSION-ERROR
 11252         IF DC-ODD-DAYS-OVER = +0
 11253             NEXT SENTENCE
 11254         ELSE
 11255             MOVE ER-0846            TO  EMI-ERROR
 11256             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11257             GO TO 1430-CHECK-AH-TOLERANCE
 11258     ELSE
 11259         MOVE ER-0846                TO  EMI-ERROR
 11260         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11261         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 219
* EL156.cbl
 11262
 11263     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 11264         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 11265
 11266     GO TO 1430-CHECK-AH-TOLERANCE.
 11267
 11268 1425-CONT-WHOLE-MONTH-PMTS.
 11269******************************************************************
 11270****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 11271****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 11272****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 11273******************************************************************
 11274
 11275     IF PI-COMPANY-ID = 'ACM'
 11276        NEXT SENTENCE
 11277     ELSE
 11278        IF DC-ODD-DAYS-OVER = +0
 11279            NEXT SENTENCE
 11280        ELSE
 11281            MOVE ER-0845            TO  EMI-ERROR
 11282            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11283            GO TO 1430-CHECK-AH-TOLERANCE.
 11284
 11285     COMPUTE PI-CPYAMT ROUNDED =
 11286                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11287
 11288 1430-CHECK-AH-TOLERANCE.
 11289     IF PI-PMT-APPR-SW = 'G'
 11290         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 11291
 11292*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11293*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 11294*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 11295*
 11296*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11297*      IF WDF-MONTH = 02
 11298*        IF SAVE-ELAPSED-MONTHS = 0
 11299*          NEXT SENTENCE
 11300*        ELSE
 11301*          IF SAVE-ODD-DAYS-OVER > 0
 11302*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11303*            COMPUTE WS-PMT-MOS ROUNDED =
 11304*                (SAVE-ODD-DAYS-OVER / +30) + .005
 11305*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11306*                                     WS-PMT-MOS
 11307*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 11308*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 11309*          ELSE
 11310*            MOVE +0                     TO  WS-MAX-PMT-TOL
 11311*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 11312*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 11313*                                     WS-PMT-MOS.
 11314
 11315     IF WS-MAX-PMT-TOL NOT = ZERO
 11316        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 11317           (PI-CPYAMT > WS-MAX-PMT-TOL)
 11318            MOVE ER-0494         TO  EMI-ERROR
 11319            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 220
* EL156.cbl
 11320            GO TO 1500-EDIT-EXPENSES.
 11321
 11322 1430-CONT-CHECK-AH-TOLERANCE.
 11323
 11324     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 11325        GO TO 1500-EDIT-EXPENSES.
 11326
 11327     IF CM-O-B-COVERAGE
 11328        GO TO 1500-EDIT-EXPENSES.
 11329
 11330     IF PI-COMPANY-ID = 'NCL'
 11331       IF FOUND-TOL-SW = 'Y'
 11332         IF WS-PMT-TOL NOT = ZERO
 11333           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11334              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11335                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 11336                  IF WS-NCL-PMT-OPTION = SPACES
 11337                      MOVE ER-0699 TO EMI-ERROR
 11338                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11339                  ELSE
 11340                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 11341                      NEXT SENTENCE
 11342                  ELSE
 11343                  IF NOT WS-VALID-NCL-OPTION
 11344                      MOVE ER-0699 TO EMI-ERROR
 11345                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11346
 11347     IF WS-PMT-TOL NOT = ZERO
 11348        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 11349           ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 11350                MOVE ER-0495     TO EMI-ERROR
 11351                PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11352
 11353     GO TO 1500-EDIT-EXPENSES.
 11354
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 221
* EL156.cbl
 11356 1440-COMPUTE-LIFE-REMAINING.
 11357
 11358     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11359        IF PI-PMTTYPE = '4'
 11360          MOVE PI-EPYAMT TO PI-CPYAMT
 11361          GO TO 1460-TEST-TYPE.
 11362
 11363     IF WS-LF-COVERAGE-TYPE = 'L'
 11364        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 11365                          - CL-TOTAL-PAID-AMT
 11366        GO TO 1450-CHECK-MAX.
 11367
 11368     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11369        PI-LF-COVERAGE-TYPE = 'P'
 11370          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 11371                              CM-LF-ITD-DEATH-AMT
 11372          GO TO 1450-CHECK-MAX.
 11373
 11374     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 11375     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 11376     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 11377     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11378     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11379     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 11380     MOVE '4'                    TO CP-REM-TERM-METHOD.
 11381     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11382     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11383
 11384     PERFORM 9800-LINK-REM-TERM.
 11385
 11386     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 11387     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 11388     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 11389     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 11390     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 11391     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 11392     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 11393     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 11394     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 11395     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 11396     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 11397     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 11398     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 11399     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 11400     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 11401     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 11402
 11403
 11404* EXEC CICS LINK
 11405*       PROGRAM  (LINK-REMAMT)
 11406*       COMMAREA (CALCULATION-PASS-AREA)
 11407*       LENGTH   (CP-COMM-LENGTH)
 11408*    END-EXEC.
 11409*    MOVE '."C                   ''   #00010936' TO DFHEIV0
 11410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11412     MOVE X'2020233030303130393336' TO DFHEIV0(25:11)
 11413     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 222
* EL156.cbl
 11414           LINK-REMAMT,
 11415           CALCULATION-PASS-AREA,
 11416           CP-COMM-LENGTH,
 11417           DFHEIV99,
 11418           DFHEIV99,
 11419           DFHEIV99
 11420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11421
 11422
 11423     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 11424
 11425     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 11426     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 11427
 11428     IF PI-COMPANY-ID = 'BOA' AND
 11429        PI-PMTTYPE    = '2'   AND
 11430        PI-OFFLINE    = 'N'
 11431           GO TO 1441-COMPUTE-BOA-INTEREST.
 11432
 11433     IF PI-COMPANY-ID = 'NCL' AND
 11434        PI-PMTTYPE    = '2'   AND
 11435        PI-OFFLINE    = 'N'
 11436          GO TO 1442-COMPUTE-NCL-INTEREST
 11437       ELSE
 11438          GO TO 1445-CONTINUE.
 11439
 11440 1441-COMPUTE-BOA-INTEREST.
 11441     MOVE +0             TO WS-CALC-INT.
 11442
 11443     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 11444     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 11445     MOVE +0             TO DC-ELAPSED-MONTHS
 11446                            DC-ELAPSED-DAYS.
 11447     MOVE '1'            TO DC-OPTION-CODE.
 11448     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11449     IF NO-CONVERSION-ERROR
 11450         NEXT SENTENCE
 11451     ELSE
 11452         GO TO 1445-CONTINUE.
 11453
 11454     IF (PI-INT-RATE NOT > ZEROS)  AND
 11455        (DC-ELAPSED-DAYS > +30)
 11456         MOVE ER-3531            TO EMI-ERROR
 11457         MOVE -1                 TO PINTL
 11458         MOVE AL-UNBON           TO PINTA
 11459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11460
 11461     IF PI-EPYAMT NOT > ZEROS
 11462         GO TO 1445-CONTINUE.
 11463
 11464     IF (PI-INT-RATE NOT > ZEROS)  OR
 11465        (DC-ELAPSED-DAYS NOT > +30)
 11466         MOVE PI-EPYAMT TO PI-CPYAMT
 11467         GO TO 1441-FORMAT-NOTE.
 11468
 11469     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 11470                                 *  PI-INT-RATE
 11471                                 *  DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 223
* EL156.cbl
 11472                                 /  365
 11473                                 /  100.
 11474
 11475     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 11476
 11477 1441-FORMAT-NOTE.
 11478
 11479     MOVE SPACES        TO WS-BOANOTE1.
 11480     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 11481     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 11482     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 11483     MOVE AL-UANON      TO NOTE1A.
 11484
 11485     IF WS-CALC-INT > ZEROS
 11486         MOVE SPACES        TO WS-BOANOTE2
 11487         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 11488         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 11489         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 11490         MOVE AL-UANON      TO NOTE2A.
 11491
 11492     GO TO 1445-CONTINUE.
 11493
 11494 1442-COMPUTE-NCL-INTEREST.
 11495     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11496     MOVE PI-STATE               TO WS-ST-ACCESS.
 11497     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11498     MOVE '3'                    TO CNTL-REC-TYPE.
 11499     MOVE +0                     TO CNTL-SEQ-NO.
 11500     MOVE 'STAT'                 TO FILE-SWITCH.
 11501
 11502     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11503
 11504     MOVE +0                 TO WS-CALC-INT.
 11505
 11506     IF ST-STAT-FROM-INCURRED
 11507         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 11508       ELSE
 11509     IF ST-STAT-FROM-REPORTED
 11510         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 11511       ELSE
 11512         GO TO 1445-CONTINUE.
 11513
 11514     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 11515     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 11516     MOVE +0                 TO DC-ELAPSED-MONTHS
 11517                                DC-ELAPSED-DAYS.
 11518     MOVE '1'                TO DC-OPTION-CODE.
 11519     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11520     IF NO-CONVERSION-ERROR
 11521         NEXT SENTENCE
 11522     ELSE
 11523         GO TO 1445-CONTINUE.
 11524
 11525     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 11526        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 11527         GO TO 1445-CONTINUE.
 11528
 11529     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 224
* EL156.cbl
 11530                                 *  CF-ST-STAT-INTEREST.
 11531
 11532     MOVE SPACES              TO WS-NCLNOTE1.
 11533     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 11534     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 11535     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 11536                                 PI-PMTNOTE1
 11537                                 NOTE1I.
 11538     MOVE AL-UANON            TO NOTE1A.
 11539
 11540     IF WS-CALC-INT > ZEROS
 11541         MOVE SPACES          TO WS-NCLNOTE2
 11542         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 11543         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 11544         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 11545                                 PI-PMTNOTE2
 11546                                 NOTE2I
 11547         MOVE AL-UANON        TO NOTE2A.
 11548
 11549     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 11550
 11551 1445-CONTINUE.
 11552
 11553     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 11554        GO TO 1460-TEST-TYPE.
 11555
 11556     IF CM-O-B-COVERAGE
 11557        GO TO 1460-TEST-TYPE.
 11558
 11559     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 11560         GO TO 1450-CHECK-MAX.
 11561
 11562     IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11563                      > PI-EPYAMT)
 11564                      OR
 11565        (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 11566                      < PI-EPYAMT)
 11567         MOVE ER-0594            TO EMI-ERROR
 11568         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11569         GO TO 1460-TEST-TYPE.
 11570
 11571 1450-CHECK-MAX.
 11572
 11573     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11574        PI-LF-COVERAGE-TYPE = 'P'
 11575         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11576                                   CM-LF-ITD-DEATH-AMT
 11577     ELSE
 11578         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 11579                                   CL-TOTAL-PAID-AMT.
 11580
 11581     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 11582          MOVE ER-0543           TO EMI-ERROR
 11583          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11584
 11585 1460-TEST-TYPE.
 11586
 11587     IF PI-PMT-APPR-SW = 'G'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 225
* EL156.cbl
 11588       NEXT SENTENCE
 11589     ELSE
 11590       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 11591         IF PI-EPYAMT = ZERO
 11592             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 11593                 MOVE ER-0494    TO  EMI-ERROR
 11594                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11595                 GO TO 1500-EDIT-EXPENSES
 11596             ELSE
 11597                 NEXT SENTENCE
 11598         ELSE
 11599             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 11600                 MOVE ER-0494    TO  EMI-ERROR
 11601                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11602                 GO TO 1500-EDIT-EXPENSES.
 11603
 11604     IF PI-PMTTYPE NOT = '2' OR
 11605        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 11606         GO TO 1500-EDIT-EXPENSES.
 11607
 11608     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 11609     MOVE ER-0526                TO EMI-ERROR.
 11610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11611
 11612     IF EMI-ERROR-NUMBER (1) = '0526'
 11613        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 11614
 11615     IF EMI-ERROR-NUMBER (2) = '0526'
 11616        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 11617
 11618     GO TO 1500-EDIT-EXPENSES.
 11619
 11620 1490-PAYMENT-ERROR.
 11621     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11622
 11623     IF EMI-MESSAGE-FORMATTED
 11624         MOVE -1                 TO EPYAMTL
 11625         MOVE AL-UNBON           TO EPYAMTA.
 11626
 11627 1490-EXIT.
 11628      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 226
* EL156.cbl
 11630 1500-EDIT-EXPENSES.
 11631     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 11632         GO TO 1500-SKIP-ERROR-0556.
 11633
 11634 1500-CONTINUE-ON.
 11635
 11636     IF CM-O-B-COVERAGE
 11637        MOVE ER-0556             TO EMI-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11639
 11640 1500-SKIP-ERROR-0556.
 11641     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11642        IF PI-EEXPENS NOT = ZEROS
 11643           MOVE ER-0524          TO EMI-ERROR
 11644           GO TO 1590-EXPENSE-ERROR
 11645        ELSE
 11646           GO TO 1600-EDIT-RESERVES.
 11647
 11648     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11649     MOVE '6'                    TO CNTL-REC-TYPE.
 11650
 11651     IF CONTROL-IS-ACTUAL-CARRIER
 11652         MOVE PI-CARRIER         TO WS-CARR
 11653     ELSE
 11654         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11655
 11656     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11657     MOVE +0                     TO CNTL-SEQ-NO.
 11658     MOVE 'CARR'                 TO FILE-SWITCH.
 11659
 11660     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11661
 11662     IF EXPENSE-CALC-MANUAL
 11663        GO TO 1600-EDIT-RESERVES.
 11664
 11665     IF DOLLARS-PER-PMT
 11666        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 11667        GO TO 1600-EDIT-RESERVES.
 11668
 11669     IF DOLLARS-PER-MONTH AND
 11670        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11671       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 11672       GO TO 1600-EDIT-RESERVES.
 11673
 11674     IF PERCENT-OF-PAYMENT
 11675        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 11676
 11677     GO TO 1600-EDIT-RESERVES.
 11678
 11679 1590-EXPENSE-ERROR.
 11680     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11681
 11682     IF EMI-MESSAGE-FORMATTED
 11683        MOVE -1                  TO EEXPENSL
 11684        MOVE AL-UNBON            TO EEXPENSA.
 11685
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 227
* EL156.cbl
 11687 1600-EDIT-RESERVES.
 11688     IF PI-PMTTYPE = '4' OR '5' OR '6'
 11689        IF PI-ERESV = ZEROS
 11690           GO TO 1700-EDIT-EXPENSE-TYPE
 11691        ELSE
 11692           MOVE ER-0525          TO EMI-ERROR
 11693           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 11694           GO TO 1700-EDIT-EXPENSE-TYPE.
 11695
 11696     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11697     MOVE ZEROS                  TO TRLR-SEQ-NO.
 11698     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 11699
 11700     IF NOT AT-MANUAL-RESERVES-USED
 11701        IF PI-ERESV NOT = ZEROS
 11702           MOVE ER-0518          TO EMI-ERROR
 11703           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 11704
 11705     IF AT-MANUAL-RESERVES-USED
 11706        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 11707        GO TO 1700-EDIT-EXPENSE-TYPE.
 11708
 11709     IF AT-FUTURE-RESERVES-USED
 11710        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 11711
 11712     IF AT-FUTURE-RESERVES-USED
 11713        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 11714
 11715     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 11716        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 11717
 11718     IF AT-IBNR-RESERVES-USED
 11719        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 11720
 11721     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 11722     GO TO 1700-EDIT-EXPENSE-TYPE.
 11723
 11724 1690-RESERVE-ERROR.
 11725     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11726
 11727     IF EMI-MESSAGE-FORMATTED
 11728        MOVE AL-UNBON            TO ERESVA
 11729        MOVE -1                  TO ERESVL.
 11730
 11731 1690-EXIT.
 11732      EXIT.
 11733
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 228
* EL156.cbl
 11735 1700-EDIT-EXPENSE-TYPE.
 11736     IF PI-PMTTYPE NOT = '5' AND '6'
 11737        GO TO 2000-EDIT-DONE.
 11738
 11739     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 11740                   '6' OR '7' OR '8' OR '9'
 11741        GO TO 2000-EDIT-DONE.
 11742
 11743 1705-EXPENSE-ERROR.
 11744     MOVE ER-0573                TO EMI-ERROR.
 11745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11746
 11747     IF EMI-MESSAGE-FORMATTED
 11748        MOVE AL-UABON            TO ETYPEA
 11749        MOVE -1                  TO ETYPEL.
 11750
 11751     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 229
* EL156.cbl
 11753 1950-NOT-FOUND.
 11754     IF FILE-SWITCH = 'MSTR'
 11755        MOVE ER-0204             TO EMI-ERROR.
 11756
 11757     IF FILE-SWITCH = 'CARR'
 11758        MOVE ER-0252             TO EMI-ERROR.
 11759
 11760     IF FILE-SWITCH = 'COMP'
 11761        MOVE ER-0254             TO EMI-ERROR.
 11762
 11763     IF FILE-SWITCH = 'STAT'
 11764        MOVE ER-0149             TO EMI-ERROR.
 11765
 11766     IF FILE-SWITCH = 'PROC'
 11767        MOVE ER-0019             TO EMI-ERROR.
 11768
 11769     IF FILE-SWITCH = 'ACCT'
 11770        MOVE ER-0198             TO EMI-ERROR.
 11771
 11772     IF FILE-SWITCH = 'BENE'
 11773        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11774           MOVE ER-0282          TO EMI-ERROR
 11775        ELSE
 11776           MOVE ER-0283          TO EMI-ERROR.
 11777
 11778     MOVE -1                     TO PMTTYPEL.
 11779     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11780
 11781     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 11782                                     WS-FORCE-CTR.
 11783
 11784     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 11785                                     WS-FATAL-CTR.
 11786
 11787     GO TO 8200-SEND-DATAONLY.
 11788
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 230
* EL156.cbl
 11790 2000-EDIT-DONE.
 11791     IF (WS-SPECIAL-CALC-CD = 'C')
 11792        AND (CM-AH-CRITICAL-PERIOD) > 0
 11793        IF CM-AH-BENEFIT-AMT NOT = ZERO
 11794           IF PI-EPYAMT > ZEROS
 11795              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11796                 PI-EPYAMT) / CM-AH-BENEFIT-AMT
 11797           ELSE
 11798              COMPUTE WS-CRIT-PERIOD-DAYS = (CL-TOTAL-PAID-AMT +
 11799                 PI-CPYAMT) / CM-AH-BENEFIT-AMT
 11800           END-IF
 11801           IF WS-CRIT-PERIOD-DAYS > CM-AH-CRITICAL-PERIOD
 11802              MOVE ER-0657          TO EMI-ERROR
 11803              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804           END-IF
 11805        END-IF
 11806     END-IF
 11807     IF PI-HOLDTIL NOT = ZEROS
 11808        MOVE PI-HOLDTIL          TO HOLDTILO
 11809        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 11810
 11811     IF PI-EPYFROM NOT = ZEROS
 11812        MOVE PI-EPYFROM          TO EPYFROMO
 11813        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 11814
 11815     IF PI-EPYTHRU NOT = ZEROS
 11816        MOVE PI-EPYTHRU            TO EPYTHRUO
 11817        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 11818        IF PI-USES-PAID-TO
 11819           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 11820           MOVE '4'                TO DC-OPTION-CODE
 11821           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11822           IF NO-CONVERSION-ERROR
 11823              MOVE +1              TO DC-ELAPSED-DAYS
 11824              MOVE +0              TO DC-ELAPSED-MONTHS
 11825              MOVE '6'             TO DC-OPTION-CODE
 11826              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11827              IF NO-CONVERSION-ERROR
 11828                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 11829
 11830     MOVE PI-EDAYS               TO EDAYSO.
 11831
 11832     IF PI-AIGFROM NOT = ZEROS
 11833        MOVE PI-AIGFROM          TO AIGFROMO
 11834        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 11835
 11836     MOVE PI-EPYAMT              TO EPYAMTO.
 11837     MOVE PI-ERESV               TO ERESVO.
 11838     MOVE PI-EEXPENS             TO EEXPENSO.
 11839
 11840     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11841     MOVE SPACES                 TO DC-OPTION-CODE.
 11842     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11843
 11844     IF DATE-CONVERSION-ERROR
 11845        MOVE SPACES              TO CPYFROMI
 11846     ELSE
 11847        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 231
* EL156.cbl
 11848        IF PI-EPYFROM = ZEROS
 11849           MOVE AL-UANON             TO EPYFROMA
 11850           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 11851           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 11852
 11853     IF PI-USES-PAID-TO
 11854        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 11855        MOVE +1                            TO DC-ELAPSED-DAYS
 11856        MOVE +0                            TO DC-ELAPSED-MONTHS
 11857        MOVE '6'                           TO DC-OPTION-CODE
 11858        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11859        IF NO-CONVERSION-ERROR
 11860           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 11861           IF PI-EPYTHRU = ZEROS
 11862              MOVE AL-UANON                TO EPYTHRUA
 11863              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 11864              MOVE ' '                     TO DC-OPTION-CODE
 11865              MOVE +0                      TO DC-ELAPSED-DAYS
 11866                                              DC-ELAPSED-MONTHS
 11867              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11868              IF NO-CONVERSION-ERROR
 11869                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 11870                  GO TO 2001-CONTINUE
 11871              ELSE
 11872                  GO TO 2001-CONTINUE
 11873           ELSE
 11874              GO TO 2001-CONTINUE.
 11875
 11876     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11877     MOVE SPACES                 TO DC-OPTION-CODE.
 11878     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11879
 11880     IF DATE-CONVERSION-ERROR
 11881        MOVE SPACES              TO CPYTHRUI
 11882     ELSE
 11883        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 11884        IF PI-EPYTHRU = ZEROS
 11885           MOVE AL-UANON TO EPYTHRUA
 11886           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 11887           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 11888
 11889 2001-CONTINUE.
 11890
 11891     MOVE PI-CDAYS               TO CDAYSO.
 11892
 11893     IF PI-EDAYS = ZEROS
 11894        MOVE AL-UNNON TO EDAYSA
 11895        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 11896
 11897     MOVE PI-CPYAMT              TO CPYAMTO.
 11898
 11899     IF PI-EPYAMT = ZEROS
 11900        MOVE AL-UNNON            TO EPYAMTA
 11901        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 11902
 11903     MOVE PI-CRESV               TO CRESVO.
 11904     MOVE PI-CEXPENS             TO CEXPENSO.
 11905
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 232
* EL156.cbl
 11906     IF PI-EEXPENS = ZEROS
 11907        MOVE AL-UNNON TO EEXPENSA
 11908        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 11909
 11910     IF (PI-COMPANY-ID = 'CID')
 11911        AND (CL-CLAIM-TYPE = 'L')
 11912        AND (PI-OFFLINE NOT EQUAL 'Y')
 11913        IF PI-PMTTYPE = '2' OR '4'
 11914           PERFORM 2200-CALC-INTEREST
 11915                                 THRU 2200-EXIT
 11916        END-IF
 11917     END-IF
 11918     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 11919     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 11920     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 11921
 11922     IF EMI-FATAL-CTR = ZEROS
 11923        MOVE 'B'                 TO PI-PASS-SW.
 11924
 11925     IF NOT EMI-MESSAGE-FORMATTED
 11926         MOVE -1                 TO EPYFROML
 11927     ELSE
 11928         IF EMI-ERROR-NUMBER (1) = '0526' AND
 11929            EMI-ERROR-NUMBER (2) = SPACES
 11930             MOVE -1             TO EPYFROML.
 11931
 11932     GO TO 8200-SEND-DATAONLY.
 11933
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 233
* EL156.cbl
 11935 2200-CALC-INTEREST.
 11936     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 11937        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 11938        MOVE '4'                 TO DC-OPTION-CODE
 11939        PERFORM 9700-LINK-DATE-CONVERT
 11940        IF DATE-CONVERSION-ERROR
 11941            MOVE LOW-VALUES      TO CP-PRF-DT
 11942        ELSE
 11943           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 11944        END-IF
 11945     END-IF
 11946     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 11947        IN CLAIM-INT-PASS-AREA
 11948     MOVE CL-CERT-STATE          TO CP-STATE
 11949        IN CLAIM-INT-PASS-AREA
 11950     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 11951     MOVE 'LF'                   TO CP-COVERAGE
 11952     MOVE CL-INCURRED-DT         TO CP-INC-DT
 11953     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 11954     MOVE LOW-VALUES             TO CP-LSTPD-DT
 11955     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 11956     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 11957     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 11958
 11959* EXEC CICS LINK
 11960*       PROGRAM   ('ELCLMI')
 11961*       COMMAREA  (CLAIM-INT-PASS-AREA)
 11962*       LENGTH    (CP-CLAIM-LENGTH)
 11963*    END-EXEC
 11964     MOVE 'ELCLMI' TO DFHEIV1
 11965*    MOVE '."C                   ''   #00011477' TO DFHEIV0
 11966     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11967     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11968     MOVE X'2020233030303131343737' TO DFHEIV0(25:11)
 11969     CALL 'kxdfhei1' USING DFHEIV0,
 11970           DFHEIV1,
 11971           CLAIM-INT-PASS-AREA,
 11972           CP-CLAIM-LENGTH,
 11973           DFHEIV99,
 11974           DFHEIV99,
 11975           DFHEIV99
 11976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11977     MOVE AL-PANOF               TO PINTHA
 11978                                    PINTA
 11979     IF NO-CI-ERROR
 11980        MOVE CP-CLM-INT-AMT      TO PINTO
 11981                                    PI-INT-AMT
 11982        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 11983        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 11984        MOVE AL-PANOF            TO PINTHA
 11985                                    PINTA
 11986     ELSE
 11987        IF CI-RETURN-CODE = '8'
 11988           MOVE ER-3818          TO EMI-ERROR
 11989           MOVE -1               TO ZINTL
 11990           PERFORM 9900-ERROR-FORMAT
 11991                                 THRU 9900-EXIT
 11992           GO TO 2200-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 234
* EL156.cbl
 11993        ELSE
 11994           MOVE ZEROS            TO PINTO
 11995                                    PI-INT-AMT
 11996                                    PI-INT-DAYS
 11997                                    PI-INT-RATE-USED
 11998        END-IF
 11999     END-IF
 12000     IF PI-INT-AMT NOT = ZEROS
 12001        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12002           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12003           CONTINUE
 12004        ELSE
 12005           MOVE CL-SOC-SEC-NO (1:3)
 12006                                 TO WS-SSN (1:3)
 12007           MOVE CL-SOC-SEC-NO (5:2)
 12008                                 TO WS-SSN (4:2)
 12009           MOVE CL-SOC-SEC-NO (8:4)
 12010                                 TO WS-SSN (6:4)
 12011           IF (WS-SSN NUMERIC)
 12012              AND (WS-SSN NOT = ZEROS)
 12013              CONTINUE
 12014           ELSE
 12015              MOVE ER-2044       TO EMI-ERROR
 12016              PERFORM 9900-ERROR-FORMAT
 12017                                 THRU 9900-EXIT
 12018           END-IF
 12019        END-IF
 12020        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12021        MOVE +51                 TO TRLR-SEQ-NO
 12022
 12023* EXEC CICS READ
 12024*          DATASET  ('ELTRLR')
 12025*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12026*          RIDFLD   (ELTRLR-KEY)
 12027*          RESP     (WS-RESPONSE)
 12028*       END-EXEC
 12029     MOVE 'ELTRLR' TO DFHEIV1
 12030*    MOVE '&"S        E          (  N#00011527' TO DFHEIV0
 12031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12033     MOVE X'204E233030303131353237' TO DFHEIV0(25:11)
 12034     CALL 'kxdfhei1' USING DFHEIV0,
 12035           DFHEIV1,
 12036           DFHEIV20,
 12037           DFHEIV99,
 12038           ELTRLR-KEY,
 12039           DFHEIV99,
 12040           DFHEIV99,
 12041           DFHEIV99
 12042     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12043         DFHEIV20
 12044     MOVE EIBRESP  TO WS-RESPONSE
 12045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12046        IF (NOT WS-RESP-NORMAL)
 12047                    OR
 12048           ((WS-RESP-NORMAL)
 12049           AND ((AT-ADDRESS-LINE-1 = SPACES)
 12050           OR (AT-CITY-STATE = SPACES)))
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 235
* EL156.cbl
 12051           MOVE ER-0874          TO EMI-ERROR
 12052           PERFORM 9900-ERROR-FORMAT
 12053                                 THRU 9900-EXIT
 12054        END-IF
 12055     END-IF
 12056     .
 12057 2200-EXIT.
 12058     EXIT.
 12059 3000-MOVE-INPUT-TO-SAVE-AREA.
 12060     IF PMTTYPEL > 0
 12061         MOVE PMTTYPEI           TO WS-PMTTYPE.
 12062
 12063     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 12064
 12065     IF WS-PMTTYPE = '9'
 12066         MOVE 'P'                TO PI-PROVISIONAL-IND
 12067         MOVE '1'                TO WS-PMTTYPE.
 12068
 12069     IF PAYEEL > 0
 12070         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 12071         MOVE PAYEEI             TO WS-PAYEE.
 12072
 12073     IF NOTE1L > +0
 12074         MOVE NOTE1I             TO WS-PMTNOTE1
 12075                                    WS-FLI-PMTNOTE
 12076                                    WS-HAN-PMTNOTE.
 12077
 12078     IF NOTE2L > +0
 12079         MOVE NOTE2I             TO WS-PMTNOTE2.
 12080
 12081     IF OFFLINEL > 0
 12082         MOVE OFFLINEI           TO WS-OFFLINE.
 12083
 12084     IF PROOFDTL > 0
 12085         MOVE PROOFDTI            TO DATE-WORK
 12086         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12087         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 12088         MOVE '4'                 TO DC-OPTION-CODE
 12089         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 12090         IF NO-CONVERSION-ERROR
 12091            MOVE NUM-WORK         TO PROOFDTO
 12092            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 12093            MOVE NUM-WORK         TO WS-PROOF-DATE
 12094         ELSE
 12095            MOVE ZEROS            TO WS-PROOF-DATE
 12096         END-IF
 12097     END-IF.
 12098
 12099     IF EOBYNL > +0
 12100        MOVE EOBYNI              TO WS-PRINT-EOB-YN
 12101     END-IF
 12102     IF GROUPEDL > +0
 12103         MOVE GROUPEDI           TO WS-GROUPED.
 12104
 12105     IF CASHL > +0
 12106        MOVE CASHI               TO WS-CASH.
 12107
 12108     IF LOANNOL > +0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 236
* EL156.cbl
 12109         MOVE LOANNOI            TO WS-LOAN-NO.
 12110
 12111     IF CHECKNOL > 0
 12112         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 12113
 12114     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12115         IF WS-AIG-CREDIT-ENTERED
 12116             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 12117             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 12118             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 12119             MOVE AL-UANON         TO CHECKNOA.
 12120
 12121     IF HOLDTILL > 0
 12122         MOVE HOLDTILI           TO DATE-WORK
 12123         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12124         MOVE NUM-WORK           TO WS-HOLDTIL.
 12125
 12126     IF ZINTL > +0
 12127
 12128* EXEC CICS BIF DEEDIT
 12129*           FIELD   (ZINTI)
 12130*           LENGTH  (07)
 12131*       END-EXEC
 12132     MOVE 07
 12133       TO DFHEIV11
 12134*    MOVE '@"L                   #   #00011614' TO DFHEIV0
 12135     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12137     MOVE X'2020233030303131363134' TO DFHEIV0(25:11)
 12138     CALL 'kxdfhei1' USING DFHEIV0,
 12139           ZINTI,
 12140           DFHEIV11
 12141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12142        IF ZINTI NOT NUMERIC
 12143           MOVE ER-0419          TO EMI-ERROR
 12144           PERFORM 9900-ERROR-FORMAT
 12145           MOVE AL-UABON         TO ZINTA
 12146           MOVE -1               TO ZINTL
 12147        ELSE
 12148           MOVE ZINTI            TO CP-INT-RATE
 12149                                    WS-INT-RATE
 12150           MOVE CP-INT-RATE      TO ZINTO
 12151           MOVE AL-UNNON         TO ZINTA
 12152        END-IF
 12153     ELSE
 12154        MOVE ZEROS               TO CP-INT-RATE
 12155     END-IF
 12156     IF EPYFROML > 0
 12157         MOVE EPYFROMI           TO DATE-WORK
 12158         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12159         MOVE NUM-WORK           TO WS-EPYFROM.
 12160
 12161     IF AIGFROML > 0
 12162         MOVE AIGFROMI           TO DATE-WORK
 12163         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12164         MOVE NUM-WORK           TO WS-AIGFROM
 12165     ELSE
 12166         IF (AIGFROMI = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 237
* EL156.cbl
 12167            (PI-AIGFROM NOT = ZEROS)
 12168              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 12169
 12170     IF EPYTHRUL > +0
 12171        MOVE EPYTHRUI           TO DATE-WORK
 12172        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 12173        MOVE NUM-WORK           TO WS-EPYTHRU
 12174        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12175        MOVE '4'                TO DC-OPTION-CODE
 12176        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12177        IF NO-CONVERSION-ERROR
 12178           IF PI-USES-PAID-TO
 12179              MOVE '6'                TO DC-OPTION-CODE
 12180              MOVE -1                 TO DC-ELAPSED-DAYS
 12181              MOVE +0                 TO DC-ELAPSED-MONTHS
 12182              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12183              IF NO-CONVERSION-ERROR
 12184                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 12185                 MOVE ' '             TO DC-OPTION-CODE
 12186                 MOVE +0              TO DC-ELAPSED-DAYS
 12187                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12188              IF NO-CONVERSION-ERROR
 12189                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 12190
 12191*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12192*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12193     IF EDAYSL > 0
 12194
 12195* EXEC CICS BIF DEEDIT
 12196*            FIELD(EDAYSI)
 12197*            LENGTH(6)
 12198*        END-EXEC
 12199     MOVE 6
 12200       TO DFHEIV11
 12201*    MOVE '@"L                   #   #00011670' TO DFHEIV0
 12202     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12203     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12204     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 12205     CALL 'kxdfhei1' USING DFHEIV0,
 12206           EDAYSI,
 12207           DFHEIV11
 12208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12209         MOVE EDAYSI             TO WS-DY-WORK
 12210         IF WS-DY-SIGN = SPACES
 12211            MOVE WS-DY-NUM       TO WS-EDAYS
 12212            ADD 0                TO WS-EDAYS
 12213         ELSE
 12214            MOVE EDAYSI          TO WS-EDAYS
 12215            ADD 0                TO WS-EDAYS.
 12216
 12217*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 12218*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 12219     IF EPYAMTL > 0
 12220
 12221* EXEC CICS BIF DEEDIT
 12222*            FIELD(EPYAMTI)
 12223*            LENGTH(10)
 12224*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 238
* EL156.cbl
 12225     MOVE 10
 12226       TO DFHEIV11
 12227*    MOVE '@"L                   #   #00011685' TO DFHEIV0
 12228     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12229     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12230     MOVE X'2020233030303131363835' TO DFHEIV0(25:11)
 12231     CALL 'kxdfhei1' USING DFHEIV0,
 12232           EPYAMTI,
 12233           DFHEIV11
 12234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12235         MOVE EPYAMTI            TO WS-PY-WORK
 12236         IF WS-PY-SIGN = SPACES
 12237            MOVE WS-PY-NUM       TO WS-EPYAMT
 12238            ADD 0                TO WS-EPYAMT
 12239         ELSE
 12240            MOVE EPYAMTI         TO WS-EPYAMT
 12241            ADD 0                TO WS-EPYAMT.
 12242
 12243     IF ERESVL > 0
 12244
 12245* EXEC CICS BIF DEEDIT
 12246*            FIELD(ERESVI)
 12247*            LENGTH(9)
 12248*        END-EXEC
 12249     MOVE 9
 12250       TO DFHEIV11
 12251*    MOVE '@"L                   #   #00011698' TO DFHEIV0
 12252     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12253     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12254     MOVE X'2020233030303131363938' TO DFHEIV0(25:11)
 12255     CALL 'kxdfhei1' USING DFHEIV0,
 12256           ERESVI,
 12257           DFHEIV11
 12258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12259         MOVE ERESVI TO WS-ERESV.
 12260
 12261     IF EEXPENSL > 0
 12262
 12263* EXEC CICS BIF DEEDIT
 12264*            FIELD(EEXPENSI)
 12265*            LENGTH(8)
 12266*        END-EXEC
 12267     MOVE 8
 12268       TO DFHEIV11
 12269*    MOVE '@"L                   #   #00011705' TO DFHEIV0
 12270     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12271     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12272     MOVE X'2020233030303131373035' TO DFHEIV0(25:11)
 12273     CALL 'kxdfhei1' USING DFHEIV0,
 12274           EEXPENSI,
 12275           DFHEIV11
 12276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12277         MOVE EEXPENSI           TO WS-EEXPENS.
 12278
 12279     IF ETYPEL > ZEROS
 12280         MOVE ETYPEI             TO WS-ETYPE.
 12281
 12282     IF PI-COMPANY-ID = 'BOA'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 239
* EL156.cbl
 12283        IF PINTL > ZEROS
 12284
 12285* EXEC CICS BIF DEEDIT
 12286*            FIELD (PINTI)
 12287*            LENGTH(05)
 12288*          END-EXEC
 12289     MOVE 05
 12290       TO DFHEIV11
 12291*    MOVE '@"L                   #   #00011716' TO DFHEIV0
 12292     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12293     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12294     MOVE X'2020233030303131373136' TO DFHEIV0(25:11)
 12295     CALL 'kxdfhei1' USING DFHEIV0,
 12296           PINTI,
 12297           DFHEIV11
 12298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12299           IF PINTI NUMERIC
 12300               MOVE AL-UNNON     TO PINTA
 12301               MOVE PINTI        TO WS-INT-RATE
 12302               MOVE WS-INT-RATE  TO PINTO.
 12303
 12304 3000-EXIT.
 12305     EXIT.
 12306
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 240
* EL156.cbl
 12308 3050-REBUILD-ENTERED.
 12309
 12310     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 12311
 12312     IF PI-PROV-PMT
 12313         MOVE '9'           TO PMTTYPEO
 12314     ELSE
 12315         MOVE PI-PMTTYPE    TO PMTTYPEO.
 12316
 12317     MOVE PI-PAYEE          TO PAYEEO.
 12318     MOVE PI-PMTNOTE1       TO NOTE1O.
 12319     MOVE PI-PMTNOTE2       TO NOTE2O.
 12320     MOVE PI-OFFLINE        TO OFFLINEO.
 12321     IF PI-PROOF-DATE NOT = ZEROS
 12322         MOVE PI-PROOF-DATE TO PROOFDTO
 12323         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 12324     END-IF.
 12325     MOVE PI-GROUPED        TO GROUPEDO.
 12326
 12327     MOVE PI-CASH           TO CASHO.
 12328
 12329     IF PI-INT-RATE > ZEROS
 12330         MOVE PI-INT-RATE   TO PINTO.
 12331
 12332     IF PI-COMPANY-ID = 'CID'
 12333        IF PI-INT-AMT > ZEROS
 12334           MOVE PI-INT-AMT       TO PINTO
 12335           MOVE AL-PANOF         TO PINTA
 12336                                    PINTHA
 12337        END-IF
 12338     END-IF
 12339     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 12340     IF PI-HOLDTIL NOT = ZEROS
 12341        MOVE PI-HOLDTIL          TO HOLDTILO
 12342        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12343
 12344     IF PI-EPYFROM NOT = ZEROS
 12345        MOVE PI-EPYFROM          TO EPYFROMO
 12346        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 12347
 12348     IF PI-AIGFROM NOT = ZEROS
 12349        MOVE PI-AIGFROM          TO AIGFROMO
 12350        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12351
 12352     IF PI-EPYTHRU NOT = ZEROS
 12353        MOVE PI-EPYTHRU          TO EPYTHRUO
 12354        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 12355        IF PI-USES-PAID-TO
 12356           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12357           MOVE '4'                TO DC-OPTION-CODE
 12358           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12359           IF NO-CONVERSION-ERROR
 12360              MOVE +1 TO DC-ELAPSED-DAYS
 12361              MOVE +0 TO DC-ELAPSED-MONTHS
 12362              MOVE '6' TO DC-OPTION-CODE
 12363              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12364              IF NO-CONVERSION-ERROR
 12365                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 241
* EL156.cbl
 12366
 12367     IF PI-EDAYS NOT = ZEROS
 12368        MOVE PI-EDAYS TO EDAYSO.
 12369
 12370     IF PI-EPYAMT NOT = ZEROS
 12371        MOVE PI-EPYAMT TO EPYAMTO.
 12372
 12373     IF PI-ERESV NOT = ZEROS
 12374        MOVE PI-ERESV TO ERESVO.
 12375
 12376     IF PI-EEXPENS NOT = ZEROS
 12377        MOVE PI-EEXPENS TO EEXPENSO.
 12378
 12379     MOVE PI-ETYPE TO ETYPEO.
 12380
 12381     IF PI-ECHECKNO NOT = SPACES
 12382        MOVE PI-ECHECKNO         TO CHECKNOO
 12383     ELSE
 12384        MOVE PI-CCHECKNO         TO CHECKNOO.
 12385
 12386     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12387     MOVE SPACES                 TO DC-OPTION-CODE.
 12388     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12389
 12390     IF DATE-CONVERSION-ERROR
 12391        MOVE SPACES              TO CPYFROMI
 12392     ELSE
 12393        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 12394
 12395     IF PI-USES-PAID-TO
 12396        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12397        MOVE +1                  TO DC-ELAPSED-DAYS
 12398        MOVE +0                  TO DC-ELAPSED-MONTHS
 12399        MOVE '6'                 TO DC-OPTION-CODE
 12400        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12401        IF NO-CONVERSION-ERROR
 12402           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12403           GO TO 3051-CONTINUE.
 12404
 12405     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12406     MOVE SPACES                 TO DC-OPTION-CODE.
 12407     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12408
 12409     IF DATE-CONVERSION-ERROR
 12410        MOVE SPACES              TO CPYTHRUI
 12411     ELSE
 12412        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 12413
 12414 3051-CONTINUE.
 12415
 12416     IF PI-CDAYS NOT = ZEROS
 12417        MOVE PI-CDAYS TO CDAYSO.
 12418
 12419     IF PI-CPYAMT NOT = ZEROS
 12420        MOVE PI-CPYAMT TO CPYAMTO.
 12421
 12422     IF PI-CRESV NOT = ZEROS
 12423        MOVE PI-CRESV TO CRESVO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 242
* EL156.cbl
 12424
 12425     IF PI-CEXPENS NOT = ZEROS
 12426        MOVE PI-CEXPENS TO CEXPENSO.
 12427
 12428 3059-EXIT.
 12429     EXIT.
 12430
 12431 3100-DEEDIT-DATE.
 12432
 12433* EXEC CICS BIF DEEDIT
 12434*        FIELD(DATE-WORK)
 12435*        LENGTH(8)
 12436*    END-EXEC.
 12437     MOVE 8
 12438       TO DFHEIV11
 12439*    MOVE '@"L                   #   #00011853' TO DFHEIV0
 12440     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12441     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12442     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 12443     CALL 'kxdfhei1' USING DFHEIV0,
 12444           DATE-WORK,
 12445           DFHEIV11
 12446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12447
 12448
 12449 3100-EXIT.
 12450     EXIT.
 12451
 12452 3200-CALC-AIG-DAYS.
 12453
 12454     MOVE 'N'                    TO WS-DUE-DAY-SW.
 12455
 12456     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 12457     MOVE ' '                    TO DC-OPTION-CODE.
 12458     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12459     IF NO-CONVERSION-ERROR
 12460         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 12461     ELSE
 12462         GO TO 3290-ERROR.
 12463
 12464     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12465         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12466                                WS-BIN-FROM-DT
 12467     ELSE
 12468         IF CL-TOTAL-PAID-AMT > ZEROS
 12469             IF WS-SV-EPYFROM = LOW-VALUES
 12470                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12471                                        WS-BIN-FROM-DT
 12472             ELSE
 12473                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12474                                        WS-BIN-FROM-DT
 12475         ELSE
 12476             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 12477                                        WS-BIN-FROM-DT.
 12478
 12479 3210-CONTINUE.
 12480
 12481     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 243
* EL156.cbl
 12482     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12483     IF DATE-CONVERSION-ERROR
 12484         GO TO 3290-ERROR.
 12485
 12486     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 12487
 12488     IF PI-LOAN-DUE-DAY = 31
 12489         MOVE 30              TO WS-PMT-DUE-DA
 12490                                 WS-SAVE-DUE-DA
 12491     ELSE
 12492         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 12493                                 WS-SAVE-DUE-DA.
 12494
 12495     IF (PI-LOAN-DUE-DAY > 28) AND
 12496        (WS-PMT-DUE-MO = 2)
 12497         MOVE 'Y'                TO WS-DUE-DAY-SW
 12498         MOVE 28                 TO WS-PMT-DUE-DA.
 12499
 12500     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 12501     MOVE '4'                    TO DC-OPTION-CODE.
 12502     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12503     IF NO-CONVERSION-ERROR
 12504         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 12505     ELSE
 12506         GO TO 3290-ERROR.
 12507
 12508*--------------------------------------------------------------*
 12509*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 12510*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 12511*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 12512*                                                              *
 12513*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 12514*             INCURRED DATE      - 04/15/91                    *
 12515*             PMT DUE DATE       - 04/03/91                    *
 12516*             PMT DUE DATE       - 05/03/91                    *
 12517*--------------------------------------------------------------*
 12518
 12519     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12520        (WS-SV-AIGFROM = LOW-VALUES)
 12521         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 12522            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 12523             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12524             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12525             IF NO-CONVERSION-ERROR
 12526                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12527                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12528             ELSE
 12529                 GO TO 3290-ERROR.
 12530
 12531     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 12532        (WS-SV-AIGFROM = LOW-VALUES)
 12533         GO TO 3205-CONT-CALC-PMT.
 12534
 12535     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 12536     MOVE ' '                    TO DC-OPTION-CODE.
 12537     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12538     IF NO-CONVERSION-ERROR
 12539         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 244
* EL156.cbl
 12540     ELSE
 12541         GO TO 3290-ERROR.
 12542
 12543     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 12544        (WS-PMT-DUE-DA < WS-FROM-DA)
 12545          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 12546          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 12547          IF NO-CONVERSION-ERROR
 12548              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12549              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12550          ELSE
 12551              GO TO 3290-ERROR.
 12552
 12553 3205-CONT-CALC-PMT.
 12554
 12555*--------------------------------------------------------------*
 12556*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 12557*    BETWEEN THE PAY FROM / THRU DATES.                        *
 12558*--------------------------------------------------------------*
 12559
 12560     IF CL-TOTAL-PAID-AMT = ZEROS AND
 12561        PI-PMTTYPE = '2'
 12562          NEXT SENTENCE
 12563     ELSE
 12564        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 12565           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 12566             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 12567             MOVE ER-3527            TO EMI-ERROR
 12568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12569             MOVE -1                 TO EPYTHRUL
 12570             MOVE AL-UNBON           TO EPYTHRUA
 12571                                        EPYFROMA
 12572             GO TO 3299-EXIT.
 12573
 12574*--------------------------------------------------------------*
 12575*    CALCULATE RETRO ELIMINATION DATE                          *
 12576*--------------------------------------------------------------*
 12577
 12578     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12579         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12580     ELSE
 12581         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12582
 12583     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 12584     MOVE +0             TO DC-ELAPSED-MONTHS.
 12585     MOVE '6'            TO DC-OPTION-CODE.
 12586     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12587     IF NO-CONVERSION-ERROR
 12588         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 12589     ELSE
 12590         GO TO 3290-ERROR.
 12591
 12592 3210-CHECK-PMT-DATE.
 12593
 12594*--------------------------------------------------------------*
 12595*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 12596*    THE ENTERED PAY FROM DATE                                 *
 12597*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 245
* EL156.cbl
 12598
 12599     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 12600         NEXT SENTENCE
 12601     ELSE
 12602         GO TO 3220-COMPUTE-DAYS.
 12603
 12604     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 12605     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12606     IF NO-CONVERSION-ERROR
 12607         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 12608         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12609         GO TO 3210-CHECK-PMT-DATE
 12610     ELSE
 12611         GO TO 3290-ERROR.
 12612
 12613 3220-COMPUTE-DAYS.
 12614
 12615     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 12616     MOVE ZEROS         TO WS-CDAYS.
 12617     MOVE 'N'           TO WS-ELIMINATION-SW.
 12618
 12619*--------------------------------------------------------------*
 12620*    COMPUTE CALIFORNIA DUE DAYS                               *
 12621*--------------------------------------------------------------*
 12622
 12623     IF CL-TOTAL-PAID-AMT > ZEROS
 12624         MOVE 'Y' TO WS-ELIMINATION-SW
 12625         GO TO 3240-FIRST-PMT-DUE
 12626     ELSE
 12627        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 12628            NEXT SENTENCE
 12629        ELSE
 12630            GO TO 3240-FIRST-PMT-DUE.
 12631
 12632 3230-NEXT-PMT-DUE.
 12633
 12634     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 12635     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 12636     IF NO-CONVERSION-ERROR
 12637         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 12638         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12639     ELSE
 12640         GO TO 3290-ERROR.
 12641
 12642 3240-FIRST-PMT-DUE.
 12643
 12644     IF CL-TOTAL-PAID-AMT > ZEROS
 12645         NEXT SENTENCE
 12646     ELSE
 12647        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 12648            GO TO 3230-NEXT-PMT-DUE.
 12649
 12650     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 12651         GO TO 3250-VERIFY-ELIMINATION.
 12652
 12653     ADD +30 TO WS-CDAYS.
 12654     MOVE 'Y' TO WS-ELIMINATION-SW.
 12655     GO TO 3230-NEXT-PMT-DUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 246
* EL156.cbl
 12656
 12657 3250-VERIFY-ELIMINATION.
 12658
 12659     IF ELIM-SATISFIED
 12660         GO TO 3260-END-CALC.
 12661
 12662     IF PI-PMTTYPE = '1'
 12663         MOVE ZEROS TO WS-CDAYS
 12664         GO TO 3260-END-CALC.
 12665
 12666     IF WS-SV-AIGFROM NOT = LOW-VALUES
 12667         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 12668     ELSE
 12669         IF CL-TOTAL-PAID-AMT > ZEROS
 12670             IF WS-SV-EPYFROM = LOW-VALUES
 12671                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 12672             ELSE
 12673                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 12674         ELSE
 12675             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 12676
 12677     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 12678     MOVE '1'                    TO DC-OPTION-CODE.
 12679     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12680     IF NO-CONVERSION-ERROR
 12681         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 12682     ELSE
 12683         GO TO 3290-ERROR.
 12684
 12685     IF CL-TOTAL-PAID-AMT > ZEROS
 12686         MOVE WS-DAYS-OFF TO WS-CDAYS
 12687     ELSE
 12688         IF PI-BEN-DAYS > WS-DAYS-OFF
 12689             MOVE ZEROS TO WS-CDAYS
 12690         ELSE
 12691             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 12692
 12693 3260-END-CALC.
 12694
 12695     MOVE WS-CDAYS TO PI-CDAYS.
 12696
 12697     IF PI-EDAYS = ZEROS
 12698         MOVE PI-CDAYS TO PI-EDAYS
 12699         MOVE AL-UNNON TO EDAYSA.
 12700
 12701     GO TO 3299-EXIT.
 12702
 12703 3290-ERROR.
 12704
 12705     MOVE ER-3528            TO EMI-ERROR.
 12706     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12707     MOVE -1                 TO CDAYSL.
 12708     MOVE AL-UNBON           TO CDAYSA.
 12709
 12710 3299-EXIT.
 12711     EXIT.
 12712
 12713 3300-BUMP-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 247
* EL156.cbl
 12714
 12715     IF WS-RESTORE-DUE-DAY
 12716         MOVE 'N'              TO WS-DUE-DAY-SW
 12717         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 12718         ADD 1                 TO WS-PMT-DUE-MO
 12719         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 12720         MOVE '4'              TO DC-OPTION-CODE
 12721         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12722         IF NO-CONVERSION-ERROR
 12723             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 12724             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 12725             GO TO 3399-EXIT
 12726         ELSE
 12727             MOVE '9'          TO DC-ERROR-CODE
 12728             GO TO 3399-EXIT.
 12729
 12730     IF (WS-PMT-DUE-MO = 1) AND
 12731        (WS-SAVE-DUE-DA > 28)
 12732           MOVE 'Y' TO WS-DUE-DAY-SW.
 12733
 12734     MOVE +0                 TO DC-ELAPSED-DAYS.
 12735     MOVE +1                 TO DC-ELAPSED-MONTHS.
 12736     MOVE '6'                TO DC-OPTION-CODE.
 12737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12738
 12739 3399-EXIT.
 12740     EXIT.
 12741
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 248
* EL156.cbl
 12743 3400-COMPUTE-EXPIRY.
 12744
 12745     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 12746     MOVE +0                    TO DC-ELAPSED-DAYS
 12747                                   DC-ODD-DAYS-OVER.
 12748     MOVE '1'                   TO DC-END-OF-MONTH.
 12749     MOVE '6'                   TO DC-OPTION-CODE.
 12750
 12751     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12752         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 12753     ELSE
 12754         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 12755
 12756     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12757     IF NO-CONVERSION-ERROR
 12758         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 12759     ELSE
 12760         GO TO 3390-CONTINUE.
 12761
 12762     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 12763         GO TO 3390-CONTINUE.
 12764
 12765     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12766     MOVE '4'                    TO CNTL-REC-TYPE.
 12767     MOVE +0                     TO CNTL-SEQ-NO.
 12768     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 12769     MOVE WS-ACCESS              TO CNTL-ACCESS.
 12770     MOVE 'BENE'                 TO FILE-SWITCH.
 12771
 12772     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 12773
 12774     IF NO-BENEFIT-FOUND
 12775         GO TO 3390-CONTINUE.
 12776
 12777     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC'
 12778        IF (PI-OFFLINE = 'Y') OR
 12779           (PI-PMTTYPE = '7')
 12780           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 12781                                     THRU 9870-EXIT
 12782           IF ERROR-ON-OUTPUT
 12783             MOVE -1                 TO ENTERPFL
 12784             MOVE AL-UANON           TO ENTERPFA
 12785             MOVE MAP-NAMEA          TO MAP-NAME
 12786             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12787             GO TO 8200-SEND-DATAONLY.
 12788
 12789     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 12790        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 12791        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 12792          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 12793          MOVE +0        TO DC-ELAPSED-DAYS
 12794          MOVE +1        TO DC-ELAPSED-MONTHS
 12795          MOVE 6         TO DC-OPTION-CODE
 12796          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12797          IF NO-CONVERSION-ERROR
 12798              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 12799
 12800 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 249
* EL156.cbl
 12801
 12802      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12803         MOVE CM-AH-LOAN-EXPIRE-DT
 12804                                 TO DC-BIN-DATE-1
 12805      ELSE
 12806         MOVE CM-LF-LOAN-EXPIRE-DT
 12807                                 TO DC-BIN-DATE-1
 12808      END-IF
 12809
 12810      MOVE ' '                    TO DC-OPTION-CODE.
 12811      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12812      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 12813      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 12814
 12815 3499-EXIT.
 12816     EXIT.
 12817
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 250
* EL156.cbl
 12819
 12820 3600-CHECK-VERIFICATION.
 12821
 12822     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12823
 12824     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 12825
 12826     IF PI-PAYEE-TYPE = 'I'
 12827        GO TO 3600-READ-TRAILER.
 12828
 12829     IF PI-PAYEE-TYPE = 'B'
 12830        ADD +10                  TO TRLR-SEQ-NO
 12831        GO TO 3600-READ-TRAILER.
 12832
 12833     IF PI-PAYEE-TYPE = 'A'
 12834        ADD +20                  TO TRLR-SEQ-NO
 12835        GO TO 3600-READ-TRAILER.
 12836
 12837     IF PI-PAYEE-TYPE = 'O'
 12838        ADD +50                  TO TRLR-SEQ-NO
 12839        GO TO 3600-READ-TRAILER.
 12840
 12841     IF PI-PAYEE-TYPE = 'Q'
 12842        ADD +60                  TO TRLR-SEQ-NO
 12843        GO TO 3600-READ-TRAILER.
 12844
 12845     IF PI-PAYEE-TYPE = 'P'
 12846        ADD +30                  TO TRLR-SEQ-NO
 12847        GO TO 3600-READ-TRAILER.
 12848
 12849     IF PI-PAYEE-TYPE = 'E'
 12850        ADD +40                  TO TRLR-SEQ-NO.
 12851
 12852 3600-READ-TRAILER.
 12853
 12854
 12855* EXEC CICS HANDLE CONDITION
 12856*         NOTFND(3600-CONTINUE)
 12857*    END-EXEC.
 12858*    MOVE '"$I                   ! - #00012263' TO DFHEIV0
 12859     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12861     MOVE X'2D20233030303132323633' TO DFHEIV0(25:11)
 12862     CALL 'kxdfhei1' USING DFHEIV0
 12863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12864
 12865
 12866     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12867
 12868 3600-CONTINUE.
 12869
 12870     IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 12871       IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 12872         MOVE ER-7576            TO EMI-ERROR
 12873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874         MOVE -1                 TO PAYEEL
 12875         MOVE AL-UABON           TO PAYEEA
 12876       END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 251
* EL156.cbl
 12877     END-IF.
 12878
 12879 3600-EXIT.
 12880     EXIT.
 12881
 12882 5000-UPDATE.
 12883
 12884     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 12885
 12886     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 12887
 12888     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 12889        PI-OFFLINE = 'Y'
 12890        NEXT SENTENCE
 12891     ELSE
 12892        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 12893
 12894*    IF PI-COMPANY-ID = 'CRI'
 12895*       IF PI-PMTTYPE = '1' OR  '2'
 12896*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12897*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 12898*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 12899
 12900*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 12901*       IF PI-PMTTYPE = '1'
 12902*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12903*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 12904
 12905     IF PI-PMTTYPE      = '2' AND
 12906        PI-SPLIT-PMT-SW = 'Y' AND
 12907        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 12908          MOVE ER-3530                TO EMI-ERROR
 12909          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12910
 12911     IF (PI-COMPANY-ID = 'CID')
 12912        AND (CL-CLAIM-TYPE = 'L')
 12913        IF PI-PMTTYPE = '2' OR '4'
 12914           IF PI-INT-AMT NOT = ZEROS
 12915              PERFORM 7110-BUILD-PMT-TRLR
 12916                                 THRU 7130-EXIT
 12917           ELSE
 12918              IF PI-PMTTYPE = '2'
 12919                 PERFORM 7140-BUILD-NOTE-TRLR
 12920                                 THRU 7170-EXIT
 12921              END-IF
 12922           END-IF
 12923        END-IF
 12924     END-IF
 12925*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12926*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12927*            MOVE 'N'                 TO  WS-LETTER-SW.
 12928
 12929*    IF PI-COMPANY-ID = 'DMD'
 12930*        IF CL-NO-OF-PMTS-MADE = +1
 12931*                OR
 12932*           PI-PMTTYPE = '2'
 12933*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 12934
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 252
* EL156.cbl
 12935     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 12936
 12937*    IF PI-COMPANY-ID = 'DMD'
 12938*       IF CL-CERT-NO (5:2) = '69' OR '70'
 12939*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 12940
 12941
 12942* EXEC CICS REWRITE
 12943*         DATASET('ELMSTR')
 12944*         FROM(CLAIM-MASTER)
 12945*     END-EXEC.
 12946     MOVE LENGTH OF
 12947      CLAIM-MASTER
 12948       TO DFHEIV11
 12949     MOVE 'ELMSTR' TO DFHEIV1
 12950*    MOVE '&& L                  %   #00012342' TO DFHEIV0
 12951     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12952     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12953     MOVE X'2020233030303132333432' TO DFHEIV0(25:11)
 12954     CALL 'kxdfhei1' USING DFHEIV0,
 12955           DFHEIV1,
 12956           CLAIM-MASTER,
 12957           DFHEIV11,
 12958           DFHEIV99
 12959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12960
 12961
 12962     IF WS-LETTER-SW = 'N'
 12963         GO TO 5000-END-UPDATE.
 12964
 12965 5000-GENERATE-AUTO-LETTER.
 12966
 12967
 12968* EXEC CICS LINK
 12969*        PROGRAM    (LINK-1523)
 12970*        COMMAREA   (W-1523-LINKDATA)
 12971*        LENGTH     (W-1523-COMM-LENGTH)
 12972*    END-EXEC.
 12973*    MOVE '."C                   ''   #00012352' TO DFHEIV0
 12974     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12975     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12976     MOVE X'2020233030303132333532' TO DFHEIV0(25:11)
 12977     CALL 'kxdfhei1' USING DFHEIV0,
 12978           LINK-1523,
 12979           W-1523-LINKDATA,
 12980           W-1523-COMM-LENGTH,
 12981           DFHEIV99,
 12982           DFHEIV99,
 12983           DFHEIV99
 12984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12985
 12986
 12987     IF W-1523-FATAL-ERROR
 12988         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 12989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12990         MOVE ER-0802                TO  EMI-ERROR
 12991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12992
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 253
* EL156.cbl
 12993     IF W-1523-ERROR-CODE = 0191
 12994         MOVE ER-0803                TO  EMI-ERROR
 12995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12996
 12997     IF PI-COMPANY-ID      = 'HAN' AND
 12998        PI-PMTTYPE         = '1'   AND
 12999        PI-3RD-PARTY-SW    = 'Y'   AND
 13000        W-1523-FORM-NUMBER = 'EOB1'
 13001           MOVE LOW-VALUES              TO W-1523-LINKDATA
 13002           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 13003           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 13004           GO TO 5000-GENERATE-AUTO-LETTER.
 13005
 13006 5000-END-UPDATE.
 13007
 13008     MOVE ER-0000                TO EMI-ERROR.
 13009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13010     GO TO 7000-SHOW-CLAIM.
 13011
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 254
* EL156.cbl
 13013 5000-MOVE-NAME.
 13014     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13015     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13016     MOVE CL-INSURED-MID-INIT    TO MINITO.
 13017
 13018 5000-EXIT.
 13019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 255
* EL156.cbl
 13021 5300-CREATE-DMO.
 13022
 13023     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 13024     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 13025     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 13026
 13027
 13028* EXEC CICS HANDLE CONDITION
 13029*         NOTFND   (5300-NOTE-NOT-FOUND)
 13030*    END-EXEC.
 13031*    MOVE '"$I                   ! . #00012398' TO DFHEIV0
 13032     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13034     MOVE X'2E20233030303132333938' TO DFHEIV0(25:11)
 13035     CALL 'kxdfhei1' USING DFHEIV0
 13036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13037
 13038
 13039
 13040* EXEC CICS READ
 13041*         DATASET('ERNOTE')
 13042*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 13043*         RIDFLD (W-NOTE-KEY)
 13044*    END-EXEC.
 13045     MOVE 'ERNOTE' TO DFHEIV1
 13046*    MOVE '&"S        E          (   #00012402' TO DFHEIV0
 13047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13049     MOVE X'2020233030303132343032' TO DFHEIV0(25:11)
 13050     CALL 'kxdfhei1' USING DFHEIV0,
 13051           DFHEIV1,
 13052           DFHEIV20,
 13053           DFHEIV99,
 13054           W-NOTE-KEY,
 13055           DFHEIV99,
 13056           DFHEIV99,
 13057           DFHEIV99
 13058     SET ADDRESS OF CERTIFICATE-NOTE TO
 13059         DFHEIV20
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13061
 13062
 13063     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 13064     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 13065     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 13066
 13067     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 13068         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 13069     ELSE
 13070         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 13071
 13072     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 13073     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 13074     MOVE 'DLO006'               TO PGM-NAME.
 13075
 13076
 13077* EXEC CICS LINK
 13078*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 256
* EL156.cbl
 13079*        COMMAREA   (DCT-COMMUNICATION-AREA)
 13080*        LENGTH     (DCT-RCRD-LENGTH)
 13081*    END-EXEC.
 13082*    MOVE '."C                   ''   #00012421' TO DFHEIV0
 13083     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13084     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13085     MOVE X'2020233030303132343231' TO DFHEIV0(25:11)
 13086     CALL 'kxdfhei1' USING DFHEIV0,
 13087           PGM-NAME,
 13088           DCT-COMMUNICATION-AREA,
 13089           DCT-RCRD-LENGTH,
 13090           DFHEIV99,
 13091           DFHEIV99,
 13092           DFHEIV99
 13093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13094
 13095
 13096     IF DCT-RETURN-CODE = 'OK'
 13097         GO TO 5300-CONT.
 13098
 13099     IF DCT-RETURN-CODE = '01' OR '02'
 13100         GO TO 5300-EXIT.
 13101
 13102     IF DCT-RETURN-CODE = '03'
 13103         MOVE ER-0951            TO EMI-ERROR
 13104         GO TO 5300-BAD-EXIT.
 13105
 13106     IF DCT-RETURN-CODE = '04'
 13107         MOVE ER-0946            TO EMI-ERROR
 13108         GO TO 5300-BAD-EXIT.
 13109
 13110     IF DCT-RETURN-CODE = '05'
 13111         MOVE ER-0947            TO EMI-ERROR
 13112         GO TO 5300-BAD-EXIT.
 13113
 13114     IF DCT-RETURN-CODE = '06'
 13115         MOVE ER-0921            TO EMI-ERROR
 13116         GO TO 5300-BAD-EXIT.
 13117
 13118     IF DCT-RETURN-CODE = '07'
 13119         MOVE ER-0849            TO EMI-ERROR
 13120         GO TO 5300-BAD-EXIT.
 13121
 13122     IF DCT-RETURN-CODE = '08'
 13123         MOVE ER-0948            TO EMI-ERROR
 13124         GO TO 5300-BAD-EXIT.
 13125
 13126     IF DCT-RETURN-CODE = 'N1'
 13127         MOVE ER-0950            TO EMI-ERROR
 13128         GO TO 5300-BAD-EXIT.
 13129
 13130     IF DCT-RETURN-CODE = 'E1'
 13131         MOVE ER-0974            TO EMI-ERROR
 13132         GO TO 5300-BAD-EXIT.
 13133
 13134     IF DCT-RETURN-CODE = 'E2'
 13135         MOVE ER-0975            TO EMI-ERROR
 13136         GO TO 5300-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 257
* EL156.cbl
 13137
 13138     IF DCT-RETURN-CODE NOT = 'OK'
 13139         MOVE ER-0949            TO EMI-ERROR
 13140         GO TO 5300-BAD-EXIT.
 13141
 13142 5300-CONT.
 13143
 13144     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 13145     MOVE 'CS'                   TO DM-RECORD-TYPE.
 13146     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 13147     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 13148     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 13149     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 13150     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 13151     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 13152
 13153     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 13154     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 13155     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 13156     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 13157     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 13158
 13159     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 13160
 13161     IF PI-PMTTYPE = '2'
 13162         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 13163         MOVE '4'                TO DM-CLAIM-STATUS
 13164     ELSE
 13165         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 13166         MOVE '2'                TO DM-CLAIM-STATUS.
 13167
 13168     MOVE 'DLO025'               TO PGM-NAME.
 13169
 13170
 13171* EXEC CICS LINK
 13172*        PROGRAM    (PGM-NAME)
 13173*        COMMAREA   (DMO-COMMUNICATION-AREA)
 13174*        LENGTH     (DM-DMO-LENGTH)
 13175*    END-EXEC.
 13176*    MOVE '."C                   ''   #00012501' TO DFHEIV0
 13177     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13178     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13179     MOVE X'2020233030303132353031' TO DFHEIV0(25:11)
 13180     CALL 'kxdfhei1' USING DFHEIV0,
 13181           PGM-NAME,
 13182           DMO-COMMUNICATION-AREA,
 13183           DM-DMO-LENGTH,
 13184           DFHEIV99,
 13185           DFHEIV99,
 13186           DFHEIV99
 13187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13188
 13189
 13190     IF DM-RETURN-CODE = 'OK'
 13191         GO TO 5300-EXIT.
 13192
 13193     IF DM-RETURN-CODE = '01'
 13194         MOVE ER-8051            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 258
* EL156.cbl
 13195         GO TO 5300-BAD-EXIT.
 13196
 13197     IF DM-RETURN-CODE = '02'
 13198         MOVE ER-8052            TO EMI-ERROR
 13199         GO TO 5300-BAD-EXIT.
 13200
 13201     IF DM-RETURN-CODE = '03'
 13202         MOVE ER-8053            TO EMI-ERROR
 13203         GO TO 5300-BAD-EXIT.
 13204
 13205     IF DM-RETURN-CODE = '04'
 13206         MOVE ER-8054            TO EMI-ERROR
 13207         GO TO 5300-BAD-EXIT.
 13208
 13209     IF DM-RETURN-CODE = '05'
 13210         MOVE ER-8055            TO EMI-ERROR
 13211         GO TO 5300-BAD-EXIT.
 13212
 13213     IF DM-RETURN-CODE = '06'
 13214         MOVE ER-8056            TO EMI-ERROR
 13215         GO TO 5300-BAD-EXIT.
 13216
 13217     IF DM-RETURN-CODE = '07'
 13218         MOVE ER-8057            TO EMI-ERROR
 13219         GO TO 5300-BAD-EXIT.
 13220
 13221     IF DM-RETURN-CODE = '08'
 13222         MOVE ER-8058            TO EMI-ERROR
 13223         GO TO 5300-BAD-EXIT.
 13224
 13225     IF DM-RETURN-CODE = '09'
 13226         MOVE ER-8059            TO EMI-ERROR
 13227         GO TO 5300-BAD-EXIT.
 13228
 13229     IF DM-RETURN-CODE = '10'
 13230         MOVE ER-8060            TO EMI-ERROR
 13231         GO TO 5300-BAD-EXIT.
 13232
 13233     IF DM-RETURN-CODE = '11'
 13234         MOVE ER-8061            TO EMI-ERROR
 13235         GO TO 5300-BAD-EXIT.
 13236
 13237     IF DM-RETURN-CODE = '12'
 13238         MOVE ER-8062            TO EMI-ERROR
 13239         GO TO 5300-BAD-EXIT.
 13240
 13241     IF DM-RETURN-CODE = '13'
 13242         MOVE ER-8063            TO EMI-ERROR
 13243         GO TO 5300-BAD-EXIT.
 13244
 13245     IF DM-RETURN-CODE = '14'
 13246         MOVE ER-8064            TO EMI-ERROR
 13247         GO TO 5300-BAD-EXIT.
 13248
 13249     IF DM-RETURN-CODE = '15'
 13250         MOVE ER-8065            TO EMI-ERROR
 13251         GO TO 5300-BAD-EXIT.
 13252
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 259
* EL156.cbl
 13253     IF DM-RETURN-CODE = '16'
 13254         MOVE ER-8154            TO EMI-ERROR
 13255         GO TO 5300-BAD-EXIT.
 13256
 13257     IF DM-RETURN-CODE = '17'
 13258         MOVE ER-8155            TO EMI-ERROR
 13259         GO TO 5300-BAD-EXIT.
 13260
 13261     IF DM-RETURN-CODE = 'N1'
 13262         MOVE ER-8152            TO EMI-ERROR
 13263         GO TO 5300-BAD-EXIT.
 13264
 13265     IF DM-RETURN-CODE = 'E1'
 13266         MOVE ER-8153            TO EMI-ERROR
 13267         GO TO 5300-BAD-EXIT.
 13268
 13269     MOVE ER-8066            TO EMI-ERROR.
 13270     GO TO 5300-BAD-EXIT.
 13271
 13272 5300-NOTE-NOT-FOUND.
 13273
 13274     MOVE ER-0954                TO EMI-ERROR.
 13275     GO TO 5300-BAD-EXIT.
 13276
 13277 5300-BAD-EXIT.
 13278
 13279* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 13280*    MOVE '6"R                   !   #00012595' TO DFHEIV0
 13281     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 13282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13283     MOVE X'2020233030303132353935' TO DFHEIV0(25:11)
 13284     CALL 'kxdfhei1' USING DFHEIV0
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287     IF MAP-NAME = 'EL156A'
 13288         MOVE -1             TO ENTERPFL
 13289       ELSE
 13290         MOVE LOW-VALUES     TO EL156BI
 13291         MOVE -1             TO ENTPFBL.
 13292
 13293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13294     GO TO 8200-SEND-DATAONLY.
 13295
 13296 5300-EXIT.
 13297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 260
* EL156.cbl
 13299 5350-FORMAT-LAST-NAME-1ST.
 13300*****************************************************************
 13301*             M O V E   N A M E   R O U T I N E                 *
 13302*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13303*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13304*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13305*                  FIELD                   VALUE                *
 13306*           W-NAME-LAST    (CL15)      SMITH                    *
 13307*           W-NAME-FIRST   (CL15)      JOHN                     *
 13308*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 13309*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13310*     CONTAIN                                                   *
 13311*                SMITH, JOHN ALLEN                              *
 13312*     OR                                                        *
 13313*                SMITH, JOHN A.                                 *
 13314*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13315*     COPYBOOK, ELCNWA.                                         *
 13316*****************************************************************.
 13317
 13318     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 13319     MOVE ZERO                   TO  WS-NAME-SW.
 13320     SET NWA-INDEX               TO +1.
 13321
 13322     IF W-NAME-LAST   = SPACES AND
 13323        W-NAME-MIDDLE = SPACES
 13324         MOVE +1                 TO WS-NAME-SW.
 13325
 13326     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13327     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13328
 13329     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13330     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13331
 13332     SET NWA-INDEX UP BY +1.
 13333
 13334     IF W-NAME-MIDDLE NOT = SPACES
 13335         IF W-NAME-MIDDLE-2 = SPACES
 13336             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13337             SET NWA-INDEX UP BY +1
 13338             MOVE '.'            TO WS-NW (NWA-INDEX)
 13339             SET NWA-INDEX UP BY +2
 13340         ELSE
 13341             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13342             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 13343
 13344 5350-EXIT.
 13345     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 261
* EL156.cbl
 13347 5360-MOVE-NAME.
 13348
 13349     IF WS-NAME-SW > +1
 13350         GO TO 5360-EXIT.
 13351
 13352     IF WS-NAME-WORK2 = SPACES
 13353         GO TO 5360-EXIT.
 13354
 13355     SET NWA-INDEX2            TO +1.
 13356     SET NWA-INDEX3            TO +2.
 13357
 13358 5360-MOVE-NAME-CYCLE.
 13359
 13360     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 13361
 13362     IF NWA-INDEX < +30
 13363         SET NWA-INDEX UP BY +1
 13364     ELSE
 13365         ADD +2                TO  WS-NAME-SW
 13366         GO TO 5360-EXIT.
 13367
 13368     IF NWA-INDEX2 < +20
 13369         SET NWA-INDEX3 UP BY +1
 13370         SET NWA-INDEX2 UP BY +1.
 13371
 13372     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 13373        WS-NW2 (NWA-INDEX3) = SPACES
 13374         IF WS-NAME-SW = ZERO
 13375             MOVE ','            TO  WS-NW (NWA-INDEX)
 13376             SET NWA-INDEX UP BY +2
 13377             MOVE +1             TO  WS-NAME-SW
 13378             GO TO 5360-EXIT
 13379         ELSE
 13380             GO TO 5360-EXIT.
 13381
 13382     GO TO 5360-MOVE-NAME-CYCLE.
 13383
 13384 5360-EXIT.
 13385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 262
* EL156.cbl
 13387 6000-BUILD-SCREEN-B.
 13388     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13389     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13390     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13391     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13392
 13393     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 13394
 13395 6050-BUILD-SCREEN.
 13396     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 13397     MOVE LOW-VALUES             TO EL156BI.
 13398     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 13399
 13400     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 13401
 13402     IF PI-PAYEE-TYPE = 'I'
 13403        GO TO 6060-READ-TRAILER.
 13404
 13405     IF PI-PAYEE-TYPE = 'B'
 13406        ADD +10                  TO TRLR-SEQ-NO
 13407        GO TO 6060-READ-TRAILER.
 13408
 13409     IF PI-PAYEE-TYPE = 'A'
 13410        ADD +20                  TO TRLR-SEQ-NO
 13411        GO TO 6060-READ-TRAILER.
 13412
 13413     IF PI-PAYEE-TYPE = 'O'
 13414        ADD +50                  TO TRLR-SEQ-NO
 13415        GO TO 6060-READ-TRAILER.
 13416
 13417     IF PI-PAYEE-TYPE = 'Q'
 13418        ADD +60                  TO TRLR-SEQ-NO
 13419        GO TO 6060-READ-TRAILER.
 13420
 13421     IF PI-PAYEE-TYPE = 'P'
 13422        ADD +30                  TO TRLR-SEQ-NO
 13423        GO TO 6060-READ-TRAILER.
 13424
 13425     IF PI-PAYEE-TYPE = 'E'
 13426        ADD +40                  TO TRLR-SEQ-NO.
 13427
 13428 6060-READ-TRAILER.
 13429
 13430     IF PI-PAYEE-TYPE    = 'A' AND
 13431        PI-PAYEE-SEQ-NUM = 0
 13432          GO TO 6061-READ-ACCOUNT.
 13433
 13434     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 13435        (PI-PAYEE-TYPE    = 'B')             AND
 13436        (PI-PAYEE-SEQ-NUM = 9)
 13437          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13438          IF BENE-FOUND-SW = 'N'
 13439            GO TO 6065-NOT-FOUND
 13440          ELSE
 13441            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13442            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13443            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13444*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 263
* EL156.cbl
 13445            STRING BE-CITY ' ' BE-STATE
 13446               DELIMITED BY '  ' INTO CITYSTBO
 13447            END-STRING
 13448            MOVE BE-ZIP-CODE       TO ZIPBO
 13449            GO TO 6061-READ-ACCOUNT.
 13450
 13451     IF PI-PAYEE-TYPE    = 'B' AND
 13452        PI-PAYEE-SEQ-NUM = 0
 13453          PERFORM 7920-READ-BENE THRU 7920-EXIT
 13454          IF BENE-FOUND-SW = 'N'
 13455            GO TO 6065-NOT-FOUND
 13456          ELSE
 13457            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 13458            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 13459            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 13460*           MOVE BE-CITY-STATE     TO CITYSTBO
 13461            STRING BE-CITY ' ' BE-STATE
 13462               DELIMITED BY '  ' INTO CITYSTBO
 13463            END-STRING
 13464            MOVE BE-ZIP-CODE       TO ZIPBO
 13465            GO TO 6061-READ-ACCOUNT.
 13466
 13467
 13468* EXEC CICS HANDLE CONDITION
 13469*         NOTFND(6065-NOT-FOUND)
 13470*     END-EXEC.
 13471*    MOVE '"$I                   ! / #00012776' TO DFHEIV0
 13472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13474     MOVE X'2F20233030303132373736' TO DFHEIV0(25:11)
 13475     CALL 'kxdfhei1' USING DFHEIV0
 13476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13477
 13478
 13479     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13480
 13481     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 13482     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 13483     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 13484     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 13485*    MOVE AT-CITY-STATE          TO CITYSTBO.
 13486     STRING AT-CITY ' ' AT-STATE
 13487        DELIMITED BY '  ' INTO CITYSTBO
 13488     END-STRING
 13489     MOVE AT-ZIP-CODE            TO ZIPBO.
 13490
 13491 6061-READ-ACCOUNT.
 13492
 13493* EXEC CICS HANDLE CONDITION
 13494*         NOTFND(6068-ACCT-NOT-FND)
 13495*     END-EXEC.
 13496*    MOVE '"$I                   ! 0 #00012793' TO DFHEIV0
 13497     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13498     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13499     MOVE X'3020233030303132373933' TO DFHEIV0(25:11)
 13500     CALL 'kxdfhei1' USING DFHEIV0
 13501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13502
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 264
* EL156.cbl
 13503
 13504
 13505* EXEC CICS READ
 13506*         DATASET('ERACCT')
 13507*         SET    (ADDRESS OF ACCOUNT-MASTER)
 13508*         RIDFLD (PI-ACCT-KEY)
 13509*     END-EXEC.
 13510     MOVE 'ERACCT' TO DFHEIV1
 13511*    MOVE '&"S        E          (   #00012797' TO DFHEIV0
 13512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13513     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13514     MOVE X'2020233030303132373937' TO DFHEIV0(25:11)
 13515     CALL 'kxdfhei1' USING DFHEIV0,
 13516           DFHEIV1,
 13517           DFHEIV20,
 13518           DFHEIV99,
 13519           PI-ACCT-KEY,
 13520           DFHEIV99,
 13521           DFHEIV99,
 13522           DFHEIV99
 13523     SET ADDRESS OF ACCOUNT-MASTER TO
 13524         DFHEIV20
 13525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13526
 13527
 13528     MOVE AM-CARRIER             TO ACARRBO.
 13529     MOVE AM-GROUPING            TO GROUPBO.
 13530     MOVE AM-STATE               TO STATEBO.
 13531     MOVE AM-ACCOUNT             TO ACCTBO.
 13532     MOVE AM-NAME                TO ACCTNMBO.
 13533
 13534     IF PI-PAYEE-TYPE = 'A' AND
 13535        PI-PAYEE-SEQ-NUM = 0
 13536          MOVE AM-NAME             TO NAMEBO
 13537                                      PI-PAYEE-NAME
 13538          MOVE AM-ADDRS            TO ADDR1BO
 13539          MOVE SPACES              TO ADDR2BO
 13540*         MOVE AM-CITY             TO CITYSTBO
 13541          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13542             DELIMITED BY '  ' INTO CITYSTBO
 13543          END-STRING
 13544          MOVE AM-ZIP-PRIME        TO WS-ZIP
 13545          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 13546          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 13547          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 13548
 13549     IF CITYSTBO EQUAL SPACES
 13550         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13551         GO TO 6070-FORMAT-DATA
 13552     END-IF.
 13553
 13554     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 13555     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 13556     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 13557     PERFORM VARYING WS-SUB FROM 30 BY -1
 13558          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 13559        IF WS-END-SUB = 0  AND
 13560           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES OR '.')
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 265
* EL156.cbl
 13561            CONTINUE
 13562        ELSE
 13563            IF WS-END-SUB = 0
 13564                MOVE WS-SUB TO WS-END-SUB
 13565            ELSE
 13566                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 13567                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 13568                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13569                END-IF
 13570            END-IF
 13571        END-IF
 13572        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 13573            COMPUTE WS-BEG-SUB = WS-SUB + 1
 13574            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 13575        END-IF
 13576     END-PERFORM.
 13577
 13578     IF WS-BEG-SUB > 0
 13579         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 13580         IF WS-STATE-LENGTH = 2
 13581             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 13582                  TO PI-CHECK-STATE-FOR-AK
 13583         ELSE
 13584             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 13585                'ALASKA'
 13586                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 13587             ELSE
 13588                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13589             END-IF
 13590         END-IF
 13591     ELSE
 13592         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 13593     END-IF.
 13594
 13595     GO TO 6070-FORMAT-DATA.
 13596
 13597 6065-NOT-FOUND.
 13598     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 13599     GO TO 6061-READ-ACCOUNT.
 13600
 13601 6068-ACCT-NOT-FND.
 13602     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 13603
 13604 6070-FORMAT-DATA.
 13605     IF PI-HOLDTIL = ZEROS
 13606        MOVE SAVE-DATE           TO PAYDTBI
 13607       ELSE
 13608        MOVE PI-HOLDTIL          TO PAYDTBO
 13609        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 13610
 13611     MOVE PI-PROOF-DATE          TO PROOFDBO.
 13612     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 13613
 13614     IF EIBAID = DFHPF3 OR DFHPF4
 13615        NEXT SENTENCE
 13616     ELSE
 13617       GO TO 6071-CONTINUE.
 13618
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 266
* EL156.cbl
 13619     MOVE PI-EPYFROM          TO PYFROMBO.
 13620     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 13621
 13622     IF NOT PI-USES-PAID-TO
 13623        MOVE PI-EPYTHRU          TO PYTHRUBO
 13624        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 13625     ELSE
 13626        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 13627        MOVE '4'              TO DC-OPTION-CODE
 13628        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13629        IF NO-CONVERSION-ERROR
 13630           MOVE +1            TO DC-ELAPSED-DAYS
 13631           MOVE +0            TO DC-ELAPSED-MONTHS
 13632           MOVE '6'           TO DC-OPTION-CODE
 13633           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13634           IF NO-CONVERSION-ERROR
 13635              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13636
 13637     MOVE PI-EDAYS            TO DAYSBO.
 13638     MOVE PI-EPYAMT           TO PAYAMTBO.
 13639     IF PI-COMPANY-ID = 'CID'
 13640        IF PI-INT-AMT > ZEROS
 13641           MOVE PI-INT-AMT       TO INTAMTBO
 13642        END-IF
 13643     END-IF
 13644     GO TO 6072-SET-TYPE.
 13645
 13646 6071-CONTINUE.
 13647
 13648     IF PI-CPYFROM NOT = LOW-VALUES
 13649        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 13650        MOVE SPACES              TO DC-OPTION-CODE
 13651        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13652        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 13653
 13654     IF PI-CPYTHRU NOT = LOW-VALUES
 13655        IF NOT PI-USES-PAID-TO
 13656           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13657           MOVE SPACES             TO DC-OPTION-CODE
 13658           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13659           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 13660        ELSE
 13661           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 13662           MOVE '6'                TO DC-OPTION-CODE
 13663           MOVE +1                 TO DC-ELAPSED-DAYS
 13664           MOVE +0                 TO DC-ELAPSED-MONTHS
 13665           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13666           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 13667
 13668     MOVE PI-CDAYS               TO DAYSBO.
 13669     MOVE PI-CPYAMT              TO PAYAMTBO.
 13670     IF PI-COMPANY-ID = 'CID'
 13671        IF PI-INT-AMT > ZEROS
 13672           MOVE PI-INT-AMT       TO INTAMTBO
 13673        END-IF
 13674     END-IF
 13675     .
 13676 6072-SET-TYPE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 267
* EL156.cbl
 13677     IF PI-PMTTYPE = '1'
 13678        MOVE 'PARTIAL'           TO PAYTYPBO.
 13679
 13680     IF PI-PMTTYPE = '2'
 13681        MOVE 'FINAL'             TO PAYTYPBO.
 13682
 13683     IF PI-PMTTYPE = '3'
 13684        MOVE 'LUMP SUM'          TO PAYTYPBO.
 13685
 13686     IF PI-PMTTYPE = '4'
 13687        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 13688
 13689     IF PI-PMTTYPE = '5'
 13690        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 13691
 13692     IF PI-PMTTYPE = '6'
 13693        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 13694
 13695     IF PI-PROV-PMT
 13696        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 13697
 13698     IF PI-ECHECKNO NOT = SPACES
 13699        MOVE PI-ECHECKNO         TO CKNUMBO
 13700     ELSE
 13701        MOVE PI-CCHECKNO         TO CKNUMBO.
 13702
 13703     IF PI-COMPANY-ID = 'CID' OR 'DCC'
 13704        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 13705        MOVE +91                 TO  TRLR-SEQ-NO
 13706
 13707* EXEC CICS READ
 13708*           DATASET  ('ELTRLR')
 13709*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13710*           RIDFLD   (ELTRLR-KEY)
 13711*           RESP     (WS-RESPONSE)
 13712*       END-EXEC
 13713     MOVE 'ELTRLR' TO DFHEIV1
 13714*    MOVE '&"S        E          (  N#00012981' TO DFHEIV0
 13715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13717     MOVE X'204E233030303132393831' TO DFHEIV0(25:11)
 13718     CALL 'kxdfhei1' USING DFHEIV0,
 13719           DFHEIV1,
 13720           DFHEIV20,
 13721           DFHEIV99,
 13722           ELTRLR-KEY,
 13723           DFHEIV99,
 13724           DFHEIV99,
 13725           DFHEIV99
 13726     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13727         DFHEIV20
 13728     MOVE EIBRESP  TO WS-RESPONSE
 13729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13730
 13731        IF WS-RESP-NORMAL
 13732           MOVE AT-INFO-LINE-1   TO  LOANNBO
 13733        ELSE
 13734           MOVE SPACES           TO  LOANNBO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 268
* EL156.cbl
 13735        END-IF
 13736     END-IF
 13737
 13738*       MOVE PI-LOAN-NO          TO LOANNBO
 13739
 13740     IF CKNUMBO = SPACES
 13741         MOVE SPACES             TO CKNUMHDO.
 13742
 13743     MOVE CL-CLAIM-NO            TO CLMNOBO.
 13744     MOVE CL-CARRIER             TO CARRBO.
 13745     MOVE CL-CERT-PRIME          TO CERTNOBO.
 13746     MOVE CL-CERT-SFX            TO SUFXBO.
 13747
 13748     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13749        EVALUATE CL-CLAIM-TYPE
 13750           WHEN 'I'
 13751              MOVE '  IU  '      TO CLMTYPBO
 13752           WHEN 'G'
 13753              MOVE ' GAP  '      TO CLMTYPBO
 13754           WHEN OTHER
 13755              MOVE PI-AH-OVERRIDE-L6
 13756                                 TO CLMTYPBO
 13757        END-EVALUATE
 13758        MOVE ZEROS               TO UNDISBO
 13759*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 13760        IF PI-PMTTYPE = '5' OR '6'
 13761           GO TO 6073-GET-NOTIFY-DATA
 13762        ELSE
 13763           MOVE PI-DAILY-RATE    TO RATEBO
 13764           GO TO 6073-GET-NOTIFY-DATA.
 13765
 13766     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 13767
 13768     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 13769        MOVE ZEROS               TO UNDISBO
 13770     ELSE
 13771        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 13772
 13773 6073-GET-NOTIFY-DATA.
 13774
 13775     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 13776
 13777     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 13778         MOVE SPACES             TO  NAMEB2O
 13779                                     ADDR1B2O
 13780                                     ADDR2B2O
 13781                                     CITYST2O
 13782                                     AGTHDGO
 13783         MOVE ZEROS              TO  ZIPB2O
 13784         GO TO 6080-SET-INCURRED.
 13785
 13786     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 13787     MOVE +29                    TO  TRLR-SEQ-NO.
 13788
 13789
 13790* EXEC CICS HANDLE CONDITION
 13791*        NOTFND   (6074-GET-COMP-DATA)
 13792*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 269
* EL156.cbl
 13793*    MOVE '"$I                   ! 1 #00013046' TO DFHEIV0
 13794     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13796     MOVE X'3120233030303133303436' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0
 13798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13799
 13800
 13801     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 13802
 13803     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 13804     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 13805     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 13806*    MOVE AT-CITY-STATE          TO  CITYST2O.
 13807     STRING AT-CITY ' ' AT-STATE
 13808        DELIMITED BY '  ' INTO CITYST2O
 13809     END-STRING
 13810     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 13811     GO TO 6080-SET-INCURRED.
 13812
 13813 6074-GET-COMP-DATA.
 13814
 13815     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 13816         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 13817
 13818     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 13819         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 13820                                         ADDR1B2O
 13821                                         ADDR2B2O
 13822                                         CITYST2O
 13823         MOVE ZEROS                  TO  ZIPB2O
 13824         GO TO 6080-SET-INCURRED.
 13825
 13826     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 13827     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 13828     MOVE AM-CARRIER             TO  COMP-CARRIER.
 13829     MOVE AM-GROUPING            TO  COMP-GROUP.
 13830     MOVE 'A'                    TO  COMP-TYPE.
 13831     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13832                                 TO  COMP-FIN-RESP.
 13833
 13834     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 13835         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 13836                                       'G' OR 'B'
 13837             MOVE 'G'            TO  COMP-TYPE
 13838             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 13839         ELSE
 13840             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 13841                                 TO  COMP-ACCOUNT
 13842     ELSE
 13843         MOVE 'G'                TO  COMP-TYPE
 13844         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 13845
 13846     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 13847
 13848     IF COMP-REC-FOUND
 13849         MOVE CO-ACCT-NAME       TO  NAMEB2O
 13850         MOVE CO-ADDR-1          TO  ADDR1B2O
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 270
* EL156.cbl
 13851         MOVE CO-ADDR-2          TO  ADDR2B2O
 13852*        MOVE CO-ADDR-3          TO  CITYST2O
 13853         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13854            DELIMITED BY '  ' INTO CITYST2O
 13855         END-STRING
 13856         MOVE CO-ZIP             TO  ZIPB2O
 13857     ELSE
 13858         MOVE 'NO COMP ADDRESS AVAILABLE'
 13859                                 TO  NAMEB2O
 13860                                     ADDR1B2O
 13861                                     ADDR2B2O
 13862                                     CITYST2O
 13863         MOVE ZEROS               TO ZIPB2O.
 13864
 13865 6080-SET-INCURRED.
 13866     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13867     MOVE SPACES                 TO DC-OPTION-CODE.
 13868     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13869     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 13870     MOVE PI-PROCESSOR-ID        TO BYBO.
 13871     MOVE MAP-NAMEB              TO MAP-NAME.
 13872     MOVE 'C'                    TO PI-PASS-SW.
 13873     MOVE EIBAID                 TO PI-PFKEY-USED.
 13874     MOVE -1                     TO ENTPFBL.
 13875     GO TO 8100-SEND-INITIAL-MAP.
 13876
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 271
* EL156.cbl
 13878 6100-BUILD-PAYMENT-TRAILER.
 13879
 13880     IF PI-CHECK-STATE-FOR-AK = 'AK' AND PI-COMPANY-ID = 'CID'
 13881         GO TO 6105-STATE-CHECK-NUMBER
 13882     END-IF.
 13883
 13884     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13885     MOVE '6'                    TO CNTL-REC-TYPE.
 13886
 13887     IF CONTROL-IS-ACTUAL-CARRIER
 13888         MOVE PI-CARRIER         TO WS-CARR
 13889     ELSE
 13890         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 13891
 13892     IF PI-COMPANY-ID = 'FIA'
 13893         MOVE PI-CARRIER         TO  WS-CARR.
 13894
 13895     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 13896     MOVE 0                      TO CNTL-SEQ-NO.
 13897     MOVE 'CARR'                 TO FILE-SWITCH.
 13898
 13899     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 13900
 13901     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13902         IF PI-OFFLINE     = 'Y' AND
 13903            PI-ECHECKNO-CR = 'CR'
 13904              GO TO 6110-READ-CONTROL
 13905         ELSE
 13906            IF PI-CASH = 'N'
 13907                GO TO 6110-READ-CONTROL.
 13908
 13909     IF CHECK-NO-MANUAL    OR
 13910        CHECK-NO-AT-PRINT  OR
 13911        PI-OFFLINE = 'Y'
 13912          GO TO 6130-BUILD-TRAILER.
 13913
 13914     IF PI-COMPANY-ID = 'FIA'
 13915         NEXT SENTENCE
 13916     ELSE
 13917         IF NOT CONTROL-IS-ACTUAL-CARRIER
 13918             GO TO 6110-READ-CONTROL.
 13919
 13920     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13921
 13922     IF CHECK-CNT-RESET-VALUE
 13923        MOVE +1                  TO CF-CHECK-COUNTER
 13924     ELSE
 13925        ADD +1                   TO CF-CHECK-COUNTER.
 13926
 13927     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 13928
 13929     IF CHECK-NO-CARR-SEQ
 13930        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 13931
 13932     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 13933     GO TO 6120-REWRITE.
 13934
 13935 6105-STATE-CHECK-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 272
* EL156.cbl
 13936     IF CHECK-NO-MANUAL    OR
 13937        CHECK-NO-AT-PRINT  OR
 13938        PI-OFFLINE = 'Y'
 13939           GO TO 6130-BUILD-TRAILER
 13940     END-IF.
 13941
 13942     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 13943     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 13944     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 13945     MOVE '3'                TO CNTL-REC-TYPE.
 13946     MOVE +0                 TO CNTL-SEQ-NO.
 13947     MOVE 'STAT'             TO FILE-SWITCH.
 13948     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13949
 13950     IF CF-ST-CHECK-CNT-RESET
 13951         MOVE +1             TO CF-ST-CHECK-COUNTER
 13952     ELSE
 13953         ADD +1              TO CF-ST-CHECK-COUNTER
 13954     END-IF.
 13955
 13956     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 13957     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 13958     GO TO 6120-REWRITE.
 13959
 13960 6110-READ-CONTROL.
 13961     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13962     MOVE '1'                    TO CNTL-REC-TYPE.
 13963     MOVE SPACES                 TO CNTL-ACCESS.
 13964     MOVE 0                      TO CNTL-SEQ-NO.
 13965
 13966     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 13967
 13968     IF CO-CHECK-COUNT-RESET
 13969        MOVE +1                  TO CF-CO-CHECK-COUNTER
 13970     ELSE
 13971        ADD +1                   TO CF-CO-CHECK-COUNTER.
 13972
 13973     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 13974
 13975     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13976         IF PI-OFFLINE     = 'Y'  AND
 13977            PI-ECHECKNO-CR = 'CR'
 13978              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 13979              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 13980              MOVE AL-UANON           TO CHECKNOA
 13981              GO TO 6120-REWRITE
 13982         ELSE
 13983         IF PI-CASH = 'N'
 13984             MOVE 'N'                TO PI-ECHECKNO-N
 13985             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 13986             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 13987             MOVE AL-UANON           TO CHECKNOA
 13988             GO TO 6120-REWRITE.
 13989
 13990     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 13991
 13992 6120-REWRITE.
 13993
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 273
* EL156.cbl
 13994* EXEC CICS REWRITE
 13995*         DATASET('ELCNTL')
 13996*         FROM(CONTROL-FILE)
 13997*     END-EXEC.
 13998     MOVE LENGTH OF
 13999      CONTROL-FILE
 14000       TO DFHEIV11
 14001     MOVE 'ELCNTL' TO DFHEIV1
 14002*    MOVE '&& L                  %   #00013242' TO DFHEIV0
 14003     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14004     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14005     MOVE X'2020233030303133323432' TO DFHEIV0(25:11)
 14006     CALL 'kxdfhei1' USING DFHEIV0,
 14007           DFHEIV1,
 14008           CONTROL-FILE,
 14009           DFHEIV11,
 14010           DFHEIV99
 14011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14012
 14013
 14014     MOVE 'Y'                    TO PI-CK-ASSIGN.
 14015
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 274
* EL156.cbl
 14017 6130-BUILD-TRAILER.
 14018
 14019
 14020* EXEC CICS GETMAIN
 14021*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14022*         LENGTH    (200)
 14023*         INITIMG   (GETMAIN-SPACE)
 14024*     END-EXEC.
 14025     MOVE 200
 14026       TO DFHEIV11
 14027*    MOVE ',"IL                  $   #00013252' TO DFHEIV0
 14028     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14029     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14030     MOVE X'2020233030303133323532' TO DFHEIV0(25:11)
 14031     CALL 'kxdfhei1' USING DFHEIV0,
 14032           DFHEIV20,
 14033           DFHEIV11,
 14034           GETMAIN-SPACE
 14035     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14036         DFHEIV20
 14037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14038
 14039
 14040     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 14041                                    AT-PREV-PAID-THRU-DT.
 14042     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 14043     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 14044     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14045     MOVE 'AT'                   TO AT-RECORD-ID.
 14046     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14047
 14048     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14049        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 14050           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 14051     ELSE
 14052           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 14053           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 14054
 14055     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 14056         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 14057             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 14058             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 14059           ELSE
 14060             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 14061             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 14062
 14063     MOVE '2'                    TO AT-TRAILER-TYPE.
 14064     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14065                                    AT-PAYMENT-LAST-MAINT-DT.
 14066     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14067                                    AT-PAYMENT-LAST-UPDATED-BY.
 14068     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14069     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 14070     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 14071     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 14072
 14073     IF PI-PMT-APPROVED
 14074        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 275
* EL156.cbl
 14075           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 14076
 14077     IF PI-PFKEY-USED = DFHPF5
 14078        GO TO 6140-PF5-ENTERED.
 14079
 14080     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 14081     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 14082
 14083     IF PI-AIG-SPECIAL-BENEFIT
 14084         IF WS-1ST-SPECIAL-PMT
 14085             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 14086             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 14087                                        AT-AMOUNT-PAID
 14088         ELSE
 14089             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14090
 14091     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 14092
 14093     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 14094     MOVE '4'                    TO DC-OPTION-CODE.
 14095     PERFORM 9700-LINK-DATE-CONVERT.
 14096
 14097     IF DATE-CONVERSION-ERROR
 14098        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 14099     ELSE
 14100        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 14101
 14102     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14103     MOVE '4'                    TO DC-OPTION-CODE.
 14104     PERFORM 9700-LINK-DATE-CONVERT.
 14105
 14106     IF DATE-CONVERSION-ERROR
 14107        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 14108     ELSE
 14109        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 14110
 14111     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 14112     GO TO 6150-FINISH-MOVE.
 14113
 14114 6140-PF5-ENTERED.
 14115     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 14116     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 14117
 14118     IF PI-AIG-SPECIAL-BENEFIT
 14119         IF WS-1ST-SPECIAL-PMT
 14120             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 14121             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 14122                                        AT-AMOUNT-PAID
 14123         ELSE
 14124             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 14125
 14126     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 14127     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 14128     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 14129
 14130 6150-FINISH-MOVE.
 14131
 14132     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 276
* EL156.cbl
 14133         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 14134     ELSE
 14135         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 14136
 14137     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 14138     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 14139
 14140     MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 14141     MOVE PI-CASH                TO AT-CASH-PAYMENT.
 14142
 14143     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14144         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 14145
 14146     IF PI-OFFLINE = 'N'
 14147        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 14148        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 14149     ELSE
 14150        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 14151        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 14152
 14153     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 14154
 14155     IF WS-2ND-SPECIAL-PMT
 14156         MOVE 'Y'                TO AT-CASH-PAYMENT
 14157         MOVE SPACES             TO AT-CHECK-NO
 14158         MOVE '3'                TO AT-PAYMENT-ORIGIN
 14159         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 14160         MOVE 'U'                TO AT-AIG-UNEMP-IND
 14161         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 14162
 14163     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 14164                                    AT-TO-BE-WRITTEN-DT.
 14165
 14166     IF PI-HOLDTIL NOT = ZEROS
 14167        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 14168        MOVE '4'                 TO DC-OPTION-CODE
 14169        PERFORM 9700-LINK-DATE-CONVERT
 14170        IF PI-OFFLINE = 'N'
 14171           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 14172        ELSE
 14173           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 14174
 14175     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 14176     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 14177                                    AT-CHECK-QUE-SEQUENCE.
 14178
 14179     IF PI-PFKEY-USED = DFHPF4
 14180        MOVE '1'                 TO AT-FORCE-CONTROL.
 14181
 14182     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 14183        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 14184        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 14185        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 14186
 14187     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 14188                                    AT-VOID-SELECT-DT
 14189                                    AT-VOID-ACCEPT-DT
 14190                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 277
* EL156.cbl
 14191     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14192        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 14193        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 14194        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 14195        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 14196     ELSE
 14197        MOVE ZEROS               TO AT-DAILY-RATE
 14198                                    AT-ELIMINATION-DAYS
 14199        MOVE SPACES              TO AT-BENEFIT-TYPE
 14200     END-IF
 14201     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 14202     MOVE '4'                    TO DC-OPTION-CODE.
 14203     PERFORM 9700-LINK-DATE-CONVERT.
 14204     IF DATE-CONVERSION-ERROR
 14205         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 14206     ELSE
 14207         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 14208     END-IF.
 14209     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 14210*******************************************************
 14211     IF NOT PI-PMT-GRADUATED
 14212         GO TO 6170-WRITE.
 14213
 14214     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14215     MOVE '1'                    TO CNTL-REC-TYPE.
 14216     MOVE SPACES                 TO CNTL-ACCESS.
 14217     MOVE +0                     TO CNTL-SEQ-NO.
 14218     MOVE 'COMP'                 TO FILE-SWITCH.
 14219
 14220     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 14221
 14222     IF PAID-FOR-LIFE
 14223         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 14224             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14225                                     WS-PMT-APPROVAL-SW
 14226             GO TO 6170-WRITE.
 14227
 14228*05999      IF PAID-FOR-AH
 14229     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14230         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 14231             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14232                                     WS-PMT-APPROVAL-SW
 14233             GO TO 6170-WRITE.
 14234
 14235     MOVE '1'                    TO AT-APPROVED-LEVEL.
 14236
 14237******A&H Limits are set as a monthly payment.  Calculate the mont
 14238******equivalent of the amount paid today
 14239     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 14240        PI-SAVE-ODD-DAYS-OVER > 0
 14241           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 14242                               / 30) + PI-SAVE-ELAPSED-MONTHS
 14243           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 14244                                  WS-CALC-PMT-MONTHS
 14245     ELSE
 14246           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 14247     END-IF.
 14248*06007      IF ((PAID-FOR-AH) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 278
* EL156.cbl
 14249     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14250*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14251        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 14252              OR
 14253        ((PAID-FOR-LIFE) AND
 14254        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 14255            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14256       ELSE
 14257*06014      IF ((PAID-FOR-AH)  AND
 14258         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14259*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14260           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 14261              OR
 14262        ((PAID-FOR-LIFE) AND
 14263        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 14264            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14265         ELSE
 14266*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 14267           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14268               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 14269              OR
 14270          ((PAID-FOR-LIFE) AND
 14271          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 14272            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14273       ELSE
 14274            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14275
 14276     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14277        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 14278        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 14279            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 14280        END-IF
 14281     ELSE
 14282     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14283        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 14284        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 14285            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 14286        END-IF
 14287     ELSE
 14288     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 14289        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 14290        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 14291            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 14292        END-IF
 14293     ELSE
 14294     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 14295            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD.
 14296
 14297     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 14298
 14299     IF NOT PI-PMT-GRADUATED
 14300         GO TO 6170-WRITE.
 14301
 14302
 14303* EXEC CICS HANDLE CONDITION
 14304*        NOTFND   (6170-WRITE)
 14305*    END-EXEC.
 14306*    MOVE '"$I                   ! 2 #00013520' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 279
* EL156.cbl
 14307     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14309     MOVE X'3220233030303133353230' TO DFHEIV0(25:11)
 14310     CALL 'kxdfhei1' USING DFHEIV0
 14311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14312
 14313
 14314     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14315     MOVE '2'                    TO CNTL-REC-TYPE.
 14316     MOVE +0                     TO CNTL-SEQ-NO.
 14317     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 14318
 14319
 14320* EXEC CICS READ
 14321*         DATASET  ('ELCNTL')
 14322*         SET      (ADDRESS OF CONTROL-FILE)
 14323*         RIDFLD   (ELCNTL-KEY)
 14324*    END-EXEC.
 14325     MOVE 'ELCNTL' TO DFHEIV1
 14326*    MOVE '&"S        E          (   #00013529' TO DFHEIV0
 14327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14329     MOVE X'2020233030303133353239' TO DFHEIV0(25:11)
 14330     CALL 'kxdfhei1' USING DFHEIV0,
 14331           DFHEIV1,
 14332           DFHEIV20,
 14333           DFHEIV99,
 14334           ELCNTL-KEY,
 14335           DFHEIV99,
 14336           DFHEIV99,
 14337           DFHEIV99
 14338     SET ADDRESS OF CONTROL-FILE TO
 14339         DFHEIV20
 14340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14341
 14342
 14343     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 14344
 14345     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 14346                         OR '4'
 14347         NEXT SENTENCE
 14348     ELSE
 14349         MOVE 'Y' TO WS-NEED-APPROVAL
 14350         GO TO 6170-WRITE.
 14351
 14352     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 14353         MOVE 'Y' TO WS-NEED-APPROVAL
 14354         IF WS-APPROVAL-LEVEL = '1'
 14355             MOVE '2'        TO  AT-APPROVED-LEVEL
 14356                            WS-SAVE-APPROVED-LEVEL
 14357             GO TO 6170-WRITE
 14358         ELSE
 14359             IF WS-APPROVAL-LEVEL = '2'
 14360                 MOVE '3'        TO  AT-APPROVED-LEVEL
 14361                                WS-SAVE-APPROVED-LEVEL
 14362                 GO TO 6170-WRITE
 14363             ELSE IF WS-APPROVAL-LEVEL = '3'
 14364                 MOVE '4'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 280
* EL156.cbl
 14365                                WS-SAVE-APPROVED-LEVEL
 14366                 GO TO 6170-WRITE.
 14367
 14368     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 14369                             WS-PMT-APPROVAL-SW.
 14370     MOVE SPACES         TO  AT-APPROVED-LEVEL
 14371                             AT-APPROVAL-LEVEL-REQD.
 14372
 14373*******************************************************
 14374
 14375 6170-WRITE.
 14376
 14377     IF PI-COMPANY-ID = 'DMD'
 14378        IF PI-AT-EOB-CODES NOT = SPACES
 14379           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 14380           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 14381           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 14382           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 14383           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 14384
 14385
 14386* EXEC CICS HANDLE CONDITION
 14387*        DUPREC    (6180-DUPREC)
 14388*    END-EXEC.
 14389*    MOVE '"$%                   ! 3 #00013577' TO DFHEIV0
 14390     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14392     MOVE X'3320233030303133353737' TO DFHEIV0(25:11)
 14393     CALL 'kxdfhei1' USING DFHEIV0
 14394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14395
 14396
 14397
 14398* EXEC CICS WRITE
 14399*         DATASET       ('ELTRLR')
 14400*         FROM          (ACTIVITY-TRAILERS)
 14401*         RIDFLD        (AT-CONTROL-PRIMARY)
 14402*     END-EXEC.
 14403     MOVE LENGTH OF
 14404      ACTIVITY-TRAILERS
 14405       TO DFHEIV11
 14406     MOVE 'ELTRLR' TO DFHEIV1
 14407*    MOVE '&$ L                  ''   #00013581' TO DFHEIV0
 14408     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14409     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14410     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 14411     CALL 'kxdfhei1' USING DFHEIV0,
 14412           DFHEIV1,
 14413           ACTIVITY-TRAILERS,
 14414           DFHEIV11,
 14415           AT-CONTROL-PRIMARY,
 14416           DFHEIV99,
 14417           DFHEIV99
 14418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14419
 14420
 14421     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 14422        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 281
* EL156.cbl
 14423*06088           GO TO 6199-EXIT.
 14424           GO TO 6176-APPROVAL-NOTE.
 14425
 14426
 14427* EXEC CICS GETMAIN
 14428*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14429*         LENGTH    (200)
 14430*         INITIMG   (GETMAIN-SPACE)
 14431*     END-EXEC.
 14432     MOVE 200
 14433       TO DFHEIV11
 14434*    MOVE ',"IL                  $   #00013592' TO DFHEIV0
 14435     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14437     MOVE X'2020233030303133353932' TO DFHEIV0(25:11)
 14438     CALL 'kxdfhei1' USING DFHEIV0,
 14439           DFHEIV20,
 14440           DFHEIV11,
 14441           GETMAIN-SPACE
 14442     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14443         DFHEIV20
 14444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14445
 14446
 14447     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14448
 14449     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 14450     MOVE 'AT'                   TO AT-RECORD-ID.
 14451     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 14452     MOVE '6'                    TO AT-TRAILER-TYPE.
 14453     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 14454                                    AT-GEN-INFO-LAST-MAINT-DT
 14455     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 14456                                    AT-GEN-INFO-LAST-UPDATED-BY
 14457     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 14458
 14459     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 14460     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 14461     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 14462
 14463     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 14464
 14465 6175-WRITE.
 14466
 14467
 14468* EXEC CICS HANDLE CONDITION
 14469*        DUPREC    (6190-DUPREC)
 14470*    END-EXEC.
 14471*    MOVE '"$%                   ! 4 #00013618' TO DFHEIV0
 14472     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14474     MOVE X'3420233030303133363138' TO DFHEIV0(25:11)
 14475     CALL 'kxdfhei1' USING DFHEIV0
 14476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14477
 14478
 14479
 14480* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 282
* EL156.cbl
 14481*         DATASET     ('ELTRLR')
 14482*         FROM        (ACTIVITY-TRAILERS)
 14483*         RIDFLD      (AT-CONTROL-PRIMARY)
 14484*     END-EXEC.
 14485     MOVE LENGTH OF
 14486      ACTIVITY-TRAILERS
 14487       TO DFHEIV11
 14488     MOVE 'ELTRLR' TO DFHEIV1
 14489*    MOVE '&$ L                  ''   #00013622' TO DFHEIV0
 14490     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14491     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14492     MOVE X'2020233030303133363232' TO DFHEIV0(25:11)
 14493     CALL 'kxdfhei1' USING DFHEIV0,
 14494           DFHEIV1,
 14495           ACTIVITY-TRAILERS,
 14496           DFHEIV11,
 14497           AT-CONTROL-PRIMARY,
 14498           DFHEIV99,
 14499           DFHEIV99
 14500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14501
 14502
 14503 6176-APPROVAL-NOTE.
 14504
 14505     IF NOT APPROVAL-NEEDED
 14506         GO TO 6199-EXIT.
 14507
 14508
 14509* EXEC CICS GETMAIN
 14510*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14511*        LENGTH    (200)
 14512*        INITIMG   (GETMAIN-SPACE)
 14513*    END-EXEC.
 14514     MOVE 200
 14515       TO DFHEIV11
 14516*    MOVE ',"IL                  $   #00013633' TO DFHEIV0
 14517     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14518     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14519     MOVE X'2020233030303133363333' TO DFHEIV0(25:11)
 14520     CALL 'kxdfhei1' USING DFHEIV0,
 14521           DFHEIV20,
 14522           DFHEIV11,
 14523           GETMAIN-SPACE
 14524     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14525         DFHEIV20
 14526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14527
 14528
 14529     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 14530
 14531     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 14532     MOVE 'AT'               TO AT-RECORD-ID
 14533     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 14534     MOVE '6'                TO AT-TRAILER-TYPE
 14535     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 14536                                AT-GEN-INFO-LAST-MAINT-DT
 14537     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 14538                                AT-GEN-INFO-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 283
* EL156.cbl
 14539     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 14540
 14541     MOVE WS-APPROV-NOTE     TO AT-INFO-LINE-1
 14542     MOVE SPACES             TO AT-INFO-LINE-2
 14543
 14544     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 14545 6177-WRITE.
 14546
 14547
 14548* EXEC CICS HANDLE CONDITION
 14549*        DUPREC    (6185-DUPREC)
 14550*    END-EXEC.
 14551*    MOVE '"$%                   ! 5 #00013657' TO DFHEIV0
 14552     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14554     MOVE X'3520233030303133363537' TO DFHEIV0(25:11)
 14555     CALL 'kxdfhei1' USING DFHEIV0
 14556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14557
 14558
 14559
 14560* EXEC CICS WRITE
 14561*         DATASET     ('ELTRLR')
 14562*         FROM        (ACTIVITY-TRAILERS)
 14563*         RIDFLD      (AT-CONTROL-PRIMARY)
 14564*     END-EXEC.
 14565     MOVE LENGTH OF
 14566      ACTIVITY-TRAILERS
 14567       TO DFHEIV11
 14568     MOVE 'ELTRLR' TO DFHEIV1
 14569*    MOVE '&$ L                  ''   #00013661' TO DFHEIV0
 14570     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14571     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14572     MOVE X'2020233030303133363631' TO DFHEIV0(25:11)
 14573     CALL 'kxdfhei1' USING DFHEIV0,
 14574           DFHEIV1,
 14575           ACTIVITY-TRAILERS,
 14576           DFHEIV11,
 14577           AT-CONTROL-PRIMARY,
 14578           DFHEIV99,
 14579           DFHEIV99
 14580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14581
 14582
 14583
 14584     GO TO 6199-EXIT.
 14585
 14586 6180-DUPREC.
 14587
 14588     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14589     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14590     GO TO 6170-WRITE.
 14591
 14592 6185-DUPREC.
 14593     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14594     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14595     GO TO 6177-WRITE.
 14596
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 284
* EL156.cbl
 14597 6190-DUPREC.
 14598     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 14599     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 14600     GO TO 6175-WRITE.
 14601
 14602 6199-EXIT.
 14603      EXIT.
 14604
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 285
* EL156.cbl
 14606 6200-UPDATE-CLAIM-MSTR.
 14607     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14608     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14609     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14610     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14611
 14612     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 14613
 14614     MOVE ZEROS                  TO W-INTEREST.
 14615
 14616     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC'
 14617        IF (PI-OFFLINE = 'Y') OR
 14618           (PI-PMTTYPE = '7')
 14619           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14620                                 THRU 9870-EXIT
 14621        END-IF
 14622     END-IF
 14623     IF NOT ERROR-ON-OUTPUT
 14624        CONTINUE
 14625     ELSE
 14626
 14627* EXEC CICS REWRITE
 14628*          DATASET('ELMSTR')
 14629*          FROM(CLAIM-MASTER)
 14630*       END-EXEC
 14631     MOVE LENGTH OF
 14632      CLAIM-MASTER
 14633       TO DFHEIV11
 14634     MOVE 'ELMSTR' TO DFHEIV1
 14635*    MOVE '&& L                  %   #00013710' TO DFHEIV0
 14636     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14637     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14638     MOVE X'2020233030303133373130' TO DFHEIV0(25:11)
 14639     CALL 'kxdfhei1' USING DFHEIV0,
 14640           DFHEIV1,
 14641           CLAIM-MASTER,
 14642           DFHEIV11,
 14643           DFHEIV99
 14644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14645
 14646        MOVE -1                  TO ENTPFBL
 14647        MOVE AL-UANON            TO ENTPFBA
 14648        MOVE MAP-NAMEB           TO MAP-NAME
 14649        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14650        GO TO 8200-SEND-DATAONLY
 14651     END-IF
 14652
 14653     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 14654
 14655     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 14656
 14657     IF PI-AIG-SPECIAL-BENEFIT
 14658         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 14659
 14660     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 14661
 14662     IF PI-SPECIAL-BEN-SW = 'Y'
 14663         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 286
* EL156.cbl
 14664         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 14665
 14666     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14667         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 14668     ELSE
 14669         IF PI-PMTTYPE NOT = '4'
 14670            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 14671
 14672     IF PI-PMTTYPE = '5' OR '6'
 14673        GO TO  6250-SET-MAINT.
 14674
 14675     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 14676                                         CL-LAG-REPORT-CODE.
 14677
 14678     IF CL-ACTIVITY-CODE = 09
 14679         GO TO 6200-CONT-UPDATE.
 14680
 14681     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14682         IF CL-ACTIVITY-CODE = 11
 14683             GO TO 6200-CONT-UPDATE.
 14684
 14685     IF WS-ACT-REC-FOUND-SW = 'N'
 14686         GO TO 6200-CONT-UPDATE.
 14687
 14688     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 14689         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 14690         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 14691         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 14692
 14693     IF WS-UPDATE-SW = 'Y'
 14694         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 14695                                         CL-NEXT-FOLLOWUP-DT.
 14696
 14697 6200-CONT-UPDATE.
 14698
 14699     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14700       IF CLAIM-IS-CLOSED
 14701         IF PI-PMTTYPE = '2' OR '3' OR '4'
 14702           IF WS-OPEN-CLOSE-SW = '2'
 14703             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 14704                                        CL-LAST-CLOSE-DT.
 14705
 14706     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 14707        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 14708        MOVE 'O'                 TO CL-CLAIM-STATUS.
 14709
 14710     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 14711        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 14712        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 14713        MOVE 'C'                 TO CL-CLAIM-STATUS
 14714        IF PI-PMTTYPE = '2'
 14715           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14716           CONTINUE
 14717        ELSE
 14718           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14719        END-IF
 14720     ELSE
 14721        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 287
* EL156.cbl
 14722           IF PI-PMTTYPE = '2' AND
 14723              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 14724              CONTINUE
 14725           ELSE
 14726              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 14727           END-IF
 14728        END-IF
 14729     END-IF
 14730
 14731     IF PI-PMTTYPE = '4'
 14732        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 14733
 14734     IF PI-COMPANY-ID = 'CVL'
 14735         IF PI-LOAN-UPDATE-SW = 'Y'
 14736             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 14737             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 14738             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 14739             MOVE CL-CERT-STATE      TO  CERT-STATE
 14740             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 14741             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 14742             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 14743             MOVE 'CERT'             TO  FILE-SWITCH
 14744             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 14745             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 14746             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 14747
 14748     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 14749        GO TO 6220-USE-COMPUTED.
 14750
 14751     IF (PI-PMTTYPE = '4')  AND
 14752        (PI-EPYAMT < ZEROS)
 14753          COMPUTE CL-NO-OF-DAYS-PAID =
 14754                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 14755          IF CL-NO-OF-DAYS-PAID < +0
 14756              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14757          ELSE
 14758              NEXT SENTENCE
 14759     ELSE
 14760          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 14761
 14762     IF PI-PROCESSOR-ID = 'FIX '
 14763        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 14764           NEXT SENTENCE
 14765        ELSE
 14766           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 14767     ELSE
 14768        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 14769
 14770     IF PI-PMTTYPE = '4'
 14771        GO TO 6250-SET-MAINT.
 14772
 14773     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14774
 14775     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 14776     MOVE '4'                    TO DC-OPTION-CODE.
 14777     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14778     IF DATE-CONVERSION-ERROR
 14779        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 288
* EL156.cbl
 14780     ELSE
 14781        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 14782           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 14783           IF PI-AIG-SPECIAL-BENEFIT
 14784               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 14785           ELSE
 14786               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 14787
 14788     GO TO 6250-SET-MAINT.
 14789
 14790 6220-USE-COMPUTED.
 14791
 14792     IF (PI-PMTTYPE = '4')  AND
 14793        (PI-CPYAMT < ZEROS)
 14794          COMPUTE CL-NO-OF-DAYS-PAID =
 14795                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 14796          IF CL-NO-OF-DAYS-PAID < +0
 14797              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 14798          ELSE
 14799              NEXT SENTENCE
 14800     ELSE
 14801          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 14802
 14803     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 14804
 14805     IF PI-PMTTYPE = '4'
 14806        GO TO 6250-SET-MAINT.
 14807
 14808     IF PI-AIG-SPECIAL-BENEFIT
 14809         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 14810     ELSE
 14811         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 14812
 14813     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 14814
 14815     IF PI-CPYTHRU > CL-PAID-THRU-DT
 14816        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 14817
 14818 6250-SET-MAINT.
 14819     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 14820
 14821     IF PI-PROCESSOR-ID = 'FIX '
 14822        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 14823           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 14824        ELSE
 14825           NEXT SENTENCE
 14826     ELSE
 14827        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 14828
 14829     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 14830     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 14831     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 14832
 14833 6299-EXIT.
 14834      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 289
* EL156.cbl
 14836 6300-UPDATE-CERT.
 14837
 14838*  ADD CERTNOTE FOR SC NP+6
 14839     IF PI-COMPANY-ID = 'CID' AND
 14840       (PI-PMTTYPE = '2' OR '3') AND
 14841        CL-CERT-STATE = 'SC'  AND
 14842        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 14843           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 14844     END-IF.
 14845
 14846     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 14847     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 14848     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 14849     MOVE CL-CERT-STATE    TO CERT-STATE.
 14850     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 14851     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 14852     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 14853     MOVE 'CERT'           TO FILE-SWITCH.
 14854
 14855     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 14856
 14857     IF CERT-NOTE-ADDED
 14858        IF CM-NOTE-SW = ' '
 14859           MOVE '4'             TO CM-NOTE-SW
 14860        ELSE
 14861           IF CM-NOTE-SW = '1'
 14862               MOVE '5'           TO CM-NOTE-SW
 14863           ELSE
 14864              IF CM-NOTE-SW = '2'
 14865                 MOVE '6'         TO CM-NOTE-SW
 14866              ELSE
 14867                 IF CM-NOTE-SW = '3'
 14868                    MOVE '7'      TO CM-NOTE-SW
 14869                 END-IF
 14870              END-IF
 14871           END-IF
 14872        END-IF
 14873     END-IF.
 14874
 14875     IF PI-COMPANY-ID = 'CVL'
 14876         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 14877         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 14878
 14879     IF PI-PMTTYPE NOT = '4'
 14880        GO TO 6340-UPDATE-CERT.
 14881
 14882     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14883        IF PI-PFKEY-USED = DFHPF5
 14884           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 14885        ELSE
 14886           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
 14887
 14888*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14889*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14890*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14891*               PI-LF-COVERAGE-TYPE = 'P'
 14892*                GO TO 6350-REWRITE-CERT.
 14893
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 290
* EL156.cbl
 14894     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14895       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14896          PI-LF-COVERAGE-TYPE = 'P'
 14897           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14898                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14899                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14900                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14901                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14902                GO TO 6350-REWRITE-CERT
 14903            ELSE
 14904                GO TO 6350-REWRITE-CERT.
 14905
 14906     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14907         GO TO 6350-REWRITE-CERT.
 14908
 14909     IF NOT CM-AH-LUMP-SUM-DISAB
 14910        GO TO 6380-UNLOCK-CERT.
 14911
 14912     IF PI-PFKEY-USED = DFHPF5
 14913        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 14914                                    CM-AH-ITD-AH-PMT
 14915        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14916        GO TO 6350-REWRITE-CERT
 14917     ELSE
 14918        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 14919                                    CM-AH-ITD-AH-PMT
 14920        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 14921        GO TO 6350-REWRITE-CERT.
 14922
 14923 6340-UPDATE-CERT.
 14924
 14925     IF CL-CLAIM-TYPE = 'L'
 14926         IF PI-PFKEY-USED = DFHPF5
 14927             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 14928         ELSE
 14929             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 14930
 14931     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14932         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 14933             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14934                PI-LF-COVERAGE-TYPE = 'P'
 14935                 GO TO 6350-REWRITE-CERT.
 14936
 14937     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14938       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 14939          PI-LF-COVERAGE-TYPE = 'P'
 14940           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 14941                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 14942                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 14943                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 14944                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 14945                GO TO 6350-REWRITE-CERT.
 14946
 14947     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14948         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 14949            PI-LF-COVERAGE-TYPE NOT = 'P'
 14950             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 14951             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 291
* EL156.cbl
 14952             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 14953             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 14954             GO TO 6350-REWRITE-CERT.
 14955
 14956     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14957         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 14958         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 14959         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 14960         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 14961         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 14962         IF PI-PFKEY-USED = DFHPF5
 14963             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 14964                                        CM-AH-ITD-AH-PMT
 14965             GO TO 6350-REWRITE-CERT
 14966         ELSE
 14967             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 14968                                        CM-AH-ITD-AH-PMT
 14969             GO TO 6350-REWRITE-CERT.
 14970
 14971 6350-REWRITE-CERT.
 14972
 14973
 14974* EXEC CICS REWRITE
 14975*         DATASET  ('ELCERT')
 14976*         FROM(CERTIFICATE-MASTER)
 14977*     END-EXEC.
 14978     MOVE LENGTH OF
 14979      CERTIFICATE-MASTER
 14980       TO DFHEIV11
 14981     MOVE 'ELCERT' TO DFHEIV1
 14982*    MOVE '&& L                  %   #00014042' TO DFHEIV0
 14983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14985     MOVE X'2020233030303134303432' TO DFHEIV0(25:11)
 14986     CALL 'kxdfhei1' USING DFHEIV0,
 14987           DFHEIV1,
 14988           CERTIFICATE-MASTER,
 14989           DFHEIV11,
 14990           DFHEIV99
 14991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14992
 14993
 14994     GO TO 6399-EXIT.
 14995
 14996 6380-UNLOCK-CERT.
 14997
 14998* EXEC CICS UNLOCK
 14999*         DATASET  ('ELCERT')
 15000*     END-EXEC.
 15001     MOVE 'ELCERT' TO DFHEIV1
 15002*    MOVE '&*                    #   #00014050' TO DFHEIV0
 15003     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15004     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15005     MOVE X'2020233030303134303530' TO DFHEIV0(25:11)
 15006     CALL 'kxdfhei1' USING DFHEIV0,
 15007           DFHEIV1,
 15008           DFHEIV99
 15009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 292
* EL156.cbl
 15010
 15011
 15012 6399-EXIT.
 15013      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 293
* EL156.cbl
 15015 6400-UPDATE-ZERO-TRAILER.
 15016     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15017     MOVE ZEROS                  TO TRLR-SEQ-NO.
 15018
 15019     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 15020
 15021     IF PI-EPYAMT NOT = ZEROS
 15022         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 15023     ELSE
 15024         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 15025
 15026     IF PI-ERESV NOT = ZEROS
 15027        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 15028
 15029     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 15030        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 15031
 15032     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 15033        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 15034     ELSE
 15035        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 15036
 15037     IF PI-PMTTYPE = '5'
 15038        IF PI-EPYAMT = ZEROS
 15039           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 15040        ELSE
 15041           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 15042
 15043     IF PI-PMTTYPE = '6'
 15044        IF PI-EPYAMT = ZEROS
 15045           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 15046        ELSE
 15047           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 15048
 15049 6420-CHECK-OPEN-CLOSE.
 15050     IF PI-PMTTYPE = '5' OR '6'
 15051        GO TO 6450-REWRITE.
 15052
 15053     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15054         IF PI-PMTTYPE = '2' OR '3' OR '4'
 15055             IF CLAIM-IS-CLOSED
 15056                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 15057                 MOVE 1          TO  SUB-1
 15058                 GO TO 6440-AIG-LOOP.
 15059
 15060     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 15061        GO TO 6450-REWRITE.
 15062
 15063     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 15064        GO TO 6450-REWRITE.
 15065
 15066     MOVE 1                      TO SUB-1.
 15067
 15068 6430-LOOP.
 15069     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15070        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 15071        IF PI-PMTTYPE = '1' OR '4'
 15072           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 294
* EL156.cbl
 15073           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15074           GO TO 6450-REWRITE
 15075        ELSE
 15076           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 15077           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 15078           GO TO 6450-REWRITE.
 15079
 15080     IF SUB-1 = 6
 15081      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15082      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15083      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15084      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15085      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15086      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15087      GO TO 6430-LOOP.
 15088
 15089     ADD 1                       TO SUB-1.
 15090     GO TO 6430-LOOP.
 15091
 15092
 15093 6440-AIG-LOOP.
 15094
 15095     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 15096       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 15097       IF WS-OPEN-CLOSE-SW = '1'
 15098         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15099         IF PI-PMTTYPE = '2'
 15100           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15101           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 15102         ELSE
 15103           IF PI-PMTTYPE = '3'
 15104             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15105             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 15106           ELSE
 15107             IF PI-PMTTYPE = '4'
 15108               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15109               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15110             ELSE
 15111               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15112               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 15113       ELSE
 15114         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 15115         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 15116         GO TO 6450-REWRITE.
 15117
 15118     IF SUB-1 = 6
 15119      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 15120      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 15121      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 15122      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 15123      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 15124      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 15125      GO TO 6440-AIG-LOOP.
 15126
 15127     ADD 1                       TO SUB-1.
 15128     GO TO 6440-AIG-LOOP.
 15129
 15130 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 295
* EL156.cbl
 15131     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 15132     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 15133     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 15134
 15135     IF PI-COMPANY-ID = 'DMD'
 15136         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15137         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15138         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15139         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15140         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15141
 15142
 15143* EXEC CICS REWRITE
 15144*         DATASET  ('ELTRLR')
 15145*         FROM     (ACTIVITY-TRAILERS)
 15146*     END-EXEC.
 15147     MOVE LENGTH OF
 15148      ACTIVITY-TRAILERS
 15149       TO DFHEIV11
 15150     MOVE 'ELTRLR' TO DFHEIV1
 15151*    MOVE '&& L                  %   #00014184' TO DFHEIV0
 15152     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15153     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15154     MOVE X'2020233030303134313834' TO DFHEIV0(25:11)
 15155     CALL 'kxdfhei1' USING DFHEIV0,
 15156           DFHEIV1,
 15157           ACTIVITY-TRAILERS,
 15158           DFHEIV11,
 15159           DFHEIV99
 15160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15161
 15162
 15163 6499-EXIT.
 15164      EXIT.
 15165
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 296
* EL156.cbl
 15167 6500-READ-DLO035.
 15168     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 15169     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15170     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15171     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15172
 15173
 15174* EXEC CICS LINK
 15175*        PROGRAM    ('DLO035')
 15176*        COMMAREA   (DLO035-KEY)
 15177*        LENGTH     (DL35-LENGTH)
 15178*    END-EXEC.
 15179     MOVE 'DLO035' TO DFHEIV1
 15180*    MOVE '."C                   ''   #00014199' TO DFHEIV0
 15181     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15183     MOVE X'2020233030303134313939' TO DFHEIV0(25:11)
 15184     CALL 'kxdfhei1' USING DFHEIV0,
 15185           DFHEIV1,
 15186           DLO035-KEY,
 15187           DL35-LENGTH,
 15188           DFHEIV99,
 15189           DFHEIV99,
 15190           DFHEIV99
 15191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15192
 15193
 15194     IF DL35-RETURN-CODE = 'OK'
 15195         GO TO 6500-EXIT.
 15196
 15197     IF DL35-RETURN-CODE = '01'
 15198         MOVE ER-7830            TO EMI-ERROR
 15199         GO TO 6500-BAD-EXIT.
 15200
 15201     IF DL35-RETURN-CODE = '02'
 15202         MOVE ER-7831            TO EMI-ERROR
 15203         GO TO 6500-BAD-EXIT.
 15204
 15205     IF DL35-RETURN-CODE = '03'
 15206         MOVE ER-7832            TO EMI-ERROR
 15207         GO TO 6500-BAD-EXIT.
 15208
 15209     IF DL35-RETURN-CODE = '04'
 15210         MOVE ER-7833            TO EMI-ERROR
 15211         GO TO 6500-BAD-EXIT.
 15212
 15213     IF DL35-RETURN-CODE = '05'
 15214         MOVE ER-7834            TO EMI-ERROR
 15215         GO TO 6500-BAD-EXIT.
 15216
 15217     IF DL35-RETURN-CODE = '06'
 15218         MOVE ER-7835            TO EMI-ERROR
 15219         GO TO 6500-BAD-EXIT.
 15220
 15221     IF DL35-RETURN-CODE = '07'
 15222         MOVE ER-7836            TO EMI-ERROR
 15223         GO TO 6500-BAD-EXIT.
 15224
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 297
* EL156.cbl
 15225     IF DL35-RETURN-CODE = 'E1'
 15226         MOVE ER-7837            TO EMI-ERROR
 15227         GO TO 6500-BAD-EXIT.
 15228
 15229     IF DL35-RETURN-CODE NOT = 'OK'
 15230         MOVE ER-7838            TO EMI-ERROR
 15231         GO TO 6500-BAD-EXIT.
 15232
 15233 6500-EXIT.
 15234      EXIT.
 15235
 15236 6500-BAD-EXIT.
 15237
 15238* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15239*    MOVE '6"R                   !   #00014248' TO DFHEIV0
 15240     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15242     MOVE X'2020233030303134323438' TO DFHEIV0(25:11)
 15243     CALL 'kxdfhei1' USING DFHEIV0
 15244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15245
 15246     MOVE -1                 TO PMTTYPEL.
 15247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15248     GO TO 8200-SEND-DATAONLY.
 15249
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 298
* EL156.cbl
 15251 6600-UPDATE-DLO035.
 15252     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 15253     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 15254     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 15255     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 15256
 15257
 15258* EXEC CICS LINK
 15259*        PROGRAM    ('DLO035')
 15260*        COMMAREA   (DLO035-KEY)
 15261*        LENGTH     (DL35-LENGTH)
 15262*    END-EXEC.
 15263     MOVE 'DLO035' TO DFHEIV1
 15264*    MOVE '."C                   ''   #00014260' TO DFHEIV0
 15265     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15267     MOVE X'2020233030303134323630' TO DFHEIV0(25:11)
 15268     CALL 'kxdfhei1' USING DFHEIV0,
 15269           DFHEIV1,
 15270           DLO035-KEY,
 15271           DL35-LENGTH,
 15272           DFHEIV99,
 15273           DFHEIV99,
 15274           DFHEIV99
 15275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15276
 15277
 15278     IF DL35-RETURN-CODE = 'OK'
 15279         GO TO 6600-EXIT.
 15280
 15281     IF DL35-RETURN-CODE = '01'
 15282         MOVE ER-7830            TO EMI-ERROR
 15283         GO TO 6500-BAD-EXIT.
 15284
 15285     IF DL35-RETURN-CODE = '02'
 15286         MOVE ER-7831            TO EMI-ERROR
 15287         GO TO 6500-BAD-EXIT.
 15288
 15289     IF DL35-RETURN-CODE = '03'
 15290         MOVE ER-7832            TO EMI-ERROR
 15291         GO TO 6500-BAD-EXIT.
 15292
 15293     IF DL35-RETURN-CODE = '04'
 15294         MOVE ER-7833            TO EMI-ERROR
 15295         GO TO 6500-BAD-EXIT.
 15296
 15297     IF DL35-RETURN-CODE = '05'
 15298         MOVE ER-7834            TO EMI-ERROR
 15299         GO TO 6500-BAD-EXIT.
 15300
 15301     IF DL35-RETURN-CODE = '06'
 15302         MOVE ER-7835            TO EMI-ERROR
 15303         GO TO 6500-BAD-EXIT.
 15304
 15305     IF DL35-RETURN-CODE = '07'
 15306         MOVE ER-7836            TO EMI-ERROR
 15307         GO TO 6500-BAD-EXIT.
 15308
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 299
* EL156.cbl
 15309     IF DL35-RETURN-CODE = 'E1'
 15310         MOVE ER-7837            TO EMI-ERROR
 15311         GO TO 6500-BAD-EXIT.
 15312
 15313     IF DL35-RETURN-CODE NOT = 'OK'
 15314         MOVE ER-7838            TO EMI-ERROR
 15315         GO TO 6500-BAD-EXIT.
 15316
 15317 6600-EXIT.
 15318      EXIT.
 15319
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 300
* EL156.cbl
 15321 6700-UPDATE-ACTQ.
 15322***************************************************************
 15323*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 15324*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 15325*    ONE ALREADY THERE.                                       *
 15326***************************************************************
 15327
 15328
 15329* EXEC CICS HANDLE CONDITION
 15330*         NOTFND(6720-BUILD-NEW-RECORD)
 15331*     END-EXEC.
 15332*    MOVE '"$I                   ! 6 #00014316' TO DFHEIV0
 15333     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15335     MOVE X'3620233030303134333136' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0
 15337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15338
 15339
 15340
 15341* EXEC CICS READ
 15342*         DATASET('ELACTQ')
 15343*         RIDFLD (ELMSTR-KEY)
 15344*         SET    (ADDRESS OF ACTIVITY-QUE)
 15345*         UPDATE
 15346*     END-EXEC.
 15347     MOVE 'ELACTQ' TO DFHEIV1
 15348*    MOVE '&"S        EU         (   #00014320' TO DFHEIV0
 15349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15350     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15351     MOVE X'2020233030303134333230' TO DFHEIV0(25:11)
 15352     CALL 'kxdfhei1' USING DFHEIV0,
 15353           DFHEIV1,
 15354           DFHEIV20,
 15355           DFHEIV99,
 15356           ELMSTR-KEY,
 15357           DFHEIV99,
 15358           DFHEIV99,
 15359           DFHEIV99
 15360     SET ADDRESS OF ACTIVITY-QUE TO
 15361         DFHEIV20
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15366
 15367     IF PI-AIG-SPECIAL-BENEFIT AND
 15368        PI-CASH = 'Y'
 15369         ADD 2                   TO AQ-PAYMENT-COUNTER
 15370     ELSE
 15371         ADD 1                   TO AQ-PAYMENT-COUNTER.
 15372
 15373     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 15374         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 15375
 15376     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 15377
 15378     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 301
* EL156.cbl
 15379         IF WS-PMT-APPROVAL-SW = 'A'
 15380             NEXT SENTENCE
 15381         ELSE
 15382            IF PI-AIG-SPECIAL-BENEFIT AND
 15383               PI-CASH = 'Y'
 15384                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15385                                     WS-PMT-UNAPPROVED-CNT
 15386            ELSE
 15387                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15388                                     WS-PMT-UNAPPROVED-CNT
 15389     ELSE
 15390         IF PI-PMT-APPR-SW = 'Y'
 15391            IF PI-AIG-SPECIAL-BENEFIT AND
 15392               PI-CASH = 'Y'
 15393                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15394                                     WS-PMT-UNAPPROVED-CNT
 15395            ELSE
 15396                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15397                                     WS-PMT-UNAPPROVED-CNT.
 15398
 15399     IF WS-PMT-UNAPPROVED-CNT > ZERO
 15400         MOVE ER-3536 TO EMI-ERROR
 15401         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15402
 15403     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 15404
 15405
 15406* EXEC CICS REWRITE
 15407*         DATASET('ELACTQ')
 15408*         FROM   (ACTIVITY-QUE)
 15409*     END-EXEC.
 15410     MOVE LENGTH OF
 15411      ACTIVITY-QUE
 15412       TO DFHEIV11
 15413     MOVE 'ELACTQ' TO DFHEIV1
 15414*    MOVE '&& L                  %   #00014367' TO DFHEIV0
 15415     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15416     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15417     MOVE X'2020233030303134333637' TO DFHEIV0(25:11)
 15418     CALL 'kxdfhei1' USING DFHEIV0,
 15419           DFHEIV1,
 15420           ACTIVITY-QUE,
 15421           DFHEIV11,
 15422           DFHEIV99
 15423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15424
 15425
 15426     GO TO 6799-EXIT.
 15427
 15428 6720-BUILD-NEW-RECORD.
 15429
 15430* EXEC CICS GETMAIN
 15431*         SET    (ADDRESS OF ACTIVITY-QUE)
 15432*         LENGTH (60)
 15433*         INITIMG(GETMAIN-SPACE)
 15434*     END-EXEC.
 15435     MOVE 60
 15436       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 302
* EL156.cbl
 15437*    MOVE ',"IL                  $   #00014375' TO DFHEIV0
 15438     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15440     MOVE X'2020233030303134333735' TO DFHEIV0(25:11)
 15441     CALL 'kxdfhei1' USING DFHEIV0,
 15442           DFHEIV20,
 15443           DFHEIV11,
 15444           GETMAIN-SPACE
 15445     SET ADDRESS OF ACTIVITY-QUE TO
 15446         DFHEIV20
 15447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15448
 15449
 15450     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 15451
 15452     IF PI-AIG-SPECIAL-BENEFIT AND
 15453        PI-CASH = 'Y'
 15454         MOVE 2                  TO AQ-PAYMENT-COUNTER
 15455     ELSE
 15456         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 15457
 15458     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 15459     MOVE 'AQ'                   TO AQ-RECORD-ID.
 15460     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 15461     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 15462                                    AQ-FOLLOWUP-DATE.
 15463     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 15464     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 15465
 15466     IF PI-PMT-GRADUATED
 15467         IF WS-PMT-APPROVAL-SW = 'A'
 15468             NEXT SENTENCE
 15469         ELSE
 15470            IF PI-AIG-SPECIAL-BENEFIT AND
 15471               PI-CASH = 'Y'
 15472                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15473            ELSE
 15474                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 15475     ELSE
 15476         IF PI-PMT-APPR-SW = 'Y'
 15477            IF PI-AIG-SPECIAL-BENEFIT AND
 15478               PI-CASH = 'Y'
 15479                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 15480            ELSE
 15481                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 15482
 15483     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 15484         MOVE ER-3536 TO EMI-ERROR
 15485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15486
 15487
 15488* EXEC CICS WRITE
 15489*         DATASET('ELACTQ')
 15490*         RIDFLD (ELMSTR-KEY)
 15491*         FROM   (ACTIVITY-QUE)
 15492*     END-EXEC.
 15493     MOVE LENGTH OF
 15494      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 303
* EL156.cbl
 15495       TO DFHEIV11
 15496     MOVE 'ELACTQ' TO DFHEIV1
 15497*    MOVE '&$ L                  ''   #00014418' TO DFHEIV0
 15498     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15500     MOVE X'2020233030303134343138' TO DFHEIV0(25:11)
 15501     CALL 'kxdfhei1' USING DFHEIV0,
 15502           DFHEIV1,
 15503           ACTIVITY-QUE,
 15504           DFHEIV11,
 15505           ELMSTR-KEY,
 15506           DFHEIV99,
 15507           DFHEIV99
 15508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15509
 15510
 15511 6799-EXIT.
 15512      EXIT.
 15513
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 304
* EL156.cbl
 15515 6800-BUILD-FORM-TRAILER.
 15516
 15517
 15518* EXEC CICS GETMAIN
 15519*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15520*         LENGTH   (200)
 15521*         INITIMG  (GETMAIN-SPACE)
 15522*    END-EXEC.
 15523     MOVE 200
 15524       TO DFHEIV11
 15525*    MOVE ',"IL                  $   #00014430' TO DFHEIV0
 15526     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15528     MOVE X'2020233030303134343330' TO DFHEIV0(25:11)
 15529     CALL 'kxdfhei1' USING DFHEIV0,
 15530           DFHEIV20,
 15531           DFHEIV11,
 15532           GETMAIN-SPACE
 15533     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15534         DFHEIV20
 15535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15536
 15537
 15538     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 15539
 15540     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 15541     MOVE 'AT'                   TO AT-RECORD-ID.
 15542     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15543
 15544     MOVE 'A'                    TO AT-TRAILER-TYPE.
 15545     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15546                                    AT-FORM-LAST-MAINT-DT
 15547                                    AT-FORM-SEND-ON-DT.
 15548     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15549                                    AT-FORM-LAST-UPDATED-BY.
 15550     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15551     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 15552     MOVE '6'                    TO DC-OPTION-CODE.
 15553     MOVE +29                    TO DC-ELAPSED-DAYS.
 15554     MOVE +0                     TO DC-ELAPSED-MONTHS.
 15555     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15556     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 15557
 15558     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15559         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 15560
 15561     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 15562                                    AT-FORM-RE-SEND-DT
 15563                                    AT-EMP-FORM-ANSWERED-DT
 15564                                    AT-PHY-FORM-ANSWERED-DT
 15565                                    AT-EMP-FORM-SEND-ON-DT
 15566                                    AT-PHY-FORM-SEND-ON-DT
 15567                                    AT-FORM-PRINTED-DT
 15568                                    AT-FORM-REPRINT-DT.
 15569     MOVE '2'                    TO AT-FORM-TYPE.
 15570
 15571     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 15572     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 305
* EL156.cbl
 15573
 15574     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 15575         NEXT SENTENCE
 15576     ELSE
 15577         IF CL-PROG-FORM-TYPE NOT = 'S'
 15578            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 15579
 15580
 15581* EXEC CICS WRITE
 15582*         DATASET  ('ELTRLR')
 15583*         FROM     (ACTIVITY-TRAILERS)
 15584*         RIDFLD   (AT-CONTROL-PRIMARY)
 15585*     END-EXEC.
 15586     MOVE LENGTH OF
 15587      ACTIVITY-TRAILERS
 15588       TO DFHEIV11
 15589     MOVE 'ELTRLR' TO DFHEIV1
 15590*    MOVE '&$ L                  ''   #00014478' TO DFHEIV0
 15591     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15592     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15593     MOVE X'2020233030303134343738' TO DFHEIV0(25:11)
 15594     CALL 'kxdfhei1' USING DFHEIV0,
 15595           DFHEIV1,
 15596           ACTIVITY-TRAILERS,
 15597           DFHEIV11,
 15598           AT-CONTROL-PRIMARY,
 15599           DFHEIV99,
 15600           DFHEIV99
 15601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15602
 15603
 15604 6899-EXIT.
 15605      EXIT.
 15606
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 306
* EL156.cbl
 15608 6900-BUILD-ARCHIVE-HEADER.
 15609
 15610     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15611     MOVE '1'                    TO CNTL-REC-TYPE.
 15612     MOVE +0                     TO CNTL-SEQ-NO.
 15613     MOVE SPACES                 TO CNTL-ACCESS.
 15614
 15615
 15616* EXEC CICS READ
 15617*         DATASET  ('ELCNTL')
 15618*         SET      (ADDRESS OF CONTROL-FILE)
 15619*         RIDFLD   (ELCNTL-KEY)
 15620*         UPDATE
 15621*    END-EXEC.
 15622     MOVE 'ELCNTL' TO DFHEIV1
 15623*    MOVE '&"S        EU         (   #00014495' TO DFHEIV0
 15624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15625     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15626     MOVE X'2020233030303134343935' TO DFHEIV0(25:11)
 15627     CALL 'kxdfhei1' USING DFHEIV0,
 15628           DFHEIV1,
 15629           DFHEIV20,
 15630           DFHEIV99,
 15631           ELCNTL-KEY,
 15632           DFHEIV99,
 15633           DFHEIV99,
 15634           DFHEIV99
 15635     SET ADDRESS OF CONTROL-FILE TO
 15636         DFHEIV20
 15637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15638
 15639
 15640     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 15641     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 15642
 15643
 15644* EXEC CICS REWRITE
 15645*         FROM     (CONTROL-FILE)
 15646*         DATASET  ('ELCNTL')
 15647*    END-EXEC.
 15648     MOVE LENGTH OF
 15649      CONTROL-FILE
 15650       TO DFHEIV11
 15651     MOVE 'ELCNTL' TO DFHEIV1
 15652*    MOVE '&& L                  %   #00014505' TO DFHEIV0
 15653     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15654     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15655     MOVE X'2020233030303134353035' TO DFHEIV0(25:11)
 15656     CALL 'kxdfhei1' USING DFHEIV0,
 15657           DFHEIV1,
 15658           CONTROL-FILE,
 15659           DFHEIV11,
 15660           DFHEIV99
 15661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15662
 15663
 15664
 15665* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 307
* EL156.cbl
 15666*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 15667*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 15668*    END-EXEC.
 15669*    MOVE '"$$%                  ! 7 #00014510' TO DFHEIV0
 15670     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 15671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15672     MOVE X'3720233030303134353130' TO DFHEIV0(25:11)
 15673     CALL 'kxdfhei1' USING DFHEIV0
 15674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15675
 15676
 15677
 15678* EXEC CICS GETMAIN
 15679*         SET     (ADDRESS OF LETTER-ARCHIVE)
 15680*         LENGTH  (ELARCH-LENGTH)
 15681*         INITIMG (GETMAIN-SPACE)
 15682*    END-EXEC.
 15683*    MOVE ',"IL                  $   #00014515' TO DFHEIV0
 15684     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15686     MOVE X'2020233030303134353135' TO DFHEIV0(25:11)
 15687     CALL 'kxdfhei1' USING DFHEIV0,
 15688           DFHEIV20,
 15689           ELARCH-LENGTH,
 15690           GETMAIN-SPACE
 15691     SET ADDRESS OF LETTER-ARCHIVE TO
 15692         DFHEIV20
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
 15695
 15696     MOVE 'LA'                   TO LA-RECORD-ID.
 15697     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 15698                                    LA-ARCHIVE-NO-A1.
 15699     MOVE '4'                    TO LA-RECORD-TYPE
 15700                                    LA-RECORD-TYPE-A1.
 15701     MOVE +0                     TO LA-LINE-SEQ-NO
 15702                                    LA-LINE-SEQ-NO-A1.
 15703     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 15704                                    LA-COMPANY-CD-A1.
 15705     MOVE CL-CARRIER             TO LA4-CARRIER.
 15706     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 15707     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 15708     MOVE CL-CERT-STATE          TO LA4-STATE.
 15709     MOVE +0                     TO LA4-NO-OF-COPIES.
 15710     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 15711     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 15712     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 15713                                    LA4-INITIAL-PRINT-DATE
 15714                                    LA4-RESEND-PRINT-DATE
 15715                                    LA4-FORM-REM-PRINT-DT.
 15716     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 15717     MOVE '2'                    TO LA4-FORM-TYPE.
 15718
 15719
 15720* EXEC CICS WRITE
 15721*         DATASET  ('ELARCH')
 15722*         FROM     (LETTER-ARCHIVE)
 15723*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 308
* EL156.cbl
 15724*    END-EXEC.
 15725     MOVE LENGTH OF
 15726      LETTER-ARCHIVE
 15727       TO DFHEIV11
 15728     MOVE 'ELARCH' TO DFHEIV1
 15729*    MOVE '&$ L                  ''   #00014544' TO DFHEIV0
 15730     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15732     MOVE X'2020233030303134353434' TO DFHEIV0(25:11)
 15733     CALL 'kxdfhei1' USING DFHEIV0,
 15734           DFHEIV1,
 15735           LETTER-ARCHIVE,
 15736           DFHEIV11,
 15737           LA-CONTROL-PRIMARY,
 15738           DFHEIV99,
 15739           DFHEIV99
 15740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15741
 15742
 15743 6999-EXIT.
 15744      EXIT.
 15745
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 309
* EL156.cbl
 15747 7000-SHOW-CLAIM.
 15748     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 15749     MOVE 'A'                    TO PI-PASS-SW.
 15750     MOVE LOW-VALUES             TO PI-CPYFROM
 15751                                    PI-MONTH-END-SAVE
 15752                                    PI-CPYTHRU.
 15753
 15754     MOVE ZEROS                  TO PI-FATAL-COUNT
 15755                                    PI-DAILY-RATE
 15756                                    PI-BEN-DAYS
 15757                                    PI-MANUAL-SW
 15758                                    PI-SAVE-CURSOR
 15759                                    PI-FORCE-COUNT
 15760                                    PI-HOLDTIL
 15761                                    PI-EPYFROM
 15762                                    PI-EPYTHRU
 15763                                    PI-EDAYS
 15764                                    PI-EPYAMT
 15765                                    PI-ERESV
 15766                                    PI-EEXPENS
 15767                                    PI-CDAYS
 15768                                    PI-CPYAMT
 15769                                    PI-CRESV
 15770                                    PI-CEXPENS
 15771                                    PI-INT-RATE
 15772                                    PI-AIGFROM.
 15773     MOVE ZEROS                  TO PI-PROOF-DATE.
 15774     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 15775                                    PI-REM-BEN-AMT
 15776                                    PI-MO-BEN-AMT.
 15777
 15778     MOVE LOW-VALUES             TO EL156AI.
 15779     MOVE MAP-NAMEA              TO MAP-NAME.
 15780
 15781 7010-BUILD-MAP.
 15782
 15783
 15784* EXEC CICS HANDLE CONDITION
 15785*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 15786*    END-EXEC.
 15787*    MOVE '"$I                   ! 8 #00014590' TO DFHEIV0
 15788     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15790     MOVE X'3820233030303134353930' TO DFHEIV0(25:11)
 15791     CALL 'kxdfhei1' USING DFHEIV0
 15792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15793
 15794
 15795     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15796     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15797     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15798     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15799     MOVE 'MSTR'                 TO FILE-SWITCH.
 15800
 15801     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15802
 15803     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 15804     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 310
* EL156.cbl
 15805     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 15806     MOVE CL-CCN                 TO PI-SV-CCN.
 15807
 15808     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15809     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15810     MOVE CL-CLAIM-NO            TO CLMNOO.
 15811     MOVE CL-CARRIER             TO CARRO.
 15812     MOVE CL-CERT-PRIME          TO CERTNOO.
 15813     MOVE CL-CERT-SFX            TO SUFXO.
 15814
 15815     IF (PI-COMPANY-ID = 'CID')
 15816        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 15817        CONTINUE
 15818     ELSE
 15819        MOVE AL-SADOF            TO ZINTHA
 15820                                    ZINTA
 15821                                    PINTHA
 15822                                    PINTA
 15823     END-IF
 15824     EVALUATE TRUE
 15825     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 15826         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 15827     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 15828         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 15829
 15830     WHEN CL-CLAIM-TYPE = 'I'
 15831         MOVE '  IU  '           TO CLMTYPO
 15832     WHEN CL-CLAIM-TYPE = 'G'
 15833         MOVE ' GAP  '           TO CLMTYPO
 15834     END-EVALUATE.
 15835     IF CLAIM-IS-OPEN
 15836         MOVE ' OPEN'            TO CLMSTATO
 15837     ELSE
 15838         MOVE 'CLOSED'           TO CLMSTATO.
 15839
 15840     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 15841
 15842     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 15843         MOVE SPACES             TO  PCERTNOO
 15844                                     PSUFXO
 15845                                     PRIMHDGO
 15846                                     SEQUO
 15847         MOVE AL-SADOF           TO  PCERTNOA
 15848                                     PSUFXA
 15849                                     PRIMHDGA
 15850                                     SEQUA
 15851     ELSE
 15852         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 15853         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 15854         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 15855         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 15856         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 15857         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 15858         MOVE AL-SANON               TO  PCERTNOA
 15859                                         PSUFXA
 15860                                         PRIMHDGA
 15861         MOVE AL-SABON               TO  SEQUA.
 15862
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 311
* EL156.cbl
 15863     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 15864
 15865     IF CL-NO-OF-PMTS-MADE = 0 AND
 15866        CL-TOTAL-PAID-AMT = 0
 15867         NEXT SENTENCE
 15868     ELSE
 15869         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 15870             IF NOT PI-USES-PAID-TO
 15871                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15872                 MOVE ' '                 TO DC-OPTION-CODE
 15873                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15874                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15875             ELSE
 15876                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 15877                 MOVE '6'                 TO DC-OPTION-CODE
 15878                 MOVE +1                  TO DC-ELAPSED-DAYS
 15879                 MOVE +0                  TO DC-ELAPSED-MONTHS
 15880                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15881                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 15882
 15883     IF MAP-NAME = 'EL156A'
 15884     IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 15885        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 15886          MOVE AL-SADOF TO    AIGFRMHA AIGFROMA.
 15887
 15888     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 15889         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 15890         MOVE ' '                TO DC-OPTION-CODE
 15891         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15892         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 15893
 15894     IF CL-INCURRED-DT NOT = LOW-VALUES
 15895         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15896         MOVE ' '                TO DC-OPTION-CODE
 15897         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15898         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 15899
 15900     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 15901
 15902     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 15903         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 15904         MOVE ' '                TO DC-OPTION-CODE
 15905         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15906         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 15907
 15908     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15909         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 15910         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 15911     ELSE
 15912         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 15913         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 15914
 15915     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 15916     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 15917     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 15918     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 15919                                    PI-GROUPING.
 15920     MOVE CL-CERT-STATE          TO CERT-STATE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 312
* EL156.cbl
 15921                                    PI-STATE.
 15922     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 15923                                    PI-ACCOUNT.
 15924     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 15925     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 15926     MOVE 'CERT'                 TO FILE-SWITCH.
 15927
 15928     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 15929
 15930     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15931     MOVE PI-STATE               TO WS-ST-ACCESS.
 15932     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 15933     MOVE '3'                    TO CNTL-REC-TYPE.
 15934     MOVE +0                     TO CNTL-SEQ-NO.
 15935     MOVE 'STAT'                 TO FILE-SWITCH.
 15936
 15937     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15938
 15939     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 15940     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 15941
 15942     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15943        GO TO 7020-BYPASS-BENEFIT.
 15944
 15945     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15946     MOVE '4'                    TO CNTL-REC-TYPE.
 15947     MOVE +0                     TO CNTL-SEQ-NO.
 15948     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 15949     MOVE WS-ACCESS              TO CNTL-ACCESS.
 15950     MOVE 'BENE'                 TO FILE-SWITCH.
 15951
 15952     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 15953
 15954     IF NO-BENEFIT-FOUND
 15955        GO TO 7020-BYPASS-BENEFIT.
 15956
 15957     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 15958     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 15959     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 15960
 15961 7020-BYPASS-BENEFIT.
 15962
 15963*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15964*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 15965*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 15966
 15967     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 15968         GO TO 7021-GO-TO-LIFE.
 15969
 15970     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15971     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 15972     MOVE CM-AH-BENEFIT-AMT      TO BENEO.
 15973     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 15974     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 15975                                    CP-ORIGINAL-TERM.
 15976     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 15977
 15978*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 313
* EL156.cbl
 15979*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 15980*    ELSE
 15981         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 15982
 15983     MOVE ' '                    TO DC-OPTION-CODE.
 15984     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15985     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 15986
 15987     IF PI-COMPANY-ID = 'DMD'
 15988         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 15989         GO TO 7023-BYPASS-REMAINING-TERM.
 15990
 15991     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 15992     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15993     GO TO 7022-AROUND-LIFE.
 15994
 15995 7021-GO-TO-LIFE.
 15996
 15997     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15998     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 15999     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 16000                                    CP-ORIGINAL-TERM.
 16001     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 16002     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 16003     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 16004     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 16005
 16006     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16007         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 16008     ELSE
 16009         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 16010
 16011     MOVE ' '                    TO DC-OPTION-CODE.
 16012     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16013     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 16014
 16015 7022-AROUND-LIFE.
 16016
 16017     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 16018     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16019     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 16020     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 16021     MOVE '4'                    TO CP-REM-TERM-METHOD.
 16022     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 16023     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 16024
 16025     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 16026
 16027     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16028        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 16029           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 16030
 16031     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16032        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 16033           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 16034
 16035 7023-BYPASS-REMAINING-TERM.
 16036
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 314
* EL156.cbl
 16037     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16038       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 16039          MOVE ZEROS                  TO BENEO
 16040       ELSE
 16041          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 16042          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 16043          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 16044          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 16045          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 16046          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 16047          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 16048          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 16049          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 16050          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 16051          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 16052          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 16053
 16054* EXEC CICS LINK
 16055*            PROGRAM  (LINK-REMAMT)
 16056*            COMMAREA (CALCULATION-PASS-AREA)
 16057*            LENGTH   (CP-COMM-LENGTH)
 16058*         END-EXEC
 16059*    MOVE '."C                   ''   #00014852' TO DFHEIV0
 16060     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16061     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16062     MOVE X'2020233030303134383532' TO DFHEIV0(25:11)
 16063     CALL 'kxdfhei1' USING DFHEIV0,
 16064           LINK-REMAMT,
 16065           CALCULATION-PASS-AREA,
 16066           CP-COMM-LENGTH,
 16067           DFHEIV99,
 16068           DFHEIV99,
 16069           DFHEIV99
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16071          MOVE CP-REMAINING-AMT       TO BENEO.
 16072
 16073     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16074         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16075            WS-LF-COVERAGE-TYPE = 'P'
 16076             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 16077                                        CM-LF-ITD-DEATH-AMT
 16078             MOVE WS-REMAINING-AMT  TO  BENEO.
 16079
 16080     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 16081     MOVE BENEO                  TO PI-REM-BEN-AMT.
 16082     MOVE WS-TERMS               TO TERMSO.
 16083
 16084     IF WS-STATUS = '6' OR '7' OR '8'
 16085         MOVE AL-SABOF           TO CRTSTATA.
 16086
 16087     IF WS-STATUS = '1' OR '4'
 16088        IF CP-REMAINING-TERM-3 = ZEROS
 16089           MOVE 'EXPIRED'        TO CRTSTATO
 16090        ELSE
 16091           MOVE 'ACTIVE  '       TO CRTSTATO.
 16092
 16093     IF WS-STATUS = '2'
 16094         MOVE 'PEND    '         TO CRTSTATO.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 315
* EL156.cbl
 16095
 16096     IF WS-STATUS = '3'
 16097         MOVE 'RESTORE '         TO CRTSTATO.
 16098
 16099     IF WS-STATUS = '5'
 16100         MOVE 'REISSUE '         TO CRTSTATO.
 16101
 16102     IF WS-STATUS = '6'
 16103         MOVE 'LMP DIS'          TO CRTSTATO.
 16104
 16105     IF WS-STATUS = '7'
 16106         MOVE 'DEATH'            TO CRTSTATO.
 16107
 16108     IF WS-STATUS = '8'
 16109         MOVE 'CANCEL'           TO CRTSTATO.
 16110
 16111     IF WS-STATUS = '9'
 16112         MOVE 'RE-ONLY '         TO CRTSTATO.
 16113
 16114     IF WS-STATUS = 'V'
 16115         MOVE 'VOID  '           TO CRTSTATO.
 16116
 16117     IF WS-STATUS = 'D'
 16118         MOVE 'DECLINE '         TO CRTSTATO.
 16119
 16120     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16121         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 16122         MOVE '5'                TO CNTL-REC-TYPE
 16123     ELSE
 16124         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 16125         MOVE '4'                TO CNTL-REC-TYPE.
 16126
 16127     MOVE '** NONE **'           TO COVERO.
 16128     MOVE AL-SABON               TO COVERA.
 16129
 16130     IF PI-COMPANY-ID = 'CVL'
 16131         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 16132             MOVE CM-BENEFICIARY TO LOANNOO
 16133             MOVE AL-UANON       TO LOANNOA.
 16134
 16135     IF PI-COMPANY-ID = 'CID' OR 'DCC'
 16136        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 16137        MOVE +91                 TO  TRLR-SEQ-NO
 16138
 16139* EXEC CICS READ
 16140*           DATASET  ('ELTRLR')
 16141*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16142*           RIDFLD   (ELTRLR-KEY)
 16143*           RESP     (WS-RESPONSE)
 16144*       END-EXEC
 16145     MOVE 'ELTRLR' TO DFHEIV1
 16146*    MOVE '&"S        E          (  N#00014924' TO DFHEIV0
 16147     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16149     MOVE X'204E233030303134393234' TO DFHEIV0(25:11)
 16150     CALL 'kxdfhei1' USING DFHEIV0,
 16151           DFHEIV1,
 16152           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 316
* EL156.cbl
 16153           DFHEIV99,
 16154           ELTRLR-KEY,
 16155           DFHEIV99,
 16156           DFHEIV99,
 16157           DFHEIV99
 16158     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16159         DFHEIV20
 16160     MOVE EIBRESP  TO WS-RESPONSE
 16161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16162
 16163        IF WS-RESP-NORMAL
 16164           MOVE AT-INFO-LINE-1   TO  LOANNOO
 16165        ELSE
 16166           MOVE SPACES           TO  LOANNOO
 16167        END-IF
 16168*052506
 16169*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 16170*052506
 16171     END-IF
 16172
 16173     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 16174        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 16175
 16176     IF WS-BEN-CD = ZEROS
 16177         GO TO 7050-SHOW-CONTINUE.
 16178
 16179     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16180     MOVE WS-ACCESS              TO CNTL-ACCESS.
 16181     MOVE +0                     TO CNTL-SEQ-NO.
 16182     MOVE 'BENE'                 TO FILE-SWITCH.
 16183
 16184     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 16185
 16186     IF BENEFIT-FOUND
 16187         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 16188         MOVE AL-SANON                    TO COVERA.
 16189
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 317
* EL156.cbl
 16191 7050-SHOW-CONTINUE.
 16192
 16193     IF PI-COMPANY-ID = 'DMD'
 16194         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 16195
 16196     MOVE -1                     TO PMTTYPEL.
 16197     GO TO 8100-SEND-INITIAL-MAP.
 16198
 16199 7100-SHOW-RECORD-NOT-FOUND.
 16200     IF FILE-SWITCH = 'MSTR'
 16201         MOVE ER-0204            TO EMI-ERROR.
 16202
 16203     IF FILE-SWITCH = 'CERT'
 16204         MOVE ER-0206            TO EMI-ERROR.
 16205
 16206     IF FILE-SWITCH = 'STAT'
 16207         MOVE ER-0149            TO EMI-ERROR.
 16208
 16209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16210
 16211     MOVE -1                     TO PMTTYPEL.
 16212     GO TO 8100-SEND-INITIAL-MAP
 16213
 16214     .
 16215 7110-BUILD-PMT-TRLR.
 16216     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 16217     MOVE +51                    TO TRLR-SEQ-NO
 16218
 16219* EXEC CICS READ
 16220*        DATASET  ('ELTRLR')
 16221*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16222*        RIDFLD   (ELTRLR-KEY)
 16223*        RESP     (WS-RESPONSE)
 16224*    END-EXEC
 16225     MOVE 'ELTRLR' TO DFHEIV1
 16226*    MOVE '&"S        E          (  N#00014986' TO DFHEIV0
 16227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16229     MOVE X'204E233030303134393836' TO DFHEIV0(25:11)
 16230     CALL 'kxdfhei1' USING DFHEIV0,
 16231           DFHEIV1,
 16232           DFHEIV20,
 16233           DFHEIV99,
 16234           ELTRLR-KEY,
 16235           DFHEIV99,
 16236           DFHEIV99,
 16237           DFHEIV99
 16238     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16239         DFHEIV20
 16240     MOVE EIBRESP  TO WS-RESPONSE
 16241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16242     IF WS-RESP-NORMAL
 16243        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 16244     END-IF
 16245     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 16246
 16247* EXEC CICS GETMAIN
 16248*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 318
* EL156.cbl
 16249*         LENGTH    (200)
 16250*         INITIMG   (GETMAIN-SPACE)
 16251*     END-EXEC
 16252     MOVE 200
 16253       TO DFHEIV11
 16254*    MOVE ',"IL                  $   #00014996' TO DFHEIV0
 16255     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16257     MOVE X'2020233030303134393936' TO DFHEIV0(25:11)
 16258     CALL 'kxdfhei1' USING DFHEIV0,
 16259           DFHEIV20,
 16260           DFHEIV11,
 16261           GETMAIN-SPACE
 16262     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16263         DFHEIV20
 16264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16265     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 16266                                    AT-PREV-PAID-THRU-DT
 16267     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 16268     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16269     MOVE 'AT'                   TO AT-RECORD-ID
 16270     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16271     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 16272     MOVE '2'                    TO AT-TRAILER-TYPE
 16273     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16274                                    AT-PAYMENT-LAST-MAINT-DT
 16275     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16276                                    AT-PAYMENT-LAST-UPDATED-BY
 16277     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16278     MOVE 'I'                    TO AT-PAYMENT-TYPE
 16279     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 16280     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 16281     MOVE +0                     TO AT-EXPENSE-PER-PMT
 16282     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 16283     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 16284     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 16285     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 16286     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 16287     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 16288     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 16289     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 16290     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 16291     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 16292     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 16293                                    AT-TO-BE-WRITTEN-DT
 16294     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 16295                                    AT-CHECK-QUE-SEQUENCE
 16296                                    AT-ADDL-RESERVE
 16297     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 16298                                    AT-VOID-SELECT-DT
 16299                                    AT-VOID-ACCEPT-DT
 16300                                    AT-VOID-DT
 16301                                    AT-PMT-PROOF-DT
 16302                                    AT-INT-PMT-SELECT-DT
 16303     MOVE ZEROS                  TO AT-DAILY-RATE
 16304                                    AT-ELIMINATION-DAYS
 16305     MOVE SPACES                 TO AT-BENEFIT-TYPE
 16306*    EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 319
* EL156.cbl
 16307*        DUPREC    (7120-DUPREC)
 16308*    END-EXEC
 16309     .
 16310 7115-WRITE-INT-TRLR.
 16311
 16312* EXEC CICS WRITE
 16313*         DATASET       ('ELTRLR')
 16314*         FROM          (ACTIVITY-TRAILERS)
 16315*         RIDFLD        (AT-CONTROL-PRIMARY)
 16316*         RESP          (WS-RESPONSE)
 16317*     END-EXEC
 16318     MOVE LENGTH OF
 16319      ACTIVITY-TRAILERS
 16320       TO DFHEIV11
 16321     MOVE 'ELTRLR' TO DFHEIV1
 16322*    MOVE '&$ L                  ''  N#00015047' TO DFHEIV0
 16323     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16325     MOVE X'204E233030303135303437' TO DFHEIV0(25:11)
 16326     CALL 'kxdfhei1' USING DFHEIV0,
 16327           DFHEIV1,
 16328           ACTIVITY-TRAILERS,
 16329           DFHEIV11,
 16330           AT-CONTROL-PRIMARY,
 16331           DFHEIV99,
 16332           DFHEIV99
 16333     MOVE EIBRESP  TO WS-RESPONSE
 16334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16335      IF WS-RESP-DUPREC
 16336         GO TO 7120-DUPREC
 16337      END-IF
 16338     GO TO 7130-EXIT
 16339     .
 16340 7120-DUPREC.
 16341     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16342     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 16343     GO TO 7115-WRITE-INT-TRLR
 16344     .
 16345 7130-EXIT.
 16346      EXIT.
 16347 7140-BUILD-NOTE-TRLR.
 16348
 16349
 16350* EXEC CICS GETMAIN
 16351*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16352*         LENGTH    (200)
 16353*         INITIMG   (GETMAIN-SPACE)
 16354*     END-EXEC
 16355     MOVE 200
 16356       TO DFHEIV11
 16357*    MOVE ',"IL                  $   #00015067' TO DFHEIV0
 16358     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16360     MOVE X'2020233030303135303637' TO DFHEIV0(25:11)
 16361     CALL 'kxdfhei1' USING DFHEIV0,
 16362           DFHEIV20,
 16363           DFHEIV11,
 16364           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 320
* EL156.cbl
 16365     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16366         DFHEIV20
 16367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16368     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16369     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 16370     MOVE 'AT'                   TO AT-RECORD-ID
 16371     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 16372     MOVE '6'                    TO AT-TRAILER-TYPE
 16373     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16374                                    AT-GEN-INFO-LAST-MAINT-DT
 16375     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16376                                    AT-GEN-INFO-LAST-UPDATED-BY
 16377     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 16378     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 16379     .
 16380 7150-WRITE.
 16381
 16382* EXEC CICS HANDLE CONDITION
 16383*        DUPREC    (7160-DUPREC)
 16384*    END-EXEC
 16385*    MOVE '"$%                   ! 9 #00015085' TO DFHEIV0
 16386     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16388     MOVE X'3920233030303135303835' TO DFHEIV0(25:11)
 16389     CALL 'kxdfhei1' USING DFHEIV0
 16390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16391
 16392* EXEC CICS WRITE
 16393*         DATASET     ('ELTRLR')
 16394*         FROM        (ACTIVITY-TRAILERS)
 16395*         RIDFLD      (AT-CONTROL-PRIMARY)
 16396*         RESP        (WS-RESPONSE)
 16397*     END-EXEC
 16398     MOVE LENGTH OF
 16399      ACTIVITY-TRAILERS
 16400       TO DFHEIV11
 16401     MOVE 'ELTRLR' TO DFHEIV1
 16402*    MOVE '&$ L                  ''  N#00015088' TO DFHEIV0
 16403     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16405     MOVE X'204E233030303135303838' TO DFHEIV0(25:11)
 16406     CALL 'kxdfhei1' USING DFHEIV0,
 16407           DFHEIV1,
 16408           ACTIVITY-TRAILERS,
 16409           DFHEIV11,
 16410           AT-CONTROL-PRIMARY,
 16411           DFHEIV99,
 16412           DFHEIV99
 16413     MOVE EIBRESP  TO WS-RESPONSE
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16415      IF WS-RESP-DUPREC
 16416         GO TO 7160-DUPREC
 16417      END-IF
 16418     GO TO 7170-EXIT
 16419     .
 16420 7160-DUPREC.
 16421     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 16422     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 321
* EL156.cbl
 16423     GO TO 7150-WRITE
 16424     .
 16425 7170-EXIT.
 16426      EXIT.
 16427
 16428 7180-ADD-CERT-NOTE.
 16429*ADD CERT NOTE FOR SC NP+6
 16430
 16431
 16432* EXEC CICS GETMAIN
 16433*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16434*         LENGTH    (150)
 16435*         INITIMG   (GETMAIN-SPACE)
 16436*     END-EXEC.
 16437     MOVE 150
 16438       TO DFHEIV11
 16439*    MOVE ',"IL                  $   #00015110' TO DFHEIV0
 16440     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16441     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16442     MOVE X'2020233030303135313130' TO DFHEIV0(25:11)
 16443     CALL 'kxdfhei1' USING DFHEIV0,
 16444           DFHEIV20,
 16445           DFHEIV11,
 16446           GETMAIN-SPACE
 16447     SET ADDRESS OF CERT-NOTE-FILE TO
 16448         DFHEIV20
 16449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16450
 16451
 16452     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 16453     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 16454     MOVE +1                     TO WRK-NOTE-SEQ.
 16455     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16456     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16457     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16458     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16459     MOVE CL-CERT-STATE          TO CZ-STATE.
 16460     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16461     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16462     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16463     MOVE '2'                    TO CZ-RECORD-TYPE.
 16464     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16465     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16466     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16467     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16468     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16469     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 16470     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 16471     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 16472     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 16473
 16474 7181-WRITE.
 16475
 16476
 16477* EXEC CICS WRITE
 16478*         DATASET     ('ERCNOT')
 16479*         FROM        (CERT-NOTE-FILE)
 16480*         RIDFLD      (CZ-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 322
* EL156.cbl
 16481*         RESP        (WS-RESPONSE)
 16482*    END-EXEC.
 16483     MOVE LENGTH OF
 16484      CERT-NOTE-FILE
 16485       TO DFHEIV11
 16486     MOVE 'ERCNOT' TO DFHEIV1
 16487*    MOVE '&$ L                  ''  N#00015140' TO DFHEIV0
 16488     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16489     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16490     MOVE X'204E233030303135313430' TO DFHEIV0(25:11)
 16491     CALL 'kxdfhei1' USING DFHEIV0,
 16492           DFHEIV1,
 16493           CERT-NOTE-FILE,
 16494           DFHEIV11,
 16495           CZ-CONTROL-PRIMARY,
 16496           DFHEIV99,
 16497           DFHEIV99
 16498     MOVE EIBRESP  TO WS-RESPONSE
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     IF WS-RESP-DUPREC
 16503         GO TO 7182-DUPREC
 16504     END-IF.
 16505
 16506     SET CERT-NOTE-ADDED TO TRUE.
 16507
 16508     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 16509         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 16510     END-IF.
 16511
 16512     GO TO 7189-EXIT.
 16513
 16514 7182-DUPREC.
 16515
 16516     ADD +1                      TO  WRK-NOTE-SEQ.
 16517     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16518     GO TO 7181-WRITE.
 16519
 16520 7189-EXIT.
 16521      EXIT.
 16522
 16523 7190-ADD-ORIG-NOTE.
 16524
 16525
 16526* EXEC CICS GETMAIN
 16527*         SET       (ADDRESS OF CERT-NOTE-FILE)
 16528*         LENGTH    (150)
 16529*         INITIMG   (GETMAIN-SPACE)
 16530*     END-EXEC.
 16531     MOVE 150
 16532       TO DFHEIV11
 16533*    MOVE ',"IL                  $   #00015170' TO DFHEIV0
 16534     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16535     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16536     MOVE X'2020233030303135313730' TO DFHEIV0(25:11)
 16537     CALL 'kxdfhei1' USING DFHEIV0,
 16538           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 323
* EL156.cbl
 16539           DFHEIV11,
 16540           GETMAIN-SPACE
 16541     SET ADDRESS OF CERT-NOTE-FILE TO
 16542         DFHEIV20
 16543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16544
 16545
 16546     ADD +1                      TO WRK-NOTE-SEQ.
 16547     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 16548     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 16549     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 16550     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 16551     MOVE CL-CERT-STATE          TO CZ-STATE.
 16552     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 16553     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 16554     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 16555     MOVE '2'                    TO CZ-RECORD-TYPE.
 16556     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 16557     MOVE 'CZ'                   TO CZ-RECORD-ID.
 16558     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 16559     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 16560     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 16561     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 16562
 16563 7191-WRITE.
 16564
 16565
 16566* EXEC CICS WRITE
 16567*         DATASET     ('ERCNOT')
 16568*         FROM        (CERT-NOTE-FILE)
 16569*         RIDFLD      (CZ-CONTROL-PRIMARY)
 16570*         RESP        (WS-RESPONSE)
 16571*    END-EXEC.
 16572     MOVE LENGTH OF
 16573      CERT-NOTE-FILE
 16574       TO DFHEIV11
 16575     MOVE 'ERCNOT' TO DFHEIV1
 16576*    MOVE '&$ L                  ''  N#00015195' TO DFHEIV0
 16577     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16579     MOVE X'204E233030303135313935' TO DFHEIV0(25:11)
 16580     CALL 'kxdfhei1' USING DFHEIV0,
 16581           DFHEIV1,
 16582           CERT-NOTE-FILE,
 16583           DFHEIV11,
 16584           CZ-CONTROL-PRIMARY,
 16585           DFHEIV99,
 16586           DFHEIV99
 16587     MOVE EIBRESP  TO WS-RESPONSE
 16588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16589
 16590
 16591     IF WS-RESP-DUPREC
 16592         GO TO 7192-DUPREC
 16593     END-IF.
 16594
 16595     GO TO 7199-EXIT.
 16596
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 324
* EL156.cbl
 16597 7192-DUPREC.
 16598
 16599     ADD +1                      TO  WRK-NOTE-SEQ.
 16600     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 16601     GO TO 7191-WRITE.
 16602
 16603 7199-EXIT.
 16604      EXIT.
 16605 7200-FIND-BENEFIT.
 16606     MOVE 'N' TO WS-BEN-SEARCH-SW.
 16607
 16608
 16609* EXEC CICS HANDLE CONDITION
 16610*        ENDFILE(7200-EXIT)
 16611*        NOTFND(7200-EXIT)
 16612*    END-EXEC.
 16613*    MOVE '"$''I                  ! : #00015219' TO DFHEIV0
 16614     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16616     MOVE X'3A20233030303135323139' TO DFHEIV0(25:11)
 16617     CALL 'kxdfhei1' USING DFHEIV0
 16618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16619
 16620
 16621
 16622* EXEC CICS READ
 16623*        DATASET('ELCNTL')
 16624*        SET(ADDRESS OF CONTROL-FILE)
 16625*        RIDFLD(ELCNTL-KEY)
 16626*        GTEQ
 16627*    END-EXEC.
 16628     MOVE 'ELCNTL' TO DFHEIV1
 16629*    MOVE '&"S        G          (   #00015224' TO DFHEIV0
 16630     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16632     MOVE X'2020233030303135323234' TO DFHEIV0(25:11)
 16633     CALL 'kxdfhei1' USING DFHEIV0,
 16634           DFHEIV1,
 16635           DFHEIV20,
 16636           DFHEIV99,
 16637           ELCNTL-KEY,
 16638           DFHEIV99,
 16639           DFHEIV99,
 16640           DFHEIV99
 16641     SET ADDRESS OF CONTROL-FILE TO
 16642         DFHEIV20
 16643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16644
 16645
 16646     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 16647        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 16648           GO TO 7200-EXIT.
 16649
 16650     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 16651         VARYING SUB-1 FROM 1 BY 1 UNTIL
 16652            ((SUB-1 > 8) OR
 16653            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 16654
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 325
* EL156.cbl
 16655     IF SUB-1 NOT = 9
 16656         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 16657
 16658     GO TO 7200-EXIT.
 16659
 16660 7200-BENEFIT-DUMMY.
 16661
 16662 7200-DUMMY-EXIT.
 16663     EXIT.
 16664
 16665 7200-EXIT.
 16666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 326
* EL156.cbl
 16668*052506
 16669*052506 7250-FIND-LETTER-TRLR.
 16670*052506     EXEC CICS HANDLE CONDITION
 16671*052506         ENDFILE  (7250-END)
 16672*052506         NOTFND   (7250-END)
 16673*052506     END-EXEC.
 16674*052506
 16675*052506     EXEC CICS STARTBR
 16676*052506         DATASET   ('ELTRLR')
 16677*052506         RIDFLD    (ELTRLR-KEY)
 16678*052506         GTEQ
 16679*052506     END-EXEC.
 16680*052506
 16681*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 16682*052506
 16683*052506 7250-FIND-LOOP.
 16684*052506     EXEC CICS READNEXT
 16685*052506         DATASET   ('ELTRLR')
 16686*052506         RIDFLD    (ELTRLR-KEY)
 16687*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16688*052506     END-EXEC.
 16689*052506
 16690*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 16691*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 16692*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 16693*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 16694*052506        GO TO 7250-END
 16695*052506     END-IF.
 16696*052506
 16697*052506     IF AT-TRAILER-TYPE NOT = '4'
 16698*052506         GO TO 7250-FIND-LOOP
 16699*052506     END-IF.
 16700*052506
 16701*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 16702*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 16703*052506     END-IF.
 16704*052506
 16705*052506     GO TO 7250-FIND-LOOP.
 16706*052506
 16707*052506 7250-END.
 16708*052506
 16709*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 16710*051506         MOVE SPACES             TO  DC-OPTION-CODE
 16711*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 16712*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16713*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 16714*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 16715*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 16716*052506     END-IF.
 16717*052506
 16718*052506     EXEC CICS ENDBR
 16719*052506          DATASET    ('ELTRLR')
 16720*052506     END-EXEC.
 16721*052506
 16722*052506 7250-EXIT.
 16723*052506     EXIT.
 16724*052506     EJECT
 16725*052506
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 327
* EL156.cbl
 16726 7300-CHECK-AUTO-ACTIVITY.
 16727
 16728     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 16729         NEXT SENTENCE
 16730     ELSE
 16731         GO TO 7399-EXIT.
 16732
 16733     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 16734
 16735     IF WS-ACT-REC-FOUND-SW = 'N'
 16736         GO TO 7399-EXIT.
 16737
 16738     IF PI-ACTIVITY-CODE = 09
 16739         GO TO 7300-CONT-AUTO-ACTIVITY.
 16740
 16741     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 16742        (PI-ACTIVITY-CODE = 11)
 16743         GO TO 7300-CONT-AUTO-ACTIVITY.
 16744
 16745     IF PI-PROVISIONAL-IND = 'P'
 16746         IF PI-PMTTYPE = '1'
 16747             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 16748                 MOVE 'N'    TO  PI-RESET-SW
 16749                 GO TO 7399-EXIT.
 16750
 16751     IF PI-PMTTYPE = '1'
 16752         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 16753             MOVE 'N'        TO  PI-RESET-SW
 16754             GO TO 7399-EXIT.
 16755
 16756     IF PI-PMTTYPE = '2' OR '3'
 16757         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 16758             MOVE 'N'        TO  PI-RESET-SW
 16759             GO TO 7399-EXIT.
 16760
 16761     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16762         IF PI-PROVISIONAL-IND = 'P'
 16763             NEXT SENTENCE
 16764         ELSE
 16765             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 16766
 16767 7300-CONT-AUTO-ACTIVITY.
 16768
 16769     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16770         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 16771         MOVE '4'            TO DC-OPTION-CODE
 16772         MOVE +0             TO DC-ELAPSED-DAYS
 16773                                DC-ELAPSED-MONTHS
 16774         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16775         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 16776         IF PI-USES-PAID-TO
 16777             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16778             IF NO-CONVERSION-ERROR
 16779                 MOVE +1     TO DC-ELAPSED-DAYS
 16780                 MOVE +0     TO DC-ELAPSED-MONTHS
 16781                 MOVE '6'    TO DC-OPTION-CODE
 16782                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16783                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 328
* EL156.cbl
 16784                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16785
 16786     IF PI-PFKEY-USED = DFHPF5
 16787         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 16788         IF PI-USES-PAID-TO
 16789             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 16790             MOVE +1                  TO DC-ELAPSED-DAYS
 16791             MOVE +0                  TO DC-ELAPSED-MONTHS
 16792             MOVE '6'                 TO DC-OPTION-CODE
 16793             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16794             IF NO-CONVERSION-ERROR
 16795                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 16796
 16797     IF WS-CHK-THRU-DT < PI-EXP-DT
 16798         NEXT SENTENCE
 16799     ELSE
 16800         MOVE 03                     TO  WS-ACTIVITY-CODE
 16801         GO TO 7390-PROCESS-ACTIVITY.
 16802
 16803     IF PI-PROV-PMT
 16804         MOVE 09                     TO  WS-ACTIVITY-CODE
 16805     ELSE
 16806        IF PI-PMTTYPE = '1'
 16807            MOVE 02                  TO  WS-ACTIVITY-CODE
 16808        ELSE
 16809        IF PI-PMTTYPE = '2' OR '3'
 16810            MOVE 07                  TO  WS-ACTIVITY-CODE
 16811        ELSE
 16812        IF PI-PMTTYPE = '4'
 16813            MOVE 00                  TO  WS-ACTIVITY-CODE
 16814        ELSE
 16815            MOVE 'N'                 TO  PI-RESET-SW
 16816            GO TO 7399-EXIT.
 16817
 16818 7390-PROCESS-ACTIVITY.
 16819
 16820     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7499-EXIT.
 16821
 16822 7399-EXIT.
 16823     EXIT.
 16824
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 329
* EL156.cbl
 16826 7400-CHECK-AUTO-ACTIVITY.
 16827
 16828
 16829* EXEC CICS HANDLE CONDITION
 16830*        NOTFND   (7400-NOT-FOUND)
 16831*    END-EXEC.
 16832*    MOVE '"$I                   ! ; #00015413' TO DFHEIV0
 16833     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16835     MOVE X'3B20233030303135343133' TO DFHEIV0(25:11)
 16836     CALL 'kxdfhei1' USING DFHEIV0
 16837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16838
 16839
 16840     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 16841     MOVE 'T'                    TO  CNTL-REC-TYPE.
 16842     MOVE SPACES                 TO  CNTL-ACCESS.
 16843     MOVE +0                     TO  CNTL-SEQ-NO.
 16844
 16845
 16846* EXEC CICS READ
 16847*        DATASET   ('ELCNTL')
 16848*        RIDFLD    (ELCNTL-KEY)
 16849*        SET       (ADDRESS OF CONTROL-FILE)
 16850*    END-EXEC.
 16851     MOVE 'ELCNTL' TO DFHEIV1
 16852*    MOVE '&"S        E          (   #00015422' TO DFHEIV0
 16853     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16855     MOVE X'2020233030303135343232' TO DFHEIV0(25:11)
 16856     CALL 'kxdfhei1' USING DFHEIV0,
 16857           DFHEIV1,
 16858           DFHEIV20,
 16859           DFHEIV99,
 16860           ELCNTL-KEY,
 16861           DFHEIV99,
 16862           DFHEIV99,
 16863           DFHEIV99
 16864     SET ADDRESS OF CONTROL-FILE TO
 16865         DFHEIV20
 16866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16867
 16868
 16869     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 16870     GO TO 7400-EXIT.
 16871
 16872 7400-NOT-FOUND.
 16873     MOVE 'N'                        TO  PI-RESET-SW
 16874                                         WS-LETTER-SW
 16875                                         WS-ACT-REC-FOUND-SW.
 16876
 16877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16878
 16879 7400-EXIT.
 16880     EXIT.
 16881
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 330
* EL156.cbl
 16883 7450-FORMAT-AUTO-LETTER.
 16884
 16885     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 16886         MOVE 'Y'                    TO PI-RESET-SW
 16887         GO TO 7450-CONTINUE-PROCESS.
 16888
 16889     MOVE PI-ACTIVITY-CODE           TO  SUB.
 16890
 16891     IF SUB > 9
 16892         SUBTRACT 9 FROM SUB
 16893         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 16894     ELSE
 16895         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 16896
 16897 7450-CONTINUE-PROCESS.
 16898
 16899     IF WS-ACTIVITY-CODE = ZEROS
 16900         MOVE 'N'                    TO  WS-LETTER-SW
 16901         GO TO 7499-EXIT.
 16902
 16903     MOVE WS-ACTIVITY-CODE           TO  SUB.
 16904
 16905     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 16906         MOVE 'N'                    TO  PI-RESET-SW
 16907                                         WS-LETTER-SW
 16908         GO TO 7499-EXIT.
 16909
 16910     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 16911         MOVE 'N'                    TO  WS-LETTER-SW
 16912         GO TO 7499-EXIT.
 16913
 16914     MOVE 'Y'                        TO  WS-LETTER-SW.
 16915     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16916     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16917
 16918     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 16919
 16920     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 16921         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16922         MOVE '6'                    TO  DC-OPTION-CODE
 16923         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 16924         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16925         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16926         IF NO-CONVERSION-ERROR
 16927             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 16928         ELSE
 16929              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 16930
 16931     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 16932         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 16933         MOVE '6'                    TO  DC-OPTION-CODE
 16934         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 16935         MOVE +0                     TO  DC-ELAPSED-MONTHS
 16936         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 16937         IF NO-CONVERSION-ERROR
 16938             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 16939         ELSE
 16940             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 331
* EL156.cbl
 16941
 16942 7499-EXIT.
 16943     EXIT.
 16944
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 332
* EL156.cbl
 16946 7500-RESET-AUTO-ACTIVITY.
 16947
 16948     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 16949     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 16950     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 16951     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 16952     MOVE +100                   TO  TRLR-SEQ-NO.
 16953
 16954 7500-STARTBR-TRLR.
 16955
 16956
 16957* EXEC CICS HANDLE CONDITION
 16958*        ENDFILE  (7590-END)
 16959*        NOTFND   (7590-END)
 16960*    END-EXEC.
 16961*    MOVE '"$''I                  ! < #00015515' TO DFHEIV0
 16962     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16964     MOVE X'3C20233030303135353135' TO DFHEIV0(25:11)
 16965     CALL 'kxdfhei1' USING DFHEIV0
 16966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16967
 16968
 16969
 16970* EXEC CICS STARTBR
 16971*        DATASET   ('ELTRLR')
 16972*        RIDFLD    (ELTRLR-KEY)
 16973*        GTEQ
 16974*    END-EXEC.
 16975     MOVE 'ELTRLR' TO DFHEIV1
 16976     MOVE 0
 16977       TO DFHEIV11
 16978*    MOVE '&,         G          &   #00015520' TO DFHEIV0
 16979     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16981     MOVE X'2020233030303135353230' TO DFHEIV0(25:11)
 16982     CALL 'kxdfhei1' USING DFHEIV0,
 16983           DFHEIV1,
 16984           ELTRLR-KEY,
 16985           DFHEIV99,
 16986           DFHEIV11,
 16987           DFHEIV99
 16988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16989
 16990
 16991     MOVE 'Y'                        TO  WS-BROWSE-SW.
 16992
 16993 7500-READ-NEXT.
 16994
 16995
 16996* EXEC CICS READNEXT
 16997*        DATASET   ('ELTRLR')
 16998*        RIDFLD    (ELTRLR-KEY)
 16999*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17000*    END-EXEC.
 17001     MOVE 'ELTRLR' TO DFHEIV1
 17002     MOVE 0
 17003       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 333
* EL156.cbl
 17004*    MOVE '&.S                   )   #00015530' TO DFHEIV0
 17005     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17007     MOVE X'2020233030303135353330' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0,
 17009           DFHEIV1,
 17010           DFHEIV20,
 17011           DFHEIV99,
 17012           ELTRLR-KEY,
 17013           DFHEIV99,
 17014           DFHEIV11,
 17015           DFHEIV99,
 17016           DFHEIV99
 17017     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17018         DFHEIV20
 17019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17020
 17021
 17022     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 17023        PI-CARRIER    NOT = TRLR-CARRIER  OR
 17024        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 17025        PI-CERT-NO    NOT = TRLR-CERT-NO
 17026         GO TO 7590-END.
 17027
 17028     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 17029         GO TO 7500-READ-NEXT.
 17030
 17031     IF AT-TRAILER-TYPE NOT = '4'
 17032         GO TO 7500-READ-NEXT.
 17033
 17034     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 17035         GO TO 7500-READ-NEXT.
 17036
 17037     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 17038        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 17039         GO TO 7500-READ-NEXT.
 17040
 17041     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 17042        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 17043        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 17044         GO TO 7500-READ-NEXT.
 17045
 17046     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 17047                         AND
 17048        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 17049                         AND
 17050        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 17051            GO TO 7500-READ-NEXT.
 17052
 17053     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 17054
 17055
 17056* EXEC CICS ENDBR
 17057*        DATASET   ('ELTRLR')
 17058*    END-EXEC.
 17059     MOVE 'ELTRLR' TO DFHEIV1
 17060     MOVE 0
 17061       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 334
* EL156.cbl
 17062*    MOVE '&2                    $   #00015569' TO DFHEIV0
 17063     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17064     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17065     MOVE X'2020233030303135353639' TO DFHEIV0(25:11)
 17066     CALL 'kxdfhei1' USING DFHEIV0,
 17067           DFHEIV1,
 17068           DFHEIV11,
 17069           DFHEIV99
 17070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17071
 17072
 17073     MOVE 'N'                        TO  WS-BROWSE-SW.
 17074
 17075
 17076* EXEC CICS READ
 17077*        DATASET   ('ELTRLR')
 17078*        RIDFLD    (ELTRLR-KEY)
 17079*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17080*        UPDATE
 17081*    END-EXEC.
 17082     MOVE 'ELTRLR' TO DFHEIV1
 17083*    MOVE '&"S        EU         (   #00015575' TO DFHEIV0
 17084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17085     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17086     MOVE X'2020233030303135353735' TO DFHEIV0(25:11)
 17087     CALL 'kxdfhei1' USING DFHEIV0,
 17088           DFHEIV1,
 17089           DFHEIV20,
 17090           DFHEIV99,
 17091           ELTRLR-KEY,
 17092           DFHEIV99,
 17093           DFHEIV99,
 17094           DFHEIV99
 17095     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17096         DFHEIV20
 17097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17098
 17099
 17100     MOVE 'Y'                        TO  WS-UPDATE-SW.
 17101
 17102     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 17103         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 17104     ELSE
 17105         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 17106             NEXT SENTENCE
 17107         ELSE
 17108             GO TO 7500-REWRITE-TRLR.
 17109
 17110     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 17111
 17112     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 17113     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 17114     MOVE '1'                        TO  ARCH-REC-TYPE.
 17115     MOVE +0                         TO  ARCH-SEQ.
 17116
 17117     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 17118
 17119 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 335
* EL156.cbl
 17120
 17121
 17122* EXEC CICS REWRITE
 17123*        DATASET   ('ELTRLR')
 17124*        FROM      (ACTIVITY-TRAILERS)
 17125*    END-EXEC.
 17126     MOVE LENGTH OF
 17127      ACTIVITY-TRAILERS
 17128       TO DFHEIV11
 17129     MOVE 'ELTRLR' TO DFHEIV1
 17130*    MOVE '&& L                  %   #00015603' TO DFHEIV0
 17131     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17133     MOVE X'2020233030303135363033' TO DFHEIV0(25:11)
 17134     CALL 'kxdfhei1' USING DFHEIV0,
 17135           DFHEIV1,
 17136           ACTIVITY-TRAILERS,
 17137           DFHEIV11,
 17138           DFHEIV99
 17139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17140
 17141
 17142     GO TO 7500-STARTBR-TRLR.
 17143
 17144 7590-END.
 17145
 17146     IF WS-BROWSE-SW = 'Y'
 17147         MOVE 'N'                    TO  WS-BROWSE-SW
 17148
 17149* EXEC CICS ENDBR
 17150*            DATASET   ('ELTRLR')
 17151*        END-EXEC.
 17152     MOVE 'ELTRLR' TO DFHEIV1
 17153     MOVE 0
 17154       TO DFHEIV11
 17155*    MOVE '&2                    $   #00015614' TO DFHEIV0
 17156     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17157     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17158     MOVE X'2020233030303135363134' TO DFHEIV0(25:11)
 17159     CALL 'kxdfhei1' USING DFHEIV0,
 17160           DFHEIV1,
 17161           DFHEIV11,
 17162           DFHEIV99
 17163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17164
 17165
 17166 7599-EXIT.
 17167     EXIT.
 17168
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 336
* EL156.cbl
 17170 7600-READ-ARCH-UPDATE.
 17171
 17172
 17173* EXEC CICS HANDLE CONDITION
 17174*        NOTFND   (7699-EXIT)
 17175*    END-EXEC.
 17176*    MOVE '"$I                   ! = #00015624' TO DFHEIV0
 17177     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17179     MOVE X'3D20233030303135363234' TO DFHEIV0(25:11)
 17180     CALL 'kxdfhei1' USING DFHEIV0
 17181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17182
 17183
 17184
 17185* EXEC CICS READ
 17186*        DATASET   ('ELARCH')
 17187*        RIDFLD    (ELARCH-KEY)
 17188*        SET       (ADDRESS OF LETTER-ARCHIVE)
 17189*        UPDATE
 17190*    END-EXEC.
 17191     MOVE 'ELARCH' TO DFHEIV1
 17192*    MOVE '&"S        EU         (   #00015628' TO DFHEIV0
 17193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17195     MOVE X'2020233030303135363238' TO DFHEIV0(25:11)
 17196     CALL 'kxdfhei1' USING DFHEIV0,
 17197           DFHEIV1,
 17198           DFHEIV20,
 17199           DFHEIV99,
 17200           ELARCH-KEY,
 17201           DFHEIV99,
 17202           DFHEIV99,
 17203           DFHEIV99
 17204     SET ADDRESS OF LETTER-ARCHIVE TO
 17205         DFHEIV20
 17206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17207
 17208
 17209     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 17210
 17211
 17212* EXEC CICS REWRITE
 17213*        DATASET   ('ELARCH')
 17214*        FROM      (LETTER-ARCHIVE)
 17215*    END-EXEC.
 17216     MOVE LENGTH OF
 17217      LETTER-ARCHIVE
 17218       TO DFHEIV11
 17219     MOVE 'ELARCH' TO DFHEIV1
 17220*    MOVE '&& L                  %   #00015637' TO DFHEIV0
 17221     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17223     MOVE X'2020233030303135363337' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           DFHEIV1,
 17226           LETTER-ARCHIVE,
 17227           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 337
* EL156.cbl
 17228           DFHEIV99
 17229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17230
 17231
 17232 7699-EXIT.
 17233     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 338
* EL156.cbl
 17235 7700-GET-DCT.
 17236
 17237     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 17238     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 17239     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 17240     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 17241                                    PI-MAX-BENEFIT-AMT
 17242                                    PI-MAX-BENEFIT-PYMT
 17243                                    PI-MIN-PAYMENT-AMT
 17244                                    PI-TIME-OF-LOSS-BAL.
 17245
 17246
 17247* EXEC CICS HANDLE CONDITION
 17248*         NOTFND (5300-NOTE-NOT-FOUND)
 17249*     END-EXEC.
 17250*    MOVE '"$I                   ! > #00015656' TO DFHEIV0
 17251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17253     MOVE X'3E20233030303135363536' TO DFHEIV0(25:11)
 17254     CALL 'kxdfhei1' USING DFHEIV0
 17255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17256
 17257
 17258
 17259* EXEC CICS READ
 17260*         DATASET('ERNOTE')
 17261*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 17262*         RIDFLD (W-NOTE-KEY)
 17263*     END-EXEC.
 17264     MOVE 'ERNOTE' TO DFHEIV1
 17265*    MOVE '&"S        E          (   #00015660' TO DFHEIV0
 17266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17268     MOVE X'2020233030303135363630' TO DFHEIV0(25:11)
 17269     CALL 'kxdfhei1' USING DFHEIV0,
 17270           DFHEIV1,
 17271           DFHEIV20,
 17272           DFHEIV99,
 17273           W-NOTE-KEY,
 17274           DFHEIV99,
 17275           DFHEIV99,
 17276           DFHEIV99
 17277     SET ADDRESS OF CERTIFICATE-NOTE TO
 17278         DFHEIV20
 17279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17280
 17281
 17282     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 17283     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 17284     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 17285     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 17286     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 17287
 17288     IF PI-PAYEE-TYPE NOT = 'B'
 17289         GO TO 7700-EXIT.
 17290
 17291     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 17292     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 339
* EL156.cbl
 17293     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 17294
 17295     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 17296         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 17297     ELSE
 17298         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 17299
 17300     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 17301     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 17302     MOVE 'DLO006'               TO PGM-NAME.
 17303
 17304
 17305* EXEC CICS LINK
 17306*        PROGRAM    (PGM-NAME)
 17307*        COMMAREA   (DCT-COMMUNICATION-AREA)
 17308*        LENGTH     (DCT-RCRD-LENGTH)
 17309*    END-EXEC.
 17310*    MOVE '."C                   ''   #00015688' TO DFHEIV0
 17311     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17312     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17313     MOVE X'2020233030303135363838' TO DFHEIV0(25:11)
 17314     CALL 'kxdfhei1' USING DFHEIV0,
 17315           PGM-NAME,
 17316           DCT-COMMUNICATION-AREA,
 17317           DCT-RCRD-LENGTH,
 17318           DFHEIV99,
 17319           DFHEIV99,
 17320           DFHEIV99
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324     IF DCT-RETURN-CODE = 'OK'
 17325         GO TO 7700-CONT.
 17326
 17327     IF DCT-RETURN-CODE = '01' OR '02'
 17328         GO TO 7700-SET-TO-YES.
 17329
 17330     IF DCT-RETURN-CODE = '03'
 17331
 17332* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17333*    MOVE '6"R                   !   #00015701' TO DFHEIV0
 17334     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17336     MOVE X'2020233030303135373031' TO DFHEIV0(25:11)
 17337     CALL 'kxdfhei1' USING DFHEIV0
 17338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17339         MOVE ER-0951            TO EMI-ERROR
 17340         MOVE -1                 TO PMTTYPEL
 17341         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17342         GO TO 8200-SEND-DATAONLY.
 17343
 17344     IF DCT-RETURN-CODE = '04'
 17345
 17346* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17347*    MOVE '6"R                   !   #00015708' TO DFHEIV0
 17348     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17350     MOVE X'2020233030303135373038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 340
* EL156.cbl
 17351     CALL 'kxdfhei1' USING DFHEIV0
 17352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17353         MOVE ER-0946            TO EMI-ERROR
 17354         MOVE -1                 TO PMTTYPEL
 17355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17356         GO TO 8200-SEND-DATAONLY.
 17357
 17358     IF DCT-RETURN-CODE = '05'
 17359
 17360* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17361*    MOVE '6"R                   !   #00015715' TO DFHEIV0
 17362     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17364     MOVE X'2020233030303135373135' TO DFHEIV0(25:11)
 17365     CALL 'kxdfhei1' USING DFHEIV0
 17366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17367         MOVE ER-0947            TO EMI-ERROR
 17368         MOVE -1                 TO PMTTYPEL
 17369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17370         GO TO 8200-SEND-DATAONLY.
 17371
 17372     IF DCT-RETURN-CODE = '06'
 17373
 17374* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17375*    MOVE '6"R                   !   #00015722' TO DFHEIV0
 17376     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17378     MOVE X'2020233030303135373232' TO DFHEIV0(25:11)
 17379     CALL 'kxdfhei1' USING DFHEIV0
 17380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17381         MOVE ER-0921            TO EMI-ERROR
 17382         MOVE -1                 TO PMTTYPEL
 17383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17384         GO TO 8200-SEND-DATAONLY.
 17385
 17386     IF DCT-RETURN-CODE = '07'
 17387
 17388* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17389*    MOVE '6"R                   !   #00015729' TO DFHEIV0
 17390     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17392     MOVE X'2020233030303135373239' TO DFHEIV0(25:11)
 17393     CALL 'kxdfhei1' USING DFHEIV0
 17394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17395         MOVE ER-0919            TO EMI-ERROR
 17396         MOVE -1                 TO PMTTYPEL
 17397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17398         GO TO 8200-SEND-DATAONLY.
 17399
 17400     IF DCT-RETURN-CODE = '08'
 17401
 17402* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17403*    MOVE '6"R                   !   #00015736' TO DFHEIV0
 17404     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17406     MOVE X'2020233030303135373336' TO DFHEIV0(25:11)
 17407     CALL 'kxdfhei1' USING DFHEIV0
 17408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 341
* EL156.cbl
 17409         MOVE ER-0948            TO EMI-ERROR
 17410         MOVE -1                 TO PMTTYPEL
 17411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17412         GO TO 8200-SEND-DATAONLY.
 17413
 17414     IF DCT-RETURN-CODE = 'N1'
 17415
 17416* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17417*    MOVE '6"R                   !   #00015743' TO DFHEIV0
 17418     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17420     MOVE X'2020233030303135373433' TO DFHEIV0(25:11)
 17421     CALL 'kxdfhei1' USING DFHEIV0
 17422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17423         MOVE ER-0950            TO EMI-ERROR
 17424         MOVE -1                 TO PMTTYPEL
 17425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17426         GO TO 8200-SEND-DATAONLY.
 17427
 17428     IF DCT-RETURN-CODE = 'E1'
 17429
 17430* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17431*    MOVE '6"R                   !   #00015750' TO DFHEIV0
 17432     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17434     MOVE X'2020233030303135373530' TO DFHEIV0(25:11)
 17435     CALL 'kxdfhei1' USING DFHEIV0
 17436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17437         MOVE ER-0974            TO EMI-ERROR
 17438         MOVE -1                 TO PMTTYPEL
 17439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17440         GO TO 8200-SEND-DATAONLY.
 17441
 17442     IF DCT-RETURN-CODE = 'E2'
 17443
 17444* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17445*    MOVE '6"R                   !   #00015757' TO DFHEIV0
 17446     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17448     MOVE X'2020233030303135373537' TO DFHEIV0(25:11)
 17449     CALL 'kxdfhei1' USING DFHEIV0
 17450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17451         MOVE ER-0975            TO EMI-ERROR
 17452         MOVE -1                 TO PMTTYPEL
 17453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17454         GO TO 8200-SEND-DATAONLY.
 17455
 17456     IF DCT-RETURN-CODE NOT = 'OK'
 17457
 17458* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 17459*    MOVE '6"R                   !   #00015764' TO DFHEIV0
 17460     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17462     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 17463     CALL 'kxdfhei1' USING DFHEIV0
 17464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17465         MOVE ER-0949            TO EMI-ERROR
 17466         MOVE -1                 TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 342
* EL156.cbl
 17467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17468         GO TO 8200-SEND-DATAONLY.
 17469
 17470 7700-CONT.
 17471
 17472     MOVE 'N'                    TO CASHO.
 17473     MOVE +1                     TO CASHL.
 17474     MOVE AL-UANON               TO CASHA.
 17475
 17476     IF PI-OFFLINE = 'Y'
 17477         GO TO 7700-EXIT.
 17478
 17479     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 17480     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 17481     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 17482     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 17483     MOVE +7                     TO CHECKNOL.
 17484     MOVE AL-UANON               TO CHECKNOA.
 17485     GO TO 7700-EXIT.
 17486
 17487 7700-SET-TO-YES.
 17488
 17489     MOVE 'Y'                    TO CASHO.
 17490     MOVE +1                     TO CASHL.
 17491     MOVE AL-UANON               TO CASHA.
 17492
 17493 7700-EXIT.
 17494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 343
* EL156.cbl
 17496 7800-READ-COMP-MSTR.
 17497
 17498
 17499* EXEC CICS HANDLE CONDITION
 17500*        NOTFND   (7800-COMP-NOTFND)
 17501*    END-EXEC.
 17502*    MOVE '"$I                   ! ? #00015798' TO DFHEIV0
 17503     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17505     MOVE X'3F20233030303135373938' TO DFHEIV0(25:11)
 17506     CALL 'kxdfhei1' USING DFHEIV0
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510
 17511* EXEC CICS READ
 17512*        DATASET   ('ERCOMP')
 17513*        RIDFLD    (ERCOMP-KEY)
 17514*        SET       (ADDRESS OF COMPENSATION-MASTER)
 17515*    END-EXEC.
 17516     MOVE 'ERCOMP' TO DFHEIV1
 17517*    MOVE '&"S        E          (   #00015802' TO DFHEIV0
 17518     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17519     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17520     MOVE X'2020233030303135383032' TO DFHEIV0(25:11)
 17521     CALL 'kxdfhei1' USING DFHEIV0,
 17522           DFHEIV1,
 17523           DFHEIV20,
 17524           DFHEIV99,
 17525           ERCOMP-KEY,
 17526           DFHEIV99,
 17527           DFHEIV99,
 17528           DFHEIV99
 17529     SET ADDRESS OF COMPENSATION-MASTER TO
 17530         DFHEIV20
 17531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17532
 17533
 17534     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 17535     GO TO 7800-COMP-EXIT.
 17536
 17537 7800-COMP-NOTFND.
 17538     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 17539
 17540 7800-COMP-EXIT.
 17541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 344
* EL156.cbl
 17543 7900-READ-CLAIM.
 17544
 17545* EXEC CICS READ
 17546*        DATASET  ('ELMSTR')
 17547*        SET      (ADDRESS OF CLAIM-MASTER)
 17548*        RIDFLD   (ELMSTR-KEY)
 17549*    END-EXEC.
 17550     MOVE 'ELMSTR' TO DFHEIV1
 17551*    MOVE '&"S        E          (   #00015818' TO DFHEIV0
 17552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17554     MOVE X'2020233030303135383138' TO DFHEIV0(25:11)
 17555     CALL 'kxdfhei1' USING DFHEIV0,
 17556           DFHEIV1,
 17557           DFHEIV20,
 17558           DFHEIV99,
 17559           ELMSTR-KEY,
 17560           DFHEIV99,
 17561           DFHEIV99,
 17562           DFHEIV99
 17563     SET ADDRESS OF CLAIM-MASTER TO
 17564         DFHEIV20
 17565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17566
 17567
 17568 7900-EXIT.
 17569      EXIT.
 17570
 17571 7910-READ-CLAIM-UPDATE.
 17572
 17573* EXEC CICS READ
 17574*        DATASET  ('ELMSTR')
 17575*        SET      (ADDRESS OF CLAIM-MASTER)
 17576*        RIDFLD   (ELMSTR-KEY)
 17577*        UPDATE
 17578*    END-EXEC.
 17579     MOVE 'ELMSTR' TO DFHEIV1
 17580*    MOVE '&"S        EU         (   #00015828' TO DFHEIV0
 17581     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17582     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17583     MOVE X'2020233030303135383238' TO DFHEIV0(25:11)
 17584     CALL 'kxdfhei1' USING DFHEIV0,
 17585           DFHEIV1,
 17586           DFHEIV20,
 17587           DFHEIV99,
 17588           ELMSTR-KEY,
 17589           DFHEIV99,
 17590           DFHEIV99,
 17591           DFHEIV99
 17592     SET ADDRESS OF CLAIM-MASTER TO
 17593         DFHEIV20
 17594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17595
 17596
 17597 7910-EXIT.
 17598      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 345
* EL156.cbl
 17600 7920-READ-BENE.
 17601     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 17602     MOVE 'B'                TO BENE-RECORD-TYPE.
 17603     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 17604
 17605     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17606        IF PI-PAYEE-TYPE    = 'B' AND
 17607           PI-PAYEE-SEQ-NUM = 9
 17608             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 17609             MOVE WS-A-BENE           TO BENE-NUMBER.
 17610
 17611
 17612* EXEC CICS HANDLE CONDITION
 17613*        NOTFND   (7920-NOT-FOUND)
 17614*    END-EXEC.
 17615*    MOVE '"$I                   ! @ #00015849' TO DFHEIV0
 17616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17618     MOVE X'4020233030303135383439' TO DFHEIV0(25:11)
 17619     CALL 'kxdfhei1' USING DFHEIV0
 17620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17621
 17622
 17623
 17624* EXEC CICS READ
 17625*        DATASET  ('ELBENE')
 17626*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 17627*        RIDFLD   (ELBENE-KEY)
 17628*    END-EXEC.
 17629     MOVE 'ELBENE' TO DFHEIV1
 17630*    MOVE '&"S        E          (   #00015853' TO DFHEIV0
 17631     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17632     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17633     MOVE X'2020233030303135383533' TO DFHEIV0(25:11)
 17634     CALL 'kxdfhei1' USING DFHEIV0,
 17635           DFHEIV1,
 17636           DFHEIV20,
 17637           DFHEIV99,
 17638           ELBENE-KEY,
 17639           DFHEIV99,
 17640           DFHEIV99,
 17641           DFHEIV99
 17642     SET ADDRESS OF BENEFICIARY-MASTER TO
 17643         DFHEIV20
 17644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17645
 17646
 17647     MOVE 'Y' TO BENE-FOUND-SW.
 17648     GO TO 7920-EXIT.
 17649
 17650 7920-NOT-FOUND.
 17651     MOVE 'N'                    TO BENE-FOUND-SW.
 17652
 17653 7920-EXIT.
 17654      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 346
* EL156.cbl
 17656 7930-READ-CONTROL.
 17657
 17658* EXEC CICS READ
 17659*        DATASET  ('ELCNTL')
 17660*        SET      (ADDRESS OF CONTROL-FILE)
 17661*        RIDFLD   (ELCNTL-KEY)
 17662*    END-EXEC.
 17663     MOVE 'ELCNTL' TO DFHEIV1
 17664*    MOVE '&"S        E          (   #00015869' TO DFHEIV0
 17665     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17666     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17667     MOVE X'2020233030303135383639' TO DFHEIV0(25:11)
 17668     CALL 'kxdfhei1' USING DFHEIV0,
 17669           DFHEIV1,
 17670           DFHEIV20,
 17671           DFHEIV99,
 17672           ELCNTL-KEY,
 17673           DFHEIV99,
 17674           DFHEIV99,
 17675           DFHEIV99
 17676     SET ADDRESS OF CONTROL-FILE TO
 17677         DFHEIV20
 17678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17679
 17680
 17681 7930-EXIT.
 17682      EXIT.
 17683
 17684 7940-READ-CONTROL-UPDATE.
 17685
 17686* EXEC CICS READ
 17687*        DATASET  ('ELCNTL')
 17688*        SET      (ADDRESS OF CONTROL-FILE)
 17689*        RIDFLD   (ELCNTL-KEY)
 17690*        UPDATE
 17691*    END-EXEC.
 17692     MOVE 'ELCNTL' TO DFHEIV1
 17693*    MOVE '&"S        EU         (   #00015879' TO DFHEIV0
 17694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17695     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17696     MOVE X'2020233030303135383739' TO DFHEIV0(25:11)
 17697     CALL 'kxdfhei1' USING DFHEIV0,
 17698           DFHEIV1,
 17699           DFHEIV20,
 17700           DFHEIV99,
 17701           ELCNTL-KEY,
 17702           DFHEIV99,
 17703           DFHEIV99,
 17704           DFHEIV99
 17705     SET ADDRESS OF CONTROL-FILE TO
 17706         DFHEIV20
 17707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17708
 17709
 17710 7940-EXIT.
 17711      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 347
* EL156.cbl
 17713 7950-READ-TRAILER.
 17714
 17715* EXEC CICS READ
 17716*        DATASET  ('ELTRLR')
 17717*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17718*        RIDFLD   (ELTRLR-KEY)
 17719*    END-EXEC.
 17720     MOVE 'ELTRLR' TO DFHEIV1
 17721*    MOVE '&"S        E          (   #00015890' TO DFHEIV0
 17722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17724     MOVE X'2020233030303135383930' TO DFHEIV0(25:11)
 17725     CALL 'kxdfhei1' USING DFHEIV0,
 17726           DFHEIV1,
 17727           DFHEIV20,
 17728           DFHEIV99,
 17729           ELTRLR-KEY,
 17730           DFHEIV99,
 17731           DFHEIV99,
 17732           DFHEIV99
 17733     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17734         DFHEIV20
 17735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17736
 17737
 17738 7950-EXIT.
 17739      EXIT.
 17740
 17741 7960-READ-TRAILER-UPDATE.
 17742
 17743* EXEC CICS READ
 17744*        DATASET  ('ELTRLR')
 17745*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17746*        RIDFLD   (ELTRLR-KEY)
 17747*        UPDATE
 17748*    END-EXEC.
 17749     MOVE 'ELTRLR' TO DFHEIV1
 17750*    MOVE '&"S        EU         (   #00015900' TO DFHEIV0
 17751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17752     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17753     MOVE X'2020233030303135393030' TO DFHEIV0(25:11)
 17754     CALL 'kxdfhei1' USING DFHEIV0,
 17755           DFHEIV1,
 17756           DFHEIV20,
 17757           DFHEIV99,
 17758           ELTRLR-KEY,
 17759           DFHEIV99,
 17760           DFHEIV99,
 17761           DFHEIV99
 17762     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17763         DFHEIV20
 17764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17765
 17766
 17767 7960-EXIT.
 17768      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 348
* EL156.cbl
 17770 7970-READ-CERT.
 17771
 17772* EXEC CICS READ
 17773*        DATASET  ('ELCERT')
 17774*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17775*        RIDFLD   (ELCERT-KEY)
 17776*    END-EXEC.
 17777     MOVE 'ELCERT' TO DFHEIV1
 17778*    MOVE '&"S        E          (   #00015911' TO DFHEIV0
 17779     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17781     MOVE X'2020233030303135393131' TO DFHEIV0(25:11)
 17782     CALL 'kxdfhei1' USING DFHEIV0,
 17783           DFHEIV1,
 17784           DFHEIV20,
 17785           DFHEIV99,
 17786           ELCERT-KEY,
 17787           DFHEIV99,
 17788           DFHEIV99,
 17789           DFHEIV99
 17790     SET ADDRESS OF CERTIFICATE-MASTER TO
 17791         DFHEIV20
 17792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17793
 17794
 17795 7970-EXIT.
 17796      EXIT.
 17797
 17798 7980-READ-CERT-UPDATE.
 17799
 17800* EXEC CICS READ
 17801*        DATASET  ('ELCERT')
 17802*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 17803*        RIDFLD   (ELCERT-KEY)
 17804*        UPDATE
 17805*    END-EXEC.
 17806     MOVE 'ELCERT' TO DFHEIV1
 17807*    MOVE '&"S        EU         (   #00015921' TO DFHEIV0
 17808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17809     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17810     MOVE X'2020233030303135393231' TO DFHEIV0(25:11)
 17811     CALL 'kxdfhei1' USING DFHEIV0,
 17812           DFHEIV1,
 17813           DFHEIV20,
 17814           DFHEIV99,
 17815           ELCERT-KEY,
 17816           DFHEIV99,
 17817           DFHEIV99,
 17818           DFHEIV99
 17819     SET ADDRESS OF CERTIFICATE-MASTER TO
 17820         DFHEIV20
 17821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17822
 17823
 17824 7980-EXIT.
 17825      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 349
* EL156.cbl
 17827 8000-LOAD-ERROR-MESSAGES.
 17828     IF PI-PASS-SW = 'C'
 17829        MOVE EMI-LINE1           TO ERMSG1BO
 17830     ELSE
 17831        MOVE EMI-LINE1           TO ERRMSG1O
 17832        MOVE EMI-LINE2           TO ERRMSG2O.
 17833
 17834 8000-EXIT.
 17835     EXIT.
 17836
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 350
* EL156.cbl
 17838
 17839 8010-DMD-ERROR-CHECKS.
 17840     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 17841
 17842     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 17843         GO TO 8051-ISSUE-ERROR.
 17844
 17845     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 17846     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 17847     MOVE '3'                    TO DC-OPTION-CODE.
 17848     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17849     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 17850         GO TO 8051-ISSUE-ERROR.
 17851
 17852     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 17853       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 17854                           OR
 17855          (CL-SSN-STATE   = CL-CERT-STATE  AND
 17856           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 17857             MOVE ER-0851         TO EMI-ERROR
 17858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17859       END-IF
 17860       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 17861             MOVE ER-8147         TO EMI-ERROR
 17862             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17863
 17864     GO TO 8090-EXIT.
 17865
 17866 8051-ISSUE-ERROR.
 17867     MOVE ER-8146            TO EMI-ERROR.
 17868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17869     GO TO 8090-EXIT.
 17870
 17871 8090-EXIT.
 17872      EXIT.
 17873
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 351
* EL156.cbl
 17875 8100-SEND-INITIAL-MAP.
 17876
 17877     MOVE SAVE-DATE              TO RUNDTEAO.
 17878     MOVE EIBTIME                TO TIME-IN.
 17879     MOVE TIME-OUT               TO RUNTIMAO.
 17880     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17881
 17882     IF MAP-NAME = 'EL156A'
 17883        IF PI-COMPANY-ID = 'CID' OR 'DCC'
 17884           MOVE 'PF6=EOB CODES'  TO PF6TITO
 17885        END-IF
 17886     END-IF
 17887     IF MAP-NAME = 'EL156A'
 17888        IF PI-COMPANY-ID = 'CRI'
 17889           NEXT SENTENCE
 17890        ELSE
 17891           MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 17892
 17893     IF MAP-NAME = 'EL156A'
 17894        IF PI-COMPANY-ID = 'BOA' OR 'CID'
 17895           NEXT SENTENCE
 17896        ELSE
 17897           MOVE AL-SADOF TO  PINTA    PINTHA.
 17898
 17899     IF MAP-NAME = 'EL156A'
 17900        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17901            NEXT SENTENCE
 17902        ELSE
 17903           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 17904
 17905     IF MAP-NAME = 'EL156A'
 17906        IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 17907           NEXT SENTENCE
 17908        ELSE
 17909           MOVE AL-SADOF TO CASHHA CASHA.
 17910
 17911     IF MAP-NAME = 'EL156A'
 17912        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC'
 17913           NEXT SENTENCE
 17914        ELSE
 17915           MOVE AL-SADOF        TO  LOANHA
 17916                                    LOANNOA.
 17917
 17918     IF MAP-NAME = 'EL156A'
 17919        MOVE -1                 TO  ENTERPFL
 17920        IF PI-USES-PAID-TO
 17921           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17922           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17923           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17924        ELSE
 17925           NEXT SENTENCE
 17926     ELSE
 17927        IF MAP-NAME = 'EL156B'
 17928           IF PI-USES-PAID-TO
 17929              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 17930              MOVE PMT-HEAD-B     TO PMTHDGBO.
 17931
 17932
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 352
* EL156.cbl
 17933* EXEC CICS SEND
 17934*        MAP   (MAP-NAME)
 17935*        MAPSET(MAPSET-NAME)
 17936*        FROM  (EL156AI)
 17937*        ERASE
 17938*        CURSOR
 17939*    END-EXEC.
 17940     MOVE LENGTH OF
 17941      EL156AI
 17942       TO DFHEIV12
 17943     MOVE -1
 17944       TO DFHEIV11
 17945*    MOVE '8$     CT  E    H L F ,   #00016036' TO DFHEIV0
 17946     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17947     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17948     MOVE X'2020233030303136303336' TO DFHEIV0(25:11)
 17949     CALL 'kxdfhei1' USING DFHEIV0,
 17950           MAP-NAME,
 17951           EL156AI,
 17952           DFHEIV12,
 17953           MAPSET-NAME,
 17954           DFHEIV99,
 17955           DFHEIV99,
 17956           DFHEIV99,
 17957           DFHEIV11,
 17958           DFHEIV99,
 17959           DFHEIV99,
 17960           DFHEIV99
 17961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17962
 17963
 17964     GO TO 9100-RETURN-TRAN.
 17965
 17966 8200-SEND-DATAONLY.
 17967
 17968     IF FIRST-ENTRY = 'Y'
 17969         GO TO 8100-SEND-INITIAL-MAP.
 17970
 17971     IF RETURNED-FROM-B = 'Y'
 17972         GO TO 8100-SEND-INITIAL-MAP.
 17973
 17974     MOVE SAVE-DATE              TO RUNDTEAO.
 17975     MOVE EIBTIME                TO TIME-IN.
 17976     MOVE TIME-OUT               TO RUNTIMAO.
 17977
 17978     IF EIBAID = DFHPF11
 17979        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 17980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17981        MOVE 'EL001   '          TO RETURNED-FROM
 17982        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 17983        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 17984        GO TO 8100-SEND-INITIAL-MAP.
 17985
 17986     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 17987
 17988     IF MAP-NAME =  'EL156A'
 17989        MOVE -1                 TO  ENTERPFL
 17990        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 353
* EL156.cbl
 17991           MOVE 'PAID TO DATE :' TO PTHRHDGO
 17992           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 17993           MOVE PMT-HEAD-A      TO  PMTHDGAO
 17994        ELSE
 17995           NEXT SENTENCE
 17996     ELSE
 17997        IF MAP-NAME = 'EL156B'
 17998           IF PI-USES-PAID-TO
 17999              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 18000              MOVE PMT-HEAD-B     TO PMTHDGBO.
 18001
 18002     IF MAP-NAME =  'EL156A'
 18003        IF PI-COMPANY-ID = 'BOA'
 18004            IF PI-INT-RATE NUMERIC
 18005                MOVE PI-INT-RATE TO PINTO.
 18006     IF MAP-NAME = 'EL156A'
 18007        IF PI-COMPANY-ID = 'CID' OR 'DCC'
 18008           MOVE 'PF6=EOB CODES'  TO PF6TITO
 18009*          MOVE 'Y'              TO EOBYNO
 18010        END-IF
 18011     END-IF
 18012
 18013
 18014* EXEC CICS SEND
 18015*        MAP   (MAP-NAME)
 18016*        MAPSET(MAPSET-NAME)
 18017*        FROM  (EL156AI)
 18018*        DATAONLY
 18019*        CURSOR
 18020*    END-EXEC.
 18021     MOVE LENGTH OF
 18022      EL156AI
 18023       TO DFHEIV12
 18024     MOVE -1
 18025       TO DFHEIV11
 18026*    MOVE '8$D    CT       H L F ,   #00016093' TO DFHEIV0
 18027     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 18028     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 18029     MOVE X'2020233030303136303933' TO DFHEIV0(25:11)
 18030     CALL 'kxdfhei1' USING DFHEIV0,
 18031           MAP-NAME,
 18032           EL156AI,
 18033           DFHEIV12,
 18034           MAPSET-NAME,
 18035           DFHEIV99,
 18036           DFHEIV99,
 18037           DFHEIV99,
 18038           DFHEIV11,
 18039           DFHEIV99,
 18040           DFHEIV99,
 18041           DFHEIV99
 18042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18043
 18044
 18045     GO TO 9100-RETURN-TRAN.
 18046
 18047 8300-SEND-TEXT.
 18048
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 354
* EL156.cbl
 18049* EXEC CICS SEND TEXT
 18050*        FROM(LOGOFF-TEXT)
 18051*        LENGTH(LOGOFF-LENGTH)
 18052*        ERASE
 18053*        FREEKB
 18054*    END-EXEC.
 18055*    MOVE '8&      T  E F  H   F -   #00016104' TO DFHEIV0
 18056     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 18057     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 18058     MOVE X'2020233030303136313034' TO DFHEIV0(25:11)
 18059     CALL 'kxdfhei1' USING DFHEIV0,
 18060           LOGOFF-TEXT,
 18061           LOGOFF-LENGTH,
 18062           DFHEIV99,
 18063           DFHEIV99,
 18064           DFHEIV99,
 18065           DFHEIV99,
 18066           DFHEIV99,
 18067           DFHEIV99,
 18068           DFHEIV99,
 18069           DFHEIV99,
 18070           DFHEIV99,
 18071           DFHEIV99
 18072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18073
 18074
 18075
 18076* EXEC CICS RETURN
 18077*    END-EXEC.
 18078*    MOVE '.(                    &   #00016111' TO DFHEIV0
 18079     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 18080     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18081     MOVE X'2020233030303136313131' TO DFHEIV0(25:11)
 18082     CALL 'kxdfhei1' USING DFHEIV0,
 18083           DFHEIV99,
 18084           DFHEIV99,
 18085           DFHEIV99,
 18086           DFHEIV99,
 18087           DFHEIV99
 18088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18089
 18090
 18091 8500-FILE-NOTOPEN.
 18092     IF FILE-SWITCH = 'MSTR'
 18093         MOVE ER-0154            TO EMI-ERROR.
 18094     IF FILE-SWITCH = 'TRLR'
 18095         MOVE ER-0172            TO EMI-ERROR.
 18096     IF FILE-SWITCH = 'CERT'
 18097         MOVE ER-0169            TO EMI-ERROR.
 18098     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 18099                      'PROC' OR 'STAT'
 18100         MOVE ER-0042            TO EMI-ERROR.
 18101     IF FILE-SWITCH = 'ACTQ'
 18102         MOVE ER-0338            TO EMI-ERROR.
 18103     IF FILE-SWITCH = 'ACCT'
 18104         MOVE ER-0168            TO EMI-ERROR.
 18105
 18106     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 355
* EL156.cbl
 18107     MOVE -1                     TO PMTTYPEL.
 18108
 18109     IF FIRST-ENTRY = 'Y'
 18110         GO TO 8100-SEND-INITIAL-MAP.
 18111
 18112     GO TO 8200-SEND-DATAONLY.
 18113
 18114 8600-PGRM-NOT-FOUND.
 18115
 18116     MOVE ER-0923                TO EMI-ERROR.
 18117     MOVE -1                     TO ENTPFBL.
 18118     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18119
 18120     IF FIRST-ENTRY = 'Y'
 18121         GO TO 8100-SEND-INITIAL-MAP
 18122     ELSE
 18123         GO TO 8200-SEND-DATAONLY.
 18124
 18125 8800-UNAUTHORIZED-ACCESS.
 18126     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 18127     GO TO 8300-SEND-TEXT.
 18128
 18129 8810-PF23.
 18130     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 18131     MOVE XCTL-005               TO PGM-NAME.
 18132     GO TO 9300-XCTL.
 18133
 18134 8820-PF7-8.
 18135     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 18136     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 18137                                    PI-SAVED-PROGRAM-2
 18138                                    PI-SAVED-PROGRAM-3
 18139                                    PI-SAVED-PROGRAM-4
 18140                                    PI-SAVED-PROGRAM-5
 18141                                    PI-SAVED-PROGRAM-6
 18142                                    PI-RETURN-TO-PROGRAM.
 18143     IF EIBAID = DFHPF8
 18144        MOVE XCTL-132            TO PGM-NAME
 18145     ELSE
 18146        MOVE XCTL-130            TO PGM-NAME.
 18147
 18148     GO TO 9300-XCTL.
 18149
 18150 9100-RETURN-TRAN.
 18151     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 18152     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 18153
 18154
 18155* EXEC CICS RETURN
 18156*        TRANSID(TRANS-ID)
 18157*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18158*        LENGTH(PI-COMM-LENGTH)
 18159*    END-EXEC.
 18160*    MOVE '.(CT                  &   #00016177' TO DFHEIV0
 18161     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 18162     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18163     MOVE X'2020233030303136313737' TO DFHEIV0(25:11)
 18164     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 356
* EL156.cbl
 18165           TRANS-ID,
 18166           PROGRAM-INTERFACE-BLOCK,
 18167           PI-COMM-LENGTH,
 18168           DFHEIV99,
 18169           DFHEIV99
 18170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18171
 18172
 18173 9200-RETURN-MAIN-MENU.
 18174     MOVE XCTL-126               TO PGM-NAME.
 18175     GO TO 9300-XCTL.
 18176
 18177 9300-XCTL.
 18178
 18179* EXEC CICS XCTL
 18180*        PROGRAM(PGM-NAME)
 18181*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 18182*        LENGTH(PI-COMM-LENGTH)
 18183*    END-EXEC.
 18184*    MOVE '.$C                   $   #00016188' TO DFHEIV0
 18185     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 18186     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18187     MOVE X'2020233030303136313838' TO DFHEIV0(25:11)
 18188     CALL 'kxdfhei1' USING DFHEIV0,
 18189           PGM-NAME,
 18190           PROGRAM-INTERFACE-BLOCK,
 18191           PI-COMM-LENGTH
 18192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18193
 18194
 18195 9400-CLEAR.
 18196     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 18197     GO TO 9300-XCTL.
 18198
 18199 9500-PF12.
 18200     MOVE XCTL-010               TO PGM-NAME.
 18201     GO TO 9300-XCTL.
 18202
 18203 9700-LINK-DATE-CONVERT.
 18204     MOVE LINK-ELDATCV           TO PGM-NAME.
 18205
 18206* EXEC CICS LINK
 18207*        PROGRAM   (PGM-NAME)
 18208*        COMMAREA  (DATE-CONVERSION-DATA)
 18209*        LENGTH    (DC-COMM-LENGTH)
 18210*    END-EXEC.
 18211*    MOVE '."C                   ''   #00016204' TO DFHEIV0
 18212     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18213     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18214     MOVE X'2020233030303136323034' TO DFHEIV0(25:11)
 18215     CALL 'kxdfhei1' USING DFHEIV0,
 18216           PGM-NAME,
 18217           DATE-CONVERSION-DATA,
 18218           DC-COMM-LENGTH,
 18219           DFHEIV99,
 18220           DFHEIV99,
 18221           DFHEIV99
 18222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 357
* EL156.cbl
 18223
 18224
 18225 9700-EXIT.
 18226     EXIT.
 18227
 18228 9800-LINK-REM-TERM.
 18229     MOVE LINK-REMTERM TO PGM-NAME.
 18230
 18231
 18232* EXEC CICS LINK
 18233*        PROGRAM   (PGM-NAME)
 18234*        COMMAREA  (CALCULATION-PASS-AREA)
 18235*        LENGTH    (CP-COMM-LENGTH)
 18236*    END-EXEC.
 18237*    MOVE '."C                   ''   #00016216' TO DFHEIV0
 18238     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18240     MOVE X'2020233030303136323136' TO DFHEIV0(25:11)
 18241     CALL 'kxdfhei1' USING DFHEIV0,
 18242           PGM-NAME,
 18243           CALCULATION-PASS-AREA,
 18244           CP-COMM-LENGTH,
 18245           DFHEIV99,
 18246           DFHEIV99,
 18247           DFHEIV99
 18248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18249
 18250
 18251 9800-EXIT.
 18252     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 358
* EL156.cbl
 18254 9830-DMD-REMAINING-TERM.
 18255
 18256     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 18257         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 18258
 18259     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 18260                              CM-PMT-EXTENSION-DAYS.
 18261
 18262     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 18263                                  CL-NO-OF-DAYS-PAID.
 18264
 18265     DIVIDE W-REM-TERM-IN-DAYS BY +30
 18266         GIVING W-REM REMAINDER W-REM-DAYS.
 18267
 18268     MOVE W-REM                  TO WST-REM.
 18269
 18270     IF W-REM-DAYS > ZEROS
 18271         MOVE '/'                TO WST-SLASH
 18272         MOVE W-REM-DAYS         TO WST-REM-DAYS
 18273     ELSE
 18274         MOVE SPACES             TO WST-REM-DAYS-GRP.
 18275
 18276 9830-EXIT.
 18277     EXIT.
 18278
 18279 9870-OUTPUT-ACTIVITY-RECORD.
 18280
 18281
 18282* EXEC CICS GETMAIN
 18283*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 18284*         LENGTH(25)
 18285*         INITIMG(WS-BLANK)
 18286*    END-EXEC.
 18287     MOVE 25
 18288       TO DFHEIV11
 18289*    MOVE ',"IL                  $   #00016252' TO DFHEIV0
 18290     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18291     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18292     MOVE X'2020233030303136323532' TO DFHEIV0(25:11)
 18293     CALL 'kxdfhei1' USING DFHEIV0,
 18294           DFHEIV20,
 18295           DFHEIV11,
 18296           WS-BLANK
 18297     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 18298         DFHEIV20
 18299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18300
 18301
 18302     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 18303     MOVE ELMSTR-KEY             TO DA-KEY.
 18304     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 18305
 18306     IF PI-PMTTYPE EQUAL '7'
 18307         MOVE 'V'                TO DA-RECORD-TYPE
 18308     ELSE
 18309         MOVE 'P'                TO DA-RECORD-TYPE.
 18310
 18311
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 359
* EL156.cbl
 18312* EXEC CICS HANDLE CONDITION
 18313*         NOTOPEN(9870-NOTOPEN)
 18314*         DUPREC(9870-EXIT)
 18315*    END-EXEC.
 18316*    MOVE '"$J%                  ! A #00016267' TO DFHEIV0
 18317     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 18318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18319     MOVE X'4120233030303136323637' TO DFHEIV0(25:11)
 18320     CALL 'kxdfhei1' USING DFHEIV0
 18321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18322
 18323
 18324
 18325* EXEC CICS WRITE
 18326*         DATASET('DLYACTV')
 18327*         RIDFLD(DA-KEY)
 18328*         FROM(DAILY-ACTIVITY-RECORD)
 18329*         LENGTH(25)
 18330*    END-EXEC.
 18331     MOVE 'DLYACTV' TO DFHEIV1
 18332     MOVE 25
 18333       TO DFHEIV11
 18334*    MOVE '&$ L                  ''   #00016272' TO DFHEIV0
 18335     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18336     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18337     MOVE X'2020233030303136323732' TO DFHEIV0(25:11)
 18338     CALL 'kxdfhei1' USING DFHEIV0,
 18339           DFHEIV1,
 18340           DAILY-ACTIVITY-RECORD,
 18341           DFHEIV11,
 18342           DA-KEY,
 18343           DFHEIV99,
 18344           DFHEIV99
 18345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18346
 18347     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 18348     GO TO 9870-EXIT.
 18349
 18350 9870-NOTOPEN.
 18351
 18352     MOVE '2955'                 TO EMI-ERROR.
 18353     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 18354
 18355 9870-EXIT.
 18356     EXIT.
 18357
 18358 9900-ERROR-FORMAT.
 18359
 18360     IF EMI-ERROR = ER-0923
 18361         MOVE PGM-NAME           TO W-CALLED-NAME.
 18362
 18363     MOVE LINK-001      TO PGM-NAME.
 18364     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 18365
 18366
 18367* EXEC CICS LINK
 18368*        PROGRAM (PGM-NAME)
 18369*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 360
* EL156.cbl
 18370*        LENGTH  (EMI-COMM-LENGTH)
 18371*    END-EXEC.
 18372*    MOVE '."C                   ''   #00016297' TO DFHEIV0
 18373     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18374     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18375     MOVE X'2020233030303136323937' TO DFHEIV0(25:11)
 18376     CALL 'kxdfhei1' USING DFHEIV0,
 18377           PGM-NAME,
 18378           ERROR-MESSAGE-INTERFACE-BLOCK,
 18379           EMI-COMM-LENGTH,
 18380           DFHEIV99,
 18381           DFHEIV99,
 18382           DFHEIV99
 18383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18384
 18385
 18386     IF EMI-ERROR = ER-0923
 18387         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 18388
 18389 9900-EXIT.
 18390     EXIT.
 18391
 18392 9990-ABEND.
 18393     MOVE LINK-004               TO PGM-NAME.
 18394     MOVE DFHEIBLK               TO EMI-LINE1.
 18395
 18396* EXEC CICS LINK
 18397*        PROGRAM   (PGM-NAME)
 18398*        COMMAREA  (EMI-LINE1)
 18399*        LENGTH    (64)
 18400*    END-EXEC.
 18401     MOVE 64
 18402       TO DFHEIV11
 18403*    MOVE '."C                   ''   #00016312' TO DFHEIV0
 18404     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18406     MOVE X'2020233030303136333132' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           PGM-NAME,
 18409           EMI-LINE1,
 18410           DFHEIV11,
 18411           DFHEIV99,
 18412           DFHEIV99,
 18413           DFHEIV99
 18414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18415
 18416
 18417     MOVE 'EL156A'               TO  MAP-NAME.
 18418     MOVE LOW-VALUES             TO  EL156AO.
 18419     GO TO 8100-SEND-INITIAL-MAP.
 18420
 18421 9995-SECURITY-VIOLATION.
 18422*    COPY ELCSCTP.
 18423******************************************************************
 18424*                                                                *
 18425*                            ELCSCTP                             *
 18426*                            VMOD=2.001                          *
 18427*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 361
* EL156.cbl
 18428*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 18429******************************************************************
 18430
 18431
 18432     MOVE EIBDATE          TO SM-JUL-DATE.
 18433     MOVE EIBTRMID         TO SM-TERMID.
 18434     MOVE THIS-PGM         TO SM-PGM.
 18435     MOVE EIBTIME          TO TIME-IN.
 18436     MOVE TIME-OUT         TO SM-TIME.
 18437     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 18438
 18439
 18440* EXEC CICS LINK
 18441*         PROGRAM  ('EL003')
 18442*         COMMAREA (SECURITY-MESSAGE)
 18443*         LENGTH   (80)
 18444*    END-EXEC.
 18445     MOVE 'EL003' TO DFHEIV1
 18446     MOVE 80
 18447       TO DFHEIV11
 18448*    MOVE '."C                   ''   #00016340' TO DFHEIV0
 18449     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18450     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18451     MOVE X'2020233030303136333430' TO DFHEIV0(25:11)
 18452     CALL 'kxdfhei1' USING DFHEIV0,
 18453           DFHEIV1,
 18454           SECURITY-MESSAGE,
 18455           DFHEIV11,
 18456           DFHEIV99,
 18457           DFHEIV99,
 18458           DFHEIV99
 18459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18460
 18461
 18462******************************************************************
 18463
 18464
 18465
 18466 9999-DFHBACK SECTION.
 18467     MOVE '9%                    "   ' TO DFHEIV0
 18468     MOVE 'EL156' TO DFHEIV1
 18469     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18470     GOBACK.
 18471 9999-DFHEXIT.
 18472     IF DFHEIGDJ EQUAL 0001
 18473         NEXT SENTENCE
 18474     ELSE IF DFHEIGDJ EQUAL 2
 18475         GO TO 9990-ABEND,
 18476               8600-PGRM-NOT-FOUND,
 18477               0400-FIRST-TIME,
 18478               6180-DUPREC,
 18479               9990-ABEND
 18480         DEPENDING ON DFHEIGDI
 18481     ELSE IF DFHEIGDJ EQUAL 3
 18482         GO TO 0380-CLAIM-END-FILE,
 18483               0380-CLAIM-END-FILE
 18484         DEPENDING ON DFHEIGDI
 18485     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 362
* EL156.cbl
 18486         GO TO 0380-CLAIM-END-FILE,
 18487               0380-CLAIM-END-FILE
 18488         DEPENDING ON DFHEIGDI
 18489     ELSE IF DFHEIGDJ EQUAL 5
 18490         GO TO 0800-EXIT
 18491         DEPENDING ON DFHEIGDI
 18492     ELSE IF DFHEIGDJ EQUAL 6
 18493         GO TO 1950-NOT-FOUND,
 18494               1950-NOT-FOUND
 18495         DEPENDING ON DFHEIGDI
 18496     ELSE IF DFHEIGDJ EQUAL 7
 18497         GO TO 1950-NOT-FOUND
 18498         DEPENDING ON DFHEIGDI
 18499     ELSE IF DFHEIGDJ EQUAL 8
 18500         GO TO 1950-NOT-FOUND,
 18501               1950-NOT-FOUND
 18502         DEPENDING ON DFHEIGDI
 18503     ELSE IF DFHEIGDJ EQUAL 9
 18504         GO TO 1166-END-CHECK,
 18505               1166-END-CHECK
 18506         DEPENDING ON DFHEIGDI
 18507     ELSE IF DFHEIGDJ EQUAL 10
 18508         GO TO 1950-NOT-FOUND,
 18509               1950-NOT-FOUND
 18510         DEPENDING ON DFHEIGDI
 18511     ELSE IF DFHEIGDJ EQUAL 11
 18512         GO TO 1950-NOT-FOUND,
 18513               1950-NOT-FOUND
 18514         DEPENDING ON DFHEIGDI
 18515     ELSE IF DFHEIGDJ EQUAL 12
 18516         GO TO 1950-NOT-FOUND
 18517         DEPENDING ON DFHEIGDI
 18518     ELSE IF DFHEIGDJ EQUAL 13
 18519         GO TO 3600-CONTINUE
 18520         DEPENDING ON DFHEIGDI
 18521     ELSE IF DFHEIGDJ EQUAL 14
 18522         GO TO 5300-NOTE-NOT-FOUND
 18523         DEPENDING ON DFHEIGDI
 18524     ELSE IF DFHEIGDJ EQUAL 15
 18525         GO TO 6065-NOT-FOUND
 18526         DEPENDING ON DFHEIGDI
 18527     ELSE IF DFHEIGDJ EQUAL 16
 18528         GO TO 6068-ACCT-NOT-FND
 18529         DEPENDING ON DFHEIGDI
 18530     ELSE IF DFHEIGDJ EQUAL 17
 18531         GO TO 6074-GET-COMP-DATA
 18532         DEPENDING ON DFHEIGDI
 18533     ELSE IF DFHEIGDJ EQUAL 18
 18534         GO TO 6170-WRITE
 18535         DEPENDING ON DFHEIGDI
 18536     ELSE IF DFHEIGDJ EQUAL 19
 18537         GO TO 6180-DUPREC
 18538         DEPENDING ON DFHEIGDI
 18539     ELSE IF DFHEIGDJ EQUAL 20
 18540         GO TO 6190-DUPREC
 18541         DEPENDING ON DFHEIGDI
 18542     ELSE IF DFHEIGDJ EQUAL 21
 18543         GO TO 6185-DUPREC
* Micro Focus Server Express         V5.1 revision 000 18-Jul-11 12:21 Page 363
* EL156.cbl
 18544         DEPENDING ON DFHEIGDI
 18545     ELSE IF DFHEIGDJ EQUAL 22
 18546         GO TO 6720-BUILD-NEW-RECORD
 18547         DEPENDING ON DFHEIGDI
 18548     ELSE IF DFHEIGDJ EQUAL 23
 18549         GO TO 6900-BUILD-ARCHIVE-HEADER,
 18550               6900-BUILD-ARCHIVE-HEADER
 18551         DEPENDING ON DFHEIGDI
 18552     ELSE IF DFHEIGDJ EQUAL 24
 18553         GO TO 7100-SHOW-RECORD-NOT-FOUND
 18554         DEPENDING ON DFHEIGDI
 18555     ELSE IF DFHEIGDJ EQUAL 25
 18556         GO TO 7160-DUPREC
 18557         DEPENDING ON DFHEIGDI
 18558     ELSE IF DFHEIGDJ EQUAL 26
 18559         GO TO 7200-EXIT,
 18560               7200-EXIT
 18561         DEPENDING ON DFHEIGDI
 18562     ELSE IF DFHEIGDJ EQUAL 27
 18563         GO TO 7400-NOT-FOUND
 18564         DEPENDING ON DFHEIGDI
 18565     ELSE IF DFHEIGDJ EQUAL 28
 18566         GO TO 7590-END,
 18567               7590-END
 18568         DEPENDING ON DFHEIGDI
 18569     ELSE IF DFHEIGDJ EQUAL 29
 18570         GO TO 7699-EXIT
 18571         DEPENDING ON DFHEIGDI
 18572     ELSE IF DFHEIGDJ EQUAL 30
 18573         GO TO 5300-NOTE-NOT-FOUND
 18574         DEPENDING ON DFHEIGDI
 18575     ELSE IF DFHEIGDJ EQUAL 31
 18576         GO TO 7800-COMP-NOTFND
 18577         DEPENDING ON DFHEIGDI
 18578     ELSE IF DFHEIGDJ EQUAL 32
 18579         GO TO 7920-NOT-FOUND
 18580         DEPENDING ON DFHEIGDI
 18581     ELSE IF DFHEIGDJ EQUAL 33
 18582         GO TO 9870-NOTOPEN,
 18583               9870-EXIT
 18584         DEPENDING ON DFHEIGDI.
 18585     MOVE '9%                    "   ' TO DFHEIV0
 18586     MOVE 'EL156' TO DFHEIV1
 18587     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18588     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       11628     Code:       68818
