* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24* 101412    2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    25* 101812    2012101700002  AJRA  READ ENDT BY ARCHIVE NO
    26* 110612    2012101700002  AJRA  ADD NEW FIELDS
    27* 121112    2012101700002  AJRA  HANDLE .01 PREM AND 9999999 BEN
    28* 121712    2012101700002  AJRA  ADD DEFAULT AGE FLAG
    29* 050213    2013050100001  AJRA  FIX AH REFUND ON DEATH CLAIM
    30* 091213    2013090300001  AJRA  NAPERSOFT PHASE 2
    31* 123113    2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    32******************************************************************
    33 ENVIRONMENT DIVISION.
    34 DATA DIVISION.
    35 working-storage section.
    36 01  DFH-START PIC X(04).
    37 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    38 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    39 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    40 77  SAVE-BIN-NEXT-BUS-DT        PIC XX      VALUE SPACES.
    41 77  S1                          PIC S999 COMP-3 VALUE +0.
    42 77  E1                          PIC S999 COMP-3 VALUE +0.
    43 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    44 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    45 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    46 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    47 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    48 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    49 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    50 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    51 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    52 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    53 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    54 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    55     88  FOUND-BENE                  VALUE 'Y'.
    56 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    57 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    58 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    59 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    60     88  END-OF-ERPNDB              VALUE 'Y'.
    61 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    62     88  ACCT-FOUND                 VALUE 'Y'.
    63 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    64     88  CERT-FOUND                 VALUE 'Y'.
    65     88  CERT-NOT-FOUND             VALUE 'N'.
    66 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    67     88  ENDT-FOUND                 VALUE 'Y'.
    68     88  ENDT-NOT-FOUND             VALUE 'N'.
    69 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    70     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
    71 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   3
* NSRASBL.cbl
    72 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    73 77  WS-LF-EARN                  PIC X     VALUE ' '.
    74 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    75 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    76 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    77 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    78 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    79 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    80 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    81 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    82 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
    83 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    84 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    85 77  WS-WORK-ALT-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    86 77  WS-WORK-CMB-LF-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
    87 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    88 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    89 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    90 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    91 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    92     88  PROCESS-ISSUE               VALUE 'I'.
    93     88  PROCESS-CANCEL              VALUE 'C'.
    94 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    95 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    96 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    97 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    98 77  WS-CHGBK-LIFE-PCT           PIC S9V9(5) COMP-3 VALUE +0.
    99 77  WS-CHGBK-AH-PCT             PIC S9V9(5) COMP-3 VALUE +0.
   100 77  WS-CERT-EFF-DT              PIC XX  VALUE SPACES.
   101 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
   102 01  WS-CALC-FIELDS.
   103     12  WS-WRK-AMOUNT           PIC S9(7)V99 COMP-3 VALUE +0.
   104     12  WS-WRK-AMOUNT2          PIC S9(7)V99 COMP-3 VALUE +0.
   105     12  WS-CSO-LF-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   106     12  WS-CSO-ALT-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   107     12  WS-CSO-CMB-LF-PORTION   PIC S9(7)V99 COMP-3 VALUE +0.
   108     12  WS-CSO-AH-PORTION       PIC S9(7)V99 COMP-3 VALUE +0.
   109     12  WS-CSO-PORTION          PIC S9(7)V99 COMP-3 VALUE +0.
   110     12  WS-ACCT-LF-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   111     12  WS-ACCT-ALT-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   112     12  WS-ACCT-CMB-LF-PORTION  PIC S9(7)V99 COMP-3 VALUE +0.
   113     12  WS-ACCT-AH-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
   114     12  WS-ACCT-PORTION         PIC S9(7)V99 COMP-3 VALUE +0.
   115     12  WS-CSO-ORIG-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   116     12  WS-CSO-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   117     12  WS-CSO-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   118     12  WS-CSO-ORIG-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   119     12  WS-CSO-ORIG-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   120     12  WS-ACCT-ORIG-LF-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   121     12  WS-ACCT-ORIG-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   122     12  WS-ACCT-ORIG-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   123     12  WS-ACCT-ORIG-AH-PORT    PIC S9(7)V99 COMP-3 VALUE +0.
   124     12  WS-ACCT-ORIG-PORTION    PIC S9(7)V99 COMP-3 VALUE +0.
   125     12  WS-CSO-NEW-LF-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   126     12  WS-CSO-NEW-ALT-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   127     12  WS-CSO-NEW-CMB-LF-PORT  PIC S9(7)V99 COMP-3 VALUE +0.
   128     12  WS-CSO-NEW-AH-PORT      PIC S9(7)V99 COMP-3 VALUE +0.
   129     12  WS-CSO-NEW-PORTION      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   4
* NSRASBL.cbl
   130     12  WS-ACCT-NEW-LF-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   131     12  WS-ACCT-NEW-ALT-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   132     12  WS-ACCT-NEW-CMB-LF-PORT PIC S9(7)V99 COMP-3 VALUE +0.
   133     12  WS-ACCT-NEW-AH-PORT     PIC S9(7)V99 COMP-3 VALUE +0.
   134     12  WS-ACCT-NEW-PORTION     PIC S9(7)V99 COMP-3 VALUE +0.
   135     12  WS-CSO-LF-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   136     12  WS-CSO-ALT-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   137     12  WS-CSO-CMB-LF-PORT-CHG  PIC S9(7)V99 COMP-3 VALUE +0.
   138     12  WS-CSO-AH-PORT-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   139     12  WS-CSO-PORTION-CHG      PIC S9(7)V99 COMP-3 VALUE +0.
   140     12  WS-ACCT-LF-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   141     12  WS-ACCT-ALT-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   142     12  WS-ACCT-CMB-LF-PORT-CHG PIC S9(7)V99 COMP-3 VALUE +0.
   143     12  WS-ACCT-AH-PORT-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   144     12  WS-ACCT-PORTION-CHG     PIC S9(7)V99 COMP-3 VALUE +0.
   145 01  WS-SAVE-ERACCT-REC          PIC X(2000).
   146 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
   147 01 response-code         pic s9(8) comp.
   148 01 display-response      pic 9(8).
   149 01 bl-index              pic 9(8) comp.
   150 01 max-last-name         pic x(18).
   151 01 first-initial         pic x.
   152 01 name-in-range-flag    pic 9.
   153 01 max-entries           pic s9(8) comp value 100.
   154 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   155 01 lower-case    pic x(26) value
   156            "abcdefghijklmnopqrstuvwxyz".
   157 01 upper-case    pic x(26) value
   158            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   159
   160*                                COPY ELCVADS.
   161******************************************************************
   162*                                                                *
   163*                                                                *
   164*                            ELCVADS.                            *
   165*                                                                *
   166*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   167*   ELVADS                  LENGTH = 350                         *
   168******************************************************************
   169******************************************************************
   170*                   C H A N G E   L O G
   171*
   172* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   173*-----------------------------------------------------------------
   174*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   175* EFFECTIVE    NUMBER
   176*-----------------------------------------------------------------
   177* 100111    2011022800001  AJRA  NAPERSOFT
   178******************************************************************
   179
   180 01  VIRGINIA-DISCLOSURE.
   181     12  VD-COMPANY-CD              PIC X.
   182     12  VD-CARRIER                 PIC X.
   183     12  VD-GROUPING.
   184         20  VD-GROUPING-PREFIX     PIC XXX.
   185         20  VD-GROUPING-PRIME      PIC XXX.
   186     12  VD-STATE                   PIC XX.
   187     12  VD-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   5
* NSRASBL.cbl
   188         20  VD-ACCOUNT-PREFIX      PIC X(4).
   189         20  VD-ACCOUNT-PRIME       PIC X(6).
   190     12  VD-CERT-EFF-DT             PIC XX.
   191     12  VD-CERT-NO.
   192         20  VD-CERT-PRIME          PIC X(10).
   193         20  VD-CERT-SFX            PIC X.
   194     12  VD-ENTRY-BATCH             PIC X(6).
   195     12  VD-CSR-ID                  PIC X(4).
   196     12  VD-NAME.
   197         20  VD-INSURED-LAST-NAME   PIC X(15).
   198         20  VD-INSURED-FIRST-NAME.
   199             24  VD-INSURED-1ST-INIT PIC X.
   200             24  FILLER             PIC X(9).
   201         20  VD-INSURED-MIDDLE-INIT PIC X.
   202     12  VD-JOINT-INSURED.
   203         20 VD-JOINT-LAST-NAME      PIC X(15).
   204         20 VD-JOINT-FIRST-NAME.
   205            24  VD-JOINT-FIRST-INIT PIC X.
   206            24  FILLER              PIC X(9).
   207         20 VD-JOINT-MIDDLE-INIT    PIC X.
   208     12  VD-INSURED-ADDRESS-1       PIC X(30).
   209     12  VD-INSURED-ADDRESS-2       PIC X(30).
   210     12  VD-INSURED-CITY-STATE.
   211         20  VD-INSURED-CITY        PIC X(28).
   212         20  VD-INSURED-STATE       PIC XX.
   213     12  VD-INSURED-ZIP-CODE.
   214         20  VD-INSURED-ZIP-PRIME.
   215             24  VD-INSURED-ZIP-1   PIC X.
   216                 88  VD-CANADIAN-POST-CODE
   217                                       VALUE 'A' THRU 'Z'.
   218             24  FILLER             PIC X(4).
   219         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   220     12  VD-BENEFICIARY-NAME        PIC X(30).
   221     12  VD-ACCOUNT-NAME            PIC X(30).
   222     12  VD-LOAN-TERM               PIC S999   COMP-3.
   223     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   224     12  VD-1ST-PMT-DT              PIC XX.
   225     12  VD-LIFE-BENEFIT-CD         PIC XX.
   226         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   227         88  VD-INVALID-LIFE           VALUE '  ' '00'
   228                                             '90' THRU '99'.
   229     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   230                                    PIC XX.
   231     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   232     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   233     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   234     12  VD-LF-TERM                 PIC S999   COMP-3.
   235     12  VD-AH-BENEFIT-CD           PIC XX.
   236         88  VD-VALID-AH               VALUE '01' THRU '89'.
   237         88  VD-INVALID-AH             VALUE '  ' '00'
   238                                             '90' THRU '99'.
   239     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   240     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   241     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   242     12  VD-AH-TERM                 PIC S999   COMP-3.
   243     12  VD-LETTER-ID               PIC X(4).
   244     12  VD-PROC-ID                 PIC X(4).
   245     12  VD-COMP-ID                 PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   6
* NSRASBL.cbl
   246     12  VD-CURRENT-DATE            PIC XX.
   247     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   248     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   249     12  FILLER                     PIC X(32).
   250 01  WS-PASS-AREA.
   251     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   252     05  WS-PASS-VADS-REC    PIC X(350).
   253
   254*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   255*                         COPY ELCZREC.
   256******************************************************************
   257*                                                                *
   258*                                                                *
   259*                            ELCZREC.                            *
   260*                                                                *
   261*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   262*                                                                *
   263******************************************************************
   264*-----------------------------------------------------------------
   265*                   C H A N G E   L O G
   266*
   267* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   268*-----------------------------------------------------------------
   269*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   270* EFFECTIVE    NUMBER
   271*-----------------------------------------------------------------
   272* 122011    2011022800001  AJRA  NEW FILE
   273* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   274* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   275* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   276* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   277*-----------------------------------------------------------------
   278 01  W-Z-CONTROL-DATA.
   279     05  W-NUMBER-OF-COPIES      PIC  9.
   280     05  FILLER                  PIC  X.
   281     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   282     05  FILLER                  PIC  X.
   283     05  W-DAYS-TO-RESEND        PIC  999.
   284     05  FILLER                  PIC  X.
   285     05  W-FORM-TO-RESEND        PIC  X(4).
   286     05  W-ADD-BAR-CODE          PIC  X.
   287     05  W-PROMPT-LETTER         PIC  X.
   288     05  W-HAS-RETURN-ENV        PIC  X.
   289     05  W-ENCLOSURE-CD          PIC  XXX.
   290     05  W-SIG-FLAG-DEFAULT      PIC  X.
   291     05  W-AUTO-CLOSE-IND        PIC  X.
   292     05  FILLER                  PIC  X.
   293     05  W-LETTER-TO-BENE        PIC  X.
   294     05  FILLER                  PIC  X.
   295     05  W-LETTER-TO-ACCT        PIC  X.
   296     05  FILLER                  PIC  X.
   297     05  W-LETTER-TYPE           PIC  X.
   298     05  FILLER                  PIC  X.
   299     05  W-PRINT-CERTIFICATE     PIC  X.
   300     05  FILLER                  PIC  X.
   301     05  W-REFUND-REQUIRED       PIC  X.
   302     05  FILLER                  PIC  X.
   303     05  W-ONBASE-CODE           PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   7
* NSRASBL.cbl
   304     05  FILLER                  PIC  X.
   305     05  W-ACCT-SUMM             PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-CSO-SUMM              PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-REASONS-REQUIRED      PIC  X.
   310     05  FILLER                  PIC  X(29).
   311 01  MISC.
   312     12  WS-RESPONSE             PIC S9(8)   COMP.
   313         88  RESP-NORMAL                  VALUE +00.
   314         88  RESP-NOTFND                  VALUE +13.
   315         88  RESP-DUPREC                  VALUE +14.
   316         88  RESP-DUPKEY                  VALUE +15.
   317         88  RESP-NOTOPEN                 VALUE +19.
   318         88  RESP-ENDFILE                 VALUE +20.
   319 01  srch-commarea.
   320*                                copy ELCADLTRSPI.
   321******************************************************************
   322*                   C H A N G E   L O G
   323*
   324* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   325*-----------------------------------------------------------------
   326*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   327* EFFECTIVE    NUMBER
   328*-----------------------------------------------------------------
   329* 060611    2011022800001  PEMA  NEW COPYBOOK
   330* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   331* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   332******************************************************************
   333****************************************
   334*  commarea for NaperSoft On Demand Admin services letters
   335*  (business logic input & output)
   336****************************************
   337     03  BL-INPUT.
   338         05  BL-DATA-SRCE        PIC X.
   339         05  BL-LETTER-ID        PIC XXXX.
   340         05  BL-CARRIER          PIC X.
   341         05  BL-GROUP            PIC X(6).
   342         05  BL-STATE            PIC XX.
   343         05  BL-ACCOUNT          PIC X(10).
   344         05  BL-EFF-DT           PIC X(10).
   345         05  BL-CERT-NO          PIC X(11).
   346         05  BL-BATCH-NO         PIC X(6).
   347         05  BL-BATCH-SEQ        PIC 9(8).
   348         05  BL-RESP-NO          PIC X(10).
   349         05  BL-NO-OF-COPIES     PIC 99.
   350         05  BL-PROC-ID          PIC XXXX.
   351         05  BL-COMP-ID          PIC XXX.
   352         05  BL-PRINT-NOW-SW     PIC X.
   353         05  BL-ENC-CD           PIC XXX.
   354         05  BL-RESEND-DT        PIC X(10).
   355         05  BL-FOLLOW-UP-DT     PIC X(10).
   356         05  BL-ARCHIVE-NO       PIC 9(8).
   357         05  BL-FUNC             PIC X(8).
   358         05  BL-COMMENTS         PIC X(100).
   359         05  FILLER REDEFINES BL-COMMENTS.
   360             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   361             10  BL-LETTER-TO-ACCT PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   8
* NSRASBL.cbl
   362             10  BL-LETTER-TO-BENE PIC X.
   363             10  BL-WRITE-ERARCH   PIC X.
   364                 88  ERARCH-QWS      VALUE 'Q'.
   365                 88  ERARCH-BATCH    VALUE 'B'.
   366                 88  ERARCH-TEMP     VALUE 'T'.
   367             10  BL-PROCESS-TYPE PIC X(07).
   368             10  BL-CERT-FORM-ID PIC X(05).
   369             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   370             10  BL-SOURCE-SCREEN PIC X(8).
   371             10  FILLER          PIC X(25).
   372     03  BL-OUTPUT.
   373         05  BL-STATUS                   PIC X.
   374             88  BL-OK                      VALUE "P".
   375             88  BL-FAIL                  VALUE "F".
   376         05  BL-MESSAGE          PIC X(50).
   377     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   378     03  FILLER                  PIC X(31).
   379 01  filler                      pic x(500).
   380 01  WS-SAVE-CARRIER-INFO.
   381     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   382     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   383     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   384     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   385     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   386     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   387     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   388     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   389 01  WS-SAVE-STATE-INFO.
   390     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   391     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   392 01  WS-SAVE-LFBEN-INFO.
   393     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   394     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   395     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   396 01  WS-SAVE-AHBEN-INFO.
   397     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   398     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   399     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   400     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   401 01  WS-ERPNDB-KEY.
   402     05  WS-ERPNDB-COMPANY-CD    PIC X.
   403     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   404     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   405     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   406 01  WS-ELENCC-KEY.
   407     05  WS-ELENCC-COMPANY-CD    PIC X.
   408     05  WS-ELENCC-REC-TYPE      PIC X.
   409     05  WS-ELENCC-ENC-CODE      PIC X(5).
   410     05  F                       PIC X(9).
   411 01  WS-ELCERT-KEY.
   412     05  WS-ELCERT-COMPANY-CD    PIC X.
   413     05  WS-ELCERT-CARRIER       PIC X.
   414     05  WS-ELCERT-GROUP         PIC X(6).
   415     05  WS-ELCERT-STATE         PIC XX.
   416     05  WS-ELCERT-ACCOUNT       PIC X(10).
   417     05  WS-ELCERT-EFF-DT        PIC XX.
   418     05  WS-ELCERT-CERT-NO       PIC X(11).
   419 01  WS-ELCRTT-KEY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page   9
* NSRASBL.cbl
   420     05  WS-ELCRTT-PRIMARY       PIC X(33).
   421     05  WS-ELCRTT-REC-TYPE      PIC X(1).
   422
   423 01  WS-ERENDT-KEY.
   424     05  WS-ERENDT-COMPANY-CD    PIC X.
   425     05  WS-ERENDT-CARRIER       PIC X.
   426     05  WS-ERENDT-GROUP         PIC X(6).
   427     05  WS-ERENDT-STATE         PIC XX.
   428     05  WS-ERENDT-ACCOUNT       PIC X(10).
   429     05  WS-ERENDT-EFF-DT        PIC XX.
   430     05  WS-ERENDT-CERT-NO       PIC X(11).
   431     05  WS-ERENDT-REC-TYPE      PIC X.
   432     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   433
   434 01  WS-ERENDT-KEY-BY-ARCH.
   435     05  WS-ERENDT-COMPANY-CD-A1 PIC X.
   436     05  WS-ERENDT-ARCHIVE       PIC 9(8) BINARY.
   437 01  WS-ERCOMP-KEY.
   438     05  WS-ERCOMP-COMPANY-CD    PIC X.
   439     05  WS-ERCOMP-CARRIER       PIC X.
   440     05  WS-ERCOMP-GROUP         PIC X(6).
   441     05  WS-ERCOMP-RESP-NO       PIC X(10).
   442     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   443     05  WS-ERCOMP-REC-TYPE      PIC X.
   444 01  WS-ERMAIL-KEY.
   445     05  WS-ERMAIL-COMPANY-CD    PIC X.
   446     05  WS-ERMAIL-CARRIER       PIC X.
   447     05  WS-ERMAIL-GROUP         PIC X(6).
   448     05  WS-ERMAIL-STATE         PIC XX.
   449     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   450     05  WS-ERMAIL-EFF-DT        PIC XX.
   451     05  WS-ERMAIL-CERT-NO       PIC X(11).
   452 01  WS-ERACCT-KEY.
   453     05  WS-ERACCT-COMPANY-CD    PIC X.
   454     05  WS-ERACCT-CARRIER       PIC X.
   455     05  WS-ERACCT-GROUP         PIC X(6).
   456     05  WS-ERACCT-STATE         PIC XX.
   457     05  WS-ERACCT-ACCOUNT       PIC X(10).
   458     05  WS-ERACCT-EXP-DT        PIC XX.
   459     05  FILLER                  PIC XXXX.
   460 01  WS-ELLETR-KEY.
   461     05  WS-ELLETR-COMPANY-CD    PIC X.
   462     05  WS-ELLETR-LETTER-ID     PIC X(12).
   463     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   464 01  WS-ELCNTL-KEY.
   465     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   466     05  WS-ELCNTL-REC-TYPE      PIC X.
   467     05  WS-ELCNTL-GENL.
   468         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   469         10  WS-ELCNTL-BEN-CD.
   470             15  F               PIC X.
   471             15  WS-ELCNTL-CARR  PIC X.
   472     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   473*                                COPY ELCDATE.
   474******************************************************************
   475*                                                                *
   476*                                                                *
   477*                            ELCDATE.                            *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  10
* NSRASBL.cbl
   478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   479*                            VMOD=2.003
   480*                                                                *
   481*                                                                *
   482*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   483*                 LENGTH = 200                                   *
   484******************************************************************
   485
   486 01  DATE-CONVERSION-DATA.
   487     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   488     12  DC-OPTION-CODE                PIC X.
   489         88  BIN-TO-GREG                VALUE ' '.
   490         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   491         88  EDIT-GREG-TO-BIN           VALUE '2'.
   492         88  YMD-GREG-TO-BIN            VALUE '3'.
   493         88  MDY-GREG-TO-BIN            VALUE '4'.
   494         88  JULIAN-TO-BIN              VALUE '5'.
   495         88  BIN-PLUS-ELAPSED           VALUE '6'.
   496         88  FIND-CENTURY               VALUE '7'.
   497         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   498         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   499         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   500         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   501         88  JULIAN-TO-BIN-3            VALUE 'C'.
   502         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   503         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   504         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   505         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   506         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   507         88  CHECK-LEAP-YEAR            VALUE 'H'.
   508         88  BIN-3-TO-GREG              VALUE 'I'.
   509         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   510         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   511         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   512         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   513         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   514         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   515         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   516         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   517         88  THREE-CHARACTER-BIN
   518                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   519         88  GREGORIAN-TO-BIN
   520                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   521         88  BIN-TO-GREGORIAN
   522                  VALUES ' ' '1' 'I' '8' 'G'.
   523         88  JULIAN-TO-BINARY
   524                  VALUES '5' 'C' 'E' 'F'.
   525     12  DC-ERROR-CODE                 PIC X.
   526         88  NO-CONVERSION-ERROR        VALUE ' '.
   527         88  DATE-CONVERSION-ERROR
   528                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   529         88  DATE-IS-ZERO               VALUE '1'.
   530         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   531         88  DATE-IS-INVALID            VALUE '3'.
   532         88  DATE1-GREATER-DATE2        VALUE '4'.
   533         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   534         88  DATE-INVALID-OPTION        VALUE '9'.
   535         88  INVALID-CENTURY            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  11
* NSRASBL.cbl
   536         88  ONLY-CENTURY               VALUE 'B'.
   537         88  ONLY-LEAP-YEAR             VALUE 'C'.
   538         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   539     12  DC-END-OF-MONTH               PIC X.
   540         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   541     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   542         88  USE-NORMAL-PROCESS         VALUE ' '.
   543         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   544         88  ADJUST-UP-100-YRS          VALUE '2'.
   545     12  FILLER                        PIC X.
   546     12  DC-CONVERSION-DATES.
   547         16  DC-BIN-DATE-1             PIC XX.
   548         16  DC-BIN-DATE-2             PIC XX.
   549         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   550         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   551                       DC-GREG-DATE-1-EDIT.
   552             20  DC-EDIT1-MONTH        PIC 99.
   553             20  SLASH1-1              PIC X.
   554             20  DC-EDIT1-DAY          PIC 99.
   555             20  SLASH1-2              PIC X.
   556             20  DC-EDIT1-YEAR         PIC 99.
   557         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   558         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   559                     DC-GREG-DATE-2-EDIT.
   560             20  DC-EDIT2-MONTH        PIC 99.
   561             20  SLASH2-1              PIC X.
   562             20  DC-EDIT2-DAY          PIC 99.
   563             20  SLASH2-2              PIC X.
   564             20  DC-EDIT2-YEAR         PIC 99.
   565         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   566         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   567                     DC-GREG-DATE-1-YMD.
   568             20  DC-YMD-YEAR           PIC 99.
   569             20  DC-YMD-MONTH          PIC 99.
   570             20  DC-YMD-DAY            PIC 99.
   571         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   572         16  DC-GREG-DATE-1-MDY-R REDEFINES
   573                      DC-GREG-DATE-1-MDY.
   574             20  DC-MDY-MONTH          PIC 99.
   575             20  DC-MDY-DAY            PIC 99.
   576             20  DC-MDY-YEAR           PIC 99.
   577         16  DC-GREG-DATE-1-ALPHA.
   578             20  DC-ALPHA-MONTH        PIC X(10).
   579             20  DC-ALPHA-DAY          PIC 99.
   580             20  FILLER                PIC XX.
   581             20  DC-ALPHA-CENTURY.
   582                 24 DC-ALPHA-CEN-N     PIC 99.
   583             20  DC-ALPHA-YEAR         PIC 99.
   584         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   585         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   586         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   587         16  DC-JULIAN-DATE            PIC 9(05).
   588         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   589                                       PIC 9(05).
   590         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   591             20  DC-JULIAN-YEAR        PIC 99.
   592             20  DC-JULIAN-DAYS        PIC 999.
   593         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  12
* NSRASBL.cbl
   594         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   595         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   596     12  DATE-CONVERSION-VARIBLES.
   597         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   598         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   599             20  FILLER                PIC 9(3).
   600             20  HOLD-CEN-1-CCYY.
   601                 24  HOLD-CEN-1-CC     PIC 99.
   602                 24  HOLD-CEN-1-YY     PIC 99.
   603             20  HOLD-CEN-1-MO         PIC 99.
   604             20  HOLD-CEN-1-DA         PIC 99.
   605         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   606             20  HOLD-CEN-1-R-MO       PIC 99.
   607             20  HOLD-CEN-1-R-DA       PIC 99.
   608             20  HOLD-CEN-1-R-CCYY.
   609                 24  HOLD-CEN-1-R-CC   PIC 99.
   610                 24  HOLD-CEN-1-R-YY   PIC 99.
   611             20  FILLER                PIC 9(3).
   612         16  HOLD-CENTURY-1-X.
   613             20  FILLER                PIC X(3)  VALUE SPACES.
   614             20  HOLD-CEN-1-X-CCYY.
   615                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   616                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   617             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   618             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   619         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   620             20  HOLD-CEN-1-R-X-MO     PIC XX.
   621             20  HOLD-CEN-1-R-X-DA     PIC XX.
   622             20  HOLD-CEN-1-R-X-CCYY.
   623                 24  HOLD-CEN-1-R-X-CC PIC XX.
   624                 24  HOLD-CEN-1-R-X-YY PIC XX.
   625             20  FILLER                PIC XXX.
   626         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   627         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   628         16  DC-JULIAN-DATE-1          PIC 9(07).
   629         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   630             20  DC-JULIAN-1-CCYY.
   631                 24  DC-JULIAN-1-CC    PIC 99.
   632                 24  DC-JULIAN-1-YR    PIC 99.
   633             20  DC-JULIAN-DA-1        PIC 999.
   634         16  DC-JULIAN-DATE-2          PIC 9(07).
   635         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   636             20  DC-JULIAN-2-CCYY.
   637                 24  DC-JULIAN-2-CC    PIC 99.
   638                 24  DC-JULIAN-2-YR    PIC 99.
   639             20  DC-JULIAN-DA-2        PIC 999.
   640         16  DC-GREG-DATE-A-EDIT.
   641             20  DC-EDITA-MONTH        PIC 99.
   642             20  SLASHA-1              PIC X VALUE '/'.
   643             20  DC-EDITA-DAY          PIC 99.
   644             20  SLASHA-2              PIC X VALUE '/'.
   645             20  DC-EDITA-CCYY.
   646                 24  DC-EDITA-CENT     PIC 99.
   647                 24  DC-EDITA-YEAR     PIC 99.
   648         16  DC-GREG-DATE-B-EDIT.
   649             20  DC-EDITB-MONTH        PIC 99.
   650             20  SLASHB-1              PIC X VALUE '/'.
   651             20  DC-EDITB-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  13
* NSRASBL.cbl
   652             20  SLASHB-2              PIC X VALUE '/'.
   653             20  DC-EDITB-CCYY.
   654                 24  DC-EDITB-CENT     PIC 99.
   655                 24  DC-EDITB-YEAR     PIC 99.
   656         16  DC-GREG-DATE-CYMD         PIC 9(08).
   657         16  DC-GREG-DATE-CYMD-R REDEFINES
   658                              DC-GREG-DATE-CYMD.
   659             20  DC-CYMD-CEN           PIC 99.
   660             20  DC-CYMD-YEAR          PIC 99.
   661             20  DC-CYMD-MONTH         PIC 99.
   662             20  DC-CYMD-DAY           PIC 99.
   663         16  DC-GREG-DATE-MDCY         PIC 9(08).
   664         16  DC-GREG-DATE-MDCY-R REDEFINES
   665                              DC-GREG-DATE-MDCY.
   666             20  DC-MDCY-MONTH         PIC 99.
   667             20  DC-MDCY-DAY           PIC 99.
   668             20  DC-MDCY-CEN           PIC 99.
   669             20  DC-MDCY-YEAR          PIC 99.
   670    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   671        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   672    12  DC-EL310-DATE                  PIC X(21).
   673    12  FILLER                         PIC X(28).
   674*                                COPY NSCASEXTR.
   675******************************************************************
   676*                                                                *
   677*                                                                *
   678*                            NSCASEXTR.                          *
   679*                            VMOD=2.001                          *
   680*                                                                *
   681*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   682*                                                                *
   683*   FILE TYPE = VSAM,KSDS                                        *
   684*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   685*                                                                *
   686*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   687*                                                                *
   688*   LOG = NO                                                     *
   689*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   690******************************************************************
   691*-----------------------------------------------------------------
   692*                   C H A N G E   L O G
   693*
   694* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   695*-----------------------------------------------------------------
   696*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   697* EFFECTIVE    NUMBER
   698*-----------------------------------------------------------------
   699* 072211    2011022800001  PEMA  NEW FILE
   700*-----------------------------------------------------------------
   701 01 NSAS-EXTRACT-RECORD.
   702    05  NSAS-CONTROL-PRIMARY.
   703        10  NSAS-COMPANY-CD      PIC X.
   704        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   705        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   706    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   707    05  FILLER                   PIC X(143).
   708*                                COPY ERCPNDB.
   709******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  14
* NSRASBL.cbl
   710*                                                                *
   711*                                                                *
   712*                            ERCPNDB.                            *
   713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   714*                            VMOD=2.025                          *
   715*                                                                *
   716*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   717*                                                                *
   718******************************************************************
   719*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   720*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   721******************************************************************
   722*                                                                *
   723*                                                                *
   724*   FILE TYPE = VSAM,KSDS                                        *
   725*   RECORD SIZE = 585  RECFORM = FIXED                           *
   726*                                                                *
   727*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   728*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   729*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   730*                                                 RKP=13,LEN=36  *
   731*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   732*                                      AND CHG-SEQ.)             *
   733*                                                RKP=49,LEN=11   *
   734*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   735*                                      AND CHG-SEQ.)             *
   736*                                                RKP=60,LEN=15   *
   737*                                                                *
   738*   LOG = NO                                                     *
   739*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   740******************************************************************
   741******************************************************************
   742*                   C H A N G E   L O G
   743*
   744* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   745*-----------------------------------------------------------------
   746*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   747* EFFECTIVE    NUMBER
   748*-----------------------------------------------------------------
   749* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   750* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   751* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   752* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   753* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   754* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   755* 032306                   PEMA  ADD BOW LOAN NUMBER
   756* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   757* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   758* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   759* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   760* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   761* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   762* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   763* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   764******************************************************************
   765
   766 01  PENDING-BUSINESS.
   767     12  PB-RECORD-ID                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  15
* NSRASBL.cbl
   768         88  VALID-PB-ID                        VALUE 'PB'.
   769
   770     12  PB-CONTROL-PRIMARY.
   771         16  PB-COMPANY-CD                PIC X.
   772         16  PB-ENTRY-BATCH               PIC X(6).
   773         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   774         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   775
   776     12  PB-CONTROL-BY-ACCOUNT.
   777         16  PB-COMPANY-CD-A1             PIC X.
   778         16  PB-CARRIER                   PIC X.
   779         16  PB-GROUPING.
   780             20  PB-GROUPING-PREFIX       PIC XXX.
   781             20  PB-GROUPING-PRIME        PIC XXX.
   782         16  PB-STATE                     PIC XX.
   783         16  PB-ACCOUNT.
   784             20  PB-ACCOUNT-PREFIX        PIC X(4).
   785             20  PB-ACCOUNT-PRIME         PIC X(6).
   786         16  PB-CERT-EFF-DT               PIC XX.
   787         16  PB-CERT-NO.
   788             20  PB-CERT-PRIME            PIC X(10).
   789             20  PB-CERT-SFX              PIC X.
   790         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   791
   792         16  PB-RECORD-TYPE               PIC X.
   793             88  PB-MAILING-DATA                VALUE '0'.
   794             88  PB-ISSUE                       VALUE '1'.
   795             88  PB-CANCELLATION                VALUE '2'.
   796             88  PB-BATCH-TRAILER               VALUE '9'.
   797
   798     12  PB-CONTROL-BY-ORIG-BATCH.
   799         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   800         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   801         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   802         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   803
   804     12  PB-CONTROL-BY-CSR.
   805         16  PB-CSR-COMPANY-CD            PIC X.
   806         16  PB-CSR-ID                    PIC X(4).
   807         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   808         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   809         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   810******************************************************************
   811*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   812******************************************************************
   813
   814     12  PB-LAST-MAINT-DT                 PIC XX.
   815     12  PB-LAST-MAINT-BY                 PIC X(4).
   816     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   817
   818     12  PB-RECORD-BODY                   PIC X(375).
   819
   820     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   821         16  PB-CERT-ORIGIN               PIC X.
   822             88  CLASIC-CREATED-CERT         VALUE '1'.
   823         16  PB-I-NAME.
   824             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   825             20  PB-I-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  16
* NSRASBL.cbl
   826                 24  PB-I-INSURED-1ST-INIT PIC X.
   827                 24  FILLER                PIC X(9).
   828             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   829         16  PB-I-AGE                     PIC S99   COMP-3.
   830         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   831         16  PB-I-BIRTHDAY                PIC XX.
   832         16  PB-I-INSURED-SEX             PIC X.
   833             88  PB-SEX-MALE     VALUE 'M'.
   834             88  PB-SEX-FEMALE   VALUE 'F'.
   835
   836         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   837         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   838         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   839         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   840         16  PB-I-SKIP-CODE               PIC X.
   841             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   842             88  PB-SKIP-JULY              VALUE '1'.
   843             88  PB-SKIP-AUGUST            VALUE '2'.
   844             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   845             88  PB-SKIP-JULY-AUG          VALUE '4'.
   846             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   847             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   848             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   849             88  PB-SKIP-JUNE              VALUE '8'.
   850             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   851             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   852             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   853         16  PB-I-TERM-TYPE               PIC X.
   854             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   855             88  PB-PAID-WEEKLY            VALUE 'W'.
   856             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   857             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   858             88  PB-PAID-13-YEARLY         VALUE 'T'.
   859         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   860         16  PB-I-POLICY-FORM-NO          PIC X(12).
   861         16  PB-I-DATA-ENTRY-SW           PIC X.
   862             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   863             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   864             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   865             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   866         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   867         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   868*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   869         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   870         16  FILLER                       PIC X.
   871
   872         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   873             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   874             88  PB-INVALID-LIFE             VALUE '  ' '00'
   875                                                   '90' THRU '99'.
   876         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   877                                          PIC XX.
   878         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   879         16  PB-I-AMOUNT-FINANCED REDEFINES
   880                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   881         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   882         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   883                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  17
* NSRASBL.cbl
   884         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   885         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   886         16  PB-I-CLP-AMOUNT REDEFINES
   887                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   888         16  PB-I-LF-CALC-FLAG            PIC X.
   889             88 PB-COMP-LF-PREM               VALUE '?'.
   890         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   891         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   892         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   893         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   894         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   895         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   896         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   897         16  PB-I-LF-ABBR                 PIC XXX.
   898         16  PB-I-LF-INPUT-CD             PIC XX.
   899
   900         16  PB-I-AH-BENEFIT-CD           PIC XX.
   901             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   902             88  PB-INVALID-AH               VALUE '  ' '00'
   903                                                   '90' THRU '99'.
   904         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   905         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   906         16  PB-I-AH-CALC-FLAG            PIC X.
   907             88 PB-COMP-AH-PREM                  VALUE '?'.
   908         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   909         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   910         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   911         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   912         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   913         16  PB-I-AH-ABBR                 PIC XXX.
   914         16  PB-I-AH-INPUT-CD             PIC XXX.
   915
   916         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   917         16  PB-I-REIN-TABLE              PIC XXX.
   918         16  PB-I-BUSINESS-TYPE           PIC 99.
   919         16  PB-I-INDV-GRP-CD             PIC X.
   920         16  PB-I-MORT-CODE.
   921             20  PB-I-TABLE               PIC X.
   922             20  PB-I-INTEREST            PIC XX.
   923             20  PB-I-MORT-TYP            PIC X.
   924         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   925         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   926         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   927         16  PB-I-INDV-GRP-OVRD           PIC X.
   928         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   929         16  PB-I-SIG-SW                  PIC X.
   930             88  PB-POLICY-SIGNED             VALUE 'Y'.
   931         16  PB-I-RATE-CLASS              PIC XX.
   932         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   933         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   934         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   935         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   936         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   937         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   938         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   939         16  PB-I-BENEFIT-TYPE            PIC XXX.
   940         16  PB-I-OB-FLAG                 PIC X.
   941             88  PB-I-OB                      VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  18
* NSRASBL.cbl
   942             88  PB-I-SUMMARY                 VALUE 'Z'.
   943         16  PB-I-ENTRY-STATUS            PIC X.
   944             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   945                                              'M' '5' '9' '2'.
   946             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   947             88  PB-I-POLICY-PENDING          VALUE '2'.
   948             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   949             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   950             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   951             88  PB-I-REIN-ONLY               VALUE '9'.
   952             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   953             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   954             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   955             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   956         16  PB-I-INT-CODE                PIC X.
   957             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   958             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   959         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   960         16  PB-I-SOC-SEC-NO              PIC X(11).
   961         16  PB-I-MEMBER-NO               PIC X(12).
   962         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   963*        16  PB-I-LOAN-OFFICER            PIC XXX.
   964         16  PB-I-OLD-LOF                 PIC XXX.
   965         16  PB-I-LF-EXPIRE-DT            PIC XX.
   966         16  PB-I-AH-EXPIRE-DT            PIC XX.
   967         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   968         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   969         16  PB-I-LIFE-INDICATOR          PIC X.
   970             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   971         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   972         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   973                                          PIC S9(5)V99    COMP-3.
   974         16  PB-I-MAIL-ADDRS-SW           PIC X.
   975             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   976             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   977         16  PB-I-1ST-PMT-DT              PIC XX.
   978         16  PB-I-JOINT-INSURED.
   979             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   980             20 PB-I-JOINT-FIRST-NAME.
   981                24  PB-I-JOINT-FIRST-INIT PIC X.
   982                24  FILLER                PIC X(9).
   983             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   984*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   985         16  PB-I-BENEFICIARY-NAME.
   986             20  PB-I-BANK-NUMBER         PIC X(10).
   987             20  FILLER                   PIC X(15).
   988         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   989         16  PB-I-REFERENCE               PIC X(12).
   990         16  FILLER REDEFINES PB-I-REFERENCE.
   991             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   992             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   993             20  PB-I-CLP-STATE           PIC XX.
   994         16  PB-I-UNDERWRITING-STATUS     PIC X.
   995             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   996             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   997             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   998         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   999         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  19
* NSRASBL.cbl
  1000         16  PB-I-RESIDENT-STATE          PIC XX.
  1001         16  PB-I-RATE-CODE               PIC X(4).
  1002         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1003         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1004         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1005         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1006         16  PB-I-BANK-NOCHRGB            PIC 99.
  1007         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1008         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1009
  1010     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1011         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1012             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1013         16  PB-C-CANCEL-ORIGIN           PIC X.
  1014             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1015         16  PB-C-LF-CANCEL-DT            PIC XX.
  1016         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1017         16  PB-C-LF-CALC-REQ             PIC X.
  1018             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1019         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1020         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1021         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1022             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1023         16  PB-C-AH-CANCEL-DT            PIC XX.
  1024         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1025         16  PB-C-AH-CALC-REQ             PIC X.
  1026             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1027         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1028         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1029         16  PB-C-LAST-NAME               PIC X(15).
  1030         16  PB-C-REFUND-SW               PIC X.
  1031             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1032             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1033         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1034         16  PB-C-PAYEE-CODE              PIC X(6).
  1035         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1036         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1037         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1038         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1039         16  PB-C-REFERENCE               PIC X(12).
  1040         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1041         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1042         16  PB-C-POST-CARD-IND           PIC X.
  1043         16  PB-C-CANCEL-REASON           PIC X.
  1044         16  PB-C-REF-INTERFACE-SW        PIC X.
  1045         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1046         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1047         16  FILLER                       PIC X(01).
  1048*        16  FILLER                       PIC X(18).
  1049         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1050*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1051         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1052         16  PB-CANCELED-CERT-DATA.
  1053             20  PB-CI-INSURED-NAME.
  1054                 24  PB-CI-LAST-NAME      PIC X(15).
  1055                 24  PB-CI-INITIALS       PIC XX.
  1056             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1057             20  PB-CI-INSURED-SEX        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1059             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1060             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1061             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1062             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1063             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1064             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1065             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1066             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1067             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1068             20  PB-CI-RATE-CLASS         PIC XX.
  1069             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1070             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1071             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1072             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1073             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1074             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1075             20  PB-CI-LF-ABBR            PIC X(3).
  1076             20  PB-CI-AH-ABBR            PIC X(3).
  1077             20  PB-CI-OB-FLAG            PIC X.
  1078                 88  PB-CI-OB                VALUE 'B'.
  1079             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1080                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1081                                           'M' '4' '5' '9' '2'.
  1082                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1083                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1084                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1085                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1086                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1087                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1088                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1089                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1090                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1091                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1092                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1093                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1094             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1095                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1096                                           'M' '4' '5' '9' '2'.
  1097                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1098                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1099                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1100                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1101                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1102                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1103                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1104                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1105                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1106                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1107                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1108                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1109             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1110             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1111             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1112             20  PB-CI-MEMBER-NO          PIC X(12).
  1113             20  PB-CI-INT-CODE           PIC X.
  1114                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1115                 88  PB-CI-SIMPLE                  VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  21
* NSRASBL.cbl
  1116             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1117             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1118             20  PB-CI-COMP-EXCP-SW       PIC X.
  1119                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1120                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1121             20  PB-CI-ENTRY-STATUS       PIC X.
  1122             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1123             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1124             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1125             20  PB-CI-DEATH-DT           PIC XX.
  1126             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1127             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1128             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1129             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1130             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1131             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1132             20  PB-CI-ENTRY-DT              PIC XX.
  1133             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1134             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1135             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1136             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1137             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1138             20  PB-CI-OLD-LOF               PIC XXX.
  1139*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1140             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1141             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1142             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1143             20  PB-CI-INDV-GRP-CD           PIC X.
  1144             20  PB-CI-BENEFICIARY-NAME.
  1145                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1146                 24  FILLER                  PIC X(15).
  1147             20  PB-CI-NOTE-SW               PIC X.
  1148             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1149             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1150             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1151             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1152             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1153             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1154             20  PB-CI-FIRST-NAME            PIC X(10).
  1155             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1156
  1157         16  FILLER                       PIC X(13).
  1158*032306  16  FILLER                       PIC X(27).
  1159*        16  FILLER                       PIC X(46).
  1160
  1161     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1162         16  FILLER                       PIC X(10).
  1163         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1164         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1165         16  PB-M-INSURED-MID-INIT        PIC X.
  1166         16  PB-M-INSURED-AGE             PIC 99.
  1167         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1168         16  PB-M-INSURED-SEX             PIC X.
  1169         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1170         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1171         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1172         16  PB-M-INSURED-CITY-STATE.
  1173             20  PB-M-INSURED-CITY        PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  22
* NSRASBL.cbl
  1174             20  PB-M-INSURED-STATE       PIC XX.
  1175         16  PB-M-INSURED-ZIP-CODE.
  1176             20  PB-M-INSURED-ZIP-PRIME.
  1177                 24  PB-M-INSURED-ZIP-1   PIC X.
  1178                     88  PB-M-CANADIAN-POST-CODE
  1179                                             VALUE 'A' THRU 'Z'.
  1180                 24  FILLER               PIC X(4).
  1181             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1182         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1183                                        PB-M-INSURED-ZIP-CODE.
  1184             20  PM-M-INS-CAN-POST1       PIC XXX.
  1185             20  PM-M-INS-CAN-POST2       PIC XXX.
  1186             20  FILLER                   PIC XXX.
  1187         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1188         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1189         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1190         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1191         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1192         16  PB-M-CRED-BENE-CITYST.
  1193             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1194             20  PB-M-CRED-BENE-STATE     PIC XX.
  1195         16  FILLER                       PIC X(92).
  1196
  1197     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1198         16  FILLER                       PIC X(10).
  1199         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1200         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1201         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1202         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1203         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1204         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1205         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1206         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1207         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1208         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1209         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1210         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1211         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1212         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1213         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1214         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1215         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1216         16  PB-ACCOUNT-NAME              PIC X(30).
  1217         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1218         16  PB-REFERENCE                 PIC X(12).
  1219         16  PB-B-RECEIVED-DT             PIC XX.
  1220         16  FILLER                       PIC X(234).
  1221
  1222     12  PB-RECORD-STATUS.
  1223         16  PB-CREDIT-SELECT-DT          PIC XX.
  1224         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1225         16  PB-BILLED-DT                 PIC XX.
  1226         16  PB-BILLING-STATUS            PIC X.
  1227             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1228             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1229             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1230         16  PB-RECORD-BILL               PIC X.
  1231             88  PB-RECORD-ON-HOLD            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  23
* NSRASBL.cbl
  1232             88  PB-RECORD-RETURNED           VALUE 'R'.
  1233             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1234             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1235             88  PB-OVERRIDE-AH               VALUE 'A'.
  1236             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1237         16  PB-BATCH-ENTRY               PIC X.
  1238             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1239             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1240             88  PB-REISSUED-CERT             VALUE 'E'.
  1241             88  PB-MONTHLY-CERT              VALUE 'M'.
  1242             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1243             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1244             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1245         16  PB-FORCE-CODE                PIC X.
  1246             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1247             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1248             88  PB-CANCEL-FORCE              VALUE '8'.
  1249             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1250             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1251             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1252             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1253             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1254             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1255             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1256         16  PB-FATAL-FLAG                PIC X.
  1257             88  PB-FATAL-ERRORS              VALUE 'X'.
  1258         16  PB-FORCE-ER-CD               PIC X.
  1259             88  PB-FORCE-ERRORS              VALUE 'F'.
  1260             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1261         16  PB-WARN-ER-CD                PIC X.
  1262             88  PB-WARNING-ERRORS            VALUE 'W'.
  1263         16  FILLER                       PIC X.
  1264         16  PB-OUT-BAL-CD                PIC X.
  1265             88  PB-OUT-OF-BAL                VALUE 'O'.
  1266         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1267         16  PB-AH-OVERRIDE-L1            PIC X.
  1268         16  PB-INPUT-DT                  PIC XX.
  1269         16  PB-INPUT-BY                  PIC X(4).
  1270         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1271         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1272         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1273         16  PB-LF-EARNING-METHOD         PIC X.
  1274         16  PB-AH-EARNING-METHOD         PIC X.
  1275         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1276         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1277         16  PB-REIN-CD                   PIC XXX.
  1278         16  PB-LF-REFUND-TYPE            PIC X.
  1279         16  PB-AH-REFUND-TYPE            PIC X.
  1280         16  PB-ACCT-EFF-DT               PIC XX.
  1281         16  PB-ACCT-EXP-DT               PIC XX.
  1282         16  PB-COMPANY-ID                PIC X(3).
  1283         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1284         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1285         16  PB-SV-CARRIER                PIC X.
  1286         16  PB-SV-GROUPING               PIC X(6).
  1287         16  PB-SV-STATE                  PIC XX.
  1288         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1289         16  PB-GA-BILLING-INFO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  24
* NSRASBL.cbl
  1290             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1291                                          PIC XX.
  1292         16  PB-SV-REMIT-TO  REDEFINES
  1293             PB-GA-BILLING-INFO           PIC X(10).
  1294         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1295         16  PB-I-LOAN-OFFICER            PIC X(5).
  1296         16  PB-I-VIN                     PIC X(17).
  1297
  1298         16  FILLER                       PIC X(04).
  1299         16  IMNET-BYPASS-SW              PIC X.
  1300
  1301******************************************************************
  1302*                COMMON EDIT ERRORS                              *
  1303******************************************************************
  1304
  1305     12  PB-COMMON-ERRORS.
  1306         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1307                                           PIC S9(4)     COMP.
  1308
  1309******************************************************************
  1310*                                COPY ERCENDT.
  1311******************************************************************
  1312*                                                                *
  1313*                                                                *
  1314*                            ERCENDT.                            *
  1315*                            VMOD=2.001                          *
  1316*                                                                *
  1317*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1318*                                                                *
  1319*   FILE TYPE = VSAM,KSDS                                        *
  1320*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1321*                                                                *
  1322*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1323*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1324*                                                                *
  1325*   LOG = NO                                                     *
  1326*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1327******************************************************************
  1328*-----------------------------------------------------------------
  1329*                   C H A N G E   L O G
  1330*
  1331* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1332*-----------------------------------------------------------------
  1333*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1334* EFFECTIVE    NUMBER
  1335*-----------------------------------------------------------------
  1336* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1337*                                WITH OPEN CLAIMS
  1338* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1339* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1340* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1341*-----------------------------------------------------------------
  1342 01  ENDORSEMENT-RECORD.
  1343     12  EN-RECORD-ID                PIC XX.
  1344         88  VALID-EN-ID                VALUE 'EN'.
  1345     12  EN-CONTROL-PRIMARY.
  1346         16  EN-COMPANY-CD           PIC X.
  1347         16  EN-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  25
* NSRASBL.cbl
  1348         16  EN-GROUPING             PIC X(6).
  1349         16  EN-STATE                PIC XX.
  1350         16  EN-ACCOUNT              PIC X(10).
  1351         16  EN-CERT-EFF-DT          PIC XX.
  1352         16  EN-CERT-NO.
  1353             20  EN-CERT-PRIME       PIC X(10).
  1354             20  EN-CERT-SFX         PIC X.
  1355         16  EN-REC-TYPE             PIC X.
  1356             88  EN-ISSUE               VALUE 'I'.
  1357             88  EN-CANCELLATION        VALUE 'C'.
  1358         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1359     12  EN-CONTROL-BY-ARCH-NO.
  1360         16  EN-COMPANY-CD-A1              PIC X.
  1361         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1362     12  EN-LAST-MAINT-DT            PIC XX.
  1363     12  EN-LAST-MAINT-BY            PIC X(4).
  1364     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1365     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1366     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1367         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1368         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1369         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1370         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1371         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1372         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1373         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1374         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1375         16  EN-LF-ORIG-BENCD        PIC XX.
  1376         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1377         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1378         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1379         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1380         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1381         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1382*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1383         16  EN-ORIG-CRED-BENE       PIC X(25).
  1384         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1385         16  FILLER                  PIC X.
  1386         16  EN-AH-ORIG-BENCD        PIC XX.
  1387         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1388         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1389         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1390         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1391*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1392*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1393         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1394         16  F                       PIC X(09).
  1395         16  EN-AH-ORIG-CP           PIC 99.
  1396         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1397         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1398         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1399         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1400         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1401         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1402         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1403         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1404         16  EN-LF-NEW-BENCD         PIC XX.
  1405         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  26
* NSRASBL.cbl
  1406         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1407         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1408         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1409         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1410         16  EN-LF-NEW-EXP-DT        PIC XX.
  1411         16  EN-NEW-CRED-BENE        PIC X(25).
  1412         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1413         16  FILLER                  PIC X.
  1414         16  EN-AH-NEW-BENCD         PIC XX.
  1415         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1416         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1417         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1418         16  EN-AH-NEW-EXP-DT        PIC XX.
  1419*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1420*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1421*        16  F                       PIC X(12).
  1422         16  EN-AH-NEW-CP            PIC 99.
  1423         16  EN-SIG-SW               PIC X.
  1424         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1425         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  1426         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1427         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  1428         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  1429         16  FILLER                  PIC X(33).
  1430     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1431         16  EN-LF-ORIG-REF-DT       PIC XX.
  1432         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1433         16  EN-AH-ORIG-REF-DT       PIC XX.
  1434         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1435         16  EN-LF-NEW-REF-DT        PIC XX.
  1436         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1437         16  EN-AH-NEW-REF-DT        PIC XX.
  1438         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1439         16  EN-FLAG-CERT            PIC X.
  1440         16  EN-INS-LAST-NAME        PIC X(15).
  1441         16  EN-INS-FIRST-NAME       PIC X(10).
  1442         16  EN-INS-MIDDLE-INIT      PIC X.
  1443         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1444         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  1445         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1446         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  1447         16  FILLER                  PIC X(262).
  1448     12  EN-MONEY-SW             PIC X.
  1449     12  EN-HEALTH-APP           PIC X.
  1450     12  EN-VOUCHER-SW           PIC X.
  1451     12  EN-PAYEE                PIC X(14).
  1452     12  EN-INPUT-DT             PIC XX.
  1453     12  EN-PROCESS-DT           PIC XX.
  1454     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1455     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1456     12  EN-REASON-CODES.
  1457         16  F OCCURS 12.
  1458             20  EN-REASON-CODE  PIC X(4).
  1459     12  EN-TEMPLATE-USED        PIC X(8).
  1460     12  EN-DOCU-TYPE            PIC X.
  1461         88  EN-VERI-DOCU          VALUE 'V'.
  1462         88  EN-GCE-DOCU           VALUE 'G'.
  1463         88  EN-CANC-DOCU          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  27
* NSRASBL.cbl
  1464     12  EN-COMMENTS1            PIC X(13).
  1465     12  EN-COMMENTS2            PIC X(70).
  1466     12  EN-COMM-CHGBK           PIC X.
  1467         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1468         88  EN-CHG-ACCT           VALUE 'Y'.
  1469     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1470     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1471     12  EN-BATCH-NUMBER         PIC X(6).
  1472     12  EN-ACCT-SUMM            PIC X.
  1473     12  EN-CSO-SUMM             PIC X.
  1474     12  FILLER                  PIC X(13).
  1475******************************************************************
  1476*                                COPY ERCMAIL.
  1477******************************************************************
  1478*                                                                *
  1479*                                                                *
  1480*                            ERCMAIL                             *
  1481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1482*                            VMOD=2.003                          *
  1483*                                                                *
  1484*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1485*                                                                *
  1486*   FILE TYPE = VSAM,KSDS                                        *
  1487*   RECORD SIZE = 374   RECFORM = FIX                            *
  1488*                                                                *
  1489*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1490*   ALTERNATE PATH    = NOT USED                                 *
  1491*                                                                *
  1492*   LOG = YES                                                    *
  1493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1494******************************************************************
  1495*                   C H A N G E   L O G
  1496*
  1497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1498*-----------------------------------------------------------------
  1499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1500* EFFECTIVE    NUMBER
  1501*-----------------------------------------------------------------
  1502* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1503* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1504* 111108                   PEMA  ADD CRED BENE ADDR2
  1505******************************************************************
  1506
  1507 01  MAILING-DATA.
  1508     12  MA-RECORD-ID                      PIC XX.
  1509         88  VALID-MA-ID                       VALUE 'MA'.
  1510
  1511     12  MA-CONTROL-PRIMARY.
  1512         16  MA-COMPANY-CD                 PIC X.
  1513         16  MA-CARRIER                    PIC X.
  1514         16  MA-GROUPING.
  1515             20  MA-GROUPING-PREFIX        PIC XXX.
  1516             20  MA-GROUPING-PRIME         PIC XXX.
  1517         16  MA-STATE                      PIC XX.
  1518         16  MA-ACCOUNT.
  1519             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1520             20  MA-ACCOUNT-PRIME          PIC X(6).
  1521         16  MA-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  28
* NSRASBL.cbl
  1522         16  MA-CERT-NO.
  1523             20  MA-CERT-PRIME             PIC X(10).
  1524             20  MA-CERT-SFX               PIC X.
  1525
  1526     12  FILLER                            PIC XX.
  1527
  1528     12  MA-ACCESS-CONTROL.
  1529         16  MA-SOURCE-SYSTEM              PIC XX.
  1530             88  MA-FROM-CREDIT                VALUE 'CR'.
  1531             88  MA-FROM-VSI                   VALUE 'VS'.
  1532             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1533             88  MA-FROM-OTHER                 VALUE 'OT'.
  1534         16  MA-RECORD-ADD-DT              PIC XX.
  1535         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1536         16  MA-LAST-MAINT-DT              PIC XX.
  1537         16  MA-LAST-MAINT-BY              PIC XXXX.
  1538         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1539
  1540     12  MA-PROFILE-INFO.
  1541         16  MA-QUALIFY-CODE-1             PIC XX.
  1542         16  MA-QUALIFY-CODE-2             PIC XX.
  1543         16  MA-QUALIFY-CODE-3             PIC XX.
  1544         16  MA-QUALIFY-CODE-4             PIC XX.
  1545         16  MA-QUALIFY-CODE-5             PIC XX.
  1546
  1547         16  MA-INSURED-LAST-NAME          PIC X(15).
  1548         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1549         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1550         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1551         16  MA-INSURED-BIRTH-DT           PIC XX.
  1552         16  MA-INSURED-SEX                PIC X.
  1553             88  MA-SEX-MALE                   VALUE 'M'.
  1554             88  MA-SEX-FEMALE                 VALUE 'F'.
  1555         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1556
  1557         16  MA-ADDRESS-CORRECTED          PIC X.
  1558         16  MA-JOINT-BIRTH-DT             PIC XX.
  1559*        16  FILLER                        PIC X(12).
  1560
  1561         16  MA-ADDRESS-LINE-1             PIC X(30).
  1562         16  MA-ADDRESS-LINE-2             PIC X(30).
  1563         16  MA-CITY-STATE.
  1564             20  MA-CITY                   PIC X(28).
  1565             20  MA-ADDR-STATE             PIC XX.
  1566         16  MA-ZIP.
  1567             20  MA-ZIP-CODE.
  1568                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1569                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1570                 24  FILLER                PIC X(4).
  1571             20  MA-ZIP-PLUS4              PIC X(4).
  1572         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1573             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1574             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1575             20  FILLER                    PIC X(3).
  1576
  1577         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1578
  1579         16  FILLER                        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  29
* NSRASBL.cbl
  1580*        16  FILLER                        PIC X(10).
  1581
  1582     12  MA-CRED-BENE-INFO.
  1583         16  MA-CRED-BENE-NAME                 PIC X(25).
  1584         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1585         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1586         16  MA-CRED-BENE-CTYST.
  1587             20  MA-CRED-BENE-CITY             PIC X(28).
  1588             20  MA-CRED-BENE-STATE            PIC XX.
  1589         16  MA-CRED-BENE-ZIP.
  1590             20  MA-CB-ZIP-CODE.
  1591                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1592                     88  MA-CB-CANADIAN-POST-CODE
  1593                                           VALUE 'A' THRU 'Z'.
  1594                 24  FILLER                    PIC X(4).
  1595             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1596         16  MA-CB-CANADIAN-POSTAL-CODE
  1597                            REDEFINES MA-CRED-BENE-ZIP.
  1598             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1599             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1600             20  FILLER                        PIC X(3).
  1601     12  MA-POST-CARD-MAIL-DATA.
  1602         16  MA-MAIL-DATA OCCURS 7.
  1603             20  MA-MAIL-TYPE              PIC X.
  1604                 88  MA-12MO-MAILING           VALUE '1'.
  1605                 88  MA-EXP-MAILING            VALUE '2'.
  1606             20  MA-MAIL-STATUS            PIC X.
  1607                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1608                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1609                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1610             20  MA-MAIL-DATE              PIC XX.
  1611     12  FILLER                            PIC XX.
  1612     12  FILLER                            PIC XX.
  1613*    12  FILLER                            PIC X(30).
  1614******************************************************************
  1615*                                COPY ERCCOMP.
  1616******************************************************************
  1617*                                                                *
  1618*                                                                *
  1619*                            ERCCOMP                             *
  1620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1621*                            VMOD=2.019                          *
  1622*                                                                *
  1623*   ONLINE CREDIT SYSTEM                                         *
  1624*                                                                *
  1625*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1626*                                                                *
  1627*   FILE TYPE = VSAM,KSDS                                        *
  1628*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1629*                                                                *
  1630*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1631*       ALTERNATE PATH = NONE                                    *
  1632*                                                                *
  1633*   LOG = NO                                                     *
  1634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1635*                                                                *
  1636******************************************************************
  1637*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  30
* NSRASBL.cbl
  1638*
  1639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1640*-----------------------------------------------------------------
  1641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1642* EFFECTIVE    NUMBER
  1643*-----------------------------------------------------------------
  1644* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1645* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1646* 092205    2005050300006  PEMA  ADD LEASE FEE
  1647* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1648* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1649* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1650* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1651* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1652* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1653******************************************************************
  1654
  1655 01  COMPENSATION-MASTER.
  1656     12  CO-RECORD-ID                          PIC XX.
  1657         88  VALID-CO-ID                          VALUE 'CO'.
  1658
  1659     12  CO-CONTROL-PRIMARY.
  1660         16  CO-COMPANY-CD                     PIC X.
  1661         16  CO-CONTROL.
  1662             20  CO-CTL-1.
  1663                 24  CO-CARR-GROUP.
  1664                     28  CO-CARRIER            PIC X.
  1665                     28  CO-GROUPING.
  1666                         32  CO-GROUP-PREFIX   PIC XXX.
  1667                         32  CO-GROUP-PRIME    PIC XXX.
  1668                 24  CO-RESP-NO.
  1669                     28  CO-RESP-PREFIX        PIC X(4).
  1670                     28  CO-RESP-PRIME         PIC X(6).
  1671             20  CO-CTL-2.
  1672                 24  CO-ACCOUNT.
  1673                     28  CO-ACCT-PREFIX        PIC X(4).
  1674                     28  CO-ACCT-PRIME         PIC X(6).
  1675         16  CO-TYPE                           PIC X.
  1676             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1677             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1678             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1679
  1680     12  CO-MAINT-INFORMATION.
  1681         16  CO-LAST-MAINT-DT                  PIC XX.
  1682         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1683         16  CO-LAST-MAINT-USER                PIC X(4).
  1684     12  FILLER                                PIC XX.
  1685     12  CO-STMT-TYPE                          PIC XXX.
  1686     12  CO-COMP-TYPE                          PIC X.
  1687         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1688     12  CO-STMT-OWNER                         PIC X(4).
  1689     12  CO-BALANCE-CONTROL                    PIC X.
  1690         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1691         88  CO-NO-BALANCE                        VALUE 'N'.
  1692
  1693     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1694         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1695         88  CO-AUTO-GENERATED                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  31
* NSRASBL.cbl
  1696         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1697
  1698     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1699         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1700         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1701
  1702     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1703     12  CO-GA-DIRECT-DEP                      PIC X.
  1704     12  CO-FUTURE-SPACE                       PIC X.
  1705         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1706
  1707     12  CO-ACCT-NAME                          PIC X(30).
  1708     12  CO-MAIL-NAME                          PIC X(30).
  1709     12  CO-ADDR-1                             PIC X(30).
  1710     12  CO-ADDR-2                             PIC X(30).
  1711     12  CO-ADDR-3.
  1712         16  CO-ADDR-CITY                      PIC X(27).
  1713         16  CO-ADDR-STATE                     PIC XX.
  1714     12  CO-CSO-1099                           PIC X.
  1715     12  CO-ZIP.
  1716         16  CO-ZIP-PRIME.
  1717             20  CO-ZIP-PRI-1ST                PIC X.
  1718                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1719             20  FILLER                        PIC X(4).
  1720         16  CO-ZIP-PLUS4                      PIC X(4).
  1721     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1722         16  CO-CAN-POSTAL-1                   PIC XXX.
  1723         16  CO-CAN-POSTAL-2                   PIC XXX.
  1724         16  FILLER                            PIC XXX.
  1725     12  CO-SOC-SEC                            PIC X(13).
  1726     12  CO-TELEPHONE.
  1727         16  CO-AREA-CODE                      PIC XXX.
  1728         16  CO-PREFIX                         PIC XXX.
  1729         16  CO-PHONE                          PIC X(4).
  1730
  1731     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1732
  1733     12  CO-AR-BAL-LEVEL                       PIC X.
  1734         88  CO-AR-REF-LVL                        VALUE '1'.
  1735         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1736         88  CO-AR-BILL-LVL                       VALUE '2'.
  1737         88  CO-AR-AGT-LVL                        VALUE '3'.
  1738         88  CO-AR-FR-LVL                         VALUE '4'.
  1739
  1740     12  CO-AR-NORMAL-PRINT                    PIC X.
  1741         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1742         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1743
  1744     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1745
  1746     12  CO-AR-REPORTING                       PIC X.
  1747         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1748         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1749
  1750     12  CO-AR-PULL-CHECK                      PIC X.
  1751         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1752         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1753
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  32
* NSRASBL.cbl
  1754     12  CO-AR-BALANCE-PRINT                   PIC X.
  1755         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1756
  1757     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1758         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1759         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1760         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1761
  1762     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1763
  1764     12  CO-USER-CODE                          PIC X.
  1765     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1766
  1767******************************************************************
  1768*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1769*    THE LAST MONTH END RUN.
  1770******************************************************************
  1771
  1772     12  CO-LAST-ACTIVITY-DATE.
  1773         16  CO-ACT-YEAR                       PIC 99.
  1774         16  CO-ACT-MONTH                      PIC 99.
  1775         16  CO-ACT-DAY                        PIC 99.
  1776
  1777     12  CO-LAST-STMT-DT.
  1778         16  CO-LAST-STMT-YEAR                 PIC 99.
  1779         16  CO-LAST-STMT-MONTH                PIC 99.
  1780         16  CO-LAST-STMT-DAY                  PIC 99.
  1781
  1782     12  CO-MO-END-TOTALS.
  1783         16  CO-MONTHLY-TOTALS.
  1784             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1785             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1786             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1787             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1788             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1789
  1790         16  CO-AGING-TOTALS.
  1791             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1792             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1793             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1794             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1795
  1796         16  CO-YTD-TOTALS.
  1797             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1798             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1799
  1800         16  CO-OVER-UNDER-TOTALS.
  1801             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1802             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1803
  1804     12  CO-MISCELLANEOUS-TOTALS.
  1805         16  CO-FICA-TOTALS.
  1806             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1807             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1808
  1809         16  CO-CLAIM-TOTALS.
  1810             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1811             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  33
* NSRASBL.cbl
  1812
  1813******************************************************************
  1814*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1815*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1816******************************************************************
  1817
  1818     12  CO-CURRENT-TOTALS.
  1819         16  CO-CURRENT-LAST-STMT-DT.
  1820             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1821             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1822             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1823
  1824         16  CO-CURRENT-MONTHLY-TOTALS.
  1825             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1826             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1827             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1828             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1830
  1831         16  CO-CURRENT-AGING-TOTALS.
  1832             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1833             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1834             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1835             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1836
  1837         16  CO-CURRENT-YTD-TOTALS.
  1838             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1839             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1840
  1841     12  CO-PAID-COMM-TOTALS.
  1842         16  CO-YTD-PAID-COMMS.
  1843             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1844             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1845
  1846     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1847         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1848         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1849
  1850     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1851         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1852         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1853         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1854         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1855         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1856         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1857         88  CO-FINAL-LETTER                  VALUE 'F'.
  1858         88  CO-RECONCILING                   VALUE 'R'.
  1859         88  CO-PHONE-CALL                    VALUE 'P'.
  1860         88  CO-LEGAL                         VALUE 'L'.
  1861         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1862         88  CO-WRITE-OFF                     VALUE 'W'.
  1863         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1864
  1865     12  CO-CSR-CODE                       PIC X(4).
  1866
  1867     12  CO-GA-STATUS-INFO.
  1868         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1869         16  CO-GA-TERMINATION-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  34
* NSRASBL.cbl
  1870         16  CO-GA-STATUS-CODE             PIC X.
  1871             88  CO-GA-ACTIVE                 VALUE 'A'.
  1872             88  CO-GA-INACTIVE               VALUE 'I'.
  1873             88  CO-GA-PENDING                VALUE 'P'.
  1874         16  CO-GA-COMMENTS.
  1875             20  CO-GA-COMMENT-1           PIC X(40).
  1876             20  CO-GA-COMMENT-2           PIC X(40).
  1877             20  CO-GA-COMMENT-3           PIC X(40).
  1878             20  CO-GA-COMMENT-4           PIC X(40).
  1879
  1880     12  CO-RPTCD2                         PIC X(10).
  1881     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1882         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1883         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1884
  1885     12  CO-TYPE-AGENT                     PIC X(01).
  1886         88  CO-CORPORATION                   VALUE 'C'.
  1887         88  CO-PARTNERSHIP                   VALUE 'P'.
  1888         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1889         88  CO-TRUST                         VALUE 'T'.
  1890         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1891
  1892     12  CO-FAXNO.
  1893         16  CO-FAX-AREA-CODE                  PIC XXX.
  1894         16  CO-FAX-PREFIX                     PIC XXX.
  1895         16  CO-FAX-PHONE                      PIC X(4).
  1896
  1897     12  CO-BANK-INFORMATION.
  1898         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1899         16  CO-BANK-TRANSIT-NON REDEFINES
  1900             CO-BANK-TRANSIT-NO                PIC 9(8).
  1901
  1902         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1903     12  CO-MISC-DEDUCT-INFO REDEFINES
  1904                  CO-BANK-INFORMATION.
  1905         16  CO-MD-GL-ACCT                     PIC X(10).
  1906         16  CO-MD-DIV                         PIC XX.
  1907         16  CO-MD-CENTER                      PIC X(4).
  1908         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1909         16  CO-CREATE-AP-CHECK                PIC X.
  1910         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1911         16  FILLER                            PIC XXX.
  1912     12  CO-ACH-STATUS                         PIC X.
  1913         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1914         88  CO-ACH-PENDING                        VALUE 'P'.
  1915
  1916     12  CO-BILL-SW                            PIC X.
  1917     12  CO-CONTROL-NAME                       PIC X(30).
  1918     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1919     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1920     12  CO-CLP-STATE                          PIC XX.
  1921     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1922     12  CO-SPP-REFUND-EDIT                    PIC X.
  1923
  1924******************************************************************
  1925*                                COPY ELCCERT.
  1926******************************************************************
  1927*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  35
* NSRASBL.cbl
  1928*                            ELCCERT.                            *
  1929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1930*                            VMOD=2.013                          *
  1931*                                                                *
  1932*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1933*                                                                *
  1934*   FILE TYPE = VSAM,KSDS                                        *
  1935*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1936*                                                                *
  1937*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1938*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1939*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1940*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1941*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1942*                                                                *
  1943*   LOG = YES                                                    *
  1944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1945******************************************************************
  1946*                   C H A N G E   L O G
  1947*
  1948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1949*-----------------------------------------------------------------
  1950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1951* EFFECTIVE    NUMBER
  1952*-----------------------------------------------------------------
  1953* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1954* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1955* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1956* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1957* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1958* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1959* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1960* 032612  CR2011110200001  PEMA  AHL CHANGES
  1961******************************************************************
  1962
  1963 01  CERTIFICATE-MASTER.
  1964     12  CM-RECORD-ID                      PIC XX.
  1965         88  VALID-CM-ID                      VALUE 'CM'.
  1966
  1967     12  CM-CONTROL-PRIMARY.
  1968         16  CM-COMPANY-CD                 PIC X.
  1969         16  CM-CARRIER                    PIC X.
  1970         16  CM-GROUPING.
  1971             20  CM-GROUPING-PREFIX        PIC X(3).
  1972             20  CM-GROUPING-PRIME         PIC X(3).
  1973         16  CM-STATE                      PIC XX.
  1974         16  CM-ACCOUNT.
  1975             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1976             20  CM-ACCOUNT-PRIME          PIC X(6).
  1977         16  CM-CERT-EFF-DT                PIC XX.
  1978         16  CM-CERT-NO.
  1979             20  CM-CERT-PRIME             PIC X(10).
  1980             20  CM-CERT-SFX               PIC X.
  1981
  1982     12  CM-CONTROL-BY-NAME.
  1983         16  CM-COMPANY-CD-A1              PIC X.
  1984         16  CM-INSURED-LAST-NAME          PIC X(15).
  1985         16  CM-INSURED-INITIALS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  36
* NSRASBL.cbl
  1986             20  CM-INSURED-INITIAL1       PIC X.
  1987             20  CM-INSURED-INITIAL2       PIC X.
  1988
  1989     12  CM-CONTROL-BY-SSN.
  1990         16  CM-COMPANY-CD-A2              PIC X.
  1991         16  CM-SOC-SEC-NO.
  1992             20  CM-SSN-STATE              PIC XX.
  1993             20  CM-SSN-ACCOUNT            PIC X(6).
  1994             20  CM-SSN-LN3.
  1995                 25  CM-INSURED-INITIALS-A2.
  1996                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1997                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1998                 25 CM-PART-LAST-NAME-A2         PIC X.
  1999
  2000     12  CM-CONTROL-BY-CERT-NO.
  2001         16  CM-COMPANY-CD-A4              PIC X.
  2002         16  CM-CERT-NO-A4                 PIC X(11).
  2003
  2004     12  CM-CONTROL-BY-MEMB.
  2005         16  CM-COMPANY-CD-A5              PIC X.
  2006         16  CM-MEMBER-NO.
  2007             20  CM-MEMB-STATE             PIC XX.
  2008             20  CM-MEMB-ACCOUNT           PIC X(6).
  2009             20  CM-MEMB-LN4.
  2010                 25  CM-INSURED-INITIALS-A5.
  2011                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2012                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2013                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2014
  2015     12  CM-INSURED-PROFILE-DATA.
  2016         16  CM-INSURED-FIRST-NAME.
  2017             20  CM-INSURED-1ST-INIT       PIC X.
  2018             20  FILLER                    PIC X(9).
  2019         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2020         16  CM-INSURED-SEX                PIC X.
  2021             88  CM-SEX-MALE                  VALUE 'M'.
  2022             88  CM-SEX-FEMAL                 VALUE 'F'.
  2023         16  CM-INSURED-JOINT-AGE          PIC 99.
  2024         16  CM-JOINT-INSURED-NAME.
  2025             20  CM-JT-LAST-NAME           PIC X(15).
  2026             20  CM-JT-FIRST-NAME.
  2027                 24  CM-JT-1ST-INIT        PIC X.
  2028                 24  FILLER                PIC X(9).
  2029             20  CM-JT-INITIAL             PIC X.
  2030
  2031     12  CM-LIFE-DATA.
  2032         16  CM-LF-BENEFIT-CD              PIC XX.
  2033         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2034         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2035         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2036         16  CM-LF-DEV-CODE                PIC XXX.
  2037         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2038         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2039         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2040         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2041         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2042         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2043         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  37
* NSRASBL.cbl
  2044         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2045         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2046         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2047         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2048         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2049         16  FILLER                        PIC XX.
  2050
  2051     12  CM-AH-DATA.
  2052         16  CM-AH-BENEFIT-CD              PIC XX.
  2053         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2054         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2055         16  CM-AH-DEV-CODE                PIC XXX.
  2056         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2057         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2058         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2059         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2060         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2061         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2062         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2063         16  CM-AH-PAID-THRU-DT            PIC XX.
  2064             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2065         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2066         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2067         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2068         16  FILLER                        PIC X.
  2069
  2070     12  CM-LOAN-INFORMATION.
  2071         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2072         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2073                                           PIC S9(5)V99  COMP-3.
  2074         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2075         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2076         16  CM-PAY-FREQUENCY              PIC S99.
  2077         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2078         16  CM-RATE-CLASS                 PIC XX.
  2079         16  CM-BENEFICIARY                PIC X(25).
  2080         16  CM-POLICY-FORM-NO             PIC X(12).
  2081         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2082         16  CM-LAST-ADD-ON-DT             PIC XX.
  2083         16  CM-DEDUCTIBLE-AMOUNTS.
  2084             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2085             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2086         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2087             20  CM-RESIDENT-STATE         PIC XX.
  2088             20  CM-RATE-CODE              PIC X(4).
  2089             20  FILLER                    PIC XX.
  2090         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2091             20  CM-LOAN-OFFICER           PIC X(5).
  2092             20  FILLER                    PIC XXX.
  2093         16  CM-CSR-CODE                   PIC XXX.
  2094         16  CM-UNDERWRITING-CODE          PIC X.
  2095             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2096         16  CM-POST-CARD-IND              PIC X.
  2097         16  CM-NH-INTERFACE-SW            PIC X.
  2098         16  CM-PREMIUM-TYPE               PIC X.
  2099             88  CM-SING-PRM                  VALUE '1'.
  2100             88  CM-O-B-COVERAGE              VALUE '2'.
  2101             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  38
* NSRASBL.cbl
  2102         16  CM-IND-GRP-TYPE               PIC X.
  2103             88  CM-INDIVIDUAL                VALUE 'I'.
  2104             88  CM-GROUP                     VALUE 'G'.
  2105         16  CM-SKIP-CODE                  PIC X.
  2106             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2107             88  SKIP-JULY                    VALUE '1'.
  2108             88  SKIP-AUGUST                  VALUE '2'.
  2109             88  SKIP-SEPTEMBER               VALUE '3'.
  2110             88  SKIP-JULY-AUG                VALUE '4'.
  2111             88  SKIP-AUG-SEPT                VALUE '5'.
  2112             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2113             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2114             88  SKIP-JUNE                    VALUE '8'.
  2115             88  SKIP-JUNE-JULY               VALUE '9'.
  2116             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2117             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2118         16  CM-PAYMENT-MODE               PIC X.
  2119             88  PAY-MONTHLY                  VALUE SPACE.
  2120             88  PAY-WEEKLY                   VALUE '1'.
  2121             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2122             88  PAY-BI-WEEKLY                VALUE '3'.
  2123             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2124         16  CM-LOAN-NUMBER                PIC X(8).
  2125         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2126         16  CM-OLD-LOF                    PIC XXX.
  2127*        16  CM-LOAN-OFFICER               PIC XXX.
  2128         16  CM-REIN-TABLE                 PIC XXX.
  2129         16  CM-SPECIAL-REIN-CODE          PIC X.
  2130         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2131         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2132         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2133
  2134     12  CM-STATUS-DATA.
  2135         16  CM-ENTRY-STATUS               PIC X.
  2136         16  CM-ENTRY-DT                   PIC XX.
  2137
  2138         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2139         16  CM-LF-CANCEL-DT               PIC XX.
  2140         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2141
  2142         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2143         16  CM-LF-DEATH-DT                PIC XX.
  2144         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2145
  2146         16  CM-LF-CURRENT-STATUS          PIC X.
  2147             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2148                                                'M' '4' '5' '9'.
  2149             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2150             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2151             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2152             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2153             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2154             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2155             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2156             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2157             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2158             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2159             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  39
* NSRASBL.cbl
  2160             88  CM-LF-VOIDED                 VALUE 'V'.
  2161
  2162         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2163         16  CM-AH-CANCEL-DT               PIC XX.
  2164         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2165
  2166         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2167         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2168         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2169
  2170         16  CM-AH-CURRENT-STATUS          PIC X.
  2171             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2172                                                'M' '4' '5' '9'.
  2173             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2174             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2175             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2176             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2177             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2178             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2179             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2180             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2181             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2182             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2183             88  CM-AH-DECLINED               VALUE 'D'.
  2184             88  CM-AH-VOIDED                 VALUE 'V'.
  2185
  2186         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2187             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2188             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2189             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2190         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2191
  2192         16  CM-ENTRY-BATCH                PIC X(6).
  2193         16  CM-LF-EXIT-BATCH              PIC X(6).
  2194         16  CM-AH-EXIT-BATCH              PIC X(6).
  2195         16  CM-LAST-MONTH-END             PIC XX.
  2196
  2197     12  CM-NOTE-SW                        PIC X.
  2198         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2199         88  CERT-NOTES-PRESENT               VALUE '1'.
  2200         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2201         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2202         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2203         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2204         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2205         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2206     12  CM-COMP-EXCP-SW                   PIC X.
  2207         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2208         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2209     12  CM-INSURED-ADDRESS-SW             PIC X.
  2210         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2211         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2212
  2213*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2214     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2215     12  FILLER                            PIC X.
  2216
  2217*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  40
* NSRASBL.cbl
  2218     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2219     12  FILLER                            PIC X.
  2220*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2221     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2222
  2223     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2224         88  CERT-ADDED-BATCH                 VALUE ' '.
  2225         88  CERT-ADDED-ONLINE                VALUE '1'.
  2226         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2227         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2228         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2229     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2230         88  CERT-AS-LOADED                   VALUE ' '.
  2231         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2232         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2233         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2234         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2235         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2236         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2237         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2238
  2239     12  CM-ACCOUNT-COMM-PCTS.
  2240         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2241         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2242
  2243     12  CM-USER-FIELD                     PIC X.
  2244     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2245     12  CM-CLP-STATE                      PIC XX.
  2246     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2247     12  CM-USER-RESERVED                  PIC XXX.
  2248     12  FILLER REDEFINES CM-USER-RESERVED.
  2249         16  CM-AH-CLASS-CD                PIC XX.
  2250         16  F                             PIC X.
  2251******************************************************************
  2252*                                COPY ELCCRTO.
  2253******************************************************************
  2254*                                                                *
  2255*                            ELCCRTO.                            *
  2256*                                                                *
  2257*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2258*                                                                *
  2259*   FILE TYPE = VSAM,KSDS                                        *
  2260*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2261*                                                                *
  2262*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2263*                                                                *
  2264*   LOG = YES                                                    *
  2265*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2266******************************************************************
  2267*                   C H A N G E   L O G
  2268*
  2269* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2270*-----------------------------------------------------------------
  2271*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2272* EFFECTIVE    NUMBER
  2273*-----------------------------------------------------------------
  2274* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2275* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  41
* NSRASBL.cbl
  2276* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2277* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2278* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2279******************************************************************
  2280 01  ORIGINAL-CERTIFICATE.
  2281     12  OC-RECORD-ID                      PIC XX.
  2282         88  VALID-OC-ID                      VALUE 'OC'.
  2283     12  OC-CONTROL-PRIMARY.
  2284         16  OC-COMPANY-CD                 PIC X.
  2285         16  OC-CARRIER                    PIC X.
  2286         16  OC-GROUPING                   PIC X(6).
  2287         16  OC-STATE                      PIC XX.
  2288         16  OC-ACCOUNT                    PIC X(10).
  2289         16  OC-CERT-EFF-DT                PIC XX.
  2290         16  OC-CERT-NO.
  2291             20  OC-CERT-PRIME             PIC X(10).
  2292             20  OC-CERT-SFX               PIC X.
  2293         16  OC-RECORD-TYPE                PIC X.
  2294         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2295     12  OC-LAST-MAINT-DT                  PIC XX.
  2296     12  OC-LAST-MAINT-BY                  PIC X(4).
  2297     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2298     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2299     12  FILLER                            PIC X(49).
  2300     12  OC-ORIG-REC.
  2301         16  OC-INS-LAST-NAME              PIC X(15).
  2302         16  OC-INS-FIRST-NAME             PIC X(10).
  2303         16  OC-INS-MIDDLE-INIT            PIC X.
  2304         16  OC-INS-AGE                    PIC S999     COMP-3.
  2305         16  OC-JNT-LAST-NAME              PIC X(15).
  2306         16  OC-JNT-FIRST-NAME             PIC X(10).
  2307         16  OC-JNT-MIDDLE-INIT            PIC X.
  2308         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2309         16  OC-LF-BENCD                   PIC XX.
  2310         16  OC-LF-TERM                    PIC S999      COMP-3.
  2311         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2312         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2313         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2314         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2315         16  OC-LF-EXP-DT                  PIC XX.
  2316         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2317         16  OC-LF-CANCEL-DT               PIC XX.
  2318         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2319         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2320         16  OC-AH-BENCD                   PIC XX.
  2321         16  OC-AH-TERM                    PIC S999      COMP-3.
  2322         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2323         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2324         16  OC-AH-EXP-DT                  PIC XX.
  2325         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2326         16  OC-AH-CP                      PIC 99.
  2327         16  OC-AH-CANCEL-DT               PIC XX.
  2328         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2329         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2330         16  OC-CRED-BENE-NAME             PIC X(25).
  2331         16  OC-1ST-PMT-DT                 PIC XX.
  2332         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  2333         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  42
* NSRASBL.cbl
  2334         16  OC-ISSUE-TRAN-IND             PIC X.
  2335         16  OC-CANCEL-TRAN-IND            PIC X.
  2336         16  FILLER                        PIC X(211).
  2337
  2338     12  FILLER                            PIC X(50).
  2339******************************************************************
  2340*                                COPY ERCACCT.
  2341******************************************************************
  2342*                                                                *
  2343*                                                                *
  2344*                            ERCACCT                             *
  2345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2346*                            VMOD=2.031                          *
  2347*                                                                *
  2348*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2349*                                                                *
  2350*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2351*   VSAM ACCOUNT MASTER FILES.                                   *
  2352*                                                                *
  2353*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2354*                                                                *
  2355*   FILE TYPE = VSAM,KSDS                                        *
  2356*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2357*                                                                *
  2358*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2359*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2360*                                                                *
  2361*   LOG = NO                                                     *
  2362*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2363*                                                                *
  2364*                                                                *
  2365******************************************************************
  2366*                   C H A N G E   L O G
  2367*
  2368* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2369*-----------------------------------------------------------------
  2370*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2371* EFFECTIVE    NUMBER
  2372*-----------------------------------------------------------------
  2373* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2374* 092705    2005050300006  PEMA  ADD SPP LEASES
  2375* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2376* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2377* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2378* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2379* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2380******************************************************************
  2381
  2382 01  ACCOUNT-MASTER.
  2383     12  AM-RECORD-ID                      PIC XX.
  2384         88  VALID-AM-ID                      VALUE 'AM'.
  2385
  2386     12  AM-CONTROL-PRIMARY.
  2387         16  AM-COMPANY-CD                 PIC X.
  2388         16  AM-MSTR-CNTRL.
  2389             20  AM-CONTROL-A.
  2390                 24  AM-CARRIER            PIC X.
  2391                 24  AM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  43
* NSRASBL.cbl
  2392                     28 AM-GROUPING-PREFIX PIC XXX.
  2393                     28 AM-GROUPING-PRIME  PIC XXX.
  2394                 24  AM-STATE              PIC XX.
  2395                 24  AM-ACCOUNT.
  2396                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2397                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2398             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2399                                           PIC X(19).
  2400             20  AM-CNTRL-B.
  2401                 24  AM-EXPIRATION-DT      PIC XX.
  2402                 24  FILLER                PIC X(4).
  2403             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2404                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2405
  2406     12  AM-CONTROL-BY-VAR-GRP.
  2407         16  AM-COMPANY-CD-A1              PIC X.
  2408         16  AM-VG-CARRIER                 PIC X.
  2409         16  AM-VG-GROUPING                PIC X(6).
  2410         16  AM-VG-STATE                   PIC XX.
  2411         16  AM-VG-ACCOUNT                 PIC X(10).
  2412         16  AM-VG-DATE.
  2413             20  AM-VG-EXPIRATION-DT       PIC XX.
  2414             20  FILLER                    PIC X(4).
  2415         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2416                                           PIC 9(11)      COMP-3.
  2417     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2418         16  FILLER                        PIC X(10).
  2419         16  AM-VG-KEY3.
  2420             20  AM-VG3-ACCOUNT            PIC X(10).
  2421             20  AM-VG3-EXP-DT             PIC XX.
  2422         16  FILLER                        PIC X(4).
  2423     12  AM-MAINT-INFORMATION.
  2424         16  AM-LAST-MAINT-DT              PIC XX.
  2425         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2426         16  AM-LAST-MAINT-USER            PIC X(4).
  2427         16  FILLER                        PIC XX.
  2428
  2429     12  AM-EFFECTIVE-DT                   PIC XX.
  2430     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2431
  2432     12  AM-PREV-DATES  COMP-3.
  2433         16  AM-PREV-EXP-DT                PIC 9(11).
  2434         16  AM-PREV-EFF-DT                PIC 9(11).
  2435
  2436     12  AM-REPORT-CODE-1                  PIC X(10).
  2437     12  AM-REPORT-CODE-2                  PIC X(10).
  2438
  2439     12  AM-CITY-CODE                      PIC X(4).
  2440     12  AM-COUNTY-PARISH                  PIC X(6).
  2441
  2442     12  AM-NAME                           PIC X(30).
  2443     12  AM-PERSON                         PIC X(30).
  2444     12  AM-ADDRS                          PIC X(30).
  2445     12  AM-CITY.
  2446         16  AM-ADDR-CITY                  PIC X(28).
  2447         16  AM-ADDR-STATE                 PIC XX.
  2448     12  AM-ZIP.
  2449         16  AM-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  44
* NSRASBL.cbl
  2450             20  AM-ZIP-PRI-1ST            PIC X.
  2451                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2452             20  FILLER                    PIC X(4).
  2453         16  AM-ZIP-PLUS4                  PIC X(4).
  2454     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2455         16  AM-CAN-POSTAL-1               PIC XXX.
  2456         16  AM-CAN-POSTAL-2               PIC XXX.
  2457         16  FILLER                        PIC XXX.
  2458     12  AM-TEL-NO.
  2459         16  AM-AREA-CODE                  PIC 999.
  2460         16  AM-TEL-PRE                    PIC 999.
  2461         16  AM-TEL-NBR                    PIC 9(4).
  2462     12  AM-TEL-LOC                        PIC X.
  2463         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2464         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2465
  2466     12  AM-COMM-STRUCTURE.
  2467         16  AM-DEFN-1.
  2468             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2469                 24  AM-AGT.
  2470                     28  AM-AGT-PREFIX     PIC X(4).
  2471                     28  AM-AGT-PRIME      PIC X(6).
  2472                 24  AM-COM-TYP            PIC X.
  2473                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2474                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2475                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2476                 24  AM-RECALC-LV-INDIC    PIC X.
  2477                 24  AM-RETRO-LV-INDIC     PIC X.
  2478                 24  AM-GL-CODES           PIC X.
  2479                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2480                 24  FILLER                PIC X(01).
  2481         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2482             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2483                 24  FILLER                PIC X(11).
  2484                 24  AM-L-COMA             PIC XXX.
  2485                 24  AM-J-COMA             PIC XXX.
  2486                 24  AM-A-COMA             PIC XXX.
  2487                 24  FILLER                PIC X(6).
  2488
  2489     12  AM-COMM-CHANGE-STATUS             PIC X.
  2490         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2491
  2492     12  AM-CSR-CODE                       PIC X(4).
  2493
  2494     12  AM-BILLING-STATUS                 PIC X.
  2495         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2496         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2497     12  AM-AUTO-REFUND-SW                 PIC X.
  2498         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2499         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2500     12  AM-GPCD                           PIC 99.
  2501     12  AM-IG                             PIC X.
  2502         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2503         88  AM-HAS-GROUP                     VALUE '2'.
  2504     12  AM-STATUS                         PIC X.
  2505         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2506         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2507         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  45
* NSRASBL.cbl
  2508         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2509         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2510         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2511     12  AM-REMIT-TO                       PIC 99.
  2512     12  AM-ID-NO                          PIC X(11).
  2513
  2514     12  AM-CAL-TABLE                      PIC XX.
  2515     12  AM-LF-DEVIATION                   PIC XXX.
  2516     12  AM-AH-DEVIATION                   PIC XXX.
  2517     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2518     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2519     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2520     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2521     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2522     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2523
  2524     12  AM-USER-FIELDS.
  2525         16  AM-FLD-1                      PIC XX.
  2526         16  AM-FLD-2                      PIC XX.
  2527         16  AM-FLD-3                      PIC XX.
  2528         16  AM-FLD-4                      PIC XX.
  2529         16  AM-FLD-5                      PIC XX.
  2530
  2531     12  AM-1ST-PROD-DATE.
  2532         16  AM-1ST-PROD-YR                PIC XX.
  2533         16  AM-1ST-PROD-MO                PIC XX.
  2534         16  AM-1ST-PROD-DA                PIC XX.
  2535     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2536     12  AM-CERTS-PURGED-DATE.
  2537         16  AM-PUR-YR                     PIC XX.
  2538         16  AM-PUR-MO                     PIC XX.
  2539         16  AM-PUR-DA                     PIC XX.
  2540     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2541     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2542     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2543     12  AM-INACTIVE-DATE.
  2544         16  AM-INA-MO                     PIC 99.
  2545         16  AM-INA-DA                     PIC 99.
  2546         16  AM-INA-YR                     PIC 99.
  2547     12  AM-AR-HI-CERT-DATE                PIC XX.
  2548
  2549     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2550     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2551
  2552     12  AM-OB-PAYMENT-MODE                PIC X.
  2553         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2554         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2555         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2556         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2557
  2558     12  AM-AH-ONLY-INDICATOR              PIC X.
  2559         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2560         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2561
  2562     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2563
  2564     12  AM-OVER-SHORT.
  2565         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  46
* NSRASBL.cbl
  2566         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2567
  2568     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2569     12  AM-DCC-CLP-STATE                  PIC XX.
  2570
  2571     12  AM-RECALC-COMM                    PIC X.
  2572     12  AM-RECALC-REIN                    PIC X.
  2573
  2574     12  AM-REI-TABLE                      PIC XXX.
  2575     12  AM-REI-ET-LF                      PIC X.
  2576     12  AM-REI-ET-AH                      PIC X.
  2577     12  AM-REI-PE-LF                      PIC X.
  2578     12  AM-REI-PE-AH                      PIC X.
  2579     12  AM-REI-PRT-ST                     PIC X.
  2580     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2581     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2582     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2583     12  AM-REI-GROUP-A                    PIC X(6).
  2584     12  AM-REI-MORT                       PIC X(4).
  2585     12  AM-REI-PRT-OW                     PIC X.
  2586     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2587     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2588     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2589     12  AM-REI-GROUP-B                    PIC X(6).
  2590
  2591     12  AM-TRUST-TYPE                     PIC X(2).
  2592
  2593     12  AM-EMPLOYER-STMT-USED             PIC X.
  2594     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2595
  2596     12  AM-STD-AH-TYPE                    PIC XX.
  2597     12  AM-EARN-METHODS.
  2598         16  AM-EARN-METHOD-R              PIC X.
  2599             88 AM-REF-RL-R78                 VALUE 'R'.
  2600             88 AM-REF-RL-PR                  VALUE 'P'.
  2601             88 AM-REF-RL-MEAN                VALUE 'M'.
  2602             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2603         16  AM-EARN-METHOD-L              PIC X.
  2604             88 AM-REF-LL-R78                 VALUE 'R'.
  2605             88 AM-REF-LL-PR                  VALUE 'P'.
  2606             88 AM-REF-LL-MEAN                VALUE 'M'.
  2607             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2608         16  AM-EARN-METHOD-A              PIC X.
  2609             88 AM-REF-AH-R78                 VALUE 'R'.
  2610             88 AM-REF-AH-PR                  VALUE 'P'.
  2611             88 AM-REF-AH-MEAN                VALUE 'M'.
  2612             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2613             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2614             88 AM-REF-AH-NET                 VALUE 'N'.
  2615
  2616     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2617     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2618     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2619
  2620     12  AM-RET-Y-N                        PIC X.
  2621     12  AM-RET-P-E                        PIC X.
  2622     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2623     12  AM-AH-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  47
* NSRASBL.cbl
  2624     12  AM-RET-GRP                        PIC X(6).
  2625     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2626         16  AM-POOL-PRIME                 PIC XXX.
  2627         16  AM-POOL-SUB                   PIC XXX.
  2628     12  AM-RETRO-EARNINGS.
  2629         16  AM-RET-EARN-R                 PIC X.
  2630         16  AM-RET-EARN-L                 PIC X.
  2631         16  AM-RET-EARN-A                 PIC X.
  2632     12  AM-RET-ST-TAX-USE                 PIC X.
  2633         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2634         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2635     12  AM-RETRO-BEG-EARNINGS.
  2636         16  AM-RET-BEG-EARN-R             PIC X.
  2637         16  AM-RET-BEG-EARN-L             PIC X.
  2638         16  AM-RET-BEG-EARN-A             PIC X.
  2639     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2640     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2641
  2642     12  AM-USER-SELECT-OPTIONS.
  2643         16  AM-USER-SELECT-1              PIC X(10).
  2644         16  AM-USER-SELECT-2              PIC X(10).
  2645         16  AM-USER-SELECT-3              PIC X(10).
  2646         16  AM-USER-SELECT-4              PIC X(10).
  2647         16  AM-USER-SELECT-5              PIC X(10).
  2648
  2649     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2650
  2651     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2652
  2653     12  AM-RPT045A-SWITCH                 PIC X.
  2654         88  RPT045A-OFF                   VALUE 'N'.
  2655
  2656     12  AM-INSURANCE-LIMITS.
  2657         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2658         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2659
  2660     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2661         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2662
  2663     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2664         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2665         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2666
  2667     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2668
  2669     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2670     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2671     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2672     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2673     12  AM-DCC-UEF-STATE                  PIC XX.
  2674     12  FILLER                            PIC XXX.
  2675     12  AM-REPORT-CODE-3                  PIC X(10).
  2676*    12  FILLER                            PIC X(22).
  2677
  2678     12  AM-RESERVE-DATE.
  2679         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2680         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2681         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  48
* NSRASBL.cbl
  2682
  2683     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2684     12  AM-NOTIFICATION-TYPES.
  2685         16  AM-NOTIF-OF-LETTERS           PIC X.
  2686         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2687         16  AM-NOTIF-OF-REPORTS           PIC X.
  2688         16  AM-NOTIF-OF-STATUS            PIC X.
  2689
  2690     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2691         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2692         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2693         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2694         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2695
  2696     12  AM-BENEFIT-CONTROLS.
  2697         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2698             20  AM-BENEFIT-CODE           PIC XX.
  2699             20  AM-BENEFIT-TYPE           PIC X.
  2700             20  AM-BENEFIT-REVISION       PIC XXX.
  2701             20  AM-BENEFIT-REM-TERM       PIC X.
  2702             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2703             20  FILLER                    PIC XX.
  2704         16  FILLER                        PIC X(80).
  2705
  2706     12  AM-TRANSFER-DATA.
  2707         16  AM-TRANSFERRED-FROM.
  2708             20  AM-TRNFROM-CARRIER        PIC X.
  2709             20  AM-TRNFROM-GROUPING.
  2710                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2711                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2712             20  AM-TRNFROM-STATE          PIC XX.
  2713             20  AM-TRNFROM-ACCOUNT.
  2714                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2715                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2716             20  AM-TRNFROM-DTE            PIC XX.
  2717         16  AM-TRANSFERRED-TO.
  2718             20  AM-TRNTO-CARRIER          PIC X.
  2719             20  AM-TRNTO-GROUPING.
  2720                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2721                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2722             20  AM-TRNTO-STATE            PIC XX.
  2723             20  AM-TRNTO-ACCOUNT.
  2724                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2725                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2726             20  AM-TRNTO-DTE              PIC XX.
  2727         16  FILLER                        PIC X(10).
  2728
  2729     12  AM-SAVED-REMIT-TO                 PIC 99.
  2730
  2731     12  AM-COMM-STRUCTURE-SAVED.
  2732         16  AM-DEFN-1-SAVED.
  2733             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2734                 24  AM-AGT-SV             PIC X(10).
  2735                 24  AM-COM-TYP-SV         PIC X.
  2736                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2737                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2738                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2739                 24  AM-RECALC-LV-INDIC-SV PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  49
* NSRASBL.cbl
  2740                 24  FILLER                PIC X.
  2741                 24  AM-GL-CODES-SV        PIC X.
  2742                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2743                 24  FILLER                PIC X.
  2744         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2745             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2746                 24  FILLER                PIC X(11).
  2747                 24  AM-L-COMA-SV          PIC XXX.
  2748                 24  AM-J-COMA-SV          PIC XXX.
  2749                 24  AM-A-COMA-SV          PIC XXX.
  2750                 24  FILLER                PIC X(6).
  2751
  2752     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2753         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2754            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2755            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2756            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2757
  2758     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2759     12  FILLER                            PIC X(120).
  2760
  2761     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2762         16  AM-CONTROL-NAME               PIC X(30).
  2763         16  AM-EXECUTIVE-ONE.
  2764             20  AM-EXEC1-NAME             PIC X(15).
  2765             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2766                                                          COMP-3.
  2767             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2768                                                          COMP-3.
  2769         16  AM-EXECUTIVE-TWO.
  2770             20  AM-EXEC2-NAME             PIC X(15).
  2771             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2772                                                          COMP-3.
  2773             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2774                                                          COMP-3.
  2775
  2776     12  AM-RETRO-ADDITIONAL-DATA.
  2777         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2778         16  AM-RETRO-PREM-P-E             PIC X.
  2779         16  AM-RETRO-CLMS-P-I             PIC X.
  2780         16  AM-RETRO-RET-BRACKET-LF.
  2781             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2782                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2783                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2784             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2785                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2786                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2787             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2788                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2789                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2790         16  AM-RETRO-RET-BRACKET-AH.
  2791             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2792                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2793                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2794                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2795             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2796                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2797                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  50
* NSRASBL.cbl
  2798             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2799                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2800                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2801
  2802     12  AM-COMMENTS.
  2803         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2804
  2805     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2806         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2807         16  AM-FLI-BILLING-CODE           PIC X.
  2808         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2809         16  AM-FLI-UNITED-IDENT           PIC X.
  2810         16  AM-FLI-INTEREST-LOST-DATA.
  2811             20  AM-FLI-BANK-NO            PIC X(5).
  2812             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2813             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2814             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2815         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2816             20  AM-FLI-AGT                PIC X(9).
  2817             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2818             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2819         16  FILLER                        PIC X(102).
  2820
  2821     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2822         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2823             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2824             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2825             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2826             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2827             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2828         16  FILLER                          PIC X(10).
  2829******************************************************************
  2830*                                COPY ELCTEXT.
  2831******************************************************************
  2832*                                                                *
  2833*                                                                *
  2834*                            ELCTEXT.                            *
  2835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2836*                            VMOD=2.008                          *
  2837*                                                                *
  2838*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2839*                                     FORM LETTERS,              *
  2840*                                     CERT FORM DISPLAY.
  2841*                                                                *
  2842*   FILE TYPE = VSAM,KSDS                                        *
  2843*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2844*                                                                *
  2845*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2846*       ALTERNATE INDEX = NONE                                   *
  2847*                                                                *
  2848*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2849*       ALTERNATE INDEX = NONE                                   *
  2850*                                                                *
  2851*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2852*       ALTERNATE INDEX = NONE                                   *
  2853*                                                                *
  2854*   LOG = NO                                                     *
  2855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  51
* NSRASBL.cbl
  2856******************************************************************
  2857 01  TEXT-FILES.
  2858     12  TEXT-FILE-ID                PIC XX.
  2859         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2860         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2861         88  HELP-FILE-TEXT             VALUE 'TH'.
  2862
  2863     12  TX-CONTROL-PRIMARY.
  2864         16  TX-COMPANY-CD           PIC X.
  2865             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2866         16  TX-ACCESS-CD-GENL       PIC X(12).
  2867
  2868         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2869             20  TX-LETTER-NO        PIC X(4).
  2870             20  FILLER              PIC X(8).
  2871
  2872         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2873             20  TX-FORM-NO          PIC X(12).
  2874
  2875         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2876             20  TX-HELP-TYPE        PIC X.
  2877                 88  HELP-FOR-GENERAL   VALUE ' '.
  2878                 88  HELP-BY-SCREEN     VALUE 'S'.
  2879                 88  HELP-BY-ERROR      VALUE 'E'.
  2880             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2881                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2882             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2883                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2884             20  FILLER              PIC X(4).
  2885
  2886         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2887
  2888     12  TX-PROCESS-CONTROL          PIC XX.
  2889         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2890
  2891     12  TX-TEXT-LINE                PIC X(70).
  2892
  2893     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2894         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2895         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2896         88  TX-VALID-FORM-SQUEEZE-VALUE
  2897                                        VALUE 'Y' ' '.
  2898
  2899     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2900         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2901         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2902         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2903         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2904         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2905         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2906         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2907                                              'K' 'N' ' '
  2908                                              'Z'.
  2909
  2910     12  TX-ARCHIVE-SW               PIC X.
  2911         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2912         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2913         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  52
* NSRASBL.cbl
  2914
  2915     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2916     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2917
  2918     12  TX-BSR-CODE                 PIC X.
  2919         88  TX-BSR-LETTER              VALUE 'B'.
  2920         88  TX-NON-BSR-LETTER          VALUE ' '.
  2921
  2922     12  FILLER                      PIC X.
  2923*****************************************************************
  2924*                                COPY ELCCNTL.
  2925******************************************************************
  2926*                                                                *
  2927*                                                                *
  2928*                            ELCCNTL.                            *
  2929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2930*                            VMOD=2.059                          *
  2931*                                                                *
  2932*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2933*                                                                *
  2934*   FILE TYPE = VSAM,KSDS                                        *
  2935*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2936*                                                                *
  2937*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2938*       ALTERNATE INDEX = NONE                                   *
  2939*                                                                *
  2940*   LOG = YES                                                    *
  2941*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2942******************************************************************
  2943*                   C H A N G E   L O G
  2944*
  2945* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2946*-----------------------------------------------------------------
  2947*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2948* EFFECTIVE    NUMBER
  2949*-----------------------------------------------------------------
  2950* 082503                   PEMA  ADD BENEFIT GROUP
  2951* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2952* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2953* 092705    2005050300006  PEMA  ADD SPP LEASES
  2954* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2955* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2956* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2957* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2958* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2959* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2960* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2961* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2962* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2963******************************************************************
  2964*
  2965 01  CONTROL-FILE.
  2966     12  CF-RECORD-ID                       PIC XX.
  2967         88  VALID-CF-ID                        VALUE 'CF'.
  2968
  2969     12  CF-CONTROL-PRIMARY.
  2970         16  CF-COMPANY-ID                  PIC XXX.
  2971         16  CF-RECORD-TYPE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  53
* NSRASBL.cbl
  2972             88  CF-COMPANY-MASTER              VALUE '1'.
  2973             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2974             88  CF-STATE-MASTER                VALUE '3'.
  2975             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2976             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2977             88  CF-CARRIER-MASTER              VALUE '6'.
  2978             88  CF-MORTALITY-MASTER            VALUE '7'.
  2979             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2980             88  CF-TERMINAL-MASTER             VALUE '9'.
  2981             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2982             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2983             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2984             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2985             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2986             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2987             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2988             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2989             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2990         16  CF-ACCESS-CD-GENL              PIC X(4).
  2991         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2992             20  CF-PROCESSOR               PIC X(4).
  2993         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2994             20  CF-STATE-CODE              PIC XX.
  2995             20  FILLER                     PIC XX.
  2996         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2997             20  FILLER                     PIC XX.
  2998             20  CF-HI-BEN-IN-REC           PIC XX.
  2999         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3000             20  FILLER                     PIC XXX.
  3001             20  CF-CARRIER-CNTL            PIC X.
  3002         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3003             20  FILLER                     PIC XX.
  3004             20  CF-HI-TYPE-IN-REC          PIC 99.
  3005         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3006             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3007                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3008             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3009             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3010         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3011             20  FILLER                     PIC X.
  3012             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3013         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3014             20  FILLER                     PIC XX.
  3015             20  CF-MORTGAGE-PLAN           PIC XX.
  3016         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3017
  3018     12  CF-LAST-MAINT-DT                   PIC XX.
  3019     12  CF-LAST-MAINT-BY                   PIC X(4).
  3020     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3021
  3022     12  CF-RECORD-BODY                     PIC X(728).
  3023
  3024
  3025****************************************************************
  3026*             COMPANY MASTER RECORD                            *
  3027****************************************************************
  3028
  3029     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  54
* NSRASBL.cbl
  3030         16  CF-COMPANY-ADDRESS.
  3031             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3032             20  CF-CL-IN-CARE-OF           PIC X(30).
  3033             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3034             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3035             20  CF-CL-CITY-STATE           PIC X(30).
  3036             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3037             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3038         16  CF-COMPANY-CD                  PIC X.
  3039         16  CF-COMPANY-PASSWORD            PIC X(8).
  3040         16  CF-SECURITY-OPTION             PIC X.
  3041             88  ALL-SECURITY                   VALUE '1'.
  3042             88  COMPANY-VERIFY                 VALUE '2'.
  3043             88  PROCESSOR-VERIFY               VALUE '3'.
  3044             88  NO-SECURITY                    VALUE '4'.
  3045             88  ALL-BUT-TERM                   VALUE '5'.
  3046         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3047             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3048         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3049             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3050         16  CF-INFORCE-LOCATION            PIC X.
  3051             88  CERTS-ARE-ONLINE               VALUE '1'.
  3052             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3053             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3054         16  CF-LOWER-CASE-LETTERS          PIC X.
  3055         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3056             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3057             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3058             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3059             88  CF-ACCNT-CNTL                  VALUE '3'.
  3060             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3061
  3062         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3063         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3064
  3065         16  CF-LGX-CREDIT-USER             PIC X.
  3066             88  CO-IS-NOT-USER                 VALUE 'N'.
  3067             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3068
  3069         16 CF-CREDIT-CALC-CODES.
  3070             20  CF-CR-REM-TERM-CALC PIC X.
  3071               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3072               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3073               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3074               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3075               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3076               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3077               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3078             20  CF-CR-R78-METHOD           PIC X.
  3079               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3080               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3081
  3082         16  CF-CLAIM-CONTROL-COUNTS.
  3083             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3084                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3085
  3086             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3087                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  55
* NSRASBL.cbl
  3088
  3089             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3090                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3091
  3092             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3093                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3094
  3095         16  CF-CURRENT-MONTH-END           PIC XX.
  3096
  3097         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3098             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3099             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3100             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3101             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3102                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3103                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3104             20  CF-CO-PREM-REJECT-SW       PIC X.
  3105                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3106                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3107             20  CF-CO-REF-REJECT-SW        PIC X.
  3108                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3109                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3110
  3111         16  CF-CO-REPORTING-DT             PIC XX.
  3112         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3113         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3114           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3115           88  CF-CO-MONTH-END                  VALUE '1'.
  3116
  3117         16  CF-LGX-CLAIM-USER              PIC X.
  3118             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3119             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3120
  3121         16  CF-CREDIT-EDIT-CONTROLS.
  3122             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3123             20  CF-MIN-AGE                 PIC 99.
  3124             20  CF-DEFAULT-AGE             PIC 99.
  3125             20  CF-MIN-TERM                PIC S999      COMP-3.
  3126             20  CF-MAX-TERM                PIC S999      COMP-3.
  3127             20  CF-DEFAULT-SEX             PIC X.
  3128             20  CF-JOINT-AGE-INPUT         PIC X.
  3129                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3130             20  CF-BIRTH-DATE-INPUT        PIC X.
  3131                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3132             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3133                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3134                 88  CF-ZERO-CARRIER            VALUE '1'.
  3135                 88  CF-ZERO-GROUPING           VALUE '2'.
  3136                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3137             20  CF-EDIT-SW                 PIC X.
  3138                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3139             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3140             20  CF-CR-PR-METHOD            PIC X.
  3141               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3142               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3143             20  FILLER                     PIC X.
  3144
  3145         16  CF-CREDIT-MISC-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  56
* NSRASBL.cbl
  3146             20  CF-REIN-TABLE-SW           PIC X.
  3147                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3148             20  CF-COMP-TABLE-SW           PIC X.
  3149                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3150             20  CF-EXPERIENCE-RETENTION-AGE
  3151                                            PIC S9        COMP-3.
  3152             20  CF-CONVERSION-DT           PIC XX.
  3153             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3154             20  CF-RUN-FREQUENCY-SW        PIC X.
  3155                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3156                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3157
  3158             20  CF-CR-CHECK-NO-CONTROL.
  3159                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3160                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3161                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3162                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3163                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3164                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3165
  3166                 24  CF-CR-CHECK-COUNT       REDEFINES
  3167                     CF-CR-CHECK-COUNTER      PIC X(4).
  3168
  3169                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3170                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3171
  3172                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3173                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3174                 24  CF-MAIL-PROCESSING       PIC X.
  3175                     88  MAIL-PROCESSING          VALUE 'Y'.
  3176
  3177         16  CF-MISC-SYSTEM-CONTROL.
  3178             20  CF-SYSTEM-C                 PIC X.
  3179                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3180             20  CF-SYSTEM-D                 PIC X.
  3181                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3182             20  CF-SOC-SEC-NO-SW            PIC X.
  3183                 88  SOC-SEC-NO-USED             VALUE '1'.
  3184             20  CF-MEMBER-NO-SW             PIC X.
  3185                 88  MEMBER-NO-USED              VALUE '1'.
  3186             20  CF-TAX-ID-NUMBER            PIC X(11).
  3187             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3188             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3189                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3190                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3191                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3192                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3193             20  CF-SYSTEM-E                 PIC X.
  3194                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3195
  3196         16  CF-LGX-LIFE-USER               PIC X.
  3197             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3198             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3199
  3200         16  CF-CR-MONTH-END-DT             PIC XX.
  3201
  3202         16  CF-FILE-MAINT-DATES.
  3203             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  57
* NSRASBL.cbl
  3204                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3205             20  CF-LAST-BATCH       REDEFINES
  3206                 CF-LAST-BATCH-NO               PIC X(4).
  3207             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3208             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3209             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3210             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3211             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3212             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3213             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3214             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3215             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3216             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3217
  3218         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3219         16  FILLER                         PIC X.
  3220
  3221         16  CF-ALT-MORT-CODE               PIC X(4).
  3222         16  CF-MEMBER-CAPTION              PIC X(10).
  3223
  3224         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3225             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3226             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3227             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3228             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3229             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3230
  3231         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3232
  3233         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3234         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3235         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3236         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3237
  3238         16  CF-AH-OVERRIDE-L1              PIC X.
  3239         16  CF-AH-OVERRIDE-L2              PIC XX.
  3240         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3241         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3242
  3243         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3244         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3245
  3246         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3247         16  CF-AR-LAST-EL860-DT            PIC XX.
  3248         16  CF-MP-MONTH-END-DT             PIC XX.
  3249
  3250         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3251         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3252             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3253
  3254         16  CF-AR-MONTH-END-DT             PIC XX.
  3255
  3256         16  CF-CRDTCRD-USER                PIC X.
  3257             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3258             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3259
  3260         16  CF-CC-MONTH-END-DT             PIC XX.
  3261
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  58
* NSRASBL.cbl
  3262         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3263
  3264         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3265             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3266             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3267             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3268         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3269         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3270         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3271         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3272             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3273             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3274         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3275         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3276         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3277             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3278         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3279
  3280         16  CF-CL-ZIP-CODE.
  3281             20  CF-CL-ZIP-PRIME.
  3282                 24  CF-CL-ZIP-1ST          PIC X.
  3283                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3284                 24  FILLER                 PIC X(4).
  3285             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3286         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3287             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3288             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3289             20  FILLER                     PIC XXX.
  3290
  3291         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3292         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3293         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3294         16  CF-CO-OPTION-START-DATE        PIC XX.
  3295         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3296           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3297                                                      '3' '4'.
  3298           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3299           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3300           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3301           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3302           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3303           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3304
  3305         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3306
  3307         16  CF-PAYMENT-APPROVAL-LEVELS.
  3308             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3309             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3310             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3311             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3312             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3313             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3314
  3315         16  CF-END-USER-REPORTING-USER     PIC X.
  3316             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3317             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3318
  3319         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  59
* NSRASBL.cbl
  3320             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3321             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3322
  3323         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3324
  3325         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3326         16  FILLER                         PIC X.
  3327
  3328         16  CF-CREDIT-ARCHIVE-CNTL.
  3329             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3330             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3331             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3332
  3333         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3334
  3335         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3336             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3337             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3338
  3339         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3340             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3341             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3342
  3343         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3344
  3345         16  CF-CO-ACH-ID-CODE              PIC  X.
  3346             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3347             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3348             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3349         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3350         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3351         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3352         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3353         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3354         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3355         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3356         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3357         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3358                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3359         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3360                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3361
  3362         16  CF-CO-OVER-SHORT.
  3363             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3364             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3365
  3366*         16  FILLER                         PIC X(102).
  3367         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3368             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3369             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3370
  3371         16  CF-AH-APPROVAL-DAYS.
  3372             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3373             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3374             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3375             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3376
  3377         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  60
* NSRASBL.cbl
  3378
  3379         16  CF-APPROV-LEV-5.
  3380             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3381             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3382             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3383
  3384         16  FILLER                         PIC X(68).
  3385****************************************************************
  3386*             PROCESSOR/USER RECORD                            *
  3387****************************************************************
  3388
  3389     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3390         16  CF-PROCESSOR-NAME              PIC X(30).
  3391         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3392         16  CF-PROCESSOR-TITLE             PIC X(26).
  3393         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3394                 88  MESSAGE-YES                VALUE 'Y'.
  3395                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3396
  3397*****************************************************
  3398****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3399****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3400****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3401****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3402*****************************************************
  3403
  3404         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3405             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3406             20  CF-APPLICATION-FORCE       PIC X.
  3407             20  CF-INDIVIDUAL-APP.
  3408                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3409                     28  CF-BROWSE-APP      PIC X.
  3410                     28  CF-UPDATE-APP      PIC X.
  3411
  3412         16  CF-CURRENT-TERM-ON             PIC X(4).
  3413         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3414             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3415             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3416             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3417             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3418             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3419             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3420             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3421         16  CF-PROCESSOR-CARRIER           PIC X.
  3422             88  NO-CARRIER-SECURITY            VALUE ' '.
  3423         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3424             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3425         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3426             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3427         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3428             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3429
  3430         16  CF-PROC-SYS-ACCESS-SW.
  3431             20  CF-PROC-CREDIT-CLAIMS-SW.
  3432                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3433                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3434                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3435                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  61
* NSRASBL.cbl
  3436             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3437                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3438                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3439             20  CF-PROC-LIFE-GNRLDGR-SW.
  3440                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3441                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3442                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3443                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3444             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3445                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3446                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3447         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3448             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3449             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3450         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3451
  3452         16  CF-APPROVAL-LEVEL                  PIC X.
  3453             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3454             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3455             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3456             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3457             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3458
  3459         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3460
  3461         16  CF-LANGUAGE-TYPE                   PIC X.
  3462             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3463             88  CF-LANG-IS-FR                      VALUE 'F'.
  3464
  3465         16  CF-CSR-IND                         PIC X.
  3466         16  FILLER                             PIC X(239).
  3467
  3468****************************************************************
  3469*             PROCESSOR/REMINDERS RECORD                       *
  3470****************************************************************
  3471
  3472     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3473         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3474             20  CF-START-REMIND-DT         PIC XX.
  3475             20  CF-END-REMIND-DT           PIC XX.
  3476             20  CF-REMINDER-TEXT           PIC X(50).
  3477         16  FILLER                         PIC X(296).
  3478
  3479
  3480****************************************************************
  3481*             STATE MASTER RECORD                              *
  3482****************************************************************
  3483
  3484     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3485         16  CF-STATE-ABBREVIATION          PIC XX.
  3486         16  CF-STATE-NAME                  PIC X(25).
  3487         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3488         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3489             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3490             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3491             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3492             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3493                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  62
* NSRASBL.cbl
  3494                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3495             20  CF-ST-PREM-REJECT-SW       PIC X.
  3496                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3497                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3498             20  CF-ST-REF-REJECT-SW        PIC X.
  3499                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3500                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3501         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3502         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3503         16  CF-ST-REFUND-RULES.
  3504             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3505             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3506             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3507         16  CF-ST-FST-PMT-EXTENSION.
  3508             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3509             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3510                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3511                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3512                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3513                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3514         16  CF-ST-STATE-CALL.
  3515             20  CF-ST-CALL-UNEARNED        PIC X.
  3516             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3517             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3518         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3519             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3520             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3521         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3522         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3523         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3524         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3525         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3526         16  FILLER                         PIC X.
  3527         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3528             20  CF-ST-BENEFIT-CD           PIC XX.
  3529             20  CF-ST-BENEFIT-KIND         PIC X.
  3530                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3531                 88  CF-ST-AH-KIND              VALUE 'A'.
  3532             20  CF-ST-REM-TERM-CALC        PIC X.
  3533                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3534                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3535                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3536                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3537                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3538                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3539                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3540                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3541
  3542             20  CF-ST-REFUND-CALC          PIC X.
  3543                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3544                 88  ST-REFD-BY-R78             VALUE '1'.
  3545                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3546                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3547                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3548                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3549                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3550                 88  ST-REFD-UTAH               VALUE '7'.
  3551                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  63
* NSRASBL.cbl
  3552                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3553                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3554
  3555             20  CF-ST-EARNING-CALC         PIC X.
  3556                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3557                 88  ST-EARN-BY-R78             VALUE '1'.
  3558                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3559                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3560                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3561                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3562                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3563                 88  ST-EARN-MEAN               VALUE '8'.
  3564                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3565
  3566             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3567                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3568                 88  ST-OVRD-BY-R78             VALUE '1'.
  3569                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3570                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3571                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3572                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3573                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3574                 88  ST-OVRD-MEAN               VALUE '8'.
  3575                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3576             20  FILLER                     PIC X.
  3577
  3578         16  CF-ST-COMMISSION-CAPS.
  3579             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3580             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3581             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3582             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3583         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3584                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3585
  3586         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3587
  3588         16  CF-ST-STATUTORY-INTEREST.
  3589             20  CF-ST-STAT-DATE-FROM       PIC X.
  3590                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3591                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3592             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3593             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3594             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3595             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3596             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3597
  3598         16  CF-ST-OVER-SHORT.
  3599             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3600             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3601
  3602         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3603
  3604         16  CF-ST-RT-CALC                  PIC X.
  3605
  3606         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3607         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3608         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3609         16  CF-ST-RF-LR-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  64
* NSRASBL.cbl
  3610         16  CF-ST-RF-LL-CALC               PIC X.
  3611         16  CF-ST-RF-LN-CALC               PIC X.
  3612         16  CF-ST-RF-AH-CALC               PIC X.
  3613         16  CF-ST-RF-CP-CALC               PIC X.
  3614*        16  FILLER                         PIC X(206).
  3615*CIDMOD         16  FILLER                         PIC X(192).
  3616         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3617             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3618         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3619         16  CF-ST-VFY-2ND-BENE             PIC X.
  3620         16  CF-ST-CAUSAL-STATE             PIC X.
  3621         16  FILLER                         PIC X(185).
  3622
  3623****************************************************************
  3624*             BENEFIT MASTER RECORD                            *
  3625****************************************************************
  3626
  3627     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3628         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3629             20  CF-BENEFIT-CODE            PIC XX.
  3630             20  CF-BENEFIT-NUMERIC  REDEFINES
  3631                 CF-BENEFIT-CODE            PIC XX.
  3632             20  CF-BENEFIT-ALPHA           PIC XXX.
  3633             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3634             20  CF-BENEFIT-COMMENT         PIC X(10).
  3635
  3636             20  CF-LF-COVERAGE-TYPE        PIC X.
  3637                 88  CF-REDUCING                VALUE 'R'.
  3638                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3639
  3640             20  CF-SPECIAL-CALC-CD         PIC X.
  3641                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3642                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3643                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3644                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3645                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3646                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3647                 88  CF-FARM-PLAN               VALUE 'F'.
  3648                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3649                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3650                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3651                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3652                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3653                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3654                 88  CF-PRUDENTIAL              VALUE 'P'.
  3655                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3656                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3657                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3658                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3659                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3660                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3661
  3662             20  CF-JOINT-INDICATOR         PIC X.
  3663                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3664
  3665*            20  FILLER                     PIC X(12).
  3666             20  FILLER                     PIC X(11).
  3667             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  65
* NSRASBL.cbl
  3668             20  CF-LOAN-TYPE               PIC X(8).
  3669
  3670             20  CF-CO-REM-TERM-CALC        PIC X.
  3671                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3672                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3673                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3674                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3675                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3676
  3677             20  CF-CO-EARNINGS-CALC        PIC X.
  3678                 88  CO-EARN-BY-R78             VALUE '1'.
  3679                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3680                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3681                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3682                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3683                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3684                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3685                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3686
  3687             20  CF-CO-REFUND-CALC          PIC X.
  3688                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3689                 88  CO-REFD-BY-R78             VALUE '1'.
  3690                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3691                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3692                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3693                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3694                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3695                 88  CO-REFD-MEAN               VALUE '8'.
  3696                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3697                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3698                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3699
  3700             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3701                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3702                 88  CO-OVRD-BY-R78             VALUE '1'.
  3703                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3704                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3705                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3706                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3707                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3708                 88  CO-OVRD-MEAN               VALUE '8'.
  3709                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3710
  3711             20  CF-CO-BEN-I-G-CD           PIC X.
  3712                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3713                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3714                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3715
  3716         16  FILLER                         PIC X(304).
  3717
  3718
  3719****************************************************************
  3720*             CARRIER MASTER RECORD                            *
  3721****************************************************************
  3722
  3723     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3724         16  CF-ADDRESS-DATA.
  3725             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  66
* NSRASBL.cbl
  3726             20  CF-IN-CARE-OF              PIC X(30).
  3727             20  CF-ADDRESS-LINE-1          PIC X(30).
  3728             20  CF-ADDRESS-LINE-2          PIC X(30).
  3729             20  CF-CITY-STATE              PIC X(30).
  3730             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3731             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3732
  3733         16  CF-CLAIM-NO-CONTROL.
  3734             20  CF-CLAIM-NO-METHOD         PIC X.
  3735                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3736                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3737                 88  CLAIM-NO-SEQ               VALUE '3'.
  3738                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3739             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3740                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3741                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3742                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3743
  3744         16  CF-CHECK-NO-CONTROL.
  3745             20  CF-CHECK-NO-METHOD         PIC X.
  3746                 88  CHECK-NO-MANUAL            VALUE '1'.
  3747                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3748                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3749                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3750             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3751                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3752
  3753         16  CF-DOMICILE-STATE              PIC XX.
  3754
  3755         16  CF-EXPENSE-CONTROLS.
  3756             20  CF-EXPENSE-METHOD          PIC X.
  3757                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3758                 88  DOLLARS-PER-PMT            VALUE '2'.
  3759                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3760                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3761             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3762             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3763
  3764         16  CF-CORRESPONDENCE-CONTROL.
  3765             20  CF-LETTER-RESEND-OPT       PIC X.
  3766                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3767                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3768             20  FILLER                     PIC X(4).
  3769
  3770         16  CF-RESERVE-CONTROLS.
  3771             20  CF-MANUAL-SW               PIC X.
  3772                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3773             20  CF-FUTURE-SW               PIC X.
  3774                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3775             20  CF-PTC-SW                  PIC X.
  3776                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3777             20  CF-IBNR-SW                 PIC X.
  3778                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3779             20  CF-PTC-LF-SW               PIC X.
  3780                 88  CF-LF-PTC-USED             VALUE '1'.
  3781             20  CF-CDT-ACCESS-METHOD       PIC X.
  3782                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3783                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  67
* NSRASBL.cbl
  3784                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3785             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3786
  3787         16  CF-CLAIM-CALC-METHOD           PIC X.
  3788             88  360-PLUS-MONTHS                VALUE '1'.
  3789             88  365-PLUS-MONTHS                VALUE '2'.
  3790             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3791             88  360-DAILY                      VALUE '4'.
  3792             88  365-DAILY                      VALUE '5'.
  3793
  3794         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3795         16  FILLER                         PIC X(11).
  3796
  3797         16  CF-LIMIT-AMOUNTS.
  3798             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3799             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3800             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3801             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3802             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3803             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3804             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3805             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3806             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3807             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3808
  3809         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3810         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3811         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3812
  3813         16  CF-ZIP-CODE.
  3814             20  CF-ZIP-PRIME.
  3815                 24  CF-ZIP-1ST             PIC X.
  3816                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3817                 24  FILLER                 PIC X(4).
  3818             20  CF-ZIP-PLUS4               PIC X(4).
  3819         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3820             20  CF-CAN-POSTAL-1            PIC XXX.
  3821             20  CF-CAN-POSTAL-2            PIC XXX.
  3822             20  FILLER                     PIC XXX.
  3823
  3824         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3825         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3826         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3827
  3828         16  CF-RATING-SWITCH               PIC X.
  3829             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3830             88  CF-NO-RATING                   VALUE 'N'.
  3831
  3832         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3833
  3834         16  CF-CARRIER-OVER-SHORT.
  3835             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3836             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3837
  3838         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3839         16  CF-SECPAY-SWITCH               PIC X.
  3840             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3841             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  68
* NSRASBL.cbl
  3842         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3843         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3844         16  FILLER                         PIC X(444).
  3845*        16  FILLER                         PIC X(452).
  3846
  3847
  3848****************************************************************
  3849*             MORTALITY MASTER RECORD                          *
  3850****************************************************************
  3851
  3852     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3853         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3854                                INDEXED BY CF-MORT-NDX.
  3855             20  CF-MORT-TABLE              PIC X(5).
  3856             20  CF-MORT-TABLE-TYPE         PIC X.
  3857                 88  CF-MORT-JOINT              VALUE 'J'.
  3858                 88  CF-MORT-SINGLE             VALUE 'S'.
  3859                 88  CF-MORT-COMBINED           VALUE 'C'.
  3860                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3861                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3862             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3863             20  CF-MORT-AGE-METHOD         PIC XX.
  3864                 88  CF-AGE-LAST                VALUE 'AL'.
  3865                 88  CF-AGE-NEAR                VALUE 'AN'.
  3866             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3867             20  CF-MORT-ADJUSTMENT-DIRECTION
  3868                                            PIC X.
  3869                 88  CF-MINUS                   VALUE '-'.
  3870                 88  CF-PLUS                    VALUE '+'.
  3871             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3872             20  CF-MORT-JOINT-CODE         PIC X.
  3873                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3874             20  CF-MORT-PC-Q               PIC X.
  3875                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3876             20  CF-MORT-TABLE-CODE         PIC X(4).
  3877             20  CF-MORT-COMMENTS           PIC X(15).
  3878             20  FILLER                     PIC X(14).
  3879
  3880         16  FILLER                         PIC X(251).
  3881
  3882
  3883****************************************************************
  3884*             BUSSINESS TYPE MASTER RECORD                     *
  3885****************************************************************
  3886
  3887     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3888* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3889* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3890* AND RECORD 05 IS TYPES 81-99
  3891         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3892             20  CF-BUSINESS-TITLE          PIC  X(19).
  3893             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3894                                            PIC S9V9(4) COMP-3.
  3895             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3896             20  FILLER                     PIC  X.
  3897         16  FILLER                         PIC  X(248).
  3898
  3899
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  69
* NSRASBL.cbl
  3900****************************************************************
  3901*             TERMINAL MASTER RECORD                           *
  3902****************************************************************
  3903
  3904     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3905
  3906         16  CF-COMPANY-TERMINALS.
  3907             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3908                                  PIC X(4).
  3909         16  FILLER               PIC X(248).
  3910
  3911
  3912****************************************************************
  3913*             LIFE EDIT MASTER RECORD                          *
  3914****************************************************************
  3915
  3916     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3917         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3918             20  CF-LIFE-CODE-IN            PIC XX.
  3919             20  CF-LIFE-CODE-OUT           PIC XX.
  3920         16  FILLER                         PIC X(248).
  3921
  3922
  3923****************************************************************
  3924*             AH EDIT MASTER RECORD                            *
  3925****************************************************************
  3926
  3927     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3928         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3929             20  CF-AH-CODE-IN              PIC XXX.
  3930             20  CF-AH-CODE-OUT             PIC XX.
  3931         16  FILLER                         PIC X(248).
  3932
  3933
  3934****************************************************************
  3935*             CREDIBILITY TABLES                               *
  3936****************************************************************
  3937
  3938     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3939         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3940                             INDEXED BY CF-CRDB-NDX.
  3941             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3942             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3943             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3944         16  FILLER                         PIC  X(332).
  3945
  3946
  3947****************************************************************
  3948*             REPORT CUSTOMIZATION RECORD                      *
  3949****************************************************************
  3950
  3951     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3952         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3953             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3954             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3955             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3956**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3957****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  70
* NSRASBL.cbl
  3958             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3959
  3960         16  FILLER                         PIC XX.
  3961
  3962         16  CF-CARRIER-CNTL-OPT.
  3963             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3964                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3965                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3966             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3967                                            PIC X.
  3968         16  CF-GROUP-CNTL-OPT.
  3969             20  CF-GROUP-OPT-SEQ           PIC 9.
  3970                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3971                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3972             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3973                                            PIC X(6).
  3974         16  CF-STATE-CNTL-OPT.
  3975             20  CF-STATE-OPT-SEQ           PIC 9.
  3976                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3977                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3978             20  CF-STATE-SELECT OCCURS 3 TIMES
  3979                                            PIC XX.
  3980         16  CF-ACCOUNT-CNTL-OPT.
  3981             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3982                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3983                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3984             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3985                                            PIC X(10).
  3986         16  CF-BUS-TYP-CNTL-OPT.
  3987             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3988                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3989                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3990             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3991                                            PIC XX.
  3992         16  CF-LF-TYP-CNTL-OPT.
  3993             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3994                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3995                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3996             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3997                                            PIC XX.
  3998         16  CF-AH-TYP-CNTL-OPT.
  3999             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4000                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4001                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4002             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4003                                            PIC XX.
  4004         16  CF-REPTCD1-CNTL-OPT.
  4005             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4006                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4007                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4008             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4009                                            PIC X(10).
  4010         16  CF-REPTCD2-CNTL-OPT.
  4011             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4012                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4013                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4014             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4015                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  71
* NSRASBL.cbl
  4016         16  CF-USER1-CNTL-OPT.
  4017             20  CF-USER1-OPT-SEQ           PIC 9.
  4018                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4019                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4020             20  CF-USER1-SELECT OCCURS 3 TIMES
  4021                                            PIC X(10).
  4022         16  CF-USER2-CNTL-OPT.
  4023             20  CF-USER2-OPT-SEQ           PIC 9.
  4024                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4025                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4026             20  CF-USER2-SELECT OCCURS 3 TIMES
  4027                                            PIC X(10).
  4028         16  CF-USER3-CNTL-OPT.
  4029             20  CF-USER3-OPT-SEQ           PIC 9.
  4030                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4031                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4032             20  CF-USER3-SELECT OCCURS 3 TIMES
  4033                                            PIC X(10).
  4034         16  CF-USER4-CNTL-OPT.
  4035             20  CF-USER4-OPT-SEQ           PIC 9.
  4036                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4037                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4038             20  CF-USER4-SELECT OCCURS 3 TIMES
  4039                                            PIC X(10).
  4040         16  CF-USER5-CNTL-OPT.
  4041             20  CF-USER5-OPT-SEQ           PIC 9.
  4042                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4043                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4044             20  CF-USER5-SELECT OCCURS 3 TIMES
  4045                                            PIC X(10).
  4046         16  CF-REINS-CNTL-OPT.
  4047             20  CF-REINS-OPT-SEQ           PIC 9.
  4048                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4049                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4050             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4051                 24  CF-REINS-PRIME         PIC XXX.
  4052                 24  CF-REINS-SUB           PIC XXX.
  4053
  4054         16  CF-AGENT-CNTL-OPT.
  4055             20  CF-AGENT-OPT-SEQ           PIC 9.
  4056                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4057                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4058             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4059                                            PIC X(10).
  4060
  4061         16  FILLER                         PIC X(43).
  4062
  4063         16  CF-LOSS-RATIO-SELECT.
  4064             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4065             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4066         16  CF-ENTRY-DATE-SELECT.
  4067             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4068             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4069         16  CF-EFFECTIVE-DATE-SELECT.
  4070             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4071             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4072
  4073         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  72
* NSRASBL.cbl
  4074             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4075
  4076         16  FILLER                         PIC X(318).
  4077
  4078****************************************************************
  4079*                  EXCEPTION REPORTING RECORD                  *
  4080****************************************************************
  4081
  4082     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4083         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4084             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4085
  4086         16  CF-COMBINED-LIFE-AH-OPT.
  4087             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4088             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4089             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4090             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4091
  4092         16  CF-LIFE-OPT.
  4093             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4094             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4095             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4096             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4097             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4098             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4099             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4100             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4101             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4102             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4103
  4104         16  CF-AH-OPT.
  4105             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4106             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4107             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4108             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4109             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4110             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4111             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4112             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4113             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4114             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4115
  4116         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4117             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4118             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4119             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4120
  4121         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4122
  4123         16  FILLER                         PIC X(673).
  4124
  4125
  4126****************************************************************
  4127*             MORTGAGE SYSTEM PLAN RECORD                      *
  4128****************************************************************
  4129
  4130     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4131         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  73
* NSRASBL.cbl
  4132             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4133             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4134             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4135         16  CF-PLAN-ABBREV                 PIC XXX.
  4136         16  CF-PLAN-DESCRIPT               PIC X(10).
  4137         16  CF-PLAN-NOTES                  PIC X(20).
  4138         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4139         16  CF-PLAN-UNDERWRITING.
  4140             20  CF-PLAN-TERM-DATA.
  4141                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4142                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4143             20  CF-PLAN-AGE-DATA.
  4144                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4145                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4146                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4147             20  CF-PLAN-BENEFIT-DATA.
  4148                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4149                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4150                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4151                                            PIC S9(7)V99  COMP-3.
  4152         16  CF-PLAN-POLICY-FORMS.
  4153             20  CF-POLICY-FORM             PIC X(12).
  4154             20  CF-MASTER-APPLICATION      PIC X(12).
  4155             20  CF-MASTER-POLICY           PIC X(12).
  4156         16  CF-PLAN-RATING.
  4157             20  CF-RATE-CODE               PIC X(5).
  4158             20  CF-SEX-RATING              PIC X.
  4159                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4160                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4161             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4162             20  CF-SUB-STD-TYPE            PIC X.
  4163                 88  CF-PCT-OF-PREM            VALUE '1'.
  4164                 88  CF-PCT-OF-BENE            VALUE '2'.
  4165         16  CF-PLAN-PREM-TOLERANCES.
  4166             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4167             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4168         16  CF-PLAN-PYMT-TOLERANCES.
  4169             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4170             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4171         16  CF-PLAN-MISC-DATA.
  4172             20  FILLER                     PIC X.
  4173             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4174             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4175         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4176         16  CF-PLAN-IND-GRP                PIC X.
  4177             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4178                                                     '1'.
  4179             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4180                                                     '2'.
  4181         16  CF-MIB-SEARCH-SW               PIC X.
  4182             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4183             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4184             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4185             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4186         16  CF-ALPHA-SEARCH-SW             PIC X.
  4187             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4188             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4189             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  74
* NSRASBL.cbl
  4190             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4191             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4192             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4193             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4194             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4195             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4196             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4197                                                     'A' 'B' 'C'
  4198                                                     'X' 'Y' 'Z'.
  4199         16  CF-EFF-DT-RULE-SW              PIC X.
  4200             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4201             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4202             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4203             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4204             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4205         16  FILLER                         PIC X(4).
  4206         16  CF-HEALTH-QUESTIONS            PIC X.
  4207             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4208         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4209         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4210         16  CF-PLAN-SNGL-JNT               PIC X.
  4211             88  CF-COMBINED-PLAN              VALUE 'C'.
  4212             88  CF-JNT-PLAN                   VALUE 'J'.
  4213             88  CF-SNGL-PLAN                  VALUE 'S'.
  4214         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4215         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4216         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4217         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4218         16  CF-RERATE-CNTL                 PIC  X.
  4219             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4220             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4221             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4222             88  CF-AUTO-RECALC                 VALUE '4'.
  4223         16  CF-BENEFIT-TYPE                PIC  X.
  4224             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4225             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4226         16  CF-POLICY-FEE                  PIC S999V99
  4227                                                    COMP-3.
  4228         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4229         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4230         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4231         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4232         16  FILLER                         PIC  X(32).
  4233         16  CF-TERMINATION-FORM            PIC  X(04).
  4234         16  FILLER                         PIC  X(08).
  4235         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4236                                                       COMP-3.
  4237         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4238         16  CF-ISSUE-LETTER                PIC  X(4).
  4239         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4240         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4241             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4242             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4243         16  CF-MP-REFUND-CALC              PIC X.
  4244             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4245             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4246             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4247             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  75
* NSRASBL.cbl
  4248             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4249             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4250             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4251             88  CF-MP-REFD-MEAN                VALUE '8'.
  4252         16  CF-ALT-RATE-CODE               PIC  X(5).
  4253
  4254
  4255         16  FILLER                         PIC X(498).
  4256****************************************************************
  4257*             MORTGAGE COMPANY MASTER RECORD                   *
  4258****************************************************************
  4259
  4260     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4261         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4262         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4263             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4264             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4265             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4266             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4267             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4268
  4269         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4270         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4271         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4272         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4273         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4274
  4275         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4276             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4277         16  CF-MP-RECON-USE-IND            PIC X(1).
  4278             88  CF-MP-USE-RECON             VALUE 'Y'.
  4279         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4280             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4281         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4282             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4283             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4284         16  FILLER                         PIC X(1).
  4285         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4286             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4287         16  CF-MORTG-MIB-VERSION           PIC X.
  4288             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4289             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4290             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4291         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4292             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4293                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4294             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4295                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4296             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4297                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4298             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4299                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4300             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4301                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4302             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4303                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4304         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4305         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  76
* NSRASBL.cbl
  4306         16  CF-MORTG-DESTINATION-SYMBOL.
  4307             20  CF-MORTG-MIB-COMM          PIC X(5).
  4308             20  CF-MORTG-MIB-TERM          PIC X(5).
  4309         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4310             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4311         16  FILLER                         PIC X(03).
  4312         16  CF-MP-CHECK-NO-CONTROL.
  4313             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4314                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4315                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4316                                                ' ' LOW-VALUES.
  4317                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4318                                               VALUE '3'.
  4319         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4320         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4321         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4322             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4323                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4324             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4325                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4326             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4327                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4328             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4329                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4330             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4331                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4332             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4333                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4334         16  CF-MORTG-BILLING-AREA.
  4335             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4336                                            PIC X.
  4337         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4338         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4339         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4340         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4341             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4342             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4343         16  FILLER                         PIC X.
  4344         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4345             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4346             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4347         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4348         16  FILLER                         PIC X(8).
  4349         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4350         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4351         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4352         16  CF-ACH-COMPANY-ID.
  4353             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4354                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4355                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4356                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4357             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4358         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4359             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4360         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4361             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4362             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4363         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  77
* NSRASBL.cbl
  4364         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4365         16  FILLER                         PIC X(536).
  4366
  4367****************************************************************
  4368*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4369****************************************************************
  4370
  4371     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4372         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4373             20  CF-FEMALE-HEIGHT.
  4374                 24  CF-FEMALE-FT           PIC 99.
  4375                 24  CF-FEMALE-IN           PIC 99.
  4376             20  CF-FEMALE-MIN-WT           PIC 999.
  4377             20  CF-FEMALE-MAX-WT           PIC 999.
  4378         16  FILLER                         PIC X(428).
  4379
  4380     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4381         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4382             20  CF-MALE-HEIGHT.
  4383                 24  CF-MALE-FT             PIC 99.
  4384                 24  CF-MALE-IN             PIC 99.
  4385             20  CF-MALE-MIN-WT             PIC 999.
  4386             20  CF-MALE-MAX-WT             PIC 999.
  4387         16  FILLER                         PIC X(428).
  4388******************************************************************
  4389*             AUTOMATIC ACTIVITY RECORD                          *
  4390******************************************************************
  4391     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4392         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4393             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4394             20  CF-SYS-LETTER-ID           PIC X(04).
  4395             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4396             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4397             20  CF-SYS-RESET-SW            PIC X(01).
  4398             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4399             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4400
  4401         16  FILLER                         PIC X(50).
  4402
  4403         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4404             20  CF-USER-ACTIVE-SW          PIC X(01).
  4405             20  CF-USER-LETTER-ID          PIC X(04).
  4406             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4407             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4408             20  CF-USER-RESET-SW           PIC X(01).
  4409             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4410             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4411             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4412
  4413         16  FILLER                         PIC X(246).
  4414*                                COPY NSCASVARS.
  4415******************************************************************
  4416*                   C H A N G E   L O G
  4417*
  4418*        CURRENT SIZE - 6150
  4419*
  4420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4421*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  78
* NSRASBL.cbl
  4422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4423* EFFECTIVE    NUMBER
  4424*-----------------------------------------------------------------
  4425* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4426* 110612  CR2012101700002  AJRA  ADD NEW FIELDS
  4427* 091213  CR2013090300001  AJRA  ADD NEXT BUSINESS DATE
  4428******************************************************************
  4429 01 NAPER-OUTPUT-DATA.
  4430    05  F                       PIC X(07) VALUE "LETTER=".
  4431    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4432    05  F                       PIC X(08) VALUE "~PROCID=".
  4433    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4434    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4435    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4436    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4437    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4438    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4439    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4440    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4441    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4442    05  F                       PIC X(06) VALUE "~CARR=".
  4443    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4444    05  F                       PIC X(10) VALUE "~GROUPING=".
  4445    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4446    05  F                       PIC X(08) VALUE "~CERTST=".
  4447    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4448    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4449    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4450    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4451    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4452    05  F                       PIC X(07) VALUE "~CRTNO=".
  4453    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4454    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4455    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4456    05  F                       PIC X(08) VALUE "~ILNAME=".
  4457    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4458    05  F                       PIC X(08) VALUE "~IFNAME=".
  4459    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4460    05  F                       PIC X(08) VALUE "~IFINIT=".
  4461    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4462    05  F                       PIC X(08) VALUE "~IMINIT=".
  4463    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4464    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4465    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4466    05  F                       PIC X(06) VALUE "~ISEX=".
  4467    05  OUT-ISEX                PIC X(01) VALUE SPACES.
  4468    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4469    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4470    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4471    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4472    05  F                       PIC X(09) VALUE "~INSCITY=".
  4473    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4474    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4475    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4476    05  F                       PIC X(08) VALUE "~INSZIP=".
  4477    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4478    05  F                       PIC X(05) VALUE "~SSN=".
  4479    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  79
* NSRASBL.cbl
  4480    05  F                       PIC X(07) VALUE "~MEMNO=".
  4481    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4482    05  F                       PIC X(08) VALUE "~JLNAME=".
  4483    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4484    05  F                       PIC X(08) VALUE "~JFNAME=".
  4485    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4486    05  F                       PIC X(08) VALUE "~JMINIT=".
  4487    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4488    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4489    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4490    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4491    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4492    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4493    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4494    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4495    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4496    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4497    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4498    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4499    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4500    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4501    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4502    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4503    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4504    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4505    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4506    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4507    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4508    05  F                       PIC X(10) VALUE "~BENENAME=".
  4509    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4510    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4511    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4512    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4513    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4514    05  F                       PIC X(10) VALUE "~BENECITY=".
  4515    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4516    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4517    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4518    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4519    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4520    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4521    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4522    05  F                       PIC X(08) VALUE "~RESPNO=".
  4523    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4524    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4525    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
  4526    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4527    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4528    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4529    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4530    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4531    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4532    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4533    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4534    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4535    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4536    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4537    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  80
* NSRASBL.cbl
  4538    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4539    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4540    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4541    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4542    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4543    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4544    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4545    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4546    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4547    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4548    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4549    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4550    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4551    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4552    05  F                       PIC X(07) VALUE "~BATCH=".
  4553    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4554    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4555    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4556    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4557    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4558    05  F                       PIC X(05) VALUE "~APR=".
  4559    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4560    05  F                       PIC X(08) VALUE "~LNTERM=".
  4561    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4562    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4563    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4564    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4565    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4566    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4567    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4568    05  F                       PIC X(07) VALUE "~UCODE=".
  4569    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4570    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4571    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4572    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4573    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4574    05  F                       PIC X(06) VALUE "~SKIP=".
  4575    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4576    05  F                       PIC X(06) VALUE "~MODE=".
  4577    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4578    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4579    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4580    05  F                       PIC X(06) VALUE "~RTBL=".
  4581    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4582    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4583    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
  4584    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4585    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4586    05  F                       PIC X(08) VALUE "~LFTERM=".
  4587    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4588    05  F                       PIC X(07) VALUE "~LFDEV=".
  4589    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4590    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4591    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4592    05  F                       PIC X(07) VALUE "~LFBEN=".
  4593    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4594    05  F                       PIC X(08) VALUE "~LFPREM=".
  4595    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  81
* NSRASBL.cbl
  4596    05  F                       PIC X(08) VALUE "~LFABEN=".
  4597    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4598    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4599    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4600    05  F                       PIC X(07) VALUE "~LFNSP=".
  4601    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4602    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4603    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4604    05  F                       PIC X(07) VALUE "~LFCAN=".
  4605    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4606    05  F                       PIC X(07) VALUE "~LFDTH=".
  4607    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4608    05  F                       PIC X(08) VALUE "~LFRATE=".
  4609    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4610    05  F                       PIC X(09) VALUE "~LFARATE=".
  4611    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4612    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4613    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4614    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4615    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4616    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4617    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4618    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4619    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4620    05  F                       PIC X(07) VALUE "~DTHDT=".
  4621    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4622    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4623    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4624    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4625    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4626    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4627    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4628    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4629    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4630    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4631    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4632    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4633    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4634    05  F                       PIC X(08) VALUE "~AHTERM=".
  4635    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4636    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4637    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4638    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4639    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4640    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4641    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
  4642    05  F                       PIC X(07) VALUE "~AHBEN=".
  4643    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4644    05  F                       PIC X(08) VALUE "~AHPREM=".
  4645    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4646    05  F                       PIC X(07) VALUE "~AHNSP=".
  4647    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4648    05  F                       PIC X(07) VALUE "~AHCAN=".
  4649    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4650    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4651    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4652    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4653    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4655    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4656    05  F                       PIC X(08) VALUE "~AHRATE=".
  4657    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4658    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4659    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4660    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4661    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4662    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4663    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4664    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4665    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4666    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4667    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4668    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4669    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4670    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4671    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4672    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4673    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4674    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4675    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4676    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4677    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4678    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4679    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4680    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4681                                PIC X(2).
  4682    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4683    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4684    05  F                       PIC X(08) VALUE "~TOTREF=".
  4685    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4686    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4687    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4688    05  F                       PIC X(07) VALUE "~STERM=".
  4689    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4690    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4691    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4692    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4693    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4694    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4695    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4696    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4697    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4698    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4699    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
  4700    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4701    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4702    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4703    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4704    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4705    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4706    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4707    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4708    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4709    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4710    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4711    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  83
* NSRASBL.cbl
  4712    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4713                                PIC X(12).
  4714    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4715    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4716    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4717                                PIC X(12).
  4718    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4719    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4720    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4721    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4722    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4723    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4724    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4725    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4726    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4727                                PIC X(12).
  4728    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4729    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4730    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4731                                PIC X(10).
  4732    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4733    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4734    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4735    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4736    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4737    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4738    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4739    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4740    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4741    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4742    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4743    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4744    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4745                                PIC X(10).
  4746    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4747    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4748    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4749                                PIC X(10).
  4750    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4751    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4752    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4753    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4754    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4755    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4756    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4757    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
  4758    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4759    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4760    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4761    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4762    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4763    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4764    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4765    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4766    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4767    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4768    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4769                                PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4771    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4772    05  F                       PIC X(08) VALUE "~OSTERM=".
  4773    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4774    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4775    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4776    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4777    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4778    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4779    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4780    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4781    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4782    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4783                                PIC X(09).
  4784    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4785    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4786    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4787    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4788    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4789    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4790    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4791    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4792    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4793                                PIC X(09).
  4794    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4795    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4796    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4797    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4798    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4799                                PIC X(09).
  4800    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4801    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4802    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4803                                PIC X(12).
  4804    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4805    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4806    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4807                                PIC X(10).
  4808    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4809    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4810    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4811    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4812    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4813                                PIC X(12).
  4814    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4815    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
  4816    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4817                                PIC X(10).
  4818    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4819    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4820    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4821    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4822    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4823    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4824    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4825    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4826    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4827                                PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4829    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4830    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4831                                PIC X(09).
  4832    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4833    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4834    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4835                                PIC X(10).
  4836    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4837    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4838    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4839                                PIC X(10).
  4840    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4841    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4842    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4843    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4844    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4845    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4846    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4847    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4848    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4849    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4850    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4851    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4852    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4853    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4854    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4855                                PIC X(09).
  4856    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4857    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4858    05  F                       PIC X(08) VALUE "~NSTERM=".
  4859    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4860    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4861                                PIC X(09).
  4862    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4863    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4864    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4865    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4866    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4867    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4868    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4869    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4870    05  F                       PIC X(09) VALUE "~BALLOON=".
  4871    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4872    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4873    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
  4874    05  F                       PIC X(09) VALUE "~RESCIND=".
  4875    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4876    05  F                       PIC X(07) VALUE "~RCD01=".
  4877    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4878    05  F                       PIC X(07) VALUE "~RCD02=".
  4879    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4880    05  F                       PIC X(07) VALUE "~RCD03=".
  4881    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4882    05  F                       PIC X(07) VALUE "~RCD04=".
  4883    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4884    05  F                       PIC X(07) VALUE "~RCD05=".
  4885    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  86
* NSRASBL.cbl
  4886    05  F                       PIC X(07) VALUE "~RCD06=".
  4887    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4888    05  F                       PIC X(07) VALUE "~RCD07=".
  4889    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4890    05  F                       PIC X(07) VALUE "~RCD08=".
  4891    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4892    05  F                       PIC X(07) VALUE "~RCD09=".
  4893    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4894    05  F                       PIC X(07) VALUE "~RCD10=".
  4895    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4896    05  F                       PIC X(07) VALUE "~RCD11=".
  4897    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4898    05  F                       PIC X(07) VALUE "~RCD12=".
  4899    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4900    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4901    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4902    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4903    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4904    05  F                       PIC X(06) VALUE "~FORM=".
  4905    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4906    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4907    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4908    05  F                       PIC X(08) VALUE "~ATTACH=".
  4909    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4910    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4911    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4912    05  F                       PIC X(11) VALUE "~STATENAME=".
  4913    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4914    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4915    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4916    05  F                       PIC X(05) VALUE "~NCB=".
  4917    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4918    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4919    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4920    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4921    05  OUT-ACCT-PORTION        PIC 9(7).99 VALUE ZEROS.
  4922    05  F                       PIC X(09) VALUE "~LETRTYP=".
  4923    05  OUT-LETTER-TYPE         PIC X(01) VALUE SPACES.
  4924    05  F                       PIC X(10) VALUE "~PRNTCERT=".
  4925    05  OUT-PRINT-CERTIFICATE   PIC X(01) VALUE SPACES.
  4926    05  F                       PIC X(08) VALUE "~INSBDT=".
  4927    05  OUT-INS-BIRTHDATE       PIC X(21) VALUE SPACES.
  4928    05  F                       PIC X(08) VALUE "~JNTBDT=".
  4929    05  OUT-JNT-BIRTHDATE       PIC X(21) VALUE SPACES.
  4930    05  F                       PIC X(08) VALUE "~TOTINT=".
  4931    05  OUT-TOT-INTEREST        PIC 9(7).99 VALUE ZEROS.
  4932    05  F                       PIC X(8) VALUE "~TOPREM=".
  4933    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4934    05  F                       PIC X(7) VALUE "~TOREF=".
  4935    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4936    05  F                       PIC X(7) VALUE "~CANDT=".
  4937    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4938    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4939    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4940    05  F                       PIC X(08) VALUE "~CERTID=".
  4941    05  OUT-CERTIFICATE-ID      PIC X(5)  VALUE SPACES.
  4942    05  F                       PIC X(08) VALUE "~UNDWID=".
  4943    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  87
* NSRASBL.cbl
  4944    05  F                       PIC X(8) VALUE "~TNPREM=".
  4945    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4946    05  F                       PIC X(7) VALUE "~TNREF=".
  4947    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4948    05  F                       PIC X(8)  VALUE "~COVIND=".
  4949    05  OUT-COVERAGE-IND        PIC X(4)  VALUE SPACES.
  4950    05  F                       PIC X(9)  VALUE "~OCOVIND=".
  4951    05  OUT-ORIG-COVERAGE-IND   PIC X(4)  VALUE SPACES.
  4952    05  F                       PIC X(9)  VALUE "~NCOVIND=".
  4953    05  OUT-NEW-COVERAGE-IND    PIC X(4)  VALUE SPACES.
  4954    05  F                       PIC X(10) VALUE "~LFCMBPRM=".
  4955    05  OUT-LF-CMB-PREM         PIC 9(7).99 VALUE ZEROS.
  4956    05  F                       PIC X(11) VALUE "~LFOCMBPRM=".
  4957    05  OUT-ORIG-LF-CMB-PREM    PIC 9(7).99 VALUE ZEROS.
  4958    05  F                       PIC X(11) VALUE "~LFNCMBPRM=".
  4959    05  OUT-NEW-LF-CMB-PREM     PIC 9(7).99 VALUE ZEROS.
  4960    05  OUT-NEW-LF-CMB-PREM-A REDEFINES OUT-NEW-LF-CMB-PREM
  4961                                PIC X(10).
  4962    05  F                       PIC X(11) VALUE "~LFPREMCHG=".
  4963    05  OUT-LF-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4964    05  F                       PIC X(11) VALUE "~LFAPRMCHG=".
  4965    05  OUT-LF-ALT-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4966    05  F                       PIC X(11) VALUE "~LFCPRMCHG=".
  4967    05  OUT-LF-CMB-PREM-CHG     PIC 9(7).99 VALUE ZEROS.
  4968    05  F                       PIC X(11) VALUE "~AHPREMCHG=".
  4969    05  OUT-AH-PREM-CHG         PIC 9(7).99 VALUE ZEROS.
  4970    05  F                       PIC X(10) VALUE "~LFREFCHG=".
  4971    05  OUT-LF-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4972    05  F                       PIC X(10) VALUE "~AHREFCHG=".
  4973    05  OUT-AH-REF-CHG          PIC 9(7).99 VALUE ZEROS.
  4974    05  F                       PIC X(11) VALUE "~ACCTLFAMT=".
  4975    05  OUT-ACCT-LF-PORTION     PIC 9(7).99 VALUE ZEROS.
  4976    05  F                       PIC X(11) VALUE "~ACTALFAMT=".
  4977    05  OUT-ACCT-ALT-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4978    05  F                       PIC X(11) VALUE "~ACTCLFAMT=".
  4979    05  OUT-ACCT-CMB-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  4980    05  F                       PIC X(11) VALUE "~ACCTAHAMT=".
  4981    05  OUT-ACCT-AH-PORTION     PIC 9(7).99 VALUE ZEROS.
  4982    05  F                       PIC X(10) VALUE "~CSOLFAMT=".
  4983    05  OUT-CSO-LF-PORTION      PIC 9(7).99 VALUE ZEROS.
  4984    05  F                       PIC X(11) VALUE "~CSOALFAMT=".
  4985    05  OUT-CSO-ALT-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4986    05  F                       PIC X(11) VALUE "~CSOCLFAMT=".
  4987    05  OUT-CSO-CMB-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  4988    05  F                       PIC X(10) VALUE "~CSOAHAMT=".
  4989    05  OUT-CSO-AH-PORTION      PIC 9(7).99 VALUE ZEROS.
  4990    05  F                       PIC X(11) VALUE "~ACTOLFAMT=".
  4991    05  OUT-ACCT-ORIG-LF-PORT   PIC 9(7).99 VALUE ZEROS.
  4992    05  F                       PIC X(12) VALUE "~ACTOALFAMT=".
  4993    05  OUT-ACCT-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4994    05  F                       PIC X(12) VALUE "~ACTOCLFAMT=".
  4995    05  OUT-ACCT-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  4996    05  F                       PIC X(11) VALUE "~ACTOAHAMT=".
  4997    05  OUT-ACCT-ORIG-AH-PORT   PIC 9(7).99 VALUE ZEROS.
  4998    05  F                       PIC X(10) VALUE "~ACCTOAMT=".
  4999    05  OUT-ACCT-ORIG-PORTION   PIC 9(7).99 VALUE ZEROS.
  5000    05  F                       PIC X(11) VALUE "~CSOOLFAMT=".
  5001    05  OUT-CSO-ORIG-LF-PORT    PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  88
* NSRASBL.cbl
  5002    05  F                       PIC X(12) VALUE "~CSOOALFAMT=".
  5003    05  OUT-CSO-ORIG-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5004    05  F                       PIC X(12) VALUE "~CSOOCLFAMT=".
  5005    05  OUT-CSO-ORIG-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5006    05  F                       PIC X(11) VALUE "~CSOOAHAMT=".
  5007    05  OUT-CSO-ORIG-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5008    05  F                       PIC X(09) VALUE "~CSOOAMT=".
  5009    05  OUT-CSO-ORIG-PORTION    PIC 9(7).99 VALUE ZEROS.
  5010    05  F                       PIC X(11) VALUE "~ACTNLFAMT=".
  5011    05  OUT-ACCT-NEW-LF-PORT    PIC 9(7).99 VALUE ZEROS.
  5012    05  F                       PIC X(12) VALUE "~ACTNALFAMT=".
  5013    05  OUT-ACCT-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5014    05  F                       PIC X(12) VALUE "~ACTNCLFAMT=".
  5015    05  OUT-ACCT-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5016    05  F                       PIC X(11) VALUE "~ACTNAHAMT=".
  5017    05  OUT-ACCT-NEW-AH-PORT    PIC 9(7).99 VALUE ZEROS.
  5018    05  F                       PIC X(10) VALUE "~ACCTNAMT=".
  5019    05  OUT-ACCT-NEW-PORTION    PIC 9(7).99 VALUE ZEROS.
  5020    05  F                       PIC X(11) VALUE "~CSONLFAMT=".
  5021    05  OUT-CSO-NEW-LF-PORT     PIC 9(7).99 VALUE ZEROS.
  5022    05  F                       PIC X(12) VALUE "~CSONALFAMT=".
  5023    05  OUT-CSO-NEW-ALT-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5024    05  F                       PIC X(12) VALUE "~CSONCLFAMT=".
  5025    05  OUT-CSO-NEW-CMB-LF-PORT PIC 9(7).99 VALUE ZEROS.
  5026    05  F                       PIC X(11) VALUE "~CSONAHAMT=".
  5027    05  OUT-CSO-NEW-AH-PORT     PIC 9(7).99 VALUE ZEROS.
  5028    05  F                       PIC X(09) VALUE "~CSONAMT=".
  5029    05  OUT-CSO-NEW-PORTION     PIC 9(7).99 VALUE ZEROS.
  5030    05  F                       PIC X(10) VALUE "~ACTLFCHG=".
  5031    05  OUT-ACCT-LF-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5032    05  F                       PIC X(11) VALUE "~ACTALFCHG=".
  5033    05  OUT-ACCT-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5034    05  F                       PIC X(11) VALUE "~ACTCLFCHG=".
  5035    05  OUT-ACCT-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5036    05  F                       PIC X(10) VALUE "~ACTAHCHG=".
  5037    05  OUT-ACCT-AH-PORT-CHG    PIC 9(7).99 VALUE ZEROS.
  5038    05  F                       PIC X(09) VALUE "~ACCTCHG=".
  5039    05  OUT-ACCT-PORTION-CHG    PIC 9(7).99 VALUE ZEROS.
  5040    05  F                       PIC X(10) VALUE "~CSOLFCHG=".
  5041    05  OUT-CSO-LF-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5042    05  F                       PIC X(11) VALUE "~CSOALFCHG=".
  5043    05  OUT-CSO-ALT-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5044    05  F                       PIC X(11) VALUE "~CSOCLFCHG=".
  5045    05  OUT-CSO-CMB-LF-PORT-CHG PIC 9(7).99 VALUE ZEROS.
  5046    05  F                       PIC X(10) VALUE "~CSOAHCHG=".
  5047    05  OUT-CSO-AH-PORT-CHG     PIC 9(7).99 VALUE ZEROS.
  5048    05  F                       PIC X(08) VALUE "~CSOCHG=".
  5049    05  OUT-CSO-PORTION-CHG     PIC 9(7).99 VALUE ZEROS.
  5050    05  F                       PIC X(10) VALUE "~LFOCANDT=".
  5051    05  OUT-ORIG-LF-CAN-DT      PIC X(21) VALUE SPACES.
  5052    05  F                       PIC X(10) VALUE "~LFNCANDT=".
  5053    05  OUT-NEW-LF-CAN-DT       PIC X(21) VALUE SPACES.
  5054    05  F                       PIC X(10) VALUE "~AHOCANDT=".
  5055    05  OUT-ORIG-AH-CAN-DT      PIC X(21) VALUE SPACES.
  5056    05  F                       PIC X(10) VALUE "~AHNCANDT=".
  5057    05  OUT-NEW-AH-CAN-DT       PIC X(21) VALUE SPACES.
  5058    05  F                       PIC X(11) VALUE "~ORIGCANDT=".
  5059    05  OUT-ORIG-CAN-DT         PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  89
* NSRASBL.cbl
  5060    05  F                       PIC X(10) VALUE "~NEWCANDT=".
  5061    05  OUT-NEW-CAN-DT          PIC X(21) VALUE SPACES.
  5062    05  F                       PIC X(8)  VALUE "~SCREEN=".
  5063    05  OUT-SCREEN-ID           PIC X(8)  VALUE SPACES.
  5064    05  F                       PIC X(9)  VALUE "~NXTBSDT=".
  5065    05  OUT-NEXT-BUS-DT         PIC X(21) VALUE SPACES.
  5066    05  F                       PIC X(11) VALUE 'EndOfString'.
  5067    05  f                       pic x(2) value spaces.
  5068*                                COPY ERCARCH.
  5069******************************************************************
  5070*                                                                *
  5071*                            ERCARCH.                            *
  5072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5073*                            VMOD=2.002                          *
  5074*                                                                *
  5075*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5076*                                                                *
  5077*   FILE TYPE = VSAM,KSDS                                        *
  5078*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5079*                                                                *
  5080*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5081*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5082*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5083*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5084*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5085*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5086*                                                                *
  5087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5088******************************************************************
  5089*                   C H A N G E   L O G
  5090*
  5091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5092*-----------------------------------------------------------------
  5093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5094* EFFECTIVE    NUMBER
  5095*-----------------------------------------------------------------
  5096* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5097* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5098* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5099******************************************************************
  5100 01  LETTER-ARCHIVE.
  5101     12  LA-RECORD-ID                PIC  X(02).
  5102         88  LA-VALID-ID                VALUE 'LA'.
  5103
  5104     12  LA-CONTROL-PRIMARY.
  5105         16  LA-COMPANY-CD           PIC  X(01).
  5106         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5107
  5108     12  LA-CONTROL-BY-CERT-RESP.
  5109         16  LA-COMPANY-CD-A2        PIC  X(01).
  5110         16  LA-CERT-NO-A2.
  5111             20  LA-CERT-PRIME-A2    PIC  X(10).
  5112             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5113         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5114             20  LA-RESP-PERSON-A2   PIC  X(10).
  5115             20  LA-TYPE-A2          PIC  X(01).
  5116         16  LA-CARRIER-A2           PIC  X(01).
  5117         16  LA-GROUPING-A2          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  90
* NSRASBL.cbl
  5118         16  LA-STATE-A2             PIC  X(02).
  5119         16  LA-ACCOUNT-A2           PIC  X(10).
  5120         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5121         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5122
  5123     12  LA-CONTROL-BY-FORM.
  5124         16  LA-COMPANY-CD-A3        PIC  X(01).
  5125         16  LA-FORM-A3              PIC  X(04).
  5126         16  LA-CARRIER-A3           PIC  X(01).
  5127         16  LA-GROUPING-A3          PIC  X(06).
  5128         16  LA-STATE-A3             PIC  X(02).
  5129         16  LA-ACCOUNT-A3           PIC  X(10).
  5130         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5131
  5132     12  LA-CONTROL-BY-PROCESSOR.
  5133         16  LA-COMPANY-CD-A4        PIC  X(01).
  5134         16  LA-PROCESSOR-CD         PIC  X(04).
  5135         16  LA-CARRIER-A4           PIC  X(01).
  5136         16  LA-GROUPING-A4          PIC  X(06).
  5137         16  LA-STATE-A4             PIC  X(02).
  5138         16  LA-ACCOUNT-A4           PIC  X(10).
  5139         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5140
  5141     12  LA-CONTROL-BY-KEY-FIELDS.
  5142         16  LA-COMPANY-CD-A5        PIC  X(01).
  5143         16  LA-CARRIER-A5           PIC  X(01).
  5144         16  LA-GROUPING-A5          PIC  X(06).
  5145         16  LA-STATE-A5             PIC  X(02).
  5146         16  LA-ACCOUNT-A5           PIC  X(10).
  5147         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5148
  5149     12  LA-CONTROL-BY-GROUP-CODE.
  5150         16  LA-COMPANY-CD-A6        PIC  X(01).
  5151         16  LA-ENTRY-A6.
  5152             20  LA-FILLER           PIC  X(02).
  5153             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5154         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5155
  5156     12  FILLER                      PIC  X(09).
  5157
  5158     12  LA-HEADER-RECORD.
  5159         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5160         16  LA-CREATION-DATE        PIC  X(02).
  5161         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5162         16  LA-FINAL-ACT-DATE       REDEFINES
  5163               LA-FOLLOW-UP-DATE     PIC  X(02).
  5164         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5165         16  LA-NO-OF-COPIES         PIC S9(01).
  5166         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5167         16  LA-REPLY-DATE           PIC  X(02).
  5168         16  LA-RESEND-DATES.
  5169             20  LA-RESEND-DATE      PIC  X(02).
  5170             20  LA-SENT-DATE        PIC  X(02).
  5171             20  FILLER              PIC  X(08).
  5172         16  LA-SOURCE-INFORMATION.
  5173             20  LA-DATA-SOURCE      PIC  X(01).
  5174             20  LA-ADDR-SOURCE      PIC  X(01).
  5175         16  LA-STATUS               PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  91
* NSRASBL.cbl
  5176             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5177             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5178             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5179             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5180             88  LA-STATUS-PURGED         VALUE 'P'.
  5181             88  LA-STATUS-VOIDED         VALUE 'V'.
  5182         16  LA-LAST-RESENT-PRINT-DATE
  5183                                     PIC  X(02).
  5184         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5185             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5186                                          VALUE 'C'.
  5187             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5188                                          VALUE 'F'.
  5189             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5190                                          VALUE 'P'.
  5191         16  LA-PURGED-DATE          PIC  X(02).
  5192         16  LA-VOIDED-DATE          PIC  X(02).
  5193         16  LA-RESEND-LETR          PIC  X(4).
  5194         16  FILLER                  PIC  X(08).
  5195*        16  LA-RESEND-LETR-2        PIC  X(4).
  5196*        16  LA-RESEND-LETR-3        PIC  X(4).
  5197*        16  FILLER                  PIC  X(59).
  5198         16  LA-ARCHIVE-STATUS       PIC  X.
  5199             88  LA-TEMP                VALUE 'T'.
  5200             88  LA-QWS                 VALUE 'Q'.
  5201             88  LA-BATCH               VALUE 'B'.
  5202         16  LA-FINAL-ACT-IND        PIC  X(1).
  5203         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5204         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5205         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5206                                     PIC X(4).
  5207         16  FILLER                  PIC  X(42).
  5208*        16  FILLER                  PIC  X(71).
  5209         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5210         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5211         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5212                                     PIC  X(4).
  5213         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5214
  5215******************************************************************
  5216*                                COPY ELCCRTT.
  5217******************************************************************
  5218*                                                                *
  5219*                            ELCCRTT.                            *
  5220*                                                                *
  5221*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5222*                                                                *
  5223*   FILE TYPE = VSAM,KSDS                                        *
  5224*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5225*                                                                *
  5226*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5227*                                                                *
  5228*   LOG = YES                                                    *
  5229*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5230******************************************************************
  5231*                   C H A N G E   L O G
  5232*
  5233* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  92
* NSRASBL.cbl
  5234*-----------------------------------------------------------------
  5235*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5236* EFFECTIVE    NUMBER
  5237*-----------------------------------------------------------------
  5238* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5239* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5240* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5241* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5242* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5243******************************************************************
  5244
  5245 01  CERTIFICATE-TRAILERS.
  5246     12  CS-RECORD-ID                      PIC XX.
  5247         88  VALID-CS-ID                      VALUE 'CS'.
  5248
  5249     12  CS-CONTROL-PRIMARY.
  5250         16  CS-COMPANY-CD                 PIC X.
  5251         16  CS-CARRIER                    PIC X.
  5252         16  CS-GROUPING                   PIC X(6).
  5253         16  CS-STATE                      PIC XX.
  5254         16  CS-ACCOUNT                    PIC X(10).
  5255         16  CS-CERT-EFF-DT                PIC XX.
  5256         16  CS-CERT-NO.
  5257             20  CS-CERT-PRIME             PIC X(10).
  5258             20  CS-CERT-SFX               PIC X.
  5259         16  CS-TRAILER-TYPE               PIC X.
  5260             88  COMM-TRLR           VALUE 'A'.
  5261             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5262             88  CERT-DATA-TRLR      VALUE 'C'.
  5263
  5264     12  CS-DATA-AREA                      PIC X(516).
  5265
  5266     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5267         16  CS-BANK-COMMISSION-AREA.
  5268             20  CS-BANK-COMMS       OCCURS 10.
  5269                 24  CS-AGT                PIC X(10).
  5270                 24  CS-COM-TYP            PIC X.
  5271                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5272                 24  CS-RECALC-LV-INDIC    PIC X.
  5273                 24  FILLER                PIC X(10).
  5274         16  FILLER                        PIC X(256).
  5275
  5276     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5277****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5278****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5279         16  CS-MB-CLAIM-DATA OCCURS 2.
  5280             20  FILLER OCCURS 10.
  5281                 24  CS-CLAIM-TYPE         PIC X.
  5282                     88  CS-AH-CLM           VALUE 'A'.
  5283                     88  CS-IU-CLM           VALUE 'I'.
  5284                     88  CS-GP-CLM           VALUE 'G'.
  5285                     88  CS-LF-CLM           VALUE 'L'.
  5286                     88  CS-PR-CLM           VALUE 'P'.
  5287                 24  CS-BANK               PIC S999 COMP-3.
  5288                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5289                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5290                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5291         16  FILLER                        PIC X(216).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  93
* NSRASBL.cbl
  5292     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5293         16  CS-VIN-NUMBER                 PIC X(17).
  5294         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5295         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5296         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5297         16  FILLER                        PIC X(496).
  5298******************************************************************
  5299 01  FILLER                      PIC X(500)  VALUE SPACES.
  5300*                                COPY ELCENCC.
  5301******************************************************************
  5302*                                                                *
  5303*                                                                *
  5304*                            ELCENCC                             *
  5305*                            VMOD=2.001                          *
  5306*                                                                *
  5307*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5308*                                                                *
  5309*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5310*   A NAPERSOFT DOCUMENT                                         *
  5311*                                                                *
  5312*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5313*                                                                *
  5314*   FILE TYPE = VSAM,KSDS                                        *
  5315*   RECORD SIZE = 400   RECFORM = FIX                            *
  5316*                                                                *
  5317*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5318*                                                                *
  5319*   LOG = NO                                                     *
  5320*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5321*                                                                *
  5322*                                                                *
  5323******************************************************************
  5324*                   C H A N G E   L O G
  5325*
  5326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5327*-----------------------------------------------------------------
  5328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5329* EFFECTIVE    NUMBER
  5330*-----------------------------------------------------------------
  5331* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5332******************************************************************
  5333 01  ENCLOSURE-CODES.
  5334     12  NC-RECORD-ID                      PIC XX.
  5335         88  VALID-NC-ID                      VALUE 'NC'.
  5336     12  NC-CONTROL-PRIMARY.
  5337         16  NC-COMPANY-CD                 PIC X.
  5338         16  NC-REC-TYPE                   PIC X.
  5339             88  NC-CLAIMS                   VALUE '1'.
  5340             88  NC-ADMIN                    VALUE '2'.
  5341         16  NC-ENC-CODE                   PIC X(5).
  5342         16  FILLER                        PIC X(09).
  5343     12  NC-MAINT-INFORMATION.
  5344         16  NC-LAST-MAINT-DT              PIC XX.
  5345         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5346         16  NC-LAST-MAINT-USER            PIC X(4).
  5347         16  FILLER                        PIC XX.
  5348     12  NC-OUTPUT-STACK                   PIC XXX.
  5349     12  NC-ENCLOSURE-LINE                 PIC X(100).
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  94
* NSRASBL.cbl
  5350     12  NC-ATTACHMENTS                    PIC X(100).
  5351     12  NC-FUTURE                         PIC X(50).
  5352     12  FILLER                            PIC X(117).
  5353******************************************************************
  5354****************************************************************
  5355*
  5356* Copyright (c) 2007 by Clerity Solutions, Inc.
  5357* All rights reserved.
  5358*
  5359****************************************************************
  5360 01  DFHEIV.
  5361   02  DFHEIV0               PIC X(35).
  5362   02  DFHEIV1               PIC X(08).
  5363   02  DFHEIV2               PIC X(08).
  5364   02  DFHEIV3               PIC X(08).
  5365   02  DFHEIV4               PIC X(06).
  5366   02  DFHEIV5               PIC X(04).
  5367   02  DFHEIV6               PIC X(04).
  5368   02  DFHEIV7               PIC X(02).
  5369   02  DFHEIV8               PIC X(02).
  5370   02  DFHEIV9               PIC X(01).
  5371   02  DFHEIV10              PIC S9(7) COMP-3.
  5372   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5373   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5374   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5375   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5376   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5377   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5378   02  DFHEIV17              PIC X(04).
  5379   02  DFHEIV18              PIC X(04).
  5380   02  DFHEIV19              PIC X(04).
  5381   02  DFHEIV20              USAGE IS POINTER.
  5382   02  DFHEIV21              USAGE IS POINTER.
  5383   02  DFHEIV22              USAGE IS POINTER.
  5384   02  DFHEIV23              USAGE IS POINTER.
  5385   02  DFHEIV24              USAGE IS POINTER.
  5386   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5387   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5388   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5389   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5390   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5391   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5392   02  FILLER                PIC X(02).
  5393   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5394   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5395   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5396   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5397   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5398 LINKAGE  SECTION.
  5399*****************************************************************
  5400*                                                               *
  5401* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5402* All rights reserved.                                          *
  5403*                                                               *
  5404*****************************************************************
  5405 01  dfheiblk.
  5406     02  eibtime          pic s9(7) comp-3.
  5407     02  eibdate          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  95
* NSRASBL.cbl
  5408     02  eibtrnid         pic x(4).
  5409     02  eibtaskn         pic s9(7) comp-3.
  5410     02  eibtrmid         pic x(4).
  5411     02  dfheigdi         pic s9(4) comp.
  5412     02  eibcposn         pic s9(4) comp.
  5413     02  eibcalen         pic s9(4) comp.
  5414     02  eibaid           pic x(1).
  5415     02  eibfiller1       pic x(1).
  5416     02  eibfn            pic x(2).
  5417     02  eibfiller2       pic x(2).
  5418     02  eibrcode         pic x(6).
  5419     02  eibfiller3       pic x(2).
  5420     02  eibds            pic x(8).
  5421     02  eibreqid         pic x(8).
  5422     02  eibrsrce         pic x(8).
  5423     02  eibsync          pic x(1).
  5424     02  eibfree          pic x(1).
  5425     02  eibrecv          pic x(1).
  5426     02  eibsend          pic x(1).
  5427     02  eibatt           pic x(1).
  5428     02  eibeoc           pic x(1).
  5429     02  eibfmh           pic x(1).
  5430     02  eibcompl         pic x(1).
  5431     02  eibsig           pic x(1).
  5432     02  eibconf          pic x(1).
  5433     02  eiberr           pic x(1).
  5434     02  eibrldbk         pic x(1).
  5435     02  eiberrcd         pic x(4).
  5436     02  eibsynrb         pic x(1).
  5437     02  eibnodat         pic x(1).
  5438     02  eibfiller5       pic x(2).
  5439     02  eibresp          pic 9(09) comp.
  5440     02  eibresp2         pic 9(09) comp.
  5441     02  dfheigdj         pic s9(4) comp.
  5442     02  dfheigdk         pic s9(4) comp.
  5443 01 dfhcommarea                  PIC X(6500).
  5444 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5445 0000-DFHEXIT SECTION.
  5446     MOVE '9#                    $   ' TO DFHEIV0.
  5447     MOVE 'NSRASBL' TO DFHEIV1.
  5448     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5449     display ' entering pgm nsrasbl '
  5450     display ' commarea ' dfhcommarea
  5451     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5452     MOVE '5'                    TO DC-OPTION-CODE
  5453     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5454     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5455     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5456     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5457
  5458     MOVE '6'                    TO DC-OPTION-CODE
  5459     IF DC-DAY-OF-WEEK = 6
  5460        MOVE 3                   TO DC-ELAPSED-DAYS
  5461     ELSE
  5462        IF DC-DAY-OF-WEEK = 7
  5463           MOVE 2                TO DC-ELAPSED-DAYS
  5464        ELSE
  5465           MOVE 1                TO DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  96
* NSRASBL.cbl
  5466        END-IF
  5467     END-IF
  5468     PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5469     IF NO-CONVERSION-ERROR
  5470         MOVE DC-BIN-DATE-2      TO SAVE-BIN-NEXT-BUS-DT
  5471     ELSE
  5472         DISPLAY 'ERROR CALCULATING NEXT BUS DATE'
  5473         MOVE SAVE-BIN-DATE      TO SAVE-BIN-NEXT-BUS-DT
  5474     END-IF
  5475
  5476     move dfhcommarea            to srch-commarea
  5477*****************************************************
  5478* The full       key has been established and passed
  5479* to this program via NSRASLTR
  5480*****************************************************
  5481     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5482     display ' input data ' bl-carrier ' ' bl-group ' '
  5483        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5484     MOVE BL-LETTER-ID           TO OUT-LETTER
  5485     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5486     MOVE BL-CARRIER             TO OUT-CARRIER
  5487     MOVE BL-GROUP               TO OUT-GROUPING
  5488     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5489     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5490     MOVE BL-CERT-FORM-ID        TO OUT-CERTIFICATE-ID
  5491     MOVE BL-SOURCE-SCREEN       TO OUT-SCREEN-ID
  5492     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5493        DC-EDITA-DAY  DELIMITED BY SIZE
  5494        INTO OUT-CYCLE-DT
  5495     END-STRING
  5496
  5497     STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5498        DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5499           INTO OUT-NEXT-BUS-DT
  5500     END-STRING
  5501     MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  5502     MOVE '6'                 TO DC-OPTION-CODE
  5503     IF DC-DAY-OF-WEEK = 6
  5504        MOVE 3                TO DC-ELAPSED-DAYS
  5505     ELSE
  5506        IF DC-DAY-OF-WEEK = 7
  5507           MOVE 2             TO DC-ELAPSED-DAYS
  5508        ELSE
  5509           MOVE 1             TO DC-ELAPSED-DAYS
  5510        END-IF
  5511     END-IF
  5512     PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5513     IF NO-CONVERSION-ERROR
  5514        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5515           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5516              INTO OUT-NEXT-BUS-DT
  5517        END-STRING
  5518     END-IF
  5519     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5520        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5521     ELSE
  5522        IF BL-EFF-DT = SPACES
  5523           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  97
* NSRASBL.cbl
  5524        ELSE
  5525           IF BL-EFF-DT (9:2) = SPACES
  5526              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5527                     BL-EFF-DT (4:2)
  5528                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5529              END-STRING
  5530           ELSE
  5531              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5532                     BL-EFF-DT (4:2)
  5533                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5534              END-STRING
  5535           END-IF
  5536           MOVE '3'              TO DC-OPTION-CODE
  5537           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5538           IF NO-CONVERSION-ERROR
  5539              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
  5540           ELSE
  5541              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5542              SET BL-FAIL TO TRUE
  5543              GO TO 0000-RETURN
  5544           END-IF
  5545        END-IF
  5546     END-IF
  5547     perform 0800-init-out-data  thru 0800-exit
  5548     SET BL-FAIL TO TRUE
  5549******************************************************************
  5550* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5551*    1) FROM ACCT MAINT
  5552*    2) FROM CERT UPDATE
  5553*    3) FROM COMP MAINT
  5554*    4) FROM REVIEW AND CORRECTIONS
  5555******************************************************************
  5556     EVALUATE BL-DATA-SRCE
  5557        WHEN '1'
  5558           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5559        WHEN '2'
  5560           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5561        WHEN '3'
  5562           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5563        WHEN '4'
  5564           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5565        WHEN OTHER
  5566           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5567     END-EVALUATE
  5568     IF BL-OK
  5569        display ' bl write erarch ' bl-write-erarch
  5570        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5571        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5572        IF BL-ARCHIVE-NO = ZEROS
  5573           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5574           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5575           display ' arch zeros, new arch ' bl-archive-no
  5576        END-IF
  5577        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5578        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5579        display ' bl write erarch ' bl-write-erarch
  5580        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5581           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  98
* NSRASBL.cbl
  5582           IF BL-FAIL
  5583              GO TO 0000-RETURN
  5584           END-IF
  5585        END-IF
  5586        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5587        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5588     END-IF
  5589     .
  5590 0000-RETURN.
  5591     move srch-commarea          to dfhcommarea
  5592
  5593* exec cics
  5594*       return
  5595*    end-exec
  5596*    MOVE '.(                    ''   #00005588' TO DFHEIV0
  5597     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5598     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5599     MOVE X'2020233030303035353838' TO DFHEIV0(25:11)
  5600     CALL 'kxdfhei1' USING DFHEIV0,
  5601           DFHEIV99,
  5602           DFHEIV99,
  5603           DFHEIV99,
  5604           DFHEIV99,
  5605           DFHEIV99,
  5606           DFHEIV99
  5607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5608     .
  5609 0100-DATA-SRCE-1.
  5610     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5611     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5612     MOVE ' '                    TO WS-ERACCT-SW
  5613     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5614     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5615     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5616     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5617     MOVE BL-STATE               TO WS-ERACCT-STATE
  5618     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5619     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5620                                    WS-CERT-EFF-DT
  5621     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5622     IF ACCT-FOUND
  5623        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5624        PERFORM 1025-GET-CSR-INFO
  5625                                 THRU 1025-EXIT
  5626        PERFORM 1300-DETERMINE-COMM
  5627                                 THRU 1300-EXIT
  5628        SET BL-OK TO TRUE
  5629     ELSE
  5630        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5631        SET BL-FAIL TO TRUE
  5632     END-IF
  5633     .
  5634 0100-EXIT.
  5635     EXIT.
  5636 0200-DATA-SRCE-2.
  5637     display ' made it to data srce 2 '
  5638     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5639     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page  99
* NSRASBL.cbl
  5640     MOVE ' '                    TO WS-ELCERT-SW
  5641     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5642     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5643     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5644     MOVE BL-STATE               TO WS-ELCERT-STATE
  5645     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5646     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5647                                    WS-CERT-EFF-DT
  5648     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5649
  5650     MOVE ' '                 TO WS-ERACCT-SW
  5651     MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5652     MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5653     PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5654     IF ACCT-FOUND
  5655        MOVE AM-CSR-CODE      TO WS-CSR-ID
  5656        PERFORM 1025-GET-CSR-INFO THRU 1025-EXIT
  5657     END-IF
  5658     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5659     IF CERT-FOUND
  5660        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5661        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5662        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5663        IF WS-LF-EARN = 'B'
  5664           MOVE 'B'              TO OUT-BALLOON-IND
  5665        END-IF
  5666        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5667        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5668        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5669        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5670
  5671        IF BL-ENDT-ARCH-NO > ZERO
  5672           MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5673           MOVE BL-ENDT-ARCH-NO    TO WS-ERENDT-ARCHIVE
  5674           PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5675        ELSE
  5676           IF BL-ARCHIVE-NO > ZERO
  5677              MOVE WS-COMPANY-CD      TO WS-ERENDT-COMPANY-CD-A1
  5678              MOVE BL-ARCHIVE-NO      TO WS-ERENDT-ARCHIVE
  5679              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5680           END-IF
  5681        END-IF
  5682
  5683        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5684           AND (OUT-BALLOON-IND = 'B')
  5685           MOVE 'B'              TO OUT-FORM (3:1)
  5686        END-IF
  5687        SET BL-OK TO TRUE
  5688     ELSE
  5689        display ' cert not found ' ws-elcert-cert-no
  5690        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5691        SET BL-FAIL TO TRUE
  5692     END-IF
  5693     .
  5694 0200-EXIT.
  5695     EXIT.
  5696 0300-DATA-SRCE-3.
  5697     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 100
* NSRASBL.cbl
  5698     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5699     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5700     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5701     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5702     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5703     IF WS-ERCOMP-ACCOUNT = SPACES
  5704        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5705        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5706     ELSE
  5707        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5708     END-IF
  5709     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5710     IF RESP-NORMAL
  5711        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5712        PERFORM 1025-GET-CSR-INFO
  5713                                 THRU 1025-EXIT
  5714        SET BL-OK TO TRUE
  5715     ELSE
  5716        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5717        SET BL-FAIL TO TRUE
  5718     END-IF
  5719     .
  5720 0300-EXIT.
  5721     EXIT.
  5722 0400-DATA-SRCE-4.
  5723     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5724     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5725     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
  5726     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5727     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5728                                    WS-ELCERT-SW WS-ERENDT-SW
  5729
  5730* EXEC CICS READ
  5731*         DATASET    ('ERPNDB')
  5732*         INTO       (PENDING-BUSINESS)
  5733*         RIDFLD     (WS-ERPNDB-KEY)
  5734*         RESP       (WS-RESPONSE)
  5735*    END-EXEC
  5736     MOVE LENGTH OF
  5737      PENDING-BUSINESS
  5738       TO DFHEIV11
  5739     MOVE 'ERPNDB' TO DFHEIV1
  5740*    MOVE '&"IL       E          (  N#00005712' TO DFHEIV0
  5741     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5743     MOVE X'204E233030303035373132' TO DFHEIV0(25:11)
  5744     CALL 'kxdfhei1' USING DFHEIV0,
  5745           DFHEIV1,
  5746           PENDING-BUSINESS,
  5747           DFHEIV11,
  5748           WS-ERPNDB-KEY,
  5749           DFHEIV99,
  5750           DFHEIV99,
  5751           DFHEIV99
  5752     MOVE EIBRESP  TO WS-RESPONSE
  5753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5754     IF RESP-NORMAL
  5755        IF PB-RECORD-TYPE = '1' OR '2'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 101
* NSRASBL.cbl
  5756           MOVE PB-CARRIER       TO BL-CARRIER
  5757           MOVE PB-GROUPING      TO BL-GROUP
  5758           MOVE PB-STATE         TO BL-STATE
  5759           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5760           MOVE PB-CERT-NO       TO BL-CERT-NO
  5761           MOVE PB-CSR-ID        TO WS-CSR-ID
  5762           IF PB-ISSUE
  5763              SET PROCESS-ISSUE TO TRUE
  5764              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5765              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5766              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5767              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5768           ELSE
  5769              SET PROCESS-CANCEL TO TRUE
  5770              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5771              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5772              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5773              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5774           END-IF
  5775           PERFORM 1120-MATCH-CARRIER
  5776                                 THRU 1120-EXIT
  5777           PERFORM 1125-MATCH-STATE
  5778                                 THRU 1125-EXIT
  5779           PERFORM 1130-MATCH-BENCDS
  5780                                 THRU 1130-EXIT
  5781           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5782           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5783                                    OUT-ORIG-LF-DESC
  5784           IF WS-LF-EARN = 'B'
  5785              MOVE 'B'           TO OUT-BALLOON-IND
  5786           END-IF
  5787           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5788                                    OUT-ORIG-WAIT-PER
  5789           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5790                                    OUT-ORIG-RET-ELIM
  5791           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5792                                    OUT-ORIG-AH-DESC
  5793           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5794                                    OUT-ORIG-BEN-DAYS
  5795           PERFORM 1025-GET-CSR-INFO
  5796                                 THRU 1025-EXIT
  5797
  5798           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5799           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5800                                 TO WS-ERACCT-KEY (1:22)
  5801           MOVE PB-CERT-EFF-DT   TO WS-CERT-EFF-DT
  5802           PERFORM 1200-GET-ERACCT THRU 1200-EXIT
  5803           IF ACCT-FOUND
  5804              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5805              PERFORM 1025-GET-CSR-INFO
  5806                                    THRU 1025-EXIT
  5807              PERFORM 1300-DETERMINE-COMM
  5808                                    THRU 1300-EXIT
  5809           END-IF
  5810
  5811           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5812                                 TO WS-ELCERT-KEY
  5813           PERFORM 1100-GET-ELCERT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 102
* NSRASBL.cbl
  5814                                 THRU 1100-EXIT
  5815
  5816           IF BL-ENDT-ARCH-NO > ZERO
  5817              MOVE PB-COMPANY-CD   TO WS-ERENDT-COMPANY-CD-A1
  5818              MOVE BL-ENDT-ARCH-NO TO WS-ERENDT-ARCHIVE
  5819              PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5820           ELSE
  5821              IF BL-ARCHIVE-NO > ZERO
  5822                 MOVE PB-COMPANY-CD TO WS-ERENDT-COMPANY-CD-A1
  5823                 MOVE BL-ARCHIVE-NO TO WS-ERENDT-ARCHIVE
  5824                 PERFORM 0600-GET-ERENDT THRU 0600-EXIT
  5825              END-IF
  5826           END-IF
  5827
  5828           SET BL-OK TO TRUE
  5829           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5830              AND (OUT-BALLOON-IND = 'B')
  5831              MOVE 'B'           TO OUT-FORM (3:1)
  5832           END-IF
  5833        END-IF
  5834     END-IF
  5835     .
  5836 0400-EXIT.
  5837     EXIT.
  5838 0500-SCRUB-DATA.
  5839*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5840*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5841*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5842*   TO A HEX 26 TO GET BY THE DECODER
  5843     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5844                                 TO M1
  5845     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5846     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5847        (A1 > M1)
  5848        OR (WS-WORK-FIELD (A1:1) = '*')
  5849        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5850        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5851     END-PERFORM
  5852     IF A1 > M1
  5853        CONTINUE
  5854     ELSE
  5855        MOVE WS-WORK-FIELD (1:A1 - 1)
  5856                                 TO OUT-ACCT-NAME
  5857     END-IF
  5858     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5859                                 TO M1
  5860     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5861     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5862        (A1 > M1)
  5863        OR (WS-WORK-FIELD (A1:1) = '*')
  5864        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5865        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5866     END-PERFORM
  5867     IF A1 > M1
  5868        CONTINUE
  5869     ELSE
  5870        MOVE WS-WORK-FIELD (1:A1 - 1)
  5871                                 TO OUT-BENE-NAME
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 103
* NSRASBL.cbl
  5872     END-IF
  5873     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5874         MOVE '0000000000 '  TO OUT-CERT-NO
  5875     END-IF
  5876     MOVE +1 TO M1
  5877     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5878     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5879                                 TO NS-LEN
  5880     display ' naper output data length ' ns-len
  5881     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5882        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5883        OR (A1 > NS-LEN)
  5884        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5885           CONTINUE
  5886        ELSE
  5887           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5888              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5889              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5890              ADD +1 TO M1
  5891           ELSE
  5892              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5893                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5894                 ADD +3 TO M1
  5895              ELSE
  5896                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5897                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5898                 ADD +1 TO M1
  5899              END-IF
  5900           END-IF
  5901        END-IF
  5902     END-PERFORM
  5903     .
  5904 0500-EXIT.
  5905     EXIT.
  5906 0600-GET-ERENDT.
  5907
  5908* EXEC CICS READ
  5909*         DATASET    ('ERENDT2')
  5910*         INTO       (ENDORSEMENT-RECORD)
  5911*         RIDFLD     (WS-ERENDT-KEY-BY-ARCH)
  5912*         RESP       (WS-RESPONSE)
  5913*    END-EXEC
  5914     MOVE LENGTH OF
  5915      ENDORSEMENT-RECORD
  5916       TO DFHEIV11
  5917     MOVE 'ERENDT2' TO DFHEIV1
  5918*    MOVE '&"IL       E          (  N#00005871' TO DFHEIV0
  5919     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5920     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5921     MOVE X'204E233030303035383731' TO DFHEIV0(25:11)
  5922     CALL 'kxdfhei1' USING DFHEIV0,
  5923           DFHEIV1,
  5924           ENDORSEMENT-RECORD,
  5925           DFHEIV11,
  5926           WS-ERENDT-KEY-BY-ARCH,
  5927           DFHEIV99,
  5928           DFHEIV99,
  5929           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 104
* NSRASBL.cbl
  5930     MOVE EIBRESP  TO WS-RESPONSE
  5931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5932     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5933         WS-ERENDT-ARCHIVE
  5934     IF (RESP-NORMAL)
  5935        SET ENDT-FOUND TO TRUE
  5936        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5937        PERFORM 0650-PROCESS-NO-Change
  5938                                 THRU 0650-EXIT
  5939     END-IF
  5940     .
  5941 0600-EXIT.
  5942     EXIT.
  5943 0620-BUILD-ENDT.
  5944     MOVE SPACES                 TO OUT-ORIG-LF-CAN-DT
  5945                                    OUT-NEW-LF-CAN-DT
  5946                                    OUT-ORIG-AH-CAN-DT
  5947                                    OUT-NEW-AH-CAN-DT
  5948                                    OUT-ORIG-CAN-DT
  5949                                    OUT-NEW-CAN-DT
  5950     IF EN-REC-TYPE = 'C'
  5951        GO TO 0620-PROCESS-CANCEL
  5952     END-IF
  5953     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5954     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5955     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5956     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5957     IF WS-LF-EARN = 'B'
  5958        MOVE 'B'                 TO OUT-BALLOON-IND
  5959     END-IF
  5960     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5961     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5962     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5963     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5964     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5965     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5966     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
  5967     IF EN-INS-ORIG-AGE-DEF-FLAG = 'Y'
  5968         MOVE ZERO                 TO OUT-ORIG-IAGE
  5969     ELSE
  5970         MOVE EN-INS-ORIG-AGE      TO OUT-ORIG-IAGE
  5971     END-IF
  5972     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5973     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5974     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5975     IF EN-JNT-ORIG-AGE-DEF-FLAG = 'Y'
  5976         MOVE ZERO                 TO OUT-ORIG-JAGE
  5977     ELSE
  5978         MOVE EN-JNT-ORIG-AGE      TO OUT-ORIG-JAGE
  5979     END-IF
  5980     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5981     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5982     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5983     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5984     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5985     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5986     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  5987                             EN-LF-ORIG-ALT-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 105
* NSRASBL.cbl
  5988     MOVE WS-WRK-AMOUNT          TO OUT-ORIG-LF-CMB-PREM
  5989     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5990         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5991                                    OUT-ORIG-LF-PRM-A
  5992                                    OUT-ORIG-LF-ALT-BEN-A
  5993                                    OUT-ORIG-LF-ALT-PRM-A
  5994                                    OUT-ORIG-COVERAGE-IND
  5995     ELSE
  5996         MOVE 'LIFE'             TO OUT-ORIG-COVERAGE-IND
  5997         IF EN-LF-ORIG-PRM-AMT = .01
  5998             MOVE SPACES         TO OUT-ORIG-LF-PRM-A
  5999         END-IF
  6000         IF EN-LF-ORIG-BEN-AMT = 999999999.99
  6001             MOVE SPACES         TO OUT-ORIG-LF-BEN-A
  6002         END-IF
  6003         IF EN-LF-ORIG-ALT-PRM-AMT = .01
  6004             MOVE SPACES         TO OUT-ORIG-LF-ALT-PRM-A
  6005         END-IF
  6006         IF EN-LF-ORIG-ALT-BEN-AMT = 999999999.99
  6007             MOVE SPACES         TO OUT-ORIG-LF-ALT-BEN-A
  6008         END-IF
  6009     END-IF
  6010     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6011     MOVE ' '                    TO DC-OPTION-CODE
  6012     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6013     IF NO-CONVERSION-ERROR
  6014        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6015           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6016              INTO OUT-ORIG-LF-EXP-DT
  6017        END-STRING
  6018     END-IF
  6019     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  6020     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  6021     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  6022     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  6023     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6024         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  6025                                    OUT-ORIG-AH-PRM-A
  6026     ELSE
  6027        IF OUT-ORIG-COVERAGE-IND = 'LIFE'
  6028            MOVE 'BOTH'          TO OUT-ORIG-COVERAGE-IND
  6029        ELSE
  6030            MOVE 'AH  '          TO OUT-ORIG-COVERAGE-IND
  6031        END-IF
  6032        IF EN-AH-ORIG-PRM-AMT = .01
  6033            MOVE SPACES          TO OUT-ORIG-AH-PRM-A
  6034        END-IF
  6035        IF EN-AH-ORIG-BEN-AMT = 9999999.99
  6036            MOVE SPACES          TO OUT-ORIG-AH-BEN-A
  6037        END-IF
  6038     END-IF
  6039     COMPUTE WS-WORK-PREM =
  6040        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  6041           + EN-AH-ORIG-PRM-AMT
  6042     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  6043     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  6044     MOVE ' '                    TO DC-OPTION-CODE
  6045     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 106
* NSRASBL.cbl
  6046     IF NO-CONVERSION-ERROR
  6047        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6048           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6049              INTO OUT-ORIG-AH-EXP-DT
  6050        END-STRING
  6051     END-IF
  6052     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  6053                                    OUT-ORIG-MAX-PMTS
  6054     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  6055         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  6056     END-IF
  6057     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  6058     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  6059     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  6060     IF EN-INS-NEW-AGE-DEF-FLAG = 'Y'
  6061         MOVE ZERO                TO OUT-NEW-IAGE
  6062     ELSE
  6063         MOVE EN-INS-NEW-AGE      TO OUT-NEW-IAGE
  6064     END-IF
  6065     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  6066     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
  6067     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  6068     IF EN-JNT-NEW-AGE-DEF-FLAG = 'Y'
  6069         MOVE ZERO                TO OUT-NEW-JAGE
  6070     ELSE
  6071         MOVE EN-JNT-NEW-AGE      TO OUT-NEW-JAGE
  6072     END-IF
  6073     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  6074     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  6075     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  6076     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  6077     IF WS-LF-EARN = 'B'
  6078        MOVE 'B'                 TO OUT-BALLOON-IND
  6079     END-IF
  6080     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  6081     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  6082     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  6083     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  6084     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  6085     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  6086     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  6087     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  6088     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  6089     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  6090     COMPUTE WS-WRK-AMOUNT = EN-LF-NEW-PRM-AMT +
  6091                             EN-LF-NEW-ALT-PRM-AMT
  6092     MOVE WS-WRK-AMOUNT           TO OUT-NEW-LF-CMB-PREM
  6093     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  6094         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  6095                                    OUT-NEW-LF-PRM-A
  6096                                    OUT-NEW-LF-ALT-BEN-A
  6097                                    OUT-NEW-LF-ALT-PRM-A
  6098                                    OUT-NEW-LF-CMB-PREM-A
  6099                                    OUT-NEW-COVERAGE-IND
  6100     ELSE
  6101         MOVE 'LIFE'             TO OUT-NEW-COVERAGE-IND
  6102     END-IF
  6103    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 107
* NSRASBL.cbl
  6104     MOVE ' '                     TO DC-OPTION-CODE
  6105     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6106     IF NO-CONVERSION-ERROR
  6107        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6108           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6109              INTO OUT-NEW-LF-EXP-DT
  6110        END-STRING
  6111     END-IF
  6112     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  6113     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  6114     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  6115     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  6116     COMPUTE WS-WORK-PREM =
  6117        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  6118           + EN-AH-NEW-PRM-AMT
  6119     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  6120     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6121         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  6122                                    OUT-NEW-AH-PRM-A
  6123     ELSE
  6124        IF OUT-NEW-COVERAGE-IND = 'LIFE'
  6125            MOVE 'BOTH'          TO OUT-NEW-COVERAGE-IND
  6126        ELSE
  6127            MOVE 'AH  '          TO OUT-NEW-COVERAGE-IND
  6128        END-IF
  6129     END-IF
  6130     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  6131     MOVE ' '                     TO DC-OPTION-CODE
  6132     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  6133     IF NO-CONVERSION-ERROR
  6134        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6135           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6136              INTO OUT-NEW-AH-EXP-DT
  6137        END-STRING
  6138     END-IF
  6139     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  6140                                     OUT-NEW-MAX-PMTS
  6141     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  6142         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  6143     END-IF
  6144     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  6145        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6146     ELSE
  6147        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  6148     END-IF
  6149     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  6150        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6151     ELSE
  6152        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  6153     END-IF
  6154     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  6155        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6156     ELSE
  6157        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  6158     END-IF
  6159     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  6160        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6161     ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 108
* NSRASBL.cbl
  6162        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  6163     END-IF
  6164     COMPUTE WS-WORK-PREM =
  6165        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  6166        EN-AH-NEW-PRM-AMT) -
  6167        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  6168        EN-AH-ORIG-PRM-AMT)
  6169     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  6170     IF EN-CSO-PORTION NOT NUMERIC
  6171        MOVE ZEROS               TO EN-CSO-PORTION
  6172     END-IF
  6173     IF EN-ACCT-PORTION NOT NUMERIC
  6174        MOVE ZERO                TO EN-ACCT-PORTION
  6175     END-IF
  6176*    MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6177*    MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6178     IF WS-WORK-PREM > +0
  6179        MOVE 'CSO'               TO OUT-PAYEE
  6180     ELSE
  6181      IF WS-WORK-PREM = +0
  6182         MOVE 'ZERO'             TO OUT-PAYEE
  6183      ELSE
  6184         MOVE 'ACCT'             TO OUT-PAYEE
  6185      END-IF
  6186     END-IF
  6187     COMPUTE WS-ACCT-ORIG-LF-PORT =
  6188        EN-LF-ORIG-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6189     MOVE WS-ACCT-ORIG-LF-PORT TO OUT-ACCT-ORIG-LF-PORT
  6190     COMPUTE WS-ACCT-ORIG-ALT-LF-PORT =
  6191        EN-LF-ORIG-ALT-PRM-AMT * EN-LF-ORIG-COMM-PCT
  6192     MOVE WS-ACCT-ORIG-ALT-LF-PORT TO OUT-ACCT-ORIG-ALT-LF-PORT
  6193     COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6194        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6195        * EN-LF-ORIG-COMM-PCT
  6196     MOVE WS-ACCT-ORIG-CMB-LF-PORT TO OUT-ACCT-ORIG-CMB-LF-PORT
  6197     COMPUTE WS-ACCT-ORIG-AH-PORT =
  6198        EN-AH-ORIG-PRM-AMT * EN-AH-ORIG-COMM-PCT
  6199     MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6200     COMPUTE WS-ACCT-ORIG-PORTION =
  6201        WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6202     MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6203
  6204     COMPUTE WS-CSO-ORIG-LF-PORT =
  6205       EN-LF-ORIG-PRM-AMT - WS-ACCT-ORIG-LF-PORT
  6206     MOVE WS-CSO-ORIG-LF-PORT TO OUT-CSO-ORIG-LF-PORT
  6207     COMPUTE WS-CSO-ORIG-ALT-LF-PORT =
  6208       EN-LF-ORIG-ALT-PRM-AMT - WS-ACCT-ORIG-ALT-LF-PORT
  6209     MOVE WS-CSO-ORIG-ALT-LF-PORT TO OUT-CSO-ORIG-ALT-LF-PORT
  6210     COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6211       (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  6212        WS-ACCT-ORIG-CMB-LF-PORT
  6213     MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6214     COMPUTE WS-CSO-ORIG-AH-PORT =
  6215        EN-AH-ORIG-PRM-AMT - WS-ACCT-ORIG-AH-PORT
  6216     MOVE WS-CSO-ORIG-AH-PORT TO OUT-CSO-ORIG-AH-PORT
  6217     COMPUTE WS-CSO-ORIG-PORTION =
  6218        WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6219     MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 109
* NSRASBL.cbl
  6220     COMPUTE WS-ACCT-NEW-LF-PORT =
  6221        EN-LF-NEW-PRM-AMT * EN-LF-NEW-COMM-PCT
  6222     MOVE WS-ACCT-NEW-LF-PORT TO OUT-ACCT-NEW-LF-PORT
  6223     COMPUTE WS-ACCT-NEW-ALT-LF-PORT =
  6224        EN-LF-NEW-ALT-PRM-AMT * EN-LF-NEW-COMM-PCT
  6225     MOVE WS-ACCT-NEW-ALT-LF-PORT TO OUT-ACCT-NEW-ALT-LF-PORT
  6226     COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6227        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT)
  6228        * EN-LF-NEW-COMM-PCT
  6229     MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6230     COMPUTE WS-ACCT-NEW-AH-PORT =
  6231        EN-AH-NEW-PRM-AMT * EN-AH-NEW-COMM-PCT
  6232     MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6233     COMPUTE WS-ACCT-NEW-PORTION =
  6234        WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6235     MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6236
  6237     COMPUTE WS-CSO-NEW-LF-PORT =
  6238       EN-LF-NEW-PRM-AMT - WS-ACCT-NEW-LF-PORT
  6239     MOVE WS-CSO-NEW-LF-PORT TO OUT-CSO-NEW-LF-PORT
  6240     COMPUTE WS-CSO-NEW-ALT-LF-PORT =
  6241       EN-LF-NEW-ALT-PRM-AMT - WS-ACCT-NEW-ALT-LF-PORT
  6242     MOVE WS-CSO-NEW-ALT-LF-PORT TO OUT-CSO-NEW-ALT-LF-PORT
  6243     COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6244       (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6245        WS-ACCT-NEW-CMB-LF-PORT
  6246     MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6247     COMPUTE WS-CSO-NEW-AH-PORT =
  6248        EN-AH-NEW-PRM-AMT - WS-ACCT-NEW-AH-PORT
  6249     MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6250     COMPUTE WS-CSO-NEW-PORTION =
  6251        WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6252     MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6253
  6254     COMPUTE WS-ACCT-LF-PORT-CHG =
  6255        WS-ACCT-NEW-LF-PORT - WS-ACCT-ORIG-LF-PORT
  6256     MOVE WS-ACCT-LF-PORT-CHG TO OUT-ACCT-LF-PORT-CHG
  6257     COMPUTE WS-ACCT-ALT-LF-PORT-CHG =
  6258        WS-ACCT-NEW-ALT-LF-PORT - WS-ACCT-ORIG-ALT-LF-PORT
  6259     MOVE WS-ACCT-ALT-LF-PORT-CHG TO OUT-ACCT-ALT-LF-PORT-CHG
  6260     COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6261        WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6262     MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6263     COMPUTE WS-ACCT-AH-PORT-CHG =
  6264        WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6265     MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6266     COMPUTE WS-ACCT-PORTION-CHG =
  6267        WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6268     MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6269
  6270     COMPUTE WS-CSO-LF-PORT-CHG =
  6271        WS-CSO-NEW-LF-PORT - WS-CSO-ORIG-LF-PORT
  6272     MOVE WS-CSO-LF-PORT-CHG TO OUT-CSO-LF-PORT-CHG
  6273     COMPUTE WS-CSO-ALT-LF-PORT-CHG =
  6274        WS-CSO-NEW-ALT-LF-PORT - WS-CSO-ORIG-ALT-LF-PORT
  6275     MOVE WS-CSO-ALT-LF-PORT-CHG TO OUT-CSO-ALT-LF-PORT-CHG
  6276     COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6277        WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 110
* NSRASBL.cbl
  6278     MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6279     COMPUTE WS-CSO-AH-PORT-CHG =
  6280        WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6281     MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6282     COMPUTE WS-CSO-PORTION-CHG =
  6283        WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6284     MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6285
  6286     COMPUTE WS-WORK-PREM =
  6287         EN-LF-NEW-PRM-AMT - EN-LF-ORIG-PRM-AMT
  6288     MOVE WS-WORK-PREM           TO OUT-LF-PREM-CHG
  6289     COMPUTE WS-WORK-PREM =
  6290         EN-LF-NEW-ALT-PRM-AMT - EN-LF-ORIG-ALT-PRM-AMT
  6291     MOVE WS-WORK-PREM           TO OUT-LF-ALT-PREM-CHG
  6292     COMPUTE WS-WORK-PREM =
  6293        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT) -
  6294        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT)
  6295     MOVE WS-WORK-PREM           TO OUT-LF-CMB-PREM-CHG
  6296     COMPUTE WS-WORK-PREM =
  6297        (EN-AH-NEW-PRM-AMT - EN-AH-ORIG-PRM-AMT)
  6298     MOVE WS-WORK-PREM           TO OUT-AH-PREM-CHG
  6299
  6300     move en-sig-sw              to out-sig-sw
  6301     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  6302     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6303     GO TO 0620-CONTINUE
  6304     .
  6305 0620-PROCESS-CANCEL.
  6306     IF EN-LF-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6307        MOVE EN-LF-ORIG-REF-DT   TO DC-BIN-DATE-1
  6308        MOVE ' '                 TO DC-OPTION-CODE
  6309        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6310        IF NO-CONVERSION-ERROR
  6311           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6312              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6313                 INTO OUT-ORIG-LF-CAN-DT
  6314           END-STRING
  6315        END-IF
  6316        MOVE OUT-ORIG-LF-CAN-DT  TO OUT-ORIG-CAN-DT
  6317     END-IF
  6318
  6319     IF EN-LF-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6320        MOVE EN-LF-NEW-REF-DT    TO DC-BIN-DATE-1
  6321        MOVE ' '                 TO DC-OPTION-CODE
  6322        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6323        IF NO-CONVERSION-ERROR
  6324           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6325              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6326                 INTO OUT-NEW-LF-CAN-DT
  6327           END-STRING
  6328        END-IF
  6329        MOVE OUT-NEW-LF-CAN-DT   TO OUT-NEW-CAN-DT
  6330     END-IF
  6331
  6332     IF EN-AH-ORIG-REF-DT NOT = LOW-VALUES AND SPACES
  6333        MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  6334        MOVE ' '                    TO DC-OPTION-CODE
  6335        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 111
* NSRASBL.cbl
  6336        IF NO-CONVERSION-ERROR
  6337           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6338              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6339                 INTO OUT-ORIG-AH-CAN-DT
  6340           END-STRING
  6341        END-IF
  6342        IF EN-AH-ORIG-REF-DT > EN-LF-ORIG-REF-DT
  6343           MOVE OUT-ORIG-AH-CAN-DT  TO OUT-ORIG-CAN-DT
  6344        END-IF
  6345     END-IF
  6346
  6347     IF EN-AH-NEW-REF-DT NOT = LOW-VALUES AND SPACES
  6348        MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  6349        MOVE ' '                    TO DC-OPTION-CODE
  6350        PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6351        IF NO-CONVERSION-ERROR
  6352           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6353              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6354                 INTO OUT-NEW-AH-CAN-DT
  6355           END-STRING
  6356        END-IF
  6357        IF EN-AH-NEW-REF-DT > EN-LF-NEW-REF-DT
  6358           MOVE OUT-NEW-AH-CAN-DT  TO OUT-NEW-CAN-DT
  6359        END-IF
  6360     END-IF
  6361     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  6362     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  6363     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  6364     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  6365     COMPUTE WS-WORK-PREM =
  6366        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  6367     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  6368     COMPUTE WS-WORK-PREM =
  6369        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6370     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  6371     COMPUTE WS-WORK-PREM =
  6372        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6373        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6374     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  6375
  6376     COMPUTE WS-WORK-PREM =
  6377        (EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT)
  6378     MOVE WS-WORK-PREM           TO OUT-LF-REF-CHG
  6379     COMPUTE WS-WORK-PREM =
  6380        (EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT)
  6381     MOVE WS-WORK-PREM           TO OUT-AH-REF-CHG
  6382
  6383*     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  6384*     MOVE EN-ACCT-PORTION        TO OUT-ACCT-PORTION
  6385     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  6386
  6387     IF EN-COMM-CHGBK = 'N'
  6388         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6389                                   OUT-CSO-ORIG-ALT-LF-PORT
  6390         MOVE EN-LF-ORIG-REF-AMT TO OUT-CSO-ORIG-CMB-LF-PORT
  6391         MOVE EN-AH-ORIG-REF-AMT TO OUT-CSO-ORIG-AH-PORT
  6392         COMPUTE WS-CSO-ORIG-PORTION =
  6393             EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 112
* NSRASBL.cbl
  6394         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6395         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6396                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6397                                   OUT-ACCT-ORIG-CMB-LF-PORT
  6398                                   OUT-ACCT-ORIG-AH-PORT
  6399                                   OUT-ACCT-ORIG-PORTION
  6400
  6401         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6402                                   OUT-CSO-NEW-ALT-LF-PORT
  6403         MOVE EN-LF-NEW-REF-AMT TO OUT-CSO-NEW-CMB-LF-PORT
  6404         MOVE EN-AH-NEW-REF-AMT TO OUT-CSO-NEW-AH-PORT
  6405         COMPUTE WS-CSO-NEW-PORTION =
  6406             EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  6407         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6408         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6409                                   OUT-ACCT-NEW-ALT-LF-PORT
  6410                                   OUT-ACCT-NEW-CMB-LF-PORT
  6411                                   OUT-ACCT-NEW-AH-PORT
  6412                                   OUT-ACCT-NEW-PORTION
  6413
  6414         MOVE ZERO              TO OUT-CSO-LF-PORT-CHG
  6415                                   OUT-CSO-ALT-LF-PORT-CHG
  6416         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6417           EN-LF-NEW-REF-AMT - EN-LF-ORIG-REF-AMT
  6418         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6419         COMPUTE WS-CSO-AH-PORT-CHG =
  6420           EN-AH-NEW-REF-AMT - EN-AH-ORIG-REF-AMT
  6421         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6422         COMPUTE WS-CSO-PORTION-CHG =
  6423           (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  6424           (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  6425         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6426         MOVE ZERO              TO OUT-ACCT-LF-PORT-CHG
  6427                                   OUT-ACCT-ALT-LF-PORT-CHG
  6428                                   OUT-ACCT-CMB-LF-PORT-CHG
  6429                                   OUT-ACCT-AH-PORT-CHG
  6430                                   OUT-ACCT-PORTION-CHG
  6431     ELSE
  6432         MOVE ZERO              TO OUT-ACCT-ORIG-LF-PORT
  6433                                   OUT-ACCT-ORIG-ALT-LF-PORT
  6434         COMPUTE WS-ACCT-ORIG-CMB-LF-PORT =
  6435           (EN-LF-ORIG-REF-AMT * EN-LF-ORIG-REF-COMM-PCT)
  6436         MOVE WS-ACCT-ORIG-CMB-LF-PORT TO
  6437                                  OUT-ACCT-ORIG-CMB-LF-PORT
  6438         COMPUTE WS-ACCT-ORIG-AH-PORT =
  6439           (EN-AH-ORIG-REF-AMT * EN-AH-ORIG-REF-COMM-PCT)
  6440         MOVE WS-ACCT-ORIG-AH-PORT TO OUT-ACCT-ORIG-AH-PORT
  6441         COMPUTE WS-ACCT-ORIG-PORTION =
  6442            WS-ACCT-ORIG-CMB-LF-PORT + WS-ACCT-ORIG-AH-PORT
  6443         MOVE WS-ACCT-ORIG-PORTION TO OUT-ACCT-ORIG-PORTION
  6444
  6445         MOVE ZERO              TO OUT-CSO-ORIG-LF-PORT
  6446                                   OUT-CSO-ORIG-ALT-LF-PORT
  6447         COMPUTE WS-CSO-ORIG-CMB-LF-PORT =
  6448           (EN-LF-ORIG-REF-AMT - WS-ACCT-ORIG-CMB-LF-PORT)
  6449         MOVE WS-CSO-ORIG-CMB-LF-PORT TO OUT-CSO-ORIG-CMB-LF-PORT
  6450         COMPUTE WS-CSO-ORIG-AH-PORT =
  6451           (EN-AH-ORIG-REF-AMT - WS-ACCT-ORIG-AH-PORT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 113
* NSRASBL.cbl
  6452         MOVE WS-CSO-AH-PORTION  TO OUT-CSO-ORIG-AH-PORT
  6453         COMPUTE WS-CSO-ORIG-PORTION =
  6454            WS-CSO-ORIG-CMB-LF-PORT + WS-CSO-ORIG-AH-PORT
  6455         MOVE WS-CSO-ORIG-PORTION TO OUT-CSO-ORIG-PORTION
  6456
  6457         MOVE ZERO              TO OUT-ACCT-NEW-LF-PORT
  6458                                   OUT-ACCT-NEW-ALT-LF-PORT
  6459         COMPUTE WS-ACCT-NEW-CMB-LF-PORT =
  6460           (EN-LF-NEW-REF-AMT * EN-LF-NEW-REF-COMM-PCT)
  6461         MOVE WS-ACCT-NEW-CMB-LF-PORT TO OUT-ACCT-NEW-CMB-LF-PORT
  6462         COMPUTE WS-ACCT-NEW-AH-PORT =
  6463           (EN-AH-NEW-REF-AMT * EN-AH-NEW-REF-COMM-PCT)
  6464         MOVE WS-ACCT-NEW-AH-PORT TO OUT-ACCT-NEW-AH-PORT
  6465         COMPUTE WS-ACCT-NEW-PORTION =
  6466            WS-ACCT-NEW-CMB-LF-PORT + WS-ACCT-NEW-AH-PORT
  6467         MOVE WS-ACCT-NEW-PORTION TO OUT-ACCT-NEW-PORTION
  6468
  6469         MOVE ZERO              TO OUT-CSO-NEW-LF-PORT
  6470                                   OUT-CSO-NEW-ALT-LF-PORT
  6471         COMPUTE WS-CSO-NEW-CMB-LF-PORT =
  6472           (EN-LF-NEW-REF-AMT - WS-ACCT-NEW-CMB-LF-PORT)
  6473         MOVE WS-CSO-NEW-CMB-LF-PORT TO OUT-CSO-NEW-CMB-LF-PORT
  6474         COMPUTE WS-CSO-NEW-AH-PORT =
  6475           (EN-AH-NEW-REF-AMT - WS-ACCT-NEW-AH-PORT)
  6476         MOVE WS-CSO-NEW-AH-PORT TO OUT-CSO-NEW-AH-PORT
  6477         COMPUTE WS-CSO-NEW-PORTION =
  6478            WS-CSO-NEW-CMB-LF-PORT + WS-CSO-NEW-AH-PORT
  6479         MOVE WS-CSO-NEW-PORTION TO OUT-CSO-NEW-PORTION
  6480
  6481         MOVE ZERO               TO OUT-ACCT-LF-PORT-CHG
  6482                                    OUT-ACCT-ALT-LF-PORT-CHG
  6483         COMPUTE WS-ACCT-CMB-LF-PORT-CHG =
  6484            WS-ACCT-NEW-CMB-LF-PORT - WS-ACCT-ORIG-CMB-LF-PORT
  6485         MOVE WS-ACCT-CMB-LF-PORT-CHG TO OUT-ACCT-CMB-LF-PORT-CHG
  6486         COMPUTE WS-ACCT-AH-PORT-CHG =
  6487            WS-ACCT-NEW-AH-PORT - WS-ACCT-ORIG-AH-PORT
  6488         MOVE WS-ACCT-AH-PORT-CHG TO OUT-ACCT-AH-PORT-CHG
  6489         COMPUTE WS-ACCT-PORTION-CHG =
  6490            WS-ACCT-NEW-PORTION - WS-ACCT-ORIG-PORTION
  6491         MOVE WS-ACCT-PORTION-CHG TO OUT-ACCT-PORTION-CHG
  6492
  6493         MOVE ZERO               TO OUT-CSO-LF-PORT-CHG
  6494                                    OUT-CSO-ALT-LF-PORT-CHG
  6495         COMPUTE WS-CSO-CMB-LF-PORT-CHG =
  6496            WS-CSO-NEW-CMB-LF-PORT - WS-CSO-ORIG-CMB-LF-PORT
  6497         MOVE WS-CSO-CMB-LF-PORT-CHG TO OUT-CSO-CMB-LF-PORT-CHG
  6498         COMPUTE WS-CSO-AH-PORT-CHG =
  6499            WS-CSO-NEW-AH-PORT - WS-CSO-ORIG-AH-PORT
  6500         MOVE WS-CSO-AH-PORT-CHG TO OUT-CSO-AH-PORT-CHG
  6501         COMPUTE WS-CSO-PORTION-CHG =
  6502            WS-CSO-NEW-PORTION - WS-CSO-ORIG-PORTION
  6503         MOVE WS-CSO-PORTION-CHG TO OUT-CSO-PORTION-CHG
  6504
  6505     END-IF
  6506     .
  6507 0620-CONTINUE.
  6508     display ' about to bld reason codes ' en-reason-code (1)
  6509     move en-reason-code (1)     to out-rea-cd1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 114
* NSRASBL.cbl
  6510     move en-reason-code (2)     to out-rea-cd2
  6511     move en-reason-code (3)     to out-rea-cd3
  6512     move en-reason-code (4)     to out-rea-cd4
  6513     move en-reason-code (5)     to out-rea-cd5
  6514     move en-reason-code (6)     to out-rea-cd6
  6515     move en-reason-code (7)     to out-rea-cd7
  6516     move en-reason-code (8)     to out-rea-cd8
  6517     move en-reason-code (9)     to out-rea-cd9
  6518     move en-reason-code (10)    to out-rea-cd10
  6519     move en-reason-code (11)    to out-rea-cd11
  6520     move en-reason-code (12)    to out-rea-cd12
  6521*    PERFORM 1300-DETERMINE-COMM
  6522*                                THRU 1300-EXIT
  6523     .
  6524 0620-EXIT.
  6525     EXIT.
  6526 0650-PROCESS-NO-Change.
  6527     IF EN-REC-TYPE = 'C'
  6528        GO TO 0650-PROCESS-CANCEL
  6529     END-IF
  6530     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
  6531        AND (OUT-NEW-ILNAME NOT = SPACES))
  6532                      AND
  6533        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  6534        AND (OUT-NEW-IFNAME NOT = SPACES))
  6535                      AND
  6536        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  6537        AND (OUT-NEW-IFNAME NOT = SPACES))
  6538        move 'No Change'         to out-new-Ifname
  6539        MOVE SPACES              TO OUT-NEW-IMINIT
  6540        move spaces              to out-new-Ilname
  6541     ELSE
  6542         IF OUT-NEW-ILNAME = SPACES
  6543           AND OUT-NEW-IFNAME = SPACES
  6544           AND OUT-NEW-IMINIT = SPACES
  6545           AND OUT-ORIG-ILNAME NOT = SPACES
  6546            MOVE 'None'          TO OUT-NEW-IFNAME
  6547            MOVE SPACES          TO OUT-NEW-IMINIT
  6548            MOVE SPACES          TO OUT-NEW-ILNAME
  6549         END-IF
  6550     END-IF
  6551     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  6552        AND (OUT-NEW-JLNAME NOT = SPACES))
  6553                    AND
  6554        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  6555        AND (OUT-NEW-JFNAME NOT = SPACES))
  6556                    AND
  6557        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  6558        AND (OUT-NEW-JFNAME NOT = SPACES))
  6559        MOVE 'No Change'         TO OUT-NEW-JFNAME
  6560        MOVE SPACES              TO OUT-NEW-JMINIT
  6561        MOVE SPACES              TO OUT-NEW-JLNAME
  6562     ELSE
  6563         IF OUT-NEW-JLNAME = SPACES
  6564           AND OUT-NEW-JFNAME = SPACES
  6565           AND OUT-NEW-JMINIT = SPACES
  6566           AND OUT-ORIG-JLNAME NOT = SPACES
  6567            MOVE 'None'          TO OUT-NEW-JFNAME
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 115
* NSRASBL.cbl
  6568            MOVE SPACES          TO OUT-NEW-JMINIT
  6569            MOVE SPACES          TO OUT-NEW-JLNAME
  6570         END-IF
  6571     END-IF
  6572     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  6573        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6574        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  6575     ELSE
  6576         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6577           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6578             MOVE ZEROS          TO OUT-NEW-LF-BEN
  6579         END-IF
  6580     END-IF
  6581     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  6582        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6583        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  6584     ELSE
  6585         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6586           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6587             MOVE ZEROS          TO OUT-NEW-LF-PRM
  6588         END-IF
  6589     END-IF
  6590     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  6591        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6592        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  6593     ELSE
  6594         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6595           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6596             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  6597         END-IF
  6598     END-IF
  6599     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  6600        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6601        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  6602     ELSE
  6603         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6604           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6605             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  6606         END-IF
  6607     END-IF
  6608
  6609     COMPUTE WS-WRK-AMOUNT = EN-LF-ORIG-PRM-AMT +
  6610                              EN-LF-ORIG-ALT-PRM-AMT
  6611     COMPUTE WS-WRK-AMOUNT2 = EN-LF-NEW-PRM-AMT +
  6612                               EN-LF-NEW-ALT-PRM-AMT
  6613     IF (WS-WRK-AMOUNT2 = WS-WRK-AMOUNT)
  6614        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6615        MOVE 'No Change'         TO OUT-NEW-LF-CMB-PREM-A
  6616     ELSE
  6617         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6618           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6619            MOVE ZEROS          TO OUT-NEW-LF-CMB-PREM
  6620         END-IF
  6621     END-IF
  6622     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  6623        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  6624     END-IF
  6625     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 116
* NSRASBL.cbl
  6626        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  6627        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  6628     END-IF
  6629     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  6630        AND (OUT-NEW-LF-DESC NOT = SPACES)
  6631        MOVE 'No Change'         to OUT-NEW-LF-DESC
  6632     ELSE
  6633        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6634          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6635            MOVE 'None'          TO OUT-NEW-LF-DESC
  6636        END-IF
  6637     end-if
  6638     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  6639       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  6640        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  6641     END-IF
  6642     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  6643        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  6644        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  6645     ELSE
  6646         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6647           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6648             MOVE ZEROS          TO OUT-NEW-AH-BEN
  6649         END-IF
  6650     END-IF
  6651     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  6652        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  6653        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  6654     ELSE
  6655         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6656           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6657             MOVE ZEROS          TO OUT-NEW-AH-PRM
  6658         END-IF
  6659     END-IF
  6660     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
  6661        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  6662        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  6663     ELSE
  6664         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6665           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6666             MOVE 'None'         TO OUT-NEW-AH-DESC
  6667         END-IF
  6668     END-IF
  6669     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  6670       AND EN-INS-NEW-AGE-DEF-FLAG = EN-INS-ORIG-AGE-DEF-FLAG
  6671       AND EN-INS-NEW-AGE-DEF-FLAG <> 'Y'
  6672       AND EN-INS-NEW-LAST-NAME = EN-INS-ORIG-LAST-NAME
  6673       AND EN-INS-NEW-FIRST-NAME = EN-INS-ORIG-FIRST-NAME
  6674       AND EN-INS-NEW-MIDDLE-INIT = EN-INS-ORIG-MIDDLE-INIT
  6675        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  6676     END-IF
  6677     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  6678        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  6679        AND EN-JNT-NEW-AGE-DEF-FLAG = EN-JNT-ORIG-AGE-DEF-FLAG
  6680        AND EN-JNT-NEW-AGE-DEF-FLAG <> 'Y'
  6681        AND EN-JNT-NEW-LAST-NAME = EN-JNT-ORIG-LAST-NAME
  6682        AND EN-JNT-NEW-FIRST-NAME = EN-JNT-ORIG-FIRST-NAME
  6683        AND EN-JNT-NEW-MIDDLE-INIT = EN-JNT-ORIG-MIDDLE-INIT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 117
* NSRASBL.cbl
  6684        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  6685     ELSE
  6686         IF (EN-JNT-ORIG-AGE > ZEROS)
  6687           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  6688             MOVE 'None'         TO OUT-NEW-JAGE-A
  6689         END-IF
  6690     END-IF
  6691     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  6692        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  6693        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  6694     ELSE
  6695         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  6696           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  6697             MOVE ZEROS          TO OUT-NEW-LF-TERM
  6698         END-IF
  6699     END-IF
  6700     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  6701        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  6702        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  6703     ELSE
  6704         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6705           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6706             MOVE ZEROS          TO OUT-NEW-AH-TERM
  6707         END-IF
  6708     END-IF
  6709     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  6710        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  6711        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  6712                                    OUT-NEW-MAX-PMTS-A
  6713     ELSE
  6714         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6715           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6716             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  6717                                    OUT-NEW-MAX-PMTS-A
  6718         END-IF
  6719     END-IF
  6720     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  6721        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  6722     END-IF
  6723     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  6724       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  6725         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  6726     ELSE
  6727         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  6728           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  6729             MOVE 'None'         TO OUT-NEW-WAIT-PER
  6730         END-IF
  6731     END-IF
  6732     .
  6733 0650-PROCESS-CANCEL.
  6734     .
  6735 0650-EXIT.
  6736     EXIT.
  6737 0700-WRITE-EXTR.
  6738     display ' made it to 0700 '
  6739     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  6740     IF BL-FAIL
  6741        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 118
* NSRASBL.cbl
  6742        GO TO 0700-EXIT
  6743     END-IF
  6744     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6745     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6746     MOVE +0                     TO NSAS-SEQ-NO
  6747     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6748     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6749     IF BL-FAIL
  6750        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6751        GO TO 0700-EXIT
  6752     END-IF
  6753     IF W-LETTER-TO-ACCT NOT = SPACES
  6754        display ' acct ne spaces ' bl-archive-no
  6755        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6756        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6757        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6758        MOVE +1                  TO NSAS-SEQ-NO
  6759        PERFORM 0720-WRITE-NSASEXTR
  6760                                 THRU 0720-EXIT
  6761        IF BL-FAIL
  6762           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6763           GO TO 0700-EXIT
  6764        END-IF
  6765     END-IF
  6766     IF W-LETTER-TO-BENE NOT = SPACES
  6767        display ' bene ne spaces ' bl-archive-no
  6768        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6769        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6770        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6771        MOVE +2                  TO NSAS-SEQ-NO
  6772        PERFORM 0720-WRITE-NSASEXTR
  6773                                 THRU 0720-EXIT
  6774        IF BL-FAIL
  6775           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6776        END-IF
  6777     END-IF
  6778     IF W-PRINT-CERTIFICATE = 'Y' AND
  6779        BL-STATE = 'VA'
  6780           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6781           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6782           MOVE BL-CARRIER          TO VD-CARRIER
  6783           MOVE BL-GROUP            TO VD-GROUPING
  6784           MOVE BL-STATE            TO VD-STATE
  6785           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6786           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
  6787           MOVE BL-CERT-NO          TO VD-CERT-NO
  6788           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6789           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6790           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6791           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6792           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6793           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6794           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6795           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6796           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6797           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6798           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6799           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 119
* NSRASBL.cbl
  6800           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6801           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6802           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6803           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6804           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6805           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6806           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6807           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6808           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6809           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6810           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6811           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6812           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6813           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6814           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6815           MOVE 'VADS'              TO VD-LETTER-ID
  6816           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6817           MOVE BL-COMP-ID          TO VD-COMP-ID
  6818           MOVE EIBTIME             TO VD-CURRENT-TIME
  6819           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6820           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6821           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6822
  6823* EXEC CICS LINK
  6824*              PROGRAM    (LINK-ELVADS)
  6825*              COMMAREA   (WS-PASS-AREA)
  6826*              LENGTH     (WS-PASS-AREA-LENGTH)
  6827*          END-EXEC
  6828*    MOVE '."C                   (   #00006767' TO DFHEIV0
  6829     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6831     MOVE X'2020233030303036373637' TO DFHEIV0(25:11)
  6832     CALL 'kxdfhei1' USING DFHEIV0,
  6833           LINK-ELVADS,
  6834           WS-PASS-AREA,
  6835           WS-PASS-AREA-LENGTH,
  6836           DFHEIV99,
  6837           DFHEIV99,
  6838           DFHEIV99,
  6839           DFHEIV99
  6840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6841     END-IF
  6842     .
  6843 0700-EXIT.
  6844     EXIT.
  6845  0710-BUILD-NSASEXTR.
  6846***  i added the extra space in front of the 1st ~
  6847***  only because there may be a letter to acct or bene
  6848     STRING
  6849         OUT-LETTER             ' ~'
  6850         OUT-PROC-ID            '~'
  6851         OUT-PROC-NAME          '~'
  6852         OUT-PROC-TITLE         '~'
  6853         OUT-CSR-NAME           '~'
  6854         OUT-CSR-TITLE          '~'
  6855         OUT-CARRIER            '~'
  6856         OUT-GROUPING           '~'
  6857         OUT-STATE              '~'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 120
* NSRASBL.cbl
  6858         OUT-ACCOUNT            '~'
  6859         OUT-CERT-EFF-DT        '~'
  6860         OUT-CERT-NO            '~'
  6861         OUT-CERT-SFX           '~'
  6862         OUT-ILNAME             '~'
  6863         OUT-IFNAME             '~'
  6864         OUT-IFINIT             '~'
  6865         OUT-IMINIT             '~'
  6866         OUT-IAGE               '~'
  6867         OUT-ISEX               '~'
  6868         OUT-INS-ADDR1          '~'
  6869         OUT-INS-ADDR2          '~'
  6870         OUT-INS-CITY           '~'
  6871         OUT-INS-STATE          '~'
  6872         OUT-INS-ZIP            '~'
  6873         OUT-SOC-SEC-NO         '~'
  6874         OUT-MEMBER-NO          '~'
  6875         OUT-JLNAME             '~'
  6876         OUT-JFNAME             '~'
  6877         OUT-JMINIT             '~'
  6878         OUT-JAGE               '~'
  6879         OUT-ACCT-NAME          '~'
  6880         OUT-ACCT-ADDR1         '~'
  6881         OUT-ACCT-ADDR2         '~'
  6882         OUT-ACCT-CITY          '~'
  6883         OUT-ACCT-STATE         '~'
  6884         OUT-ACCT-ZIP           '~'
  6885         OUT-ACCT-PHONE         '~'
  6886         OUT-ACCT-CNTRL-NAME    '~'
  6887         OUT-ACCT-BUS-TYPE      '~'
  6888         OUT-BENE-NAME          '~'
  6889         OUT-BENE-ADDR1         '~'
  6890         OUT-BENE-ADDR2         '~'
  6891         OUT-BENE-CITY          '~'
  6892         OUT-BENE-STATE         '~'
  6893         OUT-BENE-ZIP           '~'
  6894         OUT-CARR-NAME          '~'
  6895         OUT-RESP-NO            '~'
  6896         OUT-COMP-NAME          '~'
  6897         OUT-COMP-MAIL-TO       '~'
  6898         OUT-COMP-ADDR1         '~'
  6899         OUT-COMP-ADDR2         '~'
  6900         OUT-COMP-CITY          '~'
  6901         OUT-COMP-STATE         '~'
  6902         OUT-COMP-ZIP           '~'
  6903         OUT-COMP-PHONE         '~'
  6904         OUT-COMP-FAX           '~'
  6905         OUT-COMP-STATUS        '~'
  6906         OUT-BILL-SW            '~'
  6907         OUT-RPT-CD1            '~'
  6908         OUT-RPT-CD2            '~'
  6909         OUT-ENTRY-DT           '~'
  6910         OUT-ENTRY-BATCH        '~'
  6911         OUT-ENTRY-STATUS       '~'
  6912         OUT-1ST-PMT-DT         '~'
  6913         OUT-LOAN-APR           '~'
  6914         OUT-LOAN-TERM          '~'
  6915         OUT-RATE-CLASS         '~'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 121
* NSRASBL.cbl
  6916         OUT-EXT-DAYS           '~'
  6917         OUT-CSR-CODE           '~'
  6918         OUT-UCODE              '~'
  6919         OUT-PREM-TYPE          '~'
  6920         OUT-IND-GRP            '~'
  6921         OUT-SKIP-CD            '~'
  6922         OUT-PMT-MODE           '~'
  6923         OUT-LOAN-OFF           '~'
  6924         OUT-REIN-TABLE         '~'
  6925         OUT-SPEC-REIN          '~'
  6926         OUT-LF-BENCD           '~'
  6927         OUT-LF-TERM            '~'
  6928         OUT-LF-DEV-CD          '~'
  6929         OUT-LF-DEV-PCT         '~'
  6930         OUT-LF-BEN             '~'
  6931         OUT-LF-PRM             '~'
  6932         OUT-LF-ALT-BEN         '~'
  6933         OUT-LF-ALT-PRM         '~'
  6934         OUT-LF-NSP             '~'
  6935         OUT-LF-REM-BEN         '~'
  6936         OUT-LF-REF             '~'
  6937         OUT-LF-DTH             '~'
  6938         OUT-LF-RATE            '~'
  6939         OUT-LF-ALT-RATE        '~'
  6940         OUT-LF-EXP-DT          '~'
  6941         OUT-LF-CUR-STATUS      '~'
  6942         OUT-LF-CAN-DT          '~'
  6943         OUT-LF-CAN-EXIT-DT     '~'
  6944         OUT-LF-DTH-DT          '~'
  6945         OUT-LF-DTH-EXIT-DT     '~'
  6946         OUT-LF-EXIT-BATCH      '~'
  6947         OUT-LF-COMM-PCT        '~'
  6948         OUT-LF-DESC            '~'
  6949         OUT-LF-ABBRV           '~'
  6950         OUT-AH-BENCD           '~'
  6951         OUT-AH-TERM            '~'
  6952         OUT-CRIT-PER           '~'
  6953         OUT-AH-DEV-CD          '~'
  6954         OUT-AH-DEV-PCT         '~'
  6955         OUT-AH-BEN             '~'
  6956         OUT-AH-PRM             '~'
  6957         OUT-AH-NSP             '~'
  6958         OUT-AH-REF             '~'
  6959         OUT-AH-CLM             '~'
  6960         OUT-AH-TOT-BEN         '~'
  6961         OUT-AH-PDTHRU-DT       '~'
  6962         OUT-AH-RATE            '~'
  6963         OUT-AH-EXP-DT          '~'
  6964         OUT-AH-CUR-STATUS      '~'
  6965         OUT-AH-CAN-DT          '~'
  6966         OUT-AH-CAN-EXIT-DT     '~'
  6967         OUT-AH-EXIT-BATCH      '~'
  6968         OUT-AH-COMM-PCT        '~'
  6969         OUT-AH-DESC            '~'
  6970         OUT-RET-ELIM           '~'
  6971         OUT-BEN-DAYS           '~'
  6972         OUT-WAIT-PER           '~'
  6973         OUT-MAX-PMTS           '~'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 122
* NSRASBL.cbl
  6974         OUT-TOT-PRM            '~'
  6975         OUT-TOT-REF            '~'
  6976         OUT-SCHED-EXP-DT       '~'
  6977         OUT-SCHED-TERM         '~'
  6978         OUT-ORIG-ILNAME        '~'
  6979         OUT-ORIG-IFNAME        '~'
  6980         OUT-ORIG-MINIT         '~'
  6981         OUT-ORIG-IAGE          '~'
  6982         OUT-ORIG-JLNAME        '~'
  6983         OUT-ORIG-JFNAME        '~'
  6984         OUT-ORIG-JMINIT        '~'
  6985         OUT-ORIG-JAGE          '~'
  6986         OUT-ORIG-LF-BENCD      '~'
  6987         OUT-ORIG-LF-TERM       '~'
  6988         OUT-ORIG-LF-BEN        '~'
  6989         OUT-ORIG-LF-PRM        '~'
  6990         OUT-LF-CALC-PRM        '~'
  6991         OUT-ORIG-LF-REF        '~'
  6992         OUT-LF-CALC-REF        '~'
  6993         OUT-ORIG-LF-ALT-BEN    '~'
  6994         OUT-ORIG-LF-ALT-PRM    '~'
  6995         OUT-ORIG-LF-EXP-DT     '~'
  6996         OUT-ORIG-LF-DESC       '~'
  6997         OUT-ORIG-AH-BENCD      '~'
  6998         OUT-ORIG-AH-TERM       '~'
  6999         OUT-ORIG-CRIT-PER      '~'
  7000         OUT-ORIG-AH-BEN        '~'
  7001         OUT-ORIG-AH-PRM        '~'
  7002         OUT-AH-CALC-PRM        '~'
  7003         OUT-ORIG-AH-REF        '~'
  7004         OUT-AH-CALC-REF        '~'
  7005         OUT-ORIG-AH-EXP-DT     '~'
  7006         OUT-ORIG-AH-DESC       '~'
  7007         OUT-ORIG-RET-ELIM      '~'
  7008         OUT-ORIG-BEN-DAYS      '~'
  7009         OUT-ORIG-WAIT-PER      '~'
  7010         OUT-ORIG-MAX-PMTS      '~'
  7011         OUT-ORIG-SCHED-EXP-DT  '~'
  7012         OUT-ORIG-SCHED-TERM    '~'
  7013         OUT-NEW-ILNAME         '~'
  7014         OUT-NEW-IFNAME         '~'
  7015         OUT-NEW-IMINIT         '~'
  7016         OUT-NEW-IAGE           '~'
  7017         OUT-NEW-JLNAME         '~'
  7018         OUT-NEW-JFNAME         '~'
  7019         OUT-NEW-JMINIT         '~'
  7020         OUT-NEW-JAGE           '~'
  7021         OUT-NEW-LF-BENCD       '~'
  7022         OUT-NEW-LF-TERM        '~'
  7023         OUT-NEW-LF-BEN         '~'
  7024         OUT-NEW-LF-PRM         '~'
  7025         OUT-NEW-LF-REF         '~'
  7026         OUT-NEW-LF-ALT-BEN     '~'
  7027         OUT-NEW-LF-ALT-PRM     '~'
  7028         OUT-NEW-LF-EXP-DT      '~'
  7029         OUT-NEW-LF-DESC        '~'
  7030         OUT-NEW-AH-BENCD       '~'
  7031         OUT-NEW-AH-TERM        '~'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 123
* NSRASBL.cbl
  7032         OUT-NEW-CRIT-PER       '~'
  7033         OUT-NEW-AH-BEN         '~'
  7034         OUT-NEW-AH-PRM         '~'
  7035         OUT-NEW-AH-REF         '~'
  7036         OUT-NEW-AH-EXP-DT      '~'
  7037         OUT-NEW-AH-DESC        '~'
  7038         OUT-NEW-RET-ELIM       '~'
  7039         OUT-NEW-BEN-DAYS       '~'
  7040         OUT-NEW-WAIT-PER       '~'
  7041         OUT-NEW-MAX-PMTS       '~'
  7042         OUT-NEW-SCHED-EXP-DT   '~'
  7043         OUT-NEW-SCHED-TERM     '~'
  7044         OUT-TOT-PRM-CHG        '~'
  7045         OUT-TOT-REF-CHG        '~'
  7046         OUT-PAYEE              '~'
  7047         OUT-SIG-SW             '~'
  7048         OUT-BALLOON-IND        '~'
  7049         OUT-LEASE-IND          '~'
  7050         OUT-RESCIND            '~'
  7051         OUT-REA-CD1            '~'
  7052         OUT-REA-CD2            '~'
  7053         OUT-REA-CD3            '~'
  7054         OUT-REA-CD4            '~'
  7055         OUT-REA-CD5            '~'
  7056         OUT-REA-CD6            '~'
  7057         OUT-REA-CD7            '~'
  7058         OUT-REA-CD8            '~'
  7059         OUT-REA-CD9            '~'
  7060         OUT-REA-CD10           '~'
  7061         OUT-REA-CD11           '~'
  7062         OUT-REA-CD12           '~'
  7063         OUT-CYCLE-DT           '~'
  7064         OUT-ARCH-NO            '~'
  7065         OUT-FORM               '~'
  7066         OUT-ENC-LINE           '~'
  7067         OUT-ATTACH             '~'
  7068         OUT-STACK              '~'
  7069         OUT-STATE-NAME         '~'
  7070         OUT-PRINT-NOW          '~'
  7071         OUT-CHGBACK            '~'
  7072         OUT-CSO-PORTION        '~'
  7073         OUT-ACCT-PORTION       '~'
  7074         OUT-LETTER-TYPE        '~'
  7075         OUT-PRINT-CERTIFICATE  '~'
  7076         OUT-INS-BIRTHDATE      '~'
  7077         OUT-JNT-BIRTHDATE      '~'
  7078         OUT-TOT-INTEREST       '~'
  7079         OUT-ORIG-TOT-PREM      '~'
  7080         OUT-ORIG-TOT-REF       '~'
  7081         OUT-CANCEL-DT          '~'
  7082         OUT-HEALTH-APP         '~'
  7083         OUT-CERTIFICATE-ID     '~'
  7084         OUT-UNDW-ID            '~'
  7085         OUT-NEW-TOT-PREM       '~'
  7086         OUT-NEW-TOT-REF        '~'
  7087         OUT-COVERAGE-IND       '~'
  7088         OUT-ORIG-COVERAGE-IND  '~'
  7089         OUT-NEW-COVERAGE-IND   '~'
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 124
* NSRASBL.cbl
  7090         OUT-LF-CMB-PREM        '~'
  7091         OUT-ORIG-LF-CMB-PREM   '~'
  7092         OUT-NEW-LF-CMB-PREM    '~'
  7093         OUT-LF-PREM-CHG        '~'
  7094         OUT-LF-ALT-PREM-CHG    '~'
  7095         OUT-LF-CMB-PREM-CHG    '~'
  7096         OUT-AH-PREM-CHG        '~'
  7097         OUT-LF-REF-CHG         '~'
  7098         OUT-AH-REF-CHG         '~'
  7099         OUT-ACCT-LF-PORTION    '~'
  7100         OUT-ACCT-ALT-LF-PORT   '~'
  7101         OUT-ACCT-CMB-LF-PORT   '~'
  7102         OUT-ACCT-AH-PORTION    '~'
  7103         OUT-CSO-LF-PORTION     '~'
  7104         OUT-CSO-ALT-LF-PORT    '~'
  7105         OUT-CSO-CMB-LF-PORT    '~'
  7106         OUT-CSO-AH-PORTION     '~'
  7107         OUT-ACCT-ORIG-LF-PORT  '~'
  7108         OUT-ACCT-ORIG-ALT-LF-PORT '~'
  7109         OUT-ACCT-ORIG-CMB-LF-PORT '~'
  7110         OUT-ACCT-ORIG-AH-PORT  '~'
  7111         OUT-ACCT-ORIG-PORTION  '~'
  7112         OUT-CSO-ORIG-LF-PORT   '~'
  7113         OUT-CSO-ORIG-ALT-LF-PORT '~'
  7114         OUT-CSO-ORIG-CMB-LF-PORT '~'
  7115         OUT-CSO-ORIG-AH-PORT   '~'
  7116         OUT-CSO-ORIG-PORTION   '~'
  7117         OUT-ACCT-NEW-LF-PORT   '~'
  7118         OUT-ACCT-NEW-ALT-LF-PORT '~'
  7119         OUT-ACCT-NEW-CMB-LF-PORT '~'
  7120         OUT-ACCT-NEW-AH-PORT   '~'
  7121         OUT-ACCT-NEW-PORTION   '~'
  7122         OUT-CSO-NEW-LF-PORT    '~'
  7123         OUT-CSO-NEW-ALT-LF-PORT '~'
  7124         OUT-CSO-NEW-CMB-LF-PORT '~'
  7125         OUT-CSO-NEW-AH-PORT    '~'
  7126         OUT-CSO-NEW-PORTION    '~'
  7127         OUT-ACCT-LF-PORT-CHG   '~'
  7128         OUT-ACCT-ALT-LF-PORT-CHG '~'
  7129         OUT-ACCT-CMB-LF-PORT-CHG '~'
  7130         OUT-ACCT-AH-PORT-CHG   '~'
  7131         OUT-ACCT-PORTION-CHG   '~'
  7132         OUT-CSO-LF-PORT-CHG    '~'
  7133         OUT-CSO-ALT-LF-PORT-CHG '~'
  7134         OUT-CSO-CMB-LF-PORT-CHG '~'
  7135         OUT-CSO-AH-PORT-CHG    '~'
  7136         OUT-CSO-PORTION-CHG    '~'
  7137         OUT-ORIG-LF-CAN-DT     '~'
  7138         OUT-NEW-LF-CAN-DT      '~'
  7139         OUT-ORIG-AH-CAN-DT     '~'
  7140         OUT-NEW-AH-CAN-DT      '~'
  7141         OUT-ORIG-CAN-DT        '~'
  7142         OUT-NEW-CAN-DT         '~'
  7143         OUT-SCREEN-ID          '~'
  7144         OUT-NEXT-BUS-DT        '~'
  7145            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  7146     END-STRING
  7147     .
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 125
* NSRASBL.cbl
  7148 0710-exit.
  7149     EXIT.
  7150 0720-WRITE-NSASEXTR.
  7151
  7152* EXEC CICS WRITE
  7153*       DATASET    ('NSASEXTR')
  7154*       FROM       (NSAS-EXTRACT-RECORD)
  7155*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  7156*       RESP       (WS-RESPONSE)
  7157*    END-EXEC
  7158     MOVE LENGTH OF
  7159      NSAS-EXTRACT-RECORD
  7160       TO DFHEIV11
  7161     MOVE 'NSASEXTR' TO DFHEIV1
  7162*    MOVE '&$ L                  ''  N#00007082' TO DFHEIV0
  7163     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7164     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7165     MOVE X'204E233030303037303832' TO DFHEIV0(25:11)
  7166     CALL 'kxdfhei1' USING DFHEIV0,
  7167           DFHEIV1,
  7168           NSAS-EXTRACT-RECORD,
  7169           DFHEIV11,
  7170           NSAS-CONTROL-PRIMARY,
  7171           DFHEIV99,
  7172           DFHEIV99
  7173     MOVE EIBRESP  TO WS-RESPONSE
  7174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7175     IF NOT RESP-NORMAL
  7176        display ' bad write nsasextr ' ws-response
  7177        SET BL-FAIL TO TRUE
  7178     END-IF
  7179     .
  7180 0720-EXIT.
  7181     EXIT.
  7182 0800-init-out-data.
  7183     MOVE ZEROS                  TO OUT-IAGE
  7184                                    OUT-JAGE
  7185                                    OUT-LOAN-APR
  7186                                    OUT-LOAN-TERM
  7187                                    OUT-EXT-DAYS
  7188                                    OUT-LF-TERM
  7189                                    OUT-AH-TERM
  7190                                    OUT-LF-DEV-PCT
  7191                                    OUT-AH-DEV-PCT
  7192                                    OUT-LF-BEN
  7193                                    OUT-AH-BEN
  7194                                    OUT-CRIT-PER
  7195                                    OUT-MAX-PMTS
  7196                                    OUT-SCHED-TERM
  7197                                    OUT-ORIG-IAGE
  7198                                    OUT-ORIG-JAGE
  7199                                    OUT-NEW-IAGE
  7200                                    OUT-NEW-JAGE
  7201                                    OUT-ORIG-LF-TERM
  7202                                    OUT-ORIG-AH-TERM
  7203                                    OUT-NEW-LF-TERM
  7204                                    OUT-NEW-AH-TERM
  7205                                    OUT-ORIG-CRIT-PER
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 126
* NSRASBL.cbl
  7206                                    OUT-ORIG-MAX-PMTS
  7207                                    OUT-ORIG-SCHED-TERM
  7208                                    OUT-NEW-SCHED-TERM
  7209                                    OUT-NEW-CRIT-PER
  7210                                    OUT-NEW-MAX-PMTS
  7211                                    OUT-CSO-PORTION
  7212                                    OUT-CSO-LF-PORTION
  7213                                    OUT-CSO-ALT-LF-PORT
  7214                                    OUT-CSO-CMB-LF-PORT
  7215                                    OUT-CSO-AH-PORTION
  7216                                    OUT-ACCT-PORTION
  7217                                    OUT-ACCT-LF-PORTION
  7218                                    OUT-ACCT-ALT-LF-PORT
  7219                                    OUT-ACCT-CMB-LF-PORT
  7220                                    OUT-ACCT-AH-PORTION
  7221                                    OUT-LF-PREM-CHG
  7222                                    OUT-LF-ALT-PREM-CHG
  7223                                    OUT-LF-CMB-PREM-CHG
  7224                                    OUT-AH-PREM-CHG
  7225                                    OUT-LF-REF-CHG
  7226                                    OUT-AH-REF-CHG
  7227     .
  7228 0800-exit.
  7229     exit.
  7230 1000-BUILD-ERARCH.
  7231* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7232*    1) FROM ACCT MAINT
  7233*    2) FROM CERT UPDATE
  7234*    3) FROM COMP MAINT
  7235*    4) FROM REVIEW AND CORRECTIONS
  7236******************************************************************
  7237     MOVE 'LA'                   TO LETTER-ARCHIVE
  7238     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  7239                                    LA-ARCHIVE-NO-A2
  7240                                    LA-ARCHIVE-NO-A3
  7241                                    LA-ARCHIVE-NO-A4
  7242                                    LA-ARCHIVE-NO-A5
  7243                                    LA-ARCHIVE-NO-A6
  7244     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  7245                                    LA-COMPANY-CD-A2
  7246                                    LA-COMPANY-CD-A3
  7247                                    LA-COMPANY-CD-A4
  7248                                    LA-COMPANY-CD-A5
  7249                                    LA-COMPANY-CD-A6
  7250     MOVE BL-CARRIER             TO LA-CARRIER-A2
  7251                                    LA-CARRIER-A3
  7252                                    LA-CARRIER-A4
  7253                                    LA-CARRIER-A5
  7254     MOVE BL-GROUP               TO LA-GROUPING-A2
  7255                                    LA-GROUPING-A3
  7256                                    LA-GROUPING-A4
  7257                                    LA-GROUPING-A5
  7258     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  7259                                    LA-ACCOUNT-A3
  7260                                    LA-ACCOUNT-A4
  7261                                    LA-ACCOUNT-A5
  7262     MOVE BL-STATE               TO LA-STATE-A2
  7263                                    LA-STATE-A3
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 127
* NSRASBL.cbl
  7264                                    LA-STATE-A4
  7265                                    LA-STATE-A5
  7266     IF BL-DATA-SRCE = '2' OR '4'
  7267        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  7268        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  7269     ELSE
  7270        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  7271     END-IF
  7272     IF BL-DATA-SRCE = '4'
  7273        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  7274     END-IF
  7275     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  7276                                    LA-LAST-UPDATED-BY
  7277     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7278                                    LA-INITIAL-PRINT-DATE
  7279                                    LA-SENT-DATE
  7280                                    LA-REPLY-DATE
  7281                                    LA-RESEND-DATE
  7282                                    LA-FOLLOW-UP-DATE
  7283     MOVE 'A'                    TO LA-STATUS
  7284     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7285     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  7286     IF W-DAYS-TO-RESEND NOT NUMERIC
  7287        MOVE ZEROS               TO W-DAYS-TO-RESEND
  7288     END-IF
  7289     IF W-DAYS-TO-RESEND > ZEROS
  7290        MOVE SAVE-BIN-NEXT-BUS-DT TO DC-BIN-DATE-1
  7291        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  7292        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7293        MOVE '6'                 TO DC-OPTION-CODE
  7294        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7295        IF NO-CONVERSION-ERROR
  7296           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  7297        END-IF
  7298     END-IF
  7299     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  7300        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  7301        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  7302        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  7303        MOVE '6'                 TO DC-OPTION-CODE
  7304        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7305        IF NO-CONVERSION-ERROR
  7306           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  7307        END-IF
  7308     END-IF
  7309
  7310     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7311     MOVE BL-LETTER-ID           TO LA-FORM-A3
  7312     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  7313     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  7314     IF BL-ENDT-ARCH-NO > ZEROS
  7315        MOVE BL-ENDT-ARCH-NO     TO LA-ENDT-ARCH-NO
  7316     ELSE
  7317        MOVE BL-ARCHIVE-NO       TO LA-ENDT-ARCH-NO
  7318     END-IF
  7319     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  7320                                    LA-LAST-MAINT-DATE
  7321     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 128
* NSRASBL.cbl
  7322                                    LA-NO-OF-TEXT-RECORDS
  7323     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  7324
  7325* EXEC CICS WRITE
  7326*         DATASET   ('ERARCH')
  7327*         FROM      (LETTER-ARCHIVE)
  7328*         RIDFLD    (LA-CONTROL-PRIMARY)
  7329*         RESP      (WS-RESPONSE)
  7330*    END-EXEC
  7331     MOVE LENGTH OF
  7332      LETTER-ARCHIVE
  7333       TO DFHEIV11
  7334     MOVE 'ERARCH' TO DFHEIV1
  7335*    MOVE '&$ L                  ''  N#00007237' TO DFHEIV0
  7336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7338     MOVE X'204E233030303037323337' TO DFHEIV0(25:11)
  7339     CALL 'kxdfhei1' USING DFHEIV0,
  7340           DFHEIV1,
  7341           LETTER-ARCHIVE,
  7342           DFHEIV11,
  7343           LA-CONTROL-PRIMARY,
  7344           DFHEIV99,
  7345           DFHEIV99
  7346     MOVE EIBRESP  TO WS-RESPONSE
  7347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7348     IF NOT RESP-NORMAL
  7349        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  7350        la-archive-no
  7351        SET BL-FAIL TO TRUE
  7352     END-IF
  7353     .
  7354 1000-EXIT.
  7355     EXIT.
  7356 1025-GET-CSR-INFO.
  7357     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  7358                                    OUT-CSR-TITLE
  7359                                    OUT-PROC-TITLE
  7360                                    OUT-UNDW-ID
  7361     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7362     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  7363     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  7364     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7365
  7366* EXEC CICS READ
  7367*       INTO    (CONTROL-FILE)
  7368*       DATASET ('ELCNTL')
  7369*       RIDFLD  (WS-ELCNTL-KEY)
  7370*       RESP    (WS-RESPONSE)
  7371*    END-EXEC
  7372     MOVE LENGTH OF
  7373      CONTROL-FILE
  7374       TO DFHEIV11
  7375     MOVE 'ELCNTL' TO DFHEIV1
  7376*    MOVE '&"IL       E          (  N#00007260' TO DFHEIV0
  7377     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7378     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7379     MOVE X'204E233030303037323630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 129
* NSRASBL.cbl
  7380     CALL 'kxdfhei1' USING DFHEIV0,
  7381           DFHEIV1,
  7382           CONTROL-FILE,
  7383           DFHEIV11,
  7384           WS-ELCNTL-KEY,
  7385           DFHEIV99,
  7386           DFHEIV99,
  7387           DFHEIV99
  7388     MOVE EIBRESP  TO WS-RESPONSE
  7389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7390     IF RESP-NORMAL
  7391        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  7392                                    OUT-PROC-NAME
  7393*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  7394*                                   OUT-PROC-TITLE
  7395     END-IF
  7396     IF BL-PROC-ID NOT = PB-CSR-ID
  7397        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  7398        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  7399        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  7400                                    OUT-PROC-TITLE
  7401        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  7402
  7403* EXEC CICS READ
  7404*          INTO    (CONTROL-FILE)
  7405*          DATASET ('ELCNTL')
  7406*          RIDFLD  (WS-ELCNTL-KEY)
  7407*          RESP    (WS-RESPONSE)
  7408*       END-EXEC
  7409     MOVE LENGTH OF
  7410      CONTROL-FILE
  7411       TO DFHEIV11
  7412     MOVE 'ELCNTL' TO DFHEIV1
  7413*    MOVE '&"IL       E          (  N#00007278' TO DFHEIV0
  7414     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7415     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7416     MOVE X'204E233030303037323738' TO DFHEIV0(25:11)
  7417     CALL 'kxdfhei1' USING DFHEIV0,
  7418           DFHEIV1,
  7419           CONTROL-FILE,
  7420           DFHEIV11,
  7421           WS-ELCNTL-KEY,
  7422           DFHEIV99,
  7423           DFHEIV99,
  7424           DFHEIV99
  7425     MOVE EIBRESP  TO WS-RESPONSE
  7426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7427        IF RESP-NORMAL
  7428           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  7429*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  7430        END-IF
  7431     END-IF
  7432     .
  7433 1025-EXIT.
  7434     EXIT.
  7435 1050-GET-ERMAIL.
  7436     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  7437
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 130
* NSRASBL.cbl
  7438* EXEC CICS READ
  7439*         DATASET    ('ERMAIL')
  7440*         INTO       (MAILING-DATA)
  7441*         RIDFLD     (WS-ERMAIL-KEY)
  7442*         RESP       (WS-RESPONSE)
  7443*    END-EXEC
  7444     MOVE LENGTH OF
  7445      MAILING-DATA
  7446       TO DFHEIV11
  7447     MOVE 'ERMAIL' TO DFHEIV1
  7448*    MOVE '&"IL       E          (  N#00007294' TO DFHEIV0
  7449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7451     MOVE X'204E233030303037323934' TO DFHEIV0(25:11)
  7452     CALL 'kxdfhei1' USING DFHEIV0,
  7453           DFHEIV1,
  7454           MAILING-DATA,
  7455           DFHEIV11,
  7456           WS-ERMAIL-KEY,
  7457           DFHEIV99,
  7458           DFHEIV99,
  7459           DFHEIV99
  7460     MOVE EIBRESP  TO WS-RESPONSE
  7461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7462     IF RESP-NORMAL
  7463        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  7464        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  7465        MOVE MA-CITY             TO OUT-INS-CITY
  7466        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  7467        MOVE MA-ZIP              TO OUT-INS-ZIP
  7468        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  7469        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  7470        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  7471        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  7472        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  7473        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  7474        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7475           MOVE MA-INSURED-BIRTH-DT
  7476                                 TO DC-BIN-DATE-1
  7477           MOVE ' '              TO DC-OPTION-CODE
  7478           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7479           IF NO-CONVERSION-ERROR
  7480              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7481                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7482                INTO OUT-INS-BIRTHDATE
  7483              END-STRING
  7484           END-IF
  7485        END-IF
  7486        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  7487           MOVE MA-JOINT-BIRTH-DT
  7488                                 TO DC-BIN-DATE-1
  7489           MOVE ' '              TO DC-OPTION-CODE
  7490           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7491           IF NO-CONVERSION-ERROR
  7492              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7493                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7494                INTO OUT-JNT-BIRTHDATE
  7495              END-STRING
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 131
* NSRASBL.cbl
  7496           END-IF
  7497        END-IF
  7498     END-IF
  7499     .
  7500 1050-EXIT.
  7501     EXIT.
  7502 1100-GET-ELCERT.
  7503
  7504* EXEC CICS READ
  7505*         DATASET    ('ELCERT')
  7506*         INTO       (CERTIFICATE-MASTER)
  7507*         RIDFLD     (WS-ELCERT-KEY)
  7508*         RESP       (WS-RESPONSE)
  7509*    END-EXEC.
  7510     MOVE LENGTH OF
  7511      CERTIFICATE-MASTER
  7512       TO DFHEIV11
  7513     MOVE 'ELCERT' TO DFHEIV1
  7514*    MOVE '&"IL       E          (  N#00007341' TO DFHEIV0
  7515     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7517     MOVE X'204E233030303037333431' TO DFHEIV0(25:11)
  7518     CALL 'kxdfhei1' USING DFHEIV0,
  7519           DFHEIV1,
  7520           CERTIFICATE-MASTER,
  7521           DFHEIV11,
  7522           WS-ELCERT-KEY,
  7523           DFHEIV99,
  7524           DFHEIV99,
  7525           DFHEIV99
  7526     MOVE EIBRESP  TO WS-RESPONSE
  7527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7528
  7529     IF RESP-NORMAL
  7530        SET CERT-FOUND TO TRUE
  7531        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  7532        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  7533     END-IF
  7534     .
  7535 1100-EXIT.
  7536     EXIT.
  7537 1110-BUILD-CERT.
  7538     PERFORM 1300-DETERMINE-COMM THRU 1300-EXIT
  7539     MOVE SPACES                 TO OUT-COVERAGE-IND
  7540     MOVE SPACES                 TO OUT-ORIG-COVERAGE-IND
  7541     MOVE SPACES                 TO OUT-NEW-COVERAGE-IND
  7542     MOVE CM-CARRIER             TO OUT-CARRIER
  7543     MOVE CM-GROUPING            TO OUT-GROUPING
  7544     MOVE CM-STATE               TO OUT-STATE
  7545     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  7546     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  7547     MOVE ' '                    TO DC-OPTION-CODE
  7548     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7549     IF NO-CONVERSION-ERROR
  7550        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7551           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7552              INTO OUT-CERT-EFF-DT
  7553        END-STRING
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 132
* NSRASBL.cbl
  7554     END-IF
  7555     MOVE CM-CERT-NO             TO OUT-CERT-NO
  7556     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  7557                                    OUT-ORIG-ILNAME
  7558     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  7559     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  7560                                    OUT-ORIG-MINIT
  7561     IF (CM-SSN-STATE = CM-STATE)
  7562        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  7563        MOVE SPACES              TO OUT-SOC-SEC-NO
  7564     ELSE
  7565        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  7566     END-IF
  7567     IF (CM-MEMB-STATE = CM-STATE)
  7568        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  7569        MOVE SPACES              TO OUT-MEMBER-NO
  7570     ELSE
  7571        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  7572     END-IF
  7573     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  7574                                    OUT-ORIG-IFNAME
  7575     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  7576                                    OUT-ORIG-IAGE
  7577     MOVE CM-INSURED-SEX         TO OUT-ISEX
  7578     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  7579                                    OUT-ORIG-JAGE
  7580     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  7581                                    OUT-ORIG-JLNAME
  7582     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  7583                                    OUT-ORIG-JFNAME
  7584     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  7585                                    OUT-ORIG-JMINIT
  7586     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  7587                                    OUT-ORIG-LF-BENCD
  7588     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  7589                                    OUT-ORIG-LF-TERM
  7590     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  7591     IF CM-LF-DEV-PCT NOT NUMERIC
  7592        MOVE ZEROS               TO CM-LF-DEV-PCT
  7593     END-IF
  7594     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  7595     PERFORM 1160-READ-CERT-TRAILER THRU 1160-EXIT
  7596     IF NOT CERT-TRL-REC-NOT-FOUND
  7597         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
  7598             MOVE ZERO           TO OUT-IAGE
  7599                                    OUT-ORIG-IAGE
  7600         END-IF
  7601         IF CS-JNT-AGE-DEFAULT-FLAG = 'Y'
  7602             MOVE ZERO           TO OUT-JAGE
  7603                                    OUT-ORIG-JAGE
  7604         END-IF
  7605     END-IF
  7606
  7607     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7608        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7609          ((CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES) OR
  7610           (CM-LF-DEATH-DT NOT = LOW-VALUES AND SPACES))
  7611             MOVE SPACES          TO OUT-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 133
* NSRASBL.cbl
  7612                                     WS-LF-BENCD
  7613                                     OUT-LF-CAN-DT
  7614             MOVE ZEROS           TO OUT-LF-TERM
  7615                                     OUT-LF-BEN
  7616                                     OUT-LF-PRM
  7617                                     OUT-LF-ALT-BEN
  7618                                     OUT-LF-ALT-PRM
  7619                                     OUT-LF-COMM-PCT
  7620                                     OUT-LF-NSP
  7621                                     OUT-LF-REM-BEN
  7622                                     WS-WORK-LF-PREM
  7623                                     WS-WORK-ALT-LF-PREM
  7624                                     WS-WORK-CMB-LF-PREM
  7625                                     OUT-LF-REF
  7626                                     OUT-ORIG-LF-REF
  7627                                     WS-WORK-LF-REF
  7628             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7629             GO TO 1100-LF-CONT
  7630        END-IF
  7631     END-IF
  7632
  7633     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7634        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7635             MOVE SPACES          TO OUT-LF-BENCD
  7636                                     WS-LF-BENCD
  7637                                     OUT-LF-CAN-DT
  7638             MOVE ZEROS           TO OUT-LF-TERM
  7639                                     OUT-LF-BEN
  7640                                     OUT-LF-PRM
  7641                                     OUT-LF-ALT-BEN
  7642                                     OUT-LF-ALT-PRM
  7643                                     OUT-LF-COMM-PCT
  7644                                     OUT-LF-NSP
  7645                                     OUT-LF-REM-BEN
  7646                                     WS-WORK-LF-PREM
  7647                                     WS-WORK-ALT-LF-PREM
  7648                                     WS-WORK-CMB-LF-PREM
  7649                                     OUT-LF-REF
  7650                                     OUT-ORIG-LF-REF
  7651                                     WS-WORK-LF-REF
  7652             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  7653             GO TO 1100-LF-CONT
  7654        END-IF
  7655     END-IF
  7656     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  7657         MOVE 'LIFE'             TO OUT-COVERAGE-IND
  7658                                    OUT-ORIG-COVERAGE-IND
  7659     END-IF
  7660
  7661     MOVE CM-LF-BENEFIT-CD       TO WS-LF-BENCD
  7662     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  7663                                    OUT-ORIG-LF-BEN
  7664     IF CM-LF-BENEFIT-AMT = 999999999.99
  7665        MOVE SPACES              TO OUT-ORIG-LF-BEN-A
  7666     END-IF
  7667     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  7668                                    OUT-ORIG-LF-PRM
  7669                                    WS-WORK-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 134
* NSRASBL.cbl
  7670     IF CM-LF-PREMIUM-AMT = .01
  7671         MOVE SPACES             TO OUT-ORIG-LF-PRM-A
  7672     END-IF
  7673     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  7674        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
  7675     END-IF
  7676     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  7677                                    OUT-ORIG-LF-ALT-BEN
  7678     IF CM-LF-ALT-BENEFIT-AMT = 999999999.99
  7679        MOVE SPACES              TO OUT-ORIG-LF-ALT-BEN-A
  7680     END-IF
  7681     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  7682        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  7683     END-IF
  7684     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  7685                                    OUT-ORIG-LF-ALT-PRM
  7686                                    WS-WORK-ALT-LF-PREM
  7687     IF CM-LF-ALT-PREMIUM-AMT = .01
  7688         MOVE SPACES             TO OUT-ORIG-LF-ALT-PRM-A
  7689     END-IF
  7690     COMPUTE WS-WRK-AMOUNT = CM-LF-PREMIUM-AMT +
  7691                             CM-LF-ALT-PREMIUM-AMT
  7692     MOVE WS-WRK-AMOUNT          TO OUT-LF-CMB-PREM
  7693                                 OUT-ORIG-LF-CMB-PREM
  7694                                 WS-WORK-CMB-LF-PREM
  7695     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  7696        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  7697     END-IF
  7698     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  7699     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  7700     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  7701                                    OUT-ORIG-LF-REF
  7702                                    WS-WORK-LF-REF
  7703     IF CM-LF-DEATH-CLAIM-APPLIED
  7704        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7705            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  7706                                    OUT-ORIG-LF-REF
  7707                                    WS-WORK-LF-REF
  7708     END-IF
  7709     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  7710     MOVE ' '                    TO DC-OPTION-CODE
  7711     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7712     IF NO-CONVERSION-ERROR
  7713        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7714           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7715              INTO OUT-LF-CAN-DT
  7716        END-STRING
  7717     END-IF
  7718
  7719     IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7720         MOVE ZEROS          TO WS-WORK-LF-PREM
  7721                                WS-WORK-ALT-LF-PREM
  7722                                WS-WORK-CMB-LF-PREM
  7723     END-IF
  7724
  7725      .
  7726 1100-LF-CONT.
  7727
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 135
* NSRASBL.cbl
  7728     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  7729     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  7730        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  7731     END-IF
  7732     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  7733     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  7734        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  7735     END-IF
  7736     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  7737     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  7738        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  7739          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7740              MOVE SPACES              TO OUT-AH-BENCD
  7741                                          WS-AH-BENCD
  7742                                          OUT-AH-CAN-DT
  7743              MOVE ZEROS               TO OUT-AH-TERM
  7744                                          OUT-AH-BEN
  7745                                          OUT-AH-PRM
  7746                                          OUT-AH-NSP
  7747                                          OUT-AH-COMM-PCT
  7748                                          OUT-CRIT-PER
  7749                                          WS-WORK-AH-PREM
  7750                                          OUT-AH-REF
  7751                                          OUT-ORIG-AH-REF
  7752                                          WS-WORK-AH-REF
  7753              MOVE SPACES              TO OUT-MAX-PMTS-A
  7754                                          OUT-WAIT-PER
  7755                                          OUT-RET-ELIM
  7756                                          OUT-AH-DESC
  7757                                          OUT-BEN-DAYS
  7758              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7759             GO TO 1100-AH-CONT
  7760        END-IF
  7761     END-IF
  7762
  7763     IF BL-DATA-SRCE = '2' AND BL-FUNC = 'CrtVerif'
  7764        IF (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7765              MOVE SPACES              TO OUT-AH-BENCD
  7766                                          WS-AH-BENCD
  7767                                          OUT-AH-CAN-DT
  7768              MOVE ZEROS               TO OUT-AH-TERM
  7769                                          OUT-AH-BEN
  7770                                          OUT-AH-PRM
  7771                                          OUT-AH-NSP
  7772                                          OUT-AH-COMM-PCT
  7773                                          OUT-CRIT-PER
  7774                                          WS-WORK-AH-PREM
  7775                                          OUT-AH-REF
  7776                                          OUT-ORIG-AH-REF
  7777                                          WS-WORK-AH-REF
  7778              MOVE SPACES              TO OUT-MAX-PMTS-A
  7779                                          OUT-WAIT-PER
  7780                                          OUT-RET-ELIM
  7781                                          OUT-AH-DESC
  7782                                          OUT-BEN-DAYS
  7783              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  7784             GO TO 1100-AH-CONT
  7785        END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 136
* NSRASBL.cbl
  7786     END-IF
  7787     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BENCD
  7788     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  7789                                    OUT-ORIG-AH-BENCD
  7790     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  7791        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  7792           CM-AH-BENEFIT-AMT
  7793        IF OUT-COVERAGE-IND = 'LIFE'
  7794            MOVE 'BOTH'          TO OUT-COVERAGE-IND
  7795                                    OUT-ORIG-COVERAGE-IND
  7796        ELSE
  7797            MOVE 'AH  '          TO OUT-COVERAGE-IND
  7798                                    OUT-ORIG-COVERAGE-IND
  7799        END-IF
  7800     ELSE
  7801        MOVE ZEROS               TO OUT-AH-TOT-BEN
  7802     END-IF
  7803     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  7804                                    OUT-ORIG-AH-TERM
  7805     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  7806                                    OUT-ORIG-CRIT-PER
  7807                                    OUT-MAX-PMTS
  7808                                    OUT-ORIG-MAX-PMTS
  7809     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  7810         MOVE SPACES             TO OUT-MAX-PMTS-A
  7811     END-IF
  7812     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  7813     IF CM-AH-DEV-PCT NOT NUMERIC
  7814        MOVE ZEROS               TO CM-AH-DEV-PCT
  7815     END-IF
  7816     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  7817     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  7818                                    OUT-ORIG-AH-BEN
  7819     IF CM-AH-BENEFIT-AMT = 9999999.99
  7820        MOVE SPACES              TO OUT-ORIG-AH-BEN-A
  7821     END-IF
  7822     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  7823                                    OUT-ORIG-AH-PRM
  7824                                    WS-WORK-AH-PREM
  7825     IF CM-AH-PREMIUM-AMT = .01
  7826         MOVE SPACES             TO OUT-ORIG-AH-PRM-A
  7827     END-IF
  7828     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  7829     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  7830                                    OUT-ORIG-AH-REF
  7831                                    WS-WORK-AH-REF
  7832     IF CM-AH-DEATH-CLAIM-APPLIED
  7833        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  7834            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  7835                                    OUT-ORIG-AH-REF
  7836                                    WS-WORK-AH-REF
  7837     END-IF
  7838     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  7839     MOVE ' '                    TO DC-OPTION-CODE
  7840     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7841     IF NO-CONVERSION-ERROR
  7842        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7843           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 137
* NSRASBL.cbl
  7844              INTO OUT-AH-CAN-DT
  7845        END-STRING
  7846     END-IF
  7847
  7848     IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  7849         MOVE ZEROS          TO WS-WORK-AH-PREM
  7850     END-IF
  7851
  7852      .
  7853 1100-AH-CONT.
  7854
  7855     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  7856     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  7857     MOVE ' '                    TO DC-OPTION-CODE
  7858     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7859     IF NO-CONVERSION-ERROR
  7860        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7861           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7862              INTO OUT-AH-PDTHRU-DT
  7863        END-STRING
  7864     END-IF
  7865     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  7866        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  7867     END-IF
  7868     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  7869     IF CM-LOAN-APR NOT NUMERIC
  7870        MOVE ZEROS               TO CM-LOAN-APR
  7871     END-IF
  7872     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  7873     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  7874     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  7875     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  7876     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  7877     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  7878     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  7879     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  7880     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  7881     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  7882     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7883     MOVE ' '                    TO DC-OPTION-CODE
  7884     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7885     IF NO-CONVERSION-ERROR
  7886        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7887           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7888              INTO OUT-LF-EXP-DT
  7889        END-STRING
  7890     END-IF
  7891     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  7892     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  7893     MOVE ' '                    TO DC-OPTION-CODE
  7894     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7895     IF NO-CONVERSION-ERROR
  7896        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7897           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7898              INTO OUT-AH-EXP-DT
  7899        END-STRING
  7900     END-IF
  7901     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 138
* NSRASBL.cbl
  7902     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  7903     MOVE ' '                    TO DC-OPTION-CODE
  7904     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7905     IF NO-CONVERSION-ERROR
  7906        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7907           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7908              INTO OUT-1ST-PMT-DT
  7909        END-STRING
  7910     END-IF
  7911     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
  7912     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  7913     MOVE ' '                    TO DC-OPTION-CODE
  7914     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7915     IF NO-CONVERSION-ERROR
  7916        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7917           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7918              INTO OUT-ENTRY-DT
  7919        END-STRING
  7920     END-IF
  7921     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7922     MOVE ' '                    TO DC-OPTION-CODE
  7923     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7924     IF NO-CONVERSION-ERROR
  7925        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7926           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7927              INTO OUT-LF-CAN-EXIT-DT
  7928        END-STRING
  7929     END-IF
  7930     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  7931     MOVE ' '                    TO DC-OPTION-CODE
  7932     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7933     IF NO-CONVERSION-ERROR
  7934        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7935           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7936              INTO OUT-LF-DTH-DT
  7937        END-STRING
  7938     END-IF
  7939     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7940     MOVE ' '                    TO DC-OPTION-CODE
  7941     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7942     IF NO-CONVERSION-ERROR
  7943        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7944           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7945              INTO OUT-LF-DTH-EXIT-DT
  7946        END-STRING
  7947     END-IF
  7948     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7949     IF OUT-AH-CAN-DT NOT = SPACES
  7950        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7951     ELSE
  7952        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7953     END-IF
  7954     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7955     MOVE ' '                    TO DC-OPTION-CODE
  7956     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7957     IF NO-CONVERSION-ERROR
  7958        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7959           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 139
* NSRASBL.cbl
  7960              INTO OUT-AH-CAN-EXIT-DT
  7961        END-STRING
  7962     END-IF
  7963     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7964     IF CM-ENTRY-BATCH = LOW-VALUES
  7965        MOVE SPACES              TO CM-ENTRY-BATCH
  7966     END-IF
  7967     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7968     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7969        MOVE SPACES              TO CM-LF-EXIT-BATCH
  7970     END-IF
  7971     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7972     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7973        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7974     END-IF
  7975     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7976     MOVE WS-CHGBK-LIFE-PCT      TO OUT-LF-COMM-PCT
  7977     MOVE WS-CHGBK-AH-PCT        TO OUT-AH-COMM-PCT
  7978     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7979     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7980     COMPUTE WS-WORK-PREM =
  7981        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7982           + CM-AH-PREMIUM-AMT)
  7983     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7984                                    OUT-ORIG-TOT-PREM
  7985     COMPUTE WS-WORK-REF =
  7986        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7987     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7988                                    OUT-ORIG-TOT-REF
  7989     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7990        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7991     ELSE
  7992        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7993     END-IF
  7994     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7995     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7996        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7997     ELSE
  7998        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7999     END-IF
  8000     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  8001     IF CM-NH-INT-ON-REFS NUMERIC
  8002        IF CM-NH-INT-ON-REFS NOT = ZEROS
  8003           MOVE CM-NH-INT-ON-REFS TO OUT-TOT-INTEREST
  8004        END-IF
  8005     END-IF
  8006
  8007     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  8008        IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8009            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8010        END-IF
  8011        IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8012            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8013        END-IF
  8014     END-IF
  8015*
  8016*     IF BL-DATA-SRCE = '2'
  8017*        IF CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 140
* NSRASBL.cbl
  8018*            MOVE WS-WORK-LF-REF TO WS-WORK-CMB-LF-PREM
  8019*        END-IF
  8020*        IF CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES
  8021*            MOVE WS-WORK-AH-REF TO WS-WORK-AH-PREM
  8022*        END-IF
  8023*     END-IF
  8024
  8025     COMPUTE WS-ACCT-LF-PORTION =
  8026        WS-WORK-LF-PREM * WS-CHGBK-LIFE-PCT
  8027     MOVE WS-ACCT-LF-PORTION TO OUT-ACCT-LF-PORTION
  8028                                OUT-ACCT-ORIG-LF-PORT
  8029     COMPUTE WS-ACCT-ALT-LF-PORTION =
  8030        WS-WORK-ALT-LF-PREM * WS-CHGBK-LIFE-PCT
  8031     MOVE WS-ACCT-ALT-LF-PORTION TO OUT-ACCT-ALT-LF-PORT
  8032                                OUT-ACCT-ORIG-ALT-LF-PORT
  8033     COMPUTE WS-ACCT-CMB-LF-PORTION =
  8034        WS-WORK-CMB-LF-PREM * WS-CHGBK-LIFE-PCT
  8035     MOVE WS-ACCT-CMB-LF-PORTION TO OUT-ACCT-CMB-LF-PORT
  8036                                OUT-ACCT-ORIG-CMB-LF-PORT
  8037     COMPUTE WS-ACCT-AH-PORTION =
  8038        WS-WORK-AH-PREM * WS-CHGBK-AH-PCT
  8039     MOVE WS-ACCT-AH-PORTION TO OUT-ACCT-AH-PORTION
  8040                                OUT-ACCT-ORIG-AH-PORT
  8041     COMPUTE WS-ACCT-PORTION =
  8042        WS-ACCT-CMB-LF-PORTION + WS-ACCT-AH-PORTION
  8043     MOVE WS-ACCT-PORTION TO OUT-ACCT-PORTION
  8044                                OUT-ACCT-ORIG-PORTION
  8045
  8046     COMPUTE WS-CSO-LF-PORTION =
  8047       WS-WORK-LF-PREM - WS-ACCT-LF-PORTION
  8048     MOVE WS-CSO-LF-PORTION TO OUT-CSO-LF-PORTION
  8049                               OUT-CSO-ORIG-LF-PORT
  8050     COMPUTE WS-CSO-ALT-LF-PORTION =
  8051       WS-WORK-ALT-LF-PREM - WS-ACCT-ALT-LF-PORTION
  8052     MOVE WS-CSO-ALT-LF-PORTION TO OUT-CSO-ALT-LF-PORT
  8053                                   OUT-CSO-ORIG-ALT-LF-PORT
  8054     COMPUTE WS-CSO-CMB-LF-PORTION =
  8055       WS-WORK-CMB-LF-PREM - WS-ACCT-CMB-LF-PORTION
  8056     MOVE WS-CSO-CMB-LF-PORTION TO OUT-CSO-CMB-LF-PORT
  8057                                   OUT-CSO-ORIG-CMB-LF-PORT
  8058     COMPUTE WS-CSO-AH-PORTION =
  8059        WS-WORK-AH-PREM - WS-ACCT-AH-PORTION
  8060     MOVE WS-CSO-AH-PORTION TO OUT-CSO-AH-PORTION
  8061                               OUT-CSO-ORIG-AH-PORT
  8062     COMPUTE WS-CSO-PORTION =
  8063        WS-CSO-CMB-LF-PORTION + WS-CSO-AH-PORTION
  8064     MOVE WS-CSO-PORTION TO OUT-CSO-PORTION
  8065                            OUT-CSO-ORIG-PORTION
  8066     .
  8067 1110-EXIT.
  8068     EXIT.
  8069 1115-MATCH-COMPANY.
  8070     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8071     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8072     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8073
  8074* EXEC CICS READ
  8075*       INTO    (CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 141
* NSRASBL.cbl
  8076*       DATASET ('ELCNTL')
  8077*       RIDFLD  (WS-ELCNTL-KEY)
  8078*       RESP    (WS-RESPONSE)
  8079*    END-EXEC
  8080     MOVE LENGTH OF
  8081      CONTROL-FILE
  8082       TO DFHEIV11
  8083     MOVE 'ELCNTL' TO DFHEIV1
  8084*    MOVE '&"IL       E          (  N#00007891' TO DFHEIV0
  8085     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8087     MOVE X'204E233030303037383931' TO DFHEIV0(25:11)
  8088     CALL 'kxdfhei1' USING DFHEIV0,
  8089           DFHEIV1,
  8090           CONTROL-FILE,
  8091           DFHEIV11,
  8092           WS-ELCNTL-KEY,
  8093           DFHEIV99,
  8094           DFHEIV99,
  8095           DFHEIV99
  8096     MOVE EIBRESP  TO WS-RESPONSE
  8097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8098     IF RESP-NORMAL
  8099        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  8100     END-IF
  8101     .
  8102 1115-EXIT.
  8103     EXIT.
  8104 1120-MATCH-CARRIER.
  8105     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8106     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  8107     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  8108     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8109
  8110* EXEC CICS READ
  8111*       INTO    (CONTROL-FILE)
  8112*       DATASET ('ELCNTL')
  8113*       RIDFLD  (WS-ELCNTL-KEY)
  8114*       RESP    (WS-RESPONSE)
  8115*    END-EXEC
  8116     MOVE LENGTH OF
  8117      CONTROL-FILE
  8118       TO DFHEIV11
  8119     MOVE 'ELCNTL' TO DFHEIV1
  8120*    MOVE '&"IL       E          (  N#00007908' TO DFHEIV0
  8121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8123     MOVE X'204E233030303037393038' TO DFHEIV0(25:11)
  8124     CALL 'kxdfhei1' USING DFHEIV0,
  8125           DFHEIV1,
  8126           CONTROL-FILE,
  8127           DFHEIV11,
  8128           WS-ELCNTL-KEY,
  8129           DFHEIV99,
  8130           DFHEIV99,
  8131           DFHEIV99
  8132     MOVE EIBRESP  TO WS-RESPONSE
  8133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 142
* NSRASBL.cbl
  8134     IF RESP-NORMAL
  8135        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  8136     ELSE
  8137        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  8138     END-IF
  8139     .
  8140 1120-EXIT.
  8141     EXIT.
  8142 1125-MATCH-STATE.
  8143     MOVE BL-STATE               TO OUT-STATE
  8144     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8145     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  8146     MOVE BL-STATE               TO WS-ELCNTL-STATE
  8147     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8148
  8149* EXEC CICS READ
  8150*       INTO    (CONTROL-FILE)
  8151*       DATASET ('ELCNTL')
  8152*       RIDFLD  (WS-ELCNTL-KEY)
  8153*       RESP    (WS-RESPONSE)
  8154*    END-EXEC
  8155     MOVE LENGTH OF
  8156      CONTROL-FILE
  8157       TO DFHEIV11
  8158     MOVE 'ELCNTL' TO DFHEIV1
  8159*    MOVE '&"IL       E          (  N#00007928' TO DFHEIV0
  8160     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8162     MOVE X'204E233030303037393238' TO DFHEIV0(25:11)
  8163     CALL 'kxdfhei1' USING DFHEIV0,
  8164           DFHEIV1,
  8165           CONTROL-FILE,
  8166           DFHEIV11,
  8167           WS-ELCNTL-KEY,
  8168           DFHEIV99,
  8169           DFHEIV99,
  8170           DFHEIV99
  8171     MOVE EIBRESP  TO WS-RESPONSE
  8172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8173     IF RESP-NORMAL
  8174        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  8175     ELSE
  8176        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  8177     END-IF
  8178     .
  8179 1125-EXIT.
  8180     EXIT.
  8181 1130-MATCH-BENCDS.
  8182     MOVE SPACES                 TO WS-LF-ABBRV
  8183                                    WS-LF-DESC
  8184                                    WS-LF-EARN
  8185                                    WS-WAIT-PER
  8186                                    WS-RET-ELIM
  8187                                    WS-AH-DESC
  8188                                    WS-BEN-DAYS
  8189     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  8190        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  8191     END-IF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 143
* NSRASBL.cbl
  8192     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  8193        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  8194     END-IF
  8195     .
  8196 1130-EXIT.
  8197     EXIT.
  8198 1140-MATCH-LFBEN.
  8199     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8200     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  8201     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  8202     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8203
  8204* EXEC CICS READ
  8205*       INTO    (CONTROL-FILE)
  8206*       DATASET ('ELCNTL')
  8207*       RIDFLD  (WS-ELCNTL-KEY)
  8208*       GTEQ
  8209*       RESP    (WS-RESPONSE)
  8210*    END-EXEC
  8211     MOVE LENGTH OF
  8212      CONTROL-FILE
  8213       TO DFHEIV11
  8214     MOVE 'ELCNTL' TO DFHEIV1
  8215*    MOVE '&"IL       G          (  N#00007964' TO DFHEIV0
  8216     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8217     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8218     MOVE X'204E233030303037393634' TO DFHEIV0(25:11)
  8219     CALL 'kxdfhei1' USING DFHEIV0,
  8220           DFHEIV1,
  8221           CONTROL-FILE,
  8222           DFHEIV11,
  8223           WS-ELCNTL-KEY,
  8224           DFHEIV99,
  8225           DFHEIV99,
  8226           DFHEIV99
  8227     MOVE EIBRESP  TO WS-RESPONSE
  8228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8229     IF RESP-NORMAL
  8230        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8231           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  8232           OR (S1 > +8)
  8233        END-PERFORM
  8234        IF S1 < + 9
  8235           MOVE CF-BENEFIT-ALPHA (S1)
  8236                                 TO WS-LF-ABBRV
  8237           MOVE WS-LF-BENCD      TO WS-LF-DESC
  8238           MOVE CF-CO-EARNINGS-CALC (S1)
  8239                                 TO WS-LF-EARN
  8240        ELSE
  8241           MOVE 'XX'             TO WS-LF-DESC
  8242           MOVE 'XXX'            TO WS-LF-ABBRV
  8243        END-IF
  8244     ELSE
  8245        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  8246     END-IF
  8247     .
  8248 1140-EXIT.
  8249     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 144
* NSRASBL.cbl
  8250 1150-MATCH-AHBEN.
  8251     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  8252     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  8253     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  8254     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  8255
  8256* EXEC CICS READ
  8257*       INTO    (CONTROL-FILE)
  8258*       DATASET ('ELCNTL')
  8259*       RIDFLD  (WS-ELCNTL-KEY)
  8260*       GTEQ
  8261*       RESP    (WS-RESPONSE)
  8262*    END-EXEC
  8263     MOVE LENGTH OF
  8264      CONTROL-FILE
  8265       TO DFHEIV11
  8266     MOVE 'ELCNTL' TO DFHEIV1
  8267*    MOVE '&"IL       G          (  N#00007997' TO DFHEIV0
  8268     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8270     MOVE X'204E233030303037393937' TO DFHEIV0(25:11)
  8271     CALL 'kxdfhei1' USING DFHEIV0,
  8272           DFHEIV1,
  8273           CONTROL-FILE,
  8274           DFHEIV11,
  8275           WS-ELCNTL-KEY,
  8276           DFHEIV99,
  8277           DFHEIV99,
  8278           DFHEIV99
  8279     MOVE EIBRESP  TO WS-RESPONSE
  8280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8281     IF RESP-NORMAL
  8282        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8283           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  8284           OR (S1 > +8)
  8285        END-PERFORM
  8286        IF S1 < + 9
  8287           MOVE CF-BENEFIT-ALPHA (S1)
  8288                                 TO WS-WAIT-PER
  8289           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  8290                                 TO WS-RET-ELIM
  8291           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  8292                                 TO WS-BEN-DAYS
  8293           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  8294              IF CF-JOINT-INDICATOR (S1) = 'J'
  8295                 MOVE 'Joint Critical Period Disability'
  8296                                 TO WS-AH-DESC
  8297              ELSE
  8298                 MOVE 'Single Critical Period-Primary Only'
  8299                                 TO WS-AH-DESC
  8300              END-IF
  8301           ELSE
  8302              IF CF-JOINT-INDICATOR (S1) = 'J'
  8303                 MOVE 'Joint Disability'
  8304                                 TO WS-AH-DESC
  8305              ELSE
  8306                 MOVE 'Single Disability (Primary Only)'
  8307                                 TO WS-AH-DESC
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 145
* NSRASBL.cbl
  8308              END-IF
  8309           END-IF
  8310        ELSE
  8311           MOVE 'NOT FOUND'      TO WS-AH-DESC
  8312        END-IF
  8313     ELSE
  8314        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  8315     END-IF
  8316     .
  8317 1150-EXIT.
  8318     EXIT.
  8319
  8320 1160-READ-CERT-TRAILER.
  8321
  8322     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
  8323     MOVE WS-ELCERT-KEY          TO  WS-ELCRTT-PRIMARY.
  8324     MOVE 'C'                    TO  WS-ELCRTT-REC-TYPE.
  8325
  8326
  8327* EXEC CICS HANDLE CONDITION
  8328*        NOTFND (1160-CERT-TRL-REC-NOTFND)
  8329*    END-EXEC.
  8330*    MOVE '"$I                   ! " #00008049' TO DFHEIV0
  8331     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8333     MOVE X'2220233030303038303439' TO DFHEIV0(25:11)
  8334     CALL 'kxdfhei1' USING DFHEIV0
  8335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8336
  8337
  8338
  8339* EXEC CICS READ
  8340*        DATASET  ('ELCRTT')
  8341*        RIDFLD   (WS-ELCRTT-KEY)
  8342*        INTO     (CERTIFICATE-TRAILERS)
  8343*    END-EXEC.
  8344     MOVE LENGTH OF
  8345      CERTIFICATE-TRAILERS
  8346       TO DFHEIV11
  8347     MOVE 'ELCRTT' TO DFHEIV1
  8348*    MOVE '&"IL       E          (   #00008053' TO DFHEIV0
  8349     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8350     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8351     MOVE X'2020233030303038303533' TO DFHEIV0(25:11)
  8352     CALL 'kxdfhei1' USING DFHEIV0,
  8353           DFHEIV1,
  8354           CERTIFICATE-TRAILERS,
  8355           DFHEIV11,
  8356           WS-ELCRTT-KEY,
  8357           DFHEIV99,
  8358           DFHEIV99,
  8359           DFHEIV99
  8360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8361
  8362
  8363     GO TO 1160-EXIT.
  8364
  8365 1160-CERT-TRL-REC-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 146
* NSRASBL.cbl
  8366     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
  8367
  8368 1160-EXIT.
  8369     EXIT.
  8370 1200-GET-ERACCT.
  8371     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  8372     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  8373                                    OUT-ACCT-ADDR1
  8374                                    OUT-ACCT-ADDR2
  8375                                    OUT-ACCT-CITY
  8376     MOVE ZEROS                  TO WS-CHGBACK
  8377
  8378* EXEC CICS STARTBR
  8379*        DATASET   ('ERACCT')
  8380*        RIDFLD    (WS-ERACCT-KEY)
  8381*        GTEQ
  8382*        RESP      (WS-RESPONSE)
  8383*    END-EXEC
  8384     MOVE 'ERACCT' TO DFHEIV1
  8385     MOVE 0
  8386       TO DFHEIV11
  8387*    MOVE '&,         G          &  N#00008073' TO DFHEIV0
  8388     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8389     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8390     MOVE X'204E233030303038303733' TO DFHEIV0(25:11)
  8391     CALL 'kxdfhei1' USING DFHEIV0,
  8392           DFHEIV1,
  8393           WS-ERACCT-KEY,
  8394           DFHEIV99,
  8395           DFHEIV11,
  8396           DFHEIV99
  8397     MOVE EIBRESP  TO WS-RESPONSE
  8398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8399     IF RESP-NORMAL
  8400
  8401* EXEC CICS READNEXT
  8402*          INTO    (ACCOUNT-MASTER)
  8403*          DATASET ('ERACCT')
  8404*          RIDFLD  (WS-ERACCT-KEY)
  8405*          RESP    (WS-RESPONSE)
  8406*       END-EXEC
  8407     MOVE LENGTH OF
  8408      ACCOUNT-MASTER
  8409       TO DFHEIV12
  8410     MOVE 'ERACCT' TO DFHEIV1
  8411     MOVE 0
  8412       TO DFHEIV11
  8413*    MOVE '&.IL                  )  N#00008080' TO DFHEIV0
  8414     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8415     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8416     MOVE X'204E233030303038303830' TO DFHEIV0(25:11)
  8417     CALL 'kxdfhei1' USING DFHEIV0,
  8418           DFHEIV1,
  8419           ACCOUNT-MASTER,
  8420           DFHEIV12,
  8421           WS-ERACCT-KEY,
  8422           DFHEIV99,
  8423           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 147
* NSRASBL.cbl
  8424           DFHEIV99,
  8425           DFHEIV99
  8426     MOVE EIBRESP  TO WS-RESPONSE
  8427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8428     END-IF
  8429     IF RESP-NORMAL
  8430        PERFORM UNTIL
  8431           NOT (RESP-NORMAL)
  8432           OR (WS-SAVE-ERACCT-KEY NOT =
  8433                        AM-CONTROL-PRIMARY (1:20))
  8434           IF BL-DATA-SRCE = '4' OR '2'
  8435              IF (WS-CERT-EFF-DT < AM-EXPIRATION-DT
  8436                 AND >= AM-EFFECTIVE-DT)
  8437                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8438                    (AM-COM-TYP (S1) = 'C' OR 'D')
  8439                    OR (S1 > +10)
  8440                 END-PERFORM
  8441                 IF S1 < +11
  8442                    MOVE AM-COMM-CHARGEBACK (S1)
  8443                                 TO WS-CHGBACK
  8444                 END-IF
  8445              END-IF
  8446           END-IF
  8447           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  8448
  8449* EXEC CICS READNEXT
  8450*             INTO    (ACCOUNT-MASTER)
  8451*             DATASET ('ERACCT')
  8452*             RIDFLD  (WS-ERACCT-KEY)
  8453*             RESP    (WS-RESPONSE)
  8454*          END-EXEC
  8455     MOVE LENGTH OF
  8456      ACCOUNT-MASTER
  8457       TO DFHEIV12
  8458     MOVE 'ERACCT' TO DFHEIV1
  8459     MOVE 0
  8460       TO DFHEIV11
  8461*    MOVE '&.IL                  )  N#00008106' TO DFHEIV0
  8462     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8464     MOVE X'204E233030303038313036' TO DFHEIV0(25:11)
  8465     CALL 'kxdfhei1' USING DFHEIV0,
  8466           DFHEIV1,
  8467           ACCOUNT-MASTER,
  8468           DFHEIV12,
  8469           WS-ERACCT-KEY,
  8470           DFHEIV99,
  8471           DFHEIV11,
  8472           DFHEIV99,
  8473           DFHEIV99
  8474     MOVE EIBRESP  TO WS-RESPONSE
  8475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8476        END-PERFORM
  8477        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  8478        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  8479           SET ACCT-FOUND TO TRUE
  8480           MOVE AM-NAME          TO OUT-ACCT-NAME
  8481           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 148
* NSRASBL.cbl
  8482           MOVE SPACES           TO OUT-ACCT-ADDR2
  8483           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  8484           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  8485           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
  8486           MOVE AM-CONTROL-NAME  TO OUT-ACCT-CNTRL-NAME
  8487           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  8488           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  8489           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  8490              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  8491                 INTO OUT-ACCT-ZIP (6:5)
  8492              END-STRING
  8493           END-IF
  8494           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  8495           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  8496           MOVE AM-STATE         TO OUT-FORM
  8497           IF AM-ACCOUNT (10:1) = 'L'
  8498              MOVE 'L'           TO OUT-FORM (3:1)
  8499                                    OUT-LEASE-IND
  8500           END-IF
  8501           MOVE AM-CONTROL-PRIMARY (1:8)
  8502                                 TO WS-ERCOMP-KEY
  8503           IF AM-REMIT-TO NOT NUMERIC
  8504              MOVE 01            TO AM-REMIT-TO
  8505           END-IF
  8506           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  8507           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  8508              (AM-COM-TYP (S1) = 'C' OR 'D')
  8509              OR (S1 > +10)
  8510           END-PERFORM
  8511           IF S1 < +11
  8512              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  8513           END-IF
  8514           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  8515           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  8516        END-IF
  8517     END-IF
  8518
  8519* EXEC CICS ENDBR
  8520*        DATASET   ('ERACCT')
  8521*    END-EXEC
  8522     MOVE 'ERACCT' TO DFHEIV1
  8523     MOVE 0
  8524       TO DFHEIV11
  8525*    MOVE '&2                    $   #00008154' TO DFHEIV0
  8526     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8528     MOVE X'2020233030303038313534' TO DFHEIV0(25:11)
  8529     CALL 'kxdfhei1' USING DFHEIV0,
  8530           DFHEIV1,
  8531           DFHEIV11,
  8532           DFHEIV99
  8533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8534    .
  8535 1200-EXIT.
  8536     EXIT.
  8537 1225-GET-ERCOMP.
  8538
  8539* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 149
* NSRASBL.cbl
  8540*       INTO    (COMPENSATION-MASTER)
  8541*       DATASET ('ERCOMP')
  8542*       RIDFLD  (WS-ERCOMP-KEY)
  8543*       RESP    (WS-RESPONSE)
  8544*    END-EXEC
  8545     MOVE LENGTH OF
  8546      COMPENSATION-MASTER
  8547       TO DFHEIV11
  8548     MOVE 'ERCOMP' TO DFHEIV1
  8549*    MOVE '&"IL       E          (  N#00008161' TO DFHEIV0
  8550     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8552     MOVE X'204E233030303038313631' TO DFHEIV0(25:11)
  8553     CALL 'kxdfhei1' USING DFHEIV0,
  8554           DFHEIV1,
  8555           COMPENSATION-MASTER,
  8556           DFHEIV11,
  8557           WS-ERCOMP-KEY,
  8558           DFHEIV99,
  8559           DFHEIV99,
  8560           DFHEIV99
  8561     MOVE EIBRESP  TO WS-RESPONSE
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8563     IF RESP-NORMAL
  8564        MOVE CO-RESP-NO          TO OUT-RESP-NO
  8565        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  8566        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  8567        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  8568        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  8569        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  8570        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  8571        MOVE CO-ZIP              TO OUT-COMP-ZIP
  8572        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  8573        MOVE CO-FAXNO            TO OUT-COMP-FAX
  8574        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  8575        MOVE CO-BILL-SW          TO OUT-BILL-SW
  8576     END-IF
  8577     .
  8578 1225-EXIT.
  8579     EXIT.
  8580 1250-GET-ELLETR.
  8581     display ' made it to 1250 '
  8582     move spaces                 to W-Z-CONTROL-DATA
  8583     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  8584     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  8585     MOVE +0                     TO WS-ELLETR-SEQ-NO
  8586
  8587* EXEC CICS READ
  8588*         DATASET    ('ELLETR')
  8589*         INTO       (TEXT-FILES)
  8590*         RIDFLD     (WS-ELLETR-KEY)
  8591*         RESP       (WS-RESPONSE)
  8592*         GTEQ
  8593*    END-EXEC
  8594     MOVE LENGTH OF
  8595      TEXT-FILES
  8596       TO DFHEIV11
  8597     MOVE 'ELLETR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 150
* NSRASBL.cbl
  8598*    MOVE '&"IL       G          (  N#00008190' TO DFHEIV0
  8599     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  8600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8601     MOVE X'204E233030303038313930' TO DFHEIV0(25:11)
  8602     CALL 'kxdfhei1' USING DFHEIV0,
  8603           DFHEIV1,
  8604           TEXT-FILES,
  8605           DFHEIV11,
  8606           WS-ELLETR-KEY,
  8607           DFHEIV99,
  8608           DFHEIV99,
  8609           DFHEIV99
  8610     MOVE EIBRESP  TO WS-RESPONSE
  8611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8612     IF RESP-NORMAL
  8613        IF (LETTER-FILE-TEXT)
  8614           AND (BL-LETTER-ID = TX-LETTER-NO)
  8615           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  8616           display ' found good z record '
  8617           PERFORM 1280-PROCESS-Z-CONTROLS
  8618                                 THRU 1280-EXIT
  8619        END-IF
  8620     END-IF
  8621     .
  8622 1250-EXIT.
  8623     EXIT.
  8624 1280-PROCESS-Z-CONTROLS.
  8625     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  8626*    IF W-FORM-TO-RESEND > SPACES
  8627*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  8628*    ELSE
  8629*       MOVE SPACES              TO OUT-FORM
  8630*    END-IF
  8631     IF BL-ENC-CD = SPACES OR LOW-VALUES
  8632        MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  8633     END-IF
  8634     MOVE W-LETTER-TYPE          TO OUT-LETTER-TYPE
  8635     MOVE W-PRINT-CERTIFICATE    TO OUT-PRINT-CERTIFICATE
  8636     .
  8637 1280-EXIT.
  8638     EXIT.
  8639 1300-DETERMINE-COMM.
  8640******************************************************************
  8641* DATA SOURCE MEANINGS  BL-DATA-SRCE
  8642*    1) FROM ACCT MAINT
  8643*    2) FROM CERT UPDATE
  8644*    3) FROM COMP MAINT
  8645*    4) FROM REVIEW AND CORRECTIONS
  8646******************************************************************
  8647     MOVE 'Y'                    TO OUT-CHGBACK
  8648     MOVE ZEROS                  TO WS-DIFF
  8649                                    WS-CHGBK-LIFE-PCT
  8650                                    WS-CHGBK-AH-PCT
  8651     IF BL-DATA-SRCE = '4'
  8652        IF PB-CANCELLATION
  8653           MOVE PB-CI-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8654           MOVE PB-CI-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8655           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 151
* NSRASBL.cbl
  8656           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  8657           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  8658              MOVE PB-C-LF-CANCEL-DT
  8659                                 TO DC-BIN-DATE-2
  8660           END-IF
  8661           MOVE '1'              TO DC-OPTION-CODE
  8662           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8663           IF NO-CONVERSION-ERROR
  8664              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8665              IF DC-ODD-DAYS-OVER > +1
  8666                 ADD +1          TO WS-DIFF
  8667              END-IF
  8668              IF (WS-CHGBACK = 99)
  8669                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8670                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8671                                WS-CHGBK-AH-PCT
  8672                   MOVE 'N'  TO OUT-CHGBACK
  8673              END-IF
  8674           END-IF
  8675        ELSE
  8676           MOVE PB-I-LIFE-COMMISSION TO WS-CHGBK-LIFE-PCT
  8677           MOVE PB-I-AH-COMMISSION   TO WS-CHGBK-AH-PCT
  8678        END-IF
  8679     ELSE
  8680        MOVE CM-LIFE-COMM-PCT TO WS-CHGBK-LIFE-PCT
  8681        MOVE CM-AH-COMM-PCT   TO WS-CHGBK-AH-PCT
  8682        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8683           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  8684           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  8685           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  8686           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  8687              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  8688           END-IF
  8689           MOVE '1'              TO DC-OPTION-CODE
  8690           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8691           IF NO-CONVERSION-ERROR
  8692              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  8693              IF DC-ODD-DAYS-OVER > +1
  8694                 ADD +1          TO WS-DIFF
  8695              END-IF
  8696              IF (WS-CHGBACK = 99)
  8697                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  8698                   MOVE +0   TO WS-CHGBK-LIFE-PCT
  8699                                WS-CHGBK-AH-PCT
  8700                   MOVE 'N'  TO OUT-CHGBACK
  8701              END-IF
  8702           END-IF
  8703        END-IF
  8704     END-IF
  8705     .
  8706 1300-EXIT.
  8707     EXIT.
  8708 1500-GET-ARCH-NO.
  8709     DISPLAY ' MADE IT TO 1500 '
  8710     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  8711     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  8712     MOVE SPACES                 TO WS-ELCNTL-GENL
  8713     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 152
* NSRASBL.cbl
  8714
  8715* EXEC CICS READ
  8716*       INTO    (CONTROL-FILE)
  8717*       DATASET ('ELCNTL')
  8718*       RIDFLD  (WS-ELCNTL-KEY)
  8719*       UPDATE
  8720*       RESP    (WS-RESPONSE)
  8721*    END-EXEC
  8722     MOVE LENGTH OF
  8723      CONTROL-FILE
  8724       TO DFHEIV11
  8725     MOVE 'ELCNTL' TO DFHEIV1
  8726*    MOVE '&"IL       EU         (  N#00008299' TO DFHEIV0
  8727     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8728     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8729     MOVE X'204E233030303038323939' TO DFHEIV0(25:11)
  8730     CALL 'kxdfhei1' USING DFHEIV0,
  8731           DFHEIV1,
  8732           CONTROL-FILE,
  8733           DFHEIV11,
  8734           WS-ELCNTL-KEY,
  8735           DFHEIV99,
  8736           DFHEIV99,
  8737           DFHEIV99
  8738     MOVE EIBRESP  TO WS-RESPONSE
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8740     IF RESP-NORMAL
  8741        AND (CF-COMPANY-ID  = BL-COMP-ID)
  8742        AND (CF-RECORD-TYPE = '1')
  8743        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  8744        MOVE CF-CREDIT-LAST-ARCH-NUM
  8745                                 TO WS-ARCHIVE-NO
  8746
  8747* EXEC CICS REWRITE
  8748*          FROM    (CONTROL-FILE)
  8749*          DATASET ('ELCNTL')
  8750*       END-EXEC
  8751     MOVE LENGTH OF
  8752      CONTROL-FILE
  8753       TO DFHEIV11
  8754     MOVE 'ELCNTL' TO DFHEIV1
  8755*    MOVE '&& L                  %   #00008312' TO DFHEIV0
  8756     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8758     MOVE X'2020233030303038333132' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           DFHEIV1,
  8761           CONTROL-FILE,
  8762           DFHEIV11,
  8763           DFHEIV99
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8765     ELSE
  8766        MOVE +0                  TO WS-ARCHIVE-NO
  8767     END-IF
  8768    .
  8769 1500-EXIT.
  8770     EXIT.
  8771 1700-GET-ELENCC.
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 153
* NSRASBL.cbl
  8772     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  8773     MOVE '2'                    TO WS-ELENCC-REC-TYPE
  8774     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  8775     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  8776        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  8777        OR (E1 > +5)
  8778     END-PERFORM
  8779     IF E1 < +5
  8780        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  8781     END-IF
  8782
  8783* EXEC CICS READ
  8784*        DATASET   ('ELENCC')
  8785*        INTO      (ENCLOSURE-CODES)
  8786*        RIDFLD    (WS-ELENCC-KEY)
  8787*        RESP      (WS-RESPONSE)
  8788*    END-EXEC
  8789     MOVE LENGTH OF
  8790      ENCLOSURE-CODES
  8791       TO DFHEIV11
  8792     MOVE 'ELENCC' TO DFHEIV1
  8793*    MOVE '&"IL       E          (  N#00008333' TO DFHEIV0
  8794     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8796     MOVE X'204E233030303038333333' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           DFHEIV1,
  8799           ENCLOSURE-CODES,
  8800           DFHEIV11,
  8801           WS-ELENCC-KEY,
  8802           DFHEIV99,
  8803           DFHEIV99,
  8804           DFHEIV99
  8805     MOVE EIBRESP  TO WS-RESPONSE
  8806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8807     IF NOT RESP-NORMAL
  8808        display ' elencc resp not normal ' ws-response
  8809        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  8810
  8811* EXEC CICS READ
  8812*           DATASET   ('ELENCC')
  8813*           INTO      (ENCLOSURE-CODES)
  8814*           RIDFLD    (WS-ELENCC-KEY)
  8815*           RESP      (WS-RESPONSE)
  8816*       END-EXEC
  8817     MOVE LENGTH OF
  8818      ENCLOSURE-CODES
  8819       TO DFHEIV11
  8820     MOVE 'ELENCC' TO DFHEIV1
  8821*    MOVE '&"IL       E          (  N#00008342' TO DFHEIV0
  8822     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8824     MOVE X'204E233030303038333432' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           DFHEIV1,
  8827           ENCLOSURE-CODES,
  8828           DFHEIV11,
  8829           WS-ELENCC-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 154
* NSRASBL.cbl
  8830           DFHEIV99,
  8831           DFHEIV99,
  8832           DFHEIV99
  8833     MOVE EIBRESP  TO WS-RESPONSE
  8834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8835     END-IF
  8836     IF RESP-NORMAL
  8837        display ' elencc resp normal ' ws-response
  8838        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  8839        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  8840        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  8841     END-IF
  8842     .
  8843 1700-EXIT.
  8844     EXIT.
  8845 9700-DATE-LINK.
  8846
  8847* EXEC CICS LINK
  8848*        PROGRAM   ('ELDATCV')
  8849*        COMMAREA  (DATE-CONVERSION-DATA)
  8850*        LENGTH    (DC-COMM-LENGTH)
  8851*    END-EXEC.
  8852     MOVE 'ELDATCV' TO DFHEIV1
  8853*    MOVE '."C                   (   #00008359' TO DFHEIV0
  8854     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8856     MOVE X'2020233030303038333539' TO DFHEIV0(25:11)
  8857     CALL 'kxdfhei1' USING DFHEIV0,
  8858           DFHEIV1,
  8859           DATE-CONVERSION-DATA,
  8860           DC-COMM-LENGTH,
  8861           DFHEIV99,
  8862           DFHEIV99,
  8863           DFHEIV99,
  8864           DFHEIV99
  8865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8866
  8867 9700-EXIT.
  8868      EXIT.
  8869
  8870 9999-DFHBACK SECTION.
  8871     MOVE '9%                    "   ' TO DFHEIV0
  8872     MOVE 'NSRASBL' TO DFHEIV1
  8873     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8874     GOBACK.
  8875 9999-DFHEXIT.
  8876     IF DFHEIGDJ EQUAL 0001
  8877         NEXT SENTENCE
  8878     ELSE IF DFHEIGDJ EQUAL 2
  8879         GO TO 1160-CERT-TRL-REC-NOTFND
  8880         DEPENDING ON DFHEIGDI.
  8881     MOVE '9%                    "   ' TO DFHEIV0
  8882     MOVE 'NSRASBL' TO DFHEIV1
  8883     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8884     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 07-Jan-14 12:33 Page 155
* NSRASBL.cbl
* Total Messages:     0
* Data:       35108     Code:       54527
