* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   1
* NSAASBL.cbl
* Options: int("NSAASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSAASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSAASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSAASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSAASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSAASLTR.cl2
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   2
* NSAASBL.cbl
    14* 071111    2011022800001  PEMA  NEW PROGRAM
    15* 102212    2012101700002  AJRA  EXPAND PASSED AREA
    16* 012413    2013012100001  AJRA  ADD AUTO BILLING NOTE
    17******************************************************************
    18 ENVIRONMENT DIVISION.
    19 DATA DIVISION.
    20 working-storage section.
    21 01  DFH-START PIC X(04).
    22 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    23 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    24 77  S1                          PIC S999 COMP-3 VALUE +0.
    25 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    26 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    27 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    28 77  NOTE-SUB                    PIC S9(5) COMP-3 VALUE +0.
    29 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    30     88  NO-CERT-RW                 VALUE 'N'.
    31     88  CERT-RW                    VALUE 'Y'.
    32 01 response-code         pic s9(8) comp.
    33 01 display-response      pic 9(8).
    34 01 bl-index              pic 9(8) comp.
    35 01 max-last-name         pic x(18).
    36 01 first-initial         pic x.
    37 01 name-in-range-flag    pic 9.
    38 01 max-entries           pic s9(8) comp value 100.
    39 01 lower-case    pic x(26) value
    40            "abcdefghijklmnopqrstuvwxyz".
    41 01 upper-case    pic x(26) value
    42            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    43 01  MISC.
    44     12  WS-RESPONSE             PIC S9(8)   COMP.
    45         88  RESP-NORMAL                  VALUE +00.
    46         88  RESP-NOTFND                  VALUE +13.
    47         88  RESP-DUPREC                  VALUE +14.
    48         88  RESP-DUPKEY                  VALUE +15.
    49         88  RESP-NOTOPEN                 VALUE +19.
    50         88  RESP-ENDFILE                 VALUE +20.
    51*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
    52*                         COPY ELCZREC.
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*                            ELCZREC.                            *
    57*                                                                *
    58*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
    59*                                                                *
    60******************************************************************
    61*-----------------------------------------------------------------
    62*                   C H A N G E   L O G
    63*
    64* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    65*-----------------------------------------------------------------
    66*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    67* EFFECTIVE    NUMBER
    68*-----------------------------------------------------------------
    69* 122011    2011022800001  AJRA  NEW FILE
    70* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    71* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   3
* NSAASBL.cbl
    72*-----------------------------------------------------------------
    73 01  W-Z-CONTROL-DATA.
    74     05  W-NUMBER-OF-COPIES      PIC  9.
    75     05  FILLER                  PIC  X.
    76     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
    77     05  FILLER                  PIC  X.
    78     05  W-DAYS-TO-RESEND        PIC  999.
    79     05  FILLER                  PIC  X.
    80     05  W-FORM-TO-RESEND        PIC  X(4).
    81     05  FILLER                  PIC  X.
    82     05  W-PROMPT-LETTER         PIC  X.
    83     05  FILLER                  PIC  X.
    84     05  W-ENCLOSURE-CD          PIC  XXX.
    85     05  FILLER                  PIC  X.
    86     05  W-AUTO-CLOSE-IND        PIC  X.
    87     05  FILLER                  PIC  X.
    88     05  W-LETTER-TO-BENE        PIC  X.
    89     05  FILLER                  PIC  X.
    90     05  W-LETTER-TO-ACCT        PIC  X.
    91     05  FILLER                  PIC  X.
    92     05  W-LETTER-TYPE           PIC  X.
    93     05  FILLER                  PIC  X.
    94     05  W-PRINT-CERTIFICATE     PIC  X.
    95     05  FILLER                  PIC  X.
    96     05  W-REFUND-REQUIRED       PIC  X.
    97     05  FILLER                  PIC  X.
    98     05  W-ONBASE-CODE           PIC  XX.
    99     05  FILLER                  PIC  X.
   100     05  W-ACCT-SUMM             PIC  X.
   101     05  FILLER                  PIC  X.
   102     05  W-CSO-SUMM              PIC  X.
   103     05  FILLER                  PIC  X.
   104     05  W-REASONS-REQUIRED      PIC  X.
   105     05  FILLER                  PIC  X(29).
   106 01  WS-ERARCH-KEY.
   107     05  WS-ERARCH-COMPANY-CD    PIC X.
   108     05  WS-ERARCH-ARCH-NO       PIC S9(8) BINARY.
   109 01  WS-ERENDT2-KEY.
   110     05  WS-ERENDT-COMPANY-CD    PIC X.
   111     05  WS-ERENDT-ARCH-NO       PIC 9(8) BINARY.
   112 01  WS-NSASEXTR-KEY.
   113     05  WS-EXTR-COMPANY-CD    PIC X.
   114     05  WS-EXTR-ARCH-NO       PIC 9(8) BINARY.
   115     05  WS-EXTR-SEQ-NO        PIC 9(4) BINARY.
   116 01  WS-ELLETR-KEY.
   117     05  WS-ELLETR-COMPANY-CD    PIC X.
   118     05  WS-ELLETR-LETTER-ID     PIC X(12).
   119     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   120
   121 01  BILL-NOTE-AREA.
   122     12  WS-ELEOBC-KEY.
   123         16  WS-EOBC-COMPANY-CD  PIC X.
   124         16  WS-EOBC-REC-TYPE    PIC X.
   125         16  WS-EOBC-CODE        PIC X(4).
   126         16  FILLER              PIC X(9).
   127     12  WS-ERNOTE-KEY.
   128         16  WS-NOTE-COMPANY-CD  PIC X.
   129         16  WS-NOTE-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   4
* NSAASBL.cbl
   130         16  WS-NOTE-GROUPING    PIC X(6).
   131         16  WS-NOTE-STATE       PIC XX.
   132         16  WS-NOTE-ACCOUNT     PIC X(10).
   133         16  WS-NOTE-CERT-EFF-DT PIC XX.
   134         16  WS-NOTE-CERT-PRIME  PIC X(10).
   135         16  WS-NOTE-CERT-SFX    PIC X.
   136     12  WS-BILLING-NOTE.
   137         16  WS-BN-NOTE          PIC X(25).
   138         16  WS-BN-LTRID         PIC X(4).
   139         16  FILLER              PIC X(3).
   140         16  WS-BN-DATE          PIC X(8).
   141         16  FILLER              PIC X(3).
   142         16  WS-BN-USERID        PIC X(4).
   143         16  FILLER              PIC X(30).
   144     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   145     12  WS-ELCERT-KEY.
   146         16  WS-CERT-COMPANY-CD  PIC X.
   147         16  WS-CERT-CARRIER     PIC X.
   148         16  WS-CERT-GROUPING    PIC X(6).
   149         16  WS-CERT-STATE       PIC XX.
   150         16  WS-CERT-ACCOUNT     PIC X(10).
   151         16  WS-CERT-CERT-EFF-DT PIC XX.
   152         16  WS-CERT-CERT-PRIME  PIC X(10).
   153         16  WS-CERT-CERT-SFX    PIC X.
   154     12  WS-SAVE-KEY.
   155         16  WS-SV-COMPANY-CD    PIC X.
   156         16  WS-SV-CARRIER       PIC X.
   157         16  WS-SV-GROUPING      PIC X(6).
   158         16  WS-SV-STATE         PIC XX.
   159         16  WS-SV-ACCOUNT       PIC X(10).
   160         16  WS-SV-CERT-EFF-DT   PIC XX.
   161         16  WS-SV-CERT-PRIME    PIC X(10).
   162         16  WS-SV-CERT-SFX      PIC X.
   163     12  WS-SAVE-DATA.
   164         16  WS-SV-LETTER-ID     PIC X(4).
   165         16  WS-SV-PROC-ID       PIC X(4).
   166 01 srch-commarea.
   167*                                copy ELCADLTRSPI.
   168******************************************************************
   169*                   C H A N G E   L O G
   170*
   171* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   172*-----------------------------------------------------------------
   173*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   174* EFFECTIVE    NUMBER
   175*-----------------------------------------------------------------
   176* 060611    2011022800001  PEMA  NEW COPYBOOK
   177* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   178* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   179******************************************************************
   180****************************************
   181*  commarea for NaperSoft On Demand Admin services letters
   182*  (business logic input & output)
   183****************************************
   184     03  BL-INPUT.
   185         05  BL-DATA-SRCE        PIC X.
   186         05  BL-LETTER-ID        PIC XXXX.
   187         05  BL-CARRIER          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   5
* NSAASBL.cbl
   188         05  BL-GROUP            PIC X(6).
   189         05  BL-STATE            PIC XX.
   190         05  BL-ACCOUNT          PIC X(10).
   191         05  BL-EFF-DT           PIC X(10).
   192         05  BL-CERT-NO          PIC X(11).
   193         05  BL-BATCH-NO         PIC X(6).
   194         05  BL-BATCH-SEQ        PIC 9(8).
   195         05  BL-RESP-NO          PIC X(10).
   196         05  BL-NO-OF-COPIES     PIC 99.
   197         05  BL-PROC-ID          PIC XXXX.
   198         05  BL-COMP-ID          PIC XXX.
   199         05  BL-PRINT-NOW-SW     PIC X.
   200         05  BL-ENC-CD           PIC XXX.
   201         05  BL-RESEND-DT        PIC X(10).
   202         05  BL-FOLLOW-UP-DT     PIC X(10).
   203         05  BL-ARCHIVE-NO       PIC 9(8).
   204         05  BL-FUNC             PIC X(8).
   205         05  BL-COMMENTS         PIC X(100).
   206         05  FILLER REDEFINES BL-COMMENTS.
   207             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   208             10  BL-LETTER-TO-ACCT PIC X.
   209             10  BL-LETTER-TO-BENE PIC X.
   210             10  BL-WRITE-ERARCH   PIC X.
   211                 88  ERARCH-QWS      VALUE 'Q'.
   212                 88  ERARCH-BATCH    VALUE 'B'.
   213                 88  ERARCH-TEMP     VALUE 'T'.
   214             10  BL-PROCESS-TYPE PIC X(07).
   215             10  BL-CERT-FORM-ID PIC X(05).
   216             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   217             10  BL-SOURCE-SCREEN PIC X(8).
   218             10  FILLER          PIC X(25).
   219     03  BL-OUTPUT.
   220         05  BL-STATUS                   PIC X.
   221             88  BL-OK                      VALUE "P".
   222             88  BL-FAIL                  VALUE "F".
   223         05  BL-MESSAGE          PIC X(50).
   224     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   225     03  FILLER                  PIC X(31).
   226*                                COPY ELCDATE.
   227******************************************************************
   228*                                                                *
   229*                                                                *
   230*                            ELCDATE.                            *
   231*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   232*                            VMOD=2.003
   233*                                                                *
   234*                                                                *
   235*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   236*                 LENGTH = 200                                   *
   237******************************************************************
   238
   239 01  DATE-CONVERSION-DATA.
   240     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   241     12  DC-OPTION-CODE                PIC X.
   242         88  BIN-TO-GREG                VALUE ' '.
   243         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   244         88  EDIT-GREG-TO-BIN           VALUE '2'.
   245         88  YMD-GREG-TO-BIN            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   6
* NSAASBL.cbl
   246         88  MDY-GREG-TO-BIN            VALUE '4'.
   247         88  JULIAN-TO-BIN              VALUE '5'.
   248         88  BIN-PLUS-ELAPSED           VALUE '6'.
   249         88  FIND-CENTURY               VALUE '7'.
   250         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   251         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   252         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   253         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   254         88  JULIAN-TO-BIN-3            VALUE 'C'.
   255         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   256         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   257         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   258         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   259         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   260         88  CHECK-LEAP-YEAR            VALUE 'H'.
   261         88  BIN-3-TO-GREG              VALUE 'I'.
   262         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   263         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   264         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   265         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   266         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   267         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   268         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   269         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   270         88  THREE-CHARACTER-BIN
   271                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   272         88  GREGORIAN-TO-BIN
   273                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   274         88  BIN-TO-GREGORIAN
   275                  VALUES ' ' '1' 'I' '8' 'G'.
   276         88  JULIAN-TO-BINARY
   277                  VALUES '5' 'C' 'E' 'F'.
   278     12  DC-ERROR-CODE                 PIC X.
   279         88  NO-CONVERSION-ERROR        VALUE ' '.
   280         88  DATE-CONVERSION-ERROR
   281                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   282         88  DATE-IS-ZERO               VALUE '1'.
   283         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   284         88  DATE-IS-INVALID            VALUE '3'.
   285         88  DATE1-GREATER-DATE2        VALUE '4'.
   286         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   287         88  DATE-INVALID-OPTION        VALUE '9'.
   288         88  INVALID-CENTURY            VALUE 'A'.
   289         88  ONLY-CENTURY               VALUE 'B'.
   290         88  ONLY-LEAP-YEAR             VALUE 'C'.
   291         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   292     12  DC-END-OF-MONTH               PIC X.
   293         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   294     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   295         88  USE-NORMAL-PROCESS         VALUE ' '.
   296         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   297         88  ADJUST-UP-100-YRS          VALUE '2'.
   298     12  FILLER                        PIC X.
   299     12  DC-CONVERSION-DATES.
   300         16  DC-BIN-DATE-1             PIC XX.
   301         16  DC-BIN-DATE-2             PIC XX.
   302         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   303         16  DC-GREG-DATE-1-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   7
* NSAASBL.cbl
   304                       DC-GREG-DATE-1-EDIT.
   305             20  DC-EDIT1-MONTH        PIC 99.
   306             20  SLASH1-1              PIC X.
   307             20  DC-EDIT1-DAY          PIC 99.
   308             20  SLASH1-2              PIC X.
   309             20  DC-EDIT1-YEAR         PIC 99.
   310         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   311         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   312                     DC-GREG-DATE-2-EDIT.
   313             20  DC-EDIT2-MONTH        PIC 99.
   314             20  SLASH2-1              PIC X.
   315             20  DC-EDIT2-DAY          PIC 99.
   316             20  SLASH2-2              PIC X.
   317             20  DC-EDIT2-YEAR         PIC 99.
   318         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   319         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   320                     DC-GREG-DATE-1-YMD.
   321             20  DC-YMD-YEAR           PIC 99.
   322             20  DC-YMD-MONTH          PIC 99.
   323             20  DC-YMD-DAY            PIC 99.
   324         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   325         16  DC-GREG-DATE-1-MDY-R REDEFINES
   326                      DC-GREG-DATE-1-MDY.
   327             20  DC-MDY-MONTH          PIC 99.
   328             20  DC-MDY-DAY            PIC 99.
   329             20  DC-MDY-YEAR           PIC 99.
   330         16  DC-GREG-DATE-1-ALPHA.
   331             20  DC-ALPHA-MONTH        PIC X(10).
   332             20  DC-ALPHA-DAY          PIC 99.
   333             20  FILLER                PIC XX.
   334             20  DC-ALPHA-CENTURY.
   335                 24 DC-ALPHA-CEN-N     PIC 99.
   336             20  DC-ALPHA-YEAR         PIC 99.
   337         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   338         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   339         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   340         16  DC-JULIAN-DATE            PIC 9(05).
   341         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   342                                       PIC 9(05).
   343         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   344             20  DC-JULIAN-YEAR        PIC 99.
   345             20  DC-JULIAN-DAYS        PIC 999.
   346         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   347         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   348         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   349     12  DATE-CONVERSION-VARIBLES.
   350         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   351         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   352             20  FILLER                PIC 9(3).
   353             20  HOLD-CEN-1-CCYY.
   354                 24  HOLD-CEN-1-CC     PIC 99.
   355                 24  HOLD-CEN-1-YY     PIC 99.
   356             20  HOLD-CEN-1-MO         PIC 99.
   357             20  HOLD-CEN-1-DA         PIC 99.
   358         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   359             20  HOLD-CEN-1-R-MO       PIC 99.
   360             20  HOLD-CEN-1-R-DA       PIC 99.
   361             20  HOLD-CEN-1-R-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   8
* NSAASBL.cbl
   362                 24  HOLD-CEN-1-R-CC   PIC 99.
   363                 24  HOLD-CEN-1-R-YY   PIC 99.
   364             20  FILLER                PIC 9(3).
   365         16  HOLD-CENTURY-1-X.
   366             20  FILLER                PIC X(3)  VALUE SPACES.
   367             20  HOLD-CEN-1-X-CCYY.
   368                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   369                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   370             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   371             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   372         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   373             20  HOLD-CEN-1-R-X-MO     PIC XX.
   374             20  HOLD-CEN-1-R-X-DA     PIC XX.
   375             20  HOLD-CEN-1-R-X-CCYY.
   376                 24  HOLD-CEN-1-R-X-CC PIC XX.
   377                 24  HOLD-CEN-1-R-X-YY PIC XX.
   378             20  FILLER                PIC XXX.
   379         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   380         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   381         16  DC-JULIAN-DATE-1          PIC 9(07).
   382         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   383             20  DC-JULIAN-1-CCYY.
   384                 24  DC-JULIAN-1-CC    PIC 99.
   385                 24  DC-JULIAN-1-YR    PIC 99.
   386             20  DC-JULIAN-DA-1        PIC 999.
   387         16  DC-JULIAN-DATE-2          PIC 9(07).
   388         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   389             20  DC-JULIAN-2-CCYY.
   390                 24  DC-JULIAN-2-CC    PIC 99.
   391                 24  DC-JULIAN-2-YR    PIC 99.
   392             20  DC-JULIAN-DA-2        PIC 999.
   393         16  DC-GREG-DATE-A-EDIT.
   394             20  DC-EDITA-MONTH        PIC 99.
   395             20  SLASHA-1              PIC X VALUE '/'.
   396             20  DC-EDITA-DAY          PIC 99.
   397             20  SLASHA-2              PIC X VALUE '/'.
   398             20  DC-EDITA-CCYY.
   399                 24  DC-EDITA-CENT     PIC 99.
   400                 24  DC-EDITA-YEAR     PIC 99.
   401         16  DC-GREG-DATE-B-EDIT.
   402             20  DC-EDITB-MONTH        PIC 99.
   403             20  SLASHB-1              PIC X VALUE '/'.
   404             20  DC-EDITB-DAY          PIC 99.
   405             20  SLASHB-2              PIC X VALUE '/'.
   406             20  DC-EDITB-CCYY.
   407                 24  DC-EDITB-CENT     PIC 99.
   408                 24  DC-EDITB-YEAR     PIC 99.
   409         16  DC-GREG-DATE-CYMD         PIC 9(08).
   410         16  DC-GREG-DATE-CYMD-R REDEFINES
   411                              DC-GREG-DATE-CYMD.
   412             20  DC-CYMD-CEN           PIC 99.
   413             20  DC-CYMD-YEAR          PIC 99.
   414             20  DC-CYMD-MONTH         PIC 99.
   415             20  DC-CYMD-DAY           PIC 99.
   416         16  DC-GREG-DATE-MDCY         PIC 9(08).
   417         16  DC-GREG-DATE-MDCY-R REDEFINES
   418                              DC-GREG-DATE-MDCY.
   419             20  DC-MDCY-MONTH         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page   9
* NSAASBL.cbl
   420             20  DC-MDCY-DAY           PIC 99.
   421             20  DC-MDCY-CEN           PIC 99.
   422             20  DC-MDCY-YEAR          PIC 99.
   423    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   424        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   425    12  DC-EL310-DATE                  PIC X(21).
   426    12  FILLER                         PIC X(28).
   427*                                COPY ERCARCH.
   428******************************************************************
   429*                                                                *
   430*                            ERCARCH.                            *
   431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   432*                            VMOD=2.002                          *
   433*                                                                *
   434*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
   435*                                                                *
   436*   FILE TYPE = VSAM,KSDS                                        *
   437*   RECORD SIZE = 250  RECFORM = FIXED                           *
   438*                                                                *
   439*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
   440*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
   441*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
   442*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
   443*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
   444*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
   445*                                                                *
   446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   456* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
   457* 110612    2012101700002  AJRA  ADD NEW FIELDS
   458******************************************************************
   459 01  LETTER-ARCHIVE.
   460     12  LA-RECORD-ID                PIC  X(02).
   461         88  LA-VALID-ID                VALUE 'LA'.
   462
   463     12  LA-CONTROL-PRIMARY.
   464         16  LA-COMPANY-CD           PIC  X(01).
   465         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
   466
   467     12  LA-CONTROL-BY-CERT-RESP.
   468         16  LA-COMPANY-CD-A2        PIC  X(01).
   469         16  LA-CERT-NO-A2.
   470             20  LA-CERT-PRIME-A2    PIC  X(10).
   471             20  LA-CERT-SUFFIX-A2   PIC  X(01).
   472         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
   473             20  LA-RESP-PERSON-A2   PIC  X(10).
   474             20  LA-TYPE-A2          PIC  X(01).
   475         16  LA-CARRIER-A2           PIC  X(01).
   476         16  LA-GROUPING-A2          PIC  X(06).
   477         16  LA-STATE-A2             PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  10
* NSAASBL.cbl
   478         16  LA-ACCOUNT-A2           PIC  X(10).
   479         16  LA-EFFECT-DATE-A2       PIC  X(02).
   480         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
   481
   482     12  LA-CONTROL-BY-FORM.
   483         16  LA-COMPANY-CD-A3        PIC  X(01).
   484         16  LA-FORM-A3              PIC  X(04).
   485         16  LA-CARRIER-A3           PIC  X(01).
   486         16  LA-GROUPING-A3          PIC  X(06).
   487         16  LA-STATE-A3             PIC  X(02).
   488         16  LA-ACCOUNT-A3           PIC  X(10).
   489         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
   490
   491     12  LA-CONTROL-BY-PROCESSOR.
   492         16  LA-COMPANY-CD-A4        PIC  X(01).
   493         16  LA-PROCESSOR-CD         PIC  X(04).
   494         16  LA-CARRIER-A4           PIC  X(01).
   495         16  LA-GROUPING-A4          PIC  X(06).
   496         16  LA-STATE-A4             PIC  X(02).
   497         16  LA-ACCOUNT-A4           PIC  X(10).
   498         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
   499
   500     12  LA-CONTROL-BY-KEY-FIELDS.
   501         16  LA-COMPANY-CD-A5        PIC  X(01).
   502         16  LA-CARRIER-A5           PIC  X(01).
   503         16  LA-GROUPING-A5          PIC  X(06).
   504         16  LA-STATE-A5             PIC  X(02).
   505         16  LA-ACCOUNT-A5           PIC  X(10).
   506         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
   507
   508     12  LA-CONTROL-BY-GROUP-CODE.
   509         16  LA-COMPANY-CD-A6        PIC  X(01).
   510         16  LA-ENTRY-A6.
   511             20  LA-FILLER           PIC  X(02).
   512             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
   513         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
   514
   515     12  FILLER                      PIC  X(09).
   516
   517     12  LA-HEADER-RECORD.
   518         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
   519         16  LA-CREATION-DATE        PIC  X(02).
   520         16  LA-FOLLOW-UP-DATE       PIC  X(02).
   521         16  LA-FINAL-ACT-DATE       REDEFINES
   522               LA-FOLLOW-UP-DATE     PIC  X(02).
   523         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
   524         16  LA-NO-OF-COPIES         PIC S9(01).
   525         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
   526         16  LA-REPLY-DATE           PIC  X(02).
   527         16  LA-RESEND-DATES.
   528             20  LA-RESEND-DATE      PIC  X(02).
   529             20  LA-SENT-DATE        PIC  X(02).
   530             20  FILLER              PIC  X(08).
   531         16  LA-SOURCE-INFORMATION.
   532             20  LA-DATA-SOURCE      PIC  X(01).
   533             20  LA-ADDR-SOURCE      PIC  X(01).
   534         16  LA-STATUS               PIC  X(01).
   535             88  LA-STATUS-ACTIVE         VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  11
* NSAASBL.cbl
   536             88  LA-STATUS-COMPLETED      VALUE 'C'.
   537             88  LA-STATUS-ON-HOLD        VALUE 'H'.
   538             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
   539             88  LA-STATUS-PURGED         VALUE 'P'.
   540             88  LA-STATUS-VOIDED         VALUE 'V'.
   541         16  LA-LAST-RESENT-PRINT-DATE
   542                                     PIC  X(02).
   543         16  LA-PRINT-RESTRICTION    PIC  X(01).
   544             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
   545                                          VALUE 'C'.
   546             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
   547                                          VALUE 'F'.
   548             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
   549                                          VALUE 'P'.
   550         16  LA-PURGED-DATE          PIC  X(02).
   551         16  LA-VOIDED-DATE          PIC  X(02).
   552         16  LA-RESEND-LETR          PIC  X(4).
   553         16  FILLER                  PIC  X(08).
   554*        16  LA-RESEND-LETR-2        PIC  X(4).
   555*        16  LA-RESEND-LETR-3        PIC  X(4).
   556*        16  FILLER                  PIC  X(59).
   557         16  LA-ARCHIVE-STATUS       PIC  X.
   558             88  LA-TEMP                VALUE 'T'.
   559             88  LA-QWS                 VALUE 'Q'.
   560             88  LA-BATCH               VALUE 'B'.
   561         16  LA-FINAL-ACT-IND        PIC  X(1).
   562         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   563         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   564         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   565                                     PIC X(4).
   566         16  FILLER                  PIC  X(42).
   567*        16  FILLER                  PIC  X(71).
   568         16  LA-LAST-MAINT-DATE      PIC  X(2).
   569         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   570         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   571                                     PIC  X(4).
   572         16  LA-LAST-UPDATED-BY      PIC  X(4).
   573
   574******************************************************************
   575*                                COPY ERCENDT.
   576******************************************************************
   577*                                                                *
   578*                                                                *
   579*                            ERCENDT.                            *
   580*                            VMOD=2.001                          *
   581*                                                                *
   582*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
   583*                                                                *
   584*   FILE TYPE = VSAM,KSDS                                        *
   585*   RECORD SIZE = 579  RECFORM = FIXED                           *
   586*                                                                *
   587*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
   588*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
   589*                                                                *
   590*   LOG = NO                                                     *
   591*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   592******************************************************************
   593*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  12
* NSAASBL.cbl
   594*                   C H A N G E   L O G
   595*
   596* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   597*-----------------------------------------------------------------
   598*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   599* EFFECTIVE    NUMBER
   600*-----------------------------------------------------------------
   601* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
   602*                                WITH OPEN CLAIMS
   603* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
   604* 110612    2012101700002  AJRA  ADD NEW FIELDS
   605* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   606*-----------------------------------------------------------------
   607 01  ENDORSEMENT-RECORD.
   608     12  EN-RECORD-ID                PIC XX.
   609         88  VALID-EN-ID                VALUE 'EN'.
   610     12  EN-CONTROL-PRIMARY.
   611         16  EN-COMPANY-CD           PIC X.
   612         16  EN-CARRIER              PIC X.
   613         16  EN-GROUPING             PIC X(6).
   614         16  EN-STATE                PIC XX.
   615         16  EN-ACCOUNT              PIC X(10).
   616         16  EN-CERT-EFF-DT          PIC XX.
   617         16  EN-CERT-NO.
   618             20  EN-CERT-PRIME       PIC X(10).
   619             20  EN-CERT-SFX         PIC X.
   620         16  EN-REC-TYPE             PIC X.
   621             88  EN-ISSUE               VALUE 'I'.
   622             88  EN-CANCELLATION        VALUE 'C'.
   623         16  EN-SEQ-NO               PIC 9(04) BINARY.
   624     12  EN-CONTROL-BY-ARCH-NO.
   625         16  EN-COMPANY-CD-A1              PIC X.
   626         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
   627     12  EN-LAST-MAINT-DT            PIC XX.
   628     12  EN-LAST-MAINT-BY            PIC X(4).
   629     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
   630     12  EN-ENDORSEMENT-RECORD       PIC X(329).
   631     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   632         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
   633         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
   634         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
   635         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
   636         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
   637         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
   638         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
   639         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
   640         16  EN-LF-ORIG-BENCD        PIC XX.
   641         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
   642         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   643         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   644         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   645         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   646         16  EN-LF-ORIG-EXP-DT       PIC XX.
   647*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
   648         16  EN-ORIG-CRED-BENE       PIC X(25).
   649         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   650         16  FILLER                  PIC X.
   651         16  EN-AH-ORIG-BENCD        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  13
* NSAASBL.cbl
   652         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
   653         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
   654         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
   655         16  EN-AH-ORIG-EXP-DT       PIC XX.
   656*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
   657*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
   658         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
   659         16  F                       PIC X(09).
   660         16  EN-AH-ORIG-CP           PIC 99.
   661         16  EN-INS-NEW-LAST-NAME    PIC X(15).
   662         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
   663         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
   664         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
   665         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
   666         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
   667         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
   668         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
   669         16  EN-LF-NEW-BENCD         PIC XX.
   670         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
   671         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   672         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   673         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
   674         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
   675         16  EN-LF-NEW-EXP-DT        PIC XX.
   676         16  EN-NEW-CRED-BENE        PIC X(25).
   677         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   678         16  FILLER                  PIC X.
   679         16  EN-AH-NEW-BENCD         PIC XX.
   680         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
   681         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
   682         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
   683         16  EN-AH-NEW-EXP-DT        PIC XX.
   684*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
   685*        16  EN-AH-NEW-WAIT-PER      PIC 99.
   686*        16  F                       PIC X(12).
   687         16  EN-AH-NEW-CP            PIC 99.
   688         16  EN-SIG-SW               PIC X.
   689         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
   690         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
   691         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
   692         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
   693         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
   694         16  FILLER                  PIC X(33).
   695     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
   696         16  EN-LF-ORIG-REF-DT       PIC XX.
   697         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   698         16  EN-AH-ORIG-REF-DT       PIC XX.
   699         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
   700         16  EN-LF-NEW-REF-DT        PIC XX.
   701         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   702         16  EN-AH-NEW-REF-DT        PIC XX.
   703         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
   704         16  EN-FLAG-CERT            PIC X.
   705         16  EN-INS-LAST-NAME        PIC X(15).
   706         16  EN-INS-FIRST-NAME       PIC X(10).
   707         16  EN-INS-MIDDLE-INIT      PIC X.
   708         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
   709         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  14
* NSAASBL.cbl
   710         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
   711         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
   712         16  FILLER                  PIC X(262).
   713     12  EN-MONEY-SW             PIC X.
   714     12  EN-HEALTH-APP           PIC X.
   715     12  EN-VOUCHER-SW           PIC X.
   716     12  EN-PAYEE                PIC X(14).
   717     12  EN-INPUT-DT             PIC XX.
   718     12  EN-PROCESS-DT           PIC XX.
   719     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
   720     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
   721     12  EN-REASON-CODES.
   722         16  F OCCURS 12.
   723             20  EN-REASON-CODE  PIC X(4).
   724     12  EN-TEMPLATE-USED        PIC X(8).
   725     12  EN-DOCU-TYPE            PIC X.
   726         88  EN-VERI-DOCU          VALUE 'V'.
   727         88  EN-GCE-DOCU           VALUE 'G'.
   728         88  EN-CANC-DOCU          VALUE 'C'.
   729     12  EN-COMMENTS1            PIC X(13).
   730     12  EN-COMMENTS2            PIC X(70).
   731     12  EN-COMM-CHGBK           PIC X.
   732         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
   733         88  EN-CHG-ACCT           VALUE 'Y'.
   734     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
   735     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
   736     12  EN-BATCH-NUMBER         PIC X(6).
   737     12  EN-ACCT-SUMM            PIC X.
   738     12  EN-CSO-SUMM             PIC X.
   739     12  FILLER                  PIC X(13).
   740******************************************************************
   741*                                COPY NSCASEXTR.
   742******************************************************************
   743*                                                                *
   744*                                                                *
   745*                            NSCASEXTR.                          *
   746*                            VMOD=2.001                          *
   747*                                                                *
   748*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   749*                                                                *
   750*   FILE TYPE = VSAM,KSDS                                        *
   751*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   752*                                                                *
   753*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   754*                                                                *
   755*   LOG = NO                                                     *
   756*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   757******************************************************************
   758*-----------------------------------------------------------------
   759*                   C H A N G E   L O G
   760*
   761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   762*-----------------------------------------------------------------
   763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   764* EFFECTIVE    NUMBER
   765*-----------------------------------------------------------------
   766* 072211    2011022800001  PEMA  NEW FILE
   767*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  15
* NSAASBL.cbl
   768 01 NSAS-EXTRACT-RECORD.
   769    05  NSAS-CONTROL-PRIMARY.
   770        10  NSAS-COMPANY-CD      PIC X.
   771        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   772        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   773    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   774    05  FILLER                   PIC X(143).
   775*                                COPY ERCNOTE.
   776******************************************************************
   777*                                                                *
   778*                                                                *
   779*                            ERCNOTE                             *
   780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   781*                            VMOD=2.003                          *
   782*                                                                *
   783*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
   784*                                                                *
   785*        FILE TYPE= VSAM,KSDS                                    *
   786*        RECORD SIZE = 825    RECFORM = FIXED                    *
   787*                                                                *
   788*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
   789*                                                                *
   790*        LOG = YES                                               *
   791*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   792*                                                                *
   793******************************************************************
   794*                   C H A N G E   L O G
   795*
   796* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   797*-----------------------------------------------------------------
   798*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   799* EFFECTIVE    NUMBER
   800*-----------------------------------------------------------------
   801* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
   802*                                FILE WILL CONTAIN BILLING NOTES O
   803******************************************************************
   804
   805 01  CERTIFICATE-NOTE.
   806     12  CN-RECORD-ID                PIC  XX.
   807         88  VALID-CN-ID                  VALUE 'CN'.
   808
   809     12  CN-CONTROL-PRIMARY.
   810         16  CN-COMPANY-CD           PIC X.
   811         16  CN-CARRIER              PIC X.
   812         16  CN-GROUPING.
   813             20 CN-GROUPING-PREFIX   PIC XXX.
   814             20 CN-GROUPING-PRIME    PIC XXX.
   815         16  CN-STATE                PIC XX.
   816         16  CN-ACCOUNT.
   817             20 CN-ACCOUNT-PREFIX    PIC X(4).
   818             20 CN-ACCOUNT-PRIME     PIC X(6).
   819         16  CN-CERT-EFF-DT          PIC XX.
   820         16  CN-CERT-NO.
   821             20  CN-CERT-PRIME       PIC X(10).
   822             20  CN-CERT-SFX         PIC X.
   823
   824     12  CN-BILLING-START-LINE-NO    PIC 99.
   825     12  CN-BILLING-END-LINE-NO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  16
* NSAASBL.cbl
   826
   827     12  CN-LINES.
   828         16  CN-LINE OCCURS 10       PIC X(77).
   829
   830     12  CN-LAST-MAINT-DT            PIC XX.
   831     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   832     12  CN-LAST-MAINT-USER          PIC X(4).
   833     12  FILLER                      PIC X(6).
   834******************************************************************
   835*                                COPY ELCEOBC.
   836******************************************************************
   837*                                                                *
   838*                                                                *
   839*                            ELCEOBC                             *
   840*                            VMOD=2.001                          *
   841*                                                                *
   842*   CLAIM SYSTEM EOB CODE TABLE                                  *
   843*                                                                *
   844*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   845*   VSAM EOB CODE TABLE                                          *
   846*                                                                *
   847*   FILE DESCRIPTION = EOB CODE TABLE                            *
   848*                                                                *
   849*   FILE TYPE = VSAM,KSDS                                        *
   850*   RECORD SIZE = 350   RECFORM = FIX                            *
   851*                                                                *
   852*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
   853*                                                                *
   854*   LOG = NO                                                     *
   855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   856*                                                                *
   857*                                                                *
   858******************************************************************
   859*                   C H A N G E   L O G
   860*
   861* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   862*-----------------------------------------------------------------
   863*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   864* EFFECTIVE    NUMBER
   865*-----------------------------------------------------------------
   866* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
   867* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
   868******************************************************************
   869 01  EOB-CODES.
   870     12  EO-RECORD-ID                      PIC XX.
   871         88  VALID-DN-ID                      VALUE 'EO'.
   872     12  EO-CONTROL-PRIMARY.
   873         16  EO-COMPANY-CD                 PIC X.
   874         16  EO-RECORD-TYPE                PIC X.
   875             88  EO-EOB-RECS                  VALUE '1'.
   876             88  EO-VERIF-RECS                VALUE '2'.
   877             88  EO-GCE-RECS                  VALUE '3'.
   878         16  EO-EOB-CODE                   PIC X(4).
   879         16  FILLER                        PIC X(9).
   880     12  EO-MAINT-INFORMATION.
   881         16  EO-LAST-MAINT-DT              PIC XX.
   882         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   883         16  EO-LAST-MAINT-USER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  17
* NSAASBL.cbl
   884         16  FILLER                        PIC XX.
   885     12  EO-DESCRIPTION                    PIC X(275).
   886     12  FILLER                            PIC X(46).
   887******************************************************************
   888*                                COPY ELCCERT.
   889******************************************************************
   890*                                                                *
   891*                            ELCCERT.                            *
   892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   893*                            VMOD=2.013                          *
   894*                                                                *
   895*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   896*                                                                *
   897*   FILE TYPE = VSAM,KSDS                                        *
   898*   RECORD SIZE = 450  RECFORM = FIXED                           *
   899*                                                                *
   900*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   901*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   902*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   903*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   904*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   905*                                                                *
   906*   LOG = YES                                                    *
   907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   908******************************************************************
   909*                   C H A N G E   L O G
   910*
   911* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   912*-----------------------------------------------------------------
   913*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   914* EFFECTIVE    NUMBER
   915*-----------------------------------------------------------------
   916* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   917* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   918* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   919* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   920* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   921* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   922* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   923* 032612  CR2011110200001  PEMA  AHL CHANGES
   924******************************************************************
   925
   926 01  CERTIFICATE-MASTER.
   927     12  CM-RECORD-ID                      PIC XX.
   928         88  VALID-CM-ID                      VALUE 'CM'.
   929
   930     12  CM-CONTROL-PRIMARY.
   931         16  CM-COMPANY-CD                 PIC X.
   932         16  CM-CARRIER                    PIC X.
   933         16  CM-GROUPING.
   934             20  CM-GROUPING-PREFIX        PIC X(3).
   935             20  CM-GROUPING-PRIME         PIC X(3).
   936         16  CM-STATE                      PIC XX.
   937         16  CM-ACCOUNT.
   938             20  CM-ACCOUNT-PREFIX         PIC X(4).
   939             20  CM-ACCOUNT-PRIME          PIC X(6).
   940         16  CM-CERT-EFF-DT                PIC XX.
   941         16  CM-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  18
* NSAASBL.cbl
   942             20  CM-CERT-PRIME             PIC X(10).
   943             20  CM-CERT-SFX               PIC X.
   944
   945     12  CM-CONTROL-BY-NAME.
   946         16  CM-COMPANY-CD-A1              PIC X.
   947         16  CM-INSURED-LAST-NAME          PIC X(15).
   948         16  CM-INSURED-INITIALS.
   949             20  CM-INSURED-INITIAL1       PIC X.
   950             20  CM-INSURED-INITIAL2       PIC X.
   951
   952     12  CM-CONTROL-BY-SSN.
   953         16  CM-COMPANY-CD-A2              PIC X.
   954         16  CM-SOC-SEC-NO.
   955             20  CM-SSN-STATE              PIC XX.
   956             20  CM-SSN-ACCOUNT            PIC X(6).
   957             20  CM-SSN-LN3.
   958                 25  CM-INSURED-INITIALS-A2.
   959                     30 CM-INSURED-INITIAL1-A2   PIC X.
   960                     30 CM-INSURED-INITIAL2-A2   PIC X.
   961                 25 CM-PART-LAST-NAME-A2         PIC X.
   962
   963     12  CM-CONTROL-BY-CERT-NO.
   964         16  CM-COMPANY-CD-A4              PIC X.
   965         16  CM-CERT-NO-A4                 PIC X(11).
   966
   967     12  CM-CONTROL-BY-MEMB.
   968         16  CM-COMPANY-CD-A5              PIC X.
   969         16  CM-MEMBER-NO.
   970             20  CM-MEMB-STATE             PIC XX.
   971             20  CM-MEMB-ACCOUNT           PIC X(6).
   972             20  CM-MEMB-LN4.
   973                 25  CM-INSURED-INITIALS-A5.
   974                     30 CM-INSURED-INITIAL1-A5   PIC X.
   975                     30 CM-INSURED-INITIAL2-A5   PIC X.
   976                 25 CM-PART-LAST-NAME-A5         PIC XX.
   977
   978     12  CM-INSURED-PROFILE-DATA.
   979         16  CM-INSURED-FIRST-NAME.
   980             20  CM-INSURED-1ST-INIT       PIC X.
   981             20  FILLER                    PIC X(9).
   982         16  CM-INSURED-ISSUE-AGE          PIC 99.
   983         16  CM-INSURED-SEX                PIC X.
   984             88  CM-SEX-MALE                  VALUE 'M'.
   985             88  CM-SEX-FEMAL                 VALUE 'F'.
   986         16  CM-INSURED-JOINT-AGE          PIC 99.
   987         16  CM-JOINT-INSURED-NAME.
   988             20  CM-JT-LAST-NAME           PIC X(15).
   989             20  CM-JT-FIRST-NAME.
   990                 24  CM-JT-1ST-INIT        PIC X.
   991                 24  FILLER                PIC X(9).
   992             20  CM-JT-INITIAL             PIC X.
   993
   994     12  CM-LIFE-DATA.
   995         16  CM-LF-BENEFIT-CD              PIC XX.
   996         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   997         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   998         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   999         16  CM-LF-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  19
* NSAASBL.cbl
  1000         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1001         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1002         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1003         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1004         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1005         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1006         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1007         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1008         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1009         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1010         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1011         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1012         16  FILLER                        PIC XX.
  1013
  1014     12  CM-AH-DATA.
  1015         16  CM-AH-BENEFIT-CD              PIC XX.
  1016         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1017         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1018         16  CM-AH-DEV-CODE                PIC XXX.
  1019         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1020         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1021         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1022         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1023         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1024         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1025         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1026         16  CM-AH-PAID-THRU-DT            PIC XX.
  1027             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1028         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1029         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1030         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1031         16  FILLER                        PIC X.
  1032
  1033     12  CM-LOAN-INFORMATION.
  1034         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1035         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1036                                           PIC S9(5)V99  COMP-3.
  1037         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1038         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1039         16  CM-PAY-FREQUENCY              PIC S99.
  1040         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1041         16  CM-RATE-CLASS                 PIC XX.
  1042         16  CM-BENEFICIARY                PIC X(25).
  1043         16  CM-POLICY-FORM-NO             PIC X(12).
  1044         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1045         16  CM-LAST-ADD-ON-DT             PIC XX.
  1046         16  CM-DEDUCTIBLE-AMOUNTS.
  1047             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1048             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1049         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1050             20  CM-RESIDENT-STATE         PIC XX.
  1051             20  CM-RATE-CODE              PIC X(4).
  1052             20  FILLER                    PIC XX.
  1053         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1054             20  CM-LOAN-OFFICER           PIC X(5).
  1055             20  FILLER                    PIC XXX.
  1056         16  CM-CSR-CODE                   PIC XXX.
  1057         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  20
* NSAASBL.cbl
  1058             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1059         16  CM-POST-CARD-IND              PIC X.
  1060         16  CM-NH-INTERFACE-SW            PIC X.
  1061         16  CM-PREMIUM-TYPE               PIC X.
  1062             88  CM-SING-PRM                  VALUE '1'.
  1063             88  CM-O-B-COVERAGE              VALUE '2'.
  1064             88  CM-OPEN-END                  VALUE '3'.
  1065         16  CM-IND-GRP-TYPE               PIC X.
  1066             88  CM-INDIVIDUAL                VALUE 'I'.
  1067             88  CM-GROUP                     VALUE 'G'.
  1068         16  CM-SKIP-CODE                  PIC X.
  1069             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1070             88  SKIP-JULY                    VALUE '1'.
  1071             88  SKIP-AUGUST                  VALUE '2'.
  1072             88  SKIP-SEPTEMBER               VALUE '3'.
  1073             88  SKIP-JULY-AUG                VALUE '4'.
  1074             88  SKIP-AUG-SEPT                VALUE '5'.
  1075             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1076             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1077             88  SKIP-JUNE                    VALUE '8'.
  1078             88  SKIP-JUNE-JULY               VALUE '9'.
  1079             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1080             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1081         16  CM-PAYMENT-MODE               PIC X.
  1082             88  PAY-MONTHLY                  VALUE SPACE.
  1083             88  PAY-WEEKLY                   VALUE '1'.
  1084             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1085             88  PAY-BI-WEEKLY                VALUE '3'.
  1086             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1087         16  CM-LOAN-NUMBER                PIC X(8).
  1088         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1089         16  CM-OLD-LOF                    PIC XXX.
  1090*        16  CM-LOAN-OFFICER               PIC XXX.
  1091         16  CM-REIN-TABLE                 PIC XXX.
  1092         16  CM-SPECIAL-REIN-CODE          PIC X.
  1093         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1094         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1095         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1096
  1097     12  CM-STATUS-DATA.
  1098         16  CM-ENTRY-STATUS               PIC X.
  1099         16  CM-ENTRY-DT                   PIC XX.
  1100
  1101         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1102         16  CM-LF-CANCEL-DT               PIC XX.
  1103         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1104
  1105         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1106         16  CM-LF-DEATH-DT                PIC XX.
  1107         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1108
  1109         16  CM-LF-CURRENT-STATUS          PIC X.
  1110             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1111                                                'M' '4' '5' '9'.
  1112             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1113             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1114             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1115             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  21
* NSAASBL.cbl
  1116             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1117             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1118             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1119             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1120             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1121             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1122             88  CM-LF-DECLINED               VALUE 'D'.
  1123             88  CM-LF-VOIDED                 VALUE 'V'.
  1124
  1125         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1126         16  CM-AH-CANCEL-DT               PIC XX.
  1127         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1128
  1129         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1130         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1131         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1132
  1133         16  CM-AH-CURRENT-STATUS          PIC X.
  1134             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1135                                                'M' '4' '5' '9'.
  1136             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1137             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1138             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1139             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1140             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1141             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1142             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1143             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1144             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1145             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1146             88  CM-AH-DECLINED               VALUE 'D'.
  1147             88  CM-AH-VOIDED                 VALUE 'V'.
  1148
  1149         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1150             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1151             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1152             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1153         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1154
  1155         16  CM-ENTRY-BATCH                PIC X(6).
  1156         16  CM-LF-EXIT-BATCH              PIC X(6).
  1157         16  CM-AH-EXIT-BATCH              PIC X(6).
  1158         16  CM-LAST-MONTH-END             PIC XX.
  1159
  1160     12  CM-NOTE-SW                        PIC X.
  1161         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1162         88  CERT-NOTES-PRESENT               VALUE '1'.
  1163         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1164         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1165         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1166         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1167         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1168         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1169     12  CM-COMP-EXCP-SW                   PIC X.
  1170         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1171         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1172     12  CM-INSURED-ADDRESS-SW             PIC X.
  1173         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  22
* NSAASBL.cbl
  1174         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1175
  1176*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1177     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1178     12  FILLER                            PIC X.
  1179
  1180*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1181     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1182     12  FILLER                            PIC X.
  1183*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1184     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1185
  1186     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1187         88  CERT-ADDED-BATCH                 VALUE ' '.
  1188         88  CERT-ADDED-ONLINE                VALUE '1'.
  1189         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1190         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1191         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1192     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1193         88  CERT-AS-LOADED                   VALUE ' '.
  1194         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1195         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1196         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1197         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1198         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1199         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1200         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1201
  1202     12  CM-ACCOUNT-COMM-PCTS.
  1203         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1204         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1205
  1206     12  CM-USER-FIELD                     PIC X.
  1207     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1208     12  CM-CLP-STATE                      PIC XX.
  1209     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1210     12  CM-USER-RESERVED                  PIC XXX.
  1211     12  FILLER REDEFINES CM-USER-RESERVED.
  1212         16  CM-AH-CLASS-CD                PIC XX.
  1213         16  F                             PIC X.
  1214******************************************************************
  1215****************************************************************
  1216*
  1217* Copyright (c) 2007 by Clerity Solutions, Inc.
  1218* All rights reserved.
  1219*
  1220****************************************************************
  1221 01  DFHEIV.
  1222   02  DFHEIV0               PIC X(35).
  1223   02  DFHEIV1               PIC X(08).
  1224   02  DFHEIV2               PIC X(08).
  1225   02  DFHEIV3               PIC X(08).
  1226   02  DFHEIV4               PIC X(06).
  1227   02  DFHEIV5               PIC X(04).
  1228   02  DFHEIV6               PIC X(04).
  1229   02  DFHEIV7               PIC X(02).
  1230   02  DFHEIV8               PIC X(02).
  1231   02  DFHEIV9               PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  23
* NSAASBL.cbl
  1232   02  DFHEIV10              PIC S9(7) COMP-3.
  1233   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1234   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1235   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1236   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1237   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1238   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1239   02  DFHEIV17              PIC X(04).
  1240   02  DFHEIV18              PIC X(04).
  1241   02  DFHEIV19              PIC X(04).
  1242   02  DFHEIV20              USAGE IS POINTER.
  1243   02  DFHEIV21              USAGE IS POINTER.
  1244   02  DFHEIV22              USAGE IS POINTER.
  1245   02  DFHEIV23              USAGE IS POINTER.
  1246   02  DFHEIV24              USAGE IS POINTER.
  1247   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1248   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1249   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1250   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1251   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1252   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1253   02  FILLER                PIC X(02).
  1254   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1255   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1256   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1257   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1258   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1259 LINKAGE  SECTION.
  1260*****************************************************************
  1261*                                                               *
  1262* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1263* All rights reserved.                                          *
  1264*                                                               *
  1265*****************************************************************
  1266 01  dfheiblk.
  1267     02  eibtime          pic s9(7) comp-3.
  1268     02  eibdate          pic s9(7) comp-3.
  1269     02  eibtrnid         pic x(4).
  1270     02  eibtaskn         pic s9(7) comp-3.
  1271     02  eibtrmid         pic x(4).
  1272     02  dfheigdi         pic s9(4) comp.
  1273     02  eibcposn         pic s9(4) comp.
  1274     02  eibcalen         pic s9(4) comp.
  1275     02  eibaid           pic x(1).
  1276     02  eibfiller1       pic x(1).
  1277     02  eibfn            pic x(2).
  1278     02  eibfiller2       pic x(2).
  1279     02  eibrcode         pic x(6).
  1280     02  eibfiller3       pic x(2).
  1281     02  eibds            pic x(8).
  1282     02  eibreqid         pic x(8).
  1283     02  eibrsrce         pic x(8).
  1284     02  eibsync          pic x(1).
  1285     02  eibfree          pic x(1).
  1286     02  eibrecv          pic x(1).
  1287     02  eibsend          pic x(1).
  1288     02  eibatt           pic x(1).
  1289     02  eibeoc           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  24
* NSAASBL.cbl
  1290     02  eibfmh           pic x(1).
  1291     02  eibcompl         pic x(1).
  1292     02  eibsig           pic x(1).
  1293     02  eibconf          pic x(1).
  1294     02  eiberr           pic x(1).
  1295     02  eibrldbk         pic x(1).
  1296     02  eiberrcd         pic x(4).
  1297     02  eibsynrb         pic x(1).
  1298     02  eibnodat         pic x(1).
  1299     02  eibfiller5       pic x(2).
  1300     02  eibresp          pic 9(09) comp.
  1301     02  eibresp2         pic 9(09) comp.
  1302     02  dfheigdj         pic s9(4) comp.
  1303     02  dfheigdk         pic s9(4) comp.
  1304 01 dfhcommarea                  pic x(218).
  1305 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1306 0000-DFHEXIT SECTION.
  1307     MOVE '9#                    $   ' TO DFHEIV0.
  1308     MOVE 'NSAASBL' TO DFHEIV1.
  1309     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1310     display ' entering nsaasbl '
  1311     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1312     MOVE '5'                    TO DC-OPTION-CODE
  1313     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1314     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  1315     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  1316     MOVE DFHCOMMAREA            TO BL-INPUT
  1317*****************************************************
  1318* Using the information passed to this program,
  1319* it will update the erarch record with a "Q"
  1320* in the status field
  1321*****************************************************
  1322*    DISPLAY ' BL INPUT ' BL-INPUT
  1323     IF BL-COMP-ID = 'DCC'
  1324        MOVE X'05'               TO WS-ERARCH-COMPANY-CD
  1325     ELSE
  1326        IF BL-COMP-ID = 'AHL'
  1327           MOVE X'06'               TO WS-ERARCH-COMPANY-CD
  1328        ELSE
  1329           MOVE X'04'               TO WS-ERARCH-COMPANY-CD
  1330        END-IF
  1331     END-IF
  1332     MOVE WS-ERARCH-COMPANY-CD   TO WS-ERENDT-COMPANY-CD
  1333                                    WS-EXTR-COMPANY-CD
  1334     MOVE BL-ARCHIVE-NO          TO WS-ERARCH-ARCH-NO
  1335                                    WS-ERENDT-ARCH-NO
  1336                                    WS-EXTR-ARCH-NO
  1337     SET BL-FAIL TO TRUE
  1338
  1339* EXEC CICS READ
  1340*         DATASET    ('ERARCH')
  1341*         INTO       (LETTER-ARCHIVE)
  1342*         RIDFLD     (WS-ERARCH-KEY)
  1343*         UPDATE
  1344*         RESP       (WS-RESPONSE)
  1345*    END-EXEC
  1346     MOVE LENGTH OF
  1347      LETTER-ARCHIVE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  25
* NSAASBL.cbl
  1348       TO DFHEIV11
  1349     MOVE 'ERARCH' TO DFHEIV1
  1350*    MOVE '&"IL       EU         (  N#00001334' TO DFHEIV0
  1351     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1352     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1353     MOVE X'204E233030303031333334' TO DFHEIV0(25:11)
  1354     CALL 'kxdfhei1' USING DFHEIV0,
  1355           DFHEIV1,
  1356           LETTER-ARCHIVE,
  1357           DFHEIV11,
  1358           WS-ERARCH-KEY,
  1359           DFHEIV99,
  1360           DFHEIV99,
  1361           DFHEIV99
  1362     MOVE EIBRESP  TO WS-RESPONSE
  1363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1364     IF RESP-NORMAL
  1365        SET BL-OK TO TRUE
  1366        IF (BL-PRINT-NOW-SW = 'P')
  1367           or (bl-process-type = 'cancel')
  1368           PERFORM 0050-DELETE-RECORDS
  1369                                 THRU 0050-EXIT
  1370        ELSE
  1371           IF BL-PROCESS-TYPE = 'process'
  1372              MOVE LA-COMPANY-CD-A2 TO WS-SV-COMPANY-CD
  1373              MOVE LA-CARRIER-A2    TO WS-SV-CARRIER
  1374              MOVE LA-GROUPING-A2   TO WS-SV-GROUPING
  1375              MOVE LA-STATE-A2      TO WS-SV-STATE
  1376              MOVE LA-ACCOUNT-A2    TO WS-SV-ACCOUNT
  1377              MOVE LA-EFFECT-DATE-A2 TO WS-SV-CERT-EFF-DT
  1378              MOVE LA-CERT-PRIME-A2 TO WS-SV-CERT-PRIME
  1379              MOVE LA-CERT-SUFFIX-A2 TO WS-SV-CERT-SFX
  1380              MOVE LA-FORM-A3       TO WS-SV-LETTER-ID
  1381              MOVE LA-PROCESSOR-CD  TO WS-SV-PROC-ID
  1382              MOVE 'Q'           TO LA-ARCHIVE-STATUS
  1383              IF BL-PRINT-NOW-SW = 'Y'
  1384                 MOVE SAVE-BIN-DATE TO LA-INITIAL-PRINT-DATE
  1385                 IF (LA-RESEND-DATE EQUAL LOW-VALUES OR SPACES)
  1386                  AND (LA-FOLLOW-UP-DATE EQUAL
  1387                                 LOW-VALUES OR SPACES)
  1388                    MOVE 'C'             TO LA-STATUS
  1389                 END-IF
  1390              END-IF
  1391           ELSE
  1392              MOVE 'T'           TO LA-ARCHIVE-STATUS
  1393           END-IF
  1394        END-IF
  1395
  1396* EXEC CICS REWRITE
  1397*          FROM      (LETTER-ARCHIVE)
  1398*          DATASET   ('ERARCH')
  1399*          RESP       (WS-RESPONSE)
  1400*       END-EXEC
  1401     MOVE LENGTH OF
  1402      LETTER-ARCHIVE
  1403       TO DFHEIV11
  1404     MOVE 'ERARCH' TO DFHEIV1
  1405*    MOVE '&& L                  %  N#00001372' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  26
* NSAASBL.cbl
  1406     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1407     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1408     MOVE X'204E233030303031333732' TO DFHEIV0(25:11)
  1409     CALL 'kxdfhei1' USING DFHEIV0,
  1410           DFHEIV1,
  1411           LETTER-ARCHIVE,
  1412           DFHEIV11,
  1413           DFHEIV99
  1414     MOVE EIBRESP  TO WS-RESPONSE
  1415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1416        IF BL-PROCESS-TYPE = 'process'
  1417           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  1418        END-IF
  1419     ELSE
  1420        MOVE ' BAD READ UPDATE ON ERARCH '
  1421                                 TO BL-MESSAGE
  1422        display ' bad read on erarch ' ws-response
  1423          ' ' bl-archive-no
  1424     END-IF
  1425     MOVE BL-INPUT               TO DFHCOMMAREA
  1426
  1427* exec cics return end-exec.
  1428*    MOVE '.(                    ''   #00001387' TO DFHEIV0
  1429     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1430     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1431     MOVE X'2020233030303031333837' TO DFHEIV0(25:11)
  1432     CALL 'kxdfhei1' USING DFHEIV0,
  1433           DFHEIV99,
  1434           DFHEIV99,
  1435           DFHEIV99,
  1436           DFHEIV99,
  1437           DFHEIV99,
  1438           DFHEIV99
  1439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1440
  1441 0050-DELETE-RECORDS.
  1442     DISPLAY ' ABOUT TO DELETE RECS ' BL-ARCHIVE-NO ' ' BL-FUNC
  1443     IF BL-FUNC = 'ClmResc' or 'ClmRefo'
  1444        display ' bypass delete ' bl-func
  1445        go to 0050-exit
  1446     end-if
  1447
  1448* EXEC CICS DELETE
  1449*       DATASET    ('ERARCH')
  1450*       RESP       (WS-RESPONSE)
  1451*    END-EXEC
  1452     MOVE 'ERARCH' TO DFHEIV1
  1453*    MOVE '&(                    &  N#00001394' TO DFHEIV0
  1454     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1455     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1456     MOVE X'204E233030303031333934' TO DFHEIV0(25:11)
  1457     CALL 'kxdfhei1' USING DFHEIV0,
  1458           DFHEIV1,
  1459           DFHEIV99,
  1460           DFHEIV99,
  1461           DFHEIV99,
  1462           DFHEIV99
  1463     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  27
* NSAASBL.cbl
  1464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1465     IF NOT RESP-NORMAL
  1466        DISPLAY ' BAD DELETE ERARCH ' WS-RESPONSE
  1467        GO TO 0050-EXIT
  1468     END-IF
  1469
  1470* EXEC CICS READ
  1471*         DATASET    ('ERENDT2')
  1472*         INTO       (ENDORSEMENT-RECORD)
  1473*         RIDFLD     (WS-ERENDT2-KEY)
  1474*         UPDATE
  1475*         RESP       (WS-RESPONSE)
  1476*    END-EXEC
  1477     MOVE LENGTH OF
  1478      ENDORSEMENT-RECORD
  1479       TO DFHEIV11
  1480     MOVE 'ERENDT2' TO DFHEIV1
  1481*    MOVE '&"IL       EU         (  N#00001402' TO DFHEIV0
  1482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1484     MOVE X'204E233030303031343032' TO DFHEIV0(25:11)
  1485     CALL 'kxdfhei1' USING DFHEIV0,
  1486           DFHEIV1,
  1487           ENDORSEMENT-RECORD,
  1488           DFHEIV11,
  1489           WS-ERENDT2-KEY,
  1490           DFHEIV99,
  1491           DFHEIV99,
  1492           DFHEIV99
  1493     MOVE EIBRESP  TO WS-RESPONSE
  1494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1495     IF NOT RESP-NORMAL
  1496        DISPLAY ' BAD READ ON ERENDT2 ' WS-RESPONSE
  1497     ELSE
  1498
  1499* EXEC CICS DELETE
  1500*          DATASET    ('ERENDT2')
  1501*          RESP       (WS-RESPONSE)
  1502*       END-EXEC
  1503     MOVE 'ERENDT2' TO DFHEIV1
  1504*    MOVE '&(                    &  N#00001412' TO DFHEIV0
  1505     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1507     MOVE X'204E233030303031343132' TO DFHEIV0(25:11)
  1508     CALL 'kxdfhei1' USING DFHEIV0,
  1509           DFHEIV1,
  1510           DFHEIV99,
  1511           DFHEIV99,
  1512           DFHEIV99,
  1513           DFHEIV99
  1514     MOVE EIBRESP  TO WS-RESPONSE
  1515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1516        IF NOT RESP-NORMAL
  1517           DISPLAY ' BAD DELETE ON ERENDT2 ' WS-RESPONSE
  1518        END-IF
  1519     END-IF
  1520     MOVE 0                      TO WS-EXTR-SEQ-NO
  1521
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  28
* NSAASBL.cbl
  1522* EXEC CICS READ
  1523*         DATASET    ('NSASEXTR')
  1524*         INTO       (NSAS-EXTRACT-RECORD)
  1525*         RIDFLD     (WS-NSASEXTR-KEY)
  1526*         UPDATE
  1527*         RESP       (WS-RESPONSE)
  1528*    END-EXEC
  1529     MOVE LENGTH OF
  1530      NSAS-EXTRACT-RECORD
  1531       TO DFHEIV11
  1532     MOVE 'NSASEXTR' TO DFHEIV1
  1533*    MOVE '&"IL       EU         (  N#00001421' TO DFHEIV0
  1534     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1535     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1536     MOVE X'204E233030303031343231' TO DFHEIV0(25:11)
  1537     CALL 'kxdfhei1' USING DFHEIV0,
  1538           DFHEIV1,
  1539           NSAS-EXTRACT-RECORD,
  1540           DFHEIV11,
  1541           WS-NSASEXTR-KEY,
  1542           DFHEIV99,
  1543           DFHEIV99,
  1544           DFHEIV99
  1545     MOVE EIBRESP  TO WS-RESPONSE
  1546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1547     IF NOT RESP-NORMAL
  1548        DISPLAY ' BAD READ ON 0 NSASEXTR ' WS-RESPONSE
  1549        GO TO 0050-EXIT
  1550     ELSE
  1551
  1552* EXEC CICS DELETE
  1553*          DATASET    ('NSASEXTR')
  1554*          RESP       (WS-RESPONSE)
  1555*       END-EXEC
  1556     MOVE 'NSASEXTR' TO DFHEIV1
  1557*    MOVE '&(                    &  N#00001432' TO DFHEIV0
  1558     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1560     MOVE X'204E233030303031343332' TO DFHEIV0(25:11)
  1561     CALL 'kxdfhei1' USING DFHEIV0,
  1562           DFHEIV1,
  1563           DFHEIV99,
  1564           DFHEIV99,
  1565           DFHEIV99,
  1566           DFHEIV99
  1567     MOVE EIBRESP  TO WS-RESPONSE
  1568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1569        IF NOT RESP-NORMAL
  1570           DISPLAY ' BAD DELETE ON 0 NSASEXTR ' WS-RESPONSE
  1571           GO TO 0050-EXIT
  1572        END-IF
  1573     END-IF
  1574     MOVE 1                      TO WS-EXTR-SEQ-NO
  1575
  1576* EXEC CICS READ
  1577*         DATASET    ('NSASEXTR')
  1578*         INTO       (NSAS-EXTRACT-RECORD)
  1579*         RIDFLD     (WS-NSASEXTR-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  29
* NSAASBL.cbl
  1580*         UPDATE
  1581*         RESP       (WS-RESPONSE)
  1582*    END-EXEC
  1583     MOVE LENGTH OF
  1584      NSAS-EXTRACT-RECORD
  1585       TO DFHEIV11
  1586     MOVE 'NSASEXTR' TO DFHEIV1
  1587*    MOVE '&"IL       EU         (  N#00001442' TO DFHEIV0
  1588     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1589     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1590     MOVE X'204E233030303031343432' TO DFHEIV0(25:11)
  1591     CALL 'kxdfhei1' USING DFHEIV0,
  1592           DFHEIV1,
  1593           NSAS-EXTRACT-RECORD,
  1594           DFHEIV11,
  1595           WS-NSASEXTR-KEY,
  1596           DFHEIV99,
  1597           DFHEIV99,
  1598           DFHEIV99
  1599     MOVE EIBRESP  TO WS-RESPONSE
  1600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1601     IF NOT RESP-NORMAL
  1602        DISPLAY ' BAD READ ON 1 NSASEXTR ' WS-RESPONSE
  1603     ELSE
  1604
  1605* EXEC CICS DELETE
  1606*          DATASET    ('NSASEXTR')
  1607*          RESP       (WS-RESPONSE)
  1608*       END-EXEC
  1609     MOVE 'NSASEXTR' TO DFHEIV1
  1610*    MOVE '&(                    &  N#00001452' TO DFHEIV0
  1611     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1613     MOVE X'204E233030303031343532' TO DFHEIV0(25:11)
  1614     CALL 'kxdfhei1' USING DFHEIV0,
  1615           DFHEIV1,
  1616           DFHEIV99,
  1617           DFHEIV99,
  1618           DFHEIV99,
  1619           DFHEIV99
  1620     MOVE EIBRESP  TO WS-RESPONSE
  1621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1622        IF NOT RESP-NORMAL
  1623           DISPLAY ' BAD DELETE ON 1 NSASEXTR ' WS-RESPONSE
  1624        END-IF
  1625     END-IF
  1626     MOVE 2                      TO WS-EXTR-SEQ-NO
  1627
  1628* EXEC CICS READ
  1629*         DATASET    ('NSASEXTR')
  1630*         INTO       (NSAS-EXTRACT-RECORD)
  1631*         RIDFLD     (WS-NSASEXTR-KEY)
  1632*         UPDATE
  1633*         RESP       (WS-RESPONSE)
  1634*    END-EXEC
  1635     MOVE LENGTH OF
  1636      NSAS-EXTRACT-RECORD
  1637       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  30
* NSAASBL.cbl
  1638     MOVE 'NSASEXTR' TO DFHEIV1
  1639*    MOVE '&"IL       EU         (  N#00001461' TO DFHEIV0
  1640     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1641     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1642     MOVE X'204E233030303031343631' TO DFHEIV0(25:11)
  1643     CALL 'kxdfhei1' USING DFHEIV0,
  1644           DFHEIV1,
  1645           NSAS-EXTRACT-RECORD,
  1646           DFHEIV11,
  1647           WS-NSASEXTR-KEY,
  1648           DFHEIV99,
  1649           DFHEIV99,
  1650           DFHEIV99
  1651     MOVE EIBRESP  TO WS-RESPONSE
  1652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1653     IF NOT RESP-NORMAL
  1654        DISPLAY ' BAD READ ON 2 NSASEXTR ' WS-RESPONSE
  1655     ELSE
  1656
  1657* EXEC CICS DELETE
  1658*          DATASET    ('NSASEXTR')
  1659*          RESP       (WS-RESPONSE)
  1660*       END-EXEC
  1661     MOVE 'NSASEXTR' TO DFHEIV1
  1662*    MOVE '&(                    &  N#00001471' TO DFHEIV0
  1663     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1664     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1665     MOVE X'204E233030303031343731' TO DFHEIV0(25:11)
  1666     CALL 'kxdfhei1' USING DFHEIV0,
  1667           DFHEIV1,
  1668           DFHEIV99,
  1669           DFHEIV99,
  1670           DFHEIV99,
  1671           DFHEIV99
  1672     MOVE EIBRESP  TO WS-RESPONSE
  1673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1674        IF NOT RESP-NORMAL
  1675           DISPLAY ' BAD DELETE ON 2 NSASEXTR ' WS-RESPONSE
  1676        END-IF
  1677     END-IF
  1678     .
  1679 0050-EXIT.
  1680     EXIT.
  1681
  1682
  1683 0440-ADD-BILLING-NOTE.
  1684
  1685     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  1686     MOVE WS-ERARCH-COMPANY-CD   TO WS-EOBC-COMPANY-CD
  1687     MOVE '5'                    TO WS-EOBC-REC-TYPE
  1688
  1689
  1690* EXEC CICS STARTBR
  1691*        DATASET   ('ELEOBC')
  1692*        RIDFLD    (WS-ELEOBC-KEY)
  1693*        GTEQ
  1694*        RESP      (WS-RESPONSE)
  1695*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  31
* NSAASBL.cbl
  1696     MOVE 'ELEOBC' TO DFHEIV1
  1697     MOVE 0
  1698       TO DFHEIV11
  1699*    MOVE '&,         G          &  N#00001490' TO DFHEIV0
  1700     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1702     MOVE X'204E233030303031343930' TO DFHEIV0(25:11)
  1703     CALL 'kxdfhei1' USING DFHEIV0,
  1704           DFHEIV1,
  1705           WS-ELEOBC-KEY,
  1706           DFHEIV99,
  1707           DFHEIV11,
  1708           DFHEIV99
  1709     MOVE EIBRESP  TO WS-RESPONSE
  1710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1711
  1712     IF NOT RESP-NORMAL
  1713        GO TO 0440-EXIT
  1714     END-IF
  1715      .
  1716 0440-READNEXT-ELEOBC.
  1717
  1718
  1719* EXEC CICS READNEXT
  1720*       INTO    (EOB-CODES)
  1721*       DATASET ('ELEOBC')
  1722*       RIDFLD  (WS-ELEOBC-KEY)
  1723*       RESP    (WS-RESPONSE)
  1724*    END-EXEC
  1725     MOVE LENGTH OF
  1726      EOB-CODES
  1727       TO DFHEIV12
  1728     MOVE 'ELEOBC' TO DFHEIV1
  1729     MOVE 0
  1730       TO DFHEIV11
  1731*    MOVE '&.IL                  )  N#00001503' TO DFHEIV0
  1732     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1733     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1734     MOVE X'204E233030303031353033' TO DFHEIV0(25:11)
  1735     CALL 'kxdfhei1' USING DFHEIV0,
  1736           DFHEIV1,
  1737           EOB-CODES,
  1738           DFHEIV12,
  1739           WS-ELEOBC-KEY,
  1740           DFHEIV99,
  1741           DFHEIV11,
  1742           DFHEIV99,
  1743           DFHEIV99
  1744     MOVE EIBRESP  TO WS-RESPONSE
  1745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1746
  1747     IF RESP-NORMAL
  1748         IF EO-RECORD-TYPE NOT = '5'
  1749             GO TO 0440-EXIT
  1750         END-IF
  1751     ELSE
  1752         GO TO 0440-EXIT
  1753     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  32
* NSAASBL.cbl
  1754
  1755     IF EO-RECORD-TYPE = '5' AND
  1756        EO-EOB-CODE = WS-SV-LETTER-ID
  1757           CONTINUE
  1758     ELSE
  1759         GO TO 0440-READNEXT-ELEOBC
  1760     END-IF
  1761
  1762     MOVE SPACES         TO WS-BILLING-NOTE
  1763     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  1764     MOVE WS-SV-LETTER-ID TO WS-BN-LTRID
  1765     MOVE SAVE-DATE      TO WS-BN-DATE
  1766     MOVE WS-SV-PROC-ID  TO WS-BN-USERID
  1767     MOVE +25            TO WS-LEN
  1768
  1769     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  1770     .
  1771 0440-EXIT.
  1772     EXIT.
  1773
  1774 0441-UPDATE-BILLING-NOTE.
  1775
  1776     MOVE WS-SAVE-KEY TO WS-ERNOTE-KEY
  1777
  1778
  1779* EXEC CICS READ
  1780*       DATASET    ('ERNOTE')
  1781*       RIDFLD     (WS-ERNOTE-KEY)
  1782*       INTO       (CERTIFICATE-NOTE)
  1783*       RESP       (WS-RESPONSE)
  1784*       UPDATE
  1785*    END-EXEC
  1786     MOVE LENGTH OF
  1787      CERTIFICATE-NOTE
  1788       TO DFHEIV11
  1789     MOVE 'ERNOTE' TO DFHEIV1
  1790*    MOVE '&"IL       EU         (  N#00001541' TO DFHEIV0
  1791     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1792     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1793     MOVE X'204E233030303031353431' TO DFHEIV0(25:11)
  1794     CALL 'kxdfhei1' USING DFHEIV0,
  1795           DFHEIV1,
  1796           CERTIFICATE-NOTE,
  1797           DFHEIV11,
  1798           WS-ERNOTE-KEY,
  1799           DFHEIV99,
  1800           DFHEIV99,
  1801           DFHEIV99
  1802     MOVE EIBRESP  TO WS-RESPONSE
  1803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1804
  1805     IF RESP-NORMAL
  1806       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  1807          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  1808       END-IF
  1809       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  1810          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  1811       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  33
* NSAASBL.cbl
  1812       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  1813           (NOTE-SUB > +10) OR
  1814           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  1815                             WS-BILLING-NOTE (1:WS-LEN))
  1816       END-PERFORM
  1817       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  1818                              WS-BILLING-NOTE (1:WS-LEN)
  1819
  1820* EXEC CICS UNLOCK
  1821*           DATASET    ('ERNOTE')
  1822*        END-EXEC
  1823     MOVE 'ERNOTE' TO DFHEIV1
  1824*    MOVE '&*                    #   #00001563' TO DFHEIV0
  1825     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1826     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1827     MOVE X'2020233030303031353633' TO DFHEIV0(25:11)
  1828     CALL 'kxdfhei1' USING DFHEIV0,
  1829           DFHEIV1,
  1830           DFHEIV99
  1831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1832       ELSE
  1833         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  1834           (NOTE-SUB > +10) OR
  1835           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  1836         END-PERFORM
  1837         IF (NOTE-SUB < +11)
  1838           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  1839              NOTE-SUB <= CN-BILLING-END-LINE-NO
  1840                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  1841           ELSE
  1842             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  1843              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  1844                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  1845                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  1846             ELSE
  1847               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  1848                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  1849                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  1850                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  1851               ELSE
  1852                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  1853                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  1854                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  1855                                       CN-BILLING-START-LINE-NO
  1856                 ELSE
  1857                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  1858                 END-IF
  1859               END-IF
  1860             END-IF
  1861           END-IF
  1862           MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  1863           MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  1864           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  1865
  1866* EXEC CICS REWRITE
  1867*             DATASET    ('ERNOTE')
  1868*             FROM       (CERTIFICATE-NOTE)
  1869*             RESP       (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  34
* NSAASBL.cbl
  1870*          END-EXEC
  1871     MOVE LENGTH OF
  1872      CERTIFICATE-NOTE
  1873       TO DFHEIV11
  1874     MOVE 'ERNOTE' TO DFHEIV1
  1875*    MOVE '&& L                  %  N#00001599' TO DFHEIV0
  1876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1878     MOVE X'204E233030303031353939' TO DFHEIV0(25:11)
  1879     CALL 'kxdfhei1' USING DFHEIV0,
  1880           DFHEIV1,
  1881           CERTIFICATE-NOTE,
  1882           DFHEIV11,
  1883           DFHEIV99
  1884     MOVE EIBRESP  TO WS-RESPONSE
  1885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1886           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  1887         END-IF
  1888       END-IF
  1889     ELSE
  1890        MOVE SPACES              TO CERTIFICATE-NOTE
  1891        MOVE 'CN'                TO CN-RECORD-ID
  1892        MOVE WS-SAVE-KEY         TO CN-CONTROL-PRIMARY
  1893                                    WS-ERNOTE-KEY
  1894        MOVE 01                  TO CN-BILLING-START-LINE-NO
  1895                                    CN-BILLING-END-LINE-NO
  1896        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  1897        MOVE WS-SV-PROC-ID       TO CN-LAST-MAINT-USER
  1898        MOVE SAVE-BIN-DATE       TO CN-LAST-MAINT-DT
  1899        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  1900
  1901* EXEC CICS WRITE
  1902*          DATASET    ('ERNOTE')
  1903*          FROM       (CERTIFICATE-NOTE)
  1904*          RIDFLD     (WS-ERNOTE-KEY)
  1905*          RESP       (WS-RESPONSE)
  1906*       END-EXEC
  1907     MOVE LENGTH OF
  1908      CERTIFICATE-NOTE
  1909       TO DFHEIV11
  1910     MOVE 'ERNOTE' TO DFHEIV1
  1911*    MOVE '&$ L                  ''  N#00001618' TO DFHEIV0
  1912     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1914     MOVE X'204E233030303031363138' TO DFHEIV0(25:11)
  1915     CALL 'kxdfhei1' USING DFHEIV0,
  1916           DFHEIV1,
  1917           CERTIFICATE-NOTE,
  1918           DFHEIV11,
  1919           WS-ERNOTE-KEY,
  1920           DFHEIV99,
  1921           DFHEIV99
  1922     MOVE EIBRESP  TO WS-RESPONSE
  1923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1924
  1925        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  1926     END-IF
  1927
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  35
* NSAASBL.cbl
  1928     .
  1929 0441-EXIT.
  1930     EXIT.
  1931
  1932
  1933 0442-SQUEEZE-IT-IN.
  1934
  1935     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  1936        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  1937           NOTE-SUB = +10
  1938           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  1939           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  1940             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  1941             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  1942             MOVE +9 TO NOTE-SUB
  1943           END-IF
  1944        END-PERFORM
  1945     ELSE
  1946        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  1947           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  1948             UNTIL NOTE-SUB = +1
  1949             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  1950             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  1951                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  1952                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  1953                MOVE +2          TO NOTE-SUB
  1954             END-IF
  1955           END-PERFORM
  1956        END-IF
  1957     END-IF
  1958
  1959     .
  1960 0442-EXIT.
  1961     EXIT.
  1962
  1963 0445-CERTIFICATE-UPDATE.
  1964
  1965     MOVE WS-SAVE-KEY     TO WS-ELCERT-KEY
  1966
  1967* EXEC CICS READ
  1968*        DATASET  ('ELCERT')
  1969*        RIDFLD   (WS-ELCERT-KEY)
  1970*        INTO     (CERTIFICATE-MASTER)
  1971*        RESP     (WS-RESPONSE)
  1972*        UPDATE
  1973*    END-EXEC
  1974     MOVE LENGTH OF
  1975      CERTIFICATE-MASTER
  1976       TO DFHEIV11
  1977     MOVE 'ELCERT' TO DFHEIV1
  1978*    MOVE '&"IL       EU         (  N#00001666' TO DFHEIV0
  1979     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1980     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1981     MOVE X'204E233030303031363636' TO DFHEIV0(25:11)
  1982     CALL 'kxdfhei1' USING DFHEIV0,
  1983           DFHEIV1,
  1984           CERTIFICATE-MASTER,
  1985           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  36
* NSAASBL.cbl
  1986           WS-ELCERT-KEY,
  1987           DFHEIV99,
  1988           DFHEIV99,
  1989           DFHEIV99
  1990     MOVE EIBRESP  TO WS-RESPONSE
  1991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1992
  1993     IF RESP-NORMAL
  1994        EVALUATE CM-NOTE-SW
  1995           WHEN '2'
  1996           WHEN '3'
  1997           WHEN '6'
  1998           WHEN '7'
  1999              SET NO-CERT-RW     TO TRUE
  2000           WHEN ' '
  2001              MOVE '2'           TO CM-NOTE-SW
  2002           WHEN '1'
  2003              MOVE '3'           TO CM-NOTE-SW
  2004           WHEN '4'
  2005              MOVE '6'           TO CM-NOTE-SW
  2006           WHEN '5'
  2007              MOVE '7'           TO CM-NOTE-SW
  2008        END-EVALUATE
  2009     END-IF
  2010
  2011     IF NOT NO-CERT-RW
  2012
  2013* EXEC CICS REWRITE
  2014*          FROM     (CERTIFICATE-MASTER)
  2015*          DATASET  ('ELCERT')
  2016*          RESP     (WS-RESPONSE)
  2017*       END-EXEC
  2018     MOVE LENGTH OF
  2019      CERTIFICATE-MASTER
  2020       TO DFHEIV11
  2021     MOVE 'ELCERT' TO DFHEIV1
  2022*    MOVE '&& L                  %  N#00001693' TO DFHEIV0
  2023     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2024     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2025     MOVE X'204E233030303031363933' TO DFHEIV0(25:11)
  2026     CALL 'kxdfhei1' USING DFHEIV0,
  2027           DFHEIV1,
  2028           CERTIFICATE-MASTER,
  2029           DFHEIV11,
  2030           DFHEIV99
  2031     MOVE EIBRESP  TO WS-RESPONSE
  2032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2033     ELSE
  2034
  2035* EXEC CICS UNLOCK
  2036*          DATASET  ('ELCERT')
  2037*       END-EXEC
  2038     MOVE 'ELCERT' TO DFHEIV1
  2039*    MOVE '&*                    #   #00001699' TO DFHEIV0
  2040     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2042     MOVE X'2020233030303031363939' TO DFHEIV0(25:11)
  2043     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 06:16 Page  37
* NSAASBL.cbl
  2044           DFHEIV1,
  2045           DFHEIV99
  2046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2047     END-IF
  2048
  2049     .
  2050 0445-EXIT.
  2051     EXIT.
  2052
  2053 9700-DATE-LINK.
  2054
  2055* EXEC CICS LINK
  2056*        PROGRAM   ('ELDATCV')
  2057*        COMMAREA  (DATE-CONVERSION-DATA)
  2058*        LENGTH    (DC-COMM-LENGTH)
  2059*    END-EXEC.
  2060     MOVE 'ELDATCV' TO DFHEIV1
  2061*    MOVE '."C                   (   #00001709' TO DFHEIV0
  2062     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2064     MOVE X'2020233030303031373039' TO DFHEIV0(25:11)
  2065     CALL 'kxdfhei1' USING DFHEIV0,
  2066           DFHEIV1,
  2067           DATE-CONVERSION-DATA,
  2068           DC-COMM-LENGTH,
  2069           DFHEIV99,
  2070           DFHEIV99,
  2071           DFHEIV99,
  2072           DFHEIV99
  2073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2074
  2075 9700-EXIT.
  2076      EXIT.
  2077
  2078 9999-DFHBACK SECTION.
  2079     MOVE '9%                    "   ' TO DFHEIV0
  2080     MOVE 'NSAASBL' TO DFHEIV1
  2081     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2082     GOBACK.
  2083 9999-DFHEXIT.
  2084     IF DFHEIGDJ EQUAL 0001
  2085         NEXT SENTENCE.
  2086     MOVE '9%                    "   ' TO DFHEIV0
  2087     MOVE 'NSAASBL' TO DFHEIV1
  2088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2089     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15160     Code:        5629
