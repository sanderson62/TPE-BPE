* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   1
* EL633.cbl
* Options: int("EL633.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   2
* EL633.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53* 031912  CR2011120900003  AJRA AHL COMPANY CODE
    54* 100713  CR2013100700001  AJRA ADD 1825091000 FOR CID
    55******************************************************************
    56
    57 ENVIRONMENT DIVISION.
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   3
* EL633.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER  PIC X(32)  VALUE '********************************'.
    63 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    64 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    65
    66*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    67*77  SV-COFA PIC X(42)  VALUE SPACES.
    68*77  K-SPACE PIC X(11)  VALUE SPACES.
    69
    70 01  DATE-WORK-AREAS.
    71     05  WS-GREG-STORE.
    72         10  WS-GS-MM  PIC XX.
    73         10  FILLER    PIC X.
    74         10  WS-GS-DD  PIC XX.
    75         10  FILLER    PIC X.
    76         10  WS-GS-YY  PIC XX.
    77     05  WS-SDTE-STORE.
    78         10  WS-SS-MM  PIC XX.
    79         10  WS-SS-DD  PIC XX.
    80         10  WS-SS-YY  PIC XX.
    81*                            COPY ELCSCTM.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCTM                             *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-MESSAGE.
    92     12  FILLER                          PIC X(30)
    93            VALUE '** LOGIC SECURITY VIOLATION -'.
    94     12  SM-READ                         PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' PGM='.
    97     12  SM-PGM                          PIC X(6).
    98     12  FILLER                          PIC X(5)
    99            VALUE ' OPR='.
   100     12  SM-PROCESSOR-ID                 PIC X(4).
   101     12  FILLER                          PIC X(6)
   102            VALUE ' TERM='.
   103     12  SM-TERMID                       PIC X(4).
   104     12  FILLER                          PIC XX   VALUE SPACE.
   105     12  SM-JUL-DATE                     PIC 9(5).
   106     12  FILLER                          PIC X    VALUE SPACE.
   107     12  SM-TIME                         PIC 99.99.
   108
   109*                            COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   4
* EL633.cbl
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
   132
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   5
* EL633.cbl
   134
   135 01  STANDARD-AREAS.
   136     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   137     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   138     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   139     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   140     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   141     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   142     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   143     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   144     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   145     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   146     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   147     12  PGM-NAME            PIC  X(8).
   148     12  TIME-IN             PIC S9(7).
   149     12  TIME-OUT-R  REDEFINES  TIME-IN.
   150         16  FILLER          PIC  X.
   151         16  TIME-OUT        PIC  99V99.
   152         16  FILLER          PIC  X(2).
   153     12  EL640               PIC  X(8)       VALUE 'EL640'.
   154     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   155     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   156     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   157     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   158     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   159     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   160     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   161     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   162     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   163     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   164     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   165     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   166     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   167     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   168     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   169     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   170     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   171         88  PYAJ-1ST-READ                   VALUE 'Y'.
   172     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   173         88  FIRST-ADD                       VALUE 'Y'.
   174     12  ZERO-NDX            PIC  9          VALUE ZERO.
   175     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   176     12  WORK-SEQ-TIME       PIC  9(6).
   177     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   178         16  WORK-SEQ-HHMMS  PIC  9(5).
   179         16  FILLER          PIC  9.
   180     12  WORK-DATE-JULIAN.
   181         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   182         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   183     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   184     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   185         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   186                                                    'S' 'T' 'U'
   187                                                    'X' 'Y' 'Z'
   188                                                    'F'.
   189     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   190         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   191     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   6
* EL633.cbl
   192         88  FORCE-SHOW                      VALUE  'Y'.
   193
   194     12  WS-EOM-DTS OCCURS 13  TIMES
   195                              INDEXED BY PINDEX.
   196         16  WS-EOM-DT               PIC XX.
   197*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   198
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   7
* EL633.cbl
   200     12  WS-ERROR-CODES.
   201         16  ER-0000         PIC  X(4)       VALUE '0000'.
   202         16  ER-0008         PIC  X(4)       VALUE '0008'.
   203         16  ER-0023         PIC  X(4)       VALUE '0023'.
   204         16  ER-0029         PIC  X(4)       VALUE '0029'.
   205         16  ER-0070         PIC  X(4)       VALUE '0070'.
   206         16  ER-0587         PIC  X(4)       VALUE '0587'.
   207         16  ER-2056         PIC  X(4)       VALUE '2056'.
   208         16  ER-2230         PIC  X(4)       VALUE '2230'.
   209         16  ER-2231         PIC  X(4)       VALUE '2231'.
   210         16  ER-2232         PIC  X(4)       VALUE '2232'.
   211         16  ER-2233         PIC  X(4)       VALUE '2233'.
   212         16  ER-2234         PIC  X(4)       VALUE '2234'.
   213         16  ER-2235         PIC  X(4)       VALUE '2235'.
   214         16  ER-2236         PIC  X(4)       VALUE '2236'.
   215         16  ER-2237         PIC  X(4)       VALUE '2237'.
   216         16  ER-2238         PIC  X(4)       VALUE '2238'.
   217         16  ER-2239         PIC  X(4)       VALUE '2239'.
   218         16  ER-2244         PIC  X(4)       VALUE '2244'.
   219         16  ER-2245         PIC  X(4)       VALUE '2245'.
   220         16  ER-2246         PIC  X(4)       VALUE '2246'.
   221         16  ER-2370         PIC  X(4)       VALUE '2370'.
   222         16  ER-2432         PIC  X(4)       VALUE '2432'.
   223         16  ER-2449         PIC  X(4)       VALUE '2449'.
   224         16  ER-2587         PIC  X(4)       VALUE '2587'.
   225         16  ER-2588         PIC  X(4)       VALUE '2588'.
   226         16  ER-2595         PIC  X(4)       VALUE '2595'.
   227         16  ER-2596         PIC  X(4)       VALUE '2596'.
   228         16  ER-2763         PIC  X(4)       VALUE '2763'.
   229         16  ER-2929         PIC  X(4)       VALUE '2929'.
   230         16  ER-2957         PIC  X(4)       VALUE '2957'.
   231         16  ER-2958         PIC  X(4)       VALUE '2958'.
   232*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   233         16  ER-2960         PIC  X(4)       VALUE '2960'.
   234         16  ER-3020         PIC  X(4)       VALUE '3020'.
   235
   236*************************************************************
   237*                      TABLE OF STATE NAMES
   238*************************************************************
   239
   240 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   241     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   242                                   'CD' 'CO' 'CT' 'DC' 'DE'
   243                                   'FL' 'GA' 'GM' 'HI' 'IA'
   244                                   'ID' 'IL' 'IN' 'KS' 'KY'
   245                                   'LA' 'MA' 'MD' 'ME' 'MI'
   246                                   'MN' 'MO' 'MS' 'MT' 'MX'
   247                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   248                                   'NM' 'NV' 'NY' 'OF' 'OH'
   249                                   'OK' 'OR' 'PA' 'PI' 'PR'
   250                                   'RI' 'SC' 'SD' 'TN' 'TX'
   251                                   'UT' 'VA' 'VI' 'VT' 'WA'
   252                                   'WI' 'WV' 'WY'.
   253
   254 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   255     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   256                                 '1108125100'
   257                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   8
* EL633.cbl
   258                                 '1825011200'
   259                                 '1825011300'
   260                                 '1825091000'
   261                                 '1825099050'
   262                                 '8505700033'
   263                                 '8506400030'
   264                                 '8507200020'
   265                                 '8507200010'.
   266     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   267                                     '2725040320'
   268                                     '2725040330'
   269                                     '2725040310'
   270                                     '8506400030'
   271                                     '8507200010'
   272                                     '1108121250'.
   273     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   274                                     '2725040110'
   275                                     '2725040120'
   276                                     '2725040130'
   277                                     '2725020400'.
   278
   279     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   280                                     '1825013200'
   281                                     '1825013300'
   282                                     '1825013400'
   283                                     '8506400030'
   284                                     '8507200010'
   285                                     '8507200020'
   286                                     '1108121010'.
   287
   288*01  WS-ACCT-BREAK.
   289*    05  WS-ACCT-1               PIC X.
   290*    05  FILLER                  PIC X(6).
   291*
   292 01  WORK-AREA.
   293     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   294     12  QID.
   295         16  QID-TERM        PIC X(04).
   296         16  FILLER          PIC X(04)       VALUE '633A'.
   297     12  DEEDIT-FIELD        PIC X(11).
   298     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   299     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   300     12  DATE-TEST-AREA      PIC  9(6).
   301     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   302         16  DATE-TEST-MM    PIC  99.
   303         16  DATE-TEST-DD    PIC  99.
   304         16  DATE-TEST-YY    PIC  99.
   305     12  DIVIDE-RESULT       PIC  99.
   306     12  DIVIDE-REMAINDER    PIC  9.
   307     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   308     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   309     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   310     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   311     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   312     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   313     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   314     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   315
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page   9
* EL633.cbl
   316 01  ACCESS-KEYS.
   317     12  ERPYAJ-KEY.
   318         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   319         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   320         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   321         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   322         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   323         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   324         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   325
   326     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   327     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   328
   329     12  ERCHKQ-KEY.
   330         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   331         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   332         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   333     12  ERCOMP-KEY.
   334         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   335         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   336         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   337         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   338         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   339         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   340*    12  COFA-KEY-X.
   341*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   342*        16  COFA-ACCOUNT.
   343*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   344*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   345*
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  10
* EL633.cbl
   347*                                    COPY ELCDATE.
   348******************************************************************
   349*                                                                *
   350*                                                                *
   351*                            ELCDATE.                            *
   352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   353*                            VMOD=2.003
   354*                                                                *
   355*                                                                *
   356*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   357*                 LENGTH = 200                                   *
   358******************************************************************
   359
   360 01  DATE-CONVERSION-DATA.
   361     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   362     12  DC-OPTION-CODE                PIC X.
   363         88  BIN-TO-GREG                VALUE ' '.
   364         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   365         88  EDIT-GREG-TO-BIN           VALUE '2'.
   366         88  YMD-GREG-TO-BIN            VALUE '3'.
   367         88  MDY-GREG-TO-BIN            VALUE '4'.
   368         88  JULIAN-TO-BIN              VALUE '5'.
   369         88  BIN-PLUS-ELAPSED           VALUE '6'.
   370         88  FIND-CENTURY               VALUE '7'.
   371         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   372         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   373         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   374         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   375         88  JULIAN-TO-BIN-3            VALUE 'C'.
   376         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   377         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   378         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   379         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   380         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   381         88  CHECK-LEAP-YEAR            VALUE 'H'.
   382         88  BIN-3-TO-GREG              VALUE 'I'.
   383         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   384         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   385         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   386         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   387         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   388         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   389         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   390         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   391         88  THREE-CHARACTER-BIN
   392                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   393         88  GREGORIAN-TO-BIN
   394                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   395         88  BIN-TO-GREGORIAN
   396                  VALUES ' ' '1' 'I' '8' 'G'.
   397         88  JULIAN-TO-BINARY
   398                  VALUES '5' 'C' 'E' 'F'.
   399     12  DC-ERROR-CODE                 PIC X.
   400         88  NO-CONVERSION-ERROR        VALUE ' '.
   401         88  DATE-CONVERSION-ERROR
   402                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   403         88  DATE-IS-ZERO               VALUE '1'.
   404         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  11
* EL633.cbl
   405         88  DATE-IS-INVALID            VALUE '3'.
   406         88  DATE1-GREATER-DATE2        VALUE '4'.
   407         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   408         88  DATE-INVALID-OPTION        VALUE '9'.
   409         88  INVALID-CENTURY            VALUE 'A'.
   410         88  ONLY-CENTURY               VALUE 'B'.
   411         88  ONLY-LEAP-YEAR             VALUE 'C'.
   412         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   413     12  DC-END-OF-MONTH               PIC X.
   414         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   415     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   416         88  USE-NORMAL-PROCESS         VALUE ' '.
   417         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   418         88  ADJUST-UP-100-YRS          VALUE '2'.
   419     12  FILLER                        PIC X.
   420     12  DC-CONVERSION-DATES.
   421         16  DC-BIN-DATE-1             PIC XX.
   422         16  DC-BIN-DATE-2             PIC XX.
   423         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   424         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   425                       DC-GREG-DATE-1-EDIT.
   426             20  DC-EDIT1-MONTH        PIC 99.
   427             20  SLASH1-1              PIC X.
   428             20  DC-EDIT1-DAY          PIC 99.
   429             20  SLASH1-2              PIC X.
   430             20  DC-EDIT1-YEAR         PIC 99.
   431         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   432         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   433                     DC-GREG-DATE-2-EDIT.
   434             20  DC-EDIT2-MONTH        PIC 99.
   435             20  SLASH2-1              PIC X.
   436             20  DC-EDIT2-DAY          PIC 99.
   437             20  SLASH2-2              PIC X.
   438             20  DC-EDIT2-YEAR         PIC 99.
   439         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   440         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   441                     DC-GREG-DATE-1-YMD.
   442             20  DC-YMD-YEAR           PIC 99.
   443             20  DC-YMD-MONTH          PIC 99.
   444             20  DC-YMD-DAY            PIC 99.
   445         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   446         16  DC-GREG-DATE-1-MDY-R REDEFINES
   447                      DC-GREG-DATE-1-MDY.
   448             20  DC-MDY-MONTH          PIC 99.
   449             20  DC-MDY-DAY            PIC 99.
   450             20  DC-MDY-YEAR           PIC 99.
   451         16  DC-GREG-DATE-1-ALPHA.
   452             20  DC-ALPHA-MONTH        PIC X(10).
   453             20  DC-ALPHA-DAY          PIC 99.
   454             20  FILLER                PIC XX.
   455             20  DC-ALPHA-CENTURY.
   456                 24 DC-ALPHA-CEN-N     PIC 99.
   457             20  DC-ALPHA-YEAR         PIC 99.
   458         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   459         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   460         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   461         16  DC-JULIAN-DATE            PIC 9(05).
   462         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  12
* EL633.cbl
   463                                       PIC 9(05).
   464         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   465             20  DC-JULIAN-YEAR        PIC 99.
   466             20  DC-JULIAN-DAYS        PIC 999.
   467         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   468         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   469         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   470     12  DATE-CONVERSION-VARIBLES.
   471         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   472         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   473             20  FILLER                PIC 9(3).
   474             20  HOLD-CEN-1-CCYY.
   475                 24  HOLD-CEN-1-CC     PIC 99.
   476                 24  HOLD-CEN-1-YY     PIC 99.
   477             20  HOLD-CEN-1-MO         PIC 99.
   478             20  HOLD-CEN-1-DA         PIC 99.
   479         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   480             20  HOLD-CEN-1-R-MO       PIC 99.
   481             20  HOLD-CEN-1-R-DA       PIC 99.
   482             20  HOLD-CEN-1-R-CCYY.
   483                 24  HOLD-CEN-1-R-CC   PIC 99.
   484                 24  HOLD-CEN-1-R-YY   PIC 99.
   485             20  FILLER                PIC 9(3).
   486         16  HOLD-CENTURY-1-X.
   487             20  FILLER                PIC X(3)  VALUE SPACES.
   488             20  HOLD-CEN-1-X-CCYY.
   489                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   490                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   491             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   492             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   493         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   494             20  HOLD-CEN-1-R-X-MO     PIC XX.
   495             20  HOLD-CEN-1-R-X-DA     PIC XX.
   496             20  HOLD-CEN-1-R-X-CCYY.
   497                 24  HOLD-CEN-1-R-X-CC PIC XX.
   498                 24  HOLD-CEN-1-R-X-YY PIC XX.
   499             20  FILLER                PIC XXX.
   500         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   501         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   502         16  DC-JULIAN-DATE-1          PIC 9(07).
   503         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   504             20  DC-JULIAN-1-CCYY.
   505                 24  DC-JULIAN-1-CC    PIC 99.
   506                 24  DC-JULIAN-1-YR    PIC 99.
   507             20  DC-JULIAN-DA-1        PIC 999.
   508         16  DC-JULIAN-DATE-2          PIC 9(07).
   509         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   510             20  DC-JULIAN-2-CCYY.
   511                 24  DC-JULIAN-2-CC    PIC 99.
   512                 24  DC-JULIAN-2-YR    PIC 99.
   513             20  DC-JULIAN-DA-2        PIC 999.
   514         16  DC-GREG-DATE-A-EDIT.
   515             20  DC-EDITA-MONTH        PIC 99.
   516             20  SLASHA-1              PIC X VALUE '/'.
   517             20  DC-EDITA-DAY          PIC 99.
   518             20  SLASHA-2              PIC X VALUE '/'.
   519             20  DC-EDITA-CCYY.
   520                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  13
* EL633.cbl
   521                 24  DC-EDITA-YEAR     PIC 99.
   522         16  DC-GREG-DATE-B-EDIT.
   523             20  DC-EDITB-MONTH        PIC 99.
   524             20  SLASHB-1              PIC X VALUE '/'.
   525             20  DC-EDITB-DAY          PIC 99.
   526             20  SLASHB-2              PIC X VALUE '/'.
   527             20  DC-EDITB-CCYY.
   528                 24  DC-EDITB-CENT     PIC 99.
   529                 24  DC-EDITB-YEAR     PIC 99.
   530         16  DC-GREG-DATE-CYMD         PIC 9(08).
   531         16  DC-GREG-DATE-CYMD-R REDEFINES
   532                              DC-GREG-DATE-CYMD.
   533             20  DC-CYMD-CEN           PIC 99.
   534             20  DC-CYMD-YEAR          PIC 99.
   535             20  DC-CYMD-MONTH         PIC 99.
   536             20  DC-CYMD-DAY           PIC 99.
   537         16  DC-GREG-DATE-MDCY         PIC 9(08).
   538         16  DC-GREG-DATE-MDCY-R REDEFINES
   539                              DC-GREG-DATE-MDCY.
   540             20  DC-MDCY-MONTH         PIC 99.
   541             20  DC-MDCY-DAY           PIC 99.
   542             20  DC-MDCY-CEN           PIC 99.
   543             20  DC-MDCY-YEAR          PIC 99.
   544    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   545        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   546    12  DC-EL310-DATE                  PIC X(21).
   547    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  14
* EL633.cbl
   549*                                    COPY ELCLOGOF.
   550******************************************************************
   551*                                                                *
   552*                                                                *
   553*                            ELCLOGOF.                           *
   554*                            VMOD=2.001                          *
   555*                                                                *
   556*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   557*                                                                *
   558******************************************************************
   559 01  CLASIC-LOGOFF.
   560     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   561     12  LOGOFF-TEXT.
   562         16  FILLER          PIC X(5)    VALUE SPACES.
   563         16  LOGOFF-MSG.
   564             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   565             20  FILLER      PIC X       VALUE SPACES.
   566             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   567         16  FILLER          PIC X(80)
   568           VALUE '* YOU ARE NOW LOGGED OFF'.
   569         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   570         16  FILLER          PIC X       VALUE QUOTE.
   571         16  LOGOFF-SYS-MSG  PIC X(17)
   572           VALUE 'S CLAS-IC SYSTEM '.
   573     12  TEXT-MESSAGES.
   574         16  UNACCESS-MSG    PIC X(29)
   575             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   576         16  PGMIDERR-MSG    PIC X(17)
   577             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  15
* EL633.cbl
   579*                                    COPY ELCATTR.
   580******************************************************************
   581*                                                                *
   582*                            ELCATTR.                            *
   583*                            VMOD=2.001                          *
   584*                                                                *
   585*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   586*                                                                *
   587*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   588*                                                                *
   589*                   POS 1   P=PROTECTED                          *
   590*                           U=UNPROTECTED                        *
   591*                           S=ASKIP                              *
   592*                   POS 2   A=ALPHA/NUMERIC                      *
   593*                           N=NUMERIC                            *
   594*                   POS 3   N=NORMAL                             *
   595*                           B=BRIGHT                             *
   596*                           D=DARK                               *
   597*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   598*                           OF=MODIFIED DATA TAG OFF             *
   599*                                                                *
   600*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   601******************************************************************
   602 01  ATTRIBUTE-LIST.
   603     12  AL-PABOF            PIC X       VALUE 'Y'.
   604     12  AL-PABON            PIC X       VALUE 'Z'.
   605     12  AL-PADOF            PIC X       VALUE '%'.
   606     12  AL-PADON            PIC X       VALUE '_'.
   607     12  AL-PANOF            PIC X       VALUE '-'.
   608     12  AL-PANON            PIC X       VALUE '/'.
   609     12  AL-SABOF            PIC X       VALUE '8'.
   610     12  AL-SABON            PIC X       VALUE '9'.
   611     12  AL-SADOF            PIC X       VALUE '@'.
   612     12  AL-SADON            PIC X       VALUE QUOTE.
   613     12  AL-SANOF            PIC X       VALUE '0'.
   614     12  AL-SANON            PIC X       VALUE '1'.
   615     12  AL-UABOF            PIC X       VALUE 'H'.
   616     12  AL-UABON            PIC X       VALUE 'I'.
   617     12  AL-UADOF            PIC X       VALUE '<'.
   618     12  AL-UADON            PIC X       VALUE '('.
   619     12  AL-UANOF            PIC X       VALUE ' '.
   620     12  AL-UANON            PIC X       VALUE 'A'.
   621     12  AL-UNBOF            PIC X       VALUE 'Q'.
   622     12  AL-UNBON            PIC X       VALUE 'R'.
   623     12  AL-UNDOF            PIC X       VALUE '*'.
   624     12  AL-UNDON            PIC X       VALUE ')'.
   625     12  AL-UNNOF            PIC X       VALUE '&'.
   626     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  16
* EL633.cbl
   628*                                    COPY ELCEMIB.
   629******************************************************************
   630*                                                                *
   631*                                                                *
   632*                            ELCEMIB.                            *
   633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   634*                            VMOD=2.005                          *
   635*                                                                *
   636*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   637*                                                                *
   638******************************************************************
   639 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   640     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   641     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   642     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   643     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   644     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   645     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   646     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   647     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   648     12  EMI-SWITCH1             PIC X        VALUE '1'.
   649         88  EMI-NO-ERRORS                    VALUE '1'.
   650         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   651         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   652     12  EMI-SWITCH2             PIC X        VALUE '1'.
   653         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   654     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   655         88  EMI-AREA1-EMPTY                  VALUE '1'.
   656         88  EMI-AREA1-FULL                   VALUE '2'.
   657     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   658         88  EMI-AREA2-EMPTY                  VALUE '1'.
   659         88  EMI-AREA2-FULL                   VALUE '2'.
   660     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   661         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   662         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   663         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   664         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   665         88  EMI-BYPASS-FATALS                VALUE 'X'.
   666     12  EMI-ERROR-LINES.
   667         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   668         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   669         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   670         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   671             20  EMI-ERR-CODES OCCURS 10 TIMES.
   672                 24  EMI-ERR-NUM         PIC X(4).
   673                 24  EMI-FILLER          PIC X.
   674                 24  EMI-SEV             PIC X.
   675                 24  FILLER              PIC X.
   676             20  FILLER                  PIC X(02).
   677     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   678         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   679             20  EMI-ERROR-NUMBER    PIC X(4).
   680             20  EMI-FILL            PIC X.
   681             20  EMI-SEVERITY        PIC X.
   682             20  FILLER              PIC X.
   683             20  EMI-ERROR-TEXT.
   684                 24  EMI-TEXT-VARIABLE   PIC X(10).
   685                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  17
* EL633.cbl
   686     12  EMI-SEVERITY-SAVE           PIC X.
   687         88  EMI-NOTE                    VALUE 'N'.
   688         88  EMI-WARNING                 VALUE 'W'.
   689         88  EMI-FORCABLE                VALUE 'F'.
   690         88  EMI-FATAL                   VALUE 'X'.
   691     12  EMI-MESSAGE-FLAG            PIC X.
   692         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   693         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   694     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   695     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   696         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   697         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   698         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   699     12  emi-claim-no                pic x(7).
   700     12  emi-claim-type              pic x(6).
   701     12  FILLER                      PIC X(124)  VALUE SPACES.
   702     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   703     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   704     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   705     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  18
* EL633.cbl
   707*                                    COPY ELCINTF.
   708******************************************************************
   709*                                                                *
   710*                                                                *
   711*                            ELCINTF.                            *
   712*                            VMOD=2.017                          *
   713*                                                                *
   714*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   715*                                                                *
   716*       LENGTH = 1024                                            *
   717*                                                                *
   718******************************************************************
   719*                   C H A N G E   L O G
   720*
   721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   722*-----------------------------------------------------------------
   723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   724* EFFECTIVE    NUMBER
   725*-----------------------------------------------------------------
   726* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   727******************************************************************
   728 01  PROGRAM-INTERFACE-BLOCK.
   729     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   730     12  PI-CALLING-PROGRAM              PIC X(8).
   731     12  PI-SAVED-PROGRAM-1              PIC X(8).
   732     12  PI-SAVED-PROGRAM-2              PIC X(8).
   733     12  PI-SAVED-PROGRAM-3              PIC X(8).
   734     12  PI-SAVED-PROGRAM-4              PIC X(8).
   735     12  PI-SAVED-PROGRAM-5              PIC X(8).
   736     12  PI-SAVED-PROGRAM-6              PIC X(8).
   737     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   738     12  PI-COMPANY-ID                   PIC XXX.
   739     12  PI-COMPANY-CD                   PIC X.
   740
   741     12  PI-COMPANY-PASSWORD             PIC X(8).
   742
   743     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   744
   745     12  PI-CONTROL-IN-PROGRESS.
   746         16  PI-CARRIER                  PIC X.
   747         16  PI-GROUPING                 PIC X(6).
   748         16  PI-STATE                    PIC XX.
   749         16  PI-ACCOUNT                  PIC X(10).
   750         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   751                                         PIC X(10).
   752         16  PI-CLAIM-CERT-GRP.
   753             20  PI-CLAIM-NO             PIC X(7).
   754             20  PI-CERT-NO.
   755                 25  PI-CERT-PRIME       PIC X(10).
   756                 25  PI-CERT-SFX         PIC X.
   757             20  PI-CERT-EFF-DT          PIC XX.
   758         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   759             20  PI-PLAN-CODE            PIC X(2).
   760             20  PI-REVISION-NUMBER      PIC X(3).
   761             20  PI-PLAN-EFF-DT          PIC X(2).
   762             20  PI-PLAN-EXP-DT          PIC X(2).
   763             20  FILLER                  PIC X(11).
   764         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  19
* EL633.cbl
   765             20  PI-OE-REFERENCE-1.
   766                 25  PI-OE-REF-1-PRIME   PIC X(18).
   767                 25  PI-OE-REF-1-SUFF    PIC XX.
   768
   769     12  PI-SESSION-IN-PROGRESS          PIC X.
   770         88  CLAIM-SESSION                   VALUE '1'.
   771         88  CREDIT-SESSION                  VALUE '2'.
   772         88  WARRANTY-SESSION                VALUE '3'.
   773         88  MORTGAGE-SESSION                VALUE '4'.
   774         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   775
   776
   777*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   778
   779     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   780     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   781
   782     12  PI-CREDIT-USER                  PIC X.
   783         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   784         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   785
   786     12  PI-CLAIM-USER                   PIC X.
   787         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   788         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   789
   790     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   791         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   792         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   793         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   794         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   795         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   796
   797     12  PI-PROCESSOR-ID                 PIC X(4).
   798
   799     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   800
   801     12  PI-MEMBER-CAPTION               PIC X(10).
   802
   803     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   804         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   805
   806     12  PI-LIFE-OVERRIDE-L1             PIC X.
   807     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   808     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   809     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   810
   811     12  PI-AH-OVERRIDE-L1               PIC X.
   812     12  PI-AH-OVERRIDE-L2               PIC XX.
   813     12  PI-AH-OVERRIDE-L6               PIC X(6).
   814     12  PI-AH-OVERRIDE-L12              PIC X(12).
   815
   816     12  PI-NEW-SYSTEM                   PIC X(2).
   817
   818     12  PI-PRIMARY-CERT-NO              PIC X(11).
   819     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   820         88  PI-USES-PAID-TO                 VALUE '1'.
   821     12  PI-CRDTCRD-SYSTEM.
   822         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  20
* EL633.cbl
   823             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   824             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   825         16  PI-CC-MONTH-END-DT          PIC XX.
   826     12  PI-PROCESSOR-PRINTER            PIC X(4).
   827
   828     12  PI-OE-REFERENCE-2.
   829         16  PI-OE-REF-2-PRIME           PIC X(10).
   830         16  PI-OE-REF-2-SUFF            PIC X.
   831
   832     12  PI-REM-TRM-CALC-OPTION          PIC X.
   833
   834     12  PI-LANGUAGE-TYPE                PIC X.
   835             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   836             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   837             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   838
   839     12  PI-POLICY-LINKAGE-IND           PIC X.
   840         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   841         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   842                                                   LOW-VALUES.
   843
   844     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   845     12  PI-CLAIM-PW-SESSION             PIC X(1).
   846         88  PI-CLAIM-CREDIT                 VALUE '1'.
   847         88  PI-CLAIM-CONVEN                 VALUE '2'.
   848
   849     12  PI-PROCESSOR-CSR-IND            PIC X.
   850         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   851         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   852
   853     12  FILLER                          PIC X(3).
   854
   855     12  PI-SYSTEM-LEVEL                 PIC X(145).
   856
   857     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   858         PI-SYSTEM-LEVEL.
   859
   860         16  PI-ENTRY-CODES.
   861             20  PI-ENTRY-CD-1           PIC X.
   862             20  PI-ENTRY-CD-2           PIC X.
   863
   864         16  PI-RETURN-CODES.
   865             20  PI-RETURN-CD-1          PIC X.
   866             20  PI-RETURN-CD-2          PIC X.
   867
   868         16  PI-UPDATE-STATUS-SAVE.
   869             20  PI-UPDATE-BY            PIC X(4).
   870             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   871
   872         16  PI-LOWER-CASE-LETTERS       PIC X.
   873             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   874
   875*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   876*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   877*            88  CARRIER-CLM-CNTL            VALUE '2'.
   878
   879         16  PI-CERT-ACCESS-CONTROL      PIC X.
   880             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  21
* EL633.cbl
   881             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   882             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   883             88  ACCNT-CNTL                  VALUE '3'.
   884             88  CARR-ACCNT-CNTL             VALUE '4'.
   885
   886         16  PI-PROCESSOR-CAP-LIST.
   887             20  PI-SYSTEM-CONTROLS.
   888                24 PI-SYSTEM-DISPLAY     PIC X.
   889                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   890                24 PI-SYSTEM-MODIFY      PIC X.
   891                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   892             20  FILLER                  PIC XX.
   893             20  PI-DISPLAY-CAP          PIC X.
   894                 88  DISPLAY-CAP             VALUE 'Y'.
   895             20  PI-MODIFY-CAP           PIC X.
   896                 88  MODIFY-CAP              VALUE 'Y'.
   897             20  PI-MSG-AT-LOGON-CAP     PIC X.
   898                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   899             20  PI-FORCE-CAP            PIC X.
   900                 88  FORCE-CAP               VALUE 'Y'.
   901
   902         16  PI-PROGRAM-CONTROLS.
   903             20  PI-PGM-PRINT-OPT        PIC X.
   904             20  PI-PGM-FORMAT-OPT       PIC X.
   905             20  PI-PGM-PROCESS-OPT      PIC X.
   906             20  PI-PGM-TOTALS-OPT       PIC X.
   907
   908         16  PI-HELP-INTERFACE.
   909             20  PI-LAST-ERROR-NO        PIC X(4).
   910             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   911
   912         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   913             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   914
   915         16  PI-CR-CONTROL-IN-PROGRESS.
   916             20  PI-CR-CARRIER           PIC X.
   917             20  PI-CR-GROUPING          PIC X(6).
   918             20  PI-CR-STATE             PIC XX.
   919             20  PI-CR-ACCOUNT           PIC X(10).
   920             20  PI-CR-FIN-RESP          PIC X(10).
   921             20  PI-CR-TYPE              PIC X.
   922
   923         16  PI-CR-BATCH-NUMBER          PIC X(6).
   924
   925         16  PI-CR-MONTH-END-DT          PIC XX.
   926
   927         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   928             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   929             88  PI-ZERO-CARRIER             VALUE '1'.
   930             88  PI-ZERO-GROUPING            VALUE '2'.
   931             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   932
   933         16  PI-CARRIER-SECURITY         PIC X.
   934             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   935
   936         16  PI-ACCOUNT-SECURITY         PIC X(10).
   937             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   938             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  22
* EL633.cbl
   939
   940         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   941             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   942                                         INDEXED BY PI-ACCESS-NDX
   943                                         PIC X.
   944
   945         16  PI-GA-BILLING-CONTROL       PIC X.
   946             88  PI-GA-BILLING               VALUE '1'.
   947
   948         16  PI-MAIL-PROCESSING          PIC X.
   949             88  PI-MAIL-YES                 VALUE 'Y'.
   950
   951         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   952
   953         16  PI-AR-SYSTEM.
   954             20  PI-AR-PROCESSING-CNTL   PIC X.
   955                 88  PI-AR-PROCESSING        VALUE 'Y'.
   956             20  PI-AR-SUMMARY-CODE      PIC X(6).
   957             20  PI-AR-MONTH-END-DT      PIC XX.
   958
   959         16  PI-MP-SYSTEM.
   960             20  PI-MORTGAGE-USER            PIC X.
   961                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   962                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   963             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   964                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   965                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   966                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   967                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   968                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   969             20  PI-MP-MONTH-END-DT          PIC XX.
   970             20  PI-MP-REFERENCE-NO.
   971                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   972                 24  PI-MP-REFERENCE-SFX     PIC XX.
   973
   974         16  PI-LABEL-CONTROL            PIC X(01).
   975             88  PI-CREATE-LABELS                    VALUE 'Y'.
   976             88  PI-BYPASS-LABELS                    VALUE 'N'.
   977
   978         16  PI-BILL-GROUPING-CODE       PIC X(01).
   979             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   980
   981         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   982             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   983             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   984
   985         16  FILLER                      PIC X(14).
   986
   987     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   988******************************************************************
   989     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   990         16  PI-PYAJ-FILE-SW             PIC  X.
   991             88  END-OF-ACCT                 VALUE 'A'.
   992             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   993             88  END-OF-FILE                 VALUE 'X'.
   994             88  TOP-OF-FILE                 VALUE 'T'.
   995             88  PAGE-FULL                   VALUE 'F'.
   996             88  NO-RECORDS                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  23
* EL633.cbl
   997             88  NOT-OPEN                    VALUE 'Z'.
   998         16  PI-PREV-FUNCTION            PIC  X.
   999         16  PI-SAV-FUNCTION             PIC  X.
  1000         16  PI-PREV-PFKEY               PIC  X.
  1001         16  PI-SEQ-NOS.
  1002             20  FILLER  OCCURS 13 TIMES
  1003                             INDEXED BY NDX.
  1004                 24  PI-REC-TYPE         PIC  X.
  1005                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
  1006         16  PI-SAV-ENDING-PYAJ-KEY.
  1007             20  PI-SAV-COMP-CD          PIC  X.
  1008             20  PI-SAV-COMP-CONTROL.
  1009                 24  PI-SAV-CARRIER      PIC  X.
  1010                 24  PI-SAV-GROUPING     PIC  X(6).
  1011                 24  PI-SAV-FIN-RESP     PIC  X(10).
  1012                 24  PI-SAV-ACCOUNT      PIC  X(10).
  1013                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
  1014                 24  PI-SAV-RECORD-TYPE  PIC  X.
  1015         16  PI-START-PYAJ-KEY           PIC  X(33).
  1016         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
  1017         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
  1018         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1019         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1020         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1021             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1022         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1023         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1024         16  PI-FRST-RECORD-TYPE         PIC  X.
  1025         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1026         16  PI-PREV-RECORD-TYPE         PIC  X.
  1027         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1028         16  PI-LAST-RECORD-TYPE         PIC  X.
  1029         16  PI-PAGE-SW                  PIC  X.
  1030             88  FIRST-PAGE                          VALUE 'Y'.
  1031         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  24
* EL633.cbl
  1033*                            COPY ELCJPFX.
  1034******************************************************************
  1035*                                                                *
  1036*                                                                *
  1037*                            ELCJPFX.                            *
  1038*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1039*                            VMOD=2.002                          *
  1040*                                                                *
  1041*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1042*                                                                *
  1043*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1044*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1045*        ELCNTL - CONTROL FILE                                   *
  1046*        ELMSTR - CLAIM MASTERS                                  *
  1047*        ELTRLR - ACTIVITY TRAILERS                              *
  1048*        ELCHKQ - CHECK QUE                                      *
  1049******************************************************************
  1050 01  JOURNAL-RECORD.
  1051     12  jp-date                     pic s9(5) comp-3.
  1052     12  jp-time                     pic s9(7) comp-3.
  1053     12  JP-USER-ID                  PIC X(4).
  1054     12  JP-FILE-ID                  PIC X(8).
  1055     12  JP-PROGRAM-ID               PIC X(8).
  1056     12  JP-RECORD-TYPE              PIC X.
  1057         88 JP-ADD              VALUE 'A'.
  1058         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1059         88 JP-AFTER-CHANGE     VALUE 'C'.
  1060         88 JP-DELETE           VALUE 'D'.
  1061         88 JP-GENERIC-DELETE   VALUE 'G'.
  1062         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1063         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1064     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1065     12  JP-RECORD-AREA
  1066
  1067
  1068                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  25
* EL633.cbl
  1070*                            COPY ELCAID.
  1071******************************************************************
  1072*                                                                *
  1073*                            ELCAID.                             *
  1074*                            VMOD=2.001                          *
  1075*                                                                *
  1076*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1077*                                                                *
  1078*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1079*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1080******************************************************************
  1081
  1082 01  DFHAID.
  1083   02  DFHNULL   PIC  X  VALUE  ' '.
  1084   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1085   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1086   02  DFHPEN    PIC  X  VALUE  '='.
  1087   02  DFHOPID   PIC  X  VALUE  'W'.
  1088   02  DFHPA1    PIC  X  VALUE  '%'.
  1089   02  DFHPA2    PIC  X  VALUE  '>'.
  1090   02  DFHPA3    PIC  X  VALUE  ','.
  1091   02  DFHPF1    PIC  X  VALUE  '1'.
  1092   02  DFHPF2    PIC  X  VALUE  '2'.
  1093   02  DFHPF3    PIC  X  VALUE  '3'.
  1094   02  DFHPF4    PIC  X  VALUE  '4'.
  1095   02  DFHPF5    PIC  X  VALUE  '5'.
  1096   02  DFHPF6    PIC  X  VALUE  '6'.
  1097   02  DFHPF7    PIC  X  VALUE  '7'.
  1098   02  DFHPF8    PIC  X  VALUE  '8'.
  1099   02  DFHPF9    PIC  X  VALUE  '9'.
  1100   02  DFHPF10   PIC  X  VALUE  ':'.
  1101   02  DFHPF11   PIC  X  VALUE  '#'.
  1102   02  DFHPF12   PIC  X  VALUE  '@'.
  1103   02  DFHPF13   PIC  X  VALUE  'A'.
  1104   02  DFHPF14   PIC  X  VALUE  'B'.
  1105   02  DFHPF15   PIC  X  VALUE  'C'.
  1106   02  DFHPF16   PIC  X  VALUE  'D'.
  1107   02  DFHPF17   PIC  X  VALUE  'E'.
  1108   02  DFHPF18   PIC  X  VALUE  'F'.
  1109   02  DFHPF19   PIC  X  VALUE  'G'.
  1110   02  DFHPF20   PIC  X  VALUE  'H'.
  1111   02  DFHPF21   PIC  X  VALUE  'I'.
  1112*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1113   02  DFHPF22   PIC  X  VALUE  '['.
  1114   02  DFHPF23   PIC  X  VALUE  '.'.
  1115   02  DFHPF24   PIC  X  VALUE  '<'.
  1116   02  DFHMSRE   PIC  X  VALUE  'X'.
  1117   02  DFHSTRF   PIC  X  VALUE  'h'.
  1118   02  DFHTRIG   PIC  X  VALUE  '"'.
  1119
  1120 01  FILLER  REDEFINES  DFHAID.
  1121     12  FILLER              PIC  X(8).
  1122     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  26
* EL633.cbl
  1124*                            COPY EL633S.
  1125 01  EL633AI.
  1126     05  FILLER            PIC  X(0012).
  1127*    -------------------------------
  1128     05  DATEL PIC S9(0004) COMP.
  1129     05  DATEF PIC  X(0001).
  1130     05  FILLER REDEFINES DATEF.
  1131         10  DATEA PIC  X(0001).
  1132     05  DATEI PIC  X(0008).
  1133*    -------------------------------
  1134     05  TIMEL PIC S9(0004) COMP.
  1135     05  TIMEF PIC  X(0001).
  1136     05  FILLER REDEFINES TIMEF.
  1137         10  TIMEA PIC  X(0001).
  1138     05  TIMEI PIC  X(0005).
  1139*    -------------------------------
  1140     05  CMPNYIDL PIC S9(0004) COMP.
  1141     05  CMPNYIDF PIC  X(0001).
  1142     05  FILLER REDEFINES CMPNYIDF.
  1143         10  CMPNYIDA PIC  X(0001).
  1144     05  CMPNYIDI PIC  X(0003).
  1145*    -------------------------------
  1146     05  USERIDL PIC S9(0004) COMP.
  1147     05  USERIDF PIC  X(0001).
  1148     05  FILLER REDEFINES USERIDF.
  1149         10  USERIDA PIC  X(0001).
  1150     05  USERIDI PIC  X(0004).
  1151*    -------------------------------
  1152     05  MAINTL PIC S9(0004) COMP.
  1153     05  MAINTF PIC  X(0001).
  1154     05  FILLER REDEFINES MAINTF.
  1155         10  MAINTA PIC  X(0001).
  1156     05  MAINTI PIC  X(0001).
  1157*    -------------------------------
  1158     05  CARRIERL PIC S9(0004) COMP.
  1159     05  CARRIERF PIC  X(0001).
  1160     05  FILLER REDEFINES CARRIERF.
  1161         10  CARRIERA PIC  X(0001).
  1162     05  CARRIERI PIC  X(0001).
  1163*    -------------------------------
  1164     05  GROUPL PIC S9(0004) COMP.
  1165     05  GROUPF PIC  X(0001).
  1166     05  FILLER REDEFINES GROUPF.
  1167         10  GROUPA PIC  X(0001).
  1168     05  GROUPI PIC  X(0006).
  1169*    -------------------------------
  1170     05  FINRESPL PIC S9(0004) COMP.
  1171     05  FINRESPF PIC  X(0001).
  1172     05  FILLER REDEFINES FINRESPF.
  1173         10  FINRESPA PIC  X(0001).
  1174     05  FINRESPI PIC  X(0010).
  1175*    -------------------------------
  1176     05  ACCTL PIC S9(0004) COMP.
  1177     05  ACCTF PIC  X(0001).
  1178     05  FILLER REDEFINES ACCTF.
  1179         10  ACCTA PIC  X(0001).
  1180     05  ACCTI PIC  X(0010).
  1181*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  27
* EL633.cbl
  1182     05  MSAAC1L PIC S9(0004) COMP.
  1183     05  MSAAC1F PIC  X(0001).
  1184     05  FILLER REDEFINES MSAAC1F.
  1185         10  MSAAC1A PIC  X(0001).
  1186     05  MSAAC1I PIC  X(0010).
  1187*    -------------------------------
  1188     05  MSAST1L PIC S9(0004) COMP.
  1189     05  MSAST1F PIC  X(0001).
  1190     05  FILLER REDEFINES MSAST1F.
  1191         10  MSAST1A PIC  X(0001).
  1192     05  MSAST1I PIC  X(0002).
  1193*    -------------------------------
  1194     05  MSACN1L PIC S9(0004) COMP.
  1195     05  MSACN1F PIC  X(0001).
  1196     05  FILLER REDEFINES MSACN1F.
  1197         10  MSACN1A PIC  X(0001).
  1198     05  MSACN1I PIC  X(0001).
  1199*    -------------------------------
  1200     05  MSACM1L PIC S9(0004) COMP.
  1201     05  MSACM1F PIC  X(0001).
  1202     05  FILLER REDEFINES MSACM1F.
  1203         10  MSACM1A PIC  X(0001).
  1204     05  MSACM1I PIC  X(0010).
  1205*    -------------------------------
  1206     05  TYPE1L PIC S9(0004) COMP.
  1207     05  TYPE1F PIC  X(0001).
  1208     05  FILLER REDEFINES TYPE1F.
  1209         10  TYPE1A PIC  X(0001).
  1210     05  TYPE1I PIC  X(0001).
  1211*    -------------------------------
  1212     05  AMT1L PIC S9(0004) COMP.
  1213     05  AMT1F PIC  X(0001).
  1214     05  FILLER REDEFINES AMT1F.
  1215         10  AMT1A PIC  X(0001).
  1216     05  AMT1I PIC  X(0011).
  1217*    -------------------------------
  1218     05  VOID1L PIC S9(0004) COMP.
  1219     05  VOID1F PIC  X(0001).
  1220     05  FILLER REDEFINES VOID1F.
  1221         10  VOID1A PIC  X(0001).
  1222     05  VOID1I PIC  X(0001).
  1223*    -------------------------------
  1224     05  MDT1L PIC S9(0004) COMP.
  1225     05  MDT1F PIC  X(0001).
  1226     05  FILLER REDEFINES MDT1F.
  1227         10  MDT1A PIC  X(0001).
  1228     05  MDT1I PIC  X(0006).
  1229*    -------------------------------
  1230     05  BDT1L PIC S9(0004) COMP.
  1231     05  BDT1F PIC  X(0001).
  1232     05  FILLER REDEFINES BDT1F.
  1233         10  BDT1A PIC  X(0001).
  1234     05  BDT1I PIC  X(0006).
  1235*    -------------------------------
  1236     05  SDT1L PIC S9(0004) COMP.
  1237     05  SDT1F PIC  X(0001).
  1238     05  FILLER REDEFINES SDT1F.
  1239         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  28
* EL633.cbl
  1240     05  SDT1I PIC  X(0006).
  1241*    -------------------------------
  1242     05  MSAAC2L PIC S9(0004) COMP.
  1243     05  MSAAC2F PIC  X(0001).
  1244     05  FILLER REDEFINES MSAAC2F.
  1245         10  MSAAC2A PIC  X(0001).
  1246     05  MSAAC2I PIC  X(0010).
  1247*    -------------------------------
  1248     05  MSAST2L PIC S9(0004) COMP.
  1249     05  MSAST2F PIC  X(0001).
  1250     05  FILLER REDEFINES MSAST2F.
  1251         10  MSAST2A PIC  X(0001).
  1252     05  MSAST2I PIC  X(0002).
  1253*    -------------------------------
  1254     05  MSACN2L PIC S9(0004) COMP.
  1255     05  MSACN2F PIC  X(0001).
  1256     05  FILLER REDEFINES MSACN2F.
  1257         10  MSACN2A PIC  X(0001).
  1258     05  MSACN2I PIC  X(0001).
  1259*    -------------------------------
  1260     05  MSACM2L PIC S9(0004) COMP.
  1261     05  MSACM2F PIC  X(0001).
  1262     05  FILLER REDEFINES MSACM2F.
  1263         10  MSACM2A PIC  X(0001).
  1264     05  MSACM2I PIC  X(0010).
  1265*    -------------------------------
  1266     05  TYPE2L PIC S9(0004) COMP.
  1267     05  TYPE2F PIC  X(0001).
  1268     05  FILLER REDEFINES TYPE2F.
  1269         10  TYPE2A PIC  X(0001).
  1270     05  TYPE2I PIC  X(0001).
  1271*    -------------------------------
  1272     05  AMT2L PIC S9(0004) COMP.
  1273     05  AMT2F PIC  X(0001).
  1274     05  FILLER REDEFINES AMT2F.
  1275         10  AMT2A PIC  X(0001).
  1276     05  AMT2I PIC  X(0011).
  1277*    -------------------------------
  1278     05  VOID2L PIC S9(0004) COMP.
  1279     05  VOID2F PIC  X(0001).
  1280     05  FILLER REDEFINES VOID2F.
  1281         10  VOID2A PIC  X(0001).
  1282     05  VOID2I PIC  X(0001).
  1283*    -------------------------------
  1284     05  MDT2L PIC S9(0004) COMP.
  1285     05  MDT2F PIC  X(0001).
  1286     05  FILLER REDEFINES MDT2F.
  1287         10  MDT2A PIC  X(0001).
  1288     05  MDT2I PIC  X(0006).
  1289*    -------------------------------
  1290     05  BDT2L PIC S9(0004) COMP.
  1291     05  BDT2F PIC  X(0001).
  1292     05  FILLER REDEFINES BDT2F.
  1293         10  BDT2A PIC  X(0001).
  1294     05  BDT2I PIC  X(0006).
  1295*    -------------------------------
  1296     05  SDT2L PIC S9(0004) COMP.
  1297     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  29
* EL633.cbl
  1298     05  FILLER REDEFINES SDT2F.
  1299         10  SDT2A PIC  X(0001).
  1300     05  SDT2I PIC  X(0006).
  1301*    -------------------------------
  1302     05  MSAAC3L PIC S9(0004) COMP.
  1303     05  MSAAC3F PIC  X(0001).
  1304     05  FILLER REDEFINES MSAAC3F.
  1305         10  MSAAC3A PIC  X(0001).
  1306     05  MSAAC3I PIC  X(0010).
  1307*    -------------------------------
  1308     05  MSAST3L PIC S9(0004) COMP.
  1309     05  MSAST3F PIC  X(0001).
  1310     05  FILLER REDEFINES MSAST3F.
  1311         10  MSAST3A PIC  X(0001).
  1312     05  MSAST3I PIC  X(0002).
  1313*    -------------------------------
  1314     05  MSACN3L PIC S9(0004) COMP.
  1315     05  MSACN3F PIC  X(0001).
  1316     05  FILLER REDEFINES MSACN3F.
  1317         10  MSACN3A PIC  X(0001).
  1318     05  MSACN3I PIC  X(0001).
  1319*    -------------------------------
  1320     05  MSACM3L PIC S9(0004) COMP.
  1321     05  MSACM3F PIC  X(0001).
  1322     05  FILLER REDEFINES MSACM3F.
  1323         10  MSACM3A PIC  X(0001).
  1324     05  MSACM3I PIC  X(0010).
  1325*    -------------------------------
  1326     05  TYPE3L PIC S9(0004) COMP.
  1327     05  TYPE3F PIC  X(0001).
  1328     05  FILLER REDEFINES TYPE3F.
  1329         10  TYPE3A PIC  X(0001).
  1330     05  TYPE3I PIC  X(0001).
  1331*    -------------------------------
  1332     05  AMT3L PIC S9(0004) COMP.
  1333     05  AMT3F PIC  X(0001).
  1334     05  FILLER REDEFINES AMT3F.
  1335         10  AMT3A PIC  X(0001).
  1336     05  AMT3I PIC  X(0011).
  1337*    -------------------------------
  1338     05  VOID3L PIC S9(0004) COMP.
  1339     05  VOID3F PIC  X(0001).
  1340     05  FILLER REDEFINES VOID3F.
  1341         10  VOID3A PIC  X(0001).
  1342     05  VOID3I PIC  X(0001).
  1343*    -------------------------------
  1344     05  MDT3L PIC S9(0004) COMP.
  1345     05  MDT3F PIC  X(0001).
  1346     05  FILLER REDEFINES MDT3F.
  1347         10  MDT3A PIC  X(0001).
  1348     05  MDT3I PIC  X(0006).
  1349*    -------------------------------
  1350     05  BDT3L PIC S9(0004) COMP.
  1351     05  BDT3F PIC  X(0001).
  1352     05  FILLER REDEFINES BDT3F.
  1353         10  BDT3A PIC  X(0001).
  1354     05  BDT3I PIC  X(0006).
  1355*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  30
* EL633.cbl
  1356     05  SDT3L PIC S9(0004) COMP.
  1357     05  SDT3F PIC  X(0001).
  1358     05  FILLER REDEFINES SDT3F.
  1359         10  SDT3A PIC  X(0001).
  1360     05  SDT3I PIC  X(0006).
  1361*    -------------------------------
  1362     05  MSAAC4L PIC S9(0004) COMP.
  1363     05  MSAAC4F PIC  X(0001).
  1364     05  FILLER REDEFINES MSAAC4F.
  1365         10  MSAAC4A PIC  X(0001).
  1366     05  MSAAC4I PIC  X(0010).
  1367*    -------------------------------
  1368     05  MSAST4L PIC S9(0004) COMP.
  1369     05  MSAST4F PIC  X(0001).
  1370     05  FILLER REDEFINES MSAST4F.
  1371         10  MSAST4A PIC  X(0001).
  1372     05  MSAST4I PIC  X(0002).
  1373*    -------------------------------
  1374     05  MSACN4L PIC S9(0004) COMP.
  1375     05  MSACN4F PIC  X(0001).
  1376     05  FILLER REDEFINES MSACN4F.
  1377         10  MSACN4A PIC  X(0001).
  1378     05  MSACN4I PIC  X(0001).
  1379*    -------------------------------
  1380     05  MSACM4L PIC S9(0004) COMP.
  1381     05  MSACM4F PIC  X(0001).
  1382     05  FILLER REDEFINES MSACM4F.
  1383         10  MSACM4A PIC  X(0001).
  1384     05  MSACM4I PIC  X(0010).
  1385*    -------------------------------
  1386     05  TYPE4L PIC S9(0004) COMP.
  1387     05  TYPE4F PIC  X(0001).
  1388     05  FILLER REDEFINES TYPE4F.
  1389         10  TYPE4A PIC  X(0001).
  1390     05  TYPE4I PIC  X(0001).
  1391*    -------------------------------
  1392     05  AMT4L PIC S9(0004) COMP.
  1393     05  AMT4F PIC  X(0001).
  1394     05  FILLER REDEFINES AMT4F.
  1395         10  AMT4A PIC  X(0001).
  1396     05  AMT4I PIC  X(0011).
  1397*    -------------------------------
  1398     05  VOID4L PIC S9(0004) COMP.
  1399     05  VOID4F PIC  X(0001).
  1400     05  FILLER REDEFINES VOID4F.
  1401         10  VOID4A PIC  X(0001).
  1402     05  VOID4I PIC  X(0001).
  1403*    -------------------------------
  1404     05  MDT4L PIC S9(0004) COMP.
  1405     05  MDT4F PIC  X(0001).
  1406     05  FILLER REDEFINES MDT4F.
  1407         10  MDT4A PIC  X(0001).
  1408     05  MDT4I PIC  X(0006).
  1409*    -------------------------------
  1410     05  BDT4L PIC S9(0004) COMP.
  1411     05  BDT4F PIC  X(0001).
  1412     05  FILLER REDEFINES BDT4F.
  1413         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  31
* EL633.cbl
  1414     05  BDT4I PIC  X(0006).
  1415*    -------------------------------
  1416     05  SDT4L PIC S9(0004) COMP.
  1417     05  SDT4F PIC  X(0001).
  1418     05  FILLER REDEFINES SDT4F.
  1419         10  SDT4A PIC  X(0001).
  1420     05  SDT4I PIC  X(0006).
  1421*    -------------------------------
  1422     05  MSAAC5L PIC S9(0004) COMP.
  1423     05  MSAAC5F PIC  X(0001).
  1424     05  FILLER REDEFINES MSAAC5F.
  1425         10  MSAAC5A PIC  X(0001).
  1426     05  MSAAC5I PIC  X(0010).
  1427*    -------------------------------
  1428     05  MSAST5L PIC S9(0004) COMP.
  1429     05  MSAST5F PIC  X(0001).
  1430     05  FILLER REDEFINES MSAST5F.
  1431         10  MSAST5A PIC  X(0001).
  1432     05  MSAST5I PIC  X(0002).
  1433*    -------------------------------
  1434     05  MSACN5L PIC S9(0004) COMP.
  1435     05  MSACN5F PIC  X(0001).
  1436     05  FILLER REDEFINES MSACN5F.
  1437         10  MSACN5A PIC  X(0001).
  1438     05  MSACN5I PIC  X(0001).
  1439*    -------------------------------
  1440     05  MSACM5L PIC S9(0004) COMP.
  1441     05  MSACM5F PIC  X(0001).
  1442     05  FILLER REDEFINES MSACM5F.
  1443         10  MSACM5A PIC  X(0001).
  1444     05  MSACM5I PIC  X(0010).
  1445*    -------------------------------
  1446     05  TYPE5L PIC S9(0004) COMP.
  1447     05  TYPE5F PIC  X(0001).
  1448     05  FILLER REDEFINES TYPE5F.
  1449         10  TYPE5A PIC  X(0001).
  1450     05  TYPE5I PIC  X(0001).
  1451*    -------------------------------
  1452     05  AMT5L PIC S9(0004) COMP.
  1453     05  AMT5F PIC  X(0001).
  1454     05  FILLER REDEFINES AMT5F.
  1455         10  AMT5A PIC  X(0001).
  1456     05  AMT5I PIC  X(0011).
  1457*    -------------------------------
  1458     05  VOID5L PIC S9(0004) COMP.
  1459     05  VOID5F PIC  X(0001).
  1460     05  FILLER REDEFINES VOID5F.
  1461         10  VOID5A PIC  X(0001).
  1462     05  VOID5I PIC  X(0001).
  1463*    -------------------------------
  1464     05  MDT5L PIC S9(0004) COMP.
  1465     05  MDT5F PIC  X(0001).
  1466     05  FILLER REDEFINES MDT5F.
  1467         10  MDT5A PIC  X(0001).
  1468     05  MDT5I PIC  X(0006).
  1469*    -------------------------------
  1470     05  BDT5L PIC S9(0004) COMP.
  1471     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  32
* EL633.cbl
  1472     05  FILLER REDEFINES BDT5F.
  1473         10  BDT5A PIC  X(0001).
  1474     05  BDT5I PIC  X(0006).
  1475*    -------------------------------
  1476     05  SDT5L PIC S9(0004) COMP.
  1477     05  SDT5F PIC  X(0001).
  1478     05  FILLER REDEFINES SDT5F.
  1479         10  SDT5A PIC  X(0001).
  1480     05  SDT5I PIC  X(0006).
  1481*    -------------------------------
  1482     05  MSAAC6L PIC S9(0004) COMP.
  1483     05  MSAAC6F PIC  X(0001).
  1484     05  FILLER REDEFINES MSAAC6F.
  1485         10  MSAAC6A PIC  X(0001).
  1486     05  MSAAC6I PIC  X(0010).
  1487*    -------------------------------
  1488     05  MSAST6L PIC S9(0004) COMP.
  1489     05  MSAST6F PIC  X(0001).
  1490     05  FILLER REDEFINES MSAST6F.
  1491         10  MSAST6A PIC  X(0001).
  1492     05  MSAST6I PIC  X(0002).
  1493*    -------------------------------
  1494     05  MSACN6L PIC S9(0004) COMP.
  1495     05  MSACN6F PIC  X(0001).
  1496     05  FILLER REDEFINES MSACN6F.
  1497         10  MSACN6A PIC  X(0001).
  1498     05  MSACN6I PIC  X(0001).
  1499*    -------------------------------
  1500     05  MSACM6L PIC S9(0004) COMP.
  1501     05  MSACM6F PIC  X(0001).
  1502     05  FILLER REDEFINES MSACM6F.
  1503         10  MSACM6A PIC  X(0001).
  1504     05  MSACM6I PIC  X(0010).
  1505*    -------------------------------
  1506     05  TYPE6L PIC S9(0004) COMP.
  1507     05  TYPE6F PIC  X(0001).
  1508     05  FILLER REDEFINES TYPE6F.
  1509         10  TYPE6A PIC  X(0001).
  1510     05  TYPE6I PIC  X(0001).
  1511*    -------------------------------
  1512     05  AMT6L PIC S9(0004) COMP.
  1513     05  AMT6F PIC  X(0001).
  1514     05  FILLER REDEFINES AMT6F.
  1515         10  AMT6A PIC  X(0001).
  1516     05  AMT6I PIC  X(0011).
  1517*    -------------------------------
  1518     05  VOID6L PIC S9(0004) COMP.
  1519     05  VOID6F PIC  X(0001).
  1520     05  FILLER REDEFINES VOID6F.
  1521         10  VOID6A PIC  X(0001).
  1522     05  VOID6I PIC  X(0001).
  1523*    -------------------------------
  1524     05  MDT6L PIC S9(0004) COMP.
  1525     05  MDT6F PIC  X(0001).
  1526     05  FILLER REDEFINES MDT6F.
  1527         10  MDT6A PIC  X(0001).
  1528     05  MDT6I PIC  X(0006).
  1529*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  33
* EL633.cbl
  1530     05  BDT6L PIC S9(0004) COMP.
  1531     05  BDT6F PIC  X(0001).
  1532     05  FILLER REDEFINES BDT6F.
  1533         10  BDT6A PIC  X(0001).
  1534     05  BDT6I PIC  X(0006).
  1535*    -------------------------------
  1536     05  SDT6L PIC S9(0004) COMP.
  1537     05  SDT6F PIC  X(0001).
  1538     05  FILLER REDEFINES SDT6F.
  1539         10  SDT6A PIC  X(0001).
  1540     05  SDT6I PIC  X(0006).
  1541*    -------------------------------
  1542     05  MSAAC7L PIC S9(0004) COMP.
  1543     05  MSAAC7F PIC  X(0001).
  1544     05  FILLER REDEFINES MSAAC7F.
  1545         10  MSAAC7A PIC  X(0001).
  1546     05  MSAAC7I PIC  X(0010).
  1547*    -------------------------------
  1548     05  MSAST7L PIC S9(0004) COMP.
  1549     05  MSAST7F PIC  X(0001).
  1550     05  FILLER REDEFINES MSAST7F.
  1551         10  MSAST7A PIC  X(0001).
  1552     05  MSAST7I PIC  X(0002).
  1553*    -------------------------------
  1554     05  MSACN7L PIC S9(0004) COMP.
  1555     05  MSACN7F PIC  X(0001).
  1556     05  FILLER REDEFINES MSACN7F.
  1557         10  MSACN7A PIC  X(0001).
  1558     05  MSACN7I PIC  X(0001).
  1559*    -------------------------------
  1560     05  MSACM7L PIC S9(0004) COMP.
  1561     05  MSACM7F PIC  X(0001).
  1562     05  FILLER REDEFINES MSACM7F.
  1563         10  MSACM7A PIC  X(0001).
  1564     05  MSACM7I PIC  X(0010).
  1565*    -------------------------------
  1566     05  TYPE7L PIC S9(0004) COMP.
  1567     05  TYPE7F PIC  X(0001).
  1568     05  FILLER REDEFINES TYPE7F.
  1569         10  TYPE7A PIC  X(0001).
  1570     05  TYPE7I PIC  X(0001).
  1571*    -------------------------------
  1572     05  AMT7L PIC S9(0004) COMP.
  1573     05  AMT7F PIC  X(0001).
  1574     05  FILLER REDEFINES AMT7F.
  1575         10  AMT7A PIC  X(0001).
  1576     05  AMT7I PIC  X(0011).
  1577*    -------------------------------
  1578     05  VOID7L PIC S9(0004) COMP.
  1579     05  VOID7F PIC  X(0001).
  1580     05  FILLER REDEFINES VOID7F.
  1581         10  VOID7A PIC  X(0001).
  1582     05  VOID7I PIC  X(0001).
  1583*    -------------------------------
  1584     05  MDT7L PIC S9(0004) COMP.
  1585     05  MDT7F PIC  X(0001).
  1586     05  FILLER REDEFINES MDT7F.
  1587         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  34
* EL633.cbl
  1588     05  MDT7I PIC  X(0006).
  1589*    -------------------------------
  1590     05  BDT7L PIC S9(0004) COMP.
  1591     05  BDT7F PIC  X(0001).
  1592     05  FILLER REDEFINES BDT7F.
  1593         10  BDT7A PIC  X(0001).
  1594     05  BDT7I PIC  X(0006).
  1595*    -------------------------------
  1596     05  SDT7L PIC S9(0004) COMP.
  1597     05  SDT7F PIC  X(0001).
  1598     05  FILLER REDEFINES SDT7F.
  1599         10  SDT7A PIC  X(0001).
  1600     05  SDT7I PIC  X(0006).
  1601*    -------------------------------
  1602     05  MSAAC8L PIC S9(0004) COMP.
  1603     05  MSAAC8F PIC  X(0001).
  1604     05  FILLER REDEFINES MSAAC8F.
  1605         10  MSAAC8A PIC  X(0001).
  1606     05  MSAAC8I PIC  X(0010).
  1607*    -------------------------------
  1608     05  MSAST8L PIC S9(0004) COMP.
  1609     05  MSAST8F PIC  X(0001).
  1610     05  FILLER REDEFINES MSAST8F.
  1611         10  MSAST8A PIC  X(0001).
  1612     05  MSAST8I PIC  X(0002).
  1613*    -------------------------------
  1614     05  MSACN8L PIC S9(0004) COMP.
  1615     05  MSACN8F PIC  X(0001).
  1616     05  FILLER REDEFINES MSACN8F.
  1617         10  MSACN8A PIC  X(0001).
  1618     05  MSACN8I PIC  X(0001).
  1619*    -------------------------------
  1620     05  MSACM8L PIC S9(0004) COMP.
  1621     05  MSACM8F PIC  X(0001).
  1622     05  FILLER REDEFINES MSACM8F.
  1623         10  MSACM8A PIC  X(0001).
  1624     05  MSACM8I PIC  X(0010).
  1625*    -------------------------------
  1626     05  TYPE8L PIC S9(0004) COMP.
  1627     05  TYPE8F PIC  X(0001).
  1628     05  FILLER REDEFINES TYPE8F.
  1629         10  TYPE8A PIC  X(0001).
  1630     05  TYPE8I PIC  X(0001).
  1631*    -------------------------------
  1632     05  AMT8L PIC S9(0004) COMP.
  1633     05  AMT8F PIC  X(0001).
  1634     05  FILLER REDEFINES AMT8F.
  1635         10  AMT8A PIC  X(0001).
  1636     05  AMT8I PIC  X(0011).
  1637*    -------------------------------
  1638     05  VOID8L PIC S9(0004) COMP.
  1639     05  VOID8F PIC  X(0001).
  1640     05  FILLER REDEFINES VOID8F.
  1641         10  VOID8A PIC  X(0001).
  1642     05  VOID8I PIC  X(0001).
  1643*    -------------------------------
  1644     05  MDT8L PIC S9(0004) COMP.
  1645     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  35
* EL633.cbl
  1646     05  FILLER REDEFINES MDT8F.
  1647         10  MDT8A PIC  X(0001).
  1648     05  MDT8I PIC  X(0006).
  1649*    -------------------------------
  1650     05  BDT8L PIC S9(0004) COMP.
  1651     05  BDT8F PIC  X(0001).
  1652     05  FILLER REDEFINES BDT8F.
  1653         10  BDT8A PIC  X(0001).
  1654     05  BDT8I PIC  X(0006).
  1655*    -------------------------------
  1656     05  SDT8L PIC S9(0004) COMP.
  1657     05  SDT8F PIC  X(0001).
  1658     05  FILLER REDEFINES SDT8F.
  1659         10  SDT8A PIC  X(0001).
  1660     05  SDT8I PIC  X(0006).
  1661*    -------------------------------
  1662     05  MSAAC9L PIC S9(0004) COMP.
  1663     05  MSAAC9F PIC  X(0001).
  1664     05  FILLER REDEFINES MSAAC9F.
  1665         10  MSAAC9A PIC  X(0001).
  1666     05  MSAAC9I PIC  X(0010).
  1667*    -------------------------------
  1668     05  MSAST9L PIC S9(0004) COMP.
  1669     05  MSAST9F PIC  X(0001).
  1670     05  FILLER REDEFINES MSAST9F.
  1671         10  MSAST9A PIC  X(0001).
  1672     05  MSAST9I PIC  X(0002).
  1673*    -------------------------------
  1674     05  MSACN9L PIC S9(0004) COMP.
  1675     05  MSACN9F PIC  X(0001).
  1676     05  FILLER REDEFINES MSACN9F.
  1677         10  MSACN9A PIC  X(0001).
  1678     05  MSACN9I PIC  X(0001).
  1679*    -------------------------------
  1680     05  MSACM9L PIC S9(0004) COMP.
  1681     05  MSACM9F PIC  X(0001).
  1682     05  FILLER REDEFINES MSACM9F.
  1683         10  MSACM9A PIC  X(0001).
  1684     05  MSACM9I PIC  X(0010).
  1685*    -------------------------------
  1686     05  TYPE9L PIC S9(0004) COMP.
  1687     05  TYPE9F PIC  X(0001).
  1688     05  FILLER REDEFINES TYPE9F.
  1689         10  TYPE9A PIC  X(0001).
  1690     05  TYPE9I PIC  X(0001).
  1691*    -------------------------------
  1692     05  AMT9L PIC S9(0004) COMP.
  1693     05  AMT9F PIC  X(0001).
  1694     05  FILLER REDEFINES AMT9F.
  1695         10  AMT9A PIC  X(0001).
  1696     05  AMT9I PIC  X(0011).
  1697*    -------------------------------
  1698     05  VOID9L PIC S9(0004) COMP.
  1699     05  VOID9F PIC  X(0001).
  1700     05  FILLER REDEFINES VOID9F.
  1701         10  VOID9A PIC  X(0001).
  1702     05  VOID9I PIC  X(0001).
  1703*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  36
* EL633.cbl
  1704     05  MDT9L PIC S9(0004) COMP.
  1705     05  MDT9F PIC  X(0001).
  1706     05  FILLER REDEFINES MDT9F.
  1707         10  MDT9A PIC  X(0001).
  1708     05  MDT9I PIC  X(0006).
  1709*    -------------------------------
  1710     05  BDT9L PIC S9(0004) COMP.
  1711     05  BDT9F PIC  X(0001).
  1712     05  FILLER REDEFINES BDT9F.
  1713         10  BDT9A PIC  X(0001).
  1714     05  BDT9I PIC  X(0006).
  1715*    -------------------------------
  1716     05  SDT9L PIC S9(0004) COMP.
  1717     05  SDT9F PIC  X(0001).
  1718     05  FILLER REDEFINES SDT9F.
  1719         10  SDT9A PIC  X(0001).
  1720     05  SDT9I PIC  X(0006).
  1721*    -------------------------------
  1722     05  MSAAC10L PIC S9(0004) COMP.
  1723     05  MSAAC10F PIC  X(0001).
  1724     05  FILLER REDEFINES MSAAC10F.
  1725         10  MSAAC10A PIC  X(0001).
  1726     05  MSAAC10I PIC  X(0010).
  1727*    -------------------------------
  1728     05  MSAST10L PIC S9(0004) COMP.
  1729     05  MSAST10F PIC  X(0001).
  1730     05  FILLER REDEFINES MSAST10F.
  1731         10  MSAST10A PIC  X(0001).
  1732     05  MSAST10I PIC  X(0002).
  1733*    -------------------------------
  1734     05  MSACN10L PIC S9(0004) COMP.
  1735     05  MSACN10F PIC  X(0001).
  1736     05  FILLER REDEFINES MSACN10F.
  1737         10  MSACN10A PIC  X(0001).
  1738     05  MSACN10I PIC  X(0001).
  1739*    -------------------------------
  1740     05  MSACM10L PIC S9(0004) COMP.
  1741     05  MSACM10F PIC  X(0001).
  1742     05  FILLER REDEFINES MSACM10F.
  1743         10  MSACM10A PIC  X(0001).
  1744     05  MSACM10I PIC  X(0010).
  1745*    -------------------------------
  1746     05  TYPE10L PIC S9(0004) COMP.
  1747     05  TYPE10F PIC  X(0001).
  1748     05  FILLER REDEFINES TYPE10F.
  1749         10  TYPE10A PIC  X(0001).
  1750     05  TYPE10I PIC  X(0001).
  1751*    -------------------------------
  1752     05  AMT10L PIC S9(0004) COMP.
  1753     05  AMT10F PIC  X(0001).
  1754     05  FILLER REDEFINES AMT10F.
  1755         10  AMT10A PIC  X(0001).
  1756     05  AMT10I PIC  X(0011).
  1757*    -------------------------------
  1758     05  VOID10L PIC S9(0004) COMP.
  1759     05  VOID10F PIC  X(0001).
  1760     05  FILLER REDEFINES VOID10F.
  1761         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  37
* EL633.cbl
  1762     05  VOID10I PIC  X(0001).
  1763*    -------------------------------
  1764     05  MDT10L PIC S9(0004) COMP.
  1765     05  MDT10F PIC  X(0001).
  1766     05  FILLER REDEFINES MDT10F.
  1767         10  MDT10A PIC  X(0001).
  1768     05  MDT10I PIC  X(0006).
  1769*    -------------------------------
  1770     05  BDT10L PIC S9(0004) COMP.
  1771     05  BDT10F PIC  X(0001).
  1772     05  FILLER REDEFINES BDT10F.
  1773         10  BDT10A PIC  X(0001).
  1774     05  BDT10I PIC  X(0006).
  1775*    -------------------------------
  1776     05  SDT10L PIC S9(0004) COMP.
  1777     05  SDT10F PIC  X(0001).
  1778     05  FILLER REDEFINES SDT10F.
  1779         10  SDT10A PIC  X(0001).
  1780     05  SDT10I PIC  X(0006).
  1781*    -------------------------------
  1782     05  MSAAC11L PIC S9(0004) COMP.
  1783     05  MSAAC11F PIC  X(0001).
  1784     05  FILLER REDEFINES MSAAC11F.
  1785         10  MSAAC11A PIC  X(0001).
  1786     05  MSAAC11I PIC  X(0010).
  1787*    -------------------------------
  1788     05  MSAST11L PIC S9(0004) COMP.
  1789     05  MSAST11F PIC  X(0001).
  1790     05  FILLER REDEFINES MSAST11F.
  1791         10  MSAST11A PIC  X(0001).
  1792     05  MSAST11I PIC  X(0002).
  1793*    -------------------------------
  1794     05  MSACN11L PIC S9(0004) COMP.
  1795     05  MSACN11F PIC  X(0001).
  1796     05  FILLER REDEFINES MSACN11F.
  1797         10  MSACN11A PIC  X(0001).
  1798     05  MSACN11I PIC  X(0001).
  1799*    -------------------------------
  1800     05  MSACM11L PIC S9(0004) COMP.
  1801     05  MSACM11F PIC  X(0001).
  1802     05  FILLER REDEFINES MSACM11F.
  1803         10  MSACM11A PIC  X(0001).
  1804     05  MSACM11I PIC  X(0010).
  1805*    -------------------------------
  1806     05  TYPE11L PIC S9(0004) COMP.
  1807     05  TYPE11F PIC  X(0001).
  1808     05  FILLER REDEFINES TYPE11F.
  1809         10  TYPE11A PIC  X(0001).
  1810     05  TYPE11I PIC  X(0001).
  1811*    -------------------------------
  1812     05  AMT11L PIC S9(0004) COMP.
  1813     05  AMT11F PIC  X(0001).
  1814     05  FILLER REDEFINES AMT11F.
  1815         10  AMT11A PIC  X(0001).
  1816     05  AMT11I PIC  X(0011).
  1817*    -------------------------------
  1818     05  VOID11L PIC S9(0004) COMP.
  1819     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  38
* EL633.cbl
  1820     05  FILLER REDEFINES VOID11F.
  1821         10  VOID11A PIC  X(0001).
  1822     05  VOID11I PIC  X(0001).
  1823*    -------------------------------
  1824     05  MDT11L PIC S9(0004) COMP.
  1825     05  MDT11F PIC  X(0001).
  1826     05  FILLER REDEFINES MDT11F.
  1827         10  MDT11A PIC  X(0001).
  1828     05  MDT11I PIC  X(0006).
  1829*    -------------------------------
  1830     05  BDT11L PIC S9(0004) COMP.
  1831     05  BDT11F PIC  X(0001).
  1832     05  FILLER REDEFINES BDT11F.
  1833         10  BDT11A PIC  X(0001).
  1834     05  BDT11I PIC  X(0006).
  1835*    -------------------------------
  1836     05  SDT11L PIC S9(0004) COMP.
  1837     05  SDT11F PIC  X(0001).
  1838     05  FILLER REDEFINES SDT11F.
  1839         10  SDT11A PIC  X(0001).
  1840     05  SDT11I PIC  X(0006).
  1841*    -------------------------------
  1842     05  MSAAC12L PIC S9(0004) COMP.
  1843     05  MSAAC12F PIC  X(0001).
  1844     05  FILLER REDEFINES MSAAC12F.
  1845         10  MSAAC12A PIC  X(0001).
  1846     05  MSAAC12I PIC  X(0010).
  1847*    -------------------------------
  1848     05  MSAST12L PIC S9(0004) COMP.
  1849     05  MSAST12F PIC  X(0001).
  1850     05  FILLER REDEFINES MSAST12F.
  1851         10  MSAST12A PIC  X(0001).
  1852     05  MSAST12I PIC  X(0002).
  1853*    -------------------------------
  1854     05  MSACN12L PIC S9(0004) COMP.
  1855     05  MSACN12F PIC  X(0001).
  1856     05  FILLER REDEFINES MSACN12F.
  1857         10  MSACN12A PIC  X(0001).
  1858     05  MSACN12I PIC  X(0001).
  1859*    -------------------------------
  1860     05  MSACM12L PIC S9(0004) COMP.
  1861     05  MSACM12F PIC  X(0001).
  1862     05  FILLER REDEFINES MSACM12F.
  1863         10  MSACM12A PIC  X(0001).
  1864     05  MSACM12I PIC  X(0010).
  1865*    -------------------------------
  1866     05  TYPE12L PIC S9(0004) COMP.
  1867     05  TYPE12F PIC  X(0001).
  1868     05  FILLER REDEFINES TYPE12F.
  1869         10  TYPE12A PIC  X(0001).
  1870     05  TYPE12I PIC  X(0001).
  1871*    -------------------------------
  1872     05  AMT12L PIC S9(0004) COMP.
  1873     05  AMT12F PIC  X(0001).
  1874     05  FILLER REDEFINES AMT12F.
  1875         10  AMT12A PIC  X(0001).
  1876     05  AMT12I PIC  X(0011).
  1877*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  39
* EL633.cbl
  1878     05  VOID12L PIC S9(0004) COMP.
  1879     05  VOID12F PIC  X(0001).
  1880     05  FILLER REDEFINES VOID12F.
  1881         10  VOID12A PIC  X(0001).
  1882     05  VOID12I PIC  X(0001).
  1883*    -------------------------------
  1884     05  MDT12L PIC S9(0004) COMP.
  1885     05  MDT12F PIC  X(0001).
  1886     05  FILLER REDEFINES MDT12F.
  1887         10  MDT12A PIC  X(0001).
  1888     05  MDT12I PIC  X(0006).
  1889*    -------------------------------
  1890     05  BDT12L PIC S9(0004) COMP.
  1891     05  BDT12F PIC  X(0001).
  1892     05  FILLER REDEFINES BDT12F.
  1893         10  BDT12A PIC  X(0001).
  1894     05  BDT12I PIC  X(0006).
  1895*    -------------------------------
  1896     05  SDT12L PIC S9(0004) COMP.
  1897     05  SDT12F PIC  X(0001).
  1898     05  FILLER REDEFINES SDT12F.
  1899         10  SDT12A PIC  X(0001).
  1900     05  SDT12I PIC  X(0006).
  1901*    -------------------------------
  1902     05  MSAAC13L PIC S9(0004) COMP.
  1903     05  MSAAC13F PIC  X(0001).
  1904     05  FILLER REDEFINES MSAAC13F.
  1905         10  MSAAC13A PIC  X(0001).
  1906     05  MSAAC13I PIC  X(0010).
  1907*    -------------------------------
  1908     05  MSAST13L PIC S9(0004) COMP.
  1909     05  MSAST13F PIC  X(0001).
  1910     05  FILLER REDEFINES MSAST13F.
  1911         10  MSAST13A PIC  X(0001).
  1912     05  MSAST13I PIC  X(0002).
  1913*    -------------------------------
  1914     05  MSACN13L PIC S9(0004) COMP.
  1915     05  MSACN13F PIC  X(0001).
  1916     05  FILLER REDEFINES MSACN13F.
  1917         10  MSACN13A PIC  X(0001).
  1918     05  MSACN13I PIC  X(0001).
  1919*    -------------------------------
  1920     05  MSACM13L PIC S9(0004) COMP.
  1921     05  MSACM13F PIC  X(0001).
  1922     05  FILLER REDEFINES MSACM13F.
  1923         10  MSACM13A PIC  X(0001).
  1924     05  MSACM13I PIC  X(0010).
  1925*    -------------------------------
  1926     05  TYPE13L PIC S9(0004) COMP.
  1927     05  TYPE13F PIC  X(0001).
  1928     05  FILLER REDEFINES TYPE13F.
  1929         10  TYPE13A PIC  X(0001).
  1930     05  TYPE13I PIC  X(0001).
  1931*    -------------------------------
  1932     05  AMT13L PIC S9(0004) COMP.
  1933     05  AMT13F PIC  X(0001).
  1934     05  FILLER REDEFINES AMT13F.
  1935         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  40
* EL633.cbl
  1936     05  AMT13I PIC  X(0011).
  1937*    -------------------------------
  1938     05  VOID13L PIC S9(0004) COMP.
  1939     05  VOID13F PIC  X(0001).
  1940     05  FILLER REDEFINES VOID13F.
  1941         10  VOID13A PIC  X(0001).
  1942     05  VOID13I PIC  X(0001).
  1943*    -------------------------------
  1944     05  MDT13L PIC S9(0004) COMP.
  1945     05  MDT13F PIC  X(0001).
  1946     05  FILLER REDEFINES MDT13F.
  1947         10  MDT13A PIC  X(0001).
  1948     05  MDT13I PIC  X(0006).
  1949*    -------------------------------
  1950     05  BDT13L PIC S9(0004) COMP.
  1951     05  BDT13F PIC  X(0001).
  1952     05  FILLER REDEFINES BDT13F.
  1953         10  BDT13A PIC  X(0001).
  1954     05  BDT13I PIC  X(0006).
  1955*    -------------------------------
  1956     05  SDT13L PIC S9(0004) COMP.
  1957     05  SDT13F PIC  X(0001).
  1958     05  FILLER REDEFINES SDT13F.
  1959         10  SDT13A PIC  X(0001).
  1960     05  SDT13I PIC  X(0006).
  1961*    -------------------------------
  1962     05  ERRMSG1L PIC S9(0004) COMP.
  1963     05  ERRMSG1F PIC  X(0001).
  1964     05  FILLER REDEFINES ERRMSG1F.
  1965         10  ERRMSG1A PIC  X(0001).
  1966     05  ERRMSG1I PIC  X(0079).
  1967*    -------------------------------
  1968     05  ERRMSG2L PIC S9(0004) COMP.
  1969     05  ERRMSG2F PIC  X(0001).
  1970     05  FILLER REDEFINES ERRMSG2F.
  1971         10  ERRMSG2A PIC  X(0001).
  1972     05  ERRMSG2I PIC  X(0079).
  1973*    -------------------------------
  1974     05  PFENTERL PIC S9(0004) COMP.
  1975     05  PFENTERF PIC  X(0001).
  1976     05  FILLER REDEFINES PFENTERF.
  1977         10  PFENTERA PIC  X(0001).
  1978     05  PFENTERI PIC  9(2).
  1979 01  EL633AO REDEFINES EL633AI.
  1980     05  FILLER            PIC  X(0012).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  DATEO PIC  X(0008).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  TIMEO PIC  99.99.
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  CMPNYIDO PIC  X(0003).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  USERIDO PIC  X(0004).
  1993*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  41
* EL633.cbl
  1994     05  FILLER            PIC  X(0003).
  1995     05  MAINTO PIC  X(0001).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  CARRIERO PIC  X(0001).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  GROUPO PIC  X(0006).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  FINRESPO PIC  X(0010).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  ACCTO PIC  X(0010).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  MSAAC1O PIC  X(0010).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  MSAST1O PIC  X(0002).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  MSACN1O PIC  X(0001).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  MSACM1O PIC  X(0010).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  TYPE1O PIC  X(0001).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  AMT1O PIC  X(0011).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  VOID1O PIC  X(0001).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  MDT1O PIC  X(0006).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  BDT1O PIC  X(0006).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  SDT1O PIC  X(0006).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  MSAAC2O PIC  X(0010).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  MSAST2O PIC  X(0002).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  MSACN2O PIC  X(0001).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  MSACM2O PIC  X(0010).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  42
* EL633.cbl
  2052     05  TYPE2O PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  AMT2O PIC  X(0011).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  VOID2O PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  MDT2O PIC  X(0006).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BDT2O PIC  X(0006).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  SDT2O PIC  X(0006).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  MSAAC3O PIC  X(0010).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  MSAST3O PIC  X(0002).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  MSACN3O PIC  X(0001).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  MSACM3O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  TYPE3O PIC  X(0001).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  AMT3O PIC  X(0011).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  VOID3O PIC  X(0001).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  MDT3O PIC  X(0006).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BDT3O PIC  X(0006).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  SDT3O PIC  X(0006).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  MSAAC4O PIC  X(0010).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  MSAST4O PIC  X(0002).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  MSACN4O PIC  X(0001).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  43
* EL633.cbl
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  TYPE4O PIC  X(0001).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  AMT4O PIC  X(0011).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  VOID4O PIC  X(0001).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  MDT4O PIC  X(0006).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  BDT4O PIC  X(0006).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  SDT4O PIC  X(0006).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  MSAAC5O PIC  X(0010).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  MSAST5O PIC  X(0002).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  MSACN5O PIC  X(0001).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  MSACM5O PIC  X(0010).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  TYPE5O PIC  X(0001).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  AMT5O PIC  X(0011).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  VOID5O PIC  X(0001).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  MDT5O PIC  X(0006).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  BDT5O PIC  X(0006).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  SDT5O PIC  X(0006).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  MSAAC6O PIC  X(0010).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  MSAST6O PIC  X(0002).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  MSACN6O PIC  X(0001).
  2167*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  44
* EL633.cbl
  2168     05  FILLER            PIC  X(0003).
  2169     05  MSACM6O PIC  X(0010).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  TYPE6O PIC  X(0001).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  AMT6O PIC  X(0011).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  VOID6O PIC  X(0001).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  MDT6O PIC  X(0006).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  BDT6O PIC  X(0006).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  SDT6O PIC  X(0006).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  MSAAC7O PIC  X(0010).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  MSAST7O PIC  X(0002).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  MSACN7O PIC  X(0001).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  MSACM7O PIC  X(0010).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  TYPE7O PIC  X(0001).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  AMT7O PIC  X(0011).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  VOID7O PIC  X(0001).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  MDT7O PIC  X(0006).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  BDT7O PIC  X(0006).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  SDT7O PIC  X(0006).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  MSAAC8O PIC  X(0010).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  MSAST8O PIC  X(0002).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  45
* EL633.cbl
  2226     05  MSACN8O PIC  X(0001).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  MSACM8O PIC  X(0010).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  TYPE8O PIC  X(0001).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  AMT8O PIC  X(0011).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  VOID8O PIC  X(0001).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  MDT8O PIC  X(0006).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  BDT8O PIC  X(0006).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  SDT8O PIC  X(0006).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  MSAAC9O PIC  X(0010).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  MSAST9O PIC  X(0002).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  MSACN9O PIC  X(0001).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  MSACM9O PIC  X(0010).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  TYPE9O PIC  X(0001).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  AMT9O PIC  X(0011).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  VOID9O PIC  X(0001).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  MDT9O PIC  X(0006).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  BDT9O PIC  X(0006).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  SDT9O PIC  X(0006).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  MSAAC10O PIC  X(0010).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  46
* EL633.cbl
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  MSACN10O PIC  X(0001).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  MSACM10O PIC  X(0010).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  TYPE10O PIC  X(0001).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  AMT10O PIC  X(0011).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  VOID10O PIC  X(0001).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  MDT10O PIC  X(0006).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  BDT10O PIC  X(0006).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  SDT10O PIC  X(0006).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  MSAAC11O PIC  X(0010).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  MSAST11O PIC  X(0002).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  MSACN11O PIC  X(0001).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  MSACM11O PIC  X(0010).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  TYPE11O PIC  X(0001).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  AMT11O PIC  X(0011).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  VOID11O PIC  X(0001).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  MDT11O PIC  X(0006).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  BDT11O PIC  X(0006).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  SDT11O PIC  X(0006).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  MSAAC12O PIC  X(0010).
  2341*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  47
* EL633.cbl
  2342     05  FILLER            PIC  X(0003).
  2343     05  MSAST12O PIC  X(0002).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  MSACN12O PIC  X(0001).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  MSACM12O PIC  X(0010).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  TYPE12O PIC  X(0001).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  AMT12O PIC  X(0011).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  VOID12O PIC  X(0001).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  MDT12O PIC  X(0006).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  BDT12O PIC  X(0006).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  SDT12O PIC  X(0006).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  MSAAC13O PIC  X(0010).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  MSAST13O PIC  X(0002).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  MSACN13O PIC  X(0001).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  MSACM13O PIC  X(0010).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  TYPE13O PIC  X(0001).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  AMT13O PIC  X(0011).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  VOID13O PIC  X(0001).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  MDT13O PIC  X(0006).
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  BDT13O PIC  X(0006).
  2395*    -------------------------------
  2396     05  FILLER            PIC  X(0003).
  2397     05  SDT13O PIC  X(0006).
  2398*    -------------------------------
  2399     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  48
* EL633.cbl
  2400     05  ERRMSG1O PIC  X(0079).
  2401*    -------------------------------
  2402     05  FILLER            PIC  X(0003).
  2403     05  ERRMSG2O PIC  X(0079).
  2404*    -------------------------------
  2405     05  FILLER            PIC  X(0003).
  2406     05  PFENTERO PIC  X(0002).
  2407*    -------------------------------
  2408
  2409 01  MAP-EL633A  REDEFINES  EL633AI.
  2410     12  FILLER                  PIC  X(87).
  2411     12  DATA-AREA       OCCURS 13 TIMES
  2412                             INDEXED BY PINDX.
  2413         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2414         16  GL-ACCT-ATTRB       PIC  X.
  2415         16  GL-ACCT             PIC  X(10).
  2416         16  WSL-COMM  REDEFINES GL-ACCT.
  2417             20  WSL-COMM-DTE.
  2418                 24  WSL-MO      PIC  X(2).
  2419                 24  WSL-DA      PIC  X(2).
  2420                 24  WSL-YR      PIC  X(2).
  2421             20  WSL-COMM-REST   PIC  X(4).
  2422         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2423         16  GL-STATE-ATTRB      PIC  X.
  2424         16  GL-STATE            PIC  X(02).
  2425         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2426         16  GL-CANC-ATTRB       PIC  X.
  2427         16  GL-CANC             PIC  X.
  2428         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2429         16  GL-COMM-ATTRB       PIC  X.
  2430         16  GL-COMM             PIC  X(10).
  2431         16  RTYPE-LEN           PIC S9(4)              COMP.
  2432         16  RTYPE-ATTRB         PIC  X.
  2433         16  RTYPE               PIC  X.
  2434         16  AMT-LEN             PIC S9(4)              COMP.
  2435         16  AMT-ATTRB           PIC  X.
  2436         16  AMT                 PIC S9(9)V9(2).
  2437         16  AMTO  REDEFINES
  2438             AMT                 PIC Z(7).9(2)-.
  2439         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2440         16  VOID-SW-ATTRB       PIC  X.
  2441         16  VOID-SW             PIC  X.
  2442         16  MDTE-LEN            PIC S9(4)              COMP.
  2443         16  MDTE-ATTRB          PIC  X.
  2444         16  MDTE                PIC  X(6).
  2445         16  BDTE-LEN            PIC S9(4)              COMP.
  2446         16  BDTE-ATTRB          PIC  X.
  2447         16  BDTE                PIC  X(6).
  2448         16  SDTE-LEN            PIC S9(4)              COMP.
  2449         16  SDTE-ATTRB          PIC  X.
  2450         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  49
* EL633.cbl
  2452****************************************************************
  2453*
  2454* Copyright (c) 2007 by Clerity Solutions, Inc.
  2455* All rights reserved.
  2456*
  2457****************************************************************
  2458 01  DFHEIV.
  2459   02  DFHEIV0               PIC X(35).
  2460   02  DFHEIV1               PIC X(08).
  2461   02  DFHEIV2               PIC X(08).
  2462   02  DFHEIV3               PIC X(08).
  2463   02  DFHEIV4               PIC X(06).
  2464   02  DFHEIV5               PIC X(04).
  2465   02  DFHEIV6               PIC X(04).
  2466   02  DFHEIV7               PIC X(02).
  2467   02  DFHEIV8               PIC X(02).
  2468   02  DFHEIV9               PIC X(01).
  2469   02  DFHEIV10              PIC S9(7) COMP-3.
  2470   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2471   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2472   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2473   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2474   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2475   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2476   02  DFHEIV17              PIC X(04).
  2477   02  DFHEIV18              PIC X(04).
  2478   02  DFHEIV19              PIC X(04).
  2479   02  DFHEIV20              USAGE IS POINTER.
  2480   02  DFHEIV21              USAGE IS POINTER.
  2481   02  DFHEIV22              USAGE IS POINTER.
  2482   02  DFHEIV23              USAGE IS POINTER.
  2483   02  DFHEIV24              USAGE IS POINTER.
  2484   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2485   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2486   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2487   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2488   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2489   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2490   02  FILLER                PIC X(02).
  2491   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2492   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2493   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2494   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2495   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2496 LINKAGE  SECTION.
  2497*****************************************************************
  2498*                                                               *
  2499* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2500* All rights reserved.                                          *
  2501*                                                               *
  2502*****************************************************************
  2503 01  dfheiblk.
  2504     02  eibtime          pic s9(7) comp-3.
  2505     02  eibdate          pic s9(7) comp-3.
  2506     02  eibtrnid         pic x(4).
  2507     02  eibtaskn         pic s9(7) comp-3.
  2508     02  eibtrmid         pic x(4).
  2509     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  50
* EL633.cbl
  2510     02  eibcposn         pic s9(4) comp.
  2511     02  eibcalen         pic s9(4) comp.
  2512     02  eibaid           pic x(1).
  2513     02  eibfiller1       pic x(1).
  2514     02  eibfn            pic x(2).
  2515     02  eibfiller2       pic x(2).
  2516     02  eibrcode         pic x(6).
  2517     02  eibfiller3       pic x(2).
  2518     02  eibds            pic x(8).
  2519     02  eibreqid         pic x(8).
  2520     02  eibrsrce         pic x(8).
  2521     02  eibsync          pic x(1).
  2522     02  eibfree          pic x(1).
  2523     02  eibrecv          pic x(1).
  2524     02  eibsend          pic x(1).
  2525     02  eibatt           pic x(1).
  2526     02  eibeoc           pic x(1).
  2527     02  eibfmh           pic x(1).
  2528     02  eibcompl         pic x(1).
  2529     02  eibsig           pic x(1).
  2530     02  eibconf          pic x(1).
  2531     02  eiberr           pic x(1).
  2532     02  eibrldbk         pic x(1).
  2533     02  eiberrcd         pic x(4).
  2534     02  eibsynrb         pic x(1).
  2535     02  eibnodat         pic x(1).
  2536     02  eibfiller5       pic x(2).
  2537     02  eibresp          pic 9(09) comp.
  2538     02  eibresp2         pic 9(09) comp.
  2539     02  dfheigdj         pic s9(4) comp.
  2540     02  dfheigdk         pic s9(4) comp.
  2541 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  51
* EL633.cbl
  2542/
  2543*                            COPY ERCCHKQ.
  2544******************************************************************
  2545*                                                                *
  2546*                                                                *
  2547*                            ERCCHKQ                             *
  2548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2549*                            VMOD=2.005                          *
  2550*                                                                *
  2551*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2552*                                                                *
  2553*   FILE TYPE = VSAM,KSDS                                        *
  2554*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2555*                                                                *
  2556*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2557*       ALTERNATE PATH  = NONE                                   *
  2558*                                                                *
  2559*   LOG = YES                                                    *
  2560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2561******************************************************************
  2562 01  CHECK-QUE.
  2563     12  CQ-RECORD-ID                PIC XX.
  2564         88  VALID-CQ-ID                     VALUE 'CQ'.
  2565
  2566     12  CQ-CONTROL-PRIMARY.
  2567         16  CQ-COMPANY-CD           PIC X.
  2568         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2569         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2570
  2571     12  CQ-ENTRY-TYPE               PIC X.
  2572             88  CHECK-ON-QUE           VALUE 'Q'.
  2573             88  ALIGNMENT-CHECK        VALUE 'A'.
  2574             88  MANUAL-CHECK           VALUE 'M'.
  2575             88  SPOILED-CHECK          VALUE 'S'.
  2576             88  VOIDED-CHECK           VALUE 'V'.
  2577             88  PAYMENT-ABORTED        VALUE 'X'.
  2578
  2579     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2580
  2581     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2582         CQ-CREDIT-MASTER-CNTL.
  2583         16  CQ-PYAJ-CARRIER         PIC X.
  2584         16  CQ-PYAJ-GROUPING        PIC X(6).
  2585         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2586         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2587         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2588         16  CQ-PYAJ-REC-TYPE        PIC X.
  2589         16  FILLER                  PIC X(18).
  2590
  2591     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2592         CQ-CREDIT-MASTER-CNTL.
  2593         16  CQ-CHEK-CARRIER         PIC X.
  2594         16  CQ-CHEK-GROUPING        PIC X(6).
  2595         16  CQ-CHEK-STATE           PIC XX.
  2596         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2597         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2598         16  CQ-CHEK-CERT-NO.
  2599             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  52
* EL633.cbl
  2600             20  CQ-CHEK-CERT-SFX    PIC X.
  2601         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2602         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2603         16  FILLER                  PIC X(06).
  2604
  2605     12  CQ-CHECK-NUMBER             PIC X(7).
  2606     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2607     12  CQ-PAYMENT-TYPE             PIC X.
  2608             88  CQ-BILLING-CREDIT         VALUE '1'.
  2609             88  CQ-REFUND-PMT             VALUE '2'.
  2610             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2611     12  CQ-VOID-INDICATOR           PIC X.
  2612             88  CHECK-IS-VOID             VALUE 'V'.
  2613     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2614     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2615     12  CQ-CHECK-BY-USER            PIC X(4).
  2616     12  CQ-PRE-NUMBERING-SW         PIC X.
  2617       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2618       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2619
  2620     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2621     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2622     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2623     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2624
  2625     12  CQ-LETTERS-IND              PIC X.
  2626         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2627
  2628******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  53
* EL633.cbl
  2629/
  2630*                            COPY ERCPYAJ.
  2631******************************************************************
  2632*                                                                *
  2633*                            ERCPYAJ                             *
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2635*                            VMOD=2.015                          *
  2636*                                                                *
  2637*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2638*                                                                *
  2639*                                                                *
  2640*   FILE TYPE = VSAM,KSDS                                        *
  2641*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2642*                                                                *
  2643*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2644*       ALTERNATE PATHS = NONE                                   *
  2645*                                                                *
  2646*   LOG = YES                                                    *
  2647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2648******************************************************************
  2649******************************************************************
  2650*                   C H A N G E   L O G
  2651*
  2652* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2653*-----------------------------------------------------------------
  2654*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2655* EFFECTIVE    NUMBER
  2656*-----------------------------------------------------------------
  2657* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2658* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2659******************************************************************
  2660
  2661 01  PENDING-PAY-ADJ.
  2662     12  PY-RECORD-ID                     PIC XX.
  2663         88  VALID-PY-ID                        VALUE 'PY'.
  2664
  2665     12  PY-CONTROL-PRIMARY.
  2666         16  PY-COMPANY-CD                PIC X.
  2667         16  PY-CARRIER                   PIC X.
  2668         16  PY-GROUPING                  PIC X(6).
  2669         16  PY-FIN-RESP                  PIC X(10).
  2670         16  PY-ACCOUNT                   PIC X(10).
  2671         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2672                                          PIC X(10).
  2673         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2674         16  PY-RECORD-TYPE               PIC X.
  2675             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2676             88  PY-DEPOSIT                   VALUE 'D'.
  2677             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2678             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2679             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2680             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2681             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2682             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2683             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2684             88  PY-FICA-ENTRY                VALUE 'F'.
  2685             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2686             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  54
* EL633.cbl
  2687             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2688
  2689     12  PY-PYMT-TYPE                     PIC X.
  2690             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2691             88  PY-REINS-PYMT                VALUE 'R'.
  2692             88  PY-EXP-PYMT                  VALUE 'E'.
  2693
  2694     12  PY-BIL-INV                       PIC X(6).
  2695     12  PY-REF-NO                        PIC X(12).
  2696
  2697     12  PY-LAST-MAINT-DT                 PIC XX.
  2698     12  PY-LAST-MAINT-BY                 PIC X(4).
  2699     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2700
  2701     12  PY-PYADJ-RECORD.
  2702         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2703         16  PY-ENTRY-COMMENT             PIC X(30).
  2704         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2705             20  PY-GL-ACCOUNT            PIC X(10).
  2706             20  PY-GL-STATE              PIC X(02).
  2707             20  PY-GL-CANC-SW            PIC X(01).
  2708                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2709                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2710             20  PY-GL-COMMENT            PIC X(10).
  2711             20  FILLER      REDEFINES PY-GL-COMMENT.
  2712                 24  PY-GL-CHECK-NO       PIC 9(06).
  2713                 24  FILLER               PIC X(04).
  2714             20  FILLER                   PIC X(07).
  2715         16  PY-SAVE-ACCOUNT              PIC X(10).
  2716         16  PY-SAVE-TYPE                 PIC X(01).
  2717
  2718         16  PY-LETTERS.
  2719             20  PY-LETTER OCCURS 3 TIMES
  2720                           INDEXED BY PY-LET-NDX
  2721                                          PIC X(04).
  2722
  2723         16  PY-ERCOMP-TYPE               PIC X.
  2724             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2725             88  PY-GA-TYPE                   VALUE 'G'.
  2726             88  PY-BANK-TYPE                 VALUE 'B'.
  2727         16  FILLER                       PIC X(05).
  2728
  2729     12  PY-RECORD-STATUS.
  2730         16  PY-CREDIT-SELECT-DT          PIC XX.
  2731         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2732         16  PY-BILLED-DATE               PIC XX.
  2733         16  PY-REPORTED-DT               PIC XX.
  2734         16  PY-PMT-APPLIED               PIC X.
  2735             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2736             88  PY-GA-PMT                    VALUE 'G'.
  2737             88  PY-OVWRITE-PMT               VALUE 'O'.
  2738             88  PY-NON-AR-PMT                VALUE 'N'.
  2739         16  FILLER                       PIC X(5).
  2740         16  PY-INPUT-DT                  PIC XX.
  2741         16  PY-CHECK-NUMBER              PIC X(6).
  2742         16  PY-VOID-SW                   PIC X.
  2743             88  PY-CHECK-VOIDED              VALUE 'V'.
  2744         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  55
* EL633.cbl
  2745             88  PY-BILLING-CHECK             VALUE 'B'.
  2746             88  PY-REFUND-CHECK              VALUE 'R'.
  2747             88  PY-GA-CHECK                  VALUE 'G'.
  2748             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2749             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2750         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2751         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2752         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2753         16  PY-BILL-FLAG                 PIC X.
  2754             88  PY-BILLED                    VALUE 'B'.
  2755         16  PY-AR-FLAG                   PIC X.
  2756             88  PY-AR-CYCLE                  VALUE 'C'.
  2757             88  PY-AR-MONTH-END              VALUE 'M'.
  2758         16  PY-AR-DATE                   PIC XX.
  2759
  2760     12  PY-GL-CODES.
  2761         16  PY-GL-DB                     PIC X(14).
  2762         16  PY-GL-CR                     PIC X(14).
  2763         16  PY-GL-FLAG                   PIC X.
  2764         16  PY-GL-DATE                   PIC XX.
  2765
  2766     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2767     12  FILLER                           PIC X(3).
  2768******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  56
* EL633.cbl
  2769/
  2770*                            COPY ERCCOMP.
  2771******************************************************************
  2772*                                                                *
  2773*                                                                *
  2774*                            ERCCOMP                             *
  2775*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2776*                            VMOD=2.019                          *
  2777*                                                                *
  2778*   ONLINE CREDIT SYSTEM                                         *
  2779*                                                                *
  2780*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2781*                                                                *
  2782*   FILE TYPE = VSAM,KSDS                                        *
  2783*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2784*                                                                *
  2785*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2786*       ALTERNATE PATH = NONE                                    *
  2787*                                                                *
  2788*   LOG = NO                                                     *
  2789*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790*                                                                *
  2791******************************************************************
  2792*                   C H A N G E   L O G
  2793*
  2794* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2795*-----------------------------------------------------------------
  2796*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2797* EFFECTIVE    NUMBER
  2798*-----------------------------------------------------------------
  2799* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2800* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2801* 092205    2005050300006  PEMA  ADD LEASE FEE
  2802* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2803* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2804* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2805* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2806* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2807* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2808******************************************************************
  2809
  2810 01  COMPENSATION-MASTER.
  2811     12  CO-RECORD-ID                          PIC XX.
  2812         88  VALID-CO-ID                          VALUE 'CO'.
  2813
  2814     12  CO-CONTROL-PRIMARY.
  2815         16  CO-COMPANY-CD                     PIC X.
  2816         16  CO-CONTROL.
  2817             20  CO-CTL-1.
  2818                 24  CO-CARR-GROUP.
  2819                     28  CO-CARRIER            PIC X.
  2820                     28  CO-GROUPING.
  2821                         32  CO-GROUP-PREFIX   PIC XXX.
  2822                         32  CO-GROUP-PRIME    PIC XXX.
  2823                 24  CO-RESP-NO.
  2824                     28  CO-RESP-PREFIX        PIC X(4).
  2825                     28  CO-RESP-PRIME         PIC X(6).
  2826             20  CO-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  57
* EL633.cbl
  2827                 24  CO-ACCOUNT.
  2828                     28  CO-ACCT-PREFIX        PIC X(4).
  2829                     28  CO-ACCT-PRIME         PIC X(6).
  2830         16  CO-TYPE                           PIC X.
  2831             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2832             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2833             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2834
  2835     12  CO-MAINT-INFORMATION.
  2836         16  CO-LAST-MAINT-DT                  PIC XX.
  2837         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2838         16  CO-LAST-MAINT-USER                PIC X(4).
  2839     12  FILLER                                PIC XX.
  2840     12  CO-STMT-TYPE                          PIC XXX.
  2841     12  CO-COMP-TYPE                          PIC X.
  2842         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2843     12  CO-STMT-OWNER                         PIC X(4).
  2844     12  CO-BALANCE-CONTROL                    PIC X.
  2845         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2846         88  CO-NO-BALANCE                        VALUE 'N'.
  2847
  2848     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2849         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2850         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2851         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2852
  2853     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2854         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2855         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2856
  2857     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2858     12  CO-GA-DIRECT-DEP                      PIC X.
  2859     12  CO-FUTURE-SPACE                       PIC X.
  2860         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2861
  2862     12  CO-ACCT-NAME                          PIC X(30).
  2863     12  CO-MAIL-NAME                          PIC X(30).
  2864     12  CO-ADDR-1                             PIC X(30).
  2865     12  CO-ADDR-2                             PIC X(30).
  2866     12  CO-ADDR-3.
  2867         16  CO-ADDR-CITY                      PIC X(27).
  2868         16  CO-ADDR-STATE                     PIC XX.
  2869     12  CO-CSO-1099                           PIC X.
  2870     12  CO-ZIP.
  2871         16  CO-ZIP-PRIME.
  2872             20  CO-ZIP-PRI-1ST                PIC X.
  2873                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2874             20  FILLER                        PIC X(4).
  2875         16  CO-ZIP-PLUS4                      PIC X(4).
  2876     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2877         16  CO-CAN-POSTAL-1                   PIC XXX.
  2878         16  CO-CAN-POSTAL-2                   PIC XXX.
  2879         16  FILLER                            PIC XXX.
  2880     12  CO-SOC-SEC                            PIC X(13).
  2881     12  CO-TELEPHONE.
  2882         16  CO-AREA-CODE                      PIC XXX.
  2883         16  CO-PREFIX                         PIC XXX.
  2884         16  CO-PHONE                          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  58
* EL633.cbl
  2885
  2886     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2887
  2888     12  CO-AR-BAL-LEVEL                       PIC X.
  2889         88  CO-AR-REF-LVL                        VALUE '1'.
  2890         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2891         88  CO-AR-BILL-LVL                       VALUE '2'.
  2892         88  CO-AR-AGT-LVL                        VALUE '3'.
  2893         88  CO-AR-FR-LVL                         VALUE '4'.
  2894
  2895     12  CO-AR-NORMAL-PRINT                    PIC X.
  2896         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2897         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2898
  2899     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2900
  2901     12  CO-AR-REPORTING                       PIC X.
  2902         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2903         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2904
  2905     12  CO-AR-PULL-CHECK                      PIC X.
  2906         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2907         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2908
  2909     12  CO-AR-BALANCE-PRINT                   PIC X.
  2910         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2911
  2912     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2913         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2914         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2915         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2916
  2917     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2918
  2919     12  CO-USER-CODE                          PIC X.
  2920     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2921
  2922******************************************************************
  2923*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2924*    THE LAST MONTH END RUN.
  2925******************************************************************
  2926
  2927     12  CO-LAST-ACTIVITY-DATE.
  2928         16  CO-ACT-YEAR                       PIC 99.
  2929         16  CO-ACT-MONTH                      PIC 99.
  2930         16  CO-ACT-DAY                        PIC 99.
  2931
  2932     12  CO-LAST-STMT-DT.
  2933         16  CO-LAST-STMT-YEAR                 PIC 99.
  2934         16  CO-LAST-STMT-MONTH                PIC 99.
  2935         16  CO-LAST-STMT-DAY                  PIC 99.
  2936
  2937     12  CO-MO-END-TOTALS.
  2938         16  CO-MONTHLY-TOTALS.
  2939             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2940             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2941             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2942             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  59
* EL633.cbl
  2943             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2944
  2945         16  CO-AGING-TOTALS.
  2946             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2947             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2948             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2949             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2950
  2951         16  CO-YTD-TOTALS.
  2952             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2953             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2954
  2955         16  CO-OVER-UNDER-TOTALS.
  2956             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2957             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2958
  2959     12  CO-MISCELLANEOUS-TOTALS.
  2960         16  CO-FICA-TOTALS.
  2961             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2962             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2963
  2964         16  CO-CLAIM-TOTALS.
  2965             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2966             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2967
  2968******************************************************************
  2969*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2970*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2971******************************************************************
  2972
  2973     12  CO-CURRENT-TOTALS.
  2974         16  CO-CURRENT-LAST-STMT-DT.
  2975             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2976             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2977             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2978
  2979         16  CO-CURRENT-MONTHLY-TOTALS.
  2980             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2981             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2982             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2983             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2984             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2985
  2986         16  CO-CURRENT-AGING-TOTALS.
  2987             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2988             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2989             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2990             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2991
  2992         16  CO-CURRENT-YTD-TOTALS.
  2993             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2994             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2995
  2996     12  CO-PAID-COMM-TOTALS.
  2997         16  CO-YTD-PAID-COMMS.
  2998             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2999             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3000
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  60
* EL633.cbl
  3001     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3002         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  3003         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3004
  3005     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3006         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3007         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3008         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3009         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3010         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3011         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3012         88  CO-FINAL-LETTER                  VALUE 'F'.
  3013         88  CO-RECONCILING                   VALUE 'R'.
  3014         88  CO-PHONE-CALL                    VALUE 'P'.
  3015         88  CO-LEGAL                         VALUE 'L'.
  3016         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3017         88  CO-WRITE-OFF                     VALUE 'W'.
  3018         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3019
  3020     12  CO-CSR-CODE                       PIC X(4).
  3021
  3022     12  CO-GA-STATUS-INFO.
  3023         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3024         16  CO-GA-TERMINATION-DT          PIC XX.
  3025         16  CO-GA-STATUS-CODE             PIC X.
  3026             88  CO-GA-ACTIVE                 VALUE 'A'.
  3027             88  CO-GA-INACTIVE               VALUE 'I'.
  3028             88  CO-GA-PENDING                VALUE 'P'.
  3029         16  CO-GA-COMMENTS.
  3030             20  CO-GA-COMMENT-1           PIC X(40).
  3031             20  CO-GA-COMMENT-2           PIC X(40).
  3032             20  CO-GA-COMMENT-3           PIC X(40).
  3033             20  CO-GA-COMMENT-4           PIC X(40).
  3034
  3035     12  CO-RPTCD2                         PIC X(10).
  3036     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  3037         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  3038         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  3039
  3040     12  CO-TYPE-AGENT                     PIC X(01).
  3041         88  CO-CORPORATION                   VALUE 'C'.
  3042         88  CO-PARTNERSHIP                   VALUE 'P'.
  3043         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3044         88  CO-TRUST                         VALUE 'T'.
  3045         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3046
  3047     12  CO-FAXNO.
  3048         16  CO-FAX-AREA-CODE                  PIC XXX.
  3049         16  CO-FAX-PREFIX                     PIC XXX.
  3050         16  CO-FAX-PHONE                      PIC X(4).
  3051
  3052     12  CO-BANK-INFORMATION.
  3053         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3054         16  CO-BANK-TRANSIT-NON REDEFINES
  3055             CO-BANK-TRANSIT-NO                PIC 9(8).
  3056
  3057         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3058     12  CO-MISC-DEDUCT-INFO REDEFINES
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  61
* EL633.cbl
  3059                  CO-BANK-INFORMATION.
  3060         16  CO-MD-GL-ACCT                     PIC X(10).
  3061         16  CO-MD-DIV                         PIC XX.
  3062         16  CO-MD-CENTER                      PIC X(4).
  3063         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3064         16  CO-CREATE-AP-CHECK                PIC X.
  3065         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3066         16  FILLER                            PIC XXX.
  3067     12  CO-ACH-STATUS                         PIC X.
  3068         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3069         88  CO-ACH-PENDING                        VALUE 'P'.
  3070
  3071     12  CO-BILL-SW                            PIC X.
  3072     12  CO-CONTROL-NAME                       PIC X(30).
  3073     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3074     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3075     12  CO-CLP-STATE                          PIC XX.
  3076     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3077     12  CO-SPP-REFUND-EDIT                    PIC X.
  3078
  3079******************************************************************
  3080*
  3081*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  62
* EL633.cbl
  3082/
  3083 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3084                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3085 0000-DFHEXIT SECTION.
  3086     MOVE '9#                    $   ' TO DFHEIV0.
  3087     MOVE 'EL633' TO DFHEIV1.
  3088     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3089
  3090     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3091     MOVE EIBTRMID               TO  QID-TERM.
  3092     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3093
  3094     IF EIBCALEN = ZERO
  3095         GO TO 8800-UNAUTHORIZED-ACCESS.
  3096
  3097     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3098         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3099
  3100     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3101     MOVE '5'                    TO  DC-OPTION-CODE.
  3102
  3103     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3104
  3105     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3106     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3107
  3108     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3109         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3110             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3111             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3112             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3113             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3114             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3115             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3116             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3117             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3118         ELSE
  3119             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3120             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3121             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3122             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3123             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3124             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3125             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3126             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3127
  3128     MOVE LOW-VALUES             TO  EL633AI.
  3129
  3130     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3131     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3132     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3133     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3134
  3135     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3136                                     TOTAL-ACCT-NET.
  3137
  3138     IF RETURNED-FROM = XCTL-6331 OR
  3139                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  63
* EL633.cbl
  3140                        XCTL-642  OR
  3141                        XCTL-652
  3142         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3143
  3144     IF EIBTRNID NOT = TRANS-ID
  3145         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3146         MOVE 'Y'                TO  PI-PAGE-SW
  3147         MOVE ZEROS              TO  PI-SEQ-NOS
  3148         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3149                                     PI-SAV-ACCT-NET
  3150                                     PI-SAV-PREV-AMT
  3151                                     PI-SAV-PREV-NET
  3152         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3153             EIBTRNID NOT = EL642-TRANS-ID  AND
  3154             EIBTRNID NOT = EL652-TRANS-ID) OR
  3155             PI-CR-FIN-RESP = SPACES
  3156             GO TO 8100-SEND-INITIAL-MAP
  3157         ELSE
  3158             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3159                            EL640-TRANS-ID   OR
  3160                            EL642-TRANS-ID)  AND
  3161                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3162                GO TO 8100-SEND-INITIAL-MAP
  3163             ELSE
  3164                 MOVE DFHENTER   TO  EIBAID
  3165                 MOVE 'S'        TO  MAINTI
  3166                 MOVE PI-CR-CARRIER
  3167                                 TO  CARRIERI
  3168                 MOVE PI-CR-GROUPING
  3169                                 TO  GROUPI
  3170                 MOVE PI-CR-FIN-RESP
  3171                                 TO  FINRESPI
  3172                 MOVE PI-CR-ACCOUNT
  3173                                 TO  ACCTI
  3174                 MOVE 1          TO  CARRIERL  MAINTA
  3175                 MOVE 3          TO  GROUPL
  3176                 MOVE 6          TO  FINRESPL  ACCTL
  3177                 GO TO 0400-VALIDATE-KEY-DATA.
  3178
  3179
  3180* EXEC CICS HANDLE CONDITION
  3181*        PGMIDERR  (9600-PGMID-ERROR)
  3182*        ERROR     (9990-ABEND)
  3183*    END-EXEC.
  3184*    MOVE '"$L.                  ! " #00003175' TO DFHEIV0
  3185     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3187     MOVE X'2220233030303033313735' TO DFHEIV0(25:11)
  3188     CALL 'kxdfhei1' USING DFHEIV0
  3189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3190
  3191
  3192     IF EIBAID = DFHCLEAR
  3193         GO TO 9400-CLEAR.
  3194
  3195     IF PI-PROCESSOR-ID = 'LGXX'
  3196         GO TO 0200-RECEIVE.
  3197
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  64
* EL633.cbl
  3198
  3199* EXEC CICS READQ TS
  3200*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3201*        INTO   (SECURITY-CONTROL)
  3202*        LENGTH (SC-COMM-LENGTH)
  3203*        ITEM   (SC-ITEM)
  3204*    END-EXEC.
  3205*    MOVE '*$II   L              ''   #00003186' TO DFHEIV0
  3206     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3207     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3208     MOVE X'2020233030303033313836' TO DFHEIV0(25:11)
  3209     CALL 'kxdfhei1' USING DFHEIV0,
  3210           PI-SECURITY-TEMP-STORE-ID,
  3211           SECURITY-CONTROL,
  3212           SC-COMM-LENGTH,
  3213           SC-ITEM,
  3214           DFHEIV99,
  3215           DFHEIV99
  3216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3217
  3218
  3219     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3220     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3221
  3222     IF NOT DISPLAY-CAP
  3223         MOVE 'READ'          TO SM-READ
  3224         PERFORM 9995-SECURITY-VIOLATION
  3225         MOVE ER-0070         TO  EMI-ERROR
  3226         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3227         GO TO 8100-SEND-INITIAL-MAP.
  3228
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  65
* EL633.cbl
  3230 0200-RECEIVE.
  3231
  3232     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3233         MOVE ER-0008            TO  EMI-ERROR
  3234         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3235         MOVE -1                 TO  MAINTL
  3236         GO TO 8200-SEND-DATAONLY.
  3237
  3238
  3239* EXEC CICS RECEIVE
  3240*        MAP     (MAP-NAME)
  3241*        MAPSET  (MAPSET-NAME)
  3242*        INTO    (EL633AI)
  3243*    END-EXEC.
  3244     MOVE LENGTH OF
  3245      EL633AI
  3246       TO DFHEIV11
  3247*    MOVE '8"T I  L              ''   #00003212' TO DFHEIV0
  3248     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3250     MOVE X'2020233030303033323132' TO DFHEIV0(25:11)
  3251     CALL 'kxdfhei1' USING DFHEIV0,
  3252           MAP-NAME,
  3253           EL633AI,
  3254           DFHEIV11,
  3255           MAPSET-NAME,
  3256           DFHEIV99,
  3257           DFHEIV99
  3258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3259
  3260
  3261     IF MAINTI = 'S' AND
  3262        EIBAID = DFHENTER
  3263         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3264                                     PI-SAV-ACCT-NET
  3265                                     PI-SAV-PREV-AMT
  3266                                     PI-SAV-PREV-NET
  3267                                     PI-FRST-FILE-SEQ-NO
  3268         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3269
  3270     IF PFENTERL = ZERO
  3271         GO TO 0300-CHECK-PFKEYS.
  3272
  3273     IF (PFENTERI  IS NUMERIC)
  3274       AND (PFENTERI GREATER 0 AND LESS 25)
  3275         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3276     ELSE
  3277         MOVE ER-0029               TO  EMI-ERROR
  3278         GO TO 0320-INPUT-ERROR.
  3279
  3280 0300-CHECK-PFKEYS.
  3281     IF EIBAID = DFHPF23
  3282         GO TO 8810-PF23.
  3283
  3284     IF EIBAID = DFHPF24
  3285         GO TO 9200-RETURN-MAIN-MENU.
  3286
  3287     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  66
* EL633.cbl
  3288         GO TO 9500-PF12.
  3289
  3290     IF EIBAID = DFHPF3
  3291         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3292             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3293             MOVE XCTL-652       TO  PGM-NAME
  3294             IF ERCOMP-KEY  NOT =      SPACES
  3295                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3296                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3297                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3298                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3299             END-IF
  3300
  3301             IF PI-CR-ACCOUNT = LOW-VALUES
  3302                 MOVE 'G'        TO  PI-CR-TYPE
  3303                 GO TO 9300-XCTL
  3304             ELSE
  3305                 MOVE 'A'        TO  PI-CR-TYPE
  3306                 GO TO 9300-XCTL
  3307         ELSE
  3308            MOVE ER-3020         TO  EMI-ERROR
  3309            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3310            GO TO 8100-SEND-INITIAL-MAP.
  3311
  3312     IF EIBAID = DFHPF4
  3313         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3314         MOVE XCTL-6331          TO  PGM-NAME
  3315         GO TO 9300-XCTL.
  3316
  3317     IF EIBAID = DFHPF5
  3318         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3319         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3320         MOVE XCTL-640           TO  PGM-NAME
  3321         IF PI-CR-ACCOUNT = LOW-VALUES
  3322             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3323             IF ACCTI = LOW-VALUES
  3324                MOVE 'G'         TO  PI-CR-TYPE
  3325             END-IF
  3326             GO TO 9300-XCTL
  3327         ELSE
  3328             MOVE 'A'        TO  PI-CR-TYPE
  3329             GO TO 9300-XCTL.
  3330
  3331     IF EIBAID = DFHPF6
  3332        IF PI-GA-BILLING
  3333            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3334            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3335            MOVE XCTL-642        TO  PGM-NAME
  3336            IF PI-CR-ACCOUNT = LOW-VALUES
  3337                 MOVE 'G'        TO  PI-CR-TYPE
  3338                 GO TO 9300-XCTL
  3339             ELSE
  3340                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3341                 GO TO 9300-XCTL
  3342        ELSE
  3343            MOVE ER-2929         TO  EMI-ERROR
  3344            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3345            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  67
* EL633.cbl
  3346            IF PFENTERL = ZERO
  3347                MOVE -1          TO  MAINTL
  3348                GO TO 8200-SEND-DATAONLY
  3349            ELSE
  3350                MOVE -1          TO  PFENTERL
  3351                GO TO 8200-SEND-DATAONLY.
  3352
  3353     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3354         GO TO 0400-VALIDATE-KEY-DATA.
  3355
  3356 0320-INPUT-ERROR.
  3357     MOVE ER-0029                TO  EMI-ERROR.
  3358
  3359     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3360
  3361     MOVE AL-UNBON               TO  PFENTERA.
  3362
  3363     IF PFENTERL = ZERO
  3364         MOVE -1                 TO  MAINTL
  3365     ELSE
  3366         MOVE -1                 TO  PFENTERL.
  3367
  3368     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  68
* EL633.cbl
  3370 0400-VALIDATE-KEY-DATA.
  3371     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3372         NEXT SENTENCE
  3373       ELSE
  3374        IF MAINTI NOT = 'S'
  3375         MOVE 'UPDATE'       TO SM-READ
  3376         PERFORM 9995-SECURITY-VIOLATION
  3377         MOVE ER-0070        TO EMI-ERROR
  3378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3379         GO TO 8100-SEND-INITIAL-MAP.
  3380
  3381     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3382
  3383     IF EIBAID = DFHPF1
  3384         GO TO 4000-BROWSE-FRWD.
  3385
  3386     IF EIBAID   = DFHPF1   AND
  3387        CARRIERL = ZEROS    AND
  3388        GROUPL   = ZEROS    AND
  3389        FINRESPL = ZEROS    AND
  3390        ACCTL    = ZEROS
  3391         GO TO 4000-BROWSE-FRWD.
  3392
  3393     IF PI-PROCESSOR-ID = 'LGXX'
  3394         IF MAINTI = 'C'
  3395             MOVE AL-UANON       TO MAINTA
  3396             MOVE MAINTI         TO PI-SAV-FUNCTION
  3397             GO TO CSO-BRANCH
  3398         END-IF
  3399     END-IF.
  3400
  3401     IF MAINTI = 'C' OR  'S'
  3402         MOVE AL-UANON           TO  MAINTA
  3403         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3404     ELSE
  3405         MOVE -1                 TO  MAINTL
  3406         MOVE ER-0023            TO  EMI-ERROR
  3407         MOVE AL-UABON           TO  MAINTA
  3408         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3409
  3410 CSO-BRANCH.
  3411
  3412     IF MAINTI = 'C'
  3413       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3414         MOVE -1                 TO  MAINTL
  3415         MOVE ER-2056            TO  EMI-ERROR
  3416         MOVE AL-UABON           TO  MAINTA
  3417         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3418
  3419     IF CARRIERL = ZEROS  AND
  3420        GROUPL   = ZEROS  AND
  3421        FINRESPL = ZEROS  AND
  3422        ACCTL    = ZEROS
  3423         MOVE -1                 TO  CARRIERL
  3424         MOVE ER-2231            TO  EMI-ERROR
  3425         MOVE AL-UABON           TO  CARRIERA
  3426                                     GROUPA
  3427                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  69
* EL633.cbl
  3428                                     ACCTA
  3429         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3430         GO TO 8200-SEND-DATAONLY.
  3431
  3432     IF CARRIERL NOT = ZEROS
  3433         MOVE AL-UANON           TO  CARRIERA
  3434         MOVE CARRIERI           TO  COMP-CARRIER
  3435                                     PI-SAV-CARRIER
  3436                                     PI-CR-CARRIER
  3437         IF CARRIERI NOT = ZEROS
  3438           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3439             MOVE ER-2587        TO  EMI-ERROR
  3440             MOVE -1             TO  CARRIERL
  3441             MOVE AL-UABON       TO  CARRIERA
  3442             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3443         ELSE
  3444             NEXT SENTENCE
  3445     ELSE
  3446         MOVE LOW-VALUES          TO  COMP-CARRIER
  3447                                      PI-SAV-CARRIER.
  3448
  3449     IF CARRIERL NOT = ZEROS
  3450         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3451             IF PI-CARRIER-SECURITY = CARRIERI
  3452                 NEXT SENTENCE
  3453             ELSE
  3454                 MOVE -1         TO  CARRIERL
  3455                 MOVE ER-2370    TO  EMI-ERROR
  3456                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3457
  3458     IF GROUPL NOT = ZEROS
  3459         MOVE AL-UANON           TO  GROUPA
  3460         MOVE GROUPI             TO  COMP-GROUPING
  3461                                     PI-SAV-GROUPING
  3462                                     PI-CR-GROUPING
  3463         IF GROUPI NOT = ZEROS
  3464           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3465             MOVE ER-2588        TO  EMI-ERROR
  3466             MOVE -1             TO  GROUPL
  3467             MOVE AL-UABON       TO  GROUPA
  3468             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3469         ELSE
  3470             NEXT SENTENCE
  3471     ELSE
  3472         MOVE LOW-VALUES         TO  COMP-GROUPING
  3473                                     PI-SAV-GROUPING.
  3474
  3475     IF FINRESPL NOT = ZEROS
  3476         MOVE AL-UANON           TO  FINRESPA
  3477         MOVE FINRESPI           TO  COMP-FIN-RESP
  3478                                     PI-SAV-FIN-RESP
  3479                                     PI-CR-FIN-RESP
  3480     ELSE
  3481         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3482                                     PI-SAV-FIN-RESP.
  3483
  3484     IF ACCTL NOT = ZEROS
  3485         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  70
* EL633.cbl
  3486         MOVE ACCTI              TO  COMP-ACCOUNT
  3487                                     PI-SAV-ACCOUNT
  3488                                     PI-CR-ACCOUNT
  3489     ELSE
  3490         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3491                                     PI-SAV-ACCOUNT
  3492                                     PI-CR-ACCOUNT.
  3493
  3494     IF EMI-ERROR = ZEROS
  3495         NEXT SENTENCE
  3496     ELSE
  3497         IF EIBTRNID = EL640-TRANS-ID OR
  3498            EIBTRNID = EL642-TRANS-ID OR
  3499            EIBTRNID = EL6331-TRANS-ID
  3500             GO TO 8100-SEND-INITIAL-MAP
  3501         ELSE
  3502             GO TO 8200-SEND-DATAONLY.
  3503
  3504     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3505
  3506     IF MAINTI = 'S'
  3507         IF EIBAID = DFHPF1              OR  DFHENTER
  3508             GO TO 4000-BROWSE-FRWD
  3509         ELSE
  3510             GO TO 4100-BROWSE-BKWD.
  3511
  3512     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3513     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3514
  3515
  3516* EXEC CICS HANDLE CONDITION
  3517*        NOTFND   (0410-NO-COMP-MSTR)
  3518*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3519*        END-EXEC.
  3520*    MOVE '"$IJ                  ! # #00003472' TO DFHEIV0
  3521     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3523     MOVE X'2320233030303033343732' TO DFHEIV0(25:11)
  3524     CALL 'kxdfhei1' USING DFHEIV0
  3525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3526
  3527
  3528
  3529* EXEC CICS READ
  3530*        DATASET  (COMP-FILE-ID)
  3531*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3532*        RIDFLD   (ERCOMP-KEY)
  3533*        GTEQ
  3534*        END-EXEC.
  3535*    MOVE '&"S        G          (   #00003477' TO DFHEIV0
  3536     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3538     MOVE X'2020233030303033343737' TO DFHEIV0(25:11)
  3539     CALL 'kxdfhei1' USING DFHEIV0,
  3540           COMP-FILE-ID,
  3541           DFHEIV20,
  3542           DFHEIV99,
  3543           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  71
* EL633.cbl
  3544           DFHEIV99,
  3545           DFHEIV99,
  3546           DFHEIV99
  3547     SET ADDRESS OF COMPENSATION-MASTER TO
  3548         DFHEIV20
  3549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3550
  3551
  3552     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3553        COMP-CARRIER  = CO-CARRIER     AND
  3554        COMP-GROUPING = CO-GROUPING    AND
  3555        COMP-FIN-RESP = CO-RESP-NO    AND
  3556        COMP-ACCOUNT  = CO-ACCOUNT
  3557         NEXT SENTENCE
  3558     ELSE
  3559         GO TO 0410-NO-COMP-MSTR.
  3560
  3561     IF PI-COMPANY-ID = 'NCL'
  3562         IF CO-GA-INACTIVE
  3563             GO TO 0420-INACTIVE-COMP.
  3564
  3565     IF MAINTI = 'C'
  3566         GO TO 1000-EDIT-DATA.
  3567
  3568     IF EIBAID = DFHPF1
  3569       OR DFHENTER
  3570         GO TO 4000-BROWSE-FRWD.
  3571
  3572     IF EIBAID = DFHPF2
  3573         GO TO 4100-BROWSE-BKWD.
  3574
  3575 0410-NO-COMP-MSTR.
  3576     MOVE ER-2230                TO  EMI-ERROR.
  3577     MOVE -1                     TO  CARRIERL.
  3578     MOVE AL-UABON               TO  CARRIERA
  3579                                     GROUPA
  3580                                     FINRESPA
  3581                                     ACCTA.
  3582
  3583     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3584
  3585     GO TO 8200-SEND-DATAONLY.
  3586
  3587 0420-INACTIVE-COMP.
  3588     MOVE ER-2763                TO  EMI-ERROR.
  3589     MOVE -1                     TO  CARRIERL.
  3590     MOVE AL-UABON               TO  CARRIERA
  3591                                     GROUPA
  3592                                     FINRESPA
  3593                                     ACCTA.
  3594
  3595     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3596
  3597     GO TO 8200-SEND-DATAONLY.
  3598
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  72
* EL633.cbl
  3600 0500-CREATE-TEMP-STORAGE.
  3601
  3602     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3603
  3604
  3605* EXEC CICS WRITEQ TS
  3606*        QUEUE  (QID)
  3607*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3608*        LENGTH (PI-COMM-LENGTH)
  3609*    END-EXEC.
  3610*    MOVE '*"                    ''   #00003536' TO DFHEIV0
  3611     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3613     MOVE X'2020233030303033353336' TO DFHEIV0(25:11)
  3614     CALL 'kxdfhei1' USING DFHEIV0,
  3615           QID,
  3616           PROGRAM-INTERFACE-BLOCK,
  3617           PI-COMM-LENGTH,
  3618           DFHEIV99,
  3619           DFHEIV99,
  3620           DFHEIV99
  3621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3622
  3623
  3624 0590-EXIT.
  3625      EXIT.
  3626
  3627 0600-RECOVER-TEMP-STORAGE.
  3628
  3629* EXEC CICS READQ TS
  3630*        QUEUE  (QID)
  3631*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3632*        LENGTH (PI-COMM-LENGTH)
  3633*    END-EXEC.
  3634*    MOVE '*$I    L              ''   #00003546' TO DFHEIV0
  3635     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3637     MOVE X'2020233030303033353436' TO DFHEIV0(25:11)
  3638     CALL 'kxdfhei1' USING DFHEIV0,
  3639           QID,
  3640           PROGRAM-INTERFACE-BLOCK,
  3641           PI-COMM-LENGTH,
  3642           DFHEIV99,
  3643           DFHEIV99,
  3644           DFHEIV99
  3645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3646
  3647
  3648     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3649
  3650 0690-EXIT.
  3651      EXIT.
  3652
  3653 0800-DELETE-TS.
  3654
  3655* EXEC CICS HANDLE CONDITION
  3656*        QIDERR (0890-EXIT)
  3657*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  73
* EL633.cbl
  3658*    MOVE '"$N                   ! $ #00003558' TO DFHEIV0
  3659     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3661     MOVE X'2420233030303033353538' TO DFHEIV0(25:11)
  3662     CALL 'kxdfhei1' USING DFHEIV0
  3663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3664
  3665
  3666
  3667* EXEC CICS DELETEQ TS
  3668*        QUEUE  (QID)
  3669*    END-EXEC.
  3670*    MOVE '*&                    #   #00003562' TO DFHEIV0
  3671     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3672     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3673     MOVE X'2020233030303033353632' TO DFHEIV0(25:11)
  3674     CALL 'kxdfhei1' USING DFHEIV0,
  3675           QID,
  3676           DFHEIV99
  3677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3678
  3679
  3680
  3681* EXEC CICS SYNCPOINT
  3682*    END-EXEC.
  3683*    MOVE '6"                    !   #00003566' TO DFHEIV0
  3684     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3686     MOVE X'2020233030303033353636' TO DFHEIV0(25:11)
  3687     CALL 'kxdfhei1' USING DFHEIV0
  3688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3689
  3690
  3691 0890-EXIT.
  3692      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  74
* EL633.cbl
  3694
  3695 1000-EDIT-DATA.
  3696     SET PINDX                   TO  1.
  3697
  3698     .
  3699 1010-EDIT-LOOP.
  3700     SET NDX                     TO  PINDX.
  3701     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3702        GL-STATE-LEN (PINDX) = ZEROS   AND
  3703        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3704        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3705        RTYPE-LEN (PINDX)     = ZEROS  AND
  3706        AMT-LEN (PINDX)       = ZEROS  AND
  3707        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3708        SDTE-LEN (PINDX)      = ZEROS
  3709         GO TO 1020-INCREMENT-PINDX.
  3710
  3711     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3712         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3713         IF PI-COMPANY-ID NOT = 'WSL'
  3714             NEXT SENTENCE
  3715         ELSE
  3716             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3717             MOVE '4'                   TO  DC-OPTION-CODE
  3718             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3719             IF NO-CONVERSION-ERROR
  3720                 NEXT SENTENCE
  3721             ELSE
  3722                 MOVE ER-2595    TO  EMI-ERROR
  3723                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3724                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3725                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3726     ELSE
  3727         IF PI-COMPANY-ID = 'WSL'
  3728           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3729             MOVE ER-2596        TO  EMI-ERROR
  3730             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3731             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3732             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3733
  3734
  3735     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3736*        MOVE K-SPACE            TO COFA-FILLER
  3737*        MOVE '0001'             TO COFA-COMPANY-X
  3738*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3739         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3740     ELSE
  3741         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3742             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3743             MOVE ER-2957        TO EMI-ERROR
  3744             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3745             PERFORM 9900-ERROR-FORMAT THRU
  3746                     9900-EXIT
  3747             GO TO 1040-CONTINUE-EDIT
  3748         ELSE
  3749             GO TO 1040-CONTINUE-EDIT
  3750         END-IF
  3751     END-IF.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  75
* EL633.cbl
  3752
  3753     IF (PI-COMPANY-ID = 'DCC')
  3754        AND (RTYPE (PINDX) = 'P')
  3755        GO TO 1040-CONTINUE-EDIT
  3756     END-IF
  3757     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3758        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3759     ELSE
  3760        MOVE SPACES              TO CHECK-GL-ACCT
  3761     END-IF
  3762
  3763     EVALUATE TRUE
  3764        WHEN (PI-COMPANY-ID = 'DCC')
  3765           AND (CO-CARRIER = '1' OR '2')
  3766           AND (VALID-DCC-GL-ACCOUNT)
  3767           GO TO 1040-CONTINUE-EDIT
  3768        WHEN (PI-COMPANY-ID = 'DCC')
  3769           AND (CO-CARRIER = '3' OR '4')
  3770           AND VALID-CSI-GL-ACCOUNT
  3771           GO TO 1040-CONTINUE-EDIT
  3772        WHEN (PI-COMPANY-ID = 'DCC')
  3773           AND (CO-CARRIER = '5' OR '6')
  3774           AND (VALID-CCC-GL-ACCOUNT)
  3775           GO TO 1040-CONTINUE-EDIT
  3776        WHEN (PI-COMPANY-ID = 'CID' OR 'AHL')
  3777           AND (VALID-GL-ACCOUNT)
  3778           GO TO 1040-CONTINUE-EDIT
  3779     END-EVALUATE
  3780*    EXEC CICS HANDLE CONDITION
  3781*         NOTFND (1040-NO-COFA-MSTR)
  3782*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3783*    END-EXEC.
  3784*
  3785*    EXEC CICS READ
  3786*         DATASET (COFA-FILE-ID)
  3787*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3788*         RIDFLD  (COFA-KEY-X)
  3789*    END-EXEC.
  3790*
  3791*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3792*    GO TO 1040-CONTINUE-EDIT.
  3793*
  3794*1040-NO-COFA-MSTR.
  3795
  3796     MOVE ER-2960                TO EMI-ERROR.
  3797     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3798     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3799     PERFORM 9900-ERROR-FORMAT THRU
  3800             9900-EXIT.
  3801
  3802 1040-CONTINUE-EDIT.
  3803
  3804*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3805     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3806         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3807         IF NOT VALID-STATE-CODE
  3808             MOVE -1             TO GL-STATE-LEN (PINDX)
  3809             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  76
* EL633.cbl
  3810             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3811             PERFORM 9900-ERROR-FORMAT THRU
  3812                     9900-EXIT
  3813         ELSE
  3814             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3815         END-IF
  3816     END-IF.
  3817
  3818 1040-CSO-SKIP.
  3819
  3820     IF GL-CANC (PINDX) = LOW-VALUES
  3821         MOVE SPACES             TO GL-CANC (PINDX)
  3822     END-IF.
  3823
  3824     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3825         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3826         IF NOT VALID-CANC-TYPE
  3827             MOVE -1             TO GL-CANC-LEN (PINDX)
  3828             MOVE ER-2958        TO EMI-ERROR
  3829             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3830             PERFORM 9900-ERROR-FORMAT THRU
  3831                     9900-EXIT
  3832         ELSE
  3833             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3834         END-IF
  3835     END-IF.
  3836
  3837     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3838        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3839        IF (PI-COMPANY-ID = 'DCC')
  3840           AND (RTYPE (PINDX) = 'P')
  3841           SET VALID-REC-TYPE   TO TRUE
  3842        END-IF
  3843         IF NOT VALID-REC-TYPE
  3844             MOVE -1             TO  RTYPE-LEN (PINDX)
  3845             MOVE ER-2234        TO  EMI-ERROR
  3846             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3847             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3848         ELSE
  3849             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3850     ELSE
  3851         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3852             MOVE -1             TO  RTYPE-LEN (PINDX)
  3853             MOVE ER-2235        TO  EMI-ERROR
  3854             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3855             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3856
  3857     IF AMT-LEN (PINDX) NOT = ZEROS
  3858
  3859* EXEC CICS BIF DEEDIT
  3860*           FIELD (AMT (PINDX))
  3861*           LENGTH (11)
  3862*       END-EXEC
  3863     MOVE 11
  3864       TO DFHEIV11
  3865*    MOVE '@"L                   #   #00003736' TO DFHEIV0
  3866     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3867     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  77
* EL633.cbl
  3868     MOVE X'2020233030303033373336' TO DFHEIV0(25:11)
  3869     CALL 'kxdfhei1' USING DFHEIV0,
  3870           AMT(PINDX),
  3871           DFHEIV11
  3872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3873         IF AMT (PINDX) = ZEROS
  3874             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3875                 NEXT SENTENCE
  3876             ELSE
  3877                 MOVE ER-2245    TO  EMI-ERROR
  3878                 MOVE -1         TO  AMT-LEN(PINDX)
  3879                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3880                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3881         ELSE
  3882             IF AMT (PINDX) NUMERIC
  3883                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3884             ELSE
  3885                 MOVE ER-2245    TO  EMI-ERROR
  3886                 MOVE -1         TO  AMT-LEN(PINDX)
  3887                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3888                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3889     ELSE
  3890         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3891             MOVE -1             TO  AMT-LEN (PINDX)
  3892             MOVE ER-2236        TO  EMI-ERROR
  3893             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3894             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3895
  3896     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3897         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3898           AND (PI-REC-TYPE (NDX) = 'C')
  3899             IF VOID-SW (PINDX) = 'V'
  3900                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3901             ELSE
  3902                 MOVE ER-2246    TO  EMI-ERROR
  3903                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3904                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3905                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3906         ELSE
  3907             MOVE ER-2449        TO  EMI-ERROR
  3908             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3909             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3910             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3911
  3912     IF SDTE-LEN (PINDX) = ZEROS
  3913        GO TO 1020-INCREMENT-PINDX.
  3914
  3915     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3916
  3917     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3918     PERFORM 8600-DEEDIT.
  3919
  3920     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3921        GO TO 1015-DAY-ERROR.
  3922
  3923     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3924     MOVE '4'                    TO  DC-OPTION-CODE.
  3925     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  78
* EL633.cbl
  3926
  3927     IF NO-CONVERSION-ERROR
  3928        SET PINDEX               TO  PINDX
  3929        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3930     ELSE
  3931        GO TO 1015-DAY-ERROR.
  3932
  3933     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3934
  3935     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3936         IF DATE-TEST-DD  NOT = 30
  3937             GO TO 1015-DAY-ERROR
  3938         ELSE
  3939             GO TO 1020-INCREMENT-PINDX.
  3940
  3941     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3942                             8  OR  10  OR  12
  3943         IF DATE-TEST-DD  NOT = 31
  3944             GO TO 1015-DAY-ERROR
  3945         ELSE
  3946             GO TO 1020-INCREMENT-PINDX.
  3947
  3948     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3949         REMAINDER  DIVIDE-REMAINDER.
  3950
  3951     IF (DATE-TEST-YY = ZERO)
  3952       OR (DIVIDE-REMAINDER NOT = ZERO)
  3953         IF DATE-TEST-DD  NOT = 28
  3954             GO TO 1015-DAY-ERROR
  3955         ELSE
  3956             GO TO 1020-INCREMENT-PINDX
  3957     ELSE
  3958         IF DATE-TEST-DD = 29
  3959             GO TO 1020-INCREMENT-PINDX.
  3960
  3961 1015-DAY-ERROR.
  3962     MOVE -1                     TO  SDTE-LEN (PINDX).
  3963     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3964     MOVE ER-0587                TO  EMI-ERROR.
  3965
  3966     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3967
  3968 1020-INCREMENT-PINDX.
  3969     SET PINDX  UP  BY  1.
  3970
  3971     IF PINDX  IS NOT GREATER THAN  13
  3972         GO TO 1010-EDIT-LOOP.
  3973
  3974     IF EMI-ERROR = ZEROS
  3975         NEXT SENTENCE
  3976     ELSE
  3977         MOVE 'S'                TO  PI-PREV-FUNCTION
  3978         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  79
* EL633.cbl
  3980 2000-UPDATE-THE-FILE.
  3981     SET PINDX                   TO  ZERO-NDX.
  3982*    SET NDX                     TO  ZERO-NDX.
  3983*    SET NDX  UP  BY  1.
  3984
  3985     IF PI-PYAJ-FILE-SW = 'B'
  3986         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3987         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3988     ELSE
  3989         MOVE PI-LAST-FILE-SEQ-NO
  3990                                 TO  PI-SAV-FILE-SEQ-NO
  3991         MOVE PI-LAST-RECORD-TYPE
  3992                                 TO  PI-SAV-RECORD-TYPE.
  3993
  3994 2100-UPDATE-LOOP.
  3995     SET PINDX  UP  BY  1.
  3996     SET NDX                     TO  PINDX.
  3997
  3998     IF PINDX  IS GREATER THAN  13
  3999         GO TO 2200-UPDATE-COMPLETE.
  4000
  4001     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  4002        GL-STATE-LEN (PINDX) = ZEROS AND
  4003        GL-CANC-LEN (PINDX)   = ZEROS AND
  4004        GL-COMM-LEN (PINDX)   = ZEROS AND
  4005        RTYPE-LEN (PINDX)   = ZEROS  AND
  4006        AMT-LEN (PINDX)     = ZEROS  AND
  4007        VOID-SW-LEN (PINDX) = ZEROS  AND
  4008        SDTE-LEN (PINDX)    = ZEROS
  4009         GO TO 2100-UPDATE-LOOP.
  4010
  4011
  4012* EXEC CICS BIF DEEDIT
  4013*         FIELD (AMT (PINDX))
  4014*         LENGTH (11)
  4015*    END-EXEC.
  4016     MOVE 11
  4017       TO DFHEIV11
  4018*    MOVE '@"L                   #   #00003878' TO DFHEIV0
  4019     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4020     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4021     MOVE X'2020233030303033383738' TO DFHEIV0(25:11)
  4022     CALL 'kxdfhei1' USING DFHEIV0,
  4023           AMT(PINDX),
  4024           DFHEIV11
  4025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4026
  4027
  4028     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4029         NEXT SENTENCE
  4030     ELSE
  4031         GO TO 2110-ADD-RECORD.
  4032
  4033
  4034* EXEC CICS HANDLE CONDITION
  4035*        NOTFND  (2110-ADD-RECORD)
  4036*    END-EXEC.
  4037*    MOVE '"$I                   ! % #00003888' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  80
* EL633.cbl
  4038     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4040     MOVE X'2520233030303033383838' TO DFHEIV0(25:11)
  4041     CALL 'kxdfhei1' USING DFHEIV0
  4042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4043
  4044
  4045     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4046     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4047     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4048
  4049
  4050* EXEC CICS READ
  4051*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4052*        DATASET  (PYAJ-FILE-ID)
  4053*        RIDFLD   (ERPYAJ-KEY)
  4054*        UPDATE
  4055*    END-EXEC.
  4056*    MOVE '&"S        EU         (   #00003896' TO DFHEIV0
  4057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4059     MOVE X'2020233030303033383936' TO DFHEIV0(25:11)
  4060     CALL 'kxdfhei1' USING DFHEIV0,
  4061           PYAJ-FILE-ID,
  4062           DFHEIV20,
  4063           DFHEIV99,
  4064           ERPYAJ-KEY,
  4065           DFHEIV99,
  4066           DFHEIV99,
  4067           DFHEIV99
  4068     SET ADDRESS OF PENDING-PAY-ADJ TO
  4069         DFHEIV20
  4070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4071
  4072
  4073
  4074     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4075        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4076            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4077            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4078            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4079
  4080     IF AMT-LEN (PINDX) NOT = ZEROS
  4081         IF AMT (PINDX) = ZEROS
  4082             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4083                 GO TO 2120-DELETE-RECORD
  4084             ELSE
  4085                 MOVE ER-2244       TO  EMI-ERROR
  4086                 MOVE -1            TO  AMT-LEN (PINDX)
  4087                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4088                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4089                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4090
  4091* EXEC CICS UNLOCK
  4092*                    DATASET  (PYAJ-FILE-ID)
  4093*                END-EXEC
  4094*    MOVE '&*                    #   #00003920' TO DFHEIV0
  4095     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  81
* EL633.cbl
  4096     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4097     MOVE X'2020233030303033393230' TO DFHEIV0(25:11)
  4098     CALL 'kxdfhei1' USING DFHEIV0,
  4099           PYAJ-FILE-ID,
  4100           DFHEIV99
  4101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4102                 GO TO 8200-SEND-DATAONLY.
  4103
  4104     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4105     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4106     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4107
  4108     PERFORM 8400-LOG-JOURNAL-RECORD.
  4109
  4110     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4111     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4112     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4113
  4114     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4115         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4116     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4117         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4118     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4119         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4120     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4121         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4122     IF AMT-LEN (PINDX) NOT = ZEROS
  4123         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4124
  4125     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4126         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4127
  4128     IF SDTE-LEN (PINDX) NOT = ZEROS
  4129        SET PINDEX               TO  PINDX
  4130        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4131
  4132     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4133     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4134     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4135
  4136
  4137* EXEC CICS REWRITE
  4138*        DATASET  (PYAJ-FILE-ID)
  4139*        FROM     (PENDING-PAY-ADJ)
  4140*    END-EXEC.
  4141     MOVE LENGTH OF
  4142      PENDING-PAY-ADJ
  4143       TO DFHEIV11
  4144*    MOVE '&& L                  %   #00003957' TO DFHEIV0
  4145     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4146     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4147     MOVE X'2020233030303033393537' TO DFHEIV0(25:11)
  4148     CALL 'kxdfhei1' USING DFHEIV0,
  4149           PYAJ-FILE-ID,
  4150           PENDING-PAY-ADJ,
  4151           DFHEIV11,
  4152           DFHEIV99
  4153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  82
* EL633.cbl
  4154
  4155
  4156     PERFORM 8400-LOG-JOURNAL-RECORD.
  4157
  4158     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  83
* EL633.cbl
  4160 2110-ADD-RECORD.
  4161
  4162* EXEC CICS GETMAIN
  4163*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4164*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4165*        INITIMG  (GETMAIN-SPACE)
  4166*    END-EXEC.
  4167*    MOVE ',"IL                  $   #00003967' TO DFHEIV0
  4168     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4170     MOVE X'2020233030303033393637' TO DFHEIV0(25:11)
  4171     CALL 'kxdfhei1' USING DFHEIV0,
  4172           DFHEIV20,
  4173           ERPYAJ-RECORD-LENGTH,
  4174           GETMAIN-SPACE
  4175     SET ADDRESS OF PENDING-PAY-ADJ TO
  4176         DFHEIV20
  4177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4178
  4179
  4180     MOVE 'PY'                   TO  PY-RECORD-ID.
  4181     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4182     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4183     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4184     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4185     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4186
  4187     ADD +1                      TO  WORK-SEQ-NO.
  4188     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4189
  4190     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4191     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4192     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4193     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4194
  4195     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4196     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4197     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4198        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4199     END-IF
  4200     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4201     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4202     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4203                                     PY-INPUT-DT.
  4204     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4205                                     PY-CHECK-QUE-SEQUENCE.
  4206     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4207                                     PY-BILLED-DATE
  4208                                     PY-AR-DATE
  4209                                     PY-REPORTED-DT
  4210                                     PY-CHECK-WRITTEN-DT.
  4211     IF SDTE-LEN (PINDX) = ZEROS
  4212         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4213         GO TO 2115-WRITE-REC
  4214     END-IF.
  4215
  4216     IF SDTE (PINDX) IS NUMERIC
  4217         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  84
* EL633.cbl
  4218         MOVE '4'            TO  DC-OPTION-CODE
  4219         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4220         IF DATE-CONVERSION-ERROR
  4221             MOVE PI-CR-MONTH-END-DT
  4222                             TO  PY-CREDIT-SELECT-DT
  4223         ELSE
  4224             MOVE DC-BIN-DATE-1
  4225                             TO  PY-CREDIT-SELECT-DT
  4226         END-IF
  4227     ELSE
  4228         MOVE PI-CR-MONTH-END-DT
  4229                             TO  PY-CREDIT-SELECT-DT
  4230     END-IF
  4231
  4232     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4233         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4234         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4235
  4236     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4237         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4238         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4239
  4240     MOVE 'N'                    TO  FIRST-ADD-SW.
  4241
  4242     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4243     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4244     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4245 2115-WRITE-REC.
  4246
  4247* EXEC CICS WRITE
  4248*        DATASET  (PYAJ-FILE-ID)
  4249*        FROM     (PENDING-PAY-ADJ)
  4250*        RIDFLD   (PY-CONTROL-PRIMARY)
  4251*    END-EXEC.
  4252     MOVE LENGTH OF
  4253      PENDING-PAY-ADJ
  4254       TO DFHEIV11
  4255*    MOVE '&$ L                  ''   #00004039' TO DFHEIV0
  4256     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4258     MOVE X'2020233030303034303339' TO DFHEIV0(25:11)
  4259     CALL 'kxdfhei1' USING DFHEIV0,
  4260           PYAJ-FILE-ID,
  4261           PENDING-PAY-ADJ,
  4262           DFHEIV11,
  4263           PY-CONTROL-PRIMARY,
  4264           DFHEIV99,
  4265           DFHEIV99
  4266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4267
  4268
  4269     PERFORM 8400-LOG-JOURNAL-RECORD.
  4270
  4271     GO TO 2100-UPDATE-LOOP.
  4272
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  85
* EL633.cbl
  4274 2120-DELETE-RECORD.
  4275     IF PY-RECORD-TYPE NOT = 'C'
  4276         GO TO 2120-DELETE-CONT.
  4277
  4278     IF PY-CHECK-QUE-CONTROL = ZEROS
  4279       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4280         GO TO 2120-DELETE-CONT.
  4281
  4282
  4283* EXEC CICS HANDLE CONDITION
  4284*        NOTFND  (2120-DELETE-CONT)
  4285*    END-EXEC.
  4286*    MOVE '"$I                   ! & #00004058' TO DFHEIV0
  4287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4289     MOVE X'2620233030303034303538' TO DFHEIV0(25:11)
  4290     CALL 'kxdfhei1' USING DFHEIV0
  4291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4292
  4293
  4294     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4295     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4296     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4297
  4298
  4299* EXEC CICS READ
  4300*        SET      (ADDRESS OF CHECK-QUE)
  4301*        DATASET  (CHKQ-FILE-ID)
  4302*        RIDFLD   (ERCHKQ-KEY)
  4303*        UPDATE
  4304*    END-EXEC.
  4305*    MOVE '&"S        EU         (   #00004066' TO DFHEIV0
  4306     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4308     MOVE X'2020233030303034303636' TO DFHEIV0(25:11)
  4309     CALL 'kxdfhei1' USING DFHEIV0,
  4310           CHKQ-FILE-ID,
  4311           DFHEIV20,
  4312           DFHEIV99,
  4313           ERCHKQ-KEY,
  4314           DFHEIV99,
  4315           DFHEIV99,
  4316           DFHEIV99
  4317     SET ADDRESS OF CHECK-QUE TO
  4318         DFHEIV20
  4319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4320
  4321
  4322*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4323*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4324*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4325*
  4326*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4327
  4328
  4329* EXEC CICS DELETE
  4330*        DATASET  (CHKQ-FILE-ID)
  4331*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  86
* EL633.cbl
  4332*    MOVE '&(                    &   #00004079' TO DFHEIV0
  4333     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4335     MOVE X'2020233030303034303739' TO DFHEIV0(25:11)
  4336     CALL 'kxdfhei1' USING DFHEIV0,
  4337           CHKQ-FILE-ID,
  4338           DFHEIV99,
  4339           DFHEIV99,
  4340           DFHEIV99,
  4341           DFHEIV99
  4342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4343
  4344
  4345 2120-DELETE-CONT.
  4346*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4347*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4348*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4349*
  4350*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4351
  4352     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4353         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4354         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4355         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4356                                     PI-SAV-ACCT-NET
  4357                                     PI-SAV-PREV-AMT
  4358                                     PI-SAV-PREV-NET.
  4359
  4360
  4361* EXEC CICS DELETE
  4362*        DATASET(PYAJ-FILE-ID)
  4363*    END-EXEC.
  4364*    MOVE '&(                    &   #00004098' TO DFHEIV0
  4365     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4366     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4367     MOVE X'2020233030303034303938' TO DFHEIV0(25:11)
  4368     CALL 'kxdfhei1' USING DFHEIV0,
  4369           PYAJ-FILE-ID,
  4370           DFHEIV99,
  4371           DFHEIV99,
  4372           DFHEIV99,
  4373           DFHEIV99
  4374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4375
  4376
  4377     GO TO 2100-UPDATE-LOOP.
  4378
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  87
* EL633.cbl
  4380
  4381 2190-CHANGE-RECORD-TYPE.
  4382
  4383*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4384*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4385*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4386*
  4387*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4388
  4389
  4390* EXEC CICS DELETE
  4391*        DATASET(PYAJ-FILE-ID)
  4392*    END-EXEC.
  4393*    MOVE '&(                    &   #00004114' TO DFHEIV0
  4394     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4396     MOVE X'2020233030303034313134' TO DFHEIV0(25:11)
  4397     CALL 'kxdfhei1' USING DFHEIV0,
  4398           PYAJ-FILE-ID,
  4399           DFHEIV99,
  4400           DFHEIV99,
  4401           DFHEIV99,
  4402           DFHEIV99
  4403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4404
  4405
  4406
  4407* EXEC CICS GETMAIN
  4408*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4409*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4410*        INITIMG  (GETMAIN-SPACE)
  4411*    END-EXEC.
  4412*    MOVE ',"IL                  $   #00004118' TO DFHEIV0
  4413     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4415     MOVE X'2020233030303034313138' TO DFHEIV0(25:11)
  4416     CALL 'kxdfhei1' USING DFHEIV0,
  4417           DFHEIV20,
  4418           ERPYAJ-RECORD-LENGTH,
  4419           GETMAIN-SPACE
  4420     SET ADDRESS OF PENDING-PAY-ADJ TO
  4421         DFHEIV20
  4422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4423
  4424
  4425*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4426*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4427
  4428     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4429     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4430                                    PYAJ-RECORD-TYPE.
  4431
  4432
  4433* EXEC CICS HANDLE CONDITION
  4434*        DUPREC (2190-DUP-RECORD)
  4435*    END-EXEC.
  4436*    MOVE '"$%                   ! '' #00004131' TO DFHEIV0
  4437     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  88
* EL633.cbl
  4438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4439     MOVE X'2720233030303034313331' TO DFHEIV0(25:11)
  4440     CALL 'kxdfhei1' USING DFHEIV0
  4441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4442
  4443
  4444*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4445*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4446*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4447
  4448 2190-RETRY-WRITE.
  4449
  4450
  4451* EXEC CICS WRITE
  4452*        DATASET  (PYAJ-FILE-ID)
  4453*        FROM     (PENDING-PAY-ADJ)
  4454*        RIDFLD   (PY-CONTROL-PRIMARY)
  4455*    END-EXEC.
  4456     MOVE LENGTH OF
  4457      PENDING-PAY-ADJ
  4458       TO DFHEIV11
  4459*    MOVE '&$ L                  ''   #00004141' TO DFHEIV0
  4460     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4462     MOVE X'2020233030303034313431' TO DFHEIV0(25:11)
  4463     CALL 'kxdfhei1' USING DFHEIV0,
  4464           PYAJ-FILE-ID,
  4465           PENDING-PAY-ADJ,
  4466           DFHEIV11,
  4467           PY-CONTROL-PRIMARY,
  4468           DFHEIV99,
  4469           DFHEIV99
  4470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4471
  4472
  4473*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4474
  4475
  4476* EXEC CICS READ
  4477*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4478*        DATASET  (PYAJ-FILE-ID)
  4479*        RIDFLD   (ERPYAJ-KEY)
  4480*        UPDATE
  4481*    END-EXEC.
  4482*    MOVE '&"S        EU         (   #00004149' TO DFHEIV0
  4483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4484     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4485     MOVE X'2020233030303034313439' TO DFHEIV0(25:11)
  4486     CALL 'kxdfhei1' USING DFHEIV0,
  4487           PYAJ-FILE-ID,
  4488           DFHEIV20,
  4489           DFHEIV99,
  4490           ERPYAJ-KEY,
  4491           DFHEIV99,
  4492           DFHEIV99,
  4493           DFHEIV99
  4494     SET ADDRESS OF PENDING-PAY-ADJ TO
  4495         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  89
* EL633.cbl
  4496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4497
  4498
  4499     GO TO 2190-EXIT.
  4500
  4501 2190-DUP-RECORD.
  4502
  4503     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4504
  4505     GO TO 2190-RETRY-WRITE.
  4506
  4507 2190-EXIT.
  4508     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  90
* EL633.cbl
  4510
  4511 2200-UPDATE-COMPLETE.
  4512     IF EIBAID = DFHPF1
  4513         GO TO 4000-BROWSE-FRWD.
  4514
  4515     IF EIBAID = DFHPF2
  4516         GO TO 4100-BROWSE-BKWD.
  4517
  4518     MOVE LOW-VALUES             TO  EL633AI.
  4519
  4520     MOVE ER-0000                TO  EMI-ERROR.
  4521     MOVE -1                     TO  MAINTL.
  4522
  4523     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4524
  4525     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4526     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4527
  4528*    GO TO 4000-BROWSE-FRWD.
  4529
  4530*    GO TO 8100-SEND-INITIAL-MAP.
  4531
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  91
* EL633.cbl
  4533 4000-BROWSE-FRWD.
  4534     MOVE '1'                     TO  PI-PREV-PFKEY.
  4535     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4536
  4537     IF EIBAID = DFHPF1
  4538         IF PAGE-FULL
  4539             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4540                                      TO  PYAJ-FILE-SEQ-NO
  4541             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4542             MOVE 'N'                 TO  PYAJ-READ-SW
  4543             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4544             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4545             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4546             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4547         ELSE
  4548             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4549                                          PI-SAV-ACCT-NET
  4550                                          PI-SAV-PREV-AMT
  4551                                          PI-SAV-PREV-NET
  4552             MOVE 'Y'                 TO  PI-PAGE-SW
  4553             IF NOT END-OF-FILE
  4554                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4555                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4556             END-IF
  4557             IF TOP-OF-FILE
  4558                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4559                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4560                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4561             ELSE
  4562                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4563                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4564     ELSE
  4565         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4566         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4567         IF MAINTI = 'S'
  4568             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4569             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4570
  4571
  4572     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4573
  4574     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4575         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4576
  4577 4000-BROWSE-FRWD-FOR-PREV.
  4578*    IF END-OF-FILE
  4579*        IF EIBAID = DFHPF1
  4580*           IF PI-TOTAL-DISPLAYED
  4581*              NEXT SENTENCE
  4582*           ELSE
  4583*              MOVE -1                 TO  MAINTL
  4584*              MOVE ER-2237            TO  EMI-ERROR
  4585*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4586*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4587*              SET PINDX               TO  +2
  4588*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4589*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4590*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  92
* EL633.cbl
  4591*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4592*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4593*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4594*                                          PI-SAV-ACCT-NET
  4595*              GO TO 8100-SEND-INITIAL-MAP.
  4596*
  4597*     IF END-OF-FILE
  4598*        IF EIBAID = DFHPF1
  4599*           MOVE -1             TO  MAINTL
  4600*           MOVE ER-2237        TO  EMI-ERROR
  4601*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4602*           GO TO 8200-SEND-DATAONLY.
  4603*
  4604     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4605
  4606     IF NO-RECORDS
  4607        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4608        MOVE LOW-VALUES         TO  EL633AO
  4609        MOVE ER-2239            TO  EMI-ERROR
  4610        MOVE -1                 TO  MAINTL
  4611        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4612        GO TO 8100-SEND-INITIAL-MAP.
  4613
  4614     IF NOT-OPEN
  4615         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4616
  4617     MOVE LOW-VALUES             TO  EL633AO.
  4618     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4619
  4620     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4621          VARYING  PINDX  FROM  1  BY  1
  4622             UNTIL  END-OF-ACCT
  4623                 OR  END-OF-FILE
  4624                     OR  PAGE-FULL
  4625                         OR  NO-RECORDS.
  4626
  4627     IF NO-RECORDS
  4628         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4629         MOVE LOW-VALUES         TO  EL633AO
  4630         MOVE ER-2239            TO  EMI-ERROR
  4631         MOVE -1                 TO  MAINTL
  4632         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4633         GO TO 8100-SEND-INITIAL-MAP.
  4634
  4635     IF END-OF-FILE
  4636         IF EIBAID = DFHPF2
  4637             MOVE ER-2238        TO  EMI-ERROR
  4638             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4639             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4640         ELSE
  4641             MOVE ER-2237        TO  EMI-ERROR
  4642             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4643
  4644     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4645                                     PI-SAV-FUNCTION.
  4646
  4647     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  93
* EL633.cbl
  4649 4100-BROWSE-BKWD.
  4650     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4651                                      PI-TOTAL-DISPLAYED-SW.
  4652     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4653     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4654     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4655     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4656                                      PI-SAV-ACCT-NET
  4657                                      PI-SAV-PREV-AMT
  4658                                      PI-SAV-PREV-NET.
  4659
  4660     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4661
  4662     IF NO-RECORDS
  4663         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4664         MOVE LOW-VALUES         TO  EL633AO
  4665         MOVE ER-2239            TO  EMI-ERROR
  4666         MOVE -1                 TO  MAINTL
  4667         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4668         GO TO 8100-SEND-INITIAL-MAP.
  4669
  4670     IF NOT-OPEN
  4671         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4672
  4673
  4674* EXEC CICS READNEXT
  4675*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4676*        DATASET  (PYAJ-FILE-ID)
  4677*        RIDFLD   (ERPYAJ-KEY)
  4678*    END-EXEC.
  4679     MOVE 0
  4680       TO DFHEIV11
  4681*    MOVE '&.S                   )   #00004330' TO DFHEIV0
  4682     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4684     MOVE X'2020233030303034333330' TO DFHEIV0(25:11)
  4685     CALL 'kxdfhei1' USING DFHEIV0,
  4686           PYAJ-FILE-ID,
  4687           DFHEIV20,
  4688           DFHEIV99,
  4689           ERPYAJ-KEY,
  4690           DFHEIV99,
  4691           DFHEIV11,
  4692           DFHEIV99,
  4693           DFHEIV99
  4694     SET ADDRESS OF PENDING-PAY-ADJ TO
  4695         DFHEIV20
  4696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4697
  4698
  4699     IF FIRST-PAGE OR
  4700        PI-PREV-PFKEY = '2'
  4701         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4702         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4703
  4704     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4705
  4706     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  94
* EL633.cbl
  4707     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4708     MOVE '2'                     TO  PI-PREV-PFKEY.
  4709
  4710     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  95
* EL633.cbl
  4712 5000-START-BROWSE.
  4713
  4714* EXEC CICS HANDLE CONDITION
  4715*        NOTOPEN  (5010-NOT-OPEN)
  4716*        NOTFND   (5020-NO-RECORDS)
  4717*        ENDFILE  (5020-NO-RECORDS)
  4718*    END-EXEC.
  4719*    MOVE '"$JI''                 ! ( #00004350' TO DFHEIV0
  4720     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4722     MOVE X'2820233030303034333530' TO DFHEIV0(25:11)
  4723     CALL 'kxdfhei1' USING DFHEIV0
  4724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4725
  4726
  4727
  4728* EXEC CICS STARTBR
  4729*        DATASET  (PYAJ-FILE-ID)
  4730*        RIDFLD   (ERPYAJ-KEY)
  4731*    END-EXEC.
  4732     MOVE 0
  4733       TO DFHEIV11
  4734*    MOVE '&,         G          &   #00004356' TO DFHEIV0
  4735     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4737     MOVE X'2020233030303034333536' TO DFHEIV0(25:11)
  4738     CALL 'kxdfhei1' USING DFHEIV0,
  4739           PYAJ-FILE-ID,
  4740           ERPYAJ-KEY,
  4741           DFHEIV99,
  4742           DFHEIV11,
  4743           DFHEIV99
  4744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4745
  4746
  4747     GO TO 5030-EXIT.
  4748
  4749 5010-NOT-OPEN.
  4750     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4751
  4752     GO TO 5030-EXIT.
  4753
  4754 5020-NO-RECORDS.
  4755     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4756     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4757
  4758 5030-EXIT.
  4759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  96
* EL633.cbl
  4761 5100-READ-PREVIOUS.
  4762
  4763* EXEC CICS HANDLE CONDITION
  4764*        ENDFILE  (5110-END-OF-FILE)
  4765*        NOTFND   (5110-END-OF-FILE)
  4766*    END-EXEC.
  4767*    MOVE '"$''I                  ! ) #00004376' TO DFHEIV0
  4768     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4770     MOVE X'2920233030303034333736' TO DFHEIV0(25:11)
  4771     CALL 'kxdfhei1' USING DFHEIV0
  4772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4773
  4774
  4775
  4776* EXEC CICS READPREV
  4777*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4778*        DATASET  (PYAJ-FILE-ID)
  4779*        RIDFLD   (ERPYAJ-KEY)
  4780*    END-EXEC.
  4781     MOVE 0
  4782       TO DFHEIV11
  4783*    MOVE '&0S                   )   #00004381' TO DFHEIV0
  4784     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4785     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4786     MOVE X'2020233030303034333831' TO DFHEIV0(25:11)
  4787     CALL 'kxdfhei1' USING DFHEIV0,
  4788           PYAJ-FILE-ID,
  4789           DFHEIV20,
  4790           DFHEIV99,
  4791           ERPYAJ-KEY,
  4792           DFHEIV99,
  4793           DFHEIV11,
  4794           DFHEIV99,
  4795           DFHEIV99
  4796     SET ADDRESS OF PENDING-PAY-ADJ TO
  4797         DFHEIV20
  4798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4799
  4800
  4801     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4802         IF PI-CARRIER-SECURITY = PY-CARRIER
  4803             NEXT SENTENCE
  4804         ELSE
  4805             GO TO 5110-END-OF-FILE.
  4806
  4807     GO TO 5120-EXIT.
  4808
  4809 5110-END-OF-FILE.
  4810     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4811     MOVE ER-2238                TO  EMI-ERROR.
  4812     MOVE -1                     TO  PFENTERL.
  4813
  4814     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4815
  4816     GO TO 8200-SEND-DATAONLY.
  4817
  4818 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  97
* EL633.cbl
  4819     EXIT.
  4820
  4821 5200-END-BROWSE.
  4822
  4823* EXEC CICS ENDBR
  4824*        DATASET  (PYAJ-FILE-ID)
  4825*    END-EXEC.
  4826     MOVE 0
  4827       TO DFHEIV11
  4828*    MOVE '&2                    $   #00004408' TO DFHEIV0
  4829     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4830     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4831     MOVE X'2020233030303034343038' TO DFHEIV0(25:11)
  4832     CALL 'kxdfhei1' USING DFHEIV0,
  4833           PYAJ-FILE-ID,
  4834           DFHEIV11,
  4835           DFHEIV99
  4836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4837
  4838
  4839 5200-EXIT.
  4840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  98
* EL633.cbl
  4842 6000-READ-AND-FORMAT-SCREEN.
  4843
  4844* EXEC CICS HANDLE CONDITION
  4845*        ENDFILE  (6100-END-OF-FILE)
  4846*        NOTFND   (6100-END-OF-FILE)
  4847*    END-EXEC.
  4848*    MOVE '"$''I                  ! * #00004416' TO DFHEIV0
  4849     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4851     MOVE X'2A20233030303034343136' TO DFHEIV0(25:11)
  4852     CALL 'kxdfhei1' USING DFHEIV0
  4853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4854
  4855
  4856*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4857*    INITIALIZE  PI-SEQ-NOS.
  4858
  4859 6010-READ-NEXT.
  4860
  4861
  4862* EXEC CICS READNEXT
  4863*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4864*        DATASET  (PYAJ-FILE-ID)
  4865*        RIDFLD   (ERPYAJ-KEY)
  4866*    END-EXEC.
  4867     MOVE 0
  4868       TO DFHEIV11
  4869*    MOVE '&.S                   )   #00004426' TO DFHEIV0
  4870     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4871     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4872     MOVE X'2020233030303034343236' TO DFHEIV0(25:11)
  4873     CALL 'kxdfhei1' USING DFHEIV0,
  4874           PYAJ-FILE-ID,
  4875           DFHEIV20,
  4876           DFHEIV99,
  4877           ERPYAJ-KEY,
  4878           DFHEIV99,
  4879           DFHEIV11,
  4880           DFHEIV99,
  4881           DFHEIV99
  4882     SET ADDRESS OF PENDING-PAY-ADJ TO
  4883         DFHEIV20
  4884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4885
  4886
  4887     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4888       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4889         GO TO 6100-END-OF-FILE.
  4890
  4891     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4892         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4893             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4894                 GO TO 6100-END-OF-FILE.
  4895
  4896     IF PYAJ-1ST-READ
  4897       AND EIBAID NOT = DFHENTER
  4898       AND NOT PAGE-FULL
  4899         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page  99
* EL633.cbl
  4900         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4901         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4902         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4903         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4904
  4905     IF PYAJ-1ST-READ
  4906         MOVE PI-SAV-ENDING-PYAJ-KEY
  4907                                 TO  PI-START-PYAJ-KEY.
  4908
  4909     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4910        PI-SAV-CARRIER  = PY-CARRIER     AND
  4911        PI-SAV-GROUPING = PY-GROUPING    AND
  4912        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4913        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4914         NEXT SENTENCE
  4915     ELSE
  4916         IF PYAJ-1ST-READ
  4917             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4918             MOVE SPACE          TO  PYAJ-READ-SW
  4919             GO TO 6200-EXIT
  4920         ELSE
  4921             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4922             IF PINDX  IS LESS THAN  12
  4923                 SET PINDX  UP  BY  1
  4924                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4925                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4926                 SET PINDX  UP  BY  1
  4927                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4928                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4929                     GO TO 6200-EXIT
  4930             ELSE
  4931                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4932                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4933                 SET PINDX  UP  BY  1
  4934                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4935                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4936                 GO TO 6200-EXIT.
  4937
  4938*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4939
  4940     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4941         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4942
  4943*    SET PINDX  UP  BY +1.
  4944
  4945     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4946
  4947     IF PINDX  IS GREATER THAN  13
  4948         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4949         MOVE +13                TO  PI-FULL-INDX
  4950         MOVE PI-FRST-FILE-SEQ-NO
  4951                                 TO  PI-LAST-FILE-SEQ-NO
  4952         MOVE PI-FRST-RECORD-TYPE
  4953                                 TO  PI-LAST-RECORD-TYPE
  4954         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4955         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4956         GO TO 6200-EXIT.
  4957
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 100
* EL633.cbl
  4958     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4959     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4960
  4961     IF PYAJ-1ST-READ
  4962         MOVE SPACE              TO  PYAJ-READ-SW.
  4963
  4964     IF PINDX = 1
  4965         MOVE PI-PREV-FILE-SEQ-NO
  4966                                 TO  PI-FRST-FILE-SEQ-NO
  4967         MOVE PI-PREV-RECORD-TYPE
  4968                                 TO  PI-FRST-RECORD-TYPE
  4969         MOVE PI-PREV-FILE-SEQ-NO
  4970                                 TO  PI-LAST-FILE-SEQ-NO
  4971         MOVE PI-PREV-RECORD-TYPE
  4972                                 TO  PI-LAST-RECORD-TYPE.
  4973
  4974     SET NDX                     TO  PINDX.
  4975     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4976
  4977     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4978
  4979     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4980     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4981     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4982     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4983     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4984
  4985     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4986
  4987     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4988         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4989     ELSE
  4990         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4991
  4992     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4993                                     PI-REC-TYPE (NDX).
  4994
  4995     IF PY-VOID-SW NOT = SPACE
  4996         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4997
  4998     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  4999         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  5000     ELSE
  5001         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  5002                                     PREV-BIN-MAINT-DT
  5003         MOVE SPACE              TO  DC-OPTION-CODE
  5004         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5005* DAN    MOVE DC-GREG-DATE-1-EDIT
  5006         MOVE DC-GREG-DATE-1-MDY
  5007                                 TO  MDTE (PINDX)
  5008                                     PREV-MAINT-DT.
  5009
  5010*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  5011     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  5012         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  5013         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  5014*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  5015*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 101
* EL633.cbl
  5016     END-IF.
  5017
  5018     IF PY-BILLED-DATE NOT = LOW-VALUES
  5019         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  5020                                     AMT-ATTRB (PINDX)
  5021                                     VOID-SW-ATTRB (PINDX)
  5022         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  5023             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  5024         ELSE
  5025             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5026                                     PREV-BIN-BL-DT
  5027             MOVE SPACE          TO  DC-OPTION-CODE
  5028             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5029* DAN        MOVE DC-GREG-DATE-1-EDIT
  5030             MOVE DC-GREG-DATE-1-MDY
  5031                                 TO  BDTE (PINDX)
  5032                                     PREV-BL-DT.
  5033
  5034     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5035         NEXT SENTENCE
  5036     ELSE
  5037         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5038                                     AMT-ATTRB     (PINDX).
  5039
  5040     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5041         MOVE PY-CREDIT-SELECT-DT
  5042                                 TO  DC-BIN-DATE-1
  5043         MOVE SPACE              TO  DC-OPTION-CODE
  5044         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5045
  5046         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5047         MOVE WS-GS-MM             TO  WS-SS-MM
  5048         MOVE WS-GS-DD             TO  WS-SS-DD
  5049         MOVE WS-GS-YY             TO  WS-SS-YY
  5050         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5051     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5052        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5053         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5054                                    AMT-ATTRB      (PINDX)
  5055                                    GL-ACCT-ATTRB  (PINDX)
  5056                                    GL-COMM-ATTRB  (PINDX)
  5057                                    VOID-SW-ATTRB  (PINDX)
  5058                                    GL-STATE-ATTRB (PINDX)
  5059                                    GL-CANC-ATTRB  (PINDX)
  5060                                    SDTE-ATTRB     (PINDX)
  5061
  5062     END-IF
  5063
  5064*    GO TO 6010-READ-NEXT.
  5065     GO TO 6200-EXIT.
  5066
  5067 6100-END-OF-FILE.
  5068     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5069
  5070     IF PINDX  IS LESS THAN  12
  5071         SET PINDX  UP  BY  1
  5072         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5073         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 102
* EL633.cbl
  5074         SET PINDX  UP  BY  1
  5075         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5076         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5077         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5078     ELSE
  5079         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5080         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5081         SET PINDX  UP  BY  1
  5082         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5083         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5084
  5085 6200-EXIT.
  5086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 103
* EL633.cbl
  5088 7000-PYAJ-FILE-NOTOPEN.
  5089     MOVE -1                     TO  MAINTL.
  5090     MOVE ER-2232                TO  EMI-ERROR.
  5091
  5092     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5093
  5094     GO TO 8200-SEND-DATAONLY.
  5095
  5096 7100-COMP-FILE-NOTOPEN.
  5097     MOVE -1                     TO  MAINTL.
  5098     MOVE ER-2233                TO  EMI-ERROR.
  5099
  5100     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5101
  5102     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 104
* EL633.cbl
  5104*
  5105*7100-COFA-FILE-NOTOPEN.
  5106*    MOVE -1                     TO PFENTERL.
  5107*    MOVE ER-2959                TO EMI-ERROR.
  5108*    PERFORM 9900-ERROR-FORMAT THRU
  5109*            9900-EXIT.
  5110*    GO TO 8200-SEND-DATAONLY.
  5111*
  5112 8100-SEND-INITIAL-MAP.
  5113     MOVE WS-CURRENT-DT          TO  DATEO.
  5114     MOVE EIBTIME                TO  TIME-IN.
  5115     MOVE TIME-OUT               TO  TIMEO.
  5116     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5117     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5118     MOVE -1                     TO  MAINTL.
  5119     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5120     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5121
  5122     IF EIBTRNID = TRANS-ID
  5123       OR EL640-TRANS-ID
  5124       OR EL642-TRANS-ID
  5125       OR EL652-TRANS-ID
  5126       OR EL6331-TRANS-ID
  5127         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5128             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5129             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5130             MOVE PI-SAV-GROUPING  TO  GROUPO
  5131             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5132             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5133             MOVE AL-UANON         TO  MAINTA
  5134                                       CARRIERA
  5135                                       GROUPA
  5136                                       FINRESPA
  5137                                       ACCTA
  5138         ELSE
  5139             NEXT SENTENCE.
  5140
  5141
  5142* EXEC CICS SEND
  5143*        MAP     (MAP-NAME)
  5144*        MAPSET  (MAPSET-NAME)
  5145*        FROM    (EL633AO)
  5146*        ERASE
  5147*        CURSOR
  5148*        END-EXEC.
  5149     MOVE LENGTH OF
  5150      EL633AO
  5151       TO DFHEIV12
  5152     MOVE -1
  5153       TO DFHEIV11
  5154*    MOVE '8$     CT  E    H L F ,   #00004686' TO DFHEIV0
  5155     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5156     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5157     MOVE X'2020233030303034363836' TO DFHEIV0(25:11)
  5158     CALL 'kxdfhei1' USING DFHEIV0,
  5159           MAP-NAME,
  5160           EL633AO,
  5161           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 105
* EL633.cbl
  5162           MAPSET-NAME,
  5163           DFHEIV99,
  5164           DFHEIV99,
  5165           DFHEIV99,
  5166           DFHEIV11,
  5167           DFHEIV99,
  5168           DFHEIV99,
  5169           DFHEIV99
  5170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5171
  5172
  5173     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 106
* EL633.cbl
  5175 8200-SEND-DATAONLY.
  5176     MOVE WS-CURRENT-DT          TO  DATEO.
  5177     MOVE EIBTIME                TO  TIME-IN.
  5178     MOVE TIME-OUT               TO  TIMEO.
  5179     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5180     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5181     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5182     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5183
  5184
  5185* EXEC CICS SEND
  5186*        MAP     (MAP-NAME)
  5187*        MAPSET  (MAPSET-NAME)
  5188*        FROM    (EL633AO)
  5189*        DATAONLY
  5190*        CURSOR
  5191*    END-EXEC.
  5192     MOVE LENGTH OF
  5193      EL633AO
  5194       TO DFHEIV12
  5195     MOVE -1
  5196       TO DFHEIV11
  5197*    MOVE '8$D    CT       H L F ,   #00004705' TO DFHEIV0
  5198     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5199     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5200     MOVE X'2020233030303034373035' TO DFHEIV0(25:11)
  5201     CALL 'kxdfhei1' USING DFHEIV0,
  5202           MAP-NAME,
  5203           EL633AO,
  5204           DFHEIV12,
  5205           MAPSET-NAME,
  5206           DFHEIV99,
  5207           DFHEIV99,
  5208           DFHEIV99,
  5209           DFHEIV11,
  5210           DFHEIV99,
  5211           DFHEIV99,
  5212           DFHEIV99
  5213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5214
  5215
  5216     GO TO 9100-RETURN-TRAN.
  5217
  5218 8300-SEND-TEXT.
  5219
  5220* EXEC CICS SEND TEXT
  5221*        FROM    (LOGOFF-TEXT)
  5222*        LENGTH  (LOGOFF-LENGTH)
  5223*        ERASE
  5224*        FREEKB
  5225*    END-EXEC.
  5226*    MOVE '8&      T  E F  H   F -   #00004716' TO DFHEIV0
  5227     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5228     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5229     MOVE X'2020233030303034373136' TO DFHEIV0(25:11)
  5230     CALL 'kxdfhei1' USING DFHEIV0,
  5231           LOGOFF-TEXT,
  5232           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 107
* EL633.cbl
  5233           DFHEIV99,
  5234           DFHEIV99,
  5235           DFHEIV99,
  5236           DFHEIV99,
  5237           DFHEIV99,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99,
  5242           DFHEIV99
  5243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5244
  5245
  5246
  5247* EXEC CICS RETURN
  5248*    END-EXEC.
  5249*    MOVE '.(                    ''   #00004723' TO DFHEIV0
  5250     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5252     MOVE X'2020233030303034373233' TO DFHEIV0(25:11)
  5253     CALL 'kxdfhei1' USING DFHEIV0,
  5254           DFHEIV99,
  5255           DFHEIV99,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99,
  5259           DFHEIV99
  5260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5261
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 108
* EL633.cbl
  5263 8400-LOG-JOURNAL-RECORD.
  5264*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5265*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5266
  5267*    EXEC CICS JOURNAL
  5268*        JFILEID  (PI-JOURNAL-FILE-ID)
  5269*        JTYPEID  ('EL')
  5270*        FROM     (JOURNAL-RECORD)
  5271*        LENGTH   (223)
  5272*        END-EXEC.
  5273
  5274 8500-DATE-CONVERT.
  5275
  5276* EXEC CICS LINK
  5277*        PROGRAM   (LINK-CLDATCV)
  5278*        COMMAREA  (DATE-CONVERSION-DATA)
  5279*        LENGTH    (DC-COMM-LENGTH)
  5280*    END-EXEC.
  5281*    MOVE '."C                   (   #00004738' TO DFHEIV0
  5282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5284     MOVE X'2020233030303034373338' TO DFHEIV0(25:11)
  5285     CALL 'kxdfhei1' USING DFHEIV0,
  5286           LINK-CLDATCV,
  5287           DATE-CONVERSION-DATA,
  5288           DC-COMM-LENGTH,
  5289           DFHEIV99,
  5290           DFHEIV99,
  5291           DFHEIV99,
  5292           DFHEIV99
  5293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5294
  5295
  5296 8500-EXIT.
  5297     EXIT.
  5298
  5299 8600-DEEDIT.
  5300
  5301* EXEC CICS BIF DEEDIT
  5302*        FIELD   (DEEDIT-FIELD)
  5303*        LENGTH  (11)
  5304*    END-EXEC.
  5305     MOVE 11
  5306       TO DFHEIV11
  5307*    MOVE '@"L                   #   #00004748' TO DFHEIV0
  5308     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5309     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5310     MOVE X'2020233030303034373438' TO DFHEIV0(25:11)
  5311     CALL 'kxdfhei1' USING DFHEIV0,
  5312           DEEDIT-FIELD,
  5313           DFHEIV11
  5314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5315
  5316
  5317 8600-EXIT.
  5318     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 109
* EL633.cbl
  5320 8800-UNAUTHORIZED-ACCESS.
  5321     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5322
  5323     GO TO 8300-SEND-TEXT.
  5324
  5325 8810-PF23.
  5326     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5327     MOVE XCTL-005               TO  PGM-NAME.
  5328
  5329     GO TO 9300-XCTL.
  5330
  5331 9100-RETURN-TRAN.
  5332     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5333     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5334
  5335
  5336* EXEC CICS RETURN
  5337*        TRANSID   (TRANS-ID)
  5338*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5339*        LENGTH    (PI-COMM-LENGTH)
  5340*    END-EXEC.
  5341*    MOVE '.(CT                  ''   #00004771' TO DFHEIV0
  5342     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5343     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5344     MOVE X'2020233030303034373731' TO DFHEIV0(25:11)
  5345     CALL 'kxdfhei1' USING DFHEIV0,
  5346           TRANS-ID,
  5347           PROGRAM-INTERFACE-BLOCK,
  5348           PI-COMM-LENGTH,
  5349           DFHEIV99,
  5350           DFHEIV99,
  5351           DFHEIV99
  5352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5353
  5354
  5355 9200-RETURN-MAIN-MENU.
  5356     MOVE XCTL-626               TO  PGM-NAME.
  5357
  5358     GO TO 9300-XCTL.
  5359
  5360 9300-XCTL.
  5361
  5362* EXEC CICS XCTL
  5363*        PROGRAM   (PGM-NAME)
  5364*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5365*        LENGTH    (PI-COMM-LENGTH)
  5366*    END-EXEC.
  5367*    MOVE '.$C                   %   #00004783' TO DFHEIV0
  5368     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5370     MOVE X'2020233030303034373833' TO DFHEIV0(25:11)
  5371     CALL 'kxdfhei1' USING DFHEIV0,
  5372           PGM-NAME,
  5373           PROGRAM-INTERFACE-BLOCK,
  5374           PI-COMM-LENGTH,
  5375           DFHEIV99
  5376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5377
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 110
* EL633.cbl
  5378
  5379 9400-CLEAR.
  5380     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5381
  5382     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5383     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5384                                     PI-SAV-COMP-CONTROL.
  5385
  5386     GO TO 9300-XCTL.
  5387
  5388 9500-PF12.
  5389     MOVE XCTL-010               TO  PGM-NAME.
  5390
  5391     GO TO 9300-XCTL.
  5392
  5393 9600-PGMID-ERROR.
  5394
  5395* EXEC CICS HANDLE CONDITION
  5396*        PGMIDERR  (8300-SEND-TEXT)
  5397*    END-EXEC.
  5398*    MOVE '"$L                   ! + #00004804' TO DFHEIV0
  5399     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5401     MOVE X'2B20233030303034383034' TO DFHEIV0(25:11)
  5402     CALL 'kxdfhei1' USING DFHEIV0
  5403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5404
  5405
  5406     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5407     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5408     MOVE XCTL-005               TO  PGM-NAME.
  5409     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5410     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5411
  5412     GO TO 9300-XCTL.
  5413
  5414 9900-ERROR-FORMAT.
  5415     IF NOT EMI-ERRORS-COMPLETE
  5416         MOVE LINK-001           TO  PGM-NAME
  5417
  5418* EXEC CICS LINK
  5419*            PROGRAM   (PGM-NAME)
  5420*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5421*            LENGTH    (EMI-COMM-LENGTH)
  5422*        END-EXEC.
  5423*    MOVE '."C                   (   #00004819' TO DFHEIV0
  5424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5426     MOVE X'2020233030303034383139' TO DFHEIV0(25:11)
  5427     CALL 'kxdfhei1' USING DFHEIV0,
  5428           PGM-NAME,
  5429           ERROR-MESSAGE-INTERFACE-BLOCK,
  5430           EMI-COMM-LENGTH,
  5431           DFHEIV99,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99
  5435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 111
* EL633.cbl
  5436
  5437
  5438 9900-EXIT.
  5439     EXIT.
  5440
  5441 9990-ABEND.
  5442     MOVE LINK-004               TO  PGM-NAME.
  5443     MOVE DFHEIBLK               TO  EMI-LINE1.
  5444
  5445
  5446* EXEC CICS LINK
  5447*        PROGRAM   (PGM-NAME)
  5448*        COMMAREA  (EMI-LINE1)
  5449*        LENGTH    (72)
  5450*    END-EXEC.
  5451     MOVE 72
  5452       TO DFHEIV11
  5453*    MOVE '."C                   (   #00004832' TO DFHEIV0
  5454     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5455     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5456     MOVE X'2020233030303034383332' TO DFHEIV0(25:11)
  5457     CALL 'kxdfhei1' USING DFHEIV0,
  5458           PGM-NAME,
  5459           EMI-LINE1,
  5460           DFHEIV11,
  5461           DFHEIV99,
  5462           DFHEIV99,
  5463           DFHEIV99,
  5464           DFHEIV99
  5465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5466
  5467
  5468     MOVE -1                     TO  PFENTERL.
  5469
  5470     GO TO 8200-SEND-DATAONLY.
  5471
  5472 9995-SECURITY-VIOLATION.
  5473*                            COPY ELCSCTP.
  5474******************************************************************
  5475*                                                                *
  5476*                            ELCSCTP                             *
  5477*                            VMOD=2.001                          *
  5478*                                                                *
  5479*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5480******************************************************************
  5481
  5482
  5483     MOVE EIBDATE          TO SM-JUL-DATE.
  5484     MOVE EIBTRMID         TO SM-TERMID.
  5485     MOVE THIS-PGM         TO SM-PGM.
  5486     MOVE EIBTIME          TO TIME-IN.
  5487     MOVE TIME-OUT         TO SM-TIME.
  5488     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5489
  5490
  5491* EXEC CICS LINK
  5492*         PROGRAM  ('EL003')
  5493*         COMMAREA (SECURITY-MESSAGE)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 112
* EL633.cbl
  5494*         LENGTH   (80)
  5495*    END-EXEC.
  5496     MOVE 'EL003' TO DFHEIV1
  5497     MOVE 80
  5498       TO DFHEIV11
  5499*    MOVE '."C                   (   #00004860' TO DFHEIV0
  5500     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5502     MOVE X'2020233030303034383630' TO DFHEIV0(25:11)
  5503     CALL 'kxdfhei1' USING DFHEIV0,
  5504           DFHEIV1,
  5505           SECURITY-MESSAGE,
  5506           DFHEIV11,
  5507           DFHEIV99,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV99
  5511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5512
  5513
  5514******************************************************************
  5515
  5516
  5517 9995-EXIT.
  5518     EXIT.
  5519
  5520
  5521 9999-DFHBACK SECTION.
  5522     MOVE '9%                    "   ' TO DFHEIV0
  5523     MOVE 'EL633' TO DFHEIV1
  5524     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5525     GOBACK.
  5526 9999-DFHEXIT.
  5527     IF DFHEIGDJ EQUAL 0001
  5528         NEXT SENTENCE
  5529     ELSE IF DFHEIGDJ EQUAL 2
  5530         GO TO 9600-PGMID-ERROR,
  5531               9990-ABEND
  5532         DEPENDING ON DFHEIGDI
  5533     ELSE IF DFHEIGDJ EQUAL 3
  5534         GO TO 0410-NO-COMP-MSTR,
  5535               7100-COMP-FILE-NOTOPEN
  5536         DEPENDING ON DFHEIGDI
  5537     ELSE IF DFHEIGDJ EQUAL 4
  5538         GO TO 0890-EXIT
  5539         DEPENDING ON DFHEIGDI
  5540     ELSE IF DFHEIGDJ EQUAL 5
  5541         GO TO 2110-ADD-RECORD
  5542         DEPENDING ON DFHEIGDI
  5543     ELSE IF DFHEIGDJ EQUAL 6
  5544         GO TO 2120-DELETE-CONT
  5545         DEPENDING ON DFHEIGDI
  5546     ELSE IF DFHEIGDJ EQUAL 7
  5547         GO TO 2190-DUP-RECORD
  5548         DEPENDING ON DFHEIGDI
  5549     ELSE IF DFHEIGDJ EQUAL 8
  5550         GO TO 5010-NOT-OPEN,
  5551               5020-NO-RECORDS,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 12:18 Page 113
* EL633.cbl
  5552               5020-NO-RECORDS
  5553         DEPENDING ON DFHEIGDI
  5554     ELSE IF DFHEIGDJ EQUAL 9
  5555         GO TO 5110-END-OF-FILE,
  5556               5110-END-OF-FILE
  5557         DEPENDING ON DFHEIGDI
  5558     ELSE IF DFHEIGDJ EQUAL 10
  5559         GO TO 6100-END-OF-FILE,
  5560               6100-END-OF-FILE
  5561         DEPENDING ON DFHEIGDI
  5562     ELSE IF DFHEIGDJ EQUAL 11
  5563         GO TO 8300-SEND-TEXT
  5564         DEPENDING ON DFHEIGDI.
  5565     MOVE '9%                    "   ' TO DFHEIV0
  5566     MOVE 'EL633' TO DFHEIV1
  5567     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5568     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5640     Code:       16735
