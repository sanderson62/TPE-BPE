* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    83******************************************************************
    84
    85 ENVIRONMENT DIVISION.
    86
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   4
* EL6311.cbl
    88 DATA DIVISION.
    89 WORKING-STORAGE SECTION.
    90 01  DFH-START PIC X(04).
    91 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    92 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    93 77  FILLER  PIC X(32)  VALUE '********************************'.
    94 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    95 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    96 77  A1                          PIC S999 COMP-3 VALUE +0.
    97 77  N1                          PIC S999 COMP-3 VALUE +0.
    98 77  N2                          PIC S999 COMP-3 VALUE +0.
    99 77  N3                          PIC S999 COMP-3 VALUE +0.
   100 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   101 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   102 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   103     88  REVERSAL                    VALUE 'Y'.
   104 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   105 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   106 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   107 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   108 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   109     88  ERMAIL-FOUND                 VALUE 'Y'.
   110 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   111 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   112 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   113 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   114     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   115 77  ws-stop-sw                  pic x value ' '.
   116     88  i-say-stop                 value 'Y'.
   117 77  ws-check-sw                 pic x value ' '.
   118     88  i-have-checks              value 'Y'.
   119 77  ws-proc-check-sw            pic x value ' '.
   120     88  i-have-processed-checks    value 'Y'.
   121 77  ws-any-check-sw             pic x value ' '.
   122     88  i-have-a-check-period      value 'Y'.
   123 77  ws-chek-browse-sw           pic x value ' '.
   124 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   125 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   126 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   127 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   128 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   129 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   130 77  ws-elcrtt-update-sw         pic x value ' '.
   131     88  update-elcrtt              value 'Y'.
   132 01  P pointer.
   133 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   134 01  var-ptr pointer.
   135 01  env-var-len                 pic 9(4)  binary.
   136 01  rc                          pic 9(9)  binary.
   137 01  WS-KIXSYS.
   138     05  WS-KIX-FIL1             PIC X(10).
   139     05  WS-KIX-APPS             PIC X(10).
   140     05  WS-KIX-ENV              PIC X(10).
   141     05  WS-KIX-MYENV            PIC X(10).
   142     05  WS-KIX-SYS              PIC X(10).
   143*    COPY ELCSCTM.
   144******************************************************************
   145*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   5
* EL6311.cbl
   146*                                                                *
   147*                            ELCSCTM                             *
   148*                            VMOD=2.001                          *
   149*                                                                *
   150*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   151*                                                                *
   152******************************************************************
   153 01  SECURITY-MESSAGE.
   154     12  FILLER                          PIC X(30)
   155            VALUE '** LOGIC SECURITY VIOLATION -'.
   156     12  SM-READ                         PIC X(6).
   157     12  FILLER                          PIC X(5)
   158            VALUE ' PGM='.
   159     12  SM-PGM                          PIC X(6).
   160     12  FILLER                          PIC X(5)
   161            VALUE ' OPR='.
   162     12  SM-PROCESSOR-ID                 PIC X(4).
   163     12  FILLER                          PIC X(6)
   164            VALUE ' TERM='.
   165     12  SM-TERMID                       PIC X(4).
   166     12  FILLER                          PIC XX   VALUE SPACE.
   167     12  SM-JUL-DATE                     PIC 9(5).
   168     12  FILLER                          PIC X    VALUE SPACE.
   169     12  SM-TIME                         PIC 99.99.
   170
   171
   172*    COPY ELCSCRTY.
   173******************************************************************
   174*                                                                *
   175*                                                                *
   176*                            ELCSCRTY                            *
   177*                            VMOD=2.001                          *
   178*                                                                *
   179*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   180*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   181*        SAVED IN PI-SECURITY-ADDRESS.                           *
   182*                                                                *
   183******************************************************************
   184 01  SECURITY-CONTROL.
   185     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   186     12  FILLER                       PIC XX    VALUE 'SC'.
   187     12  SC-CREDIT-CODES.
   188         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   189             20  SC-CREDIT-DISPLAY    PIC X.
   190             20  SC-CREDIT-UPDATE     PIC X.
   191     12  SC-CLAIMS-CODES.
   192         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   193             20  SC-CLAIMS-DISPLAY    PIC X.
   194             20  SC-CLAIMS-UPDATE     PIC X.
   195
   196 01  WS-VA-NO-COMM-MESS.
   197     12  FILLER                  PIC X(41) VALUE
   198        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   199 01  WS-OC-MESSAGE.
   200     12  FILLER                  PIC X(43) VALUE
   201        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   202     12  WS-OC-DIS-AMT           PIC -----9.99.
   203     12  FILLER                  PIC X(4) VALUE ' ON '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   6
* EL6311.cbl
   204     12  WS-OC-DATE              PIC X(10).
   205 01  WS-DATE-AREA.
   206     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   207     12  WS-CURRENT-DT.
   208         16  FILLER              PIC X(6)    VALUE SPACES.
   209         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   210     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   211     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   212     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   213
   214 01  STANDARD-AREAS.
   215     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   216     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   217     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   218     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   219     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   220     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   221     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   222     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   223     12  PGM-NAME                PIC X(8).
   224     12  TIME-IN                 PIC S9(7).
   225     12  TIME-OUT-R  REDEFINES TIME-IN.
   226         16  FILLER              PIC X.
   227         16  TIME-OUT            PIC 99V99.
   228         16  FILLER              PIC XX.
   229     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   230     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   231     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   232     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   233     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   234     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   235     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   236     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   237     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   238     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   239     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   240     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   241     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   242     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   243     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   244     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   245     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   246     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   247     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   248     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   249     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   250     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   251     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   252     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   253     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   254     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   255     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   256     12  FILE-ID                 PIC X(8).
   257     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   258     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   259     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   260     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   261     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   7
* EL6311.cbl
   262     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   263     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   264     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   265     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   266     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   267     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   268     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   269     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   270     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   271     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   272
   273 01  WS-PASS-AREA.
   274     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   275     05  WS-PASS-VADS-REC    PIC X(350).
   276*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   277*                                COPY ELCZREC.
   278******************************************************************
   279*                                                                *
   280*                                                                *
   281*                            ELCZREC.                            *
   282*                                                                *
   283*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   284*                                                                *
   285******************************************************************
   286*-----------------------------------------------------------------
   287*                   C H A N G E   L O G
   288*
   289* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   290*-----------------------------------------------------------------
   291*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   292* EFFECTIVE    NUMBER
   293*-----------------------------------------------------------------
   294* 122011    2011022800001  AJRA  NEW FILE
   295* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   296* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   297* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   298* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   299*-----------------------------------------------------------------
   300 01  W-Z-CONTROL-DATA.
   301     05  W-NUMBER-OF-COPIES      PIC  9.
   302     05  FILLER                  PIC  X.
   303     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   304     05  FILLER                  PIC  X.
   305     05  W-DAYS-TO-RESEND        PIC  999.
   306     05  FILLER                  PIC  X.
   307     05  W-FORM-TO-RESEND        PIC  X(4).
   308     05  W-ADD-BAR-CODE          PIC  X.
   309     05  W-PROMPT-LETTER         PIC  X.
   310     05  W-HAS-RETURN-ENV        PIC  X.
   311     05  W-ENCLOSURE-CD          PIC  XXX.
   312     05  W-SIG-FLAG-DEFAULT      PIC  X.
   313     05  W-AUTO-CLOSE-IND        PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-LETTER-TO-BENE        PIC  X.
   316     05  FILLER                  PIC  X.
   317     05  W-LETTER-TO-ACCT        PIC  X.
   318     05  FILLER                  PIC  X.
   319     05  W-LETTER-TYPE           PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   8
* EL6311.cbl
   320     05  FILLER                  PIC  X.
   321     05  W-PRINT-CERTIFICATE     PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-REFUND-REQUIRED       PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-ONBASE-CODE           PIC  XX.
   326     05  FILLER                  PIC  X.
   327     05  W-ACCT-SUMM             PIC  X.
   328     05  FILLER                  PIC  X.
   329     05  W-CSO-SUMM              PIC  X.
   330     05  FILLER                  PIC  X.
   331     05  W-REASONS-REQUIRED      PIC  X.
   332     05  FILLER                  PIC  X(29).
   333******************************************************************
   334*                                                                *
   335*              A C C E S S   K E Y S                             *
   336*                                                                *
   337******************************************************************
   338
   339 01  ACCESS-KEYS.
   340     12  ERPYAJ-KEY.
   341         16  ERPYAJ-COMPANY-CD       PIC X.
   342         16  ERPYAJ-CARRIER          PIC X.
   343         16  ERPYAJ-GROUPING         PIC X(6).
   344         16  ERPYAJ-FIN-RESP         PIC X(10).
   345         16  ERPYAJ-ACCOUNT          PIC X(10).
   346         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   347         16  ERPYAJ-TYPE             PIC X.
   348     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   349     12  ELCERT-KEY.
   350         16  ELCERT-COMPANY-CD       PIC X.
   351         16  ELCERT-CARRIER          PIC X.
   352         16  ELCERT-GROUPING         PIC X(6).
   353         16  ELCERT-STATE            PIC XX.
   354         16  ELCERT-ACCOUNT          PIC X(10).
   355         16  ELCERT-CERT-EFF-DT      PIC XX.
   356         16  ELCERT-CERT-NO.
   357             20  ELCERT-CERT-PRIME   PIC X(10).
   358             20  ELCERT-CERT-SFX     PIC X.
   359
   360     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   361     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   362     12  ELCRTO-KEY.
   363         16  ELCRTO-COMPANY-CD       PIC X.
   364         16  ELCRTO-CARRIER          PIC X.
   365         16  ELCRTO-GROUPING         PIC X(6).
   366         16  ELCRTO-STATE            PIC XX.
   367         16  ELCRTO-ACCOUNT          PIC X(10).
   368         16  ELCRTO-CERT-EFF-DT      PIC XX.
   369         16  ELCRTO-CERT-NO.
   370             20  ELCRTO-CERT-PRIME   PIC X(10).
   371             20  ELCRTO-CERT-SFX     PIC X.
   372         16  ELCRTO-RECORD-TYPE      PIC X.
   373         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   374
   375     12  ELCRTT-KEY.
   376         16  ELCRTT-PRIMARY          PIC X(33).
   377         16  ELCRTT-REC-TYPE         PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page   9
* EL6311.cbl
   378     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   379     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   380
   381     12  ERPNDB-KEY.
   382         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   383         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   384         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   385         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   386             ERPNDB-BATCH-SEQ-NO     PIC XX.
   387         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   388
   389     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   390     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   391     12  ERCHEK-KEY.
   392         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   393         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   394         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   395         16  CHEK-STATE              PIC XX      VALUE SPACES.
   396         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   397         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   398         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   399         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   400         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   401     12  ELLETR-KEY.
   402         16  LETR-COMPANY-CD     PIC X.
   403         16  LETR-LETTER-ID      PIC X(4).
   404         16  LETR-FILLER         PIC X(8).
   405         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   406     12  ERPNDM-KEY.
   407         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   408         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   409         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   410         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   411
   412*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   413     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   414*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   415     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   416
   417     12  ERPNDB-ALT-KEY.
   418         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   419         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   420         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   421         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   422         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   423         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   424         16  ERPNDB-CERT-NO.
   425             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   426             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   427         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   428         16  ERPNDB-RECORD-TYPE      PIC X.
   429
   430      12  ERPNDB-CSR-KEY.
   431          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   432          20  ERPNDB-CSR-ID                PIC X(4).
   433          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   434          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   435          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  10
* EL6311.cbl
   436
   437     12  ERNOTE-KEY.
   438         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   439         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   440         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   441         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   442         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   443         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   444         16  ERNOTE-CERT-NO.
   445             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   446             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   447
   448     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   449     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   450
   451     12  ERCNOT-KEY.
   452         16  ERCNOT-PART-KEY.
   453             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   454             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   455             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   456             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   457             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   458             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   459             20  ERCNOT-CERT-NO.
   460                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   461                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   462         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   463         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   464
   465     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   466     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   467
   468     12  ERMAIL-KEY.
   469         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   470         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   471         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   472         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   473         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   474         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   475         16  ERMAIL-CERT-NO.
   476             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   477             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   478
   479     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   480     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   481
   482     12  ERRQST-KEY.
   483         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   484         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   485
   486     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   487     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   488
   489     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   490
   491     12  ERLOFC-KEY.
   492         16  ERLOFC-COMPANY-CD          PIC  X.
   493         16  ERLOFC-CARRIER             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  11
* EL6311.cbl
   494         16  ERLOFC-GROUPING            PIC  X(6).
   495         16  ERLOFC-STATE               PIC  XX.
   496         16  ERLOFC-ACCOUNT             PIC  X(10).
   497         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   498*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   499
   500     12  ERACCT-KEY.
   501         16  ERACCT-COMPANY-CD          PIC  X.
   502         16  ERACCT-CARRIER             PIC  X.
   503         16  ERACCT-GROUPING            PIC  X(6).
   504         16  ERACCT-STATE               PIC  XX.
   505         16  ERACCT-ACCOUNT             PIC  X(10).
   506         16  ERACCT-EXP-DT.
   507             20  ERACCT-DT              PIC  XX.
   508             20  ERACCT-FILL            PIC  X(4).
   509     12  ERENDT-KEY.
   510         16  ENDT-COMPANY-CD       PIC X.
   511         16  ENDT-CARRIER          PIC X.
   512         16  ENDT-GROUPING         PIC X(6).
   513         16  ENDT-STATE            PIC XX.
   514         16  ENDT-ACCOUNT          PIC X(10).
   515         16  ENDT-CERT-EFF-DT      PIC XX.
   516         16  ENDT-CERT-PRIME       PIC X(10).
   517         16  ENDT-CERT-SFX         PIC X.
   518         16  ENDT-RECORD-TYPE      PIC X.
   519         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   520
   521 01  WS-ELMSTR-WORK.
   522     12  ELMSTR-KEY.
   523         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   524         16  MSTR-CERT-NO.
   525             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   526             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   527     12  W-CLAIM-KEY.
   528         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   529         16  W-CL-CERT-NO.
   530             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   531             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   532      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   533 01  CANCEL-GEN-PASS-AREA.
   534     05  CG-OPTION-CODE          PIC X.
   535         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   536         88  CG-FLAT-CANCEL        VALUE '1'.
   537         88  CG-CANCEL             VALUE '2'.
   538         88  CG-CANCEL-REISSUE     VALUE '3'.
   539     05  CG-ERROR-CODE           PIC 99.
   540         88  CG-SUCCESS            VALUE 00.
   541         88  CG-DATE-ERROR         VALUE 01.
   542         88  CG-CERT-NOT-FOUND     VALUE 02.
   543         88  CG-AMOUNT-ERROR       VALUE 04.
   544         88  CG-OPTION-ERROR       VALUE 05.
   545         88  CG-PREV-CAN           VALUE 06.
   546         88  CG-INVALID-DATA       VALUE 07.
   547         88  CG-NO-ACCT-MSTR       VALUE 08.
   548         88  CG-SFX-A-EXIST        VALUE 09.
   549         88  CG-MISC-ERROR         VALUE 99.
   550     05  CG-COMPANY-ID           PIC XXX.
   551     05  CG-PROC-ID              PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  12
* EL6311.cbl
   552     05  CG-CURRENT-DT           PIC XX.
   553     05  CG-MONTH-END-DT         PIC XX.
   554     05  CG-CERT-KEY.
   555         10  CG-CERT-COMPANY-CD  PIC X.
   556         10  CG-CERT-CARRIER     PIC X.
   557         10  CG-CERT-GROUP       PIC X(6).
   558         10  CG-CERT-STATE       PIC XX.
   559         10  CG-CERT-ACCOUNT     PIC X(10).
   560         10  CG-CERT-EFF-DT      PIC XX.
   561         10  CG-CERT-CERT-NO     PIC X(11).
   562     05  CG-LF-CAN-DATA.
   563         10  CG-LF-CAN-DT        PIC XX.
   564         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   565     05  CG-AH-CAN-DATA.
   566         10  CG-AH-CAN-DT        PIC XX.
   567         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   568     05  CG-CERT-PROFILE-DATA.
   569         10  CG-INS-LNAME        PIC X(15).
   570         10  CG-INS-FNAME        PIC X(10).
   571         10  CG-INS-MID-INIT     PIC X.
   572         10  CG-INS-AGE          PIC 99.
   573         10  CG-JNT-LNAME        PIC X(15).
   574         10  CG-JNT-FNAME        PIC X(10).
   575         10  CG-JNT-MID-INIT     PIC X.
   576         10  CG-JNT-AGE          PIC 99.
   577     05  CG-LF-ISS-DATA.
   578         10  CG-LF-BENCD         PIC XX.
   579         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   580         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   581     05  CG-AH-ISS-DATA.
   582         10  CG-AH-BENCD         PIC XX.
   583         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   584     05  CG-BATCH-NO             PIC X(6).
   585     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   586     05  FILLER                  PIC X(306).
   587******************************************************************
   588*                                                                *
   589*            G E N E R A L   W O R K   A R E A                   *
   590*                                                                *
   591******************************************************************
   592
   593 01  WORK-AREA.
   594     12  WS-RESPONSE             PIC S9(8)   COMP.
   595         88  RESP-NORMAL           VALUE +0.
   596         88  resp-file-notfnd      value +12.
   597         88  RESP-NOTFND           VALUE +13.
   598         88  resp-duprec           value +14.
   599         88  resp-dupkey           value +15.
   600         88  resp-invreq           value +16.
   601         88  RESP-NOTOPEN          VALUE +19.
   602         88  RESP-ENDFILE          VALUE +20.
   603         88  resp-lengtherr        value +22.
   604     12  DEEDIT-FIELD            PIC X(15).
   605     12  FILLER          REDEFINES DEEDIT-FIELD.
   606         16  FILLER              PIC X(4).
   607         16  DEEDIT-FIELD-X11    PIC X(11).
   608     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   609                                 PIC S9(15).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  13
* EL6311.cbl
   610     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   611                                 PIC S9(13)V99.
   612     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   613                                 PIC S9(11)V9999.
   614     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   615     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   616     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   617         16  WS-CALC-TERM-WHOLE  PIC S999.
   618         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   619
   620     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   621     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   622         16  WS-HR-MINS          PIC 99V99.
   623         16  FILLER              PIC XX.
   624
   625     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   626     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   627
   628     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   629     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   630
   631     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   632     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   633     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   634     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   635     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   636     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   637     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   638
   639     12  QID.
   640         16  QID-TERM            PIC X(4).
   641         16  FILLER              PIC X(4)    VALUE '607B'.
   642
   643     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   644         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   645
   646     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   647         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   648
   649     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   650         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   651                                         'A'.
   652
   653     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   654
   655     12  WS-NUMERIC-SW           PIC X.
   656        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   657
   658     12  WS-EDIT-CSO-FIELD.
   659         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   660                                 PIC X.
   661
   662     12  WS-SAVE-INPUT-FIELDS.
   663         16  WS-BAGE             PIC 99       VALUE ZERO.
   664*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   665         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   666         16  FILLER REDEFINES WS-BAPR.
   667             20  WS-APR-WHOLE-NUM    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  14
* EL6311.cbl
   668             20  WS-APR-DEC          PIC 9999.
   669         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   670         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   671
   672         16  WS-B-COVERAGE OCCURS 2 TIMES.
   673             20  WS-TERM-IN-DAYS-SW  PIC X.
   674                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   675             20  WS-BTERM        PIC 999       COMP-3.
   676             20  WS-BALT-TERM    PIC 999       COMP-3.
   677             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   678             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   679             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   680             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   681             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   682             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   683
   684         16  WS-C-FIELDS COMP-3.
   685             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   686             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   687             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   688
   689         16  WS-D-FIELDS COMP-3.
   690             20  WS-DRISS        PIC S9(5)    VALUE +0.
   691             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   692             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   693             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   694             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   695             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   696
   697     12  WS-SAVE-BIRTH-DATE.
   698         16  FILLER              PIC X(4)   VALUE SPACES.
   699         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   700
   701     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   702     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   703     12  FILLER REDEFINES WS-WORK-BIN-RED.
   704         16  FILLER              PIC X(02).
   705         16  WS-WORK-BIN-DT      PIC X(02).
   706     12  WS-SW-1                 PIC X     VALUE SPACE.
   707     12  WS-SW-2                 PIC X     VALUE SPACE.
   708     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   709         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   710     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   711         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   712
   713     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   714     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   715     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   716     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   717     12  WS-CONVERTED-CANCEL-DATES.
   718         16  WS-CONVERTED-CANDT1                  PIC XX.
   719         16  WS-CONVERTED-CANDT2                  PIC XX.
   720
   721     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   722
   723     12  WS-REC-FOUND-SW         PIC X.
   724         88  RECORD-NOT-FOUND    VALUE 'N'.
   725
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  15
* EL6311.cbl
   726     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   727         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   728         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   729
   730     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   731         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   732         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   733
   734     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   735         88  BROWSE-STARTED      VALUE 'Y'.
   736
   737     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   738         88  FIRST-TIME          VALUE 'Y'.
   739
   740     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   741         88  FIRST-ENTRY         VALUE 'Y'.
   742
   743     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   744         88  REC-BILLED          VALUE 'Y'.
   745
   746     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   747         88  NO-CURSOR-SET       VALUE +0.
   748         88  CURSOR-SET          VALUE +1.
   749
   750     12  WS-ERR-SW               PIC X.
   751         88  STD-ERRORS          VALUE 'S'.
   752         88  TRN-ERRORS          VALUE 'T'.
   753
   754     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   755         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   756
   757     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   758         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   759
   760     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   761         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   762
   763     12  WS-ERR-CODE.
   764         16  FILLER              PIC 99.
   765         16  WS-ERROR-SUB        PIC 99.
   766
   767     12  WS-DATE-WORK.
   768         16  WS-WORK-MM          PIC XX.
   769         16  WS-WORK-DD          PIC XX.
   770         16  WS-WORK-YY          PIC XX.
   771
   772     12  WS-MM-YY.
   773         16  WS-MM               PIC XX.
   774         16  FILLER              PIC X     VALUE '/'.
   775         16  WS-YY               PIC XX.
   776
   777     12  WS-CERT-EFF-DT          PIC XX.
   778
   779     12  WS-MEMBER-NO            PIC X(12).
   780     12  FILLER  REDEFINES  WS-MEMBER-NO.
   781         16  WS-MEMBER-NO-1-8    PIC 9(8).
   782         16  FILLER              PIC X(4).
   783
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  16
* EL6311.cbl
   784     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   785
   786     12  WS-ERPNDB-ALT-KEY.
   787         16  WS-PB-COMPANY-CD-A1         PIC X.
   788         16  WS-PB-CARRIER               PIC X.
   789         16  WS-PB-GROUPING              PIC X(6).
   790         16  WS-PB-STATE                 PIC XX.
   791         16  WS-PB-ACCOUNT               PIC X(10).
   792         16  WS-PB-CERT-EFF-DT           PIC XX.
   793         16  WS-PB-CERT-NO.
   794             20  WS-PB-CERT-PRIME        PIC X(10).
   795             20  WS-PB-CERT-SFX          PIC X.
   796         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   797         16  WS-PB-RECORD-TYPE           PIC X.
   798
   799     12  WS-SHOW-SAVE-AREAS.
   800         16  WS-NEW-CERT-NO.
   801             20  WS-NEW-PRIME    PIC X(10).
   802             20  WS-NEW-SUFFIX   PIC X.
   803         16  WS-NEW-CERT-EFF-DT  PIC XX.
   804         16  WS-NEW-RECORD-TYPE  PIC X.
   805         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   806             88   SHOW-RECORD            VALUE 'Y'.
   807
   808     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   809
   810     12  WS-BATCH-NO.
   811         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   812         16  FILLER              PIC X(5) VALUE SPACES.
   813
   814     12  WS-FIRST-NAME.
   815         16  WS-1ST-INIT         PIC X.
   816         16  FILLER              PIC X(9).
   817
   818     12  WS-INITIALS.
   819         16  WS-INITIAL-1        PIC X.
   820         16  WS-INITIAL-2        PIC X.
   821
   822     12  WS-C-HDG.
   823         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   824         16  FILLER              PIC X(4) VALUE '-REF'.
   825
   826     12  WS-D-PREM-HDG.
   827         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   828         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   829
   830     12  WS-D-REFUND-HDG.
   831         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   832         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   833
   834     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   835
   836     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   837     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   838     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   839     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   840     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   841     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  17
* EL6311.cbl
   842     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   843
   844     12  WS-01-CANCEL-ERR        PIC X(25)
   845         VALUE 'CANCEL DATE ERROR'.
   846     12  WS-02-CANCEL-ERR        PIC X(25)
   847         VALUE 'CERT NOT FOUND'.
   848     12  WS-04-CANCEL-ERR        PIC X(25)
   849         VALUE 'CANCEL AMOUNT ERROR'.
   850     12  WS-05-CANCEL-ERR        PIC X(25)
   851         VALUE 'CANCEL OPTION ERROR'.
   852     12  WS-06-CANCEL-ERR        PIC X(25)
   853         VALUE 'PREVIOUSLY CANCELLED'.
   854     12  WS-07-CANCEL-ERR        PIC X(25)
   855         VALUE 'INVALID DATA'.
   856     12  WS-08-CANCEL-ERR        PIC X(25)
   857         VALUE 'NO ACCOUNT MASTER'.
   858     12  WS-09-CANCEL-ERR        PIC X(25)
   859         VALUE 'SUFFIX ALREADY EXISTS'.
   860     12  WS-99-CANCEL-ERR        PIC X(25)
   861         VALUE 'MISC CANCEL ERROR'.
   862
   863     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   864     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   865
   866     12  WS-AGE-FIELDS.
   867         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   868         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   869         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   870         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   871
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  18
* EL6311.cbl
   873
   874******************************************************************
   875*                                                                *
   876*                 B A T C H   T O T A L S                        *
   877*                                                                *
   878******************************************************************
   879
   880     12  WS-BATCH-RECORD.
   881         16  FILLER                       PIC X(10).
   882         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   884         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   887         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   888         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   889         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   890         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   891         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   892         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   893         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   894         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   895         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   896         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   897         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   898         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   899         16  WS-ACCOUNT-NAME              PIC X(30).
   900         16  FILLER                       PIC X.
   901         16  WS-REFERENCE                 PIC X(12).
   902         16  FILLER                       PIC X(197).
   903
   904     12  WS-BATCH-TOTALS.
   905         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   910         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   911         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   916         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   917         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   918         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   919         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   920         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   921         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   922         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   923         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   924
   925     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   926
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  19
* EL6311.cbl
   928
   929******************************************************************
   930*                                                                *
   931*                E R R O R   M E S S A G E S                     *
   932*                                                                *
   933******************************************************************
   934
   935 01  ERROR-MESSAGES.
   936     12  ER-0004                 PIC  9(4) VALUE 0004.
   937     12  ER-0008                 PIC  9(4) VALUE 0008.
   938     12  ER-0023                 PIC  9(4) VALUE 0023.
   939     12  ER-0029                 PIC  9(4) VALUE 0029.
   940     12  ER-0033                 PIC  9(4) VALUE 0033.
   941     12  ER-0070                 PIC  9(4) VALUE 0070.
   942     12  ER-0220                 PIC  9(4) VALUE 0220.
   943     12  ER-0248                 PIC  9(4) VALUE 0248.
   944     12  ER-0280                 PIC  9(4) VALUE 0280.
   945     12  ER-0348                 PIC  9(4) VALUE 0348.
   946     12  ER-0582                 PIC  9(4) VALUE 0582.
   947     12  ER-0877                 PIC  9(4) VALUE 0877.
   948     12  ER-1236                 PIC  9(4) VALUE 1236.
   949     12  ER-1570                 PIC  9(4) VALUE 1570.
   950     12  ER-1575                 PIC  9(4) VALUE 1575.
   951     12  ER-1609                 PIC  9(4) VALUE 1609.
   952     12  ER-1819                 PIC  9(4) VALUE 1819.
   953     12  ER-2077                 PIC  9(4) VALUE 2077.
   954     12  ER-2129                 PIC  9(4) VALUE 2129.
   955     12  ER-2188                 PIC  9(4) VALUE 2188.
   956     12  ER-2192                 PIC  9(4) VALUE 2192.
   957     12  ER-2196                 PIC  9(4) VALUE 2196.
   958     12  ER-2197                 PIC  9(4) VALUE 2197.
   959     12  ER-2198                 PIC  9(4) VALUE 2198.
   960     12  ER-2200                 PIC  9(4) VALUE 2200.
   961     12  ER-2212                 PIC  9(4) VALUE 2212.
   962     12  ER-2218                 PIC  9(4) VALUE 2218.
   963     12  ER-2220                 PIC  9(4) VALUE 2220.
   964     12  ER-2222                 PIC  9(4) VALUE 2222.
   965     12  ER-2223                 PIC  9(4) VALUE 2223.
   966     12  ER-2224                 PIC  9(4) VALUE 2224.
   967     12  ER-2225                 PIC  9(4) VALUE 2225.
   968     12  ER-2226                 PIC  9(4) VALUE 2226.
   969     12  ER-2227                 PIC  9(4) VALUE 2227.
   970     12  ER-2228                 PIC  9(4) VALUE 2228.
   971     12  ER-2240                 PIC  9(4) VALUE 2240.
   972     12  ER-2241                 PIC  9(4) VALUE 2241.
   973     12  ER-2242                 PIC  9(4) VALUE 2242.
   974     12  ER-2243                 PIC  9(4) VALUE 2243.
   975     12  ER-2244                 PIC  9(4) VALUE 2244.
   976     12  ER-2245                 PIC  9(4) VALUE 2245.
   977     12  ER-2246                 PIC  9(4) VALUE 2246.
   978     12  ER-2247                 PIC  9(4) VALUE 2247.
   979     12  ER-2251                 PIC  9(4) VALUE 2251.
   980     12  ER-2252                 PIC  9(4) VALUE 2252.
   981     12  ER-2253                 PIC  9(4) VALUE 2253.
   982     12  ER-2254                 PIC  9(4) VALUE 2254.
   983     12  ER-2255                 PIC  9(4) VALUE 2255.
   984     12  ER-2256                 PIC  9(4) VALUE 2256.
   985     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  20
* EL6311.cbl
   986     12  ER-2258                 PIC  9(4) VALUE 2258.
   987     12  ER-2259                 PIC  9(4) VALUE 2259.
   988     12  ER-2260                 PIC  9(4) VALUE 2260.
   989     12  ER-2261                 PIC  9(4) VALUE 2261.
   990     12  ER-2287                 PIC  9(4) VALUE 2287.
   991     12  ER-2336                 PIC  9(4) VALUE 2336.
   992     12  ER-2337                 PIC  9(4) VALUE 2337.
   993     12  ER-2437                 PIC  9(4) VALUE 2437.
   994     12  ER-2471                 PIC  9(4) VALUE 2471.
   995     12  ER-2530                 PIC  9(4) VALUE 2530.
   996     12  ER-2531                 PIC  9(4) VALUE 2531.
   997     12  ER-2532                 PIC  9(4) VALUE 2532.
   998     12  ER-2533                 PIC  9(4) VALUE 2533.
   999     12  ER-2547                 PIC  9(4) VALUE 2547.
  1000     12  ER-2591                 PIC  9(4) VALUE 2591.
  1001     12  ER-2592                 PIC  9(4) VALUE 2592.
  1002     12  ER-2593                 PIC  9(4) VALUE 2593.
  1003     12  ER-2600                 PIC  9(4) VALUE 2600.
  1004     12  ER-2601                 PIC  9(4) VALUE 2601.
  1005     12  ER-2604                 PIC  9(4) VALUE 2604.
  1006     12  ER-2605                 PIC  9(4) VALUE 2605.
  1007     12  ER-2606                 PIC  9(4) VALUE 2606.
  1008     12  ER-2607                 PIC  9(4) VALUE 2607.
  1009     12  ER-2622                 PIC  9(4) VALUE 2622.
  1010     12  ER-2625                 PIC  9(4) VALUE 2625.
  1011     12  ER-2626                 PIC  9(4) VALUE 2626.
  1012     12  ER-2627                 PIC  9(4) VALUE 2627.
  1013     12  ER-2628                 PIC  9(4) VALUE 2628.
  1014     12  ER-2629                 PIC  9(4) VALUE 2629.
  1015     12  ER-2630                 PIC  9(4) VALUE 2630.
  1016     12  ER-2631                 PIC  9(4) VALUE 2631.
  1017     12  ER-2632                 PIC  9(4) VALUE 2632.
  1018     12  ER-2633                 PIC  9(4) VALUE 2633.
  1019     12  ER-2634                 PIC  9(4) VALUE 2634.
  1020     12  ER-2635                 PIC  9(4) VALUE 2635.
  1021     12  ER-2636                 PIC  9(4) VALUE 2636.
  1022     12  ER-2639                 PIC  9(4) VALUE 2639.
  1023     12  ER-2640                 PIC  9(4) VALUE 2640.
  1024     12  ER-2647                 PIC  9(4) VALUE 2647.
  1025     12  ER-2648                 PIC  9(4) VALUE 2648.
  1026     12  ER-2649                 PIC  9(4) VALUE 2649.
  1027     12  ER-2650                 PIC  9(4) VALUE 2650.
  1028     12  ER-2653                 PIC  9(4) VALUE 2653.
  1029     12  ER-2654                 PIC  9(4) VALUE 2654.
  1030     12  ER-2655                 PIC  9(4) VALUE 2655.
  1031     12  ER-2656                 PIC  9(4) VALUE 2656.
  1032     12  ER-2657                 PIC  9(4) VALUE 2657.
  1033     12  ER-2660                 PIC  9(4) VALUE 2660.
  1034     12  ER-2661                 PIC  9(4) VALUE 2661.
  1035     12  ER-2662                 PIC  9(4) VALUE 2662.
  1036     12  ER-2663                 PIC  9(4) VALUE 2663.
  1037     12  ER-2664                 PIC  9(4) VALUE 2664.
  1038     12  ER-2667                 PIC  9(4) VALUE 2667.
  1039     12  ER-2668                 PIC  9(4) VALUE 2668.
  1040     12  ER-2669                 PIC  9(4) VALUE 2669.
  1041     12  ER-2670                 PIC  9(4) VALUE 2670.
  1042     12  ER-2671                 PIC  9(4) VALUE 2671.
  1043     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  21
* EL6311.cbl
  1044     12  ER-2673                 PIC  9(4) VALUE 2673.
  1045     12  ER-2677                 PIC  9(4) VALUE 2677.
  1046     12  ER-2678                 PIC  9(4) VALUE 2678.
  1047     12  ER-2679                 PIC  9(4) VALUE 2679.
  1048     12  ER-2680                 PIC  9(4) VALUE 2680.
  1049     12  ER-2681                 PIC  9(4) VALUE 2681.
  1050     12  ER-2682                 PIC  9(4) VALUE 2682.
  1051     12  ER-2683                 PIC  9(4) VALUE 2683.
  1052     12  ER-2684                 PIC  9(4) VALUE 2684.
  1053     12  ER-2686                 PIC  9(4) VALUE 2686.
  1054     12  ER-2689                 PIC  9(4) VALUE 2689.
  1055     12  ER-2690                 PIC  9(4) VALUE 2690.
  1056     12  ER-2693                 PIC  9(4) VALUE 2693.
  1057     12  ER-2695                 PIC  9(4) VALUE 2695.
  1058     12  ER-2701                 PIC  9(4) VALUE 2701.
  1059     12  ER-2720                 PIC  9(4) VALUE 2720.
  1060     12  ER-2709                 PIC  9(4) VALUE 2709.
  1061     12  ER-2704                 PIC  9(4) VALUE 2704.
  1062     12  ER-2725                 PIC  9(4) VALUE 2725.
  1063     12  ER-2726                 PIC  9(4) VALUE 2726.
  1064     12  ER-2728                 PIC  9(4) VALUE 2728.
  1065     12  ER-2729                 PIC  9(4) VALUE 2729.
  1066     12  ER-2731                 PIC  9(4) VALUE 2731.
  1067     12  ER-2732                 PIC  9(4) VALUE 2732.
  1068     12  ER-2733                 PIC  9(4) VALUE 2733.
  1069     12  ER-2735                 PIC  9(4) VALUE 2735.
  1070     12  ER-2738                 PIC  9(4) VALUE 2738.
  1071     12  ER-2742                 PIC  9(4) VALUE 2742.
  1072     12  ER-2743                 PIC  9(4) VALUE 2743.
  1073     12  ER-2744                 PIC  9(4) VALUE 2744.
  1074     12  ER-2747                 PIC  9(4) VALUE 2747.
  1075     12  ER-2749                 PIC  9(4) VALUE 2749.
  1076     12  ER-2753                 PIC  9(4) VALUE 2753.
  1077     12  ER-2755                 PIC  9(4) VALUE 2755.
  1078     12  ER-2757                 PIC  9(4) VALUE 2757.
  1079     12  ER-2771                 PIC  9(4) VALUE 2771.
  1080     12  ER-2774                 PIC  9(4) VALUE 2774.
  1081     12  ER-2775                 PIC  9(4) VALUE 2775.
  1082     12  ER-2776                 PIC  9(4) VALUE 2776.
  1083     12  ER-2777                 PIC  9(4) VALUE 2777.
  1084     12  ER-2794                 PIC  9(4) VALUE 2794.
  1085     12  ER-2799                 PIC  9(4) VALUE 2799.
  1086     12  ER-2900                 PIC  9(4) VALUE 2900.
  1087     12  ER-2902                 PIC  9(4) VALUE 2902.
  1088     12  ER-2945                 PIC  9(4) VALUE 2945.
  1089     12  ER-3000                 PIC  9(4) VALUE 3000.
  1090     12  ER-3006                 PIC  9(4) VALUE 3006.
  1091     12  ER-3054                 PIC  9(4) VALUE 3054.
  1092     12  ER-3224                 PIC  9(4) VALUE 3224.
  1093     12  ER-3269                 PIC  9(4) VALUE 3269.
  1094     12  er-3444                 pic  9(4) value 3444.
  1095     12  er-3446                 pic  9(4) value 3446.
  1096     12  er-3447                 pic  9(4) value 3447.
  1097     12  er-3448                 pic  9(4) value 3448.
  1098     12  er-3449                 pic  9(4) value 3449.
  1099     12  ER-3456                 PIC  9(4) VALUE 3456.
  1100     12  ER-3457                 PIC  9(4) VALUE 3457.
  1101     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  22
* EL6311.cbl
  1102     12  ER-3504                 PIC  9(4) VALUE 3504.
  1103     12  ER-3513                 PIC  9(4) VALUE 3513.
  1104     12  ER-3831                 PIC  9(4) VALUE 3831.
  1105     12  ER-3834                 PIC  9(4) VALUE 3834.
  1106     12  ER-3835                 PIC  9(4) VALUE 3835.
  1107     12  ER-4005                 PIC  9(4) VALUE 4005.
  1108     12  ER-7144                 PIC  9(4) VALUE 7144.
  1109     12  ER-7401                 PIC  9(4) VALUE 7401.
  1110     12  ER-7402                 PIC  9(4) VALUE 7402.
  1111     12  ER-7403                 PIC  9(4) VALUE 7403.
  1112     12  ER-7404                 PIC  9(4) VALUE 7404.
  1113     12  ER-7423                 PIC  9(4) VALUE 7423.
  1114     12  ER-7424                 PIC  9(4) VALUE 7424.
  1115     12  ER-7433                 PIC  9(4) VALUE 7433.
  1116     12  ER-7450                 PIC  9(4) VALUE 7450.
  1117     12  ER-7451                 PIC  9(4) VALUE 7451.
  1118     12  ER-7530                 PIC  9(4) VALUE 7530.
  1119     12  ER-7573                 PIC  9(4) VALUE 7573.
  1120     12  ER-7631                 PIC  9(4) VALUE 7631.
  1121     12  ER-7632                 PIC  9(4) VALUE 7632.
  1122     12  ER-7633                 PIC  9(4) VALUE 7633.
  1123     12  ER-7537                 PIC  9(4) VALUE 7537.
  1124     12  ER-7538                 PIC  9(4) VALUE 7538.
  1125     12  ER-7574                 PIC  9(4) VALUE 7574.
  1126     12  ER-7997                 PIC  9(4) VALUE 7997.
  1127     12  ER-7998                 PIC  9(4) VALUE 7998.
  1128     12  ER-8148                 PIC  9(4) VALUE 8148.
  1129     12  ER-9063                 PIC  9(4) VALUE 9063.
  1130     12  ER-9076                 PIC  9(4) VALUE 9076.
  1131     12  ER-9618                 PIC  9(4) VALUE 9618.
  1132     12  ER-9841                 PIC  9(4) VALUE 9841.
  1133
  1134*                                COPY ELCTEXT.
  1135******************************************************************
  1136*                                                                *
  1137*                                                                *
  1138*                            ELCTEXT.                            *
  1139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1140*                            VMOD=2.008                          *
  1141*                                                                *
  1142*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1143*                                     FORM LETTERS,              *
  1144*                                     CERT FORM DISPLAY.
  1145*                                                                *
  1146*   FILE TYPE = VSAM,KSDS                                        *
  1147*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1148*                                                                *
  1149*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1150*       ALTERNATE INDEX = NONE                                   *
  1151*                                                                *
  1152*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1153*       ALTERNATE INDEX = NONE                                   *
  1154*                                                                *
  1155*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1156*       ALTERNATE INDEX = NONE                                   *
  1157*                                                                *
  1158*   LOG = NO                                                     *
  1159*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  23
* EL6311.cbl
  1160******************************************************************
  1161 01  TEXT-FILES.
  1162     12  TEXT-FILE-ID                PIC XX.
  1163         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1164         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1165         88  HELP-FILE-TEXT             VALUE 'TH'.
  1166
  1167     12  TX-CONTROL-PRIMARY.
  1168         16  TX-COMPANY-CD           PIC X.
  1169             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1170         16  TX-ACCESS-CD-GENL       PIC X(12).
  1171
  1172         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1173             20  TX-LETTER-NO        PIC X(4).
  1174             20  FILLER              PIC X(8).
  1175
  1176         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1177             20  TX-FORM-NO          PIC X(12).
  1178
  1179         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1180             20  TX-HELP-TYPE        PIC X.
  1181                 88  HELP-FOR-GENERAL   VALUE ' '.
  1182                 88  HELP-BY-SCREEN     VALUE 'S'.
  1183                 88  HELP-BY-ERROR      VALUE 'E'.
  1184             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1185                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1186             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1187                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1188             20  FILLER              PIC X(4).
  1189
  1190         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1191
  1192     12  TX-PROCESS-CONTROL          PIC XX.
  1193         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1194
  1195     12  TX-TEXT-LINE                PIC X(70).
  1196
  1197     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1198         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1199         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1200         88  TX-VALID-FORM-SQUEEZE-VALUE
  1201                                        VALUE 'Y' ' '.
  1202
  1203     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1204         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1205         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1206         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1207         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1208         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1209         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1210         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1211                                              'K' 'N' ' '
  1212                                              'Z'.
  1213
  1214     12  TX-ARCHIVE-SW               PIC X.
  1215         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1216         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1217         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  24
* EL6311.cbl
  1218
  1219     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1220     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1221
  1222     12  TX-BSR-CODE                 PIC X.
  1223         88  TX-BSR-LETTER              VALUE 'B'.
  1224         88  TX-NON-BSR-LETTER          VALUE ' '.
  1225
  1226     12  FILLER                      PIC X.
  1227*****************************************************************
  1228*                                COPY ELCCRTO.
  1229******************************************************************
  1230*                                                                *
  1231*                            ELCCRTO.                            *
  1232*                                                                *
  1233*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1234*                                                                *
  1235*   FILE TYPE = VSAM,KSDS                                        *
  1236*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1237*                                                                *
  1238*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1239*                                                                *
  1240*   LOG = YES                                                    *
  1241*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1242******************************************************************
  1243*                   C H A N G E   L O G
  1244*
  1245* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1246*-----------------------------------------------------------------
  1247*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1248* EFFECTIVE    NUMBER
  1249*-----------------------------------------------------------------
  1250* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1251* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1252* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1253* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1254* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1255******************************************************************
  1256 01  ORIGINAL-CERTIFICATE.
  1257     12  OC-RECORD-ID                      PIC XX.
  1258         88  VALID-OC-ID                      VALUE 'OC'.
  1259     12  OC-CONTROL-PRIMARY.
  1260         16  OC-COMPANY-CD                 PIC X.
  1261         16  OC-CARRIER                    PIC X.
  1262         16  OC-GROUPING                   PIC X(6).
  1263         16  OC-STATE                      PIC XX.
  1264         16  OC-ACCOUNT                    PIC X(10).
  1265         16  OC-CERT-EFF-DT                PIC XX.
  1266         16  OC-CERT-NO.
  1267             20  OC-CERT-PRIME             PIC X(10).
  1268             20  OC-CERT-SFX               PIC X.
  1269         16  OC-RECORD-TYPE                PIC X.
  1270         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1271     12  OC-LAST-MAINT-DT                  PIC XX.
  1272     12  OC-LAST-MAINT-BY                  PIC X(4).
  1273     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1274     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1275     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  25
* EL6311.cbl
  1276     12  OC-ORIG-REC.
  1277         16  OC-INS-LAST-NAME              PIC X(15).
  1278         16  OC-INS-FIRST-NAME             PIC X(10).
  1279         16  OC-INS-MIDDLE-INIT            PIC X.
  1280         16  OC-INS-AGE                    PIC S999     COMP-3.
  1281         16  OC-JNT-LAST-NAME              PIC X(15).
  1282         16  OC-JNT-FIRST-NAME             PIC X(10).
  1283         16  OC-JNT-MIDDLE-INIT            PIC X.
  1284         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1285         16  OC-LF-BENCD                   PIC XX.
  1286         16  OC-LF-TERM                    PIC S999      COMP-3.
  1287         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1288         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1289         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1290         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1291         16  OC-LF-EXP-DT                  PIC XX.
  1292         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1293         16  OC-LF-CANCEL-DT               PIC XX.
  1294         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1295         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1296         16  OC-AH-BENCD                   PIC XX.
  1297         16  OC-AH-TERM                    PIC S999      COMP-3.
  1298         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1299         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1300         16  OC-AH-EXP-DT                  PIC XX.
  1301         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1302         16  OC-AH-CP                      PIC 99.
  1303         16  OC-AH-CANCEL-DT               PIC XX.
  1304         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1305         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1306         16  OC-CRED-BENE-NAME             PIC X(25).
  1307         16  OC-1ST-PMT-DT                 PIC XX.
  1308         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1309         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1310         16  OC-ISSUE-TRAN-IND             PIC X.
  1311         16  OC-CANCEL-TRAN-IND            PIC X.
  1312         16  FILLER                        PIC X(211).
  1313
  1314     12  FILLER                            PIC X(50).
  1315******************************************************************
  1316*                                COPY ERCACCT.
  1317******************************************************************
  1318*                                                                *
  1319*                                                                *
  1320*                            ERCACCT                             *
  1321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1322*                            VMOD=2.031                          *
  1323*                                                                *
  1324*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1325*                                                                *
  1326*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1327*   VSAM ACCOUNT MASTER FILES.                                   *
  1328*                                                                *
  1329*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1330*                                                                *
  1331*   FILE TYPE = VSAM,KSDS                                        *
  1332*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  26
* EL6311.cbl
  1334*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1335*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1336*                                                                *
  1337*   LOG = NO                                                     *
  1338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1339*                                                                *
  1340*                                                                *
  1341******************************************************************
  1342*                   C H A N G E   L O G
  1343*
  1344* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1345*-----------------------------------------------------------------
  1346*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1347* EFFECTIVE    NUMBER
  1348*-----------------------------------------------------------------
  1349* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1350* 092705    2005050300006  PEMA  ADD SPP LEASES
  1351* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1352* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1353* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1354* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1355* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1356* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1357******************************************************************
  1358
  1359 01  ACCOUNT-MASTER.
  1360     12  AM-RECORD-ID                      PIC XX.
  1361         88  VALID-AM-ID                      VALUE 'AM'.
  1362
  1363     12  AM-CONTROL-PRIMARY.
  1364         16  AM-COMPANY-CD                 PIC X.
  1365         16  AM-MSTR-CNTRL.
  1366             20  AM-CONTROL-A.
  1367                 24  AM-CARRIER            PIC X.
  1368                 24  AM-GROUPING.
  1369                     28 AM-GROUPING-PREFIX PIC XXX.
  1370                     28 AM-GROUPING-PRIME  PIC XXX.
  1371                 24  AM-STATE              PIC XX.
  1372                 24  AM-ACCOUNT.
  1373                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1374                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1375             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1376                                           PIC X(19).
  1377             20  AM-CNTRL-B.
  1378                 24  AM-EXPIRATION-DT      PIC XX.
  1379                 24  FILLER                PIC X(4).
  1380             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1381                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1382
  1383     12  AM-CONTROL-BY-VAR-GRP.
  1384         16  AM-COMPANY-CD-A1              PIC X.
  1385         16  AM-VG-CARRIER                 PIC X.
  1386         16  AM-VG-GROUPING                PIC X(6).
  1387         16  AM-VG-STATE                   PIC XX.
  1388         16  AM-VG-ACCOUNT                 PIC X(10).
  1389         16  AM-VG-DATE.
  1390             20  AM-VG-EXPIRATION-DT       PIC XX.
  1391             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  27
* EL6311.cbl
  1392         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1393                                           PIC 9(11)      COMP-3.
  1394     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1395         16  FILLER                        PIC X(10).
  1396         16  AM-VG-KEY3.
  1397             20  AM-VG3-ACCOUNT            PIC X(10).
  1398             20  AM-VG3-EXP-DT             PIC XX.
  1399         16  FILLER                        PIC X(4).
  1400     12  AM-MAINT-INFORMATION.
  1401         16  AM-LAST-MAINT-DT              PIC XX.
  1402         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1403         16  AM-LAST-MAINT-USER            PIC X(4).
  1404         16  FILLER                        PIC XX.
  1405
  1406     12  AM-EFFECTIVE-DT                   PIC XX.
  1407     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1408
  1409     12  AM-PREV-DATES  COMP-3.
  1410         16  AM-PREV-EXP-DT                PIC 9(11).
  1411         16  AM-PREV-EFF-DT                PIC 9(11).
  1412
  1413     12  AM-REPORT-CODE-1                  PIC X(10).
  1414     12  AM-REPORT-CODE-2                  PIC X(10).
  1415
  1416     12  AM-CITY-CODE                      PIC X(4).
  1417     12  AM-COUNTY-PARISH                  PIC X(6).
  1418
  1419     12  AM-NAME                           PIC X(30).
  1420     12  AM-PERSON                         PIC X(30).
  1421     12  AM-ADDRS                          PIC X(30).
  1422     12  AM-CITY.
  1423         16  AM-ADDR-CITY                  PIC X(28).
  1424         16  AM-ADDR-STATE                 PIC XX.
  1425     12  AM-ZIP.
  1426         16  AM-ZIP-PRIME.
  1427             20  AM-ZIP-PRI-1ST            PIC X.
  1428                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1429             20  FILLER                    PIC X(4).
  1430         16  AM-ZIP-PLUS4                  PIC X(4).
  1431     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1432         16  AM-CAN-POSTAL-1               PIC XXX.
  1433         16  AM-CAN-POSTAL-2               PIC XXX.
  1434         16  FILLER                        PIC XXX.
  1435     12  AM-TEL-NO.
  1436         16  AM-AREA-CODE                  PIC 999.
  1437         16  AM-TEL-PRE                    PIC 999.
  1438         16  AM-TEL-NBR                    PIC 9(4).
  1439     12  AM-TEL-LOC                        PIC X.
  1440         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1441         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1442
  1443     12  AM-COMM-STRUCTURE.
  1444         16  AM-DEFN-1.
  1445             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1446                 24  AM-AGT.
  1447                     28  AM-AGT-PREFIX     PIC X(4).
  1448                     28  AM-AGT-PRIME      PIC X(6).
  1449                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  28
* EL6311.cbl
  1450                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1451                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1452                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1453                 24  AM-RECALC-LV-INDIC    PIC X.
  1454                 24  AM-RETRO-LV-INDIC     PIC X.
  1455                 24  AM-GL-CODES           PIC X.
  1456                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1457                 24  FILLER                PIC X(01).
  1458         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1459             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1460                 24  FILLER                PIC X(11).
  1461                 24  AM-L-COMA             PIC XXX.
  1462                 24  AM-J-COMA             PIC XXX.
  1463                 24  AM-A-COMA             PIC XXX.
  1464                 24  FILLER                PIC X(6).
  1465
  1466     12  AM-COMM-CHANGE-STATUS             PIC X.
  1467         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1468
  1469     12  AM-CSR-CODE                       PIC X(4).
  1470
  1471     12  AM-BILLING-STATUS                 PIC X.
  1472         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1473         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1474     12  AM-AUTO-REFUND-SW                 PIC X.
  1475         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1476         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1477     12  AM-GPCD                           PIC 99.
  1478     12  AM-IG                             PIC X.
  1479         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1480         88  AM-HAS-GROUP                     VALUE '2'.
  1481     12  AM-STATUS                         PIC X.
  1482         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1483         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1484         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1485         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1486         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1487         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1488         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1489         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1490         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1491         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1492     12  AM-REMIT-TO                       PIC 99.
  1493     12  AM-ID-NO                          PIC X(11).
  1494
  1495     12  AM-CAL-TABLE                      PIC XX.
  1496     12  AM-LF-DEVIATION                   PIC XXX.
  1497     12  AM-AH-DEVIATION                   PIC XXX.
  1498     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1499     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1500     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1501     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1502     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1503     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1504
  1505     12  AM-USER-FIELDS.
  1506         16  AM-FLD-1                      PIC XX.
  1507         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  29
* EL6311.cbl
  1508         16  AM-FLD-3                      PIC XX.
  1509         16  AM-FLD-4                      PIC XX.
  1510         16  AM-FLD-5                      PIC XX.
  1511
  1512     12  AM-1ST-PROD-DATE.
  1513         16  AM-1ST-PROD-YR                PIC XX.
  1514         16  AM-1ST-PROD-MO                PIC XX.
  1515         16  AM-1ST-PROD-DA                PIC XX.
  1516     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1517     12  AM-CERTS-PURGED-DATE.
  1518         16  AM-PUR-YR                     PIC XX.
  1519         16  AM-PUR-MO                     PIC XX.
  1520         16  AM-PUR-DA                     PIC XX.
  1521     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1522     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1523     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1524     12  AM-INACTIVE-DATE.
  1525         16  AM-INA-MO                     PIC 99.
  1526         16  AM-INA-DA                     PIC 99.
  1527         16  AM-INA-YR                     PIC 99.
  1528     12  AM-AR-HI-CERT-DATE                PIC XX.
  1529
  1530     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1531     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1532
  1533     12  AM-OB-PAYMENT-MODE                PIC X.
  1534         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1535         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1536         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1537         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1538
  1539     12  AM-AH-ONLY-INDICATOR              PIC X.
  1540         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1541         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1542
  1543     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1544
  1545     12  AM-OVER-SHORT.
  1546         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1547         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1548
  1549     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1550     12  AM-DCC-CLP-STATE                  PIC XX.
  1551
  1552     12  AM-RECALC-COMM                    PIC X.
  1553     12  AM-RECALC-REIN                    PIC X.
  1554
  1555     12  AM-REI-TABLE                      PIC XXX.
  1556     12  AM-REI-ET-LF                      PIC X.
  1557     12  AM-REI-ET-AH                      PIC X.
  1558     12  AM-REI-PE-LF                      PIC X.
  1559     12  AM-REI-PE-AH                      PIC X.
  1560     12  AM-REI-PRT-ST                     PIC X.
  1561     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1562     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1563     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1564     12  AM-REI-GROUP-A                    PIC X(6).
  1565     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  30
* EL6311.cbl
  1566     12  AM-REI-PRT-OW                     PIC X.
  1567     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1568     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1569     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1570     12  AM-REI-GROUP-B                    PIC X(6).
  1571
  1572     12  AM-TRUST-TYPE                     PIC X(2).
  1573
  1574     12  AM-EMPLOYER-STMT-USED             PIC X.
  1575     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1576
  1577     12  AM-STD-AH-TYPE                    PIC XX.
  1578     12  AM-EARN-METHODS.
  1579         16  AM-EARN-METHOD-R              PIC X.
  1580             88 AM-REF-RL-R78                 VALUE 'R'.
  1581             88 AM-REF-RL-PR                  VALUE 'P'.
  1582             88 AM-REF-RL-MEAN                VALUE 'M'.
  1583             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1584         16  AM-EARN-METHOD-L              PIC X.
  1585             88 AM-REF-LL-R78                 VALUE 'R'.
  1586             88 AM-REF-LL-PR                  VALUE 'P'.
  1587             88 AM-REF-LL-MEAN                VALUE 'M'.
  1588             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1589         16  AM-EARN-METHOD-A              PIC X.
  1590             88 AM-REF-AH-R78                 VALUE 'R'.
  1591             88 AM-REF-AH-PR                  VALUE 'P'.
  1592             88 AM-REF-AH-MEAN                VALUE 'M'.
  1593             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1594             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1595             88 AM-REF-AH-NET                 VALUE 'N'.
  1596
  1597     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1598     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1599     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1600
  1601     12  AM-RET-Y-N                        PIC X.
  1602     12  AM-RET-P-E                        PIC X.
  1603     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1604     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1605     12  AM-RET-GRP                        PIC X(6).
  1606     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1607         16  AM-POOL-PRIME                 PIC XXX.
  1608         16  AM-POOL-SUB                   PIC XXX.
  1609     12  AM-RETRO-EARNINGS.
  1610         16  AM-RET-EARN-R                 PIC X.
  1611         16  AM-RET-EARN-L                 PIC X.
  1612         16  AM-RET-EARN-A                 PIC X.
  1613     12  AM-RET-ST-TAX-USE                 PIC X.
  1614         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1615         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1616     12  AM-RETRO-BEG-EARNINGS.
  1617         16  AM-RET-BEG-EARN-R             PIC X.
  1618         16  AM-RET-BEG-EARN-L             PIC X.
  1619         16  AM-RET-BEG-EARN-A             PIC X.
  1620     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1621     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1622
  1623     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  31
* EL6311.cbl
  1624         16  AM-USER-SELECT-1              PIC X(10).
  1625         16  AM-USER-SELECT-2              PIC X(10).
  1626         16  AM-USER-SELECT-3              PIC X(10).
  1627         16  AM-USER-SELECT-4              PIC X(10).
  1628         16  AM-USER-SELECT-5              PIC X(10).
  1629
  1630     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1631
  1632     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1633
  1634     12  AM-RPT045A-SWITCH                 PIC X.
  1635         88  RPT045A-OFF                   VALUE 'N'.
  1636
  1637     12  AM-INSURANCE-LIMITS.
  1638         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1639         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1640
  1641     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1642         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1643
  1644     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1645         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1646         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1647
  1648     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1649
  1650     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1651     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1652     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1653     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1654     12  AM-DCC-UEF-STATE                  PIC XX.
  1655     12  FILLER                            PIC XXX.
  1656     12  AM-REPORT-CODE-3                  PIC X(10).
  1657*    12  FILLER                            PIC X(22).
  1658
  1659     12  AM-RESERVE-DATE.
  1660         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1661         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1662         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1663
  1664     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1665     12  AM-NOTIFICATION-TYPES.
  1666         16  AM-NOTIF-OF-LETTERS           PIC X.
  1667         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1668         16  AM-NOTIF-OF-REPORTS           PIC X.
  1669         16  AM-NOTIF-OF-STATUS            PIC X.
  1670
  1671     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1672         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1673         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1674         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1675         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1676
  1677     12  AM-BENEFIT-CONTROLS.
  1678         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1679             20  AM-BENEFIT-CODE           PIC XX.
  1680             20  AM-BENEFIT-TYPE           PIC X.
  1681             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  32
* EL6311.cbl
  1682             20  AM-BENEFIT-REM-TERM       PIC X.
  1683             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1684             20  FILLER                    PIC XX.
  1685         16  FILLER                        PIC X(80).
  1686
  1687     12  AM-TRANSFER-DATA.
  1688         16  AM-TRANSFERRED-FROM.
  1689             20  AM-TRNFROM-CARRIER        PIC X.
  1690             20  AM-TRNFROM-GROUPING.
  1691                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1692                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1693             20  AM-TRNFROM-STATE          PIC XX.
  1694             20  AM-TRNFROM-ACCOUNT.
  1695                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1696                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1697             20  AM-TRNFROM-DTE            PIC XX.
  1698         16  AM-TRANSFERRED-TO.
  1699             20  AM-TRNTO-CARRIER          PIC X.
  1700             20  AM-TRNTO-GROUPING.
  1701                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1702                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1703             20  AM-TRNTO-STATE            PIC XX.
  1704             20  AM-TRNTO-ACCOUNT.
  1705                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1706                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1707             20  AM-TRNTO-DTE              PIC XX.
  1708         16  FILLER                        PIC X(10).
  1709
  1710     12  AM-SAVED-REMIT-TO                 PIC 99.
  1711
  1712     12  AM-COMM-STRUCTURE-SAVED.
  1713         16  AM-DEFN-1-SAVED.
  1714             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1715                 24  AM-AGT-SV             PIC X(10).
  1716                 24  AM-COM-TYP-SV         PIC X.
  1717                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1718                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1719                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1720                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1721                 24  FILLER                PIC X.
  1722                 24  AM-GL-CODES-SV        PIC X.
  1723                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1724                 24  FILLER                PIC X.
  1725         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1726             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1727                 24  FILLER                PIC X(11).
  1728                 24  AM-L-COMA-SV          PIC XXX.
  1729                 24  AM-J-COMA-SV          PIC XXX.
  1730                 24  AM-A-COMA-SV          PIC XXX.
  1731                 24  FILLER                PIC X(6).
  1732
  1733     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1734         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1735            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1736            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1737            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1738
  1739     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  33
* EL6311.cbl
  1740     12  FILLER                            PIC X(120).
  1741
  1742     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1743         16  AM-CONTROL-NAME               PIC X(30).
  1744         16  AM-EXECUTIVE-ONE.
  1745             20  AM-EXEC1-NAME             PIC X(15).
  1746             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1747                                                          COMP-3.
  1748             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1749                                                          COMP-3.
  1750         16  AM-EXECUTIVE-TWO.
  1751             20  AM-EXEC2-NAME             PIC X(15).
  1752             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1753                                                          COMP-3.
  1754             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1755                                                          COMP-3.
  1756
  1757     12  AM-RETRO-ADDITIONAL-DATA.
  1758         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1759         16  AM-RETRO-PREM-P-E             PIC X.
  1760         16  AM-RETRO-CLMS-P-I             PIC X.
  1761         16  AM-RETRO-RET-BRACKET-LF.
  1762             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1763                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1764                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1765             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1766                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1767                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1768             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1769                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1770                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1771         16  AM-RETRO-RET-BRACKET-AH.
  1772             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1773                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1774                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1775                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1776             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1777                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1778                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1779             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1780                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1781                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1782
  1783     12  AM-COMMENTS.
  1784         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1785
  1786     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1787         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1788         16  AM-FLI-BILLING-CODE           PIC X.
  1789         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1790         16  AM-FLI-UNITED-IDENT           PIC X.
  1791         16  AM-FLI-INTEREST-LOST-DATA.
  1792             20  AM-FLI-BANK-NO            PIC X(5).
  1793             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1794             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1795             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1796         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1797             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  34
* EL6311.cbl
  1798             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1799             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1800         16  FILLER                        PIC X(102).
  1801
  1802     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1803         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1804             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1805             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1806             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1807             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1808             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1809         16  FILLER                          PIC X(10).
  1810******************************************************************
  1811*                                COPY ELCVADS.
  1812******************************************************************
  1813*                                                                *
  1814*                                                                *
  1815*                            ELCVADS.                            *
  1816*                                                                *
  1817*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1818*   ELVADS                  LENGTH = 350                         *
  1819******************************************************************
  1820******************************************************************
  1821*                   C H A N G E   L O G
  1822*
  1823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1824*-----------------------------------------------------------------
  1825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1826* EFFECTIVE    NUMBER
  1827*-----------------------------------------------------------------
  1828* 100111    2011022800001  AJRA  NAPERSOFT
  1829******************************************************************
  1830
  1831 01  VIRGINIA-DISCLOSURE.
  1832     12  VD-COMPANY-CD              PIC X.
  1833     12  VD-CARRIER                 PIC X.
  1834     12  VD-GROUPING.
  1835         20  VD-GROUPING-PREFIX     PIC XXX.
  1836         20  VD-GROUPING-PRIME      PIC XXX.
  1837     12  VD-STATE                   PIC XX.
  1838     12  VD-ACCOUNT.
  1839         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1840         20  VD-ACCOUNT-PRIME       PIC X(6).
  1841     12  VD-CERT-EFF-DT             PIC XX.
  1842     12  VD-CERT-NO.
  1843         20  VD-CERT-PRIME          PIC X(10).
  1844         20  VD-CERT-SFX            PIC X.
  1845     12  VD-ENTRY-BATCH             PIC X(6).
  1846     12  VD-CSR-ID                  PIC X(4).
  1847     12  VD-NAME.
  1848         20  VD-INSURED-LAST-NAME   PIC X(15).
  1849         20  VD-INSURED-FIRST-NAME.
  1850             24  VD-INSURED-1ST-INIT PIC X.
  1851             24  FILLER             PIC X(9).
  1852         20  VD-INSURED-MIDDLE-INIT PIC X.
  1853     12  VD-JOINT-INSURED.
  1854         20 VD-JOINT-LAST-NAME      PIC X(15).
  1855         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  35
* EL6311.cbl
  1856            24  VD-JOINT-FIRST-INIT PIC X.
  1857            24  FILLER              PIC X(9).
  1858         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1859     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1860     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1861     12  VD-INSURED-CITY-STATE.
  1862         20  VD-INSURED-CITY        PIC X(28).
  1863         20  VD-INSURED-STATE       PIC XX.
  1864     12  VD-INSURED-ZIP-CODE.
  1865         20  VD-INSURED-ZIP-PRIME.
  1866             24  VD-INSURED-ZIP-1   PIC X.
  1867                 88  VD-CANADIAN-POST-CODE
  1868                                       VALUE 'A' THRU 'Z'.
  1869             24  FILLER             PIC X(4).
  1870         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1871     12  VD-BENEFICIARY-NAME        PIC X(30).
  1872     12  VD-ACCOUNT-NAME            PIC X(30).
  1873     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1874     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1875     12  VD-1ST-PMT-DT              PIC XX.
  1876     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1877         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1878         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1879                                             '90' THRU '99'.
  1880     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1881                                    PIC XX.
  1882     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1883     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1884     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1885     12  VD-LF-TERM                 PIC S999   COMP-3.
  1886     12  VD-AH-BENEFIT-CD           PIC XX.
  1887         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1888         88  VD-INVALID-AH             VALUE '  ' '00'
  1889                                             '90' THRU '99'.
  1890     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1891     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1892     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1893     12  VD-AH-TERM                 PIC S999   COMP-3.
  1894     12  VD-LETTER-ID               PIC X(4).
  1895     12  VD-PROC-ID                 PIC X(4).
  1896     12  VD-COMP-ID                 PIC X(3).
  1897     12  VD-CURRENT-DATE            PIC XX.
  1898     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1899     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1900     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  36
* EL6311.cbl
  1902*    COPY ELCDATE.
  1903******************************************************************
  1904*                                                                *
  1905*                                                                *
  1906*                            ELCDATE.                            *
  1907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1908*                            VMOD=2.003
  1909*                                                                *
  1910*                                                                *
  1911*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1912*                 LENGTH = 200                                   *
  1913******************************************************************
  1914
  1915 01  DATE-CONVERSION-DATA.
  1916     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1917     12  DC-OPTION-CODE                PIC X.
  1918         88  BIN-TO-GREG                VALUE ' '.
  1919         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1920         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1921         88  YMD-GREG-TO-BIN            VALUE '3'.
  1922         88  MDY-GREG-TO-BIN            VALUE '4'.
  1923         88  JULIAN-TO-BIN              VALUE '5'.
  1924         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1925         88  FIND-CENTURY               VALUE '7'.
  1926         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1927         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1928         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1929         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1930         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1931         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1932         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1933         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1934         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1935         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1936         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1937         88  BIN-3-TO-GREG              VALUE 'I'.
  1938         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1939         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1940         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1941         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1942         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1943         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1944         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1945         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1946         88  THREE-CHARACTER-BIN
  1947                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1948         88  GREGORIAN-TO-BIN
  1949                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1950         88  BIN-TO-GREGORIAN
  1951                  VALUES ' ' '1' 'I' '8' 'G'.
  1952         88  JULIAN-TO-BINARY
  1953                  VALUES '5' 'C' 'E' 'F'.
  1954     12  DC-ERROR-CODE                 PIC X.
  1955         88  NO-CONVERSION-ERROR        VALUE ' '.
  1956         88  DATE-CONVERSION-ERROR
  1957                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1958         88  DATE-IS-ZERO               VALUE '1'.
  1959         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  37
* EL6311.cbl
  1960         88  DATE-IS-INVALID            VALUE '3'.
  1961         88  DATE1-GREATER-DATE2        VALUE '4'.
  1962         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1963         88  DATE-INVALID-OPTION        VALUE '9'.
  1964         88  INVALID-CENTURY            VALUE 'A'.
  1965         88  ONLY-CENTURY               VALUE 'B'.
  1966         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1967         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1968     12  DC-END-OF-MONTH               PIC X.
  1969         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1970     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1971         88  USE-NORMAL-PROCESS         VALUE ' '.
  1972         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1973         88  ADJUST-UP-100-YRS          VALUE '2'.
  1974     12  FILLER                        PIC X.
  1975     12  DC-CONVERSION-DATES.
  1976         16  DC-BIN-DATE-1             PIC XX.
  1977         16  DC-BIN-DATE-2             PIC XX.
  1978         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1979         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1980                       DC-GREG-DATE-1-EDIT.
  1981             20  DC-EDIT1-MONTH        PIC 99.
  1982             20  SLASH1-1              PIC X.
  1983             20  DC-EDIT1-DAY          PIC 99.
  1984             20  SLASH1-2              PIC X.
  1985             20  DC-EDIT1-YEAR         PIC 99.
  1986         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1987         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1988                     DC-GREG-DATE-2-EDIT.
  1989             20  DC-EDIT2-MONTH        PIC 99.
  1990             20  SLASH2-1              PIC X.
  1991             20  DC-EDIT2-DAY          PIC 99.
  1992             20  SLASH2-2              PIC X.
  1993             20  DC-EDIT2-YEAR         PIC 99.
  1994         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1995         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1996                     DC-GREG-DATE-1-YMD.
  1997             20  DC-YMD-YEAR           PIC 99.
  1998             20  DC-YMD-MONTH          PIC 99.
  1999             20  DC-YMD-DAY            PIC 99.
  2000         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2001         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2002                      DC-GREG-DATE-1-MDY.
  2003             20  DC-MDY-MONTH          PIC 99.
  2004             20  DC-MDY-DAY            PIC 99.
  2005             20  DC-MDY-YEAR           PIC 99.
  2006         16  DC-GREG-DATE-1-ALPHA.
  2007             20  DC-ALPHA-MONTH        PIC X(10).
  2008             20  DC-ALPHA-DAY          PIC 99.
  2009             20  FILLER                PIC XX.
  2010             20  DC-ALPHA-CENTURY.
  2011                 24 DC-ALPHA-CEN-N     PIC 99.
  2012             20  DC-ALPHA-YEAR         PIC 99.
  2013         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2014         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2015         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2016         16  DC-JULIAN-DATE            PIC 9(05).
  2017         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  38
* EL6311.cbl
  2018                                       PIC 9(05).
  2019         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2020             20  DC-JULIAN-YEAR        PIC 99.
  2021             20  DC-JULIAN-DAYS        PIC 999.
  2022         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2023         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2024         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2025     12  DATE-CONVERSION-VARIBLES.
  2026         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2027         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2028             20  FILLER                PIC 9(3).
  2029             20  HOLD-CEN-1-CCYY.
  2030                 24  HOLD-CEN-1-CC     PIC 99.
  2031                 24  HOLD-CEN-1-YY     PIC 99.
  2032             20  HOLD-CEN-1-MO         PIC 99.
  2033             20  HOLD-CEN-1-DA         PIC 99.
  2034         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2035             20  HOLD-CEN-1-R-MO       PIC 99.
  2036             20  HOLD-CEN-1-R-DA       PIC 99.
  2037             20  HOLD-CEN-1-R-CCYY.
  2038                 24  HOLD-CEN-1-R-CC   PIC 99.
  2039                 24  HOLD-CEN-1-R-YY   PIC 99.
  2040             20  FILLER                PIC 9(3).
  2041         16  HOLD-CENTURY-1-X.
  2042             20  FILLER                PIC X(3)  VALUE SPACES.
  2043             20  HOLD-CEN-1-X-CCYY.
  2044                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2045                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2046             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2047             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2048         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2049             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2050             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2051             20  HOLD-CEN-1-R-X-CCYY.
  2052                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2053                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2054             20  FILLER                PIC XXX.
  2055         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2056         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2057         16  DC-JULIAN-DATE-1          PIC 9(07).
  2058         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2059             20  DC-JULIAN-1-CCYY.
  2060                 24  DC-JULIAN-1-CC    PIC 99.
  2061                 24  DC-JULIAN-1-YR    PIC 99.
  2062             20  DC-JULIAN-DA-1        PIC 999.
  2063         16  DC-JULIAN-DATE-2          PIC 9(07).
  2064         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2065             20  DC-JULIAN-2-CCYY.
  2066                 24  DC-JULIAN-2-CC    PIC 99.
  2067                 24  DC-JULIAN-2-YR    PIC 99.
  2068             20  DC-JULIAN-DA-2        PIC 999.
  2069         16  DC-GREG-DATE-A-EDIT.
  2070             20  DC-EDITA-MONTH        PIC 99.
  2071             20  SLASHA-1              PIC X VALUE '/'.
  2072             20  DC-EDITA-DAY          PIC 99.
  2073             20  SLASHA-2              PIC X VALUE '/'.
  2074             20  DC-EDITA-CCYY.
  2075                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  39
* EL6311.cbl
  2076                 24  DC-EDITA-YEAR     PIC 99.
  2077         16  DC-GREG-DATE-B-EDIT.
  2078             20  DC-EDITB-MONTH        PIC 99.
  2079             20  SLASHB-1              PIC X VALUE '/'.
  2080             20  DC-EDITB-DAY          PIC 99.
  2081             20  SLASHB-2              PIC X VALUE '/'.
  2082             20  DC-EDITB-CCYY.
  2083                 24  DC-EDITB-CENT     PIC 99.
  2084                 24  DC-EDITB-YEAR     PIC 99.
  2085         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2086         16  DC-GREG-DATE-CYMD-R REDEFINES
  2087                              DC-GREG-DATE-CYMD.
  2088             20  DC-CYMD-CEN           PIC 99.
  2089             20  DC-CYMD-YEAR          PIC 99.
  2090             20  DC-CYMD-MONTH         PIC 99.
  2091             20  DC-CYMD-DAY           PIC 99.
  2092         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2093         16  DC-GREG-DATE-MDCY-R REDEFINES
  2094                              DC-GREG-DATE-MDCY.
  2095             20  DC-MDCY-MONTH         PIC 99.
  2096             20  DC-MDCY-DAY           PIC 99.
  2097             20  DC-MDCY-CEN           PIC 99.
  2098             20  DC-MDCY-YEAR          PIC 99.
  2099    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2100        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2101    12  DC-EL310-DATE                  PIC X(21).
  2102    12  FILLER                         PIC X(28).
  2103
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  40
* EL6311.cbl
  2105*    COPY ELCLOGOF.
  2106******************************************************************
  2107*                                                                *
  2108*                                                                *
  2109*                            ELCLOGOF.                           *
  2110*                            VMOD=2.001                          *
  2111*                                                                *
  2112*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2113*                                                                *
  2114******************************************************************
  2115 01  CLASIC-LOGOFF.
  2116     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2117     12  LOGOFF-TEXT.
  2118         16  FILLER          PIC X(5)    VALUE SPACES.
  2119         16  LOGOFF-MSG.
  2120             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2121             20  FILLER      PIC X       VALUE SPACES.
  2122             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2123         16  FILLER          PIC X(80)
  2124           VALUE '* YOU ARE NOW LOGGED OFF'.
  2125         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2126         16  FILLER          PIC X       VALUE QUOTE.
  2127         16  LOGOFF-SYS-MSG  PIC X(17)
  2128           VALUE 'S CLAS-IC SYSTEM '.
  2129     12  TEXT-MESSAGES.
  2130         16  UNACCESS-MSG    PIC X(29)
  2131             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2132         16  PGMIDERR-MSG    PIC X(17)
  2133             VALUE 'PROGRAM NOT FOUND'.
  2134
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  41
* EL6311.cbl
  2136*    COPY ELCATTR.
  2137******************************************************************
  2138*                                                                *
  2139*                            ELCATTR.                            *
  2140*                            VMOD=2.001                          *
  2141*                                                                *
  2142*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2143*                                                                *
  2144*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2145*                                                                *
  2146*                   POS 1   P=PROTECTED                          *
  2147*                           U=UNPROTECTED                        *
  2148*                           S=ASKIP                              *
  2149*                   POS 2   A=ALPHA/NUMERIC                      *
  2150*                           N=NUMERIC                            *
  2151*                   POS 3   N=NORMAL                             *
  2152*                           B=BRIGHT                             *
  2153*                           D=DARK                               *
  2154*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2155*                           OF=MODIFIED DATA TAG OFF             *
  2156*                                                                *
  2157*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2158******************************************************************
  2159 01  ATTRIBUTE-LIST.
  2160     12  AL-PABOF            PIC X       VALUE 'Y'.
  2161     12  AL-PABON            PIC X       VALUE 'Z'.
  2162     12  AL-PADOF            PIC X       VALUE '%'.
  2163     12  AL-PADON            PIC X       VALUE '_'.
  2164     12  AL-PANOF            PIC X       VALUE '-'.
  2165     12  AL-PANON            PIC X       VALUE '/'.
  2166     12  AL-SABOF            PIC X       VALUE '8'.
  2167     12  AL-SABON            PIC X       VALUE '9'.
  2168     12  AL-SADOF            PIC X       VALUE '@'.
  2169     12  AL-SADON            PIC X       VALUE QUOTE.
  2170     12  AL-SANOF            PIC X       VALUE '0'.
  2171     12  AL-SANON            PIC X       VALUE '1'.
  2172     12  AL-UABOF            PIC X       VALUE 'H'.
  2173     12  AL-UABON            PIC X       VALUE 'I'.
  2174     12  AL-UADOF            PIC X       VALUE '<'.
  2175     12  AL-UADON            PIC X       VALUE '('.
  2176     12  AL-UANOF            PIC X       VALUE ' '.
  2177     12  AL-UANON            PIC X       VALUE 'A'.
  2178     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2179     12  AL-UNBON            PIC X       VALUE 'R'.
  2180     12  AL-UNDOF            PIC X       VALUE '*'.
  2181     12  AL-UNDON            PIC X       VALUE ')'.
  2182     12  AL-UNNOF            PIC X       VALUE '&'.
  2183     12  AL-UNNON            PIC X       VALUE 'J'.
  2184
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  42
* EL6311.cbl
  2186*    COPY ELCEMIB.
  2187******************************************************************
  2188*                                                                *
  2189*                                                                *
  2190*                            ELCEMIB.                            *
  2191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2192*                            VMOD=2.005                          *
  2193*                                                                *
  2194*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2195*                                                                *
  2196******************************************************************
  2197 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2198     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2199     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2200     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2201     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2202     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2203     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2204     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2205     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2206     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2207         88  EMI-NO-ERRORS                    VALUE '1'.
  2208         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2209         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2210     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2211         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2212     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2213         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2214         88  EMI-AREA1-FULL                   VALUE '2'.
  2215     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2216         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2217         88  EMI-AREA2-FULL                   VALUE '2'.
  2218     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2219         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2220         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2221         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2222         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2223         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2224     12  EMI-ERROR-LINES.
  2225         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2226         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2227         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2228         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2229             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2230                 24  EMI-ERR-NUM         PIC X(4).
  2231                 24  EMI-FILLER          PIC X.
  2232                 24  EMI-SEV             PIC X.
  2233                 24  FILLER              PIC X.
  2234             20  FILLER                  PIC X(02).
  2235     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2236         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2237             20  EMI-ERROR-NUMBER    PIC X(4).
  2238             20  EMI-FILL            PIC X.
  2239             20  EMI-SEVERITY        PIC X.
  2240             20  FILLER              PIC X.
  2241             20  EMI-ERROR-TEXT.
  2242                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2243                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  43
* EL6311.cbl
  2244     12  EMI-SEVERITY-SAVE           PIC X.
  2245         88  EMI-NOTE                    VALUE 'N'.
  2246         88  EMI-WARNING                 VALUE 'W'.
  2247         88  EMI-FORCABLE                VALUE 'F'.
  2248         88  EMI-FATAL                   VALUE 'X'.
  2249     12  EMI-MESSAGE-FLAG            PIC X.
  2250         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2251         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2252     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2253     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2254         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2255         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2256         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2257     12  emi-claim-no                pic x(7).
  2258     12  emi-claim-type              pic x(6).
  2259     12  FILLER                      PIC X(124)  VALUE SPACES.
  2260     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2261     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2262     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2263     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2264
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  44
* EL6311.cbl
  2266*    COPY ELCINTF.
  2267******************************************************************
  2268*                                                                *
  2269*                                                                *
  2270*                            ELCINTF.                            *
  2271*                            VMOD=2.017                          *
  2272*                                                                *
  2273*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2274*                                                                *
  2275*       LENGTH = 1024                                            *
  2276*                                                                *
  2277******************************************************************
  2278*                   C H A N G E   L O G
  2279*
  2280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2281*-----------------------------------------------------------------
  2282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2283* EFFECTIVE    NUMBER
  2284*-----------------------------------------------------------------
  2285* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2286******************************************************************
  2287 01  PROGRAM-INTERFACE-BLOCK.
  2288     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2289     12  PI-CALLING-PROGRAM              PIC X(8).
  2290     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2291     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2292     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2293     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2294     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2295     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2296     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2297     12  PI-COMPANY-ID                   PIC XXX.
  2298     12  PI-COMPANY-CD                   PIC X.
  2299
  2300     12  PI-COMPANY-PASSWORD             PIC X(8).
  2301
  2302     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2303
  2304     12  PI-CONTROL-IN-PROGRESS.
  2305         16  PI-CARRIER                  PIC X.
  2306         16  PI-GROUPING                 PIC X(6).
  2307         16  PI-STATE                    PIC XX.
  2308         16  PI-ACCOUNT                  PIC X(10).
  2309         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2310                                         PIC X(10).
  2311         16  PI-CLAIM-CERT-GRP.
  2312             20  PI-CLAIM-NO             PIC X(7).
  2313             20  PI-CERT-NO.
  2314                 25  PI-CERT-PRIME       PIC X(10).
  2315                 25  PI-CERT-SFX         PIC X.
  2316             20  PI-CERT-EFF-DT          PIC XX.
  2317         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2318             20  PI-PLAN-CODE            PIC X(2).
  2319             20  PI-REVISION-NUMBER      PIC X(3).
  2320             20  PI-PLAN-EFF-DT          PIC X(2).
  2321             20  PI-PLAN-EXP-DT          PIC X(2).
  2322             20  FILLER                  PIC X(11).
  2323         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  45
* EL6311.cbl
  2324             20  PI-OE-REFERENCE-1.
  2325                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2326                 25  PI-OE-REF-1-SUFF    PIC XX.
  2327
  2328     12  PI-SESSION-IN-PROGRESS          PIC X.
  2329         88  CLAIM-SESSION                   VALUE '1'.
  2330         88  CREDIT-SESSION                  VALUE '2'.
  2331         88  WARRANTY-SESSION                VALUE '3'.
  2332         88  MORTGAGE-SESSION                VALUE '4'.
  2333         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2334
  2335
  2336*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2337
  2338     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2339     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2340
  2341     12  PI-CREDIT-USER                  PIC X.
  2342         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2343         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2344
  2345     12  PI-CLAIM-USER                   PIC X.
  2346         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2347         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2348
  2349     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2350         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2351         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2352         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2353         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2354         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2355
  2356     12  PI-PROCESSOR-ID                 PIC X(4).
  2357
  2358     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2359
  2360     12  PI-MEMBER-CAPTION               PIC X(10).
  2361
  2362     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2363         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2364
  2365     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2366     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2367     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2368     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2369
  2370     12  PI-AH-OVERRIDE-L1               PIC X.
  2371     12  PI-AH-OVERRIDE-L2               PIC XX.
  2372     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2373     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2374
  2375     12  PI-NEW-SYSTEM                   PIC X(2).
  2376
  2377     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2378     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2379         88  PI-USES-PAID-TO                 VALUE '1'.
  2380     12  PI-CRDTCRD-SYSTEM.
  2381         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  46
* EL6311.cbl
  2382             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2383             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2384         16  PI-CC-MONTH-END-DT          PIC XX.
  2385     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2386
  2387     12  PI-OE-REFERENCE-2.
  2388         16  PI-OE-REF-2-PRIME           PIC X(10).
  2389         16  PI-OE-REF-2-SUFF            PIC X.
  2390
  2391     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2392
  2393     12  PI-LANGUAGE-TYPE                PIC X.
  2394             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2395             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2396             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2397
  2398     12  PI-POLICY-LINKAGE-IND           PIC X.
  2399         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2400         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2401                                                   LOW-VALUES.
  2402
  2403     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2404     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2405         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2406         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2407
  2408     12  PI-PROCESSOR-CSR-IND            PIC X.
  2409         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2410         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2411
  2412     12  FILLER                          PIC X(3).
  2413
  2414     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2415
  2416     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2417         PI-SYSTEM-LEVEL.
  2418
  2419         16  PI-ENTRY-CODES.
  2420             20  PI-ENTRY-CD-1           PIC X.
  2421             20  PI-ENTRY-CD-2           PIC X.
  2422
  2423         16  PI-RETURN-CODES.
  2424             20  PI-RETURN-CD-1          PIC X.
  2425             20  PI-RETURN-CD-2          PIC X.
  2426
  2427         16  PI-UPDATE-STATUS-SAVE.
  2428             20  PI-UPDATE-BY            PIC X(4).
  2429             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2430
  2431         16  PI-LOWER-CASE-LETTERS       PIC X.
  2432             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2433
  2434*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2435*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2436*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2437
  2438         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2439             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  47
* EL6311.cbl
  2440             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2441             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2442             88  ACCNT-CNTL                  VALUE '3'.
  2443             88  CARR-ACCNT-CNTL             VALUE '4'.
  2444
  2445         16  PI-PROCESSOR-CAP-LIST.
  2446             20  PI-SYSTEM-CONTROLS.
  2447                24 PI-SYSTEM-DISPLAY     PIC X.
  2448                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2449                24 PI-SYSTEM-MODIFY      PIC X.
  2450                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2451             20  FILLER                  PIC XX.
  2452             20  PI-DISPLAY-CAP          PIC X.
  2453                 88  DISPLAY-CAP             VALUE 'Y'.
  2454             20  PI-MODIFY-CAP           PIC X.
  2455                 88  MODIFY-CAP              VALUE 'Y'.
  2456             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2457                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2458             20  PI-FORCE-CAP            PIC X.
  2459                 88  FORCE-CAP               VALUE 'Y'.
  2460
  2461         16  PI-PROGRAM-CONTROLS.
  2462             20  PI-PGM-PRINT-OPT        PIC X.
  2463             20  PI-PGM-FORMAT-OPT       PIC X.
  2464             20  PI-PGM-PROCESS-OPT      PIC X.
  2465             20  PI-PGM-TOTALS-OPT       PIC X.
  2466
  2467         16  PI-HELP-INTERFACE.
  2468             20  PI-LAST-ERROR-NO        PIC X(4).
  2469             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2470
  2471         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2472             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2473
  2474         16  PI-CR-CONTROL-IN-PROGRESS.
  2475             20  PI-CR-CARRIER           PIC X.
  2476             20  PI-CR-GROUPING          PIC X(6).
  2477             20  PI-CR-STATE             PIC XX.
  2478             20  PI-CR-ACCOUNT           PIC X(10).
  2479             20  PI-CR-FIN-RESP          PIC X(10).
  2480             20  PI-CR-TYPE              PIC X.
  2481
  2482         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2483
  2484         16  PI-CR-MONTH-END-DT          PIC XX.
  2485
  2486         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2487             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2488             88  PI-ZERO-CARRIER             VALUE '1'.
  2489             88  PI-ZERO-GROUPING            VALUE '2'.
  2490             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2491
  2492         16  PI-CARRIER-SECURITY         PIC X.
  2493             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2494
  2495         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2496             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2497             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  48
* EL6311.cbl
  2498
  2499         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2500             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2501                                         INDEXED BY PI-ACCESS-NDX
  2502                                         PIC X.
  2503
  2504         16  PI-GA-BILLING-CONTROL       PIC X.
  2505             88  PI-GA-BILLING               VALUE '1'.
  2506
  2507         16  PI-MAIL-PROCESSING          PIC X.
  2508             88  PI-MAIL-YES                 VALUE 'Y'.
  2509
  2510         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2511
  2512         16  PI-AR-SYSTEM.
  2513             20  PI-AR-PROCESSING-CNTL   PIC X.
  2514                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2515             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2516             20  PI-AR-MONTH-END-DT      PIC XX.
  2517
  2518         16  PI-MP-SYSTEM.
  2519             20  PI-MORTGAGE-USER            PIC X.
  2520                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2521                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2522             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2523                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2524                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2525                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2526                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2527                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2528             20  PI-MP-MONTH-END-DT          PIC XX.
  2529             20  PI-MP-REFERENCE-NO.
  2530                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2531                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2532
  2533         16  PI-LABEL-CONTROL            PIC X(01).
  2534             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2535             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2536
  2537         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2538             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2539
  2540         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2541             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2542             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2543
  2544         16  FILLER                      PIC X(14).
  2545
  2546     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2547******************************************************************
  2548
  2549     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2550*    COPY ELC631PI.
  2551******************************************************************
  2552*                                                                *
  2553*                                                                *
  2554*                            ELC631PI                            *
  2555*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  49
* EL6311.cbl
  2556*                                                                *
  2557*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2558*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2559*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2560*                                                                *
  2561*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2562*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2563*    BETWEEN PROGRAMS.                                           *
  2564*                                                                *
  2565*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2566*                                                                *
  2567*               EL631 - EL6311 - EL6312 - EL6313                 *
  2568*                                                                *
  2569******************************************************************
  2570*                   C H A N G E   L O G
  2571*
  2572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2573*-----------------------------------------------------------------
  2574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2575* EFFECTIVE    NUMBER
  2576*-----------------------------------------------------------------
  2577* 021414    2003053000001  PEMA  changes for auto chk request
  2578******************************************************************
  2579
  2580         16  PI-631-DATA.
  2581             20  PI-ERPNDB-KEY.
  2582                 24  PI-PB-COMPANY-CD     PIC X.
  2583                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2584                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2585                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2586
  2587             20  PI-ERPNDB-ALT-KEY.
  2588                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2589                 24  PI-PB-CARRIER        PIC X.
  2590                 24  PI-PB-GROUPING       PIC X(6).
  2591                 24  PI-PB-STATE          PIC XX.
  2592                 24  PI-PB-ACCOUNT        PIC X(10).
  2593                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2594                 24  PI-PB-CERT-NO.
  2595                     28  PI-PB-CERT-PRIME PIC X(10).
  2596                     28  PI-PB-CERT-SFX   PIC X.
  2597                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2598                 24  PI-PB-RECORD-TYPE    PIC X.
  2599
  2600             20  PI-ERPNDB-CSR-KEY.
  2601                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2602                 24  PI-PB-CSR-ID             PIC X(4).
  2603                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2604                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2605                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2606
  2607             20  PI-BROWSE-TYPE               PIC X.
  2608                 88  PI-FILE-BROWSE             VALUE ' '.
  2609                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2610                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2611                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2612                 88  PI-CSR-BROWSE              VALUE '4'.
  2613
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  50
* EL6311.cbl
  2614             20  PI-MAINT-FUNCTION            PIC X.
  2615                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2616                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2617                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2618                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2619                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2620                 88  PI-PF5-FUNCTION            VALUE '5'.
  2621                 88  PI-PF6-FUNCTION            VALUE '6'.
  2622
  2623             20  PI-FILE-SWITCHES.
  2624                 24  PI-ALL-ISSUES-SW         PIC X.
  2625                     88  ALL-ISSUES             VALUE 'Y'.
  2626                 24  PI-ALL-CANCELS-SW        PIC X.
  2627                     88  ALL-CANCELS            VALUE 'Y'.
  2628                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2629                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2630                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2631                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2632                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2633                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2634                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2635                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2636                 24  PI-HOLD-REC-SW           PIC X.
  2637                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2638                 24  PI-CHANGE-REC-SW         PIC X.
  2639                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2640                 24  PI-CHK-REQ-REC-SW        PIC X.
  2641                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2642                 24  PI-ISSUE-WARNING-SW      PIC X.
  2643                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2644                 24  PI-CANCEL-WARNING-SW     PIC X.
  2645                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2646             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2647                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2648             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2649                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2650
  2651             20  PI-MAP-NAME                  PIC X(8).
  2652
  2653             20  PI-CURSOR                    PIC S9(4) COMP.
  2654
  2655             20  PI-PREV-ALT-KEY              PIC X(36).
  2656             20  PI-PREV-CSR-KEY              PIC X(15).
  2657             20  PI-PREV-KEY.
  2658                 24  PI-PREV-COMPANY-CD       PIC X.
  2659                 24  PI-PREV-BATCH            PIC X(6).
  2660                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2661                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2662             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2663             20  PI-BROWSE-SW                 PIC X.
  2664                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2665                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2666             20  PI-SV-CARRIER                PIC X.
  2667             20  PI-SV-GROUPING               PIC X(6).
  2668             20  PI-SV-STATE                  PIC XX.
  2669             20  PI-EDIT-SW                   PIC X.
  2670             20  PI-DISPLAY-SW                PIC XX.
  2671                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  51
* EL6311.cbl
  2672                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2673             20  PI-CRITERIA-DATA             PIC X(350).
  2674             20  PI-BMODE                     PIC X.
  2675             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2676             20  PI-BPMTS                     PIC S999     COMP-3.
  2677             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2678             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2679             20  PI-CSR-SESSION-SW            PIC X.
  2680                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2681             20  PI-ERRORS-SW                 PIC X.
  2682                 88  FATAL-ERRORS               VALUE 'X'.
  2683*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2684             20  pi-unforced-sw               pic x.
  2685                 88  unforced-errors            value 'X'.
  2686             20  FILLER                       PIC X(4).
  2687
  2688        16  pi-6311-fatal-ctr    pic s999 comp-3.
  2689        16  FILLER             PIC X(92).
  2690
  2691 01  W-LETTER-COMMUNICATION-AREAS.
  2692*    COPY ELC1042.
  2693******************************************************************
  2694*                                                                *
  2695*                                                                *
  2696*                           ELC1042                              *
  2697*                            VMOD=2.002                          *
  2698*                                                                *
  2699*    NOTE                                                        *
  2700*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2701*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2702*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2703*        TO THESE PROGRAMS.                                      *
  2704*                                                                *
  2705*    NOTE                                                        *
  2706*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2707*        USE ONLY!                                               *
  2708*                                                                *
  2709******************************************************************
  2710
  2711         16  PI-1042-WA.
  2712             20  PI-ACTION       PIC  X(01).
  2713                 88 PI-SHOW-MODE           VALUE '1'.
  2714                 88 PI-CLEAR-MODE          VALUE '2'.
  2715                 88 PI-CREATE-MODE         VALUE '3'.
  2716             20  PI-COMM-CONTROL PIC  X(12).
  2717             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2718             20  PI-EOF-SW       PIC  X(01).
  2719                 88  PI-FILE-EOF           VALUE 'Y'.
  2720             20  PI-FILETYP      PIC  X(01).
  2721             20  PI-FORM-SQUEEZE-CONTROL
  2722                                 PIC  X(01).
  2723                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2724                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2725             20  PI-LAST-CONTROL PIC  X(12).
  2726             20  PI-TEMP-STOR-ITEMS
  2727                                 PIC S9(04) COMP.
  2728             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2729             20  PI-UPDATE-SW    PIC  9(01).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  52
* EL6311.cbl
  2730                 88 ANY-UPDATES            VALUE 1.
  2731             20  PI-104-SCREEN-SENT-IND
  2732                                 PIC  X(01).
  2733                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2734                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2735             20  PI-1042-SCREEN-SENT-IND
  2736                                 PIC  X(01).
  2737                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2738                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2739             20  PI-1042-ARCHIVE-IND
  2740                                 PIC  X(01).
  2741                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2742             20  FILLER          PIC  X(29).
  2743*    COPY ELC689PI.
  2744******************************************************************
  2745*                                                                *
  2746*                            ELC689PI                            *
  2747*                            VMOD=2.003                          *
  2748*                                                                *
  2749*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2750*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2751*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2752*                                                                *
  2753*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2754*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2755*    BETWEEN PROGRAMS.                                           *
  2756*                                                                *
  2757*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2758*                                                                *
  2759*               EL631 - EL689  - EL6891 - EL6892                 *
  2760*                                                                *
  2761******************************************************************
  2762*                   C H A N G E   L O G
  2763*
  2764* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2765*-----------------------------------------------------------------
  2766*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2767* EFFECTIVE    NUMBER
  2768*-----------------------------------------------------------------
  2769* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2770* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2771* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2772******************************************************************
  2773
  2774
  2775         16  PI-689-WORK-AREA.
  2776             20  PI-689-ALT-PRINTER-ID
  2777                                 PIC  X(04).
  2778             20  PI-689-ARCHIVE-NUMBER
  2779                                 PIC  9(08).
  2780             20  PI-689-ARCHIVE-SW
  2781                                 PIC  X(01).
  2782                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2783             20  PI-689-DATA-SOURCE
  2784                                 PIC  X(01).
  2785                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2786                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2787                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  53
* EL6311.cbl
  2788                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2789                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2790             20  PI-689-ERROR-IND
  2791                                 PIC  X(01).
  2792                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2793             20  PI-689-ERROR    PIC  9(04).
  2794                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2795                 88  PI-689-FATAL-ERROR
  2796                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2797                            0042 0047 0051 0066 0067 0070
  2798                            0168 0169 0174 0175 0176 0177 0179
  2799                            0180 0181 0182 0184 0185 0189 0190
  2800                            0191
  2801                            0215 0279 0280
  2802                            0412 0413 0454
  2803                            0533 0537
  2804                            2055 2114 2208 2209 2216 2232 2369
  2805                            2398 2433 2908 2999
  2806                            3000 3770 3771 3775
  2807                            7250 7365 7367 7368 7369 7370 7371
  2808                            7272 7373 7374 7376 7377 7378 7379
  2809                            7381 7388 7390 7393 7395 7396 7398
  2810                            9095 9096 9281 9298 9299 9320 9327
  2811                            9426 9427.
  2812                 88  PI-689-STOP-ERROR
  2813                     VALUES 0004 0008 0013 0023 0029 0033
  2814                            0042 0047 0066 0067 0070
  2815                            0168 0169 0174 0175 0176 0177
  2816                            0181 0182 0184 0185 0189 0190
  2817                            0279 0280
  2818                            0412 0413 0454
  2819                            2055 2208 2209 2216 2232
  2820                            2398 2999
  2821                            3000 3770 3771 3775
  2822                            7250 7365 7369 7370 7371
  2823                            7272 7373 7374 7376 7377 7378 7379
  2824                            7381 7388 7390 7393 7396 7398
  2825                            9095 9096 9299 9320 9426.
  2826             20  PI-689-FOLLOW-UP-DATE
  2827                                 PIC  X(02).
  2828             20  PI-689-FORM-NUMBER
  2829                                 PIC  X(04).
  2830             20  PI-689-LABEL-SOURCE
  2831                                 PIC X(01).
  2832                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2833                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2834                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2835                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2836                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2837                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2838                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2839             20  PI-689-NUMBER-COPIES
  2840                                 PIC  9(01).
  2841             20  PI-689-NUMBER-LABEL-LINES
  2842                                 PIC  9(01).
  2843             20  PI-689-NUMBER-TEXT-RECORDS
  2844                                 PIC  9(03).
  2845             20  PI-689-PRINT-ORDER-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  54
* EL6311.cbl
  2846                                 PIC  X(01).
  2847                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2848                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2849                 88  PI-689-PRINT-LATER     VALUE '3'.
  2850                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2851             20  PI-689-PRINT-RESTRICTION
  2852                                 PIC  X(01).
  2853                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2854                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2855                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2856             20  PI-689-PRINT-SW PIC  X(01).
  2857                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2858             20  PI-689-RESEND-DATE-1
  2859                                 PIC  X(02).
  2860             20  PI-689-RESEND-LETR-1
  2861                                 PIC X(4).
  2862             20  PI-689-TEMP-STOR-ID
  2863                                 PIC  X(08).
  2864             20  PI-689-USE-SCREEN-IND
  2865                                 PIC  X(01).
  2866                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2867             20  PI-689-ARCH-POINTER
  2868                                 PIC S9(08) COMP.
  2869                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2870             20  PI-689-ARCT-POINTER
  2871                                 PIC S9(08) COMP.
  2872                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2873             20  PI-689-VARIABLE-DATA-GRP.
  2874                 24  PI-689-VARIABLE-DATA-1
  2875                                 PIC  X(30).
  2876                 24  PI-689-VARIABLE-DATA-2
  2877                                 PIC  X(30).
  2878                 24  PI-689-VARIABLE-DATA-3
  2879                                 PIC  X(30).
  2880                 24  PI-689-VARIABLE-DATA-4
  2881                                 PIC  X(30).
  2882
  2883         16  PI-689-KEY-DATA-FIELDS.
  2884             20  PI-689-ACCOUNT  PIC  X(10).
  2885             20  PI-689-CARRIER  PIC  X(01).
  2886             20  PI-689-CERT-NO.
  2887                 24  PI-689-CERT-PRIME
  2888                                 PIC  X(10).
  2889                 24  PI-689-CERT-SFX
  2890                                 PIC  X(01).
  2891             20  PI-689-CHG-SEQ-NO
  2892                                 PIC S9(04)    COMP.
  2893             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2894                                 PIC  X(02).
  2895             20  PI-689-ENTRY-BATCH
  2896                                 PIC  X(06).
  2897             20  PI-689-EFF-DATE PIC  X(02).
  2898             20  PI-689-EXP-DATE PIC  X(02).
  2899             20  PI-689-GROUPING PIC  X(06).
  2900             20  PI-689-RESP-PERSON
  2901                                 PIC  X(10).
  2902             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2903             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  55
* EL6311.cbl
  2904                                 PIC  X(04).
  2905             20  PI-689-STATE    PIC  X(02).
  2906             20  PI-689-TYPE     PIC  X(01).
  2907             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2908             20  PI-689-ALT-SEQ-NO
  2909                                 PIC S9(04)    COMP.
  2910         16  PI-689-DATE-EDIT    PIC  X(08).
  2911         16  PI-689-FOLLOW-UP-EDIT
  2912                                 PIC  X(08).
  2913         16  PI-689-RESEND1-EDIT PIC  X(08).
  2914         16  PI-689-SEQ-EDIT     PIC  X(08).
  2915         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2916         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2917             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2918         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2919         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  56
* EL6311.cbl
  2921
  2922 01  WS-EL6315-PASS-AREA.
  2923        16  PI-6315-ISS-CAN-SW      PIC X.
  2924        16  FILLER                  PIC X(120).
  2925        16  PI-RES-REF-CLM-TYPE     PIC X.
  2926        16  FILLER                  PIC X.
  2927        16  PI-6315-PASS-AREA.
  2928            20 FILLER               PIC X(236).
  2929            20 PI-6315-FINALIZED    PIC X.
  2930            20 FILLER               PIC X(280).
  2931
  2932 01  WS-EL6316-PASS-AREA.
  2933        16  PI-ISS-CAN-SW           PIC X.
  2934        16  FILLER                  PIC X(121).
  2935        16  PI-CLM-RESC-IND         PIC X.
  2936        16  PI-6316-PASS-AREA.
  2937            20 FILLER               PIC X(236).
  2938            20 PI-6316-FINALIZED    PIC X.
  2939            20 FILLER               PIC X(280).
  2940
  2941******************************************************************
  2942*                                                                *
  2943*         P A S S   A R E A   F O R   E D I T                    *
  2944*                                                                *
  2945******************************************************************
  2946
  2947 01  PASSED-RECORD.
  2948     12  RECORD-SAVE                  PIC X(585).
  2949* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2950*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2951*                    BY  WK-CURRENT-DATE.
  2952******************************************************************
  2953*                                                                *
  2954*                                                                *
  2955*                             ELC50W1                            *
  2956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2957*                            VMOD=2.004                          *
  2958*                                                                *
  2959*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2960*                                                                *
  2961*                                                                *
  2962******************************************************************
  2963
  2964     12  WK-WORK-AREA.
  2965         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2966         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2967         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2968         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2969         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2970         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2971         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2972         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2973         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2974         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2975         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2976         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2977         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2978         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  57
* EL6311.cbl
  2979         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2980         16  WK-CREDIT-EDIT-CONTROLS.
  2981             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2982             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2983             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2984             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2985             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2986             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2987         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2988         16  WK-SAVE-REIN-DATA.
  2989             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2990             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2991             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2992         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2993             88  ENTRY-FROM-EL6311       VALUE '6'.
  2994         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2995         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2996     12  WK-RECORD-ADDRESSES.
  2997         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2998         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2999         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  3000         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  3001         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  3002         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3003         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3004         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3005     12  WK-OVER-SHORT-AREA.
  3006         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3007         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3008         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3009             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3010         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  58
* EL6311.cbl
  3012
  3013*    COPY ELCEDITC.
  3014******************************************************************
  3015*                                                                *
  3016*                                                                *
  3017*                            ELCEDITC                            *
  3018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3019*                            VMOD=2.012                          *
  3020*                                                                *
  3021*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3022*                     EL6313, EL050 AND EL517.                   *
  3023*                                                                *
  3024******************************************************************
  3025******************************************************************
  3026*                   C H A N G E   L O G
  3027*
  3028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3029*-----------------------------------------------------------------
  3030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3031* EFFECTIVE    NUMBER
  3032*-----------------------------------------------------------------
  3033* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3034******************************************************************
  3035
  3036     12  EDIT-CRITERIA-DATA.
  3037         16  EC-CO-MONTH-END-DT       PIC XX.
  3038         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3039         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3040         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3041         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3042         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3043         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3044         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3045         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3046         16  EC-CO-REM-TERM-CALC      PIC X.
  3047               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3048               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3049               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3050               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3051
  3052         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3053               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3054               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3055               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3056               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3057               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3058               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3059               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3060               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3061               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3062               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3063
  3064         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3065               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3066               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3067               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3068               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3069               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  59
* EL6311.cbl
  3070               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3071               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3072               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3073
  3074         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3075                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3076                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3077
  3078         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3079                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3080                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3081                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3082                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3083                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3084                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3085                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3086                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3087
  3088         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3089               88  EC-BR-REDUCING                   VALUE 'R'.
  3090               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3091
  3092         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3093         16  EC-BR-LF-DESC             PIC X(10).
  3094         16  EC-BR-AH-DESC             PIC X(10).
  3095         16  EC-BR-LF-COMMENT          PIC X(10).
  3096         16  EC-BR-AH-COMMENT          PIC X(10).
  3097
  3098         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3099               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3100               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3101               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3102               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3103
  3104         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3105               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3106               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3107               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3108               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3109
  3110         16  EC-BR-LF-REFUND-CALC      PIC X.
  3111                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3112                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3113                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3114                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3115                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3116                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3117                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3118
  3119         16  EC-BR-AH-REFUND-CALC      PIC X.
  3120                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3121                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3122                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3123                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3124                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3125                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3126                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3127                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  60
* EL6311.cbl
  3128
  3129         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3130                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3131                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3132                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3133
  3134         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3135                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3136                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3137                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3138
  3139         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3140         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3141         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3142         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3143
  3144         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3145         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3146                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3147                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3148                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3149                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3150
  3151         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3152               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3153               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3154               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3155               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3156               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3157
  3158         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3159               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3160               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3161               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3162               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3163               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3164
  3165         16  EC-ST-LF-REFUND-CALC      PIC X.
  3166                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3167                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3168                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3169                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3170                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3171                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3172                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3173                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3174
  3175         16  EC-ST-AH-REFUND-CALC      PIC X.
  3176                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3177                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3178                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3179                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3180                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3181                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3182                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3183                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3184
  3185         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  61
* EL6311.cbl
  3186         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3187         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3188         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3189         16  EC-AM-EXPIRATION-DT       PIC XX.
  3190         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3191         16  EC-AM-CLASS-CD            PIC XX.
  3192         16  EC-AM-LF-DEVIATION        PIC XXX.
  3193         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3194         16  EC-AM-AH-DEVIATION        PIC XXX.
  3195         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3196         16  EC-AM-PHONE-NO            PIC X(10).
  3197
  3198         16  EC-AM-LF-REFUND-CALC      PIC X.
  3199                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3200                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3201                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3202                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3203                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3204                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3205                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3206
  3207         16  EC-AM-AH-REFUND-CALC      PIC X.
  3208                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3209                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3210                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3211                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3212                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3213                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3214                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3215
  3216         16  EC-AM-BEN-I-G-CD          PIC X.
  3217                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3218                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3219                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3220
  3221         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3222         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3223         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3224         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3225         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3226         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3227         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3228         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3229         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3230
  3231         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3232         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3233         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3234         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3235         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3236         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3237         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3238         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3239         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3240         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3241         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3242         16  EC-RT-LF-NSP-ST           PIC XX.
  3243         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  62
* EL6311.cbl
  3244         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3245         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3246
  3247         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3248             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3249                                             'M' '5' '9' '2'.
  3250             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3251             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3252             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3253             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3254             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3255             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3256             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3257             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3258             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3259             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3260
  3261         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3262             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3263                                             'M' '5' '9' '2'.
  3264             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3265             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3266             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3267             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3268             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3269             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3270             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3271             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3272             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3273             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3274
  3275         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3276         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3277         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3278         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3279         16  EC-CM-DEATH-DT            PIC XX.
  3280
  3281*DMD CUSTOM CODING FIELDS BELOW
  3282*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3283         16  EC-BR-DMD-RATING-SW       PIC X.
  3284                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3285                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3286                 88  NO-DMD-RATING               VALUE 'N'.
  3287
  3288         16  EC-NEW-CERT               PIC X(11).
  3289         16  EC-NEW-STATE              PIC XX.
  3290         16  FILLER                    PIC X.
  3291*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3292         16  OVER-SHORT-EDIT-FIELDS.
  3293             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3294             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3295             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3296             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3297             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3298             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3299             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3300             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3301             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  63
* EL6311.cbl
  3302         16  FILLER                    PIC X(71).
  3303
  3304******************************************************************
  3305
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  64
* EL6311.cbl
  3307
  3308*    COPY ELCJPFX.
  3309******************************************************************
  3310*                                                                *
  3311*                                                                *
  3312*                            ELCJPFX.                            *
  3313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3314*                            VMOD=2.002                          *
  3315*                                                                *
  3316*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3317*                                                                *
  3318*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3319*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3320*        ELCNTL - CONTROL FILE                                   *
  3321*        ELMSTR - CLAIM MASTERS                                  *
  3322*        ELTRLR - ACTIVITY TRAILERS                              *
  3323*        ELCHKQ - CHECK QUE                                      *
  3324******************************************************************
  3325 01  JOURNAL-RECORD.
  3326     12  jp-date                     pic s9(5) comp-3.
  3327     12  jp-time                     pic s9(7) comp-3.
  3328     12  JP-USER-ID                  PIC X(4).
  3329     12  JP-FILE-ID                  PIC X(8).
  3330     12  JP-PROGRAM-ID               PIC X(8).
  3331     12  JP-RECORD-TYPE              PIC X.
  3332         88 JP-ADD              VALUE 'A'.
  3333         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3334         88 JP-AFTER-CHANGE     VALUE 'C'.
  3335         88 JP-DELETE           VALUE 'D'.
  3336         88 JP-GENERIC-DELETE   VALUE 'G'.
  3337         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3338         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3339     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3340     12  JP-RECORD-AREA
  3341
  3342
  3343                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  65
* EL6311.cbl
  3345*    COPY ELCAID.
  3346******************************************************************
  3347*                                                                *
  3348*                            ELCAID.                             *
  3349*                            VMOD=2.001                          *
  3350*                                                                *
  3351*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3352*                                                                *
  3353*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3354*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3355******************************************************************
  3356
  3357 01  DFHAID.
  3358   02  DFHNULL   PIC  X  VALUE  ' '.
  3359   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3360   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3361   02  DFHPEN    PIC  X  VALUE  '='.
  3362   02  DFHOPID   PIC  X  VALUE  'W'.
  3363   02  DFHPA1    PIC  X  VALUE  '%'.
  3364   02  DFHPA2    PIC  X  VALUE  '>'.
  3365   02  DFHPA3    PIC  X  VALUE  ','.
  3366   02  DFHPF1    PIC  X  VALUE  '1'.
  3367   02  DFHPF2    PIC  X  VALUE  '2'.
  3368   02  DFHPF3    PIC  X  VALUE  '3'.
  3369   02  DFHPF4    PIC  X  VALUE  '4'.
  3370   02  DFHPF5    PIC  X  VALUE  '5'.
  3371   02  DFHPF6    PIC  X  VALUE  '6'.
  3372   02  DFHPF7    PIC  X  VALUE  '7'.
  3373   02  DFHPF8    PIC  X  VALUE  '8'.
  3374   02  DFHPF9    PIC  X  VALUE  '9'.
  3375   02  DFHPF10   PIC  X  VALUE  ':'.
  3376   02  DFHPF11   PIC  X  VALUE  '#'.
  3377   02  DFHPF12   PIC  X  VALUE  '@'.
  3378   02  DFHPF13   PIC  X  VALUE  'A'.
  3379   02  DFHPF14   PIC  X  VALUE  'B'.
  3380   02  DFHPF15   PIC  X  VALUE  'C'.
  3381   02  DFHPF16   PIC  X  VALUE  'D'.
  3382   02  DFHPF17   PIC  X  VALUE  'E'.
  3383   02  DFHPF18   PIC  X  VALUE  'F'.
  3384   02  DFHPF19   PIC  X  VALUE  'G'.
  3385   02  DFHPF20   PIC  X  VALUE  'H'.
  3386   02  DFHPF21   PIC  X  VALUE  'I'.
  3387*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3388   02  DFHPF22   PIC  X  VALUE  '['.
  3389   02  DFHPF23   PIC  X  VALUE  '.'.
  3390   02  DFHPF24   PIC  X  VALUE  '<'.
  3391   02  DFHMSRE   PIC  X  VALUE  'X'.
  3392   02  DFHSTRF   PIC  X  VALUE  'h'.
  3393   02  DFHTRIG   PIC  X  VALUE  '"'.
  3394
  3395 01  FILLER    REDEFINES DFHAID.
  3396     12  FILLER              PIC X(8).
  3397     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3398
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  66
* EL6311.cbl
  3400*    COPY EL6311S.
  3401 01  EL631BI.
  3402     05  FILLER            PIC  X(0012).
  3403*    -------------------------------
  3404     05  BDATEL PIC S9(0004) COMP.
  3405     05  BDATEF PIC  X(0001).
  3406     05  FILLER REDEFINES BDATEF.
  3407         10  BDATEA PIC  X(0001).
  3408     05  BDATEI PIC  X(0008).
  3409*    -------------------------------
  3410     05  BTIMEL PIC S9(0004) COMP.
  3411     05  BTIMEF PIC  X(0001).
  3412     05  FILLER REDEFINES BTIMEF.
  3413         10  BTIMEA PIC  X(0001).
  3414     05  BTIMEI PIC  X(0005).
  3415*    -------------------------------
  3416     05  BHEADL PIC S9(0004) COMP.
  3417     05  BHEADF PIC  X(0001).
  3418     05  FILLER REDEFINES BHEADF.
  3419         10  BHEADA PIC  X(0001).
  3420     05  BHEADI PIC  X(0038).
  3421*    -------------------------------
  3422     05  BNCERTLL PIC S9(0004) COMP.
  3423     05  BNCERTLF PIC  X(0001).
  3424     05  FILLER REDEFINES BNCERTLF.
  3425         10  BNCERTLA PIC  X(0001).
  3426     05  BNCERTLI PIC  X(0008).
  3427*    -------------------------------
  3428     05  BNCERTL PIC S9(0004) COMP.
  3429     05  BNCERTF PIC  X(0001).
  3430     05  FILLER REDEFINES BNCERTF.
  3431         10  BNCERTA PIC  X(0001).
  3432     05  BNCERTI PIC  X(0011).
  3433*    -------------------------------
  3434     05  BNSTATLL PIC S9(0004) COMP.
  3435     05  BNSTATLF PIC  X(0001).
  3436     05  FILLER REDEFINES BNSTATLF.
  3437         10  BNSTATLA PIC  X(0001).
  3438     05  BNSTATLI PIC  X(0009).
  3439*    -------------------------------
  3440     05  BNSTATL PIC S9(0004) COMP.
  3441     05  BNSTATF PIC  X(0001).
  3442     05  FILLER REDEFINES BNSTATF.
  3443         10  BNSTATA PIC  X(0001).
  3444     05  BNSTATI PIC  X(0002).
  3445*    -------------------------------
  3446     05  BCHGTL PIC S9(0004) COMP.
  3447     05  BCHGTF PIC  X(0001).
  3448     05  FILLER REDEFINES BCHGTF.
  3449         10  BCHGTA PIC  X(0001).
  3450     05  BCHGTI PIC  X(0004).
  3451*    -------------------------------
  3452     05  BCHGL PIC S9(0004) COMP.
  3453     05  BCHGF PIC  X(0001).
  3454     05  FILLER REDEFINES BCHGF.
  3455         10  BCHGA PIC  X(0001).
  3456     05  BCHGI PIC  X(0004).
  3457*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  67
* EL6311.cbl
  3458     05  BCOMPIDL PIC S9(0004) COMP.
  3459     05  BCOMPIDF PIC  X(0001).
  3460     05  FILLER REDEFINES BCOMPIDF.
  3461         10  BCOMPIDA PIC  X(0001).
  3462     05  BCOMPIDI PIC  X(0003).
  3463*    -------------------------------
  3464     05  BREGIONL PIC S9(0004) COMP.
  3465     05  BREGIONF PIC  X(0001).
  3466     05  FILLER REDEFINES BREGIONF.
  3467         10  BREGIONA PIC  X(0001).
  3468     05  BREGIONI PIC  X(0006).
  3469*    -------------------------------
  3470     05  BUSERL PIC S9(0004) COMP.
  3471     05  BUSERF PIC  X(0001).
  3472     05  FILLER REDEFINES BUSERF.
  3473         10  BUSERA PIC  X(0001).
  3474     05  BUSERI PIC  X(0004).
  3475*    -------------------------------
  3476     05  BMAINTL PIC S9(0004) COMP.
  3477     05  BMAINTF PIC  X(0001).
  3478     05  FILLER REDEFINES BMAINTF.
  3479         10  BMAINTA PIC  X(0001).
  3480     05  BMAINTI PIC  X(0001).
  3481*    -------------------------------
  3482     05  BMANTBYL PIC S9(0004) COMP.
  3483     05  BMANTBYF PIC  X(0001).
  3484     05  FILLER REDEFINES BMANTBYF.
  3485         10  BMANTBYA PIC  X(0001).
  3486     05  BMANTBYI PIC  X(0004).
  3487*    -------------------------------
  3488     05  BCHGHDGL PIC S9(0004) COMP.
  3489     05  BCHGHDGF PIC  X(0001).
  3490     05  FILLER REDEFINES BCHGHDGF.
  3491         10  BCHGHDGA PIC  X(0001).
  3492     05  BCHGHDGI PIC  X(0003).
  3493*    -------------------------------
  3494     05  BMANTDTL PIC S9(0004) COMP.
  3495     05  BMANTDTF PIC  X(0001).
  3496     05  FILLER REDEFINES BMANTDTF.
  3497         10  BMANTDTA PIC  X(0001).
  3498     05  BMANTDTI PIC  X(0008).
  3499*    -------------------------------
  3500     05  BMANTATL PIC S9(0004) COMP.
  3501     05  BMANTATF PIC  X(0001).
  3502     05  FILLER REDEFINES BMANTATF.
  3503         10  BMANTATA PIC  X(0001).
  3504     05  BMANTATI PIC  X(0005).
  3505*    -------------------------------
  3506     05  BCSRL PIC S9(0004) COMP.
  3507     05  BCSRF PIC  X(0001).
  3508     05  FILLER REDEFINES BCSRF.
  3509         10  BCSRA PIC  X(0001).
  3510     05  BCSRI PIC  X(0004).
  3511*    -------------------------------
  3512     05  BBATCHL PIC S9(0004) COMP.
  3513     05  BBATCHF PIC  X(0001).
  3514     05  FILLER REDEFINES BBATCHF.
  3515         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  68
* EL6311.cbl
  3516     05  BBATCHI PIC  X(0006).
  3517*    -------------------------------
  3518     05  BSEQL PIC S9(0004) COMP.
  3519     05  BSEQF PIC  X(0001).
  3520     05  FILLER REDEFINES BSEQF.
  3521         10  BSEQA PIC  X(0001).
  3522     05  BSEQI PIC  X(0004).
  3523*    -------------------------------
  3524     05  BMOENDTL PIC S9(0004) COMP.
  3525     05  BMOENDTF PIC  X(0001).
  3526     05  FILLER REDEFINES BMOENDTF.
  3527         10  BMOENDTA PIC  X(0001).
  3528     05  BMOENDTI PIC  X(0008).
  3529*    -------------------------------
  3530     05  BCARRL PIC S9(0004) COMP.
  3531     05  BCARRF PIC  X(0001).
  3532     05  FILLER REDEFINES BCARRF.
  3533         10  BCARRA PIC  X(0001).
  3534     05  BCARRI PIC  X(0001).
  3535*    -------------------------------
  3536     05  BGROUPL PIC S9(0004) COMP.
  3537     05  BGROUPF PIC  X(0001).
  3538     05  FILLER REDEFINES BGROUPF.
  3539         10  BGROUPA PIC  X(0001).
  3540     05  BGROUPI PIC  X(0006).
  3541*    -------------------------------
  3542     05  BSTATEL PIC S9(0004) COMP.
  3543     05  BSTATEF PIC  X(0001).
  3544     05  FILLER REDEFINES BSTATEF.
  3545         10  BSTATEA PIC  X(0001).
  3546     05  BSTATEI PIC  X(0002).
  3547*    -------------------------------
  3548     05  BACCTL PIC S9(0004) COMP.
  3549     05  BACCTF PIC  X(0001).
  3550     05  FILLER REDEFINES BACCTF.
  3551         10  BACCTA PIC  X(0001).
  3552     05  BACCTI PIC  X(0010).
  3553*    -------------------------------
  3554     05  BVINHL PIC S9(0004) COMP.
  3555     05  BVINHF PIC  X(0001).
  3556     05  FILLER REDEFINES BVINHF.
  3557         10  BVINHA PIC  X(0001).
  3558     05  BVINHI PIC  X(0004).
  3559*    -------------------------------
  3560     05  BVINL PIC S9(0004) COMP.
  3561     05  BVINF PIC  X(0001).
  3562     05  FILLER REDEFINES BVINF.
  3563         10  BVINA PIC  X(0001).
  3564     05  BVINI PIC  X(0017).
  3565*    -------------------------------
  3566     05  BREFHDGL PIC S9(0004) COMP.
  3567     05  BREFHDGF PIC  X(0001).
  3568     05  FILLER REDEFINES BREFHDGF.
  3569         10  BREFHDGA PIC  X(0001).
  3570     05  BREFHDGI PIC  X(0004).
  3571*    -------------------------------
  3572     05  BREFL PIC S9(0004) COMP.
  3573     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  69
* EL6311.cbl
  3574     05  FILLER REDEFINES BREFF.
  3575         10  BREFA PIC  X(0001).
  3576     05  BREFI PIC  X(0012).
  3577*    -------------------------------
  3578     05  BAGEDEFL PIC S9(0004) COMP.
  3579     05  BAGEDEFF PIC  X(0001).
  3580     05  FILLER REDEFINES BAGEDEFF.
  3581         10  BAGEDEFA PIC  X(0001).
  3582     05  BAGEDEFI PIC  X(0004).
  3583*    -------------------------------
  3584     05  BCERTNOL PIC S9(0004) COMP.
  3585     05  BCERTNOF PIC  X(0001).
  3586     05  FILLER REDEFINES BCERTNOF.
  3587         10  BCERTNOA PIC  X(0001).
  3588     05  BCERTNOI PIC  X(0010).
  3589*    -------------------------------
  3590     05  BSUFIXL PIC S9(0004) COMP.
  3591     05  BSUFIXF PIC  X(0001).
  3592     05  FILLER REDEFINES BSUFIXF.
  3593         10  BSUFIXA PIC  X(0001).
  3594     05  BSUFIXI PIC  X(0001).
  3595*    -------------------------------
  3596     05  BEFFDTL PIC S9(0004) COMP.
  3597     05  BEFFDTF PIC  X(0001).
  3598     05  FILLER REDEFINES BEFFDTF.
  3599         10  BEFFDTA PIC  X(0001).
  3600     05  BEFFDTI PIC  X(0008).
  3601*    -------------------------------
  3602     05  BLSTNML PIC S9(0004) COMP.
  3603     05  BLSTNMF PIC  X(0001).
  3604     05  FILLER REDEFINES BLSTNMF.
  3605         10  BLSTNMA PIC  X(0001).
  3606     05  BLSTNMI PIC  X(0015).
  3607*    -------------------------------
  3608     05  B1STNML PIC S9(0004) COMP.
  3609     05  B1STNMF PIC  X(0001).
  3610     05  FILLER REDEFINES B1STNMF.
  3611         10  B1STNMA PIC  X(0001).
  3612     05  B1STNMI PIC  X(0010).
  3613*    -------------------------------
  3614     05  BINITL PIC S9(0004) COMP.
  3615     05  BINITF PIC  X(0001).
  3616     05  FILLER REDEFINES BINITF.
  3617         10  BINITA PIC  X(0001).
  3618     05  BINITI PIC  X(0001).
  3619*    -------------------------------
  3620     05  BSEXL PIC S9(0004) COMP.
  3621     05  BSEXF PIC  X(0001).
  3622     05  FILLER REDEFINES BSEXF.
  3623         10  BSEXA PIC  X(0001).
  3624     05  BSEXI PIC  X(0001).
  3625*    -------------------------------
  3626     05  BAGEL PIC S9(0004) COMP.
  3627     05  BAGEF PIC  X(0001).
  3628     05  FILLER REDEFINES BAGEF.
  3629         10  BAGEA PIC  X(0001).
  3630     05  BAGEI PIC  X(0002).
  3631*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  70
* EL6311.cbl
  3632     05  BBIRTHL PIC S9(0004) COMP.
  3633     05  BBIRTHF PIC  X(0001).
  3634     05  FILLER REDEFINES BBIRTHF.
  3635         10  BBIRTHA PIC  X(0001).
  3636     05  BBIRTHI PIC  X(0008).
  3637*    -------------------------------
  3638     05  B1STPMTL PIC S9(0004) COMP.
  3639     05  B1STPMTF PIC  X(0001).
  3640     05  FILLER REDEFINES B1STPMTF.
  3641         10  B1STPMTA PIC  X(0001).
  3642     05  B1STPMTI PIC  X(0008).
  3643*    -------------------------------
  3644     05  BDAYSL PIC S9(0004) COMP.
  3645     05  BDAYSF PIC  X(0001).
  3646     05  FILLER REDEFINES BDAYSF.
  3647         10  BDAYSA PIC  X(0001).
  3648     05  BDAYSI PIC  X(0003).
  3649*    -------------------------------
  3650     05  BLNTRML PIC S9(0004) COMP.
  3651     05  BLNTRMF PIC  X(0001).
  3652     05  FILLER REDEFINES BLNTRMF.
  3653         10  BLNTRMA PIC  X(0001).
  3654     05  BLNTRMI PIC  X(0003).
  3655*    -------------------------------
  3656     05  BLNOFCRL PIC S9(0004) COMP.
  3657     05  BLNOFCRF PIC  X(0001).
  3658     05  FILLER REDEFINES BLNOFCRF.
  3659         10  BLNOFCRA PIC  X(0001).
  3660     05  BLNOFCRI PIC  X(0005).
  3661*    -------------------------------
  3662     05  BMODEL PIC S9(0004) COMP.
  3663     05  BMODEF PIC  X(0001).
  3664     05  FILLER REDEFINES BMODEF.
  3665         10  BMODEA PIC  X(0001).
  3666     05  BMODEI PIC  X(0001).
  3667*    -------------------------------
  3668     05  BFREQL PIC S9(0004) COMP.
  3669     05  BFREQF PIC  X(0001).
  3670     05  FILLER REDEFINES BFREQF.
  3671         10  BFREQA PIC  X(0001).
  3672     05  BFREQI PIC  X(0002).
  3673*    -------------------------------
  3674     05  BPMTSL PIC S9(0004) COMP.
  3675     05  BPMTSF PIC  X(0001).
  3676     05  FILLER REDEFINES BPMTSF.
  3677         10  BPMTSA PIC  X(0001).
  3678     05  BPMTSI PIC  999.
  3679*    -------------------------------
  3680     05  BPMTAMTL PIC S9(0004) COMP.
  3681     05  BPMTAMTF PIC  X(0001).
  3682     05  FILLER REDEFINES BPMTAMTF.
  3683         10  BPMTAMTA PIC  X(0001).
  3684     05  BPMTAMTI PIC  9(7)V99.
  3685*    -------------------------------
  3686     05  BAPRL PIC S9(0004) COMP.
  3687     05  BAPRF PIC  X(0001).
  3688     05  FILLER REDEFINES BAPRF.
  3689         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  71
* EL6311.cbl
  3690     05  BAPRI PIC  X(7).
  3691*    -------------------------------
  3692     05  BLIVESL PIC S9(0004) COMP.
  3693     05  BLIVESF PIC  X(0001).
  3694     05  FILLER REDEFINES BLIVESF.
  3695         10  BLIVESA PIC  X(0001).
  3696     05  BLIVESI PIC  X(0009).
  3697*    -------------------------------
  3698     05  BMEMCAPL PIC S9(0004) COMP.
  3699     05  BMEMCAPF PIC  X(0001).
  3700     05  FILLER REDEFINES BMEMCAPF.
  3701         10  BMEMCAPA PIC  X(0001).
  3702     05  BMEMCAPI PIC  X(0011).
  3703*    -------------------------------
  3704     05  BORIGHDL PIC S9(0004) COMP.
  3705     05  BORIGHDF PIC  X(0001).
  3706     05  FILLER REDEFINES BORIGHDF.
  3707         10  BORIGHDA PIC  X(0001).
  3708     05  BORIGHDI PIC  X(0009).
  3709*    -------------------------------
  3710     05  DMDBILL PIC S9(0004) COMP.
  3711     05  DMDBILF PIC  X(0001).
  3712     05  FILLER REDEFINES DMDBILF.
  3713         10  DMDBILA PIC  X(0001).
  3714     05  DMDBILI PIC  X(0006).
  3715*    -------------------------------
  3716     05  BFORCEL PIC S9(0004) COMP.
  3717     05  BFORCEF PIC  X(0001).
  3718     05  FILLER REDEFINES BFORCEF.
  3719         10  BFORCEA PIC  X(0001).
  3720     05  BFORCEI PIC  X(0001).
  3721*    -------------------------------
  3722     05  BENTRYL PIC S9(0004) COMP.
  3723     05  BENTRYF PIC  X(0001).
  3724     05  FILLER REDEFINES BENTRYF.
  3725         10  BENTRYA PIC  X(0001).
  3726     05  BENTRYI PIC  X(0001).
  3727*    -------------------------------
  3728     05  BREINL PIC S9(0004) COMP.
  3729     05  BREINF PIC  X(0001).
  3730     05  FILLER REDEFINES BREINF.
  3731         10  BREINA PIC  X(0001).
  3732     05  BREINI PIC  X(0001).
  3733*    -------------------------------
  3734     05  BBILCDL PIC S9(0004) COMP.
  3735     05  BBILCDF PIC  X(0001).
  3736     05  FILLER REDEFINES BBILCDF.
  3737         10  BBILCDA PIC  X(0001).
  3738     05  BBILCDI PIC  X(0001).
  3739*    -------------------------------
  3740     05  BUNWRITL PIC S9(0004) COMP.
  3741     05  BUNWRITF PIC  X(0001).
  3742     05  FILLER REDEFINES BUNWRITF.
  3743         10  BUNWRITA PIC  X(0001).
  3744     05  BUNWRITI PIC  X(0001).
  3745*    -------------------------------
  3746     05  BSKPCDL PIC S9(0004) COMP.
  3747     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  72
* EL6311.cbl
  3748     05  FILLER REDEFINES BSKPCDF.
  3749         10  BSKPCDA PIC  X(0001).
  3750     05  BSKPCDI PIC  X(0001).
  3751*    -------------------------------
  3752     05  BINDGRPL PIC S9(0004) COMP.
  3753     05  BINDGRPF PIC  X(0001).
  3754     05  FILLER REDEFINES BINDGRPF.
  3755         10  BINDGRPA PIC  X(0001).
  3756     05  BINDGRPI PIC  X(0001).
  3757*    -------------------------------
  3758     05  BSIGL PIC S9(0004) COMP.
  3759     05  BSIGF PIC  X(0001).
  3760     05  FILLER REDEFINES BSIGF.
  3761         10  BSIGA PIC  X(0001).
  3762     05  BSIGI PIC  X(0001).
  3763*    -------------------------------
  3764     05  BRTCLSL PIC S9(0004) COMP.
  3765     05  BRTCLSF PIC  X(0001).
  3766     05  FILLER REDEFINES BRTCLSF.
  3767         10  BRTCLSA PIC  X(0001).
  3768     05  BRTCLSI PIC  X(0002).
  3769*    -------------------------------
  3770     05  BCHGCNTL PIC S9(0004) COMP.
  3771     05  BCHGCNTF PIC  X(0001).
  3772     05  FILLER REDEFINES BCHGCNTF.
  3773         10  BCHGCNTA PIC  X(0001).
  3774     05  BCHGCNTI PIC  X(0003).
  3775*    -------------------------------
  3776     05  BMEMBERL PIC S9(0004) COMP.
  3777     05  BMEMBERF PIC  X(0001).
  3778     05  FILLER REDEFINES BMEMBERF.
  3779         10  BMEMBERA PIC  X(0001).
  3780     05  BMEMBERI PIC  X(0012).
  3781*    -------------------------------
  3782     05  BORGNOL PIC S9(0004) COMP.
  3783     05  BORGNOF PIC  X(0001).
  3784     05  FILLER REDEFINES BORGNOF.
  3785         10  BORGNOA PIC  X(0001).
  3786     05  BORGNOI PIC  X(0006).
  3787*    -------------------------------
  3788     05  BORGSEQL PIC S9(0004) COMP.
  3789     05  BORGSEQF PIC  X(0001).
  3790     05  FILLER REDEFINES BORGSEQF.
  3791         10  BORGSEQA PIC  X(0001).
  3792     05  BORGSEQI PIC  X(0004).
  3793*    -------------------------------
  3794     05  BBILLEDL PIC S9(0004) COMP.
  3795     05  BBILLEDF PIC  X(0001).
  3796     05  FILLER REDEFINES BBILLEDF.
  3797         10  BBILLEDA PIC  X(0001).
  3798     05  BBILLEDI PIC  9(9).
  3799*    -------------------------------
  3800     05  BKIND1L PIC S9(0004) COMP.
  3801     05  BKIND1F PIC  X(0001).
  3802     05  FILLER REDEFINES BKIND1F.
  3803         10  BKIND1A PIC  X(0001).
  3804     05  BKIND1I PIC  X(0002).
  3805*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  73
* EL6311.cbl
  3806     05  BTYPE1L PIC S9(0004) COMP.
  3807     05  BTYPE1F PIC  X(0001).
  3808     05  FILLER REDEFINES BTYPE1F.
  3809         10  BTYPE1A PIC  X(0001).
  3810     05  BTYPE1I PIC  X(0003).
  3811*    -------------------------------
  3812     05  BTERM1L PIC S9(0004) COMP.
  3813     05  BTERM1F PIC  X(0001).
  3814     05  FILLER REDEFINES BTERM1F.
  3815         10  BTERM1A PIC  X(0001).
  3816     05  BTERM1I PIC  X(0003).
  3817*    -------------------------------
  3818     05  BBEN1L PIC S9(0004) COMP.
  3819     05  BBEN1F PIC  X(0001).
  3820     05  FILLER REDEFINES BBEN1F.
  3821         10  BBEN1A PIC  X(0001).
  3822     05  BBEN1I PIC  X(0012).
  3823*    -------------------------------
  3824     05  BPREM1L PIC S9(0004) COMP.
  3825     05  BPREM1F PIC  X(0001).
  3826     05  FILLER REDEFINES BPREM1F.
  3827         10  BPREM1A PIC  X(0001).
  3828     05  BPREM1I PIC  X(0011).
  3829*    -------------------------------
  3830     05  BEXPIR1L PIC S9(0004) COMP.
  3831     05  BEXPIR1F PIC  X(0001).
  3832     05  FILLER REDEFINES BEXPIR1F.
  3833         10  BEXPIR1A PIC  X(0001).
  3834     05  BEXPIR1I PIC  X(0008).
  3835*    -------------------------------
  3836     05  BCP1L PIC S9(0004) COMP.
  3837     05  BCP1F PIC  X(0001).
  3838     05  FILLER REDEFINES BCP1F.
  3839         10  BCP1A PIC  X(0001).
  3840     05  BCP1I PIC  X(0002).
  3841*    -------------------------------
  3842     05  BALTBN1L PIC S9(0004) COMP.
  3843     05  BALTBN1F PIC  X(0001).
  3844     05  FILLER REDEFINES BALTBN1F.
  3845         10  BALTBN1A PIC  X(0001).
  3846     05  BALTBN1I PIC  X(0012).
  3847*    -------------------------------
  3848     05  BALTPR1L PIC S9(0004) COMP.
  3849     05  BALTPR1F PIC  X(0001).
  3850     05  FILLER REDEFINES BALTPR1F.
  3851         10  BALTPR1A PIC  X(0001).
  3852     05  BALTPR1I PIC  X(0011).
  3853*    -------------------------------
  3854     05  BBNCD1L PIC S9(0004) COMP.
  3855     05  BBNCD1F PIC  X(0001).
  3856     05  FILLER REDEFINES BBNCD1F.
  3857         10  BBNCD1A PIC  X(0001).
  3858     05  BBNCD1I PIC  X(0003).
  3859*    -------------------------------
  3860     05  BCPRM1L PIC S9(0004) COMP.
  3861     05  BCPRM1F PIC  X(0001).
  3862     05  FILLER REDEFINES BCPRM1F.
  3863         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  74
* EL6311.cbl
  3864     05  BCPRM1I PIC  X(0011).
  3865*    -------------------------------
  3866     05  BCAPRM1L PIC S9(0004) COMP.
  3867     05  BCAPRM1F PIC  X(0001).
  3868     05  FILLER REDEFINES BCAPRM1F.
  3869         10  BCAPRM1A PIC  X(0001).
  3870     05  BCAPRM1I PIC  X(0011).
  3871*    -------------------------------
  3872     05  BENABR1L PIC S9(0004) COMP.
  3873     05  BENABR1F PIC  X(0001).
  3874     05  FILLER REDEFINES BENABR1F.
  3875         10  BENABR1A PIC  X(0001).
  3876     05  BENABR1I PIC  X(0005).
  3877*    -------------------------------
  3878     05  BDIFF1L PIC S9(0004) COMP.
  3879     05  BDIFF1F PIC  X(0001).
  3880     05  FILLER REDEFINES BDIFF1F.
  3881         10  BDIFF1A PIC  X(0001).
  3882     05  BDIFF1I PIC  X(0011).
  3883*    -------------------------------
  3884     05  BBILIT1L PIC S9(0004) COMP.
  3885     05  BBILIT1F PIC  X(0001).
  3886     05  FILLER REDEFINES BBILIT1F.
  3887         10  BBILIT1A PIC  X(0001).
  3888     05  BBILIT1I PIC  X(0008).
  3889*    -------------------------------
  3890     05  BADIFF1L PIC S9(0004) COMP.
  3891     05  BADIFF1F PIC  X(0001).
  3892     05  FILLER REDEFINES BADIFF1F.
  3893         10  BADIFF1A PIC  X(0001).
  3894     05  BADIFF1I PIC  X(0011).
  3895*    -------------------------------
  3896     05  BKIND2L PIC S9(0004) COMP.
  3897     05  BKIND2F PIC  X(0001).
  3898     05  FILLER REDEFINES BKIND2F.
  3899         10  BKIND2A PIC  X(0001).
  3900     05  BKIND2I PIC  X(0002).
  3901*    -------------------------------
  3902     05  BTYPE2L PIC S9(0004) COMP.
  3903     05  BTYPE2F PIC  X(0001).
  3904     05  FILLER REDEFINES BTYPE2F.
  3905         10  BTYPE2A PIC  X(0001).
  3906     05  BTYPE2I PIC  X(0003).
  3907*    -------------------------------
  3908     05  BTERM2L PIC S9(0004) COMP.
  3909     05  BTERM2F PIC  X(0001).
  3910     05  FILLER REDEFINES BTERM2F.
  3911         10  BTERM2A PIC  X(0001).
  3912     05  BTERM2I PIC  X(0003).
  3913*    -------------------------------
  3914     05  BBEN2L PIC S9(0004) COMP.
  3915     05  BBEN2F PIC  X(0001).
  3916     05  FILLER REDEFINES BBEN2F.
  3917         10  BBEN2A PIC  X(0001).
  3918     05  BBEN2I PIC  X(0012).
  3919*    -------------------------------
  3920     05  BPREM2L PIC S9(0004) COMP.
  3921     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  75
* EL6311.cbl
  3922     05  FILLER REDEFINES BPREM2F.
  3923         10  BPREM2A PIC  X(0001).
  3924     05  BPREM2I PIC  X(0011).
  3925*    -------------------------------
  3926     05  BEXPIR2L PIC S9(0004) COMP.
  3927     05  BEXPIR2F PIC  X(0001).
  3928     05  FILLER REDEFINES BEXPIR2F.
  3929         10  BEXPIR2A PIC  X(0001).
  3930     05  BEXPIR2I PIC  X(0008).
  3931*    -------------------------------
  3932     05  BCP2L PIC S9(0004) COMP.
  3933     05  BCP2F PIC  X(0001).
  3934     05  FILLER REDEFINES BCP2F.
  3935         10  BCP2A PIC  X(0001).
  3936     05  BCP2I PIC  X(0002).
  3937*    -------------------------------
  3938     05  BALTBN2L PIC S9(0004) COMP.
  3939     05  BALTBN2F PIC  X(0001).
  3940     05  FILLER REDEFINES BALTBN2F.
  3941         10  BALTBN2A PIC  X(0001).
  3942     05  BALTBN2I PIC  X(0012).
  3943*    -------------------------------
  3944     05  BALTPR2L PIC S9(0004) COMP.
  3945     05  BALTPR2F PIC  X(0001).
  3946     05  FILLER REDEFINES BALTPR2F.
  3947         10  BALTPR2A PIC  X(0001).
  3948     05  BALTPR2I PIC  X(0011).
  3949*    -------------------------------
  3950     05  BBNCD2L PIC S9(0004) COMP.
  3951     05  BBNCD2F PIC  X(0001).
  3952     05  FILLER REDEFINES BBNCD2F.
  3953         10  BBNCD2A PIC  X(0001).
  3954     05  BBNCD2I PIC  X(0003).
  3955*    -------------------------------
  3956     05  BCPRM2L PIC S9(0004) COMP.
  3957     05  BCPRM2F PIC  X(0001).
  3958     05  FILLER REDEFINES BCPRM2F.
  3959         10  BCPRM2A PIC  X(0001).
  3960     05  BCPRM2I PIC  X(0011).
  3961*    -------------------------------
  3962     05  BCAPRM2L PIC S9(0004) COMP.
  3963     05  BCAPRM2F PIC  X(0001).
  3964     05  FILLER REDEFINES BCAPRM2F.
  3965         10  BCAPRM2A PIC  X(0001).
  3966     05  BCAPRM2I PIC  X(0011).
  3967*    -------------------------------
  3968     05  BENABR2L PIC S9(0004) COMP.
  3969     05  BENABR2F PIC  X(0001).
  3970     05  FILLER REDEFINES BENABR2F.
  3971         10  BENABR2A PIC  X(0001).
  3972     05  BENABR2I PIC  X(0005).
  3973*    -------------------------------
  3974     05  BDIFF2L PIC S9(0004) COMP.
  3975     05  BDIFF2F PIC  X(0001).
  3976     05  FILLER REDEFINES BDIFF2F.
  3977         10  BDIFF2A PIC  X(0001).
  3978     05  BDIFF2I PIC  X(0011).
  3979*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  76
* EL6311.cbl
  3980     05  BBILIT2L PIC S9(0004) COMP.
  3981     05  BBILIT2F PIC  X(0001).
  3982     05  FILLER REDEFINES BBILIT2F.
  3983         10  BBILIT2A PIC  X(0001).
  3984     05  BBILIT2I PIC  X(0008).
  3985*    -------------------------------
  3986     05  BADIFF2L PIC S9(0004) COMP.
  3987     05  BADIFF2F PIC  X(0001).
  3988     05  FILLER REDEFINES BADIFF2F.
  3989         10  BADIFF2A PIC  X(0001).
  3990     05  BADIFF2I PIC  X(0011).
  3991*    -------------------------------
  3992     05  BERMSG1L PIC S9(0004) COMP.
  3993     05  BERMSG1F PIC  X(0001).
  3994     05  FILLER REDEFINES BERMSG1F.
  3995         10  BERMSG1A PIC  X(0001).
  3996     05  BERMSG1I PIC  X(0078).
  3997*    -------------------------------
  3998     05  BERMSG2L PIC S9(0004) COMP.
  3999     05  BERMSG2F PIC  X(0001).
  4000     05  FILLER REDEFINES BERMSG2F.
  4001         10  BERMSG2A PIC  X(0001).
  4002     05  BERMSG2I PIC  X(0078).
  4003*    -------------------------------
  4004     05  BERMSG3L PIC S9(0004) COMP.
  4005     05  BERMSG3F PIC  X(0001).
  4006     05  FILLER REDEFINES BERMSG3F.
  4007         10  BERMSG3A PIC  X(0001).
  4008     05  BERMSG3I PIC  X(0078).
  4009*    -------------------------------
  4010     05  BPFENTRL PIC S9(0004) COMP.
  4011     05  BPFENTRF PIC  X(0001).
  4012     05  FILLER REDEFINES BPFENTRF.
  4013         10  BPFENTRA PIC  X(0001).
  4014     05  BPFENTRI PIC  9(2).
  4015*    -------------------------------
  4016     05  BPF5HDRL PIC S9(0004) COMP.
  4017     05  BPF5HDRF PIC  X(0001).
  4018     05  FILLER REDEFINES BPF5HDRF.
  4019         10  BPF5HDRA PIC  X(0001).
  4020     05  BPF5HDRI PIC  X(0005).
  4021*    -------------------------------
  4022     05  BPF4HDRL PIC S9(0004) COMP.
  4023     05  BPF4HDRF PIC  X(0001).
  4024     05  FILLER REDEFINES BPF4HDRF.
  4025         10  BPF4HDRA PIC  X(0001).
  4026     05  BPF4HDRI PIC  X(0013).
  4027*    -------------------------------
  4028     05  BF15HDRL PIC S9(0004) COMP.
  4029     05  BF15HDRF PIC  X(0001).
  4030     05  FILLER REDEFINES BF15HDRF.
  4031         10  BF15HDRA PIC  X(0001).
  4032     05  BF15HDRI PIC  X(0010).
  4033 01  EL631BO REDEFINES EL631BI.
  4034     05  FILLER            PIC  X(0012).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  77
* EL6311.cbl
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BTIMEO PIC  99.99.
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BHEADO PIC  X(0038).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BNCERTLO PIC  X(0008).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BNCERTO PIC  X(0011).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BNSTATLO PIC  X(0009).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BNSTATO PIC  X(0002).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BCHGTO PIC  X(0004).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BCHGO PIC  ZZZ9.
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BCOMPIDO PIC  X(0003).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BREGIONO PIC  X(0006).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BUSERO PIC  X(0004).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BMAINTO PIC  X(0001).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BMANTBYO PIC  X(0004).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BCHGHDGO PIC  X(0003).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BMANTDTO PIC  X(0008).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BMANTATO PIC  99.99.
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BCSRO PIC  X(0004).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BBATCHO PIC  X(0006).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BSEQO PIC  X(0004).
  4095*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  78
* EL6311.cbl
  4096     05  FILLER            PIC  X(0003).
  4097     05  BMOENDTO PIC  X(0008).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BCARRO PIC  X(0001).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BGROUPO PIC  X(0006).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BSTATEO PIC  X(0002).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BACCTO PIC  X(0010).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BVINHO PIC  X(0004).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BVINO PIC  X(0017).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BREFHDGO PIC  X(0004).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BREFO PIC  X(0012).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BAGEDEFO PIC  X(0004).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BCERTNOO PIC  X(0010).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BSUFIXO PIC  X(0001).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BEFFDTO PIC  X(0008).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BLSTNMO PIC  X(0015).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  B1STNMO PIC  X(0010).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BINITO PIC  X(0001).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BSEXO PIC  X(0001).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BAGEO PIC  X(0002).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BBIRTHO PIC  X(0008).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  79
* EL6311.cbl
  4154     05  B1STPMTO PIC  X(0008).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BDAYSO PIC  X(0003).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BLNTRMO PIC  X(0003).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BLNOFCRO PIC  X(0005).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BMODEO PIC  X(0001).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BFREQO PIC  X(0002).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BPMTSO PIC  X(0003).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BPMTAMTO PIC  ZZZZZ9.99.
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BAPRO PIC  99.9999.
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BMEMCAPO PIC  X(0011).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BORIGHDO PIC  X(0009).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  DMDBILO PIC  X(0006).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BFORCEO PIC  X(0001).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BENTRYO PIC  X(0001).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BREINO PIC  X(0001).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BBILCDO PIC  X(0001).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BUNWRITO PIC  X(0001).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BSKPCDO PIC  X(0001).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  80
* EL6311.cbl
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BSIGO PIC  X(0001).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BRTCLSO PIC  X(0002).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BCHGCNTO PIC  X(0003).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BMEMBERO PIC  X(0012).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BORGNOO PIC  X(0006).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BORGSEQO PIC  X(0004).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BKIND1O PIC  X(0002).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BTYPE1O PIC  X(0003).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BTERM1O PIC  X(0003).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BBEN1O PIC  X(0012).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BPREM1O PIC  X(0011).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BEXPIR1O PIC  X(0008).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BCP1O PIC  X(0002).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BALTBN1O PIC  X(0012).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BALTPR1O PIC  X(0011).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BBNCD1O PIC  X(0003).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BCPRM1O PIC  X(0011).
  4266*    -------------------------------
  4267     05  FILLER            PIC  X(0003).
  4268     05  BCAPRM1O PIC  X(0011).
  4269*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  81
* EL6311.cbl
  4270     05  FILLER            PIC  X(0003).
  4271     05  BENABR1O PIC  X(0005).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BDIFF1O PIC  X(0011).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BBILIT1O PIC  X(0008).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BADIFF1O PIC  X(0011).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BKIND2O PIC  X(0002).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BTYPE2O PIC  X(0003).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BTERM2O PIC  X(0003).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BBEN2O PIC  X(0012).
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BPREM2O PIC  X(0011).
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BEXPIR2O PIC  X(0008).
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BCP2O PIC  X(0002).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BALTBN2O PIC  X(0012).
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
  4307     05  BALTPR2O PIC  X(0011).
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BBNCD2O PIC  X(0003).
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BCPRM2O PIC  X(0011).
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BCAPRM2O PIC  X(0011).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  BENABR2O PIC  X(0005).
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  BDIFF2O PIC  X(0011).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
  4325     05  BBILIT2O PIC  X(0008).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  82
* EL6311.cbl
  4328     05  BADIFF2O PIC  X(0011).
  4329*    -------------------------------
  4330     05  FILLER            PIC  X(0003).
  4331     05  BERMSG1O PIC  X(0078).
  4332*    -------------------------------
  4333     05  FILLER            PIC  X(0003).
  4334     05  BERMSG2O PIC  X(0078).
  4335*    -------------------------------
  4336     05  FILLER            PIC  X(0003).
  4337     05  BERMSG3O PIC  X(0078).
  4338*    -------------------------------
  4339     05  FILLER            PIC  X(0003).
  4340     05  BPFENTRO PIC  X(0002).
  4341*    -------------------------------
  4342     05  FILLER            PIC  X(0003).
  4343     05  BPF5HDRO PIC  X(0005).
  4344*    -------------------------------
  4345     05  FILLER            PIC  X(0003).
  4346     05  BPF4HDRO PIC  X(0013).
  4347*    -------------------------------
  4348     05  FILLER            PIC  X(0003).
  4349     05  BF15HDRO PIC  X(0010).
  4350*    -------------------------------
  4351 01  EL631CI REDEFINES EL631BI.
  4352     05  FILLER            PIC  X(0012).
  4353*    -------------------------------
  4354     05  CDATEL PIC S9(0004) COMP.
  4355     05  CDATEF PIC  X(0001).
  4356     05  FILLER REDEFINES CDATEF.
  4357         10  CDATEA PIC  X(0001).
  4358     05  CDATEI PIC  X(0008).
  4359*    -------------------------------
  4360     05  CTIMEL PIC S9(0004) COMP.
  4361     05  CTIMEF PIC  X(0001).
  4362     05  FILLER REDEFINES CTIMEF.
  4363         10  CTIMEA PIC  X(0001).
  4364     05  CTIMEI PIC  X(0005).
  4365*    -------------------------------
  4366     05  CHEADL PIC S9(0004) COMP.
  4367     05  CHEADF PIC  X(0001).
  4368     05  FILLER REDEFINES CHEADF.
  4369         10  CHEADA PIC  X(0001).
  4370     05  CHEADI PIC  X(0038).
  4371*    -------------------------------
  4372     05  CCHGTL PIC S9(0004) COMP.
  4373     05  CCHGTF PIC  X(0001).
  4374     05  FILLER REDEFINES CCHGTF.
  4375         10  CCHGTA PIC  X(0001).
  4376     05  CCHGTI PIC  X(0004).
  4377*    -------------------------------
  4378     05  CCHGL PIC S9(0004) COMP.
  4379     05  CCHGF PIC  X(0001).
  4380     05  FILLER REDEFINES CCHGF.
  4381         10  CCHGA PIC  X(0001).
  4382     05  CCHGI PIC  X(0004).
  4383*    -------------------------------
  4384     05  CMAINTL PIC S9(0004) COMP.
  4385     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  83
* EL6311.cbl
  4386     05  FILLER REDEFINES CMAINTF.
  4387         10  CMAINTA PIC  X(0001).
  4388     05  CMAINTI PIC  X(0001).
  4389*    -------------------------------
  4390     05  CMANTBYL PIC S9(0004) COMP.
  4391     05  CMANTBYF PIC  X(0001).
  4392     05  FILLER REDEFINES CMANTBYF.
  4393         10  CMANTBYA PIC  X(0001).
  4394     05  CMANTBYI PIC  X(0004).
  4395*    -------------------------------
  4396     05  CCHGHDGL PIC S9(0004) COMP.
  4397     05  CCHGHDGF PIC  X(0001).
  4398     05  FILLER REDEFINES CCHGHDGF.
  4399         10  CCHGHDGA PIC  X(0001).
  4400     05  CCHGHDGI PIC  X(0003).
  4401*    -------------------------------
  4402     05  CMANTDTL PIC S9(0004) COMP.
  4403     05  CMANTDTF PIC  X(0001).
  4404     05  FILLER REDEFINES CMANTDTF.
  4405         10  CMANTDTA PIC  X(0001).
  4406     05  CMANTDTI PIC  X(0008).
  4407*    -------------------------------
  4408     05  CMANTATL PIC S9(0004) COMP.
  4409     05  CMANTATF PIC  X(0001).
  4410     05  FILLER REDEFINES CMANTATF.
  4411         10  CMANTATA PIC  X(0001).
  4412     05  CMANTATI PIC  X(0005).
  4413*    -------------------------------
  4414     05  CCSRL PIC S9(0004) COMP.
  4415     05  CCSRF PIC  X(0001).
  4416     05  FILLER REDEFINES CCSRF.
  4417         10  CCSRA PIC  X(0001).
  4418     05  CCSRI PIC  X(0004).
  4419*    -------------------------------
  4420     05  CBATCHL PIC S9(0004) COMP.
  4421     05  CBATCHF PIC  X(0001).
  4422     05  FILLER REDEFINES CBATCHF.
  4423         10  CBATCHA PIC  X(0001).
  4424     05  CBATCHI PIC  X(0006).
  4425*    -------------------------------
  4426     05  CSEQL PIC S9(0004) COMP.
  4427     05  CSEQF PIC  X(0001).
  4428     05  FILLER REDEFINES CSEQF.
  4429         10  CSEQA PIC  X(0001).
  4430     05  CSEQI PIC  X(0004).
  4431*    -------------------------------
  4432     05  CMOENDTL PIC S9(0004) COMP.
  4433     05  CMOENDTF PIC  X(0001).
  4434     05  FILLER REDEFINES CMOENDTF.
  4435         10  CMOENDTA PIC  X(0001).
  4436     05  CMOENDTI PIC  X(0008).
  4437*    -------------------------------
  4438     05  CCARRL PIC S9(0004) COMP.
  4439     05  CCARRF PIC  X(0001).
  4440     05  FILLER REDEFINES CCARRF.
  4441         10  CCARRA PIC  X(0001).
  4442     05  CCARRI PIC  X(0001).
  4443*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  84
* EL6311.cbl
  4444     05  CGROUPL PIC S9(0004) COMP.
  4445     05  CGROUPF PIC  X(0001).
  4446     05  FILLER REDEFINES CGROUPF.
  4447         10  CGROUPA PIC  X(0001).
  4448     05  CGROUPI PIC  X(0006).
  4449*    -------------------------------
  4450     05  CSTATEL PIC S9(0004) COMP.
  4451     05  CSTATEF PIC  X(0001).
  4452     05  FILLER REDEFINES CSTATEF.
  4453         10  CSTATEA PIC  X(0001).
  4454     05  CSTATEI PIC  X(0002).
  4455*    -------------------------------
  4456     05  CACCTL PIC S9(0004) COMP.
  4457     05  CACCTF PIC  X(0001).
  4458     05  FILLER REDEFINES CACCTF.
  4459         10  CACCTA PIC  X(0001).
  4460     05  CACCTI PIC  X(0010).
  4461*    -------------------------------
  4462     05  CORIGHDL PIC S9(0004) COMP.
  4463     05  CORIGHDF PIC  X(0001).
  4464     05  FILLER REDEFINES CORIGHDF.
  4465         10  CORIGHDA PIC  X(0001).
  4466     05  CORIGHDI PIC  X(0011).
  4467*    -------------------------------
  4468     05  CORGNOL PIC S9(0004) COMP.
  4469     05  CORGNOF PIC  X(0001).
  4470     05  FILLER REDEFINES CORGNOF.
  4471         10  CORGNOA PIC  X(0001).
  4472     05  CORGNOI PIC  X(0006).
  4473*    -------------------------------
  4474     05  CORGSEQL PIC S9(0004) COMP.
  4475     05  CORGSEQF PIC  X(0001).
  4476     05  FILLER REDEFINES CORGSEQF.
  4477         10  CORGSEQA PIC  X(0001).
  4478     05  CORGSEQI PIC  X(0004).
  4479*    -------------------------------
  4480     05  CREFHDGL PIC S9(0004) COMP.
  4481     05  CREFHDGF PIC  X(0001).
  4482     05  FILLER REDEFINES CREFHDGF.
  4483         10  CREFHDGA PIC  X(0001).
  4484     05  CREFHDGI PIC  X(0010).
  4485*    -------------------------------
  4486     05  CREFL PIC S9(0004) COMP.
  4487     05  CREFF PIC  X(0001).
  4488     05  FILLER REDEFINES CREFF.
  4489         10  CREFA PIC  X(0001).
  4490     05  CREFI PIC  X(0012).
  4491*    -------------------------------
  4492     05  CNHINTL PIC S9(0004) COMP.
  4493     05  CNHINTF PIC  X(0001).
  4494     05  FILLER REDEFINES CNHINTF.
  4495         10  CNHINTA PIC  X(0001).
  4496     05  CNHINTI PIC  9(7)V99.
  4497*    -------------------------------
  4498     05  CCERTNOL PIC S9(0004) COMP.
  4499     05  CCERTNOF PIC  X(0001).
  4500     05  FILLER REDEFINES CCERTNOF.
  4501         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  85
* EL6311.cbl
  4502     05  CCERTNOI PIC  X(0010).
  4503*    -------------------------------
  4504     05  CSUFIXL PIC S9(0004) COMP.
  4505     05  CSUFIXF PIC  X(0001).
  4506     05  FILLER REDEFINES CSUFIXF.
  4507         10  CSUFIXA PIC  X(0001).
  4508     05  CSUFIXI PIC  X(0001).
  4509*    -------------------------------
  4510     05  CEFFDTL PIC S9(0004) COMP.
  4511     05  CEFFDTF PIC  X(0001).
  4512     05  FILLER REDEFINES CEFFDTF.
  4513         10  CEFFDTA PIC  X(0001).
  4514     05  CEFFDTI PIC  X(0008).
  4515*    -------------------------------
  4516     05  CLSTNML PIC S9(0004) COMP.
  4517     05  CLSTNMF PIC  X(0001).
  4518     05  FILLER REDEFINES CLSTNMF.
  4519         10  CLSTNMA PIC  X(0001).
  4520     05  CLSTNMI PIC  X(0015).
  4521*    -------------------------------
  4522     05  CPCYNL PIC S9(0004) COMP.
  4523     05  CPCYNF PIC  X(0001).
  4524     05  FILLER REDEFINES CPCYNF.
  4525         10  CPCYNA PIC  X(0001).
  4526     05  CPCYNI PIC  X(0001).
  4527*    -------------------------------
  4528     05  CINAMEL PIC S9(0004) COMP.
  4529     05  CINAMEF PIC  X(0001).
  4530     05  FILLER REDEFINES CINAMEF.
  4531         10  CINAMEA PIC  X(0001).
  4532     05  CINAMEI PIC  X(0015).
  4533*    -------------------------------
  4534     05  CINITSL PIC S9(0004) COMP.
  4535     05  CINITSF PIC  X(0001).
  4536     05  FILLER REDEFINES CINITSF.
  4537         10  CINITSA PIC  X(0001).
  4538     05  CINITSI PIC  X(0010).
  4539*    -------------------------------
  4540     05  CCANREAL PIC S9(0004) COMP.
  4541     05  CCANREAF PIC  X(0001).
  4542     05  FILLER REDEFINES CCANREAF.
  4543         10  CCANREAA PIC  X(0001).
  4544     05  CCANREAI PIC  X(0001).
  4545*    -------------------------------
  4546     05  CKIND1L PIC S9(0004) COMP.
  4547     05  CKIND1F PIC  X(0001).
  4548     05  FILLER REDEFINES CKIND1F.
  4549         10  CKIND1A PIC  X(0001).
  4550     05  CKIND1I PIC  X(0002).
  4551*    -------------------------------
  4552     05  CCANDT1L PIC S9(0004) COMP.
  4553     05  CCANDT1F PIC  X(0001).
  4554     05  FILLER REDEFINES CCANDT1F.
  4555         10  CCANDT1A PIC  X(0001).
  4556     05  CCANDT1I PIC  X(0008).
  4557*    -------------------------------
  4558     05  CREFND1L PIC S9(0004) COMP.
  4559     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  86
* EL6311.cbl
  4560     05  FILLER REDEFINES CREFND1F.
  4561         10  CREFND1A PIC  X(0001).
  4562     05  CREFND1I PIC  S9(9)V99.
  4563*    -------------------------------
  4564     05  CMTHD1L PIC S9(0004) COMP.
  4565     05  CMTHD1F PIC  X(0001).
  4566     05  FILLER REDEFINES CMTHD1F.
  4567         10  CMTHD1A PIC  X(0001).
  4568     05  CMTHD1I PIC  X(0001).
  4569*    -------------------------------
  4570     05  CKIND2L PIC S9(0004) COMP.
  4571     05  CKIND2F PIC  X(0001).
  4572     05  FILLER REDEFINES CKIND2F.
  4573         10  CKIND2A PIC  X(0001).
  4574     05  CKIND2I PIC  X(0002).
  4575*    -------------------------------
  4576     05  CCANDT2L PIC S9(0004) COMP.
  4577     05  CCANDT2F PIC  X(0001).
  4578     05  FILLER REDEFINES CCANDT2F.
  4579         10  CCANDT2A PIC  X(0001).
  4580     05  CCANDT2I PIC  X(0008).
  4581*    -------------------------------
  4582     05  CREFND2L PIC S9(0004) COMP.
  4583     05  CREFND2F PIC  X(0001).
  4584     05  FILLER REDEFINES CREFND2F.
  4585         10  CREFND2A PIC  X(0001).
  4586     05  CREFND2I PIC  S9(9)V99.
  4587*    -------------------------------
  4588     05  CMTHD2L PIC S9(0004) COMP.
  4589     05  CMTHD2F PIC  X(0001).
  4590     05  FILLER REDEFINES CMTHD2F.
  4591         10  CMTHD2A PIC  X(0001).
  4592     05  CMTHD2I PIC  X(0001).
  4593*    -------------------------------
  4594     05  CLIVESL PIC S9(0004) COMP.
  4595     05  CLIVESF PIC  X(0001).
  4596     05  FILLER REDEFINES CLIVESF.
  4597         10  CLIVESA PIC  X(0001).
  4598     05  CLIVESI PIC  X(0003).
  4599*    -------------------------------
  4600     05  CFORCEL PIC S9(0004) COMP.
  4601     05  CFORCEF PIC  X(0001).
  4602     05  FILLER REDEFINES CFORCEF.
  4603         10  CFORCEA PIC  X(0001).
  4604     05  CFORCEI PIC  X(0001).
  4605*    -------------------------------
  4606     05  CBILCDL PIC S9(0004) COMP.
  4607     05  CBILCDF PIC  X(0001).
  4608     05  FILLER REDEFINES CBILCDF.
  4609         10  CBILCDA PIC  X(0001).
  4610     05  CBILCDI PIC  X(0001).
  4611*    -------------------------------
  4612     05  CCRFND1L PIC S9(0004) COMP.
  4613     05  CCRFND1F PIC  X(0001).
  4614     05  FILLER REDEFINES CCRFND1F.
  4615         10  CCRFND1A PIC  X(0001).
  4616     05  CCRFND1I PIC  X(0011).
  4617*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  87
* EL6311.cbl
  4618     05  CCRFND2L PIC S9(0004) COMP.
  4619     05  CCRFND2F PIC  X(0001).
  4620     05  FILLER REDEFINES CCRFND2F.
  4621         10  CCRFND2A PIC  X(0001).
  4622     05  CCRFND2I PIC  X(0011).
  4623*    -------------------------------
  4624     05  CBILIT1L PIC S9(0004) COMP.
  4625     05  CBILIT1F PIC  X(0001).
  4626     05  FILLER REDEFINES CBILIT1F.
  4627         10  CBILIT1A PIC  X(0001).
  4628     05  CBILIT1I PIC  X(0008).
  4629*    -------------------------------
  4630     05  CDRFND1L PIC S9(0004) COMP.
  4631     05  CDRFND1F PIC  X(0001).
  4632     05  FILLER REDEFINES CDRFND1F.
  4633         10  CDRFND1A PIC  X(0001).
  4634     05  CDRFND1I PIC  X(0011).
  4635*    -------------------------------
  4636     05  CBILIT2L PIC S9(0004) COMP.
  4637     05  CBILIT2F PIC  X(0001).
  4638     05  FILLER REDEFINES CBILIT2F.
  4639         10  CBILIT2A PIC  X(0001).
  4640     05  CBILIT2I PIC  X(0008).
  4641*    -------------------------------
  4642     05  CDRFND2L PIC S9(0004) COMP.
  4643     05  CDRFND2F PIC  X(0001).
  4644     05  FILLER REDEFINES CDRFND2F.
  4645         10  CDRFND2A PIC  X(0001).
  4646     05  CDRFND2I PIC  X(0011).
  4647*    -------------------------------
  4648     05  CCANTXTL PIC S9(0004) COMP.
  4649     05  CCANTXTF PIC  X(0001).
  4650     05  FILLER REDEFINES CCANTXTF.
  4651         10  CCANTXTA PIC  X(0001).
  4652     05  CCANTXTI PIC  X(0005).
  4653*    -------------------------------
  4654     05  CCANFEEL PIC S9(0004) COMP.
  4655     05  CCANFEEF PIC  X(0001).
  4656     05  FILLER REDEFINES CCANFEEF.
  4657         10  CCANFEEA PIC  X(0001).
  4658     05  CCANFEEI PIC  X(0002).
  4659*    -------------------------------
  4660     05  CTERM1L PIC S9(0004) COMP.
  4661     05  CTERM1F PIC  X(0001).
  4662     05  FILLER REDEFINES CTERM1F.
  4663         10  CTERM1A PIC  X(0001).
  4664     05  CTERM1I PIC  X(0003).
  4665*    -------------------------------
  4666     05  CRTERM1L PIC S9(0004) COMP.
  4667     05  CRTERM1F PIC  X(0001).
  4668     05  FILLER REDEFINES CRTERM1F.
  4669         10  CRTERM1A PIC  X(0001).
  4670     05  CRTERM1I PIC  X(0003).
  4671*    -------------------------------
  4672     05  CPREM1L PIC S9(0004) COMP.
  4673     05  CPREM1F PIC  X(0001).
  4674     05  FILLER REDEFINES CPREM1F.
  4675         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  88
* EL6311.cbl
  4676     05  CPREM1I PIC  X(0011).
  4677*    -------------------------------
  4678     05  CTERM2L PIC S9(0004) COMP.
  4679     05  CTERM2F PIC  X(0001).
  4680     05  FILLER REDEFINES CTERM2F.
  4681         10  CTERM2A PIC  X(0001).
  4682     05  CTERM2I PIC  X(0003).
  4683*    -------------------------------
  4684     05  CRTERM2L PIC S9(0004) COMP.
  4685     05  CRTERM2F PIC  X(0001).
  4686     05  FILLER REDEFINES CRTERM2F.
  4687         10  CRTERM2A PIC  X(0001).
  4688     05  CRTERM2I PIC  X(0003).
  4689*    -------------------------------
  4690     05  CPREM2L PIC S9(0004) COMP.
  4691     05  CPREM2F PIC  X(0001).
  4692     05  FILLER REDEFINES CPREM2F.
  4693         10  CPREM2A PIC  X(0001).
  4694     05  CPREM2I PIC  X(0011).
  4695*    -------------------------------
  4696     05  CENTRDTL PIC S9(0004) COMP.
  4697     05  CENTRDTF PIC  X(0001).
  4698     05  FILLER REDEFINES CENTRDTF.
  4699         10  CENTRDTA PIC  X(0001).
  4700     05  CENTRDTI PIC  X(0008).
  4701*    -------------------------------
  4702     05  CPAYEEL PIC S9(0004) COMP.
  4703     05  CPAYEEF PIC  X(0001).
  4704     05  FILLER REDEFINES CPAYEEF.
  4705         10  CPAYEEA PIC  X(0001).
  4706     05  CPAYEEI PIC  X(0006).
  4707*    -------------------------------
  4708     05  CRFNDSWL PIC S9(0004) COMP.
  4709     05  CRFNDSWF PIC  X(0001).
  4710     05  FILLER REDEFINES CRFNDSWF.
  4711         10  CRFNDSWA PIC  X(0001).
  4712     05  CRFNDSWI PIC  X(0003).
  4713*    -------------------------------
  4714     05  CLFHDGL PIC S9(0004) COMP.
  4715     05  CLFHDGF PIC  X(0001).
  4716     05  FILLER REDEFINES CLFHDGF.
  4717         10  CLFHDGA PIC  X(0001).
  4718     05  CLFHDGI PIC  X(0006).
  4719*    -------------------------------
  4720     05  CAHHDGL PIC S9(0004) COMP.
  4721     05  CAHHDGF PIC  X(0001).
  4722     05  FILLER REDEFINES CAHHDGF.
  4723         10  CAHHDGA PIC  X(0001).
  4724     05  CAHHDGI PIC  X(0006).
  4725*    -------------------------------
  4726     05  CENTDTL PIC S9(0004) COMP.
  4727     05  CENTDTF PIC  X(0001).
  4728     05  FILLER REDEFINES CENTDTF.
  4729         10  CENTDTA PIC  X(0001).
  4730     05  CENTDTI PIC  X(0008).
  4731*    -------------------------------
  4732     05  CENTBYL PIC S9(0004) COMP.
  4733     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  89
* EL6311.cbl
  4734     05  FILLER REDEFINES CENTBYF.
  4735         10  CENTBYA PIC  X(0001).
  4736     05  CENTBYI PIC  X(0004).
  4737*    -------------------------------
  4738     05  CCHGCNTL PIC S9(0004) COMP.
  4739     05  CCHGCNTF PIC  X(0001).
  4740     05  FILLER REDEFINES CCHGCNTF.
  4741         10  CCHGCNTA PIC  X(0001).
  4742     05  CCHGCNTI PIC  X(0003).
  4743*    -------------------------------
  4744     05  CLFREFNL PIC S9(0004) COMP.
  4745     05  CLFREFNF PIC  X(0001).
  4746     05  FILLER REDEFINES CLFREFNF.
  4747         10  CLFREFNA PIC  X(0001).
  4748     05  CLFREFNI PIC  X(0006).
  4749*    -------------------------------
  4750     05  CAHREFNL PIC S9(0004) COMP.
  4751     05  CAHREFNF PIC  X(0001).
  4752     05  FILLER REDEFINES CAHREFNF.
  4753         10  CAHREFNA PIC  X(0001).
  4754     05  CAHREFNI PIC  X(0006).
  4755*    -------------------------------
  4756     05  CREINCDL PIC S9(0004) COMP.
  4757     05  CREINCDF PIC  X(0001).
  4758     05  FILLER REDEFINES CREINCDF.
  4759         10  CREINCDA PIC  X(0001).
  4760     05  CREINCDI PIC  X(0003).
  4761*    -------------------------------
  4762     05  CAEFFDTL PIC S9(0004) COMP.
  4763     05  CAEFFDTF PIC  X(0001).
  4764     05  FILLER REDEFINES CAEFFDTF.
  4765         10  CAEFFDTA PIC  X(0001).
  4766     05  CAEFFDTI PIC  X(0008).
  4767*    -------------------------------
  4768     05  CAEXPDTL PIC S9(0004) COMP.
  4769     05  CAEXPDTF PIC  X(0001).
  4770     05  FILLER REDEFINES CAEXPDTF.
  4771         10  CAEXPDTA PIC  X(0001).
  4772     05  CAEXPDTI PIC  X(0008).
  4773*    -------------------------------
  4774     05  COMMLFL PIC S9(0004) COMP.
  4775     05  COMMLFF PIC  X(0001).
  4776     05  FILLER REDEFINES COMMLFF.
  4777         10  COMMLFA PIC  X(0001).
  4778     05  COMMLFI PIC  X(0006).
  4779*    -------------------------------
  4780     05  COMMAHL PIC S9(0004) COMP.
  4781     05  COMMAHF PIC  X(0001).
  4782     05  FILLER REDEFINES COMMAHF.
  4783         10  COMMAHA PIC  X(0001).
  4784     05  COMMAHI PIC  X(0006).
  4785*    -------------------------------
  4786     05  CERMSG1L PIC S9(0004) COMP.
  4787     05  CERMSG1F PIC  X(0001).
  4788     05  FILLER REDEFINES CERMSG1F.
  4789         10  CERMSG1A PIC  X(0001).
  4790     05  CERMSG1I PIC  X(0078).
  4791*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  90
* EL6311.cbl
  4792     05  CERMSG2L PIC S9(0004) COMP.
  4793     05  CERMSG2F PIC  X(0001).
  4794     05  FILLER REDEFINES CERMSG2F.
  4795         10  CERMSG2A PIC  X(0001).
  4796     05  CERMSG2I PIC  X(0078).
  4797*    -------------------------------
  4798     05  CERMSG3L PIC S9(0004) COMP.
  4799     05  CERMSG3F PIC  X(0001).
  4800     05  FILLER REDEFINES CERMSG3F.
  4801         10  CERMSG3A PIC  X(0001).
  4802     05  CERMSG3I PIC  X(0078).
  4803*    -------------------------------
  4804     05  CPFENTRL PIC S9(0004) COMP.
  4805     05  CPFENTRF PIC  X(0001).
  4806     05  FILLER REDEFINES CPFENTRF.
  4807         10  CPFENTRA PIC  X(0001).
  4808     05  CPFENTRI PIC  9(2).
  4809*    -------------------------------
  4810     05  CPF5HDRL PIC S9(0004) COMP.
  4811     05  CPF5HDRF PIC  X(0001).
  4812     05  FILLER REDEFINES CPF5HDRF.
  4813         10  CPF5HDRA PIC  X(0001).
  4814     05  CPF5HDRI PIC  X(0005).
  4815*    -------------------------------
  4816     05  CPF4HDRL PIC S9(0004) COMP.
  4817     05  CPF4HDRF PIC  X(0001).
  4818     05  FILLER REDEFINES CPF4HDRF.
  4819         10  CPF4HDRA PIC  X(0001).
  4820     05  CPF4HDRI PIC  X(0013).
  4821*    -------------------------------
  4822     05  CF15HDRL PIC S9(0004) COMP.
  4823     05  CF15HDRF PIC  X(0001).
  4824     05  FILLER REDEFINES CF15HDRF.
  4825         10  CF15HDRA PIC  X(0001).
  4826     05  CF15HDRI PIC  X(0022).
  4827 01  EL631CO REDEFINES EL631BI.
  4828     05  FILLER            PIC  X(0012).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CDATEO PIC  X(0008).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CTIMEO PIC  99.99.
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CHEADO PIC  X(0038).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CCHGTO PIC  X(0004).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CCHGO PIC  ZZZ9.
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CMAINTO PIC  X(0001).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  91
* EL6311.cbl
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CCHGHDGO PIC  X(0003).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CMANTDTO PIC  X(0008).
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CMANTATO PIC  99.99.
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CCSRO PIC  X(0004).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CBATCHO PIC  X(0006).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CSEQO PIC  X(0004).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CMOENDTO PIC  X(0008).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CCARRO PIC  X(0001).
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CGROUPO PIC  X(0006).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CSTATEO PIC  X(0002).
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CACCTO PIC  X(0010).
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CORIGHDO PIC  X(0011).
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CORGNOO PIC  X(0006).
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CORGSEQO PIC  X(0004).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CREFHDGO PIC  X(0010).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CREFO PIC  X(0012).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CNHINTO PIC  ZZZZZ9.99.
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CCERTNOO PIC  X(0010).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CSUFIXO PIC  X(0001).
  4907*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  92
* EL6311.cbl
  4908     05  FILLER            PIC  X(0003).
  4909     05  CEFFDTO PIC  X(0008).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CLSTNMO PIC  X(0015).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CPCYNO PIC  X(0001).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CINAMEO PIC  X(0015).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CINITSO PIC  X(0010).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CCANREAO PIC  X(0001).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CKIND1O PIC  X(0002).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CCANDT1O PIC  X(0008).
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CREFND1O PIC  Z(7).99-.
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CMTHD1O PIC  X(0001).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CKIND2O PIC  X(0002).
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CCANDT2O PIC  X(0008).
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CREFND2O PIC  Z(7).99-.
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CMTHD2O PIC  X(0001).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CLIVESO PIC  X(0003).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CFORCEO PIC  X(0001).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CBILCDO PIC  X(0001).
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CCRFND1O PIC  Z(7).99-.
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
  4963     05  CCRFND2O PIC  Z(7).99-.
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  93
* EL6311.cbl
  4966     05  CBILIT1O PIC  X(0008).
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CDRFND1O PIC  Z(7).99-.
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CBILIT2O PIC  X(0008).
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CDRFND2O PIC  Z(7).99-.
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CCANTXTO PIC  X(0005).
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CCANFEEO PIC  Z9.
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CTERM1O PIC  ZZ9.
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CRTERM1O PIC  ZZ9.
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CPREM1O PIC  ZZZZZZ9.99-.
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CTERM2O PIC  ZZ9.
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CRTERM2O PIC  ZZ9.
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CPREM2O PIC  ZZZZZZ9.99-.
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CENTRDTO PIC  X(0008).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CPAYEEO PIC  X(0006).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CRFNDSWO PIC  X(0003).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CLFHDGO PIC  X(0006).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CAHHDGO PIC  X(0006).
  5015*    -------------------------------
  5016     05  FILLER            PIC  X(0003).
  5017     05  CENTDTO PIC  X(0008).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  CENTBYO PIC  X(0004).
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  94
* EL6311.cbl
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CLFREFNO PIC  X(0006).
  5027*    -------------------------------
  5028     05  FILLER            PIC  X(0003).
  5029     05  CAHREFNO PIC  X(0006).
  5030*    -------------------------------
  5031     05  FILLER            PIC  X(0003).
  5032     05  CREINCDO PIC  X(0003).
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CAEFFDTO PIC  X(0008).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  CAEXPDTO PIC  X(0008).
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  COMMLFO PIC  .99999.
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  COMMAHO PIC  .99999.
  5045*    -------------------------------
  5046     05  FILLER            PIC  X(0003).
  5047     05  CERMSG1O PIC  X(0078).
  5048*    -------------------------------
  5049     05  FILLER            PIC  X(0003).
  5050     05  CERMSG2O PIC  X(0078).
  5051*    -------------------------------
  5052     05  FILLER            PIC  X(0003).
  5053     05  CERMSG3O PIC  X(0078).
  5054*    -------------------------------
  5055     05  FILLER            PIC  X(0003).
  5056     05  CPFENTRO PIC  X(0002).
  5057*    -------------------------------
  5058     05  FILLER            PIC  X(0003).
  5059     05  CPF5HDRO PIC  X(0005).
  5060*    -------------------------------
  5061     05  FILLER            PIC  X(0003).
  5062     05  CPF4HDRO PIC  X(0013).
  5063*    -------------------------------
  5064     05  FILLER            PIC  X(0003).
  5065     05  CF15HDRO PIC  X(0022).
  5066*    -------------------------------
  5067 01  EL631DI REDEFINES EL631BI.
  5068     05  FILLER            PIC  X(0012).
  5069*    -------------------------------
  5070     05  DDATEL PIC S9(0004) COMP.
  5071     05  DDATEF PIC  X(0001).
  5072     05  FILLER REDEFINES DDATEF.
  5073         10  DDATEA PIC  X(0001).
  5074     05  DDATEI PIC  X(0008).
  5075*    -------------------------------
  5076     05  DTIMEL PIC S9(0004) COMP.
  5077     05  DTIMEF PIC  X(0001).
  5078     05  FILLER REDEFINES DTIMEF.
  5079         10  DTIMEA PIC  X(0001).
  5080     05  DTIMEI PIC  X(0005).
  5081*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  95
* EL6311.cbl
  5082     05  DHEADL PIC S9(0004) COMP.
  5083     05  DHEADF PIC  X(0001).
  5084     05  FILLER REDEFINES DHEADF.
  5085         10  DHEADA PIC  X(0001).
  5086     05  DHEADI PIC  X(0038).
  5087*    -------------------------------
  5088     05  DLDATEL PIC S9(0004) COMP.
  5089     05  DLDATEF PIC  X(0001).
  5090     05  FILLER REDEFINES DLDATEF.
  5091         10  DLDATEA PIC  X(0001).
  5092     05  DLDATEI PIC  X(0010).
  5093*    -------------------------------
  5094     05  DBATCHL PIC S9(0004) COMP.
  5095     05  DBATCHF PIC  X(0001).
  5096     05  FILLER REDEFINES DBATCHF.
  5097         10  DBATCHA PIC  X(0001).
  5098     05  DBATCHI PIC  X(0011).
  5099*    -------------------------------
  5100     05  DACCTNML PIC S9(0004) COMP.
  5101     05  DACCTNMF PIC  X(0001).
  5102     05  FILLER REDEFINES DACCTNMF.
  5103         10  DACCTNMA PIC  X(0001).
  5104     05  DACCTNMI PIC  X(0030).
  5105*    -------------------------------
  5106     05  DPROCDTL PIC S9(0004) COMP.
  5107     05  DPROCDTF PIC  X(0001).
  5108     05  FILLER REDEFINES DPROCDTF.
  5109         10  DPROCDTA PIC  X(0001).
  5110     05  DPROCDTI PIC  X(0008).
  5111*    -------------------------------
  5112     05  DINPUTL PIC S9(0004) COMP.
  5113     05  DINPUTF PIC  X(0001).
  5114     05  FILLER REDEFINES DINPUTF.
  5115         10  DINPUTA PIC  X(0001).
  5116     05  DINPUTI PIC  X(0008).
  5117*    -------------------------------
  5118     05  DMAINDTL PIC S9(0004) COMP.
  5119     05  DMAINDTF PIC  X(0001).
  5120     05  FILLER REDEFINES DMAINDTF.
  5121         10  DMAINDTA PIC  X(0001).
  5122     05  DMAINDTI PIC  X(0008).
  5123*    -------------------------------
  5124     05  DCARRL PIC S9(0004) COMP.
  5125     05  DCARRF PIC  X(0001).
  5126     05  FILLER REDEFINES DCARRF.
  5127         10  DCARRA PIC  X(0001).
  5128     05  DCARRI PIC  X(0001).
  5129*    -------------------------------
  5130     05  DGROUPL PIC S9(0004) COMP.
  5131     05  DGROUPF PIC  X(0001).
  5132     05  FILLER REDEFINES DGROUPF.
  5133         10  DGROUPA PIC  X(0001).
  5134     05  DGROUPI PIC  X(0006).
  5135*    -------------------------------
  5136     05  DSTATEL PIC S9(0004) COMP.
  5137     05  DSTATEF PIC  X(0001).
  5138     05  FILLER REDEFINES DSTATEF.
  5139         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  96
* EL6311.cbl
  5140     05  DSTATEI PIC  X(0002).
  5141*    -------------------------------
  5142     05  DACCTL PIC S9(0004) COMP.
  5143     05  DACCTF PIC  X(0001).
  5144     05  FILLER REDEFINES DACCTF.
  5145         10  DACCTA PIC  X(0001).
  5146     05  DACCTI PIC  X(0010).
  5147*    -------------------------------
  5148     05  DRECVDTL PIC S9(0004) COMP.
  5149     05  DRECVDTF PIC  X(0001).
  5150     05  FILLER REDEFINES DRECVDTF.
  5151         10  DRECVDTA PIC  X(0001).
  5152     05  DRECVDTI PIC  X(0008).
  5153*    -------------------------------
  5154     05  DCSRL PIC S9(0004) COMP.
  5155     05  DCSRF PIC  X(0001).
  5156     05  FILLER REDEFINES DCSRF.
  5157         10  DCSRA PIC  X(0001).
  5158     05  DCSRI PIC  X(0004).
  5159*    -------------------------------
  5160     05  DREFHDGL PIC S9(0004) COMP.
  5161     05  DREFHDGF PIC  X(0001).
  5162     05  FILLER REDEFINES DREFHDGF.
  5163         10  DREFHDGA PIC  X(0001).
  5164     05  DREFHDGI PIC  X(0010).
  5165*    -------------------------------
  5166     05  DREFL PIC S9(0004) COMP.
  5167     05  DREFF PIC  X(0001).
  5168     05  FILLER REDEFINES DREFF.
  5169         10  DREFA PIC  X(0001).
  5170     05  DREFI PIC  X(0012).
  5171*    -------------------------------
  5172     05  DLFPHDGL PIC S9(0004) COMP.
  5173     05  DLFPHDGF PIC  X(0001).
  5174     05  FILLER REDEFINES DLFPHDGF.
  5175         10  DLFPHDGA PIC  X(0001).
  5176     05  DLFPHDGI PIC  X(0010).
  5177*    -------------------------------
  5178     05  DAHPHDGL PIC S9(0004) COMP.
  5179     05  DAHPHDGF PIC  X(0001).
  5180     05  FILLER REDEFINES DAHPHDGF.
  5181         10  DAHPHDGA PIC  X(0001).
  5182     05  DAHPHDGI PIC  X(0010).
  5183*    -------------------------------
  5184     05  DLFRHDGL PIC S9(0004) COMP.
  5185     05  DLFRHDGF PIC  X(0001).
  5186     05  FILLER REDEFINES DLFRHDGF.
  5187         10  DLFRHDGA PIC  X(0001).
  5188     05  DLFRHDGI PIC  X(0009).
  5189*    -------------------------------
  5190     05  DAHRHDGL PIC S9(0004) COMP.
  5191     05  DAHRHDGF PIC  X(0001).
  5192     05  FILLER REDEFINES DAHRHDGF.
  5193         10  DAHRHDGA PIC  X(0001).
  5194     05  DAHRHDGI PIC  X(0009).
  5195*    -------------------------------
  5196     05  DRISSL PIC S9(0004) COMP.
  5197     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  97
* EL6311.cbl
  5198     05  FILLER REDEFINES DRISSF.
  5199         10  DRISSA PIC  X(0001).
  5200     05  DRISSI PIC  X(0005).
  5201*    -------------------------------
  5202     05  DRLFPRML PIC S9(0004) COMP.
  5203     05  DRLFPRMF PIC  X(0001).
  5204     05  FILLER REDEFINES DRLFPRMF.
  5205         10  DRLFPRMA PIC  X(0001).
  5206     05  DRLFPRMI PIC  S9(9)V99.
  5207*    -------------------------------
  5208     05  DRAHPRML PIC S9(0004) COMP.
  5209     05  DRAHPRMF PIC  X(0001).
  5210     05  FILLER REDEFINES DRAHPRMF.
  5211         10  DRAHPRMA PIC  X(0001).
  5212     05  DRAHPRMI PIC  S9(9)V99.
  5213*    -------------------------------
  5214     05  DRCANCL PIC S9(0004) COMP.
  5215     05  DRCANCF PIC  X(0001).
  5216     05  FILLER REDEFINES DRCANCF.
  5217         10  DRCANCA PIC  X(0001).
  5218     05  DRCANCI PIC  X(0005).
  5219*    -------------------------------
  5220     05  DRLFRFDL PIC S9(0004) COMP.
  5221     05  DRLFRFDF PIC  X(0001).
  5222     05  FILLER REDEFINES DRLFRFDF.
  5223         10  DRLFRFDA PIC  X(0001).
  5224     05  DRLFRFDI PIC  S9(9)V99.
  5225*    -------------------------------
  5226     05  DRAHRFDL PIC S9(0004) COMP.
  5227     05  DRAHRFDF PIC  X(0001).
  5228     05  FILLER REDEFINES DRAHRFDF.
  5229         10  DRAHRFDA PIC  X(0001).
  5230     05  DRAHRFDI PIC  S9(9)V99.
  5231*    -------------------------------
  5232     05  DEISSL PIC S9(0004) COMP.
  5233     05  DEISSF PIC  X(0001).
  5234     05  FILLER REDEFINES DEISSF.
  5235         10  DEISSA PIC  X(0001).
  5236     05  DEISSI PIC  X(0005).
  5237*    -------------------------------
  5238     05  DELFPRML PIC S9(0004) COMP.
  5239     05  DELFPRMF PIC  X(0001).
  5240     05  FILLER REDEFINES DELFPRMF.
  5241         10  DELFPRMA PIC  X(0001).
  5242     05  DELFPRMI PIC  X(0011).
  5243*    -------------------------------
  5244     05  DEAHPRML PIC S9(0004) COMP.
  5245     05  DEAHPRMF PIC  X(0001).
  5246     05  FILLER REDEFINES DEAHPRMF.
  5247         10  DEAHPRMA PIC  X(0001).
  5248     05  DEAHPRMI PIC  X(0011).
  5249*    -------------------------------
  5250     05  DECANCL PIC S9(0004) COMP.
  5251     05  DECANCF PIC  X(0001).
  5252     05  FILLER REDEFINES DECANCF.
  5253         10  DECANCA PIC  X(0001).
  5254     05  DECANCI PIC  X(0005).
  5255*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  98
* EL6311.cbl
  5256     05  DELFRFDL PIC S9(0004) COMP.
  5257     05  DELFRFDF PIC  X(0001).
  5258     05  FILLER REDEFINES DELFRFDF.
  5259         10  DELFRFDA PIC  X(0001).
  5260     05  DELFRFDI PIC  X(0011).
  5261*    -------------------------------
  5262     05  DEAHRFDL PIC S9(0004) COMP.
  5263     05  DEAHRFDF PIC  X(0001).
  5264     05  FILLER REDEFINES DEAHRFDF.
  5265         10  DEAHRFDA PIC  X(0001).
  5266     05  DEAHRFDI PIC  X(0011).
  5267*    -------------------------------
  5268     05  DCISSL PIC S9(0004) COMP.
  5269     05  DCISSF PIC  X(0001).
  5270     05  FILLER REDEFINES DCISSF.
  5271         10  DCISSA PIC  X(0001).
  5272     05  DCISSI PIC  X(0005).
  5273*    -------------------------------
  5274     05  DCLFPRML PIC S9(0004) COMP.
  5275     05  DCLFPRMF PIC  X(0001).
  5276     05  FILLER REDEFINES DCLFPRMF.
  5277         10  DCLFPRMA PIC  X(0001).
  5278     05  DCLFPRMI PIC  X(0011).
  5279*    -------------------------------
  5280     05  DCAHPRML PIC S9(0004) COMP.
  5281     05  DCAHPRMF PIC  X(0001).
  5282     05  FILLER REDEFINES DCAHPRMF.
  5283         10  DCAHPRMA PIC  X(0001).
  5284     05  DCAHPRMI PIC  X(0011).
  5285*    -------------------------------
  5286     05  DCCANCL PIC S9(0004) COMP.
  5287     05  DCCANCF PIC  X(0001).
  5288     05  FILLER REDEFINES DCCANCF.
  5289         10  DCCANCA PIC  X(0001).
  5290     05  DCCANCI PIC  X(0005).
  5291*    -------------------------------
  5292     05  DCLFRFDL PIC S9(0004) COMP.
  5293     05  DCLFRFDF PIC  X(0001).
  5294     05  FILLER REDEFINES DCLFRFDF.
  5295         10  DCLFRFDA PIC  X(0001).
  5296     05  DCLFRFDI PIC  X(0011).
  5297*    -------------------------------
  5298     05  DCAHRFDL PIC S9(0004) COMP.
  5299     05  DCAHRFDF PIC  X(0001).
  5300     05  FILLER REDEFINES DCAHRFDF.
  5301         10  DCAHRFDA PIC  X(0001).
  5302     05  DCAHRFDI PIC  X(0011).
  5303*    -------------------------------
  5304     05  DOISSL PIC S9(0004) COMP.
  5305     05  DOISSF PIC  X(0001).
  5306     05  FILLER REDEFINES DOISSF.
  5307         10  DOISSA PIC  X(0001).
  5308     05  DOISSI PIC  X(0005).
  5309*    -------------------------------
  5310     05  DOLFPRML PIC S9(0004) COMP.
  5311     05  DOLFPRMF PIC  X(0001).
  5312     05  FILLER REDEFINES DOLFPRMF.
  5313         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page  99
* EL6311.cbl
  5314     05  DOLFPRMI PIC  X(0011).
  5315*    -------------------------------
  5316     05  DOAHPRML PIC S9(0004) COMP.
  5317     05  DOAHPRMF PIC  X(0001).
  5318     05  FILLER REDEFINES DOAHPRMF.
  5319         10  DOAHPRMA PIC  X(0001).
  5320     05  DOAHPRMI PIC  X(0011).
  5321*    -------------------------------
  5322     05  DOCANCL PIC S9(0004) COMP.
  5323     05  DOCANCF PIC  X(0001).
  5324     05  FILLER REDEFINES DOCANCF.
  5325         10  DOCANCA PIC  X(0001).
  5326     05  DOCANCI PIC  X(0005).
  5327*    -------------------------------
  5328     05  DOLFRFDL PIC S9(0004) COMP.
  5329     05  DOLFRFDF PIC  X(0001).
  5330     05  FILLER REDEFINES DOLFRFDF.
  5331         10  DOLFRFDA PIC  X(0001).
  5332     05  DOLFRFDI PIC  X(0011).
  5333*    -------------------------------
  5334     05  DOAHRFDL PIC S9(0004) COMP.
  5335     05  DOAHRFDF PIC  X(0001).
  5336     05  FILLER REDEFINES DOAHRFDF.
  5337         10  DOAHRFDA PIC  X(0001).
  5338     05  DOAHRFDI PIC  X(0011).
  5339*    -------------------------------
  5340     05  DITOTALL PIC S9(0004) COMP.
  5341     05  DITOTALF PIC  X(0001).
  5342     05  FILLER REDEFINES DITOTALF.
  5343         10  DITOTALA PIC  X(0001).
  5344     05  DITOTALI PIC  X(0005).
  5345*    -------------------------------
  5346     05  DIFATALL PIC S9(0004) COMP.
  5347     05  DIFATALF PIC  X(0001).
  5348     05  FILLER REDEFINES DIFATALF.
  5349         10  DIFATALA PIC  X(0001).
  5350     05  DIFATALI PIC  X(0005).
  5351*    -------------------------------
  5352     05  DIFORCEL PIC S9(0004) COMP.
  5353     05  DIFORCEF PIC  X(0001).
  5354     05  FILLER REDEFINES DIFORCEF.
  5355         10  DIFORCEA PIC  X(0001).
  5356     05  DIFORCEI PIC  X(0005).
  5357*    -------------------------------
  5358     05  DIHOLDL PIC S9(0004) COMP.
  5359     05  DIHOLDF PIC  X(0001).
  5360     05  FILLER REDEFINES DIHOLDF.
  5361         10  DIHOLDA PIC  X(0001).
  5362     05  DIHOLDI PIC  X(0005).
  5363*    -------------------------------
  5364     05  DIAVAILL PIC S9(0004) COMP.
  5365     05  DIAVAILF PIC  X(0001).
  5366     05  FILLER REDEFINES DIAVAILF.
  5367         10  DIAVAILA PIC  X(0001).
  5368     05  DIAVAILI PIC  X(0005).
  5369*    -------------------------------
  5370     05  DIGPREML PIC S9(0004) COMP.
  5371     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 100
* EL6311.cbl
  5372     05  FILLER REDEFINES DIGPREMF.
  5373         10  DIGPREMA PIC  X(0001).
  5374     05  DIGPREMI PIC  X(0011).
  5375*    -------------------------------
  5376     05  DIBPREML PIC S9(0004) COMP.
  5377     05  DIBPREMF PIC  X(0001).
  5378     05  FILLER REDEFINES DIBPREMF.
  5379         10  DIBPREMA PIC  X(0001).
  5380     05  DIBPREMI PIC  X(0011).
  5381*    -------------------------------
  5382     05  DCTOTALL PIC S9(0004) COMP.
  5383     05  DCTOTALF PIC  X(0001).
  5384     05  FILLER REDEFINES DCTOTALF.
  5385         10  DCTOTALA PIC  X(0001).
  5386     05  DCTOTALI PIC  X(0005).
  5387*    -------------------------------
  5388     05  DCFATALL PIC S9(0004) COMP.
  5389     05  DCFATALF PIC  X(0001).
  5390     05  FILLER REDEFINES DCFATALF.
  5391         10  DCFATALA PIC  X(0001).
  5392     05  DCFATALI PIC  X(0005).
  5393*    -------------------------------
  5394     05  DCFORCEL PIC S9(0004) COMP.
  5395     05  DCFORCEF PIC  X(0001).
  5396     05  FILLER REDEFINES DCFORCEF.
  5397         10  DCFORCEA PIC  X(0001).
  5398     05  DCFORCEI PIC  X(0005).
  5399*    -------------------------------
  5400     05  DCHOLDL PIC S9(0004) COMP.
  5401     05  DCHOLDF PIC  X(0001).
  5402     05  FILLER REDEFINES DCHOLDF.
  5403         10  DCHOLDA PIC  X(0001).
  5404     05  DCHOLDI PIC  X(0005).
  5405*    -------------------------------
  5406     05  DCAVAILL PIC S9(0004) COMP.
  5407     05  DCAVAILF PIC  X(0001).
  5408     05  FILLER REDEFINES DCAVAILF.
  5409         10  DCAVAILA PIC  X(0001).
  5410     05  DCAVAILI PIC  X(0005).
  5411*    -------------------------------
  5412     05  DCGPREML PIC S9(0004) COMP.
  5413     05  DCGPREMF PIC  X(0001).
  5414     05  FILLER REDEFINES DCGPREMF.
  5415         10  DCGPREMA PIC  X(0001).
  5416     05  DCGPREMI PIC  X(0011).
  5417*    -------------------------------
  5418     05  DCBPREML PIC S9(0004) COMP.
  5419     05  DCBPREMF PIC  X(0001).
  5420     05  FILLER REDEFINES DCBPREMF.
  5421         10  DCBPREMA PIC  X(0001).
  5422     05  DCBPREMI PIC  X(0011).
  5423*    -------------------------------
  5424     05  DNTOTALL PIC S9(0004) COMP.
  5425     05  DNTOTALF PIC  X(0001).
  5426     05  FILLER REDEFINES DNTOTALF.
  5427         10  DNTOTALA PIC  X(0001).
  5428     05  DNTOTALI PIC  X(0005).
  5429*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 101
* EL6311.cbl
  5430     05  DNFATALL PIC S9(0004) COMP.
  5431     05  DNFATALF PIC  X(0001).
  5432     05  FILLER REDEFINES DNFATALF.
  5433         10  DNFATALA PIC  X(0001).
  5434     05  DNFATALI PIC  X(0005).
  5435*    -------------------------------
  5436     05  DNFORCEL PIC S9(0004) COMP.
  5437     05  DNFORCEF PIC  X(0001).
  5438     05  FILLER REDEFINES DNFORCEF.
  5439         10  DNFORCEA PIC  X(0001).
  5440     05  DNFORCEI PIC  X(0005).
  5441*    -------------------------------
  5442     05  DNHOLDL PIC S9(0004) COMP.
  5443     05  DNHOLDF PIC  X(0001).
  5444     05  FILLER REDEFINES DNHOLDF.
  5445         10  DNHOLDA PIC  X(0001).
  5446     05  DNHOLDI PIC  X(0005).
  5447*    -------------------------------
  5448     05  DNAVAILL PIC S9(0004) COMP.
  5449     05  DNAVAILF PIC  X(0001).
  5450     05  FILLER REDEFINES DNAVAILF.
  5451         10  DNAVAILA PIC  X(0001).
  5452     05  DNAVAILI PIC  X(0005).
  5453*    -------------------------------
  5454     05  DNGPREML PIC S9(0004) COMP.
  5455     05  DNGPREMF PIC  X(0001).
  5456     05  FILLER REDEFINES DNGPREMF.
  5457         10  DNGPREMA PIC  X(0001).
  5458     05  DNGPREMI PIC  X(0011).
  5459*    -------------------------------
  5460     05  DNBPREML PIC S9(0004) COMP.
  5461     05  DNBPREMF PIC  X(0001).
  5462     05  FILLER REDEFINES DNBPREMF.
  5463         10  DNBPREMA PIC  X(0001).
  5464     05  DNBPREMI PIC  X(0011).
  5465*    -------------------------------
  5466     05  DERMSGL PIC S9(0004) COMP.
  5467     05  DERMSGF PIC  X(0001).
  5468     05  FILLER REDEFINES DERMSGF.
  5469         10  DERMSGA PIC  X(0001).
  5470     05  DERMSGI PIC  X(0075).
  5471*    -------------------------------
  5472     05  DPFENTRL PIC S9(0004) COMP.
  5473     05  DPFENTRF PIC  X(0001).
  5474     05  FILLER REDEFINES DPFENTRF.
  5475         10  DPFENTRA PIC  X(0001).
  5476     05  DPFENTRI PIC  9(2).
  5477 01  EL631DO REDEFINES EL631BI.
  5478     05  FILLER            PIC  X(0012).
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DDATEO PIC  X(0008).
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DTIMEO PIC  99.99.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 102
* EL6311.cbl
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DLDATEO PIC  X(0010).
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DBATCHO PIC  X(0011).
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DACCTNMO PIC  X(0030).
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DPROCDTO PIC  X(0008).
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DINPUTO PIC  X(0008).
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DMAINDTO PIC  X(0008).
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DCARRO PIC  X(0001).
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DGROUPO PIC  X(0006).
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DSTATEO PIC  X(0002).
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DACCTO PIC  X(0010).
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DRECVDTO PIC  X(0008).
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DCSRO PIC  X(0004).
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DREFHDGO PIC  X(0010).
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DREFO PIC  X(0012).
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DLFPHDGO PIC  X(0010).
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DAHPHDGO PIC  X(0010).
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DLFRHDGO PIC  X(0009).
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DAHRHDGO PIC  X(0009).
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DRISSO PIC  ZZ99-.
  5545*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 103
* EL6311.cbl
  5546     05  FILLER            PIC  X(0003).
  5547     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DRCANCO PIC  ZZ99-.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DEISSO PIC  ZZ99-.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DECANCO PIC  ZZ99-.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DCISSO PIC  ZZ99-.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
  5583     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DCCANCO PIC  ZZ99-.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DOISSO PIC  ZZ99-.
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
  5601     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5602*    -------------------------------
  5603     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 104
* EL6311.cbl
  5604     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DOCANCO PIC  ZZ99-.
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DITOTALO PIC  ZZZ99.
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DIFATALO PIC  ZZZ99.
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DIFORCEO PIC  ZZZ99.
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DIHOLDO PIC  ZZZ99.
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DIAVAILO PIC  ZZZ99.
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DCTOTALO PIC  ZZZ99.
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DCFATALO PIC  ZZZ99.
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DCFORCEO PIC  ZZZ99.
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DCHOLDO PIC  ZZZ99.
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DCAVAILO PIC  ZZZ99.
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5653*    -------------------------------
  5654     05  FILLER            PIC  X(0003).
  5655     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DNTOTALO PIC  ---99.
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 105
* EL6311.cbl
  5662*    -------------------------------
  5663     05  FILLER            PIC  X(0003).
  5664     05  DNFORCEO PIC  ---99.
  5665*    -------------------------------
  5666     05  FILLER            PIC  X(0003).
  5667     05  DNHOLDO PIC  ---99.
  5668*    -------------------------------
  5669     05  FILLER            PIC  X(0003).
  5670     05  DNAVAILO PIC  ---99.
  5671*    -------------------------------
  5672     05  FILLER            PIC  X(0003).
  5673     05  DNGPREMO PIC  -------9.99.
  5674*    -------------------------------
  5675     05  FILLER            PIC  X(0003).
  5676     05  DNBPREMO PIC  -------9.99.
  5677*    -------------------------------
  5678     05  FILLER            PIC  X(0003).
  5679     05  DERMSGO PIC  X(0075).
  5680*    -------------------------------
  5681     05  FILLER            PIC  X(0003).
  5682     05  DPFENTRO PIC  X(0002).
  5683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 106
* EL6311.cbl
  5685 01  MAP-B REDEFINES EL631BI.
  5686     12  FILLER                  PIC X(591).
  5687*    12  FILLER                  PIC X(512).
  5688*    12  FILLER                  PIC X(510).
  5689     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5690         16  BKIND-LEN               PIC S9(4)  COMP.
  5691         16  BKIND-ATTRB             PIC X.
  5692         16  BKIND                   PIC XX.
  5693         16  BTYPE-LEN               PIC S9(4)  COMP.
  5694         16  BTYPE-ATTRB             PIC X.
  5695         16  BTYPE                   PIC X(3).
  5696         16  BTERM-LEN               PIC S9(4)  COMP.
  5697         16  BTERM-ATTRB             PIC X.
  5698         16  BTERMI                  PIC 999.
  5699         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5700         16  BBEN-LEN                PIC S9(4)  COMP.
  5701         16  BBEN-ATTRB              PIC X.
  5702         16  BBENI                   PIC 9(10)V99.
  5703*        16  BBENI                   PIC 9(12).
  5704         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5705         16  BPREM-LEN               PIC S9(4)  COMP.
  5706         16  BPREM-ATTRB             PIC X.
  5707         16  BPREMI                  PIC S9(9)V99.
  5708*        16  BPREMI                  PIC 9(11).
  5709         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5710         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5711         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5712         16  BEXPIRE-ATTRB           PIC X.
  5713         16  BEXPIRE                 PIC X(8).
  5714         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5715         16  BCRIT-PERD-ATTRB        PIC X.
  5716         16  BCRIT-PERDI             PIC 99.
  5717         16  BCRIT-PERDO REDEFINES
  5718                         BCRIT-PERDI PIC ZZ.
  5719         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5720         16  BALT-BEN-ATTRB          PIC X.
  5721         16  BALT-BENI               PIC 9(10)V99.
  5722*        16  BALT-BENI               PIC 9(12).
  5723         16  BALT-BENO REDEFINES
  5724                           BALT-BENI PIC Z(9).ZZ.
  5725         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5726         16  BALT-PREM-ATTRB         PIC X.
  5727         16  BALT-PREMI              PIC 9(9)V99.
  5728*        16  BALT-PREMI              PIC 9(11).
  5729         16  BALT-PREMO REDEFINES
  5730                          BALT-PREMI PIC Z(7).ZZ-.
  5731         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5732         16  BBEN-CD-ATTRB           PIC X.
  5733         16  BBEN-CD                 PIC XXX.
  5734         16  BCPREM-LEN              PIC S9(4)  COMP.
  5735         16  BCPREM-ATTRB            PIC X.
  5736         16  BCPREMI                 PIC S9(9)V99.
  5737*        16  BCPREMI                 PIC X(11).
  5738         16  BCPREMO REDEFINES BCPREMI
  5739                                     PIC Z(7).99-.
  5740         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5741         16  BCALT-PREM-ATTRB        PIC X.
  5742         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 107
* EL6311.cbl
  5743         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5744         16  BBEN-ABBR-ATTRB         PIC X.
  5745         16  BBEN-ABBR               PIC X(5).
  5746         16  BDIFF-LEN               PIC S9(4)  COMP.
  5747         16  BDIFF-ATTRB             PIC X.
  5748         16  BDIFFO                  PIC Z(7).99-.
  5749         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5750         16  BBILL-LIT-ATTRB         PIC X.
  5751         16  BBILL-LIT               PIC X(8).
  5752         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5753         16  BDALT-PREM-ATTRB        PIC X.
  5754         16  BDALT-PREM              PIC Z(7).99-.
  5755
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 108
* EL6311.cbl
  5757
  5758****************************************************************
  5759*
  5760* Copyright (c) 2007-2013 Dell Inc.
  5761* All rights reserved.
  5762*
  5763****************************************************************
  5764 01  DFHEIV.
  5765   02  DFHEIV0               PIC X(35).
  5766   02  DFHEIV1               PIC X(08).
  5767   02  DFHEIV2               PIC X(08).
  5768   02  DFHEIV3               PIC X(08).
  5769   02  DFHEIV4               PIC X(06).
  5770   02  DFHEIV5               PIC X(04).
  5771   02  DFHEIV6               PIC X(04).
  5772   02  DFHEIV7               PIC X(02).
  5773   02  DFHEIV8               PIC X(02).
  5774   02  DFHEIV9               PIC X(01).
  5775   02  DFHEIV10              PIC S9(7) COMP-3.
  5776   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5777   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5778   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5779   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5780   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5781   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5782   02  DFHEIV17              PIC X(04).
  5783   02  DFHEIV18              PIC X(04).
  5784   02  DFHEIV19              PIC X(04).
  5785   02  DFHEIV20              USAGE IS POINTER.
  5786   02  DFHEIV21              USAGE IS POINTER.
  5787   02  DFHEIV22              USAGE IS POINTER.
  5788   02  DFHEIV23              USAGE IS POINTER.
  5789   02  DFHEIV24              USAGE IS POINTER.
  5790   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5791   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5792   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5793   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5794   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5795   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5796   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5797   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5798   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5799   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5800   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5801   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5802   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5803   02  FILLER                PIC X(02).
  5804   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5805   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5806   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5807   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5808   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5809   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5810   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5811 LINKAGE  SECTION.
  5812*****************************************************************
  5813*                                                               *
  5814* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 109
* EL6311.cbl
  5815* All rights reserved.                                          *
  5816*                                                               *
  5817*****************************************************************
  5818 01  dfheiblk.
  5819     02  eibtime          pic s9(7) comp-3.
  5820     02  eibdate          pic s9(7) comp-3.
  5821     02  eibtrnid         pic x(4).
  5822     02  eibtaskn         pic s9(7) comp-3.
  5823     02  eibtrmid         pic x(4).
  5824     02  dfheigdi         pic s9(4) comp.
  5825     02  eibcposn         pic s9(4) comp.
  5826     02  eibcalen         pic s9(4) comp.
  5827     02  eibaid           pic x(1).
  5828     02  eibfiller1       pic x(1).
  5829     02  eibfn            pic x(2).
  5830     02  eibfiller2       pic x(2).
  5831     02  eibrcode         pic x(6).
  5832     02  eibfiller3       pic x(2).
  5833     02  eibds            pic x(8).
  5834     02  eibreqid         pic x(8).
  5835     02  eibrsrce         pic x(8).
  5836     02  eibsync          pic x(1).
  5837     02  eibfree          pic x(1).
  5838     02  eibrecv          pic x(1).
  5839     02  eibsend          pic x(1).
  5840     02  eibatt           pic x(1).
  5841     02  eibeoc           pic x(1).
  5842     02  eibfmh           pic x(1).
  5843     02  eibcompl         pic x(1).
  5844     02  eibsig           pic x(1).
  5845     02  eibconf          pic x(1).
  5846     02  eiberr           pic x(1).
  5847     02  eibrldbk         pic x(1).
  5848     02  eiberrcd         pic x(4).
  5849     02  eibsynrb         pic x(1).
  5850     02  eibnodat         pic x(1).
  5851     02  eibfiller5       pic x(2).
  5852     02  eibresp          pic s9(8) comp.
  5853     02  eibresp2         pic s9(8) comp.
  5854     02  dfheigdj         pic s9(4) comp.
  5855     02  dfheigdk         pic s9(4) comp.
  5856 01  DFHCOMMAREA                 PIC X(1300).
  5857*                                COPY ERCPNDB.
  5858******************************************************************
  5859*                                                                *
  5860*                                                                *
  5861*                            ERCPNDB.                            *
  5862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5863*                            VMOD=2.025                          *
  5864*                                                                *
  5865*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5866*                                                                *
  5867******************************************************************
  5868*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5869*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5870******************************************************************
  5871*                                                                *
  5872*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 110
* EL6311.cbl
  5873*   FILE TYPE = VSAM,KSDS                                        *
  5874*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5875*                                                                *
  5876*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5877*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5878*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5879*                                                 RKP=13,LEN=36  *
  5880*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5881*                                      AND CHG-SEQ.)             *
  5882*                                                RKP=49,LEN=11   *
  5883*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5884*                                      AND CHG-SEQ.)             *
  5885*                                                RKP=60,LEN=15   *
  5886*                                                                *
  5887*   LOG = NO                                                     *
  5888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5889******************************************************************
  5890******************************************************************
  5891*                   C H A N G E   L O G
  5892*
  5893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5894*-----------------------------------------------------------------
  5895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5896* EFFECTIVE    NUMBER
  5897*-----------------------------------------------------------------
  5898* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5899* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5900* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5901* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5902* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5903* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5904* 032306                   PEMA  ADD BOW LOAN NUMBER
  5905* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5906* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5907* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5908* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5909* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5910* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5911* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5912* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5913* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5914* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5915* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5916* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5917******************************************************************
  5918
  5919 01  PENDING-BUSINESS.
  5920     12  PB-RECORD-ID                     PIC XX.
  5921         88  VALID-PB-ID                        VALUE 'PB'.
  5922
  5923     12  PB-CONTROL-PRIMARY.
  5924         16  PB-COMPANY-CD                PIC X.
  5925         16  PB-ENTRY-BATCH               PIC X(6).
  5926         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5927         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5928
  5929     12  PB-CONTROL-BY-ACCOUNT.
  5930         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 111
* EL6311.cbl
  5931         16  PB-CARRIER                   PIC X.
  5932         16  PB-GROUPING.
  5933             20  PB-GROUPING-PREFIX       PIC XXX.
  5934             20  PB-GROUPING-PRIME        PIC XXX.
  5935         16  PB-STATE                     PIC XX.
  5936         16  PB-ACCOUNT.
  5937             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5938             20  PB-ACCOUNT-PRIME         PIC X(6).
  5939         16  PB-CERT-EFF-DT               PIC XX.
  5940         16  PB-CERT-NO.
  5941             20  PB-CERT-PRIME            PIC X(10).
  5942             20  PB-CERT-SFX              PIC X.
  5943         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5944
  5945         16  PB-RECORD-TYPE               PIC X.
  5946             88  PB-MAILING-DATA                VALUE '0'.
  5947             88  PB-ISSUE                       VALUE '1'.
  5948             88  PB-CANCELLATION                VALUE '2'.
  5949             88  PB-BATCH-TRAILER               VALUE '9'.
  5950
  5951     12  PB-CONTROL-BY-ORIG-BATCH.
  5952         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5953         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5954         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5955         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5956
  5957     12  PB-CONTROL-BY-CSR.
  5958         16  PB-CSR-COMPANY-CD            PIC X.
  5959         16  PB-CSR-ID                    PIC X(4).
  5960         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5961         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5962         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5963******************************************************************
  5964*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5965******************************************************************
  5966
  5967     12  PB-LAST-MAINT-DT                 PIC XX.
  5968     12  PB-LAST-MAINT-BY                 PIC X(4).
  5969     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5970
  5971     12  PB-RECORD-BODY                   PIC X(375).
  5972
  5973     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5974         16  PB-CERT-ORIGIN               PIC X.
  5975             88  CLASIC-CREATED-CERT         VALUE '1'.
  5976         16  PB-I-NAME.
  5977             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5978             20  PB-I-INSURED-FIRST-NAME.
  5979                 24  PB-I-INSURED-1ST-INIT PIC X.
  5980                 24  FILLER                PIC X(9).
  5981             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5982         16  PB-I-AGE                     PIC S99   COMP-3.
  5983         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5984         16  PB-I-BIRTHDAY                PIC XX.
  5985         16  PB-I-INSURED-SEX             PIC X.
  5986             88  PB-SEX-MALE     VALUE 'M'.
  5987             88  PB-SEX-FEMALE   VALUE 'F'.
  5988
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 112
* EL6311.cbl
  5989         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5990         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5991         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5992         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5993         16  PB-I-SKIP-CODE               PIC X.
  5994             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5995             88  PB-SKIP-JULY              VALUE '1'.
  5996             88  PB-SKIP-AUGUST            VALUE '2'.
  5997             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5998             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5999             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6000             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6001             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6002             88  PB-SKIP-JUNE              VALUE '8'.
  6003             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6004             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6005             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6006         16  PB-I-TERM-TYPE               PIC X.
  6007             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6008             88  PB-PAID-WEEKLY            VALUE 'W'.
  6009             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6010             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6011             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6012         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6013         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6014         16  PB-I-DATA-ENTRY-SW           PIC X.
  6015             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6016             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6017             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6018             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6019         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6020         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6021*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6022         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6023         16  FILLER                       PIC X.
  6024
  6025         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6026             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6027             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6028                                                   '90' THRU '99'.
  6029         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6030                                          PIC XX.
  6031         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6032         16  PB-I-AMOUNT-FINANCED REDEFINES
  6033                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6034         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6035         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6036                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6037         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6038         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6039         16  PB-I-CLP-AMOUNT REDEFINES
  6040                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6041         16  PB-I-LF-CALC-FLAG            PIC X.
  6042             88 PB-COMP-LF-PREM               VALUE '?'.
  6043         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6044         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6045         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6046         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 113
* EL6311.cbl
  6047         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6048         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6049         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6050         16  PB-I-LF-ABBR                 PIC XXX.
  6051         16  PB-I-LF-INPUT-CD             PIC XX.
  6052
  6053         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6054             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6055             88  PB-INVALID-AH               VALUE '  ' '00'
  6056                                                   '90' THRU '99'.
  6057         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6058         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6059         16  PB-I-AH-CALC-FLAG            PIC X.
  6060             88 PB-COMP-AH-PREM                  VALUE '?'.
  6061         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6062         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6063         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6064         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6065         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6066         16  PB-I-AH-ABBR                 PIC XXX.
  6067         16  PB-I-AH-INPUT-CD             PIC XXX.
  6068
  6069         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6070         16  PB-I-REIN-TABLE              PIC XXX.
  6071         16  PB-I-BUSINESS-TYPE           PIC 99.
  6072         16  PB-I-INDV-GRP-CD             PIC X.
  6073         16  PB-I-MORT-CODE.
  6074             20  PB-I-TABLE               PIC X.
  6075             20  PB-I-INTEREST            PIC XX.
  6076             20  PB-I-MORT-TYP            PIC X.
  6077         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6078         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6079         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6080         16  PB-I-INDV-GRP-OVRD           PIC X.
  6081         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6082         16  PB-I-SIG-SW                  PIC X.
  6083             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6084         16  PB-I-RATE-CLASS              PIC XX.
  6085         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6086         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6087         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6088         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6089         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6090         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6091         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6092         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6093         16  PB-I-OB-FLAG                 PIC X.
  6094             88  PB-I-OB                      VALUE 'B'.
  6095             88  PB-I-SUMMARY                 VALUE 'Z'.
  6096         16  PB-I-ENTRY-STATUS            PIC X.
  6097             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6098                                              'M' '5' '9' '2'.
  6099             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6100             88  PB-I-POLICY-PENDING          VALUE '2'.
  6101             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6102             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6103             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6104             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 114
* EL6311.cbl
  6105             88  PB-I-REIN-ONLY               VALUE '9'.
  6106             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6107             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6108             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6109             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6110         16  PB-I-INT-CODE                PIC X.
  6111             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6112             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6113         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6114         16  PB-I-SOC-SEC-NO              PIC X(11).
  6115         16  PB-I-MEMBER-NO               PIC X(12).
  6116         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6117*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6118         16  PB-I-OLD-LOF                 PIC XXX.
  6119         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6120         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6121         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6122         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6123         16  PB-I-LIFE-INDICATOR          PIC X.
  6124             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6125         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6126         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6127                                          PIC S9(5)V99    COMP-3.
  6128         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6129             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6130             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6131         16  PB-I-1ST-PMT-DT              PIC XX.
  6132         16  PB-I-JOINT-INSURED.
  6133             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6134             20 PB-I-JOINT-FIRST-NAME.
  6135                24  PB-I-JOINT-FIRST-INIT PIC X.
  6136                24  FILLER                PIC X(9).
  6137             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6138*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6139         16  PB-I-BENEFICIARY-NAME.
  6140             20  PB-I-BANK-NUMBER         PIC X(10).
  6141             20  FILLER                   PIC X(15).
  6142         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6143         16  PB-I-REFERENCE               PIC X(12).
  6144         16  FILLER REDEFINES PB-I-REFERENCE.
  6145             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6146             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6147             20  PB-I-CLP-STATE           PIC XX.
  6148         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6149             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6150             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6151             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6152         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6153         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6154         16  PB-I-RESIDENT-STATE          PIC XX.
  6155         16  PB-I-RATE-CODE               PIC X(4).
  6156         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6157         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6158         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6159         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6160         16  PB-I-BANK-NOCHRGB            PIC 99.
  6161         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6162         16  PB-I-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 115
* EL6311.cbl
  6163
  6164     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6165         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6166             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6167         16  PB-C-CANCEL-ORIGIN           PIC X.
  6168             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6169         16  PB-C-LF-CANCEL-DT            PIC XX.
  6170         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6171         16  PB-C-LF-CALC-REQ             PIC X.
  6172             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6173         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6174         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6175         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6176             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6177         16  PB-C-AH-CANCEL-DT            PIC XX.
  6178         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6179         16  PB-C-AH-CALC-REQ             PIC X.
  6180             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6181         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6182         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6183         16  PB-C-LAST-NAME               PIC X(15).
  6184         16  PB-C-REFUND-SW               PIC X.
  6185             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6186             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6187         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6188         16  PB-C-PAYEE-CODE              PIC X(6).
  6189         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6190         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6191         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6192         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6193         16  PB-C-REFERENCE               PIC X(12).
  6194         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6195         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6196         16  PB-C-POST-CARD-IND           PIC X.
  6197         16  PB-C-CANCEL-REASON           PIC X.
  6198         16  PB-C-REF-INTERFACE-SW        PIC X.
  6199         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6200         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6201         16  FILLER                       PIC X(01).
  6202*        16  FILLER                       PIC X(18).
  6203         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6204*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6205         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6206         16  PB-CANCELED-CERT-DATA.
  6207             20  PB-CI-INSURED-NAME.
  6208                 24  PB-CI-LAST-NAME      PIC X(15).
  6209                 24  PB-CI-INITIALS       PIC XX.
  6210             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6211             20  PB-CI-INSURED-SEX        PIC X.
  6212             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6213             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6214             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6215             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6216             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6217             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6218             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6219             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6220             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 116
* EL6311.cbl
  6221             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6222             20  PB-CI-RATE-CLASS         PIC XX.
  6223             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6224             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6225             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6226             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6227             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6228             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6229             20  PB-CI-LF-ABBR            PIC X(3).
  6230             20  PB-CI-AH-ABBR            PIC X(3).
  6231             20  PB-CI-OB-FLAG            PIC X.
  6232                 88  PB-CI-OB                VALUE 'B'.
  6233             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6234                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6235                                           'M' '4' '5' '9' '2'.
  6236                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6237                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6238                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6239                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6240                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6241                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6242                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6243                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6244                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6245                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6246                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6247                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6248                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6249             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6250                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6251                                           'M' '4' '5' '9' '2'.
  6252                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6253                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6254                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6255                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6256                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6257                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6258                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6259                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6260                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6261                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6262                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6263                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6264                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6265             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6266             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6267             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6268             20  PB-CI-MEMBER-NO          PIC X(12).
  6269             20  PB-CI-INT-CODE           PIC X.
  6270                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6271                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6272             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6273             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6274             20  PB-CI-COMP-EXCP-SW       PIC X.
  6275                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6276                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6277             20  PB-CI-ENTRY-STATUS       PIC X.
  6278             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 117
* EL6311.cbl
  6279             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6280             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6281             20  PB-CI-DEATH-DT           PIC XX.
  6282             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6283             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6284             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6285             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6286             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6287             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6288             20  PB-CI-ENTRY-DT              PIC XX.
  6289             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6290             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6291             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6292             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6293             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6294             20  PB-CI-OLD-LOF               PIC XXX.
  6295*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6296             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6297             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6298             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6299             20  PB-CI-INDV-GRP-CD           PIC X.
  6300             20  PB-CI-BENEFICIARY-NAME.
  6301                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6302                 24  FILLER                  PIC X(15).
  6303             20  PB-CI-NOTE-SW               PIC X.
  6304             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6305             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6306             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6307             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6308             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6309             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6310             20  PB-CI-FIRST-NAME            PIC X(10).
  6311             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6312
  6313         16  FILLER                       PIC X(13).
  6314*032306  16  FILLER                       PIC X(27).
  6315*        16  FILLER                       PIC X(46).
  6316
  6317     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6318         16  FILLER                       PIC X(10).
  6319         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6320         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6321         16  PB-M-INSURED-MID-INIT        PIC X.
  6322         16  PB-M-INSURED-AGE             PIC 99.
  6323         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6324         16  PB-M-INSURED-SEX             PIC X.
  6325         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6326         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6327         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6328         16  PB-M-INSURED-CITY-STATE.
  6329             20  PB-M-INSURED-CITY        PIC X(28).
  6330             20  PB-M-INSURED-STATE       PIC XX.
  6331         16  PB-M-INSURED-ZIP-CODE.
  6332             20  PB-M-INSURED-ZIP-PRIME.
  6333                 24  PB-M-INSURED-ZIP-1   PIC X.
  6334                     88  PB-M-CANADIAN-POST-CODE
  6335                                             VALUE 'A' THRU 'Z'.
  6336                 24  FILLER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 118
* EL6311.cbl
  6337             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6338         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6339                                        PB-M-INSURED-ZIP-CODE.
  6340             20  PM-M-INS-CAN-POST1       PIC XXX.
  6341             20  PM-M-INS-CAN-POST2       PIC XXX.
  6342             20  FILLER                   PIC XXX.
  6343         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6344         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6345         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6346         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6347         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6348         16  PB-M-CRED-BENE-CITYST.
  6349             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6350             20  PB-M-CRED-BENE-STATE     PIC XX.
  6351         16  FILLER                       PIC X(92).
  6352
  6353     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6354         16  FILLER                       PIC X(10).
  6355         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6356         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6357         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6358         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6359         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6360         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6361         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6362         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6363         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6364         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6365         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6366         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6367         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6368         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6369         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6370         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6371         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6372         16  PB-ACCOUNT-NAME              PIC X(30).
  6373         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6374         16  PB-REFERENCE                 PIC X(12).
  6375         16  PB-B-RECEIVED-DT             PIC XX.
  6376         16  FILLER                       PIC X(234).
  6377
  6378     12  PB-RECORD-STATUS.
  6379         16  PB-CREDIT-SELECT-DT          PIC XX.
  6380         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6381         16  PB-BILLED-DT                 PIC XX.
  6382         16  PB-BILLING-STATUS            PIC X.
  6383             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6384             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6385             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6386         16  PB-RECORD-BILL               PIC X.
  6387             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6388             88  PB-RECORD-RETURNED           VALUE 'R'.
  6389             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6390             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6391             88  PB-OVERRIDE-AH               VALUE 'A'.
  6392             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6393         16  PB-BATCH-ENTRY               PIC X.
  6394             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 119
* EL6311.cbl
  6395             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6396             88  PB-REISSUED-CERT             VALUE 'E'.
  6397             88  PB-CASH-CERT                 VALUE 'C'.
  6398             88  PB-MONTHLY-CERT              VALUE 'M'.
  6399             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6400             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6401             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6402         16  PB-FORCE-CODE                PIC X.
  6403             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6404             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6405             88  PB-CANCEL-FORCE              VALUE '8'.
  6406             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6407             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6408             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6409             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6410             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6411             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6412             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6413             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6414         16  PB-FATAL-FLAG                PIC X.
  6415             88  PB-FATAL-ERRORS              VALUE 'X'.
  6416         16  PB-FORCE-ER-CD               PIC X.
  6417             88  PB-FORCE-ERRORS              VALUE 'F'.
  6418             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6419         16  PB-WARN-ER-CD                PIC X.
  6420             88  PB-WARNING-ERRORS            VALUE 'W'.
  6421         16  FILLER                       PIC X.
  6422         16  PB-OUT-BAL-CD                PIC X.
  6423             88  PB-OUT-OF-BAL                VALUE 'O'.
  6424         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6425         16  PB-AH-OVERRIDE-L1            PIC X.
  6426         16  PB-INPUT-DT                  PIC XX.
  6427         16  PB-INPUT-BY                  PIC X(4).
  6428         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6429         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6430         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6431         16  PB-LF-EARNING-METHOD         PIC X.
  6432         16  PB-AH-EARNING-METHOD         PIC X.
  6433         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6434         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6435         16  PB-REIN-CD                   PIC XXX.
  6436         16  PB-LF-REFUND-TYPE            PIC X.
  6437         16  PB-AH-REFUND-TYPE            PIC X.
  6438         16  PB-ACCT-EFF-DT               PIC XX.
  6439         16  PB-ACCT-EXP-DT               PIC XX.
  6440         16  PB-COMPANY-ID                PIC X(3).
  6441         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6442         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6443         16  PB-SV-CARRIER                PIC X.
  6444         16  PB-SV-GROUPING               PIC X(6).
  6445         16  PB-SV-STATE                  PIC XX.
  6446         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6447         16  PB-GA-BILLING-INFO.
  6448             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6449                                          PIC XX.
  6450         16  PB-SV-REMIT-TO  REDEFINES
  6451             PB-GA-BILLING-INFO           PIC X(10).
  6452         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 120
* EL6311.cbl
  6453         16  PB-I-LOAN-OFFICER            PIC X(5).
  6454         16  PB-I-VIN                     PIC X(17).
  6455
  6456         16  FILLER                       PIC X(04).
  6457         16  IMNET-BYPASS-SW              PIC X.
  6458
  6459******************************************************************
  6460*                COMMON EDIT ERRORS                              *
  6461******************************************************************
  6462
  6463     12  PB-COMMON-ERRORS.
  6464         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6465                                           PIC S9(4)     COMP.
  6466
  6467******************************************************************
  6468*                                COPY ELCCERT.
  6469******************************************************************
  6470*                                                                *
  6471*                            ELCCERT.                            *
  6472*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6473*                            VMOD=2.013                          *
  6474*                                                                *
  6475*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6476*                                                                *
  6477*   FILE TYPE = VSAM,KSDS                                        *
  6478*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6479*                                                                *
  6480*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6481*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6482*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6483*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6484*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6485*                                                                *
  6486*   LOG = YES                                                    *
  6487*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6488******************************************************************
  6489*                   C H A N G E   L O G
  6490*
  6491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6492*-----------------------------------------------------------------
  6493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6494* EFFECTIVE    NUMBER
  6495*-----------------------------------------------------------------
  6496* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6497* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6498* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6499* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6500* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6501* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6502* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6503* 032612  CR2011110200001  PEMA  AHL CHANGES
  6504* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6505* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6506* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6507******************************************************************
  6508
  6509 01  CERTIFICATE-MASTER.
  6510     12  CM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 121
* EL6311.cbl
  6511         88  VALID-CM-ID                      VALUE 'CM'.
  6512
  6513     12  CM-CONTROL-PRIMARY.
  6514         16  CM-COMPANY-CD                 PIC X.
  6515         16  CM-CARRIER                    PIC X.
  6516         16  CM-GROUPING.
  6517             20  CM-GROUPING-PREFIX        PIC X(3).
  6518             20  CM-GROUPING-PRIME         PIC X(3).
  6519         16  CM-STATE                      PIC XX.
  6520         16  CM-ACCOUNT.
  6521             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6522             20  CM-ACCOUNT-PRIME          PIC X(6).
  6523         16  CM-CERT-EFF-DT                PIC XX.
  6524         16  CM-CERT-NO.
  6525             20  CM-CERT-PRIME             PIC X(10).
  6526             20  CM-CERT-SFX               PIC X.
  6527
  6528     12  CM-CONTROL-BY-NAME.
  6529         16  CM-COMPANY-CD-A1              PIC X.
  6530         16  CM-INSURED-LAST-NAME          PIC X(15).
  6531         16  CM-INSURED-INITIALS.
  6532             20  CM-INSURED-INITIAL1       PIC X.
  6533             20  CM-INSURED-INITIAL2       PIC X.
  6534
  6535     12  CM-CONTROL-BY-SSN.
  6536         16  CM-COMPANY-CD-A2              PIC X.
  6537         16  CM-SOC-SEC-NO.
  6538             20  CM-SSN-STATE              PIC XX.
  6539             20  CM-SSN-ACCOUNT            PIC X(6).
  6540             20  CM-SSN-LN3.
  6541                 25  CM-INSURED-INITIALS-A2.
  6542                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6543                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6544                 25 CM-PART-LAST-NAME-A2         PIC X.
  6545
  6546     12  CM-CONTROL-BY-CERT-NO.
  6547         16  CM-COMPANY-CD-A4              PIC X.
  6548         16  CM-CERT-NO-A4                 PIC X(11).
  6549
  6550     12  CM-CONTROL-BY-MEMB.
  6551         16  CM-COMPANY-CD-A5              PIC X.
  6552         16  CM-MEMBER-NO.
  6553             20  CM-MEMB-STATE             PIC XX.
  6554             20  CM-MEMB-ACCOUNT           PIC X(6).
  6555             20  CM-MEMB-LN4.
  6556                 25  CM-INSURED-INITIALS-A5.
  6557                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6558                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6559                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6560
  6561     12  CM-INSURED-PROFILE-DATA.
  6562         16  CM-INSURED-FIRST-NAME.
  6563             20  CM-INSURED-1ST-INIT       PIC X.
  6564             20  FILLER                    PIC X(9).
  6565         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6566         16  CM-INSURED-SEX                PIC X.
  6567             88  CM-SEX-MALE                  VALUE 'M'.
  6568             88  CM-SEX-FEMAL                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 122
* EL6311.cbl
  6569         16  CM-INSURED-JOINT-AGE          PIC 99.
  6570         16  CM-JOINT-INSURED-NAME.
  6571             20  CM-JT-LAST-NAME           PIC X(15).
  6572             20  CM-JT-FIRST-NAME.
  6573                 24  CM-JT-1ST-INIT        PIC X.
  6574                 24  FILLER                PIC X(9).
  6575             20  CM-JT-INITIAL             PIC X.
  6576
  6577     12  CM-LIFE-DATA.
  6578         16  CM-LF-BENEFIT-CD              PIC XX.
  6579         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6580         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6581         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6582         16  CM-LF-DEV-CODE                PIC XXX.
  6583         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6584         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6585         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6586         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6587         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6588         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6589         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6590         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6591         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6592         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6593         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6594         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6595         16  cm-temp-epiq                  pic xx.
  6596             88  EPIQ-CLASS                  value 'EQ'.
  6597*        16  FILLER                        PIC XX.
  6598
  6599     12  CM-AH-DATA.
  6600         16  CM-AH-BENEFIT-CD              PIC XX.
  6601         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6602         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6603         16  CM-AH-DEV-CODE                PIC XXX.
  6604         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6605         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6606         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6607         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6608         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6609         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6610         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6611         16  CM-AH-PAID-THRU-DT            PIC XX.
  6612             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6613         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6614         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6615         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6616         16  FILLER                        PIC X.
  6617
  6618     12  CM-LOAN-INFORMATION.
  6619         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6620         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6621                                           PIC S9(5)V99  COMP-3.
  6622         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6623         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6624         16  CM-PAY-FREQUENCY              PIC S99.
  6625         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6626         16  CM-RATE-CLASS                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 123
* EL6311.cbl
  6627         16  CM-BENEFICIARY                PIC X(25).
  6628         16  CM-POLICY-FORM-NO             PIC X(12).
  6629         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6630         16  CM-LAST-ADD-ON-DT             PIC XX.
  6631         16  CM-DEDUCTIBLE-AMOUNTS.
  6632             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6633             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6634         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6635             20  CM-RESIDENT-STATE         PIC XX.
  6636             20  CM-RATE-CODE              PIC X(4).
  6637             20  FILLER                    PIC XX.
  6638         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6639             20  CM-LOAN-OFFICER           PIC X(5).
  6640             20  FILLER                    PIC XXX.
  6641         16  CM-CSR-CODE                   PIC XXX.
  6642         16  CM-UNDERWRITING-CODE          PIC X.
  6643             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6644         16  CM-POST-CARD-IND              PIC X.
  6645         16  CM-REF-INTERFACE-SW           PIC X.
  6646         16  CM-PREMIUM-TYPE               PIC X.
  6647             88  CM-SING-PRM                  VALUE '1'.
  6648             88  CM-O-B-COVERAGE              VALUE '2'.
  6649             88  CM-OPEN-END                  VALUE '3'.
  6650         16  CM-IND-GRP-TYPE               PIC X.
  6651             88  CM-INDIVIDUAL                VALUE 'I'.
  6652             88  CM-GROUP                     VALUE 'G'.
  6653         16  CM-SKIP-CODE                  PIC X.
  6654             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6655             88  SKIP-JULY                    VALUE '1'.
  6656             88  SKIP-AUGUST                  VALUE '2'.
  6657             88  SKIP-SEPTEMBER               VALUE '3'.
  6658             88  SKIP-JULY-AUG                VALUE '4'.
  6659             88  SKIP-AUG-SEPT                VALUE '5'.
  6660             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6661             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6662             88  SKIP-JUNE                    VALUE '8'.
  6663             88  SKIP-JUNE-JULY               VALUE '9'.
  6664             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6665             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6666         16  CM-PAYMENT-MODE               PIC X.
  6667             88  PAY-MONTHLY                  VALUE SPACE.
  6668             88  PAY-WEEKLY                   VALUE '1'.
  6669             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6670             88  PAY-BI-WEEKLY                VALUE '3'.
  6671             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6672         16  CM-LOAN-NUMBER                PIC X(8).
  6673         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6674         16  CM-OLD-LOF                    PIC XXX.
  6675*        16  CM-LOAN-OFFICER               PIC XXX.
  6676         16  CM-REIN-TABLE                 PIC XXX.
  6677         16  CM-SPECIAL-REIN-CODE          PIC X.
  6678         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6679         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6680         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6681
  6682     12  CM-STATUS-DATA.
  6683         16  CM-ENTRY-STATUS               PIC X.
  6684         16  CM-ENTRY-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 124
* EL6311.cbl
  6685
  6686         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6687         16  CM-LF-CANCEL-DT               PIC XX.
  6688         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6689
  6690         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6691         16  CM-LF-DEATH-DT                PIC XX.
  6692         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6693
  6694         16  CM-LF-CURRENT-STATUS          PIC X.
  6695             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6696                                                'M' '4' '5' '9'.
  6697             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6698             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6699             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6700             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6701             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6702             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6703             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6704             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6705             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6706             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6707             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6708             88  CM-LF-DECLINED               VALUE 'D'.
  6709             88  CM-LF-VOIDED                 VALUE 'V'.
  6710
  6711         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6712         16  CM-AH-CANCEL-DT               PIC XX.
  6713         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6714
  6715         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6716         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6717         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6718
  6719         16  CM-AH-CURRENT-STATUS          PIC X.
  6720             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6721                                                'M' '4' '5' '9'.
  6722             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6723             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6724             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6725             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6726             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6727             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6728             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6729             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6730             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6731             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6732             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6733             88  CM-AH-DECLINED               VALUE 'D'.
  6734             88  CM-AH-VOIDED                 VALUE 'V'.
  6735
  6736         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6737             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6738             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6739             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6740         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6741
  6742         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 125
* EL6311.cbl
  6743         16  CM-LF-EXIT-BATCH              PIC X(6).
  6744         16  CM-AH-EXIT-BATCH              PIC X(6).
  6745         16  CM-LAST-MONTH-END             PIC XX.
  6746
  6747     12  CM-NOTE-SW                        PIC X.
  6748         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6749         88  CERT-NOTES-PRESENT               VALUE '1'.
  6750         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6751         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6752         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6753         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6754         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6755         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6756     12  CM-COMP-EXCP-SW                   PIC X.
  6757         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6758         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6759     12  CM-INSURED-ADDRESS-SW             PIC X.
  6760         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6761         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6762
  6763*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6764     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6765     12  FILLER                            PIC X.
  6766
  6767*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6768     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6769     12  FILLER                            PIC X.
  6770*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6771     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6772
  6773     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6774         88  CERT-ADDED-BATCH                 VALUE ' '.
  6775         88  CERT-ADDED-ONLINE                VALUE '1'.
  6776         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6777         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6778         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6779     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6780         88  CERT-AS-LOADED                   VALUE ' '.
  6781         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6782         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6783         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6784         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6785         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6786         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6787         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6788
  6789     12  CM-ACCOUNT-COMM-PCTS.
  6790         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6791         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6792
  6793     12  CM-USER-FIELD                     PIC X.
  6794     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6795     12  CM-CLP-STATE                      PIC XX.
  6796     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6797     12  CM-USER-RESERVED                  PIC XXX.
  6798     12  FILLER REDEFINES CM-USER-RESERVED.
  6799         16  CM-AH-CLASS-CD                PIC XX.
  6800         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 126
* EL6311.cbl
  6801******************************************************************
  6802*                                COPY ERCNOTE.
  6803******************************************************************
  6804*                                                                *
  6805*                                                                *
  6806*                            ERCNOTE                             *
  6807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6808*                            VMOD=2.003                          *
  6809*                                                                *
  6810*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6811*                                                                *
  6812*        FILE TYPE= VSAM,KSDS                                    *
  6813*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6814*                                                                *
  6815*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6816*                                                                *
  6817*        LOG = YES                                               *
  6818*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6819*                                                                *
  6820******************************************************************
  6821*                   C H A N G E   L O G
  6822*
  6823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6824*-----------------------------------------------------------------
  6825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6826* EFFECTIVE    NUMBER
  6827*-----------------------------------------------------------------
  6828* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6829*                                FILE WILL CONTAIN BILLING NOTES O
  6830******************************************************************
  6831
  6832 01  CERTIFICATE-NOTE.
  6833     12  CN-RECORD-ID                PIC  XX.
  6834         88  VALID-CN-ID                  VALUE 'CN'.
  6835
  6836     12  CN-CONTROL-PRIMARY.
  6837         16  CN-COMPANY-CD           PIC X.
  6838         16  CN-CARRIER              PIC X.
  6839         16  CN-GROUPING.
  6840             20 CN-GROUPING-PREFIX   PIC XXX.
  6841             20 CN-GROUPING-PRIME    PIC XXX.
  6842         16  CN-STATE                PIC XX.
  6843         16  CN-ACCOUNT.
  6844             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6845             20 CN-ACCOUNT-PRIME     PIC X(6).
  6846         16  CN-CERT-EFF-DT          PIC XX.
  6847         16  CN-CERT-NO.
  6848             20  CN-CERT-PRIME       PIC X(10).
  6849             20  CN-CERT-SFX         PIC X.
  6850
  6851     12  CN-BILLING-START-LINE-NO    PIC 99.
  6852     12  CN-BILLING-END-LINE-NO      PIC 99.
  6853
  6854     12  CN-LINES.
  6855         16  CN-LINE OCCURS 10       PIC X(77).
  6856
  6857     12  CN-LAST-MAINT-DT            PIC XX.
  6858     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 127
* EL6311.cbl
  6859     12  CN-LAST-MAINT-USER          PIC X(4).
  6860     12  FILLER                      PIC X(6).
  6861******************************************************************
  6862*                                COPY ERCPNDM.
  6863******************************************************************
  6864*                                                                *
  6865*                                                                *
  6866*                            ERCPNDM                             *
  6867*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6868*                            VMOD=2.003                          *
  6869*                                                                *
  6870*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6871*                                                                *
  6872*   FILE TYPE = VSAM,KSDS                                        *
  6873*   RECORD SIZE = 374   RECFORM = FIX                            *
  6874*                                                                *
  6875*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6876*   ALTERNATE PATH    = NOT USED                                 *
  6877*                                                                *
  6878*   LOG = YES                                                    *
  6879*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6880******************************************************************
  6881*                   C H A N G E   L O G
  6882*
  6883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6884*-----------------------------------------------------------------
  6885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6886* EFFECTIVE    NUMBER
  6887*-----------------------------------------------------------------
  6888* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6889* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6890* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6891* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6892******************************************************************
  6893
  6894 01  PENDING-MAILING-DATA.
  6895     12  PM-RECORD-ID                      PIC XX.
  6896         88  VALID-MA-ID                       VALUE 'PM'.
  6897
  6898     12  PM-CONTROL-PRIMARY.
  6899         16  PM-COMPANY-CD                 PIC X.
  6900         16  PM-ENTRY-BATCH                PIC X(6).
  6901         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6902         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6903
  6904     12  FILLER                            PIC X(14).
  6905
  6906     12  PM-ACCESS-CONTROL.
  6907         16  PM-SOURCE-SYSTEM              PIC XX.
  6908             88  PM-FROM-CREDIT                VALUE 'CR'.
  6909             88  PM-FROM-VSI                   VALUE 'VS'.
  6910             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6911             88  PM-FROM-OTHER                 VALUE 'OT'.
  6912         16  PM-RECORD-ADD-DT              PIC XX.
  6913         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6914         16  PM-LAST-MAINT-DT              PIC XX.
  6915         16  PM-LAST-MAINT-BY              PIC XXXX.
  6916         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 128
* EL6311.cbl
  6917
  6918     12  PM-PROFILE-INFO.
  6919         16  PM-QUALIFY-CODE-1             PIC XX.
  6920         16  PM-QUALIFY-CODE-2             PIC XX.
  6921         16  PM-QUALIFY-CODE-3             PIC XX.
  6922         16  PM-QUALIFY-CODE-4             PIC XX.
  6923         16  PM-QUALIFY-CODE-5             PIC XX.
  6924
  6925         16  PM-INSURED-LAST-NAME          PIC X(15).
  6926         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6927         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6928         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6929         16  PM-INSURED-BIRTH-DT           PIC XX.
  6930         16  PM-INSURED-SEX                PIC X.
  6931             88  PM-SEX-MALE                   VALUE 'M'.
  6932             88  PM-SEX-FEMALE                 VALUE 'F'.
  6933         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6934
  6935         16  PM-ADDRESS-CORRECTED          PIC X.
  6936         16  PM-JOINT-BIRTH-DT             PIC XX.
  6937*        16  FILLER                        PIC X(12).
  6938
  6939         16  PM-ADDRESS-LINE-1             PIC X(30).
  6940         16  PM-ADDRESS-LINE-2             PIC X(30).
  6941         16  PM-CITY-STATE.
  6942             20  PM-CITY                   PIC X(28).
  6943             20  PM-STATE                  PIC XX.
  6944         16  PM-ZIP.
  6945             20  PM-ZIP-CODE.
  6946                 24  PM-ZIP-1              PIC X.
  6947                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6948                 24  FILLER                PIC X(4).
  6949             20  PM-ZIP-PLUS4              PIC X(4).
  6950         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6951             20  PM-CAN-POST1              PIC XXX.
  6952             20  PM-CAN-POST2              PIC XXX.
  6953             20  FILLER                    PIC XXX.
  6954
  6955         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6956         16  pm-city-st-zip-verified       pic x.
  6957         16  FILLER                        PIC XX.
  6958
  6959     12  PM-CRED-BENE-INFO.
  6960         16  PM-CRED-BENE-NAME             PIC X(25).
  6961         16  PM-CRED-BENE-ADDR             PIC X(30).
  6962         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6963         16  PM-CRED-BENE-CTYST.
  6964             20  PM-CRED-BENE-CITY         PIC X(28).
  6965             20  PM-CRED-BENE-STATE        PIC XX.
  6966         16  PM-CRED-BENE-ZIP.
  6967             20  PM-CB-ZIP-CODE.
  6968                 24  PM-CB-ZIP-1           PIC X.
  6969                     88  PM-CB-CANADIAN-POST-CODE
  6970                                  VALUE 'A' THRU 'Z'.
  6971                 24  FILLER                PIC X(4).
  6972             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6973         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6974             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 129
* EL6311.cbl
  6975             20  PM-CB-CAN-POST2           PIC XXX.
  6976             20  FILLER                    PIC XXX.
  6977     12  PM-POST-CARD-MAIL-DATA.
  6978         16  PM-MAIL-DATA OCCURS 7.
  6979             20  PM-MAIL-TYPE              PIC X.
  6980                 88  PM-12MO-MAILING           VALUE '1'.
  6981                 88  PM-EXP-MAILING            VALUE '2'.
  6982             20  PM-MAIL-STATUS            PIC X.
  6983                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6984                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6985                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6986             20  PM-MAIL-DATE              PIC XX.
  6987     12  FILLER                            PIC XX.
  6988     12  FILLER                            PIC X(12).
  6989*    12  FILLER                            PIC X(30).
  6990
  6991******************************************************************
  6992*                                COPY ERCMAIL.
  6993******************************************************************
  6994*                                                                *
  6995*                                                                *
  6996*                            ERCMAIL                             *
  6997*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6998*                            VMOD=2.003                          *
  6999*                                                                *
  7000*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7001*                                                                *
  7002*   FILE TYPE = VSAM,KSDS                                        *
  7003*   RECORD SIZE = 374   RECFORM = FIX                            *
  7004*                                                                *
  7005*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7006*   ALTERNATE PATH    = NOT USED                                 *
  7007*                                                                *
  7008*   LOG = YES                                                    *
  7009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7010******************************************************************
  7011*                   C H A N G E   L O G
  7012*
  7013* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7014*-----------------------------------------------------------------
  7015*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7016* EFFECTIVE    NUMBER
  7017*-----------------------------------------------------------------
  7018* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7019* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7020* 111108                   PEMA  ADD CRED BENE ADDR2
  7021******************************************************************
  7022
  7023 01  MAILING-DATA.
  7024     12  MA-RECORD-ID                      PIC XX.
  7025         88  VALID-MA-ID                       VALUE 'MA'.
  7026
  7027     12  MA-CONTROL-PRIMARY.
  7028         16  MA-COMPANY-CD                 PIC X.
  7029         16  MA-CARRIER                    PIC X.
  7030         16  MA-GROUPING.
  7031             20  MA-GROUPING-PREFIX        PIC XXX.
  7032             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 130
* EL6311.cbl
  7033         16  MA-STATE                      PIC XX.
  7034         16  MA-ACCOUNT.
  7035             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7036             20  MA-ACCOUNT-PRIME          PIC X(6).
  7037         16  MA-CERT-EFF-DT                PIC XX.
  7038         16  MA-CERT-NO.
  7039             20  MA-CERT-PRIME             PIC X(10).
  7040             20  MA-CERT-SFX               PIC X.
  7041
  7042     12  FILLER                            PIC XX.
  7043
  7044     12  MA-ACCESS-CONTROL.
  7045         16  MA-SOURCE-SYSTEM              PIC XX.
  7046             88  MA-FROM-CREDIT                VALUE 'CR'.
  7047             88  MA-FROM-VSI                   VALUE 'VS'.
  7048             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7049             88  MA-FROM-OTHER                 VALUE 'OT'.
  7050         16  MA-RECORD-ADD-DT              PIC XX.
  7051         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7052         16  MA-LAST-MAINT-DT              PIC XX.
  7053         16  MA-LAST-MAINT-BY              PIC XXXX.
  7054         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7055
  7056     12  MA-PROFILE-INFO.
  7057         16  MA-QUALIFY-CODE-1             PIC XX.
  7058         16  MA-QUALIFY-CODE-2             PIC XX.
  7059         16  MA-QUALIFY-CODE-3             PIC XX.
  7060         16  MA-QUALIFY-CODE-4             PIC XX.
  7061         16  MA-QUALIFY-CODE-5             PIC XX.
  7062
  7063         16  MA-INSURED-LAST-NAME          PIC X(15).
  7064         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7065         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7066         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7067         16  MA-INSURED-BIRTH-DT           PIC XX.
  7068         16  MA-INSURED-SEX                PIC X.
  7069             88  MA-SEX-MALE                   VALUE 'M'.
  7070             88  MA-SEX-FEMALE                 VALUE 'F'.
  7071         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7072
  7073         16  MA-ADDRESS-CORRECTED          PIC X.
  7074         16  MA-JOINT-BIRTH-DT             PIC XX.
  7075*        16  FILLER                        PIC X(12).
  7076
  7077         16  MA-ADDRESS-LINE-1             PIC X(30).
  7078         16  MA-ADDRESS-LINE-2             PIC X(30).
  7079         16  MA-CITY-STATE.
  7080             20  MA-CITY                   PIC X(28).
  7081             20  MA-ADDR-STATE             PIC XX.
  7082         16  MA-ZIP.
  7083             20  MA-ZIP-CODE.
  7084                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7085                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7086                 24  FILLER                PIC X(4).
  7087             20  MA-ZIP-PLUS4              PIC X(4).
  7088         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7089             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7090             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 131
* EL6311.cbl
  7091             20  FILLER                    PIC X(3).
  7092
  7093         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7094
  7095         16  FILLER                        PIC XXX.
  7096*        16  FILLER                        PIC X(10).
  7097
  7098     12  MA-CRED-BENE-INFO.
  7099         16  MA-CRED-BENE-NAME                 PIC X(25).
  7100         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7101         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7102         16  MA-CRED-BENE-CTYST.
  7103             20  MA-CRED-BENE-CITY             PIC X(28).
  7104             20  MA-CRED-BENE-STATE            PIC XX.
  7105         16  MA-CRED-BENE-ZIP.
  7106             20  MA-CB-ZIP-CODE.
  7107                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7108                     88  MA-CB-CANADIAN-POST-CODE
  7109                                           VALUE 'A' THRU 'Z'.
  7110                 24  FILLER                    PIC X(4).
  7111             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7112         16  MA-CB-CANADIAN-POSTAL-CODE
  7113                            REDEFINES MA-CRED-BENE-ZIP.
  7114             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7115             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7116             20  FILLER                        PIC X(3).
  7117     12  MA-POST-CARD-MAIL-DATA.
  7118         16  MA-MAIL-DATA OCCURS 7.
  7119             20  MA-MAIL-TYPE              PIC X.
  7120                 88  MA-12MO-MAILING           VALUE '1'.
  7121                 88  MA-EXP-MAILING            VALUE '2'.
  7122             20  MA-MAIL-STATUS            PIC X.
  7123                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7124                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7125                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7126             20  MA-MAIL-DATE              PIC XX.
  7127     12  FILLER                            PIC XX.
  7128     12  FILLER                            PIC XX.
  7129*    12  FILLER                            PIC X(30).
  7130******************************************************************
  7131*                                COPY ERCRQST.
  7132******************************************************************
  7133*                                                                *
  7134*                                                                *
  7135*                            ERCRQST.                            *
  7136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7137*                            VMOD=2.002                          *
  7138*                                                                *
  7139*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7140*                                                                *
  7141*   FILE TYPE = VSAM,KSDS                                        *
  7142*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7143*                                                                *
  7144*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7145*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7146*                                   ACCOUNT, REF, BATCH)         *
  7147*                                                RKP=9, LEN=38   *
  7148*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 132
* EL6311.cbl
  7149*                                   ACCOUNT, REF, BATCH)         *
  7150*                                                RKP=47, LEN=46  *
  7151*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7152*                                   BATCH)                       *
  7153*                                                RKP=93, LEN=24  *
  7154*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7155*                                   REF, BATCH)                  *
  7156*                                                RKP=117, LEN=35 *
  7157*   LOG = NO                                                     *
  7158*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7159******************************************************************
  7160
  7161 01  AR-REQUEST-RECORD.
  7162     12  RQ-RECORD-ID                     PIC XX.
  7163         88  VALID-RQ-ID                        VALUE 'RQ'.
  7164
  7165     12  RQ-CONTROL-PRIMARY.
  7166         16  RQ-COMPANY-CD                PIC X.
  7167         16  RQ-ENTRY-BATCH               PIC X(6).
  7168
  7169     12  RQ-CONTROL-BY-ACCT-REF.
  7170         16  RQ-COMPANY-CD-A1             PIC X.
  7171         16  RQ-CARRIER-A1                PIC X.
  7172         16  RQ-GROUPING-A1               PIC X(6).
  7173         16  RQ-STATE-A1                  PIC XX.
  7174         16  RQ-ACCOUNT-A1                PIC X(10).
  7175         16  RQ-REFERENCE-A1              PIC X(12).
  7176         16  RQ-BATCH-A1                  PIC X(6).
  7177
  7178     12  RQ-CONTROL-BY-FIN-RESP.
  7179         16  RQ-COMPANY-CD-A2             PIC X.
  7180         16  RQ-CARRIER-A2                PIC X.
  7181         16  RQ-GROUPING-A2               PIC X(6).
  7182         16  RQ-FIN-RESP-A2               PIC X(10).
  7183         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7184         16  RQ-REFERENCE-A2              PIC X(12).
  7185         16  RQ-BATCH-A2                  PIC X(6).
  7186
  7187     12  RQ-CONTROL-BY-ACCT-AGENT.
  7188         16  RQ-COMPANY-CD-A3             PIC X.
  7189         16  RQ-CARRIER-A3                PIC X.
  7190         16  RQ-GROUPING-A3               PIC X(6).
  7191         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7192         16  RQ-BATCH-A3                  PIC X(6).
  7193
  7194     12  RQ-CONTROL-BY-SUMMARY.
  7195         16  RQ-COMPANY-CD-A4             PIC X.
  7196         16  RQ-SUMMARY-CODE              PIC X(6).
  7197         16  RQ-ACCOUNT-A4                PIC X(10).
  7198         16  RQ-REFERENCE-A4              PIC X(12).
  7199         16  RQ-BATCH-A4                  PIC X(6).
  7200
  7201     12  RQ-REQUEST-METHOD                PIC X.
  7202         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7203         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7204         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7205         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7206     12  FILLER                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 133
* EL6311.cbl
  7207     12  RQ-STATUS                        PIC X.
  7208         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7209         88  RQ-RESUBMIT                      VALUE 'R'.
  7210     12  RQ-PROCESSOR-ID                  PIC X(4).
  7211     12  RQ-ENTRY-DT                      PIC XX.
  7212     12  RQ-MO-END-DT                     PIC XX.
  7213     12  RQ-REQUEST-DT                    PIC XX.
  7214     12  RQ-STMT-DT                       PIC XX.
  7215     12  RQ-REVERSAL-DT                   PIC XX.
  7216     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7217     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7218
  7219     12  FILLER                           PIC X(27).
  7220
  7221******************************************************************
  7222
  7223*                                COPY ERCLOFC.
  7224******************************************************************
  7225*                                                                *
  7226*                                                                *
  7227*                            ERCLOFC                             *
  7228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7229*                            VMOD=2.003                          *
  7230*                                                                *
  7231*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7232*                                                                *
  7233*   FILE TYPE = VSAM,KSDS                                        *
  7234*   RECORD SIZE = 670   RECFORM = FIX                            *
  7235*                                                                *
  7236*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7237*                                                                *
  7238*   LOG = YES                                                    *
  7239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7240*                                                                *
  7241******************************************************************
  7242
  7243 01  LOAN-OFFICER-MASTER.
  7244     12  LO-RECORD-ID                PIC XX.
  7245         88  VALID-LO-ID                VALUE 'LO'.
  7246
  7247     12  LO-CONTROL-PRIMARY.
  7248         16  LO-COMPANY-CD           PIC X.
  7249         16  LO-CARRIER              PIC X.
  7250         16  LO-GROUPING.
  7251             20  LO-GROUPING-PREFIX  PIC XXX.
  7252             20  LO-GROUPING-PRIME   PIC XXX.
  7253         16  LO-STATE                PIC XX.
  7254         16  LO-ACCOUNT.
  7255             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7256             20  LO-ACCOUNT-PRIME    PIC X(6).
  7257         16  LO-OFFICER-CODE         PIC X(5).
  7258
  7259     12  LO-OFFICER-NAME             PIC X(30).
  7260
  7261     12  LO-LAST-MAINT-DT            PIC XX.
  7262     12  LO-LAST-USER                PIC X(4).
  7263     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7264
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 134
* EL6311.cbl
  7265     12  LO-COMP-CONTROL             PIC X.
  7266             88  LO-SHOW-COMP           VALUE 'Y'.
  7267             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7268     12  LO-DETAIL-CONTROL           PIC X.
  7269             88  LO-PRINT-DETAIL        VALUE 'D'.
  7270             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7271
  7272     12  LO-SV-CARRIER               PIC X.
  7273     12  LO-SV-GROUPING              PIC X(6).
  7274     12  LO-SV-STATE                 PIC XX.
  7275
  7276     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7277     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7278
  7279     12  LO-OFFICER-INFO.
  7280         16  FILLER OCCURS 12 TIMES.
  7281             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7282             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7283             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7284             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7285             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7286             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7287             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7288             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7289     12  FILLER                      PIC X(198).
  7290******************************************************************
  7291*                                COPY ERCPYAJ.
  7292******************************************************************
  7293*                                                                *
  7294*                            ERCPYAJ                             *
  7295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7296*                            VMOD=2.015                          *
  7297*                                                                *
  7298*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7299*                                                                *
  7300*                                                                *
  7301*   FILE TYPE = VSAM,KSDS                                        *
  7302*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7303*                                                                *
  7304*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7305*       ALTERNATE PATHS = NONE                                   *
  7306*                                                                *
  7307*   LOG = YES                                                    *
  7308*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7309******************************************************************
  7310******************************************************************
  7311*                   C H A N G E   L O G
  7312*
  7313* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7314*-----------------------------------------------------------------
  7315*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7316* EFFECTIVE    NUMBER
  7317*-----------------------------------------------------------------
  7318* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7319* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7320******************************************************************
  7321
  7322 01  PENDING-PAY-ADJ.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 135
* EL6311.cbl
  7323     12  PY-RECORD-ID                     PIC XX.
  7324         88  VALID-PY-ID                        VALUE 'PY'.
  7325
  7326     12  PY-CONTROL-PRIMARY.
  7327         16  PY-COMPANY-CD                PIC X.
  7328         16  PY-CARRIER                   PIC X.
  7329         16  PY-GROUPING                  PIC X(6).
  7330         16  PY-FIN-RESP                  PIC X(10).
  7331         16  PY-ACCOUNT                   PIC X(10).
  7332         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7333                                          PIC X(10).
  7334         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7335         16  PY-RECORD-TYPE               PIC X.
  7336             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7337             88  PY-DEPOSIT                   VALUE 'D'.
  7338             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7339             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7340             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7341             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7342             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7343             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7344             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7345             88  PY-FICA-ENTRY                VALUE 'F'.
  7346             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7347             88  PY-POLICY-FEE                VALUE 'W'.
  7348             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7349
  7350     12  PY-PYMT-TYPE                     PIC X.
  7351             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7352             88  PY-REINS-PYMT                VALUE 'R'.
  7353             88  PY-EXP-PYMT                  VALUE 'E'.
  7354
  7355     12  PY-BIL-INV                       PIC X(6).
  7356     12  PY-REF-NO                        PIC X(12).
  7357
  7358     12  PY-LAST-MAINT-DT                 PIC XX.
  7359     12  PY-LAST-MAINT-BY                 PIC X(4).
  7360     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7361
  7362     12  PY-PYADJ-RECORD.
  7363         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7364         16  PY-ENTRY-COMMENT             PIC X(30).
  7365         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7366             20  PY-GL-ACCOUNT            PIC X(10).
  7367             20  PY-GL-STATE              PIC X(02).
  7368             20  PY-GL-CANC-SW            PIC X(01).
  7369                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7370                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7371             20  PY-GL-COMMENT            PIC X(10).
  7372             20  FILLER      REDEFINES PY-GL-COMMENT.
  7373                 24  PY-GL-CHECK-NO       PIC 9(06).
  7374                 24  FILLER               PIC X(04).
  7375             20  FILLER                   PIC X(07).
  7376         16  PY-SAVE-ACCOUNT              PIC X(10).
  7377         16  PY-SAVE-TYPE                 PIC X(01).
  7378
  7379         16  PY-LETTERS.
  7380             20  PY-LETTER OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 136
* EL6311.cbl
  7381                           INDEXED BY PY-LET-NDX
  7382                                          PIC X(04).
  7383
  7384         16  PY-ERCOMP-TYPE               PIC X.
  7385             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7386             88  PY-GA-TYPE                   VALUE 'G'.
  7387             88  PY-BANK-TYPE                 VALUE 'B'.
  7388         16  FILLER                       PIC X(05).
  7389
  7390     12  PY-RECORD-STATUS.
  7391         16  PY-CREDIT-SELECT-DT          PIC XX.
  7392         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7393         16  PY-BILLED-DATE               PIC XX.
  7394         16  PY-REPORTED-DT               PIC XX.
  7395         16  PY-PMT-APPLIED               PIC X.
  7396             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7397             88  PY-GA-PMT                    VALUE 'G'.
  7398             88  PY-OVWRITE-PMT               VALUE 'O'.
  7399             88  PY-NON-AR-PMT                VALUE 'N'.
  7400         16  FILLER                       PIC X(5).
  7401         16  PY-INPUT-DT                  PIC XX.
  7402         16  PY-CHECK-NUMBER              PIC X(6).
  7403         16  PY-VOID-SW                   PIC X.
  7404             88  PY-CHECK-VOIDED              VALUE 'V'.
  7405         16  PY-CHECK-ORIGIN-SW           PIC X.
  7406             88  PY-BILLING-CHECK             VALUE 'B'.
  7407             88  PY-REFUND-CHECK              VALUE 'R'.
  7408             88  PY-GA-CHECK                  VALUE 'G'.
  7409             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7410             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7411         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7412         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7413         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7414         16  PY-BILL-FLAG                 PIC X.
  7415             88  PY-BILLED                    VALUE 'B'.
  7416         16  PY-AR-FLAG                   PIC X.
  7417             88  PY-AR-CYCLE                  VALUE 'C'.
  7418             88  PY-AR-MONTH-END              VALUE 'M'.
  7419         16  PY-AR-DATE                   PIC XX.
  7420
  7421     12  PY-GL-CODES.
  7422         16  PY-GL-DB                     PIC X(14).
  7423         16  PY-GL-CR                     PIC X(14).
  7424         16  PY-GL-FLAG                   PIC X.
  7425         16  PY-GL-DATE                   PIC XX.
  7426
  7427     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7428     12  FILLER                           PIC X(3).
  7429******************************************************************
  7430*                                COPY ERCCNOT.
  7431******************************************************************
  7432*                                                                *
  7433*                            ERCCNOT                             *
  7434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7435*                            VMOD=2.003                          *
  7436*                                                                *
  7437*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7438*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 137
* EL6311.cbl
  7439*        FILE TYPE= VSAM,KSDS                                    *
  7440*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7441*                                                                *
  7442*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7443*                                                                *
  7444*        LOG = YES                                               *
  7445*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7446*                                                                *
  7447******************************************************************
  7448*                   C H A N G E   L O G
  7449*
  7450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7451*-----------------------------------------------------------------
  7452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7453* EFFECTIVE    NUMBER
  7454*-----------------------------------------------------------------
  7455* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7456******************************************************************
  7457
  7458 01  CERT-NOTE-FILE.
  7459     12  CZ-RECORD-ID                PIC  XX.
  7460         88  VALID-CZ-ID                  VALUE 'CZ'.
  7461
  7462     12  CZ-CONTROL-PRIMARY.
  7463         16  CZ-COMPANY-CD           PIC X.
  7464         16  CZ-CARRIER              PIC X.
  7465         16  CZ-GROUPING.
  7466             20 CZ-GROUPING-PREFIX   PIC XXX.
  7467             20 CZ-GROUPING-PRIME    PIC XXX.
  7468         16  CZ-STATE                PIC XX.
  7469         16  CZ-ACCOUNT.
  7470             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7471             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7472         16  CZ-CERT-EFF-DT          PIC XX.
  7473         16  CZ-CERT-NO.
  7474             20  CZ-CERT-PRIME       PIC X(10).
  7475             20  CZ-CERT-SFX         PIC X.
  7476         16  CZ-RECORD-TYPE          PIC X.
  7477             88  CERT-NOTE           VALUE '1'.
  7478             88  CLAIM-CERT-NOTE     VALUE '2'.
  7479         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7480
  7481     12  CZ-LAST-MAINT-DT            PIC XX.
  7482     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7483     12  CZ-LAST-MAINT-USER          PIC X(4).
  7484
  7485     12  CZ-NOTE-INFORMATION.
  7486         16  CZ-NOTE                 PIC X(63).
  7487         16  FILLER                  PIC X(39).
  7488******************************************************************
  7489*                                COPY ELCMSTR.
  7490******************************************************************
  7491*                                                                *
  7492*                            ELCMSTR.                            *
  7493*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7494*                            VMOD=2.012                          *
  7495*                                                                *
  7496*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 138
* EL6311.cbl
  7497*                                                                *
  7498*   FILE TYPE = VSAM,KSDS                                        *
  7499*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7500*                                                                *
  7501*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7502*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7503*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7504*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7505*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7506*                                                 RKP=75,LEN=21  *
  7507*                                                                *
  7508*   **** NOTE ****                                               *
  7509*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7510*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7511*                                                                *
  7512*   LOG = YES                                                    *
  7513*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7514******************************************************************
  7515*                   C H A N G E   L O G
  7516*
  7517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7518*-----------------------------------------------------------------
  7519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7520* EFFECTIVE    NUMBER
  7521*-----------------------------------------------------------------
  7522* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7523* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7524* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7525* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7526* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7527* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7528******************************************************************
  7529 01  CLAIM-MASTER.
  7530     12  CL-RECORD-ID                PIC XX.
  7531         88  VALID-CL-ID         VALUE 'CL'.
  7532
  7533     12  CL-CONTROL-PRIMARY.
  7534         16  CL-COMPANY-CD           PIC X.
  7535         16  CL-CARRIER              PIC X.
  7536         16  CL-CLAIM-NO             PIC X(7).
  7537         16  CL-CERT-NO.
  7538             20  CL-CERT-PRIME       PIC X(10).
  7539             20  CL-CERT-SFX         PIC X.
  7540
  7541     12  CL-CONTROL-BY-NAME.
  7542         16  CL-COMPANY-CD-A1        PIC X.
  7543         16  CL-INSURED-LAST-NAME    PIC X(15).
  7544         16  CL-INSURED-NAME.
  7545             20  CL-INSURED-1ST-NAME PIC X(12).
  7546             20  CL-INSURED-MID-INIT PIC X.
  7547
  7548     12  CL-CONTROL-BY-SSN.
  7549         16  CL-COMPANY-CD-A2        PIC X.
  7550         16  CL-SOC-SEC-NO.
  7551             20  CL-SSN-STATE        PIC XX.
  7552             20  CL-SSN-ACCOUNT      PIC X(6).
  7553             20  CL-SSN-LN3          PIC X(3).
  7554
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 139
* EL6311.cbl
  7555     12  CL-CONTROL-BY-CERT-NO.
  7556         16  CL-COMPANY-CD-A4        PIC X.
  7557         16  CL-CERT-NO-A4.
  7558             20  CL-CERT-A4-PRIME    PIC X(10).
  7559             20  CL-CERT-A4-SFX      PIC X.
  7560
  7561     12  CL-CONTROL-BY-CCN.
  7562         16  CL-COMPANY-CD-A5        PIC X.
  7563         16  CL-CCN-A5.
  7564             20  CL-CCN.
  7565                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7566                 24  CL-CCN-PRIME-A5 PIC X(12).
  7567             20  CL-CCN-FILLER-A5    PIC X(4).
  7568
  7569     12  CL-INSURED-PROFILE-DATA.
  7570         16  CL-INSURED-BIRTH-DT     PIC XX.
  7571         16  CL-INSURED-SEX-CD       PIC X.
  7572             88  INSURED-IS-MALE        VALUE 'M'.
  7573             88  INSURED-IS-FEMALE      VALUE 'F'.
  7574             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7575         16  CL-INSURED-OCC-CD       PIC X(6).
  7576         16  FILLER                  PIC X(5).
  7577
  7578     12  CL-PROCESSING-INFO.
  7579         16  CL-PROCESSOR-ID         PIC X(4).
  7580         16  CL-CLAIM-STATUS         PIC X.
  7581             88  CLAIM-IS-OPEN          VALUE 'O'.
  7582             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7583         16  CL-CLAIM-TYPE           PIC X.
  7584*            88  AH-CLAIM               VALUE 'A'.
  7585*            88  LIFE-CLAIM             VALUE 'L'.
  7586*            88  PROPERTY-CLAIM         VALUE 'P'.
  7587*            88  IUI-CLAIM              VALUE 'I'.
  7588*            88  GAP-CLAIM              VALUE 'G'.
  7589*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7590         16  CL-CLAIM-PREM-TYPE      PIC X.
  7591             88  SINGLE-PREMIUM         VALUE '1'.
  7592             88  O-B-COVERAGE           VALUE '2'.
  7593             88  OPEN-END-COVERAGE      VALUE '3'.
  7594         16  CL-INCURRED-DT          PIC XX.
  7595         16  CL-REPORTED-DT          PIC XX.
  7596         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7597         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7598         16  CL-LAST-PMT-DT          PIC XX.
  7599         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7600         16  CL-PAID-THRU-DT         PIC XX.
  7601         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7602         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7603         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7604         16  CL-PMT-CALC-METHOD      PIC X.
  7605             88  CL-360-DAY-YR          VALUE '1'.
  7606             88  CL-365-DAY-YR          VALUE '2'.
  7607             88  CL-FULL-MONTHS         VALUE '3'.
  7608         16  CL-CAUSE-CD             PIC X(6).
  7609
  7610         16  CL-PRIME-CERT-NO.
  7611             20  CL-PRIME-CERT-PRIME PIC X(10).
  7612             20  CL-PRIME-CERT-SFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 140
* EL6311.cbl
  7613
  7614         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7615             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7616             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7617
  7618         16  CL-MICROFILM-NO         PIC X(10).
  7619         16  FILLER REDEFINES CL-MICROFILM-NO.
  7620             20  CL-BENEFIT-PERIOD   PIC 99.
  7621             20  FILLER              PIC X(8).
  7622         16  CL-PROG-FORM-TYPE       PIC X.
  7623         16  CL-LAST-ADD-ON-DT       PIC XX.
  7624
  7625         16  CL-LAST-REOPEN-DT       PIC XX.
  7626         16  CL-LAST-CLOSE-DT        PIC XX.
  7627         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7628             88  FINAL-PAID             VALUE '1'.
  7629             88  CLAIM-DENIED           VALUE '2'.
  7630             88  AUTO-CLOSE             VALUE '3'.
  7631             88  MANUAL-CLOSE           VALUE '4'.
  7632             88  BENEFITS-CHANGED       VALUE 'C'.
  7633             88  SETUP-ERRORS           VALUE 'E'.
  7634         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7635         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7636         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7637             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7638         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7639         16  FILLER                  PIC X.
  7640
  7641     12  CL-CERTIFICATE-DATA.
  7642         16  CL-CERT-ORIGIN          PIC X.
  7643             88  CERT-WAS-ONLINE        VALUE '1'.
  7644             88  CERT-WAS-CREATED       VALUE '2'.
  7645             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7646         16  CL-CERT-KEY-DATA.
  7647             20  CL-CERT-CARRIER     PIC X.
  7648             20  CL-CERT-GROUPING    PIC X(6).
  7649             20  CL-CERT-STATE       PIC XX.
  7650             20  CL-CERT-ACCOUNT.
  7651                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7652                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7653             20  CL-CERT-EFF-DT      PIC XX.
  7654
  7655     12  CL-STATUS-CONTROLS.
  7656         16  CL-PRIORITY-CD          PIC X.
  7657             88  CONFIDENTIAL-DATA      VALUE '8'.
  7658             88  HIGHEST-PRIORITY       VALUE '9'.
  7659         16  CL-SUPV-ATTN-CD         PIC X.
  7660             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7661             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7662         16  CL-PURGED-DT            PIC XX.
  7663         16  CL-RESTORED-DT          PIC XX.
  7664         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7665         16  CL-NEXT-RESEND-DT       PIC XX.
  7666         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7667         16  CL-CRITICAL-PERIOD      PIC 99.
  7668*        16  FILLER                  PIC XX.
  7669         16  CL-LAST-MAINT-DT        PIC XX.
  7670         16  CL-LAST-MAINT-USER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 141
* EL6311.cbl
  7671         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7672         16  CL-LAST-MAINT-TYPE      PIC X.
  7673             88  CLAIM-SET-UP           VALUE ' '.
  7674             88  PAYMENT-MADE           VALUE '1'.
  7675             88  LETTER-SENT            VALUE '2'.
  7676             88  MASTER-WAS-ALTERED     VALUE '3'.
  7677             88  MASTER-WAS-RESTORED    VALUE '4'.
  7678             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7679             88  FILE-CONVERTED         VALUE '6'.
  7680             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7681             88  ERROR-CORRECTION       VALUE 'E'.
  7682         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7683         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7684         16  CL-BENEFICIARY          PIC X(10).
  7685         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7686         16  CL-DENIAL-TYPE          PIC X.
  7687             88  CL-TYPE-DENIAL          VALUE '1'.
  7688             88  CL-TYPE-RESCISSION      VALUE '2'.
  7689             88  CL-TYPE-REFORMATION     VALUE '3'.
  7690             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7691             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7692         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7693         16  filler                  pic x(3).
  7694*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7695*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7696*        16  CL-RTW-DT               PIC XX.
  7697
  7698     12  CL-TRAILER-CONTROLS.
  7699         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7700             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7701             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7702             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7703         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7704         16  FILLER                  PIC XX.
  7705         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7706         16  CL-ADDRESS-TRAILER-CNT.
  7707             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7708                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7709             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7710                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7711             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7712                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7713             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7714                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7715             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7716                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7717             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7718                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7719             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7720                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7721
  7722     12  CL-CV-REFERENCE-NO.
  7723         16  CL-CV-REFNO-PRIME       PIC X(18).
  7724         16  CL-CV-REFNO-SFX         PIC XX.
  7725
  7726     12  CL-FILE-LOCATION            PIC X(4).
  7727
  7728     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 142
* EL6311.cbl
  7729         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7730             88  NO-FATAL-ERRORS        VALUE ZERO.
  7731         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7732             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7733
  7734     12  CL-PRODUCT-CD               PIC X.
  7735
  7736     12  CL-CURRENT-KEY-DATA.
  7737         16  CL-CURRENT-CARRIER      PIC X.
  7738         16  CL-CURRENT-GROUPING     PIC X(6).
  7739         16  CL-CURRENT-STATE        PIC XX.
  7740         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7741
  7742     12  CL-ASSOCIATES               PIC X.
  7743         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7744         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7745         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7746         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7747
  7748     12  CL-ACTIVITY-CODE            PIC 99.
  7749     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7750     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7751
  7752     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7753     12  CL-LAG-REPORT-CODE          PIC 9.
  7754     12  CL-LOAN-TYPE                PIC XX.
  7755     12  CL-LEGAL-STATE              PIC XX.
  7756
  7757     12  CL-YESNOSW                  PIC X.
  7758     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7759         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7760         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7761         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7762     12  cl-insured-type             pic x.
  7763         88  cl-claim-on-primary         value 'P'.
  7764         88  cl-claim-on-co-borrower     value 'C'.
  7765     12  cl-benefit-expiration-dt    PIC XX.
  7766*                                COPY ERCENDT.
  7767******************************************************************
  7768*                                                                *
  7769*                                                                *
  7770*                            ERCENDT.                            *
  7771*                            VMOD=2.001                          *
  7772*                                                                *
  7773*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7774*                                                                *
  7775*   FILE TYPE = VSAM,KSDS                                        *
  7776*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7777*                                                                *
  7778*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7779*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7780*                                                                *
  7781*   LOG = NO                                                     *
  7782*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7783******************************************************************
  7784*-----------------------------------------------------------------
  7785*                   C H A N G E   L O G
  7786*
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 143
* EL6311.cbl
  7787* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7788*-----------------------------------------------------------------
  7789*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7790* EFFECTIVE    NUMBER
  7791*-----------------------------------------------------------------
  7792* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7793*                                WITH OPEN CLAIMS
  7794* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7795* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7796* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7797* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7798*-----------------------------------------------------------------
  7799 01  ENDORSEMENT-RECORD.
  7800     12  EN-RECORD-ID                PIC XX.
  7801         88  VALID-EN-ID                VALUE 'EN'.
  7802     12  EN-CONTROL-PRIMARY.
  7803         16  EN-COMPANY-CD           PIC X.
  7804         16  EN-CARRIER              PIC X.
  7805         16  EN-GROUPING             PIC X(6).
  7806         16  EN-STATE                PIC XX.
  7807         16  EN-ACCOUNT              PIC X(10).
  7808         16  EN-CERT-EFF-DT          PIC XX.
  7809         16  EN-CERT-NO.
  7810             20  EN-CERT-PRIME       PIC X(10).
  7811             20  EN-CERT-SFX         PIC X.
  7812         16  EN-REC-TYPE             PIC X.
  7813             88  EN-ISSUE               VALUE 'I'.
  7814             88  EN-CANCELLATION        VALUE 'C'.
  7815         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7816     12  EN-CONTROL-BY-ARCH-NO.
  7817         16  EN-COMPANY-CD-A1              PIC X.
  7818         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7819     12  EN-LAST-MAINT-DT            PIC XX.
  7820     12  EN-LAST-MAINT-BY            PIC X(4).
  7821     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7822     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7823     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7824         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7825         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7826         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7827         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7828         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7829         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7830         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7831         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7832         16  EN-LF-ORIG-BENCD        PIC XX.
  7833         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7834         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7835         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7836         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7837         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7838         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7839*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7840         16  EN-ORIG-CRED-BENE       PIC X(25).
  7841         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7842         16  FILLER                  PIC X.
  7843         16  EN-AH-ORIG-BENCD        PIC XX.
  7844         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 144
* EL6311.cbl
  7845         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7846         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7847         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7848*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7849*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7850         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7851         16  F                       PIC X(09).
  7852         16  EN-AH-ORIG-CP           PIC 99.
  7853         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7854         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7855         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7856         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7857         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7858         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7859         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7860         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7861         16  EN-LF-NEW-BENCD         PIC XX.
  7862         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7863         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7864         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7865         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7866         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7867         16  EN-LF-NEW-EXP-DT        PIC XX.
  7868         16  EN-NEW-CRED-BENE        PIC X(25).
  7869         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7870         16  FILLER                  PIC X.
  7871         16  EN-AH-NEW-BENCD         PIC XX.
  7872         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7873         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7874         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7875         16  EN-AH-NEW-EXP-DT        PIC XX.
  7876*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7877*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7878*        16  F                       PIC X(12).
  7879         16  EN-AH-NEW-CP            PIC 99.
  7880         16  EN-SIG-SW               PIC X.
  7881         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7882         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7883         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7884         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7885         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7886         16  FILLER                  PIC X(33).
  7887     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7888         16  EN-LF-ORIG-REF-DT       PIC XX.
  7889         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7890         16  EN-AH-ORIG-REF-DT       PIC XX.
  7891         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7892         16  EN-LF-NEW-REF-DT        PIC XX.
  7893         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7894         16  EN-AH-NEW-REF-DT        PIC XX.
  7895         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7896         16  EN-FLAG-CERT            PIC X.
  7897         16  EN-INS-LAST-NAME        PIC X(15).
  7898         16  EN-INS-FIRST-NAME       PIC X(10).
  7899         16  EN-INS-MIDDLE-INIT      PIC X.
  7900         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7901         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7902         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 145
* EL6311.cbl
  7903         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7904         16  FILLER                  PIC X(262).
  7905     12  EN-MONEY-SW             PIC X.
  7906     12  EN-HEALTH-APP           PIC X.
  7907     12  EN-VOUCHER-SW           PIC X.
  7908     12  EN-PAYEE                PIC X(14).
  7909     12  EN-INPUT-DT             PIC XX.
  7910     12  EN-PROCESS-DT           PIC XX.
  7911     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7912     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7913     12  EN-REASON-CODES.
  7914         16  F OCCURS 12.
  7915             20  EN-REASON-CODE  PIC X(4).
  7916     12  EN-TEMPLATE-USED        PIC X(8).
  7917     12  EN-DOCU-TYPE            PIC X.
  7918         88  EN-VERI-DOCU          VALUE 'V'.
  7919         88  EN-GCE-DOCU           VALUE 'G'.
  7920         88  EN-CANC-DOCU          VALUE 'C'.
  7921     12  EN-COMMENTS1            PIC X(13).
  7922     12  EN-COMMENTS2            PIC X(70).
  7923     12  EN-COMM-CHGBK           PIC X.
  7924         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7925         88  EN-CHG-ACCT           VALUE 'Y'.
  7926     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7927     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7928     12  EN-BATCH-NUMBER         PIC X(6).
  7929     12  EN-ACCT-SUMM            PIC X.
  7930     12  EN-CSO-SUMM             PIC X.
  7931     12  en-check-type           pic x.
  7932     12  FILLER                  PIC X(12).
  7933******************************************************************
  7934*                                COPY ELCCRTT.
  7935******************************************************************
  7936*                                                                *
  7937*                            ELCCRTT.                            *
  7938*                                                                *
  7939*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7940*                                                                *
  7941*   FILE TYPE = VSAM,KSDS                                        *
  7942*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7943*                                                                *
  7944*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7945*                                                                *
  7946*   LOG = YES                                                    *
  7947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7948******************************************************************
  7949*                   C H A N G E   L O G
  7950*
  7951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7952*-----------------------------------------------------------------
  7953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7954* EFFECTIVE    NUMBER
  7955*-----------------------------------------------------------------
  7956* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7957* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7958* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7959* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7960* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 146
* EL6311.cbl
  7961* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7962* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7963* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7964* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7965* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7966******************************************************************
  7967
  7968 01  CERTIFICATE-TRAILERS.
  7969     12  CS-RECORD-ID                      PIC XX.
  7970         88  VALID-CS-ID                      VALUE 'CS'.
  7971
  7972     12  CS-CONTROL-PRIMARY.
  7973         16  CS-COMPANY-CD                 PIC X.
  7974         16  CS-CARRIER                    PIC X.
  7975         16  CS-GROUPING                   PIC X(6).
  7976         16  CS-STATE                      PIC XX.
  7977         16  CS-ACCOUNT                    PIC X(10).
  7978         16  CS-CERT-EFF-DT                PIC XX.
  7979         16  CS-CERT-NO.
  7980             20  CS-CERT-PRIME             PIC X(10).
  7981             20  CS-CERT-SFX               PIC X.
  7982         16  CS-TRAILER-TYPE               PIC X.
  7983             88  COMM-TRLR           VALUE 'A'.
  7984             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7985             88  CERT-DATA-TRLR      VALUE 'C'.
  7986
  7987     12  CS-DATA-AREA                      PIC X(516).
  7988
  7989     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7990         16  CS-BANK-COMMISSION-AREA.
  7991             20  CS-BANK-COMMS       OCCURS 10.
  7992                 24  CS-AGT                PIC X(10).
  7993                 24  CS-COM-TYP            PIC X.
  7994                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7995                 24  CS-RECALC-LV-INDIC    PIC X.
  7996                 24  FILLER                PIC X(10).
  7997         16  FILLER                        PIC X(256).
  7998
  7999     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8000****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8001         16  CS-MB-CLAIM-DATA OCCURS 24.
  8002             20  CS-CLAIM-NO               PIC X(7).
  8003             20  CS-CLAIM-TYPE             PIC X.
  8004                 88  CS-AH-CLM               VALUE 'A'.
  8005                 88  CS-IU-CLM               VALUE 'I'.
  8006                 88  CS-GP-CLM               VALUE 'G'.
  8007                 88  CS-LF-CLM               VALUE 'L'.
  8008                 88  CS-PR-CLM               VALUE 'P'.
  8009                 88  CS-FL-CLM               VALUE 'F'.
  8010             20  CS-INSURED-TYPE           PIC X.
  8011                 88  CS-PRIM-INSURED          VALUE 'P'.
  8012                 88  CS-CO-BORROWER           VALUE 'C'.
  8013             20  CS-BENEFIT-PERIOD         PIC 99.
  8014             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8015             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8016             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8017         16  FILLER                        PIC X(12).
  8018     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 147
* EL6311.cbl
  8019         16  CS-VIN-NUMBER                 PIC X(17).
  8020         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8021         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8022         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8023         16  cs-agent-name.
  8024             20  cs-agent-fname            pic x(20).
  8025             20  cs-agent-mi               pic x.
  8026             20  cs-agent-lname            pic x(25).
  8027         16  cs-license-no                 pic x(15).
  8028         16  cs-npn-number                 pic x(10).
  8029         16  cs-agent-edit-status          pic x.
  8030             88  cs-ae-refer-to-manager      value 'M'.
  8031             88  cs-ae-cover-sheet           value 'C'.
  8032             88  cs-ae-sig-form              value 'S'.
  8033             88  cs-ae-verified              value 'V'.
  8034             88  cs-unidentified-signature   value 'U'.
  8035             88  cs-cert-returned            value 'R'.
  8036             88  cs-accept-no-commission     value 'N'.
  8037         16  cs-year                       pic 9999.
  8038         16  cs-make                       pic x(20).
  8039         16  cs-model                      pic x(20).
  8040         16  cs-future                     pic x(20).
  8041         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8042         16  cs-claim-verification-status  pic x.
  8043             88  cs-clm-ver-eligible         value 'A'.
  8044             88  cs-clm-ver-partial-elig     value 'B'.
  8045             88  cs-clm-ver-not-eligible     value 'C'.
  8046             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  8047             88  cs-clm-ver-not-part-elig-rw value 'E'.
  8048             88  cs-clm-ver-ND-CERT          value 'F'.
  8049             88  cs-clm-ver-spec-other       value 'G'.
  8050             88  cs-clam-ver-pratial-corrected
  8051                                             value 'H'.
  8052             88  cs-clm-ver-no-matches       value 'I'.
  8053             88  cs-clm-ver-not-elig-corrected
  8054                                             value 'J'.
  8055             88  cs-clm-ver-needs-review     value 'R'.
  8056             88  cs-clm-ver-sent-to-claims   value 'W'.
  8057         16  FILLER                        PIC X(355). *> was 420
  8058*        16  FILLER                        PIC X(496).
  8059*                                COPY ERCCHEK.
  8060******************************************************************
  8061*                                                                *
  8062*                                                                *
  8063*                            ERCCHEK                             *
  8064*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8065*                            VMOD=2.008                          *
  8066*                                                                *
  8067*   FILE DESCRIPTION = CHECK RECORDS                             *
  8068*                                                                *
  8069*   FILE TYPE = VSAM,KSDS                                        *
  8070*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8071*                                                                *
  8072*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8073*       ALTERNATE INDEX = NONE                                   *
  8074*                                                                *
  8075*   LOG = YES                                                    *
  8076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 148
* EL6311.cbl
  8077******************************************************************
  8078*                   C H A N G E   L O G
  8079*
  8080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8081*-----------------------------------------------------------------
  8082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8083* EFFECTIVE    NUMBER
  8084*-----------------------------------------------------------------
  8085* 021414    2003053000001  PEMA  changes for auto chk request
  8086******************************************************************
  8087 01  CHECK-RECORDS.
  8088     12  CH-RECORD-ID                      PIC XX.
  8089         88  VALID-CH-ID                      VALUE 'CH'.
  8090
  8091     12  CH-CONTROL-PRIMARY.
  8092         16  CH-COMPANY-CD                 PIC X.
  8093         16  CH-CARRIER                    PIC X.
  8094         16  CH-GROUPING                   PIC X(6).
  8095         16  CH-STATE                      PIC XX.
  8096         16  CH-ACCOUNT                    PIC X(10).
  8097         16  CH-CERT-EFF-DT                PIC XX.
  8098         16  CH-CERT-NO.
  8099             20  CH-CERT-PRIME             PIC X(10).
  8100             20  CH-CERT-SFX               PIC X.
  8101         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8102
  8103     12  CH-RECORDED-DT                    PIC XX.
  8104     12  CH-RECORDED-BY                    PIC X(4).
  8105     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8106
  8107     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8108     12  CH-CHECK-NO                       PIC X(7).
  8109     12  CH-REASON-FOR-CHECK               PIC X(25).
  8110     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8111     12  FILLER                            PIC X.
  8112
  8113     12  CH-PAYEE-INFO.
  8114         16  CH-PAYEE-NAME-1               PIC X(30).
  8115         16  CH-PAYEE-NAME-2               PIC X(30).
  8116         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8117         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8118         16  CH-PAYEE-CITY-ST.
  8119             20  CH-PAYEE-CITY             PIC X(28).
  8120             20  CH-PAYEE-STATE            PIC XX.
  8121         16  CH-PAYEE-ZIP-CODE.
  8122             20  CH-PAYEE-ZIP.
  8123                 24  CH-ZIP-PRI-1ST        PIC X.
  8124                     88  CH-CANADIAN-POST-CODE
  8125                                           VALUES 'A' THRU 'Z'.
  8126                 24  FILLER                PIC X(4).
  8127             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8128         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8129             20  CH-CAN-POSTAL-1           PIC XXX.
  8130             20  CH-CAN-POSTAL-2           PIC XXX.
  8131             20  FILLER                    PIC XXX.
  8132
  8133     12  CH-CHECK-STUB-TEXT.
  8134         16  CH-STUB-LINE-1                PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 149
* EL6311.cbl
  8135         16  CH-TEXT-LINE-1                PIC X(50).
  8136         16  CH-TEXT-LINE-2                PIC X(50).
  8137         16  CH-TEXT-LINE-3                PIC X(40).
  8138     12  CH-RETURN-TO                      PIC X(30).
  8139
  8140     12  CH-COMPENSATION-CONTROL.
  8141         16  CH-COMP-CARRIER               PIC X.
  8142         16  CH-COMP-GROUPING              PIC X(6).
  8143         16  CH-COMP-FIN-RESP              PIC X(10).
  8144         16  CH-COMP-ACCOUNT               PIC X(10).
  8145
  8146     12  CH-CREDIT-SELECT-DT               PIC XX.
  8147     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8148     12  CH-PAYEE-CODE                     PIC X(6).
  8149
  8150     12  CH-VOID-DATA.
  8151         20  CH-VOID-DT                    PIC XX.
  8152         20  CH-VOID-BY                    PIC X(4).
  8153         20  CH-VOID-REASON                PIC X(25).
  8154
  8155     12  CH-APPROVAL-DATA.
  8156         20  CH-APPROVAL-DT                PIC XX.
  8157         20  CH-APPROVAL-STATUS            PIC X.
  8158             88  CH-IN-LIMBO                  VALUE ' '.
  8159             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8160             88  CH-APPROVED                  VALUE 'A'.
  8161             88  CH-DENIED                    VALUE 'D'.
  8162         20  CH-APPROVED-BY                PIC XXXX.
  8163     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8164             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8165     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8166
  8167     12  ch-released-dt                    pic xx.
  8168     12  ch-check-cashed-dt                pic xx.
  8169     12  FILLER                            PIC X.
  8170*    12  CH-CHECK-REFERENCE                PIC X(12).
  8171     12  CH-CHECK-ORIGIN-SW                PIC X.
  8172             88  CH-REFUND-CHECK              VALUE 'R'.
  8173             88  CH-MAINT-CHECK               VALUE 'M'.
  8174
  8175     12  CH-CANC-DT                        PIC XX.
  8176     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8177     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8178
  8179     12  CH-INSURED-NAME                   PIC X(28).
  8180
  8181     12  ch-released-by                    pic x(4).
  8182     12  ch-csr                            pic x(4).
  8183     12  ch-deduct-commission              pic x.
  8184         88  ch-deduct-comm                  value 'Y'.
  8185         88  ch-do-not-deduct-comm           value 'N'.
  8186
  8187     12  FILLER                            PIC X(11).
  8188*    12  CH-LETTER-TABLE.
  8189*        16  CH-LETTERS OCCURS 3 TIMES
  8190*                       INDEXED BY CH-LT-NDX
  8191*                                          PIC X(04).
  8192
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 150
* EL6311.cbl
  8193     12  FILLER                            PIC X(07).
  8194
  8195 01  var                         pic x(30).
  8196 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8197                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8198                          PENDING-MAILING-DATA MAILING-DATA
  8199                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8200                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8201                          CLAIM-MASTER ENDORSEMENT-RECORD
  8202                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8203                          VAR.
  8204 0000-DFHEXIT SECTION.
  8205     MOVE '9#                    $   ' TO DFHEIV0.
  8206     MOVE 'EL6311' TO DFHEIV1.
  8207     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8208
  8209     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8210     MOVE EIBTRMID               TO QID-TERM.
  8211     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8212     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8213     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8214     MOVE 2                      TO EMI-SWITCH2.
  8215
  8216     move spaces to ws-kix-myenv
  8217     set P to address of KIXSYS
  8218     CALL "getenv" using by value P returning var-ptr
  8219     if var-ptr = null then
  8220        display ' kixsys not set '
  8221     else
  8222        set address of var to var-ptr
  8223        move 0 to env-var-len
  8224        inspect var tallying env-var-len
  8225          for characters before X'00'
  8226        unstring var (1:env-var-len) delimited by '/'
  8227           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8228              WS-KIX-SYS
  8229        end-unstring
  8230     end-if
  8231     perform varying a1 from +1 by +1 until a1 > +10
  8232        if ws-kix-myenv (a1:1) = low-values or high-values
  8233           display ' found low or hi val '
  8234           move spaces to ws-kix-myenv (a1:1)
  8235        end-if
  8236     end-perform
  8237*    display ' env *' ws-kix-myenv '*'
  8238     IF EIBCALEN = 0
  8239         GO TO 8800-UNAUTHORIZED-ACCESS.
  8240
  8241     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8242     MOVE '5'                   TO DC-OPTION-CODE.
  8243     PERFORM 9700-DATE-LINK.
  8244     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8245     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8246
  8247     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8248     MOVE SPACE                  TO DC-OPTION-CODE.
  8249     PERFORM 9700-DATE-LINK.
  8250     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 151
* EL6311.cbl
  8251     MOVE LOW-VALUES             TO EL631BI.
  8252
  8253
  8254* EXEC CICS HANDLE CONDITION
  8255*        PGMIDERR  (9600-PGMID-ERROR)
  8256*        ERROR     (9990-ABEND)
  8257*        INVREQ    (9990-ABEND)
  8258*        QIDERR    (0010-MAIN-LOGIC)
  8259*    END-EXEC.
  8260*    MOVE '"$L.8N                ! " #00008249' TO DFHEIV0
  8261     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8262     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8263     MOVE X'2220233030303038323439' TO DFHEIV0(25:11)
  8264     CALL 'kxdfhei1' USING DFHEIV0
  8265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8266
  8267
  8268     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8269         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8270             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8271             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8272             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8273             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8274             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8275             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8276             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8277             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8278
  8279             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8280                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8281
  8282             ELSE
  8283                 NEXT SENTENCE
  8284
  8285         ELSE
  8286             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8287             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8288             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8289             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8290             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8291             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8292             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8293             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8294             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8295             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8296             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8297             GO TO 3900-RE-DISPLAY-RECORD
  8298     ELSE
  8299         GO TO 0020-MAIN-LOGIC.
  8300
  8301 0010-MAIN-LOGIC.
  8302     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8303                                    WS-FIRST-ENTRY-SW.
  8304
  8305     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8306
  8307     MOVE LOW-VALUES             TO EC-NEW-CERT
  8308                                    EC-NEW-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 152
* EL6311.cbl
  8309
  8310     IF PI-DISPLAY-ORIGINAL-BATCH
  8311         NEXT SENTENCE
  8312     ELSE
  8313         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8314             GO TO 5000-BROWSE-BATCH-HEADERS.
  8315
  8316     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8317         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8318
  8319     IF PI-CSR-BROWSE
  8320        GO TO 4200-BROWSE-CSR-FORWARD.
  8321
  8322     IF PI-FILE-BROWSE
  8323         GO TO 4300-BROWSE-FILE-FORWARD.
  8324
  8325     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8326
  8327 0020-MAIN-LOGIC.
  8328     IF EIBAID = DFHCLEAR
  8329         GO TO 9400-CLEAR.
  8330
  8331     MOVE LOW-VALUES             TO EC-NEW-CERT
  8332                                    EC-NEW-STATE.
  8333
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 153
* EL6311.cbl
  8335
  8336******************************************************************
  8337*                                                                *
  8338*              R E C E I V E   M A P                             *
  8339*                                                                *
  8340******************************************************************
  8341
  8342 0200-RECEIVE.
  8343     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8344         MOVE ER-0008            TO EMI-ERROR
  8345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8346         IF PI-MAP-NAME = EL631B
  8347             MOVE -1                 TO BMAINTL
  8348             GO TO 8200-SEND-DATAONLY
  8349         ELSE
  8350             IF PI-MAP-NAME = EL631C
  8351                 MOVE -1                 TO CMAINTL
  8352                 GO TO 8200-SEND-DATAONLY
  8353             ELSE
  8354                 IF PI-MAP-NAME = EL631D
  8355                     MOVE -1                 TO DPFENTRL
  8356                     GO TO 8200-SEND-DATAONLY.
  8357
  8358
  8359* EXEC CICS RECEIVE
  8360*        MAP      (PI-MAP-NAME)
  8361*        MAPSET   (MAPSET-EL6311S)
  8362*        INTO     (EL631BI)
  8363*    END-EXEC.
  8364     MOVE LENGTH OF
  8365      EL631BI
  8366       TO DFHEIV11
  8367*    MOVE '8"T I  L              ''   #00008346' TO DFHEIV0
  8368     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8370     MOVE X'2020233030303038333436' TO DFHEIV0(25:11)
  8371     CALL 'kxdfhei1' USING DFHEIV0,
  8372           PI-MAP-NAME,
  8373           EL631BI,
  8374           DFHEIV11,
  8375           MAPSET-EL6311S,
  8376           DFHEIV99,
  8377           DFHEIV99
  8378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8379
  8380
  8381******************************************************************
  8382*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8383******************************************************************
  8384
  8385     IF BTYPE-LEN (1) EQUAL +3
  8386        IF BTYPE (1) EQUAL ALL ' '
  8387            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8388
  8389     IF BTYPE-LEN (2) EQUAL +3
  8390        IF BTYPE (2) EQUAL ALL ' '
  8391            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8392
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 154
* EL6311.cbl
  8393     INSPECT EL631BI CONVERTING '_' TO ' '.
  8394
  8395     IF PI-MAP-NAME = EL631B
  8396         IF BPFENTRL GREATER THAN ZEROS
  8397             IF EIBAID NOT = DFHENTER
  8398                 MOVE ER-0004       TO EMI-ERROR
  8399                 MOVE -1            TO BPFENTRL
  8400                 MOVE AL-UNBOF      TO BPFENTRA
  8401                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8402                 GO TO 8200-SEND-DATAONLY
  8403             ELSE
  8404                 IF BPFENTRI NUMERIC AND
  8405                   (BPFENTRI GREATER 0 AND LESS 25)
  8406                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8407                 ELSE
  8408                     MOVE ER-0029  TO EMI-ERROR
  8409                     MOVE AL-UNBON TO BPFENTRA
  8410                     MOVE -1       TO BPFENTRL
  8411                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8412                     GO TO 8200-SEND-DATAONLY
  8413         ELSE
  8414             NEXT SENTENCE
  8415     ELSE
  8416         IF PI-MAP-NAME = EL631C
  8417            IF CPFENTRL GREATER THAN ZEROS
  8418                IF EIBAID NOT = DFHENTER
  8419                 MOVE ER-0004         TO EMI-ERROR
  8420                 MOVE -1              TO CPFENTRL
  8421                 MOVE AL-UNBOF        TO CPFENTRA
  8422                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8423                 GO TO 8200-SEND-DATAONLY
  8424             ELSE
  8425                 IF CPFENTRI NUMERIC AND
  8426                   (CPFENTRI GREATER 0 AND LESS 25)
  8427                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8428                 ELSE
  8429                     MOVE ER-0029      TO EMI-ERROR
  8430                     MOVE AL-UNBON     TO CPFENTRA
  8431                     MOVE -1           TO CPFENTRL
  8432                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8433                     GO TO 8200-SEND-DATAONLY
  8434         ELSE
  8435             NEXT SENTENCE
  8436     ELSE
  8437     IF PI-MAP-NAME = EL631D
  8438         IF DPFENTRL GREATER THAN ZEROS
  8439             IF EIBAID NOT = DFHENTER
  8440                 MOVE ER-0004         TO EMI-ERROR
  8441                 MOVE -1              TO DPFENTRL
  8442                 MOVE AL-UNBOF        TO DPFENTRA
  8443                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444                 GO TO 8200-SEND-DATAONLY
  8445             ELSE
  8446                 IF DPFENTRI NUMERIC AND
  8447                   (DPFENTRI GREATER 0 AND LESS 25)
  8448                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8449                 ELSE
  8450                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 155
* EL6311.cbl
  8451                     MOVE AL-UNBON     TO DPFENTRA
  8452                     MOVE -1           TO DPFENTRL
  8453                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8454                     GO TO 8200-SEND-DATAONLY.
  8455
  8456     IF EIBAID = DFHPF23
  8457         GO TO 8810-PF23.
  8458
  8459     IF EIBAID = DFHPF24
  8460         GO TO 9200-RETURN-MAIN-MENU.
  8461
  8462     IF EIBAID = DFHPF12
  8463         GO TO 9500-PF12.
  8464
  8465     IF PI-MAP-NAME = EL631B
  8466        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8467
  8468     IF PI-MAP-NAME = EL631C
  8469        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8470
  8471     IF PI-MAP-NAME = EL631D
  8472        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8473
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 156
* EL6311.cbl
  8475
  8476******************************************************************
  8477*                                                                *
  8478*      ISSUE SCREEN PF KEY CHECKING                              *
  8479*                                                                *
  8480******************************************************************
  8481
  8482******************************************************************
  8483*                                                                *
  8484*      PF KEY FUNCTIONS:                                         *
  8485*                                                                *
  8486*      PF1  = BROWSE FORWARD                                     *
  8487*      PF2  = BROWSE BACKWARD                                    *
  8488*      PF3  = CERTIFICATE LOOKUP                                 *
  8489*      PF4  = DISPLAY BATCH HEADER                               *
  8490*      PF5  = ADD ISSUE  SCREEN                                  *
  8491*      PF6  = ADD CANCEL SCREEN                                  *
  8492*      PF7  = CERTIFICATE DISPLAY                                *
  8493*      PF8  = CERTIFICATE NOTES                                  *
  8494*      PF9  = EDIT CONTROL                                       *
  8495*      PF10 = DISPLAY LETTER SCREEN                              *
  8496*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8497*      PF12 = HELP SCREEN                                        *
  8498*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8499*      PF14 = ACCOUNT MASTER                                     *
  8500*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8501*      PF16 = DISPLAY LETTER REVIEW                              *
  8502*                                                                *
  8503******************************************************************
  8504
  8505 0300-CHECK-ISSUE-PF-KEYS.
  8506     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8507        MOVE ER-2337            TO EMI-ERROR
  8508        MOVE -1                  TO BMAINTL
  8509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8510        GO TO 8200-SEND-DATAONLY.
  8511
  8512     IF EIBAID = DFHPF1
  8513        MOVE '0'                TO PI-EDIT-SW
  8514        IF PI-PRIMARY-BROWSE
  8515           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8516        ELSE
  8517           IF PI-PRIMARY-WITH-SELECT
  8518              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8519           ELSE
  8520              IF PI-FILE-BROWSE
  8521                 GO TO 4300-BROWSE-FILE-FORWARD
  8522              ELSE
  8523                 IF PI-CSR-BROWSE
  8524                    GO TO 4200-BROWSE-CSR-FORWARD
  8525                 ELSE
  8526                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8527
  8528     IF EIBAID = DFHPF2
  8529        MOVE '0'                TO PI-EDIT-SW
  8530        IF PI-PRIMARY-BROWSE
  8531           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8532        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 157
* EL6311.cbl
  8533           IF PI-PRIMARY-WITH-SELECT
  8534              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8535           ELSE
  8536              IF PI-FILE-BROWSE
  8537                 GO TO 4800-BROWSE-FILE-BACKWARD
  8538              ELSE
  8539                 IF PI-CSR-BROWSE
  8540                    GO TO 4900-BROWSE-CSR-BACKWARD
  8541                 ELSE
  8542                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8543
  8544     IF EIBAID = DFHPF3
  8545        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8546        MOVE XCTL-EL127         TO PGM-NAME
  8547        GO TO 9300-XCTL.
  8548
  8549     IF (EIBAID = DFHPF15 OR DFHPF6)
  8550        AND (CSR-EDIT-SESSION)
  8551*       AND (FATAL-OR-UNFORCED)
  8552*       AND (FATAL-ERRORS)
  8553        and (pi-6311-fatal-ctr <> +0)
  8554        MOVE ER-1819             TO EMI-ERROR
  8555        MOVE -1                  TO BMAINTL
  8556        MOVE AL-UANON            TO BMAINTA
  8557        PERFORM 9900-ERROR-FORMAT
  8558                                 THRU 9900-EXIT
  8559        GO TO 8200-SEND-DATAONLY
  8560     END-IF
  8561     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8562      OR (EIBAID = DFHPF10)
  8563        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8564        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8565        IF (RESP-NORMAL)
  8566           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8567              AM-CONTROL-PRIMARY (1:20))
  8568            IF AM-NAME NOT GREATER THAN SPACES OR
  8569               AM-ADDRS NOT GREATER THAN SPACES  OR
  8570               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8571               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8572               AM-ZIP NOT GREATER THAN SPACES
  8573               MOVE ER-3834             TO EMI-ERROR
  8574               MOVE -1                  TO BMAINTL
  8575               MOVE AL-UANON            TO BMAINTA
  8576               PERFORM 9900-ERROR-FORMAT
  8577                                 THRU 9900-EXIT
  8578               GO TO 8200-SEND-DATAONLY
  8579            END-IF
  8580        ELSE
  8581           MOVE ER-1609             TO EMI-ERROR
  8582           MOVE -1                  TO BMAINTL
  8583           MOVE AL-UANON            TO BMAINTA
  8584           PERFORM 9900-ERROR-FORMAT
  8585                                THRU 9900-EXIT
  8586           GO TO 8200-SEND-DATAONLY
  8587        END-IF
  8588
  8589        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8590        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 158
* EL6311.cbl
  8591        IF (ERMAIL-FOUND)
  8592            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8593               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8594               MA-CITY NOT GREATER THAN SPACES OR
  8595               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8596               MA-ZIP-CODE NOT GREATER THAN SPACES
  8597               MOVE ER-3835             TO EMI-ERROR
  8598               MOVE -1                  TO BMAINTL
  8599               MOVE AL-UANON            TO BMAINTA
  8600               PERFORM 9900-ERROR-FORMAT
  8601                                 THRU 9900-EXIT
  8602               GO TO 8200-SEND-DATAONLY
  8603            END-IF
  8604        ELSE
  8605           MOVE ER-3000             TO EMI-ERROR
  8606           MOVE -1                  TO BMAINTL
  8607           MOVE AL-UANON            TO BMAINTA
  8608           PERFORM 9900-ERROR-FORMAT
  8609                                THRU 9900-EXIT
  8610           GO TO 8200-SEND-DATAONLY
  8611        END-IF
  8612
  8613     END-IF
  8614     IF (EIBAID = DFHPF15)
  8615        AND (CSR-EDIT-SESSION)
  8616        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8617        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8618        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8619        MOVE PI-SV-STATE         TO PI-STATE
  8620        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8621        MOVE BCERTNOI            TO PI-CERT-PRIME
  8622        MOVE BSUFIXI             TO PI-CERT-SFX
  8623        MOVE BEFFDTI             TO DEEDIT-FIELD
  8624        PERFORM 8600-DEEDIT
  8625        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8626        MOVE '4'                 TO DC-OPTION-CODE
  8627        PERFORM 9700-DATE-LINK
  8628        IF DATE-CONVERSION-ERROR
  8629           MOVE ER-0348          TO EMI-ERROR
  8630           MOVE -1               TO BEFFDTL
  8631           MOVE AL-UABON         TO BEFFDTA
  8632           PERFORM 9900-ERROR-FORMAT
  8633                                 THRU 9900-EXIT
  8634           GO TO 8200-SEND-DATAONLY
  8635        ELSE
  8636           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8637           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8638           MOVE XCTL-EL6315      TO PGM-NAME
  8639           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8640           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8641           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8642           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8643           GO TO 9300-XCTL
  8644        END-IF
  8645     END-IF
  8646
  8647     IF EIBAID = DFHPF4
  8648        MOVE '0'                TO PI-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 159
* EL6311.cbl
  8649        IF PI-DISPLAY-ORIGINAL-BATCH
  8650           NEXT SENTENCE
  8651        ELSE
  8652           GO TO 7200-DISPLAY-BATCHES.
  8653
  8654     IF EIBAID = DFHPF5
  8655        MOVE ER-0029                TO EMI-ERROR
  8656        MOVE -1                     TO BPFENTRL
  8657        MOVE AL-UNBON               TO BPFENTRA
  8658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8659        GO TO 8200-SEND-DATAONLY.
  8660*        MOVE '0'                TO PI-EDIT-SW
  8661*        IF PI-DISPLAY-ORIGINAL-BATCH
  8662*           NEXT SENTENCE
  8663*        ELSE
  8664*           MOVE EL631B              TO PI-MAP-NAME
  8665*           MOVE LOW-VALUES          TO EL631BI
  8666*           MOVE 'A'                 TO BMAINTO
  8667*           MOVE AL-UANON            TO BMAINTA
  8668*           MOVE -1                  TO BMAINTL
  8669*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8670*           GO TO 8100-SEND-INITIAL-MAP.
  8671
  8672     IF EIBAID = DFHPF6
  8673        IF NOT CSR-EDIT-SESSION
  8674           MOVE ER-0029                TO EMI-ERROR
  8675           MOVE -1                     TO BPFENTRL
  8676           MOVE AL-UNBON               TO BPFENTRA
  8677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8678           GO TO 8200-SEND-DATAONLY
  8679*           MOVE '0'              TO PI-EDIT-SW
  8680*           IF PI-DISPLAY-ORIGINAL-BATCH
  8681*              NEXT SENTENCE
  8682*           ELSE
  8683*              MOVE EL631C        TO PI-MAP-NAME
  8684*              MOVE LOW-VALUES    TO EL631CI
  8685*              MOVE 'A'           TO CMAINTO
  8686*              MOVE AL-UANON      TO CMAINTA
  8687*              MOVE -1            TO CMAINTL
  8688*              MOVE '6'           TO PI-MAINT-FUNCTION
  8689*              GO TO 8100-SEND-INITIAL-MAP
  8690*           END-IF
  8691        ELSE
  8692           PERFORM 5100-PROCESS-POL-RESC
  8693                                 THRU 5100-EXIT
  8694           MOVE  PI-PREV-CONTROL-PRIMARY
  8695                                 TO ERPNDB-KEY
  8696
  8697* EXEC CICS READ
  8698*              SET     (ADDRESS OF PENDING-BUSINESS)
  8699*              DATASET (FILE-ID-ERPNDB)
  8700*              RIDFLD  (ERPNDB-KEY)
  8701*          END-EXEC
  8702*    MOVE '&"S        E          (   #00008667' TO DFHEIV0
  8703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8705     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  8706     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 160
* EL6311.cbl
  8707           FILE-ID-ERPNDB,
  8708           DFHEIV20,
  8709           DFHEIV99,
  8710           ERPNDB-KEY,
  8711           DFHEIV99,
  8712           DFHEIV99,
  8713           DFHEIV99
  8714     SET ADDRESS OF PENDING-BUSINESS TO
  8715         DFHEIV20
  8716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8717           PERFORM 9800-LINK-PENDING-EDIT
  8718                                 THRU 9800-EXIT
  8719           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8720           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8721                                    PI-PREV-SEQ-NO
  8722           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8723*                                    WS-CANCEL-LETTER-SW
  8724                                    PI-ALL-ISSUES-SW
  8725                                    PI-ALL-CANCELS-SW
  8726           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8727        END-IF
  8728     END-IF
  8729     IF EIBAID = DFHPF7
  8730        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8731        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8732        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8733        MOVE PI-SV-STATE            TO PI-STATE
  8734        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8735        MOVE BCERTNOI               TO PI-CERT-PRIME
  8736        MOVE BSUFIXI                TO PI-CERT-SFX
  8737        MOVE BEFFDTI                TO DEEDIT-FIELD
  8738        PERFORM 8600-DEEDIT
  8739        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8740        MOVE '4'                    TO DC-OPTION-CODE
  8741        PERFORM 9700-DATE-LINK
  8742        IF DATE-CONVERSION-ERROR
  8743           MOVE ER-0348            TO EMI-ERROR
  8744           MOVE -1                  TO BEFFDTL
  8745           MOVE AL-UABON            TO BEFFDTA
  8746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8747           GO TO 8200-SEND-DATAONLY
  8748        ELSE
  8749           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8750           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8751           MOVE XCTL-EL1273        TO PGM-NAME
  8752           GO TO 9300-XCTL.
  8753
  8754     IF EIBAID = DFHPF8
  8755        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8756        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8757        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8758        MOVE PI-SV-STATE            TO PI-STATE
  8759        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8760        MOVE BCERTNOI               TO PI-CERT-PRIME
  8761        MOVE BSUFIXI                TO PI-CERT-SFX
  8762        MOVE BEFFDTI                TO DEEDIT-FIELD
  8763        PERFORM 8600-DEEDIT
  8764        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 161
* EL6311.cbl
  8765        MOVE '4'                    TO DC-OPTION-CODE
  8766        PERFORM 9700-DATE-LINK
  8767        IF DATE-CONVERSION-ERROR
  8768           MOVE ER-0348            TO EMI-ERROR
  8769           MOVE -1                  TO BEFFDTL
  8770           MOVE AL-UABON            TO BEFFDTA
  8771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8772           GO TO 8200-SEND-DATAONLY
  8773        ELSE
  8774           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8775           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8776           IF PI-COMPANY-ID = 'DMD'
  8777               MOVE XCTL-EL401DMD      TO PGM-NAME
  8778             ELSE
  8779               MOVE XCTL-EL1279        TO PGM-NAME
  8780           END-IF
  8781           GO TO 9300-XCTL.
  8782
  8783     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8784        MOVE XCTL-EL6312         TO PGM-NAME
  8785
  8786* EXEC CICS XCTL
  8787*           PROGRAM   (PGM-NAME)
  8788*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8789*           LENGTH    (WS-COMM-LENGTH)
  8790*       END-EXEC
  8791*    MOVE '.$C                   %   #00008740' TO DFHEIV0
  8792     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8794     MOVE X'2020233030303038373430' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           PGM-NAME,
  8797           PROGRAM-INTERFACE-BLOCK,
  8798           WS-COMM-LENGTH,
  8799           DFHEIV99
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8801     ELSE
  8802        MOVE '0'                 TO  PI-EDIT-SW.
  8803
  8804     IF  EIBAID = DFHPF10
  8805         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8806         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8807         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8808                                    PI-1042-WA
  8809         MOVE 4                  TO PI-689-DATA-SOURCE
  8810         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8811         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8812         MOVE PI-SV-STATE        TO PI-689-STATE
  8813         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8814         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8815         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8816         MOVE PI-PB-ALT-CHG-SEQ-NO
  8817                                 TO PI-689-ALT-SEQ-NO
  8818         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8819         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8820         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8821         MOVE +0                 TO PI-689-CONTROL
  8822         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 162
* EL6311.cbl
  8823                                    PI-689-EXP-DATE
  8824                                    PI-689-RESP-PERSON
  8825                                    PI-689-TYPE
  8826                                    PI-689-FOLLOW-UP-EDIT
  8827                                    PI-689-RESEND1-EDIT
  8828                                    PI-689-SEQ-EDIT
  8829                                    PI-689-BCSEQ-EDIT
  8830                                    PI-689-LBL-OVERRIDE
  8831         MOVE W-LETTER-COMMUNICATION-AREAS
  8832                                 TO PI-PROGRAM-WORK-AREA
  8833         MOVE XCTL-EL689         TO PGM-NAME
  8834         GO TO 9300-XCTL.
  8835
  8836     IF  EIBAID = DFHPF16
  8837         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8838         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8839         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8840                                    PI-1042-WA
  8841         MOVE 4                  TO PI-689-DATA-SOURCE
  8842         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8843         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8844         MOVE PI-SV-STATE        TO PI-689-STATE
  8845         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8846         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8847         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8848         MOVE PI-PB-ALT-CHG-SEQ-NO
  8849                                 TO PI-689-ALT-SEQ-NO
  8850         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8851         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8852         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8853         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8854         MOVE W-LETTER-COMMUNICATION-AREAS
  8855                                 TO PI-PROGRAM-WORK-AREA
  8856         MOVE XCTL-EL690         TO PGM-NAME
  8857         GO TO 9300-XCTL.
  8858
  8859     IF EIBAID = DFHPF13
  8860         MOVE XCTL-EL6313        TO PGM-NAME
  8861         GO TO 9300-XCTL.
  8862
  8863     IF EIBAID = DFHPF17
  8864        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8865        IF (PB-I-LOAN-APR numeric)
  8866           and (pb-i-loan-apr < 99.9999)
  8867           AND (PB-I-BENEFICIARY-NAME NOT
  8868              = SPACES AND LOW-VALUES)
  8869
  8870           MOVE LINK-ELVADS          TO PGM-NAME
  8871
  8872* EXEC CICS LINK
  8873*              PROGRAM    (PGM-NAME)
  8874*              COMMAREA   (WS-PASS-AREA)
  8875*              LENGTH     (WS-PASS-AREA-LENGTH)
  8876*          END-EXEC
  8877*    MOVE '."C                   (   #00008815' TO DFHEIV0
  8878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8880     MOVE X'2020233030303038383135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 163
* EL6311.cbl
  8881     CALL 'kxdfhei1' USING DFHEIV0,
  8882           PGM-NAME,
  8883           WS-PASS-AREA,
  8884           WS-PASS-AREA-LENGTH,
  8885           DFHEIV99,
  8886           DFHEIV99,
  8887           DFHEIV99,
  8888           DFHEIV99
  8889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8890
  8891           MOVE 0000             TO EMI-ERROR
  8892           MOVE -1               TO BMAINTL
  8893           PERFORM 9900-ERROR-FORMAT
  8894                                 THRU 9900-EXIT
  8895           GO TO 8200-SEND-DATAONLY
  8896        ELSE
  8897           MOVE ER-0877            TO EMI-ERROR
  8898           MOVE -1                  TO BEFFDTL
  8899           MOVE AL-UABON            TO BEFFDTA
  8900           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8901           GO TO 8200-SEND-DATAONLY
  8902        END-IF
  8903     END-IF
  8904     IF EIBAID = DFHPF14
  8905        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8906        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8907        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8908        MOVE PI-SV-STATE            TO PI-CR-STATE
  8909        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8910        MOVE SPACE                  TO PI-EDIT-SW
  8911        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8912        MOVE XCTL-EL650             TO PGM-NAME
  8913        GO TO 9300-XCTL.
  8914
  8915     IF EIBAID = DFHPF15
  8916        IF PI-COMPANY-ID  =  'HER'
  8917            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8918            MOVE XCTL-EL680         TO PGM-NAME
  8919            GO TO 9300-XCTL.
  8920
  8921     IF EIBAID = DFHENTER OR DFHPF11
  8922        GO TO 1000-ISSUE-MAINLINE.
  8923
  8924     MOVE ER-0029                TO EMI-ERROR
  8925     MOVE -1                     TO BPFENTRL
  8926     MOVE AL-UNBON               TO BPFENTRA
  8927     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8928     GO TO 8200-SEND-DATAONLY.
  8929
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 164
* EL6311.cbl
  8931
  8932******************************************************************
  8933*                                                                *
  8934*      CANCEL SCREEN PF KEY CHECKING                             *
  8935*                                                                *
  8936******************************************************************
  8937
  8938******************************************************************
  8939*                                                                *
  8940*      PF KEY FUNCTIONS:                                         *
  8941*                                                                *
  8942*      PF1  = BROWSE FORWARD                                     *
  8943*      PF2  = BROWSE BACKWARD                                    *
  8944*      PF3  = CERTIFICATE LOOKUP                                 *
  8945*      PF4  = DISPLAY BATCH HEADER                               *
  8946*      PF5  = ADD ISSUE SCREEN                                   *
  8947*      PF6  = ADD CANCEL SCREEN                                  *
  8948*      PF7  = CERTIFICATE DISPLAY                                *
  8949*      PF8  = CERTIFICATE NOTES                                  *
  8950*      PF9  = EDIT CONTROL                                       *
  8951*      PF10 = DISPLAY LETTER SCREEN                              *
  8952*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8953*      PF12 = DISPLAY HELP SCREEN                                *
  8954*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8955*      PF14 = ACCOUNT MASTER                                     *
  8956*      PF16 = LETTER REVIEW                                      *
  8957*                                                                *
  8958******************************************************************
  8959
  8960 0400-CHECK-CANCEL-PF-KEYS.
  8961     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8962        MOVE ER-2337             TO EMI-ERROR
  8963        MOVE -1                  TO CMAINTL
  8964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8965        GO TO 8200-SEND-DATAONLY.
  8966
  8967     IF EIBAID = DFHPF1
  8968        MOVE '0'                TO PI-EDIT-SW
  8969        IF PI-PRIMARY-BROWSE
  8970           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8971        ELSE
  8972           IF PI-PRIMARY-WITH-SELECT
  8973              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8974           ELSE
  8975              IF PI-FILE-BROWSE
  8976                 GO TO 4300-BROWSE-FILE-FORWARD
  8977              ELSE
  8978                 IF PI-CSR-BROWSE
  8979                    GO TO 4200-BROWSE-CSR-FORWARD
  8980                 ELSE
  8981                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8982
  8983     IF EIBAID = DFHPF2
  8984        MOVE '0'                TO PI-EDIT-SW
  8985        IF PI-PRIMARY-BROWSE
  8986           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8987        ELSE
  8988           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 165
* EL6311.cbl
  8989              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8990           ELSE
  8991              IF PI-FILE-BROWSE
  8992                 GO TO 4800-BROWSE-FILE-BACKWARD
  8993              ELSE
  8994                 IF PI-CSR-BROWSE
  8995                    GO TO 4900-BROWSE-CSR-BACKWARD
  8996                 ELSE
  8997                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8998
  8999     IF EIBAID = DFHPF3
  9000        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9001        MOVE XCTL-EL127         TO PGM-NAME
  9002        GO TO 9300-XCTL.
  9003
  9004     IF (EIBAID = DFHPF15 OR DFHPF17)
  9005        AND (CSR-EDIT-SESSION)
  9006*       AND (FATAL-OR-UNFORCED)
  9007        AND (FATAL-ERRORS)
  9008        MOVE ER-1819             TO EMI-ERROR
  9009        MOVE -1                  TO CMAINTL
  9010        MOVE AL-UANON            TO CMAINTA
  9011        PERFORM 9900-ERROR-FORMAT
  9012                                 THRU 9900-EXIT
  9013        GO TO 8200-SEND-DATAONLY
  9014     END-IF
  9015     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  9016       AND (CSR-EDIT-SESSION)
  9017        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  9018        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  9019        IF (RESP-NORMAL)
  9020           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  9021              AM-CONTROL-PRIMARY (1:20))
  9022            IF AM-NAME NOT GREATER THAN SPACES OR
  9023               AM-ADDRS NOT GREATER THAN SPACES  OR
  9024               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  9025               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  9026               AM-ZIP NOT GREATER THAN SPACES
  9027               MOVE ER-3834             TO EMI-ERROR
  9028               MOVE -1                  TO BMAINTL
  9029               MOVE AL-UANON            TO BMAINTA
  9030               PERFORM 9900-ERROR-FORMAT
  9031                                 THRU 9900-EXIT
  9032               GO TO 8200-SEND-DATAONLY
  9033            END-IF
  9034        ELSE
  9035           MOVE ER-1609             TO EMI-ERROR
  9036           MOVE -1                  TO BMAINTL
  9037           MOVE AL-UANON            TO BMAINTA
  9038           PERFORM 9900-ERROR-FORMAT
  9039                                THRU 9900-EXIT
  9040           GO TO 8200-SEND-DATAONLY
  9041        END-IF
  9042
  9043        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  9044        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9045        IF (ERMAIL-FOUND)
  9046            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 166
* EL6311.cbl
  9047               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9048               MA-CITY NOT GREATER THAN SPACES OR
  9049               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9050               MA-ZIP-CODE NOT GREATER THAN SPACES
  9051               MOVE ER-3835             TO EMI-ERROR
  9052               MOVE -1                  TO BMAINTL
  9053               MOVE AL-UANON            TO BMAINTA
  9054               PERFORM 9900-ERROR-FORMAT
  9055                                 THRU 9900-EXIT
  9056               GO TO 8200-SEND-DATAONLY
  9057            END-IF
  9058        ELSE
  9059           MOVE ER-3000             TO EMI-ERROR
  9060           MOVE -1                  TO BMAINTL
  9061           MOVE AL-UANON            TO BMAINTA
  9062           PERFORM 9900-ERROR-FORMAT
  9063                                THRU 9900-EXIT
  9064           GO TO 8200-SEND-DATAONLY
  9065        END-IF
  9066
  9067     END-IF
  9068     IF (EIBAID = DFHPF15 OR DFHPF17)
  9069        AND (CSR-EDIT-SESSION)
  9070        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9071        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9072        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9073        MOVE PI-SV-STATE         TO PI-STATE
  9074        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9075        MOVE CCERTNOI            TO PI-CERT-PRIME
  9076        MOVE CSUFIXI             TO PI-CERT-SFX
  9077        MOVE CEFFDTI             TO DEEDIT-FIELD
  9078        PERFORM 8600-DEEDIT
  9079        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9080        MOVE '4'                 TO DC-OPTION-CODE
  9081        PERFORM 9700-DATE-LINK
  9082        IF DATE-CONVERSION-ERROR
  9083           MOVE ER-0348          TO EMI-ERROR
  9084           MOVE -1               TO CEFFDTL
  9085           MOVE AL-UABON         TO CEFFDTA
  9086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9087           GO TO 8200-SEND-DATAONLY
  9088        ELSE
  9089           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9090           PERFORM 6000-CREATE-TEMP-STORAGE
  9091                                 THRU 6000-EXIT
  9092           IF EIBAID = DFHPF17
  9093               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9094                                  THRU 6400-EXIT
  9095               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9096                                 '2' AND '3' AND '4'
  9097                  MOVE ER-3831     TO  EMI-ERROR
  9098                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9099                  GO TO 8200-SEND-DATAONLY
  9100               END-IF
  9101               MOVE 'Y'          TO PI-CLM-RESC-IND
  9102           ELSE
  9103               MOVE 'N'          TO PI-CLM-RESC-IND
  9104           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 167
* EL6311.cbl
  9105           MOVE XCTL-EL6316      TO PGM-NAME
  9106           MOVE '2'              TO PI-ISS-CAN-SW
  9107           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9108           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9109           GO TO 9300-XCTL
  9110        END-IF
  9111     END-IF
  9112
  9113     IF EIBAID = DFHPF4
  9114        MOVE '0'                TO PI-EDIT-SW
  9115        IF PI-DISPLAY-ORIGINAL-BATCH
  9116           NEXT SENTENCE
  9117        ELSE
  9118           GO TO 7200-DISPLAY-BATCHES.
  9119
  9120     IF EIBAID = DFHPF5
  9121        MOVE ER-0029                TO EMI-ERROR
  9122        MOVE -1                     TO BPFENTRL
  9123        MOVE AL-UNBON               TO BPFENTRA
  9124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125        GO TO 8200-SEND-DATAONLY.
  9126*        MOVE '0'                TO PI-EDIT-SW
  9127*        IF PI-DISPLAY-ORIGINAL-BATCH
  9128*           NEXT SENTENCE
  9129*        ELSE
  9130*           MOVE EL631B              TO PI-MAP-NAME
  9131*           MOVE LOW-VALUES          TO EL631BI
  9132*           MOVE 'A'                 TO BMAINTO
  9133*           MOVE AL-UANON            TO BMAINTA
  9134*           MOVE -1                  TO BMAINTL
  9135*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9136*           GO TO 8100-SEND-INITIAL-MAP.
  9137
  9138     IF EIBAID = DFHPF6
  9139        MOVE ER-0029                TO EMI-ERROR
  9140        MOVE -1                     TO BPFENTRL
  9141        MOVE AL-UNBON               TO BPFENTRA
  9142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9143        GO TO 8200-SEND-DATAONLY.
  9144*        MOVE '0'                TO PI-EDIT-SW
  9145*        IF PI-DISPLAY-ORIGINAL-BATCH
  9146*           NEXT SENTENCE
  9147*        ELSE
  9148*           MOVE EL631C              TO PI-MAP-NAME
  9149*           MOVE LOW-VALUES          TO EL631CI
  9150*           MOVE 'A'                 TO CMAINTO
  9151*           MOVE AL-UANON            TO CMAINTA
  9152*           MOVE -1                  TO CMAINTL
  9153*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9154*           GO TO 8100-SEND-INITIAL-MAP.
  9155
  9156     IF EIBAID = DFHPF7
  9157        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9158        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9159        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9160        MOVE PI-SV-STATE            TO PI-STATE
  9161        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9162        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 168
* EL6311.cbl
  9163        MOVE CSUFIXI                TO PI-CERT-SFX
  9164        MOVE CEFFDTI                TO DEEDIT-FIELD
  9165        PERFORM 8600-DEEDIT
  9166        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9167        MOVE '4'                    TO DC-OPTION-CODE
  9168        PERFORM 9700-DATE-LINK
  9169        IF DATE-CONVERSION-ERROR
  9170           MOVE ER-0348            TO EMI-ERROR
  9171           MOVE -1                  TO BEFFDTL
  9172           MOVE AL-UABON            TO BEFFDTA
  9173           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9174           GO TO 8200-SEND-DATAONLY
  9175        ELSE
  9176           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9177           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9178           MOVE XCTL-EL1273        TO PGM-NAME
  9179           GO TO 9300-XCTL.
  9180
  9181     IF EIBAID = DFHPF8
  9182        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9183        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9184        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9185        MOVE PI-SV-STATE            TO PI-STATE
  9186        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9187        MOVE CCERTNOI               TO PI-CERT-PRIME
  9188        MOVE CSUFIXI                TO PI-CERT-SFX
  9189        MOVE CEFFDTI                TO DEEDIT-FIELD
  9190        PERFORM 8600-DEEDIT
  9191        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9192        MOVE '4'                    TO DC-OPTION-CODE
  9193        PERFORM 9700-DATE-LINK
  9194        IF DATE-CONVERSION-ERROR
  9195           MOVE ER-0348             TO EMI-ERROR
  9196           MOVE -1                  TO BEFFDTL
  9197           MOVE AL-UABON            TO BEFFDTA
  9198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9199           GO TO 8200-SEND-DATAONLY
  9200        ELSE
  9201           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9202           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9203           IF PI-COMPANY-ID = 'DMD'
  9204               MOVE XCTL-EL401DMD      TO PGM-NAME
  9205             ELSE
  9206               MOVE XCTL-EL1279        TO PGM-NAME
  9207           END-IF
  9208           GO TO 9300-XCTL.
  9209
  9210     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9211        MOVE XCTL-EL6312     TO PGM-NAME
  9212
  9213* EXEC CICS XCTL
  9214*           PROGRAM  (PGM-NAME)
  9215*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9216*           LENGTH   (WS-COMM-LENGTH)
  9217*       END-EXEC
  9218*    MOVE '.$C                   %   #00009142' TO DFHEIV0
  9219     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9220     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 169
* EL6311.cbl
  9221     MOVE X'2020233030303039313432' TO DFHEIV0(25:11)
  9222     CALL 'kxdfhei1' USING DFHEIV0,
  9223           PGM-NAME,
  9224           PROGRAM-INTERFACE-BLOCK,
  9225           WS-COMM-LENGTH,
  9226           DFHEIV99
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9228     ELSE
  9229        MOVE '0'                 TO  PI-EDIT-SW.
  9230
  9231     IF EIBAID = DFHPF10
  9232         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9233         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9234         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9235         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9236                                    PI-1042-WA
  9237         MOVE 4                  TO PI-689-DATA-SOURCE
  9238         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9239         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9240         MOVE PI-SV-STATE        TO PI-689-STATE
  9241         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9242         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9243         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9244         MOVE PI-PB-ALT-CHG-SEQ-NO
  9245                                 TO PI-689-ALT-SEQ-NO
  9246         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9247         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9248         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9249         MOVE +0                 TO PI-689-CONTROL
  9250         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9251                                    PI-689-EXP-DATE
  9252                                    PI-689-RESP-PERSON
  9253                                    PI-689-TYPE
  9254                                    PI-689-FOLLOW-UP-EDIT
  9255                                    PI-689-RESEND1-EDIT
  9256                                    PI-689-SEQ-EDIT
  9257                                    PI-689-BCSEQ-EDIT
  9258                                    PI-689-LBL-OVERRIDE
  9259         MOVE W-LETTER-COMMUNICATION-AREAS
  9260                                 TO PI-PROGRAM-WORK-AREA
  9261         MOVE XCTL-EL689         TO PGM-NAME
  9262         GO TO 9300-XCTL.
  9263
  9264     IF  EIBAID = DFHPF16
  9265         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9266         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9267         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9268                                    PI-1042-WA
  9269         MOVE 4                  TO PI-689-DATA-SOURCE
  9270         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9271         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9272         MOVE PI-SV-STATE        TO PI-689-STATE
  9273         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9274         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9275         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9276         MOVE PI-PB-ALT-CHG-SEQ-NO
  9277                                 TO PI-689-ALT-SEQ-NO
  9278         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 170
* EL6311.cbl
  9279         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9280         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9281         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9282         MOVE W-LETTER-COMMUNICATION-AREAS
  9283                                 TO PI-PROGRAM-WORK-AREA
  9284         MOVE XCTL-EL690         TO PGM-NAME
  9285         GO TO 9300-XCTL.
  9286     IF (EIBAID = DFHPF13)
  9287        if (not fatal-errors)
  9288           and (not unforced-errors)
  9289           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9290           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9291           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9292           MOVE PI-SV-STATE      TO PI-STATE
  9293           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9294           MOVE CCERTNOI         TO PI-CERT-PRIME
  9295           MOVE CSUFIXI          TO PI-CERT-SFX
  9296           MOVE CEFFDTI          TO DEEDIT-FIELD
  9297           PERFORM 8600-DEEDIT
  9298           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9299           MOVE '4'              TO DC-OPTION-CODE
  9300           PERFORM 9700-DATE-LINK
  9301           IF DATE-CONVERSION-ERROR
  9302              MOVE ER-0348       TO EMI-ERROR
  9303              MOVE -1            TO CEFFDTL
  9304              MOVE AL-UABON      TO CEFFDTA
  9305              PERFORM 9900-ERROR-FORMAT
  9306                                 THRU 9900-EXIT
  9307              GO TO 8200-SEND-DATAONLY
  9308           ELSE
  9309              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9310              MOVE AL-UANON      TO CEFFDTA
  9311              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9312              PERFORM 6000-CREATE-TEMP-STORAGE
  9313                                 THRU 6000-EXIT
  9314              MOVE XCTL-EL677    TO PGM-NAME
  9315              GO TO 9300-XCTL
  9316           end-if
  9317        else
  9318           MOVE ER-3444          TO EMI-ERROR
  9319           MOVE -1               TO CPFENTRL
  9320           MOVE AL-UNBON         TO CPFENTRA
  9321           PERFORM 9900-ERROR-FORMAT
  9322                                 THRU 9900-EXIT
  9323           GO TO 8200-SEND-DATAONLY
  9324        end-if
  9325     end-if
  9326
  9327     IF EIBAID = DFHPF14
  9328        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9329        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9330        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9331        MOVE PI-SV-STATE            TO PI-CR-STATE
  9332        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9333        MOVE SPACE                  TO PI-EDIT-SW
  9334        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9335        MOVE XCTL-EL650             TO PGM-NAME
  9336        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 171
* EL6311.cbl
  9337
  9338     IF EIBAID = DFHENTER OR DFHPF11
  9339        GO TO 2000-CANCEL-MAINLINE.
  9340
  9341     MOVE ER-0029                TO EMI-ERROR.
  9342     MOVE -1                     TO CPFENTRL.
  9343     MOVE AL-UNBON               TO CPFENTRA.
  9344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9345     GO TO 8200-SEND-DATAONLY.
  9346
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 172
* EL6311.cbl
  9348
  9349******************************************************************
  9350*                                                                *
  9351*      BATCH SCREEN PF KEY CHECKING                              *
  9352*                                                                *
  9353******************************************************************
  9354
  9355******************************************************************
  9356*                                                                *
  9357*      PF KEY FUNCTIONS:                                         *
  9358*                                                                *
  9359*      PF1 = BROWSE FORWARD                                      *
  9360*      PF2 = BROWSE BACKWARD                                     *
  9361*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9362*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9363*                                                                *
  9364*                                                                *
  9365******************************************************************
  9366
  9367 0500-CHECK-BATCH-PF-KEYS.
  9368     IF EIBAID = DFHPF1
  9369        MOVE '0'                TO PI-EDIT-SW
  9370        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9371           GO TO 5000-BROWSE-BATCH-HEADERS
  9372        ELSE
  9373           IF PI-GOOD-BROWSE
  9374              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9375                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9376              ELSE
  9377                 IF PI-FILE-BROWSE
  9378                    GO TO 4300-BROWSE-FILE-FORWARD
  9379                 ELSE
  9380                    IF PI-CSR-BROWSE
  9381                       GO TO 4200-BROWSE-CSR-FORWARD
  9382                    ELSE
  9383                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9384           ELSE
  9385              GO TO 0800-BROWSE-ERROR.
  9386
  9387     IF EIBAID = DFHPF2
  9388        MOVE '0'                TO PI-EDIT-SW
  9389        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9390           GO TO 5500-BROWSE-BATCH-BACKWARD
  9391        ELSE
  9392           IF PI-GOOD-BROWSE
  9393              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9394                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9395              ELSE
  9396                 IF PI-FILE-BROWSE
  9397                    GO TO 4800-BROWSE-FILE-BACKWARD
  9398                 ELSE
  9399                    IF PI-CSR-BROWSE
  9400                       GO TO 4900-BROWSE-CSR-BACKWARD
  9401                    ELSE
  9402                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9403           ELSE
  9404              GO TO 0800-BROWSE-ERROR.
  9405
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 173
* EL6311.cbl
  9406     IF EIBAID = DFHPF3
  9407        GO TO 3000-BATCH-MAINLINE.
  9408
  9409     IF  EIBAID = DFHPF4
  9410        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9411        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9412        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9413        MOVE PI-SV-STATE            TO PI-CR-STATE
  9414        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9415                                       PI-CR-FIN-RESP
  9416        MOVE 'A'                    TO PI-CR-TYPE
  9417        MOVE SPACE                  TO PI-EDIT-SW
  9418        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9419        MOVE XCTL-EL640             TO PGM-NAME
  9420        GO TO 9300-XCTL.
  9421
  9422     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9423       AND
  9424        (EIBAID = DFHENTER)
  9425           GO TO 3500-EDIT-BATCH-DATA.
  9426
  9427     IF EIBAID = DFHENTER
  9428        GO TO 3500-EDIT-BATCH-DATA.
  9429
  9430     MOVE ER-0029             TO EMI-ERROR.
  9431     MOVE -1                  TO DPFENTRL.
  9432     MOVE AL-UNBON            TO DPFENTRA.
  9433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9434     GO TO 8200-SEND-DATAONLY.
  9435
  9436 0800-BROWSE-ERROR.
  9437     MOVE ER-2258                TO EMI-ERROR.
  9438     MOVE -1                     TO DPFENTRL.
  9439     MOVE AL-UNBON               TO DPFENTRA.
  9440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441     GO TO 8200-SEND-DATAONLY.
  9442
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 174
* EL6311.cbl
  9444
  9445******************************************************************
  9446*                                                                *
  9447*                I S S U E   M A I N L I N E                     *
  9448*                                                                *
  9449******************************************************************
  9450
  9451 1000-ISSUE-MAINLINE.
  9452     IF PI-DISPLAY-ORIGINAL-BATCH
  9453        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9454           MOVE ER-0023             TO EMI-ERROR
  9455           MOVE -1                  TO BMAINTL
  9456           MOVE AL-UABON            TO BMAINTA
  9457           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9458           GO TO 8200-SEND-DATAONLY
  9459        ELSE
  9460           NEXT SENTENCE
  9461     ELSE
  9462        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9463           MOVE ER-0023             TO EMI-ERROR
  9464           MOVE -1                  TO BMAINTL
  9465           MOVE AL-UABON            TO BMAINTA
  9466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9467           GO TO 8200-SEND-DATAONLY.
  9468
  9469     IF BMAINTI = 'S'
  9470        GO TO 1100-SHOW-REQUEST.
  9471
  9472     IF NOT MODIFY-CAP
  9473         MOVE 'UPDATE'       TO SM-READ
  9474         PERFORM 9995-SECURITY-VIOLATION
  9475         MOVE ER-0070        TO EMI-ERROR
  9476         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9477         GO TO 8100-SEND-INITIAL-MAP.
  9478
  9479     IF BMAINTL GREATER THAN ZEROS
  9480        IF PI-PF5-FUNCTION
  9481           IF BMAINTI NOT = 'A'
  9482              MOVE AL-UABON  TO BMAINTA
  9483              MOVE -1        TO BMAINTL
  9484              MOVE ER-2260   TO EMI-ERROR
  9485              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9486              GO TO 8200-SEND-DATAONLY.
  9487
  9488     IF BCERTNOL = ZEROS
  9489       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9490         NEXT SENTENCE
  9491     ELSE
  9492         IF BCERTNOL NOT = ZEROS
  9493             MOVE AL-UANON       TO BCERTNOA
  9494         ELSE
  9495             MOVE -1             TO BCERTNOL
  9496             MOVE  1             TO SET-CURSOR-SW
  9497             MOVE ER-2218        TO EMI-ERROR
  9498             MOVE AL-UABON       TO BCERTNOA
  9499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9500
  9501     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 175
* EL6311.cbl
  9502         MOVE AL-UANON       TO BSUFIXA
  9503     ELSE
  9504         MOVE AL-SANOF       TO BSUFIXA.
  9505
  9506     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9507        NEXT SENTENCE
  9508     ELSE
  9509        IF BEFFDTL NOT = ZEROS
  9510           MOVE AL-UNNON             TO BEFFDTA
  9511           MOVE BEFFDTI              TO DEEDIT-FIELD
  9512           PERFORM 8600-DEEDIT
  9513           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9514           MOVE 4                    TO DC-OPTION-CODE
  9515           PERFORM 9700-DATE-LINK
  9516           IF NO-CONVERSION-ERROR
  9517              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9518              ELSE
  9519              MOVE -1                TO BEFFDTL
  9520              MOVE  1                TO SET-CURSOR-SW
  9521              MOVE ER-2226           TO EMI-ERROR
  9522              MOVE AL-UNBON          TO BEFFDTA
  9523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9524           ELSE
  9525              MOVE -1                TO BEFFDTL
  9526              MOVE  1                TO SET-CURSOR-SW
  9527              MOVE ER-2220           TO EMI-ERROR
  9528              MOVE AL-UNBON          TO BEFFDTA
  9529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9530
  9531     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9532
  9533     IF BCERTNOL NOT = ZEROS
  9534        MOVE BCERTNOI                TO WS-NEW-PRIME
  9535     ELSE
  9536        MOVE SPACES                  TO WS-NEW-PRIME.
  9537
  9538     IF BSUFIXL NOT = ZEROS
  9539        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9540     ELSE
  9541        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9542
  9543     IF BEFFDTL NOT = ZEROS
  9544        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9545     ELSE
  9546        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9547
  9548     IF BMAINTI = 'A' OR 'K' OR 'S'
  9549        NEXT SENTENCE
  9550     ELSE
  9551        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9552        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9553           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9554           WS-PB-RECORD-TYPE NOT = '1'
  9555           IF BMAINTI = 'C'
  9556               MOVE ER-2287          TO EMI-ERROR
  9557               MOVE -1               TO BCERTNOL
  9558               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9559               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 176
* EL6311.cbl
  9560               GO TO 8200-SEND-DATAONLY
  9561             ELSE
  9562               MOVE ER-2260          TO EMI-ERROR
  9563               MOVE -1               TO BCERTNOL
  9564               MOVE AL-UABON         TO BCERTNOA
  9565               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9566               GO TO 8200-SEND-DATAONLY.
  9567
  9568     IF BMAINTI = 'D'
  9569         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9570
  9571*    IF BMICRNOL  NOT =  ZEROS
  9572*        IF BMICRNOI  NUMERIC
  9573*            MOVE AL-UNNON       TO  BMICRNOA
  9574*        ELSE
  9575*            MOVE -1             TO  BMICRNOL
  9576*            MOVE 1              TO  SET-CURSOR-SW
  9577*            MOVE AL-UNBON       TO  BMICRNOA
  9578*            MOVE ER-2701        TO  EMI-ERROR
  9579*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9580     IF BVINL NOT = ZEROS
  9581        MOVE AL-UANON            TO BVINA
  9582     END-IF
  9583     IF B1STNML NOT = ZEROS
  9584         MOVE AL-UANON                TO B1STNMA.
  9585
  9586     IF BINITL  NOT = ZEROS
  9587        MOVE AL-UANON                TO BINITA.
  9588
  9589     IF BSEXL NOT = ZEROS
  9590        IF BSEXI = 'M' OR 'F'
  9591           MOVE AL-UANON             TO BSEXA
  9592        ELSE
  9593           MOVE -1               TO BSEXL
  9594           MOVE ER-2629          TO EMI-ERROR
  9595           MOVE AL-UABON         TO BSEXA
  9596           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9597
  9598     IF BAGEL NOT = ZEROS
  9599         IF BAGEI NUMERIC
  9600             MOVE BAGEI              TO WS-BAGE
  9601             MOVE AL-UNNON           TO BAGEA
  9602         ELSE
  9603             MOVE -1                 TO BAGEL
  9604             MOVE  1                 TO SET-CURSOR-SW
  9605             MOVE ER-2223            TO EMI-ERROR
  9606             MOVE AL-UNBON           TO BAGEA
  9607             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9608
  9609     IF BLSTNML NOT = ZERO  OR
  9610        B1STNML NOT = ZERO  OR
  9611        BINITL NOT = ZERO
  9612         IF BAGEL = ZEROS
  9613             MOVE -1                 TO BAGEL
  9614             MOVE  1                 TO SET-CURSOR-SW
  9615             MOVE ER-3269            TO EMI-ERROR
  9616             MOVE AL-UNBON           TO BAGEA
  9617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 177
* EL6311.cbl
  9618         END-IF
  9619     END-IF.
  9620
  9621     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9622
  9623     IF (BBIRTHL GREATER THAN +0) AND
  9624        (BBIRTHI NOT EQUAL SPACES)
  9625        NEXT SENTENCE
  9626     ELSE
  9627        GO TO 1010-CHECK-AGE.
  9628
  9629     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9630     PERFORM 8600-DEEDIT.
  9631     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9632     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9633     MOVE AL-UNNON               TO BBIRTHA.
  9634     MOVE '4'                    TO DC-OPTION-CODE.
  9635     PERFORM 9700-DATE-LINK.
  9636     IF DATE-CONVERSION-ERROR
  9637        MOVE -1                  TO BBIRTHL
  9638        MOVE  1                  TO SET-CURSOR-SW
  9639        MOVE ER-2228             TO EMI-ERROR
  9640        MOVE AL-UNBON            TO BBIRTHA
  9641        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9642        GO TO 1010-CHECK-AGE.
  9643
  9644     IF (NO-CONVERSION-ERROR) AND
  9645        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9646        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9647        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9648        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9649                                    WS-CONVERTED-BIRTH
  9650        MOVE AL-UANON            TO BBIRTHA
  9651     ELSE
  9652        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9653        MOVE AL-UANON            TO BBIRTHA.
  9654
  9655 1010-CHECK-AGE.
  9656
  9657*    IF BAGEL = ZERO
  9658*       IF BBIRTHL GREATER THAN ZERO
  9659*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9660
  9661     IF B1STPMTL NOT = ZEROS
  9662        IF B1STPMTI = SPACES
  9663           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9664        ELSE
  9665           MOVE B1STPMTI             TO DEEDIT-FIELD
  9666           PERFORM 8600-DEEDIT
  9667           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9668           MOVE AL-UNNON             TO B1STPMTA
  9669           MOVE 4                    TO DC-OPTION-CODE
  9670           PERFORM 9700-DATE-LINK
  9671           IF NO-CONVERSION-ERROR
  9672              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9673              MOVE AL-UANON          TO B1STPMTA
  9674           ELSE
  9675              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 178
* EL6311.cbl
  9676              MOVE  1                TO SET-CURSOR-SW
  9677              MOVE ER-2200           TO EMI-ERROR
  9678              MOVE AL-UNBON          TO B1STPMTA
  9679              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9680
  9681     IF BDAYSL NOT = ZEROS
  9682         IF BDAYSI NUMERIC
  9683             MOVE AL-UNNON           TO BDAYSA
  9684         ELSE
  9685             MOVE -1                 TO BDAYSL
  9686             MOVE ER-2530            TO EMI-ERROR
  9687             MOVE AL-UNBON           TO BDAYSA
  9688             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9689
  9690     IF BLNTRML NOT = ZEROS
  9691         IF BLNTRMI NUMERIC
  9692             MOVE AL-UNNON       TO BLNTRMA
  9693         ELSE
  9694             MOVE -1             TO BLNTRML
  9695             MOVE ER-2533        TO EMI-ERROR
  9696             MOVE AL-UNBON       TO BLNTRMA
  9697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9698
  9699**   IF PI-COMPANY-ID = 'DMD'
  9700     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9701        NEXT SENTENCE
  9702     ELSE
  9703         IF BLNOFCRL NOT = ZEROS
  9704            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9705            IF LOAN-OFFICER-FOUND
  9706                MOVE AL-UANON        TO BLNOFCRA
  9707             ELSE
  9708                 MOVE SPACE          TO WS-LOAN-OFFICER
  9709                 MOVE -1             TO BLNOFCRL
  9710                 MOVE  1             TO SET-CURSOR-SW
  9711                 MOVE ER-3006        TO EMI-ERROR
  9712                 MOVE AL-UNBON       TO BLNOFCRA
  9713                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9714
  9715     IF BFREQL NOT = ZEROS
  9716         IF BFREQI NUMERIC
  9717             MOVE AL-UNNON       TO BFREQA
  9718         ELSE
  9719             MOVE -1             TO BFREQL
  9720             MOVE  1             TO SET-CURSOR-SW
  9721             MOVE ER-2223        TO EMI-ERROR
  9722             MOVE AL-UNBON       TO BFREQA
  9723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9724
  9725     IF BMODEL NOT = ZEROS
  9726         MOVE BMODEI             TO WS-MODE-CODE
  9727                                    PI-BMODE
  9728         IF WS-MODE-CODE-VALID
  9729             MOVE AL-UANON       TO BMODEA
  9730         ELSE
  9731             MOVE -1             TO BMODEL
  9732             MOVE ER-2591        TO EMI-ERROR
  9733             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 179
* EL6311.cbl
  9734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9735
  9736     IF BPMTSL NOT = ZEROS
  9737         IF BPMTSI NUMERIC
  9738             MOVE AL-UNNON           TO BPMTSA
  9739             MOVE BPMTSI             TO PI-BPMTS
  9740         ELSE
  9741             MOVE -1                 TO BPMTSL
  9742             MOVE ER-2592            TO EMI-ERROR
  9743             MOVE AL-UNBON           TO BPMTSA
  9744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9745
  9746     IF BPMTAMTL NOT = ZEROS
  9747
  9748* EXEC CICS BIF DEEDIT
  9749*            FIELD  (BPMTAMTI)
  9750*            LENGTH (9)
  9751*       END-EXEC
  9752     MOVE 9
  9753       TO DFHEIV11
  9754*    MOVE '@"L                   #   #00009666' TO DFHEIV0
  9755     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9756     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9757     MOVE X'2020233030303039363636' TO DFHEIV0(25:11)
  9758     CALL 'kxdfhei1' USING DFHEIV0,
  9759           BPMTAMTI,
  9760           DFHEIV11
  9761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9762        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9763*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9764*        PERFORM 8600-DEEDIT
  9765*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9766
  9767*    IF BAPRL NOT = ZEROS
  9768*        EXEC CICS BIF DEEDIT
  9769*            FIELD  (BAPRI)
  9770*            LENGTH (7)
  9771*        END-EXEC
  9772*        MOVE BAPRI              TO WS-BAPR.
  9773
  9774     IF BAPRL > 0
  9775        MOVE +0                  TO  WS-BAPR
  9776        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9777           (WS-SUB > 7)
  9778           OR (BAPRI (WS-SUB:1) NUMERIC)
  9779           OR (BAPRI (WS-SUB:1) = '.')
  9780        END-PERFORM
  9781        IF WS-SUB > 7
  9782           MOVE ER-2471       TO EMI-ERROR
  9783           MOVE -1            TO BAPRL
  9784           MOVE AL-UNBON      TO BAPRA
  9785           PERFORM 9900-ERROR-FORMAT
  9786                                 THRU 9900-EXIT
  9787        ELSE
  9788           IF BAPRI (WS-SUB:1) NUMERIC
  9789              MOVE WS-SUB           TO WS-BEG
  9790              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9791                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 180
* EL6311.cbl
  9792                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9793              END-PERFORM
  9794              COMPUTE WS-END = WS-SUB - WS-BEG
  9795              MOVE BAPRI (WS-BEG:WS-END)
  9796                                 TO WS-APR-WHOLE-NUM
  9797           END-IF
  9798           IF BAPRI (WS-SUB:1) = '.'
  9799              COMPUTE WS-BEG = WS-SUB + 1
  9800              IF (WS-BEG < 8)
  9801                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9802                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9803                    (WS-SUB > 7)
  9804                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9805                 END-PERFORM
  9806                 COMPUTE WS-END = WS-SUB - WS-BEG
  9807                 MOVE BAPRI (WS-BEG:WS-END)
  9808                                 TO WS-APR-DEC (1:WS-END)
  9809              END-IF
  9810           END-IF
  9811           MOVE AL-UNNON      TO BAPRA
  9812           MOVE WS-BAPR       TO BAPRO
  9813        END-IF
  9814     END-IF
  9815*     IF BAPRL NOT = ZEROS
  9816*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9817*        PERFORM 8600-DEEDIT
  9818*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9819
  9820     IF BLIVESL NOT = ZEROS
  9821        MOVE BLIVESI             TO DEEDIT-FIELD
  9822        PERFORM 8600-DEEDIT
  9823        IF DEEDIT-FIELD-V0 NUMERIC
  9824           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9825           MOVE AL-UNNON         TO BLIVESA
  9826        ELSE
  9827           MOVE -1               TO BLIVESL
  9828           MOVE AL-UNBON         TO BLIVESA
  9829           MOVE ER-2223          TO EMI-ERROR
  9830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9831
  9832*DMD CUSTOM CODING*************START
  9833*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9834     IF PI-COMPANY-ID NOT = 'DMD'
  9835         MOVE ZEROS               TO BBILLEDL
  9836         GO TO 1010-EDIT-CONT.
  9837
  9838     IF BBILLEDL NOT = ZEROS
  9839        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9840        MOVE 'Y'                 TO WS-NUMERIC-SW
  9841        MOVE +1                  TO WS-CSO-SUB
  9842        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9843        IF CSO-NUMERIC-FIELD
  9844
  9845* EXEC CICS BIF DEEDIT
  9846*              FIELD  (BBILLEDI)
  9847*              LENGTH (9)
  9848*          END-EXEC
  9849     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 181
* EL6311.cbl
  9850       TO DFHEIV11
  9851*    MOVE '@"L                   #   #00009752' TO DFHEIV0
  9852     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9853     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9854     MOVE X'2020233030303039373532' TO DFHEIV0(25:11)
  9855     CALL 'kxdfhei1' USING DFHEIV0,
  9856           BBILLEDI,
  9857           DFHEIV11
  9858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9859           MOVE BBILLEDI         TO WS-BILLED
  9860           MOVE AL-UNNON         TO BBILLEDA
  9861        ELSE
  9862           MOVE -1               TO BBILLEDL
  9863           MOVE AL-UNBON         TO BBILLEDA
  9864           MOVE ER-2547          TO EMI-ERROR
  9865           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9866     ELSE
  9867        IF BMAINTI EQUAL 'A'
  9868           MOVE -1               TO BBILLEDL
  9869           MOVE AL-UNBON         TO BBILLEDA
  9870           MOVE ER-8148          TO EMI-ERROR
  9871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9872
  9873 1010-EDIT-CONT.
  9874
  9875     IF BFORCEL  NOT = ZEROS
  9876         IF FORCE-CAP
  9877            MOVE AL-UANON            TO BFORCEA
  9878         ELSE
  9879            MOVE ER-2945             TO EMI-ERROR
  9880            MOVE AL-UABON            TO BFORCEA
  9881            MOVE -1                  TO BFORCEL
  9882            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9883
  9884     if (bforcel not = zeros)
  9885        and (bforcei = 'L')
  9886        and (not csr-edit-session)
  9887        and (emi-error <> er-2945)
  9888        MOVE ER-2670             TO EMI-ERROR
  9889        MOVE AL-UABON            TO BFORCEA
  9890        MOVE -1                  TO BFORCEL
  9891        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9892     end-if
  9893     IF BENTRYL NOT = ZEROS
  9894        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9895                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9896           MOVE ER-2224              TO EMI-ERROR
  9897           MOVE AL-UABON             TO BENTRYA
  9898           MOVE -1                   TO BENTRYL
  9899           MOVE  1                   TO SET-CURSOR-SW
  9900           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9901        ELSE
  9902           MOVE AL-UANON             TO BENTRYA.
  9903
  9904     IF BUNWRITL NOT = ZEROS
  9905        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9906           MOVE ER-7574              TO EMI-ERROR
  9907           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 182
* EL6311.cbl
  9908           MOVE -1                   TO BUNWRITL
  9909           MOVE  1                   TO SET-CURSOR-SW
  9910           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9911        ELSE
  9912           MOVE AL-UANON             TO BUNWRITA.
  9913
  9914     IF BREINL  NOT = ZEROS
  9915         MOVE AL-UANON               TO BREINA.
  9916
  9917     IF BBILCDL NOT = ZEROS
  9918        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9919                             AND 'A' AND 'B' AND 'E'
  9920           MOVE ER-2225              TO EMI-ERROR
  9921           MOVE AL-UABON             TO BBILCDA
  9922           MOVE -1                   TO BBILCDL
  9923           MOVE  1                   TO SET-CURSOR-SW
  9924           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9925        ELSE
  9926           MOVE AL-UANON             TO BBILCDA.
  9927
  9928     IF BSKPCDL NOT = ZEROS
  9929         MOVE AL-UANON               TO BSKPCDA.
  9930
  9931     IF BINDGRPL NOT = ZEROS
  9932         MOVE AL-UANON               TO BINDGRPA.
  9933
  9934     IF BSIGL   NOT = ZEROS
  9935         MOVE AL-UANON               TO BSIGA.
  9936
  9937     IF BRTCLSL NOT = ZEROS
  9938         MOVE AL-UANON               TO BRTCLSA.
  9939
  9940     IF BMEMBERL NOT = ZEROS
  9941         MOVE AL-UANON               TO BMEMBERA.
  9942
  9943     MOVE +0                         TO WS-SUB1.
  9944
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 183
* EL6311.cbl
  9946
  9947******************************************************************
  9948*                                                                *
  9949*           E D I T   I S S U E   C O V E R A G E S              *
  9950*                                                                *
  9951******************************************************************
  9952
  9953 1020-EDIT-COVERAGES.
  9954     ADD +1                      TO WS-SUB1.
  9955
  9956     IF WS-SUB1 GREATER +2
  9957        GO TO 1025-EDIT-CONTINUE
  9958     END-IF
  9959
  9960     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9961       IF (BMODEL   GREATER ZERO  OR
  9962            BPMTSL   GREATER ZERO  OR
  9963            BPMTAMTL GREATER ZERO)
  9964          AND
  9965            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9966               GO TO 1021-CONT-EDIT.
  9967
  9968     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9969        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9970        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9971        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9972        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9973        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9974        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9975        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9976        NEXT SENTENCE
  9977         ELSE
  9978            GO TO 1020-EDIT-COVERAGES.
  9979
  9980 1021-CONT-EDIT.
  9981
  9982     IF BMAINTI = 'A'
  9983        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9984           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9985        ELSE
  9986           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9987           MOVE ER-7404          TO EMI-ERROR
  9988           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9990     ELSE
  9991        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9992           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9993
  9994     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9995        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9996        PERFORM 8600-DEEDIT
  9997        IF DEEDIT-FIELD-V0 NUMERIC
  9998           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9999        ELSE
 10000           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
 10001
 10002     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10003*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 184
* EL6311.cbl
 10004        IF BMODEL  GREATER THAN ZEROS  AND
 10005           BPMTSL  GREATER THAN ZEROS
 10006           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10007
 10008     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 10009         IF BMODEL   GREATER THAN ZEROS  OR
 10010            BPMTSL   GREATER THAN ZEROS  OR
 10011            BPMTAMTL GREATER THAN ZEROS
 10012             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10013
 10014     IF BMAINTI = ('C' OR 'K')
 10015        IF BTERM-LEN (WS-SUB1)  = ZEROS
 10016           NEXT SENTENCE
 10017        ELSE
 10018           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10019           PERFORM 8600-DEEDIT
 10020           IF DEEDIT-FIELD-V0 NUMERIC
 10021              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
 10022              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
 10023                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
 10024              ELSE
 10025                    MOVE ER-2241      TO EMI-ERROR
 10026                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
 10027                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
 10028                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10029           ELSE
 10030              MOVE ER-2223          TO EMI-ERROR
 10031              MOVE -1               TO BTERM-LEN     (WS-SUB1)
 10032              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
 10033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10034     ELSE
 10035        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
 10036            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
 10037            PERFORM 8600-DEEDIT
 10038            IF DEEDIT-FIELD-V0      NUMERIC
 10039               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
 10040                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
 10041                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
 10042               ELSE
 10043                  MOVE ER-2241         TO EMI-ERROR
 10044                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10045                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10046                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10047            ELSE
 10048              MOVE ER-2223             TO EMI-ERROR
 10049              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10050              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10051              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10052        ELSE
 10053            MOVE ER-2240               TO EMI-ERROR
 10054            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10055            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10056*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10057*        IF BMODEL  GREATER THAN ZEROS  AND
 10058*           BPMTSL  GREATER THAN ZEROS
 10059*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10060
 10061     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 185
* EL6311.cbl
 10062        AND BMAINTI = ('C' OR 'K')
 10063           NEXT SENTENCE
 10064     ELSE
 10065        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10066           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10067
 10068* EXEC CICS BIF DEEDIT
 10069*              FIELD  (BBENI (WS-SUB1))
 10070*              LENGTH (12)
 10071*          END-EXEC
 10072     MOVE 12
 10073       TO DFHEIV11
 10074*    MOVE '@"L                   #   #00009964' TO DFHEIV0
 10075     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10076     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10077     MOVE X'2020233030303039393634' TO DFHEIV0(25:11)
 10078     CALL 'kxdfhei1' USING DFHEIV0,
 10079           BBENI(WS-SUB1),
 10080           DFHEIV11
 10081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10082           IF BBENI (WS-SUB1)  NUMERIC
 10083              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10084                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10085*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10086*          PERFORM 8600-DEEDIT
 10087*          IF DEEDIT-FIELD-V2  NUMERIC
 10088*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10089*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10090              ELSE
 10091                 MOVE ER-7632    TO EMI-ERROR
 10092                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10093                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10094                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10095           ELSE
 10096              MOVE ER-2223         TO EMI-ERROR
 10097              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10098              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10099              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10100        ELSE
 10101           MOVE ER-7632    TO EMI-ERROR
 10102           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10103           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10105
 10106     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10107        AND (BMAINTI = ('C' OR 'K'))
 10108        CONTINUE
 10109     ELSE
 10110        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10111           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10112           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10113              FOR ALL '.'
 10114           IF WS-TALLY > 1
 10115              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10116                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10117              END-PERFORM
 10118              IF A1 < 9
 10119                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 186
* EL6311.cbl
 10120                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10121              END-IF
 10122           ELSE
 10123              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10124                (A1 > 11)
 10125                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10126                  LOW-VALUES OR SPACES)
 10127              END-PERFORM
 10128              IF A1 > 1 AND < 12
 10129                 MOVE SPACES
 10130                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10131              END-IF
 10132           END-IF
 10133
 10134* EXEC CICS BIF DEEDIT
 10135*              FIELD  (BPREMI (WS-SUB1))
 10136*              LENGTH (11)
 10137*          END-EXEC
 10138     MOVE 11
 10139       TO DFHEIV11
 10140*    MOVE '@"L                   #   #00010019' TO DFHEIV0
 10141     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303130303139' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           BPREMI(WS-SUB1),
 10146           DFHEIV11
 10147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10148           IF BPREMI (WS-SUB1) NUMERIC
 10149              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10150                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10151*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10152*          PERFORM 8600-DEEDIT
 10153*          IF DEEDIT-FIELD-V2  NUMERIC
 10154*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10155*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10156              ELSE
 10157                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10158                    MOVE ER-7633    TO EMI-ERROR
 10159                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10160                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10161                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10162                 END-IF
 10163              END-IF
 10164           ELSE
 10165              MOVE ER-2223         TO EMI-ERROR
 10166              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10167              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10169           END-IF
 10170        ELSE
 10171           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10172              MOVE ER-7633         TO EMI-ERROR
 10173              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10174              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10175              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10176           END-IF
 10177        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 187
* EL6311.cbl
 10178     END-IF
 10179
 10180     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10181        NEXT SENTENCE
 10182     ELSE
 10183        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10184
 10185* EXEC CICS BIF DEEDIT
 10186*           FIELD  (BCPREMI (WS-SUB1))
 10187*           LENGTH (11)
 10188*       END-EXEC
 10189     MOVE 11
 10190       TO DFHEIV11
 10191*    MOVE '@"L                   #   #00010059' TO DFHEIV0
 10192     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10193     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10194     MOVE X'2020233030303130303539' TO DFHEIV0(25:11)
 10195     CALL 'kxdfhei1' USING DFHEIV0,
 10196           BCPREMI(WS-SUB1),
 10197           DFHEIV11
 10198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10199        IF BCPREMI (WS-SUB1) NUMERIC
 10200           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10201*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10202*       PERFORM 8600-DEEDIT
 10203*       IF DEEDIT-FIELD-V2  NUMERIC
 10204*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10205        ELSE
 10206           MOVE ER-2223         TO EMI-ERROR
 10207           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10208           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10210
 10211     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10212        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10213        PERFORM 8600-DEEDIT
 10214        IF DEEDIT-FIELD-V0 NUMERIC
 10215           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10216           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10217         ELSE
 10218           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10219           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10220           MOVE ER-2223              TO EMI-ERROR
 10221           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10222
 10223     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10224        IF BEXPIRE   (WS-SUB1) = SPACES
 10225           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10226        ELSE
 10227           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10228           PERFORM 8600-DEEDIT
 10229           IF DEEDIT-FIELD-V0        NUMERIC
 10230              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10231              MOVE 4                TO DC-OPTION-CODE
 10232              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10233              PERFORM 9700-DATE-LINK
 10234              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10235                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 188
* EL6311.cbl
 10236              IF NO-CONVERSION-ERROR
 10237                 NEXT SENTENCE
 10238              ELSE
 10239                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10240                 MOVE ER-2531    TO EMI-ERROR
 10241                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10242                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10243           ELSE
 10244             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10245             MOVE ER-2532        TO EMI-ERROR
 10246             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10247             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10248
 10249     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10250        NEXT SENTENCE
 10251     ELSE
 10252
 10253* EXEC CICS BIF DEEDIT
 10254*           FIELD  (BALT-BENI (WS-SUB1))
 10255*           LENGTH (12)
 10256*       END-EXEC
 10257     MOVE 12
 10258       TO DFHEIV11
 10259*    MOVE '@"L                   #   #00010116' TO DFHEIV0
 10260     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10261     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10262     MOVE X'2020233030303130313136' TO DFHEIV0(25:11)
 10263     CALL 'kxdfhei1' USING DFHEIV0,
 10264           BALT-BENI(WS-SUB1),
 10265           DFHEIV11
 10266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10267        IF BALT-BENI (WS-SUB1) NUMERIC
 10268           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10269*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10270*       PERFORM 8600-DEEDIT
 10271*       IF DEEDIT-FIELD-V0 NUMERIC
 10272*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10273        ELSE
 10274           MOVE ER-2223         TO EMI-ERROR
 10275           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10276           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10278
 10279     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10280        NEXT SENTENCE
 10281     ELSE
 10282
 10283* EXEC CICS BIF DEEDIT
 10284*           FIELD  (BALT-PREMI (WS-SUB1))
 10285*           LENGTH (11)
 10286*       END-EXEC
 10287     MOVE 11
 10288       TO DFHEIV11
 10289*    MOVE '@"L                   #   #00010135' TO DFHEIV0
 10290     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10291     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10292     MOVE X'2020233030303130313335' TO DFHEIV0(25:11)
 10293     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 189
* EL6311.cbl
 10294           BALT-PREMI(WS-SUB1),
 10295           DFHEIV11
 10296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10297        IF BALT-PREMI (WS-SUB1) NUMERIC
 10298           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10299*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10300*       PERFORM 8600-DEEDIT
 10301*       IF DEEDIT-FIELD-V0 NUMERIC
 10302*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10303        ELSE
 10304           MOVE ER-2223         TO EMI-ERROR
 10305           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10306           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10308
 10309      GO TO 1020-EDIT-COVERAGES.
 10310     .
 10311 1025-edit-continue.
 10312     IF PI-COMPANY-ID  =  'DMD'
 10313        MOVE LOW-VALUES             TO BNCERTI
 10314                                       BNSTATI.
 10315
 10316     IF EMI-ERROR = ZEROS
 10317         NEXT SENTENCE
 10318     ELSE
 10319         GO TO 8200-SEND-DATAONLY.
 10320
 10321     IF BMAINTI = 'A'
 10322         GO TO 1200-ADD-ISSUE-ROUTINE.
 10323
 10324     IF BMAINTI = 'C'
 10325         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10326
 10327     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10328
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 190
* EL6311.cbl
 10330
 10331 1030-EDIT-FOR-NUMERICS.
 10332     IF WS-CSO-SUB EQUAL 10
 10333        GO TO 1030-EDIT-EXIT.
 10334
 10335     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10336        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10337        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10338           ADD +1               TO WS-CSO-SUB
 10339           GO TO 1030-EDIT-FOR-NUMERICS.
 10340
 10341     MOVE 'N'                   TO WS-NUMERIC-SW.
 10342
 10343 1030-EDIT-EXIT.
 10344******************************************************************
 10345*                                                                *
 10346*                 C A L C U L A T E   A G E                      *
 10347*                                                                *
 10348******************************************************************
 10349
 10350
 10351 1095-CALC-AGE.
 10352
 10353     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10354     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10355     MOVE 1                  TO DC-OPTION-CODE.
 10356     PERFORM 9700-DATE-LINK
 10357     IF NO-CONVERSION-ERROR
 10358         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10359         MOVE WS-BAGE            TO BAGEI
 10360         MOVE +2                 TO BAGEL
 10361         MOVE AL-UNNON TO BAGEA.
 10362
 10363 1099-EXIT.
 10364     EXIT.
 10365
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 191
* EL6311.cbl
 10367
 10368******************************************************************
 10369*                                                                *
 10370*                   S H O W   I S S U E                          *
 10371*                                                                *
 10372******************************************************************
 10373
 10374 1100-SHOW-REQUEST.
 10375     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10376
 10377     IF BCERTNOL = ZEROS AND
 10378        BEFFDTL  = ZEROS
 10379        MOVE -1                  TO BMAINTL
 10380        GO TO 8200-SEND-DATAONLY.
 10381
 10382     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10383
 10384     IF BSUFIXL NOT = ZEROS
 10385        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10386     ELSE
 10387        MOVE SPACE               TO WS-NEW-SUFFIX.
 10388
 10389     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10390     PERFORM 8600-DEEDIT.
 10391     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10392     MOVE '4'                    TO DC-OPTION-CODE.
 10393     PERFORM 9700-DATE-LINK.
 10394     IF DATE-CONVERSION-ERROR
 10395        MOVE ER-0348             TO EMI-ERROR
 10396        MOVE -1                  TO BEFFDTL
 10397        MOVE AL-UABON            TO BEFFDTA
 10398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10399        GO TO 8200-SEND-DATAONLY
 10400     ELSE
 10401        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10402        MOVE AL-UANON            TO BEFFDTA
 10403        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10404
 10405     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10406
 10407     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10408        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10409          MOVE 'Y'                    TO WS-SHOW-SW
 10410          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10411             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10412           ELSE
 10413             IF PI-FILE-BROWSE
 10414                GO TO 4300-BROWSE-FILE-FORWARD
 10415              ELSE
 10416                IF PI-CSR-BROWSE
 10417                   GO TO 4200-BROWSE-CSR-FORWARD
 10418                ELSE
 10419                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10420        ELSE
 10421           GO TO 3900-RE-DISPLAY-RECORD.
 10422
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 192
* EL6311.cbl
 10424
 10425******************************************************************
 10426*                                                                *
 10427*            A D D   I S S U E   R O U T I N E                   *
 10428*                                                                *
 10429******************************************************************
 10430
 10431***************************************************************
 10432*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10433*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10434*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10435*     4. LINK TO THE EDIT ROUTINE.                            *
 10436*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10437*     6. WRITE THE NEW ISSUE RECORD.                          *
 10438*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10439*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10440*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10441*        ELSE                                                 *
 10442*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10443***************************************************************
 10444
 10445 1200-ADD-ISSUE-ROUTINE.
 10446     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10447
 10448
 10449* EXEC CICS GETMAIN
 10450*        SET     (ADDRESS OF PENDING-BUSINESS)
 10451*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10452*    END-EXEC.
 10453*    MOVE '," L                  $   #00010290' TO DFHEIV0
 10454     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10455     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10456     MOVE X'2020233030303130323930' TO DFHEIV0(25:11)
 10457     CALL 'kxdfhei1' USING DFHEIV0,
 10458           DFHEIV20,
 10459           ERPNDB-RECORD-LENGTH,
 10460           DFHEIV99
 10461     SET ADDRESS OF PENDING-BUSINESS TO
 10462         DFHEIV20
 10463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10464
 10465
 10466
 10467* EXEC CICS HANDLE CONDITION
 10468*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10469*    END-EXEC.
 10470*    MOVE '"$I                   ! # #00010295' TO DFHEIV0
 10471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10473     MOVE X'2320233030303130323935' TO DFHEIV0(25:11)
 10474     CALL 'kxdfhei1' USING DFHEIV0
 10475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10476
 10477
 10478     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10479     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10480     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10481
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 193
* EL6311.cbl
 10482
 10483* EXEC CICS READ
 10484*        INTO    (PENDING-BUSINESS)
 10485*        DATASET (FILE-ID-ERPNDB)
 10486*        RIDFLD  (ERPNDB-KEY)
 10487*    END-EXEC.
 10488     MOVE LENGTH OF
 10489      PENDING-BUSINESS
 10490       TO DFHEIV11
 10491*    MOVE '&"IL       E          (   #00010303' TO DFHEIV0
 10492     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10494     MOVE X'2020233030303130333033' TO DFHEIV0(25:11)
 10495     CALL 'kxdfhei1' USING DFHEIV0,
 10496           FILE-ID-ERPNDB,
 10497           PENDING-BUSINESS,
 10498           DFHEIV11,
 10499           ERPNDB-KEY,
 10500           DFHEIV99,
 10501           DFHEIV99,
 10502           DFHEIV99
 10503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10504
 10505
 10506     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10507
 10508     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10509     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10510     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10511     MOVE SPACES                 TO PENDING-BUSINESS.
 10512     MOVE 'PB'                   TO PB-RECORD-ID.
 10513     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10514     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10515     MOVE SPACES                 TO PB-CERT-SFX.
 10516     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10517     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10518                                    PB-ALT-CHG-SEQ-NO.
 10519
 10520     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10521     MOVE '1'                    TO PB-RECORD-TYPE.
 10522
 10523     IF BSUFIXL NOT = ZEROS
 10524        MOVE BSUFIXI             TO PB-CERT-SFX.
 10525
 10526     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10527
 10528     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10529     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10530
 10531     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10532                                    PB-I-LF-PREM-CALC
 10533                                    PB-I-LF-ALT-PREM-CALC
 10534                                    PB-I-LF-RATE
 10535                                    PB-I-LF-ALT-RATE
 10536                                    PB-I-LF-REI-RATE
 10537                                    PB-I-LF-ALT-REI-RATE
 10538                                    PB-I-RATE-DEV-PCT-LF
 10539                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 194
* EL6311.cbl
 10540                                    PB-I-AH-RATE
 10541                                    PB-I-AH-REI-RATE
 10542                                    PB-I-AH-RATE-TRM
 10543                                    PB-I-RATE-DEV-PCT-AH
 10544                                    PB-I-BUSINESS-TYPE
 10545                                    PB-I-LIFE-COMMISSION
 10546                                    PB-I-JOINT-COMMISSION
 10547                                    PB-I-JOINT-AGE
 10548                                    PB-I-AH-COMMISSION
 10549                                    PB-I-CURR-SEQ
 10550                                    PB-CHG-COUNT
 10551                                    PB-LF-BILLED-AMTS
 10552                                    PB-AH-BILLED-AMTS
 10553                                    PB-CALC-TOLERANCE
 10554                                    PB-I-EXTENTION-DAYS
 10555*                                   PB-I-MICROFILM-NO
 10556                                    PB-I-TERM-IN-DAYS.
 10557
 10558     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10559                                    PB-I-LF-EXPIRE-DT
 10560                                    PB-I-AH-EXPIRE-DT
 10561                                    PB-BILLED-DT
 10562                                    PB-ACCT-EFF-DT
 10563                                    PB-ACCT-EXP-DT
 10564                                    PB-I-1ST-PMT-DT.
 10565
 10566     MOVE 'X'                    TO PB-FATAL-FLAG.
 10567
 10568     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10569
 10570     IF BLSTNML GREATER THAN ZEROS
 10571         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10572
 10573*    IF BMICRNOL  GREATER  ZEROS
 10574*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10575*    ELSE
 10576*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10577     IF BVINL > ZEROS
 10578        MOVE BVINI               TO PB-I-VIN
 10579     END-IF
 10580     IF B1STNML GREATER THAN ZEROS
 10581         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10582
 10583     IF BINITL  GREATER THAN ZEROS
 10584         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10585
 10586     IF BBIRTHL GREATER THAN ZERO
 10587         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10588     ELSE
 10589         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10590
 10591     IF B1STPMTL GREATER THAN ZERO
 10592         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10593     ELSE
 10594         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10595
 10596     IF BAGEL    GREATER THAN ZEROS
 10597         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 195
* EL6311.cbl
 10598        ELSE
 10599         MOVE ZEROS              TO PB-I-AGE.
 10600
 10601     IF BSEXL    GREATER THAN ZEROS
 10602         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10603
 10604     IF BTERM-LEN (1) GREATER THAN ZEROS
 10605        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10606     ELSE
 10607        MOVE ZEROS               TO PB-I-LF-TERM.
 10608
 10609     IF BTERM-LEN (2) GREATER THAN ZEROS
 10610        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10611     ELSE
 10612        MOVE ZEROS               TO PB-I-AH-TERM.
 10613
 10614     IF BLNTRML       GREATER THAN ZEROS
 10615         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10616        ELSE
 10617         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10618
 10619     IF BFREQL        GREATER THAN ZEROS
 10620         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10621        ELSE
 10622         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10623
 10624     IF BSKPCDL       GREATER THAN ZEROS
 10625         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10626
 10627     IF BMODEL        GREATER THAN ZEROS
 10628         MOVE BMODEI             TO PB-I-TERM-TYPE
 10629                                    PI-BMODE.
 10630
 10631     IF BPMTSL        GREATER THAN ZEROS
 10632         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10633                                    PI-BPMTS
 10634        ELSE
 10635         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10636                                    PI-BPMTS.
 10637
 10638     IF BPMTAMTL      GREATER THAN ZEROS
 10639         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10640        ELSE
 10641         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10642
 10643     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10644        IF BTYPE  (1)   NOT = ZEROS
 10645           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10646                                    PI-BTYPE (1)
 10647           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10648           MOVE SPACES           TO PB-I-LF-ABBR
 10649        ELSE
 10650           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10651                                    PB-I-LF-ABBR
 10652           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10653     ELSE
 10654        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10655                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 196
* EL6311.cbl
 10656        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10657
 10658     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10659         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10660     ELSE
 10661         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10662
 10663     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10664         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10665     ELSE
 10666         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10667
 10668     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10669         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10670            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10671            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10672         ELSE
 10673            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10674*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10675*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10676         END-IF
 10677     ELSE
 10678         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10679
 10680     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10681         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10682
 10683     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10684         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10685         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10686     ELSE
 10687         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10688
 10689     IF  BALT-PREM-LEN     (2) > ZEROS
 10690         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10691     ELSE
 10692         MOVE ZEROS            TO PB-I-TOT-FEES.
 10693
 10694     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10695        IF BTYPE      (2)   NOT = ZEROS
 10696           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10697                                  PI-BTYPE (2)
 10698           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10699           MOVE SPACES         TO PB-I-AH-ABBR
 10700        ELSE
 10701           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10702                                  PB-I-AH-ABBR
 10703           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10704     ELSE
 10705        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10706                                  PB-I-AH-ABBR
 10707        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10708
 10709     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10710         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10711     ELSE
 10712         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10713
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 197
* EL6311.cbl
 10714     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10715         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10716            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10717            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10718         ELSE
 10719            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10720*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10721*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10722         END-IF
 10723     ELSE
 10724         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10725
 10726     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10727         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10728
 10729     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10730        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10731     ELSE
 10732        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10733
 10734     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10735        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10736     ELSE
 10737        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10738
 10739     IF BINDGRPL  GREATER THAN ZEROS
 10740         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10741
 10742     IF BRTCLSL   GREATER THAN ZEROS
 10743         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10744
 10745     IF BSIGL     GREATER THAN ZEROS
 10746         MOVE BSIGI              TO PB-I-SIG-SW.
 10747     IF BAPRL > ZEROS
 10748         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10749     ELSE
 10750        if pi-company-id = 'CID'
 10751           move +99.9999         to pb-i-loan-apr
 10752        else
 10753           MOVE ZEROS            TO PB-I-LOAN-APR
 10754        end-if
 10755     end-if
 10756     IF BMEMBERL  GREATER THAN ZEROS
 10757         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10758
 10759     IF BLNOFCRL  GREATER THAN ZEROS
 10760         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10761
 10762     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10763        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10764     ELSE
 10765        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10766
 10767     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10768        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10769     ELSE
 10770        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10771
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 198
* EL6311.cbl
 10772     IF BDAYSL   GREATER THAN ZEROS
 10773        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10774                                    PB-I-EXTENTION-DAYS
 10775     ELSE
 10776        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10777                                    PB-I-EXTENTION-DAYS.
 10778
 10779     IF BDAYSL GREATER THAN ZEROS
 10780        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10781
 10782     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10783        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10784           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10785
 10786     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10787        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10788           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10789
 10790     IF B1STPMTL GREATER THAN ZEROS
 10791        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10792
 10793     IF PB-EXT-DAYS-PROCESSING
 10794        IF PB-I-EXTENTION-DAYS = ZEROS
 10795           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10796
 10797     IF PB-EXPIRE-DT-PROCESSING
 10798        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10799           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10800             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10801
 10802     IF PB-1ST-PMT-DT-PROCESSING
 10803        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10804           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10805
 10806     IF BREINL GREATER THAN ZEROS
 10807        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10808
 10809     IF BENTRYL NOT = ZEROS
 10810        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10811        IF PI-COMPANY-ID = 'CID'
 10812           AND (PB-BATCH-ENTRY = 'P')
 10813           AND (PB-STATE = 'VA')
 10814           PERFORM 1500-UPDATE-ERNOTE
 10815                                 THRU 1500-EXIT
 10816        END-IF
 10817     END-IF
 10818     IF BUNWRITL NOT = ZEROS
 10819        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10820
 10821     IF BFORCEL NOT = ZEROS
 10822        MOVE BFORCEI             TO PB-FORCE-CODE.
 10823
 10824     IF BBILCDL NOT = ZEROS
 10825        MOVE BBILCDI             TO PB-RECORD-BILL.
 10826
 10827     IF BLIVESL GREATER THAN ZEROS
 10828        MOVE WS-BLIVES           TO PB-I-LIVES
 10829     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 199
* EL6311.cbl
 10830        MOVE ZEROS               TO PB-I-LIVES.
 10831
 10832     IF BBILLEDL GREATER THAN ZEROS
 10833        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10834     ELSE
 10835        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10836
 10837*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10838
 10839 1260-WRITE-PB-RECORD.
 10840     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10841                                    PB-INPUT-BY.
 10842     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10843     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10844                                    PB-INPUT-DT.
 10845
 10846     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10847     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10848                                    PB-CONTROL-BY-ORIG-BATCH.
 10849
 10850
 10851     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10852     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10853     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10854     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10855     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10856
 10857     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10858
 10859     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10860
 10861     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10862     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10863     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10864
 10865     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10866     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10867
 10868 1275-WRITE-PENDING-BUSINESS.
 10869     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10870     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10871     MOVE 'A'                    TO JP-RECORD-TYPE.
 10872     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10873
 10874
 10875* EXEC CICS HANDLE CONDITION
 10876*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10877*    END-EXEC.
 10878*    MOVE '"$%                   ! $ #00010677' TO DFHEIV0
 10879     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10881     MOVE X'2420233030303130363737' TO DFHEIV0(25:11)
 10882     CALL 'kxdfhei1' USING DFHEIV0
 10883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10884
 10885
 10886
 10887* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 200
* EL6311.cbl
 10888*        DATASET (FILE-ID-ERPNDB)
 10889*        FROM    (PENDING-BUSINESS)
 10890*        RIDFLD  (PB-CONTROL-PRIMARY)
 10891*    END-EXEC.
 10892     MOVE LENGTH OF
 10893      PENDING-BUSINESS
 10894       TO DFHEIV11
 10895*    MOVE '&$ L                  ''   #00010681' TO DFHEIV0
 10896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10898     MOVE X'2020233030303130363831' TO DFHEIV0(25:11)
 10899     CALL 'kxdfhei1' USING DFHEIV0,
 10900           FILE-ID-ERPNDB,
 10901           PENDING-BUSINESS,
 10902           DFHEIV11,
 10903           PB-CONTROL-PRIMARY,
 10904           DFHEIV99,
 10905           DFHEIV99
 10906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10907
 10908
 10909     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10910
 10911     PERFORM 8400-LOG-JOURNAL-RECORD.
 10912
 10913******************************************************************
 10914*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10915******************************************************************
 10916     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10917     MOVE ' '                    TO WS-ERMAIL-SW
 10918
 10919* EXEC CICS READ
 10920*       DATASET   (FILE-ID-ERMAIL)
 10921*       SET       (ADDRESS OF MAILING-DATA)
 10922*       RIDFLD    (ERMAIL-KEY)
 10923*       RESP      (WS-RESPONSE)
 10924*    END-EXEC
 10925*    MOVE '&"S        E          (  N#00010697' TO DFHEIV0
 10926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10928     MOVE X'204E233030303130363937' TO DFHEIV0(25:11)
 10929     CALL 'kxdfhei1' USING DFHEIV0,
 10930           FILE-ID-ERMAIL,
 10931           DFHEIV20,
 10932           DFHEIV99,
 10933           ERMAIL-KEY,
 10934           DFHEIV99,
 10935           DFHEIV99,
 10936           DFHEIV99
 10937     SET ADDRESS OF MAILING-DATA TO
 10938         DFHEIV20
 10939     MOVE EIBRESP  TO WS-RESPONSE
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10941     IF RESP-NORMAL
 10942        SET ERMAIL-FOUND TO TRUE
 10943     END-IF
 10944
 10945     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 201
* EL6311.cbl
 10946     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10947     MOVE 'OC'                   TO OC-RECORD-ID
 10948     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10949                                 TO OC-CONTROL-PRIMARY (1:33)
 10950     MOVE 'I'                    TO OC-RECORD-TYPE
 10951     MOVE +4096                  TO OC-KEY-SEQ-NO
 10952     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10953     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10954     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10955     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10956     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10957     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10958     MOVE PB-I-AGE               TO OC-INS-AGE
 10959     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10960     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10961     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10962     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10963     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10964     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10965     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10966     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10967     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10968     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10969     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10970     IF PB-I-JOINT-COMMISSION > +0
 10971         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10972     ELSE
 10973         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10974     END-IF
 10975     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10976     MOVE +0                     TO OC-LF-CANCEL-AMT
 10977                                    OC-LF-ITD-CANCEL-AMT
 10978     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10979     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10980     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10981     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10982     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10983     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10984     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10985     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10986     MOVE +0                     TO OC-AH-CANCEL-AMT
 10987                                    OC-AH-ITD-CANCEL-AMT
 10988     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10989     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10990     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10991     IF ERMAIL-FOUND
 10992        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10993     END-IF
 10994     IF NOT CERT-TRL-REC-NOT-FOUND
 10995        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10996                           OC-INS-AGE-DEFAULT-FLAG
 10997        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10998                           OC-JNT-AGE-DEFAULT-FLAG
 10999     END-IF
 11000     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 11001     .
 11002 1275-WRITE-ELCRTO.
 11003
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 202
* EL6311.cbl
 11004* EXEC CICS WRITE
 11005*       DATASET   ('ELCRTO')
 11006*       FROM      (ORIGINAL-CERTIFICATE)
 11007*       RIDFLD    (OC-CONTROL-PRIMARY)
 11008*       RESP      (WS-RESPONSE)
 11009*    END-EXEC
 11010     MOVE LENGTH OF
 11011      ORIGINAL-CERTIFICATE
 11012       TO DFHEIV11
 11013     MOVE 'ELCRTO' TO DFHEIV1
 11014*    MOVE '&$ L                  ''  N#00010765' TO DFHEIV0
 11015     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11017     MOVE X'204E233030303130373635' TO DFHEIV0(25:11)
 11018     CALL 'kxdfhei1' USING DFHEIV0,
 11019           DFHEIV1,
 11020           ORIGINAL-CERTIFICATE,
 11021           DFHEIV11,
 11022           OC-CONTROL-PRIMARY,
 11023           DFHEIV99,
 11024           DFHEIV99
 11025     MOVE EIBRESP  TO WS-RESPONSE
 11026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11027*    display ' just wrote 1275 ' ws-response
 11028     IF RESP-DUPKEY
 11029        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 11030        GO TO 1275-WRITE-ELCRTO
 11031     ELSE
 11032        IF NOT RESP-NORMAL
 11033           MOVE -1               TO BMAINTL
 11034           MOVE ER-7450          TO EMI-ERROR
 11035           PERFORM 9900-ERROR-FORMAT
 11036                                 THRU 9900-EXIT
 11037           GO TO 8200-SEND-DATAONLY
 11038        END-IF
 11039     END-IF
 11040******************************************************************
 11041*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11042******************************************************************
 11043
 11044
 11045* EXEC CICS READ
 11046*        INTO    (PENDING-BUSINESS)
 11047*        DATASET (FILE-ID-ERPNDB)
 11048*        RIDFLD  (ERPNDB-KEY)
 11049*        UPDATE
 11050*    END-EXEC.
 11051     MOVE LENGTH OF
 11052      PENDING-BUSINESS
 11053       TO DFHEIV11
 11054*    MOVE '&"IL       EU         (   #00010788' TO DFHEIV0
 11055     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11056     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11057     MOVE X'2020233030303130373838' TO DFHEIV0(25:11)
 11058     CALL 'kxdfhei1' USING DFHEIV0,
 11059           FILE-ID-ERPNDB,
 11060           PENDING-BUSINESS,
 11061           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 203
* EL6311.cbl
 11062           ERPNDB-KEY,
 11063           DFHEIV99,
 11064           DFHEIV99,
 11065           DFHEIV99
 11066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11067
 11068
 11069     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11070     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11071     MOVE 'B'                    TO JP-RECORD-TYPE.
 11072     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11073
 11074     PERFORM 8400-LOG-JOURNAL-RECORD.
 11075
 11076     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11077
 11078
 11079* EXEC CICS REWRITE
 11080*        DATASET (FILE-ID-ERPNDB)
 11081*        FROM    (PENDING-BUSINESS)
 11082*    END-EXEC.
 11083     MOVE LENGTH OF
 11084      PENDING-BUSINESS
 11085       TO DFHEIV11
 11086*    MOVE '&& L                  %   #00010804' TO DFHEIV0
 11087     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11088     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11089     MOVE X'2020233030303130383034' TO DFHEIV0(25:11)
 11090     CALL 'kxdfhei1' USING DFHEIV0,
 11091           FILE-ID-ERPNDB,
 11092           PENDING-BUSINESS,
 11093           DFHEIV11,
 11094           DFHEIV99
 11095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11096
 11097
 11098     MOVE 'C'                    TO JP-RECORD-TYPE.
 11099     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11100
 11101     PERFORM 8400-LOG-JOURNAL-RECORD.
 11102
 11103     IF WS-ERRORS-PRESENT
 11104         GO TO 3900-RE-DISPLAY-RECORD.
 11105
 11106     MOVE ZEROS                  TO EMI-ERROR.
 11107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11108     MOVE LOW-VALUES             TO EL631BI.
 11109     MOVE  -1                    TO BMAINTL.
 11110     GO TO 8100-SEND-INITIAL-MAP.
 11111
 11112 1280-BATCH-HDR-NOT-FOUND.
 11113     MOVE -1                     TO BMAINTL.
 11114     MOVE ER-7450                TO EMI-ERROR.
 11115     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11116     GO TO 8200-SEND-DATAONLY.
 11117
 11118 1290-DUPLICATE-ALT-INDEX.
 11119
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 204
* EL6311.cbl
 11120******************************************************************
 11121*                                                                *
 11122*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11123*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11124*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11125*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11126*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11127*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11128*                                                                *
 11129******************************************************************
 11130
 11131     IF LCP-ONCTR-01 =  0
 11132         ADD 1 TO LCP-ONCTR-01
 11133        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11134
 11135     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11136
 11137     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11138         NEXT SENTENCE
 11139     ELSE
 11140         ADD +1 TO PB-BATCH-SEQ-NO
 11141                   PB-CSR-BATCH-SEQ-NO
 11142         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11143         GO TO 1275-WRITE-PENDING-BUSINESS.
 11144
 11145     MOVE -1                     TO BCERTNOL.
 11146     MOVE AL-UABON               TO BCERTNOA.
 11147     MOVE AL-UNBON               TO BEFFDTA.
 11148
 11149     MOVE 1                      TO EMI-SUB
 11150                                    EMI-SWITCH1
 11151                                    EMI-SWITCH-AREA-1
 11152                                    EMI-SWITCH-AREA-2.
 11153
 11154     MOVE SPACES                 TO EMI-ERROR-LINES.
 11155
 11156
 11157* EXEC CICS SYNCPOINT ROLLBACK
 11158*    END-EXEC.
 11159*    MOVE '6"R                   !   #00010867' TO DFHEIV0
 11160     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11162     MOVE X'2020233030303130383637' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0
 11164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11165
 11166
 11167     MOVE ER-2247                TO EMI-ERROR.
 11168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11169     GO TO 8200-SEND-DATAONLY.
 11170
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 205
* EL6311.cbl
 11172
 11173
 11174 1295-READ-CERT-TRAILER.
 11175
 11176
 11177* EXEC CICS GETMAIN
 11178*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11179*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11180*        INITIMG (GETMAIN-SPACE)
 11181*    END-EXEC
 11182*    MOVE ',"IL                  $   #00010879' TO DFHEIV0
 11183     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11184     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11185     MOVE X'2020233030303130383739' TO DFHEIV0(25:11)
 11186     CALL 'kxdfhei1' USING DFHEIV0,
 11187           DFHEIV20,
 11188           ELCRTT-RECORD-LENGTH,
 11189           GETMAIN-SPACE
 11190     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11191         DFHEIV20
 11192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11193
 11194     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11195     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11196     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11197
 11198
 11199* EXEC CICS HANDLE CONDITION
 11200*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11201*    END-EXEC.
 11202*    MOVE '"$I                   ! % #00010889' TO DFHEIV0
 11203     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11205     MOVE X'2520233030303130383839' TO DFHEIV0(25:11)
 11206     CALL 'kxdfhei1' USING DFHEIV0
 11207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11208
 11209
 11210
 11211* EXEC CICS READ
 11212*        DATASET  (CRTT-ID)
 11213*        RIDFLD   (ELCRTT-KEY)
 11214*        INTO     (CERTIFICATE-TRAILERS)
 11215*    END-EXEC.
 11216     MOVE LENGTH OF
 11217      CERTIFICATE-TRAILERS
 11218       TO DFHEIV11
 11219*    MOVE '&"IL       E          (   #00010893' TO DFHEIV0
 11220     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11222     MOVE X'2020233030303130383933' TO DFHEIV0(25:11)
 11223     CALL 'kxdfhei1' USING DFHEIV0,
 11224           CRTT-ID,
 11225           CERTIFICATE-TRAILERS,
 11226           DFHEIV11,
 11227           ELCRTT-KEY,
 11228           DFHEIV99,
 11229           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 206
* EL6311.cbl
 11230           DFHEIV99
 11231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11232
 11233
 11234     GO TO 1295-EXIT.
 11235
 11236 1295-CERT-TRL-REC-NOTFND.
 11237     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11238
 11239 1295-EXIT.
 11240     EXIT.
 11241
 11242******************************************************************
 11243*                                                                *
 11244*          C H A N G E   I S S U E   R O U T I N E               *
 11245*                                                                *
 11246******************************************************************
 11247
 11248***************************************************************
 11249*                                                             *
 11250*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11251*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11252*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11253*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11254*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11255*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11256*     5. LINK TO THE EDIT ROUTINE.                            *
 11257*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11258*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11259*              THE EDIT ROUTINE.                              *
 11260*     7. REWRITE THE NEW ISSUE                                *
 11261*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11262*                                                             *
 11263***************************************************************
 11264
 11265 1300-CHANGE-ISSUE-ROUTINE.
 11266     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11267
 11268     IF BCHGL NOT = ZEROS
 11269        MOVE ER-2196             TO EMI-ERROR
 11270        MOVE AL-UABON            TO BMAINTA
 11271        MOVE -1                  TO BMAINTL
 11272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11273        GO TO 8200-SEND-DATAONLY.
 11274
 11275     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11276
 11277     IF BSUFIXL NOT = ZEROS
 11278        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11279     ELSE
 11280        MOVE SPACE               TO WS-NEW-SUFFIX.
 11281
 11282     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11283     PERFORM 8600-DEEDIT.
 11284     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11285     MOVE '4'                    TO DC-OPTION-CODE.
 11286     PERFORM 9700-DATE-LINK.
 11287     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 207
* EL6311.cbl
 11288        MOVE ER-0348             TO EMI-ERROR
 11289        MOVE -1                  TO BEFFDTL
 11290        MOVE AL-UABON            TO BEFFDTA
 11291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11292        GO TO 8200-SEND-DATAONLY
 11293     ELSE
 11294        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11295        MOVE AL-UANON            TO BEFFDTA
 11296        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11297
 11298 1325-PROCESS-ISSUE-CHANGES.
 11299
 11300* EXEC CICS HANDLE CONDITION
 11301*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11302*    END-EXEC.
 11303*    MOVE '"$I                   ! & #00010964' TO DFHEIV0
 11304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11306     MOVE X'2620233030303130393634' TO DFHEIV0(25:11)
 11307     CALL 'kxdfhei1' USING DFHEIV0
 11308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11309
 11310
 11311     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11312     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11313     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11314
 11315
 11316* EXEC CICS GETMAIN
 11317*        SET      (ADDRESS OF PENDING-BUSINESS)
 11318*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11319*        INITIMG  (GETMAIN-SPACE)
 11320*     END-EXEC.
 11321*    MOVE ',"IL                  $   #00010972' TO DFHEIV0
 11322     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11323     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11324     MOVE X'2020233030303130393732' TO DFHEIV0(25:11)
 11325     CALL 'kxdfhei1' USING DFHEIV0,
 11326           DFHEIV20,
 11327           ERPNDB-RECORD-LENGTH,
 11328           GETMAIN-SPACE
 11329     SET ADDRESS OF PENDING-BUSINESS TO
 11330         DFHEIV20
 11331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11332
 11333
 11334
 11335* EXEC CICS READ
 11336*        INTO    (PENDING-BUSINESS)
 11337*        DATASET (FILE-ID-ERPNDB)
 11338*        RIDFLD  (ERPNDB-KEY)
 11339*    END-EXEC.
 11340     MOVE LENGTH OF
 11341      PENDING-BUSINESS
 11342       TO DFHEIV11
 11343*    MOVE '&"IL       E          (   #00010978' TO DFHEIV0
 11344     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 208
* EL6311.cbl
 11346     MOVE X'2020233030303130393738' TO DFHEIV0(25:11)
 11347     CALL 'kxdfhei1' USING DFHEIV0,
 11348           FILE-ID-ERPNDB,
 11349           PENDING-BUSINESS,
 11350           DFHEIV11,
 11351           ERPNDB-KEY,
 11352           DFHEIV99,
 11353           DFHEIV99,
 11354           DFHEIV99
 11355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11356
 11357
 11358     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11359
 11360
 11361* EXEC CICS HANDLE CONDITION
 11362*         NOTFND     (1385-REC-NOT-FOUND)
 11363*    END-EXEC.
 11364*    MOVE '"$I                   ! '' #00010986' TO DFHEIV0
 11365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11367     MOVE X'2720233030303130393836' TO DFHEIV0(25:11)
 11368     CALL 'kxdfhei1' USING DFHEIV0
 11369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11370
 11371
 11372**********************************************************
 11373*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11374*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11375**********************************************************
 11376
 11377
 11378* EXEC CICS READ
 11379*        DATASET (FILE-ID-ERPNDB)
 11380*        INTO    (PENDING-BUSINESS)
 11381*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11382*    END-EXEC.
 11383     MOVE LENGTH OF
 11384      PENDING-BUSINESS
 11385       TO DFHEIV11
 11386*    MOVE '&"IL       E          (   #00010995' TO DFHEIV0
 11387     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11388     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11389     MOVE X'2020233030303130393935' TO DFHEIV0(25:11)
 11390     CALL 'kxdfhei1' USING DFHEIV0,
 11391           FILE-ID-ERPNDB,
 11392           PENDING-BUSINESS,
 11393           DFHEIV11,
 11394           PI-PREV-CONTROL-PRIMARY,
 11395           DFHEIV99,
 11396           DFHEIV99,
 11397           DFHEIV99
 11398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11399
 11400
 11401********** DO NOT ALLOW CHANGES IF THRU A/R
 11402     IF BMAINTI = 'C'
 11403         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 209
* EL6311.cbl
 11404             MOVE ER-4005          TO EMI-ERROR
 11405             MOVE -1               TO BMAINTL
 11406             MOVE AL-UABON         TO BMAINTA
 11407             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11408             GO TO 8200-SEND-DATAONLY.
 11409**********
 11410
 11411     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11412        MOVE -1                 TO BMAINTL
 11413        MOVE ER-2197            TO EMI-ERROR
 11414        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11415        GO TO 8200-SEND-DATAONLY.
 11416
 11417     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11418        MOVE ER-2196             TO EMI-ERROR
 11419        MOVE AL-UABON            TO BMAINTA
 11420        MOVE -1                  TO BMAINTL
 11421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11422        GO TO 8200-SEND-DATAONLY.
 11423
 11424     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11425
 11426     IF PB-BILLED-DT = LOW-VALUES AND
 11427        PB-CHG-COUNT = ZEROS
 11428        NEXT SENTENCE
 11429     ELSE
 11430        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11431            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11432           OR
 11433           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11434            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11435           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11436     move zeros                  to ws-check-amts
 11437     move ' '                    to ws-stop-sw
 11438                                    ws-check-sw
 11439                                    ws-proc-check-sw
 11440                                    ws-any-check-sw
 11441                                    ws-chek-browse-sw
 11442
 11443     perform 2500-browse-checks  thru 2500-exit
 11444
 11445     if i-have-processed-checks
 11446        or i-have-checks
 11447        continue
 11448     else
 11449        go to 1330-continue
 11450     end-if
 11451
 11452     compute ws-tot-orig-prem =
 11453        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11454        pb-i-lf-alt-premium-amt
 11455
 11456     if bprem1l <> zeros
 11457        MOVE AL-UNNON            TO bprem1a
 11458        move ws-bprem (1)        to ws-new-iss-total
 11459     else
 11460        move pb-i-lf-premium-amt to ws-new-iss-total
 11461     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 210
* EL6311.cbl
 11462     display ' new iss totala ' ws-new-iss-total
 11463
 11464     if baltpr1l <> zeros
 11465        MOVE AL-UNNON            TO baltpr1a
 11466        compute ws-new-iss-total =
 11467           ws-new-iss-total + ws-balt-prem(1)
 11468     else
 11469        compute ws-new-iss-total =
 11470           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11471     end-if
 11472
 11473     if bprem2l <> zeros
 11474        MOVE AL-UNNON            TO bprem2a
 11475        compute ws-new-iss-total = ws-new-iss-total +
 11476           ws-bprem (2)
 11477     else
 11478        compute ws-new-iss-total = ws-new-iss-total +
 11479           pb-i-ah-premium-amt
 11480     end-if
 11481
 11482     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11483        if ((bprem1l <> zeros)
 11484           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11485                      or
 11486           ((bprem2l <> zeros)
 11487           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11488           move er-3456          to emi-error
 11489           perform 9900-error-format
 11490                                 thru 9900-exit
 11491           go to 1330-continue
 11492        end-if
 11493     end-if
 11494
 11495     if ws-new-iss-total > ws-tot-orig-prem
 11496        move er-3458             to emi-error
 11497        perform 9900-error-format thru 9900-exit
 11498        move al-uabon            to bmainta
 11499        move -1                  to bmaintl
 11500        go to 8200-send-dataonly
 11501     end-if
 11502
 11503     if ws-new-iss-total < ws-tot-orig-prem
 11504        move er-3457             to emi-error
 11505        move al-uabon            to bprem1a
 11506                                    bprem2a
 11507        move +0 to bprem1l bprem2l
 11508        perform 9900-error-format thru 9900-exit
 11509        move -1                  to bmaintl
 11510        go to 1330-continue
 11511     end-if
 11512
 11513     .
 11514 1330-continue.
 11515
 11516
 11517* EXEC CICS READ
 11518*        DATASET (FILE-ID-ERPNDB)
 11519*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 211
* EL6311.cbl
 11520*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11521*        UPDATE
 11522*    END-EXEC.
 11523     MOVE LENGTH OF
 11524      PENDING-BUSINESS
 11525       TO DFHEIV11
 11526*    MOVE '&"IL       EU         (   #00011116' TO DFHEIV0
 11527     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11528     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11529     MOVE X'2020233030303131313136' TO DFHEIV0(25:11)
 11530     CALL 'kxdfhei1' USING DFHEIV0,
 11531           FILE-ID-ERPNDB,
 11532           PENDING-BUSINESS,
 11533           DFHEIV11,
 11534           PI-PREV-CONTROL-PRIMARY,
 11535           DFHEIV99,
 11536           DFHEIV99,
 11537           DFHEIV99
 11538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11539
 11540
 11541     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11542     MOVE 'B'                    TO JP-RECORD-TYPE
 11543     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11544     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11545
 11546     PERFORM 8400-LOG-JOURNAL-RECORD.
 11547
 11548     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11549        PB-CHG-COUNT NOT = ZEROS
 11550        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11551            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11552           OR
 11553           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11554            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11555            MOVE LOW-VALUES             TO PB-BILLED-DT
 11556            ADD +1                      TO PB-CHG-COUNT.
 11557
 11558     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11559     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11560     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11561     MOVE '5'                    TO DC-OPTION-CODE.
 11562     PERFORM 9700-DATE-LINK
 11563     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11564
 11565*    IF BMICRNOL  GREATER  ZEROS
 11566*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11567
 11568     IF BVINL > ZEROS
 11569        MOVE BVINI               TO PB-I-VIN
 11570     END-IF
 11571     IF (BFORCEL NOT = ZEROS)
 11572        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11573        AND (BFORCEI = ' ')
 11574        AND (PB-FORCE-CODE = 'O')
 11575        COMPUTE PB-I-AH-PREMIUM-AMT =
 11576           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11577        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 212
* EL6311.cbl
 11578                                 THRU 1800-EXIT
 11579        PERFORM 1900-DELETE-ERPYAJ
 11580                                 THRU 1900-EXIT
 11581        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11582     END-IF
 11583     IF (BFORCEL NOT = ZEROS)
 11584        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11585        AND (BFORCEI = 'O')
 11586        AND (PB-FORCE-CODE NOT = 'O')
 11587        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11588           PB-I-AH-PREM-CALC
 11589        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11590        MOVE SPACE               TO DC-OPTION-CODE
 11591        PERFORM 9700-DATE-LINK
 11592        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11593        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11594        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11595        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11596        PERFORM 1500-UPDATE-ERNOTE
 11597                                 THRU 1500-EXIT
 11598        PERFORM 1600-UPDATE-ERPYAJ
 11599                                 THRU 1600-EXIT
 11600     END-IF
 11601     IF BLSTNML  GREATER THAN ZEROS
 11602         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11603
 11604     IF B1STNML  GREATER THAN ZEROS
 11605         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11606
 11607     IF BINITL   GREATER THAN ZEROS
 11608         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11609
 11610     IF BBIRTHL  GREATER THAN ZERO
 11611         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11612
 11613     IF B1STPMTL GREATER THAN ZERO
 11614         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11615
 11616     IF BAGEL    GREATER THAN ZEROS
 11617         MOVE BAGEI              TO PB-I-AGE.
 11618
 11619     MOVE 'N'                    TO WS-INS-AGE-SET
 11620                                    WS-JNT-AGE-SET.
 11621     IF BAGEL    GREATER THAN ZEROS
 11622        MOVE 'Y'                TO WS-INS-AGE-SET
 11623        IF BAGEI = ZERO AND
 11624             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11625           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11626           MOVE 'AGE*'          TO BAGEDEFO
 11627        ELSE
 11628           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11629           MOVE 'AGE '          TO BAGEDEFO
 11630        END-IF
 11631        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11632     END-IF.
 11633
 11634     IF BSEXL    GREATER THAN ZEROS
 11635         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 213
* EL6311.cbl
 11636
 11637     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11638        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11639
 11640     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11641        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11642
 11643     IF BLNTRML  GREATER THAN ZEROS
 11644         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11645
 11646     IF BFREQL   GREATER THAN ZEROS
 11647         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11648
 11649     IF BSKPCDL  GREATER THAN ZEROS
 11650         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11651
 11652     IF BMODEL   GREATER THAN ZEROS
 11653         MOVE BMODEI             TO PB-I-TERM-TYPE
 11654                                    PI-BMODE.
 11655
 11656     IF BPMTSL   GREATER THAN ZEROS
 11657         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11658                                    PI-BPMTS.
 11659
 11660     IF BPMTAMTL GREATER THAN ZEROS
 11661         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11662
 11663     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11664         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11665
 11666     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11667         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11668
 11669     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11670
 11671     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11672         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11673            SUBTRACT PB-I-LF-PREMIUM-AMT
 11674                     FROM WS-B-LF-ISS-PRM-ENTERED
 11675            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11676            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11677            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11678         ELSE
 11679            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11680*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11681*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11682         END-IF
 11683     END-IF.
 11684
 11685     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11686            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11687                     FROM WS-B-LF-ISS-PRM-ENTERED
 11688         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11689         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11690
 11691     IF  BALT-PREM-LEN     (2)  > ZEROS
 11692         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11693
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 214
* EL6311.cbl
 11694     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11695         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11696
 11697     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11698         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11699            SUBTRACT PB-I-AH-PREMIUM-AMT
 11700                     FROM WS-B-AH-ISS-PRM-ENTERED
 11701            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11702            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11703            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11704         ELSE
 11705            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11706*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11707*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11708         END-IF
 11709     END-IF
 11710
 11711     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11712        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11713
 11714     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11715        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11716
 11717     IF BINDGRPL            GREATER THAN ZEROS
 11718         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11719
 11720     IF BRTCLSL             GREATER THAN ZEROS
 11721         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11722
 11723     IF BSIGL               GREATER THAN ZEROS
 11724         MOVE BSIGI              TO PB-I-SIG-SW.
 11725
 11726     IF BAPRL               GREATER THAN ZEROS
 11727         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11728
 11729     IF BMEMBERL            GREATER THAN ZEROS
 11730         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11731
 11732     IF BLNOFCRL            GREATER THAN ZEROS
 11733         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11734
 11735     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11736        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11737
 11738     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11739        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11740
 11741     IF BDAYSL              GREATER THAN ZEROS
 11742        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11743                                    PB-I-EXTENTION-DAYS.
 11744
 11745     IF BDAYSL GREATER THAN ZEROS
 11746        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11747
 11748     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11749        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11750           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11751
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 215
* EL6311.cbl
 11752     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11753        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11754           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11755
 11756     IF B1STPMTL GREATER THAN ZEROS
 11757        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11758
 11759     IF PB-EXT-DAYS-PROCESSING
 11760        IF PB-I-EXTENTION-DAYS = ZEROS
 11761           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11762
 11763     IF PB-EXPIRE-DT-PROCESSING
 11764        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11765           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11766             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11767
 11768     IF PB-1ST-PMT-DT-PROCESSING
 11769        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11770           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11771
 11772     IF BREINL GREATER THAN ZEROS
 11773        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11774
 11775     IF BFORCEL NOT = ZEROS
 11776        MOVE BFORCEI             TO PB-FORCE-CODE.
 11777     IF (BENTRYL NOT = ZEROS)
 11778        AND (PB-COMPANY-ID = 'CID')
 11779        AND (PB-STATE = 'VA')
 11780        AND (BENTRYI NOT = 'P')
 11781        AND (PB-BATCH-ENTRY = 'P')
 11782        PERFORM 1800-REMOVE-CERT-NOTES
 11783                                 THRU 1800-EXIT
 11784     END-IF
 11785     IF BENTRYL NOT = ZEROS
 11786        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11787        IF PI-COMPANY-ID = 'CID'
 11788           AND (PB-BATCH-ENTRY = 'P')
 11789           AND (PB-STATE = 'VA')
 11790           PERFORM 1500-UPDATE-ERNOTE
 11791                                 THRU 1500-EXIT
 11792        END-IF
 11793     END-IF
 11794
 11795     IF BUNWRITL NOT = ZEROS
 11796        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11797
 11798     IF BBILCDL NOT = ZEROS
 11799        MOVE BBILCDI             TO PB-RECORD-BILL.
 11800
 11801     IF BLIVESL GREATER THAN ZEROS
 11802        MOVE WS-BLIVES           TO PB-I-LIVES.
 11803
 11804
 11805*DMD CUSTOM CODING*************START
 11806     IF PI-COMPANY-ID NOT = 'DMD'
 11807         MOVE ZEROS               TO BBILLEDL.
 11808*DMD CUSTOM CODING*************END
 11809
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 216
* EL6311.cbl
 11810     IF BBILLEDL GREATER THAN ZEROS
 11811        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11812
 11813
 11814*****************************************************************
 11815*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11816*****************************************************************
 11817
 11818     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11819        IF BTYPE  (1)   = ZEROS OR SPACES
 11820           IF REMOVE-LF-COVERAGE
 11821               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11822                                        PI-BTYPE (1)
 11823               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11824                                        WS-B-LF-ISS-PRM-ENTERED
 11825               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11826                                        WS-B-LF-ISS-PRM-ENTERED
 11827               SUBTRACT PB-I-LF-PREM-CALC FROM
 11828                                        WS-B-LF-ISS-PRM-COMPUTED
 11829               MOVE ZEROS            TO PB-I-LF-TERM
 11830                                        PB-I-LF-BENEFIT-AMT
 11831                                        PB-I-LF-PREMIUM-AMT
 11832                                        PB-I-LF-BENEFIT-CD
 11833                                        PB-I-LF-PREM-CALC
 11834                                        PB-I-LF-CRIT-PER
 11835                                        PB-I-LF-ALT-BENEFIT-AMT
 11836                                        PB-I-LF-ALT-PREMIUM-AMT
 11837               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11838           ELSE
 11839               NEXT SENTENCE
 11840        ELSE
 11841           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11842                                    PI-BTYPE (1).
 11843     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11844        IF BTYPE  (2)   = ZEROS OR SPACES
 11845           IF  REMOVE-AH-COVERAGE
 11846               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11847                                        PI-BTYPE (2)
 11848               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11849                                        WS-B-AH-ISS-PRM-ENTERED
 11850               SUBTRACT PB-I-AH-PREM-CALC FROM
 11851                                        WS-B-AH-ISS-PRM-COMPUTED
 11852               MOVE ZEROS            TO PB-I-AH-TERM
 11853                                        PB-I-AH-BENEFIT-AMT
 11854                                        PB-I-AH-PREMIUM-AMT
 11855                                        PB-I-AH-BENEFIT-CD
 11856                                        PB-I-AH-PREM-CALC
 11857                                        PB-I-AH-CRIT-PER
 11858               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11859           ELSE
 11860               NEXT SENTENCE
 11861        ELSE
 11862           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11863                                    PI-BTYPE (2).
 11864 1360-REWRITE-PB-RECORD.
 11865     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11866
 11867     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 217
* EL6311.cbl
 11868     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11869
 11870     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11871
 11872     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11873     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11874
 11875     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11876         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11877
 11878     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11879         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11880
 11881     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11882
 11883     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11884
 11885     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11886
 11887     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11888     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11889     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11890
 11891     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11892     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11893
 11894 1375-REWRITE-PB-RECORD.
 11895     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11896     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11897     MOVE 'C'                    TO JP-RECORD-TYPE.
 11898     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11899
 11900
 11901* EXEC CICS REWRITE
 11902*        DATASET (FILE-ID-ERPNDB)
 11903*        FROM    (PENDING-BUSINESS)
 11904*    END-EXEC.
 11905     MOVE LENGTH OF
 11906      PENDING-BUSINESS
 11907       TO DFHEIV11
 11908*    MOVE '&& L                  %   #00011482' TO DFHEIV0
 11909     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11910     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11911     MOVE X'2020233030303131343832' TO DFHEIV0(25:11)
 11912     CALL 'kxdfhei1' USING DFHEIV0,
 11913           FILE-ID-ERPNDB,
 11914           PENDING-BUSINESS,
 11915           DFHEIV11,
 11916           DFHEIV99
 11917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11918
 11919
 11920     PERFORM 8400-LOG-JOURNAL-RECORD.
 11921******************************************************************
 11922*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11923******************************************************************
 11924     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11925     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 218
* EL6311.cbl
 11926
 11927* EXEC CICS READ
 11928*       DATASET   (FILE-ID-ERMAIL)
 11929*       SET       (ADDRESS OF MAILING-DATA)
 11930*       RIDFLD    (ERMAIL-KEY)
 11931*       RESP      (WS-RESPONSE)
 11932*    END-EXEC
 11933*    MOVE '&"S        E          (  N#00011493' TO DFHEIV0
 11934     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11935     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11936     MOVE X'204E233030303131343933' TO DFHEIV0(25:11)
 11937     CALL 'kxdfhei1' USING DFHEIV0,
 11938           FILE-ID-ERMAIL,
 11939           DFHEIV20,
 11940           DFHEIV99,
 11941           ERMAIL-KEY,
 11942           DFHEIV99,
 11943           DFHEIV99,
 11944           DFHEIV99
 11945     SET ADDRESS OF MAILING-DATA TO
 11946         DFHEIV20
 11947     MOVE EIBRESP  TO WS-RESPONSE
 11948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11949     IF RESP-NORMAL
 11950        SET ERMAIL-FOUND TO TRUE
 11951     END-IF
 11952
 11953     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11954     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11955                                 TO ELCRTO-KEY
 11956     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11957     MOVE +0                     TO ELCRTO-SEQ-NO
 11958
 11959* EXEC CICS READ
 11960*       DATASET   ('ELCRTO')
 11961*       INTO      (ORIGINAL-CERTIFICATE)
 11962*       RIDFLD    (ELCRTO-KEY)
 11963*       GTEQ
 11964*       RESP      (WS-RESPONSE)
 11965*    END-EXEC
 11966     MOVE LENGTH OF
 11967      ORIGINAL-CERTIFICATE
 11968       TO DFHEIV11
 11969     MOVE 'ELCRTO' TO DFHEIV1
 11970*    MOVE '&"IL       G          (  N#00011508' TO DFHEIV0
 11971     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11973     MOVE X'204E233030303131353038' TO DFHEIV0(25:11)
 11974     CALL 'kxdfhei1' USING DFHEIV0,
 11975           DFHEIV1,
 11976           ORIGINAL-CERTIFICATE,
 11977           DFHEIV11,
 11978           ELCRTO-KEY,
 11979           DFHEIV99,
 11980           DFHEIV99,
 11981           DFHEIV99
 11982     MOVE EIBRESP  TO WS-RESPONSE
 11983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 219
* EL6311.cbl
 11984*    display ' just read gteq ' ws-response
 11985     IF RESP-NORMAL
 11986        AND (OC-CONTROL-PRIMARY (1:33) =
 11987                 PB-CONTROL-BY-ACCOUNT (1:33))
 11988        AND (OC-RECORD-TYPE = 'I')
 11989        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11990           display ' csr edit session ' PI-CSR-SESSION-SW
 11991           IF NOT CSR-EDIT-SESSION
 11992
 11993* EXEC CICS READ
 11994*                DATASET   ('ELCRTO')
 11995*                INTO      (ORIGINAL-CERTIFICATE)
 11996*                RIDFLD    (OC-CONTROL-PRIMARY)
 11997*                UPDATE
 11998*                RESP      (WS-RESPONSE)
 11999*             END-EXEC
 12000     MOVE LENGTH OF
 12001      ORIGINAL-CERTIFICATE
 12002       TO DFHEIV11
 12003     MOVE 'ELCRTO' TO DFHEIV1
 12004*    MOVE '&"IL       EU         (  N#00011525' TO DFHEIV0
 12005     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12006     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12007     MOVE X'204E233030303131353235' TO DFHEIV0(25:11)
 12008     CALL 'kxdfhei1' USING DFHEIV0,
 12009           DFHEIV1,
 12010           ORIGINAL-CERTIFICATE,
 12011           DFHEIV11,
 12012           OC-CONTROL-PRIMARY,
 12013           DFHEIV99,
 12014           DFHEIV99,
 12015           DFHEIV99
 12016     MOVE EIBRESP  TO WS-RESPONSE
 12017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12018              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 12019              IF RESP-NORMAL
 12020                 display ' good read upd '
 12021                 MOVE PB-I-INSURED-LAST-NAME TO
 12022                         OC-INS-LAST-NAME
 12023                 MOVE PB-I-INSURED-FIRST-NAME TO
 12024                         OC-INS-FIRST-NAME
 12025                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 12026                         OC-INS-MIDDLE-INIT
 12027                 MOVE PB-I-AGE         TO OC-INS-AGE
 12028                 MOVE PB-I-JOINT-LAST-NAME   TO
 12029                         OC-JNT-LAST-NAME
 12030                 MOVE PB-I-JOINT-FIRST-NAME  TO
 12031                         OC-JNT-FIRST-NAME
 12032                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 12033                         OC-JNT-MIDDLE-INIT
 12034                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12035                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12036                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12037                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12038                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12039                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 12040                         OC-LF-ALT-BEN-AMT
 12041                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 220
* EL6311.cbl
 12042                         OC-LF-ALT-PRM-AMT
 12043                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12044                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12045                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12046                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12047                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12048                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12049                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12050                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12051                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12052                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12053                 IF OC-CANCEL-TRAN-IND = 'N'
 12054                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12055                    MOVE +0            TO OC-LF-CANCEL-AMT
 12056                                          OC-LF-ITD-CANCEL-AMT
 12057                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12058                    MOVE +0            TO OC-AH-CANCEL-AMT
 12059                                          OC-AH-ITD-CANCEL-AMT
 12060                 END-IF
 12061                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12062                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12063                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12064                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12065                 IF ERMAIL-FOUND
 12066                    MOVE MA-CRED-BENE-NAME
 12067                                 TO OC-CRED-BENE-NAME
 12068                 END-IF
 12069                 IF NOT CERT-TRL-REC-NOT-FOUND
 12070                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12071                           OC-INS-AGE-DEFAULT-FLAG
 12072                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12073                           OC-JNT-AGE-DEFAULT-FLAG
 12074                 END-IF
 12075
 12076* EXEC CICS REWRITE
 12077*                   DATASET   ('ELCRTO')
 12078*                   FROM      (ORIGINAL-CERTIFICATE)
 12079*                   RESP      (WS-RESPONSE)
 12080*                END-EXEC
 12081     MOVE LENGTH OF
 12082      ORIGINAL-CERTIFICATE
 12083       TO DFHEIV11
 12084     MOVE 'ELCRTO' TO DFHEIV1
 12085*    MOVE '&& L                  %  N#00011589' TO DFHEIV0
 12086     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12087     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12088     MOVE X'204E233030303131353839' TO DFHEIV0(25:11)
 12089     CALL 'kxdfhei1' USING DFHEIV0,
 12090           DFHEIV1,
 12091           ORIGINAL-CERTIFICATE,
 12092           DFHEIV11,
 12093           DFHEIV99
 12094     MOVE EIBRESP  TO WS-RESPONSE
 12095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12096                 display ' just rewrote ' ws-response
 12097              END-IF
 12098           END-IF
 12099        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 221
* EL6311.cbl
 12100           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12101           MOVE 'OC'             TO OC-RECORD-ID
 12102           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12103           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12104           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12105           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12106           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12107           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12108           MOVE PB-I-AGE         TO OC-INS-AGE
 12109           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12110           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12111           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12112           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12113           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12114           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12115           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12116           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12117           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12118           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12119           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12120           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12121           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12122           MOVE +0               TO OC-LF-CANCEL-AMT
 12123                                    OC-LF-ITD-CANCEL-AMT
 12124           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12125           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12126           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12127           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12128           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12129           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12130           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12131           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12132           MOVE +0               TO OC-AH-CANCEL-AMT
 12133                                    OC-AH-ITD-CANCEL-AMT
 12134           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12135           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12136           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12137           IF ERMAIL-FOUND
 12138              MOVE MA-CRED-BENE-NAME
 12139                                 TO OC-CRED-BENE-NAME
 12140           END-IF
 12141           IF NOT CERT-TRL-REC-NOT-FOUND
 12142              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12143                           OC-INS-AGE-DEFAULT-FLAG
 12144              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12145                           OC-JNT-AGE-DEFAULT-FLAG
 12146           END-IF
 12147           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12148
 12149* EXEC CICS WRITE
 12150*             DATASET   ('ELCRTO')
 12151*             FROM      (ORIGINAL-CERTIFICATE)
 12152*             RIDFLD    (OC-CONTROL-PRIMARY)
 12153*             RESP      (WS-RESPONSE)
 12154*          END-EXEC
 12155     MOVE LENGTH OF
 12156      ORIGINAL-CERTIFICATE
 12157       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 222
* EL6311.cbl
 12158     MOVE 'ELCRTO' TO DFHEIV1
 12159*    MOVE '&$ L                  ''  N#00011646' TO DFHEIV0
 12160     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12161     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12162     MOVE X'204E233030303131363436' TO DFHEIV0(25:11)
 12163     CALL 'kxdfhei1' USING DFHEIV0,
 12164           DFHEIV1,
 12165           ORIGINAL-CERTIFICATE,
 12166           DFHEIV11,
 12167           OC-CONTROL-PRIMARY,
 12168           DFHEIV99,
 12169           DFHEIV99
 12170     MOVE EIBRESP  TO WS-RESPONSE
 12171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12172        END-IF
 12173     ELSE
 12174        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12175        MOVE 'OC'                TO OC-RECORD-ID
 12176        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12177                                 TO OC-CONTROL-PRIMARY (1:33)
 12178        MOVE 'I'                 TO OC-RECORD-TYPE
 12179        MOVE +4096               TO OC-KEY-SEQ-NO
 12180        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12181        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12182        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12183        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12184        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12185        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12186        MOVE PB-I-AGE            TO OC-INS-AGE
 12187        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12188        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12189        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12190        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12191        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12192        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12193        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12194        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12195        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12196        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12197        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12198        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12199        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12200        MOVE +0                  TO OC-LF-CANCEL-AMT
 12201                                    OC-LF-ITD-CANCEL-AMT
 12202        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12203        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12204        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12205        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12206        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12207        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12208        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12209        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12210        MOVE +0                  TO OC-AH-CANCEL-AMT
 12211                                    OC-AH-ITD-CANCEL-AMT
 12212        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12213        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12214        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12215        IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 223
* EL6311.cbl
 12216           MOVE MA-CRED-BENE-NAME
 12217                                 TO OC-CRED-BENE-NAME
 12218        END-IF
 12219        IF NOT CERT-TRL-REC-NOT-FOUND
 12220           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12221                           OC-INS-AGE-DEFAULT-FLAG
 12222           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12223                           OC-JNT-AGE-DEFAULT-FLAG
 12224        END-IF
 12225        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12226
 12227* EXEC CICS WRITE
 12228*          DATASET   ('ELCRTO')
 12229*          FROM      (ORIGINAL-CERTIFICATE)
 12230*          RIDFLD    (OC-CONTROL-PRIMARY)
 12231*          RESP      (WS-RESPONSE)
 12232*       END-EXEC
 12233     MOVE LENGTH OF
 12234      ORIGINAL-CERTIFICATE
 12235       TO DFHEIV11
 12236     MOVE 'ELCRTO' TO DFHEIV1
 12237*    MOVE '&$ L                  ''  N#00011706' TO DFHEIV0
 12238     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12240     MOVE X'204E233030303131373036' TO DFHEIV0(25:11)
 12241     CALL 'kxdfhei1' USING DFHEIV0,
 12242           DFHEIV1,
 12243           ORIGINAL-CERTIFICATE,
 12244           DFHEIV11,
 12245           OC-CONTROL-PRIMARY,
 12246           DFHEIV99,
 12247           DFHEIV99
 12248     MOVE EIBRESP  TO WS-RESPONSE
 12249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12250     END-IF
 12251******************************************************************
 12252*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12253******************************************************************
 12254
 12255     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12256     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12257
 12258
 12259* EXEC CICS READ
 12260*        INTO    (PENDING-BUSINESS)
 12261*        DATASET (FILE-ID-ERPNDB)
 12262*        RIDFLD  (ERPNDB-KEY)
 12263*        UPDATE
 12264*    END-EXEC.
 12265     MOVE LENGTH OF
 12266      PENDING-BUSINESS
 12267       TO DFHEIV11
 12268*    MOVE '&"IL       EU         (   #00011720' TO DFHEIV0
 12269     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12270     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12271     MOVE X'2020233030303131373230' TO DFHEIV0(25:11)
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 224
* EL6311.cbl
 12274           PENDING-BUSINESS,
 12275           DFHEIV11,
 12276           ERPNDB-KEY,
 12277           DFHEIV99,
 12278           DFHEIV99,
 12279           DFHEIV99
 12280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12281
 12282
 12283     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12284     MOVE 'B'                    TO JP-RECORD-TYPE.
 12285     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12286
 12287     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12288
 12289     PERFORM 8400-LOG-JOURNAL-RECORD.
 12290
 12291     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12292
 12293     MOVE 'C'                    TO JP-RECORD-TYPE.
 12294     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12295
 12296
 12297* EXEC CICS REWRITE
 12298*        DATASET    (FILE-ID-ERPNDB)
 12299*        FROM       (PENDING-BUSINESS)
 12300*    END-EXEC.
 12301     MOVE LENGTH OF
 12302      PENDING-BUSINESS
 12303       TO DFHEIV11
 12304*    MOVE '&& L                  %   #00011740' TO DFHEIV0
 12305     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12306     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12307     MOVE X'2020233030303131373430' TO DFHEIV0(25:11)
 12308     CALL 'kxdfhei1' USING DFHEIV0,
 12309           FILE-ID-ERPNDB,
 12310           PENDING-BUSINESS,
 12311           DFHEIV11,
 12312           DFHEIV99
 12313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12314
 12315
 12316     PERFORM 8400-LOG-JOURNAL-RECORD.
 12317
 12318     IF WS-ERRORS-PRESENT
 12319        GO TO 3900-RE-DISPLAY-RECORD.
 12320
 12321     MOVE ZEROS                  TO EMI-ERROR.
 12322     MOVE -1                     TO BMAINTL.
 12323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12324     GO TO 3900-RE-DISPLAY-RECORD.
 12325
 12326 1380-BATCH-HDR-NOT-FOUND.
 12327     MOVE -1                     TO BMAINTL.
 12328     MOVE ER-7450                TO EMI-ERROR.
 12329     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12330     GO TO 8200-SEND-DATAONLY.
 12331
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 225
* EL6311.cbl
 12332 1385-REC-NOT-FOUND.
 12333     MOVE -1                     TO BMAINTL.
 12334     MOVE ER-7451                TO EMI-ERROR.
 12335     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12336     GO TO 8200-SEND-DATAONLY.
 12337
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 226
* EL6311.cbl
 12339
 12340 1386-UPDATE-AGE-FLAGS.
 12341
 12342
 12343* EXEC CICS GETMAIN
 12344*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12345*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12346*        INITIMG (GETMAIN-SPACE)
 12347*    END-EXEC
 12348*    MOVE ',"IL                  $   #00011771' TO DFHEIV0
 12349     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12350     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12351     MOVE X'2020233030303131373731' TO DFHEIV0(25:11)
 12352     CALL 'kxdfhei1' USING DFHEIV0,
 12353           DFHEIV20,
 12354           ELCRTT-RECORD-LENGTH,
 12355           GETMAIN-SPACE
 12356     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12357         DFHEIV20
 12358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12359
 12360
 12361* EXEC CICS HANDLE CONDITION
 12362*        NOTFND   (1386-NOTFND)
 12363*    END-EXEC.
 12364*    MOVE '"$I                   ! ( #00011777' TO DFHEIV0
 12365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12367     MOVE X'2820233030303131373737' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12373     MOVE 'C'                TO ELCRTT-REC-TYPE
 12374
 12375
 12376* EXEC CICS READ
 12377*        UPDATE
 12378*        DATASET  (CRTT-ID)
 12379*        RIDFLD   (ELCRTT-KEY)
 12380*        INTO     (CERTIFICATE-TRAILERS)
 12381*    END-EXEC.
 12382     MOVE LENGTH OF
 12383      CERTIFICATE-TRAILERS
 12384       TO DFHEIV11
 12385*    MOVE '&"IL       EU         (   #00011784' TO DFHEIV0
 12386     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12387     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12388     MOVE X'2020233030303131373834' TO DFHEIV0(25:11)
 12389     CALL 'kxdfhei1' USING DFHEIV0,
 12390           CRTT-ID,
 12391           CERTIFICATE-TRAILERS,
 12392           DFHEIV11,
 12393           ELCRTT-KEY,
 12394           DFHEIV99,
 12395           DFHEIV99,
 12396           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 227
* EL6311.cbl
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12398
 12399
 12400     IF WS-INS-AGE-SET = 'Y'
 12401        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12402     END-IF
 12403     IF WS-JNT-AGE-SET = 'Y'
 12404        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12405     END-IF
 12406
 12407
 12408* EXEC CICS REWRITE
 12409*       DATASET  (CRTT-ID)
 12410*       FROM     (CERTIFICATE-TRAILERS)
 12411*    END-EXEC.
 12412     MOVE LENGTH OF
 12413      CERTIFICATE-TRAILERS
 12414       TO DFHEIV11
 12415*    MOVE '&& L                  %   #00011798' TO DFHEIV0
 12416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12418     MOVE X'2020233030303131373938' TO DFHEIV0(25:11)
 12419     CALL 'kxdfhei1' USING DFHEIV0,
 12420           CRTT-ID,
 12421           CERTIFICATE-TRAILERS,
 12422           DFHEIV11,
 12423           DFHEIV99
 12424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12425
 12426
 12427     GO TO 1386-EXIT.
 12428
 12429 1386-NOTFND.
 12430
 12431     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12432     MOVE 'CS'         TO CS-RECORD-ID.
 12433     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12434     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12435     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12436     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12437     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12438
 12439* EXEC CICS WRITE
 12440*       DATASET  (CRTT-ID)
 12441*       RIDFLD   (ELCRTT-KEY)
 12442*       FROM     (CERTIFICATE-TRAILERS)
 12443*    END-EXEC.
 12444     MOVE LENGTH OF
 12445      CERTIFICATE-TRAILERS
 12446       TO DFHEIV11
 12447*    MOVE '&$ L                  ''   #00011814' TO DFHEIV0
 12448     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12450     MOVE X'2020233030303131383134' TO DFHEIV0(25:11)
 12451     CALL 'kxdfhei1' USING DFHEIV0,
 12452           CRTT-ID,
 12453           CERTIFICATE-TRAILERS,
 12454           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 228
* EL6311.cbl
 12455           ELCRTT-KEY,
 12456           DFHEIV99,
 12457           DFHEIV99
 12458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12459
 12460
 12461 1386-EXIT.
 12462     EXIT.
 12463
 12464 1390-UPDATE-ERPNDM.
 12465
 12466
 12467* EXEC CICS HANDLE CONDITION
 12468*        NOTFND (1399-EXIT)
 12469*    END-EXEC.
 12470*    MOVE '"$I                   ! ) #00011825' TO DFHEIV0
 12471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12473     MOVE X'2920233030303131383235' TO DFHEIV0(25:11)
 12474     CALL 'kxdfhei1' USING DFHEIV0
 12475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12476
 12477
 12478     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12479
 12480
 12481* EXEC CICS READ
 12482*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12483*        DATASET (FILE-ID-ERPNDM)
 12484*        RIDFLD  (ERPNDM-KEY)
 12485*        UPDATE
 12486*    END-EXEC.
 12487*    MOVE '&"S        EU         (   #00011831' TO DFHEIV0
 12488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12489     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12490     MOVE X'2020233030303131383331' TO DFHEIV0(25:11)
 12491     CALL 'kxdfhei1' USING DFHEIV0,
 12492           FILE-ID-ERPNDM,
 12493           DFHEIV20,
 12494           DFHEIV99,
 12495           ERPNDM-KEY,
 12496           DFHEIV99,
 12497           DFHEIV99,
 12498           DFHEIV99
 12499     SET ADDRESS OF PENDING-MAILING-DATA TO
 12500         DFHEIV20
 12501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12502
 12503
 12504     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12505     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12506     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12507
 12508     IF BLSTNML GREATER THAN ZEROS
 12509         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12510
 12511     IF B1STNML GREATER  THAN ZEROS
 12512         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 229
* EL6311.cbl
 12513
 12514     IF BINITL GREATER THAN ZEROS
 12515         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12516
 12517     IF BAGEL GREATER THAN ZEROS
 12518         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12519
 12520     IF BBIRTHL GREATER THAN ZEROS
 12521         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12522
 12523     IF BSEXL GREATER THAN ZEROS
 12524         MOVE  BSEXI             TO PM-INSURED-SEX.
 12525
 12526
 12527* EXEC CICS REWRITE
 12528*        DATASET (FILE-ID-ERPNDM)
 12529*        FROM    (PENDING-MAILING-DATA)
 12530*    END-EXEC.
 12531     MOVE LENGTH OF
 12532      PENDING-MAILING-DATA
 12533       TO DFHEIV11
 12534*    MOVE '&& L                  %   #00011860' TO DFHEIV0
 12535     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12536     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12537     MOVE X'2020233030303131383630' TO DFHEIV0(25:11)
 12538     CALL 'kxdfhei1' USING DFHEIV0,
 12539           FILE-ID-ERPNDM,
 12540           PENDING-MAILING-DATA,
 12541           DFHEIV11,
 12542           DFHEIV99
 12543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12544
 12545
 12546 1399-EXIT.
 12547     EXIT.
 12548
 12549******************************************************************
 12550*                                                                *
 12551*          D E L E T E   I S S U E   R O U T I N E               *
 12552*                                                                *
 12553******************************************************************
 12554
 12555 1400-DELETE-ISSUE-ROUTINE.
 12556     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12557
 12558     IF BCHGL NOT = ZEROS
 12559        MOVE ER-2196             TO EMI-ERROR
 12560        MOVE AL-UABON            TO BMAINTA
 12561        MOVE -1                  TO BMAINTL
 12562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563        GO TO 8200-SEND-DATAONLY.
 12564
 12565
 12566* EXEC CICS HANDLE CONDITION
 12567*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12568*    END-EXEC.
 12569*    MOVE '"$I                   ! * #00011884' TO DFHEIV0
 12570     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 230
* EL6311.cbl
 12571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12572     MOVE X'2A20233030303131383834' TO DFHEIV0(25:11)
 12573     CALL 'kxdfhei1' USING DFHEIV0
 12574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12575
 12576
 12577     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12578     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12579     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12580
 12581
 12582* EXEC CICS READ
 12583*        SET     (ADDRESS OF PENDING-BUSINESS)
 12584*        DATASET (FILE-ID-ERPNDB)
 12585*        RIDFLD  (ERPNDB-KEY)
 12586*    END-EXEC.
 12587*    MOVE '&"S        E          (   #00011892' TO DFHEIV0
 12588     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12590     MOVE X'2020233030303131383932' TO DFHEIV0(25:11)
 12591     CALL 'kxdfhei1' USING DFHEIV0,
 12592           FILE-ID-ERPNDB,
 12593           DFHEIV20,
 12594           DFHEIV99,
 12595           ERPNDB-KEY,
 12596           DFHEIV99,
 12597           DFHEIV99,
 12598           DFHEIV99
 12599     SET ADDRESS OF PENDING-BUSINESS TO
 12600         DFHEIV20
 12601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12602
 12603
 12604     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12605
 12606     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12607
 12608     IF BSUFIXL NOT = ZEROS
 12609        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12610     ELSE
 12611        MOVE SPACE               TO WS-NEW-SUFFIX.
 12612
 12613     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12614     PERFORM 8600-DEEDIT.
 12615     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12616     MOVE '4'                    TO DC-OPTION-CODE.
 12617     PERFORM 9700-DATE-LINK.
 12618     IF DATE-CONVERSION-ERROR
 12619        MOVE ER-0348             TO EMI-ERROR
 12620        MOVE -1                  TO BEFFDTL
 12621        MOVE AL-UABON            TO BEFFDTA
 12622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623        GO TO 8200-SEND-DATAONLY
 12624     ELSE
 12625        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12626        MOVE AL-UANON            TO BEFFDTA
 12627        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12628
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 231
* EL6311.cbl
 12629
 12630* EXEC CICS HANDLE CONDITION
 12631*         NOTFND    (1490-RECORD-NOT-FOUND)
 12632*    END-EXEC.
 12633*    MOVE '"$I                   ! + #00011923' TO DFHEIV0
 12634     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12636     MOVE X'2B20233030303131393233' TO DFHEIV0(25:11)
 12637     CALL 'kxdfhei1' USING DFHEIV0
 12638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12639
 12640
 12641
 12642* EXEC CICS READ
 12643*        SET     (ADDRESS OF PENDING-BUSINESS)
 12644*        DATASET (FILE-ID-ERPNDB)
 12645*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12646*        UPDATE
 12647*    END-EXEC.
 12648*    MOVE '&"S        EU         (   #00011927' TO DFHEIV0
 12649     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12650     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12651     MOVE X'2020233030303131393237' TO DFHEIV0(25:11)
 12652     CALL 'kxdfhei1' USING DFHEIV0,
 12653           FILE-ID-ERPNDB,
 12654           DFHEIV20,
 12655           DFHEIV99,
 12656           PI-PREV-CONTROL-PRIMARY,
 12657           DFHEIV99,
 12658           DFHEIV99,
 12659           DFHEIV99
 12660     SET ADDRESS OF PENDING-BUSINESS TO
 12661         DFHEIV20
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12663
 12664
 12665     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12666        MOVE -1                 TO BMAINTL
 12667        MOVE ER-2197            TO EMI-ERROR
 12668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669        GO TO 8200-SEND-DATAONLY.
 12670
 12671     IF PB-BILLED-DT NOT = LOW-VALUES
 12672        MOVE -1                 TO BMAINTL
 12673        MOVE ER-2129            TO EMI-ERROR
 12674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12675        GO TO 8200-SEND-DATAONLY.
 12676
 12677     IF PB-CHG-COUNT NOT = ZEROS
 12678        MOVE ER-2336            TO EMI-ERROR
 12679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12680        MOVE AL-UABON            TO BMAINTA
 12681        MOVE -1                  TO BMAINTL
 12682        GO TO 8200-SEND-DATAONLY.
 12683
 12684     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12685        PB-CHG-COUNT NOT = ZEROS
 12686        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 232
* EL6311.cbl
 12687        MOVE AL-UABON            TO BMAINTA
 12688        MOVE -1                  TO BMAINTL
 12689        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12690        GO TO 8200-SEND-DATAONLY.
 12691******************************************************************
 12692*                                                                *
 12693*       Determine if there have been any checks created          *
 12694*                                                                *
 12695******************************************************************
 12696
 12697     perform 2500-browse-checks  thru 2500-exit
 12698
 12699     if i-have-processed-checks
 12700        or i-have-checks
 12701        or i-have-a-check-period
 12702        move er-3446             to emi-error
 12703        perform 9900-error-format thru 9900-exit
 12704        move al-uabon            to bmainta
 12705        move -1                  to bmaintl
 12706        go to 8200-send-dataonly
 12707     end-if
 12708******************************************************************
 12709*                                                                *
 12710*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12711*                                                                *
 12712******************************************************************
 12713     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12714     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12715     MOVE +0                     TO ELCRTO-SEQ-NO
 12716
 12717* EXEC CICS READ
 12718*       DATASET   ('ELCRTO')
 12719*       INTO      (ORIGINAL-CERTIFICATE)
 12720*       RIDFLD    (ELCRTO-KEY)
 12721*       GTEQ
 12722*       RESP      (WS-RESPONSE)
 12723*    END-EXEC
 12724     MOVE LENGTH OF
 12725      ORIGINAL-CERTIFICATE
 12726       TO DFHEIV11
 12727     MOVE 'ELCRTO' TO DFHEIV1
 12728*    MOVE '&"IL       G          (  N#00011985' TO DFHEIV0
 12729     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12731     MOVE X'204E233030303131393835' TO DFHEIV0(25:11)
 12732     CALL 'kxdfhei1' USING DFHEIV0,
 12733           DFHEIV1,
 12734           ORIGINAL-CERTIFICATE,
 12735           DFHEIV11,
 12736           ELCRTO-KEY,
 12737           DFHEIV99,
 12738           DFHEIV99,
 12739           DFHEIV99
 12740     MOVE EIBRESP  TO WS-RESPONSE
 12741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12742     IF RESP-NORMAL
 12743        AND (OC-CONTROL-PRIMARY (1:33) =
 12744                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 233
* EL6311.cbl
 12745        AND (OC-RECORD-TYPE = 'I')
 12746
 12747* EXEC CICS READ
 12748*          DATASET   ('ELCRTO')
 12749*          INTO      (ORIGINAL-CERTIFICATE)
 12750*          RIDFLD    (ELCRTO-KEY)
 12751*          UPDATE
 12752*          RESP      (WS-RESPONSE)
 12753*       END-EXEC
 12754     MOVE LENGTH OF
 12755      ORIGINAL-CERTIFICATE
 12756       TO DFHEIV11
 12757     MOVE 'ELCRTO' TO DFHEIV1
 12758*    MOVE '&"IL       EU         (  N#00011996' TO DFHEIV0
 12759     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12760     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12761     MOVE X'204E233030303131393936' TO DFHEIV0(25:11)
 12762     CALL 'kxdfhei1' USING DFHEIV0,
 12763           DFHEIV1,
 12764           ORIGINAL-CERTIFICATE,
 12765           DFHEIV11,
 12766           ELCRTO-KEY,
 12767           DFHEIV99,
 12768           DFHEIV99,
 12769           DFHEIV99
 12770     MOVE EIBRESP  TO WS-RESPONSE
 12771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12772        IF RESP-NORMAL
 12773
 12774* EXEC CICS DELETE
 12775*             DATASET   ('ELCRTO')
 12776*          END-EXEC
 12777     MOVE 'ELCRTO' TO DFHEIV1
 12778*    MOVE '&(                    &   #00012004' TO DFHEIV0
 12779     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12780     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12781     MOVE X'2020233030303132303034' TO DFHEIV0(25:11)
 12782     CALL 'kxdfhei1' USING DFHEIV0,
 12783           DFHEIV1,
 12784           DFHEIV99,
 12785           DFHEIV99,
 12786           DFHEIV99,
 12787           DFHEIV99
 12788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12789        END-IF
 12790     END-IF
 12791******************************************************************
 12792*                                                                *
 12793*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12794*                                                                *
 12795******************************************************************
 12796
 12797* EXEC CICS HANDLE CONDITION
 12798*        NOTFND    (1405-DELETE-CERTIFICATE)
 12799*    END-EXEC.
 12800*    MOVE '"$I                   ! , #00012014' TO DFHEIV0
 12801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 234
* EL6311.cbl
 12803     MOVE X'2C20233030303132303134' TO DFHEIV0(25:11)
 12804     CALL 'kxdfhei1' USING DFHEIV0
 12805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12806
 12807
 12808
 12809* EXEC CICS READ
 12810*        EQUAL
 12811*        DATASET   (FILE-ID-ERPNDM)
 12812*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12813*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12814*        UPDATE
 12815*    END-EXEC.
 12816*    MOVE '&"S        EU         (   #00012018' TO DFHEIV0
 12817     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12818     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12819     MOVE X'2020233030303132303138' TO DFHEIV0(25:11)
 12820     CALL 'kxdfhei1' USING DFHEIV0,
 12821           FILE-ID-ERPNDM,
 12822           DFHEIV20,
 12823           DFHEIV99,
 12824           PI-PREV-CONTROL-PRIMARY,
 12825           DFHEIV99,
 12826           DFHEIV99,
 12827           DFHEIV99
 12828     SET ADDRESS OF PENDING-MAILING-DATA TO
 12829         DFHEIV20
 12830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12831
 12832
 12833     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12834     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12835     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12836
 12837     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12838
 12839
 12840* EXEC CICS DELETE
 12841*        DATASET   (FILE-ID-ERPNDM)
 12842*    END-EXEC.
 12843*    MOVE '&(                    &   #00012032' TO DFHEIV0
 12844     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12845     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303132303332' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           FILE-ID-ERPNDM,
 12849           DFHEIV99,
 12850           DFHEIV99,
 12851           DFHEIV99,
 12852           DFHEIV99
 12853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12854
 12855
 12856******************************************************************
 12857*                PROCESS   CERTIFICATE                           *
 12858******************************************************************
 12859
 12860 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 235
* EL6311.cbl
 12861
 12862* EXEC CICS HANDLE CONDITION
 12863*         NOTFND  (1420-CONTINUE-DELETE)
 12864*    END-EXEC.
 12865*    MOVE '"$I                   ! - #00012041' TO DFHEIV0
 12866     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12867     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12868     MOVE X'2D20233030303132303431' TO DFHEIV0(25:11)
 12869     CALL 'kxdfhei1' USING DFHEIV0
 12870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12871
 12872
 12873     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12874     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12875     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12876     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12877
 12878
 12879* EXEC CICS READ
 12880*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12881*        DATASET (FILE-ID-ELCERT)
 12882*        RIDFLD  (ELCERT-KEY)
 12883*        UPDATE
 12884*    END-EXEC.
 12885*    MOVE '&"S        EU         (   #00012050' TO DFHEIV0
 12886     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12887     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12888     MOVE X'2020233030303132303530' TO DFHEIV0(25:11)
 12889     CALL 'kxdfhei1' USING DFHEIV0,
 12890           FILE-ID-ELCERT,
 12891           DFHEIV20,
 12892           DFHEIV99,
 12893           ELCERT-KEY,
 12894           DFHEIV99,
 12895           DFHEIV99,
 12896           DFHEIV99
 12897     SET ADDRESS OF CERTIFICATE-MASTER TO
 12898         DFHEIV20
 12899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12900
 12901
 12902     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12903
 12904     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12905     MOVE 'B'                    TO JP-RECORD-TYPE
 12906     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12907
 12908     PERFORM 8400-LOG-JOURNAL-RECORD.
 12909
 12910     IF CERT-NOTES-ARE-NOT-PRESENT
 12911        MOVE ' '                 TO WS-CERT-NOTE-SW
 12912     ELSE
 12913        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12914
 12915     IF INSURED-ADDR-PRESENT
 12916        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12917
 12918******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 236
* EL6311.cbl
 12919******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12920******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12921******************************************************************
 12922******************************************************************
 12923
 12924     IF CERT-ADDED-BATCH AND
 12925        (NOT NO-CLAIM-ATTACHED
 12926         OR
 12927         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12928        GO TO 1410-REWRITE-CERT.
 12929
 12930******************************************************************
 12931******************************************************************
 12932
 12933     IF CERT-ADDED-BATCH  AND
 12934        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12935        GO TO 1410-REWRITE-CERT.
 12936
 12937     IF NO-CLAIM-ATTACHED
 12938        NEXT SENTENCE
 12939     ELSE
 12940        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12941        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12942        GO TO 1410-REWRITE-CERT.
 12943
 12944     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12945     MOVE 'D'                      TO JP-RECORD-TYPE.
 12946     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12947
 12948
 12949* EXEC CICS DELETE
 12950*         DATASET    (FILE-ID-ELCERT)
 12951*    END-EXEC.
 12952*    MOVE '&(                    &   #00012103' TO DFHEIV0
 12953     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12955     MOVE X'2020233030303132313033' TO DFHEIV0(25:11)
 12956     CALL 'kxdfhei1' USING DFHEIV0,
 12957           FILE-ID-ELCERT,
 12958           DFHEIV99,
 12959           DFHEIV99,
 12960           DFHEIV99,
 12961           DFHEIV99
 12962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12963
 12964
 12965     PERFORM 8400-LOG-JOURNAL-RECORD.
 12966
 12967******************************************************************
 12968*                                                                *
 12969*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12970*                                                                *
 12971******************************************************************
 12972
 12973     IF  CERT-NOTES-ARE-PRESENT
 12974         NEXT SENTENCE
 12975     ELSE
 12976         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 237
* EL6311.cbl
 12977
 12978
 12979* EXEC CICS HANDLE CONDITION
 12980*         NOTFND  (1406-DELETE-ERNOTE)
 12981*    END-EXEC.
 12982*    MOVE '"$I                   ! . #00012120' TO DFHEIV0
 12983     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12984     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12985     MOVE X'2E20233030303132313230' TO DFHEIV0(25:11)
 12986     CALL 'kxdfhei1' USING DFHEIV0
 12987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12988
 12989
 12990     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12991     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12992     MOVE 0                     TO ERCNOT-SEQUENCE.
 12993
 12994 1406-DELETE-ERCNOT-LOOP.
 12995
 12996
 12997* EXEC CICS READ
 12998*        GTEQ
 12999*        DATASET   (FILE-ID-ERCNOT)
 13000*        SET       (ADDRESS OF CERT-NOTE-FILE)
 13001*        RIDFLD    (ERCNOT-KEY)
 13002*    END-EXEC.
 13003*    MOVE '&"S        G          (   #00012130' TO DFHEIV0
 13004     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13006     MOVE X'2020233030303132313330' TO DFHEIV0(25:11)
 13007     CALL 'kxdfhei1' USING DFHEIV0,
 13008           FILE-ID-ERCNOT,
 13009           DFHEIV20,
 13010           DFHEIV99,
 13011           ERCNOT-KEY,
 13012           DFHEIV99,
 13013           DFHEIV99,
 13014           DFHEIV99
 13015     SET ADDRESS OF CERT-NOTE-FILE TO
 13016         DFHEIV20
 13017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13018
 13019
 13020     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 13021     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 13022         GO TO 1406-DELETE-ERNOTE
 13023     END-IF.
 13024
 13025     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 13026     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13027     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 13028
 13029     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13030
 13031
 13032* EXEC CICS DELETE
 13033*        DATASET   (FILE-ID-ERCNOT)
 13034*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 238
* EL6311.cbl
 13035*        END-EXEC.
 13036*    MOVE '&(  R                 &   #00012148' TO DFHEIV0
 13037     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13038     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13039     MOVE X'2020233030303132313438' TO DFHEIV0(25:11)
 13040     CALL 'kxdfhei1' USING DFHEIV0,
 13041           FILE-ID-ERCNOT,
 13042           ERCNOT-KEY,
 13043           DFHEIV99,
 13044           DFHEIV99,
 13045           DFHEIV99
 13046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13047
 13048
 13049     PERFORM 8400-LOG-JOURNAL-RECORD.
 13050
 13051     GO TO 1406-DELETE-ERCNOT-LOOP.
 13052
 13053 1406-DELETE-ERNOTE.
 13054
 13055
 13056* EXEC CICS HANDLE CONDITION
 13057*         NOTFND  (1407-DELETE-MAILING)
 13058*    END-EXEC.
 13059*    MOVE '"$I                   ! / #00012159' TO DFHEIV0
 13060     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13062     MOVE X'2F20233030303132313539' TO DFHEIV0(25:11)
 13063     CALL 'kxdfhei1' USING DFHEIV0
 13064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13065
 13066
 13067
 13068* EXEC CICS READ
 13069*        EQUAL
 13070*        DATASET   (FILE-ID-ERNOTE)
 13071*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13072*        RIDFLD    (ELCERT-KEY)
 13073*        UPDATE
 13074*    END-EXEC.
 13075*    MOVE '&"S        EU         (   #00012163' TO DFHEIV0
 13076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13077     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13078     MOVE X'2020233030303132313633' TO DFHEIV0(25:11)
 13079     CALL 'kxdfhei1' USING DFHEIV0,
 13080           FILE-ID-ERNOTE,
 13081           DFHEIV20,
 13082           DFHEIV99,
 13083           ELCERT-KEY,
 13084           DFHEIV99,
 13085           DFHEIV99,
 13086           DFHEIV99
 13087     SET ADDRESS OF CERTIFICATE-NOTE TO
 13088         DFHEIV20
 13089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13090
 13091
 13092     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 239
* EL6311.cbl
 13093     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13094     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13095
 13096     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13097
 13098
 13099* EXEC CICS DELETE
 13100*        DATASET   (FILE-ID-ERNOTE)
 13101*        END-EXEC.
 13102*    MOVE '&(                    &   #00012177' TO DFHEIV0
 13103     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13104     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13105     MOVE X'2020233030303132313737' TO DFHEIV0(25:11)
 13106     CALL 'kxdfhei1' USING DFHEIV0,
 13107           FILE-ID-ERNOTE,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99,
 13111           DFHEIV99
 13112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13113
 13114
 13115     PERFORM 8400-LOG-JOURNAL-RECORD.
 13116
 13117******************************************************************
 13118*                                                                *
 13119*                DELETE MAILING ADDRESS RECORDS                  *
 13120*                                                                *
 13121******************************************************************
 13122
 13123 1407-DELETE-MAILING.
 13124     IF CERT-ADDRESS-PRESENT
 13125        NEXT SENTENCE
 13126     ELSE
 13127        GO TO 1420-CONTINUE-DELETE.
 13128
 13129
 13130* EXEC CICS HANDLE CONDITION
 13131*         NOTFND  (1420-CONTINUE-DELETE)
 13132*    END-EXEC.
 13133*    MOVE '"$I                   ! 0 #00012195' TO DFHEIV0
 13134     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13136     MOVE X'3020233030303132313935' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0
 13138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13139
 13140
 13141
 13142* EXEC CICS READ
 13143*        EQUAL
 13144*        DATASET   (FILE-ID-ERMAIL)
 13145*        SET       (ADDRESS OF MAILING-DATA)
 13146*        RIDFLD    (ELCERT-KEY)
 13147*        UPDATE
 13148*    END-EXEC.
 13149*    MOVE '&"S        EU         (   #00012199' TO DFHEIV0
 13150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 240
* EL6311.cbl
 13151     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13152     MOVE X'2020233030303132313939' TO DFHEIV0(25:11)
 13153     CALL 'kxdfhei1' USING DFHEIV0,
 13154           FILE-ID-ERMAIL,
 13155           DFHEIV20,
 13156           DFHEIV99,
 13157           ELCERT-KEY,
 13158           DFHEIV99,
 13159           DFHEIV99,
 13160           DFHEIV99
 13161     SET ADDRESS OF MAILING-DATA TO
 13162         DFHEIV20
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13164
 13165
 13166     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13167     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13168     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13169
 13170     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13171
 13172
 13173* EXEC CICS DELETE
 13174*        DATASET   (FILE-ID-ERMAIL)
 13175*    END-EXEC.
 13176*    MOVE '&(                    &   #00012213' TO DFHEIV0
 13177     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13178     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13179     MOVE X'2020233030303132323133' TO DFHEIV0(25:11)
 13180     CALL 'kxdfhei1' USING DFHEIV0,
 13181           FILE-ID-ERMAIL,
 13182           DFHEIV99,
 13183           DFHEIV99,
 13184           DFHEIV99,
 13185           DFHEIV99
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13187
 13188
 13189     GO TO 1420-CONTINUE-DELETE.
 13190
 13191 1410-REWRITE-CERT.
 13192     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13193     MOVE 'C'                      TO JP-RECORD-TYPE.
 13194     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13195     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13196
 13197
 13198* EXEC CICS REWRITE
 13199*         DATASET    (FILE-ID-ELCERT)
 13200*         FROM       (CERTIFICATE-MASTER)
 13201*         END-EXEC.
 13202     MOVE LENGTH OF
 13203      CERTIFICATE-MASTER
 13204       TO DFHEIV11
 13205*    MOVE '&& L                  %   #00012225' TO DFHEIV0
 13206     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13207     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13208     MOVE X'2020233030303132323235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 241
* EL6311.cbl
 13209     CALL 'kxdfhei1' USING DFHEIV0,
 13210           FILE-ID-ELCERT,
 13211           CERTIFICATE-MASTER,
 13212           DFHEIV11,
 13213           DFHEIV99
 13214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13215
 13216
 13217     PERFORM 8400-LOG-JOURNAL-RECORD.
 13218
 13219 1420-CONTINUE-DELETE.
 13220     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13221     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13222
 13223     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13224     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13225
 13226     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13227
 13228 1450-DELETE-PB-RECORD.
 13229     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13230     MOVE 'D'                      TO JP-RECORD-TYPE
 13231     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13232
 13233
 13234* EXEC CICS DELETE
 13235*        DATASET    (FILE-ID-ERPNDB)
 13236*    END-EXEC.
 13237*    MOVE '&(                    &   #00012246' TO DFHEIV0
 13238     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13239     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13240     MOVE X'2020233030303132323436' TO DFHEIV0(25:11)
 13241     CALL 'kxdfhei1' USING DFHEIV0,
 13242           FILE-ID-ERPNDB,
 13243           DFHEIV99,
 13244           DFHEIV99,
 13245           DFHEIV99,
 13246           DFHEIV99
 13247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13248
 13249
 13250     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13251
 13252     PERFORM 8400-LOG-JOURNAL-RECORD.
 13253
 13254     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13255     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13256     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13257
 13258
 13259* EXEC CICS HANDLE CONDITION
 13260*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13261*    END-EXEC.
 13262*    MOVE '"$I                   ! 1 #00012258' TO DFHEIV0
 13263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13265     MOVE X'3120233030303132323538' TO DFHEIV0(25:11)
 13266     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 242
* EL6311.cbl
 13267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13268
 13269
 13270
 13271* EXEC CICS READ
 13272*        SET     (ADDRESS OF PENDING-BUSINESS)
 13273*        DATASET (FILE-ID-ERPNDB)
 13274*        RIDFLD  (ERPNDB-KEY)
 13275*        UPDATE
 13276*    END-EXEC.
 13277*    MOVE '&"S        EU         (   #00012262' TO DFHEIV0
 13278     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13279     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13280     MOVE X'2020233030303132323632' TO DFHEIV0(25:11)
 13281     CALL 'kxdfhei1' USING DFHEIV0,
 13282           FILE-ID-ERPNDB,
 13283           DFHEIV20,
 13284           DFHEIV99,
 13285           ERPNDB-KEY,
 13286           DFHEIV99,
 13287           DFHEIV99,
 13288           DFHEIV99
 13289     SET ADDRESS OF PENDING-BUSINESS TO
 13290         DFHEIV20
 13291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13292
 13293
 13294     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13295
 13296     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13297
 13298     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13299        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13300        MOVE 'D'                   TO JP-RECORD-TYPE
 13301        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13302
 13303* EXEC CICS DELETE
 13304*            DATASET    (FILE-ID-ERPNDB)
 13305*       END-EXEC
 13306*    MOVE '&(                    &   #00012277' TO DFHEIV0
 13307     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13308     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13309     MOVE X'2020233030303132323737' TO DFHEIV0(25:11)
 13310     CALL 'kxdfhei1' USING DFHEIV0,
 13311           FILE-ID-ERPNDB,
 13312           DFHEIV99,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13317        PERFORM 8400-LOG-JOURNAL-RECORD
 13318     ELSE
 13319        MOVE 'B'                 TO JP-RECORD-TYPE
 13320        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13321        PERFORM 8400-LOG-JOURNAL-RECORD
 13322        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13323        MOVE 'C'                 TO JP-RECORD-TYPE
 13324        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 243
* EL6311.cbl
 13325
 13326* EXEC CICS REWRITE
 13327*            DATASET    (FILE-ID-ERPNDB)
 13328*            FROM       (PENDING-BUSINESS)
 13329*       END-EXEC
 13330     MOVE LENGTH OF
 13331      PENDING-BUSINESS
 13332       TO DFHEIV11
 13333*    MOVE '&& L                  %   #00012288' TO DFHEIV0
 13334     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13335     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13336     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 13337     CALL 'kxdfhei1' USING DFHEIV0,
 13338           FILE-ID-ERPNDB,
 13339           PENDING-BUSINESS,
 13340           DFHEIV11,
 13341           DFHEIV99
 13342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13343        PERFORM 8400-LOG-JOURNAL-RECORD.
 13344
 13345******************************************************************
 13346*                                                                *
 13347*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13348*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13349*                                                                *
 13350******************************************************************
 13351
 13352     IF NOT PI-AR-PROCESSING
 13353        GO TO 1475-DELETE-FINISHED.
 13354
 13355     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13356        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13357        NEXT SENTENCE
 13358     ELSE
 13359        GO TO 1475-DELETE-FINISHED.
 13360
 13361
 13362* EXEC CICS HANDLE CONDITION
 13363*         NOTFND    (1475-DELETE-FINISHED)
 13364*         END-EXEC.
 13365*    MOVE '"$I                   ! 2 #00012310' TO DFHEIV0
 13366     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13368     MOVE X'3220233030303132333130' TO DFHEIV0(25:11)
 13369     CALL 'kxdfhei1' USING DFHEIV0
 13370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13371
 13372
 13373     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13374     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13375
 13376
 13377* EXEC CICS READ
 13378*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13379*        DATASET (FILE-ID-ERRQST)
 13380*        RIDFLD  (ERRQST-KEY)
 13381*        UPDATE
 13382*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 244
* EL6311.cbl
 13383*    MOVE '&"S        EU         (   #00012317' TO DFHEIV0
 13384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13385     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13386     MOVE X'2020233030303132333137' TO DFHEIV0(25:11)
 13387     CALL 'kxdfhei1' USING DFHEIV0,
 13388           FILE-ID-ERRQST,
 13389           DFHEIV20,
 13390           DFHEIV99,
 13391           ERRQST-KEY,
 13392           DFHEIV99,
 13393           DFHEIV99,
 13394           DFHEIV99
 13395     SET ADDRESS OF AR-REQUEST-RECORD TO
 13396         DFHEIV20
 13397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13398
 13399
 13400     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13401
 13402     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13403
 13404     MOVE 'D'                      TO JP-RECORD-TYPE.
 13405     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13406
 13407
 13408* EXEC CICS DELETE
 13409*         DATASET    (FILE-ID-ERRQST)
 13410*    END-EXEC.
 13411*    MOVE '&(                    &   #00012331' TO DFHEIV0
 13412     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303132333331' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           FILE-ID-ERRQST,
 13417           DFHEIV99,
 13418           DFHEIV99,
 13419           DFHEIV99,
 13420           DFHEIV99
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13422
 13423
 13424     PERFORM 8400-LOG-JOURNAL-RECORD.
 13425
 13426 1475-DELETE-FINISHED.
 13427     MOVE ZEROS                  TO EMI-ERROR.
 13428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13429     MOVE LOW-VALUES             TO EL631BI.
 13430     MOVE -1                     TO BMAINTL.
 13431     GO TO 8100-SEND-INITIAL-MAP.
 13432
 13433 1480-BATCH-HDR-NOT-FOUND.
 13434     MOVE -1                     TO BMAINTL.
 13435     MOVE ER-7450                TO EMI-ERROR.
 13436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13437     GO TO 8200-SEND-DATAONLY.
 13438
 13439 1490-RECORD-NOT-FOUND.
 13440     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 245
* EL6311.cbl
 13441     MOVE ER-7451                TO EMI-ERROR.
 13442     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13443     GO TO 8200-SEND-DATAONLY.
 13444
 13445******************************************************************
 13446*            O V E R   C H A R G E   P R O C E S S I N G         *
 13447******************************************************************
 13448 1500-UPDATE-ERNOTE.
 13449     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13450     MOVE 'A'                    TO WS-NOTE-SW
 13451     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13452     .
 13453 1500-EXIT.
 13454     EXIT.
 13455 1510-ADD-ERNOTE-REC.
 13456
 13457* EXEC CICS GETMAIN
 13458*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13459*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13460*        INITIMG (GETMAIN-SPACE)
 13461*    END-EXEC
 13462*    MOVE ',"IL                  $   #00012367' TO DFHEIV0
 13463     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13465     MOVE X'2020233030303132333637' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0,
 13467           DFHEIV20,
 13468           ERNOTE-RECORD-LENGTH,
 13469           GETMAIN-SPACE
 13470     SET ADDRESS OF CERTIFICATE-NOTE TO
 13471         DFHEIV20
 13472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13473     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13474                                 TO ERNOTE-KEY
 13475
 13476* EXEC CICS READ
 13477*       DATASET    (FILE-ID-ERNOTE)
 13478*       RIDFLD     (ERNOTE-KEY)
 13479*       INTO       (CERTIFICATE-NOTE)
 13480*       RESP       (WS-RESPONSE)
 13481*       UPDATE
 13482*    END-EXEC
 13483     MOVE LENGTH OF
 13484      CERTIFICATE-NOTE
 13485       TO DFHEIV11
 13486*    MOVE '&"IL       EU         (  N#00012374' TO DFHEIV0
 13487     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13488     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13489     MOVE X'204E233030303132333734' TO DFHEIV0(25:11)
 13490     CALL 'kxdfhei1' USING DFHEIV0,
 13491           FILE-ID-ERNOTE,
 13492           CERTIFICATE-NOTE,
 13493           DFHEIV11,
 13494           ERNOTE-KEY,
 13495           DFHEIV99,
 13496           DFHEIV99,
 13497           DFHEIV99
 13498     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 246
* EL6311.cbl
 13499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13500     IF RESP-NORMAL
 13501        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13502           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13503        END-IF
 13504        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13505           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13506        END-IF
 13507        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13508           (N1 > +10)
 13509           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13510           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13511        END-PERFORM
 13512        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13513          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13514
 13515* EXEC CICS UNLOCK
 13516*            DATASET    (FILE-ID-ERNOTE)
 13517*          END-EXEC
 13518*    MOVE '&*                    #   #00012395' TO DFHEIV0
 13519     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13520     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13521     MOVE X'2020233030303132333935' TO DFHEIV0(25:11)
 13522     CALL 'kxdfhei1' USING DFHEIV0,
 13523           FILE-ID-ERNOTE,
 13524           DFHEIV99
 13525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13526        ELSE
 13527          PERFORM VARYING N1 FROM +1 BY +1
 13528           UNTIL (N1 > +10)
 13529           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13530          END-PERFORM
 13531          IF (N1 < +11)
 13532            IF N1 >= CN-BILLING-START-LINE-NO AND
 13533              N1 <= CN-BILLING-END-LINE-NO
 13534              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13535                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13536              ELSE
 13537                 MOVE WS-VA-NO-COMM-MESS
 13538                                    TO CN-LINE (N1)
 13539              END-IF
 13540            ELSE
 13541              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13542               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13543                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13544                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13545                ELSE
 13546                  MOVE WS-VA-NO-COMM-MESS
 13547                                    TO CN-LINE (N1)
 13548                END-IF
 13549                MOVE N1             TO CN-BILLING-END-LINE-NO
 13550              ELSE
 13551                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13552                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13553                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13554                  ELSE
 13555                     MOVE WS-VA-NO-COMM-MESS
 13556                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 247
* EL6311.cbl
 13557                  END-IF
 13558                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13559                                      CN-BILLING-START-LINE-NO
 13560                ELSE
 13561                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13562                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13563                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13564                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13565                     ELSE
 13566                       MOVE WS-VA-NO-COMM-MESS
 13567                                    TO CN-LINE (N1)
 13568                     END-IF
 13569                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13570                  ELSE
 13571                     PERFORM 1700-SQUEEZE-IT-IN
 13572                                 THRU 1700-EXIT
 13573                  END-IF
 13574                END-IF
 13575              END-IF
 13576            END-IF
 13577            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13578            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13579            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13580
 13581* EXEC CICS REWRITE
 13582*              DATASET    (FILE-ID-ERNOTE)
 13583*              FROM       (CERTIFICATE-NOTE)
 13584*              RESP       (WS-RESPONSE)
 13585*           END-EXEC
 13586     MOVE LENGTH OF
 13587      CERTIFICATE-NOTE
 13588       TO DFHEIV11
 13589*    MOVE '&& L                  %  N#00012452' TO DFHEIV0
 13590     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13591     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13592     MOVE X'204E233030303132343532' TO DFHEIV0(25:11)
 13593     CALL 'kxdfhei1' USING DFHEIV0,
 13594           FILE-ID-ERNOTE,
 13595           CERTIFICATE-NOTE,
 13596           DFHEIV11,
 13597           DFHEIV99
 13598     MOVE EIBRESP  TO WS-RESPONSE
 13599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13600          END-IF
 13601        END-IF
 13602     ELSE
 13603        MOVE SPACES              TO CERTIFICATE-NOTE
 13604        MOVE 'CN'                TO CN-RECORD-ID
 13605        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13606                                 TO CN-CONTROL-PRIMARY
 13607                                    ERNOTE-KEY
 13608        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13609                                    CN-BILLING-END-LINE-NO
 13610        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13611           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13612        ELSE
 13613           MOVE WS-VA-NO-COMM-MESS
 13614                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 248
* EL6311.cbl
 13615        END-IF
 13616        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13617        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13618        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13619
 13620* EXEC CICS WRITE
 13621*          DATASET    (FILE-ID-ERNOTE)
 13622*          FROM       (CERTIFICATE-NOTE)
 13623*          RIDFLD     (ERNOTE-KEY)
 13624*          RESP       (WS-RESPONSE)
 13625*       END-EXEC
 13626     MOVE LENGTH OF
 13627      CERTIFICATE-NOTE
 13628       TO DFHEIV11
 13629*    MOVE '&$ L                  ''  N#00012476' TO DFHEIV0
 13630     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13631     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13632     MOVE X'204E233030303132343736' TO DFHEIV0(25:11)
 13633     CALL 'kxdfhei1' USING DFHEIV0,
 13634           FILE-ID-ERNOTE,
 13635           CERTIFICATE-NOTE,
 13636           DFHEIV11,
 13637           ERNOTE-KEY,
 13638           DFHEIV99,
 13639           DFHEIV99
 13640     MOVE EIBRESP  TO WS-RESPONSE
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13642     END-IF
 13643     .
 13644 1510-EXIT.
 13645     EXIT.
 13646 1520-UPDATE-ELCERT.
 13647     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13648                                 TO ELCERT-KEY
 13649
 13650* EXEC CICS READ
 13651*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13652*        DATASET (FILE-ID-ELCERT)
 13653*        RIDFLD  (ELCERT-KEY)
 13654*        UPDATE
 13655*        RESP    (WS-RESPONSE)
 13656*    END-EXEC
 13657*    MOVE '&"S        EU         (  N#00012489' TO DFHEIV0
 13658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13659     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13660     MOVE X'204E233030303132343839' TO DFHEIV0(25:11)
 13661     CALL 'kxdfhei1' USING DFHEIV0,
 13662           FILE-ID-ELCERT,
 13663           DFHEIV20,
 13664           DFHEIV99,
 13665           ELCERT-KEY,
 13666           DFHEIV99,
 13667           DFHEIV99,
 13668           DFHEIV99
 13669     SET ADDRESS OF CERTIFICATE-MASTER TO
 13670         DFHEIV20
 13671     MOVE EIBRESP  TO WS-RESPONSE
 13672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 249
* EL6311.cbl
 13673     IF RESP-NORMAL
 13674        IF WS-NOTE-SW = 'A'
 13675           IF CM-NOTE-SW = ' '
 13676              MOVE '2'             TO CM-NOTE-SW
 13677           ELSE
 13678             IF CM-NOTE-SW = '1'
 13679                MOVE '3'           TO CM-NOTE-SW
 13680             ELSE
 13681               IF CM-NOTE-SW = '4'
 13682                  MOVE '6'         TO CM-NOTE-SW
 13683               ELSE
 13684                 IF CM-NOTE-SW = '5'
 13685                    MOVE '7'       TO CM-NOTE-SW
 13686                 END-IF
 13687               END-IF
 13688             END-IF
 13689           END-IF
 13690        ELSE
 13691           IF CM-NOTE-SW = '2'
 13692              MOVE ' '             TO CM-NOTE-SW
 13693           ELSE
 13694             IF CM-NOTE-SW = '3'
 13695                MOVE '1'           TO CM-NOTE-SW
 13696             ELSE
 13697               IF CM-NOTE-SW = '6'
 13698                  MOVE '4'         TO CM-NOTE-SW
 13699               ELSE
 13700                 IF CM-NOTE-SW = '7'
 13701                    MOVE '5'       TO CM-NOTE-SW
 13702                 END-IF
 13703               END-IF
 13704             END-IF
 13705           END-IF
 13706        END-IF
 13707
 13708* EXEC CICS REWRITE
 13709*          DATASET    (FILE-ID-ELCERT)
 13710*          FROM       (CERTIFICATE-MASTER)
 13711*          RESP       (WS-RESPONSE)
 13712*       END-EXEC
 13713     MOVE LENGTH OF
 13714      CERTIFICATE-MASTER
 13715       TO DFHEIV11
 13716*    MOVE '&& L                  %  N#00012530' TO DFHEIV0
 13717     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13719     MOVE X'204E233030303132353330' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           FILE-ID-ELCERT,
 13722           CERTIFICATE-MASTER,
 13723           DFHEIV11,
 13724           DFHEIV99
 13725     MOVE EIBRESP  TO WS-RESPONSE
 13726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13727        IF RESP-NORMAL
 13728           CONTINUE
 13729        ELSE
 13730           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 250
* EL6311.cbl
 13731           PERFORM 9900-ERROR-FORMAT
 13732                                 THRU 9900-EXIT
 13733           GO TO 8200-SEND-DATAONLY
 13734        END-IF
 13735     ELSE
 13736        MOVE -1                  TO BMAINTL
 13737        MOVE 0249                TO EMI-ERROR
 13738        PERFORM 9900-ERROR-FORMAT
 13739                                 THRU 9900-EXIT
 13740        GO TO 8200-SEND-DATAONLY
 13741     END-IF
 13742     .
 13743 1520-EXIT.
 13744     EXIT.
 13745 1600-UPDATE-ERPYAJ.
 13746     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13747                                 THRU 1610-EXIT
 13748     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13749                                 THRU 1620-EXIT
 13750     .
 13751 1600-EXIT.
 13752     EXIT.
 13753 1610-ADD-ERPYAJ-BANK-REC.
 13754
 13755* EXEC CICS GETMAIN
 13756*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13757*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13758*        INITIMG (GETMAIN-SPACE)
 13759*    END-EXEC
 13760*    MOVE ',"IL                  $   #00012562' TO DFHEIV0
 13761     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13762     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13763     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
 13764     CALL 'kxdfhei1' USING DFHEIV0,
 13765           DFHEIV20,
 13766           ERPYAJ-RECORD-LENGTH,
 13767           GETMAIN-SPACE
 13768     SET ADDRESS OF PENDING-PAY-ADJ TO
 13769         DFHEIV20
 13770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13771     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13772     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13773     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13774     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13775     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13776     MOVE +10                    TO ERPYAJ-SEQ-NO
 13777     MOVE 'R'                    TO ERPYAJ-TYPE
 13778     IF REVERSAL
 13779        MOVE 'C'                 TO ERPYAJ-TYPE
 13780     END-IF
 13781     MOVE SPACES                 TO PENDING-PAY-ADJ
 13782     MOVE 'PY'                   TO PY-RECORD-ID
 13783     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13784     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13785     IF REVERSAL
 13786        MOVE PB-I-DCC-OVER-CHG-AMT
 13787                                 TO PY-ENTRY-AMT
 13788     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 251
* EL6311.cbl
 13789     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13790                                    PY-INPUT-DT
 13791*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13792*                                   PY-INPUT-DT
 13793     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13794     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13795     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13796     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13797     IF PB-CARRIER = '2'
 13798        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13799     ELSE
 13800        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13801     END-IF
 13802     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13803                                    PY-BILLED-DATE
 13804                                    PY-AR-DATE
 13805                                    PY-REPORTED-DT
 13806                                    PY-CHECK-WRITTEN-DT
 13807     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13808                                    PY-CHECK-QUE-SEQUENCE
 13809     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13810     PERFORM WITH TEST AFTER
 13811        UNTIL (NOT RESP-DUPKEY)
 13812           AND (NOT RESP-DUPREC)
 13813
 13814* EXEC CICS WRITE
 13815*          DATASET    (FILE-ID-ERPYAJ)
 13816*          FROM       (PENDING-PAY-ADJ)
 13817*          RIDFLD     (ERPYAJ-KEY)
 13818*          RESP       (WS-RESPONSE)
 13819*       END-EXEC
 13820     MOVE LENGTH OF
 13821      PENDING-PAY-ADJ
 13822       TO DFHEIV11
 13823*    MOVE '&$ L                  ''  N#00012609' TO DFHEIV0
 13824     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13825     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13826     MOVE X'204E233030303132363039' TO DFHEIV0(25:11)
 13827     CALL 'kxdfhei1' USING DFHEIV0,
 13828           FILE-ID-ERPYAJ,
 13829           PENDING-PAY-ADJ,
 13830           DFHEIV11,
 13831           ERPYAJ-KEY,
 13832           DFHEIV99,
 13833           DFHEIV99
 13834     MOVE EIBRESP  TO WS-RESPONSE
 13835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13836        IF RESP-DUPKEY OR RESP-DUPREC
 13837           ADD +1                TO ERPYAJ-SEQ-NO
 13838           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13839        END-IF
 13840     END-PERFORM
 13841     .
 13842 1610-EXIT.
 13843     EXIT.
 13844 1620-ADD-ERPYAJ-DLR-REC.
 13845     MOVE 'C'                    TO ERPYAJ-TYPE
 13846     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 252
* EL6311.cbl
 13847        MOVE 'R'                 TO ERPYAJ-TYPE
 13848     END-IF
 13849     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13850                                    ERPYAJ-ACCOUNT
 13851     ADD +1                      TO ERPYAJ-SEQ-NO
 13852     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13853     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13854     IF PB-CARRIER = '2'
 13855        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13856     ELSE
 13857        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13858     END-IF
 13859     PERFORM WITH TEST AFTER
 13860        UNTIL (NOT RESP-DUPKEY)
 13861           AND (NOT RESP-DUPREC)
 13862
 13863* EXEC CICS WRITE
 13864*          DATASET    (FILE-ID-ERPYAJ)
 13865*          FROM       (PENDING-PAY-ADJ)
 13866*          RIDFLD     (ERPYAJ-KEY)
 13867*          RESP       (WS-RESPONSE)
 13868*       END-EXEC
 13869     MOVE LENGTH OF
 13870      PENDING-PAY-ADJ
 13871       TO DFHEIV11
 13872*    MOVE '&$ L                  ''  N#00012641' TO DFHEIV0
 13873     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13874     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13875     MOVE X'204E233030303132363431' TO DFHEIV0(25:11)
 13876     CALL 'kxdfhei1' USING DFHEIV0,
 13877           FILE-ID-ERPYAJ,
 13878           PENDING-PAY-ADJ,
 13879           DFHEIV11,
 13880           ERPYAJ-KEY,
 13881           DFHEIV99,
 13882           DFHEIV99
 13883     MOVE EIBRESP  TO WS-RESPONSE
 13884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13885        IF RESP-DUPKEY OR RESP-DUPREC
 13886           ADD +1                TO ERPYAJ-SEQ-NO
 13887           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13888        END-IF
 13889     END-PERFORM
 13890     .
 13891 1620-EXIT.
 13892     EXIT.
 13893 1700-SQUEEZE-IT-IN.
 13894     IF (N1 > CN-BILLING-END-LINE-NO)
 13895        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13896           N1 = +1
 13897           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13898           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13899              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13900                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13901              ELSE
 13902                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13903              END-IF
 13904              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 253
* EL6311.cbl
 13905              MOVE +2 TO N1
 13906           END-IF
 13907        END-PERFORM
 13908     ELSE
 13909        IF (N1 < CN-BILLING-START-LINE-NO)
 13910           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13911              N1 = +10
 13912              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13913              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13914                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13915                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13916                 ELSE
 13917                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13918                 END-IF
 13919                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13920                 MOVE +9 TO N1
 13921              END-IF
 13922           END-PERFORM
 13923        END-IF
 13924     END-IF
 13925     .
 13926 1700-EXIT.
 13927     EXIT.
 13928 1800-REMOVE-CERT-NOTES.
 13929     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13930                                 TO ERNOTE-KEY
 13931
 13932* EXEC CICS READ
 13933*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13934*       DATASET    (FILE-ID-ERNOTE)
 13935*       RIDFLD     (ERNOTE-KEY)
 13936*       RESP       (WS-RESPONSE)
 13937*       UPDATE
 13938*    END-EXEC
 13939*    MOVE '&"S        EU         (  N#00012693' TO DFHEIV0
 13940     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13941     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13942     MOVE X'204E233030303132363933' TO DFHEIV0(25:11)
 13943     CALL 'kxdfhei1' USING DFHEIV0,
 13944           FILE-ID-ERNOTE,
 13945           DFHEIV20,
 13946           DFHEIV99,
 13947           ERNOTE-KEY,
 13948           DFHEIV99,
 13949           DFHEIV99,
 13950           DFHEIV99
 13951     SET ADDRESS OF CERTIFICATE-NOTE TO
 13952         DFHEIV20
 13953     MOVE EIBRESP  TO WS-RESPONSE
 13954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13955     IF RESP-NORMAL
 13956        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13957           (N1 > +10)
 13958           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13959           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13960        END-PERFORM
 13961        IF N1 < +11
 13962           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 254
* EL6311.cbl
 13963           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13964              N1 <= CN-BILLING-END-LINE-NO
 13965              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13966              IF CN-BILLING-END-LINE-NO <
 13967                               CN-BILLING-START-LINE-NO
 13968                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13969                                     CN-BILLING-START-LINE-NO
 13970              END-IF
 13971              PERFORM 1820-SQUEEZE-ERNOTE
 13972                                  THRU 1820-EXIT
 13973           END-IF
 13974           IF CN-LINES = SPACES
 13975
 13976* EXEC CICS DELETE
 13977*                DATASET    (FILE-ID-ERNOTE)
 13978*                RESP       (WS-RESPONSE)
 13979*             END-EXEC
 13980*    MOVE '&(                    &  N#00012720' TO DFHEIV0
 13981     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13983     MOVE X'204E233030303132373230' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           FILE-ID-ERNOTE,
 13986           DFHEIV99,
 13987           DFHEIV99,
 13988           DFHEIV99,
 13989           DFHEIV99
 13990     MOVE EIBRESP  TO WS-RESPONSE
 13991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13992              IF RESP-NORMAL
 13993                 MOVE 'D'        TO WS-NOTE-SW
 13994                 PERFORM 1520-UPDATE-ELCERT
 13995                                 THRU 1520-EXIT
 13996              END-IF
 13997           ELSE
 13998
 13999* EXEC CICS REWRITE
 14000*                DATASET    (FILE-ID-ERNOTE)
 14001*                FROM       (CERTIFICATE-NOTE)
 14002*                RESP       (WS-RESPONSE)
 14003*             END-EXEC
 14004     MOVE LENGTH OF
 14005      CERTIFICATE-NOTE
 14006       TO DFHEIV11
 14007*    MOVE '&& L                  %  N#00012730' TO DFHEIV0
 14008     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14010     MOVE X'204E233030303132373330' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           FILE-ID-ERNOTE,
 14013           CERTIFICATE-NOTE,
 14014           DFHEIV11,
 14015           DFHEIV99
 14016     MOVE EIBRESP  TO WS-RESPONSE
 14017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14018           END-IF
 14019        END-IF
 14020     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 255
* EL6311.cbl
 14021     .
 14022 1800-EXIT.
 14023     EXIT.
 14024 1820-SQUEEZE-ERNOTE.
 14025     MOVE CN-BILLING-START-LINE-NO TO N2
 14026     IF N2 = 0
 14027         MOVE +1                 TO N2
 14028     END-IF
 14029     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 14030        (N1 > +9)
 14031        IF CN-LINE (N1) = SPACES
 14032           MOVE CN-LINE (N1 + +1)
 14033                                 TO CN-LINE (N1)
 14034           MOVE SPACES           TO CN-LINE (N1 + +1)
 14035        END-IF
 14036     END-PERFORM
 14037     .
 14038 1820-EXIT.
 14039     EXIT.
 14040 1900-DELETE-ERPYAJ.
 14041     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14042     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14043     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14044     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14045     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14046     MOVE +10                    TO ERPYAJ-SEQ-NO
 14047     MOVE 'R'                    TO ERPYAJ-TYPE
 14048     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14049
 14050* EXEC CICS STARTBR
 14051*       DATASET    (FILE-ID-ERPYAJ)
 14052*       RIDFLD     (ERPYAJ-KEY)
 14053*       RESP       (WS-RESPONSE)
 14054*    END-EXEC
 14055     MOVE 0
 14056       TO DFHEIV11
 14057*    MOVE '&,         G          &  N#00012766' TO DFHEIV0
 14058     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14060     MOVE X'204E233030303132373636' TO DFHEIV0(25:11)
 14061     CALL 'kxdfhei1' USING DFHEIV0,
 14062           FILE-ID-ERPYAJ,
 14063           ERPYAJ-KEY,
 14064           DFHEIV99,
 14065           DFHEIV11,
 14066           DFHEIV99
 14067     MOVE EIBRESP  TO WS-RESPONSE
 14068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14069     IF RESP-NORMAL
 14070        CONTINUE
 14071     ELSE
 14072        GO TO 1900-GET-DEALER
 14073     END-IF
 14074     .
 14075 1900-READNEXT-ERPYAJ-B.
 14076*  GET THE BANK ERPYAJ RECORD
 14077
 14078* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 256
* EL6311.cbl
 14079*       DATASET    (FILE-ID-ERPYAJ)
 14080*       RIDFLD     (ERPYAJ-KEY)
 14081*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14082*       RESP       (WS-RESPONSE)
 14083*    END-EXEC
 14084     MOVE 0
 14085       TO DFHEIV11
 14086*    MOVE '&.S                   )  N#00012779' TO DFHEIV0
 14087     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14088     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14089     MOVE X'204E233030303132373739' TO DFHEIV0(25:11)
 14090     CALL 'kxdfhei1' USING DFHEIV0,
 14091           FILE-ID-ERPYAJ,
 14092           DFHEIV20,
 14093           DFHEIV99,
 14094           ERPYAJ-KEY,
 14095           DFHEIV99,
 14096           DFHEIV11,
 14097           DFHEIV99,
 14098           DFHEIV99
 14099     SET ADDRESS OF PENDING-PAY-ADJ TO
 14100         DFHEIV20
 14101     MOVE EIBRESP  TO WS-RESPONSE
 14102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14103     IF RESP-NORMAL
 14104        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14105           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14106              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14107                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14108
 14109* EXEC CICS READ
 14110*                   DATASET    (FILE-ID-ERPYAJ)
 14111*                   RIDFLD     (ERPYAJ-KEY)
 14112*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14113*                   RESP       (WS-RESPONSE)
 14114*                   UPDATE
 14115*                END-EXEC
 14116*    MOVE '&"S        EU         (  N#00012790' TO DFHEIV0
 14117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14118     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14119     MOVE X'204E233030303132373930' TO DFHEIV0(25:11)
 14120     CALL 'kxdfhei1' USING DFHEIV0,
 14121           FILE-ID-ERPYAJ,
 14122           DFHEIV20,
 14123           DFHEIV99,
 14124           ERPYAJ-KEY,
 14125           DFHEIV99,
 14126           DFHEIV99,
 14127           DFHEIV99
 14128     SET ADDRESS OF PENDING-PAY-ADJ TO
 14129         DFHEIV20
 14130     MOVE EIBRESP  TO WS-RESPONSE
 14131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14132                 IF RESP-NORMAL
 14133
 14134* EXEC CICS DELETE
 14135*                      DATASET   (FILE-ID-ERPYAJ)
 14136*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 257
* EL6311.cbl
 14137*                   END-EXEC
 14138*    MOVE '&(                    &  N#00012798' TO DFHEIV0
 14139     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14140     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14141     MOVE X'204E233030303132373938' TO DFHEIV0(25:11)
 14142     CALL 'kxdfhei1' USING DFHEIV0,
 14143           FILE-ID-ERPYAJ,
 14144           DFHEIV99,
 14145           DFHEIV99,
 14146           DFHEIV99,
 14147           DFHEIV99
 14148     MOVE EIBRESP  TO WS-RESPONSE
 14149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14150                 END-IF
 14151              ELSE
 14152                 SET REVERSAL    TO TRUE
 14153                 PERFORM 1600-UPDATE-ERPYAJ
 14154                                 THRU 1600-EXIT
 14155                 GO TO 1900-EXIT
 14156              END-IF
 14157           ELSE
 14158              GO TO 1900-READNEXT-ERPYAJ-B
 14159           END-IF
 14160        END-IF
 14161
 14162* EXEC CICS ENDBR
 14163*          DATASET   (FILE-ID-ERPYAJ)
 14164*       END-EXEC
 14165     MOVE 0
 14166       TO DFHEIV11
 14167*    MOVE '&2                    $   #00012813' TO DFHEIV0
 14168     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14170     MOVE X'2020233030303132383133' TO DFHEIV0(25:11)
 14171     CALL 'kxdfhei1' USING DFHEIV0,
 14172           FILE-ID-ERPYAJ,
 14173           DFHEIV11,
 14174           DFHEIV99
 14175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14176     END-IF
 14177     .
 14178 1900-GET-DEALER.
 14179     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14180     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14181     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14182     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14183     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14184     MOVE +10                    TO ERPYAJ-SEQ-NO
 14185     MOVE 'C'                    TO ERPYAJ-TYPE
 14186     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14187
 14188* EXEC CICS STARTBR
 14189*       DATASET    (FILE-ID-ERPYAJ)
 14190*       RIDFLD     (ERPYAJ-KEY)
 14191*       RESP       (WS-RESPONSE)
 14192*    END-EXEC
 14193     MOVE 0
 14194       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 258
* EL6311.cbl
 14195*    MOVE '&,         G          &  N#00012827' TO DFHEIV0
 14196     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14197     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14198     MOVE X'204E233030303132383237' TO DFHEIV0(25:11)
 14199     CALL 'kxdfhei1' USING DFHEIV0,
 14200           FILE-ID-ERPYAJ,
 14201           ERPYAJ-KEY,
 14202           DFHEIV99,
 14203           DFHEIV11,
 14204           DFHEIV99
 14205     MOVE EIBRESP  TO WS-RESPONSE
 14206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14207     IF RESP-NORMAL
 14208        CONTINUE
 14209     ELSE
 14210        GO TO 1900-EXIT
 14211     END-IF
 14212     .
 14213 1900-READNEXT-ERPYAJ-D.
 14214*  GET THE DEALER ERPYAJ RECORD
 14215
 14216* EXEC CICS READNEXT
 14217*       DATASET    (FILE-ID-ERPYAJ)
 14218*       RIDFLD     (ERPYAJ-KEY)
 14219*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14220*       RESP       (WS-RESPONSE)
 14221*    END-EXEC
 14222     MOVE 0
 14223       TO DFHEIV11
 14224*    MOVE '&.S                   )  N#00012840' TO DFHEIV0
 14225     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14227     MOVE X'204E233030303132383430' TO DFHEIV0(25:11)
 14228     CALL 'kxdfhei1' USING DFHEIV0,
 14229           FILE-ID-ERPYAJ,
 14230           DFHEIV20,
 14231           DFHEIV99,
 14232           ERPYAJ-KEY,
 14233           DFHEIV99,
 14234           DFHEIV11,
 14235           DFHEIV99,
 14236           DFHEIV99
 14237     SET ADDRESS OF PENDING-PAY-ADJ TO
 14238         DFHEIV20
 14239     MOVE EIBRESP  TO WS-RESPONSE
 14240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14241     IF RESP-NORMAL
 14242        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14243           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14244              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14245                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14246
 14247* EXEC CICS READ
 14248*                   DATASET    (FILE-ID-ERPYAJ)
 14249*                   RIDFLD     (ERPYAJ-KEY)
 14250*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14251*                   RESP       (WS-RESPONSE)
 14252*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 259
* EL6311.cbl
 14253*                END-EXEC
 14254*    MOVE '&"S        EU         (  N#00012851' TO DFHEIV0
 14255     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14256     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14257     MOVE X'204E233030303132383531' TO DFHEIV0(25:11)
 14258     CALL 'kxdfhei1' USING DFHEIV0,
 14259           FILE-ID-ERPYAJ,
 14260           DFHEIV20,
 14261           DFHEIV99,
 14262           ERPYAJ-KEY,
 14263           DFHEIV99,
 14264           DFHEIV99,
 14265           DFHEIV99
 14266     SET ADDRESS OF PENDING-PAY-ADJ TO
 14267         DFHEIV20
 14268     MOVE EIBRESP  TO WS-RESPONSE
 14269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14270                 IF RESP-NORMAL
 14271
 14272* EXEC CICS DELETE
 14273*                      DATASET   (FILE-ID-ERPYAJ)
 14274*                      RESP      (WS-RESPONSE)
 14275*                   END-EXEC
 14276*    MOVE '&(                    &  N#00012859' TO DFHEIV0
 14277     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14279     MOVE X'204E233030303132383539' TO DFHEIV0(25:11)
 14280     CALL 'kxdfhei1' USING DFHEIV0,
 14281           FILE-ID-ERPYAJ,
 14282           DFHEIV99,
 14283           DFHEIV99,
 14284           DFHEIV99,
 14285           DFHEIV99
 14286     MOVE EIBRESP  TO WS-RESPONSE
 14287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14288                 END-IF
 14289              ELSE
 14290                 SET REVERSAL    TO TRUE
 14291              END-IF
 14292           ELSE
 14293              GO TO 1900-READNEXT-ERPYAJ-D
 14294           END-IF
 14295        END-IF
 14296
 14297* EXEC CICS ENDBR
 14298*          DATASET   (FILE-ID-ERPYAJ)
 14299*       END-EXEC
 14300     MOVE 0
 14301       TO DFHEIV11
 14302*    MOVE '&2                    $   #00012871' TO DFHEIV0
 14303     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14304     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14305     MOVE X'2020233030303132383731' TO DFHEIV0(25:11)
 14306     CALL 'kxdfhei1' USING DFHEIV0,
 14307           FILE-ID-ERPYAJ,
 14308           DFHEIV11,
 14309           DFHEIV99
 14310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 260
* EL6311.cbl
 14311     END-IF
 14312     .
 14313 1900-EXIT.
 14314     EXIT.
 14315******************************************************************
 14316*            C A N C E L   M A I N L I N E                       *
 14317******************************************************************
 14318
 14319 2000-CANCEL-MAINLINE.
 14320     IF PI-DISPLAY-ORIGINAL-BATCH
 14321        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14322           MOVE ER-0023             TO EMI-ERROR
 14323           MOVE -1                  TO CMAINTL
 14324           MOVE AL-UABON            TO CMAINTA
 14325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14326           GO TO 8200-SEND-DATAONLY
 14327        ELSE
 14328           NEXT SENTENCE
 14329     ELSE
 14330        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14331           MOVE ER-0023             TO EMI-ERROR
 14332           MOVE -1                  TO CMAINTL
 14333           MOVE AL-UABON            TO CMAINTA
 14334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14335           GO TO 8200-SEND-DATAONLY.
 14336
 14337     IF CMAINTI = 'S'
 14338        GO TO 2100-SHOW-REQUEST.
 14339
 14340     IF NOT MODIFY-CAP
 14341         MOVE 'UPDATE'       TO SM-READ
 14342         PERFORM 9995-SECURITY-VIOLATION
 14343         MOVE ER-0070        TO EMI-ERROR
 14344         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14345         GO TO 8100-SEND-INITIAL-MAP.
 14346
 14347     IF CMAINTL GREATER THAN ZEROS
 14348        IF PI-PF6-FUNCTION
 14349           IF CMAINTI NOT = 'A'
 14350              MOVE AL-UABON  TO CMAINTA
 14351              MOVE -1        TO CMAINTL
 14352              MOVE ER-2260   TO EMI-ERROR
 14353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14354              GO TO 8200-SEND-DATAONLY.
 14355
 14356     IF CCERTNOL = ZEROS
 14357       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14358         NEXT SENTENCE
 14359     ELSE
 14360         IF CCERTNOL NOT = ZEROS
 14361             MOVE AL-UANON       TO CCERTNOA
 14362         ELSE
 14363             MOVE -1             TO CCERTNOL
 14364             MOVE  1             TO SET-CURSOR-SW
 14365             MOVE ER-2218       TO EMI-ERROR
 14366             MOVE AL-UABON       TO CCERTNOA
 14367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14368
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 261
* EL6311.cbl
 14369     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14370        NEXT SENTENCE
 14371     ELSE
 14372        IF CEFFDTL NOT = ZEROS
 14373           MOVE AL-UNNON         TO CEFFDTA
 14374           MOVE CEFFDTI TO DEEDIT-FIELD
 14375           PERFORM 8600-DEEDIT
 14376           MOVE 4                TO DC-OPTION-CODE
 14377           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14378           PERFORM 9700-DATE-LINK
 14379           IF NO-CONVERSION-ERROR
 14380              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14381              ELSE
 14382              MOVE -1            TO CEFFDTL
 14383              MOVE  1            TO SET-CURSOR-SW
 14384              MOVE ER-2226      TO EMI-ERROR
 14385              MOVE AL-UNBON      TO CEFFDTA
 14386              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14387          ELSE
 14388          MOVE -1                 TO CEFFDTL
 14389          MOVE  1                 TO SET-CURSOR-SW
 14390          MOVE ER-2220            TO EMI-ERROR
 14391          MOVE AL-UNBON           TO CEFFDTA
 14392          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14393
 14394     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14395
 14396     IF CCERTNOL NOT = ZEROS
 14397        MOVE CCERTNOI                TO WS-NEW-PRIME
 14398     ELSE
 14399        MOVE SPACES                  TO WS-NEW-PRIME.
 14400
 14401     IF CSUFIXL NOT = ZEROS
 14402        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14403     ELSE
 14404        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14405
 14406     IF CEFFDTL NOT = ZEROS
 14407        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14408     ELSE
 14409        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14410
 14411     IF CMAINTI = 'A' OR 'K' OR 'S'
 14412        NEXT SENTENCE
 14413     ELSE
 14414        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14415        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14416           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14417           WS-PB-RECORD-TYPE NOT = '2'
 14418           IF CMAINTI = 'C'
 14419              MOVE ER-2287          TO EMI-ERROR
 14420              MOVE -1               TO CCERTNOL
 14421              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14422              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14423              GO TO 8200-SEND-DATAONLY
 14424             ELSE
 14425              MOVE ER-2260          TO EMI-ERROR
 14426              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 262
* EL6311.cbl
 14427              MOVE AL-UABON         TO CCERTNOA
 14428              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14429              GO TO 8200-SEND-DATAONLY.
 14430
 14431     IF CMAINTI = 'D'
 14432        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14433
 14434     IF CLSTNML GREATER THAN ZEROS
 14435         MOVE AL-UANON           TO CLSTNMA.
 14436
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 263
* EL6311.cbl
 14438
 14439******************************************************************
 14440*                                                                *
 14441*           E D I T   C A N C E L   C O V E R A G E S            *
 14442*                                                                *
 14443******************************************************************
 14444
 14445 2015-EDIT-COVERAGES.
 14446     IF CCANDT1L      GREATER THAN ZEROS OR
 14447        CREFND1L      GREATER THAN ZEROS OR
 14448        CCANDT2L      GREATER THAN ZEROS OR
 14449        CREFND2L      GREATER THAN ZEROS OR
 14450        CMTHD1L       GREATER THAN ZEROS OR
 14451        CMTHD2L       GREATER THAN ZEROS OR
 14452        CLIVESL       GREATER THAN ZEROS OR
 14453        CPAYEEL       GREATER THAN ZEROS OR
 14454        CFORCEL       GREATER THAN ZEROS OR
 14455        CBILCDL       GREATER THAN ZEROS OR
 14456        CCANREAL      GREATER THAN ZEROS
 14457            NEXT SENTENCE
 14458         ELSE
 14459            GO TO 2030-EDIT-COMPLETE.
 14460
 14461     IF CCANDT1L = ZEROS
 14462        AND (CMAINTI = 'C' OR 'K')
 14463        NEXT SENTENCE
 14464     ELSE
 14465        IF CCANDT1L      GREATER THAN ZEROS
 14466            MOVE AL-UNNON            TO CCANDT1A
 14467            IF CCANDT1I = SPACES
 14468               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14469            ELSE
 14470               MOVE CCANDT1I            TO DEEDIT-FIELD
 14471               PERFORM 8600-DEEDIT
 14472               IF DEEDIT-FIELD-V0   NUMERIC
 14473                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14474                  MOVE 4                TO DC-OPTION-CODE
 14475                  PERFORM 9700-DATE-LINK
 14476                  IF NO-CONVERSION-ERROR
 14477                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14478                  ELSE
 14479                      MOVE -1        TO CCANDT1L
 14480                      MOVE ER-2227   TO EMI-ERROR
 14481                      MOVE AL-UNBON  TO CCANDT1A
 14482                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14483               ELSE
 14484                  MOVE -1         TO CCANDT1L
 14485                  MOVE ER-2223    TO EMI-ERROR
 14486                  MOVE AL-UNBON   TO CCANDT1A
 14487                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14488        ELSE
 14489            IF CREFND1L GREATER THAN ZEROS
 14490               MOVE -1             TO CCANDT1L
 14491               MOVE ER-2222        TO EMI-ERROR
 14492               MOVE AL-UNBOF       TO CCANDT1A
 14493               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14494
 14495     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 264
* EL6311.cbl
 14496        AND (CMAINTI = 'C' OR 'K')
 14497         NEXT SENTENCE
 14498     ELSE
 14499         IF CREFND1L NOT = ZEROS
 14500            MOVE AL-UNNON        TO CREFND1A
 14501
 14502* EXEC CICS BIF DEEDIT
 14503*               FIELD  (CREFND1I)
 14504*               LENGTH (11)
 14505*           END-EXEC
 14506     MOVE 11
 14507       TO DFHEIV11
 14508*    MOVE '@"L                   #   #00013064' TO DFHEIV0
 14509     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14510     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14511     MOVE X'2020233030303133303634' TO DFHEIV0(25:11)
 14512     CALL 'kxdfhei1' USING DFHEIV0,
 14513           CREFND1I,
 14514           DFHEIV11
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14516            MOVE CREFND1I        TO WS-CREFND1
 14517*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14518*           PERFORM 8600-DEEDIT
 14519*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14520            IF WS-CREFND1  = ZEROS
 14521               AND CMAINTI = 'A'
 14522             MOVE ER-2437        TO EMI-ERROR
 14523             MOVE -1             TO CREFND1L
 14524             MOVE AL-UNBON       TO CREFND1A
 14525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14526
 14527     IF CCANREAL > +0
 14528        MOVE AL-UANON            TO CCANREAA
 14529        IF CCANREAI = 'R' OR ' '
 14530           CONTINUE
 14531        ELSE
 14532           MOVE ER-9841        TO EMI-ERROR
 14533           MOVE -1             TO CCANREAL
 14534           MOVE AL-UABON       TO CCANREAA
 14535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14536        END-IF
 14537     END-IF
 14538     IF CMTHD1L EQUAL +0
 14539        NEXT SENTENCE
 14540     ELSE
 14541        IF CMTHD1L NOT = +0
 14542           MOVE AL-UNNON        TO CMTHD1A
 14543           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14544                         OR '5' OR '6' OR '8' OR '9'
 14545                         OR 'R' OR ' '
 14546              NEXT SENTENCE
 14547           ELSE
 14548              MOVE ER-0582        TO EMI-ERROR
 14549              MOVE -1             TO CMTHD1L
 14550              MOVE AL-UNBON       TO CMTHD1A
 14551              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14552
 14553     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 265
* EL6311.cbl
 14554        AND (CMAINTI = 'C' OR 'K')
 14555         NEXT SENTENCE
 14556     ELSE
 14557         IF CCANDT2L  GREATER THAN ZEROS
 14558             MOVE AL-UNNON       TO CCANDT2A
 14559             IF CCANDT2I = SPACES
 14560                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14561             ELSE
 14562                MOVE CCANDT2I       TO DEEDIT-FIELD
 14563                PERFORM 8600-DEEDIT
 14564                IF DEEDIT-FIELD-V0   NUMERIC
 14565                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14566                   MOVE 4                TO DC-OPTION-CODE
 14567                   PERFORM 9700-DATE-LINK
 14568                   IF NO-CONVERSION-ERROR
 14569                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14570                   ELSE
 14571                      MOVE -1       TO CCANDT2L
 14572                      MOVE ER-2227  TO EMI-ERROR
 14573                      MOVE AL-UNBON TO CCANDT2A
 14574                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14575                ELSE
 14576                   MOVE -1         TO CCANDT2L
 14577                   MOVE ER-2223    TO EMI-ERROR
 14578                   MOVE AL-UNBON   TO CCANDT2A
 14579                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580         ELSE
 14581            IF CREFND2L GREATER THAN ZEROS
 14582               MOVE -1             TO CCANDT2L
 14583               MOVE ER-2222        TO EMI-ERROR
 14584               MOVE AL-UNBOF       TO CCANDT2A
 14585               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14586
 14587     IF CREFND2L = ZEROS
 14588        AND (CMAINTI = 'C' OR 'K')
 14589         NEXT SENTENCE
 14590     ELSE
 14591         IF CREFND2L NOT = ZEROS
 14592            MOVE AL-UNNON        TO CREFND2A
 14593
 14594* EXEC CICS BIF DEEDIT
 14595*               FIELD  (CREFND2I)
 14596*               LENGTH (11)
 14597*           END-EXEC
 14598     MOVE 11
 14599       TO DFHEIV11
 14600*    MOVE '@"L                   #   #00013145' TO DFHEIV0
 14601     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14603     MOVE X'2020233030303133313435' TO DFHEIV0(25:11)
 14604     CALL 'kxdfhei1' USING DFHEIV0,
 14605           CREFND2I,
 14606           DFHEIV11
 14607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14608            MOVE CREFND2I        TO WS-CREFND2
 14609*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14610*           PERFORM 8600-DEEDIT
 14611*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 266
* EL6311.cbl
 14612            IF WS-CREFND2  = ZEROS
 14613               AND CMAINTI = 'A'
 14614             MOVE ER-2437        TO EMI-ERROR
 14615             MOVE -1             TO CREFND2L
 14616             MOVE AL-UNBON       TO CREFND2A
 14617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14618
 14619     IF CMTHD2L EQUAL +0
 14620        NEXT SENTENCE
 14621     ELSE
 14622        IF CMTHD2L NOT = +0
 14623           MOVE AL-UNNON        TO CMTHD2A
 14624           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14625                         OR '5' OR '6' OR '8' OR '9'
 14626                         OR ' ' OR 'R'
 14627              NEXT SENTENCE
 14628           ELSE
 14629              MOVE ER-0582        TO EMI-ERROR
 14630              MOVE -1             TO CMTHD2L
 14631              MOVE AL-UNBON       TO CMTHD2A
 14632              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14633
 14634     IF CLIVESL GREATER THAN ZEROS
 14635         MOVE CLIVESI            TO DEEDIT-FIELD
 14636         PERFORM 8600-DEEDIT
 14637         IF DEEDIT-FIELD-V0 NUMERIC
 14638             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14639             MOVE AL-UNNON       TO CLIVESA
 14640         ELSE
 14641             MOVE -1             TO CLIVESL
 14642             MOVE AL-UNBON       TO CLIVESA
 14643             MOVE ER-2223        TO EMI-ERROR
 14644             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14645
 14646     IF CFORCEL  NOT = ZEROS
 14647         IF FORCE-CAP
 14648            MOVE AL-UANON            TO CFORCEA
 14649         ELSE
 14650            MOVE ER-2945             TO EMI-ERROR
 14651            MOVE AL-UABON            TO CFORCEA
 14652            MOVE -1                  TO CFORCEL
 14653            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14654
 14655     IF CPAYEEL GREATER THAN ZEROS
 14656        MOVE AL-UANON            TO CPAYEEA.
 14657
 14658     IF CBILCDL NOT = ZEROS
 14659        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14660                             AND 'A' AND 'B' AND 'E'
 14661           MOVE ER-2225              TO EMI-ERROR
 14662           MOVE AL-UABON             TO CBILCDA
 14663           MOVE -1                   TO CBILCDL
 14664           MOVE  1                   TO SET-CURSOR-SW
 14665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14666        ELSE
 14667           MOVE AL-UANON             TO CBILCDA.
 14668
 14669 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 267
* EL6311.cbl
 14670     IF EMI-ERROR = ZEROS
 14671         NEXT SENTENCE
 14672     ELSE
 14673         GO TO 8200-SEND-DATAONLY.
 14674
 14675     IF CMAINTI = 'A'
 14676        GO TO 2200-ADD-CANCEL-ROUTINE.
 14677
 14678     IF CMAINTI = 'C'
 14679        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14680
 14681     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14682
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 268
* EL6311.cbl
 14684
 14685******************************************************************
 14686*                                                                *
 14687*                   S H O W   C A N C E L                        *
 14688*                                                                *
 14689******************************************************************
 14690
 14691 2100-SHOW-REQUEST.
 14692     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14693
 14694     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14695        MOVE -1                  TO CMAINTL
 14696        GO TO 8200-SEND-DATAONLY.
 14697
 14698     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14699
 14700     IF CSUFIXL NOT = ZEROS
 14701        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14702       ELSE
 14703        MOVE SPACE            TO WS-NEW-SUFFIX.
 14704
 14705     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14706     PERFORM 8600-DEEDIT.
 14707     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14708     MOVE '4'                    TO DC-OPTION-CODE.
 14709     PERFORM 9700-DATE-LINK.
 14710     IF DATE-CONVERSION-ERROR
 14711        MOVE ER-0348             TO EMI-ERROR
 14712        MOVE -1                  TO CEFFDTL
 14713        MOVE AL-UABON            TO CEFFDTA
 14714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14715        GO TO 8200-SEND-DATAONLY
 14716     ELSE
 14717        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14718        MOVE AL-UANON            TO CEFFDTA
 14719        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14720
 14721     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14722
 14723     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14724        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14725        MOVE 'Y'                    TO WS-SHOW-SW
 14726        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14727           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14728        ELSE
 14729           IF PI-FILE-BROWSE
 14730              GO TO 4300-BROWSE-FILE-FORWARD
 14731           ELSE
 14732              IF PI-CSR-BROWSE
 14733                 GO TO 4200-BROWSE-CSR-FORWARD
 14734              ELSE
 14735                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14736     ELSE
 14737        GO TO 3900-RE-DISPLAY-RECORD.
 14738
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 269
* EL6311.cbl
 14740
 14741
 14742******************************************************************
 14743*                                                                *
 14744*            A D D   C A N C E L   R O U T I N E                 *
 14745*                                                                *
 14746******************************************************************
 14747
 14748 2200-ADD-CANCEL-ROUTINE.
 14749     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14750
 14751
 14752* EXEC CICS GETMAIN
 14753*        SET     (ADDRESS OF PENDING-BUSINESS)
 14754*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14755*    END-EXEC.
 14756*    MOVE '," L                  $   #00013292' TO DFHEIV0
 14757     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14759     MOVE X'2020233030303133323932' TO DFHEIV0(25:11)
 14760     CALL 'kxdfhei1' USING DFHEIV0,
 14761           DFHEIV20,
 14762           ERPNDB-RECORD-LENGTH,
 14763           DFHEIV99
 14764     SET ADDRESS OF PENDING-BUSINESS TO
 14765         DFHEIV20
 14766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14767
 14768
 14769
 14770* EXEC CICS HANDLE CONDITION
 14771*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14772*    END-EXEC.
 14773*    MOVE '"$I                   ! 3 #00013297' TO DFHEIV0
 14774     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14776     MOVE X'3320233030303133323937' TO DFHEIV0(25:11)
 14777     CALL 'kxdfhei1' USING DFHEIV0
 14778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14779
 14780
 14781     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14782     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14783     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14784
 14785
 14786* EXEC CICS READ
 14787*        INTO    (PENDING-BUSINESS)
 14788*        DATASET (FILE-ID-ERPNDB)
 14789*        RIDFLD  (ERPNDB-KEY)
 14790*    END-EXEC.
 14791     MOVE LENGTH OF
 14792      PENDING-BUSINESS
 14793       TO DFHEIV11
 14794*    MOVE '&"IL       E          (   #00013305' TO DFHEIV0
 14795     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14797     MOVE X'2020233030303133333035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 270
* EL6311.cbl
 14798     CALL 'kxdfhei1' USING DFHEIV0,
 14799           FILE-ID-ERPNDB,
 14800           PENDING-BUSINESS,
 14801           DFHEIV11,
 14802           ERPNDB-KEY,
 14803           DFHEIV99,
 14804           DFHEIV99,
 14805           DFHEIV99
 14806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14807
 14808
 14809     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14810
 14811     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14812     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14813     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14814     MOVE SPACES                 TO PENDING-BUSINESS.
 14815     MOVE 'PB'                   TO PB-RECORD-ID.
 14816     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14817     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14818     MOVE SPACES                 TO PB-CERT-SFX.
 14819     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14820     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14821                                    PB-ALT-CHG-SEQ-NO.
 14822
 14823     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14824     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14825     MOVE '2'                    TO PB-RECORD-TYPE.
 14826
 14827     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14828     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14829
 14830
 14831     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14832                                    PB-ALT-CHG-SEQ-NO
 14833                                    PB-C-LF-REF-CALC
 14834                                    PB-C-AH-REF-CALC
 14835                                    PB-C-LF-RFND-CLP
 14836                                    PB-C-AH-RFND-CLP
 14837                                    PB-CI-INSURED-AGE
 14838                                    PB-CI-LF-TERM
 14839                                    PB-CI-AH-TERM
 14840                                    PB-CI-LF-BENEFIT-CD
 14841                                    PB-CI-LF-BENEFIT-AMT
 14842                                    PB-CI-LF-ALT-BENEFIT-AMT
 14843                                    PB-CI-LF-PREMIUM-AMT
 14844                                    PB-CI-LF-ALT-PREMIUM-AMT
 14845                                    PB-CI-AH-BENEFIT-CD
 14846                                    PB-CI-AH-BENEFIT-AMT
 14847                                    PB-CI-AH-PREMIUM-AMT
 14848                                    PB-CI-PAY-FREQUENCY
 14849                                    PB-CI-LOAN-APR
 14850                                    PB-CI-LOAN-TERM
 14851                                    PB-CI-LIFE-COMMISSION
 14852                                    PB-CI-AH-COMMISSION
 14853                                    PB-CI-CURR-SEQ
 14854                                    PB-CI-AH-CANCEL-AMT
 14855                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 271
* EL6311.cbl
 14856                                    PB-CI-RATE-DEV-PCT-LF
 14857                                    PB-CI-RATE-DEV-PCT-AH
 14858                                    PB-CI-EXTENTION-DAYS
 14859                                    PB-CI-TERM-IN-DAYS
 14860                                    PB-CI-LIVES
 14861                                    PB-CI-LF-CRIT-PER
 14862                                    PB-CI-AH-CRIT-PER
 14863                                    PB-C-LF-REM-TERM
 14864                                    PB-C-AH-REM-TERM
 14865                                    PB-CHG-COUNT
 14866                                    PB-LF-BILLED-AMTS
 14867                                    PB-AH-BILLED-AMTS
 14868                                    PB-C-INT-ON-REFS
 14869*                                   PB-C-MICROFILM-NO
 14870                                    PB-CALC-TOLERANCE.
 14871
 14872     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14873                                    PB-CI-AH-SETTLEMENT-DT
 14874                                    PB-CI-DEATH-DT
 14875                                    PB-CI-LF-PRIOR-CANCEL-DT
 14876                                    PB-CI-AH-PRIOR-CANCEL-DT
 14877                                    PB-CI-ENTRY-DT
 14878                                    PB-CI-LF-EXPIRE-DT
 14879                                    PB-CI-AH-EXPIRE-DT
 14880                                    PB-CI-LOAN-1ST-PMT-DT
 14881                                    PB-C-LF-CANCEL-DT
 14882                                    PB-C-AH-CANCEL-DT
 14883                                    PB-CREDIT-ACCEPT-DT
 14884                                    PB-BILLED-DT
 14885                                    PB-ACCT-EFF-DT
 14886                                    PB-ACCT-EXP-DT.
 14887
 14888     MOVE 'X'                    TO PB-FATAL-FLAG.
 14889
 14890     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14891
 14892     IF CSUFIXL     GREATER THAN ZEROS
 14893        MOVE CSUFIXI             TO PB-CERT-SFX.
 14894
 14895*    IF CMICRNOL  GREATER  ZEROS
 14896*        IF CMICRNOI  NUMERIC
 14897*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14898*            MOVE AL-UNNON       TO  CMICRNOA
 14899*        ELSE
 14900*            MOVE -1             TO  CMICRNOL
 14901*            MOVE AL-UNBON       TO  CMICRNOA
 14902*            MOVE ER-2701        TO  EMI-ERROR
 14903*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14904
 14905     IF CLSTNML     GREATER THAN ZEROS
 14906        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14907
 14908     IF CCANREAL > ZEROS
 14909        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14910     END-IF
 14911     IF CPCYNL > ZEROS
 14912        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14913     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 272
* EL6311.cbl
 14914     IF CCANDT1L    GREATER THAN ZEROS
 14915        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14916
 14917     IF CCANDT2L    GREATER THAN ZEROS
 14918        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14919
 14920     IF CMTHD1L    GREATER THAN +0
 14921        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14922
 14923     IF CMTHD2L    GREATER THAN +0
 14924        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14925
 14926     IF CREFND1L    GREATER THAN ZEROS
 14927        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14928        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14929     ELSE
 14930        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14931
 14932     IF CREFND2L    GREATER THAN ZEROS
 14933        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14934        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14935     ELSE
 14936        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14937
 14938     IF CLIVESL     GREATER THAN ZEROS
 14939        MOVE WS-CLIVES           TO PB-C-LIVES
 14940     ELSE
 14941        MOVE ZEROS               TO PB-C-LIVES.
 14942
 14943     IF CPAYEEL     GREATER THAN ZEROS
 14944        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14945
 14946     IF CFORCEL     GREATER THAN ZEROS
 14947        MOVE CFORCEI             TO PB-FORCE-CODE.
 14948
 14949     IF CBILCDL     GREATER THAN ZEROS
 14950        MOVE CBILCDI             TO PB-RECORD-BILL.
 14951
 14952*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14953
 14954 2260-WRITE-PB-RECORD.
 14955     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14956                                    PB-INPUT-BY.
 14957     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14958     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14959                                    PB-INPUT-DT.
 14960
 14961     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14962     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14963                                    PB-CONTROL-BY-ORIG-BATCH.
 14964
 14965     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14966     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14967     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14968     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14969     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14970
 14971     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 273
* EL6311.cbl
 14972
 14973     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14974
 14975     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14976     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14977     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14978
 14979     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14980     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14981
 14982 2275-WRITE-PENDING-BUSINESS.
 14983     MOVE 'A'                    TO JP-RECORD-TYPE.
 14984     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14985     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14986     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14987
 14988
 14989* EXEC CICS HANDLE CONDITION
 14990*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14991*    END-EXEC.
 14992*    MOVE '"$%                   ! 4 #00013490' TO DFHEIV0
 14993     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14995     MOVE X'3420233030303133343930' TO DFHEIV0(25:11)
 14996     CALL 'kxdfhei1' USING DFHEIV0
 14997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14998
 14999
 15000
 15001* EXEC CICS WRITE
 15002*        DATASET (FILE-ID-ERPNDB)
 15003*        FROM    (PENDING-BUSINESS)
 15004*        RIDFLD  (PB-CONTROL-PRIMARY)
 15005*    END-EXEC.
 15006     MOVE LENGTH OF
 15007      PENDING-BUSINESS
 15008       TO DFHEIV11
 15009*    MOVE '&$ L                  ''   #00013494' TO DFHEIV0
 15010     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15011     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15012     MOVE X'2020233030303133343934' TO DFHEIV0(25:11)
 15013     CALL 'kxdfhei1' USING DFHEIV0,
 15014           FILE-ID-ERPNDB,
 15015           PENDING-BUSINESS,
 15016           DFHEIV11,
 15017           PB-CONTROL-PRIMARY,
 15018           DFHEIV99,
 15019           DFHEIV99
 15020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15021
 15022
 15023     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 15024
 15025     PERFORM 8400-LOG-JOURNAL-RECORD.
 15026
 15027******************************************************************
 15028*       A D D  O R I G I N A L  C E R T  I N F O                 *
 15029******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 274
* EL6311.cbl
 15030
 15031     display ' made it to add orig CANCEL cert '
 15032     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15033     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15034     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15035     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15036
 15037
 15038* EXEC CICS READ
 15039*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15040*        DATASET (FILE-ID-ELCERT)
 15041*        RIDFLD  (ELCERT-KEY)
 15042*        RESP    (WS-RESPONSE)
 15043*    END-EXEC.
 15044*    MOVE '&"S        E          (  N#00013514' TO DFHEIV0
 15045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15047     MOVE X'204E233030303133353134' TO DFHEIV0(25:11)
 15048     CALL 'kxdfhei1' USING DFHEIV0,
 15049           FILE-ID-ELCERT,
 15050           DFHEIV20,
 15051           DFHEIV99,
 15052           ELCERT-KEY,
 15053           DFHEIV99,
 15054           DFHEIV99,
 15055           DFHEIV99
 15056     SET ADDRESS OF CERTIFICATE-MASTER TO
 15057         DFHEIV20
 15058     MOVE EIBRESP  TO WS-RESPONSE
 15059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15060
 15061
 15062     IF NOT RESP-NORMAL
 15063        GO TO 2276-BYPASS-CRTO
 15064     END-IF
 15065
 15066     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15067     MOVE ' '                    TO WS-ERMAIL-SW
 15068
 15069
 15070* EXEC CICS READ
 15071*       DATASET   (FILE-ID-ERMAIL)
 15072*       SET       (ADDRESS OF MAILING-DATA)
 15073*       RIDFLD    (ERMAIL-KEY)
 15074*       RESP      (WS-RESPONSE)
 15075*    END-EXEC
 15076*    MOVE '&"S        E          (  N#00013528' TO DFHEIV0
 15077     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15079     MOVE X'204E233030303133353238' TO DFHEIV0(25:11)
 15080     CALL 'kxdfhei1' USING DFHEIV0,
 15081           FILE-ID-ERMAIL,
 15082           DFHEIV20,
 15083           DFHEIV99,
 15084           ERMAIL-KEY,
 15085           DFHEIV99,
 15086           DFHEIV99,
 15087           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 275
* EL6311.cbl
 15088     SET ADDRESS OF MAILING-DATA TO
 15089         DFHEIV20
 15090     MOVE EIBRESP  TO WS-RESPONSE
 15091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15092
 15093     IF RESP-NORMAL
 15094        SET ERMAIL-FOUND TO TRUE
 15095     END-IF
 15096
 15097     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15098
 15099     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15100     MOVE 'OC'                   TO OC-RECORD-ID
 15101     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15102                                 TO OC-CONTROL-PRIMARY (1:33)
 15103     MOVE 'I'                    TO OC-RECORD-TYPE
 15104     MOVE +4096                  TO OC-KEY-SEQ-NO
 15105     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15106     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15107     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15108
 15109     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15110     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15111     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15112     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15113     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15114     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15115     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15116     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15117     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15118     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15119     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15120     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15121     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15122     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15123     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15124     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15125     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15126     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15127     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15128     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15129     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15130     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15131     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15132     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15133     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15134     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15135     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15136     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15137     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15138     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15139     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15140     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15141
 15142     IF ERMAIL-FOUND
 15143        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15144     END-IF
 15145     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 276
* EL6311.cbl
 15146        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15147                           OC-INS-AGE-DEFAULT-FLAG
 15148        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15149                           OC-JNT-AGE-DEFAULT-FLAG
 15150     END-IF
 15151     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15152     .
 15153 2275-WRITE-ELCRTO.
 15154
 15155
 15156* EXEC CICS WRITE
 15157*       DATASET   ('ELCRTO')
 15158*       FROM      (ORIGINAL-CERTIFICATE)
 15159*       RIDFLD    (OC-CONTROL-PRIMARY)
 15160*       RESP      (WS-RESPONSE)
 15161*    END-EXEC
 15162     MOVE LENGTH OF
 15163      ORIGINAL-CERTIFICATE
 15164       TO DFHEIV11
 15165     MOVE 'ELCRTO' TO DFHEIV1
 15166*    MOVE '&$ L                  ''  N#00013597' TO DFHEIV0
 15167     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15168     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15169     MOVE X'204E233030303133353937' TO DFHEIV0(25:11)
 15170     CALL 'kxdfhei1' USING DFHEIV0,
 15171           DFHEIV1,
 15172           ORIGINAL-CERTIFICATE,
 15173           DFHEIV11,
 15174           OC-CONTROL-PRIMARY,
 15175           DFHEIV99,
 15176           DFHEIV99
 15177     MOVE EIBRESP  TO WS-RESPONSE
 15178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15179
 15180     display ' just wrote 2275 ' ws-response
 15181     IF RESP-DUPKEY
 15182        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15183        GO TO 2275-WRITE-ELCRTO
 15184     ELSE
 15185        IF NOT RESP-NORMAL
 15186           MOVE -1               TO BMAINTL
 15187           MOVE ER-7450          TO EMI-ERROR
 15188           PERFORM 9900-ERROR-FORMAT
 15189                                 THRU 9900-EXIT
 15190           GO TO 8200-SEND-DATAONLY
 15191        END-IF
 15192     END-IF.
 15193
 15194 2276-BYPASS-CRTO.
 15195******************************************************************
 15196*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15197******************************************************************
 15198
 15199
 15200* EXEC CICS READ
 15201*        INTO    (PENDING-BUSINESS)
 15202*        DATASET (FILE-ID-ERPNDB)
 15203*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 277
* EL6311.cbl
 15204*        UPDATE
 15205*    END-EXEC.
 15206     MOVE LENGTH OF
 15207      PENDING-BUSINESS
 15208       TO DFHEIV11
 15209*    MOVE '&"IL       EU         (   #00013623' TO DFHEIV0
 15210     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15212     MOVE X'2020233030303133363233' TO DFHEIV0(25:11)
 15213     CALL 'kxdfhei1' USING DFHEIV0,
 15214           FILE-ID-ERPNDB,
 15215           PENDING-BUSINESS,
 15216           DFHEIV11,
 15217           ERPNDB-KEY,
 15218           DFHEIV99,
 15219           DFHEIV99,
 15220           DFHEIV99
 15221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15222
 15223
 15224     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15225     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15226     MOVE 'B'                    TO JP-RECORD-TYPE.
 15227     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15228
 15229     PERFORM 8400-LOG-JOURNAL-RECORD.
 15230
 15231     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15232
 15233
 15234* EXEC CICS REWRITE
 15235*        DATASET (FILE-ID-ERPNDB)
 15236*        FROM    (PENDING-BUSINESS)
 15237*    END-EXEC.
 15238     MOVE LENGTH OF
 15239      PENDING-BUSINESS
 15240       TO DFHEIV11
 15241*    MOVE '&& L                  %   #00013639' TO DFHEIV0
 15242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15244     MOVE X'2020233030303133363339' TO DFHEIV0(25:11)
 15245     CALL 'kxdfhei1' USING DFHEIV0,
 15246           FILE-ID-ERPNDB,
 15247           PENDING-BUSINESS,
 15248           DFHEIV11,
 15249           DFHEIV99
 15250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15251
 15252
 15253     MOVE 'C'                    TO JP-RECORD-TYPE.
 15254     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15255
 15256     PERFORM 8400-LOG-JOURNAL-RECORD.
 15257
 15258     IF WS-ERRORS-PRESENT
 15259        GO TO 3900-RE-DISPLAY-RECORD.
 15260
 15261     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 278
* EL6311.cbl
 15262     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15263     MOVE LOW-VALUES             TO EL631CI.
 15264     MOVE  -1                    TO CMAINTL.
 15265     GO TO 8100-SEND-INITIAL-MAP.
 15266
 15267 2280-BATCH-HDR-NOT-FOUND.
 15268     MOVE -1                     TO BMAINTL.
 15269     MOVE ER-7450                TO EMI-ERROR.
 15270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15271     GO TO 8200-SEND-DATAONLY.
 15272
 15273 2290-DUPLICATE-ALT-INDEX.
 15274
 15275******************************************************************
 15276*                                                                *
 15277*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15278*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15279*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15280*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15281*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15282*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15283*                                                                *
 15284******************************************************************
 15285
 15286     IF LCP-ONCTR-02 =  0
 15287         ADD 1 TO LCP-ONCTR-02
 15288        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15289
 15290     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15291
 15292     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15293         NEXT SENTENCE
 15294     ELSE
 15295         ADD +1 TO PB-BATCH-SEQ-NO
 15296                   PB-CSR-BATCH-SEQ-NO
 15297         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15298         GO TO 2275-WRITE-PENDING-BUSINESS.
 15299
 15300     MOVE -1                     TO CCERTNOL.
 15301     MOVE AL-UABON               TO CCERTNOA.
 15302     MOVE AL-UNBON               TO CEFFDTA.
 15303
 15304     MOVE 1                      TO EMI-SUB
 15305                                    EMI-SWITCH1
 15306                                    EMI-SWITCH-AREA-1
 15307                                    EMI-SWITCH-AREA-2.
 15308
 15309     MOVE SPACES                 TO EMI-ERROR-LINES.
 15310
 15311
 15312* EXEC CICS SYNCPOINT ROLLBACK
 15313*    END-EXEC.
 15314*    MOVE '6"R                   !   #00013702' TO DFHEIV0
 15315     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15317     MOVE X'2020233030303133373032' TO DFHEIV0(25:11)
 15318     CALL 'kxdfhei1' USING DFHEIV0
 15319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 279
* EL6311.cbl
 15320
 15321
 15322     MOVE ER-2247                TO EMI-ERROR.
 15323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15324     GO TO 8200-SEND-DATAONLY.
 15325
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 280
* EL6311.cbl
 15327
 15328******************************************************************
 15329*                                                                *
 15330*          C H A N G E   C A N C E L   R O U T I N E             *
 15331*                                                                *
 15332******************************************************************
 15333
 15334***************************************************************
 15335*                                                             *
 15336*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15337*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15338*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15339*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15340*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15341*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15342*     5. LINK TO THE EDIT ROUTINE.                            *
 15343*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15344*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15345*              THE EDIT ROUTINE.                              *
 15346*     7. REWRITE THE NEW ISSUE                                *
 15347*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15348*                                                             *
 15349***************************************************************
 15350 2300-CHANGE-CANCEL-ROUTINE.
 15351     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15352
 15353     IF CCHGL NOT = ZEROS
 15354        MOVE ER-2196             TO EMI-ERROR
 15355        MOVE AL-UABON            TO CMAINTA
 15356        MOVE -1                  TO CMAINTL
 15357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15358        GO TO 8200-SEND-DATAONLY.
 15359
 15360     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15361
 15362     IF CSUFIXL NOT = ZEROS
 15363        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15364     ELSE
 15365        MOVE SPACE               TO WS-NEW-SUFFIX.
 15366
 15367     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15368     PERFORM 8600-DEEDIT.
 15369     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15370     MOVE '4'                    TO DC-OPTION-CODE.
 15371
 15372     PERFORM 9700-DATE-LINK.
 15373
 15374     IF DATE-CONVERSION-ERROR
 15375        MOVE ER-0348             TO EMI-ERROR
 15376        MOVE -1                  TO CEFFDTL
 15377        MOVE AL-UABON            TO CEFFDTA
 15378        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15379        GO TO 8200-SEND-DATAONLY
 15380     ELSE
 15381        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15382        MOVE AL-UANON            TO CEFFDTA
 15383        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15384
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 281
* EL6311.cbl
 15385 2325-PROCESS-CANCEL-CHANGES.
 15386
 15387* EXEC CICS HANDLE CONDITION
 15388*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15389*    END-EXEC.
 15390*    MOVE '"$I                   ! 5 #00013769' TO DFHEIV0
 15391     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15393     MOVE X'3520233030303133373639' TO DFHEIV0(25:11)
 15394     CALL 'kxdfhei1' USING DFHEIV0
 15395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15396
 15397
 15398     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15399     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15400     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15401
 15402
 15403* EXEC CICS GETMAIN
 15404*        SET      (ADDRESS OF PENDING-BUSINESS)
 15405*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15406*        INITIMG  (GETMAIN-SPACE)
 15407*     END-EXEC.
 15408*    MOVE ',"IL                  $   #00013777' TO DFHEIV0
 15409     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15411     MOVE X'2020233030303133373737' TO DFHEIV0(25:11)
 15412     CALL 'kxdfhei1' USING DFHEIV0,
 15413           DFHEIV20,
 15414           ERPNDB-RECORD-LENGTH,
 15415           GETMAIN-SPACE
 15416     SET ADDRESS OF PENDING-BUSINESS TO
 15417         DFHEIV20
 15418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15419
 15420
 15421
 15422* EXEC CICS READ
 15423*        INTO    (PENDING-BUSINESS)
 15424*        DATASET (FILE-ID-ERPNDB)
 15425*        RIDFLD  (ERPNDB-KEY)
 15426*    END-EXEC.
 15427     MOVE LENGTH OF
 15428      PENDING-BUSINESS
 15429       TO DFHEIV11
 15430*    MOVE '&"IL       E          (   #00013783' TO DFHEIV0
 15431     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15433     MOVE X'2020233030303133373833' TO DFHEIV0(25:11)
 15434     CALL 'kxdfhei1' USING DFHEIV0,
 15435           FILE-ID-ERPNDB,
 15436           PENDING-BUSINESS,
 15437           DFHEIV11,
 15438           ERPNDB-KEY,
 15439           DFHEIV99,
 15440           DFHEIV99,
 15441           DFHEIV99
 15442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 282
* EL6311.cbl
 15443
 15444
 15445     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15446
 15447
 15448* EXEC CICS HANDLE CONDITION
 15449*         NOTFND     (2385-REC-NOT-FOUND)
 15450*    END-EXEC.
 15451*    MOVE '"$I                   ! 6 #00013791' TO DFHEIV0
 15452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15454     MOVE X'3620233030303133373931' TO DFHEIV0(25:11)
 15455     CALL 'kxdfhei1' USING DFHEIV0
 15456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15457
 15458
 15459**********************************************************
 15460*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15461*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15462**********************************************************
 15463
 15464
 15465* EXEC CICS READ
 15466*        DATASET (FILE-ID-ERPNDB)
 15467*        INTO    (PENDING-BUSINESS)
 15468*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15469*    END-EXEC.
 15470     MOVE LENGTH OF
 15471      PENDING-BUSINESS
 15472       TO DFHEIV11
 15473*    MOVE '&"IL       E          (   #00013800' TO DFHEIV0
 15474     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15476     MOVE X'2020233030303133383030' TO DFHEIV0(25:11)
 15477     CALL 'kxdfhei1' USING DFHEIV0,
 15478           FILE-ID-ERPNDB,
 15479           PENDING-BUSINESS,
 15480           DFHEIV11,
 15481           PI-PREV-CONTROL-PRIMARY,
 15482           DFHEIV99,
 15483           DFHEIV99,
 15484           DFHEIV99
 15485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15486
 15487
 15488********** DO NOT ALLOW CHANGES IF THRU A/R
 15489     IF BMAINTI = 'C'
 15490         IF PB-EL860-INTERNAL-PROCESS
 15491             MOVE ER-4005          TO EMI-ERROR
 15492             MOVE -1               TO BMAINTL
 15493             MOVE AL-UABON         TO BMAINTA
 15494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15495             GO TO 8200-SEND-DATAONLY.
 15496**********
 15497
 15498     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15499        MOVE -1                 TO CMAINTL
 15500        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 283
* EL6311.cbl
 15501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15502        GO TO 8200-SEND-DATAONLY.
 15503
 15504     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15505        MOVE ER-2196             TO EMI-ERROR
 15506        MOVE AL-UABON            TO CMAINTA
 15507        MOVE -1                  TO CMAINTL
 15508        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15509        GO TO 8200-SEND-DATAONLY.
 15510     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15511
 15512     IF PB-BILLED-DT = LOW-VALUES AND
 15513        PB-CHG-COUNT = ZEROS
 15514        NEXT SENTENCE
 15515     ELSE
 15516        IF (CREFND1L GREATER THAN ZEROS AND
 15517            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15518           OR
 15519           (CREFND2L GREATER THAN ZEROS AND
 15520            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15521           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15522     if ((crefnd1l <> zeros)
 15523        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15524                      or
 15525        ((crefnd2l <> zeros)
 15526        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15527        continue
 15528     else
 15529        go to 2330-continue-change
 15530     end-if
 15531
 15532     move zeros                  to ws-check-amts
 15533     move ' '                    to ws-stop-sw
 15534                                    ws-check-sw
 15535                                    ws-any-check-sw
 15536                                    ws-proc-check-sw
 15537                                    ws-chek-browse-sw
 15538
 15539     perform 2500-browse-checks  thru 2500-exit
 15540
 15541     if i-have-processed-checks
 15542        or i-have-checks
 15543        continue
 15544     else
 15545        go to 2330-continue-change
 15546     end-if
 15547
 15548     if crefnd1l <> zeros
 15549        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15550        move ws-crefnd1 to ws-new-ref-total
 15551     else
 15552        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15553     end-if
 15554     if crefnd2l <> zeros
 15555        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15556        compute ws-new-ref-total = ws-new-ref-total +
 15557           ws-crefnd2
 15558     else
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 284
* EL6311.cbl
 15559        compute ws-new-ref-total = ws-new-ref-total +
 15560           pb-c-ah-cancel-amt
 15561     end-if
 15562
 15563     if zeros = (ws-lf-diff + ws-ah-diff)
 15564        move er-3449             to emi-error
 15565        perform 9900-error-format thru 9900-exit
 15566        go to 2330-continue-change
 15567     end-if
 15568
 15569     if (ws-new-ref-total < ws-check-amts)
 15570        and (pb-c-refund-sw = 'Y')
 15571        move er-3447             to emi-error
 15572        perform 9900-error-format thru 9900-exit
 15573        move al-uabon            to cmainta
 15574        move -1                  to cmaintl
 15575        go to 8200-send-dataonly
 15576     end-if
 15577
 15578     if (ws-new-ref-total > ws-check-amts)
 15579        and (ws-check-amts not = zeros)
 15580        move er-3448             to emi-error
 15581        move al-uabon            to crefnd1a
 15582                                    crefnd2a
 15583        perform 9900-error-format thru 9900-exit
 15584     end-if
 15585
 15586*     if (ws-lf-diff + ws-ah-diff) < zeros
 15587*        move er-3447             to emi-error
 15588*        perform 9900-error-format thru 9900-exit
 15589*        move al-uabon            to cmainta
 15590*        move -1                  to cmaintl
 15591*        go to 8200-send-dataonly
 15592*     end-if
 15593     .
 15594 2330-continue-change.
 15595
 15596
 15597* EXEC CICS READ
 15598*        DATASET (FILE-ID-ERPNDB)
 15599*        INTO    (PENDING-BUSINESS)
 15600*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15601*        UPDATE
 15602*    END-EXEC.
 15603     MOVE LENGTH OF
 15604      PENDING-BUSINESS
 15605       TO DFHEIV11
 15606*    MOVE '&"IL       EU         (   #00013914' TO DFHEIV0
 15607     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15608     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15609     MOVE X'2020233030303133393134' TO DFHEIV0(25:11)
 15610     CALL 'kxdfhei1' USING DFHEIV0,
 15611           FILE-ID-ERPNDB,
 15612           PENDING-BUSINESS,
 15613           DFHEIV11,
 15614           PI-PREV-CONTROL-PRIMARY,
 15615           DFHEIV99,
 15616           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 285
* EL6311.cbl
 15617           DFHEIV99
 15618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15619
 15620
 15621     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15622     MOVE 'B'                    TO JP-RECORD-TYPE
 15623     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15624     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15625
 15626     PERFORM 8400-LOG-JOURNAL-RECORD.
 15627
 15628     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15629          PB-CHG-COUNT NOT = ZEROS
 15630        IF (CREFND1L GREATER THAN ZEROS AND
 15631            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15632           OR
 15633           (CREFND2L GREATER THAN ZEROS AND
 15634            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15635            ADD +1                      TO PB-CHG-COUNT
 15636            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15637
 15638*    IF CMICRNOL  GREATER  ZEROS
 15639*        IF CMICRNOI  NUMERIC
 15640*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15641*            MOVE AL-UNNON       TO  CMICRNOA
 15642*        ELSE
 15643*            MOVE -1             TO  CMICRNOL
 15644*            MOVE AL-UNBON       TO  CMICRNOA
 15645*            MOVE ER-2701        TO  EMI-ERROR
 15646*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15647
 15648     IF CSUFIXL GREATER THAN ZEROS
 15649        MOVE CSUFIXI             TO PB-CERT-SFX.
 15650
 15651     IF CLSTNML GREATER THAN ZEROS
 15652         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15653
 15654     IF CCANREAL > ZEROS
 15655        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15656     END-IF
 15657     IF CPCYNL > ZEROS
 15658        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15659     END-IF
 15660     IF CCANDT1L    GREATER THAN ZEROS
 15661        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15662
 15663     IF CCANDT2L    GREATER THAN ZEROS
 15664        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15665
 15666     IF CMTHD1L    GREATER THAN +0
 15667        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15668
 15669     IF CMTHD2L    GREATER THAN +0
 15670        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15671
 15672     IF CREFND1L    GREATER THAN ZEROS
 15673        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15674        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 286
* EL6311.cbl
 15675        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15676        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15677
 15678     IF CREFND2L    GREATER THAN ZEROS
 15679        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15680        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15681        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15682        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15683
 15684     IF CLIVESL     GREATER THAN ZEROS
 15685        MOVE WS-CLIVES           TO PB-C-LIVES.
 15686
 15687     IF CPAYEEL     GREATER THAN ZEROS
 15688        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15689
 15690     IF CFORCEL     GREATER THAN ZEROS
 15691        MOVE CFORCEI             TO PB-FORCE-CODE.
 15692
 15693     IF CBILCDL     GREATER THAN ZEROS
 15694        MOVE CBILCDI             TO PB-RECORD-BILL.
 15695
 15696 2360-REWRITE-PB-RECORD.
 15697     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15698     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15699     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15700     MOVE 'C'                    TO JP-RECORD-TYPE.
 15701     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15702     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15703     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15704
 15705     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15706
 15707     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15708     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15709
 15710     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15711
 15712     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15713
 15714     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15715     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15716     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15717
 15718     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15719     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15720
 15721 2375-REWRITE-PENDING-BUSINESS.
 15722     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15723     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15724     MOVE 'C'                    TO JP-RECORD-TYPE.
 15725     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15726
 15727
 15728* EXEC CICS REWRITE
 15729*        DATASET (FILE-ID-ERPNDB)
 15730*        FROM    (PENDING-BUSINESS)
 15731*    END-EXEC.
 15732     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 287
* EL6311.cbl
 15733      PENDING-BUSINESS
 15734       TO DFHEIV11
 15735*    MOVE '&& L                  %   #00014027' TO DFHEIV0
 15736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15738     MOVE X'2020233030303134303237' TO DFHEIV0(25:11)
 15739     CALL 'kxdfhei1' USING DFHEIV0,
 15740           FILE-ID-ERPNDB,
 15741           PENDING-BUSINESS,
 15742           DFHEIV11,
 15743           DFHEIV99
 15744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15745
 15746
 15747     PERFORM 8400-LOG-JOURNAL-RECORD.
 15748
 15749******************************************************************
 15750*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15751******************************************************************
 15752
 15753     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15754     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15755     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15756     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15757
 15758
 15759* EXEC CICS READ
 15760*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15761*        DATASET (FILE-ID-ELCERT)
 15762*        RIDFLD  (ELCERT-KEY)
 15763*        RESP    (WS-RESPONSE)
 15764*    END-EXEC.
 15765*    MOVE '&"S        E          (  N#00014043' TO DFHEIV0
 15766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15768     MOVE X'204E233030303134303433' TO DFHEIV0(25:11)
 15769     CALL 'kxdfhei1' USING DFHEIV0,
 15770           FILE-ID-ELCERT,
 15771           DFHEIV20,
 15772           DFHEIV99,
 15773           ELCERT-KEY,
 15774           DFHEIV99,
 15775           DFHEIV99,
 15776           DFHEIV99
 15777     SET ADDRESS OF CERTIFICATE-MASTER TO
 15778         DFHEIV20
 15779     MOVE EIBRESP  TO WS-RESPONSE
 15780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15781
 15782
 15783     IF NOT RESP-NORMAL
 15784        GO TO 2376-BYPASS-CRTO
 15785     END-IF
 15786
 15787
 15788     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15789     MOVE ' '                    TO WS-ERMAIL-SW
 15790
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 288
* EL6311.cbl
 15791
 15792* EXEC CICS READ
 15793*       DATASET   (FILE-ID-ERMAIL)
 15794*       SET       (ADDRESS OF MAILING-DATA)
 15795*       RIDFLD    (ERMAIL-KEY)
 15796*       RESP      (WS-RESPONSE)
 15797*    END-EXEC
 15798*    MOVE '&"S        E          (  N#00014058' TO DFHEIV0
 15799     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15801     MOVE X'204E233030303134303538' TO DFHEIV0(25:11)
 15802     CALL 'kxdfhei1' USING DFHEIV0,
 15803           FILE-ID-ERMAIL,
 15804           DFHEIV20,
 15805           DFHEIV99,
 15806           ERMAIL-KEY,
 15807           DFHEIV99,
 15808           DFHEIV99,
 15809           DFHEIV99
 15810     SET ADDRESS OF MAILING-DATA TO
 15811         DFHEIV20
 15812     MOVE EIBRESP  TO WS-RESPONSE
 15813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15814
 15815     IF RESP-NORMAL
 15816        SET ERMAIL-FOUND TO TRUE
 15817     END-IF
 15818
 15819     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15820
 15821     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15822                                 TO ELCRTO-KEY
 15823     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15824     MOVE +0                     TO ELCRTO-SEQ-NO
 15825
 15826
 15827* EXEC CICS READ
 15828*       DATASET   ('ELCRTO')
 15829*       INTO      (ORIGINAL-CERTIFICATE)
 15830*       RIDFLD    (ELCRTO-KEY)
 15831*       GTEQ
 15832*       RESP      (WS-RESPONSE)
 15833*    END-EXEC
 15834     MOVE LENGTH OF
 15835      ORIGINAL-CERTIFICATE
 15836       TO DFHEIV11
 15837     MOVE 'ELCRTO' TO DFHEIV1
 15838*    MOVE '&"IL       G          (  N#00014076' TO DFHEIV0
 15839     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15841     MOVE X'204E233030303134303736' TO DFHEIV0(25:11)
 15842     CALL 'kxdfhei1' USING DFHEIV0,
 15843           DFHEIV1,
 15844           ORIGINAL-CERTIFICATE,
 15845           DFHEIV11,
 15846           ELCRTO-KEY,
 15847           DFHEIV99,
 15848           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 289
* EL6311.cbl
 15849           DFHEIV99
 15850     MOVE EIBRESP  TO WS-RESPONSE
 15851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15852
 15853     IF RESP-NORMAL
 15854        AND (OC-CONTROL-PRIMARY (1:33) =
 15855                 PB-CONTROL-BY-ACCOUNT (1:33))
 15856        AND (OC-RECORD-TYPE = 'I')
 15857        display ' resp norm, key =, type i '
 15858        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15859           display ' end proc blank '
 15860           display ' csr edit session ' PI-CSR-SESSION-SW
 15861           IF NOT CSR-EDIT-SESSION
 15862
 15863* EXEC CICS READ
 15864*                DATASET   ('ELCRTO')
 15865*                INTO      (ORIGINAL-CERTIFICATE)
 15866*                RIDFLD    (OC-CONTROL-PRIMARY)
 15867*                UPDATE
 15868*                RESP      (WS-RESPONSE)
 15869*             END-EXEC
 15870     MOVE LENGTH OF
 15871      ORIGINAL-CERTIFICATE
 15872       TO DFHEIV11
 15873     MOVE 'ELCRTO' TO DFHEIV1
 15874*    MOVE '&"IL       EU         (  N#00014093' TO DFHEIV0
 15875     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15876     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15877     MOVE X'204E233030303134303933' TO DFHEIV0(25:11)
 15878     CALL 'kxdfhei1' USING DFHEIV0,
 15879           DFHEIV1,
 15880           ORIGINAL-CERTIFICATE,
 15881           DFHEIV11,
 15882           OC-CONTROL-PRIMARY,
 15883           DFHEIV99,
 15884           DFHEIV99,
 15885           DFHEIV99
 15886     MOVE EIBRESP  TO WS-RESPONSE
 15887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15888              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15889              IF RESP-NORMAL
 15890                 display ' good read upd '
 15891                 IF OC-ISSUE-TRAN-IND = 'N'
 15892                    MOVE CM-INSURED-LAST-NAME   TO
 15893                         OC-INS-LAST-NAME
 15894                    MOVE CM-INSURED-FIRST-NAME  TO
 15895                         OC-INS-FIRST-NAME
 15896                    MOVE CM-INSURED-INITIAL2    TO
 15897                         OC-INS-MIDDLE-INIT
 15898                    MOVE CM-INSURED-ISSUE-AGE   TO
 15899                         OC-INS-AGE
 15900                    MOVE CM-JT-LAST-NAME        TO
 15901                         OC-JNT-LAST-NAME
 15902                    MOVE CM-JT-FIRST-NAME       TO
 15903                         OC-JNT-FIRST-NAME
 15904                    MOVE CM-JT-INITIAL          TO
 15905                         OC-JNT-MIDDLE-INIT
 15906                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 290
* EL6311.cbl
 15907                         OC-JNT-AGE
 15908                    MOVE CM-LF-BENEFIT-CD       TO
 15909                         OC-LF-BENCD
 15910                    MOVE CM-LF-ORIG-TERM        TO
 15911                         OC-LF-TERM
 15912                    MOVE CM-LF-BENEFIT-AMT      TO
 15913                         OC-LF-BEN-AMT
 15914                    MOVE CM-LF-PREMIUM-AMT      TO
 15915                         OC-LF-PRM-AMT
 15916                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15917                         OC-LF-ALT-BEN-AMT
 15918                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15919                         OC-LF-ALT-PRM-AMT
 15920                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15921                         OC-LF-EXP-DT
 15922                    MOVE CM-LIFE-COMM-PCT       TO
 15923                         OC-LF-COMM-PCT
 15924                    MOVE CM-AH-BENEFIT-CD       TO
 15925                         OC-AH-BENCD
 15926                    MOVE CM-AH-ORIG-TERM        TO
 15927                         OC-AH-TERM
 15928                    MOVE CM-AH-BENEFIT-AMT      TO
 15929                         OC-AH-BEN-AMT
 15930                    MOVE CM-AH-PREMIUM-AMT      TO
 15931                         OC-AH-PRM-AMT
 15932                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15933                         OC-AH-EXP-DT
 15934                    MOVE CM-AH-COMM-PCT         TO
 15935                         OC-AH-COMM-PCT
 15936                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15937                         OC-AH-CP
 15938                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15939                         OC-1ST-PMT-DT
 15940                 END-IF
 15941                 MOVE PB-C-LF-CANCEL-DT      TO
 15942                         OC-LF-CANCEL-DT
 15943                 MOVE PB-C-LF-CANCEL-AMT     TO
 15944                         OC-LF-CANCEL-AMT
 15945                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15946                         OC-LF-ITD-CANCEL-AMT
 15947                 MOVE PB-C-AH-CANCEL-DT      TO
 15948                         OC-AH-CANCEL-DT
 15949                 MOVE PB-C-AH-CANCEL-AMT     TO
 15950                         OC-AH-CANCEL-AMT
 15951                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15952                         OC-AH-ITD-CANCEL-AMT
 15953                 MOVE 'Y'                    TO
 15954                         OC-CANCEL-TRAN-IND
 15955                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15956                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15957                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15958                 IF ERMAIL-FOUND
 15959                    MOVE MA-CRED-BENE-NAME
 15960                                 TO OC-CRED-BENE-NAME
 15961                 END-IF
 15962                 IF NOT CERT-TRL-REC-NOT-FOUND
 15963                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15964                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 291
* EL6311.cbl
 15965                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15966                           OC-JNT-AGE-DEFAULT-FLAG
 15967                 END-IF
 15968
 15969* EXEC CICS REWRITE
 15970*                   DATASET   ('ELCRTO')
 15971*                   FROM      (ORIGINAL-CERTIFICATE)
 15972*                   RESP      (WS-RESPONSE)
 15973*                END-EXEC
 15974     MOVE LENGTH OF
 15975      ORIGINAL-CERTIFICATE
 15976       TO DFHEIV11
 15977     MOVE 'ELCRTO' TO DFHEIV1
 15978*    MOVE '&& L                  %  N#00014180' TO DFHEIV0
 15979     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15980     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15981     MOVE X'204E233030303134313830' TO DFHEIV0(25:11)
 15982     CALL 'kxdfhei1' USING DFHEIV0,
 15983           DFHEIV1,
 15984           ORIGINAL-CERTIFICATE,
 15985           DFHEIV11,
 15986           DFHEIV99
 15987     MOVE EIBRESP  TO WS-RESPONSE
 15988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15989                 display ' just rewrote ' ws-response
 15990              END-IF
 15991           END-IF
 15992        ELSE
 15993           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15994           MOVE 'OC'             TO OC-RECORD-ID
 15995           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15996           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15997           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15998           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15999           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16000           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16001           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16002           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16003           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16004           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16005           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16006           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16007           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16008           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16009           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16010           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16011           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16012           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16013           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16014           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16015           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16016           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16017           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16018           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16019           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16020           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16021           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16022           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 292
* EL6311.cbl
 16023           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16024           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16025           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16026           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16027           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16028           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16029           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16030           IF ERMAIL-FOUND
 16031              MOVE MA-CRED-BENE-NAME
 16032                                 TO OC-CRED-BENE-NAME
 16033           END-IF
 16034           IF NOT CERT-TRL-REC-NOT-FOUND
 16035              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16036                           OC-INS-AGE-DEFAULT-FLAG
 16037              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16038                           OC-JNT-AGE-DEFAULT-FLAG
 16039           END-IF
 16040           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 16041
 16042* EXEC CICS WRITE
 16043*             DATASET   ('ELCRTO')
 16044*             FROM      (ORIGINAL-CERTIFICATE)
 16045*             RIDFLD    (OC-CONTROL-PRIMARY)
 16046*             RESP      (WS-RESPONSE)
 16047*          END-EXEC
 16048     MOVE LENGTH OF
 16049      ORIGINAL-CERTIFICATE
 16050       TO DFHEIV11
 16051     MOVE 'ELCRTO' TO DFHEIV1
 16052*    MOVE '&$ L                  ''  N#00014237' TO DFHEIV0
 16053     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16054     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16055     MOVE X'204E233030303134323337' TO DFHEIV0(25:11)
 16056     CALL 'kxdfhei1' USING DFHEIV0,
 16057           DFHEIV1,
 16058           ORIGINAL-CERTIFICATE,
 16059           DFHEIV11,
 16060           OC-CONTROL-PRIMARY,
 16061           DFHEIV99,
 16062           DFHEIV99
 16063     MOVE EIBRESP  TO WS-RESPONSE
 16064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16065        END-IF
 16066     ELSE
 16067        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16068        MOVE 'OC'                TO OC-RECORD-ID
 16069        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16070                                 TO OC-CONTROL-PRIMARY (1:33)
 16071        MOVE 'I'                 TO OC-RECORD-TYPE
 16072        MOVE +4096               TO OC-KEY-SEQ-NO
 16073        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16074        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16075        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16076        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16077        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16078        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16079        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16080        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 293
* EL6311.cbl
 16081        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16082        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16083        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16084        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16085        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16086        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16087        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16088        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16089        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16090        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16091        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16092        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16093        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16094        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16095        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16096        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16097        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16098        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16099        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16100        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16101        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16102        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16103        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16104        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16105        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16106        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16107        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16108        IF ERMAIL-FOUND
 16109           MOVE MA-CRED-BENE-NAME
 16110                                 TO OC-CRED-BENE-NAME
 16111        END-IF
 16112        IF NOT CERT-TRL-REC-NOT-FOUND
 16113           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16114                           OC-INS-AGE-DEFAULT-FLAG
 16115           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16116                           OC-JNT-AGE-DEFAULT-FLAG
 16117        END-IF
 16118        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16119
 16120
 16121* EXEC CICS WRITE
 16122*          DATASET   ('ELCRTO')
 16123*          FROM      (ORIGINAL-CERTIFICATE)
 16124*          RIDFLD    (OC-CONTROL-PRIMARY)
 16125*          RESP      (WS-RESPONSE)
 16126*       END-EXEC
 16127     MOVE LENGTH OF
 16128      ORIGINAL-CERTIFICATE
 16129       TO DFHEIV11
 16130     MOVE 'ELCRTO' TO DFHEIV1
 16131*    MOVE '&$ L                  ''  N#00014298' TO DFHEIV0
 16132     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16133     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16134     MOVE X'204E233030303134323938' TO DFHEIV0(25:11)
 16135     CALL 'kxdfhei1' USING DFHEIV0,
 16136           DFHEIV1,
 16137           ORIGINAL-CERTIFICATE,
 16138           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 294
* EL6311.cbl
 16139           OC-CONTROL-PRIMARY,
 16140           DFHEIV99,
 16141           DFHEIV99
 16142     MOVE EIBRESP  TO WS-RESPONSE
 16143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16144     END-IF.
 16145
 16146 2376-BYPASS-CRTO.
 16147******************************************************************
 16148*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16149******************************************************************
 16150
 16151
 16152* EXEC CICS HANDLE CONDITION
 16153*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16154*    END-EXEC.
 16155*    MOVE '"$I                   ! 7 #00014311' TO DFHEIV0
 16156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16158     MOVE X'3720233030303134333131' TO DFHEIV0(25:11)
 16159     CALL 'kxdfhei1' USING DFHEIV0
 16160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16161
 16162
 16163
 16164* EXEC CICS READ
 16165*        INTO    (PENDING-BUSINESS)
 16166*        DATASET (FILE-ID-ERPNDB)
 16167*        RIDFLD  (ERPNDB-KEY)
 16168*        UPDATE
 16169*    END-EXEC.
 16170     MOVE LENGTH OF
 16171      PENDING-BUSINESS
 16172       TO DFHEIV11
 16173*    MOVE '&"IL       EU         (   #00014315' TO DFHEIV0
 16174     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16175     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16176     MOVE X'2020233030303134333135' TO DFHEIV0(25:11)
 16177     CALL 'kxdfhei1' USING DFHEIV0,
 16178           FILE-ID-ERPNDB,
 16179           PENDING-BUSINESS,
 16180           DFHEIV11,
 16181           ERPNDB-KEY,
 16182           DFHEIV99,
 16183           DFHEIV99,
 16184           DFHEIV99
 16185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16186
 16187
 16188     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16189     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16190     MOVE 'B'                    TO JP-RECORD-TYPE.
 16191     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16192
 16193     PERFORM 8400-LOG-JOURNAL-RECORD.
 16194
 16195     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16196
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 295
* EL6311.cbl
 16197
 16198* EXEC CICS REWRITE
 16199*        DATASET (FILE-ID-ERPNDB)
 16200*        FROM    (PENDING-BUSINESS)
 16201*    END-EXEC.
 16202     MOVE LENGTH OF
 16203      PENDING-BUSINESS
 16204       TO DFHEIV11
 16205*    MOVE '&& L                  %   #00014331' TO DFHEIV0
 16206     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16207     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16208     MOVE X'2020233030303134333331' TO DFHEIV0(25:11)
 16209     CALL 'kxdfhei1' USING DFHEIV0,
 16210           FILE-ID-ERPNDB,
 16211           PENDING-BUSINESS,
 16212           DFHEIV11,
 16213           DFHEIV99
 16214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16215
 16216
 16217     MOVE 'C'                    TO JP-RECORD-TYPE.
 16218     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16219
 16220     PERFORM 8400-LOG-JOURNAL-RECORD.
 16221
 16222     IF WS-ERRORS-PRESENT
 16223         GO TO 3900-RE-DISPLAY-RECORD.
 16224
 16225     MOVE ZEROS                  TO EMI-ERROR
 16226     MOVE -1                     TO CMAINTL
 16227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228     GO TO 3900-RE-DISPLAY-RECORD.
 16229
 16230 2380-BATCH-HDR-NOT-FOUND.
 16231     MOVE -1                     TO BMAINTL.
 16232     MOVE ER-7450                TO EMI-ERROR.
 16233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16234     GO TO 8200-SEND-DATAONLY.
 16235
 16236 2385-REC-NOT-FOUND.
 16237     MOVE -1                     TO BMAINTL.
 16238     MOVE ER-7451                TO EMI-ERROR.
 16239     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16240     GO TO 8200-SEND-DATAONLY.
 16241
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 296
* EL6311.cbl
 16243
 16244******************************************************************
 16245*                                                                *
 16246*          D E L E T E   C A N C E L   R O U T I N E             *
 16247*                                                                *
 16248******************************************************************
 16249
 16250 2400-DELETE-CANCEL-ROUTINE.
 16251     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16252
 16253     IF CCHGL NOT = ZEROS
 16254        MOVE ER-2196             TO EMI-ERROR
 16255        MOVE AL-UABON            TO CMAINTA
 16256        MOVE -1                  TO CMAINTL
 16257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16258        GO TO 8200-SEND-DATAONLY.
 16259
 16260
 16261* EXEC CICS HANDLE CONDITION
 16262*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16263*    END-EXEC.
 16264*    MOVE '"$I                   ! 8 #00014379' TO DFHEIV0
 16265     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16267     MOVE X'3820233030303134333739' TO DFHEIV0(25:11)
 16268     CALL 'kxdfhei1' USING DFHEIV0
 16269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16270
 16271
 16272     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16273     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16274     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16275
 16276
 16277* EXEC CICS READ
 16278*        SET     (ADDRESS OF PENDING-BUSINESS)
 16279*        DATASET (FILE-ID-ERPNDB)
 16280*        RIDFLD  (ERPNDB-KEY)
 16281*    END-EXEC.
 16282*    MOVE '&"S        E          (   #00014387' TO DFHEIV0
 16283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16285     MOVE X'2020233030303134333837' TO DFHEIV0(25:11)
 16286     CALL 'kxdfhei1' USING DFHEIV0,
 16287           FILE-ID-ERPNDB,
 16288           DFHEIV20,
 16289           DFHEIV99,
 16290           ERPNDB-KEY,
 16291           DFHEIV99,
 16292           DFHEIV99,
 16293           DFHEIV99
 16294     SET ADDRESS OF PENDING-BUSINESS TO
 16295         DFHEIV20
 16296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16297
 16298
 16299     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16300
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 297
* EL6311.cbl
 16301     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16302
 16303     IF CSUFIXL NOT = ZEROS
 16304        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16305     ELSE
 16306        MOVE SPACE               TO WS-NEW-SUFFIX.
 16307
 16308     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16309
 16310     PERFORM 8600-DEEDIT.
 16311     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16312     MOVE '4'                    TO DC-OPTION-CODE.
 16313     PERFORM 9700-DATE-LINK.
 16314
 16315     IF DATE-CONVERSION-ERROR
 16316        MOVE ER-0348             TO EMI-ERROR
 16317        MOVE -1                  TO CEFFDTL
 16318        MOVE AL-UABON            TO CEFFDTA
 16319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16320        GO TO 8200-SEND-DATAONLY
 16321     ELSE
 16322        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16323        MOVE AL-UANON            TO CEFFDTA
 16324        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16325
 16326
 16327* EXEC CICS HANDLE CONDITION
 16328*         NOTFND    (2490-RECORD-NOT-FOUND)
 16329*    END-EXEC.
 16330*    MOVE '"$I                   ! 9 #00014420' TO DFHEIV0
 16331     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16333     MOVE X'3920233030303134343230' TO DFHEIV0(25:11)
 16334     CALL 'kxdfhei1' USING DFHEIV0
 16335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16336
 16337
 16338
 16339* EXEC CICS READ
 16340*        SET     (ADDRESS OF PENDING-BUSINESS)
 16341*        DATASET (FILE-ID-ERPNDB)
 16342*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16343*        UPDATE
 16344*    END-EXEC.
 16345*    MOVE '&"S        EU         (   #00014424' TO DFHEIV0
 16346     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16348     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16349     CALL 'kxdfhei1' USING DFHEIV0,
 16350           FILE-ID-ERPNDB,
 16351           DFHEIV20,
 16352           DFHEIV99,
 16353           PI-PREV-CONTROL-PRIMARY,
 16354           DFHEIV99,
 16355           DFHEIV99,
 16356           DFHEIV99
 16357     SET ADDRESS OF PENDING-BUSINESS TO
 16358         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 298
* EL6311.cbl
 16359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16360
 16361
 16362     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16363        MOVE -1                 TO CMAINTL
 16364        MOVE ER-2197            TO EMI-ERROR
 16365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16366        GO TO 8200-SEND-DATAONLY.
 16367
 16368     IF PB-BILLED-DT NOT = LOW-VALUES
 16369        MOVE -1                 TO CMAINTL
 16370        MOVE ER-2129            TO EMI-ERROR
 16371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16372        GO TO 8200-SEND-DATAONLY.
 16373
 16374     IF PB-CHG-COUNT NOT = ZEROS
 16375        MOVE ER-2336            TO EMI-ERROR
 16376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16377        MOVE AL-UABON            TO CMAINTA
 16378        MOVE -1                  TO CMAINTL
 16379        GO TO 8200-SEND-DATAONLY.
 16380
 16381     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16382        PB-CHG-COUNT NOT = ZEROS
 16383        MOVE ER-2196             TO EMI-ERROR
 16384        MOVE AL-UABON            TO CMAINTA
 16385        MOVE -1                  TO CMAINTL
 16386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16387        GO TO 8200-SEND-DATAONLY.
 16388
 16389     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16390        MOVE ER-2900 TO EMI-ERROR
 16391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16392        MOVE AL-UABON         TO CMAINTA
 16393        MOVE -1               TO CMAINTL
 16394        GO TO 8200-SEND-DATAONLY.
 16395     move ' '                    to ws-stop-sw
 16396                                    ws-check-sw
 16397                                    ws-any-check-sw
 16398                                    ws-proc-check-sw
 16399                                    ws-chek-browse-sw
 16400
 16401     perform 2500-browse-checks  thru 2500-exit
 16402     if (i-have-processed-checks)
 16403        and (pb-c-refund-sw = 'Y')
 16404        move er-3446             to emi-error
 16405        perform 9900-error-format thru 9900-exit
 16406        move al-uabon            to cmainta
 16407        move -1                  to cmaintl
 16408        go to 8200-send-dataonly
 16409     end-if
 16410
 16411* EXEC CICS HANDLE CONDITION
 16412*         NOTFND  (2475-CONTINUE-DELETE)
 16413*    END-EXEC
 16414*    MOVE '"$I                   ! : #00014479' TO DFHEIV0
 16415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 299
* EL6311.cbl
 16417     MOVE X'3A20233030303134343739' TO DFHEIV0(25:11)
 16418     CALL 'kxdfhei1' USING DFHEIV0
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16420
 16421     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16422     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16423     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16424     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16425
 16426
 16427* EXEC CICS READ
 16428*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16429*        DATASET (FILE-ID-ELCERT)
 16430*        RIDFLD  (ELCERT-KEY)
 16431*        UPDATE
 16432*    END-EXEC.
 16433*    MOVE '&"S        EU         (   #00014488' TO DFHEIV0
 16434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16435     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16436     MOVE X'2020233030303134343838' TO DFHEIV0(25:11)
 16437     CALL 'kxdfhei1' USING DFHEIV0,
 16438           FILE-ID-ELCERT,
 16439           DFHEIV20,
 16440           DFHEIV99,
 16441           ELCERT-KEY,
 16442           DFHEIV99,
 16443           DFHEIV99,
 16444           DFHEIV99
 16445     SET ADDRESS OF CERTIFICATE-MASTER TO
 16446         DFHEIV20
 16447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16448
 16449
 16450     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16451
 16452     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16453     MOVE 'B'                    TO JP-RECORD-TYPE.
 16454     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16455     PERFORM 8400-LOG-JOURNAL-RECORD.
 16456
 16457     IF PB-CI-LIVES NOT NUMERIC
 16458         MOVE ZERO                    TO PB-CI-LIVES.
 16459
 16460     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16461        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16462           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16463           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16464           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16465                                            CM-LF-CANCEL-DT
 16466           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16467        ELSE
 16468           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16469           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16470           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16471           MOVE PB-CI-LIVES              TO CM-LIVES.
 16472
 16473     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16474        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 300
* EL6311.cbl
 16475           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16476               MOVE CM-LF-STATUS-AT-CANCEL
 16477                                        TO CM-LF-CURRENT-STATUS
 16478               MOVE SPACE
 16479                                        TO CM-LF-STATUS-AT-CANCEL
 16480           ELSE
 16481               MOVE PB-CI-LF-POLICY-STATUS
 16482                                        TO CM-LF-CURRENT-STATUS
 16483        ELSE
 16484           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16485
 16486
 16487     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16488        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16489           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16490           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16491           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16492                                            CM-AH-CANCEL-DT
 16493           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16494        ELSE
 16495           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16496           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16497           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16498           MOVE PB-CI-LIVES              TO CM-LIVES.
 16499
 16500     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16501        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16502           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16503               MOVE CM-AH-STATUS-AT-CANCEL
 16504                                        TO CM-AH-CURRENT-STATUS
 16505               MOVE SPACE
 16506                                        TO CM-AH-STATUS-AT-CANCEL
 16507           ELSE
 16508               MOVE PB-CI-AH-POLICY-STATUS
 16509                                        TO CM-AH-CURRENT-STATUS
 16510        ELSE
 16511           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16512
 16513 2450-REWRITE-CERT.
 16514     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16515     MOVE 'C'                      TO JP-RECORD-TYPE.
 16516     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16517
 16518
 16519* EXEC CICS REWRITE
 16520*        DATASET  (FILE-ID-ELCERT)
 16521*        FROM     (CERTIFICATE-MASTER)
 16522*    END-EXEC.
 16523     MOVE LENGTH OF
 16524      CERTIFICATE-MASTER
 16525       TO DFHEIV11
 16526*    MOVE '&& L                  %   #00014563' TO DFHEIV0
 16527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16529     MOVE X'2020233030303134353633' TO DFHEIV0(25:11)
 16530     CALL 'kxdfhei1' USING DFHEIV0,
 16531           FILE-ID-ELCERT,
 16532           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 301
* EL6311.cbl
 16533           DFHEIV11,
 16534           DFHEIV99
 16535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16536
 16537
 16538     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16539
 16540     PERFORM 8400-LOG-JOURNAL-RECORD.
 16541
 16542     move ' '                    to ws-stop-sw
 16543                                    ws-any-check-sw
 16544                                    ws-proc-check-sw
 16545                                    ws-chek-browse-sw
 16546
 16547     if i-have-checks
 16548        perform until i-say-stop
 16549           perform 2510-startbr-erchek
 16550                                 thru 2510-exit
 16551           if resp-normal
 16552              perform 2520-readnext-erchek
 16553                                 thru 2520-exit
 16554           end-if
 16555           if (not resp-normal)
 16556              or (pb-control-by-account (1:33) not =
 16557                 ch-control-primary (1:33))
 16558                 set i-say-stop to true
 16559           else
 16560              perform 2530-readupd-erchek
 16561                                 thru 2530-exit
 16562              if resp-normal
 16563                 perform 2540-delete-erchek
 16564                                 thru 2540-exit
 16565              end-if
 16566              if ws-chek-browse-sw = 'Y'
 16567                 perform 2525-endbr-erchek
 16568                                 thru 2525-exit
 16569                 move ' '        to ws-chek-browse-sw
 16570              end-if
 16571           end-if
 16572        end-perform
 16573     end-if
 16574
 16575     if ws-chek-browse-sw = 'Y'
 16576        perform 2525-endbr-erchek thru 2525-exit
 16577     end-if
 16578     .
 16579 2475-CONTINUE-DELETE.
 16580     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16581     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16582
 16583     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16584     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16585
 16586     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16587
 16588     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16589     MOVE 'D'                    TO JP-RECORD-TYPE
 16590     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 302
* EL6311.cbl
 16591
 16592
 16593* EXEC CICS DELETE
 16594*        DATASET    (FILE-ID-ERPNDB)
 16595*    END-EXEC.
 16596*    MOVE '&(                    &   #00014622' TO DFHEIV0
 16597     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16599     MOVE X'2020233030303134363232' TO DFHEIV0(25:11)
 16600     CALL 'kxdfhei1' USING DFHEIV0,
 16601           FILE-ID-ERPNDB,
 16602           DFHEIV99,
 16603           DFHEIV99,
 16604           DFHEIV99,
 16605           DFHEIV99
 16606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16607
 16608
 16609     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16610
 16611     PERFORM 8400-LOG-JOURNAL-RECORD.
 16612
 16613     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16614     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16615
 16616
 16617* EXEC CICS HANDLE CONDITION
 16618*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16619*    END-EXEC.
 16620*    MOVE '"$I                   ! ; #00014633' TO DFHEIV0
 16621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16623     MOVE X'3B20233030303134363333' TO DFHEIV0(25:11)
 16624     CALL 'kxdfhei1' USING DFHEIV0
 16625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16626
 16627
 16628
 16629* EXEC CICS READ
 16630*        SET     (ADDRESS OF PENDING-BUSINESS)
 16631*        DATASET (FILE-ID-ERPNDB)
 16632*        RIDFLD  (ERPNDB-KEY)
 16633*        UPDATE
 16634*    END-EXEC.
 16635*    MOVE '&"S        EU         (   #00014637' TO DFHEIV0
 16636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16637     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16638     MOVE X'2020233030303134363337' TO DFHEIV0(25:11)
 16639     CALL 'kxdfhei1' USING DFHEIV0,
 16640           FILE-ID-ERPNDB,
 16641           DFHEIV20,
 16642           DFHEIV99,
 16643           ERPNDB-KEY,
 16644           DFHEIV99,
 16645           DFHEIV99,
 16646           DFHEIV99
 16647     SET ADDRESS OF PENDING-BUSINESS TO
 16648         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 303
* EL6311.cbl
 16649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16650
 16651
 16652     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16653     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16654
 16655     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16656        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16657        MOVE 'D'                 TO JP-RECORD-TYPE
 16658        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16659
 16660* EXEC CICS DELETE
 16661*            DATASET    (FILE-ID-ERPNDB)
 16662*       END-EXEC
 16663*    MOVE '&(                    &   #00014651' TO DFHEIV0
 16664     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16666     MOVE X'2020233030303134363531' TO DFHEIV0(25:11)
 16667     CALL 'kxdfhei1' USING DFHEIV0,
 16668           FILE-ID-ERPNDB,
 16669           DFHEIV99,
 16670           DFHEIV99,
 16671           DFHEIV99,
 16672           DFHEIV99
 16673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16674        PERFORM 8400-LOG-JOURNAL-RECORD
 16675     ELSE
 16676        MOVE 'B'                 TO JP-RECORD-TYPE
 16677        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16678        PERFORM 8400-LOG-JOURNAL-RECORD
 16679        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16680        MOVE 'C'                 TO JP-RECORD-TYPE
 16681        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16682
 16683* EXEC CICS REWRITE
 16684*            DATASET    (FILE-ID-ERPNDB)
 16685*            FROM       (PENDING-BUSINESS)
 16686*       END-EXEC
 16687     MOVE LENGTH OF
 16688      PENDING-BUSINESS
 16689       TO DFHEIV11
 16690*    MOVE '&& L                  %   #00014662' TO DFHEIV0
 16691     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16692     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16693     MOVE X'2020233030303134363632' TO DFHEIV0(25:11)
 16694     CALL 'kxdfhei1' USING DFHEIV0,
 16695           FILE-ID-ERPNDB,
 16696           PENDING-BUSINESS,
 16697           DFHEIV11,
 16698           DFHEIV99
 16699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16700        PERFORM 8400-LOG-JOURNAL-RECORD.
 16701
 16702******************************************************************
 16703*                                                                *
 16704*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16705*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16706*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 304
* EL6311.cbl
 16707******************************************************************
 16708
 16709     IF NOT PI-AR-PROCESSING
 16710        GO TO 2480-DELETE-FINISHED.
 16711
 16712     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16713        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16714        NEXT SENTENCE
 16715     ELSE
 16716        GO TO 2480-DELETE-FINISHED.
 16717
 16718
 16719* EXEC CICS HANDLE CONDITION
 16720*         NOTFND    (2480-DELETE-FINISHED)
 16721*    END-EXEC.
 16722*    MOVE '"$I                   ! < #00014684' TO DFHEIV0
 16723     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16725     MOVE X'3C20233030303134363834' TO DFHEIV0(25:11)
 16726     CALL 'kxdfhei1' USING DFHEIV0
 16727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16728
 16729
 16730     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16731     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16732
 16733
 16734* EXEC CICS READ
 16735*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16736*        DATASET (FILE-ID-ERRQST)
 16737*        RIDFLD  (ERRQST-KEY)
 16738*        UPDATE
 16739*    END-EXEC.
 16740*    MOVE '&"S        EU         (   #00014691' TO DFHEIV0
 16741     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16742     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16743     MOVE X'2020233030303134363931' TO DFHEIV0(25:11)
 16744     CALL 'kxdfhei1' USING DFHEIV0,
 16745           FILE-ID-ERRQST,
 16746           DFHEIV20,
 16747           DFHEIV99,
 16748           ERRQST-KEY,
 16749           DFHEIV99,
 16750           DFHEIV99,
 16751           DFHEIV99
 16752     SET ADDRESS OF AR-REQUEST-RECORD TO
 16753         DFHEIV20
 16754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16755
 16756
 16757     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16758
 16759     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16760
 16761     MOVE 'D'                      TO JP-RECORD-TYPE.
 16762     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16763
 16764
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 305
* EL6311.cbl
 16765* EXEC CICS DELETE
 16766*         DATASET    (FILE-ID-ERRQST)
 16767*    END-EXEC.
 16768*    MOVE '&(                    &   #00014705' TO DFHEIV0
 16769     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16770     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16771     MOVE X'2020233030303134373035' TO DFHEIV0(25:11)
 16772     CALL 'kxdfhei1' USING DFHEIV0,
 16773           FILE-ID-ERRQST,
 16774           DFHEIV99,
 16775           DFHEIV99,
 16776           DFHEIV99,
 16777           DFHEIV99
 16778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16779
 16780
 16781     PERFORM 8400-LOG-JOURNAL-RECORD.
 16782
 16783 2480-DELETE-FINISHED.
 16784     MOVE ZEROS                  TO EMI-ERROR.
 16785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16786     MOVE LOW-VALUES             TO EL631CI.
 16787     MOVE -1                     TO CMAINTL.
 16788     GO TO 8100-SEND-INITIAL-MAP.
 16789
 16790 2485-BATCH-HDR-NOT-FOUND.
 16791     MOVE -1                     TO CMAINTL
 16792     MOVE AL-UABON               TO CMAINTA.
 16793     MOVE ER-7450                TO EMI-ERROR.
 16794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16795     GO TO 8200-SEND-DATAONLY.
 16796
 16797 2490-RECORD-NOT-FOUND.
 16798     MOVE -1                     TO CMAINTL
 16799     MOVE AL-UABON               TO CMAINTA.
 16800     MOVE ER-7451                TO EMI-ERROR.
 16801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16802     GO TO 8200-SEND-DATAONLY.
 16803***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16804***                                                            ***
 16805***     2500  B R O W S E   C H E C K S                        ***
 16806***  We perform this routine from 2 different places.          ***
 16807***  1. If the user changes the refund amount on a cancel, we  ***
 16808***    want to.........                                        ***
 16809***    a. determine if prior checks have been processed        ***
 16810***    b. If the amt is larger, display message instructing    ***
 16811***     them to create another check to make up the difference.***
 16812***    c. If the amt is less, do not allow the change and      ***
 16813***     display a FATAL error suggesting they deal with check  ***
 16814***     records befor continuing.                              ***
 16815***  2. If the user wants to delete a cancel record we......   ***
 16816***    a. browse through all the checks and if there is a      ***
 16817***     processed check, send FATAL message.                   ***
 16818***    b. If there is a non-released check, then delete that   ***
 16819***     check after you delete the pending cancel record.      ***
 16820***                                                            ***
 16821***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16822
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 306
* EL6311.cbl
 16823 2500-browse-checks.
 16824
 16825     perform 2510-startbr-erchek thru 2510-exit
 16826
 16827     if not resp-normal
 16828        go to 2500-exit
 16829     end-if
 16830
 16831     perform until i-say-stop
 16832        perform 2520-readnext-erchek
 16833                                 thru 2520-exit
 16834        if (not resp-normal)
 16835           or (pb-control-by-account (1:33) not =
 16836              ch-control-primary (1:33))
 16837              set i-say-stop to true
 16838        else
 16839           set i-have-a-check-period to true
 16840           if (ch-approval-status) = ' '
 16841              and (ch-void-dt = low-values)
 16842              and (ch-released-dt = low-values)
 16843              set i-have-checks to true
 16844           else
 16845              if ch-void-dt = low-values
 16846                 set i-have-processed-checks to true
 16847              end-if
 16848           end-if
 16849           if (ch-credit-accept-dt = low-values)
 16850              and (ch-void-dt = low-values)
 16851              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16852              if (ch-check-origin-sw not = 'R')
 16853                 and (pb-record-type = '2')
 16854                 continue
 16855              else
 16856                 compute ws-check-amts =
 16857                    ws-check-amts + ch-amount-paid
 16858              end-if
 16859           end-if
 16860        end-if
 16861     end-perform
 16862
 16863     if ws-chek-browse-sw = 'Y'
 16864        perform 2525-endbr-erchek thru 2525-exit
 16865     end-if
 16866
 16867    .
 16868 2500-exit.
 16869     exit.
 16870
 16871 2510-startbr-erchek.
 16872
 16873     move pb-control-by-account  to erchek-key
 16874     move +0                     to chek-record-seq
 16875
 16876
 16877* exec cics startbr
 16878*       dataset   ('ERCHEK')
 16879*       ridfld    (erchek-key)
 16880*       gteq
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 307
* EL6311.cbl
 16881*       resp      (ws-response)
 16882*    end-exec
 16883     MOVE 'ERCHEK' TO DFHEIV1
 16884     MOVE 0
 16885       TO DFHEIV11
 16886*    MOVE '&,         G          &  N#00014804' TO DFHEIV0
 16887     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16889     MOVE X'204E233030303134383034' TO DFHEIV0(25:11)
 16890     CALL 'kxdfhei1' USING DFHEIV0,
 16891           DFHEIV1,
 16892           erchek-key,
 16893           DFHEIV99,
 16894           DFHEIV11,
 16895           DFHEIV99
 16896     MOVE EIBRESP  TO ws-response
 16897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16898
 16899     IF RESP-NORMAL
 16900        move 'Y'                 to ws-chek-browse-sw
 16901     end-if
 16902
 16903     .
 16904 2510-exit.
 16905     exit.
 16906
 16907 2520-readnext-erchek.
 16908
 16909
 16910* EXEC CICS READNEXT
 16911*       SET     (ADDRESS OF CHECK-RECORDS)
 16912*       DATASET ('ERCHEK')
 16913*       RIDFLD  (ERCHEK-KEY)
 16914*       RESP    (WS-RESPONSE)
 16915*    END-EXEC
 16916     MOVE 'ERCHEK' TO DFHEIV1
 16917     MOVE 0
 16918       TO DFHEIV11
 16919*    MOVE '&.S                   )  N#00014821' TO DFHEIV0
 16920     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16921     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16922     MOVE X'204E233030303134383231' TO DFHEIV0(25:11)
 16923     CALL 'kxdfhei1' USING DFHEIV0,
 16924           DFHEIV1,
 16925           DFHEIV20,
 16926           DFHEIV99,
 16927           ERCHEK-KEY,
 16928           DFHEIV99,
 16929           DFHEIV11,
 16930           DFHEIV99,
 16931           DFHEIV99
 16932     SET ADDRESS OF CHECK-RECORDS TO
 16933         DFHEIV20
 16934     MOVE EIBRESP  TO WS-RESPONSE
 16935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16936
 16937     .
 16938 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 308
* EL6311.cbl
 16939     exit.
 16940
 16941 2525-endbr-erchek.
 16942
 16943
 16944* exec cics endbr
 16945*       dataset  ('ERCHEK')
 16946*    end-exec
 16947     MOVE 'ERCHEK' TO DFHEIV1
 16948     MOVE 0
 16949       TO DFHEIV11
 16950*    MOVE '&2                    $   #00014834' TO DFHEIV0
 16951     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16952     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16953     MOVE X'2020233030303134383334' TO DFHEIV0(25:11)
 16954     CALL 'kxdfhei1' USING DFHEIV0,
 16955           DFHEIV1,
 16956           DFHEIV11,
 16957           DFHEIV99
 16958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16959
 16960     .
 16961 2525-exit.
 16962     exit.
 16963
 16964 2530-readupd-erchek.
 16965
 16966
 16967* EXEC CICS READ
 16968*       UPDATE
 16969*       SET     (ADDRESS OF CHECK-RECORDS)
 16970*       DATASET ('ERCHEK')
 16971*       RIDFLD  (ERCHEK-KEY)
 16972*       RESP    (WS-RESPONSE)
 16973*    END-EXEC
 16974     MOVE 'ERCHEK' TO DFHEIV1
 16975*    MOVE '&"S        EU         (  N#00014844' TO DFHEIV0
 16976     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16978     MOVE X'204E233030303134383434' TO DFHEIV0(25:11)
 16979     CALL 'kxdfhei1' USING DFHEIV0,
 16980           DFHEIV1,
 16981           DFHEIV20,
 16982           DFHEIV99,
 16983           ERCHEK-KEY,
 16984           DFHEIV99,
 16985           DFHEIV99,
 16986           DFHEIV99
 16987     SET ADDRESS OF CHECK-RECORDS TO
 16988         DFHEIV20
 16989     MOVE EIBRESP  TO WS-RESPONSE
 16990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16991
 16992     .
 16993 2530-exit.
 16994     exit.
 16995
 16996 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 309
* EL6311.cbl
 16997
 16998
 16999* EXEC CICS DELETE
 17000*       DATASET ('ERCHEK')
 17001*       RESP    (WS-RESPONSE)
 17002*    END-EXEC
 17003     MOVE 'ERCHEK' TO DFHEIV1
 17004*    MOVE '&(                    &  N#00014858' TO DFHEIV0
 17005     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17007     MOVE X'204E233030303134383538' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0,
 17009           DFHEIV1,
 17010           DFHEIV99,
 17011           DFHEIV99,
 17012           DFHEIV99,
 17013           DFHEIV99
 17014     MOVE EIBRESP  TO WS-RESPONSE
 17015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17016
 17017     .
 17018 2540-exit.
 17019     exit.
 17020***************************************************************
 17021*                                                             *
 17022*       B U I L D   C O R R E C T I O N   R E C O R D         *
 17023*                                                             *
 17024***************************************************************
 17025
 17026***************************************************************
 17027*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 17028*     AN ALREADY BILLED RECORD.                               *
 17029***************************************************************
 17030
 17031 2700-BUILD-CORRECTION-RECORD.
 17032     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17033     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17034     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17035     MOVE '5'                    TO DC-OPTION-CODE.
 17036     PERFORM 9700-DATE-LINK.
 17037     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17038
 17039     IF PB-CHG-COUNT = ZEROS
 17040        MOVE +1                  TO WS-SEQ-SAVE
 17041     ELSE
 17042        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 17043
 17044     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17045     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17046
 17047     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17048
 17049     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17050     MOVE 'A'                    TO JP-RECORD-TYPE.
 17051     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17052
 17053
 17054* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 310
* EL6311.cbl
 17055*        DATASET    (FILE-ID-ERPNDB)
 17056*        FROM       (PENDING-BUSINESS)
 17057*        RIDFLD     (PB-CONTROL-PRIMARY)
 17058*    END-EXEC.
 17059     MOVE LENGTH OF
 17060      PENDING-BUSINESS
 17061       TO DFHEIV11
 17062*    MOVE '&$ L                  ''   #00014899' TO DFHEIV0
 17063     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17064     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17065     MOVE X'2020233030303134383939' TO DFHEIV0(25:11)
 17066     CALL 'kxdfhei1' USING DFHEIV0,
 17067           FILE-ID-ERPNDB,
 17068           PENDING-BUSINESS,
 17069           DFHEIV11,
 17070           PB-CONTROL-PRIMARY,
 17071           DFHEIV99,
 17072           DFHEIV99
 17073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17074
 17075
 17076     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17077
 17078     PERFORM 8400-LOG-JOURNAL-RECORD.
 17079
 17080 2799-EXIT.
 17081      EXIT.
 17082
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 311
* EL6311.cbl
 17084
 17085******************************************************************
 17086*                                                                *
 17087*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17088*                                                                *
 17089******************************************************************
 17090
 17091 2800-REWRITE-ISSUE-CERT-KEY.
 17092     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17093
 17094     IF  BCERTNOL GREATER THAN ZEROS
 17095         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17096
 17097     IF  BSUFIXL  GREATER THAN ZEROS
 17098         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17099
 17100     IF  BEFFDTL  GREATER THAN ZEROS
 17101         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17102
 17103 2810-READ-BY-ACCOUNT.
 17104
 17105* EXEC CICS HANDLE CONDITION
 17106*         NOTFND    (2820-PROCESS-REWRITE)
 17107*    END-EXEC.
 17108*    MOVE '"$I                   ! = #00014933' TO DFHEIV0
 17109     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17111     MOVE X'3D20233030303134393333' TO DFHEIV0(25:11)
 17112     CALL 'kxdfhei1' USING DFHEIV0
 17113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17114
 17115
 17116***  read pndb using new key
 17117
 17118* EXEC CICS READ
 17119*        SET     (ADDRESS OF PENDING-BUSINESS)
 17120*        DATASET (FILE-ID-ERPNDB2)
 17121*        RIDFLD  (ERPNDB-ALT-KEY)
 17122*    END-EXEC.
 17123*    MOVE '&"S        E          (   #00014938' TO DFHEIV0
 17124     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17126     MOVE X'2020233030303134393338' TO DFHEIV0(25:11)
 17127     CALL 'kxdfhei1' USING DFHEIV0,
 17128           FILE-ID-ERPNDB2,
 17129           DFHEIV20,
 17130           DFHEIV99,
 17131           ERPNDB-ALT-KEY,
 17132           DFHEIV99,
 17133           DFHEIV99,
 17134           DFHEIV99
 17135     SET ADDRESS OF PENDING-BUSINESS TO
 17136         DFHEIV20
 17137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17138
 17139
 17140     GO TO 2890-DUPLICATE-RECORD.
 17141
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 312
* EL6311.cbl
 17142  2820-PROCESS-REWRITE.
 17143
 17144* EXEC CICS HANDLE CONDITION
 17145*         NOTFND    (2885-RECORD-MISSING)
 17146*    END-EXEC.
 17147*    MOVE '"$I                   ! > #00014947' TO DFHEIV0
 17148     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17150     MOVE X'3E20233030303134393437' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0
 17152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17153
 17154
 17155     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17156
 17157***  read pndb using original key
 17158
 17159* EXEC CICS READ
 17160*        SET     (ADDRESS OF PENDING-BUSINESS)
 17161*        DATASET (FILE-ID-ERPNDB)
 17162*        RIDFLD  (ERPNDB-KEY)
 17163*        UPDATE
 17164*    END-EXEC.
 17165*    MOVE '&"S        EU         (   #00014954' TO DFHEIV0
 17166     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17167     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17168     MOVE X'2020233030303134393534' TO DFHEIV0(25:11)
 17169     CALL 'kxdfhei1' USING DFHEIV0,
 17170           FILE-ID-ERPNDB,
 17171           DFHEIV20,
 17172           DFHEIV99,
 17173           ERPNDB-KEY,
 17174           DFHEIV99,
 17175           DFHEIV99,
 17176           DFHEIV99
 17177     SET ADDRESS OF PENDING-BUSINESS TO
 17178         DFHEIV20
 17179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17180
 17181
 17182     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17183     MOVE 'D'                    TO JP-RECORD-TYPE.
 17184     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17185     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17186
 17187     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17188
 17189     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17190     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17191     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17192
 17193***  delete pndb using original key
 17194
 17195* EXEC CICS DELETE
 17196*        DATASET    (FILE-ID-ERPNDB)
 17197*    END-EXEC.
 17198*    MOVE '&(                    &   #00014973' TO DFHEIV0
 17199     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 313
* EL6311.cbl
 17200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17201     MOVE X'2020233030303134393733' TO DFHEIV0(25:11)
 17202     CALL 'kxdfhei1' USING DFHEIV0,
 17203           FILE-ID-ERPNDB,
 17204           DFHEIV99,
 17205           DFHEIV99,
 17206           DFHEIV99,
 17207           DFHEIV99
 17208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17209
 17210
 17211     PERFORM 8400-LOG-JOURNAL-RECORD.
 17212
 17213
 17214* EXEC CICS GETMAIN
 17215*        SET      (ADDRESS OF PENDING-BUSINESS)
 17216*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17217*        INITIMG  (GETMAIN-SPACE)
 17218*    END-EXEC.
 17219*    MOVE ',"IL                  $   #00014979' TO DFHEIV0
 17220     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17222     MOVE X'2020233030303134393739' TO DFHEIV0(25:11)
 17223     CALL 'kxdfhei1' USING DFHEIV0,
 17224           DFHEIV20,
 17225           ERPNDB-RECORD-LENGTH,
 17226           GETMAIN-SPACE
 17227     SET ADDRESS OF PENDING-BUSINESS TO
 17228         DFHEIV20
 17229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17230
 17231
 17232***  pending-business now has original record
 17233     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17234
 17235
 17236* EXEC CICS HANDLE CONDITION
 17237*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17238*    END-EXEC.
 17239*    MOVE '"$I                   ! ? #00014988' TO DFHEIV0
 17240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17242     MOVE X'3F20233030303134393838' TO DFHEIV0(25:11)
 17243     CALL 'kxdfhei1' USING DFHEIV0
 17244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17245
 17246
 17247***  read elcert using original key
 17248
 17249* EXEC CICS READ
 17250*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17251*        DATASET (FILE-ID-ELCERT)
 17252*        RIDFLD  (ELCERT-KEY)
 17253*        UPDATE
 17254*    END-EXEC.
 17255*    MOVE '&"S        EU         (   #00014993' TO DFHEIV0
 17256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 314
* EL6311.cbl
 17258     MOVE X'2020233030303134393933' TO DFHEIV0(25:11)
 17259     CALL 'kxdfhei1' USING DFHEIV0,
 17260           FILE-ID-ELCERT,
 17261           DFHEIV20,
 17262           DFHEIV99,
 17263           ELCERT-KEY,
 17264           DFHEIV99,
 17265           DFHEIV99,
 17266           DFHEIV99
 17267     SET ADDRESS OF CERTIFICATE-MASTER TO
 17268         DFHEIV20
 17269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17270
 17271
 17272     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17273     MOVE 'B'                    TO JP-RECORD-TYPE
 17274     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17275     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17276
 17277     IF INSURED-ADDR-PRESENT
 17278        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17279
 17280     IF CERT-NOTES-ARE-NOT-PRESENT
 17281        MOVE SPACE               TO WS-CERT-NOTE-SW
 17282     ELSE
 17283        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17284
 17285     IF CERT-ADDED-BATCH      OR
 17286        CERT-AND-CLAIM-ONLINE OR
 17287        CERT-WAS-CREATED-FOR-CLAIM
 17288        NEXT SENTENCE
 17289     ELSE
 17290        GO TO 2825-DELETE-CERTIFICATE.
 17291
 17292     PERFORM 8400-LOG-JOURNAL-RECORD.
 17293
 17294*********************************************************
 17295** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17296     IF CERT-ADDED-BATCH
 17297         GO TO 2822-REWRITE-ELCERT.
 17298*********************************************************
 17299
 17300     IF NO-CLAIM-ATTACHED
 17301        NEXT SENTENCE
 17302     ELSE
 17303        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17304        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17305
 17306 2822-REWRITE-ELCERT.
 17307     MOVE 'C'                    TO JP-RECORD-TYPE
 17308     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17309
 17310     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17311
 17312
 17313* EXEC CICS REWRITE
 17314*         DATASET    (FILE-ID-ELCERT)
 17315*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 315
* EL6311.cbl
 17316*    END-EXEC.
 17317     MOVE LENGTH OF
 17318      CERTIFICATE-MASTER
 17319       TO DFHEIV11
 17320*    MOVE '&& L                  %   #00015040' TO DFHEIV0
 17321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17323     MOVE X'2020233030303135303430' TO DFHEIV0(25:11)
 17324     CALL 'kxdfhei1' USING DFHEIV0,
 17325           FILE-ID-ELCERT,
 17326           CERTIFICATE-MASTER,
 17327           DFHEIV11,
 17328           DFHEIV99
 17329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17330
 17331
 17332     PERFORM 8400-LOG-JOURNAL-RECORD.
 17333
 17334     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17335
 17336 2825-DELETE-CERTIFICATE.
 17337     MOVE 'D'                      TO JP-RECORD-TYPE.
 17338     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17339
 17340     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17341
 17342
 17343* EXEC CICS DELETE
 17344*         DATASET    (FILE-ID-ELCERT)
 17345*    END-EXEC.
 17346*    MOVE '&(                    &   #00015055' TO DFHEIV0
 17347     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17349     MOVE X'2020233030303135303535' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0,
 17351           FILE-ID-ELCERT,
 17352           DFHEIV99,
 17353           DFHEIV99,
 17354           DFHEIV99,
 17355           DFHEIV99
 17356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17357
 17358
 17359     PERFORM 8400-LOG-JOURNAL-RECORD.
 17360
 17361******************************************************************
 17362*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17363******************************************************************
 17364
 17365     IF CERT-NOTES-ARE-PRESENT
 17366        NEXT SENTENCE
 17367     ELSE
 17368        GO TO 2827-DELETE-MAILING.
 17369
 17370
 17371* EXEC CICS HANDLE CONDITION
 17372*         NOTFND  (2827-DELETE-MAILING)
 17373*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 316
* EL6311.cbl
 17374*    MOVE '"$I                   ! @ #00015070' TO DFHEIV0
 17375     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17376     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17377     MOVE X'4020233030303135303730' TO DFHEIV0(25:11)
 17378     CALL 'kxdfhei1' USING DFHEIV0
 17379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17380
 17381
 17382
 17383* EXEC CICS READ
 17384*        EQUAL
 17385*        DATASET   (FILE-ID-ERNOTE)
 17386*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17387*        RIDFLD    (ELCERT-KEY)
 17388*        UPDATE
 17389*    END-EXEC.
 17390*    MOVE '&"S        EU         (   #00015074' TO DFHEIV0
 17391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17392     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17393     MOVE X'2020233030303135303734' TO DFHEIV0(25:11)
 17394     CALL 'kxdfhei1' USING DFHEIV0,
 17395           FILE-ID-ERNOTE,
 17396           DFHEIV20,
 17397           DFHEIV99,
 17398           ELCERT-KEY,
 17399           DFHEIV99,
 17400           DFHEIV99,
 17401           DFHEIV99
 17402     SET ADDRESS OF CERTIFICATE-NOTE TO
 17403         DFHEIV20
 17404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17405
 17406
 17407     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17408     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17409     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17410
 17411     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17412
 17413
 17414* EXEC CICS DELETE
 17415*        DATASET   (FILE-ID-ERNOTE)
 17416*    END-EXEC.
 17417*    MOVE '&(                    &   #00015088' TO DFHEIV0
 17418     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17419     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17420     MOVE X'2020233030303135303838' TO DFHEIV0(25:11)
 17421     CALL 'kxdfhei1' USING DFHEIV0,
 17422           FILE-ID-ERNOTE,
 17423           DFHEIV99,
 17424           DFHEIV99,
 17425           DFHEIV99,
 17426           DFHEIV99
 17427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17428
 17429
 17430     PERFORM 8400-LOG-JOURNAL-RECORD.
 17431
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 317
* EL6311.cbl
 17432******************************************************************
 17433*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17434******************************************************************
 17435
 17436 2827-DELETE-MAILING.
 17437     IF CERT-ADDRESS-PRESENT
 17438        NEXT SENTENCE
 17439     ELSE
 17440        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17441
 17442
 17443* EXEC CICS HANDLE CONDITION
 17444*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17445*    END-EXEC.
 17446*    MOVE '"$I                   ! A #00015104' TO DFHEIV0
 17447     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17449     MOVE X'4120233030303135313034' TO DFHEIV0(25:11)
 17450     CALL 'kxdfhei1' USING DFHEIV0
 17451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17452
 17453
 17454     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17455
 17456
 17457* EXEC CICS READ
 17458*        EQUAL
 17459*        DATASET   (FILE-ID-ERMAIL)
 17460*        SET       (ADDRESS OF MAILING-DATA)
 17461*        RIDFLD    (ERMAIL-KEY)
 17462*        UPDATE
 17463*    END-EXEC.
 17464*    MOVE '&"S        EU         (   #00015110' TO DFHEIV0
 17465     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17466     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17467     MOVE X'2020233030303135313130' TO DFHEIV0(25:11)
 17468     CALL 'kxdfhei1' USING DFHEIV0,
 17469           FILE-ID-ERMAIL,
 17470           DFHEIV20,
 17471           DFHEIV99,
 17472           ERMAIL-KEY,
 17473           DFHEIV99,
 17474           DFHEIV99,
 17475           DFHEIV99
 17476     SET ADDRESS OF MAILING-DATA TO
 17477         DFHEIV20
 17478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17479
 17480
 17481     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17482     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17483     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17484
 17485     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17486
 17487
 17488* EXEC CICS DELETE
 17489*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 318
* EL6311.cbl
 17490*    END-EXEC.
 17491*    MOVE '&(                    &   #00015124' TO DFHEIV0
 17492     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17494     MOVE X'2020233030303135313234' TO DFHEIV0(25:11)
 17495     CALL 'kxdfhei1' USING DFHEIV0,
 17496           FILE-ID-ERMAIL,
 17497           DFHEIV99,
 17498           DFHEIV99,
 17499           DFHEIV99,
 17500           DFHEIV99
 17501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17502
 17503
 17504     PERFORM 8400-LOG-JOURNAL-RECORD.
 17505
 17506 2830-BUILD-NEW-ISSUE-RECORD.
 17507     MOVE SPACES                 TO ELCERT-KEY.
 17508
 17509     IF  BCERTNOL GREATER THAN ZEROS
 17510         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17511
 17512     IF  BSUFIXL  GREATER THAN ZEROS
 17513         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17514
 17515     IF BEFFDTL GREATER THAN ZEROS
 17516        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17517
 17518 2870-WRITE-PENDING-BUSINESS.
 17519     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17520     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17521     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17522     MOVE '5'                    TO DC-OPTION-CODE.
 17523     PERFORM 9700-DATE-LINK.
 17524     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17525
 17526     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17527
 17528     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17529     MOVE 'A'                    TO JP-RECORD-TYPE.
 17530     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17531
 17532
 17533* EXEC CICS WRITE
 17534*        DATASET  (FILE-ID-ERPNDB)
 17535*        FROM     (PENDING-BUSINESS)
 17536*        RIDFLD   (PB-CONTROL-PRIMARY)
 17537*    END-EXEC.
 17538     MOVE LENGTH OF
 17539      PENDING-BUSINESS
 17540       TO DFHEIV11
 17541*    MOVE '&$ L                  ''   #00015156' TO DFHEIV0
 17542     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17543     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17544     MOVE X'2020233030303135313536' TO DFHEIV0(25:11)
 17545     CALL 'kxdfhei1' USING DFHEIV0,
 17546           FILE-ID-ERPNDB,
 17547           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 319
* EL6311.cbl
 17548           DFHEIV11,
 17549           PB-CONTROL-PRIMARY,
 17550           DFHEIV99,
 17551           DFHEIV99
 17552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17553
 17554
 17555     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17556
 17557     PERFORM 8400-LOG-JOURNAL-RECORD.
 17558
 17559     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17560
 17561 2885-RECORD-MISSING.
 17562     MOVE -1                     TO BMAINTL
 17563     MOVE AL-UABON               TO BMAINTA
 17564     MOVE ER-2902                TO EMI-ERROR.
 17565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17566     GO TO 8200-SEND-DATAONLY.
 17567
 17568 2890-DUPLICATE-RECORD.
 17569     MOVE -1                     TO BMAINTL.
 17570     MOVE AL-UABON               TO BCERTNOA.
 17571     MOVE AL-UNBON               TO BEFFDTA.
 17572     MOVE SPACE                  TO BMAINTI.
 17573
 17574     MOVE 1                      TO EMI-SUB
 17575                                    EMI-SWITCH1
 17576                                    EMI-SWITCH-AREA-1
 17577                                    EMI-SWITCH-AREA-2.
 17578
 17579     MOVE SPACES                 TO EMI-ERROR-LINES.
 17580
 17581
 17582* EXEC CICS SYNCPOINT ROLLBACK
 17583*    END-EXEC.
 17584*    MOVE '6"R                   !   #00015188' TO DFHEIV0
 17585     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303135313838' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0
 17589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17590
 17591
 17592     MOVE ER-2247                TO EMI-ERROR.
 17593     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17594     GO TO 8200-SEND-DATAONLY.
 17595
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 320
* EL6311.cbl
 17597
 17598******************************************************************
 17599*                                                                *
 17600*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17601*                                                                *
 17602******************************************************************
 17603
 17604 2900-REWRITE-CAN-CERT-KEY.
 17605     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17606
 17607     IF  CCERTNOL GREATER THAN ZEROS
 17608         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17609
 17610     IF  CSUFIXL  GREATER THAN ZEROS
 17611         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17612
 17613     IF  CEFFDTL  GREATER THAN ZEROS
 17614         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17615
 17616 2910-READ-BY-ACCOUNT.
 17617
 17618* EXEC CICS HANDLE CONDITION
 17619*         NOTFND    (2920-PROCESS-REWRITE)
 17620*    END-EXEC.
 17621*    MOVE '"$I                   ! B #00015216' TO DFHEIV0
 17622     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17624     MOVE X'4220233030303135323136' TO DFHEIV0(25:11)
 17625     CALL 'kxdfhei1' USING DFHEIV0
 17626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17627
 17628
 17629
 17630* EXEC CICS READ
 17631*        SET     (ADDRESS OF PENDING-BUSINESS)
 17632*        DATASET (FILE-ID-ERPNDB2)
 17633*        RIDFLD  (ERPNDB-ALT-KEY)
 17634*    END-EXEC.
 17635*    MOVE '&"S        E          (   #00015220' TO DFHEIV0
 17636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17638     MOVE X'2020233030303135323230' TO DFHEIV0(25:11)
 17639     CALL 'kxdfhei1' USING DFHEIV0,
 17640           FILE-ID-ERPNDB2,
 17641           DFHEIV20,
 17642           DFHEIV99,
 17643           ERPNDB-ALT-KEY,
 17644           DFHEIV99,
 17645           DFHEIV99,
 17646           DFHEIV99
 17647     SET ADDRESS OF PENDING-BUSINESS TO
 17648         DFHEIV20
 17649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17650
 17651
 17652     GO TO 2990-DUPLICATE-RECORD.
 17653
 17654  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 321
* EL6311.cbl
 17655
 17656* EXEC CICS HANDLE CONDITION
 17657*         NOTFND    (2985-RECORD-MISSING)
 17658*    END-EXEC.
 17659*    MOVE '"$I                   ! C #00015229' TO DFHEIV0
 17660     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17662     MOVE X'4320233030303135323239' TO DFHEIV0(25:11)
 17663     CALL 'kxdfhei1' USING DFHEIV0
 17664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17665
 17666
 17667     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17668
 17669
 17670* EXEC CICS READ
 17671*        SET     (ADDRESS OF PENDING-BUSINESS)
 17672*        DATASET (FILE-ID-ERPNDB)
 17673*        RIDFLD  (ERPNDB-KEY)
 17674*        UPDATE
 17675*    END-EXEC.
 17676*    MOVE '&"S        EU         (   #00015235' TO DFHEIV0
 17677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17678     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17679     MOVE X'2020233030303135323335' TO DFHEIV0(25:11)
 17680     CALL 'kxdfhei1' USING DFHEIV0,
 17681           FILE-ID-ERPNDB,
 17682           DFHEIV20,
 17683           DFHEIV99,
 17684           ERPNDB-KEY,
 17685           DFHEIV99,
 17686           DFHEIV99,
 17687           DFHEIV99
 17688     SET ADDRESS OF PENDING-BUSINESS TO
 17689         DFHEIV20
 17690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17691
 17692
 17693     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17694     MOVE 'D'                    TO JP-RECORD-TYPE.
 17695     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17696     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17697
 17698     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17699
 17700     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17701     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17702     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17703
 17704
 17705* EXEC CICS DELETE
 17706*        DATASET    (FILE-ID-ERPNDB)
 17707*    END-EXEC.
 17708*    MOVE '&(                    &   #00015253' TO DFHEIV0
 17709     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17711     MOVE X'2020233030303135323533' TO DFHEIV0(25:11)
 17712     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 322
* EL6311.cbl
 17713           FILE-ID-ERPNDB,
 17714           DFHEIV99,
 17715           DFHEIV99,
 17716           DFHEIV99,
 17717           DFHEIV99
 17718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17719
 17720
 17721     PERFORM 8400-LOG-JOURNAL-RECORD.
 17722
 17723
 17724* EXEC CICS GETMAIN
 17725*        SET      (ADDRESS OF PENDING-BUSINESS)
 17726*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17727*        INITIMG  (GETMAIN-SPACE)
 17728*    END-EXEC.
 17729*    MOVE ',"IL                  $   #00015259' TO DFHEIV0
 17730     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17732     MOVE X'2020233030303135323539' TO DFHEIV0(25:11)
 17733     CALL 'kxdfhei1' USING DFHEIV0,
 17734           DFHEIV20,
 17735           ERPNDB-RECORD-LENGTH,
 17736           GETMAIN-SPACE
 17737     SET ADDRESS OF PENDING-BUSINESS TO
 17738         DFHEIV20
 17739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17740
 17741
 17742     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17743
 17744 2950-PROCESS-CANCELS.
 17745
 17746
 17747* EXEC CICS HANDLE CONDITION
 17748*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17749*    END-EXEC.
 17750*    MOVE '"$I                   ! D #00015269' TO DFHEIV0
 17751     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17752     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17753     MOVE X'4420233030303135323639' TO DFHEIV0(25:11)
 17754     CALL 'kxdfhei1' USING DFHEIV0
 17755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17756
 17757
 17758
 17759* EXEC CICS READ
 17760*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17761*        DATASET (FILE-ID-ELCERT)
 17762*        RIDFLD  (ELCERT-KEY)
 17763*        UPDATE
 17764*    END-EXEC.
 17765*    MOVE '&"S        EU         (   #00015273' TO DFHEIV0
 17766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17768     MOVE X'2020233030303135323733' TO DFHEIV0(25:11)
 17769     CALL 'kxdfhei1' USING DFHEIV0,
 17770           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 323
* EL6311.cbl
 17771           DFHEIV20,
 17772           DFHEIV99,
 17773           ELCERT-KEY,
 17774           DFHEIV99,
 17775           DFHEIV99,
 17776           DFHEIV99
 17777     SET ADDRESS OF CERTIFICATE-MASTER TO
 17778         DFHEIV20
 17779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17780
 17781
 17782     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17783
 17784     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17785     MOVE 'B'                      TO JP-RECORD-TYPE.
 17786     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17787     PERFORM 8400-LOG-JOURNAL-RECORD.
 17788
 17789     IF PB-CI-LIVES NOT NUMERIC
 17790         MOVE ZERO                    TO PB-CI-LIVES.
 17791
 17792     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17793        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17794        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17795        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17796                                         CM-LF-CANCEL-DT
 17797     ELSE
 17798        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17799        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17800        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17801        MOVE PB-CI-LIVES              TO CM-LIVES.
 17802
 17803     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17804        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17805            MOVE CM-LF-STATUS-AT-CANCEL
 17806                                     TO CM-LF-CURRENT-STATUS
 17807            MOVE SPACE
 17808                                     TO CM-LF-STATUS-AT-CANCEL
 17809        ELSE
 17810            MOVE PB-CI-LF-POLICY-STATUS
 17811                                     TO CM-LF-CURRENT-STATUS
 17812     ELSE
 17813        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17814
 17815     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17816        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17817        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17818        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17819                                         CM-AH-CANCEL-DT
 17820     ELSE
 17821        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17822        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17823        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17824        MOVE PB-CI-LIVES              TO CM-LIVES.
 17825
 17826     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17827        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17828            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 324
* EL6311.cbl
 17829                                     TO CM-AH-CURRENT-STATUS
 17830            MOVE SPACE
 17831                                     TO CM-AH-STATUS-AT-CANCEL
 17832        ELSE
 17833            MOVE PB-CI-AH-POLICY-STATUS
 17834                                     TO CM-AH-CURRENT-STATUS
 17835     ELSE
 17836        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17837
 17838 2975-REWRITE-CERT.
 17839     MOVE 'C'                      TO JP-RECORD-TYPE.
 17840     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17841
 17842
 17843* EXEC CICS REWRITE
 17844*        DATASET    (FILE-ID-ELCERT)
 17845*        FROM       (CERTIFICATE-MASTER)
 17846*    END-EXEC.
 17847     MOVE LENGTH OF
 17848      CERTIFICATE-MASTER
 17849       TO DFHEIV11
 17850*    MOVE '&& L                  %   #00015340' TO DFHEIV0
 17851     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17852     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17853     MOVE X'2020233030303135333430' TO DFHEIV0(25:11)
 17854     CALL 'kxdfhei1' USING DFHEIV0,
 17855           FILE-ID-ELCERT,
 17856           CERTIFICATE-MASTER,
 17857           DFHEIV11,
 17858           DFHEIV99
 17859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17860
 17861
 17862     PERFORM 8400-LOG-JOURNAL-RECORD.
 17863
 17864 2960-BUILD-NEW-CANCEL-RECORD.
 17865     IF  CCERTNOL GREATER THAN ZEROS
 17866         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17867
 17868     IF  CSUFIXL  GREATER THAN ZEROS
 17869         MOVE CSUFIXI             TO PB-CERT-SFX.
 17870
 17871     IF  CEFFDTL  GREATER  THAN ZEROS
 17872         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17873
 17874 2970-WRITE-PENDING-BUSINESS.
 17875     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17876     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17877     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17878     MOVE '5'                    TO DC-OPTION-CODE.
 17879     PERFORM 9700-DATE-LINK.
 17880     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17881
 17882     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17883
 17884     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17885                                    PB-CI-INSURED-SEX
 17886                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 325
* EL6311.cbl
 17887                                    PB-CI-AH-BENEFIT-CD
 17888                                    PB-CI-RATE-CLASS
 17889                                    PB-CI-RATE-DEV-LF
 17890                                    PB-CI-RATE-DEV-AH
 17891                                    PB-CI-LF-ABBR
 17892                                    PB-CI-AH-ABBR
 17893                                    PB-CI-OB-FLAG
 17894                                    PB-CI-LF-POLICY-STATUS
 17895                                    PB-CI-AH-POLICY-STATUS
 17896                                    PB-CI-INDV-GRP-CD
 17897                                    PB-CI-BENEFICIARY-NAME
 17898                                    PB-CI-NOTE-SW
 17899                                    PB-CI-SOC-SEC-NO
 17900                                    PB-CI-MEMBER-NO
 17901                                    PB-CI-INT-CODE
 17902                                    PB-CI-COMP-EXCP-SW
 17903                                    PB-CI-ENTRY-STATUS
 17904                                    PB-CI-CREDIT-INTERFACE-SW-1
 17905                                    PB-CI-CREDIT-INTERFACE-SW-2
 17906                                    PB-CI-ENTRY-BATCH.
 17907
 17908     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17909                                    PB-CI-AH-SETTLEMENT-DT
 17910                                    PB-CI-DEATH-DT
 17911                                    PB-CI-LF-PRIOR-CANCEL-DT
 17912                                    PB-CI-AH-PRIOR-CANCEL-DT
 17913                                    PB-CI-LOAN-1ST-PMT-DT
 17914                                    PB-CI-ENTRY-DT
 17915                                    PB-CI-LF-EXPIRE-DT
 17916                                    PB-CI-AH-EXPIRE-DT.
 17917
 17918     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17919                                    PB-CI-LF-TERM
 17920                                    PB-CI-LF-BENEFIT-AMT
 17921                                    PB-CI-LF-ALT-BENEFIT-AMT
 17922                                    PB-CI-LF-PREMIUM-AMT
 17923                                    PB-CI-LF-ALT-PREMIUM-AMT
 17924                                    PB-CI-AH-TERM
 17925                                    PB-CI-AH-BENEFIT-AMT
 17926                                    PB-CI-AH-PREMIUM-AMT
 17927                                    PB-CI-RATE-DEV-PCT-LF
 17928                                    PB-CI-RATE-DEV-PCT-AH
 17929                                    PB-CI-LIFE-COMMISSION
 17930                                    PB-CI-AH-COMMISSION
 17931                                    PB-CI-PAY-FREQUENCY
 17932                                    PB-CI-LOAN-APR
 17933                                    PB-CI-LOAN-TERM
 17934                                    PB-CI-CURR-SEQ
 17935                                    PB-CI-AH-CANCEL-AMT
 17936                                    PB-CI-LF-CANCEL-AMT
 17937                                    PB-CI-EXTENTION-DAYS
 17938                                    PB-CI-TERM-IN-DAYS
 17939                                    PB-CI-LOAN-OFFICER
 17940                                    PB-CI-LIVES
 17941                                    PB-CI-LF-CRIT-PER
 17942                                    PB-CI-AH-CRIT-PER
 17943                                    PB-C-LF-REM-TERM
 17944                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 326
* EL6311.cbl
 17945
 17946     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17947     MOVE 'A'                    TO JP-RECORD-TYPE.
 17948     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17949
 17950
 17951* EXEC CICS HANDLE CONDITION
 17952*        DUPREC   (2990-DUPLICATE-RECORD)
 17953*    END-EXEC.
 17954*    MOVE '"$%                   ! E #00015433' TO DFHEIV0
 17955     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17957     MOVE X'4520233030303135343333' TO DFHEIV0(25:11)
 17958     CALL 'kxdfhei1' USING DFHEIV0
 17959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17960
 17961
 17962
 17963* EXEC CICS WRITE
 17964*        DATASET  (FILE-ID-ERPNDB)
 17965*        FROM     (PENDING-BUSINESS)
 17966*        RIDFLD   (PB-CONTROL-PRIMARY)
 17967*    END-EXEC.
 17968     MOVE LENGTH OF
 17969      PENDING-BUSINESS
 17970       TO DFHEIV11
 17971*    MOVE '&$ L                  ''   #00015437' TO DFHEIV0
 17972     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17973     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17974     MOVE X'2020233030303135343337' TO DFHEIV0(25:11)
 17975     CALL 'kxdfhei1' USING DFHEIV0,
 17976           FILE-ID-ERPNDB,
 17977           PENDING-BUSINESS,
 17978           DFHEIV11,
 17979           PB-CONTROL-PRIMARY,
 17980           DFHEIV99,
 17981           DFHEIV99
 17982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17983
 17984
 17985     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17986
 17987     PERFORM 8400-LOG-JOURNAL-RECORD.
 17988
 17989     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17990
 17991 2985-RECORD-MISSING.
 17992     MOVE -1                     TO CMAINTL
 17993     MOVE AL-UABON               TO CMAINTA.
 17994
 17995     MOVE ER-2902                TO EMI-ERROR.
 17996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17997     GO TO 8200-SEND-DATAONLY.
 17998
 17999 2990-DUPLICATE-RECORD.
 18000     MOVE SPACE                  TO CMAINTI.
 18001     MOVE -1                     TO CMAINTL.
 18002     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 327
* EL6311.cbl
 18003     MOVE AL-UNBON               TO CEFFDTA.
 18004
 18005     MOVE 1                      TO EMI-SUB
 18006                                    EMI-SWITCH1
 18007                                    EMI-SWITCH-AREA-1
 18008                                    EMI-SWITCH-AREA-2.
 18009     MOVE SPACES                 TO EMI-ERROR-LINES.
 18010
 18011
 18012* EXEC CICS SYNCPOINT ROLLBACK
 18013*    END-EXEC.
 18014*    MOVE '6"R                   !   #00015469' TO DFHEIV0
 18015     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18017     MOVE X'2020233030303135343639' TO DFHEIV0(25:11)
 18018     CALL 'kxdfhei1' USING DFHEIV0
 18019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18020
 18021
 18022     MOVE ER-2247                TO EMI-ERROR.
 18023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18024     GO TO 8200-SEND-DATAONLY.
 18025
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 328
* EL6311.cbl
 18027
 18028***************************************************************
 18029*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 18030*     PREMIUM FOR A SINGLE BATCH.                             *
 18031*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 18032***************************************************************
 18033
 18034 3000-BATCH-MAINLINE.
 18035     IF PI-PREV-KEY NOT = SPACES
 18036         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 18037     ELSE
 18038         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 18039
 18040     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 18041
 18042 3010-READNEXT.
 18043
 18044* EXEC CICS READ
 18045*         DATASET    (FILE-ID-ERPNDB)
 18046*         SET        (ADDRESS OF PENDING-BUSINESS)
 18047*         RIDFLD     (ERPNDB-KEY)
 18048*         GTEQ
 18049*    END-EXEC.
 18050*    MOVE '&"S        G          (   #00015493' TO DFHEIV0
 18051     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18053     MOVE X'2020233030303135343933' TO DFHEIV0(25:11)
 18054     CALL 'kxdfhei1' USING DFHEIV0,
 18055           FILE-ID-ERPNDB,
 18056           DFHEIV20,
 18057           DFHEIV99,
 18058           ERPNDB-KEY,
 18059           DFHEIV99,
 18060           DFHEIV99,
 18061           DFHEIV99
 18062     SET ADDRESS OF PENDING-BUSINESS TO
 18063         DFHEIV20
 18064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18065
 18066
 18067     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18068        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18069          GO TO 3030-END-BATCH.
 18070
 18071     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18072
 18073     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18074        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18075          GO TO 3020-BUMP-SEQ.
 18076
 18077     IF PB-ISSUE
 18078        ADD +1                   TO WS-ISS-TOTAL-CNT
 18079        IF PB-FATAL-ERRORS
 18080           ADD +1                      TO WS-ISS-FATAL-CNT
 18081           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18082           GO TO 3020-BUMP-SEQ
 18083        ELSE
 18084           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 329
* EL6311.cbl
 18085              ADD +1                      TO WS-ISS-FORCE-CNT
 18086              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18087              GO TO 3020-BUMP-SEQ
 18088           ELSE
 18089              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18090                 ADD +1                      TO WS-ISS-HOLD-CNT
 18091                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18092                 GO TO 3020-BUMP-SEQ
 18093              ELSE
 18094                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18095                     THRU  3299-EXIT
 18096                 GO TO 3020-BUMP-SEQ.
 18097
 18098     IF PB-CANCELLATION
 18099        ADD +1                   TO WS-CAN-TOTAL-CNT
 18100        IF PB-FATAL-ERRORS
 18101           ADD +1                 TO WS-CAN-FATAL-CNT
 18102           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18103           GO TO 3020-BUMP-SEQ
 18104        ELSE
 18105           IF PB-UNFORCED-ERRORS
 18106              ADD +1                 TO WS-CAN-FORCE-CNT
 18107              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18108              GO TO 3020-BUMP-SEQ
 18109           ELSE
 18110              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18111                 ADD +1                 TO WS-CAN-HOLD-CNT
 18112                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18113                 GO TO 3020-BUMP-SEQ
 18114              ELSE
 18115                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18116                     THRU  3499-EXIT
 18117                 GO TO 3020-BUMP-SEQ.
 18118
 18119     IF PB-BATCH-TRAILER
 18120         GO TO 3030-END-BATCH.
 18121
 18122 3020-BUMP-SEQ.
 18123     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18124     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18125     GO TO 3010-READNEXT.
 18126
 18127 3030-END-BATCH.
 18128     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18129     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18130     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18131     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18132
 18133     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18134                                          - WS-ISS-FORCE-CNT
 18135                                          - WS-ISS-HOLD-CNT).
 18136
 18137     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18138     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18139
 18140     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18141     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18142     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 330
* EL6311.cbl
 18143     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18144     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18145                                          - WS-CAN-FORCE-CNT
 18146                                          - WS-CAN-HOLD-CNT).
 18147     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18148     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18149
 18150     COMPUTE WS-NET-TOTAL-CNT
 18151         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18152     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18153     COMPUTE WS-NET-FATAL-CNT
 18154         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18155     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18156     COMPUTE WS-NET-FORCE-CNT
 18157         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18158     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18159     COMPUTE WS-NET-HOLD-CNT
 18160         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18161     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18162
 18163     COMPUTE WS-NET-AVAIL-CNT
 18164          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18165                              - WS-ISS-FORCE-CNT
 18166                              - WS-ISS-HOLD-CNT)
 18167          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18168                              - WS-CAN-FORCE-CNT
 18169                              - WS-CAN-HOLD-CNT).
 18170     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18171
 18172     COMPUTE WS-NET-GOOD-PREM
 18173         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18174     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18175     COMPUTE WS-NET-BAD-PREM
 18176         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18177     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18178
 18179     MOVE 0000                   TO EMI-ERROR.
 18180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18181     MOVE -1                     TO DPFENTRL.
 18182     GO TO 8200-SEND-DATAONLY.
 18183
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 331
* EL6311.cbl
 18185
 18186******************************************************************
 18187*                                                                *
 18188*           A D D    B A D   I S S U E   P R E M I U M           *
 18189*                                                                *
 18190******************************************************************
 18191
 18192 3100-ADD-BAD-ISSUE-PREM.
 18193     IF PB-OVERRIDE-LIFE
 18194       OR PB-OVERRIDE-BOTH
 18195           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18196           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18197       ELSE
 18198           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18199           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18200
 18201     IF PB-OVERRIDE-AH
 18202       OR PB-OVERRIDE-BOTH
 18203           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18204       ELSE
 18205           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18206
 18207 3199-EXIT.
 18208     EXIT.
 18209
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 332
* EL6311.cbl
 18211
 18212******************************************************************
 18213*                                                                *
 18214*       A D D   G O O D   I S S U E   P R E M I U M              *
 18215*                                                                *
 18216******************************************************************
 18217
 18218 3200-ADD-GOOD-ISSUE-PREM.
 18219     IF PB-OVERRIDE-LIFE
 18220       OR PB-OVERRIDE-BOTH
 18221           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18222           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18223       ELSE
 18224           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18225           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18226
 18227     IF PB-OVERRIDE-AH
 18228       OR PB-OVERRIDE-BOTH
 18229           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18230       ELSE
 18231           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18232
 18233 3299-EXIT.
 18234     EXIT.
 18235
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 333
* EL6311.cbl
 18237
 18238
 18239******************************************************************
 18240*                                                                *
 18241*        A D D   B A D   C A N C E L   P R E M I U M             *
 18242*                                                                *
 18243******************************************************************
 18244
 18245 3300-ADD-BAD-CANCEL-PREM.
 18246     IF PB-OVERRIDE-LIFE
 18247       OR PB-OVERRIDE-BOTH
 18248           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18249       ELSE
 18250           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18251
 18252     IF PB-OVERRIDE-AH
 18253       OR PB-OVERRIDE-BOTH
 18254           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18255       ELSE
 18256           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18257
 18258 3399-EXIT.
 18259     EXIT.
 18260
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 334
* EL6311.cbl
 18262
 18263******************************************************************
 18264*                                                                *
 18265*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18266*                                                                *
 18267******************************************************************
 18268
 18269 3400-ADD-GOOD-CANCEL-PREM.
 18270     IF PB-OVERRIDE-LIFE
 18271       OR PB-OVERRIDE-BOTH
 18272           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18273       ELSE
 18274           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18275
 18276     IF PB-OVERRIDE-AH
 18277       OR PB-OVERRIDE-BOTH
 18278           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18279       ELSE
 18280           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18281
 18282 3499-EXIT.
 18283     EXIT.
 18284
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 335
* EL6311.cbl
 18286
 18287******************************************************************
 18288*                                                                *
 18289*           E D I T   B A T C H   D A T A                        *
 18290*                                                                *
 18291******************************************************************
 18292
 18293 3500-EDIT-BATCH-DATA.
 18294     IF PI-PREV-KEY NOT = SPACES
 18295        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18296     ELSE
 18297        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18298
 18299     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18300     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18301
 18302
 18303* EXEC CICS HANDLE CONDITION
 18304*         NOTFND      (3590-NOT-FOUND)
 18305*    END-EXEC.
 18306*    MOVE '"$I                   ! F #00015735' TO DFHEIV0
 18307     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18309     MOVE X'4620233030303135373335' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0
 18311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18312
 18313
 18314     IF DRISSL   GREATER THAN ZEROS OR
 18315        DRISSL   GREATER THAN ZEROS OR
 18316        DRLFPRML GREATER THAN ZEROS OR
 18317        DRAHPRML GREATER THAN ZEROS OR
 18318        DRCANCL  GREATER THAN ZEROS OR
 18319        DRLFRFDL GREATER THAN ZEROS OR
 18320        DRAHRFDL GREATER THAN ZEROS
 18321              NEXT SENTENCE
 18322          ELSE
 18323              MOVE ER-3224    TO EMI-ERROR
 18324              MOVE -1         TO DPFENTRL
 18325              MOVE AL-UNBON   TO DPFENTRA
 18326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18327              GO TO 8200-SEND-DATAONLY.
 18328
 18329     IF NOT MODIFY-CAP
 18330         MOVE 'UPDATE'       TO SM-READ
 18331         PERFORM 9995-SECURITY-VIOLATION
 18332         MOVE ER-0070        TO EMI-ERROR
 18333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18334         GO TO 8100-SEND-INITIAL-MAP.
 18335
 18336        IF DRISSL GREATER THAN ZEROS
 18337           MOVE AL-UNNON         TO DRISSA
 18338           MOVE DRISSI           TO DEEDIT-FIELD
 18339           PERFORM 8600-DEEDIT
 18340           IF DEEDIT-FIELD-V0  NUMERIC
 18341              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18342           ELSE
 18343              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 336
* EL6311.cbl
 18344              MOVE -1         TO DRISSL
 18345              MOVE AL-UNBON   TO DRISSA
 18346              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18347
 18348        IF DRLFPRML GREATER THAN ZEROS
 18349           MOVE AL-UNNON         TO DRLFPRMA
 18350
 18351* EXEC CICS BIF DEEDIT
 18352*              FIELD  (DRLFPRMI)
 18353*              LENGTH (11)
 18354*          END-EXEC
 18355     MOVE 11
 18356       TO DFHEIV11
 18357*    MOVE '@"L                   #   #00015775' TO DFHEIV0
 18358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18360     MOVE X'2020233030303135373735' TO DFHEIV0(25:11)
 18361     CALL 'kxdfhei1' USING DFHEIV0,
 18362           DRLFPRMI,
 18363           DFHEIV11
 18364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18365           IF DRLFPRMI NUMERIC
 18366              MOVE DRLFPRMI   TO WS-DRLFPRM
 18367*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18368*          PERFORM 8600-DEEDIT
 18369*          IF DEEDIT-FIELD-V2  NUMERIC
 18370*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18371           ELSE
 18372              MOVE ER-2223    TO EMI-ERROR
 18373              MOVE -1         TO DRLFPRML
 18374              MOVE AL-UNBON   TO DRLFPRMA
 18375              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18376
 18377        IF DRAHPRML GREATER THAN ZEROS
 18378           MOVE AL-UNNON         TO DRAHPRMA
 18379
 18380* EXEC CICS BIF DEEDIT
 18381*              FIELD  (DRAHPRMI)
 18382*              LENGTH (11)
 18383*          END-EXEC
 18384     MOVE 11
 18385       TO DFHEIV11
 18386*    MOVE '@"L                   #   #00015793' TO DFHEIV0
 18387     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18388     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18389     MOVE X'2020233030303135373933' TO DFHEIV0(25:11)
 18390     CALL 'kxdfhei1' USING DFHEIV0,
 18391           DRAHPRMI,
 18392           DFHEIV11
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18394           IF DRAHPRMI NUMERIC
 18395              MOVE DRAHPRMI   TO WS-DRAHPRM
 18396*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18397*          PERFORM 8600-DEEDIT
 18398*          IF DEEDIT-FIELD-V2  NUMERIC
 18399*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18400           ELSE
 18401              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 337
* EL6311.cbl
 18402              MOVE -1         TO DRAHPRML
 18403              MOVE AL-UNBON   TO DRAHPRMA
 18404              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18405
 18406        IF DRCANCL GREATER THAN ZEROS
 18407           MOVE AL-UNNON         TO DRCANCA
 18408           MOVE DRCANCI          TO DEEDIT-FIELD
 18409           PERFORM 8600-DEEDIT
 18410           IF DEEDIT-FIELD-V0  NUMERIC
 18411              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18412           ELSE
 18413              MOVE ER-2223    TO EMI-ERROR
 18414              MOVE -1         TO DRCANCL
 18415              MOVE AL-UNBON   TO DRCANCL
 18416              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18417
 18418        IF DRLFRFDL GREATER THAN ZEROS
 18419           MOVE AL-UNNON         TO DRLFRFDA
 18420
 18421* EXEC CICS BIF DEEDIT
 18422*              FIELD  (DRLFRFDI)
 18423*              LENGTH (11)
 18424*          END-EXEC
 18425     MOVE 11
 18426       TO DFHEIV11
 18427*    MOVE '@"L                   #   #00015823' TO DFHEIV0
 18428     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18429     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18430     MOVE X'2020233030303135383233' TO DFHEIV0(25:11)
 18431     CALL 'kxdfhei1' USING DFHEIV0,
 18432           DRLFRFDI,
 18433           DFHEIV11
 18434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18435           IF DRLFRFDI NUMERIC
 18436              MOVE DRLFRFDI   TO WS-DRLFRFD
 18437*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18438*          PERFORM 8600-DEEDIT
 18439*          IF DEEDIT-FIELD-V2  NUMERIC
 18440*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18441           ELSE
 18442              MOVE ER-2223    TO EMI-ERROR
 18443              MOVE -1         TO DRLFRFDL
 18444              MOVE AL-UNBON   TO DRLFRFDA
 18445              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18446
 18447        IF DRAHRFDL GREATER THAN ZEROS
 18448           MOVE AL-UNNON         TO DRAHRFDA
 18449
 18450* EXEC CICS BIF DEEDIT
 18451*              FIELD  (DRAHRFDI)
 18452*              LENGTH (11)
 18453*          END-EXEC
 18454     MOVE 11
 18455       TO DFHEIV11
 18456*    MOVE '@"L                   #   #00015841' TO DFHEIV0
 18457     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18459     MOVE X'2020233030303135383431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 338
* EL6311.cbl
 18460     CALL 'kxdfhei1' USING DFHEIV0,
 18461           DRAHRFDI,
 18462           DFHEIV11
 18463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18464           IF DRAHRFDI NUMERIC
 18465              MOVE DRAHRFDI   TO WS-DRAHRFD
 18466*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18467*          PERFORM 8600-DEEDIT
 18468*          IF DEEDIT-FIELD-V2  NUMERIC
 18469*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18470           ELSE
 18471              MOVE ER-2223    TO EMI-ERROR
 18472              MOVE -1         TO DRAHRFDL
 18473              MOVE AL-UNBON   TO DRAHRFDA
 18474              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18475
 18476     IF EMI-ERROR = ZEROS
 18477        GO 3600-UPDATE-BATCH-HEADER.
 18478
 18479     GO TO 8200-SEND-DATAONLY.
 18480
 18481 3590-NOT-FOUND.
 18482     MOVE ER-2192                TO EMI-ERROR.
 18483     MOVE -1                     TO DPFENTRL.
 18484     MOVE AL-UNBON               TO DPFENTRA.
 18485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18486     GO TO 8200-SEND-DATAONLY.
 18487
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 339
* EL6311.cbl
 18489
 18490******************************************************************
 18491*                                                                *
 18492*           U P D A T E   B A T C H   H E A D E R                *
 18493*                                                                *
 18494******************************************************************
 18495
 18496 3600-UPDATE-BATCH-HEADER.
 18497
 18498* EXEC CICS HANDLE CONDITION
 18499*         NOTFND      (3690-NOT-FOUND)
 18500*    END-EXEC.
 18501*    MOVE '"$I                   ! G #00015878' TO DFHEIV0
 18502     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18504     MOVE X'4720233030303135383738' TO DFHEIV0(25:11)
 18505     CALL 'kxdfhei1' USING DFHEIV0
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18507
 18508
 18509
 18510* EXEC CICS READ
 18511*        DATASET (FILE-ID-ERPNDB)
 18512*        RIDFLD  (ERPNDB-KEY)
 18513*        SET     (ADDRESS OF PENDING-BUSINESS)
 18514*        UPDATE
 18515*    END-EXEC.
 18516*    MOVE '&"S        EU         (   #00015882' TO DFHEIV0
 18517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18518     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18519     MOVE X'2020233030303135383832' TO DFHEIV0(25:11)
 18520     CALL 'kxdfhei1' USING DFHEIV0,
 18521           FILE-ID-ERPNDB,
 18522           DFHEIV20,
 18523           DFHEIV99,
 18524           ERPNDB-KEY,
 18525           DFHEIV99,
 18526           DFHEIV99,
 18527           DFHEIV99
 18528     SET ADDRESS OF PENDING-BUSINESS TO
 18529         DFHEIV20
 18530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18531
 18532
 18533     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18534     MOVE 'B'                    TO JP-RECORD-TYPE.
 18535     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18536
 18537     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18538
 18539     PERFORM 8400-LOG-JOURNAL-RECORD.
 18540
 18541     IF DRISSL GREATER THAN ZEROS
 18542        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18543
 18544     IF DRCANCL GREATER THAN ZEROS
 18545        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18546
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 340
* EL6311.cbl
 18547
 18548     IF DRLFPRML GREATER THAN ZEROS
 18549        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18550
 18551     IF DRAHPRML GREATER THAN ZEROS
 18552        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18553
 18554     IF DRLFRFDL GREATER THAN ZEROS
 18555        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18556
 18557     IF DRAHRFDL GREATER THAN ZEROS
 18558        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18559
 18560 3670-REWRITE-BATCH-HEADER.
 18561     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18562        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18563        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18564        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18565        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18566        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18567        MOVE SPACE               TO PB-OUT-BAL-CD
 18568     ELSE
 18569        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18570
 18571     MOVE 'C'                    TO JP-RECORD-TYPE.
 18572     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18573
 18574
 18575* EXEC CICS REWRITE
 18576*         DATASET      (FILE-ID-ERPNDB)
 18577*         FROM         (PENDING-BUSINESS)
 18578*    END-EXEC.
 18579     MOVE LENGTH OF
 18580      PENDING-BUSINESS
 18581       TO DFHEIV11
 18582*    MOVE '&& L                  %   #00015930' TO DFHEIV0
 18583     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18584     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18585     MOVE X'2020233030303135393330' TO DFHEIV0(25:11)
 18586     CALL 'kxdfhei1' USING DFHEIV0,
 18587           FILE-ID-ERPNDB,
 18588           PENDING-BUSINESS,
 18589           DFHEIV11,
 18590           DFHEIV99
 18591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18592
 18593
 18594     PERFORM 8400-LOG-JOURNAL-RECORD.
 18595
 18596     GO TO 7200-DISPLAY-BATCHES.
 18597
 18598 3690-NOT-FOUND.
 18599     MOVE ER-2192                TO EMI-ERROR.
 18600     MOVE -1                     TO DPFENTRL.
 18601     MOVE AL-UNBON               TO DPFENTRA.
 18602     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18603     GO TO 8200-SEND-DATAONLY.
 18604
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 341
* EL6311.cbl
 18606
 18607******************************************************************
 18608*                                                                *
 18609*           R E - D I S P L A Y   R E C O R D                    *
 18610*                                                                *
 18611******************************************************************
 18612
 18613 3900-RE-DISPLAY-RECORD.
 18614
 18615* EXEC CICS HANDLE CONDITION
 18616*         NOTFND   (3990-NOT-FOUND)
 18617*    END-EXEC.
 18618*    MOVE '"$I                   ! H #00015955' TO DFHEIV0
 18619     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18620     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18621     MOVE X'4820233030303135393535' TO DFHEIV0(25:11)
 18622     CALL 'kxdfhei1' USING DFHEIV0
 18623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18624
 18625
 18626     IF PI-DISPLAY-ORIGINAL-BATCH
 18627         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18628     ELSE
 18629         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18630
 18631
 18632* EXEC CICS READ
 18633*         DATASET   (FILE-ID)
 18634*         RIDFLD    (PI-PREV-KEY)
 18635*         SET       (ADDRESS OF PENDING-BUSINESS)
 18636*    END-EXEC.
 18637*    MOVE '&"S        E          (   #00015964' TO DFHEIV0
 18638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18640     MOVE X'2020233030303135393634' TO DFHEIV0(25:11)
 18641     CALL 'kxdfhei1' USING DFHEIV0,
 18642           FILE-ID,
 18643           DFHEIV20,
 18644           DFHEIV99,
 18645           PI-PREV-KEY,
 18646           DFHEIV99,
 18647           DFHEIV99,
 18648           DFHEIV99
 18649     SET ADDRESS OF PENDING-BUSINESS TO
 18650         DFHEIV20
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18652
 18653
 18654     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18655
 18656     IF PB-ISSUE
 18657         GO TO 7000-DISPLAY-ISSUES.
 18658
 18659     IF PB-CANCELLATION
 18660         GO TO 7100-DISPLAY-CANCELS.
 18661
 18662     IF PB-BATCH-TRAILER
 18663         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 342
* EL6311.cbl
 18664
 18665 3990-NOT-FOUND.
 18666     MOVE LOW-VALUES             TO EL631BI.
 18667
 18668     IF PI-MAP-NAME = EL631B
 18669         MOVE -1                  TO BMAINTL
 18670     ELSE
 18671         MOVE -1                  TO CMAINTL.
 18672
 18673     GO TO 8100-SEND-INITIAL-MAP.
 18674
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 343
* EL6311.cbl
 18676
 18677***************************************************************
 18678*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18679*                                                             *
 18680*      1. START BROWSE WITH                                   *
 18681*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18682*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18683*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18684*                                                             *
 18685*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18686*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18687*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18688*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18689*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18690*               AND IS IT TO BE DISPLAYED.                    *
 18691*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18692*               DISPLAYED.                                    *
 18693*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18694*               DISPLAYED.                                    *
 18695*                                                             *
 18696*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18697*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18698***************************************************************
 18699
 18700 4000-BROWSE-DETAIL-FORWARD.
 18701     IF FIRST-TIME
 18702        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18703     ELSE
 18704        IF SHOW-RECORD
 18705           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18706           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18707           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18708           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18709           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18710        ELSE
 18711           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18712
 18713
 18714* EXEC CICS HANDLE CONDITION
 18715*         NOTFND   (4050-END-RECORDS)
 18716*         ENDFILE  (4050-END-RECORDS)
 18717*    END-EXEC.
 18718*    MOVE '"$I''                  ! I #00016029' TO DFHEIV0
 18719     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18721     MOVE X'4920233030303136303239' TO DFHEIV0(25:11)
 18722     CALL 'kxdfhei1' USING DFHEIV0
 18723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18724
 18725
 18726
 18727* EXEC CICS STARTBR
 18728*         DATASET   (FILE-ID-ERPNDB2)
 18729*         RIDFLD    (ERPNDB-ALT-KEY)
 18730*    END-EXEC.
 18731     MOVE 0
 18732       TO DFHEIV11
 18733*    MOVE '&,         G          &   #00016034' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 344
* EL6311.cbl
 18734     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18736     MOVE X'2020233030303136303334' TO DFHEIV0(25:11)
 18737     CALL 'kxdfhei1' USING DFHEIV0,
 18738           FILE-ID-ERPNDB2,
 18739           ERPNDB-ALT-KEY,
 18740           DFHEIV99,
 18741           DFHEIV11,
 18742           DFHEIV99
 18743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18744
 18745
 18746     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18747
 18748     IF FIRST-TIME OR SHOW-RECORD
 18749        MOVE SPACE               TO WS-FIRST-TIME-SW
 18750        GO TO 4005-READ-NEXT-RECORD.
 18751
 18752
 18753* EXEC CICS READNEXT
 18754*         DATASET    (FILE-ID-ERPNDB2)
 18755*         SET        (ADDRESS OF PENDING-BUSINESS)
 18756*         RIDFLD     (ERPNDB-ALT-KEY)
 18757*    END-EXEC.
 18758     MOVE 0
 18759       TO DFHEIV11
 18760*    MOVE '&.S                   )   #00016045' TO DFHEIV0
 18761     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18762     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18763     MOVE X'2020233030303136303435' TO DFHEIV0(25:11)
 18764     CALL 'kxdfhei1' USING DFHEIV0,
 18765           FILE-ID-ERPNDB2,
 18766           DFHEIV20,
 18767           DFHEIV99,
 18768           ERPNDB-ALT-KEY,
 18769           DFHEIV99,
 18770           DFHEIV11,
 18771           DFHEIV99,
 18772           DFHEIV99
 18773     SET ADDRESS OF PENDING-BUSINESS TO
 18774         DFHEIV20
 18775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18776
 18777
 18778 4005-READ-NEXT-RECORD.
 18779
 18780* EXEC CICS READNEXT
 18781*         DATASET    (FILE-ID-ERPNDB2)
 18782*         SET        (ADDRESS OF PENDING-BUSINESS)
 18783*         RIDFLD     (ERPNDB-ALT-KEY)
 18784*    END-EXEC.
 18785     MOVE 0
 18786       TO DFHEIV11
 18787*    MOVE '&.S                   )   #00016052' TO DFHEIV0
 18788     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18789     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18790     MOVE X'2020233030303136303532' TO DFHEIV0(25:11)
 18791     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 345
* EL6311.cbl
 18792           FILE-ID-ERPNDB2,
 18793           DFHEIV20,
 18794           DFHEIV99,
 18795           ERPNDB-ALT-KEY,
 18796           DFHEIV99,
 18797           DFHEIV11,
 18798           DFHEIV99,
 18799           DFHEIV99
 18800     SET ADDRESS OF PENDING-BUSINESS TO
 18801         DFHEIV20
 18802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18803
 18804
 18805     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18806
 18807     IF WS-BATCH-PREFIX = '#CL'
 18808        GO TO 4005-READ-NEXT-RECORD.
 18809
 18810     IF SHOW-RECORD
 18811        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18812           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18813           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18814           PB-STATE         NOT = PI-PB-STATE          OR
 18815           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18816           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18817           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18818           GO TO 4050-END-RECORDS
 18819        ELSE
 18820           GO TO 4010-CHECK-REC-TYPE.
 18821
 18822     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18823        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18824        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18825        PB-STATE            NOT = PI-PB-STATE          OR
 18826        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18827        GO TO 4050-END-RECORDS.
 18828
 18829     IF PB-BATCH-TRAILER
 18830        GO TO 4005-READ-NEXT-RECORD.
 18831
 18832     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18833        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18834           GO TO 4005-READ-NEXT-RECORD
 18835        ELSE
 18836           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18837              GO TO 4010-CHECK-REC-TYPE
 18838           ELSE
 18839              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18840                 GO TO 4010-CHECK-REC-TYPE
 18841              ELSE
 18842                 GO TO 4005-READ-NEXT-RECORD.
 18843
 18844     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18845        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18846           GO TO 4005-READ-NEXT-RECORD.
 18847
 18848 4010-CHECK-REC-TYPE.
 18849     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 346
* EL6311.cbl
 18850         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18851             NEXT SENTENCE
 18852         ELSE
 18853             GO TO 4005-READ-NEXT-RECORD.
 18854
 18855     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18856         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18857             NEXT SENTENCE
 18858        ELSE
 18859             GO TO 4005-READ-NEXT-RECORD.
 18860
 18861     IF NOT DISPLAY-CHANGE-RECORDS AND
 18862            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18863        GO TO 4005-READ-NEXT-RECORD.
 18864
 18865     IF DISPLAY-HOLD-RECORDS AND
 18866        NOT PB-RECORD-ON-HOLD
 18867          GO TO 4005-READ-NEXT-RECORD.
 18868
 18869     IF PB-ISSUE
 18870        IF DISPLAY-CHK-REQ-RECORDS
 18871            GO TO 4005-READ-NEXT-RECORD.
 18872
 18873     IF PB-ISSUE
 18874        IF ISSUE-WITH-WARNING
 18875           IF PB-WARNING-ERRORS
 18876              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18877                  GO TO 4005-READ-NEXT-RECORD
 18878              ELSE
 18879                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18880                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18881                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18882                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18883                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18884                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18885                 GO TO 7000-DISPLAY-ISSUES
 18886           ELSE
 18887              GO TO 4005-READ-NEXT-RECORD.
 18888
 18889     IF PB-ISSUE
 18890        IF (ISSUES-IN-ERROR AND
 18891            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18892            ALL-ISSUES
 18893            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18894            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18895            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18896            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18897            MOVE PB-SV-STATE            TO PI-SV-STATE
 18898            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18899            GO TO 7000-DISPLAY-ISSUES
 18900        ELSE
 18901            GO TO 4005-READ-NEXT-RECORD.
 18902
 18903     IF PB-CANCELLATION
 18904        IF DISPLAY-CHK-REQ-RECORDS
 18905           IF PB-C-REFUND-REQUESTED
 18906              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18907              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 347
* EL6311.cbl
 18908              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18909              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18910              MOVE PB-SV-STATE            TO PI-SV-STATE
 18911              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18912              GO TO 7100-DISPLAY-CANCELS
 18913           ELSE
 18914               GO TO 4005-READ-NEXT-RECORD.
 18915
 18916     IF PB-CANCELLATION
 18917        IF CANCEL-WITH-WARNING
 18918           IF PB-WARNING-ERRORS
 18919              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18920                  GO TO 4005-READ-NEXT-RECORD
 18921              ELSE
 18922                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18923                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18924                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18925                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18926                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18927                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18928                 GO TO 7100-DISPLAY-CANCELS
 18929           ELSE
 18930              GO TO 4005-READ-NEXT-RECORD.
 18931
 18932     IF PB-CANCELLATION
 18933        IF (CANCEL-IN-ERROR  AND
 18934            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18935            ALL-CANCELS
 18936            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18937            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18938            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18939            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18940            MOVE PB-SV-STATE            TO PI-SV-STATE
 18941            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18942            GO TO 7100-DISPLAY-CANCELS.
 18943
 18944     GO TO 4005-READ-NEXT-RECORD.
 18945
 18946 4050-END-RECORDS.
 18947******************************************************************
 18948*                                                                *
 18949*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18950*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18951*         PROGRAM.                                               *
 18952*                                                                *
 18953******************************************************************
 18954
 18955     IF BROWSE-STARTED
 18956        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18957
 18958* EXEC CICS ENDBR
 18959*            DATASET  (FILE-ID-ERPNDB2)
 18960*       END-EXEC.
 18961     MOVE 0
 18962       TO DFHEIV11
 18963*    MOVE '&2                    $   #00016210' TO DFHEIV0
 18964     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18965     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 348
* EL6311.cbl
 18966     MOVE X'2020233030303136323130' TO DFHEIV0(25:11)
 18967     CALL 'kxdfhei1' USING DFHEIV0,
 18968           FILE-ID-ERPNDB2,
 18969           DFHEIV11,
 18970           DFHEIV99
 18971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18972
 18973
 18974     IF  EIBTRNID NOT = TRANS-EXB1
 18975         IF PENDING-BUS-RECS-FOUND
 18976             NEXT SENTENCE
 18977           ELSE
 18978             MOVE '9'            TO PI-BROWSE-SW
 18979             GO TO 9400-CLEAR.
 18980
 18981     IF SHOW-RECORD
 18982        MOVE ER-2253            TO EMI-ERROR
 18983       ELSE
 18984        MOVE ER-2254            TO EMI-ERROR.
 18985
 18986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18987
 18988     IF PI-MAP-NAME = SPACES
 18989        MOVE -1                  TO DPFENTRL
 18990        MOVE EL631D               TO PI-MAP-NAME
 18991        GO TO 8100-SEND-INITIAL-MAP.
 18992
 18993     IF PI-MAP-NAME = EL631B
 18994        MOVE -1                  TO BMAINTL
 18995     ELSE
 18996        IF PI-MAP-NAME = EL631C
 18997           MOVE -1               TO CMAINTL
 18998        ELSE
 18999           MOVE -1               TO DPFENTRL.
 19000
 19001     GO TO 8200-SEND-DATAONLY.
 19002
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 349
* EL6311.cbl
 19004
 19005***************************************************************
 19006*                                                             *
 19007*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 19008*                                                             *
 19009*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 19010*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19011*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19012*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 19013*                                                             *
 19014*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19015*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19016*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 19017*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19018*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19019*                AND IS IT TO BE DISPLAYED.                   *
 19020*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19021*                DISPLAYED.                                   *
 19022*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19023*                DISPLAYED.                                   *
 19024*                                                             *
 19025*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19026*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19027*                                                             *
 19028*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19029*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19030*                THEY ARE NOT TO BE DISPLAYED.                *
 19031*                                                             *
 19032***************************************************************
 19033
 19034 4100-BROWSE-PRIMARY-FORWARD.
 19035     IF FIRST-TIME  OR SHOW-RECORD
 19036        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 19037        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 19038        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 19039     ELSE
 19040        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 19041        IF ERPNDB-BATCH-SEQ-NO = +9999
 19042           GO TO 4150-END-BATCH
 19043        ELSE
 19044           IF DISPLAY-CHANGE-RECORDS
 19045              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19046           ELSE
 19047              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19048              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19049
 19050     IF FIRST-TIME
 19051         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19052            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19053              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19054
 19055
 19056* EXEC CICS HANDLE CONDITION
 19057*         ENDFILE  (4150-END-BATCH)
 19058*    END-EXEC.
 19059*    MOVE '"$''                   ! J #00016295' TO DFHEIV0
 19060     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19061     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 350
* EL6311.cbl
 19062     MOVE X'4A20233030303136323935' TO DFHEIV0(25:11)
 19063     CALL 'kxdfhei1' USING DFHEIV0
 19064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19065
 19066
 19067 4105-READ-NEXT.
 19068
 19069* EXEC CICS HANDLE CONDITION
 19070*         NOTFND    (4150-END-BATCH)
 19071*    END-EXEC.
 19072*    MOVE '"$I                   ! K #00016300' TO DFHEIV0
 19073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19075     MOVE X'4B20233030303136333030' TO DFHEIV0(25:11)
 19076     CALL 'kxdfhei1' USING DFHEIV0
 19077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19078
 19079
 19080     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19081
 19082     IF PI-DISPLAY-ORIGINAL-BATCH
 19083        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19084     ELSE
 19085        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19086
 19087
 19088* EXEC CICS READ
 19089*         DATASET   (FILE-ID)
 19090*         SET       (ADDRESS OF PENDING-BUSINESS)
 19091*         RIDFLD    (ERPNDB-KEY)
 19092*         GTEQ
 19093*    END-EXEC.
 19094*    MOVE '&"S        G          (   #00016311' TO DFHEIV0
 19095     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19097     MOVE X'2020233030303136333131' TO DFHEIV0(25:11)
 19098     CALL 'kxdfhei1' USING DFHEIV0,
 19099           FILE-ID,
 19100           DFHEIV20,
 19101           DFHEIV99,
 19102           ERPNDB-KEY,
 19103           DFHEIV99,
 19104           DFHEIV99,
 19105           DFHEIV99
 19106     SET ADDRESS OF PENDING-BUSINESS TO
 19107         DFHEIV20
 19108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19109
 19110
 19111     IF PI-DISPLAY-ORIGINAL-BATCH
 19112        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19113           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19114           GO TO 4150-END-BATCH
 19115        ELSE
 19116           IF PB-BATCH-TRAILER
 19117              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19118              GO TO 4105-READ-NEXT
 19119           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 351
* EL6311.cbl
 19120              NEXT SENTENCE
 19121     ELSE
 19122        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19123           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19124           GO TO 4150-END-BATCH.
 19125
 19126     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19127
 19128     IF WS-BATCH-PREFIX = '#CL'
 19129         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19130         GO TO 4105-READ-NEXT.
 19131
 19132     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19133     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19134     MOVE PB-STATE               TO PI-PB-STATE.
 19135     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19136
 19137     IF PB-BATCH-TRAILER
 19138        IF SHOW-RECORD
 19139           GO TO 4150-END-BATCH
 19140        ELSE
 19141           MOVE ER-2251         TO EMI-ERROR
 19142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19143           MOVE 1               TO PI-BROWSE-TYPE
 19144           GO TO 7200-DISPLAY-BATCHES.
 19145
 19146     IF SHOW-RECORD
 19147           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19148              GO TO 4110-BUMP-SEQ
 19149           ELSE
 19150              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19151                 GO TO 4110-BUMP-SEQ
 19152              ELSE
 19153                 GO TO 4107-CHECK-REC-TYPE.
 19154
 19155     IF NOT  PI-PRIMARY-WITH-SELECT
 19156        GO TO 4107-CHECK-REC-TYPE.
 19157
 19158     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19159        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19160           GO TO 4110-BUMP-SEQ
 19161        ELSE
 19162           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19163              GO TO 4107-CHECK-REC-TYPE
 19164           ELSE
 19165              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19166                 GO TO 4107-CHECK-REC-TYPE
 19167              ELSE
 19168                 GO TO 4110-BUMP-SEQ.
 19169
 19170     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19171        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19172           GO TO 4110-BUMP-SEQ.
 19173
 19174 4107-CHECK-REC-TYPE.
 19175     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19176         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19177             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 352
* EL6311.cbl
 19178           ELSE
 19179             GO TO 4110-BUMP-SEQ.
 19180
 19181     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19182         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19183             NEXT SENTENCE
 19184           ELSE
 19185             GO TO 4110-BUMP-SEQ.
 19186
 19187     IF NOT DISPLAY-CHANGE-RECORDS AND
 19188        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19189           GO TO 4110-BUMP-SEQ.
 19190
 19191     IF DISPLAY-HOLD-RECORDS AND
 19192        NOT PB-RECORD-ON-HOLD
 19193          GO TO 4110-BUMP-SEQ.
 19194
 19195     IF PB-ISSUE
 19196        IF DISPLAY-CHK-REQ-RECORDS
 19197            GO TO 4110-BUMP-SEQ.
 19198
 19199     IF PB-ISSUE
 19200        IF ISSUE-WITH-WARNING
 19201           IF PB-WARNING-ERRORS
 19202              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19203                  GO TO 4110-BUMP-SEQ
 19204              ELSE
 19205                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19206                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19207                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19208                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19209                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19210                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19211                 GO TO 7000-DISPLAY-ISSUES
 19212        ELSE
 19213            GO TO 4110-BUMP-SEQ.
 19214
 19215     IF PB-ISSUE
 19216        IF (ISSUES-IN-ERROR AND
 19217            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19218            ALL-ISSUES
 19219            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19220            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19221            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19222            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19223            MOVE PB-SV-STATE            TO PI-SV-STATE
 19224            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19225            GO TO 7000-DISPLAY-ISSUES
 19226        ELSE
 19227            GO TO 4110-BUMP-SEQ.
 19228
 19229     IF PB-CANCELLATION
 19230        IF DISPLAY-CHK-REQ-RECORDS
 19231           IF PB-C-REFUND-REQUESTED
 19232              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19233              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19234              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19235              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 353
* EL6311.cbl
 19236              MOVE PB-SV-STATE            TO PI-SV-STATE
 19237              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19238              GO TO 7100-DISPLAY-CANCELS
 19239           ELSE
 19240              GO TO 4110-BUMP-SEQ.
 19241
 19242     IF PB-CANCELLATION
 19243        IF CANCEL-WITH-WARNING
 19244           IF PB-WARNING-ERRORS
 19245              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19246                  GO TO 4110-BUMP-SEQ
 19247              ELSE
 19248                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19249                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19250                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19251                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19252                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19253                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19254                 GO TO 7100-DISPLAY-CANCELS
 19255           ELSE
 19256              GO TO 4110-BUMP-SEQ.
 19257
 19258     IF PB-CANCELLATION
 19259        IF (CANCEL-IN-ERROR  AND
 19260            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19261            ALL-CANCELS
 19262            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19263            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19264            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19265            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19266            MOVE PB-SV-STATE            TO PI-SV-STATE
 19267            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19268            GO TO 7100-DISPLAY-CANCELS.
 19269
 19270 4110-BUMP-SEQ.
 19271     IF NOT DISPLAY-CHANGE-RECORDS
 19272        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19273        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19274     ELSE
 19275        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19276           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19277           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19278        ELSE
 19279           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19280           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19281
 19282     GO TO 4105-READ-NEXT.
 19283
 19284 4150-END-BATCH.
 19285******************************************************************
 19286*                                                                *
 19287*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19288*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19289*         PROGRAM.                                               *
 19290*                                                                *
 19291******************************************************************
 19292
 19293     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 354
* EL6311.cbl
 19294         IF PENDING-BUS-RECS-FOUND
 19295             NEXT SENTENCE
 19296           ELSE
 19297             MOVE '9'            TO PI-BROWSE-SW
 19298             GO TO 9400-CLEAR.
 19299
 19300     IF SHOW-RECORD
 19301        MOVE ER-2253             TO EMI-ERROR
 19302     ELSE
 19303        MOVE ER-2251             TO EMI-ERROR.
 19304
 19305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19306
 19307     IF PI-MAP-NAME = SPACES
 19308        MOVE -1                  TO BMAINTL
 19309        MOVE EL631B              TO PI-MAP-NAME
 19310        GO TO 8100-SEND-INITIAL-MAP.
 19311
 19312     IF PI-MAP-NAME = EL631B
 19313        MOVE -1                  TO BMAINTL
 19314     ELSE
 19315        IF PI-MAP-NAME = EL631C
 19316           MOVE -1               TO CMAINTL
 19317        ELSE
 19318           MOVE -1               TO DPFENTRL.
 19319
 19320     GO TO 8200-SEND-DATAONLY.
 19321
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 355
* EL6311.cbl
 19323
 19324***************************************************************
 19325*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19326*                                                             *
 19327*      1. START BROWSE WITH                                   *
 19328*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19329*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19330*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19331*                                                             *
 19332*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19333*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19334*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19335*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19336*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19337*               AND IS IT TO BE DISPLAYED.                    *
 19338*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19339*               DISPLAYED.                                    *
 19340*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19341*               DISPLAYED.                                    *
 19342*                                                             *
 19343*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19344*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19345***************************************************************
 19346
 19347 4200-BROWSE-CSR-FORWARD.
 19348
 19349     IF FIRST-TIME
 19350        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19351     ELSE
 19352        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19353
 19354
 19355* EXEC CICS HANDLE CONDITION
 19356*         NOTFND   (4250-END-RECORDS)
 19357*         ENDFILE  (4250-END-RECORDS)
 19358*    END-EXEC.
 19359*    MOVE '"$I''                  ! L #00016561' TO DFHEIV0
 19360     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19362     MOVE X'4C20233030303136353631' TO DFHEIV0(25:11)
 19363     CALL 'kxdfhei1' USING DFHEIV0
 19364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19365
 19366
 19367
 19368* EXEC CICS STARTBR
 19369*         DATASET   (FILE-ID-ERPNDB4)
 19370*         RIDFLD    (ERPNDB-CSR-KEY)
 19371*    END-EXEC.
 19372     MOVE 0
 19373       TO DFHEIV11
 19374*    MOVE '&,         G          &   #00016566' TO DFHEIV0
 19375     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19376     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303136353636' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           FILE-ID-ERPNDB4,
 19380           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 356
* EL6311.cbl
 19381           DFHEIV99,
 19382           DFHEIV11,
 19383           DFHEIV99
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19388
 19389     IF FIRST-TIME
 19390        MOVE SPACE               TO WS-FIRST-TIME-SW
 19391        GO TO 4205-READ-NEXT-RECORD.
 19392
 19393
 19394* EXEC CICS READNEXT
 19395*         DATASET    (FILE-ID-ERPNDB4)
 19396*         SET        (ADDRESS OF PENDING-BUSINESS)
 19397*         RIDFLD     (ERPNDB-CSR-KEY)
 19398*    END-EXEC.
 19399     MOVE 0
 19400       TO DFHEIV11
 19401*    MOVE '&.S                   )   #00016577' TO DFHEIV0
 19402     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303136353737' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0,
 19406           FILE-ID-ERPNDB4,
 19407           DFHEIV20,
 19408           DFHEIV99,
 19409           ERPNDB-CSR-KEY,
 19410           DFHEIV99,
 19411           DFHEIV11,
 19412           DFHEIV99,
 19413           DFHEIV99
 19414     SET ADDRESS OF PENDING-BUSINESS TO
 19415         DFHEIV20
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419 4205-READ-NEXT-RECORD.
 19420
 19421
 19422* EXEC CICS READNEXT
 19423*         DATASET    (FILE-ID-ERPNDB4)
 19424*         SET        (ADDRESS OF PENDING-BUSINESS)
 19425*         RIDFLD     (ERPNDB-CSR-KEY)
 19426*    END-EXEC.
 19427     MOVE 0
 19428       TO DFHEIV11
 19429*    MOVE '&.S                   )   #00016585' TO DFHEIV0
 19430     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19432     MOVE X'2020233030303136353835' TO DFHEIV0(25:11)
 19433     CALL 'kxdfhei1' USING DFHEIV0,
 19434           FILE-ID-ERPNDB4,
 19435           DFHEIV20,
 19436           DFHEIV99,
 19437           ERPNDB-CSR-KEY,
 19438           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 357
* EL6311.cbl
 19439           DFHEIV11,
 19440           DFHEIV99,
 19441           DFHEIV99
 19442     SET ADDRESS OF PENDING-BUSINESS TO
 19443         DFHEIV20
 19444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19445
 19446
 19447     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19448
 19449     IF WS-BATCH-PREFIX = '#CL'
 19450        GO TO 4205-READ-NEXT-RECORD.
 19451
 19452     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19453        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19454        GO TO 4250-END-RECORDS.
 19455
 19456     IF PB-BATCH-TRAILER
 19457        GO TO 4205-READ-NEXT-RECORD.
 19458
 19459     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19460        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19461           GO TO 4205-READ-NEXT-RECORD
 19462        ELSE
 19463           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19464              GO TO 4210-CHECK-REC-TYPE
 19465           ELSE
 19466              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19467                 GO TO 4210-CHECK-REC-TYPE
 19468              ELSE
 19469                 GO TO 4205-READ-NEXT-RECORD.
 19470
 19471     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19472        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19473           GO TO 4205-READ-NEXT-RECORD.
 19474
 19475 4210-CHECK-REC-TYPE.
 19476     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19477         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19478             NEXT SENTENCE
 19479         ELSE
 19480             GO TO 4205-READ-NEXT-RECORD.
 19481
 19482     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19483         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19484             NEXT SENTENCE
 19485        ELSE
 19486             GO TO 4205-READ-NEXT-RECORD.
 19487
 19488     IF NOT DISPLAY-CHANGE-RECORDS AND
 19489            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19490        GO TO 4205-READ-NEXT-RECORD.
 19491
 19492     IF DISPLAY-HOLD-RECORDS AND
 19493        NOT PB-RECORD-ON-HOLD
 19494          GO TO 4205-READ-NEXT-RECORD.
 19495
 19496     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 358
* EL6311.cbl
 19497        IF DISPLAY-CHK-REQ-RECORDS
 19498            GO TO 4205-READ-NEXT-RECORD.
 19499
 19500     IF PB-ISSUE
 19501        IF ISSUE-WITH-WARNING
 19502           IF PB-WARNING-ERRORS
 19503              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19504                  GO TO 4205-READ-NEXT-RECORD
 19505              ELSE
 19506                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19507                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19508                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19509                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19510                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19511                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19512                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19513                 GO TO 7000-DISPLAY-ISSUES
 19514           ELSE
 19515              GO TO 4205-READ-NEXT-RECORD.
 19516
 19517     IF PB-ISSUE
 19518        IF (ISSUES-IN-ERROR AND
 19519            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19520            ALL-ISSUES
 19521            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19522            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19523            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19524            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19525            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19526            MOVE PB-SV-STATE            TO PI-SV-STATE
 19527            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19528            GO TO 7000-DISPLAY-ISSUES
 19529        ELSE
 19530            GO TO 4205-READ-NEXT-RECORD.
 19531
 19532     IF PB-CANCELLATION
 19533        IF DISPLAY-CHK-REQ-RECORDS
 19534           IF PB-C-REFUND-REQUESTED
 19535              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19536              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19537              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19538              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19539              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19540              MOVE PB-SV-STATE            TO PI-SV-STATE
 19541              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19542              GO TO 7100-DISPLAY-CANCELS
 19543           ELSE
 19544               GO TO 4205-READ-NEXT-RECORD.
 19545
 19546     IF PB-CANCELLATION
 19547        IF CANCEL-WITH-WARNING
 19548           IF PB-WARNING-ERRORS
 19549              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19550                  GO TO 4205-READ-NEXT-RECORD
 19551              ELSE
 19552                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19553                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19554                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 359
* EL6311.cbl
 19555                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19556                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19557                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19558                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19559                 GO TO 7100-DISPLAY-CANCELS
 19560           ELSE
 19561              GO TO 4205-READ-NEXT-RECORD.
 19562
 19563     IF PB-CANCELLATION
 19564        IF (CANCEL-IN-ERROR  AND
 19565            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19566            ALL-CANCELS
 19567            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19568            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19569            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19570            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19571            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19572            MOVE PB-SV-STATE            TO PI-SV-STATE
 19573            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19574            GO TO 7100-DISPLAY-CANCELS.
 19575
 19576     GO TO 4205-READ-NEXT-RECORD.
 19577
 19578 4250-END-RECORDS.
 19579******************************************************************
 19580*                                                                *
 19581*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19582*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19583*         PROGRAM.                                               *
 19584*                                                                *
 19585******************************************************************
 19586
 19587     IF BROWSE-STARTED
 19588        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19589
 19590* EXEC CICS ENDBR
 19591*            DATASET  (FILE-ID-ERPNDB4)
 19592*       END-EXEC.
 19593     MOVE 0
 19594       TO DFHEIV11
 19595*    MOVE '&2                    $   #00016733' TO DFHEIV0
 19596     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303136373333' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           FILE-ID-ERPNDB4,
 19601           DFHEIV11,
 19602           DFHEIV99
 19603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19604
 19605
 19606     IF  EIBTRNID NOT = TRANS-EXB1
 19607         IF PENDING-BUS-RECS-FOUND
 19608             NEXT SENTENCE
 19609           ELSE
 19610             MOVE '9'            TO PI-BROWSE-SW
 19611             GO TO 9400-CLEAR.
 19612
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 360
* EL6311.cbl
 19613     IF SHOW-RECORD
 19614        MOVE ER-2253            TO EMI-ERROR
 19615       ELSE
 19616        MOVE ER-2254            TO EMI-ERROR.
 19617
 19618     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19619
 19620     IF PI-MAP-NAME = SPACES
 19621        MOVE -1                  TO DPFENTRL
 19622        MOVE EL631D               TO PI-MAP-NAME
 19623        GO TO 8100-SEND-INITIAL-MAP.
 19624
 19625     IF PI-MAP-NAME = EL631B
 19626        MOVE -1                  TO BMAINTL
 19627     ELSE
 19628        IF PI-MAP-NAME = EL631C
 19629           MOVE -1               TO CMAINTL
 19630        ELSE
 19631           MOVE -1               TO DPFENTRL.
 19632
 19633     GO TO 8200-SEND-DATAONLY.
 19634
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 361
* EL6311.cbl
 19636
 19637***************************************************************
 19638*                                                             *
 19639*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19640*                                                             *
 19641*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19642*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19643*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19644*                                                             *
 19645*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19646*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19647*          A. IS IT WITHIN THE SAME COMPANY                   *
 19648*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19649*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19650*                AND IS IT TO BE DISPLAYED.                   *
 19651*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19652*                DISPLAYED.                                   *
 19653*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19654*                DISPLAYED.                                   *
 19655*                                                             *
 19656*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19657*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19658*                                                             *
 19659*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19660*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19661*                THEY ARE NOT TO BE DISPLAYED.                *
 19662*                                                             *
 19663***************************************************************
 19664
 19665 4300-BROWSE-FILE-FORWARD.
 19666     IF FIRST-TIME OR SHOW-RECORD
 19667        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19668        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19669        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19670     ELSE
 19671        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19672        IF ERPNDB-BATCH-SEQ-NO = +9999
 19673           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19674        ELSE
 19675           IF DISPLAY-CHANGE-RECORDS
 19676              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19677           ELSE
 19678              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19679              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19680
 19681
 19682* EXEC CICS HANDLE CONDITION
 19683*         ENDFILE  (4350-END-BATCH)
 19684*         NOTFND   (4350-END-BATCH)
 19685*    END-EXEC.
 19686*    MOVE '"$''I                  ! M #00016812' TO DFHEIV0
 19687     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19689     MOVE X'4D20233030303136383132' TO DFHEIV0(25:11)
 19690     CALL 'kxdfhei1' USING DFHEIV0
 19691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19692
 19693
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 362
* EL6311.cbl
 19694 4305-READ-NEXT.
 19695     IF PI-DISPLAY-ORIGINAL-BATCH
 19696        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19697     ELSE
 19698        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19699
 19700
 19701* EXEC CICS READ
 19702*         DATASET   (FILE-ID)
 19703*         SET       (ADDRESS OF PENDING-BUSINESS)
 19704*         RIDFLD    (ERPNDB-KEY)
 19705*         GTEQ
 19706*    END-EXEC.
 19707*    MOVE '&"S        G          (   #00016823' TO DFHEIV0
 19708     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19709     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19710     MOVE X'2020233030303136383233' TO DFHEIV0(25:11)
 19711     CALL 'kxdfhei1' USING DFHEIV0,
 19712           FILE-ID,
 19713           DFHEIV20,
 19714           DFHEIV99,
 19715           ERPNDB-KEY,
 19716           DFHEIV99,
 19717           DFHEIV99,
 19718           DFHEIV99
 19719     SET ADDRESS OF PENDING-BUSINESS TO
 19720         DFHEIV20
 19721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19722
 19723
 19724     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19725        GO TO 4350-END-BATCH.
 19726
 19727     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19728                                    WS-BATCH-NO.
 19729
 19730     IF  WS-BATCH-PREFIX = '#CL'
 19731         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19732         GO TO 4305-READ-NEXT.
 19733
 19734     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19735     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19736     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19737     MOVE PB-STATE               TO PI-PB-STATE.
 19738     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19739
 19740     IF PB-BATCH-TRAILER
 19741        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19742        GO TO 4305-READ-NEXT.
 19743
 19744     IF SHOW-RECORD
 19745           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19746              GO TO 4310-BUMP-SEQ
 19747           ELSE
 19748              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19749                 GO TO 4310-BUMP-SEQ
 19750              ELSE
 19751                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 363
* EL6311.cbl
 19752
 19753     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19754        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19755           GO TO 4310-BUMP-SEQ
 19756        ELSE
 19757           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19758              GO TO 4307-CHECK-REC-TYPE
 19759           ELSE
 19760              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19761                 GO TO 4307-CHECK-REC-TYPE
 19762              ELSE
 19763                 GO TO 4310-BUMP-SEQ.
 19764
 19765     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19766        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19767           GO TO 4310-BUMP-SEQ.
 19768
 19769 4307-CHECK-REC-TYPE.
 19770     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19771         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19772             NEXT SENTENCE
 19773         ELSE
 19774             GO TO 4310-BUMP-SEQ.
 19775
 19776     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19777         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19778             NEXT SENTENCE
 19779        ELSE
 19780             GO TO 4310-BUMP-SEQ.
 19781
 19782     IF NOT DISPLAY-CHANGE-RECORDS AND
 19783            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19784        GO TO 4310-BUMP-SEQ.
 19785
 19786     IF DISPLAY-HOLD-RECORDS AND
 19787        NOT PB-RECORD-ON-HOLD
 19788          GO TO 4310-BUMP-SEQ.
 19789
 19790     IF PB-ISSUE
 19791        IF DISPLAY-CHK-REQ-RECORDS
 19792           GO TO 4310-BUMP-SEQ.
 19793
 19794     IF PB-ISSUE
 19795        IF ISSUE-WITH-WARNING
 19796           IF PB-WARNING-ERRORS
 19797              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19798                  GO TO 4310-BUMP-SEQ
 19799              ELSE
 19800                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19801                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19802                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19803                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19804                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19805                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19806                 GO TO 7000-DISPLAY-ISSUES
 19807           ELSE
 19808              GO TO 4310-BUMP-SEQ.
 19809
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 364
* EL6311.cbl
 19810     IF PB-ISSUE
 19811        IF (ISSUES-IN-ERROR AND
 19812            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19813            ALL-ISSUES
 19814            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19815            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19816            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19817            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19818            MOVE PB-SV-STATE            TO PI-SV-STATE
 19819            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19820            GO TO 7000-DISPLAY-ISSUES
 19821        ELSE
 19822            GO TO 4310-BUMP-SEQ.
 19823
 19824     IF PB-CANCELLATION
 19825        IF DISPLAY-CHK-REQ-RECORDS
 19826           IF PB-C-REFUND-REQUESTED
 19827              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19828              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19829              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19830              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19831              MOVE PB-SV-STATE            TO PI-SV-STATE
 19832              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19833              GO TO 7100-DISPLAY-CANCELS
 19834           ELSE
 19835              GO TO 4310-BUMP-SEQ.
 19836
 19837     IF PB-CANCELLATION
 19838        IF CANCEL-WITH-WARNING
 19839           IF PB-WARNING-ERRORS
 19840              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19841                  GO TO 4310-BUMP-SEQ
 19842              ELSE
 19843                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19844                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19845                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19846                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19847                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19848                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19849                 GO TO 7100-DISPLAY-CANCELS
 19850           ELSE
 19851              GO TO 4310-BUMP-SEQ.
 19852
 19853     IF PB-CANCELLATION
 19854        IF (CANCEL-IN-ERROR  AND
 19855            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19856            ALL-CANCELS
 19857            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19858            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19859            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19860            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19861            MOVE PB-SV-STATE            TO PI-SV-STATE
 19862            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19863            GO TO 7100-DISPLAY-CANCELS.
 19864
 19865 4310-BUMP-SEQ.
 19866     IF NOT DISPLAY-CHANGE-RECORDS
 19867        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 365
* EL6311.cbl
 19868        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19869     ELSE
 19870        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19871           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19872           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19873        ELSE
 19874           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19875           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19876
 19877     GO TO 4305-READ-NEXT.
 19878
 19879 4350-END-BATCH.
 19880
 19881******************************************************************
 19882*                                                                *
 19883*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19884*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19885*         PROGRAM.                                               *
 19886*                                                                *
 19887******************************************************************
 19888
 19889     IF  EIBTRNID NOT = TRANS-EXB1
 19890         IF PENDING-BUS-RECS-FOUND
 19891             NEXT SENTENCE
 19892           ELSE
 19893             MOVE '9'            TO PI-BROWSE-SW
 19894             GO TO 9400-CLEAR.
 19895
 19896     IF SHOW-RECORD
 19897        MOVE ER-2253            TO EMI-ERROR
 19898     ELSE
 19899        MOVE ER-2251            TO EMI-ERROR.
 19900
 19901     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19902
 19903     IF PI-MAP-NAME = SPACES
 19904        MOVE -1                  TO BMAINTL
 19905        MOVE EL631B               TO PI-MAP-NAME
 19906        GO TO 8100-SEND-INITIAL-MAP.
 19907
 19908     IF PI-MAP-NAME = EL631B
 19909        MOVE -1                  TO BMAINTL
 19910     ELSE
 19911        IF PI-MAP-NAME = EL631C
 19912           MOVE -1               TO CMAINTL
 19913        ELSE
 19914           MOVE -1               TO DPFENTRL.
 19915
 19916     GO TO 8200-SEND-DATAONLY.
 19917
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 366
* EL6311.cbl
 19919
 19920******************************************************************
 19921*                                                                *
 19922*        B R O W S E   D E T A I L   B A C K W A R D             *
 19923*                                                                *
 19924******************************************************************
 19925
 19926 4500-BROWSE-DETAIL-BACKWARD.
 19927
 19928     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19929
 19930
 19931* EXEC CICS HANDLE CONDITION
 19932*         NOTFND   (4570-NOT-FOUND)
 19933*         ENDFILE  (4550-END-RECORDS)
 19934*    END-EXEC
 19935*    MOVE '"$I''                  ! N #00017036' TO DFHEIV0
 19936     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19938     MOVE X'4E20233030303137303336' TO DFHEIV0(25:11)
 19939     CALL 'kxdfhei1' USING DFHEIV0
 19940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19941
 19942
 19943* EXEC CICS STARTBR
 19944*         DATASET   (FILE-ID-ERPNDB2)
 19945*         RIDFLD    (ERPNDB-ALT-KEY)
 19946*    END-EXEC.
 19947     MOVE 0
 19948       TO DFHEIV11
 19949*    MOVE '&,         G          &   #00017041' TO DFHEIV0
 19950     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19952     MOVE X'2020233030303137303431' TO DFHEIV0(25:11)
 19953     CALL 'kxdfhei1' USING DFHEIV0,
 19954           FILE-ID-ERPNDB2,
 19955           ERPNDB-ALT-KEY,
 19956           DFHEIV99,
 19957           DFHEIV11,
 19958           DFHEIV99
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19963                                    WS-FIRST-TIME-SW.
 19964
 19965 4505-READ-PREV-RECORD.
 19966
 19967* EXEC CICS READPREV
 19968*         DATASET    (FILE-ID-ERPNDB2)
 19969*         SET        (ADDRESS OF PENDING-BUSINESS)
 19970*         RIDFLD     (ERPNDB-ALT-KEY)
 19971*    END-EXEC.
 19972     MOVE 0
 19973       TO DFHEIV11
 19974*    MOVE '&0S                   )   #00017050' TO DFHEIV0
 19975     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19976     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 367
* EL6311.cbl
 19977     MOVE X'2020233030303137303530' TO DFHEIV0(25:11)
 19978     CALL 'kxdfhei1' USING DFHEIV0,
 19979           FILE-ID-ERPNDB2,
 19980           DFHEIV20,
 19981           DFHEIV99,
 19982           ERPNDB-ALT-KEY,
 19983           DFHEIV99,
 19984           DFHEIV11,
 19985           DFHEIV99,
 19986           DFHEIV99
 19987     SET ADDRESS OF PENDING-BUSINESS TO
 19988         DFHEIV20
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19993
 19994     IF WS-BATCH-PREFIX = '#CL'
 19995         GO TO 4505-READ-PREV-RECORD.
 19996
 19997     IF FIRST-TIME
 19998         MOVE SPACE               TO WS-FIRST-TIME-SW
 19999         GO TO 4505-READ-PREV-RECORD.
 20000
 20001     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 20002        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 20003        PB-GROUPING      NOT = PI-PB-GROUPING OR
 20004        PB-STATE         NOT = PI-PB-STATE    OR
 20005        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 20006          GO TO 4550-END-RECORDS.
 20007
 20008
 20009     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20010
 20011     IF PB-BATCH-TRAILER
 20012        GO TO 4505-READ-PREV-RECORD.
 20013
 20014     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20015
 20016     IF  WS-BATCH-PREFIX = '#CL'
 20017         GO TO 4505-READ-PREV-RECORD.
 20018
 20019     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20020        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20021           GO TO 4505-READ-PREV-RECORD
 20022        ELSE
 20023           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20024              GO TO 4510-CHECK-REC-TYPE
 20025           ELSE
 20026              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20027                 GO TO 4510-CHECK-REC-TYPE
 20028              ELSE
 20029                 GO TO 4505-READ-PREV-RECORD.
 20030
 20031     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20032        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20033           GO TO 4505-READ-PREV-RECORD.
 20034
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 368
* EL6311.cbl
 20035 4510-CHECK-REC-TYPE.
 20036     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20037         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20038             NEXT SENTENCE
 20039         ELSE
 20040             GO TO 4505-READ-PREV-RECORD.
 20041
 20042     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20043         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20044             NEXT SENTENCE
 20045        ELSE
 20046             GO TO 4505-READ-PREV-RECORD.
 20047
 20048     IF NOT DISPLAY-CHANGE-RECORDS AND
 20049            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20050        GO TO 4505-READ-PREV-RECORD.
 20051
 20052     IF DISPLAY-HOLD-RECORDS AND
 20053        NOT PB-RECORD-ON-HOLD
 20054          GO TO 4505-READ-PREV-RECORD.
 20055
 20056     IF PB-ISSUE
 20057        IF DISPLAY-CHK-REQ-RECORDS
 20058           GO TO 4505-READ-PREV-RECORD.
 20059
 20060     IF PB-ISSUE
 20061        IF ISSUE-WITH-WARNING
 20062           IF PB-WARNING-ERRORS
 20063              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20064                  GO TO 4505-READ-PREV-RECORD
 20065              ELSE
 20066                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20067                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20068                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20069                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20070                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20071                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20072                 GO TO 7000-DISPLAY-ISSUES
 20073           ELSE
 20074              GO TO 4505-READ-PREV-RECORD.
 20075
 20076     IF PB-ISSUE
 20077        IF (ISSUES-IN-ERROR AND
 20078            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20079            ALL-ISSUES
 20080            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20081            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20082            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20083            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20084            MOVE PB-SV-STATE            TO PI-SV-STATE
 20085            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20086            GO TO 7000-DISPLAY-ISSUES
 20087        ELSE
 20088            GO TO 4505-READ-PREV-RECORD.
 20089
 20090     IF PB-CANCELLATION
 20091        IF DISPLAY-CHK-REQ-RECORDS
 20092           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 369
* EL6311.cbl
 20093              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20094              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20095              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20096              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20097              MOVE PB-SV-STATE            TO PI-SV-STATE
 20098              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20099              GO TO 7100-DISPLAY-CANCELS
 20100           ELSE
 20101              GO TO 4505-READ-PREV-RECORD.
 20102
 20103     IF PB-CANCELLATION
 20104        IF CANCEL-WITH-WARNING
 20105           IF PB-WARNING-ERRORS
 20106              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20107                  GO TO 4505-READ-PREV-RECORD
 20108              ELSE
 20109                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20110                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20111                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20112                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20113                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20114                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20115                 GO TO 7100-DISPLAY-CANCELS
 20116           ELSE
 20117              GO TO 4505-READ-PREV-RECORD.
 20118
 20119     IF PB-CANCELLATION
 20120        IF (CANCEL-IN-ERROR  AND
 20121            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20122            ALL-CANCELS
 20123            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20124            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20125            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20126            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20127            MOVE PB-SV-STATE            TO PI-SV-STATE
 20128            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20129            GO TO 7100-DISPLAY-CANCELS.
 20130
 20131     GO TO 4505-READ-PREV-RECORD.
 20132
 20133 4550-END-RECORDS.
 20134     IF PI-MAP-NAME = EL631B
 20135        MOVE -1                  TO BMAINTL
 20136     ELSE
 20137        IF PI-MAP-NAME = EL631C
 20138           MOVE -1               TO CMAINTL
 20139        ELSE
 20140           MOVE -1               TO DPFENTRL.
 20141
 20142     MOVE ER-2255               TO EMI-ERROR.
 20143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20144     GO TO 8200-SEND-DATAONLY.
 20145
 20146 4570-NOT-FOUND.
 20147
 20148******************************************************************
 20149*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20150******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 370
* EL6311.cbl
 20151
 20152
 20153* EXEC CICS RESETBR
 20154*         DATASET    (FILE-ID-ERPNDB2)
 20155*         RIDFLD     (ERPNDB-ALT-KEY)
 20156*    END-EXEC.
 20157     MOVE 0
 20158       TO DFHEIV11
 20159*    MOVE '&4         G          &   #00017216' TO DFHEIV0
 20160     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20161     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20162     MOVE X'2020233030303137323136' TO DFHEIV0(25:11)
 20163     CALL 'kxdfhei1' USING DFHEIV0,
 20164           FILE-ID-ERPNDB2,
 20165           ERPNDB-ALT-KEY,
 20166           DFHEIV99,
 20167           DFHEIV11,
 20168           DFHEIV99
 20169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20170
 20171
 20172
 20173* EXEC CICS READNEXT
 20174*         DATASET    (FILE-ID-ERPNDB2)
 20175*         SET        (ADDRESS OF PENDING-BUSINESS)
 20176*         RIDFLD     (ERPNDB-ALT-KEY)
 20177*    END-EXEC.
 20178     MOVE 0
 20179       TO DFHEIV11
 20180*    MOVE '&.S                   )   #00017221' TO DFHEIV0
 20181     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20182     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20183     MOVE X'2020233030303137323231' TO DFHEIV0(25:11)
 20184     CALL 'kxdfhei1' USING DFHEIV0,
 20185           FILE-ID-ERPNDB2,
 20186           DFHEIV20,
 20187           DFHEIV99,
 20188           ERPNDB-ALT-KEY,
 20189           DFHEIV99,
 20190           DFHEIV11,
 20191           DFHEIV99,
 20192           DFHEIV99
 20193     SET ADDRESS OF PENDING-BUSINESS TO
 20194         DFHEIV20
 20195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20196
 20197
 20198
 20199* EXEC CICS READPREV
 20200*         DATASET    (FILE-ID-ERPNDB2)
 20201*         SET        (ADDRESS OF PENDING-BUSINESS)
 20202*         RIDFLD     (ERPNDB-ALT-KEY)
 20203*    END-EXEC.
 20204     MOVE 0
 20205       TO DFHEIV11
 20206*    MOVE '&0S                   )   #00017227' TO DFHEIV0
 20207     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 371
* EL6311.cbl
 20209     MOVE X'2020233030303137323237' TO DFHEIV0(25:11)
 20210     CALL 'kxdfhei1' USING DFHEIV0,
 20211           FILE-ID-ERPNDB2,
 20212           DFHEIV20,
 20213           DFHEIV99,
 20214           ERPNDB-ALT-KEY,
 20215           DFHEIV99,
 20216           DFHEIV11,
 20217           DFHEIV99,
 20218           DFHEIV99
 20219     SET ADDRESS OF PENDING-BUSINESS TO
 20220         DFHEIV20
 20221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20222
 20223
 20224 4580-READ-PREV-RECORD.
 20225
 20226* EXEC CICS READPREV
 20227*         DATASET    (FILE-ID-ERPNDB2)
 20228*         SET        (ADDRESS OF PENDING-BUSINESS)
 20229*         RIDFLD     (ERPNDB-ALT-KEY)
 20230*    END-EXEC.
 20231     MOVE 0
 20232       TO DFHEIV11
 20233*    MOVE '&0S                   )   #00017234' TO DFHEIV0
 20234     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20236     MOVE X'2020233030303137323334' TO DFHEIV0(25:11)
 20237     CALL 'kxdfhei1' USING DFHEIV0,
 20238           FILE-ID-ERPNDB2,
 20239           DFHEIV20,
 20240           DFHEIV99,
 20241           ERPNDB-ALT-KEY,
 20242           DFHEIV99,
 20243           DFHEIV11,
 20244           DFHEIV99,
 20245           DFHEIV99
 20246     SET ADDRESS OF PENDING-BUSINESS TO
 20247         DFHEIV20
 20248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20249
 20250
 20251     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20252
 20253     IF WS-BATCH-PREFIX = '#CL'
 20254        GO TO 4580-READ-PREV-RECORD.
 20255
 20256     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20257     GO TO 4505-READ-PREV-RECORD.
 20258
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 372
* EL6311.cbl
 20260
 20261******************************************************************
 20262*                                                                *
 20263*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20264*                                                                *
 20265******************************************************************
 20266
 20267 4600-BROWSE-PRIMARY-BACKWARD.
 20268        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20269
 20270     IF ERPNDB-BATCH-SEQ-NO = +9999
 20271        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20272
 20273        IF ERPNDB-BATCH-SEQ-NO = +0000
 20274           GO TO 4650-END-BATCH
 20275        ELSE
 20276           IF PI-MAP-NAME NOT = EL631D
 20277              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20278                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20279              ELSE
 20280                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20281                 IF DISPLAY-CHANGE-RECORDS
 20282                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20283                 ELSE
 20284                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20285
 20286
 20287* EXEC CICS HANDLE CONDITION
 20288*         NOTFND    (4680-NOT-FOUND)
 20289*         ENDFILE   (4680-NOT-FOUND)
 20290*    END-EXEC.
 20291*    MOVE '"$I''                  ! O #00017275' TO DFHEIV0
 20292     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20294     MOVE X'4F20233030303137323735' TO DFHEIV0(25:11)
 20295     CALL 'kxdfhei1' USING DFHEIV0
 20296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20297
 20298
 20299 4605-READ-NEXT.
 20300     IF ERPNDB-BATCH-SEQ-NO = +0000
 20301        GO TO 4650-END-BATCH.
 20302
 20303     IF PI-DISPLAY-ORIGINAL-BATCH
 20304        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20305     ELSE
 20306        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20307
 20308
 20309* EXEC CICS READ
 20310*         DATASET   (FILE-ID)
 20311*         SET       (ADDRESS OF PENDING-BUSINESS)
 20312*         RIDFLD    (ERPNDB-KEY)
 20313*    END-EXEC.
 20314*    MOVE '&"S        E          (   #00017289' TO DFHEIV0
 20315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303137323839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 373
* EL6311.cbl
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           FILE-ID,
 20320           DFHEIV20,
 20321           DFHEIV99,
 20322           ERPNDB-KEY,
 20323           DFHEIV99,
 20324           DFHEIV99,
 20325           DFHEIV99
 20326     SET ADDRESS OF PENDING-BUSINESS TO
 20327         DFHEIV20
 20328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20329
 20330
 20331     IF NOT  PI-PRIMARY-WITH-SELECT
 20332        GO TO 4607-CHECK-REC-TYPE.
 20333
 20334     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20335
 20336     IF  WS-BATCH-PREFIX = '#CL'
 20337         GO TO 4610-BUMP-SEQ.
 20338
 20339     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20340        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20341           GO TO 4610-BUMP-SEQ
 20342        ELSE
 20343           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20344              GO TO 4607-CHECK-REC-TYPE
 20345           ELSE
 20346              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20347                 GO TO 4607-CHECK-REC-TYPE
 20348              ELSE
 20349                 GO TO 4610-BUMP-SEQ.
 20350
 20351     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20352        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20353           GO TO 4610-BUMP-SEQ.
 20354
 20355 4607-CHECK-REC-TYPE.
 20356     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20357         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20358             NEXT SENTENCE
 20359         ELSE
 20360             GO TO 4610-BUMP-SEQ.
 20361
 20362     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20363         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20364             NEXT SENTENCE
 20365        ELSE
 20366             GO TO 4610-BUMP-SEQ.
 20367
 20368     IF NOT DISPLAY-CHANGE-RECORDS AND
 20369            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20370        GO TO 4610-BUMP-SEQ.
 20371
 20372     IF DISPLAY-HOLD-RECORDS AND
 20373        NOT PB-RECORD-ON-HOLD
 20374          GO TO 4610-BUMP-SEQ.
 20375
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 374
* EL6311.cbl
 20376     IF PB-ISSUE
 20377        IF DISPLAY-CHK-REQ-RECORDS
 20378           GO TO 4610-BUMP-SEQ.
 20379
 20380     IF PB-ISSUE
 20381        IF ISSUE-WITH-WARNING
 20382           IF PB-WARNING-ERRORS
 20383              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20384                  GO TO 4610-BUMP-SEQ
 20385              ELSE
 20386                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20387                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20388                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20389                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20390                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20391                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20392                 GO TO 7000-DISPLAY-ISSUES
 20393           ELSE
 20394              GO TO 4610-BUMP-SEQ.
 20395
 20396     IF PB-ISSUE
 20397        IF (ISSUES-IN-ERROR AND
 20398            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20399            ALL-ISSUES
 20400            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20401            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20402            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20403            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20404            MOVE PB-SV-STATE            TO PI-SV-STATE
 20405            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20406            GO TO 7000-DISPLAY-ISSUES
 20407        ELSE
 20408            GO TO 4610-BUMP-SEQ.
 20409
 20410     IF PB-CANCELLATION
 20411        IF DISPLAY-CHK-REQ-RECORDS
 20412           IF PB-C-REFUND-REQUESTED
 20413              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20414              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20415              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20416              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20417              MOVE PB-SV-STATE            TO PI-SV-STATE
 20418              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20419              GO TO 7100-DISPLAY-CANCELS
 20420           ELSE
 20421              GO TO 4610-BUMP-SEQ.
 20422
 20423     IF PB-CANCELLATION
 20424        IF CANCEL-WITH-WARNING
 20425           IF PB-WARNING-ERRORS
 20426              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20427                  GO TO 4610-BUMP-SEQ
 20428              ELSE
 20429                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20430                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20431                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20432                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20433                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 375
* EL6311.cbl
 20434                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20435                 GO TO 7100-DISPLAY-CANCELS
 20436           ELSE
 20437              GO TO 4610-BUMP-SEQ.
 20438
 20439     IF PB-CANCELLATION
 20440        IF (CANCEL-IN-ERROR  AND
 20441            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20442            ALL-CANCELS
 20443            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20444            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20445            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20446            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20447            MOVE PB-SV-STATE            TO PI-SV-STATE
 20448            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20449            GO TO 7100-DISPLAY-CANCELS.
 20450
 20451 4610-BUMP-SEQ.
 20452     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20453        GO TO 4650-END-BATCH.
 20454
 20455     IF DISPLAY-CHANGE-RECORDS
 20456        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20457           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20458        ELSE
 20459           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20460           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20461        ELSE
 20462           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20463           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20464
 20465        GO TO 4605-READ-NEXT.
 20466
 20467 4650-END-BATCH.
 20468     IF PI-MAP-NAME = EL631B
 20469        MOVE -1                  TO BMAINTL
 20470     ELSE
 20471        IF PI-MAP-NAME = EL631C
 20472           MOVE -1               TO CMAINTL
 20473        ELSE
 20474           MOVE -1               TO DPFENTRL.
 20475
 20476     MOVE ER-2252               TO EMI-ERROR.
 20477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20478     GO TO 8200-SEND-DATAONLY.
 20479
 20480 4680-NOT-FOUND.
 20481     IF DISPLAY-CHANGE-RECORDS
 20482        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20483           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20484        ELSE
 20485           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20486           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20487     ELSE
 20488        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20489
 20490     GO TO 4605-READ-NEXT.
 20491
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 376
* EL6311.cbl
 20493
 20494******************************************************************
 20495*                                                                *
 20496*        B R O W S E   F I L E   B A C K W A R D S               *
 20497*                                                                *
 20498******************************************************************
 20499
 20500 4800-BROWSE-FILE-BACKWARD.
 20501
 20502* EXEC CICS HANDLE CONDITION
 20503*         NOTFND   (4860-NOT-FOUND)
 20504*         ENDFILE  (4850-END-RECORDS)
 20505*    END-EXEC.
 20506*    MOVE '"$I''                  ! P #00017465' TO DFHEIV0
 20507     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20509     MOVE X'5020233030303137343635' TO DFHEIV0(25:11)
 20510     CALL 'kxdfhei1' USING DFHEIV0
 20511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20512
 20513
 20514     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20515
 20516     IF PI-DISPLAY-ORIGINAL-BATCH
 20517        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20518     ELSE
 20519        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20520
 20521
 20522* EXEC CICS STARTBR
 20523*         DATASET   (FILE-ID)
 20524*         RIDFLD    (ERPNDB-KEY)
 20525*    END-EXEC.
 20526     MOVE 0
 20527       TO DFHEIV11
 20528*    MOVE '&,         G          &   #00017477' TO DFHEIV0
 20529     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20530     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20531     MOVE X'2020233030303137343737' TO DFHEIV0(25:11)
 20532     CALL 'kxdfhei1' USING DFHEIV0,
 20533           FILE-ID,
 20534           ERPNDB-KEY,
 20535           DFHEIV99,
 20536           DFHEIV11,
 20537           DFHEIV99
 20538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20539
 20540
 20541     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20542
 20543
 20544* EXEC CICS READPREV
 20545*         DATASET    (FILE-ID-ERPNDB)
 20546*         SET        (ADDRESS OF PENDING-BUSINESS)
 20547*         RIDFLD     (ERPNDB-KEY)
 20548*    END-EXEC.
 20549     MOVE 0
 20550       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 377
* EL6311.cbl
 20551*    MOVE '&0S                   )   #00017484' TO DFHEIV0
 20552     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20554     MOVE X'2020233030303137343834' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0,
 20556           FILE-ID-ERPNDB,
 20557           DFHEIV20,
 20558           DFHEIV99,
 20559           ERPNDB-KEY,
 20560           DFHEIV99,
 20561           DFHEIV11,
 20562           DFHEIV99,
 20563           DFHEIV99
 20564     SET ADDRESS OF PENDING-BUSINESS TO
 20565         DFHEIV20
 20566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20567
 20568
 20569 4810-READ-PREV-RECORD.
 20570
 20571* EXEC CICS READPREV
 20572*         DATASET    (FILE-ID-ERPNDB)
 20573*         SET        (ADDRESS OF PENDING-BUSINESS)
 20574*         RIDFLD     (ERPNDB-KEY)
 20575*    END-EXEC.
 20576     MOVE 0
 20577       TO DFHEIV11
 20578*    MOVE '&0S                   )   #00017491' TO DFHEIV0
 20579     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20581     MOVE X'2020233030303137343931' TO DFHEIV0(25:11)
 20582     CALL 'kxdfhei1' USING DFHEIV0,
 20583           FILE-ID-ERPNDB,
 20584           DFHEIV20,
 20585           DFHEIV99,
 20586           ERPNDB-KEY,
 20587           DFHEIV99,
 20588           DFHEIV11,
 20589           DFHEIV99,
 20590           DFHEIV99
 20591     SET ADDRESS OF PENDING-BUSINESS TO
 20592         DFHEIV20
 20593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20594
 20595
 20596     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20597        GO TO 4850-END-RECORDS.
 20598
 20599     IF PB-BATCH-TRAILER
 20600        GO TO 4810-READ-PREV-RECORD.
 20601
 20602     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20603
 20604     IF  WS-BATCH-PREFIX = '#CL'
 20605         GO TO 4810-READ-PREV-RECORD.
 20606
 20607     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20608        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 378
* EL6311.cbl
 20609           GO TO 4810-READ-PREV-RECORD
 20610        ELSE
 20611           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20612              GO TO 4820-CHECK-REC-TYPE
 20613           ELSE
 20614              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20615                 GO TO 4820-CHECK-REC-TYPE
 20616              ELSE
 20617                 GO TO 4810-READ-PREV-RECORD.
 20618
 20619     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20620        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20621           GO TO 4810-READ-PREV-RECORD.
 20622
 20623 4820-CHECK-REC-TYPE.
 20624     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20625         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20626             NEXT SENTENCE
 20627         ELSE
 20628             GO TO 4810-READ-PREV-RECORD.
 20629
 20630     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20631         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20632             NEXT SENTENCE
 20633        ELSE
 20634             GO TO 4810-READ-PREV-RECORD.
 20635
 20636     IF NOT DISPLAY-CHANGE-RECORDS AND
 20637            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20638        GO TO 4810-READ-PREV-RECORD.
 20639
 20640     IF DISPLAY-HOLD-RECORDS AND
 20641        NOT PB-RECORD-ON-HOLD
 20642          GO TO 4810-READ-PREV-RECORD.
 20643
 20644     IF PB-ISSUE
 20645        IF DISPLAY-CHK-REQ-RECORDS
 20646           GO TO 4810-READ-PREV-RECORD.
 20647
 20648     IF PB-ISSUE
 20649        IF ISSUE-WITH-WARNING
 20650           IF PB-WARNING-ERRORS
 20651              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20652                  GO TO 4810-READ-PREV-RECORD
 20653              ELSE
 20654                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20655                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20656                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20657                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20658                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20659                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20660                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20661                 GO TO 7000-DISPLAY-ISSUES
 20662           ELSE
 20663              GO TO 4810-READ-PREV-RECORD.
 20664
 20665     IF PB-ISSUE
 20666        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 379
* EL6311.cbl
 20667            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20668            ALL-ISSUES
 20669            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20670            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20671            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20672            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20673            MOVE PB-SV-STATE            TO PI-SV-STATE
 20674            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20675            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20676            GO TO 7000-DISPLAY-ISSUES
 20677        ELSE
 20678            GO TO 4810-READ-PREV-RECORD.
 20679
 20680     IF PB-CANCELLATION
 20681        IF DISPLAY-CHK-REQ-RECORDS
 20682           IF PB-C-REFUND-REQUESTED
 20683              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20684              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20685              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20686              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20687              MOVE PB-SV-STATE            TO PI-SV-STATE
 20688              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20689              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20690              GO TO 7100-DISPLAY-CANCELS
 20691           ELSE
 20692              GO TO 4810-READ-PREV-RECORD.
 20693
 20694     IF PB-CANCELLATION
 20695        IF CANCEL-WITH-WARNING
 20696           IF PB-WARNING-ERRORS
 20697              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20698                  GO TO 4810-READ-PREV-RECORD
 20699              ELSE
 20700                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20701                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20702                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20703                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20704                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20705                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20706                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20707                 GO TO 7100-DISPLAY-CANCELS
 20708           ELSE
 20709              GO TO 4810-READ-PREV-RECORD.
 20710
 20711     IF PB-CANCELLATION
 20712        IF (CANCEL-IN-ERROR  AND
 20713            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20714            ALL-CANCELS
 20715            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20716            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20717            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20718            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20719            MOVE PB-SV-STATE            TO PI-SV-STATE
 20720            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20721            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20722            GO TO 7100-DISPLAY-CANCELS.
 20723
 20724     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 380
* EL6311.cbl
 20725
 20726 4850-END-RECORDS.
 20727     MOVE ER-2252                TO EMI-ERROR.
 20728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20729
 20730     IF PI-MAP-NAME = EL631B
 20731        MOVE -1                  TO BPFENTRL
 20732     ELSE
 20733        MOVE -1                  TO CPFENTRL.
 20734
 20735     GO TO 8200-SEND-DATAONLY.
 20736
 20737 4860-NOT-FOUND.
 20738
 20739******************************************************************
 20740*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20741******************************************************************
 20742
 20743
 20744* EXEC CICS RESETBR
 20745*         DATASET    (FILE-ID-ERPNDB)
 20746*         RIDFLD     (ERPNDB-KEY)
 20747*     END-EXEC.
 20748     MOVE 0
 20749       TO DFHEIV11
 20750*    MOVE '&4         G          &   #00017644' TO DFHEIV0
 20751     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20753     MOVE X'2020233030303137363434' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           FILE-ID-ERPNDB,
 20756           ERPNDB-KEY,
 20757           DFHEIV99,
 20758           DFHEIV11,
 20759           DFHEIV99
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763
 20764* EXEC CICS READNEXT
 20765*         DATASET    (FILE-ID-ERPNDB)
 20766*         SET        (ADDRESS OF PENDING-BUSINESS)
 20767*         RIDFLD     (ERPNDB-KEY)
 20768*    END-EXEC.
 20769     MOVE 0
 20770       TO DFHEIV11
 20771*    MOVE '&.S                   )   #00017649' TO DFHEIV0
 20772     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20773     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20774     MOVE X'2020233030303137363439' TO DFHEIV0(25:11)
 20775     CALL 'kxdfhei1' USING DFHEIV0,
 20776           FILE-ID-ERPNDB,
 20777           DFHEIV20,
 20778           DFHEIV99,
 20779           ERPNDB-KEY,
 20780           DFHEIV99,
 20781           DFHEIV11,
 20782           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 381
* EL6311.cbl
 20783           DFHEIV99
 20784     SET ADDRESS OF PENDING-BUSINESS TO
 20785         DFHEIV20
 20786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20787
 20788
 20789
 20790* EXEC CICS READPREV
 20791*         DATASET    (FILE-ID-ERPNDB)
 20792*         SET        (ADDRESS OF PENDING-BUSINESS)
 20793*         RIDFLD     (ERPNDB-KEY)
 20794*    END-EXEC.
 20795     MOVE 0
 20796       TO DFHEIV11
 20797*    MOVE '&0S                   )   #00017655' TO DFHEIV0
 20798     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303137363535' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           FILE-ID-ERPNDB,
 20803           DFHEIV20,
 20804           DFHEIV99,
 20805           ERPNDB-KEY,
 20806           DFHEIV99,
 20807           DFHEIV11,
 20808           DFHEIV99,
 20809           DFHEIV99
 20810     SET ADDRESS OF PENDING-BUSINESS TO
 20811         DFHEIV20
 20812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20813
 20814
 20815     GO TO 4810-READ-PREV-RECORD.
 20816
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 382
* EL6311.cbl
 20818
 20819******************************************************************
 20820*                                                                *
 20821*           B R O W S E   C S R   B A C K W A R D                *
 20822*                                                                *
 20823******************************************************************
 20824
 20825 4900-BROWSE-CSR-BACKWARD.
 20826
 20827     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20828
 20829
 20830* EXEC CICS HANDLE CONDITION
 20831*         NOTFND   (4970-NOT-FOUND)
 20832*         ENDFILE  (4950-END-RECORDS)
 20833*    END-EXEC
 20834*    MOVE '"$I''                  ! Q #00017675' TO DFHEIV0
 20835     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20837     MOVE X'5120233030303137363735' TO DFHEIV0(25:11)
 20838     CALL 'kxdfhei1' USING DFHEIV0
 20839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20840
 20841
 20842* EXEC CICS STARTBR
 20843*         DATASET   (FILE-ID-ERPNDB4)
 20844*         RIDFLD    (ERPNDB-CSR-KEY)
 20845*    END-EXEC.
 20846     MOVE 0
 20847       TO DFHEIV11
 20848*    MOVE '&,         G          &   #00017680' TO DFHEIV0
 20849     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20850     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20851     MOVE X'2020233030303137363830' TO DFHEIV0(25:11)
 20852     CALL 'kxdfhei1' USING DFHEIV0,
 20853           FILE-ID-ERPNDB4,
 20854           ERPNDB-CSR-KEY,
 20855           DFHEIV99,
 20856           DFHEIV11,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20859
 20860
 20861     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20862                                    WS-FIRST-TIME-SW.
 20863
 20864 4905-READ-PREV-RECORD.
 20865
 20866* EXEC CICS READPREV
 20867*         DATASET    (FILE-ID-ERPNDB4)
 20868*         SET        (ADDRESS OF PENDING-BUSINESS)
 20869*         RIDFLD     (ERPNDB-CSR-KEY)
 20870*    END-EXEC.
 20871     MOVE 0
 20872       TO DFHEIV11
 20873*    MOVE '&0S                   )   #00017689' TO DFHEIV0
 20874     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20875     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 383
* EL6311.cbl
 20876     MOVE X'2020233030303137363839' TO DFHEIV0(25:11)
 20877     CALL 'kxdfhei1' USING DFHEIV0,
 20878           FILE-ID-ERPNDB4,
 20879           DFHEIV20,
 20880           DFHEIV99,
 20881           ERPNDB-CSR-KEY,
 20882           DFHEIV99,
 20883           DFHEIV11,
 20884           DFHEIV99,
 20885           DFHEIV99
 20886     SET ADDRESS OF PENDING-BUSINESS TO
 20887         DFHEIV20
 20888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20889
 20890
 20891     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20892
 20893     IF WS-BATCH-PREFIX = '#CL'
 20894         GO TO 4905-READ-PREV-RECORD.
 20895
 20896     IF FIRST-TIME
 20897         MOVE SPACE               TO WS-FIRST-TIME-SW
 20898         GO TO 4905-READ-PREV-RECORD.
 20899
 20900     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20901        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20902        GO TO 4950-END-RECORDS.
 20903
 20904     IF PB-BATCH-TRAILER
 20905        GO TO 4905-READ-PREV-RECORD.
 20906
 20907     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20908
 20909     IF  WS-BATCH-PREFIX = '#CL'
 20910         GO TO 4905-READ-PREV-RECORD.
 20911
 20912     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20913        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20914           GO TO 4905-READ-PREV-RECORD
 20915        ELSE
 20916           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20917              GO TO 4910-CHECK-REC-TYPE
 20918           ELSE
 20919              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20920                 GO TO 4910-CHECK-REC-TYPE
 20921              ELSE
 20922                 GO TO 4905-READ-PREV-RECORD.
 20923
 20924     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20925        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20926           GO TO 4905-READ-PREV-RECORD.
 20927
 20928 4910-CHECK-REC-TYPE.
 20929     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20930         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20931             NEXT SENTENCE
 20932         ELSE
 20933             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 384
* EL6311.cbl
 20934
 20935     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20936         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20937             NEXT SENTENCE
 20938        ELSE
 20939             GO TO 4905-READ-PREV-RECORD.
 20940
 20941     IF NOT DISPLAY-CHANGE-RECORDS AND
 20942            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20943        GO TO 4905-READ-PREV-RECORD.
 20944
 20945     IF DISPLAY-HOLD-RECORDS AND
 20946        NOT PB-RECORD-ON-HOLD
 20947          GO TO 4905-READ-PREV-RECORD.
 20948
 20949     IF PB-ISSUE
 20950        IF DISPLAY-CHK-REQ-RECORDS
 20951           GO TO 4905-READ-PREV-RECORD.
 20952
 20953     IF PB-ISSUE
 20954        IF ISSUE-WITH-WARNING
 20955           IF PB-WARNING-ERRORS
 20956              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20957                  GO TO 4505-READ-PREV-RECORD
 20958              ELSE
 20959                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20960                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20961                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20962                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20963                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20964                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20965                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20966                 GO TO 7000-DISPLAY-ISSUES
 20967           ELSE
 20968              GO TO 4905-READ-PREV-RECORD.
 20969
 20970     IF PB-ISSUE
 20971        IF (ISSUES-IN-ERROR AND
 20972            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20973            ALL-ISSUES
 20974            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20975            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20976            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20977            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20978            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20979            MOVE PB-SV-STATE            TO PI-SV-STATE
 20980            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20981            GO TO 7000-DISPLAY-ISSUES
 20982        ELSE
 20983            GO TO 4905-READ-PREV-RECORD.
 20984
 20985     IF PB-CANCELLATION
 20986        IF DISPLAY-CHK-REQ-RECORDS
 20987           IF PB-C-REFUND-REQUESTED
 20988              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20989              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20990              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20991              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 385
* EL6311.cbl
 20992              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20993              MOVE PB-SV-STATE            TO PI-SV-STATE
 20994              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20995              GO TO 7100-DISPLAY-CANCELS
 20996           ELSE
 20997              GO TO 4905-READ-PREV-RECORD.
 20998
 20999     IF PB-CANCELLATION
 21000        IF CANCEL-WITH-WARNING
 21001           IF PB-WARNING-ERRORS
 21002              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 21003                  GO TO 4505-READ-PREV-RECORD
 21004              ELSE
 21005                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21006                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21007                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21008                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21009                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21010                 MOVE PB-SV-STATE            TO PI-SV-STATE
 21011                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21012                 GO TO 7100-DISPLAY-CANCELS
 21013           ELSE
 21014              GO TO 4905-READ-PREV-RECORD.
 21015
 21016     IF PB-CANCELLATION
 21017        IF (CANCEL-IN-ERROR  AND
 21018            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 21019            ALL-CANCELS
 21020            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 21021            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 21022            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21023            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 21024            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 21025            MOVE PB-SV-STATE            TO PI-SV-STATE
 21026            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21027            GO TO 7100-DISPLAY-CANCELS.
 21028
 21029     GO TO 4905-READ-PREV-RECORD.
 21030
 21031 4950-END-RECORDS.
 21032     IF PI-MAP-NAME = EL631B
 21033        MOVE -1                  TO BMAINTL
 21034     ELSE
 21035        IF PI-MAP-NAME = EL631C
 21036           MOVE -1               TO CMAINTL
 21037        ELSE
 21038           MOVE -1               TO DPFENTRL.
 21039
 21040     MOVE ER-2255               TO EMI-ERROR.
 21041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21042     GO TO 8200-SEND-DATAONLY.
 21043
 21044 4970-NOT-FOUND.
 21045
 21046******************************************************************
 21047*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21048******************************************************************
 21049
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 386
* EL6311.cbl
 21050
 21051* EXEC CICS RESETBR
 21052*         DATASET    (FILE-ID-ERPNDB4)
 21053*         RIDFLD     (ERPNDB-CSR-KEY)
 21054*    END-EXEC.
 21055     MOVE 0
 21056       TO DFHEIV11
 21057*    MOVE '&4         G          &   #00017854' TO DFHEIV0
 21058     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303137383534' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           FILE-ID-ERPNDB4,
 21063           ERPNDB-CSR-KEY,
 21064           DFHEIV99,
 21065           DFHEIV11,
 21066           DFHEIV99
 21067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21068
 21069
 21070
 21071* EXEC CICS READNEXT
 21072*         DATASET    (FILE-ID-ERPNDB4)
 21073*         SET        (ADDRESS OF PENDING-BUSINESS)
 21074*         RIDFLD     (ERPNDB-CSR-KEY)
 21075*    END-EXEC.
 21076     MOVE 0
 21077       TO DFHEIV11
 21078*    MOVE '&.S                   )   #00017859' TO DFHEIV0
 21079     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21080     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21081     MOVE X'2020233030303137383539' TO DFHEIV0(25:11)
 21082     CALL 'kxdfhei1' USING DFHEIV0,
 21083           FILE-ID-ERPNDB4,
 21084           DFHEIV20,
 21085           DFHEIV99,
 21086           ERPNDB-CSR-KEY,
 21087           DFHEIV99,
 21088           DFHEIV11,
 21089           DFHEIV99,
 21090           DFHEIV99
 21091     SET ADDRESS OF PENDING-BUSINESS TO
 21092         DFHEIV20
 21093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21094
 21095
 21096
 21097* EXEC CICS READPREV
 21098*         DATASET    (FILE-ID-ERPNDB4)
 21099*         SET        (ADDRESS OF PENDING-BUSINESS)
 21100*         RIDFLD     (ERPNDB-CSR-KEY)
 21101*    END-EXEC.
 21102     MOVE 0
 21103       TO DFHEIV11
 21104*    MOVE '&0S                   )   #00017865' TO DFHEIV0
 21105     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21107     MOVE X'2020233030303137383635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 387
* EL6311.cbl
 21108     CALL 'kxdfhei1' USING DFHEIV0,
 21109           FILE-ID-ERPNDB4,
 21110           DFHEIV20,
 21111           DFHEIV99,
 21112           ERPNDB-CSR-KEY,
 21113           DFHEIV99,
 21114           DFHEIV11,
 21115           DFHEIV99,
 21116           DFHEIV99
 21117     SET ADDRESS OF PENDING-BUSINESS TO
 21118         DFHEIV20
 21119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21120
 21121
 21122 4980-READ-PREV-RECORD.
 21123
 21124* EXEC CICS READPREV
 21125*         DATASET    (FILE-ID-ERPNDB4)
 21126*         SET        (ADDRESS OF PENDING-BUSINESS)
 21127*         RIDFLD     (ERPNDB-CSR-KEY)
 21128*    END-EXEC.
 21129     MOVE 0
 21130       TO DFHEIV11
 21131*    MOVE '&0S                   )   #00017872' TO DFHEIV0
 21132     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21133     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21134     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 21135     CALL 'kxdfhei1' USING DFHEIV0,
 21136           FILE-ID-ERPNDB4,
 21137           DFHEIV20,
 21138           DFHEIV99,
 21139           ERPNDB-CSR-KEY,
 21140           DFHEIV99,
 21141           DFHEIV11,
 21142           DFHEIV99,
 21143           DFHEIV99
 21144     SET ADDRESS OF PENDING-BUSINESS TO
 21145         DFHEIV20
 21146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21147
 21148
 21149     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21150
 21151     IF WS-BATCH-PREFIX = '#CL'
 21152        GO TO 4980-READ-PREV-RECORD.
 21153
 21154     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21155     GO TO 4905-READ-PREV-RECORD.
 21156
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 388
* EL6311.cbl
 21158
 21159
 21160******************************************************************
 21161*                                                                *
 21162*        B R O W S E   B A T C H   H E A D E R S                 *
 21163*                                                                *
 21164******************************************************************
 21165
 21166 5000-BROWSE-BATCH-HEADERS.
 21167
 21168     IF EIBTRNID NOT = TRANS-EXB1
 21169        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21170        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21171        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21172        GO TO 5010-READ-NEXT-RECORD.
 21173
 21174     IF EIBAID = DFHPF4
 21175        MOVE '0'                TO PI-EDIT-SW
 21176        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21177        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21178        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21179        GO TO 5010-READ-NEXT-RECORD.
 21180
 21181     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21182     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21183     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21184
 21185
 21186* EXEC CICS HANDLE CONDITION
 21187*         ENDFILE  (5050-NOT-FOUND)
 21188*    END-EXEC.
 21189*    MOVE '"$''                   ! R #00017914' TO DFHEIV0
 21190     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21192     MOVE X'5220233030303137393134' TO DFHEIV0(25:11)
 21193     CALL 'kxdfhei1' USING DFHEIV0
 21194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21195
 21196
 21197 5010-READ-NEXT-RECORD.
 21198
 21199* EXEC CICS HANDLE CONDITION
 21200*         NOTFND    (5050-NOT-FOUND)
 21201*    END-EXEC.
 21202*    MOVE '"$I                   ! S #00017919' TO DFHEIV0
 21203     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21205     MOVE X'5320233030303137393139' TO DFHEIV0(25:11)
 21206     CALL 'kxdfhei1' USING DFHEIV0
 21207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21208
 21209
 21210
 21211* EXEC CICS READ
 21212*         DATASET   (FILE-ID-ERPNDB)
 21213*         SET       (ADDRESS OF PENDING-BUSINESS)
 21214*         RIDFLD    (ERPNDB-KEY)
 21215*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 389
* EL6311.cbl
 21216*    END-EXEC.
 21217*    MOVE '&"S        G          (   #00017923' TO DFHEIV0
 21218     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21220     MOVE X'2020233030303137393233' TO DFHEIV0(25:11)
 21221     CALL 'kxdfhei1' USING DFHEIV0,
 21222           FILE-ID-ERPNDB,
 21223           DFHEIV20,
 21224           DFHEIV99,
 21225           ERPNDB-KEY,
 21226           DFHEIV99,
 21227           DFHEIV99,
 21228           DFHEIV99
 21229     SET ADDRESS OF PENDING-BUSINESS TO
 21230         DFHEIV20
 21231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21232
 21233
 21234     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21235         GO TO 5050-NOT-FOUND.
 21236
 21237     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21238
 21239     IF WS-BATCH-PREFIX = '#CL'
 21240         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21241         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21242         GO TO 5010-READ-NEXT-RECORD.
 21243
 21244     IF NOT PB-BATCH-TRAILER
 21245         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21246         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21247         GO TO 5010-READ-NEXT-RECORD.
 21248
 21249     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21250         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21251             NEXT SENTENCE
 21252         ELSE
 21253             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21254             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21255             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21256             GO TO 5010-READ-NEXT-RECORD.
 21257
 21258     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21259         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21260             NEXT SENTENCE
 21261        ELSE
 21262             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21263             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21264             GO TO 5010-READ-NEXT-RECORD.
 21265
 21266     IF EIBAID = DFHPF4
 21267        MOVE '0'                TO PI-EDIT-SW
 21268        GO TO 7200-DISPLAY-BATCHES.
 21269
 21270     IF PI-CSR-BROWSE
 21271        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21272           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21273           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 390
* EL6311.cbl
 21274           GO TO 5010-READ-NEXT-RECORD.
 21275
 21276     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21277       IF PI-PB-CARRIER    = SPACES AND
 21278          PI-PB-GROUPING   = SPACES AND
 21279          PI-PB-STATE      = SPACES AND
 21280          PI-PB-ACCOUNT    = SPACES
 21281            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21282            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21283            GO TO 7200-DISPLAY-BATCHES
 21284         ELSE
 21285           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21286              PI-PB-GROUPING   = PB-GROUPING AND
 21287              PI-PB-STATE      = PB-STATE    AND
 21288              PI-PB-ACCOUNT    = PB-ACCOUNT
 21289              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21290              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21291              GO TO 7200-DISPLAY-BATCHES.
 21292
 21293     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21294     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21295
 21296
 21297* EXEC CICS HANDLE CONDITION
 21298*         NOTFND    (5050-NOT-FOUND)
 21299*    END-EXEC.
 21300*    MOVE '"$I                   ! T #00017992' TO DFHEIV0
 21301     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21303     MOVE X'5420233030303137393932' TO DFHEIV0(25:11)
 21304     CALL 'kxdfhei1' USING DFHEIV0
 21305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21306
 21307
 21308
 21309* EXEC CICS READ
 21310*         DATASET   (FILE-ID-ERPNDB)
 21311*         SET       (ADDRESS OF PENDING-BUSINESS)
 21312*         RIDFLD    (ERPNDB-KEY)
 21313*         GTEQ
 21314*    END-EXEC.
 21315*    MOVE '&"S        G          (   #00017996' TO DFHEIV0
 21316     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21317     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21318     MOVE X'2020233030303137393936' TO DFHEIV0(25:11)
 21319     CALL 'kxdfhei1' USING DFHEIV0,
 21320           FILE-ID-ERPNDB,
 21321           DFHEIV20,
 21322           DFHEIV99,
 21323           ERPNDB-KEY,
 21324           DFHEIV99,
 21325           DFHEIV99,
 21326           DFHEIV99
 21327     SET ADDRESS OF PENDING-BUSINESS TO
 21328         DFHEIV20
 21329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21330
 21331
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 391
* EL6311.cbl
 21332     GO TO 5010-READ-NEXT-RECORD.
 21333
 21334 5050-NOT-FOUND.
 21335
 21336******************************************************************
 21337*                                                                *
 21338*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21339*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21340*         PROGRAM.                                               *
 21341*                                                                *
 21342******************************************************************
 21343
 21344     IF EIBTRNID NOT = TRANS-EXB1
 21345        IF PENDING-BUS-RECS-FOUND
 21346            NEXT SENTENCE
 21347          ELSE
 21348            MOVE '9'            TO PI-BROWSE-SW
 21349            GO TO 9400-CLEAR.
 21350
 21351     MOVE ER-2256                TO EMI-ERROR.
 21352     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21353
 21354     IF PI-MAP-NAME = SPACES
 21355        MOVE EL631D              TO PI-MAP-NAME
 21356        MOVE -1                  TO DPFENTRL
 21357        GO TO 8100-SEND-INITIAL-MAP.
 21358
 21359     IF PI-MAP-NAME = EL631B
 21360        MOVE -1                  TO BMAINTL
 21361     ELSE
 21362        IF PI-MAP-NAME = EL631C
 21363           MOVE -1               TO CMAINTL
 21364        ELSE
 21365           MOVE -1               TO DPFENTRL
 21366           GO TO 8200-SEND-DATAONLY.
 21367
 21368     GO TO 8100-SEND-INITIAL-MAP.
 21369
 21370     .
 21371 5100-PROCESS-POL-RESC.
 21372     MOVE ZEROS                  TO CG-LF-BENCD
 21373                                    CG-AH-BENCD
 21374                                    CG-LF-CAN-AMT
 21375                                    CG-AH-CAN-AMT
 21376     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21377                                    CG-AH-CAN-DT
 21378     MOVE SPACES                 TO CG-BATCH-NO
 21379     MOVE '4'                    TO CG-OPTION-CODE
 21380     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21381     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21382     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21383     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21384     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21385     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21386     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21387     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21388     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21389     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 392
* EL6311.cbl
 21390     MOVE PI-PREV-ALT-KEY (1:33)
 21391                                 TO CG-CERT-KEY
 21392     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21393     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21394                                    CG-AH-CAN-AMT
 21395     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21396                                    CG-AH-CAN-DT
 21397     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21398     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21399      display 'about to cancel ' cg-cert-key
 21400
 21401* EXEC CICS LINK
 21402*        PROGRAM  ('ELCANC')
 21403*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21404*    END-EXEC
 21405     MOVE LENGTH OF
 21406      CANCEL-GEN-PASS-AREA
 21407       TO DFHEIV11
 21408     MOVE 'ELCANC' TO DFHEIV1
 21409*    MOVE '."C                   (   #00018071' TO DFHEIV0
 21410     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21412     MOVE X'2020233030303138303731' TO DFHEIV0(25:11)
 21413     CALL 'kxdfhei1' USING DFHEIV0,
 21414           DFHEIV1,
 21415           CANCEL-GEN-PASS-AREA,
 21416           DFHEIV11,
 21417           DFHEIV99,
 21418           DFHEIV99,
 21419           DFHEIV99,
 21420           DFHEIV99
 21421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21422     IF CG-SUCCESS
 21423        CONTINUE
 21424     ELSE
 21425        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21426        MOVE '3'                 TO EMI-SWITCH1
 21427        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21428        EVALUATE TRUE
 21429           WHEN CG-DATE-ERROR
 21430             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21431           WHEN CG-CERT-NOT-FOUND
 21432             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21433           WHEN CG-AMOUNT-ERROR
 21434             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21435           WHEN CG-OPTION-ERROR
 21436             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21437           WHEN CG-PREV-CAN
 21438             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21439           WHEN CG-INVALID-DATA
 21440             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21441           WHEN CG-NO-ACCT-MSTR
 21442             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21443           WHEN CG-SFX-A-EXIST
 21444             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21445           WHEN CG-MISC-ERROR
 21446             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21447           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 393
* EL6311.cbl
 21448             MOVE ' ERROR - ELCANC - RETURN '
 21449                                 TO EMI-ERROR-TEXT (1) (12:25)
 21450        END-EVALUATE
 21451        GO TO 8200-SEND-DATAONLY
 21452     END-IF
 21453
 21454* EXEC CICS GETMAIN
 21455*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 21456*        LENGTH  (ELCRTT-RECORD-LENGTH)
 21457*        INITIMG (GETMAIN-SPACE)
 21458*    END-EXEC
 21459*    MOVE ',"IL                  $   #00018106' TO DFHEIV0
 21460     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21461     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21462     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 21463     CALL 'kxdfhei1' USING DFHEIV0,
 21464           DFHEIV20,
 21465           ELCRTT-RECORD-LENGTH,
 21466           GETMAIN-SPACE
 21467     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 21468         DFHEIV20
 21469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21470
 21471     move ' '                    to ws-elcrtt-update-sw
 21472     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTT-PRIMARY
 21473     MOVE 'C'                    TO ELCRTT-REC-TYPE
 21474
 21475
 21476* EXEC CICS READ
 21477*        UPDATE
 21478*        DATASET  (CRTT-ID)
 21479*        RIDFLD   (ELCRTT-KEY)
 21480*        INTO     (CERTIFICATE-TRAILERS)
 21481*        resp     (ws-response)
 21482*    END-EXEC
 21483     MOVE LENGTH OF
 21484      CERTIFICATE-TRAILERS
 21485       TO DFHEIV11
 21486*    MOVE '&"IL       EU         (  N#00018116' TO DFHEIV0
 21487     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21488     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21489     MOVE X'204E233030303138313136' TO DFHEIV0(25:11)
 21490     CALL 'kxdfhei1' USING DFHEIV0,
 21491           CRTT-ID,
 21492           CERTIFICATE-TRAILERS,
 21493           DFHEIV11,
 21494           ELCRTT-KEY,
 21495           DFHEIV99,
 21496           DFHEIV99,
 21497           DFHEIV99
 21498     MOVE EIBRESP  TO ws-response
 21499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21500
 21501     if resp-normal
 21502        if cs-claim-verification-status = 'B' or 'C' or 'D' or
 21503                  'E' or 'F' or 'G'
 21504           move 'J'              to cs-claim-verification-status
 21505           set update-elcrtt to true
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 394
* EL6311.cbl
 21506        end-if
 21507        if update-elcrtt
 21508
 21509* EXEC CICS REWRITE
 21510*             DATASET    (crtt-ID)
 21511*             FROM       (CERTIFICATE-TRAILERS)
 21512*          END-EXEC
 21513     MOVE LENGTH OF
 21514      CERTIFICATE-TRAILERS
 21515       TO DFHEIV11
 21516*    MOVE '&& L                  %   #00018131' TO DFHEIV0
 21517     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21518     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21519     MOVE X'2020233030303138313331' TO DFHEIV0(25:11)
 21520     CALL 'kxdfhei1' USING DFHEIV0,
 21521           crtt-ID,
 21522           CERTIFICATE-TRAILERS,
 21523           DFHEIV11,
 21524           DFHEIV99
 21525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21526        else
 21527
 21528* exec cics unlock
 21529*             dataset    (crtt-ID)
 21530*          end-exec
 21531*    MOVE '&*                    #   #00018136' TO DFHEIV0
 21532     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21533     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21534     MOVE X'2020233030303138313336' TO DFHEIV0(25:11)
 21535     CALL 'kxdfhei1' USING DFHEIV0,
 21536           crtt-ID,
 21537           DFHEIV99
 21538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21539        end-if
 21540     end-if
 21541     .
 21542 5100-EXIT.
 21543     EXIT.
 21544
 21545******************************************************************
 21546*                                                                *
 21547*        B R O W S E   B A T C H   B A C K W A R D S             *
 21548*                                                                *
 21549******************************************************************
 21550
 21551 5500-BROWSE-BATCH-BACKWARD.
 21552
 21553* EXEC CICS HANDLE CONDITION
 21554*         NOTFND   (5550-END-RECORDS)
 21555*         ENDFILE  (5550-END-RECORDS)
 21556*    END-EXEC.
 21557*    MOVE '"$I''                  ! U #00018152' TO DFHEIV0
 21558     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21560     MOVE X'5520233030303138313532' TO DFHEIV0(25:11)
 21561     CALL 'kxdfhei1' USING DFHEIV0
 21562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21563
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 395
* EL6311.cbl
 21564
 21565 5505-START-BROWSE.
 21566     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21567     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21568     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21569
 21570
 21571* EXEC CICS STARTBR
 21572*         DATASET   (FILE-ID-ERPNDB)
 21573*         RIDFLD    (ERPNDB-ALT-KEY)
 21574*    END-EXEC.
 21575     MOVE 0
 21576       TO DFHEIV11
 21577*    MOVE '&,         G          &   #00018162' TO DFHEIV0
 21578     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21580     MOVE X'2020233030303138313632' TO DFHEIV0(25:11)
 21581     CALL 'kxdfhei1' USING DFHEIV0,
 21582           FILE-ID-ERPNDB,
 21583           ERPNDB-ALT-KEY,
 21584           DFHEIV99,
 21585           DFHEIV11,
 21586           DFHEIV99
 21587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21588
 21589
 21590     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21591
 21592
 21593* EXEC CICS READNEXT
 21594*         DATASET    (FILE-ID-ERPNDB)
 21595*         SET        (ADDRESS OF PENDING-BUSINESS)
 21596*         RIDFLD     (ERPNDB-KEY)
 21597*    END-EXEC.
 21598     MOVE 0
 21599       TO DFHEIV11
 21600*    MOVE '&.S                   )   #00018169' TO DFHEIV0
 21601     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21602     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21603     MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
 21604     CALL 'kxdfhei1' USING DFHEIV0,
 21605           FILE-ID-ERPNDB,
 21606           DFHEIV20,
 21607           DFHEIV99,
 21608           ERPNDB-KEY,
 21609           DFHEIV99,
 21610           DFHEIV11,
 21611           DFHEIV99,
 21612           DFHEIV99
 21613     SET ADDRESS OF PENDING-BUSINESS TO
 21614         DFHEIV20
 21615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21616
 21617
 21618
 21619* EXEC CICS READPREV
 21620*         DATASET    (FILE-ID-ERPNDB)
 21621*         SET        (ADDRESS OF PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 396
* EL6311.cbl
 21622*         RIDFLD     (ERPNDB-KEY)
 21623*    END-EXEC.
 21624     MOVE 0
 21625       TO DFHEIV11
 21626*    MOVE '&0S                   )   #00018175' TO DFHEIV0
 21627     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21629     MOVE X'2020233030303138313735' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0,
 21631           FILE-ID-ERPNDB,
 21632           DFHEIV20,
 21633           DFHEIV99,
 21634           ERPNDB-KEY,
 21635           DFHEIV99,
 21636           DFHEIV11,
 21637           DFHEIV99,
 21638           DFHEIV99
 21639     SET ADDRESS OF PENDING-BUSINESS TO
 21640         DFHEIV20
 21641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21642
 21643
 21644
 21645* EXEC CICS READPREV
 21646*         DATASET    (FILE-ID-ERPNDB)
 21647*         SET        (ADDRESS OF PENDING-BUSINESS)
 21648*         RIDFLD     (ERPNDB-KEY)
 21649*    END-EXEC.
 21650     MOVE 0
 21651       TO DFHEIV11
 21652*    MOVE '&0S                   )   #00018181' TO DFHEIV0
 21653     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21655     MOVE X'2020233030303138313831' TO DFHEIV0(25:11)
 21656     CALL 'kxdfhei1' USING DFHEIV0,
 21657           FILE-ID-ERPNDB,
 21658           DFHEIV20,
 21659           DFHEIV99,
 21660           ERPNDB-KEY,
 21661           DFHEIV99,
 21662           DFHEIV11,
 21663           DFHEIV99,
 21664           DFHEIV99
 21665     SET ADDRESS OF PENDING-BUSINESS TO
 21666         DFHEIV20
 21667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21668
 21669
 21670     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21671        GO TO 5550-END-RECORDS.
 21672
 21673     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21674
 21675     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21676
 21677     IF  WS-BATCH-PREFIX = '#CL'
 21678             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21679
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 397
* EL6311.cbl
 21680* EXEC CICS ENDBR
 21681*                 DATASET  (FILE-ID-ERPNDB)
 21682*            END-EXEC
 21683     MOVE 0
 21684       TO DFHEIV11
 21685*    MOVE '&2                    $   #00018196' TO DFHEIV0
 21686     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21687     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21688     MOVE X'2020233030303138313936' TO DFHEIV0(25:11)
 21689     CALL 'kxdfhei1' USING DFHEIV0,
 21690           FILE-ID-ERPNDB,
 21691           DFHEIV11,
 21692           DFHEIV99
 21693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21694         GO TO 5505-START-BROWSE.
 21695
 21696     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21697         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21698             NEXT SENTENCE
 21699         ELSE
 21700             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21701
 21702* EXEC CICS ENDBR
 21703*                 DATASET  (FILE-ID-ERPNDB)
 21704*            END-EXEC
 21705     MOVE 0
 21706       TO DFHEIV11
 21707*    MOVE '&2                    $   #00018206' TO DFHEIV0
 21708     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21710     MOVE X'2020233030303138323036' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0,
 21712           FILE-ID-ERPNDB,
 21713           DFHEIV11,
 21714           DFHEIV99
 21715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21716             GO TO 5505-START-BROWSE.
 21717
 21718
 21719     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21720         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21721             NEXT SENTENCE
 21722        ELSE
 21723             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21724
 21725* EXEC CICS ENDBR
 21726*                 DATASET  (FILE-ID-ERPNDB)
 21727*            END-EXEC
 21728     MOVE 0
 21729       TO DFHEIV11
 21730*    MOVE '&2                    $   #00018217' TO DFHEIV0
 21731     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21732     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21733     MOVE X'2020233030303138323137' TO DFHEIV0(25:11)
 21734     CALL 'kxdfhei1' USING DFHEIV0,
 21735           FILE-ID-ERPNDB,
 21736           DFHEIV11,
 21737           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 398
* EL6311.cbl
 21738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21739             GO TO 5505-START-BROWSE.
 21740
 21741     IF NOT PB-BATCH-TRAILER
 21742        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21743
 21744* EXEC CICS ENDBR
 21745*            DATASET  (FILE-ID-ERPNDB)
 21746*       END-EXEC
 21747     MOVE 0
 21748       TO DFHEIV11
 21749*    MOVE '&2                    $   #00018224' TO DFHEIV0
 21750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21752     MOVE X'2020233030303138323234' TO DFHEIV0(25:11)
 21753     CALL 'kxdfhei1' USING DFHEIV0,
 21754           FILE-ID-ERPNDB,
 21755           DFHEIV11,
 21756           DFHEIV99
 21757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21758        GO TO 5505-START-BROWSE.
 21759
 21760     IF PI-CSR-BROWSE
 21761        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21762           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21763
 21764* EXEC CICS ENDBR
 21765*               DATASET  (FILE-ID-ERPNDB)
 21766*          END-EXEC
 21767     MOVE 0
 21768       TO DFHEIV11
 21769*    MOVE '&2                    $   #00018232' TO DFHEIV0
 21770     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21771     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21772     MOVE X'2020233030303138323332' TO DFHEIV0(25:11)
 21773     CALL 'kxdfhei1' USING DFHEIV0,
 21774           FILE-ID-ERPNDB,
 21775           DFHEIV11,
 21776           DFHEIV99
 21777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21778           GO TO 5505-START-BROWSE.
 21779
 21780     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21781        IF PI-PB-CARRIER    = SPACES AND
 21782           PI-PB-GROUPING   = SPACES AND
 21783           PI-PB-STATE      = SPACES AND
 21784           PI-PB-ACCOUNT    = SPACES
 21785             GO TO 7200-DISPLAY-BATCHES
 21786          ELSE
 21787            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21788               PI-PB-GROUPING   = PB-GROUPING AND
 21789               PI-PB-STATE      = PB-STATE    AND
 21790               PI-PB-ACCOUNT    = PB-ACCOUNT
 21791                 GO TO 7200-DISPLAY-BATCHES.
 21792
 21793     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21794
 21795
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 399
* EL6311.cbl
 21796* EXEC CICS ENDBR
 21797*         DATASET  (FILE-ID-ERPNDB)
 21798*    END-EXEC.
 21799     MOVE 0
 21800       TO DFHEIV11
 21801*    MOVE '&2                    $   #00018252' TO DFHEIV0
 21802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21804     MOVE X'2020233030303138323532' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0,
 21806           FILE-ID-ERPNDB,
 21807           DFHEIV11,
 21808           DFHEIV99
 21809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21810
 21811
 21812     GO TO 5505-START-BROWSE.
 21813
 21814 5550-END-RECORDS.
 21815     MOVE ER-2257                TO EMI-ERROR.
 21816     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21817     MOVE -1                     TO DPFENTRL.
 21818
 21819     GO TO 8200-SEND-DATAONLY.
 21820
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 400
* EL6311.cbl
 21822
 21823******************************************************************
 21824*                                                                *
 21825*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21826*                                                                *
 21827******************************************************************
 21828
 21829 6000-CREATE-TEMP-STORAGE.
 21830
 21831
 21832* EXEC CICS HANDLE CONDITION
 21833*        QIDERR  (6050-QID-ERROR)
 21834*    END-EXEC.
 21835*    MOVE '"$N                   ! V #00018275' TO DFHEIV0
 21836     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21838     MOVE X'5620233030303138323735' TO DFHEIV0(25:11)
 21839     CALL 'kxdfhei1' USING DFHEIV0
 21840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21841
 21842
 21843
 21844* EXEC CICS WRITEQ TS
 21845*        QUEUE    (QID)
 21846*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21847*        LENGTH   (WS-COMM-LENGTH)
 21848*        ITEM     (W-ONE)
 21849*    END-EXEC.
 21850*    MOVE '*" I   L              ''   #00018279' TO DFHEIV0
 21851     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21853     MOVE X'2020233030303138323739' TO DFHEIV0(25:11)
 21854     CALL 'kxdfhei1' USING DFHEIV0,
 21855           QID,
 21856           PROGRAM-INTERFACE-BLOCK,
 21857           WS-COMM-LENGTH,
 21858           W-ONE,
 21859           DFHEIV99,
 21860           DFHEIV99
 21861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21862
 21863
 21864 6000-EXIT.
 21865      EXIT.
 21866
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 401
* EL6311.cbl
 21868
 21869******************************************************************
 21870*                                                                *
 21871*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21872*                                                                *
 21873******************************************************************
 21874
 21875 6050-RECOVER-TEMP-STORAGE.
 21876     IF PGM-NAME = XCTL-EL6312
 21877        GO TO 6050-EXIT.
 21878
 21879     IF PGM-NAME = XCTL-EL6313
 21880        GO TO 6050-EXIT.
 21881
 21882     IF PGM-NAME = XCTL-EL6315
 21883         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21884     END-IF
 21885
 21886     IF PGM-NAME = XCTL-EL6316
 21887         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21888     END-IF
 21889
 21890
 21891* EXEC CICS HANDLE CONDITION
 21892*        QIDERR  (6050-QID-ERROR)
 21893*    END-EXEC.
 21894*    MOVE '"$N                   ! W #00018312' TO DFHEIV0
 21895     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21897     MOVE X'5720233030303138333132' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0
 21899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21900
 21901
 21902
 21903* EXEC CICS READQ TS
 21904*         QUEUE   (QID)
 21905*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21906*         LENGTH  (WS-COMM-LENGTH)
 21907*         ITEM    (W-ONE)
 21908*     END-EXEC.
 21909*    MOVE '*$II   L              ''   #00018316' TO DFHEIV0
 21910     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21912     MOVE X'2020233030303138333136' TO DFHEIV0(25:11)
 21913     CALL 'kxdfhei1' USING DFHEIV0,
 21914           QID,
 21915           PROGRAM-INTERFACE-BLOCK,
 21916           WS-COMM-LENGTH,
 21917           W-ONE,
 21918           DFHEIV99,
 21919           DFHEIV99
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21921
 21922
 21923 6050-DELETE-TEMP-STORAGE.
 21924
 21925
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 402
* EL6311.cbl
 21926* EXEC CICS DELETEQ TS
 21927*        QUEUE   (QID)
 21928*    END-EXEC.
 21929*    MOVE '*&                    #   #00018325' TO DFHEIV0
 21930     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21931     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21932     MOVE X'2020233030303138333235' TO DFHEIV0(25:11)
 21933     CALL 'kxdfhei1' USING DFHEIV0,
 21934           QID,
 21935           DFHEIV99
 21936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21937
 21938
 21939     GO TO 6050-EXIT.
 21940
 21941 6050-QID-ERROR.
 21942     MOVE ER-0033                TO EMI-ERROR
 21943     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21944
 21945 6050-EXIT.
 21946      EXIT.
 21947
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 403
* EL6311.cbl
 21949
 21950******************************************************************
 21951*                                                                *
 21952*            T E R M   C O N V E R S I O N                       *
 21953*                                                                *
 21954******************************************************************
 21955
 21956 6100-TERM-CONVERSION.
 21957
 21958     IF PI-BPMTS = ZERO
 21959         GO TO 6199-EXIT.
 21960
 21961     IF PI-BMODE = ' ' OR 'M'
 21962         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21963         GO TO 6105-ROUND-TERM.
 21964
 21965     IF PI-BMODE = 'S'
 21966         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21967         GO TO 6105-ROUND-TERM.
 21968
 21969     IF PI-BMODE = 'W'
 21970         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21971         GO TO 6105-ROUND-TERM.
 21972
 21973     IF PI-BMODE = 'B'
 21974         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21975         GO TO 6105-ROUND-TERM.
 21976
 21977     IF PI-BMODE = 'T'
 21978         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21979
 21980 6105-ROUND-TERM.
 21981
 21982     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21983         ADD +1                  TO WS-CALC-TERM-WHOLE
 21984         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21985
 21986     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21987         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21988
 21989     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21990         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21991                                      WS-BTERM    (WS-SUB1)
 21992         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21993
 21994     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21995         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21996             MOVE -1               TO BMODEL
 21997             MOVE ER-2593          TO EMI-ERROR
 21998             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21999             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22000
 22001 6124-CHECK-BENEFIT.
 22002
 22003     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 22004        GO TO 6126-COMPUTE-BENEFIT.
 22005
 22006     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 404
* EL6311.cbl
 22007
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 405
* EL6311.cbl
 22009******************************************************************
 22010**         COMPUTE TERM AND BENEFIT
 22011******************************************************************
 22012 6125-COMPUTE-TERM-BENEFIT.
 22013
 22014     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 22015        PI-BPMTAMT = ZERO
 22016         GO TO 6199-EXIT.
 22017
 22018     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 22019                                     WS-BTERM  (WS-SUB1).
 22020     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 22021
 22022 6126-COMPUTE-BENEFIT.
 22023
 22024     IF PI-BMODE = 'M' OR  ' '
 22025         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 22026
 22027     IF PI-BMODE = 'W'
 22028         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 22029
 22030     IF PI-BMODE = 'S'
 22031         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 22032
 22033     IF PI-BMODE = 'B'
 22034         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 22035
 22036     IF PI-BMODE = 'T'
 22037         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 22038
 22039     IF WS-SUB1 = +1
 22040        COMPUTE WS-BBEN (WS-SUB1) =
 22041                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 22042
 22043     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 22044     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 22045     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 22046
 22047 6199-EXIT.
 22048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 406
* EL6311.cbl
 22050
 22051******************************************************************
 22052*                                                                *
 22053*             D I S P L A Y   I S S U E S                        *
 22054*                                                                *
 22055******************************************************************
 22056
 22057 6200-CREATE-VADS.
 22058     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 22059     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 22060     MOVE SPACES                 TO WS-PASS-VADS-REC
 22061
 22062* EXEC CICS GETMAIN
 22063*       SET      (ADDRESS OF PENDING-BUSINESS)
 22064*       LENGTH   (ERPNDB-RECORD-LENGTH)
 22065*       INITIMG  (GETMAIN-SPACE)
 22066*       RESP     (WS-RESPONSE)
 22067*    END-EXEC
 22068*    MOVE ',"IL                  $  N#00018451' TO DFHEIV0
 22069     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22070     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22071     MOVE X'204E233030303138343531' TO DFHEIV0(25:11)
 22072     CALL 'kxdfhei1' USING DFHEIV0,
 22073           DFHEIV20,
 22074           ERPNDB-RECORD-LENGTH,
 22075           GETMAIN-SPACE
 22076     SET ADDRESS OF PENDING-BUSINESS TO
 22077         DFHEIV20
 22078     MOVE EIBRESP  TO WS-RESPONSE
 22079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22080
 22081* EXEC CICS READ
 22082*       INTO    (PENDING-BUSINESS)
 22083*       DATASET (FILE-ID-ERPNDB)
 22084*       RIDFLD  (ERPNDB-KEY)
 22085*       RESP    (WS-RESPONSE)
 22086*    END-EXEC
 22087     MOVE LENGTH OF
 22088      PENDING-BUSINESS
 22089       TO DFHEIV11
 22090*    MOVE '&"IL       E          (  N#00018457' TO DFHEIV0
 22091     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22092     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22093     MOVE X'204E233030303138343537' TO DFHEIV0(25:11)
 22094     CALL 'kxdfhei1' USING DFHEIV0,
 22095           FILE-ID-ERPNDB,
 22096           PENDING-BUSINESS,
 22097           DFHEIV11,
 22098           ERPNDB-KEY,
 22099           DFHEIV99,
 22100           DFHEIV99,
 22101           DFHEIV99
 22102     MOVE EIBRESP  TO WS-RESPONSE
 22103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22104     IF RESP-NORMAL
 22105        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22106        IF (RESP-NORMAL)
 22107           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 407
* EL6311.cbl
 22108              AM-CONTROL-PRIMARY (1:20))
 22109           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 22110        ELSE
 22111           MOVE 'ACCOUNT NOT FOUND'
 22112                                 TO VD-ACCOUNT-NAME
 22113        END-IF
 22114        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 22115                                    TO M1
 22116        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 22117        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 22118           (A2 > M1)
 22119           OR (WS-WORK-FIELD (A2:1) = '*')
 22120           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 22121           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 22122        END-PERFORM
 22123        IF A2 > M1
 22124           CONTINUE
 22125        ELSE
 22126           MOVE WS-WORK-FIELD (1:A2 - 1)
 22127                                    TO VD-ACCOUNT-NAME
 22128        END-IF
 22129        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 22130        MOVE PB-CARRIER          TO VD-CARRIER
 22131        MOVE PB-GROUPING         TO VD-GROUPING
 22132        MOVE PB-STATE            TO VD-STATE
 22133        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22134        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22135        MOVE PB-CERT-NO          TO VD-CERT-NO
 22136        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22137        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22138        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22139        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22140        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22141        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22142        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22143        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22144        MOVE PB-CSR-ID           TO VD-CSR-ID
 22145        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22146        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22147        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22148        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22149        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22150        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22151        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22152        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22153        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22154        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22155        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22156        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22157        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22158     END-IF
 22159     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22160
 22161
 22162* EXEC CICS GETMAIN
 22163*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22164*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22165*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 408
* EL6311.cbl
 22166*       RESP     (WS-RESPONSE)
 22167*    END-EXEC
 22168*    MOVE ',"IL                  $  N#00018520' TO DFHEIV0
 22169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22171     MOVE X'204E233030303138353230' TO DFHEIV0(25:11)
 22172     CALL 'kxdfhei1' USING DFHEIV0,
 22173           DFHEIV20,
 22174           ERPNDM-RECORD-LENGTH,
 22175           GETMAIN-SPACE
 22176     SET ADDRESS OF PENDING-MAILING-DATA TO
 22177         DFHEIV20
 22178     MOVE EIBRESP  TO WS-RESPONSE
 22179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22180
 22181
 22182* EXEC CICS READ
 22183*       INTO    (PENDING-MAILING-DATA)
 22184*       DATASET (FILE-ID-ERPNDM)
 22185*       RIDFLD  (ERPNDM-KEY)
 22186*       RESP    (WS-RESPONSE)
 22187*    END-EXEC
 22188     MOVE LENGTH OF
 22189      PENDING-MAILING-DATA
 22190       TO DFHEIV11
 22191*    MOVE '&"IL       E          (  N#00018527' TO DFHEIV0
 22192     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22194     MOVE X'204E233030303138353237' TO DFHEIV0(25:11)
 22195     CALL 'kxdfhei1' USING DFHEIV0,
 22196           FILE-ID-ERPNDM,
 22197           PENDING-MAILING-DATA,
 22198           DFHEIV11,
 22199           ERPNDM-KEY,
 22200           DFHEIV99,
 22201           DFHEIV99,
 22202           DFHEIV99
 22203     MOVE EIBRESP  TO WS-RESPONSE
 22204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22205
 22206     IF RESP-NORMAL
 22207        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22208        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22209        MOVE PM-CITY              TO VD-INSURED-CITY
 22210        MOVE PM-STATE             TO VD-INSURED-STATE
 22211        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22212     END-IF
 22213
 22214     MOVE 'VAC1'                  TO VD-LETTER-ID
 22215     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22216     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22217     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22218     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22219     MOVE +0                      TO VD-ARCHIVE-NO
 22220     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22221     .
 22222 6200-EXIT.
 22223     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 409
* EL6311.cbl
 22224 6210-READ-ERACCT.
 22225     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22226     MOVE LOW-VALUES             TO ERACCT-FILL
 22227
 22228* EXEC CICS READ
 22229*         DATASET   ('ERACCT')
 22230*         INTO      (ACCOUNT-MASTER)
 22231*         RIDFLD    (ERACCT-KEY)
 22232*         GTEQ
 22233*         RESP      (WS-RESPONSE)
 22234*    END-EXEC
 22235     MOVE LENGTH OF
 22236      ACCOUNT-MASTER
 22237       TO DFHEIV11
 22238     MOVE 'ERACCT' TO DFHEIV1
 22239*    MOVE '&"IL       G          (  N#00018555' TO DFHEIV0
 22240     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22242     MOVE X'204E233030303138353535' TO DFHEIV0(25:11)
 22243     CALL 'kxdfhei1' USING DFHEIV0,
 22244           DFHEIV1,
 22245           ACCOUNT-MASTER,
 22246           DFHEIV11,
 22247           ERACCT-KEY,
 22248           DFHEIV99,
 22249           DFHEIV99,
 22250           DFHEIV99
 22251     MOVE EIBRESP  TO WS-RESPONSE
 22252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22253     .
 22254 6210-EXIT.
 22255     EXIT.
 22256
 22257 6220-READ-ERMAIL.
 22258
 22259     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22260     MOVE ' '                    TO WS-ERMAIL-SW
 22261
 22262
 22263* EXEC CICS READ
 22264*       DATASET   (FILE-ID-ERMAIL)
 22265*       SET       (ADDRESS OF MAILING-DATA)
 22266*       RIDFLD    (ERMAIL-KEY)
 22267*       RESP      (WS-RESPONSE)
 22268*    END-EXEC
 22269*    MOVE '&"S        E          (  N#00018571' TO DFHEIV0
 22270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22272     MOVE X'204E233030303138353731' TO DFHEIV0(25:11)
 22273     CALL 'kxdfhei1' USING DFHEIV0,
 22274           FILE-ID-ERMAIL,
 22275           DFHEIV20,
 22276           DFHEIV99,
 22277           ERMAIL-KEY,
 22278           DFHEIV99,
 22279           DFHEIV99,
 22280           DFHEIV99
 22281     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 410
* EL6311.cbl
 22282         DFHEIV20
 22283     MOVE EIBRESP  TO WS-RESPONSE
 22284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22285
 22286     IF RESP-NORMAL
 22287        SET ERMAIL-FOUND TO TRUE
 22288     END-IF
 22289     .
 22290 6220-EXIT.
 22291     EXIT.
 22292
 22293 6400-CHECK-FOR-RES-REF-CLAIM.
 22294     display 'made it to 6400- for ' pi-cert-no
 22295     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22296
 22297     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22298                                    W-CL-COMP-CD.
 22299     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22300                                    W-CL-CERT-NO.
 22301     MOVE SPACES                 TO MSTR-CERT-SFX.
 22302
 22303
 22304* EXEC CICS HANDLE CONDITION
 22305*        NOTFND  (6400-CONTINUE)
 22306*        ENDFILE (6400-CONTINUE)
 22307*    END-EXEC.
 22308*    MOVE '"$I''                  ! X #00018595' TO DFHEIV0
 22309     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22311     MOVE X'5820233030303138353935' TO DFHEIV0(25:11)
 22312     CALL 'kxdfhei1' USING DFHEIV0
 22313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22314
 22315
 22316
 22317* EXEC CICS IGNORE CONDITION
 22318*        DUPKEY
 22319*    END-EXEC.
 22320*    MOVE '"*$                   !   #00018600' TO DFHEIV0
 22321     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22323     MOVE X'2020233030303138363030' TO DFHEIV0(25:11)
 22324     CALL 'kxdfhei1' USING DFHEIV0
 22325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22326
 22327
 22328
 22329* EXEC CICS STARTBR
 22330*        DATASET   (CLMS-ID)
 22331*        RIDFLD    (ELMSTR-KEY)
 22332*        GENERIC   EQUAL
 22333*        KEYLENGTH (ELMSTR-LENGTH)
 22334*    END-EXEC.
 22335     MOVE 0
 22336       TO DFHEIV11
 22337*    MOVE '&,   KG    E          &   #00018604' TO DFHEIV0
 22338     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22339     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 411
* EL6311.cbl
 22340     MOVE X'2020233030303138363034' TO DFHEIV0(25:11)
 22341     CALL 'kxdfhei1' USING DFHEIV0,
 22342           CLMS-ID,
 22343           ELMSTR-KEY,
 22344           ELMSTR-LENGTH,
 22345           DFHEIV11,
 22346           DFHEIV99
 22347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22348
 22349
 22350     display 'browse started'
 22351     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22352
 22353 6400-NEXT-CLAIM.
 22354
 22355
 22356* EXEC CICS READNEXT
 22357*        DATASET   (CLMS-ID)
 22358*        RIDFLD    (ELMSTR-KEY)
 22359*        SET       (ADDRESS OF CLAIM-MASTER)
 22360*    END-EXEC.
 22361     MOVE 0
 22362       TO DFHEIV11
 22363*    MOVE '&.S                   )   #00018616' TO DFHEIV0
 22364     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22366     MOVE X'2020233030303138363136' TO DFHEIV0(25:11)
 22367     CALL 'kxdfhei1' USING DFHEIV0,
 22368           CLMS-ID,
 22369           DFHEIV20,
 22370           DFHEIV99,
 22371           ELMSTR-KEY,
 22372           DFHEIV99,
 22373           DFHEIV11,
 22374           DFHEIV99,
 22375           DFHEIV99
 22376     SET ADDRESS OF CLAIM-MASTER TO
 22377         DFHEIV20
 22378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22379
 22380
 22381     display 'read claim for ' mstr-cert-no
 22382     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22383        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22384         GO TO 6400-CONTINUE
 22385     END-IF.
 22386
 22387     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22388        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22389        PI-STATE       NOT = CL-CERT-STATE     OR
 22390        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22391        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22392         GO TO 6400-NEXT-CLAIM
 22393     END-IF.
 22394
 22395     display 'found claim ' cl-claim-no
 22396        ' with denial type ' cl-denial-type
 22397     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 412
* EL6311.cbl
 22398         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22399         GO TO 6400-CONTINUE
 22400     END-IF.
 22401
 22402     GO TO 6400-NEXT-CLAIM.
 22403
 22404 6400-CONTINUE.
 22405
 22406     IF WS-BROWSE-STARTED-SW = 'Y'
 22407
 22408* EXEC CICS ENDBR
 22409*            DATASET   (CLMS-ID)
 22410*        END-EXEC
 22411     MOVE 0
 22412       TO DFHEIV11
 22413*    MOVE '&2                    $   #00018648' TO DFHEIV0
 22414     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22416     MOVE X'2020233030303138363438' TO DFHEIV0(25:11)
 22417     CALL 'kxdfhei1' USING DFHEIV0,
 22418           CLMS-ID,
 22419           DFHEIV11,
 22420           DFHEIV99
 22421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22422         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22423     END-IF.
 22424
 22425 6400-EXIT.
 22426     EXIT.
 22427
 22428 7000-DISPLAY-ISSUES.
 22429
 22430     IF PI-DISPLAY-ORIGINAL-BATCH
 22431        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22432        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22433     ELSE
 22434        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22435
 22436     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22437
 22438     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22439     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22440
 22441     MOVE LOW-VALUES                 TO EL631BI.
 22442     MOVE ZEROS                      TO PI-BPMTAMT
 22443                                        PI-BPMTS.
 22444     MOVE SPACE                      TO PI-BMODE
 22445                                        PI-BTYPE (1)
 22446                                        PI-BTYPE (2).
 22447     MOVE EL631B                     TO PI-MAP-NAME.
 22448     MOVE 'Y'                        TO PI-BROWSE-SW.
 22449     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22450                                        PI-HIGH-SEQ-NO.
 22451
 22452     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22453        MOVE AL-SABOF                TO BCHGTA
 22454        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22455        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 413
* EL6311.cbl
 22456     ELSE
 22457        MOVE AL-SADOF                TO BCHGTA
 22458                                        BCHGA
 22459        MOVE PB-CHG-COUNT            TO BCHGO.
 22460
 22461     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22462     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22463     MOVE WS-HR-MINS                 TO BMANTATO.
 22464
 22465     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22466        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22467        MOVE SPACE                   TO DC-OPTION-CODE
 22468        PERFORM 9700-DATE-LINK
 22469        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22470        MOVE 'INACTIVE'              TO BMOENDTO
 22471     ELSE
 22472        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22473        MOVE SPACE                   TO DC-OPTION-CODE
 22474        PERFORM 9700-DATE-LINK
 22475        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22476        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22477        MOVE SPACE                   TO DC-OPTION-CODE
 22478        PERFORM 9700-DATE-LINK
 22479        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22480
 22481*    MOVE PB-I-REFERENCE             TO BREFO.
 22482
 22483*    IF PI-COMPANY-ID EQUAL 'HER'
 22484*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22485*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22486*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22487*                MOVE WS-MEMBER-NO-1-8
 22488*                                TO  BMICRNOO.
 22489
 22490*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22491*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22492*            MOVE PB-I-MICROFILM-NO
 22493*                                TO  BMICRNOO.
 22494     IF PB-I-VIN NOT = SPACES
 22495        MOVE PB-I-VIN            TO BVINO
 22496     END-IF
 22497
 22498     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22499     MOVE PB-CERT-SFX                TO BSUFIXO.
 22500     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22501     MOVE SPACE                      TO DC-OPTION-CODE.
 22502     PERFORM 9700-DATE-LINK.
 22503     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22504
 22505     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22506     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22507     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22508     MOVE PB-I-INSURED-SEX           TO BSEXO
 22509
 22510     IF PB-I-AGE NOT = ZEROS
 22511         MOVE PB-I-AGE               TO BAGEO.
 22512
 22513     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 414
* EL6311.cbl
 22514                                 TO ELCERT-KEY
 22515     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22516     IF NOT CERT-TRL-REC-NOT-FOUND
 22517         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22518             MOVE 'AGE*'             TO BAGEDEFO
 22519         ELSE
 22520             MOVE 'AGE '             TO BAGEDEFO
 22521         END-IF
 22522     ELSE
 22523         MOVE 'AGE '             TO BAGEDEFO
 22524     END-IF
 22525
 22526     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22527         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22528         MOVE SPACE                  TO DC-OPTION-CODE
 22529         PERFORM 9700-DATE-LINK
 22530         IF NO-CONVERSION-ERROR
 22531            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22532
 22533     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22534         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22535         MOVE SPACE                  TO DC-OPTION-CODE
 22536         PERFORM 9700-DATE-LINK
 22537         IF NO-CONVERSION-ERROR
 22538            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22539
 22540     IF PB-I-EXTENTION-DAYS NUMERIC
 22541        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22542           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22543        ELSE
 22544           IF PB-I-TERM-IN-DAYS NUMERIC
 22545              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22546                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22547
 22548     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22549        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22550
 22551     MOVE PB-FORCE-CODE              TO BFORCEO.
 22552     MOVE PB-I-TERM-TYPE             TO BMODEO
 22553                                        PI-BMODE.
 22554
 22555     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22556        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22557
 22558     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22559         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22560                                        PI-BPMTS.
 22561
 22562     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22563         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22564           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22565                                        PI-BPMTAMT.
 22566
 22567     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22568     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22569     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22570     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22571     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 415
* EL6311.cbl
 22572     MOVE PB-I-SIG-SW                TO BSIGO.
 22573     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22574     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22575     MOVE PB-RECORD-BILL             TO BBILCDO.
 22576     MOVE PB-FORCE-CODE              TO BFORCEO.
 22577
 22578     IF (PB-I-LIVES NUMERIC)
 22579        AND (PB-I-LIVES > ZEROS)
 22580        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22581        IF (RESP-NORMAL)
 22582           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22583           CONTINUE
 22584        ELSE
 22585           MOVE PB-I-LIVES       TO BLIVESO
 22586        END-IF
 22587     END-IF
 22588
 22589     IF PB-I-NUM-BILLED NUMERIC AND
 22590        PB-I-NUM-BILLED GREATER THAN ZEROS
 22591        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22592*    ELSE
 22593*       MOVE ZEROS                   TO BBILLEDO.
 22594
 22595     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22596
 22597     IF PB-I-LOAN-APR NOT = +99.9999
 22598        MOVE PB-I-LOAN-APR           TO BAPRO.
 22599
 22600     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22601        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22602
 22603     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22604        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22605           MOVE AL-SANOF                TO BORIGHDA
 22606           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22607           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22608
 22609     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22610
 22611     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22612        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22613
 22614     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22615        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22616                                        PI-BTYPE (1).
 22617
 22618     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22619        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22620
 22621     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22622        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22623
 22624     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22625        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22626
 22627     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22628        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22629
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 416
* EL6311.cbl
 22630     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22631        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22632
 22633     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22634         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22635         MOVE SPACE                  TO DC-OPTION-CODE
 22636         PERFORM 9700-DATE-LINK
 22637         IF NO-CONVERSION-ERROR
 22638            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22639
 22640     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22641        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22642        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22643        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22644        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22645                 GIVING BDIFFO (1)
 22646     ELSE
 22647        MOVE SPACES                  TO BBEN-CD     (1)
 22648                                        BBEN-ABBR   (1).
 22649
 22650     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22651        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22652        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22653                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22654
 22655     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22656       IF PB-RECORD-ON-HOLD
 22657          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22658
 22659     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22660       IF PB-RECORD-RETURNED
 22661          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22662
 22663     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22664        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22665             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22666
 22667     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22668
 22669     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22670        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22671
 22672     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22673        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22674                                        PI-BTYPE (2).
 22675
 22676     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22677        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22678
 22679     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22680        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22681
 22682     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22683        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22684
 22685     IF PB-I-TOT-FEES NOT NUMERIC
 22686        MOVE ZEROS               TO PB-I-TOT-FEES
 22687     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 417
* EL6311.cbl
 22688     IF PB-I-TOT-FEES > ZEROS
 22689        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22690
 22691     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22692         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22693         MOVE SPACE                  TO DC-OPTION-CODE
 22694         PERFORM 9700-DATE-LINK
 22695         IF NO-CONVERSION-ERROR
 22696            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22697
 22698     IF PB-I-TOT-FEES > ZEROS
 22699        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22700        SUBTRACT PB-I-TOT-FEES FROM
 22701                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22702
 22703     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22704        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22705        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22706        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22707        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22708                 GIVING BDIFFO (2)
 22709     ELSE
 22710        MOVE SPACES                  TO BBEN-CD     (2)
 22711                                        BBEN-ABBR   (2).
 22712
 22713     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22714       IF PB-RECORD-ON-HOLD
 22715          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22716
 22717     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22718       IF PB-RECORD-RETURNED
 22719          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22720
 22721     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22722        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22723             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22724
 22725     MOVE PB-CSR-ID                  TO BCSRO.
 22726
 22727     IF PI-COMPANY-ID  =  'DMD'
 22728        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22729            NEXT SENTENCE
 22730        ELSE
 22731            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22732               MOVE 'NEW CERT'       TO BNCERTLI
 22733               MOVE EC-NEW-CERT      TO BNCERTO.
 22734
 22735     IF PI-COMPANY-ID  =  'DMD'
 22736        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22737            NEXT SENTENCE
 22738        ELSE
 22739           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22740               MOVE 'NEW STATE'      TO BNSTATLI
 22741               MOVE EC-NEW-STATE     TO BNSTATO.
 22742
 22743 7000-CONTINUE.
 22744     MOVE 'C'                        TO BMAINTI.
 22745     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 418
* EL6311.cbl
 22746
 22747     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22748        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22749
 22750     IF PI-6315-FINALIZED = 'Y'   AND
 22751        PB-UNFORCED-ERRORS
 22752          MOVE -1                TO BFORCEL
 22753          MOVE  1                TO SET-CURSOR-SW
 22754     END-IF
 22755
 22756     IF NO-CURSOR-SET
 22757        MOVE -1                      TO BMAINTL.
 22758
 22759     GO TO 8100-SEND-INITIAL-MAP.
 22760
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 419
* EL6311.cbl
 22762
 22763******************************************************************
 22764*                                                                *
 22765*             D I S P L A Y   C A N C E L S                      *
 22766*                                                                *
 22767******************************************************************
 22768
 22769 7100-DISPLAY-CANCELS.
 22770     IF PI-DISPLAY-ORIGINAL-BATCH
 22771        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22772        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22773     ELSE
 22774        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22775
 22776     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22777
 22778     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22779     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22780
 22781     MOVE LOW-VALUES                 TO EL631CI.
 22782     MOVE EL631C                     TO PI-MAP-NAME.
 22783     MOVE 'Y'                        TO PI-BROWSE-SW.
 22784     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22785                                        PI-HIGH-SEQ-NO.
 22786
 22787     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22788        MOVE AL-SABOF                TO CCHGTA
 22789        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22790        MOVE AL-SANON                TO CCHGA
 22791      ELSE
 22792        MOVE AL-SADOF                TO CCHGTA
 22793                                        CCHGA
 22794        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22795
 22796*    MOVE PB-C-REFERENCE             TO CREFO.
 22797
 22798*    IF PB-C-MICROFILM-NO IS NUMERIC
 22799*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22800*          MOVE PB-C-MICROFILM-NO
 22801*                                TO CMICRNOO
 22802*          MOVE AL-UNNON         TO CMICRNOA
 22803*       END-IF
 22804*    END-IF
 22805     IF PB-C-INT-ON-REFS NUMERIC
 22806        IF PB-C-INT-ON-REFS NOT = ZEROS
 22807           MOVE PB-C-INT-ON-REFS
 22808                                 TO CNHINTO
 22809           MOVE AL-SANOF         TO CNHINTA
 22810        END-IF
 22811     END-IF
 22812     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22813     MOVE PB-CERT-SFX                TO CSUFIXO.
 22814     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22815     MOVE SPACE                      TO DC-OPTION-CODE.
 22816     PERFORM 9700-DATE-LINK.
 22817     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22818
 22819     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 420
* EL6311.cbl
 22820        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22821        MOVE SPACE                   TO DC-OPTION-CODE
 22822        PERFORM 9700-DATE-LINK
 22823        IF NO-CONVERSION-ERROR
 22824           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22825
 22826     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22827        NEXT SENTENCE
 22828     ELSE
 22829        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22830
 22831     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22832        NEXT SENTENCE
 22833     ELSE
 22834        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22835
 22836     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22837        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22838        MOVE SPACE                   TO DC-OPTION-CODE
 22839        PERFORM 9700-DATE-LINK
 22840        IF NO-CONVERSION-ERROR
 22841           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22842
 22843     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22844         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22845
 22846     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22847         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22848
 22849     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22850        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22851        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22852                 GIVING CDRFND1O.
 22853
 22854     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22855        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22856        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22857                 GIVING CDRFND2O.
 22858
 22859     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22860       IF PB-RECORD-ON-HOLD
 22861          MOVE 'ON HOLD'             TO CBILIT1O.
 22862
 22863     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22864       IF PB-RECORD-RETURNED
 22865          MOVE 'RETURNED'            TO CBILIT1O.
 22866
 22867     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22868        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22869             MOVE 'OVERRIDE'         TO CBILIT1O.
 22870
 22871     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22872       IF PB-RECORD-ON-HOLD
 22873          MOVE 'ON HOLD'             TO CBILIT2O.
 22874
 22875     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22876       IF PB-RECORD-RETURNED
 22877          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 421
* EL6311.cbl
 22878
 22879     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22880        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22881             MOVE 'OVERRIDE'         TO CBILIT2O.
 22882
 22883     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22884     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22885     IF PB-C-POST-CARD-IND = 'Y'
 22886        MOVE 'Y'                     TO CPCYNO
 22887     ELSE
 22888        MOVE 'N'                     TO CPCYNO
 22889     END-IF
 22890     MOVE PB-FORCE-CODE              TO CFORCEO.
 22891     MOVE PB-RECORD-BILL             TO CBILCDO.
 22892     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22893     MOVE SPACES                     TO CINITSO.
 22894     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22895         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22896     ELSE
 22897         MOVE PB-CI-INITIALS         TO CINITSO
 22898     END-IF.
 22899
 22900     IF PB-CI-CANCEL-FEE NUMERIC
 22901        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22902        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22903     ELSE
 22904        MOVE ZEROES                  TO W-CANCEL-FEE.
 22905
 22906     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22907
 22908     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22909        ADD PB-CI-LF-PREMIUM-AMT
 22910             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22911
 22912     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22913        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22914
 22915     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22916     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22917     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22918     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22919
 22920     IF PB-C-LIVES NUMERIC
 22921        MOVE PB-C-LIVES              TO CLIVESO.
 22922
 22923     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22924        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22925
 22926     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22927        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22928        MOVE SPACE                   TO DC-OPTION-CODE
 22929        PERFORM 9700-DATE-LINK
 22930        IF NO-CONVERSION-ERROR
 22931           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22932
 22933     IF  PB-C-REFUND-CREATED
 22934         MOVE 'YES'                  TO CRFNDSWO
 22935     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 422
* EL6311.cbl
 22936         IF PB-C-REFUND-REQUESTED
 22937            MOVE 'REQ'               TO CRFNDSWO
 22938         ELSE
 22939            MOVE 'NO'                TO CRFNDSWO.
 22940
 22941     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22942     MOVE SPACE                      TO DC-OPTION-CODE.
 22943     PERFORM 9700-DATE-LINK.
 22944     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22945     MOVE PB-INPUT-BY                TO CENTBYO.
 22946
 22947     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22948        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22949        MOVE SPACE                   TO DC-OPTION-CODE
 22950        PERFORM 9700-DATE-LINK
 22951        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22952        MOVE 'INACTIVE'              TO CMOENDTO
 22953     ELSE
 22954        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22955        MOVE SPACE                   TO DC-OPTION-CODE
 22956        PERFORM 9700-DATE-LINK
 22957        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22958        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22959        MOVE SPACE                   TO DC-OPTION-CODE
 22960        PERFORM 9700-DATE-LINK
 22961        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22962
 22963     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22964
 22965     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22966     MOVE WS-HR-MINS                 TO CMANTATO.
 22967
 22968     EVALUATE PB-LF-REFUND-TYPE
 22969        WHEN '1'
 22970           MOVE 'RULE78'            TO CLFREFNO
 22971        WHEN '2'
 22972           MOVE 'PRORAT'            TO CLFREFNO
 22973        WHEN '3'
 22974           MOVE 'CALIF'             TO CLFREFNO
 22975        WHEN '4'
 22976           MOVE 'IRREG'             TO CLFREFNO
 22977        WHEN '5'
 22978           MOVE 'NETPAY'            TO CLFREFNO
 22979        WHEN '6'
 22980           MOVE 'ATCP'              TO CLFREFNO
 22981        WHEN '7'
 22982           MOVE 'UTAH'              TO CLFREFNO
 22983        WHEN '8'
 22984           MOVE 'MEAN'              TO CLFREFNO
 22985        WHEN '9'
 22986           MOVE 'SUM '              TO CLFREFNO
 22987        WHEN 'B'
 22988           MOVE 'BALN'              TO CLFREFNO
 22989     END-EVALUATE.
 22990
 22991     EVALUATE TRUE
 22992        WHEN PB-AH-REFUND-TYPE =  '1'
 22993           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 423
* EL6311.cbl
 22994        WHEN PB-AH-REFUND-TYPE =  '2'
 22995           MOVE 'PRORAT'            TO CAHREFNO
 22996        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22997           MOVE 'CALIF'             TO CAHREFNO
 22998        WHEN PB-AH-REFUND-TYPE =  '4'
 22999           MOVE 'IRREG'             TO CAHREFNO
 23000        WHEN PB-AH-REFUND-TYPE =  '5'
 23001           MOVE 'NETPAY'            TO CAHREFNO
 23002        WHEN PB-AH-REFUND-TYPE =  '6'
 23003           MOVE 'ATCP'              TO CAHREFNO
 23004        WHEN PB-AH-REFUND-TYPE =  '7'
 23005           MOVE 'UTAH'              TO CAHREFNO
 23006        WHEN PB-AH-REFUND-TYPE =  '8'
 23007           MOVE 'MEAN'              TO CAHREFNO
 23008        WHEN PB-AH-REFUND-TYPE =  '9'
 23009           MOVE 'SUM '              TO CAHREFNO
 23010        WHEN PB-AH-REFUND-TYPE =  'B'
 23011           MOVE 'BALN'              TO CAHREFNO
 23012     END-EVALUATE.
 23013
 23014     MOVE PB-REIN-CD                 TO CREINCDO.
 23015
 23016     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 23017        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 23018        MOVE SPACE                   TO DC-OPTION-CODE
 23019        PERFORM 9700-DATE-LINK
 23020        IF NO-CONVERSION-ERROR
 23021           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 23022
 23023     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 23024        MOVE 999999                  TO WS-EXP-DT-EDIT
 23025        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 23026        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 23027     ELSE
 23028        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 23029           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 23030           MOVE SPACE                   TO DC-OPTION-CODE
 23031           PERFORM 9700-DATE-LINK
 23032           IF NO-CONVERSION-ERROR
 23033              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 23034
 23035     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 23036        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 23037           MOVE AL-SANOF                TO CORIGHDA
 23038           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 23039           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 23040
 23041     MOVE PB-CSR-ID              TO CCSRO.
 23042
 23043     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 23044     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 23045     MOVE 'C'                    TO CMAINTI.
 23046     MOVE AL-UANON               TO CMAINTA.
 23047
 23048     IF PI-6316-FINALIZED = 'Y'  AND
 23049        PB-UNFORCED-ERRORS
 23050          MOVE -1                TO CFORCEL
 23051          MOVE  1                TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 424
* EL6311.cbl
 23052     END-IF
 23053
 23054     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 23055        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 23056
 23057     IF NO-CURSOR-SET
 23058        MOVE -1                  TO CMAINTL.
 23059
 23060     GO TO 8100-SEND-INITIAL-MAP.
 23061
 23062
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 425
* EL6311.cbl
 23064***************************************************************
 23065*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 23066*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 23067***************************************************************
 23068
 23069 7200-DISPLAY-BATCHES.
 23070     MOVE EL631D                 TO PI-MAP-NAME.
 23071     MOVE LOW-VALUES             TO EL631DI.
 23072
 23073     MOVE 'Y'                    TO WS-DISPLAY-SW.
 23074
 23075
 23076* EXEC CICS HANDLE CONDITION
 23077*         NOTFND   (3690-NOT-FOUND)
 23078*    END-EXEC.
 23079*    MOVE '"$I                   ! Y #00019304' TO DFHEIV0
 23080     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23082     MOVE X'5920233030303139333034' TO DFHEIV0(25:11)
 23083     CALL 'kxdfhei1' USING DFHEIV0
 23084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23085
 23086
 23087     IF PI-DISPLAY-SCREEN
 23088        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 23089     ELSE
 23090        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 23091
 23092     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 23093     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 23094
 23095
 23096* EXEC CICS READ
 23097*         DATASET   (FILE-ID-ERPNDB)
 23098*         RIDFLD    (ERPNDB-KEY)
 23099*         SET       (ADDRESS OF PENDING-BUSINESS)
 23100*    END-EXEC.
 23101*    MOVE '&"S        E          (   #00019316' TO DFHEIV0
 23102     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23104     MOVE X'2020233030303139333136' TO DFHEIV0(25:11)
 23105     CALL 'kxdfhei1' USING DFHEIV0,
 23106           FILE-ID-ERPNDB,
 23107           DFHEIV20,
 23108           DFHEIV99,
 23109           ERPNDB-KEY,
 23110           DFHEIV99,
 23111           DFHEIV99,
 23112           DFHEIV99
 23113     SET ADDRESS OF PENDING-BUSINESS TO
 23114         DFHEIV20
 23115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23116
 23117
 23118     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 23119     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 23120     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 23121     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 426
* EL6311.cbl
 23122     MOVE PB-SV-STATE            TO PI-SV-STATE.
 23123
 23124     MOVE EL631D                 TO PI-MAP-NAME.
 23125     MOVE LOW-VALUES             TO EL631DI.
 23126     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 23127
 23128*    IF PI-AR-PROCESSING
 23129*       MOVE PB-REFERENCE        TO DREFO.
 23130
 23131     MOVE PB-CSR-ID              TO DCSRO.
 23132
 23133     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23134        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23135        MOVE SPACE               TO DC-OPTION-CODE
 23136        PERFORM 9700-DATE-LINK
 23137        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23138        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23139        MOVE 'INACTIVE'          TO DLDATEO
 23140     ELSE
 23141        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23142        MOVE SPACE               TO DC-OPTION-CODE
 23143        PERFORM 9700-DATE-LINK
 23144        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23145
 23146     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23147     MOVE SPACE                  TO DC-OPTION-CODE.
 23148     PERFORM 9700-DATE-LINK.
 23149     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23150
 23151     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23152        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23153     ELSE
 23154        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23155        MOVE SPACE               TO DC-OPTION-CODE
 23156        PERFORM 9700-DATE-LINK
 23157        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23158
 23159     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23160     MOVE SPACE                  TO DC-OPTION-CODE.
 23161     PERFORM 9700-DATE-LINK.
 23162     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23163
 23164     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23165     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23166
 23167     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23168        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23169                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23170
 23171     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23172     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23173     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23174
 23175     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23176        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23177                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23178
 23179     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 427
* EL6311.cbl
 23180     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23181     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23182
 23183     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23184        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23185                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23186
 23187     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23188     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23189
 23190     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23191        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23192                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23193
 23194     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23195     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23196     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23197
 23198     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23199        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23200                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23201
 23202     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23203     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23204     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23205
 23206     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23207        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23208                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23209
 23210     MOVE -1                     TO DPFENTRL.
 23211     GO TO 8100-SEND-INITIAL-MAP.
 23212
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 428
* EL6311.cbl
 23214
 23215***************************************************************
 23216*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23217*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23218*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23219*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23220*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23221*     ARE THEN SET ACCORDINGLY.                               *
 23222*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23223*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23224*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23225***************************************************************
 23226
 23227******************************************************************
 23228*                                                                *
 23229*            E R R O R   A N A L Y S I S                         *
 23230*                                                                *
 23231******************************************************************
 23232
 23233******************************************************************
 23234*                                                                *
 23235*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23236*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23237*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23238*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23239*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23240*                                                                *
 23241*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23242*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23243*                                                                *
 23244******************************************************************
 23245
 23246 7300-FORMAT-ERRORS.
 23247     MOVE ' '                    TO PI-ERRORS-SW
 23248     IF PB-COMMON-ERRORS = LOW-VALUES
 23249        IF PB-FATAL-ERRORS
 23250           MOVE ER-2695          TO EMI-ERROR
 23251           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23252           GO TO 7399-EXIT.
 23253
 23254     MOVE +0                     TO WS-SUB4
 23255     move +0                     to pi-6311-fatal-ctr
 23256     .
 23257 7310-ERROR-LOOP.
 23258
 23259     ADD +1                      TO WS-SUB4.
 23260
 23261     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23262        GO TO 7350-SET-ERROR-FLAGS.
 23263
 23264     IF PI-COMPANY-ID = 'UCL'
 23265         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23266             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23267             MOVE ' '                   TO DC-OPTION-CODE
 23268             PERFORM 9700-DATE-LINK
 23269             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23270
 23271     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 429
* EL6311.cbl
 23272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23273     if (emi-fatal)
 23274        and (emi-error not = 1753 and 1754 and 1757 and
 23275                             1758 and 1759 and 1760)
 23276        add +1                   to pi-6311-fatal-ctr
 23277     end-if
 23278     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23279
 23280     GO TO 7310-ERROR-LOOP.
 23281
 23282
 23283 7350-SET-ERROR-FLAGS.
 23284
 23285     IF EMI-FATAL-CTR NOT = ZEROS
 23286        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23287        MOVE 'X'                 TO PB-FATAL-FLAG
 23288                                    PI-ERRORS-SW
 23289        GO TO 7355-SET-ERROR-FLAGS.
 23290
 23291     move ' ' to pi-unforced-sw
 23292     IF EMI-FORCABLE-CTR NOT = ZEROS
 23293        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23294        IF PB-ISSUE
 23295           IF PB-ISSUE-FORCE
 23296              MOVE 'F'           TO PB-FORCE-ER-CD
 23297              MOVE ER-2600       TO EMI-ERROR
 23298              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23299             ELSE
 23300              MOVE 'X'           TO PB-FORCE-ER-CD
 23301*                                   PI-ERRORS-SW
 23302          ELSE
 23303           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23304              MOVE 'F'           TO PB-FORCE-ER-CD
 23305                                    pi-unforced-sw
 23306              MOVE ER-2600       TO EMI-ERROR
 23307              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23308             ELSE
 23309              MOVE 'X'           TO PB-FORCE-ER-CD
 23310                                    pi-unforced-sw.
 23311*                                   PI-ERRORS-SW.
 23312
 23313     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23314     IF PB-ISSUE
 23315         MOVE 'I'                TO ENDT-RECORD-TYPE
 23316     ELSE
 23317         MOVE 'C'                TO ENDT-RECORD-TYPE
 23318     END-IF
 23319     MOVE +0                     TO ENDT-SEQ-NO
 23320
 23321
 23322* EXEC CICS READ
 23323*        DATASET   (FILE-ID-ERENDT)
 23324*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23325*        RIDFLD    (ERENDT-KEY)
 23326*        RESP      (WS-RESPONSE)
 23327*        GTEQ
 23328*    END-EXEC
 23329*    MOVE '&"S        G          (  N#00019525' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 430
* EL6311.cbl
 23330     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23332     MOVE X'204E233030303139353235' TO DFHEIV0(25:11)
 23333     CALL 'kxdfhei1' USING DFHEIV0,
 23334           FILE-ID-ERENDT,
 23335           DFHEIV20,
 23336           DFHEIV99,
 23337           ERENDT-KEY,
 23338           DFHEIV99,
 23339           DFHEIV99,
 23340           DFHEIV99
 23341     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23342         DFHEIV20
 23343     MOVE EIBRESP  TO WS-RESPONSE
 23344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23345
 23346     IF RESP-NORMAL
 23347        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23348        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23349            MOVE ER-0280          TO EMI-ERROR
 23350            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23351            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23352            EVALUATE TRUE
 23353              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23354                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23355              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23356                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23357              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23358                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23359            END-EVALUATE
 23360        END-IF
 23361     END-IF
 23362
 23363
 23364
 23365     IF FIRST-ENTRY OR
 23366        EIBAID = DFHPF1 OR DFHPF2
 23367        MOVE '0'                TO PI-EDIT-SW
 23368        GO TO 7399-EXIT.
 23369
 23370 7355-SET-ERROR-FLAGS.
 23371
 23372     IF EMI-WARNING-CTR NOT = ZEROS
 23373        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23374        MOVE 'W'                 TO PB-WARN-ER-CD.
 23375
 23376     IF PB-UNFORCED-ERRORS OR
 23377        PB-FATAL-ERRORS    OR
 23378        PB-RECORD-ON-HOLD  OR
 23379        PB-RECORD-RETURNED OR
 23380        PB-CANCELLATION
 23381          NEXT SENTENCE
 23382        ELSE
 23383          GO TO 7399-EXIT.
 23384
 23385
 23386* EXEC CICS  HANDLE CONDITION
 23387*           NOTFND   (7399-EXIT)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 431
* EL6311.cbl
 23388*    END-EXEC.
 23389*    MOVE '"$I                   ! Z #00019572' TO DFHEIV0
 23390     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23392     MOVE X'5A20233030303139353732' TO DFHEIV0(25:11)
 23393     CALL 'kxdfhei1' USING DFHEIV0
 23394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23395
 23396
 23397     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23398     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23399     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23400     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23401
 23402
 23403* EXEC CICS READ
 23404*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23405*        DATASET (FILE-ID-ELCERT)
 23406*        RIDFLD  (ELCERT-KEY)
 23407*        UPDATE
 23408*    END-EXEC.
 23409*    MOVE '&"S        EU         (   #00019581' TO DFHEIV0
 23410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23411     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23412     MOVE X'2020233030303139353831' TO DFHEIV0(25:11)
 23413     CALL 'kxdfhei1' USING DFHEIV0,
 23414           FILE-ID-ELCERT,
 23415           DFHEIV20,
 23416           DFHEIV99,
 23417           ELCERT-KEY,
 23418           DFHEIV99,
 23419           DFHEIV99,
 23420           DFHEIV99
 23421     SET ADDRESS OF CERTIFICATE-MASTER TO
 23422         DFHEIV20
 23423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23424
 23425
 23426
 23427     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23428     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23429
 23430     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23431        GO TO 7360-REWRITE-CERT-MASTER.
 23432
 23433     IF PB-ISSUE
 23434        IF PB-RECORD-RETURNED
 23435            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23436            GO TO 7360-REWRITE-CERT-MASTER
 23437        ELSE
 23438            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23439            GO TO 7360-REWRITE-CERT-MASTER.
 23440
 23441     IF PB-RECORD-RETURNED
 23442         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23443         GO TO 7360-REWRITE-CERT-MASTER.
 23444
 23445     IF (PB-C-LF-CANCEL-VOIDED)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 432
* EL6311.cbl
 23446        or (pb-c-ah-cancel-voided)
 23447        IF (PB-UNFORCED-ERRORS OR
 23448            PB-FATAL-ERRORS    OR
 23449            PB-RECORD-ON-HOLD)
 23450            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23451            GO TO 7360-REWRITE-CERT-MASTER
 23452        ELSE
 23453            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23454            GO TO 7360-REWRITE-CERT-MASTER.
 23455
 23456     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23457                            OR PB-RECORD-ON-HOLD)
 23458        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23459     ELSE
 23460        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23461
 23462 7360-REWRITE-CERT-MASTER.
 23463
 23464     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23465        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23466
 23467* EXEC CICS UNLOCK
 23468*            DATASET    (FILE-ID-ELCERT)
 23469*       END-EXEC
 23470*    MOVE '&*                    #   #00019628' TO DFHEIV0
 23471     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23473     MOVE X'2020233030303139363238' TO DFHEIV0(25:11)
 23474     CALL 'kxdfhei1' USING DFHEIV0,
 23475           FILE-ID-ELCERT,
 23476           DFHEIV99
 23477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23478        GO TO 7399-EXIT.
 23479
 23480
 23481* EXEC CICS REWRITE
 23482*         DATASET    (FILE-ID-ELCERT)
 23483*         FROM       (CERTIFICATE-MASTER)
 23484*    END-EXEC.
 23485     MOVE LENGTH OF
 23486      CERTIFICATE-MASTER
 23487       TO DFHEIV11
 23488*    MOVE '&& L                  %   #00019633' TO DFHEIV0
 23489     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23490     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23491     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 23492     CALL 'kxdfhei1' USING DFHEIV0,
 23493           FILE-ID-ELCERT,
 23494           CERTIFICATE-MASTER,
 23495           DFHEIV11,
 23496           DFHEIV99
 23497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23498
 23499
 23500 7399-EXIT.
 23501      EXIT.
 23502
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 433
* EL6311.cbl
 23504
 23505*************************************************************
 23506*                                                           *
 23507*              S E T   A T T R I B U T E S                  *
 23508*                                                           *
 23509*************************************************************
 23510
 23511 7400-SET-ATTRIBUTES.
 23512
 23513     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23514        GO TO 7499-EXIT.
 23515
 23516**2601**
 23517
 23518     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23519        IF PB-ISSUE
 23520           MOVE AL-UABON         TO BEFFDTA
 23521           GO TO 7499-EXIT
 23522         ELSE
 23523           MOVE AL-UABON         TO CEFFDTA
 23524           GO TO 7499-EXIT.
 23525
 23526**2604**
 23527
 23528     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23529        IF PB-ISSUE
 23530           MOVE AL-UABON         TO BTYPE1A
 23531           MOVE -1               TO BTYPE1L
 23532           MOVE  1               TO SET-CURSOR-SW
 23533           GO TO 7499-EXIT.
 23534
 23535**2605**
 23536
 23537     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23538        IF PB-ISSUE
 23539           MOVE AL-UABON         TO BTYPE2A
 23540           MOVE -1               TO BTYPE2L
 23541           MOVE  1               TO SET-CURSOR-SW
 23542           GO TO 7499-EXIT.
 23543
 23544**2606**
 23545
 23546     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23547        IF PB-ISSUE
 23548           MOVE AL-UABON         TO BSIGA
 23549           MOVE -1               TO BSIGL
 23550           MOVE  1               TO SET-CURSOR-SW
 23551           GO TO 7499-EXIT.
 23552
 23553**2607**
 23554
 23555     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23556        IF PB-ISSUE
 23557           MOVE AL-UABON         TO BSIGA
 23558           MOVE -1               TO BSIGL
 23559           MOVE  1               TO SET-CURSOR-SW
 23560           GO TO 7499-EXIT.
 23561
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 434
* EL6311.cbl
 23562**2615**
 23563
 23564     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23565        IF PB-ISSUE
 23566           MOVE AL-UABOF         TO BREINA
 23567           MOVE -1               TO BREINL
 23568           GO TO 7499-EXIT.
 23569
 23570**2622**
 23571
 23572     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23573        IF PB-ISSUE
 23574           MOVE AL-UABON         TO BEFFDTA
 23575           GO TO 7499-EXIT
 23576        ELSE
 23577           MOVE AL-UABON         TO CEFFDTA
 23578           GO TO 7499-EXIT.
 23579
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 435
* EL6311.cbl
 23581
 23582*************************************************************
 23583*                                                           *
 23584*              I S S U E   E R R O R S                      *
 23585*                                                           *
 23586*************************************************************
 23587
 23588 7420-ISSUE-ERRORS.
 23589
 23590**2626**
 23591
 23592     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23593        MOVE AL-UABON            TO BCERTNOA
 23594        GO TO 7499-EXIT.
 23595
 23596**2627**
 23597
 23598     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23599        MOVE AL-UNBON            TO BAGEA
 23600        MOVE -1                  TO BAGEL
 23601        MOVE  1                  TO SET-CURSOR-SW
 23602        GO TO 7499-EXIT.
 23603
 23604**2628**
 23605
 23606     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23607        MOVE AL-UNBON            TO BAGEA
 23608        MOVE -1                  TO BAGEL
 23609        MOVE  1                  TO SET-CURSOR-SW
 23610        GO TO 7499-EXIT.
 23611
 23612**2629**
 23613
 23614     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23615        MOVE AL-UABON            TO BSEXA
 23616        MOVE -1                  TO BSEXL
 23617        MOVE  1                  TO SET-CURSOR-SW
 23618        GO TO 7499-EXIT.
 23619
 23620**2630**
 23621
 23622     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23623        MOVE -1                  TO BTYPE1L
 23624        MOVE  1                  TO SET-CURSOR-SW
 23625        GO TO 7499-EXIT.
 23626
 23627**2631**
 23628
 23629     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23630        MOVE -1                  TO BTYPE1L
 23631        MOVE  1                  TO SET-CURSOR-SW
 23632        GO TO 7499-EXIT.
 23633
 23634**2632**
 23635
 23636     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23637        MOVE AL-UNBON            TO BBEN1A
 23638        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 436
* EL6311.cbl
 23639        MOVE  1                  TO SET-CURSOR-SW
 23640        GO TO 7499-EXIT.
 23641
 23642**2633**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23645        MOVE AL-UNBON            TO BPREM1A
 23646        MOVE -1                  TO BPREM1L
 23647        MOVE  1                  TO SET-CURSOR-SW
 23648        GO TO 7499-EXIT.
 23649
 23650**2634**
 23651
 23652     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23653        MOVE -1                  TO BTYPE2L
 23654        MOVE  1                  TO SET-CURSOR-SW
 23655        GO TO 7499-EXIT.
 23656
 23657**2635**
 23658
 23659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23660        MOVE AL-UNBON            TO BBEN2A
 23661        MOVE -1                  TO BBEN2L
 23662        MOVE  1                  TO SET-CURSOR-SW
 23663        GO TO 7499-EXIT.
 23664
 23665**2636**
 23666
 23667     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23668        MOVE AL-UNBON            TO BPREM2A
 23669        MOVE -1                  TO BPREM2L
 23670        MOVE  1                  TO SET-CURSOR-SW
 23671        GO TO 7499-EXIT.
 23672
 23673**2639**
 23674
 23675     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23676        MOVE AL-UNBON            TO BBEN1A
 23677        MOVE -1                  TO BBEN1L
 23678        MOVE  1                  TO SET-CURSOR-SW
 23679        GO TO 7499-EXIT.
 23680
 23681**2640**
 23682
 23683     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23684        MOVE AL-UNBON            TO BBEN2A
 23685        MOVE -1                  TO BBEN2L
 23686        MOVE  1                  TO SET-CURSOR-SW
 23687        GO TO 7499-EXIT.
 23688
 23689**2647**
 23690
 23691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23692        MOVE AL-UNBON            TO BTERM1A
 23693        MOVE -1                  TO BTERM1L
 23694        MOVE  1                  TO SET-CURSOR-SW
 23695        GO TO 7499-EXIT.
 23696
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 437
* EL6311.cbl
 23697**2648**
 23698
 23699     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23700        MOVE AL-UNBON            TO BLNTRMA
 23701        MOVE -1                  TO BLNTRML
 23702        MOVE  1                  TO SET-CURSOR-SW
 23703        GO TO 7499-EXIT.
 23704
 23705**2649**
 23706
 23707     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23708        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23709            MOVE AL-UNBON            TO BPREM1A
 23710            MOVE -1                  TO BPREM1L
 23711            MOVE  1                  TO SET-CURSOR-SW
 23712            GO TO 7499-EXIT
 23713     ELSE
 23714        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23715           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23716            MOVE AL-UNBON            TO BPREM2A
 23717            MOVE -1                  TO BPREM2L
 23718            MOVE  1                  TO SET-CURSOR-SW
 23719            GO TO 7499-EXIT.
 23720
 23721**2650**
 23722
 23723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23724        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23725            MOVE AL-UNBON        TO BPREM1A
 23726            MOVE -1              TO BPREM1L
 23727            MOVE  1              TO SET-CURSOR-SW
 23728            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23729                MOVE AL-UNBON        TO BPREM2A
 23730                MOVE -1              TO BPREM2L
 23731                MOVE  1              TO SET-CURSOR-SW
 23732                GO TO 7499-EXIT
 23733            ELSE
 23734                GO TO 7499-EXIT
 23735        ELSE
 23736            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23737                MOVE AL-UNBON        TO BPREM2A
 23738                MOVE -1              TO BPREM2L
 23739                MOVE  1              TO SET-CURSOR-SW
 23740                GO TO 7499-EXIT
 23741            ELSE
 23742                GO TO 7499-EXIT.
 23743
 23744**2651**
 23745
 23746     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23747        MOVE AL-UABON            TO BSIGA
 23748        MOVE -1                  TO BSIGL
 23749        MOVE  1                  TO SET-CURSOR-SW
 23750        GO TO 7499-EXIT.
 23751
 23752**2653**
 23753
 23754     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 438
* EL6311.cbl
 23755        MOVE AL-UABON            TO BFREQA
 23756        MOVE -1                  TO BFREQL
 23757        MOVE  1                  TO SET-CURSOR-SW
 23758        GO TO 7499-EXIT.
 23759
 23760**2654**
 23761
 23762     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23763        MOVE AL-UABON            TO BFREQA
 23764        MOVE -1                  TO BFREQL
 23765        MOVE  1                  TO SET-CURSOR-SW
 23766        GO TO 7499-EXIT.
 23767
 23768**2655**
 23769
 23770     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23771        MOVE AL-UABON            TO BFREQA
 23772        MOVE -1                  TO BFREQL
 23773        MOVE  1                  TO SET-CURSOR-SW
 23774        GO TO 7499-EXIT.
 23775
 23776**2656**
 23777
 23778     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23779        MOVE AL-UNBON            TO BAPRA
 23780        MOVE -1                  TO BAPRL
 23781        MOVE  1                  TO SET-CURSOR-SW
 23782        GO TO 7499-EXIT.
 23783
 23784**2657**
 23785
 23786     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23787        MOVE AL-UNBON            TO BAPRA
 23788        MOVE -1                  TO BAPRL
 23789        MOVE  1                  TO SET-CURSOR-SW
 23790        GO TO 7499-EXIT.
 23791
 23792**2658**
 23793
 23794     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23795        MOVE AL-UNBON            TO BTERM2A
 23796        MOVE -1                  TO BTERM2L
 23797        MOVE  1                  TO SET-CURSOR-SW
 23798        GO TO 7499-EXIT.
 23799
 23800**2660**
 23801
 23802     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23803        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23804        MOVE -1                  TO BLSTNML
 23805        MOVE  1                  TO SET-CURSOR-SW
 23806        GO TO 7499-EXIT.
 23807
 23808
 23809**2662**
 23810
 23811     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23812        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 439
* EL6311.cbl
 23813        MOVE -1                  TO BAGEL
 23814        MOVE  1                  TO SET-CURSOR-SW
 23815        GO TO 7499-EXIT.
 23816
 23817**2663**
 23818
 23819     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23820        MOVE AL-UNBON            TO BAGEA
 23821        MOVE -1                  TO BAGEL
 23822        MOVE  1                  TO SET-CURSOR-SW
 23823        GO TO 7499-EXIT.
 23824
 23825**2664**
 23826
 23827     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23828        MOVE AL-UABON            TO BREINA
 23829        MOVE -1                  TO BREINL
 23830        MOVE  1                  TO SET-CURSOR-SW
 23831        GO TO 7499-EXIT.
 23832
 23833**2667**
 23834
 23835     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23836        MOVE AL-UNBON            TO BBEN2A
 23837        MOVE -1                  TO BBEN2L
 23838        MOVE  1                  TO SET-CURSOR-SW
 23839        GO TO 7499-EXIT.
 23840
 23841**2668**
 23842
 23843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23844        MOVE AL-UABON            TO BEFFDTA
 23845        GO TO 7499-EXIT.
 23846
 23847**2669**
 23848
 23849     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23850       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23851       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23852        MOVE AL-UNBON            TO BAGEA
 23853        MOVE -1                  TO BAGEL
 23854        MOVE  1                  TO SET-CURSOR-SW
 23855        GO TO 7499-EXIT.
 23856
 23857**2670**
 23858
 23859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23860        MOVE AL-UABON            TO BFORCEA
 23861        MOVE -1                  TO BFORCEL
 23862        MOVE  1                  TO SET-CURSOR-SW
 23863        GO TO 7499-EXIT.
 23864
 23865**2671**
 23866
 23867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23868        MOVE AL-UABON            TO BEFFDTA
 23869        GO TO 7499-EXIT.
 23870
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 440
* EL6311.cbl
 23871**2672**
 23872
 23873     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23874        MOVE AL-UABON            TO BEFFDTA
 23875        GO TO 7499-EXIT.
 23876
 23877**2673**
 23878
 23879     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23880        MOVE AL-UABON            TO BEFFDTA
 23881        GO TO 7499-EXIT.
 23882
 23883**2674**
 23884
 23885     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23886        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23887        MOVE -1                  TO BTYPE1L
 23888        MOVE  1                  TO SET-CURSOR-SW
 23889        GO TO 7499-EXIT.
 23890
 23891**2677**
 23892
 23893     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23894        MOVE AL-UNBON            TO BTERM1A
 23895        MOVE -1                  TO BTERM1L
 23896        MOVE  1                  TO SET-CURSOR-SW
 23897        GO TO 7499-EXIT.
 23898
 23899**2678**
 23900
 23901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23902        MOVE AL-UNBON            TO BTERM2A
 23903        MOVE -1                  TO BTERM2L
 23904        MOVE  1                  TO SET-CURSOR-SW
 23905        GO TO 7499-EXIT.
 23906
 23907**2679**
 23908
 23909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23910        MOVE AL-UABON            TO BTYPE1A
 23911        MOVE -1                  TO BTYPE1L
 23912        MOVE  1                  TO SET-CURSOR-SW
 23913        GO TO 7499-EXIT.
 23914
 23915**2680**
 23916
 23917     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23918        MOVE AL-UABOF            TO B1STPMTA
 23919        MOVE -1                  TO B1STPMTL
 23920        MOVE  1                  TO SET-CURSOR-SW
 23921        GO TO 7499-EXIT.
 23922
 23923**2681**
 23924
 23925     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23926        MOVE AL-UABON            TO BDAYSA
 23927        MOVE -1                  TO BDAYSL
 23928        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 441
* EL6311.cbl
 23929        GO TO 7499-EXIT.
 23930
 23931**2682**
 23932
 23933     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23934        MOVE AL-UABON            TO BTERM1A
 23935        MOVE -1                  TO BTERM1L
 23936        MOVE  1                  TO SET-CURSOR-SW
 23937        GO TO 7499-EXIT.
 23938
 23939**2683**
 23940
 23941     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23942        MOVE AL-UABON            TO BSKPCDA
 23943        MOVE -1                  TO BSKPCDL
 23944        MOVE  1                  TO SET-CURSOR-SW
 23945        GO TO 7499-EXIT.
 23946
 23947**2684**
 23948
 23949     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23950        MOVE AL-UABON            TO BTYPE2A
 23951        MOVE -1                  TO BTYPE2L
 23952        MOVE  1                  TO SET-CURSOR-SW
 23953        GO TO 7499-EXIT.
 23954
 23955**2686**
 23956
 23957     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23958        MOVE AL-UABON            TO BTYPE2A
 23959        MOVE -1                  TO BTYPE2L
 23960        MOVE  1                  TO SET-CURSOR-SW
 23961        GO TO 7499-EXIT.
 23962
 23963**2689**
 23964
 23965     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23966        MOVE AL-UABON            TO BSIGA
 23967        MOVE -1                  TO BSIGL
 23968        MOVE  1                  TO SET-CURSOR-SW
 23969        GO TO 7499-EXIT.
 23970
 23971**2690**
 23972
 23973     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23974        MOVE AL-UABOF            TO BLNOFCRA
 23975        MOVE -1                  TO BLNOFCRL
 23976        MOVE  1                  TO SET-CURSOR-SW
 23977        GO TO 7499-EXIT.
 23978
 23979**2693**
 23980
 23981     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23982        MOVE AL-UABOF            TO BLNOFCRA
 23983        MOVE AL-UNBON            TO BBEN1A
 23984        MOVE -1                  TO BBEN1L
 23985        MOVE  1                  TO SET-CURSOR-SW
 23986        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 442
* EL6311.cbl
 23987
 23988**2720**
 23989
 23990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23991        MOVE AL-UNBON            TO BBEN1A
 23992        MOVE -1                  TO BBEN1L
 23993        MOVE  1                  TO SET-CURSOR-SW
 23994        GO TO 7499-EXIT.
 23995
 23996**2709**
 23997
 23998*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23999*       MOVE AL-UNBON            TO BBEN1A
 24000*       MOVE -1                  TO BBEN1L
 24001*       MOVE  1                  TO SET-CURSOR-SW
 24002*       GO TO 7499-EXIT.
 24003
 24004*************************************************************
 24005*                                                           *
 24006*            C A N C E L   E R R O R S                      *
 24007*                                                           *
 24008*************************************************************
 24009
 24010**2726**
 24011
 24012     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 24013        MOVE AL-UABON            TO CCERTNOA
 24014        GO TO 7499-EXIT.
 24015
 24016**2728**
 24017
 24018     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 24019        MOVE AL-UABON            TO CCERTNOA
 24020        GO TO 7499-EXIT.
 24021
 24022**2729**
 24023
 24024     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24025        MOVE AL-UABON            TO CCERTNOA
 24026        GO TO 7499-EXIT.
 24027
 24028**2730**
 24029
 24030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 24031        MOVE AL-UABON            TO CCERTNOA
 24032        GO TO 7499-EXIT.
 24033
 24034**2731**
 24035
 24036     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 24037        MOVE AL-UABON            TO CCANDT1A
 24038        MOVE -1                  TO CCANDT1L
 24039        MOVE  1                  TO SET-CURSOR-SW
 24040        GO TO 7499-EXIT.
 24041
 24042**2732**
 24043
 24044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 443
* EL6311.cbl
 24045        MOVE AL-UABON            TO CCANDT1A
 24046        MOVE -1                  TO CCANDT1L
 24047        MOVE  1                  TO SET-CURSOR-SW
 24048        GO TO 7499-EXIT.
 24049
 24050**2733**
 24051
 24052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24053        MOVE AL-UABON            TO CCANDT1A
 24054        MOVE -1                  TO CCANDT1L
 24055        MOVE  1                  TO SET-CURSOR-SW
 24056        GO TO 7499-EXIT.
 24057
 24058**2734**
 24059
 24060     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 24061        MOVE AL-UNBON            TO CREFND1A
 24062        MOVE -1                  TO CREFND1L
 24063        MOVE  1                  TO SET-CURSOR-SW
 24064        GO TO 7499-EXIT.
 24065
 24066**2735**
 24067
 24068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24069        MOVE AL-UABON            TO CCANDT2A
 24070        MOVE -1                  TO CCANDT2L
 24071        MOVE  1                  TO SET-CURSOR-SW
 24072        GO TO 7499-EXIT.
 24073
 24074**2736**
 24075
 24076     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 24077        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24078            MOVE AL-UNBON        TO CREFND1A
 24079            MOVE -1              TO CREFND1L
 24080            MOVE  1              TO SET-CURSOR-SW
 24081            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24082                MOVE AL-UNBON        TO CREFND2A
 24083                MOVE -1              TO CREFND2L
 24084                MOVE  1              TO SET-CURSOR-SW
 24085                GO TO 7499-EXIT
 24086            ELSE
 24087                GO TO 7499-EXIT
 24088        ELSE
 24089            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24090                MOVE AL-UNBON        TO CREFND2A
 24091                MOVE -1              TO CREFND2L
 24092                MOVE  1              TO SET-CURSOR-SW
 24093                GO TO 7499-EXIT
 24094            ELSE
 24095                GO TO 7499-EXIT.
 24096
 24097**2738**
 24098
 24099     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24100        MOVE -1                  TO CREFND2L
 24101        MOVE  1                  TO SET-CURSOR-SW
 24102        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 444
* EL6311.cbl
 24103
 24104**2739**
 24105
 24106     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24107        MOVE -1                  TO CREFND1L
 24108        MOVE  1                  TO SET-CURSOR-SW
 24109        GO TO 7499-EXIT.
 24110
 24111**2741**
 24112
 24113     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 24114        MOVE -1                  TO CREFND1L
 24115        MOVE  1                  TO SET-CURSOR-SW
 24116        GO TO 7499-EXIT.
 24117
 24118**2743**
 24119
 24120     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 24121        MOVE AL-UNBON            TO CCANDT1A
 24122        MOVE -1                  TO CCANDT1L
 24123        MOVE  1                  TO SET-CURSOR-SW
 24124        GO TO 7499-EXIT.
 24125
 24126**2744**
 24127
 24128     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 24129        MOVE AL-UNBON            TO CCANDT2A
 24130        MOVE -1                  TO CCANDT2L
 24131        MOVE  1                  TO SET-CURSOR-SW
 24132        GO TO 7499-EXIT.
 24133
 24134**2747**
 24135
 24136     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 24137        MOVE AL-UABON            TO CLSTNMA
 24138        MOVE -1                  TO CLSTNML
 24139        MOVE  1                  TO SET-CURSOR-SW
 24140        GO TO 7499-EXIT.
 24141
 24142**2749**
 24143
 24144     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24145        MOVE AL-UABON            TO CFORCEA
 24146        MOVE -1                  TO CFORCEL
 24147        MOVE  1                  TO SET-CURSOR-SW
 24148        GO TO 7499-EXIT.
 24149
 24150**2753**
 24151
 24152     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24153        MOVE AL-UNBON            TO CCANDT1A
 24154        MOVE -1                  TO CCANDT1L
 24155        MOVE  1                  TO SET-CURSOR-SW
 24156        GO TO 7499-EXIT.
 24157
 24158**2755**
 24159
 24160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 445
* EL6311.cbl
 24161        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24162            MOVE AL-UNBON        TO CREFND1A
 24163            MOVE -1              TO CREFND1L
 24164            MOVE  1              TO SET-CURSOR-SW
 24165            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24166                MOVE AL-UNBON        TO CREFND2A
 24167                MOVE -1              TO CREFND2L
 24168                MOVE  1              TO SET-CURSOR-SW
 24169                GO TO 7499-EXIT
 24170            ELSE
 24171                GO TO 7499-EXIT
 24172        ELSE
 24173            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24174                MOVE AL-UNBON        TO CREFND2A
 24175                MOVE -1              TO CREFND2L
 24176                MOVE  1              TO SET-CURSOR-SW
 24177            ELSE
 24178                GO TO 7499-EXIT.
 24179
 24180**2757**
 24181
 24182     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24183        MOVE AL-UNBON            TO CLIVESA
 24184        MOVE -1                  TO CLIVESL
 24185        MOVE  1                  TO SET-CURSOR-SW
 24186        GO TO 7499-EXIT.
 24187
 24188**2771**
 24189
 24190     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24191        MOVE AL-UABON            TO CCANDT2A
 24192        MOVE -1                  TO CCANDT2L
 24193        MOVE  1                  TO SET-CURSOR-SW
 24194        GO TO 7499-EXIT.
 24195
 24196**2774**
 24197
 24198     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24199        MOVE AL-UABON            TO CCANDT1A
 24200        MOVE -1                  TO CCANDT1L
 24201        MOVE  1                  TO SET-CURSOR-SW
 24202        GO TO 7499-EXIT.
 24203
 24204**2775**
 24205
 24206     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24207        MOVE AL-UABON            TO CCANDT2A
 24208        MOVE -1                  TO CCANDT2L
 24209        MOVE  1                  TO SET-CURSOR-SW
 24210        GO TO 7499-EXIT.
 24211
 24212**2776**
 24213
 24214     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24215        MOVE AL-UABON            TO CCANDT1A
 24216        MOVE -1                  TO CCANDT1L
 24217        MOVE  1                  TO SET-CURSOR-SW
 24218        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 446
* EL6311.cbl
 24219
 24220
 24221**2777**
 24222
 24223     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24224        MOVE AL-UABON            TO CCANDT2A
 24225        MOVE -1                  TO CCANDT2L
 24226        MOVE  1                  TO SET-CURSOR-SW
 24227        GO TO 7499-EXIT.
 24228
 24229**2794**
 24230
 24231     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24232        MOVE AL-UABON            TO CFORCEA
 24233        MOVE -1                  TO CFORCEL
 24234        MOVE  1                  TO SET-CURSOR-SW
 24235        GO TO 7499-EXIT.
 24236
 24237**2799**
 24238
 24239     IF PI-COMPANY-ID = 'UCL'
 24240         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24241             MOVE AL-UNBON            TO BEFFDTA
 24242             MOVE -1                  TO BEFFDTL
 24243             MOVE  1                  TO SET-CURSOR-SW
 24244             GO TO 7499-EXIT.
 24245
 24246 7499-EXIT.
 24247      EXIT.
 24248
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 447
* EL6311.cbl
 24250
 24251 7500-READ-ERLOFC.
 24252     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24253                                     ERLOFC-KEY.
 24254
 24255     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24256
 24257     IF ST-ACCNT-CNTL
 24258         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24259
 24260     IF CARR-GROUP-ST-ACCNT-CNTL
 24261         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24262         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24263         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24264
 24265     IF CARR-ST-ACCNT-CNTL
 24266         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24267         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24268
 24269     IF CARR-ACCNT-CNTL
 24270         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24271
 24272     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24273
 24274     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24275
 24276
 24277* EXEC CICS HANDLE CONDITION
 24278*        NOTFND   (7550-OFFICER-NOTFND)
 24279*    END-EXEC.
 24280*    MOVE '"$I                   ! [ #00020414' TO DFHEIV0
 24281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24283     MOVE X'5B20233030303230343134' TO DFHEIV0(25:11)
 24284     CALL 'kxdfhei1' USING DFHEIV0
 24285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24286
 24287
 24288
 24289* EXEC CICS READ
 24290*        DATASET   (FILE-ID-ERLOFC)
 24291*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24292*        RIDFLD    (ERLOFC-KEY)
 24293*        EQUAL
 24294*    END-EXEC.
 24295*    MOVE '&"S        E          (   #00020418' TO DFHEIV0
 24296     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24297     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24298     MOVE X'2020233030303230343138' TO DFHEIV0(25:11)
 24299     CALL 'kxdfhei1' USING DFHEIV0,
 24300           FILE-ID-ERLOFC,
 24301           DFHEIV20,
 24302           DFHEIV99,
 24303           ERLOFC-KEY,
 24304           DFHEIV99,
 24305           DFHEIV99,
 24306           DFHEIV99
 24307     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 448
* EL6311.cbl
 24308         DFHEIV20
 24309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24310
 24311
 24312     GO TO 7599-EXIT.
 24313
 24314 7550-OFFICER-NOTFND.
 24315     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24316
 24317 7599-EXIT.
 24318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 449
* EL6311.cbl
 24320******************************************************************
 24321*                                                                *
 24322*            S  E N D    I N I T I A L   M A P                   *
 24323*                                                                *
 24324******************************************************************
 24325
 24326 8100-SEND-INITIAL-MAP.
 24327     MOVE EIBTIME                TO TIME-IN.
 24328
 24329     IF EIBAID = DFHPF11
 24330        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24332
 24333
 24334     IF PI-COMPANY-ID = CLIENT-GIC
 24335        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24336                                       BCPREM-ATTRB (2).
 24337
 24338     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24339                         CLIENT-PEM OR
 24340                         CLIENT-CSO)
 24341        AND PI-DISPLAY-ORIGINAL-BATCH
 24342          IF PI-MAP-NAME = EL631B
 24343             MOVE AL-SADOF               TO BPF5HDRA
 24344                                            BPF4HDRA
 24345          ELSE
 24346             IF PI-MAP-NAME = EL631C
 24347                MOVE AL-SADOF            TO CPF5HDRA
 24348                                            CPF4HDRA.
 24349
 24350     IF PI-MAP-NAME = EL631B
 24351        MOVE AL-SADOF               TO BPF5HDRA
 24352     ELSE
 24353        MOVE AL-SADOF               TO CPF5HDRA
 24354     END-IF
 24355
 24356*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24357     IF PI-MAP-NAME = EL631B
 24358          IF PI-COMPANY-ID NOT = 'DMD'
 24359             MOVE AL-SANOF            TO BBILLEDA
 24360             MOVE AL-SADOF            TO DMDBILA.
 24361*DMD CUSTOM CODING*************END
 24362
 24363     IF PI-PROCESSOR-ID = 'LGXX'
 24364        IF PI-MAP-NAME = EL631B
 24365           MOVE AL-SABOF                    TO BREFHDGA
 24366           MOVE AL-SANOF                    TO BREFA
 24367        ELSE
 24368           IF PI-MAP-NAME = EL631C
 24369              MOVE AL-SABOF                 TO CREFHDGA
 24370              MOVE AL-SANOF                 TO CREFA.
 24371
 24372     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24373        continue
 24374     ELSE
 24375        IF PI-MAP-NAME = EL631C
 24376           MOVE AL-SADOF         TO CCANTXTA
 24377                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 450
* EL6311.cbl
 24378        end-if
 24379     end-if
 24380     IF PI-MAP-NAME = EL631D
 24381        IF PI-AR-PROCESSING
 24382           MOVE AL-SANOF            TO DREFHDGA
 24383        ELSE
 24384           MOVE AL-SADOF            TO DREFHDGA.
 24385
 24386     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24387        AND (PI-MAP-NAME = EL631B)
 24388        MOVE AL-SADOF            TO BVINHA
 24389                                    BVINA
 24390     END-IF
 24391     IF PI-MAP-NAME = EL631B
 24392        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24393        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24394                                 TO BREGIONO
 24395        MOVE PI-PROCESSOR-ID     TO BUSERO
 24396        IF CSR-EDIT-SESSION
 24397           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24398                                 TO BHEADO
 24399           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24400        ELSE
 24401           MOVE AL-SADOF         TO BF15HDRA
 24402           MOVE '4=B-HDR      '  TO BPF4HDRO
 24403        END-IF
 24404        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24405        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24406        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24407        MOVE WS-CURRENT-DT          TO BDATEO
 24408        MOVE TIME-OUT               TO BTIMEO
 24409        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24410        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24411        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24412        IF   WS-DISPLAY-SCREEN
 24413             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24414             MOVE PB-SV-CARRIER     TO BCARRO
 24415             MOVE PB-SV-GROUPING    TO BGROUPO
 24416             MOVE PB-SV-STATE       TO BSTATEO
 24417             MOVE PB-ACCOUNT        TO BACCTO
 24418        ELSE
 24419             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24420     ELSE
 24421        IF PI-MAP-NAME = EL631C
 24422           MOVE '4=B-HDR      '     TO CPF4HDRO
 24423           IF CSR-EDIT-SESSION
 24424              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24425                                 TO CHEADO
 24426           ELSE
 24427              MOVE AL-SADOF      TO CF15HDRA
 24428           END-IF
 24429           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24430           MOVE WS-CURRENT-DT          TO CDATEO
 24431           MOVE TIME-OUT               TO CTIMEO
 24432           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24433           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24434           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24435           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 451
* EL6311.cbl
 24436           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24437           MOVE WS-C-HDG               TO CAHHDGO
 24438           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24439           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24440           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24441           IF   WS-DISPLAY-SCREEN
 24442                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24443                MOVE PB-SV-CARRIER     TO CCARRO
 24444                MOVE PB-SV-GROUPING    TO CGROUPO
 24445                MOVE PB-SV-STATE       TO CSTATEO
 24446                MOVE PB-ACCOUNT        TO CACCTO
 24447           ELSE
 24448                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24449        ELSE
 24450           MOVE WS-CURRENT-DT          TO DDATEO
 24451           MOVE TIME-OUT               TO DTIMEO
 24452           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24453                                          WS-REFUND-HDG-OVERRIDE
 24454           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24455           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24456           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24457                                          WS-REFUND-HDG-OVERRIDE
 24458           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24459           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24460           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24461           IF CSR-EDIT-SESSION
 24462              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24463                                 TO DHEADO
 24464           END-IF
 24465           IF  WS-DISPLAY-SCREEN
 24466               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24467               MOVE PB-CARRIER         TO DCARRO
 24468               MOVE PB-GROUPING        TO DGROUPO
 24469               MOVE PB-STATE           TO DSTATEO
 24470               MOVE PB-ACCOUNT         TO DACCTO
 24471               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24472           ELSE
 24473               MOVE EL631D             TO PI-MAP-NAME
 24474               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24475               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24476
 24477     MOVE SPACE                        TO WS-DISPLAY-SW.
 24478
 24479
 24480* EXEC CICS SEND
 24481*        MAP      (PI-MAP-NAME)
 24482*        MAPSET   (MAPSET-EL6311S)
 24483*        FROM     (EL631BI)
 24484*        ERASE
 24485*        CURSOR
 24486*    END-EXEC.
 24487     MOVE LENGTH OF
 24488      EL631BI
 24489       TO DFHEIV12
 24490     MOVE -1
 24491       TO DFHEIV11
 24492*    MOVE '8$     CT  E    H L F ,   #00020592' TO DFHEIV0
 24493     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 452
* EL6311.cbl
 24494     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24495     MOVE X'2020233030303230353932' TO DFHEIV0(25:11)
 24496     CALL 'kxdfhei1' USING DFHEIV0,
 24497           PI-MAP-NAME,
 24498           EL631BI,
 24499           DFHEIV12,
 24500           MAPSET-EL6311S,
 24501           DFHEIV99,
 24502           DFHEIV99,
 24503           DFHEIV99,
 24504           DFHEIV11,
 24505           DFHEIV99,
 24506           DFHEIV99,
 24507           DFHEIV99
 24508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24509
 24510
 24511     GO TO 9100-RETURN-TRAN.
 24512
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 453
* EL6311.cbl
 24514
 24515******************************************************************
 24516*                                                                *
 24517*              S E N D    D A T A O N L Y                        *
 24518*                                                                *
 24519******************************************************************
 24520
 24521 8200-SEND-DATAONLY.
 24522     MOVE EIBTIME                TO TIME-IN.
 24523
 24524     IF PI-COMPANY-ID = CLIENT-GIC
 24525        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24526                                       BCPREM-ATTRB (2).
 24527
 24528     IF PI-MAP-NAME = EL631B
 24529        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24530        MOVE WS-CURRENT-DT          TO BDATEO
 24531        MOVE TIME-OUT               TO BTIMEO
 24532        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24533        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24534        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24535        MOVE SPACES                 TO BPFENTRO
 24536        MOVE AL-UANOF               TO BPFENTRA
 24537
 24538*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24539        IF PI-COMPANY-ID NOT = 'DMD'
 24540             MOVE AL-SANOF            TO BBILLEDA
 24541             MOVE AL-SADOF            TO DMDBILA
 24542         ELSE
 24543            NEXT SENTENCE
 24544*DMD CUSTOM CODING*************END
 24545     ELSE
 24546        IF PI-MAP-NAME = EL631C
 24547           MOVE WS-CURRENT-DT          TO CDATEO
 24548           MOVE TIME-OUT               TO CTIMEO
 24549           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24550           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24551           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24552           MOVE SPACES                 TO CPFENTRO
 24553           MOVE AL-UANOF               TO CPFENTRA
 24554        ELSE
 24555           MOVE WS-CURRENT-DT          TO DDATEO
 24556           MOVE TIME-OUT               TO DTIMEO
 24557           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24558
 24559
 24560* EXEC CICS SEND
 24561*        MAP      (PI-MAP-NAME)
 24562*        MAPSET   (MAPSET-EL6311S)
 24563*        FROM     (EL631BI)
 24564*        DATAONLY
 24565*        CURSOR
 24566*    END-EXEC.
 24567     MOVE LENGTH OF
 24568      EL631BI
 24569       TO DFHEIV12
 24570     MOVE -1
 24571       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 454
* EL6311.cbl
 24572*    MOVE '8$D    CT       H L F ,   #00020648' TO DFHEIV0
 24573     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24574     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24575     MOVE X'2020233030303230363438' TO DFHEIV0(25:11)
 24576     CALL 'kxdfhei1' USING DFHEIV0,
 24577           PI-MAP-NAME,
 24578           EL631BI,
 24579           DFHEIV12,
 24580           MAPSET-EL6311S,
 24581           DFHEIV99,
 24582           DFHEIV99,
 24583           DFHEIV99,
 24584           DFHEIV11,
 24585           DFHEIV99,
 24586           DFHEIV99,
 24587           DFHEIV99
 24588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24589
 24590
 24591     GO TO 9100-RETURN-TRAN.
 24592
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 455
* EL6311.cbl
 24594
 24595******************************************************************
 24596*                                                                *
 24597*           U T I L I T Y   R O U T I N E S                      *
 24598*                                                                *
 24599******************************************************************
 24600
 24601 8300-SEND-TEXT.
 24602
 24603* EXEC CICS SEND TEXT
 24604*        FROM     (LOGOFF-TEXT)
 24605*        LENGTH   (LOGOFF-LENGTH)
 24606*        ERASE
 24607*        FREEKB
 24608*    END-EXEC.
 24609*    MOVE '8&      T  E F  H   F -   #00020667' TO DFHEIV0
 24610     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24611     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24612     MOVE X'2020233030303230363637' TO DFHEIV0(25:11)
 24613     CALL 'kxdfhei1' USING DFHEIV0,
 24614           LOGOFF-TEXT,
 24615           LOGOFF-LENGTH,
 24616           DFHEIV99,
 24617           DFHEIV99,
 24618           DFHEIV99,
 24619           DFHEIV99,
 24620           DFHEIV99,
 24621           DFHEIV99,
 24622           DFHEIV99,
 24623           DFHEIV99,
 24624           DFHEIV99,
 24625           DFHEIV99
 24626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24627
 24628
 24629
 24630* EXEC CICS RETURN
 24631*    END-EXEC.
 24632*    MOVE '.(                    ''   #00020674' TO DFHEIV0
 24633     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24635     MOVE X'2020233030303230363734' TO DFHEIV0(25:11)
 24636     CALL 'kxdfhei1' USING DFHEIV0,
 24637           DFHEIV99,
 24638           DFHEIV99,
 24639           DFHEIV99,
 24640           DFHEIV99,
 24641           DFHEIV99,
 24642           DFHEIV99
 24643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24644
 24645
 24646 8400-LOG-JOURNAL-RECORD.
 24647     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24648     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24649
 24650*    EXEC CICS JOURNAL
 24651*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 456
* EL6311.cbl
 24652*        JTYPEID     ('EL')
 24653*        FROM        (JOURNAL-RECORD)
 24654*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24655*    END-EXEC.
 24656
 24657 8600-DEEDIT.
 24658
 24659* EXEC CICS BIF DEEDIT
 24660*         FIELD   (DEEDIT-FIELD)
 24661*         LENGTH  (15)
 24662*    END-EXEC.
 24663     MOVE 15
 24664       TO DFHEIV11
 24665*    MOVE '@"L                   #   #00020689' TO DFHEIV0
 24666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24668     MOVE X'2020233030303230363839' TO DFHEIV0(25:11)
 24669     CALL 'kxdfhei1' USING DFHEIV0,
 24670           DEEDIT-FIELD,
 24671           DFHEIV11
 24672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24673
 24674
 24675 8800-UNAUTHORIZED-ACCESS.
 24676     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24677     GO TO 8300-SEND-TEXT.
 24678
 24679 8810-PF23.
 24680     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24681     MOVE XCTL-EL005             TO PGM-NAME.
 24682     GO TO 9300-XCTL.
 24683
 24684 9100-RETURN-TRAN.
 24685     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24686
 24687     IF  PI-MAP-NAME =  EL631B
 24688         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24689
 24690     IF  PI-MAP-NAME =  EL631C
 24691         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24692
 24693     IF  PI-MAP-NAME =  EL631D
 24694         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24695
 24696
 24697* EXEC CICS RETURN
 24698*        TRANSID    (TRANS-EXB1)
 24699*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24700*        LENGTH     (1300)
 24701*    END-EXEC.
 24702     MOVE 1300
 24703       TO DFHEIV11
 24704*    MOVE '.(CT                  ''   #00020715' TO DFHEIV0
 24705     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24707     MOVE X'2020233030303230373135' TO DFHEIV0(25:11)
 24708     CALL 'kxdfhei1' USING DFHEIV0,
 24709           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 457
* EL6311.cbl
 24710           PROGRAM-INTERFACE-BLOCK,
 24711           DFHEIV11,
 24712           DFHEIV99,
 24713           DFHEIV99,
 24714           DFHEIV99
 24715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24716
 24717
 24718 9200-RETURN-MAIN-MENU.
 24719     MOVE XCTL-EL626             TO PGM-NAME.
 24720     GO TO 9300-XCTL.
 24721
 24722 9300-XCTL.
 24723
 24724* EXEC CICS XCTL
 24725*        PROGRAM    (PGM-NAME)
 24726*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24727*        LENGTH     (PI-COMM-LENGTH)
 24728*    END-EXEC.
 24729*    MOVE '.$C                   %   #00020726' TO DFHEIV0
 24730     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24731     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24732     MOVE X'2020233030303230373236' TO DFHEIV0(25:11)
 24733     CALL 'kxdfhei1' USING DFHEIV0,
 24734           PGM-NAME,
 24735           PROGRAM-INTERFACE-BLOCK,
 24736           PI-COMM-LENGTH,
 24737           DFHEIV99
 24738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24739
 24740
 24741 9400-CLEAR.
 24742     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24743     GO TO 9300-XCTL.
 24744
 24745 9500-PF12.
 24746     MOVE XCTL-EL010             TO PGM-NAME.
 24747     GO TO 9300-XCTL.
 24748
 24749 9600-PGMID-ERROR.
 24750
 24751* EXEC CICS HANDLE CONDITION
 24752*        PGMIDERR    (8300-SEND-TEXT)
 24753*    END-EXEC.
 24754*    MOVE '"$L                   ! \ #00020741' TO DFHEIV0
 24755     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24757     MOVE X'5C20233030303230373431' TO DFHEIV0(25:11)
 24758     CALL 'kxdfhei1' USING DFHEIV0
 24759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24760
 24761
 24762     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24763     MOVE ' '                    TO PI-ENTRY-CD-1.
 24764     MOVE XCTL-EL005             TO PGM-NAME.
 24765     MOVE PGM-NAME               TO LOGOFF-PGM.
 24766     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24767     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 458
* EL6311.cbl
 24768
 24769 9700-DATE-LINK.
 24770     MOVE LINK-ELDATCV           TO PGM-NAME.
 24771
 24772* EXEC CICS LINK
 24773*        PROGRAM    (PGM-NAME)
 24774*        COMMAREA   (DATE-CONVERSION-DATA)
 24775*        LENGTH     (DC-COMM-LENGTH)
 24776*    END-EXEC.
 24777*    MOVE '."C                   (   #00020754' TO DFHEIV0
 24778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24780     MOVE X'2020233030303230373534' TO DFHEIV0(25:11)
 24781     CALL 'kxdfhei1' USING DFHEIV0,
 24782           PGM-NAME,
 24783           DATE-CONVERSION-DATA,
 24784           DC-COMM-LENGTH,
 24785           DFHEIV99,
 24786           DFHEIV99,
 24787           DFHEIV99,
 24788           DFHEIV99
 24789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24790
 24791
 24792 9800-LINK-PENDING-EDIT.
 24793     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24794     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24795
 24796     MOVE LINK-EL050             TO PGM-NAME
 24797     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24798     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24799                                    WK-CO-TOL-CLAIM
 24800                                    WK-CO-TOL-PREM
 24801                                    WK-CO-TOL-REFUND
 24802                                    WK-CO-TOL-PREM-PCT
 24803                                    WK-CO-TOL-REFUND-PCT
 24804                                    WK-REFUND-OVS-AMT
 24805                                    WK-REFUND-OVS-PCT
 24806                                    WK-ACCT-ADDR
 24807                                    WK-LIFE-EDIT-ADDR
 24808                                    WK-AH-EDIT-ADDR
 24809                                    WK-LIFE-BEN-ADDR
 24810                                    WK-AH-BEN-ADDR
 24811                                    WK-STATE-ADDR
 24812                                    WK-PLAN-ADDR
 24813                                    WK-FORM-ADDR
 24814     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24815
 24816     MOVE '6'                    TO WK-ENTRY-SW.
 24817
 24818     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24819
 24820     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24821                                    EC-AM-EXPIRATION-DT
 24822                                    EC-AM-EFFECTIVE-DT
 24823                                    EC-CM-LF-CANCEL-DT
 24824                                    EC-CM-AH-CANCEL-DT
 24825                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 459
* EL6311.cbl
 24826
 24827     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24828                                    EC-CO-TOL-REFUND
 24829                                    EC-CO-MIN-AGE
 24830                                    EC-CO-MIN-PREMIUM
 24831                                    EC-CO-MIN-TERM
 24832                                    EC-CO-MAX-TERM
 24833                                    EC-ST-TOL-PREM
 24834                                    EC-ST-TOL-REFUND
 24835                                    EC-AM-LF-TOL-PREM
 24836                                    EC-AM-AH-TOL-PREM
 24837                                    EC-AM-LF-MAX-ATT-AGE
 24838                                    EC-AM-LF-MAX-AGE
 24839                                    EC-AM-LF-MAX-TERM
 24840                                    EC-AM-LF-MAX-TOT-BEN
 24841                                    EC-AM-AH-MAX-ATT-AGE
 24842                                    EC-AM-AH-MAX-AGE
 24843                                    EC-AM-AH-MAX-TERM
 24844                                    EC-AM-AH-MAX-TOT-BEN
 24845                                    EC-AM-AH-MAX-MON-BEN
 24846                                    EC-RT-LF-MAX-ATT-AGE
 24847                                    EC-RT-LF-MAX-AGE
 24848                                    EC-RT-LF-MAX-TERM
 24849                                    EC-RT-LF-MAX-TOT-BEN
 24850                                    EC-RT-AH-MAX-ATT-AGE
 24851                                    EC-RT-AH-MAX-AGE
 24852                                    EC-RT-AH-MAX-TERM
 24853                                    EC-RT-AH-MAX-TOT-BEN
 24854                                    EC-RT-AH-MAX-MON-BEN
 24855                                    EC-RT-AH-RATE
 24856                                    EC-RT-LF-RATE
 24857                                    EC-RT-LF-NSP-RATE
 24858                                    EC-RT-AH-NSP-RATE
 24859                                    EC-CM-LF-PRIOR-REFUND
 24860                                    EC-CM-AH-PRIOR-REFUND.
 24861
 24862     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24863                                    EC-ST-TOL-PREM-PCT
 24864                                    EC-AM-LF-TOL-REFUND
 24865                                    EC-AM-LF-DEV-PERCENT
 24866                                    EC-CO-TOL-REFUND-PCT
 24867                                    EC-ST-TOL-REFUND-PCT
 24868                                    EC-AM-AH-TOL-REFUND
 24869                                    EC-AM-AH-DEV-PERCENT.
 24870
 24871
 24872* EXEC CICS LINK
 24873*         PROGRAM   (PGM-NAME)
 24874*         COMMAREA  (PASSED-RECORD)
 24875*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24876*    END-EXEC.
 24877*    MOVE '."C                   (   #00020839' TO DFHEIV0
 24878     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24880     MOVE X'2020233030303230383339' TO DFHEIV0(25:11)
 24881     CALL 'kxdfhei1' USING DFHEIV0,
 24882           PGM-NAME,
 24883           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 460
* EL6311.cbl
 24884           WS-EDIT-PASS-LENGTH,
 24885           DFHEIV99,
 24886           DFHEIV99,
 24887           DFHEIV99,
 24888           DFHEIV99
 24889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24890
 24891
 24892     MOVE '1'                    TO PI-EDIT-SW.
 24893     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24894
 24895     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24896
 24897     IF PI-COMPANY-ID = 'UCL'
 24898         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24899
 24900     IF VALID-PB-ID
 24901        GO TO 9800-EXIT.
 24902
 24903     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24904
 24905     IF PI-MAP-NAME = EL631B
 24906        MOVE -1                  TO BMAINTL
 24907       ELSE
 24908        MOVE -1                  TO CMAINTL.
 24909
 24910     GO TO 8200-SEND-DATAONLY.
 24911
 24912 9800-EXIT.
 24913      EXIT.
 24914
 24915 9900-ERROR-FORMAT.
 24916
 24917     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24918
 24919     IF NOT EMI-ERRORS-COMPLETE
 24920         MOVE LINK-EL001         TO PGM-NAME
 24921
 24922* EXEC CICS LINK
 24923*            PROGRAM    (PGM-NAME)
 24924*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24925*            LENGTH     (EMI-COMM-LENGTH)
 24926*        END-EXEC.
 24927*    MOVE '."C                   (   #00020874' TO DFHEIV0
 24928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24930     MOVE X'2020233030303230383734' TO DFHEIV0(25:11)
 24931     CALL 'kxdfhei1' USING DFHEIV0,
 24932           PGM-NAME,
 24933           ERROR-MESSAGE-INTERFACE-BLOCK,
 24934           EMI-COMM-LENGTH,
 24935           DFHEIV99,
 24936           DFHEIV99,
 24937           DFHEIV99,
 24938           DFHEIV99
 24939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24940
 24941
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 461
* EL6311.cbl
 24942 9900-EXIT.
 24943     EXIT.
 24944
 24945 9990-ABEND.
 24946     MOVE LINK-EL004             TO PGM-NAME.
 24947     MOVE DFHEIBLK               TO EMI-LINE1.
 24948
 24949* EXEC CICS LINK
 24950*        PROGRAM   (PGM-NAME)
 24951*        COMMAREA  (EMI-LINE1)
 24952*        LENGTH    (72)
 24953*    END-EXEC.
 24954     MOVE 72
 24955       TO DFHEIV11
 24956*    MOVE '."C                   (   #00020886' TO DFHEIV0
 24957     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24959     MOVE X'2020233030303230383836' TO DFHEIV0(25:11)
 24960     CALL 'kxdfhei1' USING DFHEIV0,
 24961           PGM-NAME,
 24962           EMI-LINE1,
 24963           DFHEIV11,
 24964           DFHEIV99,
 24965           DFHEIV99,
 24966           DFHEIV99,
 24967           DFHEIV99
 24968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24969
 24970
 24971     IF PI-MAP-NAME = EL631B
 24972        MOVE -1                  TO BMAINTL
 24973       ELSE
 24974        MOVE -1                  TO CMAINTL.
 24975
 24976     IF EIBTRNID NOT = TRANS-EXB1
 24977        GO TO 8100-SEND-INITIAL-MAP
 24978       ELSE
 24979        GO TO 8200-SEND-DATAONLY.
 24980
 24981 9995-SECURITY-VIOLATION.
 24982*                            COPY ELCSCTP.
 24983******************************************************************
 24984*                                                                *
 24985*                            ELCSCTP                             *
 24986*                            VMOD=2.001                          *
 24987*                                                                *
 24988*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24989******************************************************************
 24990
 24991
 24992     MOVE EIBDATE          TO SM-JUL-DATE.
 24993     MOVE EIBTRMID         TO SM-TERMID.
 24994     MOVE THIS-PGM         TO SM-PGM.
 24995     MOVE EIBTIME          TO TIME-IN.
 24996     MOVE TIME-OUT         TO SM-TIME.
 24997     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24998
 24999
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 462
* EL6311.cbl
 25000* EXEC CICS LINK
 25001*         PROGRAM  ('EL003')
 25002*         COMMAREA (SECURITY-MESSAGE)
 25003*         LENGTH   (80)
 25004*    END-EXEC.
 25005     MOVE 'EL003' TO DFHEIV1
 25006     MOVE 80
 25007       TO DFHEIV11
 25008*    MOVE '."C                   (   #00020920' TO DFHEIV0
 25009     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 25010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 25011     MOVE X'2020233030303230393230' TO DFHEIV0(25:11)
 25012     CALL 'kxdfhei1' USING DFHEIV0,
 25013           DFHEIV1,
 25014           SECURITY-MESSAGE,
 25015           DFHEIV11,
 25016           DFHEIV99,
 25017           DFHEIV99,
 25018           DFHEIV99,
 25019           DFHEIV99
 25020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 25021
 25022
 25023******************************************************************
 25024
 25025
 25026 9999-DFHBACK SECTION.
 25027     MOVE '9%                    "   ' TO DFHEIV0
 25028     MOVE 'EL6311' TO DFHEIV1
 25029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25030     GOBACK.
 25031 9999-DFHEXIT.
 25032     IF DFHEIGDJ EQUAL 0001
 25033         NEXT SENTENCE
 25034     ELSE IF DFHEIGDJ EQUAL 2
 25035         GO TO 9600-PGMID-ERROR,
 25036               9990-ABEND,
 25037               9990-ABEND,
 25038               0010-MAIN-LOGIC
 25039         DEPENDING ON DFHEIGDI
 25040     ELSE IF DFHEIGDJ EQUAL 3
 25041         GO TO 1280-BATCH-HDR-NOT-FOUND
 25042         DEPENDING ON DFHEIGDI
 25043     ELSE IF DFHEIGDJ EQUAL 4
 25044         GO TO 1290-DUPLICATE-ALT-INDEX
 25045         DEPENDING ON DFHEIGDI
 25046     ELSE IF DFHEIGDJ EQUAL 5
 25047         GO TO 1295-CERT-TRL-REC-NOTFND
 25048         DEPENDING ON DFHEIGDI
 25049     ELSE IF DFHEIGDJ EQUAL 6
 25050         GO TO 1380-BATCH-HDR-NOT-FOUND
 25051         DEPENDING ON DFHEIGDI
 25052     ELSE IF DFHEIGDJ EQUAL 7
 25053         GO TO 1385-REC-NOT-FOUND
 25054         DEPENDING ON DFHEIGDI
 25055     ELSE IF DFHEIGDJ EQUAL 8
 25056         GO TO 1386-NOTFND
 25057         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 463
* EL6311.cbl
 25058     ELSE IF DFHEIGDJ EQUAL 9
 25059         GO TO 1399-EXIT
 25060         DEPENDING ON DFHEIGDI
 25061     ELSE IF DFHEIGDJ EQUAL 10
 25062         GO TO 1480-BATCH-HDR-NOT-FOUND
 25063         DEPENDING ON DFHEIGDI
 25064     ELSE IF DFHEIGDJ EQUAL 11
 25065         GO TO 1490-RECORD-NOT-FOUND
 25066         DEPENDING ON DFHEIGDI
 25067     ELSE IF DFHEIGDJ EQUAL 12
 25068         GO TO 1405-DELETE-CERTIFICATE
 25069         DEPENDING ON DFHEIGDI
 25070     ELSE IF DFHEIGDJ EQUAL 13
 25071         GO TO 1420-CONTINUE-DELETE
 25072         DEPENDING ON DFHEIGDI
 25073     ELSE IF DFHEIGDJ EQUAL 14
 25074         GO TO 1406-DELETE-ERNOTE
 25075         DEPENDING ON DFHEIGDI
 25076     ELSE IF DFHEIGDJ EQUAL 15
 25077         GO TO 1407-DELETE-MAILING
 25078         DEPENDING ON DFHEIGDI
 25079     ELSE IF DFHEIGDJ EQUAL 16
 25080         GO TO 1420-CONTINUE-DELETE
 25081         DEPENDING ON DFHEIGDI
 25082     ELSE IF DFHEIGDJ EQUAL 17
 25083         GO TO 1480-BATCH-HDR-NOT-FOUND
 25084         DEPENDING ON DFHEIGDI
 25085     ELSE IF DFHEIGDJ EQUAL 18
 25086         GO TO 1475-DELETE-FINISHED
 25087         DEPENDING ON DFHEIGDI
 25088     ELSE IF DFHEIGDJ EQUAL 19
 25089         GO TO 2280-BATCH-HDR-NOT-FOUND
 25090         DEPENDING ON DFHEIGDI
 25091     ELSE IF DFHEIGDJ EQUAL 20
 25092         GO TO 2290-DUPLICATE-ALT-INDEX
 25093         DEPENDING ON DFHEIGDI
 25094     ELSE IF DFHEIGDJ EQUAL 21
 25095         GO TO 2380-BATCH-HDR-NOT-FOUND
 25096         DEPENDING ON DFHEIGDI
 25097     ELSE IF DFHEIGDJ EQUAL 22
 25098         GO TO 2385-REC-NOT-FOUND
 25099         DEPENDING ON DFHEIGDI
 25100     ELSE IF DFHEIGDJ EQUAL 23
 25101         GO TO 2380-BATCH-HDR-NOT-FOUND
 25102         DEPENDING ON DFHEIGDI
 25103     ELSE IF DFHEIGDJ EQUAL 24
 25104         GO TO 2485-BATCH-HDR-NOT-FOUND
 25105         DEPENDING ON DFHEIGDI
 25106     ELSE IF DFHEIGDJ EQUAL 25
 25107         GO TO 2490-RECORD-NOT-FOUND
 25108         DEPENDING ON DFHEIGDI
 25109     ELSE IF DFHEIGDJ EQUAL 26
 25110         GO TO 2475-CONTINUE-DELETE
 25111         DEPENDING ON DFHEIGDI
 25112     ELSE IF DFHEIGDJ EQUAL 27
 25113         GO TO 2485-BATCH-HDR-NOT-FOUND
 25114         DEPENDING ON DFHEIGDI
 25115     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 464
* EL6311.cbl
 25116         GO TO 2480-DELETE-FINISHED
 25117         DEPENDING ON DFHEIGDI
 25118     ELSE IF DFHEIGDJ EQUAL 29
 25119         GO TO 2820-PROCESS-REWRITE
 25120         DEPENDING ON DFHEIGDI
 25121     ELSE IF DFHEIGDJ EQUAL 30
 25122         GO TO 2885-RECORD-MISSING
 25123         DEPENDING ON DFHEIGDI
 25124     ELSE IF DFHEIGDJ EQUAL 31
 25125         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25126         DEPENDING ON DFHEIGDI
 25127     ELSE IF DFHEIGDJ EQUAL 32
 25128         GO TO 2827-DELETE-MAILING
 25129         DEPENDING ON DFHEIGDI
 25130     ELSE IF DFHEIGDJ EQUAL 33
 25131         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 25132         DEPENDING ON DFHEIGDI
 25133     ELSE IF DFHEIGDJ EQUAL 34
 25134         GO TO 2920-PROCESS-REWRITE
 25135         DEPENDING ON DFHEIGDI
 25136     ELSE IF DFHEIGDJ EQUAL 35
 25137         GO TO 2985-RECORD-MISSING
 25138         DEPENDING ON DFHEIGDI
 25139     ELSE IF DFHEIGDJ EQUAL 36
 25140         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25141         DEPENDING ON DFHEIGDI
 25142     ELSE IF DFHEIGDJ EQUAL 37
 25143         GO TO 2990-DUPLICATE-RECORD
 25144         DEPENDING ON DFHEIGDI
 25145     ELSE IF DFHEIGDJ EQUAL 38
 25146         GO TO 3590-NOT-FOUND
 25147         DEPENDING ON DFHEIGDI
 25148     ELSE IF DFHEIGDJ EQUAL 39
 25149         GO TO 3690-NOT-FOUND
 25150         DEPENDING ON DFHEIGDI
 25151     ELSE IF DFHEIGDJ EQUAL 40
 25152         GO TO 3990-NOT-FOUND
 25153         DEPENDING ON DFHEIGDI
 25154     ELSE IF DFHEIGDJ EQUAL 41
 25155         GO TO 4050-END-RECORDS,
 25156               4050-END-RECORDS
 25157         DEPENDING ON DFHEIGDI
 25158     ELSE IF DFHEIGDJ EQUAL 42
 25159         GO TO 4150-END-BATCH
 25160         DEPENDING ON DFHEIGDI
 25161     ELSE IF DFHEIGDJ EQUAL 43
 25162         GO TO 4150-END-BATCH
 25163         DEPENDING ON DFHEIGDI
 25164     ELSE IF DFHEIGDJ EQUAL 44
 25165         GO TO 4250-END-RECORDS,
 25166               4250-END-RECORDS
 25167         DEPENDING ON DFHEIGDI
 25168     ELSE IF DFHEIGDJ EQUAL 45
 25169         GO TO 4350-END-BATCH,
 25170               4350-END-BATCH
 25171         DEPENDING ON DFHEIGDI
 25172     ELSE IF DFHEIGDJ EQUAL 46
 25173         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 06-Aug-18 11:37 Page 465
* EL6311.cbl
 25174               4550-END-RECORDS
 25175         DEPENDING ON DFHEIGDI
 25176     ELSE IF DFHEIGDJ EQUAL 47
 25177         GO TO 4680-NOT-FOUND,
 25178               4680-NOT-FOUND
 25179         DEPENDING ON DFHEIGDI
 25180     ELSE IF DFHEIGDJ EQUAL 48
 25181         GO TO 4860-NOT-FOUND,
 25182               4850-END-RECORDS
 25183         DEPENDING ON DFHEIGDI
 25184     ELSE IF DFHEIGDJ EQUAL 49
 25185         GO TO 4970-NOT-FOUND,
 25186               4950-END-RECORDS
 25187         DEPENDING ON DFHEIGDI
 25188     ELSE IF DFHEIGDJ EQUAL 50
 25189         GO TO 5050-NOT-FOUND
 25190         DEPENDING ON DFHEIGDI
 25191     ELSE IF DFHEIGDJ EQUAL 51
 25192         GO TO 5050-NOT-FOUND
 25193         DEPENDING ON DFHEIGDI
 25194     ELSE IF DFHEIGDJ EQUAL 52
 25195         GO TO 5050-NOT-FOUND
 25196         DEPENDING ON DFHEIGDI
 25197     ELSE IF DFHEIGDJ EQUAL 53
 25198         GO TO 5550-END-RECORDS,
 25199               5550-END-RECORDS
 25200         DEPENDING ON DFHEIGDI
 25201     ELSE IF DFHEIGDJ EQUAL 54
 25202         GO TO 6050-QID-ERROR
 25203         DEPENDING ON DFHEIGDI
 25204     ELSE IF DFHEIGDJ EQUAL 55
 25205         GO TO 6050-QID-ERROR
 25206         DEPENDING ON DFHEIGDI
 25207     ELSE IF DFHEIGDJ EQUAL 56
 25208         GO TO 6400-CONTINUE,
 25209               6400-CONTINUE
 25210         DEPENDING ON DFHEIGDI
 25211     ELSE IF DFHEIGDJ EQUAL 57
 25212         GO TO 3690-NOT-FOUND
 25213         DEPENDING ON DFHEIGDI
 25214     ELSE IF DFHEIGDJ EQUAL 58
 25215         GO TO 7399-EXIT
 25216         DEPENDING ON DFHEIGDI
 25217     ELSE IF DFHEIGDJ EQUAL 59
 25218         GO TO 7550-OFFICER-NOTFND
 25219         DEPENDING ON DFHEIGDI
 25220     ELSE IF DFHEIGDJ EQUAL 60
 25221         GO TO 8300-SEND-TEXT
 25222         DEPENDING ON DFHEIGDI.
 25223     MOVE '9%                    "   ' TO DFHEIV0
 25224     MOVE 'EL6311' TO DFHEIV1
 25225     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25226     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15828     Code:      100038
