* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   1
* SOCK00.cbl
* Options: int("SOCK00.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK00.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK00.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK00.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7******************************************************************
     8*                   C H A N G E   L O G
     9*
    10* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    11*-----------------------------------------------------------------
    12*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    13* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   2
* SOCK00.cbl
    14*-----------------------------------------------------------------
    15* 091609  CR2009082400002  PEMA  ADD USER SELECT 3
    16* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    17* 042612  CR2012042500004  PEMA  ADD CODE TO HANDLE AHL
    18* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    19* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    20* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    21* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    22*-----------------------------------------------------------------
    23 identification division.
    24 program-id. SOCK00.
    25*         This program is the first invoked by the SOCK
    26*         transaction. This transaction must be submited
    27*         by a message transmited over a stream socket.
    28*         The first message format is:
    29*         aaaa,bbbbb              ccc
    30*         where "aaaa" is the tran id SOCK (1 to 4 characters)
    31*         and "bbbbb is either "RATE " or "STATE" and ccc is eithe
    32*         DCC or CID or any future company id
    33*         Information on the originating message and
    34*         remote socket is provided in the DFHCOMMAREA.
    35*         As its first action this program must send a
    36*         message to the requesting socket. This lets the
    37*         remote program know its request has been
    38*         accepted and the transaction started.
    39*         The program will make four transmissions to
    40*         the initating program in response to received
    41*         messages and then close the socket.
    42*         This program is provided to show method and
    43*         has minimal checking and error messages.
    44*         The Cobol compiler, unless instructed otherwise,
    45*         will hold its working storage integer data items in
    46*         machine idependent form. This matches the network
    47*         ordering of information. Care should be exercised
    48*         to ensure that this data ordering is correct when
    49*         calling system library functions or passing data
    50*         structure containing such data to functions.
    51 environment division.
    52 data division.
    53 working-storage section.
    54 01  DFH-START PIC X(04).
    55*
    56* program buffers
    57*
    58 77 ws-send-msg-size           pic s9(8) comp value 4096.
    59 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    60 77 ws-recv-buf                pic x(4096).
    61 77 ws-send-buf                pic x(4096) VALUE SPACES.
    62 77 ws-recv-total              pic s9(8) comp value 0.
    63 77 ws-recv-left               pic s9(8) comp value 0.
    64 77 ws-seq-num                 pic s9(8) comp value 0.
    65 77 ws-flags                   pic s9(8) comp value 0.
    66 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    67 77 WS-COMP-ID                   PIC XXX VALUE 'CID'.
    68 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    69 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    70 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    71 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   3
* SOCK00.cbl
    72 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    73 77 S1                           PIC S999 COMP-3 VALUE +0.
    74 77 S2                           PIC S999 COMP-3 VALUE +0.
    75 77 WS-BUILD-SW                  PIC X.
    76    88  TIME-TO-BUILD               VALUE 'Y'.
    77 77 WS-SAVE-ERACCT               PIC X(2000).
    78 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    79 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    80    88  GET-RATES                    VALUE 'R'.
    81    88  GET-ACT-ACCTS                VALUE 'A'.
    82 77 ws-bin-eff-dt                pic xx  value low-values.
    83 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    84 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    85 77 ws-disp-rate                 pic z9.99999.
    86 77  WS-ERACCT-SW                PIC X VALUE ' '.
    87     88  END-OF-ERACCT                 VALUE 'Y'.
    88 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    89     88  END-OF-ERCTBL                 VALUE 'Y'.
    90 77  WS-STATUS                   PIC X.
    91 01  ws-work-date.
    92     05  ws-work-ccyy            pic x(4).
    93     05  ws-work-mm              pic xx.
    94     05  ws-work-dd              pic xx.
    95 01  ws-work-date-num redefines ws-work-date
    96                                 pic 9(8).
    97 01  WS-AM-CITY-STATE            PIC X(30) VALUE SPACES.
    98 01  ws-work-apr.
    99     05  ws-apr-num              pic 99V999.
   100 01  ws-work-ben.
   101     05  ws-ben-num              pic 9(5).
   102 01  ws-work-term.
   103     05  ws-term-num             pic 999.
   104 01  ws-get-rate-data.
   105     05  rate-state              pic xx.
   106     05  rate-lf-ah              pic x.
   107     05  rate-ben-code           pic xx.
   108     05  rate-earn-meth          pic x.
   109     05  rate-ben-amt            pic x(5).
   110     05  rate-eff-date           pic x(10).
   111     05  rate-term               pic xxx.
   112     05  rate-apr                pic x(5).
   113 01  WS-FIN-RESP                 PIC X(10).
   114 01  WS-GA-DATA.
   115     05  WS-GA-NUM               PIC X(10).
   116     05  WS-GA-PRIMARY-CONTACT   PIC X(30).
   117     05  WS-GA-NAME              PIC X(30).
   118     05  WS-GA-MAIL-NAME         PIC X(30).
   119     05  WS-GA-ADDR1             PIC X(30).
   120     05  WS-GA-ADDR2             PIC X(30).
   121     05  WS-GA-ADDR3             PIC X(30).
   122     05  WS-GA-ZIP               PIC X(9).
   123     05  WS-GA-PHONE             PIC X(10).
   124 01  WS-AM-KEY.
   125     05  WS-AM-COMPANY-CD        PIC X.
   126     05  WS-AM-CARRIER           PIC X.
   127     05  WS-AM-GROUP             PIC X(6).
   128     05  WS-AM-STATE             PIC XX.
   129     05  WS-AM-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   4
* SOCK00.cbl
   130     05  WS-AM-EXP-DT            PIC XX.
   131     05  FILLER                  PIC X(4).
   132 01  WS-NT-KEY.
   133     05  WS-NT-COMPANY-CD        PIC X.
   134     05  WS-NT-CARRIER           PIC X.
   135     05  WS-NT-GROUP             PIC X(6).
   136     05  WS-NT-STATE             PIC XX.
   137     05  WS-NT-ACCOUNT           PIC X(10).
   138     05  WS-NT-REC-TYPE          PIC X.
   139     05  WS-NT-SEQ-NO            PIC S9(4) COMP.
   140 01  WS-AM-ALT-KEY.
   141     05  WS-AM-ALT-ACCOUNT       PIC X(10).
   142     05  WS-AM-ALT-EXP-DT        PIC XX.
   143 01  WS-CT-KEY-SAVE              PIC X(5).
   144 01  WS-CT-KEY.
   145     05  WS-CT-COMPANY-CD        PIC X.
   146     05  WS-CT-TABLE             PIC XXX.
   147     05  WS-CT-BEN-TYPE          PIC X.
   148     05  WS-CT-BEN-CODE          PIC XX.
   149 01  WS-CF-KEY-SAVE              PIC X(10).
   150 01  WS-CF-KEY.
   151     05  WS-CF-COMPANY-ID        PIC XXX.
   152     05  WS-CF-RECORD-TYPE       PIC X.
   153     05  WS-CF-ACCESS            PIC X(4).
   154     05  WS-CF-SEQ-NO            PIC S9(4) COMP.
   155 01  WS-CO-KEY.
   156     05  WS-CO-COMPANY-CD        PIC X.
   157     05  WS-CO-CARRIER           PIC X.
   158     05  WS-CO-GROUP             PIC X(6).
   159     05  WS-CO-FIN-RESP          PIC X(10).
   160     05  WS-CO-ACCOUNT           PIC X(10).
   161     05  WS-CO-TYPE              PIC X.
   162 01  WS-WORK-SAH-COMM            PIC SV9(5) VALUE +0.
   163 01  WS-WORK-JAH-COMM            PIC SV9(5) VALUE +0.
   164 01  WS-POLICY-NO                PIC X(6).
   165 01  WS-SHORT-ACCT-NAME          PIC X(30).
   166 01  WS-LONG-ACCT-NAME           PIC X(60).
   167 01  WS-CONTR-NAME               PIC X(60).
   168 01  WS-SL-COMM                  PIC 9.99999.
   169 01  WS-JL-COMM                  PIC 9.99999.
   170 01  WS-SAH-COMM                 PIC 9.99999.
   171 01  WS-JAH-COMM                 PIC 9.99999.
   172 01  WS-CID-NO                   PIC X(8).
   173 01  WS-DISP-RESP                PIC 9(5).
   174 01  WS-RESPONSE                 PIC S9(8)   COMP.
   175     88  RESP-NORMAL                  VALUE +00.
   176     88  RESP-NOTFND                  VALUE +13.
   177     88  RESP-NOTOPEN                 VALUE +19.
   178     88  RESP-ENDFILE                 VALUE +20.
   179*                                 COPY ERCACNT.
   180******************************************************************
   181*                                                                *
   182*                                                                *
   183*                            ERCACNT.                            *
   184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   185*                            VMOD=2.002                          *
   186*                                                                *
   187*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   5
* SOCK00.cbl
   188*                                                                *
   189*   FILE TYPE = VSAM,KSDS                                        *
   190*   RECORD SIZE = 120   RECFORM = FIXED                          *
   191*                                                                *
   192*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
   193*       ALTERNATE INDEX = NONE                                   *
   194*                                                                *
   195*                                                                *
   196*   LOG = YES                                                    *
   197*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   198******************************************************************
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
   207*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
   208******************************************************************
   209 01  NOTE-FILE.
   210     12  NT-FILE-ID                  PIC XX.
   211         88  VALID-NOTE-ID              VALUE 'NT'.
   212
   213     12  NT-CONTROL-PRIMARY.
   214         16  NT-COMPANY-CD           PIC X.
   215         16  NT-ACCT-NOTE-KEY.
   216             18  NT-CARRIER              PIC X.
   217             18  NT-GROUPING             PIC X(06).
   218             18  NT-STATE                PIC XX.
   219             18  NT-ACCOUNT              PIC X(10).
   220         16  NT-RECORD-TYPE          PIC X.
   221              88  ACCT-NOTE          VALUE '1'.
   222              88  ACCT-BRANCH-LOC    VALUE '2'.
   223              88  ACCT-SHIPPING-ADDR VALUE '3'.
   224         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
   225
   226     12  NT-LAST-MAINT-DT            PIC XX.
   227     12  NT-LAST-MAINT-BY            PIC X(4).
   228     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
   229
   230*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
   231*     SEQUENCE NUMBERS
   232     12  NT-NOTE-INFORMATION.
   233         16  NT-NOTE-LINE            PIC X(60).
   234         16  FILLER                  PIC X(25).
   235*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
   236     12  NT-LOCATION-INFORMATION REDEFINES
   237                         NT-NOTE-INFORMATION.
   238         16  NT-BRANCH-LOC-LINE      PIC X(60).
   239         16  FILLER                  PIC X(25).
   240*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
   241*     SEQUENCE NUMBER 1 IS NAME LINE 1
   242*     SEQUENCE NUMBER 2 IS NAME LINE 2
   243*     SEQUENCE NUMBER 3 IS ADDR LINE 1
   244*     SEQUENCE NUMBER 4 IS ADDR LINE 2
   245*     SEQUENCE NUMBER 5 IS ADDR LINE 3
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   6
* SOCK00.cbl
   246*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
   247     12  NT-SHIPPING-INFORMATION REDEFINES
   248                         NT-NOTE-INFORMATION.
   249         16  NT-SHIPPING-LINE        PIC X(60).
   250         16  NT-SHIP-STATE           PIC XX.
   251         16  NT-SHIP-ZIP             PIC X(10).
   252         16  FILLER                  PIC X(13).
   253*****************************************************************
   254*                                 COPY ERCACCT.
   255******************************************************************
   256*                                                                *
   257*                                                                *
   258*                            ERCACCT                             *
   259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   260*                            VMOD=2.031                          *
   261*                                                                *
   262*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   263*                                                                *
   264*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   265*   VSAM ACCOUNT MASTER FILES.                                   *
   266*                                                                *
   267*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   268*                                                                *
   269*   FILE TYPE = VSAM,KSDS                                        *
   270*   RECORD SIZE = 2000  RECFORM = FIX                            *
   271*                                                                *
   272*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   273*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   274*                                                                *
   275*   LOG = NO                                                     *
   276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   277*                                                                *
   278*                                                                *
   279******************************************************************
   280*                   C H A N G E   L O G
   281*
   282* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   283*-----------------------------------------------------------------
   284*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   285* EFFECTIVE    NUMBER
   286*-----------------------------------------------------------------
   287* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   288* 092705    2005050300006  PEMA  ADD SPP LEASES
   289* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   290* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   291* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   292* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   293* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   294* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   295******************************************************************
   296
   297 01  ACCOUNT-MASTER.
   298     12  AM-RECORD-ID                      PIC XX.
   299         88  VALID-AM-ID                      VALUE 'AM'.
   300
   301     12  AM-CONTROL-PRIMARY.
   302         16  AM-COMPANY-CD                 PIC X.
   303         16  AM-MSTR-CNTRL.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   7
* SOCK00.cbl
   304             20  AM-CONTROL-A.
   305                 24  AM-CARRIER            PIC X.
   306                 24  AM-GROUPING.
   307                     28 AM-GROUPING-PREFIX PIC XXX.
   308                     28 AM-GROUPING-PRIME  PIC XXX.
   309                 24  AM-STATE              PIC XX.
   310                 24  AM-ACCOUNT.
   311                     28  AM-ACCOUNT-PREFIX PIC X(4).
   312                     28  AM-ACCOUNT-PRIME  PIC X(6).
   313             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   314                                           PIC X(19).
   315             20  AM-CNTRL-B.
   316                 24  AM-EXPIRATION-DT      PIC XX.
   317                 24  FILLER                PIC X(4).
   318             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   319                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   320
   321     12  AM-CONTROL-BY-VAR-GRP.
   322         16  AM-COMPANY-CD-A1              PIC X.
   323         16  AM-VG-CARRIER                 PIC X.
   324         16  AM-VG-GROUPING                PIC X(6).
   325         16  AM-VG-STATE                   PIC XX.
   326         16  AM-VG-ACCOUNT                 PIC X(10).
   327         16  AM-VG-DATE.
   328             20  AM-VG-EXPIRATION-DT       PIC XX.
   329             20  FILLER                    PIC X(4).
   330         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   331                                           PIC 9(11)      COMP-3.
   332     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   333         16  FILLER                        PIC X(10).
   334         16  AM-VG-KEY3.
   335             20  AM-VG3-ACCOUNT            PIC X(10).
   336             20  AM-VG3-EXP-DT             PIC XX.
   337         16  FILLER                        PIC X(4).
   338     12  AM-MAINT-INFORMATION.
   339         16  AM-LAST-MAINT-DT              PIC XX.
   340         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   341         16  AM-LAST-MAINT-USER            PIC X(4).
   342         16  FILLER                        PIC XX.
   343
   344     12  AM-EFFECTIVE-DT                   PIC XX.
   345     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   346
   347     12  AM-PREV-DATES  COMP-3.
   348         16  AM-PREV-EXP-DT                PIC 9(11).
   349         16  AM-PREV-EFF-DT                PIC 9(11).
   350
   351     12  AM-REPORT-CODE-1                  PIC X(10).
   352     12  AM-REPORT-CODE-2                  PIC X(10).
   353
   354     12  AM-CITY-CODE                      PIC X(4).
   355     12  AM-COUNTY-PARISH                  PIC X(6).
   356
   357     12  AM-NAME                           PIC X(30).
   358     12  AM-PERSON                         PIC X(30).
   359     12  AM-ADDRS                          PIC X(30).
   360     12  AM-CITY.
   361         16  AM-ADDR-CITY                  PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   8
* SOCK00.cbl
   362         16  AM-ADDR-STATE                 PIC XX.
   363     12  AM-ZIP.
   364         16  AM-ZIP-PRIME.
   365             20  AM-ZIP-PRI-1ST            PIC X.
   366                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   367             20  FILLER                    PIC X(4).
   368         16  AM-ZIP-PLUS4                  PIC X(4).
   369     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   370         16  AM-CAN-POSTAL-1               PIC XXX.
   371         16  AM-CAN-POSTAL-2               PIC XXX.
   372         16  FILLER                        PIC XXX.
   373     12  AM-TEL-NO.
   374         16  AM-AREA-CODE                  PIC 999.
   375         16  AM-TEL-PRE                    PIC 999.
   376         16  AM-TEL-NBR                    PIC 9(4).
   377     12  AM-TEL-LOC                        PIC X.
   378         88  AM-TEL-AT-HOME                   VALUE 'H'.
   379         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   380
   381     12  AM-COMM-STRUCTURE.
   382         16  AM-DEFN-1.
   383             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   384                 24  AM-AGT.
   385                     28  AM-AGT-PREFIX     PIC X(4).
   386                     28  AM-AGT-PRIME      PIC X(6).
   387                 24  AM-COM-TYP            PIC X.
   388                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   389                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   390                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   391                 24  AM-RECALC-LV-INDIC    PIC X.
   392                 24  AM-RETRO-LV-INDIC     PIC X.
   393                 24  AM-GL-CODES           PIC X.
   394                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   395                 24  FILLER                PIC X(01).
   396         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   397             20  AM-COM-TBLS        OCCURS 10 TIMES.
   398                 24  FILLER                PIC X(11).
   399                 24  AM-L-COMA             PIC XXX.
   400                 24  AM-J-COMA             PIC XXX.
   401                 24  AM-A-COMA             PIC XXX.
   402                 24  FILLER                PIC X(6).
   403
   404     12  AM-COMM-CHANGE-STATUS             PIC X.
   405         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   406
   407     12  AM-CSR-CODE                       PIC X(4).
   408
   409     12  AM-BILLING-STATUS                 PIC X.
   410         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   411         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   412     12  AM-AUTO-REFUND-SW                 PIC X.
   413         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   414         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   415     12  AM-GPCD                           PIC 99.
   416     12  AM-IG                             PIC X.
   417         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   418         88  AM-HAS-GROUP                     VALUE '2'.
   419     12  AM-STATUS                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page   9
* SOCK00.cbl
   420         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   421         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   422         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   423         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   424         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   425         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   426         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   427         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   428         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   429         88  AM-ACCOUNT-PENDING               VALUE '9'.
   430     12  AM-REMIT-TO                       PIC 99.
   431     12  AM-ID-NO                          PIC X(11).
   432
   433     12  AM-CAL-TABLE                      PIC XX.
   434     12  AM-LF-DEVIATION                   PIC XXX.
   435     12  AM-AH-DEVIATION                   PIC XXX.
   436     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   437     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   438     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   439     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   440     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   441     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   442
   443     12  AM-USER-FIELDS.
   444         16  AM-FLD-1                      PIC XX.
   445         16  AM-FLD-2                      PIC XX.
   446         16  AM-FLD-3                      PIC XX.
   447         16  AM-FLD-4                      PIC XX.
   448         16  AM-FLD-5                      PIC XX.
   449
   450     12  AM-1ST-PROD-DATE.
   451         16  AM-1ST-PROD-YR                PIC XX.
   452         16  AM-1ST-PROD-MO                PIC XX.
   453         16  AM-1ST-PROD-DA                PIC XX.
   454     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   455     12  AM-CERTS-PURGED-DATE.
   456         16  AM-PUR-YR                     PIC XX.
   457         16  AM-PUR-MO                     PIC XX.
   458         16  AM-PUR-DA                     PIC XX.
   459     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   460     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   461     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   462     12  AM-INACTIVE-DATE.
   463         16  AM-INA-MO                     PIC 99.
   464         16  AM-INA-DA                     PIC 99.
   465         16  AM-INA-YR                     PIC 99.
   466     12  AM-AR-HI-CERT-DATE                PIC XX.
   467
   468     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   469     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   470
   471     12  AM-OB-PAYMENT-MODE                PIC X.
   472         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   473         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   474         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   475         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   476
   477     12  AM-AH-ONLY-INDICATOR              PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  10
* SOCK00.cbl
   478         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   479         88  AM-NO-AH-ONLY                    VALUE 'N'.
   480
   481     12  AM-EDIT-LOAN-OFC                  PIC X(01).
   482
   483     12  AM-OVER-SHORT.
   484         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   485         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   486
   487     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   488     12  AM-DCC-CLP-STATE                  PIC XX.
   489
   490     12  AM-RECALC-COMM                    PIC X.
   491     12  AM-RECALC-REIN                    PIC X.
   492
   493     12  AM-REI-TABLE                      PIC XXX.
   494     12  AM-REI-ET-LF                      PIC X.
   495     12  AM-REI-ET-AH                      PIC X.
   496     12  AM-REI-PE-LF                      PIC X.
   497     12  AM-REI-PE-AH                      PIC X.
   498     12  AM-REI-PRT-ST                     PIC X.
   499     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   500     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   501     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   502     12  AM-REI-GROUP-A                    PIC X(6).
   503     12  AM-REI-MORT                       PIC X(4).
   504     12  AM-REI-PRT-OW                     PIC X.
   505     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   506     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   507     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   508     12  AM-REI-GROUP-B                    PIC X(6).
   509
   510     12  AM-TRUST-TYPE                     PIC X(2).
   511
   512     12  AM-EMPLOYER-STMT-USED             PIC X.
   513     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   514
   515     12  AM-STD-AH-TYPE                    PIC XX.
   516     12  AM-EARN-METHODS.
   517         16  AM-EARN-METHOD-R              PIC X.
   518             88 AM-REF-RL-R78                 VALUE 'R'.
   519             88 AM-REF-RL-PR                  VALUE 'P'.
   520             88 AM-REF-RL-MEAN                VALUE 'M'.
   521             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   522         16  AM-EARN-METHOD-L              PIC X.
   523             88 AM-REF-LL-R78                 VALUE 'R'.
   524             88 AM-REF-LL-PR                  VALUE 'P'.
   525             88 AM-REF-LL-MEAN                VALUE 'M'.
   526             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   527         16  AM-EARN-METHOD-A              PIC X.
   528             88 AM-REF-AH-R78                 VALUE 'R'.
   529             88 AM-REF-AH-PR                  VALUE 'P'.
   530             88 AM-REF-AH-MEAN                VALUE 'M'.
   531             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   532             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   533             88 AM-REF-AH-NET                 VALUE 'N'.
   534
   535     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  11
* SOCK00.cbl
   536     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   537     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   538
   539     12  AM-RET-Y-N                        PIC X.
   540     12  AM-RET-P-E                        PIC X.
   541     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   542     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   543     12  AM-RET-GRP                        PIC X(6).
   544     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   545         16  AM-POOL-PRIME                 PIC XXX.
   546         16  AM-POOL-SUB                   PIC XXX.
   547     12  AM-RETRO-EARNINGS.
   548         16  AM-RET-EARN-R                 PIC X.
   549         16  AM-RET-EARN-L                 PIC X.
   550         16  AM-RET-EARN-A                 PIC X.
   551     12  AM-RET-ST-TAX-USE                 PIC X.
   552         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   553         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   554     12  AM-RETRO-BEG-EARNINGS.
   555         16  AM-RET-BEG-EARN-R             PIC X.
   556         16  AM-RET-BEG-EARN-L             PIC X.
   557         16  AM-RET-BEG-EARN-A             PIC X.
   558     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   559     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   560
   561     12  AM-USER-SELECT-OPTIONS.
   562         16  AM-USER-SELECT-1              PIC X(10).
   563         16  AM-USER-SELECT-2              PIC X(10).
   564         16  AM-USER-SELECT-3              PIC X(10).
   565         16  AM-USER-SELECT-4              PIC X(10).
   566         16  AM-USER-SELECT-5              PIC X(10).
   567
   568     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   569
   570     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   571
   572     12  AM-RPT045A-SWITCH                 PIC X.
   573         88  RPT045A-OFF                   VALUE 'N'.
   574
   575     12  AM-INSURANCE-LIMITS.
   576         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   577         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   578
   579     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   580         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   581
   582     12  AM-DISMBR-COVERAGE-SW             PIC X.
   583         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   584         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   585
   586     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   587
   588     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   589     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   590     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   591     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   592     12  AM-DCC-UEF-STATE                  PIC XX.
   593     12  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  12
* SOCK00.cbl
   594     12  AM-REPORT-CODE-3                  PIC X(10).
   595*    12  FILLER                            PIC X(22).
   596
   597     12  AM-RESERVE-DATE.
   598         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   599         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   600         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   601
   602     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   603     12  AM-NOTIFICATION-TYPES.
   604         16  AM-NOTIF-OF-LETTERS           PIC X.
   605         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   606         16  AM-NOTIF-OF-REPORTS           PIC X.
   607         16  AM-NOTIF-OF-STATUS            PIC X.
   608
   609     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   610         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   611         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   612         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   613         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   614
   615     12  AM-BENEFIT-CONTROLS.
   616         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   617             20  AM-BENEFIT-CODE           PIC XX.
   618             20  AM-BENEFIT-TYPE           PIC X.
   619             20  AM-BENEFIT-REVISION       PIC XXX.
   620             20  AM-BENEFIT-REM-TERM       PIC X.
   621             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   622             20  FILLER                    PIC XX.
   623         16  FILLER                        PIC X(80).
   624
   625     12  AM-TRANSFER-DATA.
   626         16  AM-TRANSFERRED-FROM.
   627             20  AM-TRNFROM-CARRIER        PIC X.
   628             20  AM-TRNFROM-GROUPING.
   629                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   630                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   631             20  AM-TRNFROM-STATE          PIC XX.
   632             20  AM-TRNFROM-ACCOUNT.
   633                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   634                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   635             20  AM-TRNFROM-DTE            PIC XX.
   636         16  AM-TRANSFERRED-TO.
   637             20  AM-TRNTO-CARRIER          PIC X.
   638             20  AM-TRNTO-GROUPING.
   639                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   640                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   641             20  AM-TRNTO-STATE            PIC XX.
   642             20  AM-TRNTO-ACCOUNT.
   643                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   644                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   645             20  AM-TRNTO-DTE              PIC XX.
   646         16  FILLER                        PIC X(10).
   647
   648     12  AM-SAVED-REMIT-TO                 PIC 99.
   649
   650     12  AM-COMM-STRUCTURE-SAVED.
   651         16  AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  13
* SOCK00.cbl
   652             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   653                 24  AM-AGT-SV             PIC X(10).
   654                 24  AM-COM-TYP-SV         PIC X.
   655                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
   656                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
   657                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
   658                 24  AM-RECALC-LV-INDIC-SV PIC X.
   659                 24  FILLER                PIC X.
   660                 24  AM-GL-CODES-SV        PIC X.
   661                 24  AM-COM-CHARGEBACK-SV  PIC 99.
   662                 24  FILLER                PIC X.
   663         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
   664             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
   665                 24  FILLER                PIC X(11).
   666                 24  AM-L-COMA-SV          PIC XXX.
   667                 24  AM-J-COMA-SV          PIC XXX.
   668                 24  AM-A-COMA-SV          PIC XXX.
   669                 24  FILLER                PIC X(6).
   670
   671     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
   672         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
   673            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
   674            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
   675            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
   676
   677     12  AM-ORIG-DEALER-NO                 PIC X(10).
   678     12  FILLER                            PIC X(120).
   679
   680     12  AM-ACCOUNT-EXECUTIVE-DATA.
   681         16  AM-CONTROL-NAME               PIC X(30).
   682         16  AM-EXECUTIVE-ONE.
   683             20  AM-EXEC1-NAME             PIC X(15).
   684             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
   685                                                          COMP-3.
   686             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
   687                                                          COMP-3.
   688         16  AM-EXECUTIVE-TWO.
   689             20  AM-EXEC2-NAME             PIC X(15).
   690             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
   691                                                          COMP-3.
   692             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
   693                                                          COMP-3.
   694
   695     12  AM-RETRO-ADDITIONAL-DATA.
   696         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
   697         16  AM-RETRO-PREM-P-E             PIC X.
   698         16  AM-RETRO-CLMS-P-I             PIC X.
   699         16  AM-RETRO-RET-BRACKET-LF.
   700             20  AM-RETRO-RET-METHOD-LF    PIC X.
   701                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
   702                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
   703             20  AM-RETRO-RET-BASIS-LF     PIC X.
   704                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
   705                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
   706             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
   707                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
   708                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
   709         16  AM-RETRO-RET-BRACKET-AH.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  14
* SOCK00.cbl
   710             20  AM-RETRO-RET-METHOD-AH    PIC X.
   711                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
   712                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
   713                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
   714             20  AM-RETRO-RET-BASIS-AH     PIC X.
   715                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
   716                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
   717             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
   718                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
   719                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
   720
   721     12  AM-COMMENTS.
   722         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
   723
   724     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
   725         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
   726         16  AM-FLI-BILLING-CODE           PIC X.
   727         16  AM-FLI-ALT-STATE-CODE         PIC XX.
   728         16  AM-FLI-UNITED-IDENT           PIC X.
   729         16  AM-FLI-INTEREST-LOST-DATA.
   730             20  AM-FLI-BANK-NO            PIC X(5).
   731             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
   732             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
   733             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
   734         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
   735             20  AM-FLI-AGT                PIC X(9).
   736             20  AM-FLI-AGT-COMM-ACC       PIC X.
   737             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
   738         16  FILLER                        PIC X(102).
   739
   740     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
   741         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
   742             20  AM-BENEFIT-DMD-CODE         PIC XX.
   743             20  AM-BENEFIT-DMD-TYPE         PIC X.
   744             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
   745             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
   746             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
   747         16  FILLER                          PIC X(10).
   748******************************************************************
   749*                                 COPY ERCCOMP.
   750******************************************************************
   751*                                                                *
   752*                                                                *
   753*                            ERCCOMP                             *
   754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   755*                            VMOD=2.019                          *
   756*                                                                *
   757*   ONLINE CREDIT SYSTEM                                         *
   758*                                                                *
   759*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   760*                                                                *
   761*   FILE TYPE = VSAM,KSDS                                        *
   762*   RECORD SIZE = 700   RECFORM = FIXED                          *
   763*                                                                *
   764*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   765*       ALTERNATE PATH = NONE                                    *
   766*                                                                *
   767*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  15
* SOCK00.cbl
   768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   769*                                                                *
   770******************************************************************
   771*                   C H A N G E   L O G
   772*
   773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   774*-----------------------------------------------------------------
   775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   776* EFFECTIVE    NUMBER
   777*-----------------------------------------------------------------
   778* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   779* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   780* 092205    2005050300006  PEMA  ADD LEASE FEE
   781* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   782* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   783* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   784* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   785* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   786* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   787******************************************************************
   788
   789 01  COMPENSATION-MASTER.
   790     12  CO-RECORD-ID                          PIC XX.
   791         88  VALID-CO-ID                          VALUE 'CO'.
   792
   793     12  CO-CONTROL-PRIMARY.
   794         16  CO-COMPANY-CD                     PIC X.
   795         16  CO-CONTROL.
   796             20  CO-CTL-1.
   797                 24  CO-CARR-GROUP.
   798                     28  CO-CARRIER            PIC X.
   799                     28  CO-GROUPING.
   800                         32  CO-GROUP-PREFIX   PIC XXX.
   801                         32  CO-GROUP-PRIME    PIC XXX.
   802                 24  CO-RESP-NO.
   803                     28  CO-RESP-PREFIX        PIC X(4).
   804                     28  CO-RESP-PRIME         PIC X(6).
   805             20  CO-CTL-2.
   806                 24  CO-ACCOUNT.
   807                     28  CO-ACCT-PREFIX        PIC X(4).
   808                     28  CO-ACCT-PRIME         PIC X(6).
   809         16  CO-TYPE                           PIC X.
   810             88  CO-COMPANY-TYPE                  VALUE 'C'.
   811             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   812             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   813
   814     12  CO-MAINT-INFORMATION.
   815         16  CO-LAST-MAINT-DT                  PIC XX.
   816         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   817         16  CO-LAST-MAINT-USER                PIC X(4).
   818     12  FILLER                                PIC XX.
   819     12  CO-STMT-TYPE                          PIC XXX.
   820     12  CO-COMP-TYPE                          PIC X.
   821         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   822     12  CO-STMT-OWNER                         PIC X(4).
   823     12  CO-BALANCE-CONTROL                    PIC X.
   824         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   825         88  CO-NO-BALANCE                        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  16
* SOCK00.cbl
   826
   827     12  CO-INTERNAL-CONTROL-1                 PIC X.
   828         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   829         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   830         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   831
   832     12  CO-INTERNAL-CONTROL-2                 PIC X.
   833         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   834         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   835
   836     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   837     12  CO-GA-DIRECT-DEP                      PIC X.
   838     12  CO-FUTURE-SPACE                       PIC X.
   839         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   840
   841     12  CO-ACCT-NAME                          PIC X(30).
   842     12  CO-MAIL-NAME                          PIC X(30).
   843     12  CO-ADDR-1                             PIC X(30).
   844     12  CO-ADDR-2                             PIC X(30).
   845     12  CO-ADDR-3.
   846         16  CO-ADDR-CITY                      PIC X(27).
   847         16  CO-ADDR-STATE                     PIC XX.
   848     12  CO-CSO-1099                           PIC X.
   849     12  CO-ZIP.
   850         16  CO-ZIP-PRIME.
   851             20  CO-ZIP-PRI-1ST                PIC X.
   852                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   853             20  FILLER                        PIC X(4).
   854         16  CO-ZIP-PLUS4                      PIC X(4).
   855     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   856         16  CO-CAN-POSTAL-1                   PIC XXX.
   857         16  CO-CAN-POSTAL-2                   PIC XXX.
   858         16  FILLER                            PIC XXX.
   859     12  CO-SOC-SEC                            PIC X(13).
   860     12  CO-TELEPHONE.
   861         16  CO-AREA-CODE                      PIC XXX.
   862         16  CO-PREFIX                         PIC XXX.
   863         16  CO-PHONE                          PIC X(4).
   864
   865     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   866
   867     12  CO-AR-BAL-LEVEL                       PIC X.
   868         88  CO-AR-REF-LVL                        VALUE '1'.
   869         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   870         88  CO-AR-BILL-LVL                       VALUE '2'.
   871         88  CO-AR-AGT-LVL                        VALUE '3'.
   872         88  CO-AR-FR-LVL                         VALUE '4'.
   873
   874     12  CO-AR-NORMAL-PRINT                    PIC X.
   875         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   876         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   877
   878     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   879
   880     12  CO-AR-REPORTING                       PIC X.
   881         88  CO-AR-NET-REPORT                     VALUE 'N'.
   882         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   883
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  17
* SOCK00.cbl
   884     12  CO-AR-PULL-CHECK                      PIC X.
   885         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   886         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   887
   888     12  CO-AR-BALANCE-PRINT                   PIC X.
   889         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   890
   891     12  CO-AR-LAST-RUN-CODE                   PIC X.
   892         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   893         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   894         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   895
   896     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   897
   898     12  CO-USER-CODE                          PIC X.
   899     12  CO-REPORT-GROUP-ID                    PIC X(12).
   900
   901******************************************************************
   902*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   903*    THE LAST MONTH END RUN.
   904******************************************************************
   905
   906     12  CO-LAST-ACTIVITY-DATE.
   907         16  CO-ACT-YEAR                       PIC 99.
   908         16  CO-ACT-MONTH                      PIC 99.
   909         16  CO-ACT-DAY                        PIC 99.
   910
   911     12  CO-LAST-STMT-DT.
   912         16  CO-LAST-STMT-YEAR                 PIC 99.
   913         16  CO-LAST-STMT-MONTH                PIC 99.
   914         16  CO-LAST-STMT-DAY                  PIC 99.
   915
   916     12  CO-MO-END-TOTALS.
   917         16  CO-MONTHLY-TOTALS.
   918             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   919             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   920             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   921             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   922             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   923
   924         16  CO-AGING-TOTALS.
   925             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   926             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   927             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   928             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   929
   930         16  CO-YTD-TOTALS.
   931             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   932             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   933
   934         16  CO-OVER-UNDER-TOTALS.
   935             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   936             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   937
   938     12  CO-MISCELLANEOUS-TOTALS.
   939         16  CO-FICA-TOTALS.
   940             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   941             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  18
* SOCK00.cbl
   942
   943         16  CO-CLAIM-TOTALS.
   944             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   945             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   946
   947******************************************************************
   948*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   949*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   950******************************************************************
   951
   952     12  CO-CURRENT-TOTALS.
   953         16  CO-CURRENT-LAST-STMT-DT.
   954             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   955             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   956             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   957
   958         16  CO-CURRENT-MONTHLY-TOTALS.
   959             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   960             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   961             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   962             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   963             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   964
   965         16  CO-CURRENT-AGING-TOTALS.
   966             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   967             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   968             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   969             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
   970
   971         16  CO-CURRENT-YTD-TOTALS.
   972             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   973             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   974
   975     12  CO-PAID-COMM-TOTALS.
   976         16  CO-YTD-PAID-COMMS.
   977             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   978             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   979
   980     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   981         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   982         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   983
   984     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   985         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   986         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   987         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   988         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   989         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   990         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   991         88  CO-FINAL-LETTER                  VALUE 'F'.
   992         88  CO-RECONCILING                   VALUE 'R'.
   993         88  CO-PHONE-CALL                    VALUE 'P'.
   994         88  CO-LEGAL                         VALUE 'L'.
   995         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   996         88  CO-WRITE-OFF                     VALUE 'W'.
   997         88  CO-NO-ACTION                     VALUE 'N' ' '.
   998
   999     12  CO-CSR-CODE                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  19
* SOCK00.cbl
  1000
  1001     12  CO-GA-STATUS-INFO.
  1002         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1003         16  CO-GA-TERMINATION-DT          PIC XX.
  1004         16  CO-GA-STATUS-CODE             PIC X.
  1005             88  CO-GA-ACTIVE                 VALUE 'A'.
  1006             88  CO-GA-INACTIVE               VALUE 'I'.
  1007             88  CO-GA-PENDING                VALUE 'P'.
  1008         16  CO-GA-COMMENTS.
  1009             20  CO-GA-COMMENT-1           PIC X(40).
  1010             20  CO-GA-COMMENT-2           PIC X(40).
  1011             20  CO-GA-COMMENT-3           PIC X(40).
  1012             20  CO-GA-COMMENT-4           PIC X(40).
  1013
  1014     12  CO-RPTCD2                         PIC X(10).
  1015     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1016         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1017         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1018
  1019     12  CO-TYPE-AGENT                     PIC X(01).
  1020         88  CO-CORPORATION                   VALUE 'C'.
  1021         88  CO-PARTNERSHIP                   VALUE 'P'.
  1022         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1023         88  CO-TRUST                         VALUE 'T'.
  1024         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1025
  1026     12  CO-FAXNO.
  1027         16  CO-FAX-AREA-CODE                  PIC XXX.
  1028         16  CO-FAX-PREFIX                     PIC XXX.
  1029         16  CO-FAX-PHONE                      PIC X(4).
  1030
  1031     12  CO-BANK-INFORMATION.
  1032         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1033         16  CO-BANK-TRANSIT-NON REDEFINES
  1034             CO-BANK-TRANSIT-NO                PIC 9(8).
  1035
  1036         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1037     12  CO-MISC-DEDUCT-INFO REDEFINES
  1038                  CO-BANK-INFORMATION.
  1039         16  CO-MD-GL-ACCT                     PIC X(10).
  1040         16  CO-MD-DIV                         PIC XX.
  1041         16  CO-MD-CENTER                      PIC X(4).
  1042         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1043         16  CO-CREATE-AP-CHECK                PIC X.
  1044         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1045         16  FILLER                            PIC XXX.
  1046     12  CO-ACH-STATUS                         PIC X.
  1047         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1048         88  CO-ACH-PENDING                        VALUE 'P'.
  1049
  1050     12  CO-BILL-SW                            PIC X.
  1051     12  CO-CONTROL-NAME                       PIC X(30).
  1052     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1053     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1054     12  CO-CLP-STATE                          PIC XX.
  1055     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1056     12  CO-SPP-REFUND-EDIT                    PIC X.
  1057
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  20
* SOCK00.cbl
  1058******************************************************************
  1059*                                 COPY ELCCNTL.
  1060******************************************************************
  1061*                                                                *
  1062*                                                                *
  1063*                            ELCCNTL.                            *
  1064*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1065*                            VMOD=2.059                          *
  1066*                                                                *
  1067*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1068*                                                                *
  1069*   FILE TYPE = VSAM,KSDS                                        *
  1070*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1071*                                                                *
  1072*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1073*       ALTERNATE INDEX = NONE                                   *
  1074*                                                                *
  1075*   LOG = YES                                                    *
  1076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1077******************************************************************
  1078*                   C H A N G E   L O G
  1079*
  1080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1081*-----------------------------------------------------------------
  1082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1083* EFFECTIVE    NUMBER
  1084*-----------------------------------------------------------------
  1085* 082503                   PEMA  ADD BENEFIT GROUP
  1086* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1087* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1088* 092705    2005050300006  PEMA  ADD SPP LEASES
  1089* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1090* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1091* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1092* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1093* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1094* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1095* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1096* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1097* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1098* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1099******************************************************************
  1100*
  1101 01  CONTROL-FILE.
  1102     12  CF-RECORD-ID                       PIC XX.
  1103         88  VALID-CF-ID                        VALUE 'CF'.
  1104
  1105     12  CF-CONTROL-PRIMARY.
  1106         16  CF-COMPANY-ID                  PIC XXX.
  1107         16  CF-RECORD-TYPE                 PIC X.
  1108             88  CF-COMPANY-MASTER              VALUE '1'.
  1109             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1110             88  CF-STATE-MASTER                VALUE '3'.
  1111             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1112             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1113             88  CF-CARRIER-MASTER              VALUE '6'.
  1114             88  CF-MORTALITY-MASTER            VALUE '7'.
  1115             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  21
* SOCK00.cbl
  1116             88  CF-TERMINAL-MASTER             VALUE '9'.
  1117             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1118             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1119             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1120             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1121             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1122             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1123             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1124             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1125             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1126         16  CF-ACCESS-CD-GENL              PIC X(4).
  1127         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1128             20  CF-PROCESSOR               PIC X(4).
  1129         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1130             20  CF-STATE-CODE              PIC XX.
  1131             20  FILLER                     PIC XX.
  1132         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1133             20  FILLER                     PIC XX.
  1134             20  CF-HI-BEN-IN-REC           PIC XX.
  1135         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1136             20  FILLER                     PIC XXX.
  1137             20  CF-CARRIER-CNTL            PIC X.
  1138         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1139             20  FILLER                     PIC XX.
  1140             20  CF-HI-TYPE-IN-REC          PIC 99.
  1141         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1142             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1143                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1144             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1145             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1146         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1147             20  FILLER                     PIC X.
  1148             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1149         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1150             20  FILLER                     PIC XX.
  1151             20  CF-MORTGAGE-PLAN           PIC XX.
  1152         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1153
  1154     12  CF-LAST-MAINT-DT                   PIC XX.
  1155     12  CF-LAST-MAINT-BY                   PIC X(4).
  1156     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1157
  1158     12  CF-RECORD-BODY                     PIC X(728).
  1159
  1160
  1161****************************************************************
  1162*             COMPANY MASTER RECORD                            *
  1163****************************************************************
  1164
  1165     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1166         16  CF-COMPANY-ADDRESS.
  1167             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1168             20  CF-CL-IN-CARE-OF           PIC X(30).
  1169             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1170             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1171             20  CF-CL-CITY-STATE           PIC X(30).
  1172             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1173             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  22
* SOCK00.cbl
  1174         16  CF-COMPANY-CD                  PIC X.
  1175         16  CF-COMPANY-PASSWORD            PIC X(8).
  1176         16  CF-SECURITY-OPTION             PIC X.
  1177             88  ALL-SECURITY                   VALUE '1'.
  1178             88  COMPANY-VERIFY                 VALUE '2'.
  1179             88  PROCESSOR-VERIFY               VALUE '3'.
  1180             88  NO-SECURITY                    VALUE '4'.
  1181             88  ALL-BUT-TERM                   VALUE '5'.
  1182         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1183             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1184         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1185             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1186         16  CF-INFORCE-LOCATION            PIC X.
  1187             88  CERTS-ARE-ONLINE               VALUE '1'.
  1188             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1189             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1190         16  CF-LOWER-CASE-LETTERS          PIC X.
  1191         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1192             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1193             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1194             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1195             88  CF-ACCNT-CNTL                  VALUE '3'.
  1196             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1197
  1198         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1199         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1200
  1201         16  CF-LGX-CREDIT-USER             PIC X.
  1202             88  CO-IS-NOT-USER                 VALUE 'N'.
  1203             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1204
  1205         16 CF-CREDIT-CALC-CODES.
  1206             20  CF-CR-REM-TERM-CALC PIC X.
  1207               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1208               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1209               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1210               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1211               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1212               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1213               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1214             20  CF-CR-R78-METHOD           PIC X.
  1215               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1216               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1217
  1218         16  CF-CLAIM-CONTROL-COUNTS.
  1219             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1220                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1221
  1222             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1223                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1224
  1225             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1226                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1227
  1228             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1229                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1230
  1231         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  23
* SOCK00.cbl
  1232
  1233         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1234             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1235             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1236             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1237             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1238                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1239                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1240             20  CF-CO-PREM-REJECT-SW       PIC X.
  1241                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1242                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1243             20  CF-CO-REF-REJECT-SW        PIC X.
  1244                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1245                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1246
  1247         16  CF-CO-REPORTING-DT             PIC XX.
  1248         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1249         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1250           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1251           88  CF-CO-MONTH-END                  VALUE '1'.
  1252
  1253         16  CF-LGX-CLAIM-USER              PIC X.
  1254             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1255             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1256
  1257         16  CF-CREDIT-EDIT-CONTROLS.
  1258             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1259             20  CF-MIN-AGE                 PIC 99.
  1260             20  CF-DEFAULT-AGE             PIC 99.
  1261             20  CF-MIN-TERM                PIC S999      COMP-3.
  1262             20  CF-MAX-TERM                PIC S999      COMP-3.
  1263             20  CF-DEFAULT-SEX             PIC X.
  1264             20  CF-JOINT-AGE-INPUT         PIC X.
  1265                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1266             20  CF-BIRTH-DATE-INPUT        PIC X.
  1267                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1268             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1269                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1270                 88  CF-ZERO-CARRIER            VALUE '1'.
  1271                 88  CF-ZERO-GROUPING           VALUE '2'.
  1272                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1273             20  CF-EDIT-SW                 PIC X.
  1274                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1275             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1276             20  CF-CR-PR-METHOD            PIC X.
  1277               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1278               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1279             20  FILLER                     PIC X.
  1280
  1281         16  CF-CREDIT-MISC-CONTROLS.
  1282             20  CF-REIN-TABLE-SW           PIC X.
  1283                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1284             20  CF-COMP-TABLE-SW           PIC X.
  1285                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1286             20  CF-EXPERIENCE-RETENTION-AGE
  1287                                            PIC S9        COMP-3.
  1288             20  CF-CONVERSION-DT           PIC XX.
  1289             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  24
* SOCK00.cbl
  1290             20  CF-RUN-FREQUENCY-SW        PIC X.
  1291                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1292                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1293
  1294             20  CF-CR-CHECK-NO-CONTROL.
  1295                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1296                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1297                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1298                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1299                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1300                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1301
  1302                 24  CF-CR-CHECK-COUNT       REDEFINES
  1303                     CF-CR-CHECK-COUNTER      PIC X(4).
  1304
  1305                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1306                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1307
  1308                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1309                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1310                 24  CF-MAIL-PROCESSING       PIC X.
  1311                     88  MAIL-PROCESSING          VALUE 'Y'.
  1312
  1313         16  CF-MISC-SYSTEM-CONTROL.
  1314             20  CF-SYSTEM-C                 PIC X.
  1315                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1316             20  CF-SYSTEM-D                 PIC X.
  1317                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1318             20  CF-SOC-SEC-NO-SW            PIC X.
  1319                 88  SOC-SEC-NO-USED             VALUE '1'.
  1320             20  CF-MEMBER-NO-SW             PIC X.
  1321                 88  MEMBER-NO-USED              VALUE '1'.
  1322             20  CF-TAX-ID-NUMBER            PIC X(11).
  1323             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1324             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1325                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1326                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1327                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1328                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1329             20  CF-SYSTEM-E                 PIC X.
  1330                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1331
  1332         16  CF-LGX-LIFE-USER               PIC X.
  1333             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1334             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1335
  1336         16  CF-CR-MONTH-END-DT             PIC XX.
  1337
  1338         16  CF-FILE-MAINT-DATES.
  1339             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1340                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1341             20  CF-LAST-BATCH       REDEFINES
  1342                 CF-LAST-BATCH-NO               PIC X(4).
  1343             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1344             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1345             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1346             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1347             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  25
* SOCK00.cbl
  1348             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1349             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1350             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1351             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1352             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1353
  1354         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1355         16  FILLER                         PIC X.
  1356
  1357         16  CF-ALT-MORT-CODE               PIC X(4).
  1358         16  CF-MEMBER-CAPTION              PIC X(10).
  1359
  1360         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1361             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1362             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1363             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1364             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1365             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1366
  1367         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1368
  1369         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1370         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1371         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1372         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1373
  1374         16  CF-AH-OVERRIDE-L1              PIC X.
  1375         16  CF-AH-OVERRIDE-L2              PIC XX.
  1376         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1377         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1378
  1379         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1380         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1381
  1382         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1383         16  CF-AR-LAST-EL860-DT            PIC XX.
  1384         16  CF-MP-MONTH-END-DT             PIC XX.
  1385
  1386         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1387         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1388             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1389
  1390         16  CF-AR-MONTH-END-DT             PIC XX.
  1391
  1392         16  CF-CRDTCRD-USER                PIC X.
  1393             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1394             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1395
  1396         16  CF-CC-MONTH-END-DT             PIC XX.
  1397
  1398         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1399
  1400         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1401             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1402             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1403             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1404         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1405         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  26
* SOCK00.cbl
  1406         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1407         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1408             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1409             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1410         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1411         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1412         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1413             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1414         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1415
  1416         16  CF-CL-ZIP-CODE.
  1417             20  CF-CL-ZIP-PRIME.
  1418                 24  CF-CL-ZIP-1ST          PIC X.
  1419                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1420                 24  FILLER                 PIC X(4).
  1421             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1422         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1423             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1424             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1425             20  FILLER                     PIC XXX.
  1426
  1427         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1428         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1429         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1430         16  CF-CO-OPTION-START-DATE        PIC XX.
  1431         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1432           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1433                                                      '3' '4'.
  1434           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1435           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1436           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1437           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1438           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1439           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1440
  1441         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1442
  1443         16  CF-PAYMENT-APPROVAL-LEVELS.
  1444             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1445             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1446             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1447             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1448             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1449             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1450
  1451         16  CF-END-USER-REPORTING-USER     PIC X.
  1452             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1453             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1454
  1455         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1456             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1457             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1458
  1459         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1460
  1461         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1462         16  FILLER                         PIC X.
  1463
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  27
* SOCK00.cbl
  1464         16  CF-CREDIT-ARCHIVE-CNTL.
  1465             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1466             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1467             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1468
  1469         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1470
  1471         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1472             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1473             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1474
  1475         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1476             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1477             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1478
  1479         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1480
  1481         16  CF-CO-ACH-ID-CODE              PIC  X.
  1482             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1483             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1484             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1485         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1486         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1487         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1488         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1489         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1490         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1491         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1492         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1493         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1494                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1495         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1496                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1497
  1498         16  CF-CO-OVER-SHORT.
  1499             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1500             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1501
  1502*         16  FILLER                         PIC X(102).
  1503         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1504             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1505             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1506
  1507         16  CF-AH-APPROVAL-DAYS.
  1508             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1509             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1510             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1511             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1512
  1513         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1514
  1515         16  CF-APPROV-LEV-5.
  1516             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1517             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1518             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1519
  1520         16  FILLER                         PIC X(68).
  1521****************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  28
* SOCK00.cbl
  1522*             PROCESSOR/USER RECORD                            *
  1523****************************************************************
  1524
  1525     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1526         16  CF-PROCESSOR-NAME              PIC X(30).
  1527         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1528         16  CF-PROCESSOR-TITLE             PIC X(26).
  1529         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1530                 88  MESSAGE-YES                VALUE 'Y'.
  1531                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1532
  1533*****************************************************
  1534****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1535****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1536****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1537****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1538*****************************************************
  1539
  1540         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1541             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1542             20  CF-APPLICATION-FORCE       PIC X.
  1543             20  CF-INDIVIDUAL-APP.
  1544                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1545                     28  CF-BROWSE-APP      PIC X.
  1546                     28  CF-UPDATE-APP      PIC X.
  1547
  1548         16  CF-CURRENT-TERM-ON             PIC X(4).
  1549         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1550             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1551             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1552             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1553             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1554             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1555             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1556             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1557         16  CF-PROCESSOR-CARRIER           PIC X.
  1558             88  NO-CARRIER-SECURITY            VALUE ' '.
  1559         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1560             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1561         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1562             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1563         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1564             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1565
  1566         16  CF-PROC-SYS-ACCESS-SW.
  1567             20  CF-PROC-CREDIT-CLAIMS-SW.
  1568                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1569                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1570                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1571                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1572             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1573                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1574                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1575             20  CF-PROC-LIFE-GNRLDGR-SW.
  1576                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1577                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1578                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1579                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  29
* SOCK00.cbl
  1580             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1581                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1582                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1583         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1584             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1585             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1586         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1587
  1588         16  CF-APPROVAL-LEVEL                  PIC X.
  1589             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1590             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1591             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1592             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1593             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1594
  1595         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1596
  1597         16  CF-LANGUAGE-TYPE                   PIC X.
  1598             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1599             88  CF-LANG-IS-FR                      VALUE 'F'.
  1600
  1601         16  CF-CSR-IND                         PIC X.
  1602         16  FILLER                             PIC X(239).
  1603
  1604****************************************************************
  1605*             PROCESSOR/REMINDERS RECORD                       *
  1606****************************************************************
  1607
  1608     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1609         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1610             20  CF-START-REMIND-DT         PIC XX.
  1611             20  CF-END-REMIND-DT           PIC XX.
  1612             20  CF-REMINDER-TEXT           PIC X(50).
  1613         16  FILLER                         PIC X(296).
  1614
  1615
  1616****************************************************************
  1617*             STATE MASTER RECORD                              *
  1618****************************************************************
  1619
  1620     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1621         16  CF-STATE-ABBREVIATION          PIC XX.
  1622         16  CF-STATE-NAME                  PIC X(25).
  1623         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1624         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1625             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1626             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1627             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1628             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1629                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1630                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1631             20  CF-ST-PREM-REJECT-SW       PIC X.
  1632                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1633                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1634             20  CF-ST-REF-REJECT-SW        PIC X.
  1635                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1636                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1637         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  30
* SOCK00.cbl
  1638         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1639         16  CF-ST-REFUND-RULES.
  1640             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1641             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1642             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1643         16  CF-ST-FST-PMT-EXTENSION.
  1644             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1645             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1646                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1647                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1648                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1649                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1650         16  CF-ST-STATE-CALL.
  1651             20  CF-ST-CALL-UNEARNED        PIC X.
  1652             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1653             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1654         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1655             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1656             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1657         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1658         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1659         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1660         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1661         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1662         16  FILLER                         PIC X.
  1663         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1664             20  CF-ST-BENEFIT-CD           PIC XX.
  1665             20  CF-ST-BENEFIT-KIND         PIC X.
  1666                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1667                 88  CF-ST-AH-KIND              VALUE 'A'.
  1668             20  CF-ST-REM-TERM-CALC        PIC X.
  1669                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1670                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1671                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1672                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1673                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1674                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1675                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1676                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1677
  1678             20  CF-ST-REFUND-CALC          PIC X.
  1679                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1680                 88  ST-REFD-BY-R78             VALUE '1'.
  1681                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1682                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1683                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1684                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1685                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1686                 88  ST-REFD-UTAH               VALUE '7'.
  1687                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1688                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1689                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1690
  1691             20  CF-ST-EARNING-CALC         PIC X.
  1692                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1693                 88  ST-EARN-BY-R78             VALUE '1'.
  1694                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1695                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  31
* SOCK00.cbl
  1696                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1697                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1698                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1699                 88  ST-EARN-MEAN               VALUE '8'.
  1700                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1701
  1702             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1703                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1704                 88  ST-OVRD-BY-R78             VALUE '1'.
  1705                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1706                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1707                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1708                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1709                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1710                 88  ST-OVRD-MEAN               VALUE '8'.
  1711                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1712             20  cf-st-extra-periods        pic 9.
  1713*            20  FILLER                     PIC X.
  1714
  1715         16  CF-ST-COMMISSION-CAPS.
  1716             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1717             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1718             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1719             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1720         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1721                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1722
  1723         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1724
  1725         16  CF-ST-STATUTORY-INTEREST.
  1726             20  CF-ST-STAT-DATE-FROM       PIC X.
  1727                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1728                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1729             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1730             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1731             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1732             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1733             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1734
  1735         16  CF-ST-OVER-SHORT.
  1736             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1737             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1738
  1739         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1740
  1741         16  CF-ST-RT-CALC                  PIC X.
  1742
  1743         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1744         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1745         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1746         16  CF-ST-RF-LR-CALC               PIC X.
  1747         16  CF-ST-RF-LL-CALC               PIC X.
  1748         16  CF-ST-RF-LN-CALC               PIC X.
  1749         16  CF-ST-RF-AH-CALC               PIC X.
  1750         16  CF-ST-RF-CP-CALC               PIC X.
  1751*        16  FILLER                         PIC X(206).
  1752*CIDMOD         16  FILLER                         PIC X(192).
  1753         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  32
* SOCK00.cbl
  1754             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1755         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1756         16  CF-ST-VFY-2ND-BENE             PIC X.
  1757         16  CF-ST-CAUSAL-STATE             PIC X.
  1758         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1759         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1760         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1761             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1762         16  CF-ST-NET-ONLY-STATE           PIC X.
  1763             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1764         16  FILLER                         PIC X(181).
  1765
  1766****************************************************************
  1767*             BENEFIT MASTER RECORD                            *
  1768****************************************************************
  1769
  1770     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1771         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1772             20  CF-BENEFIT-CODE            PIC XX.
  1773             20  CF-BENEFIT-NUMERIC  REDEFINES
  1774                 CF-BENEFIT-CODE            PIC XX.
  1775             20  CF-BENEFIT-ALPHA           PIC XXX.
  1776             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1777             20  CF-BENEFIT-COMMENT         PIC X(10).
  1778
  1779             20  CF-LF-COVERAGE-TYPE        PIC X.
  1780                 88  CF-REDUCING                VALUE 'R'.
  1781                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1782
  1783             20  CF-SPECIAL-CALC-CD         PIC X.
  1784                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1785                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1786                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1787                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1788                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1789                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1790                 88  CF-FARM-PLAN               VALUE 'F'.
  1791                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1792                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1793                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1794                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1795                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1796                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1797                 88  CF-PRUDENTIAL              VALUE 'P'.
  1798                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1799                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1800                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1801                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1802                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1803                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1804
  1805             20  CF-JOINT-INDICATOR         PIC X.
  1806                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1807
  1808*            20  FILLER                     PIC X(12).
  1809             20  cf-maximum-benefits        pic s999 comp-3.
  1810             20  FILLER                     PIC X(09).
  1811             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  33
* SOCK00.cbl
  1812             20  CF-LOAN-TYPE               PIC X(8).
  1813
  1814             20  CF-CO-REM-TERM-CALC        PIC X.
  1815                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1816                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1817                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1818                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1819                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1820
  1821             20  CF-CO-EARNINGS-CALC        PIC X.
  1822                 88  CO-EARN-BY-R78             VALUE '1'.
  1823                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1824                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1825                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1826                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1827                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1828                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1829                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1830
  1831             20  CF-CO-REFUND-CALC          PIC X.
  1832                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1833                 88  CO-REFD-BY-R78             VALUE '1'.
  1834                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1835                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1836                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1837                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1838                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1839                 88  CO-REFD-MEAN               VALUE '8'.
  1840                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1841                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1842                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1843
  1844             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1845                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1846                 88  CO-OVRD-BY-R78             VALUE '1'.
  1847                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1848                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1849                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1850                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1851                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1852                 88  CO-OVRD-MEAN               VALUE '8'.
  1853                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1854
  1855             20  CF-CO-BEN-I-G-CD           PIC X.
  1856                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1857                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1858                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1859
  1860         16  FILLER                         PIC X(304).
  1861
  1862
  1863****************************************************************
  1864*             CARRIER MASTER RECORD                            *
  1865****************************************************************
  1866
  1867     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1868         16  CF-ADDRESS-DATA.
  1869             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  34
* SOCK00.cbl
  1870             20  CF-IN-CARE-OF              PIC X(30).
  1871             20  CF-ADDRESS-LINE-1          PIC X(30).
  1872             20  CF-ADDRESS-LINE-2          PIC X(30).
  1873             20  CF-CITY-STATE              PIC X(30).
  1874             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1875             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1876
  1877         16  CF-CLAIM-NO-CONTROL.
  1878             20  CF-CLAIM-NO-METHOD         PIC X.
  1879                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1880                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1881                 88  CLAIM-NO-SEQ               VALUE '3'.
  1882                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1883             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1884                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1885                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1886                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1887
  1888         16  CF-CHECK-NO-CONTROL.
  1889             20  CF-CHECK-NO-METHOD         PIC X.
  1890                 88  CHECK-NO-MANUAL            VALUE '1'.
  1891                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1892                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1893                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1894             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1895                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1896
  1897         16  CF-DOMICILE-STATE              PIC XX.
  1898
  1899         16  CF-EXPENSE-CONTROLS.
  1900             20  CF-EXPENSE-METHOD          PIC X.
  1901                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1902                 88  DOLLARS-PER-PMT            VALUE '2'.
  1903                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1904                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1905             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1906             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1907
  1908         16  CF-CORRESPONDENCE-CONTROL.
  1909             20  CF-LETTER-RESEND-OPT       PIC X.
  1910                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1911                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1912             20  FILLER                     PIC X(4).
  1913
  1914         16  CF-RESERVE-CONTROLS.
  1915             20  CF-MANUAL-SW               PIC X.
  1916                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1917             20  CF-FUTURE-SW               PIC X.
  1918                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1919             20  CF-PTC-SW                  PIC X.
  1920                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1921             20  CF-IBNR-SW                 PIC X.
  1922                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1923             20  CF-PTC-LF-SW               PIC X.
  1924                 88  CF-LF-PTC-USED             VALUE '1'.
  1925             20  CF-CDT-ACCESS-METHOD       PIC X.
  1926                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1927                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  35
* SOCK00.cbl
  1928                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1929             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1930
  1931         16  CF-CLAIM-CALC-METHOD           PIC X.
  1932             88  360-PLUS-MONTHS                VALUE '1'.
  1933             88  365-PLUS-MONTHS                VALUE '2'.
  1934             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1935             88  360-DAILY                      VALUE '4'.
  1936             88  365-DAILY                      VALUE '5'.
  1937
  1938         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1939         16  FILLER                         PIC X(11).
  1940
  1941         16  CF-LIMIT-AMOUNTS.
  1942             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1943             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1944             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1945             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1946             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1947             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1948             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1949             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1950             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1951             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1952
  1953         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1954         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1955         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1956
  1957         16  CF-ZIP-CODE.
  1958             20  CF-ZIP-PRIME.
  1959                 24  CF-ZIP-1ST             PIC X.
  1960                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1961                 24  FILLER                 PIC X(4).
  1962             20  CF-ZIP-PLUS4               PIC X(4).
  1963         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1964             20  CF-CAN-POSTAL-1            PIC XXX.
  1965             20  CF-CAN-POSTAL-2            PIC XXX.
  1966             20  FILLER                     PIC XXX.
  1967
  1968         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1969         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1970         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1971
  1972         16  CF-RATING-SWITCH               PIC X.
  1973             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1974             88  CF-NO-RATING                   VALUE 'N'.
  1975
  1976         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1977
  1978         16  CF-CARRIER-OVER-SHORT.
  1979             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1980             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1981
  1982         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1983         16  CF-SECPAY-SWITCH               PIC X.
  1984             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1985             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  36
* SOCK00.cbl
  1986         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1987         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1988         16  FILLER                         PIC X(444).
  1989*        16  FILLER                         PIC X(452).
  1990
  1991
  1992****************************************************************
  1993*             MORTALITY MASTER RECORD                          *
  1994****************************************************************
  1995
  1996     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1997         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1998                                INDEXED BY CF-MORT-NDX.
  1999             20  CF-MORT-TABLE              PIC X(5).
  2000             20  CF-MORT-TABLE-TYPE         PIC X.
  2001                 88  CF-MORT-JOINT              VALUE 'J'.
  2002                 88  CF-MORT-SINGLE             VALUE 'S'.
  2003                 88  CF-MORT-COMBINED           VALUE 'C'.
  2004                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2005                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2006             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2007             20  CF-MORT-AGE-METHOD         PIC XX.
  2008                 88  CF-AGE-LAST                VALUE 'AL'.
  2009                 88  CF-AGE-NEAR                VALUE 'AN'.
  2010             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2011             20  CF-MORT-ADJUSTMENT-DIRECTION
  2012                                            PIC X.
  2013                 88  CF-MINUS                   VALUE '-'.
  2014                 88  CF-PLUS                    VALUE '+'.
  2015             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2016             20  CF-MORT-JOINT-CODE         PIC X.
  2017                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2018             20  CF-MORT-PC-Q               PIC X.
  2019                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2020             20  CF-MORT-TABLE-CODE         PIC X(4).
  2021             20  CF-MORT-COMMENTS           PIC X(15).
  2022             20  FILLER                     PIC X(14).
  2023
  2024         16  FILLER                         PIC X(251).
  2025
  2026
  2027****************************************************************
  2028*             BUSSINESS TYPE MASTER RECORD                     *
  2029****************************************************************
  2030
  2031     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2032* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2033* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2034* AND RECORD 05 IS TYPES 81-99
  2035         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2036             20  CF-BUSINESS-TITLE          PIC  X(19).
  2037             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2038                                            PIC S9V9(4) COMP-3.
  2039             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2040             20  FILLER                     PIC  X.
  2041         16  FILLER                         PIC  X(248).
  2042
  2043
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  37
* SOCK00.cbl
  2044****************************************************************
  2045*             TERMINAL MASTER RECORD                           *
  2046****************************************************************
  2047
  2048     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2049
  2050         16  CF-COMPANY-TERMINALS.
  2051             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2052                                  PIC X(4).
  2053         16  FILLER               PIC X(248).
  2054
  2055
  2056****************************************************************
  2057*             LIFE EDIT MASTER RECORD                          *
  2058****************************************************************
  2059
  2060     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2061         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2062             20  CF-LIFE-CODE-IN            PIC XX.
  2063             20  CF-LIFE-CODE-OUT           PIC XX.
  2064         16  FILLER                         PIC X(248).
  2065
  2066
  2067****************************************************************
  2068*             AH EDIT MASTER RECORD                            *
  2069****************************************************************
  2070
  2071     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2072         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2073             20  CF-AH-CODE-IN              PIC XXX.
  2074             20  CF-AH-CODE-OUT             PIC XX.
  2075         16  FILLER                         PIC X(248).
  2076
  2077
  2078****************************************************************
  2079*             CREDIBILITY TABLES                               *
  2080****************************************************************
  2081
  2082     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2083         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2084                             INDEXED BY CF-CRDB-NDX.
  2085             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2086             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2087             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2088         16  FILLER                         PIC  X(332).
  2089
  2090
  2091****************************************************************
  2092*             REPORT CUSTOMIZATION RECORD                      *
  2093****************************************************************
  2094
  2095     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2096         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2097             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2098             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2099             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2100**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2101****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  38
* SOCK00.cbl
  2102             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2103
  2104         16  FILLER                         PIC XX.
  2105
  2106         16  CF-CARRIER-CNTL-OPT.
  2107             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2108                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2109                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2110             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2111                                            PIC X.
  2112         16  CF-GROUP-CNTL-OPT.
  2113             20  CF-GROUP-OPT-SEQ           PIC 9.
  2114                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2115                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2116             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2117                                            PIC X(6).
  2118         16  CF-STATE-CNTL-OPT.
  2119             20  CF-STATE-OPT-SEQ           PIC 9.
  2120                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2121                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2122             20  CF-STATE-SELECT OCCURS 3 TIMES
  2123                                            PIC XX.
  2124         16  CF-ACCOUNT-CNTL-OPT.
  2125             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2126                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2127                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2128             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2129                                            PIC X(10).
  2130         16  CF-BUS-TYP-CNTL-OPT.
  2131             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2132                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2133                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2134             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2135                                            PIC XX.
  2136         16  CF-LF-TYP-CNTL-OPT.
  2137             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2138                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2139                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2140             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2141                                            PIC XX.
  2142         16  CF-AH-TYP-CNTL-OPT.
  2143             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2144                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2145                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2146             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2147                                            PIC XX.
  2148         16  CF-REPTCD1-CNTL-OPT.
  2149             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2150                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2151                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2152             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2153                                            PIC X(10).
  2154         16  CF-REPTCD2-CNTL-OPT.
  2155             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2156                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2157                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2158             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2159                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  39
* SOCK00.cbl
  2160         16  CF-USER1-CNTL-OPT.
  2161             20  CF-USER1-OPT-SEQ           PIC 9.
  2162                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2163                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2164             20  CF-USER1-SELECT OCCURS 3 TIMES
  2165                                            PIC X(10).
  2166         16  CF-USER2-CNTL-OPT.
  2167             20  CF-USER2-OPT-SEQ           PIC 9.
  2168                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2169                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2170             20  CF-USER2-SELECT OCCURS 3 TIMES
  2171                                            PIC X(10).
  2172         16  CF-USER3-CNTL-OPT.
  2173             20  CF-USER3-OPT-SEQ           PIC 9.
  2174                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2175                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2176             20  CF-USER3-SELECT OCCURS 3 TIMES
  2177                                            PIC X(10).
  2178         16  CF-USER4-CNTL-OPT.
  2179             20  CF-USER4-OPT-SEQ           PIC 9.
  2180                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2181                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2182             20  CF-USER4-SELECT OCCURS 3 TIMES
  2183                                            PIC X(10).
  2184         16  CF-USER5-CNTL-OPT.
  2185             20  CF-USER5-OPT-SEQ           PIC 9.
  2186                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2187                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2188             20  CF-USER5-SELECT OCCURS 3 TIMES
  2189                                            PIC X(10).
  2190         16  CF-REINS-CNTL-OPT.
  2191             20  CF-REINS-OPT-SEQ           PIC 9.
  2192                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2193                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2194             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2195                 24  CF-REINS-PRIME         PIC XXX.
  2196                 24  CF-REINS-SUB           PIC XXX.
  2197
  2198         16  CF-AGENT-CNTL-OPT.
  2199             20  CF-AGENT-OPT-SEQ           PIC 9.
  2200                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2201                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2202             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2203                                            PIC X(10).
  2204
  2205         16  FILLER                         PIC X(43).
  2206
  2207         16  CF-LOSS-RATIO-SELECT.
  2208             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2209             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2210         16  CF-ENTRY-DATE-SELECT.
  2211             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2212             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2213         16  CF-EFFECTIVE-DATE-SELECT.
  2214             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2215             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2216
  2217         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  40
* SOCK00.cbl
  2218             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2219
  2220         16  FILLER                         PIC X(318).
  2221
  2222****************************************************************
  2223*                  EXCEPTION REPORTING RECORD                  *
  2224****************************************************************
  2225
  2226     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2227         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2228             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2229
  2230         16  CF-COMBINED-LIFE-AH-OPT.
  2231             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2232             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2233             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2234             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2235
  2236         16  CF-LIFE-OPT.
  2237             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2238             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2239             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2240             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2241             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2242             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2243             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2244             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2245             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2246             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2247
  2248         16  CF-AH-OPT.
  2249             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2250             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2251             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2252             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2253             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2254             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2255             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2256             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2257             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2258             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2259
  2260         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2261             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2262             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2263             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2264
  2265         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2266
  2267         16  FILLER                         PIC X(673).
  2268
  2269
  2270****************************************************************
  2271*             MORTGAGE SYSTEM PLAN RECORD                      *
  2272****************************************************************
  2273
  2274     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2275         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  41
* SOCK00.cbl
  2276             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2277             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2278             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2279         16  CF-PLAN-ABBREV                 PIC XXX.
  2280         16  CF-PLAN-DESCRIPT               PIC X(10).
  2281         16  CF-PLAN-NOTES                  PIC X(20).
  2282         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2283         16  CF-PLAN-UNDERWRITING.
  2284             20  CF-PLAN-TERM-DATA.
  2285                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2286                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2287             20  CF-PLAN-AGE-DATA.
  2288                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2289                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2290                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2291             20  CF-PLAN-BENEFIT-DATA.
  2292                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2293                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2294                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2295                                            PIC S9(7)V99  COMP-3.
  2296         16  CF-PLAN-POLICY-FORMS.
  2297             20  CF-POLICY-FORM             PIC X(12).
  2298             20  CF-MASTER-APPLICATION      PIC X(12).
  2299             20  CF-MASTER-POLICY           PIC X(12).
  2300         16  CF-PLAN-RATING.
  2301             20  CF-RATE-CODE               PIC X(5).
  2302             20  CF-SEX-RATING              PIC X.
  2303                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2304                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2305             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2306             20  CF-SUB-STD-TYPE            PIC X.
  2307                 88  CF-PCT-OF-PREM            VALUE '1'.
  2308                 88  CF-PCT-OF-BENE            VALUE '2'.
  2309         16  CF-PLAN-PREM-TOLERANCES.
  2310             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2311             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2312         16  CF-PLAN-PYMT-TOLERANCES.
  2313             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2314             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2315         16  CF-PLAN-MISC-DATA.
  2316             20  FILLER                     PIC X.
  2317             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2318             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2319         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2320         16  CF-PLAN-IND-GRP                PIC X.
  2321             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2322                                                     '1'.
  2323             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2324                                                     '2'.
  2325         16  CF-MIB-SEARCH-SW               PIC X.
  2326             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2327             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2328             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2329             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2330         16  CF-ALPHA-SEARCH-SW             PIC X.
  2331             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2332             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2333             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  42
* SOCK00.cbl
  2334             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2335             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2336             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2337             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2338             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2339             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2340             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2341                                                     'A' 'B' 'C'
  2342                                                     'X' 'Y' 'Z'.
  2343         16  CF-EFF-DT-RULE-SW              PIC X.
  2344             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2345             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2346             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2347             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2348             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2349         16  FILLER                         PIC X(4).
  2350         16  CF-HEALTH-QUESTIONS            PIC X.
  2351             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2352         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2353         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2354         16  CF-PLAN-SNGL-JNT               PIC X.
  2355             88  CF-COMBINED-PLAN              VALUE 'C'.
  2356             88  CF-JNT-PLAN                   VALUE 'J'.
  2357             88  CF-SNGL-PLAN                  VALUE 'S'.
  2358         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2359         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2360         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2361         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2362         16  CF-RERATE-CNTL                 PIC  X.
  2363             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2364             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2365             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2366             88  CF-AUTO-RECALC                 VALUE '4'.
  2367         16  CF-BENEFIT-TYPE                PIC  X.
  2368             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2369             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2370         16  CF-POLICY-FEE                  PIC S999V99
  2371                                                    COMP-3.
  2372         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2373         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2374         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2375         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2376         16  FILLER                         PIC  X(32).
  2377         16  CF-TERMINATION-FORM            PIC  X(04).
  2378         16  FILLER                         PIC  X(08).
  2379         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2380                                                       COMP-3.
  2381         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2382         16  CF-ISSUE-LETTER                PIC  X(4).
  2383         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2384         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2385             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2386             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2387         16  CF-MP-REFUND-CALC              PIC X.
  2388             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2389             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2390             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2391             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  43
* SOCK00.cbl
  2392             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2393             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2394             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2395             88  CF-MP-REFD-MEAN                VALUE '8'.
  2396         16  CF-ALT-RATE-CODE               PIC  X(5).
  2397
  2398
  2399         16  FILLER                         PIC X(498).
  2400****************************************************************
  2401*             MORTGAGE COMPANY MASTER RECORD                   *
  2402****************************************************************
  2403
  2404     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2405         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2406         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2407             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2408             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2409             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2410             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2411             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2412
  2413         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2414         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2415         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2416         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2417         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2418
  2419         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2420             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2421         16  CF-MP-RECON-USE-IND            PIC X(1).
  2422             88  CF-MP-USE-RECON             VALUE 'Y'.
  2423         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2424             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2425         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2426             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2427             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2428         16  FILLER                         PIC X(1).
  2429         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2430             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2431         16  CF-MORTG-MIB-VERSION           PIC X.
  2432             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2433             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2434             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2435         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2436             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2437                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2438             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2439                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2440             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2441                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2442             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2443                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2444             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2445                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2446             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2447                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2448         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2449         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  44
* SOCK00.cbl
  2450         16  CF-MORTG-DESTINATION-SYMBOL.
  2451             20  CF-MORTG-MIB-COMM          PIC X(5).
  2452             20  CF-MORTG-MIB-TERM          PIC X(5).
  2453         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2454             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2455         16  FILLER                         PIC X(03).
  2456         16  CF-MP-CHECK-NO-CONTROL.
  2457             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2458                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2459                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2460                                                ' ' LOW-VALUES.
  2461                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2462                                               VALUE '3'.
  2463         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2464         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2465         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2466             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2467                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2468             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2469                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2470             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2471                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2472             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2473                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2474             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2475                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2476             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2477                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2478         16  CF-MORTG-BILLING-AREA.
  2479             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2480                                            PIC X.
  2481         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2482         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2483         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2484         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2485             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2486             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2487         16  FILLER                         PIC X.
  2488         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2489             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2490             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2491         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2492         16  FILLER                         PIC X(8).
  2493         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2494         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2495         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2496         16  CF-ACH-COMPANY-ID.
  2497             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2498                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2499                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2500                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2501             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2502         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2503             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2504         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2505             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2506             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2507         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  45
* SOCK00.cbl
  2508         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2509         16  FILLER                         PIC X(536).
  2510
  2511****************************************************************
  2512*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2513****************************************************************
  2514
  2515     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2516         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2517             20  CF-FEMALE-HEIGHT.
  2518                 24  CF-FEMALE-FT           PIC 99.
  2519                 24  CF-FEMALE-IN           PIC 99.
  2520             20  CF-FEMALE-MIN-WT           PIC 999.
  2521             20  CF-FEMALE-MAX-WT           PIC 999.
  2522         16  FILLER                         PIC X(428).
  2523
  2524     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2525         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2526             20  CF-MALE-HEIGHT.
  2527                 24  CF-MALE-FT             PIC 99.
  2528                 24  CF-MALE-IN             PIC 99.
  2529             20  CF-MALE-MIN-WT             PIC 999.
  2530             20  CF-MALE-MAX-WT             PIC 999.
  2531         16  FILLER                         PIC X(428).
  2532******************************************************************
  2533*             AUTOMATIC ACTIVITY RECORD                          *
  2534******************************************************************
  2535     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2536         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2537             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2538             20  CF-SYS-LETTER-ID           PIC X(04).
  2539             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2540             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2541             20  CF-SYS-RESET-SW            PIC X(01).
  2542             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2543             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2544
  2545         16  FILLER                         PIC X(50).
  2546
  2547         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2548             20  CF-USER-ACTIVE-SW          PIC X(01).
  2549             20  CF-USER-LETTER-ID          PIC X(04).
  2550             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2551             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2552             20  CF-USER-RESET-SW           PIC X(01).
  2553             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2554             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2555             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2556
  2557         16  FILLER                         PIC X(246).
  2558*                                 COPY ERCCTBL.
  2559******************************************************************
  2560*                                                                *
  2561*                                                                *
  2562*                            ERCCTBL                             *
  2563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2564*                            VMOD=2.003
  2565*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  46
* SOCK00.cbl
  2566*   ONLINE CREDIT SYSTEM                                         *
  2567*                                                                *
  2568*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2569*                                                                *
  2570*   FILE TYPE = VSAM,KSDS                                        *
  2571*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2572*                                                                *
  2573*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2574*       ALTERNATE PATH = NONE                                    *
  2575*                                                                *
  2576*   LOG = NO                                                     *
  2577*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2578*                                                                *
  2579*                                                                *
  2580******************************************************************
  2581
  2582 01  COMM-TABLE-RECORD.
  2583     12  CT-RECORD-ID                      PIC XX.
  2584         88  VALID-CT-ID                      VALUE 'CT'.
  2585
  2586     12  CT-CONTROL-PRIMARY.
  2587         16  CT-COMPANY-CD                 PIC X.
  2588         16  CT-TABLE                      PIC XXX.
  2589         16  CT-CNTRL-2.
  2590             20  CT-BEN-TYPE               PIC X.
  2591             20  CT-BEN-CODE               PIC XX.
  2592
  2593     12  CT-MAINT-INFORMATION.
  2594         16  CT-LAST-MAINT-DT              PIC XX.
  2595         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2596         16  CT-LAST-MAINT-USER            PIC X(4).
  2597         16  FILLER                        PIC X(31).
  2598
  2599     12  CT-LIMITS.
  2600         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2601
  2602         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2603
  2604         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2605
  2606     12  CT-RATES.
  2607         16  CT-RTX          OCCURS 27 TIMES.
  2608             20  CT-RT                     PIC SV9(5)     COMP-3.
  2609             20  CT-RT-R   REDEFINES
  2610                 CT-RT                     PIC XXX.
  2611
  2612     12  FILLER                            PIC  X(42).
  2613
  2614******************************************************************
  2615*                                 COPY ELCDATE.
  2616******************************************************************
  2617*                                                                *
  2618*                                                                *
  2619*                            ELCDATE.                            *
  2620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2621*                            VMOD=2.003
  2622*                                                                *
  2623*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  47
* SOCK00.cbl
  2624*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2625*                 LENGTH = 200                                   *
  2626******************************************************************
  2627
  2628 01  DATE-CONVERSION-DATA.
  2629     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2630     12  DC-OPTION-CODE                PIC X.
  2631         88  BIN-TO-GREG                VALUE ' '.
  2632         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2633         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2634         88  YMD-GREG-TO-BIN            VALUE '3'.
  2635         88  MDY-GREG-TO-BIN            VALUE '4'.
  2636         88  JULIAN-TO-BIN              VALUE '5'.
  2637         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2638         88  FIND-CENTURY               VALUE '7'.
  2639         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2640         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2641         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2642         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2643         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2644         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2645         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2646         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2647         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2648         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2649         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2650         88  BIN-3-TO-GREG              VALUE 'I'.
  2651         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2652         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2653         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2654         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2655         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2656         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2657         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2658         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2659         88  THREE-CHARACTER-BIN
  2660                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2661         88  GREGORIAN-TO-BIN
  2662                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2663         88  BIN-TO-GREGORIAN
  2664                  VALUES ' ' '1' 'I' '8' 'G'.
  2665         88  JULIAN-TO-BINARY
  2666                  VALUES '5' 'C' 'E' 'F'.
  2667     12  DC-ERROR-CODE                 PIC X.
  2668         88  NO-CONVERSION-ERROR        VALUE ' '.
  2669         88  DATE-CONVERSION-ERROR
  2670                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2671         88  DATE-IS-ZERO               VALUE '1'.
  2672         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2673         88  DATE-IS-INVALID            VALUE '3'.
  2674         88  DATE1-GREATER-DATE2        VALUE '4'.
  2675         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2676         88  DATE-INVALID-OPTION        VALUE '9'.
  2677         88  INVALID-CENTURY            VALUE 'A'.
  2678         88  ONLY-CENTURY               VALUE 'B'.
  2679         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2680         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2681     12  DC-END-OF-MONTH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  48
* SOCK00.cbl
  2682         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2683     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2684         88  USE-NORMAL-PROCESS         VALUE ' '.
  2685         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2686         88  ADJUST-UP-100-YRS          VALUE '2'.
  2687     12  FILLER                        PIC X.
  2688     12  DC-CONVERSION-DATES.
  2689         16  DC-BIN-DATE-1             PIC XX.
  2690         16  DC-BIN-DATE-2             PIC XX.
  2691         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2692         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2693                       DC-GREG-DATE-1-EDIT.
  2694             20  DC-EDIT1-MONTH        PIC 99.
  2695             20  SLASH1-1              PIC X.
  2696             20  DC-EDIT1-DAY          PIC 99.
  2697             20  SLASH1-2              PIC X.
  2698             20  DC-EDIT1-YEAR         PIC 99.
  2699         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2700         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2701                     DC-GREG-DATE-2-EDIT.
  2702             20  DC-EDIT2-MONTH        PIC 99.
  2703             20  SLASH2-1              PIC X.
  2704             20  DC-EDIT2-DAY          PIC 99.
  2705             20  SLASH2-2              PIC X.
  2706             20  DC-EDIT2-YEAR         PIC 99.
  2707         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2708         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2709                     DC-GREG-DATE-1-YMD.
  2710             20  DC-YMD-YEAR           PIC 99.
  2711             20  DC-YMD-MONTH          PIC 99.
  2712             20  DC-YMD-DAY            PIC 99.
  2713         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2714         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2715                      DC-GREG-DATE-1-MDY.
  2716             20  DC-MDY-MONTH          PIC 99.
  2717             20  DC-MDY-DAY            PIC 99.
  2718             20  DC-MDY-YEAR           PIC 99.
  2719         16  DC-GREG-DATE-1-ALPHA.
  2720             20  DC-ALPHA-MONTH        PIC X(10).
  2721             20  DC-ALPHA-DAY          PIC 99.
  2722             20  FILLER                PIC XX.
  2723             20  DC-ALPHA-CENTURY.
  2724                 24 DC-ALPHA-CEN-N     PIC 99.
  2725             20  DC-ALPHA-YEAR         PIC 99.
  2726         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2727         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2728         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2729         16  DC-JULIAN-DATE            PIC 9(05).
  2730         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2731                                       PIC 9(05).
  2732         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2733             20  DC-JULIAN-YEAR        PIC 99.
  2734             20  DC-JULIAN-DAYS        PIC 999.
  2735         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2736         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2737         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2738     12  DATE-CONVERSION-VARIBLES.
  2739         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  49
* SOCK00.cbl
  2740         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2741             20  FILLER                PIC 9(3).
  2742             20  HOLD-CEN-1-CCYY.
  2743                 24  HOLD-CEN-1-CC     PIC 99.
  2744                 24  HOLD-CEN-1-YY     PIC 99.
  2745             20  HOLD-CEN-1-MO         PIC 99.
  2746             20  HOLD-CEN-1-DA         PIC 99.
  2747         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2748             20  HOLD-CEN-1-R-MO       PIC 99.
  2749             20  HOLD-CEN-1-R-DA       PIC 99.
  2750             20  HOLD-CEN-1-R-CCYY.
  2751                 24  HOLD-CEN-1-R-CC   PIC 99.
  2752                 24  HOLD-CEN-1-R-YY   PIC 99.
  2753             20  FILLER                PIC 9(3).
  2754         16  HOLD-CENTURY-1-X.
  2755             20  FILLER                PIC X(3)  VALUE SPACES.
  2756             20  HOLD-CEN-1-X-CCYY.
  2757                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2758                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2759             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2760             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2761         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2762             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2763             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2764             20  HOLD-CEN-1-R-X-CCYY.
  2765                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2766                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2767             20  FILLER                PIC XXX.
  2768         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2769         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2770         16  DC-JULIAN-DATE-1          PIC 9(07).
  2771         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2772             20  DC-JULIAN-1-CCYY.
  2773                 24  DC-JULIAN-1-CC    PIC 99.
  2774                 24  DC-JULIAN-1-YR    PIC 99.
  2775             20  DC-JULIAN-DA-1        PIC 999.
  2776         16  DC-JULIAN-DATE-2          PIC 9(07).
  2777         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2778             20  DC-JULIAN-2-CCYY.
  2779                 24  DC-JULIAN-2-CC    PIC 99.
  2780                 24  DC-JULIAN-2-YR    PIC 99.
  2781             20  DC-JULIAN-DA-2        PIC 999.
  2782         16  DC-GREG-DATE-A-EDIT.
  2783             20  DC-EDITA-MONTH        PIC 99.
  2784             20  SLASHA-1              PIC X VALUE '/'.
  2785             20  DC-EDITA-DAY          PIC 99.
  2786             20  SLASHA-2              PIC X VALUE '/'.
  2787             20  DC-EDITA-CCYY.
  2788                 24  DC-EDITA-CENT     PIC 99.
  2789                 24  DC-EDITA-YEAR     PIC 99.
  2790         16  DC-GREG-DATE-B-EDIT.
  2791             20  DC-EDITB-MONTH        PIC 99.
  2792             20  SLASHB-1              PIC X VALUE '/'.
  2793             20  DC-EDITB-DAY          PIC 99.
  2794             20  SLASHB-2              PIC X VALUE '/'.
  2795             20  DC-EDITB-CCYY.
  2796                 24  DC-EDITB-CENT     PIC 99.
  2797                 24  DC-EDITB-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  50
* SOCK00.cbl
  2798         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2799         16  DC-GREG-DATE-CYMD-R REDEFINES
  2800                              DC-GREG-DATE-CYMD.
  2801             20  DC-CYMD-CEN           PIC 99.
  2802             20  DC-CYMD-YEAR          PIC 99.
  2803             20  DC-CYMD-MONTH         PIC 99.
  2804             20  DC-CYMD-DAY           PIC 99.
  2805         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2806         16  DC-GREG-DATE-MDCY-R REDEFINES
  2807                              DC-GREG-DATE-MDCY.
  2808             20  DC-MDCY-MONTH         PIC 99.
  2809             20  DC-MDCY-DAY           PIC 99.
  2810             20  DC-MDCY-CEN           PIC 99.
  2811             20  DC-MDCY-YEAR          PIC 99.
  2812    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2813        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2814    12  DC-EL310-DATE                  PIC X(21).
  2815    12  FILLER                         PIC X(28).
  2816*                                 COPY ELCCALC.
  2817******************************************************************
  2818*                                                                *
  2819*                           ELCCALC.                            *
  2820*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2821*                            VMOD=2.025                          *
  2822*                                                                *
  2823*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2824*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2825*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2826*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2827*                                                                *
  2828*  PASSED TO ELRTRM                                              *
  2829*  -----------------                                             *
  2830*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2831*  ORIGINAL TERM                                                 *
  2832*  BEGINNING DATE                                                *
  2833*  ENDING DATE                                                   *
  2834*  COMPANY I.D.                                                  *
  2835*  ACCOUNT MASTER USER FIELD                                     *
  2836*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2837*  FREE LOOK DAYS                                                *
  2838*                                                                *
  2839*  RETURNED FROM ELRTRM                                          *
  2840*  ---------------------                                         *
  2841*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2842*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2843*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2844*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2845*----------------------------------------------------------------*
  2846*  PASSED TO ELRAMT                                              *
  2847*  ----------------                                              *
  2848*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2849*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2850*  ORIGINAL AMOUNT                                               *
  2851*  ALTERNATE BENEFIT (BALLON)                                    *
  2852*  A.P.R. - NET PAY ONLY                                         *
  2853*  METHOD
  2854*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2855*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  51
* SOCK00.cbl
  2856*  BENEFIT TYPE                                                  *
  2857*                                                                *
  2858*  RETURNED FROM ELRAMT                                          *
  2859*  --------------------                                          *
  2860*  REMAINING AMOUNT 1 - CURRENT                                  *
  2861*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2862*  REMAINING AMOUNT FACTOR
  2863*----------------------------------------------------------------*
  2864*  PASSED TO ELRESV                                              *
  2865*  -----------------                                             *
  2866*  CERTIFICATE EFFECTIVE DATE                                    *
  2867*  VALUATION DATE                                                *
  2868*  PAID THRU DATE                                                *
  2869*  BENEFIT                                                       *
  2870*  INCURRED DATE                                                 *
  2871*  REPORTED DATE                                                 *
  2872*  ISSUE AGE                                                     *
  2873*  TERM                                                          *
  2874*  CDT PERCENT                                                   *
  2875*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2876* *CLAIM TYPE (LIFE, A/H)                                        *
  2877* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2878* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2879*                                                                *
  2880*  RETURNED FROM ELRESV                                          *
  2881*  --------------------                                          *
  2882*  CDT TABLE USED                                                *
  2883*  CDT FACTOR USED                                               *
  2884*  PAY TO CURRENT RESERVE                                        *
  2885*  I.B.N.R. - A/H ONLY                                           *
  2886*  FUTURE (ACCRUED) AH ONLY                                      *
  2887*----------------------------------------------------------------*
  2888*  PASSED TO ELRATE                                              *
  2889*  ----------------                                              *
  2890*  CERT ISSUE DATE                                               *
  2891*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2892*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2893*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2894*  STATE CODE (CLIENT DEFINED)                                   *
  2895*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2896*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2897*  DEVIATION CODE                                                *
  2898*  ISSUE AGE                                                     *
  2899*  ORIGINAL BENEFIT AMOUNT                                       *
  2900*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2901*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2902*  BENEFIT KIND (LIFE OR A/H)                                    *
  2903*  A.P.R.                                                        *
  2904*  METHOD
  2905*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2906*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2907*  COMPANY I.D. (3 CHARACTER)                                    *
  2908*  BENEFIT CODE                                                  *
  2909*  BENEFIT OVERRIDE CODE                                         *
  2910*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2911*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2912*  JOINT INDICATOR (CSL ONLY)                                    *
  2913*  FIRST PAYMENT DATE (CSL ONLY)                                 *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  52
* SOCK00.cbl
  2914*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2915*                                                                *
  2916*  RETURNED FROM ELRATE                                          *
  2917*  --------------------                                          *
  2918*  CALCULATED PREMIUM                                            *
  2919*  PREMIUM RATE                                                  *
  2920*  MORTALITY CODE                                                *
  2921*  MAX ATTAINED AGE                                              *
  2922*  MAX AGE                                                       *
  2923*  MAX TERM                                                      *
  2924*  MAX MONTHLY BENEFIT                                           *
  2925*  MAX TOTAL BENIFIT                                             *
  2926*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2927*----------------------------------------------------------------*
  2928*  PASSED TO ELRFND                                              *
  2929*  ----------------                                              *
  2930*  CERT ISSUE DATE                                               *
  2931*  REFUND DATE                                                   *
  2932*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2933*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2934*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2935*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2936*  STATE CODE (CLIENT DEFINED)                                   *
  2937*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2938*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2939*  DEVIATION CODE                                                *
  2940*  ISSUE AGE                                                     *
  2941*  ORIGINAL BENEFIT AMOUNT                                       *
  2942*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2943*  PROCESS TYPE (CANCEL)                                         *
  2944*  BENEFIT KIND (LIFE OR A/H)                                    *
  2945*  A.P.R.                                                        *
  2946*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2947*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2948*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2949*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2950*  COMPANY I.D. (3 CHARACTER)                                    *
  2951*  BENEFIT CODE                                                  *
  2952*  BENEFIT OVERRIDE CODE                                         *
  2953*                                                                *
  2954*  RETURNED FROM ELRFND                                          *
  2955*  --------------------                                          *
  2956*  CALCULATED REFUND                                             *
  2957*----------------------------------------------------------------*
  2958*  PASSED TO ELEARN                                              *
  2959*  ----------------                                              *
  2960*  CERT ISSUE DATE                                               *
  2961*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2962*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2963*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2964*  STATE CODE (CLIENT DEFINED)                                   *
  2965*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2966*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2967*  DEVIATION CODE                                                *
  2968*  ISSUE AGE                                                     *
  2969*  ORIGINAL BENEFIT AMOUNT                                       *
  2970*  BENEFIT KIND (LIFE OR A/H)                                    *
  2971*  A.P.R.                                                        *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  53
* SOCK00.cbl
  2972*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2973*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2974*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2975*  COMPANY I.D. (3 CHARACTER)                                    *
  2976*  BENEFIT CODE                                                  *
  2977*  BENEFIT OVERRIDE CODE                                         *
  2978*                                                                *
  2979*  RETURNED FROM ELEARN                                          *
  2980*  --------------------                                          *
  2981*  INDICATED  EARNINGS                                           *
  2982*----------------------------------------------------------------*
  2983*                 LENGTH = 450                                   *
  2984*                                                                *
  2985******************************************************************
  2986******************************************************************
  2987*                   C H A N G E   L O G
  2988*
  2989* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2990*-----------------------------------------------------------------
  2991*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2992* EFFECTIVE    NUMBER
  2993*-----------------------------------------------------------------
  2994* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2995* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2996* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2997* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2998* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2999* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3000* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3001* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3002* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3003* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3004* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3005******************************************************************
  3006
  3007 01  CALCULATION-PASS-AREA.
  3008     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3009                                     COMP.
  3010
  3011     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3012       88  NO-CP-ERROR                             VALUE ZERO.
  3013       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3014                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3015       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3016       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3017       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3018       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3019       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3020       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3021       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3022       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3023       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3024       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3025       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3026       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3027       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3028       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3029       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  54
* SOCK00.cbl
  3030       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3031       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3032
  3033     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3034       88  NO-CP-ERROR-2                           VALUE ZERO.
  3035***********************  INPUT AREAS ****************************
  3036
  3037     12  CP-CALCULATION-AREA.
  3038         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3039         16  CP-CERT-EFF-DT        PIC XX.
  3040         16  CP-VALUATION-DT       PIC XX.
  3041         16  CP-PAID-THRU-DT       PIC XX.
  3042         16  CP-BENEFIT-TYPE       PIC X.
  3043           88  CP-AH                               VALUE 'A' 'D'
  3044                                                   'I' 'U'.
  3045           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3046           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3047         16  CP-INCURRED-DT        PIC XX.
  3048         16  CP-REPORTED-DT        PIC XX.
  3049         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3050         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3051         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3052                                     COMP-3.
  3053         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3054                                     COMP-3.
  3055         16  CP-CDT-METHOD         PIC X.
  3056           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3057           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3058           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3059         16  CP-CLAIM-TYPE         PIC X.
  3060           88  CP-AH-CLAIM                         VALUE 'A'.
  3061           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3062         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3063                                     COMP-3.
  3064         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3065                                     COMP-3.
  3066         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3067                                     COMP-3.
  3068         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3069                                     COMP-3.
  3070         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3071                                     COMP-3.
  3072         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3073                                     COMP-3.
  3074         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3075                                     COMP-3.
  3076         16  CP-REM-TERM-METHOD    PIC X.
  3077           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3078           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3079           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3080           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3081           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3082           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3083           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3084         16  CP-EARNING-METHOD     PIC X.
  3085           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3086           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3087           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  55
* SOCK00.cbl
  3088           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3089           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3090           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3091           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3092           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3093           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3094           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3095           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3096           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3097           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3098           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3099         16  CP-PROCESS-TYPE       PIC X.
  3100           88  CP-CLAIM                            VALUE '1'.
  3101           88  CP-CANCEL                           VALUE '2'.
  3102           88  CP-ISSUE                            VALUE '3'.
  3103         16  CP-SPECIAL-CALC-CD    PIC X.
  3104           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3105           88  CP-1-MTH-INTEREST               VALUE ' '.
  3106           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3107           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3108           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3109           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3110           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3111           88  CP-FARM-PLAN                    VALUE 'F'.
  3112           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3113           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3114           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3115           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3116           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3117           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3118           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3119           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3120           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3121           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3122                                                     'W' 'X'.
  3123           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3124           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3125           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3126           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3127           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3128           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3129           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3130           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3131           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3132           88  CP-CSL-METH-1                   VALUE '5'.
  3133           88  CP-CSL-METH-2                   VALUE '6'.
  3134           88  CP-CSL-METH-3                   VALUE '7'.
  3135           88  CP-CSL-METH-4                   VALUE '8'.
  3136
  3137         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3138                                     COMP-3.
  3139         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3140         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3141         16  CP-STATE              PIC XX          VALUE SPACE.
  3142         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3143         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3144           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3145               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  56
* SOCK00.cbl
  3146         16  CP-R78-OPTION         PIC X.
  3147           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3148           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3149
  3150         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3151         16  CP-IBNR-RESERVE-SW    PIC X.
  3152         16  CP-CLAIM-STATUS       PIC X.
  3153         16  CP-RATE-FILE          PIC X.
  3154         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3155                                     COMP-3.
  3156
  3157         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3158         16  CP-AH-OVERRIDE-CODE   PIC X.
  3159
  3160         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3161                                     COMP-3.
  3162         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3163                                   PIC S9(5)V99 COMP-3.
  3164         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3165                                     COMP-3.
  3166         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3167                                     COMP-3.
  3168         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3169                                     COMP-3.
  3170         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3171                                  PIC S9(7)V99 COMP-3.
  3172
  3173         16  CP-PAID-FROM-DATE     PIC X(02).
  3174         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3175         16  CP-EXT-DAYS-CALC      PIC X.
  3176           88  CP-EXT-NO-CHG                   VALUE ' '.
  3177           88  CP-EXT-CHG-LF                   VALUE '1'.
  3178           88  CP-EXT-CHG-AH                   VALUE '2'.
  3179           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3180         16  CP-DOMICILE-STATE     PIC XX.
  3181         16  CP-CARRIER            PIC X.
  3182         16  CP-REIN-FLAG          PIC X.
  3183         16  CP-REM-TRM-CALC-OPTION PIC X.
  3184           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3185                      '2' '3' '4' '5'.
  3186           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3187           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3188           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3189           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3190           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3191           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3192           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3193           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3194         16  CP-SIG-SWITCH         PIC X.
  3195         16  CP-RATING-METHOD      PIC X.
  3196           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3197           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3198           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3199           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3200           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3201           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3202           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3203           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  57
* SOCK00.cbl
  3204           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3205         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3206                                     COMP-3.
  3207         16  CP-BEN-CATEGORY       PIC X.
  3208         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3209         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3210                                   PIC S99V9(5) COMP-3.
  3211         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3212         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3213                                   PIC S99V9(5) COMP-3.
  3214         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3215         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3216         16  CP-EXPIRE-DT          PIC XX.
  3217         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3218         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3219         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3220         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3221         16  CP-DDF-SPEC-CALC      PIC X.
  3222             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3223             88  CP-CALC-CLP              VALUE 'C'.
  3224         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3225         16  CP-CANCEL-REASON      PIC X.
  3226         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3227         16  CP-PMT-MODE           PIC X.
  3228         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3229         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3230         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3231         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3232         16  FILLER                PIC X.
  3233
  3234***************    OUTPUT FROM ELRESV   ************************
  3235
  3236         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3237
  3238         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3239                                     COMP-3.
  3240         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3241                                     COMP-3.
  3242         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3243                                     COMP-3.
  3244         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3245                                     COMP-3.
  3246         16  FILLER                PIC X(09).
  3247***************    OUTPUT FROM ELRTRM   *************************
  3248
  3249         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3250                                     COMP-3.
  3251         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3252                                     COMP-3.
  3253         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3254                                     COMP-3.
  3255         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3256                                     COMP-3.
  3257         16  FILLER                PIC X(12).
  3258
  3259***************    OUTPUT FROM ELRAMT   *************************
  3260
  3261         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  58
* SOCK00.cbl
  3262                                     COMP-3.
  3263         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3264                                     COMP-3.
  3265         16  FILLER                PIC X(12).
  3266
  3267***************    OUTPUT FROM ELRATE   *************************
  3268
  3269         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3270                                     COMP-3.
  3271         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3272                                     COMP-3.
  3273         16  CP-MORTALITY-CODE     PIC X(4).
  3274         16  CP-RATE-EDIT-FLAG     PIC X.
  3275             88  CP-RATES-NEED-APR                  VALUE '1'.
  3276         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3277                                     COMP-3.
  3278         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3279         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3280         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3281                                   PIC S9(7)V99 COMP-3.
  3282         16  FILLER                PIC X(07).
  3283
  3284***************    OUTPUT FROM ELRFND   *************************
  3285
  3286         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3287                                     COMP-3.
  3288         16  CP-REFUND-TYPE-USED   PIC X.
  3289           88  CP-R-AS-R78                         VALUE '1'.
  3290           88  CP-R-AS-PRORATA                     VALUE '2'.
  3291           88  CP-R-AS-CALIF                       VALUE '3'.
  3292           88  CP-R-AS-TEXAS                       VALUE '4'.
  3293           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3294           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3295           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3296           88  CP-R-AS-MEAN                        VALUE '8'.
  3297           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3298           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3299           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3300           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3301           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3302           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3303         16  FILLER                PIC X(12).
  3304
  3305***************    OUTPUT FROM ELEARN   *************************
  3306
  3307         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3308                                     COMP-3.
  3309         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3310                                     COMP-3.
  3311         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3312                                     COMP-3.
  3313         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3314                                     COMP-3.
  3315         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3316                                     COMP-3.
  3317         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3318                                     COMP-3.
  3319         16  CP-EARNING-TYPE-USED  PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  59
* SOCK00.cbl
  3320           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3321           88  CP-E-AS-R78                         VALUE '1'.
  3322           88  CP-E-AS-PRORATA                     VALUE '2'.
  3323           88  CP-E-AS-TEXAS                       VALUE '4'.
  3324           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3325           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3326           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3327           88  CP-E-AS-MEAN                        VALUE '8'.
  3328           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3329         16  FILLER                PIC X(12).
  3330
  3331***************    OUTPUT FROM ELPMNT   *************************
  3332
  3333         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3334                                     COMP-3.
  3335         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3336                                     COMP-3.
  3337         16  FILLER                PIC X(12).
  3338
  3339***************   MISC WORK AREAS    *****************************
  3340         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3341                                     COMP-3.
  3342         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3343                                     COMP-3.
  3344         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3345                                     COMP-3.
  3346         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3347                                     COMP-3.
  3348         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3349                                     COMP-3.
  3350         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3351                                     COMP-3.
  3352         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3353             88  OPEN-RATE-FILE                   VALUE 'O'.
  3354             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3355             88  IO-ERROR                         VALUE 'E'.
  3356
  3357         16  CP-FIRST-PAY-DATE     PIC XX.
  3358
  3359         16  CP-JOINT-INDICATOR    PIC X.
  3360
  3361         16  CP-RESERVE-REMAINING-TERM
  3362                                   PIC S9(4)V9    VALUE ZERO
  3363                                     COMP-3.
  3364
  3365         16  CP-INSURED-BIRTH-DT   PIC XX.
  3366
  3367         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3368                                     COMP-3.
  3369
  3370         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3371                                     COMP-3.
  3372
  3373         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3374                                     COMP-3.
  3375
  3376         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3377                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  60
* SOCK00.cbl
  3378
  3379         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3380                                     COMP-3.
  3381
  3382         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3383                                     COMP-3.
  3384
  3385         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3386                                     COMP-3.
  3387
  3388         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3389             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3390
  3391         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3392                                     COMP-3.
  3393         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3394                                     COMP-3.
  3395         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3396         16  cp-extra-periods      pic 9 value zeros.
  3397         16  cp-net-only-state     pic x value spaces.
  3398         16  FILLER                PIC X(13).
  3399******************************************************************
  3400****************************************************************
  3401*
  3402* Copyright (c) 2007 by Clerity Solutions, Inc.
  3403* All rights reserved.
  3404*
  3405****************************************************************
  3406 01  DFHEIV.
  3407   02  DFHEIV0               PIC X(35).
  3408   02  DFHEIV1               PIC X(08).
  3409   02  DFHEIV2               PIC X(08).
  3410   02  DFHEIV3               PIC X(08).
  3411   02  DFHEIV4               PIC X(06).
  3412   02  DFHEIV5               PIC X(04).
  3413   02  DFHEIV6               PIC X(04).
  3414   02  DFHEIV7               PIC X(02).
  3415   02  DFHEIV8               PIC X(02).
  3416   02  DFHEIV9               PIC X(01).
  3417   02  DFHEIV10              PIC S9(7) COMP-3.
  3418   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3419   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3420   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3421   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3422   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3423   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3424   02  DFHEIV17              PIC X(04).
  3425   02  DFHEIV18              PIC X(04).
  3426   02  DFHEIV19              PIC X(04).
  3427   02  DFHEIV20              USAGE IS POINTER.
  3428   02  DFHEIV21              USAGE IS POINTER.
  3429   02  DFHEIV22              USAGE IS POINTER.
  3430   02  DFHEIV23              USAGE IS POINTER.
  3431   02  DFHEIV24              USAGE IS POINTER.
  3432   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3433   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3434   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3435   02  DFHEIV28              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  61
* SOCK00.cbl
  3436   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3437   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3438   02  FILLER                PIC X(02).
  3439   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3440   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3441   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3442   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3443   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3444 LINKAGE  SECTION.
  3445*****************************************************************
  3446*                                                               *
  3447* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3448* All rights reserved.                                          *
  3449*                                                               *
  3450*****************************************************************
  3451 01  dfheiblk.
  3452     02  eibtime          pic s9(7) comp-3.
  3453     02  eibdate          pic s9(7) comp-3.
  3454     02  eibtrnid         pic x(4).
  3455     02  eibtaskn         pic s9(7) comp-3.
  3456     02  eibtrmid         pic x(4).
  3457     02  dfheigdi         pic s9(4) comp.
  3458     02  eibcposn         pic s9(4) comp.
  3459     02  eibcalen         pic s9(4) comp.
  3460     02  eibaid           pic x(1).
  3461     02  eibfiller1       pic x(1).
  3462     02  eibfn            pic x(2).
  3463     02  eibfiller2       pic x(2).
  3464     02  eibrcode         pic x(6).
  3465     02  eibfiller3       pic x(2).
  3466     02  eibds            pic x(8).
  3467     02  eibreqid         pic x(8).
  3468     02  eibrsrce         pic x(8).
  3469     02  eibsync          pic x(1).
  3470     02  eibfree          pic x(1).
  3471     02  eibrecv          pic x(1).
  3472     02  eibsend          pic x(1).
  3473     02  eibatt           pic x(1).
  3474     02  eibeoc           pic x(1).
  3475     02  eibfmh           pic x(1).
  3476     02  eibcompl         pic x(1).
  3477     02  eibsig           pic x(1).
  3478     02  eibconf          pic x(1).
  3479     02  eiberr           pic x(1).
  3480     02  eibrldbk         pic x(1).
  3481     02  eiberrcd         pic x(4).
  3482     02  eibsynrb         pic x(1).
  3483     02  eibnodat         pic x(1).
  3484     02  eibfiller5       pic x(2).
  3485     02  eibresp          pic 9(09) comp.
  3486     02  eibresp2         pic 9(09) comp.
  3487     02  dfheigdj         pic s9(4) comp.
  3488     02  dfheigdk         pic s9(4) comp.
  3489 01  DFHCOMMAREA.
  3490   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3491   05 LSTN-NAME                PIC X(8).
  3492   05 LSTN-SUBNAME             PIC X(8).
  3493   05 CLIENT-IN-DATA.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  62
* SOCK00.cbl
  3494      15  CLIENT-CAR           PIC X.
  3495      15  CLIENT-GRP           PIC X(6).
  3496      15  CLIENT-ST            PIC XX.
  3497      15  CLIENT-ACT           PIC X(10).
  3498      15  CLIENT-ID            PIC XXX.
  3499      15  FILLER               PIC X(14).
  3500   05 SOCKADDR-IN-PARM.
  3501     15 SIN-FAMILY             PIC 9(4) COMP.
  3502     15 SIN-PORT               PIC 9(4) COMP.
  3503     15 SIN-ADDRESS            PIC 9(8) COMP.
  3504     15 SIN-ZERO               PIC X(8).
  3505 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3506 0000-DFHEXIT SECTION.
  3507     MOVE '9#                    $   ' TO DFHEIV0.
  3508     MOVE 'SOCK00' TO DFHEIV1.
  3509     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3510*
  3511* when calling a C function the function returns its value
  3512* in the system variable return code.
  3513*
  3514 start-here.
  3515*
  3516* data with transaction
  3517*
  3518     display 'SOCK00:transaction data =', CLIENT-IN-DATA.
  3519     display 'SOCK00:socket number    =', GIVE-TAKE-SOCKET.
  3520     IF CLIENT-IN-DATA (1:4) = "RATE"
  3521        SET GET-RATES            TO TRUE
  3522     ELSE
  3523        IF CLIENT-IN-DATA (1:5) = "STATE"
  3524           SET GET-ACT-ACCTS     TO TRUE
  3525        END-IF
  3526     END-IF
  3527     IF CLIENT-ID = 'AHL'
  3528        MOVE X'06'               TO WS-COMP-CD
  3529        MOVE 'AHL'               TO WS-SEND-BUF (5:3)
  3530                                    WS-COMP-ID
  3531     ELSE
  3532        IF CLIENT-ID = 'DCC'
  3533           MOVE X'05'            TO WS-COMP-CD
  3534           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3535                                    WS-COMP-ID
  3536        ELSE
  3537           IF CLIENT-ID = 'VPP'
  3538              MOVE X'07'         TO WS-COMP-CD
  3539              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  3540                                    WS-COMP-ID
  3541           ELSE
  3542              MOVE X'04'         TO WS-COMP-CD
  3543              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3544                                    WS-COMP-ID
  3545           END-IF
  3546        END-IF
  3547     END-IF
  3548     move 'CSO'                  to ws-send-buf (1:3)
  3549     move +25                    to ws-send-msg-size
  3550* send data
  3551*
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  63
* SOCK00.cbl
  3552     display 'SOCK00:sequence number  =', ws-seq-num.
  3553     display 'SOCK00:send buffer      =', ws-send-buf(1:25).
  3554     call "send" using by value GIVE-TAKE-SOCKET,
  3555         by reference ws-send-buf,
  3556         by value ws-send-msg-size,
  3557         by value ws-flags.
  3558     if return-code <= zero
  3559         display 'SOCK00:send error ',
  3560         go to socket-error.
  3561*
  3562* set up the receive buffer
  3563*
  3564     move low-values to ws-recv-buf.
  3565     set ws-recv-total to zero.
  3566     compute ws-recv-left = ws-recv-msg-size.
  3567*
  3568* receive data
  3569*
  3570     display 'SOCK00:About to recv '
  3571     call "recv" using by value GIVE-TAKE-SOCKET,
  3572         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3573         by value ws-recv-left,
  3574         by value ws-flags.
  3575*
  3576* test what was received and decide what we should do
  3577*
  3578     if return-code < zero
  3579        display 'SOCK00:recv error ',
  3580        go to socket-error.
  3581     if return-code = zero
  3582        display 'SOCK00:client disconnected',
  3583        go to socket-error.
  3584*
  3585     display 'SOCK00:Good recv  '
  3586     display 'SOCK00:return code      = ', return-code
  3587     display 'SOCK00:receive buffer   = ', ws-recv-buf(1:50)
  3588     move +4096                  to ws-send-msg-size
  3589*    move +750                   to ws-send-msg-size
  3590     if get-rates
  3591        perform 0300-get-rates   thru 0300-exit
  3592     end-if
  3593     IF GET-ACT-ACCTS
  3594        PERFORM 0400-GET-ACT-ACCTS
  3595                                 THRU 0400-EXIT
  3596     END-IF
  3597     move ws-recv-buf (1:19)     to client-in-data
  3598     IF (CLIENT-CAR NOT = ZEROS)
  3599        AND (CLIENT-ST NOT = ZEROS)
  3600        PERFORM 0500-GET-ONE-ACCT
  3601                                 THRU 0500-EXIT
  3602     END-IF
  3603     MOVE ' '                    TO WS-BUILD-SW
  3604     MOVE CLIENT-ACT             TO WS-AM-ALT-ACCOUNT
  3605     MOVE LOW-VALUES             TO WS-AM-ALT-EXP-DT
  3606     PERFORM 0010-STARTBR-ERACCT THRU 0010-EXIT
  3607     IF NOT RESP-NORMAL
  3608        MOVE 'BAD STARTBR ON ERACCT  '
  3609                                 TO WS-SEND-BUF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  64
* SOCK00.cbl
  3610        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3611        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3612        GO TO SEND-BUFFER
  3613     END-IF
  3614     PERFORM 0020-READNEXT-ERACCT
  3615                                 THRU 0020-EXIT
  3616     IF (NOT RESP-NORMAL)
  3617        OR (AM-ACCOUNT NOT = CLIENT-ACT)
  3618        MOVE 'BAD READNEXT ON ERACCT '
  3619                                 TO WS-SEND-BUF
  3620        MOVE WS-RESPONSE         TO WS-DIS-RESP
  3621        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  3622        GO TO SEND-BUFFER
  3623     ELSE
  3624        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  3625     END-IF
  3626     PERFORM UNTIL
  3627        (TIME-TO-BUILD)
  3628        IF AM-ACCOUNT = CLIENT-ACT
  3629         IF (AM-STATE = CLIENT-ST)
  3630                 OR
  3631            (CLIENT-ST = 00)
  3632           IF AM-EXPIRATION-DT = HIGH-VALUES
  3633              SET TIME-TO-BUILD  TO TRUE
  3634           ELSE
  3635              MOVE ACCOUNT-MASTER
  3636                                 TO WS-SAVE-ERACCT
  3637              PERFORM 0020-READNEXT-ERACCT
  3638                                 THRU 0020-EXIT
  3639              IF NOT RESP-NORMAL
  3640                 MOVE WS-SAVE-ERACCT
  3641                                 TO ACCOUNT-MASTER
  3642                 SET TIME-TO-BUILD
  3643                                 TO TRUE
  3644              END-IF
  3645           END-IF
  3646         ELSE
  3647          PERFORM 0020-READNEXT-ERACCT
  3648                            THRU 0020-EXIT
  3649         END-IF
  3650        ELSE
  3651           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  3652           SET TIME-TO-BUILD     TO TRUE
  3653        END-IF
  3654     END-PERFORM
  3655     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3656     .
  3657*
  3658* send data
  3659*
  3660 SEND-BUFFER.
  3661     display 'SOCK00:About to send      '
  3662     display 'SOCK00:sequence number  =', ws-seq-num.
  3663     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  3664     call "send" using by value GIVE-TAKE-SOCKET,
  3665         by reference ws-send-buf,
  3666         by value ws-send-msg-size,
  3667         by value ws-flags.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  65
* SOCK00.cbl
  3668     if return-code <= zero
  3669         display 'SOCK00:send error ',
  3670         go to socket-error.
  3671     GO TO SOCKET-FIN
  3672*
  3673* set up the receive buffer
  3674*
  3675     move low-values to ws-recv-buf.
  3676     set ws-recv-total to zero.
  3677     compute ws-recv-left = ws-recv-msg-size.
  3678*
  3679* receive data
  3680*
  3681 recv-1.
  3682     call "recv" using by value GIVE-TAKE-SOCKET,
  3683         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3684         by value ws-recv-left,
  3685         by value ws-flags.
  3686*
  3687* test what was received and decide what we should do
  3688*
  3689     if return-code < zero
  3690        display 'SOCK00:recv error ',
  3691        go to socket-error.
  3692     if return-code = zero
  3693        display 'SOCK00:client disconnected',
  3694        go to socket-error.
  3695*
  3696* have we received all the data yet?
  3697*
  3698     compute ws-recv-total = ws-recv-total + return-code.
  3699     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3700*
  3701* not yet
  3702*
  3703     if ws-recv-left > 0 go to recv-1.
  3704*
  3705* received all the data
  3706*
  3707     display 'SOCK00:receive buffer   =', ws-recv-buf(1:50).
  3708*
  3709* make sure what we received was what we sent
  3710*
  3711*    if ws-recv-buf <> ws-send-buf
  3712*        display "SOCK00:data doesn't match",
  3713*        go to socket-error.
  3714*
  3715* end of pass
  3716*
  3717*loop-end.
  3718*    if ws-seq-num = 5 go to socket-error.
  3719*    go to loop-1.
  3720*
  3721* program end
  3722*
  3723 socket-error.
  3724     if ws-seq-num <> 0
  3725         display "SOCK00:did not complete".
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  66
* SOCK00.cbl
  3726*
  3727* flush the send buffer and deallocate
  3728*
  3729*    display 'SOCK00:closing socket'.
  3730*    call "close" using by value GIVE-TAKE-SOCKET .
  3731*
  3732* finised return to cics
  3733*
  3734 socket-fin.
  3735*    display 'SOCK00:closing socket'.
  3736*    call "close" using by value GIVE-TAKE-SOCKET .
  3737     display 'SOCK00:done'.
  3738
  3739* exec cics return end-exec.
  3740*    MOVE '.(                    ''   #00003734' TO DFHEIV0
  3741     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3743     MOVE X'2020233030303033373334' TO DFHEIV0(25:11)
  3744     CALL 'kxdfhei1' USING DFHEIV0,
  3745           DFHEIV99,
  3746           DFHEIV99,
  3747           DFHEIV99,
  3748           DFHEIV99,
  3749           DFHEIV99,
  3750           DFHEIV99
  3751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3752
  3753
  3754* goback.
  3755     MOVE '9%                    "   ' TO DFHEIV0
  3756     MOVE 'SOCK00' TO DFHEIV1
  3757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3758     goback.
  3759 0010-STARTBR-ERACCT.
  3760
  3761* EXEC CICS STARTBR
  3762*         DATASET    ('ERACCT3')
  3763*         RIDFLD     (WS-AM-ALT-KEY)
  3764*         GENERIC
  3765*         GTEQ
  3766*         KEYLENGTH  (10)
  3767*         RESP       (WS-RESPONSE)
  3768*    END-EXEC
  3769     MOVE 'ERACCT3' TO DFHEIV1
  3770     MOVE 10
  3771       TO DFHEIV11
  3772     MOVE 0
  3773       TO DFHEIV12
  3774*    MOVE '&,   KG    G          &  N#00003737' TO DFHEIV0
  3775     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3777     MOVE X'204E233030303033373337' TO DFHEIV0(25:11)
  3778     CALL 'kxdfhei1' USING DFHEIV0,
  3779           DFHEIV1,
  3780           WS-AM-ALT-KEY,
  3781           DFHEIV11,
  3782           DFHEIV12,
  3783           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  67
* SOCK00.cbl
  3784     MOVE EIBRESP  TO WS-RESPONSE
  3785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3786     .
  3787 0010-EXIT.
  3788     EXIT.
  3789 0020-READNEXT-ERACCT.
  3790
  3791* EXEC CICS READNEXT
  3792*         INTO    (ACCOUNT-MASTER)
  3793*         DATASET ('ERACCT3')
  3794*         RIDFLD  (WS-AM-ALT-KEY)
  3795*         RESP    (WS-RESPONSE)
  3796*    END-EXEC
  3797     MOVE LENGTH OF
  3798      ACCOUNT-MASTER
  3799       TO DFHEIV12
  3800     MOVE 'ERACCT3' TO DFHEIV1
  3801     MOVE 0
  3802       TO DFHEIV11
  3803*    MOVE '&.IL                  )  N#00003749' TO DFHEIV0
  3804     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3805     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3806     MOVE X'204E233030303033373439' TO DFHEIV0(25:11)
  3807     CALL 'kxdfhei1' USING DFHEIV0,
  3808           DFHEIV1,
  3809           ACCOUNT-MASTER,
  3810           DFHEIV12,
  3811           WS-AM-ALT-KEY,
  3812           DFHEIV99,
  3813           DFHEIV11,
  3814           DFHEIV99,
  3815           DFHEIV99
  3816     MOVE EIBRESP  TO WS-RESPONSE
  3817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3818     .
  3819 0020-EXIT.
  3820     EXIT.
  3821 0030-BUILD-BUFFER.
  3822     PERFORM 0100-BUILD-ERACCT-STUFF
  3823                                 THRU 0100-EXIT
  3824     MOVE SPACES                 TO WS-SEND-BUF
  3825     EVALUATE AM-STATUS
  3826        WHEN '1'
  3827           MOVE 'I'              TO WS-STATUS
  3828        WHEN '2'
  3829           MOVE 'T'              TO WS-STATUS
  3830        WHEN '3'
  3831           MOVE 'C'              TO WS-STATUS
  3832        WHEN '4'
  3833           MOVE 'I'              TO WS-STATUS
  3834        WHEN '5'
  3835           MOVE 'S'              TO WS-STATUS
  3836        WHEN '6'
  3837           MOVE 'D'              TO WS-STATUS
  3838        WHEN '7'
  3839           MOVE 'L'              TO WS-STATUS
  3840        WHEN '8'
  3841           MOVE 'R'              TO WS-STATUS
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  68
* SOCK00.cbl
  3842        WHEN '9'
  3843           MOVE 'P'              TO WS-STATUS
  3844        WHEN OTHER
  3845           MOVE 'A'              TO WS-STATUS
  3846     END-EVALUATE
  3847     IF AM-REMIT-TO NOT NUMERIC
  3848        MOVE ZEROS         TO AM-REMIT-TO
  3849     END-IF
  3850     IF AM-REMIT-TO = ZEROS
  3851        MOVE 01        TO AM-REMIT-TO
  3852     END-IF
  3853     MOVE AM-AGT (AM-REMIT-TO) TO WS-FIN-RESP
  3854     MOVE SPACES                 TO WS-AM-CITY-STATE
  3855     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3856        DELIMITED BY '  ' INTO WS-AM-CITY-STATE
  3857     END-STRING
  3858     IF NOT GET-ACT-ACCTS
  3859* this is when a single account is selected
  3860       STRING
  3861        AM-ACCOUNT      ';'
  3862        WS-LONG-ACCT-NAME    ';'
  3863        WS-CONTR-NAME   ';'
  3864        AM-ADDRS        ';'
  3865        WS-AM-CITY-STATE ';'
  3866        AM-ZIP          ';'
  3867        AM-GPCD         ';'
  3868        WS-EFF-DATE     ';'
  3869        WS-EXP-DATE     ';'
  3870        WS-POLICY-NO    ';'
  3871        WS-SL-COMM      ';'
  3872        WS-JL-COMM      ';'
  3873        WS-SAH-COMM     ';'
  3874        WS-JAH-COMM     ';'
  3875        WS-CID-NO       ';'
  3876        AM-STATE        ';'
  3877        WS-GA-NUM       ';'
  3878        WS-GA-PRIMARY-CONTACT ';'
  3879        WS-GA-NAME      ';'
  3880        WS-GA-MAIL-NAME ';'
  3881        WS-GA-ADDR1     ';'
  3882        WS-GA-ADDR2     ';'
  3883        WS-GA-ADDR3     ';'
  3884        WS-GA-ZIP       ';'
  3885        WS-GA-PHONE     ';'
  3886        AM-CONTROL-NAME ';'
  3887        WS-ORIG-EFF-DT  ';'
  3888        AM-COMMENT-LINE (1) ';'
  3889        AM-COMMENT-LINE (2) ';'
  3890        AM-COMMENT-LINE (3) ';'
  3891        AM-COMMENT-LINE (4) ';'
  3892        AM-COMMENT-LINE (5) ';'
  3893        AM-TEL-NO       ';'
  3894        AM-REPORT-CODE-1    ';'
  3895        AM-REPORT-CODE-2    ';'
  3896        WS-STATUS           ';'
  3897        AM-REPORT-CODE-3    ';'
  3898        AM-USER-SELECT-2    ';'
  3899        AM-CARRIER          ';'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  69
* SOCK00.cbl
  3900        WS-FIN-RESP         ';'
  3901        AM-USER-SELECT-3    ';'
  3902        WS-SHORT-ACCT-NAME  ';'
  3903           DELIMITED BY SIZE INTO WS-SEND-BUF
  3904       END-STRING
  3905     ELSE
  3906       STRING
  3907        AM-ACCOUNT      ';'
  3908        WS-LONG-ACCT-NAME    ';'
  3909        WS-CONTR-NAME   ';'
  3910        AM-ADDRS        ';'
  3911        WS-AM-CITY-STATE ';'
  3912        AM-ZIP          ';'
  3913        AM-GPCD         ';'
  3914        WS-EFF-DATE     ';'
  3915        WS-EXP-DATE     ';'
  3916        WS-POLICY-NO    ';'
  3917        WS-SL-COMM      ';'
  3918        WS-JL-COMM      ';'
  3919        WS-SAH-COMM     ';'
  3920        WS-JAH-COMM     ';'
  3921        WS-CID-NO       ';'
  3922        AM-STATE        ';'
  3923        WS-GA-NUM       ';'
  3924        WS-GA-PRIMARY-CONTACT ';'
  3925        WS-GA-NAME      ';'
  3926        WS-GA-MAIL-NAME ';'
  3927        WS-GA-ADDR1     ';'
  3928        WS-GA-ADDR2     ';'
  3929        WS-GA-ADDR3     ';'
  3930        WS-GA-ZIP       ';'
  3931        WS-GA-PHONE     ';'
  3932        AM-COMMENT-LINE (1) ';'
  3933        AM-COMMENT-LINE (2) ';'
  3934        AM-COMMENT-LINE (3) ';'
  3935        AM-COMMENT-LINE (4) ';'
  3936        AM-COMMENT-LINE (5) ';'
  3937        AM-CONTROL-NAME     ';'
  3938        WS-ORIG-EFF-DT      ';'
  3939        AM-TEL-NO           ';'
  3940        AM-REPORT-CODE-1    ';'
  3941        AM-REPORT-CODE-2    ';'
  3942        WS-STATUS           ';'
  3943        AM-REPORT-CODE-3    ';'
  3944        AM-USER-SELECT-2    ';'
  3945        AM-CARRIER          ';'
  3946        WS-FIN-RESP         ';'
  3947        AM-USER-SELECT-3    ';'
  3948        WS-SHORT-ACCT-NAME  ';'
  3949           DELIMITED BY SIZE INTO WS-SEND-BUF
  3950       END-STRING
  3951     END-IF
  3952     .
  3953 0030-EXIT.
  3954     EXIT.
  3955 0100-BUILD-ERACCT-STUFF.
  3956     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  3957     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  70
* SOCK00.cbl
  3958     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3959     IF NO-CONVERSION-ERROR
  3960        MOVE DC-GREG-DATE-A-EDIT TO WS-EFF-DATE
  3961     ELSE
  3962        MOVE '00/00/0000'        TO WS-EFF-DATE
  3963     END-IF
  3964     IF AM-EXPIRATION-DT = HIGH-VALUES
  3965        MOVE '99/99/9999'        TO WS-EXP-DATE
  3966     ELSE
  3967        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  3968        MOVE ' '                 TO DC-OPTION-CODE
  3969        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  3970        IF NO-CONVERSION-ERROR
  3971           MOVE DC-GREG-DATE-A-EDIT
  3972                                 TO WS-EXP-DATE
  3973        ELSE
  3974           MOVE '00/00/0000'     TO WS-EXP-DATE
  3975        END-IF
  3976     END-IF
  3977     MOVE WS-BIN-ORIG-EFF-DT     TO DC-BIN-DATE-1
  3978     MOVE ' '                    TO DC-OPTION-CODE
  3979     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  3980     IF NO-CONVERSION-ERROR
  3981        MOVE DC-GREG-DATE-A-EDIT TO WS-ORIG-EFF-DT
  3982     ELSE
  3983        MOVE '00/00/0000'        TO WS-ORIG-EFF-DT
  3984     END-IF
  3985     MOVE AM-COMMENT-LINE (2)    TO WS-POLICY-NO
  3986     PERFORM VARYING S1 FROM +7 BY +1 UNTIL
  3987        (S1 > +48)
  3988        OR (AM-COMMENT-LINE (2) (S1:3) = 'CID')
  3989     END-PERFORM
  3990     IF S1 > +48
  3991        MOVE SPACES              TO WS-CID-NO
  3992     ELSE
  3993        MOVE AM-COMMENT-LINE (2) (S1:8)
  3994                                 TO WS-CID-NO
  3995     END-IF
  3996     MOVE AM-NAME                TO WS-SHORT-ACCT-NAME
  3997                                    WS-LONG-ACCT-NAME
  3998     MOVE AM-PERSON              TO WS-CONTR-NAME
  3999*    IF AM-REPORT-CODE-3 = 'RLIC'
  4000        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4001        MOVE '3'                 TO WS-NT-REC-TYPE
  4002        MOVE +1                  TO WS-NT-SEQ-NO
  4003
  4004* EXEC CICS READ
  4005*          DATASET    ('ERACNT')
  4006*          RIDFLD     (WS-NT-KEY)
  4007*          INTO       (NOTE-FILE)
  4008*          RESP       (WS-RESPONSE)
  4009*       END-EXEC
  4010     MOVE LENGTH OF
  4011      NOTE-FILE
  4012       TO DFHEIV11
  4013     MOVE 'ERACNT' TO DFHEIV1
  4014*    MOVE '&"IL       E          (  N#00003940' TO DFHEIV0
  4015     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  71
* SOCK00.cbl
  4016     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4017     MOVE X'204E233030303033393430' TO DFHEIV0(25:11)
  4018     CALL 'kxdfhei1' USING DFHEIV0,
  4019           DFHEIV1,
  4020           NOTE-FILE,
  4021           DFHEIV11,
  4022           WS-NT-KEY,
  4023           DFHEIV99,
  4024           DFHEIV99,
  4025           DFHEIV99
  4026     MOVE EIBRESP  TO WS-RESPONSE
  4027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4028        IF RESP-NORMAL
  4029           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4030              MOVE NT-SHIPPING-LINE TO WS-LONG-ACCT-NAME
  4031           END-IF
  4032        END-IF
  4033        MOVE AM-CONTROL-PRIMARY  TO WS-NT-KEY
  4034        MOVE '3'                 TO WS-NT-REC-TYPE
  4035        MOVE +2                  TO WS-NT-SEQ-NO
  4036
  4037* EXEC CICS READ
  4038*          DATASET    ('ERACNT')
  4039*          RIDFLD     (WS-NT-KEY)
  4040*          INTO       (NOTE-FILE)
  4041*          RESP       (WS-RESPONSE)
  4042*       END-EXEC
  4043     MOVE LENGTH OF
  4044      NOTE-FILE
  4045       TO DFHEIV11
  4046     MOVE 'ERACNT' TO DFHEIV1
  4047*    MOVE '&"IL       E          (  N#00003954' TO DFHEIV0
  4048     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4049     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4050     MOVE X'204E233030303033393534' TO DFHEIV0(25:11)
  4051     CALL 'kxdfhei1' USING DFHEIV0,
  4052           DFHEIV1,
  4053           NOTE-FILE,
  4054           DFHEIV11,
  4055           WS-NT-KEY,
  4056           DFHEIV99,
  4057           DFHEIV99,
  4058           DFHEIV99
  4059     MOVE EIBRESP  TO WS-RESPONSE
  4060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4061        IF RESP-NORMAL
  4062           IF NT-SHIPPING-LINE NOT = SPACES AND LOW-VALUES
  4063              MOVE NT-SHIPPING-LINE TO WS-CONTR-NAME
  4064           END-IF
  4065        END-IF
  4066*    END-IF
  4067     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4068        (S1 > +10)
  4069        OR (AM-COM-TYP (S1) = 'D' OR 'C')
  4070     END-PERFORM
  4071     IF S1 > +10
  4072        CONTINUE
  4073     ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  72
* SOCK00.cbl
  4074        PERFORM 0150-BUILD-DW-COMM
  4075                                 THRU 0150-EXIT
  4076     END-IF
  4077     MOVE SPACES                 TO WS-GA-DATA
  4078     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4079        (S1 > +10)
  4080        OR (AM-COM-TYP (S1) = 'O' OR 'P' OR 'K' OR 'S')
  4081     END-PERFORM
  4082     IF S1 > +10
  4083        MOVE ZEROS               TO WS-GA-NUM
  4084     ELSE
  4085        MOVE AM-AGT (S1)         TO WS-GA-NUM
  4086     END-IF
  4087     IF WS-GA-NUM NOT = ZEROS
  4088        PERFORM 0200-GET-ERCOMP  THRU 0200-EXIT
  4089     END-IF
  4090     .
  4091 0100-EXIT.
  4092     EXIT.
  4093 0150-BUILD-DW-COMM.
  4094     MOVE ZEROS                  TO WS-SL-COMM
  4095                                    WS-JL-COMM
  4096                                    WS-SAH-COMM
  4097                                    WS-JAH-COMM
  4098                                    WS-WORK-SAH-COMM
  4099                                    WS-WORK-JAH-COMM
  4100     IF (AM-L-COM (S1) NOT NUMERIC)
  4101        OR (AM-L-COMA (S1) (3:1) = 'L' OR 'M')
  4102        CONTINUE
  4103     ELSE
  4104        MOVE AM-L-COM (S1)       TO WS-SL-COMM
  4105     END-IF
  4106     IF (AM-J-COM (S1) NOT NUMERIC)
  4107        OR (AM-J-COMA (S1) (3:1) = 'L' OR 'M')
  4108        CONTINUE
  4109     ELSE
  4110        MOVE AM-J-COM (S1)       TO WS-JL-COMM
  4111     END-IF
  4112     IF (AM-A-COM (S1) NOT NUMERIC)
  4113        OR (AM-A-COMA (S1) (3:1) = 'L' OR 'M')
  4114        PERFORM 0160-ERCTBL-STARTBR
  4115                                 THRU 0160-EXIT
  4116        IF RESP-NORMAL
  4117           PERFORM 0165-ERCTBL-READNEXT
  4118                                 THRU 0165-EXIT
  4119           UNTIL
  4120           ((WS-WORK-SAH-COMM NOT = ZEROS)
  4121            AND (WS-WORK-JAH-COMM NOT = ZEROS))
  4122                       OR
  4123            END-OF-ERCTBL
  4124            MOVE WS-WORK-JAH-COMM TO WS-JAH-COMM
  4125            MOVE WS-WORK-SAH-COMM TO WS-SAH-COMM
  4126        END-IF
  4127     ELSE
  4128        MOVE AM-A-COM (S1)       TO WS-SAH-COMM
  4129                                    WS-JAH-COMM
  4130     END-IF
  4131     .
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  73
* SOCK00.cbl
  4132 0150-EXIT.
  4133     EXIT.
  4134 0160-ERCTBL-STARTBR.
  4135     MOVE AM-COMPANY-CD          TO WS-CT-COMPANY-CD
  4136     MOVE AM-A-COMA (S1)         TO WS-CT-TABLE
  4137     MOVE 'A'                    TO WS-CT-BEN-TYPE
  4138     MOVE LOW-VALUES             TO WS-CT-BEN-CODE
  4139     MOVE WS-CT-KEY              TO WS-CT-KEY-SAVE
  4140
  4141* EXEC CICS STARTBR
  4142*         DATASET    ('ERCTBL')
  4143*         RIDFLD     (WS-CT-KEY)
  4144*         GTEQ
  4145*         RESP       (WS-RESPONSE)
  4146*    END-EXEC
  4147     MOVE 'ERCTBL' TO DFHEIV1
  4148     MOVE 0
  4149       TO DFHEIV11
  4150*    MOVE '&,         G          &  N#00004039' TO DFHEIV0
  4151     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4152     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4153     MOVE X'204E233030303034303339' TO DFHEIV0(25:11)
  4154     CALL 'kxdfhei1' USING DFHEIV0,
  4155           DFHEIV1,
  4156           WS-CT-KEY,
  4157           DFHEIV99,
  4158           DFHEIV11,
  4159           DFHEIV99
  4160     MOVE EIBRESP  TO WS-RESPONSE
  4161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4162     .
  4163 0160-EXIT.
  4164     EXIT.
  4165 0165-ERCTBL-READNEXT.
  4166
  4167* EXEC CICS READNEXT
  4168*         INTO    (COMM-TABLE-RECORD)
  4169*         DATASET ('ERCTBL')
  4170*         RIDFLD  (WS-CT-KEY)
  4171*         RESP    (WS-RESPONSE)
  4172*    END-EXEC
  4173     MOVE LENGTH OF
  4174      COMM-TABLE-RECORD
  4175       TO DFHEIV12
  4176     MOVE 'ERCTBL' TO DFHEIV1
  4177     MOVE 0
  4178       TO DFHEIV11
  4179*    MOVE '&.IL                  )  N#00004049' TO DFHEIV0
  4180     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4182     MOVE X'204E233030303034303439' TO DFHEIV0(25:11)
  4183     CALL 'kxdfhei1' USING DFHEIV0,
  4184           DFHEIV1,
  4185           COMM-TABLE-RECORD,
  4186           DFHEIV12,
  4187           WS-CT-KEY,
  4188           DFHEIV99,
  4189           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  74
* SOCK00.cbl
  4190           DFHEIV99,
  4191           DFHEIV99
  4192     MOVE EIBRESP  TO WS-RESPONSE
  4193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4194     IF (RESP-NORMAL)
  4195        AND (WS-CT-KEY (1:5) = WS-CT-KEY-SAVE (1:5))
  4196        PERFORM 0170-PROCESS-BEN-CODE
  4197                                 THRU 0170-EXIT
  4198     ELSE
  4199        SET END-OF-ERCTBL        TO TRUE
  4200     END-IF
  4201     .
  4202 0165-EXIT.
  4203     EXIT.
  4204 0170-PROCESS-BEN-CODE.
  4205     MOVE SPACES                 TO WS-CF-KEY
  4206     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4207     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4208     MOVE CT-BEN-CODE            TO WS-CF-ACCESS (3:2)
  4209     MOVE +0                     TO WS-CF-SEQ-NO
  4210     MOVE WS-CF-KEY              TO WS-CF-KEY-SAVE
  4211
  4212* EXEC CICS READ
  4213*         DATASET    ('ELCNTL')
  4214*         RIDFLD     (WS-CF-KEY)
  4215*         INTO       (CONTROL-FILE)
  4216*         GTEQ
  4217*         RESP       (WS-RESPONSE)
  4218*    END-EXEC
  4219     MOVE LENGTH OF
  4220      CONTROL-FILE
  4221       TO DFHEIV11
  4222     MOVE 'ELCNTL' TO DFHEIV1
  4223*    MOVE '&"IL       G          (  N#00004072' TO DFHEIV0
  4224     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4226     MOVE X'204E233030303034303732' TO DFHEIV0(25:11)
  4227     CALL 'kxdfhei1' USING DFHEIV0,
  4228           DFHEIV1,
  4229           CONTROL-FILE,
  4230           DFHEIV11,
  4231           WS-CF-KEY,
  4232           DFHEIV99,
  4233           DFHEIV99,
  4234           DFHEIV99
  4235     MOVE EIBRESP  TO WS-RESPONSE
  4236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4237     IF NOT RESP-NORMAL
  4238        MOVE WS-RESPONSE         TO WS-DISP-RESP
  4239        DISPLAY ' ERROR - ELCNTL - READ ' WS-DISP-RESP
  4240        GO TO 0170-EXIT
  4241     END-IF
  4242     IF WS-CF-KEY (1:4) = WS-CF-KEY-SAVE (1:4)
  4243        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  4244           (S2 > +8)
  4245           OR (CT-BEN-CODE = CF-BENEFIT-CODE (S2))
  4246        END-PERFORM
  4247        IF CT-BEN-CODE = CF-BENEFIT-CODE (S2)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  75
* SOCK00.cbl
  4248           IF CF-JOINT-INDICATOR (S2) = 'J'
  4249              IF WS-WORK-JAH-COMM = ZEROS
  4250                 MOVE CT-RT (1)  TO WS-WORK-JAH-COMM
  4251              END-IF
  4252           ELSE
  4253              IF WS-WORK-SAH-COMM = ZEROS
  4254                 MOVE CT-RT (1)  TO WS-WORK-SAH-COMM
  4255              END-IF
  4256           END-IF
  4257        END-IF
  4258     END-IF
  4259     .
  4260 0170-EXIT.
  4261     EXIT.
  4262 0200-GET-ERCOMP.
  4263     MOVE LOW-VALUES             TO WS-CO-KEY
  4264     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  4265     MOVE AM-CARRIER             TO WS-CO-CARRIER
  4266     MOVE AM-GROUPING            TO WS-CO-GROUP
  4267     MOVE WS-GA-NUM              TO WS-CO-FIN-RESP
  4268     MOVE LOW-VALUES             TO WS-CO-ACCOUNT
  4269     MOVE 'G'                    TO WS-CO-TYPE
  4270
  4271* EXEC CICS READ
  4272*         INTO    (COMPENSATION-MASTER)
  4273*         DATASET ('ERCOMP')
  4274*         RIDFLD  (WS-CO-KEY)
  4275*         RESP    (WS-RESPONSE)
  4276*    END-EXEC
  4277     MOVE LENGTH OF
  4278      COMPENSATION-MASTER
  4279       TO DFHEIV11
  4280     MOVE 'ERCOMP' TO DFHEIV1
  4281*    MOVE '&"IL       E          (  N#00004112' TO DFHEIV0
  4282     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4284     MOVE X'204E233030303034313132' TO DFHEIV0(25:11)
  4285     CALL 'kxdfhei1' USING DFHEIV0,
  4286           DFHEIV1,
  4287           COMPENSATION-MASTER,
  4288           DFHEIV11,
  4289           WS-CO-KEY,
  4290           DFHEIV99,
  4291           DFHEIV99,
  4292           DFHEIV99
  4293     MOVE EIBRESP  TO WS-RESPONSE
  4294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4295     IF RESP-NORMAL
  4296        MOVE CO-CONTROL-NAME     TO WS-GA-PRIMARY-CONTACT
  4297        MOVE CO-ACCT-NAME        TO WS-GA-NAME
  4298        MOVE CO-MAIL-NAME        TO WS-GA-MAIL-NAME
  4299        MOVE CO-ADDR-1           TO WS-GA-ADDR1
  4300        MOVE CO-ADDR-2           TO WS-GA-ADDR2
  4301*       MOVE CO-ADDR-3           TO WS-GA-ADDR3
  4302        MOVE SPACES              TO WS-GA-ADDR3
  4303        STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  4304           DELIMITED BY '  ' INTO WS-GA-ADDR3
  4305        END-STRING
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  76
* SOCK00.cbl
  4306        MOVE CO-ZIP              TO WS-GA-ZIP
  4307        MOVE CO-TELEPHONE        TO WS-GA-PHONE
  4308     ELSE
  4309        MOVE SPACES              TO WS-GA-DATA
  4310        MOVE 'GA NOT FOUND '     TO WS-GA-NAME
  4311     END-IF
  4312     .
  4313 0200-EXIT.
  4314     EXIT.
  4315 0300-get-rates.
  4316     move +30                    to ws-send-msg-size
  4317     move ws-recv-buf (1:31)     to ws-get-rate-data
  4318     if rate-apr not numeric
  4319        move zeros               to rate-apr
  4320     end-if
  4321     move rate-apr               to ws-work-apr
  4322     if rate-ben-amt not numeric
  4323        move zeros               to rate-ben-amt
  4324     end-if
  4325     move rate-ben-amt           to ws-work-ben
  4326     if rate-term not numeric
  4327        move zeros               to rate-term
  4328     end-if
  4329     move rate-term              to ws-work-term
  4330     move rate-eff-date (7:4)    to ws-work-date (1:4)
  4331     move rate-eff-date (1:2)    to ws-work-date (5:2)
  4332     move rate-eff-date (4:2)    to ws-work-date (7:2)
  4333     move ws-work-date-num       to dc-greg-date-cymd
  4334     move 'L'                    to dc-option-code
  4335     perform 9700-date-link      thru 9700-exit
  4336     if no-conversion-error
  4337        move dc-bin-date-1       to ws-bin-eff-dt
  4338     else
  4339        move 'bad eff dt convert ' to ws-send-buf
  4340        go to send-rate-buf
  4341     end-if
  4342     move +1                     to dc-elapsed-months
  4343     move +0                     to dc-elapsed-days
  4344     move '6'                    to dc-option-code
  4345     perform 9700-date-link      thru 9700-exit
  4346     if no-conversion-error
  4347        move dc-bin-date-2       to ws-bin-1st-pay-dt
  4348     else
  4349        move 'bad 1st dt convert ' to ws-send-buf
  4350        go to send-rate-buf
  4351     end-if
  4352*    move spaces                 to calculation-pass-area
  4353     move zeros                  to cp-r-max-mon-ben
  4354                                    cp-r-max-tot-ben
  4355                                    cp-class-code
  4356                                    cp-deviation-code
  4357                                    cp-rate-dev-pct
  4358                                    cp-original-premium
  4359                                    cp-critical-months
  4360                                    cp-term-or-ext-days
  4361     move rate-state             to cp-state
  4362                                    cp-state-std-abbrv
  4363     move rate-lf-ah             to cp-benefit-type
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  77
* SOCK00.cbl
  4364     move rate-ben-code          to cp-benefit-cd
  4365     move ws-ben-num             to cp-original-benefit
  4366                                    cp-rating-benefit-amt
  4367     move 40                     to cp-issue-age
  4368     move WS-COMP-ID             to cp-company-id
  4369     move WS-COMP-CD             to cp-company-cd
  4370     move ws-apr-num             to cp-loan-apr
  4371     move ws-term-num            to cp-original-term
  4372                                    cp-loan-term
  4373                                    cp-remaining-term
  4374     move 'L'                    to cp-life-override-code
  4375     move 'A'                    to cp-ah-override-code
  4376     move '3'                    to cp-process-type
  4377     move rate-earn-meth         to cp-earning-method
  4378                                    cp-rating-method
  4379     move 'R'                    to cp-rate-file
  4380     move ws-bin-eff-dt          to cp-cert-eff-dt
  4381     move ws-bin-1st-pay-dt      to cp-first-pay-date
  4382     PERFORM 7000-GET-RATE       THRU 7000-EXIT
  4383     if not no-cp-error
  4384        move cp-return-code      to ws-send-buf
  4385     else
  4386        move cp-calc-premium     to ws-disp-amt
  4387        move cp-premium-rate     to ws-disp-rate
  4388        string ws-disp-amt ';' ws-disp-rate delimited
  4389           by size into ws-send-buf
  4390        end-string
  4391     end-if
  4392     .
  4393 SEND-RATE-BUF.
  4394     display 'SOCK00:About to send      '
  4395     display 'SOCK00:sequence number  =', ws-seq-num.
  4396     display 'SOCK00:send buffer      =', ws-send-buf(1:30).
  4397     call "send" using by value GIVE-TAKE-SOCKET,
  4398         by reference ws-send-buf,
  4399         by value ws-send-msg-size,
  4400         by value ws-flags.
  4401     if return-code <= zero
  4402         display 'SOCK00:send error ',
  4403         go to socket-error.
  4404     GO TO SOCKET-FIN
  4405     .
  4406 0300-exit.
  4407     exit.
  4408 0400-GET-ACT-ACCTS.
  4409     MOVE WS-RECV-BUF (1:2)      TO CLIENT-ST
  4410     MOVE ' '                    TO WS-BUILD-SW
  4411     MOVE LOW-VALUES             TO WS-AM-KEY
  4412     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4413     PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4414     IF NOT RESP-NORMAL
  4415        MOVE 'BAD STARTBR ON ERACCT  '
  4416                                 TO WS-SEND-BUF
  4417        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4418        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4419        GO TO SEND-BUFFER
  4420     END-IF
  4421     PERFORM 0420-READNEXT-ERACCT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  78
* SOCK00.cbl
  4422                                 THRU 0420-EXIT
  4423     IF NOT RESP-NORMAL
  4424        MOVE 'BAD READNEXT ON ERACCT '
  4425                                 TO WS-SEND-BUF
  4426        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4427        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4428        GO TO SEND-BUFFER
  4429     ELSE
  4430        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4431        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4432     END-IF
  4433     PERFORM UNTIL END-OF-ERACCT
  4434        IF NOT (RESP-NORMAL)
  4435           OR (AM-COMPANY-CD > WS-COMP-CD)
  4436           SET END-OF-ERACCT     TO TRUE
  4437        ELSE
  4438           IF AM-ACCOUNT NOT = WS-SAVE-ACCOUNT
  4439              MOVE AM-EFFECTIVE-DT TO WS-BIN-ORIG-EFF-DT
  4440           END-IF
  4441           IF (AM-STATE = CLIENT-ST)
  4442              AND (AM-EXPIRATION-DT = HIGH-VALUES)
  4443*             AND (AM-STATUS = '0')
  4444              PERFORM 0030-BUILD-BUFFER
  4445                                 THRU 0030-EXIT
  4446              PERFORM 0430-SEND-BUFFER
  4447                                 THRU 0430-EXIT
  4448           END-IF
  4449           PERFORM 0420-READNEXT-ERACCT
  4450                                 THRU 0420-EXIT
  4451        END-IF
  4452     END-PERFORM
  4453     GO TO SOCKET-FIN
  4454     .
  4455 0400-EXIT.
  4456     EXIT.
  4457 0410-STARTBR-ERACCT.
  4458
  4459* EXEC CICS STARTBR
  4460*         DATASET    ('ERACCT')
  4461*         RIDFLD     (WS-AM-KEY)
  4462*         GTEQ
  4463*         RESP       (WS-RESPONSE)
  4464*    END-EXEC
  4465     MOVE 'ERACCT' TO DFHEIV1
  4466     MOVE 0
  4467       TO DFHEIV11
  4468*    MOVE '&,         G          &  N#00004281' TO DFHEIV0
  4469     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4470     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4471     MOVE X'204E233030303034323831' TO DFHEIV0(25:11)
  4472     CALL 'kxdfhei1' USING DFHEIV0,
  4473           DFHEIV1,
  4474           WS-AM-KEY,
  4475           DFHEIV99,
  4476           DFHEIV11,
  4477           DFHEIV99
  4478     MOVE EIBRESP  TO WS-RESPONSE
  4479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  79
* SOCK00.cbl
  4480     .
  4481 0410-EXIT.
  4482     EXIT.
  4483 0420-READNEXT-ERACCT.
  4484
  4485* EXEC CICS READNEXT
  4486*         INTO    (ACCOUNT-MASTER)
  4487*         DATASET ('ERACCT')
  4488*         RIDFLD  (WS-AM-KEY)
  4489*         RESP    (WS-RESPONSE)
  4490*    END-EXEC
  4491     MOVE LENGTH OF
  4492      ACCOUNT-MASTER
  4493       TO DFHEIV12
  4494     MOVE 'ERACCT' TO DFHEIV1
  4495     MOVE 0
  4496       TO DFHEIV11
  4497*    MOVE '&.IL                  )  N#00004291' TO DFHEIV0
  4498     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4499     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4500     MOVE X'204E233030303034323931' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           DFHEIV1,
  4503           ACCOUNT-MASTER,
  4504           DFHEIV12,
  4505           WS-AM-KEY,
  4506           DFHEIV99,
  4507           DFHEIV11,
  4508           DFHEIV99,
  4509           DFHEIV99
  4510     MOVE EIBRESP  TO WS-RESPONSE
  4511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4512     .
  4513 0420-EXIT.
  4514     EXIT.
  4515 0430-SEND-BUFFER.
  4516     display 'SOCK00:About to send      '
  4517     display 'SOCK00:sequence number  =', ws-seq-num.
  4518     display 'SOCK00:send buffer      =', ws-send-buf(1:300).
  4519     call "send" using by value GIVE-TAKE-SOCKET,
  4520         by reference ws-send-buf,
  4521         by value ws-send-msg-size,
  4522         by value ws-flags.
  4523     if return-code <= zero
  4524         display 'SOCK00:send error ',
  4525         go to socket-error.
  4526     .
  4527 0430-EXIT.
  4528     EXIT.
  4529 0500-GET-ONE-ACCT.
  4530     MOVE WS-COMP-CD             TO WS-AM-COMPANY-CD
  4531     MOVE CLIENT-CAR             TO WS-AM-CARRIER
  4532     MOVE CLIENT-GRP             TO WS-AM-GROUP
  4533     MOVE CLIENT-ST              TO WS-AM-STATE
  4534     MOVE CLIENT-ACT             TO WS-AM-ACCOUNT
  4535     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4536     MOVE '5'                    TO DC-OPTION-CODE
  4537     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  80
* SOCK00.cbl
  4538     MOVE DC-BIN-DATE-1          TO WS-AM-EXP-DT
  4539     MOVE LOW-VALUES             TO WS-AM-EXP-DT
  4540     MOVE ' '                    TO WS-BUILD-SW
  4541    PERFORM 0410-STARTBR-ERACCT THRU 0410-EXIT
  4542     IF NOT RESP-NORMAL
  4543        MOVE 'BAD STARTBR ON ERACCT  '
  4544                                 TO WS-SEND-BUF
  4545        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4546        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4547        GO TO SEND-BUFFER
  4548     END-IF
  4549     PERFORM 0420-READNEXT-ERACCT
  4550                                 THRU 0420-EXIT
  4551     IF NOT RESP-NORMAL
  4552        MOVE 'BAD READNEXT ON ERACCT '
  4553                                 TO WS-SEND-BUF
  4554        MOVE WS-RESPONSE         TO WS-DIS-RESP
  4555        MOVE WS-DIS-RESP         TO WS-SEND-BUF (25:5)
  4556        GO TO SEND-BUFFER
  4557     ELSE
  4558        MOVE AM-EFFECTIVE-DT     TO WS-BIN-ORIG-EFF-DT
  4559        MOVE AM-ACCOUNT          TO WS-SAVE-ACCOUNT
  4560     END-IF
  4561     PERFORM UNTIL
  4562        (TIME-TO-BUILD)
  4563        IF AM-ACCOUNT = CLIENT-ACT
  4564           IF AM-EXPIRATION-DT = HIGH-VALUES
  4565              SET TIME-TO-BUILD  TO TRUE
  4566           ELSE
  4567              MOVE ACCOUNT-MASTER
  4568                                 TO WS-SAVE-ERACCT
  4569              PERFORM 0420-READNEXT-ERACCT
  4570                                 THRU 0420-EXIT
  4571              IF NOT RESP-NORMAL
  4572                 MOVE WS-SAVE-ERACCT
  4573                                 TO ACCOUNT-MASTER
  4574                 SET TIME-TO-BUILD
  4575                                 TO TRUE
  4576              END-IF
  4577           END-IF
  4578        ELSE
  4579           MOVE WS-SAVE-ERACCT   TO ACCOUNT-MASTER
  4580           SET TIME-TO-BUILD     TO TRUE
  4581        END-IF
  4582     END-PERFORM
  4583     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4584     PERFORM 0430-SEND-BUFFER    THRU 0430-EXIT
  4585     GO TO SOCKET-FIN
  4586     .
  4587 0500-EXIT.
  4588     EXIT.
  4589 7000-GET-RATE.
  4590
  4591* EXEC CICS LINK
  4592*       PROGRAM ('ELRATE')
  4593*       COMMAREA (CALCULATION-PASS-AREA)
  4594*       LENGTH   (CP-COMM-LENGTH)
  4595*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  81
* SOCK00.cbl
  4596     MOVE 'ELRATE' TO DFHEIV1
  4597*    MOVE '."C                   (   #00004375' TO DFHEIV0
  4598     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4600     MOVE X'2020233030303034333735' TO DFHEIV0(25:11)
  4601     CALL 'kxdfhei1' USING DFHEIV0,
  4602           DFHEIV1,
  4603           CALCULATION-PASS-AREA,
  4604           CP-COMM-LENGTH,
  4605           DFHEIV99,
  4606           DFHEIV99,
  4607           DFHEIV99,
  4608           DFHEIV99
  4609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4610     .
  4611 7000-EXIT.
  4612     EXIT.
  4613 9700-DATE-LINK.
  4614
  4615* EXEC CICS LINK
  4616*         PROGRAM  ('ELDATCV')
  4617*         COMMAREA (DATE-CONVERSION-DATA)
  4618*         LENGTH   (DC-COMM-LENGTH)
  4619*    END-EXEC.
  4620     MOVE 'ELDATCV' TO DFHEIV1
  4621*    MOVE '."C                   (   #00004384' TO DFHEIV0
  4622     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4623     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4624     MOVE X'2020233030303034333834' TO DFHEIV0(25:11)
  4625     CALL 'kxdfhei1' USING DFHEIV0,
  4626           DFHEIV1,
  4627           DATE-CONVERSION-DATA,
  4628           DC-COMM-LENGTH,
  4629           DFHEIV99,
  4630           DFHEIV99,
  4631           DFHEIV99,
  4632           DFHEIV99
  4633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4634
  4635 9700-EXIT.
  4636      EXIT.
  4637
  4638 9999-DFHBACK SECTION.
  4639     MOVE '9%                    "   ' TO DFHEIV0
  4640     MOVE 'SOCK00' TO DFHEIV1
  4641     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4642     GOBACK.
  4643 9999-DFHEXIT.
  4644     IF DFHEIGDJ EQUAL 0001
  4645         NEXT SENTENCE.
  4646     MOVE '9%                    "   ' TO DFHEIV0
  4647     MOVE 'SOCK00' TO DFHEIV1
  4648     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4649     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 12:44 Page  82
* SOCK00.cbl
* Data:       16548     Code:        8808
