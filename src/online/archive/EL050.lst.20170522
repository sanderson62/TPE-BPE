* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   149*-----------------------------------------------------------------
   150
   151 01  WORK-AREAS.
   152
   153*****************************************************************
   154*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   155*****************************************************************
   156
   157     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   160     12  WS-NAME-EDIT-WORK-AREA.
   161         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   162         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   163             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   164         16  WS-WORK-NAME.
   165             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   166             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   167             20  FILLER           PIC X(10)     VALUE SPACES.
   168         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   169             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   170
   171*****************************************************************
   172*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   173*****************************************************************
   174
   175     12  WS-ERRESC-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   5
* EL050.cbl
   176         16 WS-ERRESC-SEARCH-KEY.
   177             20  WS-ERRESC-COMPANY-CD PIC  X.
   178             20  WS-ERRESC-CARRIER    PIC  X.
   179             20  WS-ERRESC-GROUP      PIC X(6).
   180             20  WS-ERRESC-STATE      PIC XX.
   181             20  WS-ERRESC-ACCOUNT    PIC X(10).
   182         16 WS-ERRESC-RESIDUAL-KEY.
   183             20  WS-ERRESC-AGENT      PIC X(10).
   184             20  WS-ERRESC-RES-STATE  PIC XX.
   185             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   186*                                          YYYYMMDD
   187     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   188     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   189
   190*RESIDENT STATE TAX MASTER(ERRESS)
   191*
   192     12  WS-ERRESS-KEY.
   193         16  WS-ERRESS-COMPANY-CD      PIC  X.
   194         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   195         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   196         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   197*                                          YYYYMMDD
   198
   199     12  WS-CONTRACT-DATE              PIC 9(8).
   200*                                          YYYYMMDD
   201     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   202     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   203         16 WS-YEAR-YY                 PIC   9999.
   204         16 FILLER                     PIC 9(4).
   205*                                          YYYYMMDD
   206     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   207     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   208     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   209     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   210
   211     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   212         88  DPRB-1ST-TIME                      VALUE ' '.
   213
   214*****************************************************************
   215*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   216*****************************************************************
   217
   218     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   219     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   220     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   223     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   224     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   225     12  ws-st-agent-sig-edit    pic x          value spaces.
   226     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   227     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   230         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   231         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   232     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   233         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   6
* EL050.cbl
   234         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   235     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   236
   237     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   238     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   239
   240     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   241     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   254     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   255     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   270     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   274     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   275     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   276     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   277     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   278     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   279     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   287     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   288     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   289     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   290     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   291     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   7
* EL050.cbl
   292     12  WS-2671-SW               PIC X         VALUE SPACE.
   293     12  WS-2672-SW               PIC X         VALUE SPACE.
   294     12  ws-9813-sw               pic x         value spaces.
   295     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   296         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   297     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   298         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   299     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   300
   301     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   302         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   303         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   304         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   305         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   306
   307     12  WS-CREDIT-EDIT-CONTROLS.
   308         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   309         16  WS-MIN-AGE           PIC 99                VALUE  0.
   310         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   311         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   312         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   313         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   314
   315     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   316     12  WS-AGE-FIELDS.
   317         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   319         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   320         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   321
   322     12  WS-SAVE-ALLOWABLE-BENEFIT.
   323         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   324         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   325         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   326         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   327         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   328         16  FILLER                      PIC XX.
   329
   330     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   331     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   332     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   333     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   334     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   335     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   336     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   337     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   338     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   339     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   340
   341     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   342     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   343     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   344     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   345     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   346     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   347     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   348     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   349         88  WS-REDUCING              VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   8
* EL050.cbl
   350         88  WS-LEVEL                 VALUE 'L' 'P'.
   351     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   352
   353     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   354     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   355     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   356     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   357     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   358     12  ws-ah-max-bens           pic 99        value zeros.
   359     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   360     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   361     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   362     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   363
   364     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   365     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   366     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   367     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   370     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   371     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   372     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   373     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   374     12  WS-ACCT-SIG-SW.
   375         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   376         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   377     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   378     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   379     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   382     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   384     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   385     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   386     12  WS-INITIALS.
   387         16  WS-INIT-1            PIC X         VALUE SPACES.
   388         16  WS-INIT-2            PIC X         VALUE SPACES.
   389
   390     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   391     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   392     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   393     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   394     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   395*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   396     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   401     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   402     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   403     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   404     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   406     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page   9
* EL050.cbl
   408     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   409     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   410     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   411     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   417     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   418******** FLA
   419     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   422     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   423     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   424********
   425     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   427     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   428     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   429     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   430     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   431     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   432     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   433     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   434     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   435
   436     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   437         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   438                                         '0' THRU '9'.
   439
   440     12  NUMBER-OF-MONTHS.
   441         16  SK-MO OCCURS 12 TIMES PIC X.
   442
   443     12  WS-WORK-DATE.
   444         16  WS-YEAR            PIC 99    VALUE 00.
   445         16  WS-MONTH           PIC 99    VALUE 00.
   446         16  WS-DAY             PIC 99    VALUE 00.
   447
   448     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   449     12  WS-WORK-CRIT-DEV       REDEFINES
   450         WS-WORK-LF-CRIT-PER    PIC X(03).
   451
   452     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   453     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   454
   455     12  WS-WORK-DATE-FROM.
   456         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X  VALUE SPACE.
   458         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   459         16  FILLER             PIC X         VALUE SPACE.
   460         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   461
   462     12  WS-WORK-DATE-THRU.
   463         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  10
* EL050.cbl
   466         16  FILLER             PIC X         VALUE SPACE.
   467         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   468
   469     12  WS-LF-INPUT-CD.
   470         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   471         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   472
   473     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   474     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   475         16  WS-AH-INPUT-CD-1   PIC X.
   476         16  WS-AH-INPUT-CD-2-3 PIC XX.
   477
   478     12  WS-SWITCHES.
   479         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   480         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   481             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   482         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   483             88  BANK-ACCT-FOUND          VALUE 'Y'.
   484         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   485             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   486         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   487             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   488         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   489             88  COMP-MASTER-FOUND        VALUE 'Y'.
   490         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   491             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   492         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   493             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   494         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   495             88  STAT-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   497             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   498         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   499             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   501             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   502         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   503             88  FORM-MASTER-FOUND        VALUE 'Y'.
   504         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   505             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   507             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   508         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   509             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   510         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   511             88  NO-BENEFIT-FOUND         VALUE 'N'.
   512         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   514         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   515             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   516         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   517             88  AH-BENEFIT-FOUND         VALUE ' '.
   518             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   519         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   520             88  LF-BENEFIT-FOUND         VALUE ' '.
   521             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   522         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   523             88  NO-STATE-RECORD          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   525             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   527             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   528         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   529             88  CERT-WAS-FOUND           VALUE ' '.
   530             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   531         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   532             88  BROWSE-STARTED           VALUE 'Y'.
   533         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   534             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   535         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   536             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   537         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   538             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   539         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   542             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   543         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   544             88  APP-CERT-USED            VALUE 'Y' 'A'.
   545         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   546             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   547             88  FIRST-TIME-THROUGH       VALUE '1'.
   548             88  CTBL-NOT-FOUND           VALUE '2'.
   549
   550         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   551             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   552
   553         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   554             88  DLO-ERROR-FOUND          VALUE 'Y'.
   555
   556********FLA
   557     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   558     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   559********
   560     12  RC-SW-1                  PIC X           VALUE '0'.
   561     12  RC-SW-2                  PIC X           VALUE '0'.
   562     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   563     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   564     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   570     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   571     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   572     12  LIT-SPACES               PIC X           VALUE SPACES.
   573     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   574     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   575     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   576     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   577     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   578     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   579     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   580         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   581         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  12
* EL050.cbl
   582     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   583         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   584
   585 01  WS-EXTRA-PERIODS-BY-STATE.
   586     12  WS-INT-PERIODS          PIC 9.
   587     12  WS-EXTRA-PMTS           PIC 9.
   588 01  ws-net-only-state           pic x value 'N'.
   589 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   590     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   591     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   592 01  WS-CRI-SSN-WORK-AREA.
   593     05  WS-CRI-SOC-SEC-NO.
   594         10  WS-SS-REPT-CD       PIC X(5).
   595         10  WS-SS-LAST-NAME     PIC X(5).
   596         10  WS-SS-INITIAL       PIC X.
   597
   598     05  WS-CRI-REPORT-CODE.
   599         10  FILLER              PIC X(5).
   600         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   601
   602     05  WS-CRI-LAST-NAME.
   603         10  WS-CRI-NAME-MOVE    PIC X(5).
   604         10  FILLER              PIC X(10).
   605
   606 01  WS-NUM-TABLE                PIC X(26)  VALUE
   607     '12345678012345070923456789'.
   608 01  FILLER REDEFINES WS-NUM-TABLE.
   609     05  WS-NUM OCCURS 26        PIC 9.
   610 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   611 01  V1                          PIC S999 COMP-3.
   612 01  V2                          PIC S999 COMP-3.
   613 01  V3                          PIC S999 COMP-3.
   614 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   615 01  FILLER REDEFINES WS-WORK-VIN.
   616     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   617 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   618 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   619 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   620 01  WS-HEX-WORK.
   621     05  FILLER                  PIC X  VALUE LOW-VALUES.
   622     05  WS-HEX-BYTE             PIC X.
   623 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   624 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   625 01  WS-WORK-HIN-ROW-B.
   626     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   627
   628 01  ws-benefit-cd-chg-sw      pic x value spaces.
   629     88  benefit-code-chg           value 'Y'.
   630 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   631 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   632     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   633 01  WS-ROW-D-TABLE.
   634     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   635
   636 01  WS-HIN-TABLE-B.
   637     05  F                       PIC XX VALUE 'A2'.
   638     05  F                       PIC XX VALUE 'B3'.
   639     05  F                       PIC XX VALUE 'C4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'D5'.
   641     05  F                       PIC XX VALUE 'E6'.
   642     05  F                       PIC XX VALUE 'F7'.
   643     05  F                       PIC XX VALUE 'G8'.
   644     05  F                       PIC XX VALUE 'H9'.
   645     05  F                       PIC XX VALUE 'I1'.
   646     05  F                       PIC XX VALUE 'J2'.
   647     05  F                       PIC XX VALUE 'K3'.
   648     05  F                       PIC XX VALUE 'L4'.
   649     05  F                       PIC XX VALUE 'M5'.
   650     05  F                       PIC XX VALUE 'N6'.
   651     05  F                       PIC XX VALUE 'O0'.
   652     05  F                       PIC XX VALUE 'P7'.
   653     05  F                       PIC XX VALUE 'Q0'.
   654     05  F                       PIC XX VALUE 'R8'.
   655     05  F                       PIC XX VALUE 'S9'.
   656     05  F                       PIC XX VALUE 'T2'.
   657     05  F                       PIC XX VALUE 'U3'.
   658     05  F                       PIC XX VALUE 'V4'.
   659     05  F                       PIC XX VALUE 'W5'.
   660     05  F                       PIC XX VALUE 'X6'.
   661     05  F                       PIC XX VALUE 'Y7'.
   662     05  F                       PIC XX VALUE 'Z8'.
   663 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   664     05  WS-VAL-IN               PIC X.
   665     05  WS-VAL-OUT              PIC 9.
   666 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   667 01  WS-COMPARE-BINARY-DATES.
   668     05  WS-971231                PIC XX VALUE X'92FF'.
   669     05  WS-931231                PIC XX VALUE X'8CFF'.
   670     05  WS-791231                PIC XX VALUE X'77FF'.
   671     05  WS-771001                PIC XX VALUE X'74A1'.
   672     05  WS-820301                PIC XX VALUE X'7B41'.
   673     05  WS-831031                PIC XX VALUE X'7DBF'.
   674     05  WS-831231                PIC XX VALUE X'7DFF'.
   675     05  WS-810831                PIC XX VALUE X'7A7F'.
   676     05  WS-830901                PIC XX VALUE X'7D81'.
   677
   678 01  FILE-ACCESS-IDS.
   679     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   680     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   681     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   682     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   683     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   684     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   685     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   686     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   687     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   688     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   689     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   690     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   691     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   692     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   693     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   694     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   695     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   696 01  DD-IU-SW                    PIC X   VALUE ' '.
   697     88  DD-IU-PRESENT                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  14
* EL050.cbl
   698
   699 01  ACCESS-KEYS.
   700     12  ELMSTR-KEY.
   701         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   702         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   703     12  W-CLAIM-KEY.
   704         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   705         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   706
   707     12  ELCNTL-KEY.
   708         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   709         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   710         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   711         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   712
   713     12  ELCERT-KEY.
   714         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   715         16  CERT-CARRIER         PIC X       VALUE SPACE.
   716         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   717         16  CERT-STATE           PIC XX      VALUE SPACES.
   718         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   719         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   720         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   721
   722     12  ELCERT2-KEY.
   723         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   724         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   725
   726     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   727
   728     12  ELCERT-SAVE.
   729         16  FILLER                      PIC XX    VALUE SPACES.
   730
   731         16  WCS-CONTROL-PRIMARY.
   732             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   733             20  WCS-CARRIER             PIC X     VALUE SPACE.
   734             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   735             20  WCS-STATE               PIC XX    VALUE SPACES.
   736             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   737             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   738             20  WCS-CERT-NO.
   739                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   740                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   741
   742         16  CS-CONTROL-BY-NAME.
   743             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   744             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   745             20  CS-INSURED-INITIALS.
   746                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   747                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   748
   749         16  CS-CONTROL-BY-SSN.
   750             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   751             20  CS-SOC-SEC-NO.
   752                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   753                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   754                 24  CS-SSN-LN3.
   755                     28 CS-INSURED-INITIALS-A2   PIC XX
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  15
* EL050.cbl
   756                                     VALUE SPACES.
   757                     28 CS-PART-LAST-NAME-A2     PIC X
   758                                     VALUE SPACE.
   759
   760         16  CS-CONTROL-BY-CERT-NO.
   761             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   762             20  CS-CERT-NO-A4           PIC X(11)
   763                                     VALUE SPACES.
   764
   765         16  CS-CONTROL-BY-MEMB.
   766             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   767             20  CS-MEMBER-NO.
   768                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   769                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   770                 24  CS-MEMB-LN4.
   771                     28 CS-INSURED-INITIALS-A5   PIC XX
   772                                      VALUE SPACES.
   773                     28 CS-PART-LAST-NAME-A5     PIC XX
   774                                      VALUE SPACES.
   775
   776         16  FILLER              PIC X(360) VALUE SPACES.
   777
   778     12  ERACCT-KEY.
   779         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   780         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   781         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   782         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   783         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   784         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   785
   786     12  ERCOMP-KEY.
   787         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   788         16  COMP-CARRIER         PIC X     VALUE SPACES.
   789         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   790         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   791         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   792         16  COMP-TYPE            PIC X     VALUE SPACES.
   793
   794     12  ERLOFC-KEY.
   795         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   797         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   798         16  LOFC-STATE           PIC XX    VALUE SPACES.
   799         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   800         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   801
   802     12  WS-ELCRTT-KEY.
   803         16  WS-ELCRTT-PRIMARY       PIC X(33).
   804         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   805
   806     12  ERBXRF-KEY.
   807         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   808         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   809         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   810         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   811
   812     12  ERAGTC-KEY.
   813         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  16
* EL050.cbl
   814         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   815         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   816         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   817         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   818         16  AGTC-TYPE            PIC X     VALUE SPACES.
   819
   820     12  ERPLAN-KEY.
   821         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   822         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   823         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   824         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   825         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   826         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   827         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   828         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   829
   830     12  ERFORM-KEY.
   831         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   832         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   833         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   834         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   835
   836     12  ERREIN-KEY.
   837         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   838         16  REIN-TYPE            PIC X     VALUE SPACES.
   839         16  REIN-TABLE-CO.
   840             20  REIN-CODE-1      PIC X     VALUE SPACE.
   841             20  REIN-CODE-2      PIC X     VALUE SPACE.
   842             20  REIN-CODE-3      PIC X     VALUE SPACE.
   843         16  FILLER               PIC X(3)  VALUE SPACES.
   844
   845     12  ERCTBL-KEY.
   846         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   847         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   848         16  CTBL-CNTRL-2.
   849             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   850             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   851
   852     12  ELCRTO-KEY.
   853         16  ELCRTO-COMPANY-CD       PIC X.
   854         16  ELCRTO-CARRIER          PIC X.
   855         16  ELCRTO-GROUPING         PIC X(6).
   856         16  ELCRTO-STATE            PIC XX.
   857         16  ELCRTO-ACCOUNT          PIC X(10).
   858         16  ELCRTO-CERT-EFF-DT      PIC XX.
   859         16  ELCRTO-CERT-NO.
   860             20  ELCRTO-CERT-PRIME   PIC X(10).
   861             20  ELCRTO-CERT-SFX     PIC X.
   862         16  ELCRTO-RECORD-TYPE      PIC X.
   863         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   864
   865
   866     12  WS-ACCESS.
   867         16  FILLER               PIC XX    VALUE SPACES.
   868         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   869
   870     12  WS-CARR-ACCESS.
   871         16  FILLER               PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  17
* EL050.cbl
   872         16  WS-CARR              PIC X     VALUE SPACE.
   873*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   874*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   875     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   876         88  WS-DMD-LF-RATING   VALUE 'Y'.
   877         88  WS-DMD-AH-RATING   VALUE 'Y'.
   878         88  WS-DMD-NO-RATING   VALUE 'N'.
   879
   880     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   881         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   882                                         'NJ' 'NL'
   883                                         'PJ' 'PL'
   884                                         'SJ' 'SL'.
   885     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   886         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   887                                         'NI' 'NJ' 'NL' 'NU'
   888                                         'PJ' 'PL' 'PI' 'PU'
   889                                         'SI' 'SJ' 'SL' 'SU'
   890                                         'MX' 'MY' 'MZ'.
   891 01  ERPDEF-KEY-SAVE             PIC X(18).
   892 01  ERPDEF-KEY.
   893     12  ERPDEF-COMPANY-CD       PIC X.
   894     12  ERPDEF-STATE            PIC XX.
   895     12  ERPDEF-PROD-CD          PIC XXX.
   896     12  F                       PIC X(7).
   897     12  ERPDEF-BEN-TYPE         PIC X.
   898     12  ERPDEF-BEN-CODE         PIC XX.
   899     12  ERPDEF-EXP-DT           PIC XX.
   900
   901 01  ELSTAT-KEY-SAVE             PIC X(20).
   902 01  ELSTAT-KEY.
   903     12  ELSTAT-COMPANY-ID       PIC XXX.
   904     12  ELSTAT-CARRIER          PIC X.
   905     12  ELSTAT-GROUP            PIC X(6).
   906     12  ELSTAT-STATE            PIC XX.
   907     12  ELSTAT-EXP-DT           PIC 9(8).
   908 01  WS-ERROR-VALUES.
   909     12  ER-1570                     PIC S9(4)   VALUE +1570.
   910     12  ER-1571                     PIC S9(4)   VALUE +1571.
   911     12  er-1572                     pic s9(4)   value +1572.
   912     12  er-1573                     pic s9(4)   value +1573.
   913     12  er-1574                     pic s9(4)   value +1574.
   914     12  ER-1575                     PIC S9(4)   VALUE +1575.
   915     12  er-1576                     pic s9(4)   value +1576.
   916     12  er-1583                     pic s9(4)   value +1583.
   917     12  er-1743                     pic s9(4)   value +1743.
   918     12  er-1744                     pic s9(4)   value +1744.
   919     12  er-1745                     pic s9(4)   value +1745.
   920     12  er-1746                     pic s9(4)   value +1746.
   921     12  er-1747                     pic s9(4)   value +1747.
   922     12  er-1748                     pic s9(4)   value +1748.
   923     12  ER-1891                     PIC S9(4)   VALUE +1891.
   924     12  ER-1892                     PIC S9(4)   VALUE +1892.
   925     12  ER-1893                     PIC S9(4)   VALUE +1893.
   926     12  ER-1894                     PIC S9(4)   VALUE +1894.
   927     12  ER-1895                     PIC S9(4)   VALUE +1895.
   928     12  ER-1896                     PIC S9(4)   VALUE +1896.
   929     12  ER-1897                     PIC S9(4)   VALUE +1897.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  18
* EL050.cbl
   930     12  ER-1898                     PIC S9(4)   VALUE +1898.
   931     12  ER-1899                     PIC S9(4)   VALUE +1899.
   932     12  ER-1900                     PIC S9(4)   VALUE +1900.
   933     12  ER-1901                     PIC S9(4)   VALUE +1901.
   934     12  ER-1902                     PIC S9(4)   VALUE +1902.
   935     12  ER-1903                     PIC S9(4)   VALUE +1903.
   936     12  ER-1904                     PIC S9(4)   VALUE +1904.
   937     12  ER-1905                     PIC S9(4)   VALUE +1905.
   938     12  ER-1906                     PIC S9(4)   VALUE +1906.
   939     12  ER-1907                     PIC S9(4)   VALUE +1907.
   940     12  ER-1909                     PIC S9(4)   VALUE +1909.
   941     12  ER-1910                     PIC S9(4)   VALUE +1910.
   942     12  ER-1911                     PIC S9(4)   VALUE +1911.
   943     12  ER-1912                     PIC S9(4)   VALUE +1912.
   944     12  ER-1913                     PIC S9(4)   VALUE +1913.
   945     12  ER-1914                     PIC S9(4)   VALUE +1914.
   946     12  ER-1915                     PIC S9(4)   VALUE +1915.
   947     12  ER-1916                     PIC S9(4)   VALUE +1916.
   948     12  ER-1917                     PIC S9(4)   VALUE +1917.
   949     12  ER-1918                     PIC S9(4)   VALUE +1918.
   950     12  ER-1919                     PIC S9(4)   VALUE +1919.
   951     12  ER-1920                     PIC S9(4)   VALUE +1920.
   952     12  ER-1921                     PIC S9(4)   VALUE +1921.
   953     12  ER-1922                     PIC S9(4)   VALUE +1922.
   954     12  ER-1923                     PIC S9(4)   VALUE +1923.
   955     12  ER-1924                     PIC S9(4)   VALUE +1924.
   956     12  ER-1925                     PIC S9(4)   VALUE +1925.
   957     12  ER-1926                     PIC S9(4)   VALUE +1926.
   958     12  ER-1927                     PIC S9(4)   VALUE +1927.
   959     12  ER-2393                     PIC S9(4)   VALUE +2393.
   960     12  ER-2600                     PIC S9(4)   VALUE +2600.
   961     12  ER-2601                     PIC S9(4)   VALUE +2601.
   962     12  ER-2602                     PIC S9(4)   VALUE +2602.
   963     12  ER-2603                     PIC S9(4)   VALUE +2603.
   964     12  ER-2604                     PIC S9(4)   VALUE +2604.
   965     12  ER-2605                     PIC S9(4)   VALUE +2605.
   966     12  ER-2606                     PIC S9(4)   VALUE +2606.
   967     12  ER-2607                     PIC S9(4)   VALUE +2607.
   968     12  ER-2608                     PIC S9(4)   VALUE +2608.
   969     12  ER-2609                     PIC S9(4)   VALUE +2609.
   970     12  ER-2610                     PIC S9(4)   VALUE +2610.
   971     12  ER-2611                     PIC S9(4)   VALUE +2611.
   972     12  ER-2612                     PIC S9(4)   VALUE +2612.
   973     12  ER-2613                     PIC S9(4)   VALUE +2613.
   974     12  ER-2614                     PIC S9(4)   VALUE +2614.
   975     12  ER-2615                     PIC S9(4)   VALUE +2615.
   976     12  ER-2616                     PIC S9(4)   VALUE +2616.
   977     12  ER-2617                     PIC S9(4)   VALUE +2617.
   978     12  ER-2618                     PIC S9(4)   VALUE +2618.
   979     12  ER-2619                     PIC S9(4)   VALUE +2619.
   980     12  ER-2620                     PIC S9(4)   VALUE +2620.
   981     12  ER-2621                     PIC S9(4)   VALUE +2621.
   982     12  ER-2622                     PIC S9(4)   VALUE +2622.
   983     12  ER-2623                     PIC S9(4)   VALUE +2623.
   984     12  ER-2624                     PIC S9(4)   VALUE +2624.
   985     12  ER-2625                     PIC S9(4)   VALUE +2625.
   986     12  ER-2626                     PIC S9(4)   VALUE +2626.
   987     12  ER-2627                     PIC S9(4)   VALUE +2627.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  19
* EL050.cbl
   988     12  ER-2628                     PIC S9(4)   VALUE +2628.
   989     12  ER-2629                     PIC S9(4)   VALUE +2629.
   990     12  ER-2630                     PIC S9(4)   VALUE +2630.
   991     12  ER-2631                     PIC S9(4)   VALUE +2631.
   992     12  ER-2632                     PIC S9(4)   VALUE +2632.
   993     12  ER-2633                     PIC S9(4)   VALUE +2633.
   994     12  ER-2634                     PIC S9(4)   VALUE +2634.
   995     12  ER-2635                     PIC S9(4)   VALUE +2635.
   996     12  ER-2636                     PIC S9(4)   VALUE +2636.
   997     12  ER-2637                     PIC S9(4)   VALUE +2637.
   998     12  ER-2638                     PIC S9(4)   VALUE +2638.
   999     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1000     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1001     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1002     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1003     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1004     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1005     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1006     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1007     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1008     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1009     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1010     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1011     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1012     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1013     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1014     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1015     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1016     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1017     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1018     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1019     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1020     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1021     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1022     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1023     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1024     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1025     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1026     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1027     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1028     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1029     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1030     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1031     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1032     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1033     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1034     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1035     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1036     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1037     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1038     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1039     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1040     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1041     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1042     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1043     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1044     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1045     12  ER-2685                     PIC S9(4)   VALUE +2685.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  20
* EL050.cbl
  1046     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1047     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1048     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1049     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1050     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1051     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1052     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1053     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1054     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1055     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1056     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1057     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1058     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1059     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1060     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1061     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1062     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1063     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1064     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1065     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1066     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1067     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1068     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1069     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1070     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1071     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1072     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1073     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1074     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1075     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1076     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1077     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1078     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1079     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1080     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1081     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1082     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1083     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1084     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1085     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1086     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1087     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1088     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1089     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1090     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1091     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1092     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1093     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1094     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1095     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1096     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1097     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1098     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1099     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1100     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1101     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1102     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1103     12  ER-2753                     PIC S9(4)   VALUE +2753.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  21
* EL050.cbl
  1104     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1105     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1106     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1107     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1108     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1109     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1110     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1111     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1112     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1113     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1114     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1115     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1116     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1117     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1118     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1119     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1120     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1121     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1122     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1123     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1124     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1125     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1126     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1127     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1128     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1129     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1130     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1131     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1132     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1133     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1134     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1135     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1136     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1137     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1138     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1139     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1140     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1141     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1142     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1143     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1144     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1145     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1146     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1147     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1148     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1149     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1150     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1151     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1152     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1153     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1154     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1155     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1156     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1157     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1158     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1159     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1160     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1161     12  ER-2898                     PIC S9(4)   VALUE +2898.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  22
* EL050.cbl
  1162     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1163     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1164     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1165     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1166     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1167     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1168     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1169     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1170     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1171     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1172     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1173     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1174     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1175     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1176     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1177     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1178     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1179     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1180     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1181     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1182     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1183     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1184     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1185     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1186     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1187     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1188     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1189     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1190     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1191     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1192     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1193     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1194     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1195     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1196     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1197     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1198     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1199     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1200     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1201     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1202     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1203     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1204     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1205     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1206     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1207     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1208     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1209     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1210     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1211     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1212     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1213     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1214     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1215     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1216     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1217     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1218     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1219     12  ER-8080                     PIC S9(4)   VALUE +8080.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  23
* EL050.cbl
  1220     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1221     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1222     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1223     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1224     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1225     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1226     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1227     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1228     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1229     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1230     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1231     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1232     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1233     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1234     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1235     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1236     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1237     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1238     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1239     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1240     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1241     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1242     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1243     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1244     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1245     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1246     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1247     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1248     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1249     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1250     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1251     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1252     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1253     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1254     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1255     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1256     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1257     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1258     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1259     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1260     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1261     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1262     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1263     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1264     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1265     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1266     12  er-9823                     pic s9(4)   value +9823.
  1267     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1268******************************************************************
  1269***************   END OF ELC50WS     ****************************
  1270******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  24
* EL050.cbl
  1273 01  WORKING-STORAGE-WORK-AREAS.
  1274     12  WS-RESPONSE             PIC S9(8)  COMP.
  1275         88  WS-RESP-NORMAL           VALUE +00.
  1276         88  WS-RESP-ERROR            VALUE +01.
  1277         88  WS-RESP-NOTFND           VALUE +13.
  1278         88  WS-RESP-DUPREC           VALUE +14.
  1279         88  WS-RESP-ENDFILE          VALUE +20.
  1280     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1281     12  WORK-AREAS.
  1282         16  WK-CONV-GREG.
  1283             24  WCG-CENT             PIC XX.
  1284             24  WCG-REST             PIC X(4).
  1285         16  WORK-GREGORIAN-DATE.
  1286             24  WK-GREG-CENT         PIC XX.
  1287             24  WK-GREG-DATE-YYMMDD.
  1288                 28  WK-GREG-YYMM     PIC X(4).
  1289                 28  WK-GREG-DD       PIC XX.
  1290
  1291         16  WORK-SELECT-DATE.
  1292             24  WK-SELECT-CENT            PIC XX.
  1293             24  WK-SELECT-DATE-YYMMDD.
  1294                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1295                 28  FILLER                PIC XX.
  1296
  1297         16  WK-FORM-NO.
  1298             24  WK-FORM-BANK-ID       PIC X(5).
  1299             24  WK-FORM-UNDRWRTR      PIC X(1).
  1300             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1301
  1302         16  WK-MEMBER-NO.
  1303             24  WK-MEMBER-1-6        PIC X(6).
  1304             24  WK-MEMBER-7-12       PIC X(6).
  1305
  1306         16  WK-FULL-CERT-NO.
  1307             24  WK-CERT-POS-1-2      PIC X(2).
  1308             24  WK-CERT-POS-3        PIC X(1).
  1309             24  WK-CERT-POS-4        PIC X(1).
  1310             24  WK-CERT-POS-5-6      PIC X(2).
  1311             24  WK-CERT-POS-7        PIC X(1).
  1312             24  WK-CERT-POS-8-11     PIC X(4).
  1313
  1314         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1315             88  VALID-RATE-CODE        VALUE 'Y'.
  1316             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1317
  1318         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1319         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1320         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1321         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1322         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1323         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1324         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1325         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1326         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1327         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1328
  1329* DLO001
  1330 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  25
* EL050.cbl
  1331     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1332     12  DMPF-RETURN-CODE          PIC XX.
  1333         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1334         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1335         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1336         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1337         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1338         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1339
  1340* DLO002
  1341 01  WS-DLO-INTERNAL-POLICY-FORM.
  1342     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1343     12  DIPF-RETURN-CODE          PIC XX.
  1344         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1345         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1346         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1347         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1348         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1349         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1350
  1351* DLO003
  1352 01  WS-DLO-VALID-BANK-ID.
  1353     12  DVBI-BANK-ID              PIC X(5).
  1354     12  DVBI-BANK-ID-TYPE         PIC X.
  1355         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1356         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1357         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1358         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1359         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1360     12  DVBI-RETURN-CODE          PIC XX.
  1361         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1362         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1363         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1364         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1365         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1366         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1367         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1368         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1369         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1370
  1371* DLO007
  1372 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1373     12  DCUA-RES-STATE            PIC XX.
  1374     12  DCUA-BEN-TYPE             PIC XX.
  1375     12  DCUA-SYS-IDENT            PIC X.
  1376         88  DCUA-CLAIM                        VALUE 'C'.
  1377         88  DCUA-PREMIUM                      VALUE 'P'.
  1378     12  DCUA-COVERAGE-RULE        PIC X.
  1379     12  DCUA-CLIENT-ID            PIC X(10).
  1380     12  DCUA-EFF-DATE             PIC X(8).
  1381     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1382     12  DCUA-RETURN-CODE          PIC XX.
  1383         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1384     12  DCUA-CERT-NUMBER          PIC X(11).
  1385     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1386     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1387
  1388* DLO011
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  26
* EL050.cbl
  1389 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1390     12  DPRB-RATE-CODE            PIC X(4).
  1391     12  DPRB-COVERAGE-CATEG       PIC X.
  1392     12  DPRB-RETURN-CODE          PIC XX.
  1393         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1394         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1395         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1396         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1397         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1398         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1399         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1400         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1401         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1402     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1403     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1404     12  DPRB-BEN-TYPE             PIC XX.
  1405
  1406* DLO017
  1407 01  WS-DLO-VALID-RATE-CODE.
  1408     12  DVRC-RATE-CODE            PIC X(4).
  1409     12  DVRC-RETURN-CODE          PIC XX.
  1410         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1411         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1412         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1413         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1414         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1415         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1416
  1417* DLO019
  1418 01  WS-DLO-ORIG-COV-CAT.
  1419     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1420     12  DOCC-RETURN-CODE          PIC XX.
  1421     12  DOCC-ORIG-COV-CAT         PIC X.
  1422     12  DOCC-UNDERWITER           PIC XX.
  1423     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1424     12  DOCC-FILLER               PIC X(6).
  1425
  1426* DLO021
  1427 01  WS-DLO-VALID-LOAN-OFFICER.
  1428     12  DVLO-LOAN-OFFICER.
  1429         16  DVLO-BILL-TYPE        PIC X.
  1430         16  DVLO-BILL-SOURCE      PIC X.
  1431         16  DVLO-BATCH-TYPE       PIC X.
  1432     12  DVLO-RETURN-CODE          PIC XX.
  1433         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1434         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1435         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1436         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1437         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1438         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1439
  1440* DLO022
  1441 01  WS-DLO-VALID-STATE-CODE.
  1442     12  DVSC-STATE-CODE           PIC XX.
  1443     12  DVSC-RETURN-CODE          PIC XX.
  1444         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1445
  1446* DLO023
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  27
* EL050.cbl
  1447 01  WS-DLO-VALID-CODE-VALUES.
  1448     12  DVCV-SYSTEM-ID            PIC XX.
  1449         88  DVCV-CLAIMS                       VALUE 'CL'.
  1450         88  DVCV-CREDIT                       VALUE 'CR'.
  1451     12  DVCV-RECORD-TYPE          PIC XX.
  1452         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1453         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1454         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1455         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1456         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1457         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1458         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1459         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1460     12  DVCV-RECORD-KEY           PIC X(6).
  1461     12  DVCV-RETURN-CODE          PIC XX.
  1462         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1463         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1464         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1465         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1466         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1467         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1468         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1469     12  DVCV-CODE-DESC            PIC X(60).
  1470     12  DVCV-GEN-DESC-1           PIC X(20).
  1471     12  DVCV-GEN-DESC-2           PIC X(20).
  1472     12  DVCV-GEN-DESC-3           PIC X(20).
  1473
  1474****  this is for aggregate report.
  1475****  Length is erpndb + 100 of passed-key-area
  1476 01  ws-passed-key-length        pic s9(4) comp value +587.
  1477 01  ws-pass-to-pemaggo.
  1478     05  ws-passed-erpndb        pic x(585).
  1479     05  ws-exceed-limit-yn      pic x.
  1480     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  28
* EL050.cbl
  1482*    COPY ERCBXRF.
  1483******************************************************************
  1484*                                                                *
  1485*                                                                *
  1486*                            ERCBXRF                             *
  1487*                                                                *
  1488*   ONLINE CREDIT SYSTEM                                         *
  1489*                                                                *
  1490*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1491*                                                                *
  1492*   FILE TYPE = VSAM,KSDS                                        *
  1493*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1494*                                                                *
  1495*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1496*       ALTERNATE PATH = NONE                                    *
  1497*                                                                *
  1498*   LOG = NO                                                     *
  1499*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1500*                                                                *
  1501******************************************************************
  1502
  1503 01  BANK-CROSS-REFERENCE.
  1504     12  BK-RECORD-ID                PIC XX.
  1505         88  VALID-BK-ID             VALUE 'BK'.
  1506
  1507     12  BK-CONTROL-PRIMARY.
  1508         16  BK-COMPANY-CD           PIC X.
  1509         16  BK-CARRIER              PIC X.
  1510         16  BK-GROUPING             PIC X(6).
  1511         16  BK-BANK-NO              PIC X(10).
  1512
  1513     12  BK-MAINT-INFORMATION.
  1514         16  BK-LAST-MAINT-DT        PIC XX.
  1515         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1516         16  BK-LAST-MAINT-USER      PIC X(4).
  1517         16  FILLER                  PIC X(9).
  1518
  1519     12  FILLER                      PIC X(37).
  1520
  1521     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1522
  1523     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1524                            DEPENDING ON BK-BANK-POINTER-CNT.
  1525         16  BK-AM-ACCOUNT           PIC X(10).
  1526         16  BK-AM-EXP-DT            PIC XX.
  1527         16  BK-AM-EFF-DT            PIC XX.
  1528         16  BK-AM-STATE             PIC XX.
  1529         16  FILLER                  PIC X(20).
  1530
  1531******************************************************************
  1532
  1533*    COPY ERCCOMP.
  1534******************************************************************
  1535*                                                                *
  1536*                                                                *
  1537*                            ERCCOMP                             *
  1538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1539*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  29
* EL050.cbl
  1540*                                                                *
  1541*   ONLINE CREDIT SYSTEM                                         *
  1542*                                                                *
  1543*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1544*                                                                *
  1545*   FILE TYPE = VSAM,KSDS                                        *
  1546*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1547*                                                                *
  1548*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1549*       ALTERNATE PATH = NONE                                    *
  1550*                                                                *
  1551*   LOG = NO                                                     *
  1552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1553*                                                                *
  1554******************************************************************
  1555*                   C H A N G E   L O G
  1556*
  1557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1558*-----------------------------------------------------------------
  1559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1560* EFFECTIVE    NUMBER
  1561*-----------------------------------------------------------------
  1562* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1563* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1564* 092205    2005050300006  PEMA  ADD LEASE FEE
  1565* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1566* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1567* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1568* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1569* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1570* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1571******************************************************************
  1572
  1573 01  COMPENSATION-MASTER.
  1574     12  CO-RECORD-ID                          PIC XX.
  1575         88  VALID-CO-ID                          VALUE 'CO'.
  1576
  1577     12  CO-CONTROL-PRIMARY.
  1578         16  CO-COMPANY-CD                     PIC X.
  1579         16  CO-CONTROL.
  1580             20  CO-CTL-1.
  1581                 24  CO-CARR-GROUP.
  1582                     28  CO-CARRIER            PIC X.
  1583                     28  CO-GROUPING.
  1584                         32  CO-GROUP-PREFIX   PIC XXX.
  1585                         32  CO-GROUP-PRIME    PIC XXX.
  1586                 24  CO-RESP-NO.
  1587                     28  CO-RESP-PREFIX        PIC X(4).
  1588                     28  CO-RESP-PRIME         PIC X(6).
  1589             20  CO-CTL-2.
  1590                 24  CO-ACCOUNT.
  1591                     28  CO-ACCT-PREFIX        PIC X(4).
  1592                     28  CO-ACCT-PRIME         PIC X(6).
  1593         16  CO-TYPE                           PIC X.
  1594             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1595             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1596             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1597
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  30
* EL050.cbl
  1598     12  CO-MAINT-INFORMATION.
  1599         16  CO-LAST-MAINT-DT                  PIC XX.
  1600         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1601         16  CO-LAST-MAINT-USER                PIC X(4).
  1602     12  FILLER                                PIC XX.
  1603     12  CO-STMT-TYPE                          PIC XXX.
  1604     12  CO-COMP-TYPE                          PIC X.
  1605         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1606     12  CO-STMT-OWNER                         PIC X(4).
  1607     12  CO-BALANCE-CONTROL                    PIC X.
  1608         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1609         88  CO-NO-BALANCE                        VALUE 'N'.
  1610
  1611     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1612         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1613         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1614         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1615
  1616     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1617         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1618         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1619
  1620     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1621     12  CO-GA-DIRECT-DEP                      PIC X.
  1622     12  CO-FUTURE-SPACE                       PIC X.
  1623         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1624
  1625     12  CO-ACCT-NAME                          PIC X(30).
  1626     12  CO-MAIL-NAME                          PIC X(30).
  1627     12  CO-ADDR-1                             PIC X(30).
  1628     12  CO-ADDR-2                             PIC X(30).
  1629     12  CO-ADDR-3.
  1630         16  CO-ADDR-CITY                      PIC X(27).
  1631         16  CO-ADDR-STATE                     PIC XX.
  1632     12  CO-CSO-1099                           PIC X.
  1633     12  CO-ZIP.
  1634         16  CO-ZIP-PRIME.
  1635             20  CO-ZIP-PRI-1ST                PIC X.
  1636                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1637             20  FILLER                        PIC X(4).
  1638         16  CO-ZIP-PLUS4                      PIC X(4).
  1639     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1640         16  CO-CAN-POSTAL-1                   PIC XXX.
  1641         16  CO-CAN-POSTAL-2                   PIC XXX.
  1642         16  FILLER                            PIC XXX.
  1643     12  CO-SOC-SEC                            PIC X(13).
  1644     12  CO-TELEPHONE.
  1645         16  CO-AREA-CODE                      PIC XXX.
  1646         16  CO-PREFIX                         PIC XXX.
  1647         16  CO-PHONE                          PIC X(4).
  1648
  1649     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1650
  1651     12  CO-AR-BAL-LEVEL                       PIC X.
  1652         88  CO-AR-REF-LVL                        VALUE '1'.
  1653         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1654         88  CO-AR-BILL-LVL                       VALUE '2'.
  1655         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  31
* EL050.cbl
  1656         88  CO-AR-FR-LVL                         VALUE '4'.
  1657
  1658     12  CO-AR-NORMAL-PRINT                    PIC X.
  1659         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1660         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1661
  1662     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1663
  1664     12  CO-AR-REPORTING                       PIC X.
  1665         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1666         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1667
  1668     12  CO-AR-PULL-CHECK                      PIC X.
  1669         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1670         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1671
  1672     12  CO-AR-BALANCE-PRINT                   PIC X.
  1673         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1674
  1675     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1676         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1677         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1678         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1679
  1680     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1681
  1682     12  CO-USER-CODE                          PIC X.
  1683     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1684
  1685******************************************************************
  1686*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1687*    THE LAST MONTH END RUN.
  1688******************************************************************
  1689
  1690     12  CO-LAST-ACTIVITY-DATE.
  1691         16  CO-ACT-YEAR                       PIC 99.
  1692         16  CO-ACT-MONTH                      PIC 99.
  1693         16  CO-ACT-DAY                        PIC 99.
  1694
  1695     12  CO-LAST-STMT-DT.
  1696         16  CO-LAST-STMT-YEAR                 PIC 99.
  1697         16  CO-LAST-STMT-MONTH                PIC 99.
  1698         16  CO-LAST-STMT-DAY                  PIC 99.
  1699
  1700     12  CO-MO-END-TOTALS.
  1701         16  CO-MONTHLY-TOTALS.
  1702             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1703             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1704             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1705             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1706             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1707
  1708         16  CO-AGING-TOTALS.
  1709             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1710             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1711             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1712             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1713
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  32
* EL050.cbl
  1714         16  CO-YTD-TOTALS.
  1715             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1716             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-OVER-UNDER-TOTALS.
  1719             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1720             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1721
  1722     12  CO-MISCELLANEOUS-TOTALS.
  1723         16  CO-FICA-TOTALS.
  1724             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1725             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1726
  1727         16  CO-CLAIM-TOTALS.
  1728             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1729             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1730
  1731******************************************************************
  1732*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1733*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1734******************************************************************
  1735
  1736     12  CO-CURRENT-TOTALS.
  1737         16  CO-CURRENT-LAST-STMT-DT.
  1738             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1739             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1740             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1741
  1742         16  CO-CURRENT-MONTHLY-TOTALS.
  1743             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1745             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1747             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1748
  1749         16  CO-CURRENT-AGING-TOTALS.
  1750             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1751             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1752             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1753             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1754
  1755         16  CO-CURRENT-YTD-TOTALS.
  1756             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1757             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1758
  1759     12  CO-PAID-COMM-TOTALS.
  1760         16  CO-YTD-PAID-COMMS.
  1761             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1762             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1763
  1764     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1765         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1766         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1767
  1768     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1769         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1770         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1771         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  33
* EL050.cbl
  1772         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1773         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1774         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1775         88  CO-FINAL-LETTER                  VALUE 'F'.
  1776         88  CO-RECONCILING                   VALUE 'R'.
  1777         88  CO-PHONE-CALL                    VALUE 'P'.
  1778         88  CO-LEGAL                         VALUE 'L'.
  1779         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1780         88  CO-WRITE-OFF                     VALUE 'W'.
  1781         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1782
  1783     12  CO-CSR-CODE                       PIC X(4).
  1784
  1785     12  CO-GA-STATUS-INFO.
  1786         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1787         16  CO-GA-TERMINATION-DT          PIC XX.
  1788         16  CO-GA-STATUS-CODE             PIC X.
  1789             88  CO-GA-ACTIVE                 VALUE 'A'.
  1790             88  CO-GA-INACTIVE               VALUE 'I'.
  1791             88  CO-GA-PENDING                VALUE 'P'.
  1792         16  CO-GA-COMMENTS.
  1793             20  CO-GA-COMMENT-1           PIC X(40).
  1794             20  CO-GA-COMMENT-2           PIC X(40).
  1795             20  CO-GA-COMMENT-3           PIC X(40).
  1796             20  CO-GA-COMMENT-4           PIC X(40).
  1797
  1798     12  CO-RPTCD2                         PIC X(10).
  1799     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1800         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1801         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1802
  1803     12  CO-TYPE-AGENT                     PIC X(01).
  1804         88  CO-CORPORATION                   VALUE 'C'.
  1805         88  CO-PARTNERSHIP                   VALUE 'P'.
  1806         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1807         88  CO-TRUST                         VALUE 'T'.
  1808         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1809
  1810     12  CO-FAXNO.
  1811         16  CO-FAX-AREA-CODE                  PIC XXX.
  1812         16  CO-FAX-PREFIX                     PIC XXX.
  1813         16  CO-FAX-PHONE                      PIC X(4).
  1814
  1815     12  CO-BANK-INFORMATION.
  1816         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1817         16  CO-BANK-TRANSIT-NON REDEFINES
  1818             CO-BANK-TRANSIT-NO                PIC 9(8).
  1819
  1820         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1821     12  CO-MISC-DEDUCT-INFO REDEFINES
  1822                  CO-BANK-INFORMATION.
  1823         16  CO-MD-GL-ACCT                     PIC X(10).
  1824         16  CO-MD-DIV                         PIC XX.
  1825         16  CO-MD-CENTER                      PIC X(4).
  1826         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1827         16  CO-CREATE-AP-CHECK                PIC X.
  1828         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1829         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  34
* EL050.cbl
  1830     12  CO-ACH-STATUS                         PIC X.
  1831         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1832         88  CO-ACH-PENDING                        VALUE 'P'.
  1833
  1834     12  CO-BILL-SW                            PIC X.
  1835     12  CO-CONTROL-NAME                       PIC X(30).
  1836     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1837     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1838     12  CO-CLP-STATE                          PIC XX.
  1839     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1840     12  CO-SPP-REFUND-EDIT                    PIC X.
  1841
  1842******************************************************************
  1843
  1844*    COPY ERCAGTC.
  1845******************************************************************
  1846*                                                                *
  1847*                                                                *
  1848*                            ERCAGTC                             *
  1849*                            VMOD=2.001                          *
  1850*                                                                *
  1851*   ONLINE CREDIT SYSTEM                                         *
  1852*                                                                *
  1853*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1854*                                                                *
  1855*   FILE TYPE = VSAM,KSDS                                        *
  1856*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1857*                                                                *
  1858*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1859*       ALTERNATE PATH = NONE                                    *
  1860*                                                                *
  1861*   LOG = NO                                                     *
  1862*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1863*                                                                *
  1864******************************************************************
  1865*                   C H A N G E   L O G
  1866*
  1867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1868*-----------------------------------------------------------------
  1869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1870* EFFECTIVE    NUMBER
  1871*-----------------------------------------------------------------
  1872* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1873* 111004                         NEW FILE AND COPYBOOK
  1874* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1875******************************************************************
  1876 01  AGENT-COMMISSIONS.
  1877     12  AG-RECORD-ID                          PIC XX.
  1878         88  VALID-CO-ID                          VALUE 'AG'.
  1879     12  AG-CONTROL-PRIMARY.
  1880         16  AG-COMPANY-CD                     PIC X.
  1881         16  AG-CONTROL.
  1882             20  AG-CTL-1.
  1883                 24  AG-CARR-GROUP.
  1884                     28  AG-CARRIER            PIC X.
  1885                     28  AG-GROUPING           PIC X(6).
  1886                 24  AG-BANK                   PIC X(10).
  1887             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  35
* EL050.cbl
  1888                 24  AG-EXP-DT                 PIC XX.
  1889         16  AG-TYPE                           PIC X.
  1890             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1891             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1892     12  AG-MAINT-INFORMATION.
  1893         16  AG-LAST-MAINT-DT                  PIC XX.
  1894         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1895         16  AG-LAST-MAINT-USER                PIC X(4).
  1896         16  FILLER                            PIC X(10).
  1897     12  AG-EFF-DT                             PIC XX.
  1898     12  AG-COMM-STRUCTURE.
  1899         16  AG-AGT-COMMS OCCURS 10.
  1900             20  AG-AGT                PIC X(10).
  1901             20  AG-COM-TYP            PIC X.
  1902             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1903             20  AG-RECALC-LV-INDIC    PIC X.
  1904             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1905             20  AG-LRCALC-LV-INDIC    PIC X.
  1906             20  FILLER                PIC X(05).
  1907     12  FILLER                  PIC X(145).
  1908******************************************************************
  1909*    COPY ERCRESS.
  1910******************************************************************
  1911*                                                                *
  1912*                            ERCRESS                             *
  1913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1914*                            VMOD=2.002                          *
  1915*                                                                *
  1916*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1917*                                                                *
  1918*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1919*   VSAM RESIDENT STATE TAX MASTER                              *
  1920*                                                                *
  1921*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1922*                                                                *
  1923*   FILE TYPE = VSAM,KSDS                                        *
  1924*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1925*                                                                *
  1926*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1927*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1928*                                                                *
  1929*   LOG = NO                                                     *
  1930*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1931*                                                                *
  1932*                                                                *
  1933******************************************************************
  1934
  1935 01  RESIDENT-STATE-TAX-MASTER.
  1936
  1937     10  ERRESS-PRIMARY-KEY.
  1938         15  RES-COMPANY-CD        PIC X.
  1939         15  RES-RESIDENT-STATE    PIC XX.
  1940         15  RES-COVERAGE-CATEGORY PIC X.
  1941         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1942*                                      YYYYMMDD
  1943*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1944
  1945     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  36
* EL050.cbl
  1946
  1947         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1948         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1949         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1950         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1951
  1952     10 RES-RECALC-SW              PIC   X.
  1953         88 RECALC                VALUE 'Y'.
  1954         88 NO-RECALC             VALUE 'N'.
  1955     10  RES-MAINT-BY              PIC X(4).
  1956     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1957     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1958*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  37
* EL050.cbl
  1960*    COPY ERCRESC.
  1961******************************************************************
  1962*                                                                *
  1963*                            ERCRESC                             *
  1964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1965*                            VMOD=2.003                          *
  1966*                                                                *
  1967*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1968*                                                                *
  1969*   FILE TYPE = VSAM,KSDS                                        *
  1970*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1971*                                                                *
  1972*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1973*       ALTERNATE PATH1 = NONE                                   *
  1974*                                                                *
  1975*   LOG = NO                                                     *
  1976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1977*                                                                *
  1978******************************************************************
  1979
  1980 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1981
  1982     10  ERRESC-RECORD-KEY.
  1983         15  RESC-COMPANY-CD           PIC   X.
  1984         15  RESC-CARRIER              PIC   X.
  1985         15  RESC-GROUP                PIC   X(6).
  1986         15  RESC-STATE                PIC   XX.
  1987         15  RESC-ACCOUNT              PIC   X(10).
  1988         15  RESC-AGENT                PIC   X(10).
  1989         15  RESC-RESIDENT-STATE       PIC   XX.
  1990         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1991*                                           YYYYMMDD
  1992     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1993
  1994     10  RESC-COMM-RECORD-DATA.
  1995         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1996             20 RESC-COVERAGE-CAT      PIC    X.
  1997             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1998             20 RESC-COMMISSION-TAB REDEFINES
  1999                RESC-COMMISSION-PER    PIC  XXX.
  2000
  2001     10  RESC-MAINT-BY                 PIC X(4).
  2002     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2003     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2004*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  38
* EL050.cbl
  2006*    COPY ERCPLAN.
  2007******************************************************************
  2008*                                                                *
  2009*                                                                *
  2010*                            ERCPLAN                             *
  2011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2012*                            VMOD=2.003                          *
  2013*                                                                *
  2014*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2015*                                                                *
  2016*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2017*   PLAN MASTER                                                  *
  2018*                                                                *
  2019*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2020*                                                                *
  2021*   FILE TYPE = VSAM,KSDS                                        *
  2022*   RECORD SIZE = 420   RECFORM = FIX                            *
  2023*                                                                *
  2024*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2025*       ALTERNATE PATH1 = N/A                                    *
  2026*                                                                *
  2027*   LOG = NO                                                     *
  2028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2029*                                                                *
  2030*                                                                *
  2031******************************************************************
  2032
  2033 01  PLAN-MASTER.
  2034     12  PL-RECORD-ID                      PIC XX.
  2035         88  VALID-PL-ID                      VALUE 'PL'.
  2036
  2037     12  PL-CONTROL-PRIMARY.
  2038         16  PL-COMPANY-CD                 PIC X.
  2039         16  PL-MSTR-CNTRL.
  2040             20  PL-CONTROL-A.
  2041                 24  PL-CARRIER            PIC X.
  2042                 24  PL-GROUPING           PIC X(6).
  2043                 24  PL-STATE              PIC XX.
  2044                 24  PL-ACCOUNT            PIC X(10).
  2045             20  PL-BENEFIT-TYPE           PIC X.
  2046             20  PL-BENEFIT-CODE           PIC XX.
  2047             20  PL-REVISION-NO            PIC X(3).
  2048
  2049     12  PL-CONTROL-BY-VAR-GRP.
  2050         16  PL-COMPANY-CD-A1              PIC X.
  2051         16  PL-VG-CARRIER                 PIC X.
  2052         16  PL-VG-GROUPING                PIC X(6).
  2053         16  PL-VG-STATE                   PIC XX.
  2054         16  PL-VG-ACCOUNT                 PIC X(10).
  2055         16  PL-BENEFIT-TYPE-A1            PIC X.
  2056         16  PL-BENEFIT-CODE-A1            PIC XX.
  2057         16  PL-REVISION-NO-A1             PIC 999.
  2058
  2059     12  PL-MAINT-INFORMATION.
  2060         16  PL-LAST-MAINT-DT              PIC XX.
  2061         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2062         16  PL-LAST-MAINT-USER            PIC X(4).
  2063         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  39
* EL050.cbl
  2064
  2065     12  PL-LIABILITY-LIMITS.
  2066         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2067         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2068             20  PL-LM-AGE                 PIC S99        COMP-3.
  2069             20  PL-LM-DUR                 PIC S999       COMP-3.
  2070             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2071             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2072
  2073     12  FILLER                            PIC X(30).
  2074
  2075     12  PL-GL-ACCOUNT-NOS.
  2076         16  PL-PREMIUM-GL                 PIC X(8).
  2077         16  PL-COMM-GL                    PIC X(8).
  2078         16  PL-CLAIM-GL                   PIC X(8).
  2079     12  FILLER                            PIC X(24).
  2080     12  PL-TOLERANCES.
  2081         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2082         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2083         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2084         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2085         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2086         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2087     12  PL-OVER-SHORT.
  2088         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2089         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2090     12  FILLER                            PIC X(24).
  2091     12  PLAN-MISC.
  2092         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2093         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2094         16  PL-IG                         PIC X.
  2095         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2096         16  PL-POLICY-FORM                PIC X(12).
  2097         16  PL-EDIT-FOR-FORM              PIC X(01).
  2098         16  PL-DEV-CODE                   PIC XXX.
  2099         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2100         16  PL-CALC-METHOD                PIC X.
  2101         16  PL-BENEFIT-GROUP              PIC X(05).
  2102         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2103
  2104         16  FILLER                        PIC X(99).
  2105******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  40
* EL050.cbl
  2107*    COPY ELCCERT.
  2108******************************************************************
  2109*                                                                *
  2110*                            ELCCERT.                            *
  2111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2112*                            VMOD=2.013                          *
  2113*                                                                *
  2114*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2115*                                                                *
  2116*   FILE TYPE = VSAM,KSDS                                        *
  2117*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2118*                                                                *
  2119*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2120*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2121*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2122*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2123*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2124*                                                                *
  2125*   LOG = YES                                                    *
  2126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2127******************************************************************
  2128*                   C H A N G E   L O G
  2129*
  2130* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2131*-----------------------------------------------------------------
  2132*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2133* EFFECTIVE    NUMBER
  2134*-----------------------------------------------------------------
  2135* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2136* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2137* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2138* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2139* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2140* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2141* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2142* 032612  CR2011110200001  PEMA  AHL CHANGES
  2143* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2144* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2145******************************************************************
  2146
  2147 01  CERTIFICATE-MASTER.
  2148     12  CM-RECORD-ID                      PIC XX.
  2149         88  VALID-CM-ID                      VALUE 'CM'.
  2150
  2151     12  CM-CONTROL-PRIMARY.
  2152         16  CM-COMPANY-CD                 PIC X.
  2153         16  CM-CARRIER                    PIC X.
  2154         16  CM-GROUPING.
  2155             20  CM-GROUPING-PREFIX        PIC X(3).
  2156             20  CM-GROUPING-PRIME         PIC X(3).
  2157         16  CM-STATE                      PIC XX.
  2158         16  CM-ACCOUNT.
  2159             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2160             20  CM-ACCOUNT-PRIME          PIC X(6).
  2161         16  CM-CERT-EFF-DT                PIC XX.
  2162         16  CM-CERT-NO.
  2163             20  CM-CERT-PRIME             PIC X(10).
  2164             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  41
* EL050.cbl
  2165
  2166     12  CM-CONTROL-BY-NAME.
  2167         16  CM-COMPANY-CD-A1              PIC X.
  2168         16  CM-INSURED-LAST-NAME          PIC X(15).
  2169         16  CM-INSURED-INITIALS.
  2170             20  CM-INSURED-INITIAL1       PIC X.
  2171             20  CM-INSURED-INITIAL2       PIC X.
  2172
  2173     12  CM-CONTROL-BY-SSN.
  2174         16  CM-COMPANY-CD-A2              PIC X.
  2175         16  CM-SOC-SEC-NO.
  2176             20  CM-SSN-STATE              PIC XX.
  2177             20  CM-SSN-ACCOUNT            PIC X(6).
  2178             20  CM-SSN-LN3.
  2179                 25  CM-INSURED-INITIALS-A2.
  2180                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2181                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2182                 25 CM-PART-LAST-NAME-A2         PIC X.
  2183
  2184     12  CM-CONTROL-BY-CERT-NO.
  2185         16  CM-COMPANY-CD-A4              PIC X.
  2186         16  CM-CERT-NO-A4                 PIC X(11).
  2187
  2188     12  CM-CONTROL-BY-MEMB.
  2189         16  CM-COMPANY-CD-A5              PIC X.
  2190         16  CM-MEMBER-NO.
  2191             20  CM-MEMB-STATE             PIC XX.
  2192             20  CM-MEMB-ACCOUNT           PIC X(6).
  2193             20  CM-MEMB-LN4.
  2194                 25  CM-INSURED-INITIALS-A5.
  2195                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2196                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2197                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2198
  2199     12  CM-INSURED-PROFILE-DATA.
  2200         16  CM-INSURED-FIRST-NAME.
  2201             20  CM-INSURED-1ST-INIT       PIC X.
  2202             20  FILLER                    PIC X(9).
  2203         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2204         16  CM-INSURED-SEX                PIC X.
  2205             88  CM-SEX-MALE                  VALUE 'M'.
  2206             88  CM-SEX-FEMAL                 VALUE 'F'.
  2207         16  CM-INSURED-JOINT-AGE          PIC 99.
  2208         16  CM-JOINT-INSURED-NAME.
  2209             20  CM-JT-LAST-NAME           PIC X(15).
  2210             20  CM-JT-FIRST-NAME.
  2211                 24  CM-JT-1ST-INIT        PIC X.
  2212                 24  FILLER                PIC X(9).
  2213             20  CM-JT-INITIAL             PIC X.
  2214
  2215     12  CM-LIFE-DATA.
  2216         16  CM-LF-BENEFIT-CD              PIC XX.
  2217         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2218         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2219         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2220         16  CM-LF-DEV-CODE                PIC XXX.
  2221         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2222         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  42
* EL050.cbl
  2223         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2227         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2228         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2229         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2230         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2231         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2232         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2233         16  cm-temp-epiq                  pic xx.
  2234             88  EPIQ-CLASS                  value 'EQ'.
  2235*        16  FILLER                        PIC XX.
  2236
  2237     12  CM-AH-DATA.
  2238         16  CM-AH-BENEFIT-CD              PIC XX.
  2239         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2240         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2241         16  CM-AH-DEV-CODE                PIC XXX.
  2242         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2243         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2246         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2247         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2248         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2249         16  CM-AH-PAID-THRU-DT            PIC XX.
  2250             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2251         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2252         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2253         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2254         16  FILLER                        PIC X.
  2255
  2256     12  CM-LOAN-INFORMATION.
  2257         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2258         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2259                                           PIC S9(5)V99  COMP-3.
  2260         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2261         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2262         16  CM-PAY-FREQUENCY              PIC S99.
  2263         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2264         16  CM-RATE-CLASS                 PIC XX.
  2265         16  CM-BENEFICIARY                PIC X(25).
  2266         16  CM-POLICY-FORM-NO             PIC X(12).
  2267         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2268         16  CM-LAST-ADD-ON-DT             PIC XX.
  2269         16  CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2271             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2272         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2273             20  CM-RESIDENT-STATE         PIC XX.
  2274             20  CM-RATE-CODE              PIC X(4).
  2275             20  FILLER                    PIC XX.
  2276         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2277             20  CM-LOAN-OFFICER           PIC X(5).
  2278             20  FILLER                    PIC XXX.
  2279         16  CM-CSR-CODE                   PIC XXX.
  2280         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  43
* EL050.cbl
  2281             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2282         16  CM-POST-CARD-IND              PIC X.
  2283         16  CM-NH-INTERFACE-SW            PIC X.
  2284         16  CM-PREMIUM-TYPE               PIC X.
  2285             88  CM-SING-PRM                  VALUE '1'.
  2286             88  CM-O-B-COVERAGE              VALUE '2'.
  2287             88  CM-OPEN-END                  VALUE '3'.
  2288         16  CM-IND-GRP-TYPE               PIC X.
  2289             88  CM-INDIVIDUAL                VALUE 'I'.
  2290             88  CM-GROUP                     VALUE 'G'.
  2291         16  CM-SKIP-CODE                  PIC X.
  2292             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2293             88  SKIP-JULY                    VALUE '1'.
  2294             88  SKIP-AUGUST                  VALUE '2'.
  2295             88  SKIP-SEPTEMBER               VALUE '3'.
  2296             88  SKIP-JULY-AUG                VALUE '4'.
  2297             88  SKIP-AUG-SEPT                VALUE '5'.
  2298             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2299             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2300             88  SKIP-JUNE                    VALUE '8'.
  2301             88  SKIP-JUNE-JULY               VALUE '9'.
  2302             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2303             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2304         16  CM-PAYMENT-MODE               PIC X.
  2305             88  PAY-MONTHLY                  VALUE SPACE.
  2306             88  PAY-WEEKLY                   VALUE '1'.
  2307             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2308             88  PAY-BI-WEEKLY                VALUE '3'.
  2309             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2310         16  CM-LOAN-NUMBER                PIC X(8).
  2311         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2312         16  CM-OLD-LOF                    PIC XXX.
  2313*        16  CM-LOAN-OFFICER               PIC XXX.
  2314         16  CM-REIN-TABLE                 PIC XXX.
  2315         16  CM-SPECIAL-REIN-CODE          PIC X.
  2316         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2317         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2318         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2319
  2320     12  CM-STATUS-DATA.
  2321         16  CM-ENTRY-STATUS               PIC X.
  2322         16  CM-ENTRY-DT                   PIC XX.
  2323
  2324         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2325         16  CM-LF-CANCEL-DT               PIC XX.
  2326         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2327
  2328         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2329         16  CM-LF-DEATH-DT                PIC XX.
  2330         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2331
  2332         16  CM-LF-CURRENT-STATUS          PIC X.
  2333             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2334                                                'M' '4' '5' '9'.
  2335             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2336             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2337             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2338             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  44
* EL050.cbl
  2339             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2340             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2341             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2342             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2343             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2344             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2345             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2346             88  CM-LF-DECLINED               VALUE 'D'.
  2347             88  CM-LF-VOIDED                 VALUE 'V'.
  2348
  2349         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2350         16  CM-AH-CANCEL-DT               PIC XX.
  2351         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2352
  2353         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2354         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2355         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2356
  2357         16  CM-AH-CURRENT-STATUS          PIC X.
  2358             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2359                                                'M' '4' '5' '9'.
  2360             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2361             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2362             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2363             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2364             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2365             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2366             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2367             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2368             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2369             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2370             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2371             88  CM-AH-DECLINED               VALUE 'D'.
  2372             88  CM-AH-VOIDED                 VALUE 'V'.
  2373
  2374         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2375             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2376             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2377             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2378         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2379
  2380         16  CM-ENTRY-BATCH                PIC X(6).
  2381         16  CM-LF-EXIT-BATCH              PIC X(6).
  2382         16  CM-AH-EXIT-BATCH              PIC X(6).
  2383         16  CM-LAST-MONTH-END             PIC XX.
  2384
  2385     12  CM-NOTE-SW                        PIC X.
  2386         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2387         88  CERT-NOTES-PRESENT               VALUE '1'.
  2388         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2389         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2390         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2391         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2392         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2393         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2394     12  CM-COMP-EXCP-SW                   PIC X.
  2395         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2396         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  45
* EL050.cbl
  2397     12  CM-INSURED-ADDRESS-SW             PIC X.
  2398         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2399         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2400
  2401*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2402     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2403     12  FILLER                            PIC X.
  2404
  2405*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2407     12  FILLER                            PIC X.
  2408*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2409     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2410
  2411     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2412         88  CERT-ADDED-BATCH                 VALUE ' '.
  2413         88  CERT-ADDED-ONLINE                VALUE '1'.
  2414         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2415         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2416         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2417     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2418         88  CERT-AS-LOADED                   VALUE ' '.
  2419         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2420         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2421         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2422         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2423         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2424         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2425         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2426
  2427     12  CM-ACCOUNT-COMM-PCTS.
  2428         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2429         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2430
  2431     12  CM-USER-FIELD                     PIC X.
  2432     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2433     12  CM-CLP-STATE                      PIC XX.
  2434     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2435     12  CM-USER-RESERVED                  PIC XXX.
  2436     12  FILLER REDEFINES CM-USER-RESERVED.
  2437         16  CM-AH-CLASS-CD                PIC XX.
  2438         16  F                             PIC X.
  2439******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  46
* EL050.cbl
  2441*    COPY ERCMAIL.
  2442******************************************************************
  2443*                                                                *
  2444*                                                                *
  2445*                            ERCMAIL                             *
  2446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2447*                            VMOD=2.003                          *
  2448*                                                                *
  2449*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2450*                                                                *
  2451*   FILE TYPE = VSAM,KSDS                                        *
  2452*   RECORD SIZE = 374   RECFORM = FIX                            *
  2453*                                                                *
  2454*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2455*   ALTERNATE PATH    = NOT USED                                 *
  2456*                                                                *
  2457*   LOG = YES                                                    *
  2458*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2459******************************************************************
  2460*                   C H A N G E   L O G
  2461*
  2462* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2463*-----------------------------------------------------------------
  2464*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2465* EFFECTIVE    NUMBER
  2466*-----------------------------------------------------------------
  2467* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2468* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2469* 111108                   PEMA  ADD CRED BENE ADDR2
  2470******************************************************************
  2471
  2472 01  MAILING-DATA.
  2473     12  MA-RECORD-ID                      PIC XX.
  2474         88  VALID-MA-ID                       VALUE 'MA'.
  2475
  2476     12  MA-CONTROL-PRIMARY.
  2477         16  MA-COMPANY-CD                 PIC X.
  2478         16  MA-CARRIER                    PIC X.
  2479         16  MA-GROUPING.
  2480             20  MA-GROUPING-PREFIX        PIC XXX.
  2481             20  MA-GROUPING-PRIME         PIC XXX.
  2482         16  MA-STATE                      PIC XX.
  2483         16  MA-ACCOUNT.
  2484             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2485             20  MA-ACCOUNT-PRIME          PIC X(6).
  2486         16  MA-CERT-EFF-DT                PIC XX.
  2487         16  MA-CERT-NO.
  2488             20  MA-CERT-PRIME             PIC X(10).
  2489             20  MA-CERT-SFX               PIC X.
  2490
  2491     12  FILLER                            PIC XX.
  2492
  2493     12  MA-ACCESS-CONTROL.
  2494         16  MA-SOURCE-SYSTEM              PIC XX.
  2495             88  MA-FROM-CREDIT                VALUE 'CR'.
  2496             88  MA-FROM-VSI                   VALUE 'VS'.
  2497             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2498             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  47
* EL050.cbl
  2499         16  MA-RECORD-ADD-DT              PIC XX.
  2500         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2501         16  MA-LAST-MAINT-DT              PIC XX.
  2502         16  MA-LAST-MAINT-BY              PIC XXXX.
  2503         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2504
  2505     12  MA-PROFILE-INFO.
  2506         16  MA-QUALIFY-CODE-1             PIC XX.
  2507         16  MA-QUALIFY-CODE-2             PIC XX.
  2508         16  MA-QUALIFY-CODE-3             PIC XX.
  2509         16  MA-QUALIFY-CODE-4             PIC XX.
  2510         16  MA-QUALIFY-CODE-5             PIC XX.
  2511
  2512         16  MA-INSURED-LAST-NAME          PIC X(15).
  2513         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2514         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2515         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2516         16  MA-INSURED-BIRTH-DT           PIC XX.
  2517         16  MA-INSURED-SEX                PIC X.
  2518             88  MA-SEX-MALE                   VALUE 'M'.
  2519             88  MA-SEX-FEMALE                 VALUE 'F'.
  2520         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2521
  2522         16  MA-ADDRESS-CORRECTED          PIC X.
  2523         16  MA-JOINT-BIRTH-DT             PIC XX.
  2524*        16  FILLER                        PIC X(12).
  2525
  2526         16  MA-ADDRESS-LINE-1             PIC X(30).
  2527         16  MA-ADDRESS-LINE-2             PIC X(30).
  2528         16  MA-CITY-STATE.
  2529             20  MA-CITY                   PIC X(28).
  2530             20  MA-ADDR-STATE             PIC XX.
  2531         16  MA-ZIP.
  2532             20  MA-ZIP-CODE.
  2533                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2534                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2535                 24  FILLER                PIC X(4).
  2536             20  MA-ZIP-PLUS4              PIC X(4).
  2537         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2538             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2539             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2540             20  FILLER                    PIC X(3).
  2541
  2542         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2543
  2544         16  FILLER                        PIC XXX.
  2545*        16  FILLER                        PIC X(10).
  2546
  2547     12  MA-CRED-BENE-INFO.
  2548         16  MA-CRED-BENE-NAME                 PIC X(25).
  2549         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2550         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2551         16  MA-CRED-BENE-CTYST.
  2552             20  MA-CRED-BENE-CITY             PIC X(28).
  2553             20  MA-CRED-BENE-STATE            PIC XX.
  2554         16  MA-CRED-BENE-ZIP.
  2555             20  MA-CB-ZIP-CODE.
  2556                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  48
* EL050.cbl
  2557                     88  MA-CB-CANADIAN-POST-CODE
  2558                                           VALUE 'A' THRU 'Z'.
  2559                 24  FILLER                    PIC X(4).
  2560             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2561         16  MA-CB-CANADIAN-POSTAL-CODE
  2562                            REDEFINES MA-CRED-BENE-ZIP.
  2563             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2564             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2565             20  FILLER                        PIC X(3).
  2566     12  MA-POST-CARD-MAIL-DATA.
  2567         16  MA-MAIL-DATA OCCURS 7.
  2568             20  MA-MAIL-TYPE              PIC X.
  2569                 88  MA-12MO-MAILING           VALUE '1'.
  2570                 88  MA-EXP-MAILING            VALUE '2'.
  2571             20  MA-MAIL-STATUS            PIC X.
  2572                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2573                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2574                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2575             20  MA-MAIL-DATE              PIC XX.
  2576     12  FILLER                            PIC XX.
  2577     12  FILLER                            PIC XX.
  2578*    12  FILLER                            PIC X(30).
  2579******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  49
* EL050.cbl
  2581*    COPY ERCPNDM.
  2582******************************************************************
  2583*                                                                *
  2584*                                                                *
  2585*                            ERCPNDM                             *
  2586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2587*                            VMOD=2.003                          *
  2588*                                                                *
  2589*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2590*                                                                *
  2591*   FILE TYPE = VSAM,KSDS                                        *
  2592*   RECORD SIZE = 374   RECFORM = FIX                            *
  2593*                                                                *
  2594*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2595*   ALTERNATE PATH    = NOT USED                                 *
  2596*                                                                *
  2597*   LOG = YES                                                    *
  2598*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2599******************************************************************
  2600*                   C H A N G E   L O G
  2601*
  2602* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2603*-----------------------------------------------------------------
  2604*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2605* EFFECTIVE    NUMBER
  2606*-----------------------------------------------------------------
  2607* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2608* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2609* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2610******************************************************************
  2611
  2612 01  PENDING-MAILING-DATA.
  2613     12  PM-RECORD-ID                      PIC XX.
  2614         88  VALID-MA-ID                       VALUE 'PM'.
  2615
  2616     12  PM-CONTROL-PRIMARY.
  2617         16  PM-COMPANY-CD                 PIC X.
  2618         16  PM-ENTRY-BATCH                PIC X(6).
  2619         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2620         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2621
  2622     12  FILLER                            PIC X(14).
  2623
  2624     12  PM-ACCESS-CONTROL.
  2625         16  PM-SOURCE-SYSTEM              PIC XX.
  2626             88  PM-FROM-CREDIT                VALUE 'CR'.
  2627             88  PM-FROM-VSI                   VALUE 'VS'.
  2628             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2629             88  PM-FROM-OTHER                 VALUE 'OT'.
  2630         16  PM-RECORD-ADD-DT              PIC XX.
  2631         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2632         16  PM-LAST-MAINT-DT              PIC XX.
  2633         16  PM-LAST-MAINT-BY              PIC XXXX.
  2634         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2635
  2636     12  PM-PROFILE-INFO.
  2637         16  PM-QUALIFY-CODE-1             PIC XX.
  2638         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  50
* EL050.cbl
  2639         16  PM-QUALIFY-CODE-3             PIC XX.
  2640         16  PM-QUALIFY-CODE-4             PIC XX.
  2641         16  PM-QUALIFY-CODE-5             PIC XX.
  2642
  2643         16  PM-INSURED-LAST-NAME          PIC X(15).
  2644         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2645         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2646         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2647         16  PM-INSURED-BIRTH-DT           PIC XX.
  2648         16  PM-INSURED-SEX                PIC X.
  2649             88  PM-SEX-MALE                   VALUE 'M'.
  2650             88  PM-SEX-FEMALE                 VALUE 'F'.
  2651         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2652
  2653         16  PM-ADDRESS-CORRECTED          PIC X.
  2654         16  PM-JOINT-BIRTH-DT             PIC XX.
  2655*        16  FILLER                        PIC X(12).
  2656
  2657         16  PM-ADDRESS-LINE-1             PIC X(30).
  2658         16  PM-ADDRESS-LINE-2             PIC X(30).
  2659         16  PM-CITY-STATE.
  2660             20  PM-CITY                   PIC X(28).
  2661             20  PM-STATE                  PIC XX.
  2662         16  PM-ZIP.
  2663             20  PM-ZIP-CODE.
  2664                 24  PM-ZIP-1              PIC X.
  2665                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2666                 24  FILLER                PIC X(4).
  2667             20  PM-ZIP-PLUS4              PIC X(4).
  2668         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2669             20  PM-CAN-POST1              PIC XXX.
  2670             20  PM-CAN-POST2              PIC XXX.
  2671             20  FILLER                    PIC XXX.
  2672
  2673         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2674
  2675         16  FILLER                        PIC X(03).
  2676
  2677     12  PM-CRED-BENE-INFO.
  2678         16  PM-CRED-BENE-NAME             PIC X(25).
  2679         16  PM-CRED-BENE-ADDR             PIC X(30).
  2680         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2681         16  PM-CRED-BENE-CTYST.
  2682             20  PM-CRED-BENE-CITY         PIC X(28).
  2683             20  PM-CRED-BENE-STATE        PIC XX.
  2684         16  PM-CRED-BENE-ZIP.
  2685             20  PM-CB-ZIP-CODE.
  2686                 24  PM-CB-ZIP-1           PIC X.
  2687                     88  PM-CB-CANADIAN-POST-CODE
  2688                                  VALUE 'A' THRU 'Z'.
  2689                 24  FILLER                PIC X(4).
  2690             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2691         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2692             20  PM-CB-CAN-POST1           PIC XXX.
  2693             20  PM-CB-CAN-POST2           PIC XXX.
  2694             20  FILLER                    PIC XXX.
  2695     12  PM-POST-CARD-MAIL-DATA.
  2696         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  51
* EL050.cbl
  2697             20  PM-MAIL-TYPE              PIC X.
  2698                 88  PM-12MO-MAILING           VALUE '1'.
  2699                 88  PM-EXP-MAILING            VALUE '2'.
  2700             20  PM-MAIL-STATUS            PIC X.
  2701                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2702                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2703                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2704             20  PM-MAIL-DATE              PIC XX.
  2705     12  FILLER                            PIC XX.
  2706     12  FILLER                            PIC X(12).
  2707*    12  FILLER                            PIC X(30).
  2708
  2709******************************************************************
  2710*                                COPY ERCLOFC.
  2711******************************************************************
  2712*                                                                *
  2713*                                                                *
  2714*                            ERCLOFC                             *
  2715*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2716*                            VMOD=2.003                          *
  2717*                                                                *
  2718*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2719*                                                                *
  2720*   FILE TYPE = VSAM,KSDS                                        *
  2721*   RECORD SIZE = 670   RECFORM = FIX                            *
  2722*                                                                *
  2723*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2724*                                                                *
  2725*   LOG = YES                                                    *
  2726*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2727*                                                                *
  2728******************************************************************
  2729
  2730 01  LOAN-OFFICER-MASTER.
  2731     12  LO-RECORD-ID                PIC XX.
  2732         88  VALID-LO-ID                VALUE 'LO'.
  2733
  2734     12  LO-CONTROL-PRIMARY.
  2735         16  LO-COMPANY-CD           PIC X.
  2736         16  LO-CARRIER              PIC X.
  2737         16  LO-GROUPING.
  2738             20  LO-GROUPING-PREFIX  PIC XXX.
  2739             20  LO-GROUPING-PRIME   PIC XXX.
  2740         16  LO-STATE                PIC XX.
  2741         16  LO-ACCOUNT.
  2742             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2743             20  LO-ACCOUNT-PRIME    PIC X(6).
  2744         16  LO-OFFICER-CODE         PIC X(5).
  2745
  2746     12  LO-OFFICER-NAME             PIC X(30).
  2747
  2748     12  LO-LAST-MAINT-DT            PIC XX.
  2749     12  LO-LAST-USER                PIC X(4).
  2750     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2751
  2752     12  LO-COMP-CONTROL             PIC X.
  2753             88  LO-SHOW-COMP           VALUE 'Y'.
  2754             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  52
* EL050.cbl
  2755     12  LO-DETAIL-CONTROL           PIC X.
  2756             88  LO-PRINT-DETAIL        VALUE 'D'.
  2757             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2758
  2759     12  LO-SV-CARRIER               PIC X.
  2760     12  LO-SV-GROUPING              PIC X(6).
  2761     12  LO-SV-STATE                 PIC XX.
  2762
  2763     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2764     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2765
  2766     12  LO-OFFICER-INFO.
  2767         16  FILLER OCCURS 12 TIMES.
  2768             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2769             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2770             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2772             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2773             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2774             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2775             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2776     12  FILLER                      PIC X(198).
  2777******************************************************************
  2778*                                COPY ERCPDEF.
  2779******************************************************************
  2780*                                                                *
  2781*                                                                *
  2782*                            ERCPDEF.                            *
  2783*                                                                *
  2784*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2785*                                                                *
  2786*    FILE TYPE = VSAM,KSDS                                       *
  2787*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2788*                                                                *
  2789*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2790*                                                                *
  2791*    LOG = YES                                                   *
  2792*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2793******************************************************************
  2794*                   C H A N G E   L O G
  2795*
  2796* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2797*-----------------------------------------------------------------
  2798*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2799* EFFECTIVE    NUMBER
  2800*-----------------------------------------------------------------
  2801* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2802* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2803* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2804******************************************************************
  2805 01  PRODUCT-MASTER.
  2806    12  PD-RECORD-ID                 PIC X(02).
  2807        88  VALID-PD-ID                  VALUE 'PD'.
  2808    12  PD-CONTROL-PRIMARY.
  2809        16  PD-COMPANY-CD            PIC X.
  2810        16  PD-STATE                 PIC XX.
  2811        16  PD-PRODUCT-CD            PIC XXX.
  2812        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  53
* EL050.cbl
  2813        16  PD-BEN-TYPE              PIC X.
  2814        16  PD-BEN-CODE              PIC XX.
  2815        16  PD-PROD-EXP-DT           PIC XX.
  2816    12  FILLER                       PIC X(50).
  2817    12  PD-PRODUCT-DATA OCCURS 8.
  2818        16  PD-PROD-CODE             PIC X.
  2819            88  PD-PROD-LIFE           VALUE 'L'.
  2820            88  PD-PROD-PROP           VALUE 'P'.
  2821            88  PD-PROD-AH             VALUE 'A'.
  2822            88  PD-PROD-IU             VALUE 'I'.
  2823            88  PD-PROD-GAP            VALUE 'G'.
  2824            88  PD-PROD-FAML           VALUE 'F'.
  2825        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2826        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2827        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2828        16  PD-MAX-TERM              PIC S999        COMP-3.
  2829        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2830        16  FILLER                   PIC X.
  2831        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2832        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2833        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2834        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2835        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2836        16  PD-REC-CRIT-PERIOD       PIC 99.
  2837        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2838            20  PD-RECURRING-YN      PIC X.
  2839            20  FILLER               PIC X.
  2840        16  PD-RTW-MOS               PIC 99.
  2841        16  PD-MAX-EXTENSION         PIC 99.
  2842        16  pd-ben-pct               pic sv999 comp-3.
  2843*       16  FILLER                   PIC XX.
  2844    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2845    12  PD-TERM-LIMITS OCCURS 15.
  2846        16  PD-LOW-TERM              PIC S999        COMP-3.
  2847        16  PD-HI-TERM               PIC S999        COMP-3.
  2848*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2849    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2850        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2851        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2852    12  PD-EARN-FACTORS.
  2853        16  FILLER OCCURS 15.
  2854            20  FILLER OCCURS 15.
  2855                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2856    12  PD-PRODUCT-DESC              PIC X(80).
  2857    12  PD-TRUNCATED                 PIC X.
  2858    12  FILLER                       PIC X(59).
  2859    12  PD-MAINT-INFORMATION.
  2860        16  PD-LAST-MAINT-DT         PIC X(02).
  2861        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2862        16  PD-LAST-MAINT-BY         PIC X(04).
  2863*                                COPY ELCSTATE.
  2864******************************************************************
  2865*                                                                *
  2866*                                                                *
  2867*                            ELCSTATE.                           *
  2868*                                                                *
  2869*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2870*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  54
* EL050.cbl
  2871*   FILE TYPE = VSAM,KSDS                                        *
  2872*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2873*                                                                *
  2874*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2875*       ALTERNATE INDEX = NONE                                   *
  2876*                                                                *
  2877*   LOG = YES                                                    *
  2878*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2879******************************************************************
  2880*                   C H A N G E   L O G
  2881*
  2882* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2883*-----------------------------------------------------------------
  2884*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2885* EFFECTIVE    NUMBER
  2886*-----------------------------------------------------------------
  2887* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2888******************************************************************
  2889*
  2890 01  STATE-FILE.
  2891     12  SF-RECORD-ID                       PIC XX.
  2892         88  VALID-CF-ID                        VALUE 'SF'.
  2893     12  SF-CONTROL-PRIMARY.
  2894         16  SF-COMPANY-ID                  PIC XXX.
  2895         16  SF-CARRIER-CODE                PIC X.
  2896         16  SF-GROUPING                    PIC X(6).
  2897         16  SF-STATE-CODE                  PIC XX.
  2898         16  SF-EXPIRE-DATE                 PIC 9(8).
  2899****************************************************************
  2900*             STATE CONTROLS
  2901****************************************************************
  2902     12  SF-LAST-MAINT-DT                   PIC XX.
  2903     12  SF-LAST-MAINT-BY                   PIC X(4).
  2904     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2905     12  SF-STATE-RT-CONTROLS.
  2906         16  SF-ST-RT-CALC                  PIC X.
  2907     12  SF-ST-TAX-CONTROLS.
  2908         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2909         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2910         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2911     12  SF-ST-REFUND-OPTIONS.
  2912         16  SF-ST-RF-LR-CALC               PIC X.
  2913         16  SF-ST-RF-LL-CALC               PIC X.
  2914         16  SF-ST-RF-LN-CALC               PIC X.
  2915         16  SF-ST-RF-AH-CALC               PIC X.
  2916         16  SF-ST-RF-CP-CALC               PIC X.
  2917     12  SF-ST-UNEARN-PREM-OPTIONS.
  2918         16  SF-ST-LUEP-R78                 PIC X.
  2919         16  SF-ST-LUEP-PRO                 PIC X.
  2920         16  SF-ST-LUEP-ST                  PIC X.
  2921         16  SF-ST-LUEP-DOM                 PIC X.
  2922         16  SF-ST-AUEP-R78                 PIC X.
  2923         16  SF-ST-AUEP-PRO                 PIC X.
  2924         16  SF-ST-AUEP-ST                  PIC X.
  2925         16  SF-ST-AUEP-DOM                 PIC X.
  2926         16  SF-ST-CUEP-R78                 PIC X.
  2927         16  SF-ST-CUEP-PRO                 PIC X.
  2928         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  55
* EL050.cbl
  2929         16  SF-ST-CUEP-DOM                 PIC X.
  2930     12  SF-ST-EARN-PREM-OPTIONS.
  2931         16  SF-ST-LEP-R78                  PIC X.
  2932         16  SF-ST-LEP-PRO                  PIC X.
  2933         16  SF-ST-LEP-ST                   PIC X.
  2934         16  SF-ST-LEP-DOM                  PIC X.
  2935         16  SF-ST-AEP-R78                  PIC X.
  2936         16  SF-ST-AEP-PRO                  PIC X.
  2937         16  SF-ST-AEP-ST                   PIC X.
  2938         16  SF-ST-AEP-DOM                  PIC X.
  2939         16  SF-ST-CEP-R78                  PIC X.
  2940         16  SF-ST-CEP-PRO                  PIC X.
  2941         16  SF-ST-CEP-ST                   PIC X.
  2942         16  SF-ST-CEP-DOM                  PIC X.
  2943     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  56
* EL050.cbl
  2945*    COPY ELCCRTT.
  2946******************************************************************
  2947*                                                                *
  2948*                            ELCCRTT.                            *
  2949*                                                                *
  2950*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2951*                                                                *
  2952*   FILE TYPE = VSAM,KSDS                                        *
  2953*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2954*                                                                *
  2955*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2956*                                                                *
  2957*   LOG = YES                                                    *
  2958*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2959******************************************************************
  2960*                   C H A N G E   L O G
  2961*
  2962* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2963*-----------------------------------------------------------------
  2964*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2965* EFFECTIVE    NUMBER
  2966*-----------------------------------------------------------------
  2967* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2968* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2969* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2970* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2971* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2972* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2973* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2974* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2975* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2976******************************************************************
  2977
  2978 01  CERTIFICATE-TRAILERS.
  2979     12  CS-RECORD-ID                      PIC XX.
  2980         88  VALID-CS-ID                      VALUE 'CS'.
  2981
  2982     12  CS-CONTROL-PRIMARY.
  2983         16  CS-COMPANY-CD                 PIC X.
  2984         16  CS-CARRIER                    PIC X.
  2985         16  CS-GROUPING                   PIC X(6).
  2986         16  CS-STATE                      PIC XX.
  2987         16  CS-ACCOUNT                    PIC X(10).
  2988         16  CS-CERT-EFF-DT                PIC XX.
  2989         16  CS-CERT-NO.
  2990             20  CS-CERT-PRIME             PIC X(10).
  2991             20  CS-CERT-SFX               PIC X.
  2992         16  CS-TRAILER-TYPE               PIC X.
  2993             88  COMM-TRLR           VALUE 'A'.
  2994             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2995             88  CERT-DATA-TRLR      VALUE 'C'.
  2996
  2997     12  CS-DATA-AREA                      PIC X(516).
  2998
  2999     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3000         16  CS-BANK-COMMISSION-AREA.
  3001             20  CS-BANK-COMMS       OCCURS 10.
  3002                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  57
* EL050.cbl
  3003                 24  CS-COM-TYP            PIC X.
  3004                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3005                 24  CS-RECALC-LV-INDIC    PIC X.
  3006                 24  FILLER                PIC X(10).
  3007         16  FILLER                        PIC X(256).
  3008
  3009     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3010****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3011         16  CS-MB-CLAIM-DATA OCCURS 24.
  3012             20  CS-CLAIM-NO               PIC X(7).
  3013             20  CS-CLAIM-TYPE             PIC X.
  3014                 88  CS-AH-CLM               VALUE 'A'.
  3015                 88  CS-IU-CLM               VALUE 'I'.
  3016                 88  CS-GP-CLM               VALUE 'G'.
  3017                 88  CS-LF-CLM               VALUE 'L'.
  3018                 88  CS-PR-CLM               VALUE 'P'.
  3019                 88  CS-FL-CLM               VALUE 'F'.
  3020             20  CS-INSURED-TYPE           PIC X.
  3021                 88  CS-PRIM-INSURED          VALUE 'P'.
  3022                 88  CS-CO-BORROWER           VALUE 'C'.
  3023             20  CS-BENEFIT-PERIOD         PIC 99.
  3024             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3025             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3026             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3027         16  FILLER                        PIC X(12).
  3028     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3029         16  CS-VIN-NUMBER                 PIC X(17).
  3030         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3031         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3032         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3033         16  cs-agent-name.
  3034             20  cs-agent-fname            pic x(20).
  3035             20  cs-agent-mi               pic x.
  3036             20  cs-agent-lname            pic x(25).
  3037         16  cs-license-no                 pic x(15).
  3038         16  cs-npn-number                 pic x(10).
  3039         16  cs-agent-edit-status          pic x.
  3040             88  cs-ae-refer-to-manager      value 'M'.
  3041             88  cs-ae-cover-sheet           value 'C'.
  3042             88  cs-ae-sig-form              value 'S'.
  3043             88  cs-ae-verified              value 'V'.
  3044             88  cs-unidentified-signature   value 'U'.
  3045             88  cs-cert-returned            value 'R'.
  3046             88  cs-accept-no-commission     value 'N'.
  3047         16  cs-year                       pic 9999.
  3048         16  cs-make                       pic x(20).
  3049         16  cs-model                      pic x(20).
  3050         16  cs-future                     pic x(20).
  3051         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3052         16  FILLER                        PIC X(356). *> was 420
  3053*        16  FILLER                        PIC X(496).
  3054*    COPY ELCCRTO.
  3055******************************************************************
  3056*                                                                *
  3057*                            ELCCRTO.                            *
  3058*                                                                *
  3059*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3060*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  58
* EL050.cbl
  3061*   FILE TYPE = VSAM,KSDS                                        *
  3062*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3063*                                                                *
  3064*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3065*                                                                *
  3066*   LOG = YES                                                    *
  3067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3068******************************************************************
  3069*                   C H A N G E   L O G
  3070*
  3071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3072*-----------------------------------------------------------------
  3073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3074* EFFECTIVE    NUMBER
  3075*-----------------------------------------------------------------
  3076* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3077* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3078* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3079* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3080* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3081******************************************************************
  3082 01  ORIGINAL-CERTIFICATE.
  3083     12  OC-RECORD-ID                      PIC XX.
  3084         88  VALID-OC-ID                      VALUE 'OC'.
  3085     12  OC-CONTROL-PRIMARY.
  3086         16  OC-COMPANY-CD                 PIC X.
  3087         16  OC-CARRIER                    PIC X.
  3088         16  OC-GROUPING                   PIC X(6).
  3089         16  OC-STATE                      PIC XX.
  3090         16  OC-ACCOUNT                    PIC X(10).
  3091         16  OC-CERT-EFF-DT                PIC XX.
  3092         16  OC-CERT-NO.
  3093             20  OC-CERT-PRIME             PIC X(10).
  3094             20  OC-CERT-SFX               PIC X.
  3095         16  OC-RECORD-TYPE                PIC X.
  3096         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3097     12  OC-LAST-MAINT-DT                  PIC XX.
  3098     12  OC-LAST-MAINT-BY                  PIC X(4).
  3099     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3100     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3101     12  FILLER                            PIC X(49).
  3102     12  OC-ORIG-REC.
  3103         16  OC-INS-LAST-NAME              PIC X(15).
  3104         16  OC-INS-FIRST-NAME             PIC X(10).
  3105         16  OC-INS-MIDDLE-INIT            PIC X.
  3106         16  OC-INS-AGE                    PIC S999     COMP-3.
  3107         16  OC-JNT-LAST-NAME              PIC X(15).
  3108         16  OC-JNT-FIRST-NAME             PIC X(10).
  3109         16  OC-JNT-MIDDLE-INIT            PIC X.
  3110         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3111         16  OC-LF-BENCD                   PIC XX.
  3112         16  OC-LF-TERM                    PIC S999      COMP-3.
  3113         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3114         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3115         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3116         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3117         16  OC-LF-EXP-DT                  PIC XX.
  3118         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  59
* EL050.cbl
  3119         16  OC-LF-CANCEL-DT               PIC XX.
  3120         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3121         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3122         16  OC-AH-BENCD                   PIC XX.
  3123         16  OC-AH-TERM                    PIC S999      COMP-3.
  3124         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3125         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3126         16  OC-AH-EXP-DT                  PIC XX.
  3127         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3128         16  OC-AH-CP                      PIC 99.
  3129         16  OC-AH-CANCEL-DT               PIC XX.
  3130         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3131         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3132         16  OC-CRED-BENE-NAME             PIC X(25).
  3133         16  OC-1ST-PMT-DT                 PIC XX.
  3134         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3135         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3136         16  OC-ISSUE-TRAN-IND             PIC X.
  3137         16  OC-CANCEL-TRAN-IND            PIC X.
  3138         16  FILLER                        PIC X(211).
  3139
  3140     12  FILLER                            PIC X(50).
  3141******************************************************************
  3142
  3143*    COPY ELCDATE.
  3144******************************************************************
  3145*                                                                *
  3146*                                                                *
  3147*                            ELCDATE.                            *
  3148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3149*                            VMOD=2.003
  3150*                                                                *
  3151*                                                                *
  3152*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3153*                 LENGTH = 200                                   *
  3154******************************************************************
  3155
  3156 01  DATE-CONVERSION-DATA.
  3157     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3158     12  DC-OPTION-CODE                PIC X.
  3159         88  BIN-TO-GREG                VALUE ' '.
  3160         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3161         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3162         88  YMD-GREG-TO-BIN            VALUE '3'.
  3163         88  MDY-GREG-TO-BIN            VALUE '4'.
  3164         88  JULIAN-TO-BIN              VALUE '5'.
  3165         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3166         88  FIND-CENTURY               VALUE '7'.
  3167         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3168         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3169         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3170         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3171         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3172         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3173         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3174         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3175         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3176         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  60
* EL050.cbl
  3177         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3178         88  BIN-3-TO-GREG              VALUE 'I'.
  3179         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3180         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3181         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3182         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3183         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3184         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3185         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3186         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3187         88  THREE-CHARACTER-BIN
  3188                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3189         88  GREGORIAN-TO-BIN
  3190                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3191         88  BIN-TO-GREGORIAN
  3192                  VALUES ' ' '1' 'I' '8' 'G'.
  3193         88  JULIAN-TO-BINARY
  3194                  VALUES '5' 'C' 'E' 'F'.
  3195     12  DC-ERROR-CODE                 PIC X.
  3196         88  NO-CONVERSION-ERROR        VALUE ' '.
  3197         88  DATE-CONVERSION-ERROR
  3198                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3199         88  DATE-IS-ZERO               VALUE '1'.
  3200         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3201         88  DATE-IS-INVALID            VALUE '3'.
  3202         88  DATE1-GREATER-DATE2        VALUE '4'.
  3203         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3204         88  DATE-INVALID-OPTION        VALUE '9'.
  3205         88  INVALID-CENTURY            VALUE 'A'.
  3206         88  ONLY-CENTURY               VALUE 'B'.
  3207         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3208         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3209     12  DC-END-OF-MONTH               PIC X.
  3210         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3211     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3212         88  USE-NORMAL-PROCESS         VALUE ' '.
  3213         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3214         88  ADJUST-UP-100-YRS          VALUE '2'.
  3215     12  FILLER                        PIC X.
  3216     12  DC-CONVERSION-DATES.
  3217         16  DC-BIN-DATE-1             PIC XX.
  3218         16  DC-BIN-DATE-2             PIC XX.
  3219         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3220         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3221                       DC-GREG-DATE-1-EDIT.
  3222             20  DC-EDIT1-MONTH        PIC 99.
  3223             20  SLASH1-1              PIC X.
  3224             20  DC-EDIT1-DAY          PIC 99.
  3225             20  SLASH1-2              PIC X.
  3226             20  DC-EDIT1-YEAR         PIC 99.
  3227         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3228         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3229                     DC-GREG-DATE-2-EDIT.
  3230             20  DC-EDIT2-MONTH        PIC 99.
  3231             20  SLASH2-1              PIC X.
  3232             20  DC-EDIT2-DAY          PIC 99.
  3233             20  SLASH2-2              PIC X.
  3234             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  61
* EL050.cbl
  3235         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3236         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3237                     DC-GREG-DATE-1-YMD.
  3238             20  DC-YMD-YEAR           PIC 99.
  3239             20  DC-YMD-MONTH          PIC 99.
  3240             20  DC-YMD-DAY            PIC 99.
  3241         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3242         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3243                      DC-GREG-DATE-1-MDY.
  3244             20  DC-MDY-MONTH          PIC 99.
  3245             20  DC-MDY-DAY            PIC 99.
  3246             20  DC-MDY-YEAR           PIC 99.
  3247         16  DC-GREG-DATE-1-ALPHA.
  3248             20  DC-ALPHA-MONTH        PIC X(10).
  3249             20  DC-ALPHA-DAY          PIC 99.
  3250             20  FILLER                PIC XX.
  3251             20  DC-ALPHA-CENTURY.
  3252                 24 DC-ALPHA-CEN-N     PIC 99.
  3253             20  DC-ALPHA-YEAR         PIC 99.
  3254         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3255         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3256         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3257         16  DC-JULIAN-DATE            PIC 9(05).
  3258         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3259                                       PIC 9(05).
  3260         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3261             20  DC-JULIAN-YEAR        PIC 99.
  3262             20  DC-JULIAN-DAYS        PIC 999.
  3263         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3264         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3265         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3266     12  DATE-CONVERSION-VARIBLES.
  3267         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3268         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3269             20  FILLER                PIC 9(3).
  3270             20  HOLD-CEN-1-CCYY.
  3271                 24  HOLD-CEN-1-CC     PIC 99.
  3272                 24  HOLD-CEN-1-YY     PIC 99.
  3273             20  HOLD-CEN-1-MO         PIC 99.
  3274             20  HOLD-CEN-1-DA         PIC 99.
  3275         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3276             20  HOLD-CEN-1-R-MO       PIC 99.
  3277             20  HOLD-CEN-1-R-DA       PIC 99.
  3278             20  HOLD-CEN-1-R-CCYY.
  3279                 24  HOLD-CEN-1-R-CC   PIC 99.
  3280                 24  HOLD-CEN-1-R-YY   PIC 99.
  3281             20  FILLER                PIC 9(3).
  3282         16  HOLD-CENTURY-1-X.
  3283             20  FILLER                PIC X(3)  VALUE SPACES.
  3284             20  HOLD-CEN-1-X-CCYY.
  3285                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3286                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3287             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3288             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3289         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3290             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3291             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3292             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  62
* EL050.cbl
  3293                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3294                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3295             20  FILLER                PIC XXX.
  3296         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3297         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3298         16  DC-JULIAN-DATE-1          PIC 9(07).
  3299         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3300             20  DC-JULIAN-1-CCYY.
  3301                 24  DC-JULIAN-1-CC    PIC 99.
  3302                 24  DC-JULIAN-1-YR    PIC 99.
  3303             20  DC-JULIAN-DA-1        PIC 999.
  3304         16  DC-JULIAN-DATE-2          PIC 9(07).
  3305         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3306             20  DC-JULIAN-2-CCYY.
  3307                 24  DC-JULIAN-2-CC    PIC 99.
  3308                 24  DC-JULIAN-2-YR    PIC 99.
  3309             20  DC-JULIAN-DA-2        PIC 999.
  3310         16  DC-GREG-DATE-A-EDIT.
  3311             20  DC-EDITA-MONTH        PIC 99.
  3312             20  SLASHA-1              PIC X VALUE '/'.
  3313             20  DC-EDITA-DAY          PIC 99.
  3314             20  SLASHA-2              PIC X VALUE '/'.
  3315             20  DC-EDITA-CCYY.
  3316                 24  DC-EDITA-CENT     PIC 99.
  3317                 24  DC-EDITA-YEAR     PIC 99.
  3318         16  DC-GREG-DATE-B-EDIT.
  3319             20  DC-EDITB-MONTH        PIC 99.
  3320             20  SLASHB-1              PIC X VALUE '/'.
  3321             20  DC-EDITB-DAY          PIC 99.
  3322             20  SLASHB-2              PIC X VALUE '/'.
  3323             20  DC-EDITB-CCYY.
  3324                 24  DC-EDITB-CENT     PIC 99.
  3325                 24  DC-EDITB-YEAR     PIC 99.
  3326         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3327         16  DC-GREG-DATE-CYMD-R REDEFINES
  3328                              DC-GREG-DATE-CYMD.
  3329             20  DC-CYMD-CEN           PIC 99.
  3330             20  DC-CYMD-YEAR          PIC 99.
  3331             20  DC-CYMD-MONTH         PIC 99.
  3332             20  DC-CYMD-DAY           PIC 99.
  3333         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3334         16  DC-GREG-DATE-MDCY-R REDEFINES
  3335                              DC-GREG-DATE-MDCY.
  3336             20  DC-MDCY-MONTH         PIC 99.
  3337             20  DC-MDCY-DAY           PIC 99.
  3338             20  DC-MDCY-CEN           PIC 99.
  3339             20  DC-MDCY-YEAR          PIC 99.
  3340    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3341        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3342    12  DC-EL310-DATE                  PIC X(21).
  3343    12  FILLER                         PIC X(28).
  3344
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  63
* EL050.cbl
  3346*    COPY ELCCALC.
  3347******************************************************************
  3348*                                                                *
  3349*                           ELCCALC.                            *
  3350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3351*                            VMOD=2.025                          *
  3352*                                                                *
  3353*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3354*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3355*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3356*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3357*                                                                *
  3358*  PASSED TO ELRTRM                                              *
  3359*  -----------------                                             *
  3360*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3361*  ORIGINAL TERM                                                 *
  3362*  BEGINNING DATE                                                *
  3363*  ENDING DATE                                                   *
  3364*  COMPANY I.D.                                                  *
  3365*  ACCOUNT MASTER USER FIELD                                     *
  3366*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3367*  FREE LOOK DAYS                                                *
  3368*                                                                *
  3369*  RETURNED FROM ELRTRM                                          *
  3370*  ---------------------                                         *
  3371*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3372*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3373*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3374*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3375*----------------------------------------------------------------*
  3376*  PASSED TO ELRAMT                                              *
  3377*  ----------------                                              *
  3378*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3379*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3380*  ORIGINAL AMOUNT                                               *
  3381*  ALTERNATE BENEFIT (BALLON)                                    *
  3382*  A.P.R. - NET PAY ONLY                                         *
  3383*  METHOD
  3384*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3385*  COMPANY I.D.                                                  *
  3386*  BENEFIT TYPE                                                  *
  3387*                                                                *
  3388*  RETURNED FROM ELRAMT                                          *
  3389*  --------------------                                          *
  3390*  REMAINING AMOUNT 1 - CURRENT                                  *
  3391*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3392*  REMAINING AMOUNT FACTOR
  3393*----------------------------------------------------------------*
  3394*  PASSED TO ELRESV                                              *
  3395*  -----------------                                             *
  3396*  CERTIFICATE EFFECTIVE DATE                                    *
  3397*  VALUATION DATE                                                *
  3398*  PAID THRU DATE                                                *
  3399*  BENEFIT                                                       *
  3400*  INCURRED DATE                                                 *
  3401*  REPORTED DATE                                                 *
  3402*  ISSUE AGE                                                     *
  3403*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  64
* EL050.cbl
  3404*  CDT PERCENT                                                   *
  3405*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3406* *CLAIM TYPE (LIFE, A/H)                                        *
  3407* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3408* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3409*                                                                *
  3410*  RETURNED FROM ELRESV                                          *
  3411*  --------------------                                          *
  3412*  CDT TABLE USED                                                *
  3413*  CDT FACTOR USED                                               *
  3414*  PAY TO CURRENT RESERVE                                        *
  3415*  I.B.N.R. - A/H ONLY                                           *
  3416*  FUTURE (ACCRUED) AH ONLY                                      *
  3417*----------------------------------------------------------------*
  3418*  PASSED TO ELRATE                                              *
  3419*  ----------------                                              *
  3420*  CERT ISSUE DATE                                               *
  3421*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3422*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3423*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3424*  STATE CODE (CLIENT DEFINED)                                   *
  3425*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3426*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3427*  DEVIATION CODE                                                *
  3428*  ISSUE AGE                                                     *
  3429*  ORIGINAL BENEFIT AMOUNT                                       *
  3430*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3431*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3432*  BENEFIT KIND (LIFE OR A/H)                                    *
  3433*  A.P.R.                                                        *
  3434*  METHOD
  3435*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3436*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3437*  COMPANY I.D. (3 CHARACTER)                                    *
  3438*  BENEFIT CODE                                                  *
  3439*  BENEFIT OVERRIDE CODE                                         *
  3440*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3441*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3442*  JOINT INDICATOR (CSL ONLY)                                    *
  3443*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3444*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3445*                                                                *
  3446*  RETURNED FROM ELRATE                                          *
  3447*  --------------------                                          *
  3448*  CALCULATED PREMIUM                                            *
  3449*  PREMIUM RATE                                                  *
  3450*  MORTALITY CODE                                                *
  3451*  MAX ATTAINED AGE                                              *
  3452*  MAX AGE                                                       *
  3453*  MAX TERM                                                      *
  3454*  MAX MONTHLY BENEFIT                                           *
  3455*  MAX TOTAL BENIFIT                                             *
  3456*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3457*----------------------------------------------------------------*
  3458*  PASSED TO ELRFND                                              *
  3459*  ----------------                                              *
  3460*  CERT ISSUE DATE                                               *
  3461*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  65
* EL050.cbl
  3462*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3463*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3464*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3465*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3466*  STATE CODE (CLIENT DEFINED)                                   *
  3467*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3468*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3469*  DEVIATION CODE                                                *
  3470*  ISSUE AGE                                                     *
  3471*  ORIGINAL BENEFIT AMOUNT                                       *
  3472*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3473*  PROCESS TYPE (CANCEL)                                         *
  3474*  BENEFIT KIND (LIFE OR A/H)                                    *
  3475*  A.P.R.                                                        *
  3476*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3477*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3478*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3479*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3480*  COMPANY I.D. (3 CHARACTER)                                    *
  3481*  BENEFIT CODE                                                  *
  3482*  BENEFIT OVERRIDE CODE                                         *
  3483*                                                                *
  3484*  RETURNED FROM ELRFND                                          *
  3485*  --------------------                                          *
  3486*  CALCULATED REFUND                                             *
  3487*----------------------------------------------------------------*
  3488*  PASSED TO ELEARN                                              *
  3489*  ----------------                                              *
  3490*  CERT ISSUE DATE                                               *
  3491*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3492*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3493*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3494*  STATE CODE (CLIENT DEFINED)                                   *
  3495*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3496*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3497*  DEVIATION CODE                                                *
  3498*  ISSUE AGE                                                     *
  3499*  ORIGINAL BENEFIT AMOUNT                                       *
  3500*  BENEFIT KIND (LIFE OR A/H)                                    *
  3501*  A.P.R.                                                        *
  3502*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3503*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3504*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3505*  COMPANY I.D. (3 CHARACTER)                                    *
  3506*  BENEFIT CODE                                                  *
  3507*  BENEFIT OVERRIDE CODE                                         *
  3508*                                                                *
  3509*  RETURNED FROM ELEARN                                          *
  3510*  --------------------                                          *
  3511*  INDICATED  EARNINGS                                           *
  3512*----------------------------------------------------------------*
  3513*                 LENGTH = 450                                   *
  3514*                                                                *
  3515******************************************************************
  3516******************************************************************
  3517*                   C H A N G E   L O G
  3518*
  3519* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  66
* EL050.cbl
  3520*-----------------------------------------------------------------
  3521*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3522* EFFECTIVE    NUMBER
  3523*-----------------------------------------------------------------
  3524* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3525* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3526* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3527* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3528* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3529* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3530* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3531* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3532* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3533* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3534* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3535******************************************************************
  3536
  3537 01  CALCULATION-PASS-AREA.
  3538     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3539                                     COMP.
  3540
  3541     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3542       88  NO-CP-ERROR                             VALUE ZERO.
  3543       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3544                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3545       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3546       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3547       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3548       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3549       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3550       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3551       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3552       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3553       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3554       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3555       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3556       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3557       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3558       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3559       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3560       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3561       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3562
  3563     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3564       88  NO-CP-ERROR-2                           VALUE ZERO.
  3565***********************  INPUT AREAS ****************************
  3566
  3567     12  CP-CALCULATION-AREA.
  3568         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3569         16  CP-CERT-EFF-DT        PIC XX.
  3570         16  CP-VALUATION-DT       PIC XX.
  3571         16  CP-PAID-THRU-DT       PIC XX.
  3572         16  CP-BENEFIT-TYPE       PIC X.
  3573           88  CP-AH                               VALUE 'A' 'D'
  3574                                                   'I' 'U'.
  3575           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3576           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3577         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  67
* EL050.cbl
  3578         16  CP-REPORTED-DT        PIC XX.
  3579         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3580         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3581         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-CDT-METHOD         PIC X.
  3586           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3587           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3588           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3589         16  CP-CLAIM-TYPE         PIC X.
  3590           88  CP-AH-CLAIM                         VALUE 'A'.
  3591           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3592         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3597                                     COMP-3.
  3598         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3599                                     COMP-3.
  3600         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3601                                     COMP-3.
  3602         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3605                                     COMP-3.
  3606         16  CP-REM-TERM-METHOD    PIC X.
  3607           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3608           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3609           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3610           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3611           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3612           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3613           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3614         16  CP-EARNING-METHOD     PIC X.
  3615           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3616           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3617           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3618           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3619           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3620           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3621           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3622           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3623           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3624           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3625           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3626           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3627           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3628           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3629         16  CP-PROCESS-TYPE       PIC X.
  3630           88  CP-CLAIM                            VALUE '1'.
  3631           88  CP-CANCEL                           VALUE '2'.
  3632           88  CP-ISSUE                            VALUE '3'.
  3633         16  CP-SPECIAL-CALC-CD    PIC X.
  3634           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3635           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  68
* EL050.cbl
  3636           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3637           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3638           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3639           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3640           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3641           88  CP-FARM-PLAN                    VALUE 'F'.
  3642           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3643           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3644           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3645           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3646           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3647           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3648           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3649           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3650           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3651           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3652                                                     'W' 'X'.
  3653           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3654           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3655           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3656           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3657           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3658           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3659           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3660           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3661           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3662           88  CP-CSL-METH-1                   VALUE '5'.
  3663           88  CP-CSL-METH-2                   VALUE '6'.
  3664           88  CP-CSL-METH-3                   VALUE '7'.
  3665           88  CP-CSL-METH-4                   VALUE '8'.
  3666
  3667         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3670         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3671         16  CP-STATE              PIC XX          VALUE SPACE.
  3672         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3673         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3674           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3675               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3676         16  CP-R78-OPTION         PIC X.
  3677           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3678           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3679
  3680         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3681         16  CP-IBNR-RESERVE-SW    PIC X.
  3682         16  CP-CLAIM-STATUS       PIC X.
  3683         16  CP-RATE-FILE          PIC X.
  3684         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3685                                     COMP-3.
  3686
  3687         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3688         16  CP-AH-OVERRIDE-CODE   PIC X.
  3689
  3690         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3691                                     COMP-3.
  3692         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3693                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  69
* EL050.cbl
  3694         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3695                                     COMP-3.
  3696         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3697                                     COMP-3.
  3698         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3699                                     COMP-3.
  3700         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3701                                  PIC S9(7)V99 COMP-3.
  3702
  3703         16  CP-PAID-FROM-DATE     PIC X(02).
  3704         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3705         16  CP-EXT-DAYS-CALC      PIC X.
  3706           88  CP-EXT-NO-CHG                   VALUE ' '.
  3707           88  CP-EXT-CHG-LF                   VALUE '1'.
  3708           88  CP-EXT-CHG-AH                   VALUE '2'.
  3709           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3710         16  CP-DOMICILE-STATE     PIC XX.
  3711         16  CP-CARRIER            PIC X.
  3712         16  CP-REIN-FLAG          PIC X.
  3713         16  CP-REM-TRM-CALC-OPTION PIC X.
  3714           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3715                      '2' '3' '4' '5'.
  3716           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3717           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3718           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3719           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3720           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3721           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3722           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3723           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3724         16  CP-SIG-SWITCH         PIC X.
  3725         16  CP-RATING-METHOD      PIC X.
  3726           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3727           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3728           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3729           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3730           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3731           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3732           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3733           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3734           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3735         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3736                                     COMP-3.
  3737         16  CP-BEN-CATEGORY       PIC X.
  3738         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3742         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3743                                   PIC S99V9(5) COMP-3.
  3744         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3745         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3746         16  CP-EXPIRE-DT          PIC XX.
  3747         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3748         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3749         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3750         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3751         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  70
* EL050.cbl
  3752             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3753             88  CP-CALC-CLP              VALUE 'C'.
  3754         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3755         16  CP-CANCEL-REASON      PIC X.
  3756         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3757         16  CP-PMT-MODE           PIC X.
  3758         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3759         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3760         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3761         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3762         16  FILLER                PIC X.
  3763
  3764***************    OUTPUT FROM ELRESV   ************************
  3765
  3766         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3767
  3768         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  FILLER                PIC X(09).
  3777***************    OUTPUT FROM ELRTRM   *************************
  3778
  3779         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3780                                     COMP-3.
  3781         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3782                                     COMP-3.
  3783         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3784                                     COMP-3.
  3785         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3786                                     COMP-3.
  3787         16  FILLER                PIC X(12).
  3788
  3789***************    OUTPUT FROM ELRAMT   *************************
  3790
  3791         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3794                                     COMP-3.
  3795         16  FILLER                PIC X(12).
  3796
  3797***************    OUTPUT FROM ELRATE   *************************
  3798
  3799         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-MORTALITY-CODE     PIC X(4).
  3804         16  CP-RATE-EDIT-FLAG     PIC X.
  3805             88  CP-RATES-NEED-APR                  VALUE '1'.
  3806         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3807                                     COMP-3.
  3808         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3809         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  71
* EL050.cbl
  3810         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3811                                   PIC S9(7)V99 COMP-3.
  3812         16  FILLER                PIC X(07).
  3813
  3814***************    OUTPUT FROM ELRFND   *************************
  3815
  3816         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3817                                     COMP-3.
  3818         16  CP-REFUND-TYPE-USED   PIC X.
  3819           88  CP-R-AS-R78                         VALUE '1'.
  3820           88  CP-R-AS-PRORATA                     VALUE '2'.
  3821           88  CP-R-AS-CALIF                       VALUE '3'.
  3822           88  CP-R-AS-TEXAS                       VALUE '4'.
  3823           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3824           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3825           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3826           88  CP-R-AS-MEAN                        VALUE '8'.
  3827           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3828           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3829           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3830           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3831           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3832           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3833         16  FILLER                PIC X(12).
  3834
  3835***************    OUTPUT FROM ELEARN   *************************
  3836
  3837         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3842                                     COMP-3.
  3843         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3844                                     COMP-3.
  3845         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3846                                     COMP-3.
  3847         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3848                                     COMP-3.
  3849         16  CP-EARNING-TYPE-USED  PIC X.
  3850           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3851           88  CP-E-AS-R78                         VALUE '1'.
  3852           88  CP-E-AS-PRORATA                     VALUE '2'.
  3853           88  CP-E-AS-TEXAS                       VALUE '4'.
  3854           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3855           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3856           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3857           88  CP-E-AS-MEAN                        VALUE '8'.
  3858           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3859         16  FILLER                PIC X(12).
  3860
  3861***************    OUTPUT FROM ELPMNT   *************************
  3862
  3863         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  72
* EL050.cbl
  3868
  3869***************   MISC WORK AREAS    *****************************
  3870         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3871                                     COMP-3.
  3872         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3873                                     COMP-3.
  3874         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3875                                     COMP-3.
  3876         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3877                                     COMP-3.
  3878         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3879                                     COMP-3.
  3880         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3881                                     COMP-3.
  3882         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3883             88  OPEN-RATE-FILE                   VALUE 'O'.
  3884             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3885             88  IO-ERROR                         VALUE 'E'.
  3886
  3887         16  CP-FIRST-PAY-DATE     PIC XX.
  3888
  3889         16  CP-JOINT-INDICATOR    PIC X.
  3890
  3891         16  CP-RESERVE-REMAINING-TERM
  3892                                   PIC S9(4)V9    VALUE ZERO
  3893                                     COMP-3.
  3894
  3895         16  CP-INSURED-BIRTH-DT   PIC XX.
  3896
  3897         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3910                                     COMP-3.
  3911
  3912         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3913                                     COMP-3.
  3914
  3915         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3916                                     COMP-3.
  3917
  3918         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3919             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3920
  3921         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3922                                     COMP-3.
  3923         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3924                                     COMP-3.
  3925         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  73
* EL050.cbl
  3926         16  cp-extra-periods      pic 9 value zeros.
  3927         16  cp-net-only-state     pic x value spaces.
  3928         16  FILLER                PIC X(13).
  3929******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  74
* EL050.cbl
  3931******************************************************************
  3932*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3933*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3934*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3935*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3936*** MODIFICATION.                                              ***
  3937*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3938*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3939******************************************************************
  3940*    COPY ERCPNDB.
  3941******************************************************************
  3942*                                                                *
  3943*                                                                *
  3944*                            ERCPNDB.                            *
  3945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3946*                            VMOD=2.025                          *
  3947*                                                                *
  3948*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3949*                                                                *
  3950******************************************************************
  3951*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3952*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3953******************************************************************
  3954*                                                                *
  3955*                                                                *
  3956*   FILE TYPE = VSAM,KSDS                                        *
  3957*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3958*                                                                *
  3959*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3960*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3961*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3962*                                                 RKP=13,LEN=36  *
  3963*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=49,LEN=11   *
  3966*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3967*                                      AND CHG-SEQ.)             *
  3968*                                                RKP=60,LEN=15   *
  3969*                                                                *
  3970*   LOG = NO                                                     *
  3971*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3972******************************************************************
  3973******************************************************************
  3974*                   C H A N G E   L O G
  3975*
  3976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3977*-----------------------------------------------------------------
  3978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3979* EFFECTIVE    NUMBER
  3980*-----------------------------------------------------------------
  3981* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3982* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3983* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3984* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3985* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3986* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3987* 032306                   PEMA  ADD BOW LOAN NUMBER
  3988* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  75
* EL050.cbl
  3989* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3990* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3991* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3992* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3993* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3994* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3995* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3996* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3997* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3998* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  3999******************************************************************
  4000
  4001 01  PENDING-BUSINESS.
  4002     12  PB-RECORD-ID                     PIC XX.
  4003         88  VALID-PB-ID                        VALUE 'PB'.
  4004
  4005     12  PB-CONTROL-PRIMARY.
  4006         16  PB-COMPANY-CD                PIC X.
  4007         16  PB-ENTRY-BATCH               PIC X(6).
  4008         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4009         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4010
  4011     12  PB-CONTROL-BY-ACCOUNT.
  4012         16  PB-COMPANY-CD-A1             PIC X.
  4013         16  PB-CARRIER                   PIC X.
  4014         16  PB-GROUPING.
  4015             20  PB-GROUPING-PREFIX       PIC XXX.
  4016             20  PB-GROUPING-PRIME        PIC XXX.
  4017         16  PB-STATE                     PIC XX.
  4018         16  PB-ACCOUNT.
  4019             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4020             20  PB-ACCOUNT-PRIME         PIC X(6).
  4021         16  PB-CERT-EFF-DT               PIC XX.
  4022         16  PB-CERT-NO.
  4023             20  PB-CERT-PRIME            PIC X(10).
  4024             20  PB-CERT-SFX              PIC X.
  4025         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4026
  4027         16  PB-RECORD-TYPE               PIC X.
  4028             88  PB-MAILING-DATA                VALUE '0'.
  4029             88  PB-ISSUE                       VALUE '1'.
  4030             88  PB-CANCELLATION                VALUE '2'.
  4031             88  PB-BATCH-TRAILER               VALUE '9'.
  4032
  4033     12  PB-CONTROL-BY-ORIG-BATCH.
  4034         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4035         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4036         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4037         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4038
  4039     12  PB-CONTROL-BY-CSR.
  4040         16  PB-CSR-COMPANY-CD            PIC X.
  4041         16  PB-CSR-ID                    PIC X(4).
  4042         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4043         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4044         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4045******************************************************************
  4046*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  76
* EL050.cbl
  4047******************************************************************
  4048
  4049     12  PB-LAST-MAINT-DT                 PIC XX.
  4050     12  PB-LAST-MAINT-BY                 PIC X(4).
  4051     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4052
  4053     12  PB-RECORD-BODY                   PIC X(375).
  4054
  4055     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4056         16  PB-CERT-ORIGIN               PIC X.
  4057             88  CLASIC-CREATED-CERT         VALUE '1'.
  4058         16  PB-I-NAME.
  4059             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4060             20  PB-I-INSURED-FIRST-NAME.
  4061                 24  PB-I-INSURED-1ST-INIT PIC X.
  4062                 24  FILLER                PIC X(9).
  4063             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4064         16  PB-I-AGE                     PIC S99   COMP-3.
  4065         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4066         16  PB-I-BIRTHDAY                PIC XX.
  4067         16  PB-I-INSURED-SEX             PIC X.
  4068             88  PB-SEX-MALE     VALUE 'M'.
  4069             88  PB-SEX-FEMALE   VALUE 'F'.
  4070
  4071         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4072         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4073         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4074         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4075         16  PB-I-SKIP-CODE               PIC X.
  4076             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4077             88  PB-SKIP-JULY              VALUE '1'.
  4078             88  PB-SKIP-AUGUST            VALUE '2'.
  4079             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4080             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4081             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4082             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4083             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4084             88  PB-SKIP-JUNE              VALUE '8'.
  4085             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4086             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4087             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4088         16  PB-I-TERM-TYPE               PIC X.
  4089             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4090             88  PB-PAID-WEEKLY            VALUE 'W'.
  4091             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4092             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4093             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4094         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4095         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4096         16  PB-I-DATA-ENTRY-SW           PIC X.
  4097             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4098             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4099             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4100             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4101         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4102         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4103*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4104         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  77
* EL050.cbl
  4105         16  FILLER                       PIC X.
  4106
  4107         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4108             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4109             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4110                                                   '90' THRU '99'.
  4111         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4112                                          PIC XX.
  4113         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4114         16  PB-I-AMOUNT-FINANCED REDEFINES
  4115                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4116         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4117         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4118                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4119         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4120         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4121         16  PB-I-CLP-AMOUNT REDEFINES
  4122                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-CALC-FLAG            PIC X.
  4124             88 PB-COMP-LF-PREM               VALUE '?'.
  4125         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4126         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4127         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4129         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4130         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4131         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4132         16  PB-I-LF-ABBR                 PIC XXX.
  4133         16  PB-I-LF-INPUT-CD             PIC XX.
  4134
  4135         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4136             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4137             88  PB-INVALID-AH               VALUE '  ' '00'
  4138                                                   '90' THRU '99'.
  4139         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4141         16  PB-I-AH-CALC-FLAG            PIC X.
  4142             88 PB-COMP-AH-PREM                  VALUE '?'.
  4143         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4144         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4145         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4146         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4147         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4148         16  PB-I-AH-ABBR                 PIC XXX.
  4149         16  PB-I-AH-INPUT-CD             PIC XXX.
  4150
  4151         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4152         16  PB-I-REIN-TABLE              PIC XXX.
  4153         16  PB-I-BUSINESS-TYPE           PIC 99.
  4154         16  PB-I-INDV-GRP-CD             PIC X.
  4155         16  PB-I-MORT-CODE.
  4156             20  PB-I-TABLE               PIC X.
  4157             20  PB-I-INTEREST            PIC XX.
  4158             20  PB-I-MORT-TYP            PIC X.
  4159         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4160         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4161         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4162         16  PB-I-INDV-GRP-OVRD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  78
* EL050.cbl
  4163         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4164         16  PB-I-SIG-SW                  PIC X.
  4165             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4166         16  PB-I-RATE-CLASS              PIC XX.
  4167         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4168         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4169         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4170         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4171         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4172         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4173         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4174         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4175         16  PB-I-OB-FLAG                 PIC X.
  4176             88  PB-I-OB                      VALUE 'B'.
  4177             88  PB-I-SUMMARY                 VALUE 'Z'.
  4178         16  PB-I-ENTRY-STATUS            PIC X.
  4179             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4180                                              'M' '5' '9' '2'.
  4181             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4182             88  PB-I-POLICY-PENDING          VALUE '2'.
  4183             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4184             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4185             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4186             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4187             88  PB-I-REIN-ONLY               VALUE '9'.
  4188             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4189             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4190             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4191             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4192         16  PB-I-INT-CODE                PIC X.
  4193             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4194             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4195         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4196         16  PB-I-SOC-SEC-NO              PIC X(11).
  4197         16  PB-I-MEMBER-NO               PIC X(12).
  4198         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4199*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4200         16  PB-I-OLD-LOF                 PIC XXX.
  4201         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4202         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4203         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4204         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4205         16  PB-I-LIFE-INDICATOR          PIC X.
  4206             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4207         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4208         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4209                                          PIC S9(5)V99    COMP-3.
  4210         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4211             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4212             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4213         16  PB-I-1ST-PMT-DT              PIC XX.
  4214         16  PB-I-JOINT-INSURED.
  4215             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4216             20 PB-I-JOINT-FIRST-NAME.
  4217                24  PB-I-JOINT-FIRST-INIT PIC X.
  4218                24  FILLER                PIC X(9).
  4219             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4220*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  79
* EL050.cbl
  4221         16  PB-I-BENEFICIARY-NAME.
  4222             20  PB-I-BANK-NUMBER         PIC X(10).
  4223             20  FILLER                   PIC X(15).
  4224         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4225         16  PB-I-REFERENCE               PIC X(12).
  4226         16  FILLER REDEFINES PB-I-REFERENCE.
  4227             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4228             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4229             20  PB-I-CLP-STATE           PIC XX.
  4230         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4231             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4232             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4233             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4234         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4235         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4236         16  PB-I-RESIDENT-STATE          PIC XX.
  4237         16  PB-I-RATE-CODE               PIC X(4).
  4238         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4239         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4240         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4241         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4242         16  PB-I-BANK-NOCHRGB            PIC 99.
  4243         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4244         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4245
  4246     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4247         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4248             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4249         16  PB-C-CANCEL-ORIGIN           PIC X.
  4250             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4251         16  PB-C-LF-CANCEL-DT            PIC XX.
  4252         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4253         16  PB-C-LF-CALC-REQ             PIC X.
  4254             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4255         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4256         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4257         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4258             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4259         16  PB-C-AH-CANCEL-DT            PIC XX.
  4260         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4261         16  PB-C-AH-CALC-REQ             PIC X.
  4262             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4263         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4264         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4265         16  PB-C-LAST-NAME               PIC X(15).
  4266         16  PB-C-REFUND-SW               PIC X.
  4267             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4268             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4269         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4270         16  PB-C-PAYEE-CODE              PIC X(6).
  4271         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4272         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4273         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4274         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4275         16  PB-C-REFERENCE               PIC X(12).
  4276         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4277         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4278         16  PB-C-POST-CARD-IND           PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  80
* EL050.cbl
  4279         16  PB-C-CANCEL-REASON           PIC X.
  4280         16  PB-C-REF-INTERFACE-SW        PIC X.
  4281         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4282         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4283         16  FILLER                       PIC X(01).
  4284*        16  FILLER                       PIC X(18).
  4285         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4286*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4287         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4288         16  PB-CANCELED-CERT-DATA.
  4289             20  PB-CI-INSURED-NAME.
  4290                 24  PB-CI-LAST-NAME      PIC X(15).
  4291                 24  PB-CI-INITIALS       PIC XX.
  4292             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4293             20  PB-CI-INSURED-SEX        PIC X.
  4294             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4295             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4296             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4297             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4298             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4301             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4302             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4303             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4304             20  PB-CI-RATE-CLASS         PIC XX.
  4305             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4306             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4307             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4308             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4309             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4310             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4311             20  PB-CI-LF-ABBR            PIC X(3).
  4312             20  PB-CI-AH-ABBR            PIC X(3).
  4313             20  PB-CI-OB-FLAG            PIC X.
  4314                 88  PB-CI-OB                VALUE 'B'.
  4315             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4316                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4317                                           'M' '4' '5' '9' '2'.
  4318                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4319                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4320                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4321                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4322                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4323                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4324                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4325                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4326                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4327                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4328                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4329                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4330                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4331             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4332                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4333                                           'M' '4' '5' '9' '2'.
  4334                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4335                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4336                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  81
* EL050.cbl
  4337                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4338                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4339                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4340                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4341                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4342                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4343                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4344                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4345                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4346                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4347             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4348             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4349             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4350             20  PB-CI-MEMBER-NO          PIC X(12).
  4351             20  PB-CI-INT-CODE           PIC X.
  4352                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4353                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4354             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4355             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4356             20  PB-CI-COMP-EXCP-SW       PIC X.
  4357                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4358                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4359             20  PB-CI-ENTRY-STATUS       PIC X.
  4360             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4361             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4362             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4363             20  PB-CI-DEATH-DT           PIC XX.
  4364             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4365             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4366             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4367             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4368             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4369             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4370             20  PB-CI-ENTRY-DT              PIC XX.
  4371             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4372             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4373             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4374             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4375             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4376             20  PB-CI-OLD-LOF               PIC XXX.
  4377*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4378             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4379             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4380             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4381             20  PB-CI-INDV-GRP-CD           PIC X.
  4382             20  PB-CI-BENEFICIARY-NAME.
  4383                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4384                 24  FILLER                  PIC X(15).
  4385             20  PB-CI-NOTE-SW               PIC X.
  4386             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4387             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4388             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4389             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4390             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4391             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4392             20  PB-CI-FIRST-NAME            PIC X(10).
  4393             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4394
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  82
* EL050.cbl
  4395         16  FILLER                       PIC X(13).
  4396*032306  16  FILLER                       PIC X(27).
  4397*        16  FILLER                       PIC X(46).
  4398
  4399     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4400         16  FILLER                       PIC X(10).
  4401         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4402         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4403         16  PB-M-INSURED-MID-INIT        PIC X.
  4404         16  PB-M-INSURED-AGE             PIC 99.
  4405         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4406         16  PB-M-INSURED-SEX             PIC X.
  4407         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4408         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4409         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4410         16  PB-M-INSURED-CITY-STATE.
  4411             20  PB-M-INSURED-CITY        PIC X(28).
  4412             20  PB-M-INSURED-STATE       PIC XX.
  4413         16  PB-M-INSURED-ZIP-CODE.
  4414             20  PB-M-INSURED-ZIP-PRIME.
  4415                 24  PB-M-INSURED-ZIP-1   PIC X.
  4416                     88  PB-M-CANADIAN-POST-CODE
  4417                                             VALUE 'A' THRU 'Z'.
  4418                 24  FILLER               PIC X(4).
  4419             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4420         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4421                                        PB-M-INSURED-ZIP-CODE.
  4422             20  PM-M-INS-CAN-POST1       PIC XXX.
  4423             20  PM-M-INS-CAN-POST2       PIC XXX.
  4424             20  FILLER                   PIC XXX.
  4425         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4426         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4427         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4428         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4429         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4430         16  PB-M-CRED-BENE-CITYST.
  4431             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4432             20  PB-M-CRED-BENE-STATE     PIC XX.
  4433         16  FILLER                       PIC X(92).
  4434
  4435     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4436         16  FILLER                       PIC X(10).
  4437         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4439         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4441         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4442         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4445         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4446         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4447         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4448         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4449         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4450         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4451         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4452         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  83
* EL050.cbl
  4453         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4454         16  PB-ACCOUNT-NAME              PIC X(30).
  4455         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4456         16  PB-REFERENCE                 PIC X(12).
  4457         16  PB-B-RECEIVED-DT             PIC XX.
  4458         16  FILLER                       PIC X(234).
  4459
  4460     12  PB-RECORD-STATUS.
  4461         16  PB-CREDIT-SELECT-DT          PIC XX.
  4462         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4463         16  PB-BILLED-DT                 PIC XX.
  4464         16  PB-BILLING-STATUS            PIC X.
  4465             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4466             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4467             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4468         16  PB-RECORD-BILL               PIC X.
  4469             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4470             88  PB-RECORD-RETURNED           VALUE 'R'.
  4471             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4472             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4473             88  PB-OVERRIDE-AH               VALUE 'A'.
  4474             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4475         16  PB-BATCH-ENTRY               PIC X.
  4476             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4477             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4478             88  PB-REISSUED-CERT             VALUE 'E'.
  4479             88  PB-CASH-CERT                 VALUE 'C'.
  4480             88  PB-MONTHLY-CERT              VALUE 'M'.
  4481             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4482             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4483             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4484         16  PB-FORCE-CODE                PIC X.
  4485             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4486             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4487             88  PB-CANCEL-FORCE              VALUE '8'.
  4488             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4489             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4490             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4491             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4492             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4493             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4494             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4495             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4496         16  PB-FATAL-FLAG                PIC X.
  4497             88  PB-FATAL-ERRORS              VALUE 'X'.
  4498         16  PB-FORCE-ER-CD               PIC X.
  4499             88  PB-FORCE-ERRORS              VALUE 'F'.
  4500             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4501         16  PB-WARN-ER-CD                PIC X.
  4502             88  PB-WARNING-ERRORS            VALUE 'W'.
  4503         16  FILLER                       PIC X.
  4504         16  PB-OUT-BAL-CD                PIC X.
  4505             88  PB-OUT-OF-BAL                VALUE 'O'.
  4506         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4507         16  PB-AH-OVERRIDE-L1            PIC X.
  4508         16  PB-INPUT-DT                  PIC XX.
  4509         16  PB-INPUT-BY                  PIC X(4).
  4510         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  84
* EL050.cbl
  4511         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4512         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4513         16  PB-LF-EARNING-METHOD         PIC X.
  4514         16  PB-AH-EARNING-METHOD         PIC X.
  4515         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4516         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4517         16  PB-REIN-CD                   PIC XXX.
  4518         16  PB-LF-REFUND-TYPE            PIC X.
  4519         16  PB-AH-REFUND-TYPE            PIC X.
  4520         16  PB-ACCT-EFF-DT               PIC XX.
  4521         16  PB-ACCT-EXP-DT               PIC XX.
  4522         16  PB-COMPANY-ID                PIC X(3).
  4523         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4524         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4525         16  PB-SV-CARRIER                PIC X.
  4526         16  PB-SV-GROUPING               PIC X(6).
  4527         16  PB-SV-STATE                  PIC XX.
  4528         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4529         16  PB-GA-BILLING-INFO.
  4530             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4531                                          PIC XX.
  4532         16  PB-SV-REMIT-TO  REDEFINES
  4533             PB-GA-BILLING-INFO           PIC X(10).
  4534         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4535         16  PB-I-LOAN-OFFICER            PIC X(5).
  4536         16  PB-I-VIN                     PIC X(17).
  4537
  4538         16  FILLER                       PIC X(04).
  4539         16  IMNET-BYPASS-SW              PIC X.
  4540
  4541******************************************************************
  4542*                COMMON EDIT ERRORS                              *
  4543******************************************************************
  4544
  4545     12  PB-COMMON-ERRORS.
  4546         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4547                                           PIC S9(4)     COMP.
  4548
  4549******************************************************************
  4550
  4551* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4552*    COPY ELC50W1.
  4553******************************************************************
  4554*                                                                *
  4555*                                                                *
  4556*                             ELC50W1                            *
  4557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4558*                            VMOD=2.004                          *
  4559*                                                                *
  4560*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4561*                                                                *
  4562*                                                                *
  4563******************************************************************
  4564
  4565     12  WK-WORK-AREA.
  4566         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4567         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4568         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  85
* EL050.cbl
  4569         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4570         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4571         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4572         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4573         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4574         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4575         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4576         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4577         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4578         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4579         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4580         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4581         16  WK-CREDIT-EDIT-CONTROLS.
  4582             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4583             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4584             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4585             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4586             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4587             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4588         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4589         16  WK-SAVE-REIN-DATA.
  4590             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4591             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4592             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4593         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4594             88  ENTRY-FROM-EL6311       VALUE '6'.
  4595         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4596         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4597     12  WK-RECORD-ADDRESSES.
  4598         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4601         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4602         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4603         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4604         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4605         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4606     12  WK-OVER-SHORT-AREA.
  4607         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4608         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4609         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4610             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4611         16  FILLER                   PIC X(5) VALUE SPACES.
  4612
  4613*    COPY ELCEDITC.
  4614******************************************************************
  4615*                                                                *
  4616*                                                                *
  4617*                            ELCEDITC                            *
  4618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4619*                            VMOD=2.012                          *
  4620*                                                                *
  4621*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4622*                     EL6313, EL050 AND EL517.                   *
  4623*                                                                *
  4624******************************************************************
  4625******************************************************************
  4626*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  86
* EL050.cbl
  4627*
  4628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4629*-----------------------------------------------------------------
  4630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4631* EFFECTIVE    NUMBER
  4632*-----------------------------------------------------------------
  4633* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4634******************************************************************
  4635
  4636     12  EDIT-CRITERIA-DATA.
  4637         16  EC-CO-MONTH-END-DT       PIC XX.
  4638         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4639         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4640         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4641         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4642         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4643         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4644         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4645         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4646         16  EC-CO-REM-TERM-CALC      PIC X.
  4647               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4648               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4649               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4650               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4651
  4652         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4653               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4654               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4655               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4656               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4657               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4658               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4659               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4660               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4661               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4662               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4663
  4664         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4665               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4666               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4667               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4668               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4669               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4670               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4671               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4672               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4673
  4674         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4675                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4676                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4677
  4678         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4679                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4680                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4681                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4682                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4683                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4684                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  87
* EL050.cbl
  4685                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4686                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4687
  4688         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4689               88  EC-BR-REDUCING                   VALUE 'R'.
  4690               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4691
  4692         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4693         16  EC-BR-LF-DESC             PIC X(10).
  4694         16  EC-BR-AH-DESC             PIC X(10).
  4695         16  EC-BR-LF-COMMENT          PIC X(10).
  4696         16  EC-BR-AH-COMMENT          PIC X(10).
  4697
  4698         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4699               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4700               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4701               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4702               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4703
  4704         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4705               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4706               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4707               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4708               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4709
  4710         16  EC-BR-LF-REFUND-CALC      PIC X.
  4711                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4712                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4713                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4714                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4715                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4716                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4717                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4718
  4719         16  EC-BR-AH-REFUND-CALC      PIC X.
  4720                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4721                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4722                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4723                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4724                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4725                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4726                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4727                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4728
  4729         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4735                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4736                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4737                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4738
  4739         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4740         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4741         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4742         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  88
* EL050.cbl
  4743
  4744         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4745         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4746                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4747                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4748                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4749                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4750
  4751         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4752               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4753               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4754               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4755               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4756               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4757
  4758         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4759               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4760               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4761               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4762               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4763               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4764
  4765         16  EC-ST-LF-REFUND-CALC      PIC X.
  4766                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4767                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4768                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4769                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4770                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4771                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4772                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4773                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4774
  4775         16  EC-ST-AH-REFUND-CALC      PIC X.
  4776                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4777                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4778                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4779                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4780                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4781                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4782                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4783                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4784
  4785         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4786         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4787         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4788         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4789         16  EC-AM-EXPIRATION-DT       PIC XX.
  4790         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4791         16  EC-AM-CLASS-CD            PIC XX.
  4792         16  EC-AM-LF-DEVIATION        PIC XXX.
  4793         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4794         16  EC-AM-AH-DEVIATION        PIC XXX.
  4795         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4796         16  EC-AM-PHONE-NO            PIC X(10).
  4797
  4798         16  EC-AM-LF-REFUND-CALC      PIC X.
  4799                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4800                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  89
* EL050.cbl
  4801                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4802                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4803                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4804                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4805                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4806
  4807         16  EC-AM-AH-REFUND-CALC      PIC X.
  4808                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4809                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4810                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4811                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4812                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4813                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4814                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4815
  4816         16  EC-AM-BEN-I-G-CD          PIC X.
  4817                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4818                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4819                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4820
  4821         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4822         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4823         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4824         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4826         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4827         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4828         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4829         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830
  4831         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4832         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4833         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4834         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4836         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4837         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4838         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4839         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4840         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4841         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4842         16  EC-RT-LF-NSP-ST           PIC XX.
  4843         16  EC-RT-AH-NSP-ST           PIC XX.
  4844         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4845         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4846
  4847         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4848             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4849                                             'M' '5' '9' '2'.
  4850             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4851             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4852             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4853             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4854             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4855             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4856             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4857             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4858             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  90
* EL050.cbl
  4859             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4860
  4861         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4862             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4863                                             'M' '5' '9' '2'.
  4864             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4865             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4866             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4867             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4868             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4869             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4870             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4871             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4872             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4873             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4874
  4875         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4876         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4877         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4878         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4879         16  EC-CM-DEATH-DT            PIC XX.
  4880
  4881*DMD CUSTOM CODING FIELDS BELOW
  4882*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4883         16  EC-BR-DMD-RATING-SW       PIC X.
  4884                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4885                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4886                 88  NO-DMD-RATING               VALUE 'N'.
  4887
  4888         16  EC-NEW-CERT               PIC X(11).
  4889         16  EC-NEW-STATE              PIC XX.
  4890         16  FILLER                    PIC X.
  4891*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4892         16  OVER-SHORT-EDIT-FIELDS.
  4893             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4894             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4895             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4896             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4897             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4898             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4899             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4900             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4901             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4902         16  FILLER                    PIC X(71).
  4903******************************************************************
  4904
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  91
* EL050.cbl
  4906*    COPY ELCDIFRD.
  4907******************************************************************
  4908*                                                                *
  4909*                                                                *
  4910*                            ELCDIFRD.                           *
  4911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4912*                            VMOD=2.004                          *
  4913*                                                                *
  4914*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4915*                                                                *
  4916******************************************************************
  4917*
  4918  01  WS-DIFFERENCE-CALCULATION.
  4919        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4920        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4921        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4923        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4924        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4925        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4926        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4927        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4928        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4929        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4930
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  92
* EL050.cbl
  4932****************************************************************
  4933*
  4934* Copyright (c) 2007 by Clerity Solutions, Inc.
  4935* All rights reserved.
  4936*
  4937****************************************************************
  4938 01  DFHEIV.
  4939   02  DFHEIV0               PIC X(35).
  4940   02  DFHEIV1               PIC X(08).
  4941   02  DFHEIV2               PIC X(08).
  4942   02  DFHEIV3               PIC X(08).
  4943   02  DFHEIV4               PIC X(06).
  4944   02  DFHEIV5               PIC X(04).
  4945   02  DFHEIV6               PIC X(04).
  4946   02  DFHEIV7               PIC X(02).
  4947   02  DFHEIV8               PIC X(02).
  4948   02  DFHEIV9               PIC X(01).
  4949   02  DFHEIV10              PIC S9(7) COMP-3.
  4950   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4951   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4952   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4953   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4954   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4955   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4956   02  DFHEIV17              PIC X(04).
  4957   02  DFHEIV18              PIC X(04).
  4958   02  DFHEIV19              PIC X(04).
  4959   02  DFHEIV20              USAGE IS POINTER.
  4960   02  DFHEIV21              USAGE IS POINTER.
  4961   02  DFHEIV22              USAGE IS POINTER.
  4962   02  DFHEIV23              USAGE IS POINTER.
  4963   02  DFHEIV24              USAGE IS POINTER.
  4964   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4965   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4966   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4967   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4968   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4969   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4970   02  FILLER                PIC X(02).
  4971   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4972   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4973   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4974   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4975   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4976 LINKAGE  SECTION.
  4977*****************************************************************
  4978*                                                               *
  4979* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4980* All rights reserved.                                          *
  4981*                                                               *
  4982*****************************************************************
  4983 01  dfheiblk.
  4984     02  eibtime          pic s9(7) comp-3.
  4985     02  eibdate          pic s9(7) comp-3.
  4986     02  eibtrnid         pic x(4).
  4987     02  eibtaskn         pic s9(7) comp-3.
  4988     02  eibtrmid         pic x(4).
  4989     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  93
* EL050.cbl
  4990     02  eibcposn         pic s9(4) comp.
  4991     02  eibcalen         pic s9(4) comp.
  4992     02  eibaid           pic x(1).
  4993     02  eibfiller1       pic x(1).
  4994     02  eibfn            pic x(2).
  4995     02  eibfiller2       pic x(2).
  4996     02  eibrcode         pic x(6).
  4997     02  eibfiller3       pic x(2).
  4998     02  eibds            pic x(8).
  4999     02  eibreqid         pic x(8).
  5000     02  eibrsrce         pic x(8).
  5001     02  eibsync          pic x(1).
  5002     02  eibfree          pic x(1).
  5003     02  eibrecv          pic x(1).
  5004     02  eibsend          pic x(1).
  5005     02  eibatt           pic x(1).
  5006     02  eibeoc           pic x(1).
  5007     02  eibfmh           pic x(1).
  5008     02  eibcompl         pic x(1).
  5009     02  eibsig           pic x(1).
  5010     02  eibconf          pic x(1).
  5011     02  eiberr           pic x(1).
  5012     02  eibrldbk         pic x(1).
  5013     02  eiberrcd         pic x(4).
  5014     02  eibsynrb         pic x(1).
  5015     02  eibnodat         pic x(1).
  5016     02  eibfiller5       pic x(2).
  5017     02  eibresp          pic 9(09) comp.
  5018     02  eibresp2         pic 9(09) comp.
  5019     02  dfheigdj         pic s9(4) comp.
  5020     02  dfheigdk         pic s9(4) comp.
  5021
  5022 01  DFHCOMMAREA                   PIC X(1036).
  5023
  5024*01 PARMLIST .
  5025*    02  FILLER                    PIC S9(8)   COMP.
  5026*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5027*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5028*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5029*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5030*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5031*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5032*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5033
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  94
* EL050.cbl
  5035*    COPY ELCCNTL.
  5036******************************************************************
  5037*                                                                *
  5038*                                                                *
  5039*                            ELCCNTL.                            *
  5040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5041*                            VMOD=2.059                          *
  5042*                                                                *
  5043*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5044*                                                                *
  5045*   FILE TYPE = VSAM,KSDS                                        *
  5046*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5047*                                                                *
  5048*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5049*       ALTERNATE INDEX = NONE                                   *
  5050*                                                                *
  5051*   LOG = YES                                                    *
  5052*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5053******************************************************************
  5054*                   C H A N G E   L O G
  5055*
  5056* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5057*-----------------------------------------------------------------
  5058*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5059* EFFECTIVE    NUMBER
  5060*-----------------------------------------------------------------
  5061* 082503                   PEMA  ADD BENEFIT GROUP
  5062* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5063* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5064* 092705    2005050300006  PEMA  ADD SPP LEASES
  5065* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5066* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5067* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5068* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5069* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5070* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5071* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5072* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5073* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5074* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5075******************************************************************
  5076*
  5077 01  CONTROL-FILE.
  5078     12  CF-RECORD-ID                       PIC XX.
  5079         88  VALID-CF-ID                        VALUE 'CF'.
  5080
  5081     12  CF-CONTROL-PRIMARY.
  5082         16  CF-COMPANY-ID                  PIC XXX.
  5083         16  CF-RECORD-TYPE                 PIC X.
  5084             88  CF-COMPANY-MASTER              VALUE '1'.
  5085             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5086             88  CF-STATE-MASTER                VALUE '3'.
  5087             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5088             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5089             88  CF-CARRIER-MASTER              VALUE '6'.
  5090             88  CF-MORTALITY-MASTER            VALUE '7'.
  5091             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5092             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  95
* EL050.cbl
  5093             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5094             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5095             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5096             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5097             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5098             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5099             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5100             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5101             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5102         16  CF-ACCESS-CD-GENL              PIC X(4).
  5103         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5104             20  CF-PROCESSOR               PIC X(4).
  5105         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5106             20  CF-STATE-CODE              PIC XX.
  5107             20  FILLER                     PIC XX.
  5108         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5109             20  FILLER                     PIC XX.
  5110             20  CF-HI-BEN-IN-REC           PIC XX.
  5111         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5112             20  FILLER                     PIC XXX.
  5113             20  CF-CARRIER-CNTL            PIC X.
  5114         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5115             20  FILLER                     PIC XX.
  5116             20  CF-HI-TYPE-IN-REC          PIC 99.
  5117         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5119                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5120             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5121             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5122         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5123             20  FILLER                     PIC X.
  5124             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5125         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5126             20  FILLER                     PIC XX.
  5127             20  CF-MORTGAGE-PLAN           PIC XX.
  5128         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5129
  5130     12  CF-LAST-MAINT-DT                   PIC XX.
  5131     12  CF-LAST-MAINT-BY                   PIC X(4).
  5132     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5133
  5134     12  CF-RECORD-BODY                     PIC X(728).
  5135
  5136
  5137****************************************************************
  5138*             COMPANY MASTER RECORD                            *
  5139****************************************************************
  5140
  5141     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5142         16  CF-COMPANY-ADDRESS.
  5143             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5144             20  CF-CL-IN-CARE-OF           PIC X(30).
  5145             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5146             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5147             20  CF-CL-CITY-STATE           PIC X(30).
  5148             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5149             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5150         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  96
* EL050.cbl
  5151         16  CF-COMPANY-PASSWORD            PIC X(8).
  5152         16  CF-SECURITY-OPTION             PIC X.
  5153             88  ALL-SECURITY                   VALUE '1'.
  5154             88  COMPANY-VERIFY                 VALUE '2'.
  5155             88  PROCESSOR-VERIFY               VALUE '3'.
  5156             88  NO-SECURITY                    VALUE '4'.
  5157             88  ALL-BUT-TERM                   VALUE '5'.
  5158         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5159             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5160         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5161             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5162         16  CF-INFORCE-LOCATION            PIC X.
  5163             88  CERTS-ARE-ONLINE               VALUE '1'.
  5164             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5165             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5166         16  CF-LOWER-CASE-LETTERS          PIC X.
  5167         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5168             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5169             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5170             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5171             88  CF-ACCNT-CNTL                  VALUE '3'.
  5172             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5173
  5174         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5175         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5176
  5177         16  CF-LGX-CREDIT-USER             PIC X.
  5178             88  CO-IS-NOT-USER                 VALUE 'N'.
  5179             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5180
  5181         16 CF-CREDIT-CALC-CODES.
  5182             20  CF-CR-REM-TERM-CALC PIC X.
  5183               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5184               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5185               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5186               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5187               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5188               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5189               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5190             20  CF-CR-R78-METHOD           PIC X.
  5191               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5192               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5193
  5194         16  CF-CLAIM-CONTROL-COUNTS.
  5195             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5196                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5197
  5198             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5199                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5200
  5201             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5202                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5203
  5204             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5205                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5206
  5207         16  CF-CURRENT-MONTH-END           PIC XX.
  5208
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  97
* EL050.cbl
  5209         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5210             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5211             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5212             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5213             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5214                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5215                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5216             20  CF-CO-PREM-REJECT-SW       PIC X.
  5217                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5218                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5219             20  CF-CO-REF-REJECT-SW        PIC X.
  5220                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5221                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5222
  5223         16  CF-CO-REPORTING-DT             PIC XX.
  5224         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5225         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5226           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5227           88  CF-CO-MONTH-END                  VALUE '1'.
  5228
  5229         16  CF-LGX-CLAIM-USER              PIC X.
  5230             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5231             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5232
  5233         16  CF-CREDIT-EDIT-CONTROLS.
  5234             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5235             20  CF-MIN-AGE                 PIC 99.
  5236             20  CF-DEFAULT-AGE             PIC 99.
  5237             20  CF-MIN-TERM                PIC S999      COMP-3.
  5238             20  CF-MAX-TERM                PIC S999      COMP-3.
  5239             20  CF-DEFAULT-SEX             PIC X.
  5240             20  CF-JOINT-AGE-INPUT         PIC X.
  5241                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5242             20  CF-BIRTH-DATE-INPUT        PIC X.
  5243                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5244             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5245                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5246                 88  CF-ZERO-CARRIER            VALUE '1'.
  5247                 88  CF-ZERO-GROUPING           VALUE '2'.
  5248                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5249             20  CF-EDIT-SW                 PIC X.
  5250                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5251             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5252             20  CF-CR-PR-METHOD            PIC X.
  5253               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5254               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5255             20  FILLER                     PIC X.
  5256
  5257         16  CF-CREDIT-MISC-CONTROLS.
  5258             20  CF-REIN-TABLE-SW           PIC X.
  5259                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5260             20  CF-COMP-TABLE-SW           PIC X.
  5261                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5262             20  CF-EXPERIENCE-RETENTION-AGE
  5263                                            PIC S9        COMP-3.
  5264             20  CF-CONVERSION-DT           PIC XX.
  5265             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5266             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  98
* EL050.cbl
  5267                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5268                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5269
  5270             20  CF-CR-CHECK-NO-CONTROL.
  5271                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5272                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5273                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5274                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5275                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5276                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5277
  5278                 24  CF-CR-CHECK-COUNT       REDEFINES
  5279                     CF-CR-CHECK-COUNTER      PIC X(4).
  5280
  5281                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5282                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5283
  5284                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5285                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5286                 24  CF-MAIL-PROCESSING       PIC X.
  5287                     88  MAIL-PROCESSING          VALUE 'Y'.
  5288
  5289         16  CF-MISC-SYSTEM-CONTROL.
  5290             20  CF-SYSTEM-C                 PIC X.
  5291                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5292             20  CF-SYSTEM-D                 PIC X.
  5293                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5294             20  CF-SOC-SEC-NO-SW            PIC X.
  5295                 88  SOC-SEC-NO-USED             VALUE '1'.
  5296             20  CF-MEMBER-NO-SW             PIC X.
  5297                 88  MEMBER-NO-USED              VALUE '1'.
  5298             20  CF-TAX-ID-NUMBER            PIC X(11).
  5299             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5300             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5301                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5302                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5303                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5304                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5305             20  CF-SYSTEM-E                 PIC X.
  5306                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5307
  5308         16  CF-LGX-LIFE-USER               PIC X.
  5309             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5310             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5311
  5312         16  CF-CR-MONTH-END-DT             PIC XX.
  5313
  5314         16  CF-FILE-MAINT-DATES.
  5315             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5316                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5317             20  CF-LAST-BATCH       REDEFINES
  5318                 CF-LAST-BATCH-NO               PIC X(4).
  5319             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5320             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5321             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5322             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5323             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5324             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page  99
* EL050.cbl
  5325             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5326             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5327             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5328             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5329
  5330         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5331         16  FILLER                         PIC X.
  5332
  5333         16  CF-ALT-MORT-CODE               PIC X(4).
  5334         16  CF-MEMBER-CAPTION              PIC X(10).
  5335
  5336         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5337             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5338             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5339             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5340             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5341             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5342
  5343         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5344
  5345         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5346         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5347         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5348         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5349
  5350         16  CF-AH-OVERRIDE-L1              PIC X.
  5351         16  CF-AH-OVERRIDE-L2              PIC XX.
  5352         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5353         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5354
  5355         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5356         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5357
  5358         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5359         16  CF-AR-LAST-EL860-DT            PIC XX.
  5360         16  CF-MP-MONTH-END-DT             PIC XX.
  5361
  5362         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5363         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5364             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5365
  5366         16  CF-AR-MONTH-END-DT             PIC XX.
  5367
  5368         16  CF-CRDTCRD-USER                PIC X.
  5369             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5370             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5371
  5372         16  CF-CC-MONTH-END-DT             PIC XX.
  5373
  5374         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5375
  5376         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5377             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5378             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5379             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5380         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5381         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5382         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 100
* EL050.cbl
  5383         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5384             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5385             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5386         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5387         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5388         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5389             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5390         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5391
  5392         16  CF-CL-ZIP-CODE.
  5393             20  CF-CL-ZIP-PRIME.
  5394                 24  CF-CL-ZIP-1ST          PIC X.
  5395                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5396                 24  FILLER                 PIC X(4).
  5397             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5398         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5399             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5400             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5401             20  FILLER                     PIC XXX.
  5402
  5403         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5404         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5405         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5406         16  CF-CO-OPTION-START-DATE        PIC XX.
  5407         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5408           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5409                                                      '3' '4'.
  5410           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5411           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5412           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5413           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5414           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5415           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5416
  5417         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5418
  5419         16  CF-PAYMENT-APPROVAL-LEVELS.
  5420             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5421             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5422             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5423             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5424             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5425             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5426
  5427         16  CF-END-USER-REPORTING-USER     PIC X.
  5428             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5429             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5430
  5431         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5432             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5433             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5434
  5435         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5436
  5437         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5438         16  FILLER                         PIC X.
  5439
  5440         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 101
* EL050.cbl
  5441             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5442             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5443             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5444
  5445         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5446
  5447         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5448             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5449             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5450
  5451         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5452             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5453             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5454
  5455         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5456
  5457         16  CF-CO-ACH-ID-CODE              PIC  X.
  5458             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5459             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5460             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5461         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5462         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5463         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5464         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5465         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5466         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5467         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5468         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5469         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5470                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5471         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5472                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5473
  5474         16  CF-CO-OVER-SHORT.
  5475             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5476             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5477
  5478*         16  FILLER                         PIC X(102).
  5479         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5480             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5481             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5482
  5483         16  CF-AH-APPROVAL-DAYS.
  5484             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5485             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5486             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5487             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5488
  5489         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5490
  5491         16  CF-APPROV-LEV-5.
  5492             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5493             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5494             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5495
  5496         16  FILLER                         PIC X(68).
  5497****************************************************************
  5498*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 102
* EL050.cbl
  5499****************************************************************
  5500
  5501     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5502         16  CF-PROCESSOR-NAME              PIC X(30).
  5503         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5504         16  CF-PROCESSOR-TITLE             PIC X(26).
  5505         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5506                 88  MESSAGE-YES                VALUE 'Y'.
  5507                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5508
  5509*****************************************************
  5510****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5511****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5512****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5513****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5514*****************************************************
  5515
  5516         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5517             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5518             20  CF-APPLICATION-FORCE       PIC X.
  5519             20  CF-INDIVIDUAL-APP.
  5520                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5521                     28  CF-BROWSE-APP      PIC X.
  5522                     28  CF-UPDATE-APP      PIC X.
  5523
  5524         16  CF-CURRENT-TERM-ON             PIC X(4).
  5525         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5526             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5527             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5528             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5529             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5530             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5531             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5532             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5533         16  CF-PROCESSOR-CARRIER           PIC X.
  5534             88  NO-CARRIER-SECURITY            VALUE ' '.
  5535         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5536             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5537         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5538             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5539         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5540             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5541
  5542         16  CF-PROC-SYS-ACCESS-SW.
  5543             20  CF-PROC-CREDIT-CLAIMS-SW.
  5544                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5545                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5546                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5547                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5548             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5549                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5550                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5551             20  CF-PROC-LIFE-GNRLDGR-SW.
  5552                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5553                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5554                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5555                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5556             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 103
* EL050.cbl
  5557                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5558                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5559         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5560             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5561             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5562         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5563
  5564         16  CF-APPROVAL-LEVEL                  PIC X.
  5565             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5566             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5567             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5568             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5569             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5570
  5571         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5572
  5573         16  CF-LANGUAGE-TYPE                   PIC X.
  5574             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5575             88  CF-LANG-IS-FR                      VALUE 'F'.
  5576
  5577         16  CF-CSR-IND                         PIC X.
  5578         16  FILLER                             PIC X(239).
  5579
  5580****************************************************************
  5581*             PROCESSOR/REMINDERS RECORD                       *
  5582****************************************************************
  5583
  5584     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5585         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5586             20  CF-START-REMIND-DT         PIC XX.
  5587             20  CF-END-REMIND-DT           PIC XX.
  5588             20  CF-REMINDER-TEXT           PIC X(50).
  5589         16  FILLER                         PIC X(296).
  5590
  5591
  5592****************************************************************
  5593*             STATE MASTER RECORD                              *
  5594****************************************************************
  5595
  5596     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5597         16  CF-STATE-ABBREVIATION          PIC XX.
  5598         16  CF-STATE-NAME                  PIC X(25).
  5599         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5600         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5601             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5602             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5603             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5604             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5605                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5606                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5607             20  CF-ST-PREM-REJECT-SW       PIC X.
  5608                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5609                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5610             20  CF-ST-REF-REJECT-SW        PIC X.
  5611                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5612                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5613         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5614         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 104
* EL050.cbl
  5615         16  CF-ST-REFUND-RULES.
  5616             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5617             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5618             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5619         16  CF-ST-FST-PMT-EXTENSION.
  5620             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5621             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5622                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5623                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5624                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5625                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5626         16  CF-ST-STATE-CALL.
  5627             20  CF-ST-CALL-UNEARNED        PIC X.
  5628             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5629             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5630         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5631             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5632             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5633         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5634         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5635         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5636         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5637         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5638         16  FILLER                         PIC X.
  5639         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5640             20  CF-ST-BENEFIT-CD           PIC XX.
  5641             20  CF-ST-BENEFIT-KIND         PIC X.
  5642                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5643                 88  CF-ST-AH-KIND              VALUE 'A'.
  5644             20  CF-ST-REM-TERM-CALC        PIC X.
  5645                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5646                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5647                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5648                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5649                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5650                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5651                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5652                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5653
  5654             20  CF-ST-REFUND-CALC          PIC X.
  5655                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5656                 88  ST-REFD-BY-R78             VALUE '1'.
  5657                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5658                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5659                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5660                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5661                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5662                 88  ST-REFD-UTAH               VALUE '7'.
  5663                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5664                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5665                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5666
  5667             20  CF-ST-EARNING-CALC         PIC X.
  5668                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5669                 88  ST-EARN-BY-R78             VALUE '1'.
  5670                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5671                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5672                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 105
* EL050.cbl
  5673                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5674                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5675                 88  ST-EARN-MEAN               VALUE '8'.
  5676                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5677
  5678             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5679                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5680                 88  ST-OVRD-BY-R78             VALUE '1'.
  5681                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5682                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5683                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5684                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5685                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5686                 88  ST-OVRD-MEAN               VALUE '8'.
  5687                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5688             20  cf-st-extra-periods        pic 9.
  5689*            20  FILLER                     PIC X.
  5690
  5691         16  CF-ST-COMMISSION-CAPS.
  5692             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5693             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5694             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5695             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5696         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5697                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5698
  5699         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5700
  5701         16  CF-ST-STATUTORY-INTEREST.
  5702             20  CF-ST-STAT-DATE-FROM       PIC X.
  5703                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5704                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5705             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5706             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5707             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5708             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5709             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5710
  5711         16  CF-ST-OVER-SHORT.
  5712             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5713             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5714
  5715         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5716
  5717         16  CF-ST-RT-CALC                  PIC X.
  5718
  5719         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5720         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5721         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5722         16  CF-ST-RF-LR-CALC               PIC X.
  5723         16  CF-ST-RF-LL-CALC               PIC X.
  5724         16  CF-ST-RF-LN-CALC               PIC X.
  5725         16  CF-ST-RF-AH-CALC               PIC X.
  5726         16  CF-ST-RF-CP-CALC               PIC X.
  5727*        16  FILLER                         PIC X(206).
  5728*CIDMOD         16  FILLER                         PIC X(192).
  5729         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5730             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 106
* EL050.cbl
  5731         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5732         16  CF-ST-VFY-2ND-BENE             PIC X.
  5733         16  CF-ST-CAUSAL-STATE             PIC X.
  5734         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5735         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5736         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5737             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5738         16  CF-ST-NET-ONLY-STATE           PIC X.
  5739             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5740         16  FILLER                         PIC X(181).
  5741
  5742****************************************************************
  5743*             BENEFIT MASTER RECORD                            *
  5744****************************************************************
  5745
  5746     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5747         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5748             20  CF-BENEFIT-CODE            PIC XX.
  5749             20  CF-BENEFIT-NUMERIC  REDEFINES
  5750                 CF-BENEFIT-CODE            PIC XX.
  5751             20  CF-BENEFIT-ALPHA           PIC XXX.
  5752             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5753             20  CF-BENEFIT-COMMENT         PIC X(10).
  5754
  5755             20  CF-LF-COVERAGE-TYPE        PIC X.
  5756                 88  CF-REDUCING                VALUE 'R'.
  5757                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5758
  5759             20  CF-SPECIAL-CALC-CD         PIC X.
  5760                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5761                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5762                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5763                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5764                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5765                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5766                 88  CF-FARM-PLAN               VALUE 'F'.
  5767                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5768                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5769                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5770                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5771                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5772                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5773                 88  CF-PRUDENTIAL              VALUE 'P'.
  5774                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5775                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5776                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5777                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5778                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5779                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5780
  5781             20  CF-JOINT-INDICATOR         PIC X.
  5782                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5783
  5784*            20  FILLER                     PIC X(12).
  5785             20  cf-maximum-benefits        pic s999 comp-3.
  5786             20  FILLER                     PIC X(09).
  5787             20  CF-BENEFIT-CATEGORY        PIC X.
  5788             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 107
* EL050.cbl
  5789
  5790             20  CF-CO-REM-TERM-CALC        PIC X.
  5791                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5792                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5793                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5794                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5795                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5796
  5797             20  CF-CO-EARNINGS-CALC        PIC X.
  5798                 88  CO-EARN-BY-R78             VALUE '1'.
  5799                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5800                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5801                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5802                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5803                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5804                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5805                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5806
  5807             20  CF-CO-REFUND-CALC          PIC X.
  5808                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5809                 88  CO-REFD-BY-R78             VALUE '1'.
  5810                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5811                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5812                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5813                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5814                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5815                 88  CO-REFD-MEAN               VALUE '8'.
  5816                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5817                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5818                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5819
  5820             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5821                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5822                 88  CO-OVRD-BY-R78             VALUE '1'.
  5823                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5824                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5825                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5826                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5827                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5828                 88  CO-OVRD-MEAN               VALUE '8'.
  5829                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5830
  5831             20  CF-CO-BEN-I-G-CD           PIC X.
  5832                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5833                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5834                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5835
  5836         16  FILLER                         PIC X(304).
  5837
  5838
  5839****************************************************************
  5840*             CARRIER MASTER RECORD                            *
  5841****************************************************************
  5842
  5843     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5844         16  CF-ADDRESS-DATA.
  5845             20  CF-MAIL-TO-NAME            PIC X(30).
  5846             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 108
* EL050.cbl
  5847             20  CF-ADDRESS-LINE-1          PIC X(30).
  5848             20  CF-ADDRESS-LINE-2          PIC X(30).
  5849             20  CF-CITY-STATE              PIC X(30).
  5850             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5851             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5852
  5853         16  CF-CLAIM-NO-CONTROL.
  5854             20  CF-CLAIM-NO-METHOD         PIC X.
  5855                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5856                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5857                 88  CLAIM-NO-SEQ               VALUE '3'.
  5858                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5859             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5860                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5861                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5862                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5863
  5864         16  CF-CHECK-NO-CONTROL.
  5865             20  CF-CHECK-NO-METHOD         PIC X.
  5866                 88  CHECK-NO-MANUAL            VALUE '1'.
  5867                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5868                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5869                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5870             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5871                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5872
  5873         16  CF-DOMICILE-STATE              PIC XX.
  5874
  5875         16  CF-EXPENSE-CONTROLS.
  5876             20  CF-EXPENSE-METHOD          PIC X.
  5877                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5878                 88  DOLLARS-PER-PMT            VALUE '2'.
  5879                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5880                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5881             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5882             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5883
  5884         16  CF-CORRESPONDENCE-CONTROL.
  5885             20  CF-LETTER-RESEND-OPT       PIC X.
  5886                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5887                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5888             20  FILLER                     PIC X(4).
  5889
  5890         16  CF-RESERVE-CONTROLS.
  5891             20  CF-MANUAL-SW               PIC X.
  5892                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5893             20  CF-FUTURE-SW               PIC X.
  5894                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5895             20  CF-PTC-SW                  PIC X.
  5896                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5897             20  CF-IBNR-SW                 PIC X.
  5898                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5899             20  CF-PTC-LF-SW               PIC X.
  5900                 88  CF-LF-PTC-USED             VALUE '1'.
  5901             20  CF-CDT-ACCESS-METHOD       PIC X.
  5902                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5903                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5904                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 109
* EL050.cbl
  5905             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5906
  5907         16  CF-CLAIM-CALC-METHOD           PIC X.
  5908             88  360-PLUS-MONTHS                VALUE '1'.
  5909             88  365-PLUS-MONTHS                VALUE '2'.
  5910             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5911             88  360-DAILY                      VALUE '4'.
  5912             88  365-DAILY                      VALUE '5'.
  5913
  5914         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5915         16  FILLER                         PIC X(11).
  5916
  5917         16  CF-LIMIT-AMOUNTS.
  5918             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5919             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5920             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5921             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5922             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5923             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5924             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5925             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5926             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5927             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5928
  5929         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5930         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5931         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5932
  5933         16  CF-ZIP-CODE.
  5934             20  CF-ZIP-PRIME.
  5935                 24  CF-ZIP-1ST             PIC X.
  5936                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5937                 24  FILLER                 PIC X(4).
  5938             20  CF-ZIP-PLUS4               PIC X(4).
  5939         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5940             20  CF-CAN-POSTAL-1            PIC XXX.
  5941             20  CF-CAN-POSTAL-2            PIC XXX.
  5942             20  FILLER                     PIC XXX.
  5943
  5944         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5945         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5946         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5947
  5948         16  CF-RATING-SWITCH               PIC X.
  5949             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5950             88  CF-NO-RATING                   VALUE 'N'.
  5951
  5952         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5953
  5954         16  CF-CARRIER-OVER-SHORT.
  5955             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5956             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5957
  5958         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5959         16  CF-SECPAY-SWITCH               PIC X.
  5960             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5961             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5962         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 110
* EL050.cbl
  5963         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5964         16  FILLER                         PIC X(444).
  5965*        16  FILLER                         PIC X(452).
  5966
  5967
  5968****************************************************************
  5969*             MORTALITY MASTER RECORD                          *
  5970****************************************************************
  5971
  5972     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5973         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5974                                INDEXED BY CF-MORT-NDX.
  5975             20  CF-MORT-TABLE              PIC X(5).
  5976             20  CF-MORT-TABLE-TYPE         PIC X.
  5977                 88  CF-MORT-JOINT              VALUE 'J'.
  5978                 88  CF-MORT-SINGLE             VALUE 'S'.
  5979                 88  CF-MORT-COMBINED           VALUE 'C'.
  5980                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5981                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5982             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5983             20  CF-MORT-AGE-METHOD         PIC XX.
  5984                 88  CF-AGE-LAST                VALUE 'AL'.
  5985                 88  CF-AGE-NEAR                VALUE 'AN'.
  5986             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-ADJUSTMENT-DIRECTION
  5988                                            PIC X.
  5989                 88  CF-MINUS                   VALUE '-'.
  5990                 88  CF-PLUS                    VALUE '+'.
  5991             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5992             20  CF-MORT-JOINT-CODE         PIC X.
  5993                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5994             20  CF-MORT-PC-Q               PIC X.
  5995                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5996             20  CF-MORT-TABLE-CODE         PIC X(4).
  5997             20  CF-MORT-COMMENTS           PIC X(15).
  5998             20  FILLER                     PIC X(14).
  5999
  6000         16  FILLER                         PIC X(251).
  6001
  6002
  6003****************************************************************
  6004*             BUSSINESS TYPE MASTER RECORD                     *
  6005****************************************************************
  6006
  6007     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6008* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6009* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6010* AND RECORD 05 IS TYPES 81-99
  6011         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6012             20  CF-BUSINESS-TITLE          PIC  X(19).
  6013             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6014                                            PIC S9V9(4) COMP-3.
  6015             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6016             20  FILLER                     PIC  X.
  6017         16  FILLER                         PIC  X(248).
  6018
  6019
  6020****************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 111
* EL050.cbl
  6021*             TERMINAL MASTER RECORD                           *
  6022****************************************************************
  6023
  6024     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6025
  6026         16  CF-COMPANY-TERMINALS.
  6027             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6028                                  PIC X(4).
  6029         16  FILLER               PIC X(248).
  6030
  6031
  6032****************************************************************
  6033*             LIFE EDIT MASTER RECORD                          *
  6034****************************************************************
  6035
  6036     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6037         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6038             20  CF-LIFE-CODE-IN            PIC XX.
  6039             20  CF-LIFE-CODE-OUT           PIC XX.
  6040         16  FILLER                         PIC X(248).
  6041
  6042
  6043****************************************************************
  6044*             AH EDIT MASTER RECORD                            *
  6045****************************************************************
  6046
  6047     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6048         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6049             20  CF-AH-CODE-IN              PIC XXX.
  6050             20  CF-AH-CODE-OUT             PIC XX.
  6051         16  FILLER                         PIC X(248).
  6052
  6053
  6054****************************************************************
  6055*             CREDIBILITY TABLES                               *
  6056****************************************************************
  6057
  6058     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6059         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6060                             INDEXED BY CF-CRDB-NDX.
  6061             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6062             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6063             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6064         16  FILLER                         PIC  X(332).
  6065
  6066
  6067****************************************************************
  6068*             REPORT CUSTOMIZATION RECORD                      *
  6069****************************************************************
  6070
  6071     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6072         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6073             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6074             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6075             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6076**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6077****       A T-TRANSFER.                                   ****
  6078             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 112
* EL050.cbl
  6079
  6080         16  FILLER                         PIC XX.
  6081
  6082         16  CF-CARRIER-CNTL-OPT.
  6083             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6084                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6085                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6086             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6087                                            PIC X.
  6088         16  CF-GROUP-CNTL-OPT.
  6089             20  CF-GROUP-OPT-SEQ           PIC 9.
  6090                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6091                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6092             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6093                                            PIC X(6).
  6094         16  CF-STATE-CNTL-OPT.
  6095             20  CF-STATE-OPT-SEQ           PIC 9.
  6096                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6097                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6098             20  CF-STATE-SELECT OCCURS 3 TIMES
  6099                                            PIC XX.
  6100         16  CF-ACCOUNT-CNTL-OPT.
  6101             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6102                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6103                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6104             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6105                                            PIC X(10).
  6106         16  CF-BUS-TYP-CNTL-OPT.
  6107             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6108                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6109                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6110             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6111                                            PIC XX.
  6112         16  CF-LF-TYP-CNTL-OPT.
  6113             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6114                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6115                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6116             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6117                                            PIC XX.
  6118         16  CF-AH-TYP-CNTL-OPT.
  6119             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6120                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6121                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6122             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6123                                            PIC XX.
  6124         16  CF-REPTCD1-CNTL-OPT.
  6125             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6126                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6127                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6128             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6129                                            PIC X(10).
  6130         16  CF-REPTCD2-CNTL-OPT.
  6131             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6132                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6133                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6134             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6135                                            PIC X(10).
  6136         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 113
* EL050.cbl
  6137             20  CF-USER1-OPT-SEQ           PIC 9.
  6138                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6139                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6140             20  CF-USER1-SELECT OCCURS 3 TIMES
  6141                                            PIC X(10).
  6142         16  CF-USER2-CNTL-OPT.
  6143             20  CF-USER2-OPT-SEQ           PIC 9.
  6144                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6145                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6146             20  CF-USER2-SELECT OCCURS 3 TIMES
  6147                                            PIC X(10).
  6148         16  CF-USER3-CNTL-OPT.
  6149             20  CF-USER3-OPT-SEQ           PIC 9.
  6150                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6151                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6152             20  CF-USER3-SELECT OCCURS 3 TIMES
  6153                                            PIC X(10).
  6154         16  CF-USER4-CNTL-OPT.
  6155             20  CF-USER4-OPT-SEQ           PIC 9.
  6156                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6157                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6158             20  CF-USER4-SELECT OCCURS 3 TIMES
  6159                                            PIC X(10).
  6160         16  CF-USER5-CNTL-OPT.
  6161             20  CF-USER5-OPT-SEQ           PIC 9.
  6162                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6163                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6164             20  CF-USER5-SELECT OCCURS 3 TIMES
  6165                                            PIC X(10).
  6166         16  CF-REINS-CNTL-OPT.
  6167             20  CF-REINS-OPT-SEQ           PIC 9.
  6168                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6169                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6170             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6171                 24  CF-REINS-PRIME         PIC XXX.
  6172                 24  CF-REINS-SUB           PIC XXX.
  6173
  6174         16  CF-AGENT-CNTL-OPT.
  6175             20  CF-AGENT-OPT-SEQ           PIC 9.
  6176                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6177                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6178             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6179                                            PIC X(10).
  6180
  6181         16  FILLER                         PIC X(43).
  6182
  6183         16  CF-LOSS-RATIO-SELECT.
  6184             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6185             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6186         16  CF-ENTRY-DATE-SELECT.
  6187             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6188             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6189         16  CF-EFFECTIVE-DATE-SELECT.
  6190             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6191             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6192
  6193         16  CF-EXCEPTION-LIST-IND          PIC X.
  6194             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 114
* EL050.cbl
  6195
  6196         16  FILLER                         PIC X(318).
  6197
  6198****************************************************************
  6199*                  EXCEPTION REPORTING RECORD                  *
  6200****************************************************************
  6201
  6202     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6203         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6204             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6205
  6206         16  CF-COMBINED-LIFE-AH-OPT.
  6207             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6208             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6209             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6210             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6211
  6212         16  CF-LIFE-OPT.
  6213             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6214             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6215             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6216             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6218             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6219             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6220             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6221             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6222             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6223
  6224         16  CF-AH-OPT.
  6225             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6226             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6227             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6228             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6230             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6231             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6232             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6233             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6234             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6235
  6236         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6237             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6238             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6239             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6240
  6241         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6242
  6243         16  FILLER                         PIC X(673).
  6244
  6245
  6246****************************************************************
  6247*             MORTGAGE SYSTEM PLAN RECORD                      *
  6248****************************************************************
  6249
  6250     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6251         16  CF-PLAN-TYPE                   PIC X.
  6252             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 115
* EL050.cbl
  6253             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6254             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6255         16  CF-PLAN-ABBREV                 PIC XXX.
  6256         16  CF-PLAN-DESCRIPT               PIC X(10).
  6257         16  CF-PLAN-NOTES                  PIC X(20).
  6258         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6259         16  CF-PLAN-UNDERWRITING.
  6260             20  CF-PLAN-TERM-DATA.
  6261                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6262                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6263             20  CF-PLAN-AGE-DATA.
  6264                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6265                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6266                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6267             20  CF-PLAN-BENEFIT-DATA.
  6268                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6269                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6270                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6271                                            PIC S9(7)V99  COMP-3.
  6272         16  CF-PLAN-POLICY-FORMS.
  6273             20  CF-POLICY-FORM             PIC X(12).
  6274             20  CF-MASTER-APPLICATION      PIC X(12).
  6275             20  CF-MASTER-POLICY           PIC X(12).
  6276         16  CF-PLAN-RATING.
  6277             20  CF-RATE-CODE               PIC X(5).
  6278             20  CF-SEX-RATING              PIC X.
  6279                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6280                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6281             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6282             20  CF-SUB-STD-TYPE            PIC X.
  6283                 88  CF-PCT-OF-PREM            VALUE '1'.
  6284                 88  CF-PCT-OF-BENE            VALUE '2'.
  6285         16  CF-PLAN-PREM-TOLERANCES.
  6286             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6287             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6288         16  CF-PLAN-PYMT-TOLERANCES.
  6289             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6290             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6291         16  CF-PLAN-MISC-DATA.
  6292             20  FILLER                     PIC X.
  6293             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6294             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6295         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6296         16  CF-PLAN-IND-GRP                PIC X.
  6297             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6298                                                     '1'.
  6299             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6300                                                     '2'.
  6301         16  CF-MIB-SEARCH-SW               PIC X.
  6302             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6303             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6304             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6305             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6306         16  CF-ALPHA-SEARCH-SW             PIC X.
  6307             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6308             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6309             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6310             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 116
* EL050.cbl
  6311             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6312             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6313             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6314             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6315             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6316             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6317                                                     'A' 'B' 'C'
  6318                                                     'X' 'Y' 'Z'.
  6319         16  CF-EFF-DT-RULE-SW              PIC X.
  6320             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6321             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6322             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6323             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6324             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6325         16  FILLER                         PIC X(4).
  6326         16  CF-HEALTH-QUESTIONS            PIC X.
  6327             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6328         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6329         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6330         16  CF-PLAN-SNGL-JNT               PIC X.
  6331             88  CF-COMBINED-PLAN              VALUE 'C'.
  6332             88  CF-JNT-PLAN                   VALUE 'J'.
  6333             88  CF-SNGL-PLAN                  VALUE 'S'.
  6334         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6335         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6336         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6337         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6338         16  CF-RERATE-CNTL                 PIC  X.
  6339             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6340             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6341             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6342             88  CF-AUTO-RECALC                 VALUE '4'.
  6343         16  CF-BENEFIT-TYPE                PIC  X.
  6344             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6345             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6346         16  CF-POLICY-FEE                  PIC S999V99
  6347                                                    COMP-3.
  6348         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6349         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6350         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6351         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6352         16  FILLER                         PIC  X(32).
  6353         16  CF-TERMINATION-FORM            PIC  X(04).
  6354         16  FILLER                         PIC  X(08).
  6355         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6356                                                       COMP-3.
  6357         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6358         16  CF-ISSUE-LETTER                PIC  X(4).
  6359         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6360         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6361             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6362             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6363         16  CF-MP-REFUND-CALC              PIC X.
  6364             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6365             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6366             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6367             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6368             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 117
* EL050.cbl
  6369             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6370             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6371             88  CF-MP-REFD-MEAN                VALUE '8'.
  6372         16  CF-ALT-RATE-CODE               PIC  X(5).
  6373
  6374
  6375         16  FILLER                         PIC X(498).
  6376****************************************************************
  6377*             MORTGAGE COMPANY MASTER RECORD                   *
  6378****************************************************************
  6379
  6380     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6381         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6382         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6383             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6384             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6385             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6386             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6387             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6388
  6389         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6390         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6391         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6392         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6393         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6394
  6395         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6396             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6397         16  CF-MP-RECON-USE-IND            PIC X(1).
  6398             88  CF-MP-USE-RECON             VALUE 'Y'.
  6399         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6400             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6401         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6402             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6403             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6404         16  FILLER                         PIC X(1).
  6405         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6406             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6407         16  CF-MORTG-MIB-VERSION           PIC X.
  6408             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6409             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6410             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6411         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6412             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6413                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6414             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6415                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6416             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6417                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6418             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6419                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6420             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6421                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6422             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6423                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6424         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6425         16  FILLER                         PIC X(7).
  6426         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 118
* EL050.cbl
  6427             20  CF-MORTG-MIB-COMM          PIC X(5).
  6428             20  CF-MORTG-MIB-TERM          PIC X(5).
  6429         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6430             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6431         16  FILLER                         PIC X(03).
  6432         16  CF-MP-CHECK-NO-CONTROL.
  6433             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6434                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6435                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6436                                                ' ' LOW-VALUES.
  6437                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6438                                               VALUE '3'.
  6439         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6440         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6441         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6442             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6443                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6444             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6445                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6446             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6447                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6448             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6449                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6450             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6451                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6452             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6453                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6454         16  CF-MORTG-BILLING-AREA.
  6455             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6456                                            PIC X.
  6457         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6458         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6459         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6460         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6461             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6462             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6463         16  FILLER                         PIC X.
  6464         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6465             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6466             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6467         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6468         16  FILLER                         PIC X(8).
  6469         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6470         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6471         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6472         16  CF-ACH-COMPANY-ID.
  6473             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6474                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6475                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6476                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6477             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6478         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6479             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6480         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6481             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6482             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6483         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6484         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 119
* EL050.cbl
  6485         16  FILLER                         PIC X(536).
  6486
  6487****************************************************************
  6488*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6489****************************************************************
  6490
  6491     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6492         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6493             20  CF-FEMALE-HEIGHT.
  6494                 24  CF-FEMALE-FT           PIC 99.
  6495                 24  CF-FEMALE-IN           PIC 99.
  6496             20  CF-FEMALE-MIN-WT           PIC 999.
  6497             20  CF-FEMALE-MAX-WT           PIC 999.
  6498         16  FILLER                         PIC X(428).
  6499
  6500     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6501         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6502             20  CF-MALE-HEIGHT.
  6503                 24  CF-MALE-FT             PIC 99.
  6504                 24  CF-MALE-IN             PIC 99.
  6505             20  CF-MALE-MIN-WT             PIC 999.
  6506             20  CF-MALE-MAX-WT             PIC 999.
  6507         16  FILLER                         PIC X(428).
  6508******************************************************************
  6509*             AUTOMATIC ACTIVITY RECORD                          *
  6510******************************************************************
  6511     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6512         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6513             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6514             20  CF-SYS-LETTER-ID           PIC X(04).
  6515             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6516             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6517             20  CF-SYS-RESET-SW            PIC X(01).
  6518             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6519             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6520
  6521         16  FILLER                         PIC X(50).
  6522
  6523         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6524             20  CF-USER-ACTIVE-SW          PIC X(01).
  6525             20  CF-USER-LETTER-ID          PIC X(04).
  6526             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6527             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6528             20  CF-USER-RESET-SW           PIC X(01).
  6529             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6530             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6531             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6532
  6533         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 120
* EL050.cbl
  6535*    COPY ERCACCT.
  6536******************************************************************
  6537*                                                                *
  6538*                                                                *
  6539*                            ERCACCT                             *
  6540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6541*                            VMOD=2.031                          *
  6542*                                                                *
  6543*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6544*                                                                *
  6545*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6546*   VSAM ACCOUNT MASTER FILES.                                   *
  6547*                                                                *
  6548*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6549*                                                                *
  6550*   FILE TYPE = VSAM,KSDS                                        *
  6551*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6552*                                                                *
  6553*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6554*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6555*                                                                *
  6556*   LOG = NO                                                     *
  6557*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6558*                                                                *
  6559*                                                                *
  6560******************************************************************
  6561*                   C H A N G E   L O G
  6562*
  6563* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6564*-----------------------------------------------------------------
  6565*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6566* EFFECTIVE    NUMBER
  6567*-----------------------------------------------------------------
  6568* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6569* 092705    2005050300006  PEMA  ADD SPP LEASES
  6570* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6571* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6572* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6573* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6574* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6575* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6576******************************************************************
  6577
  6578 01  ACCOUNT-MASTER.
  6579     12  AM-RECORD-ID                      PIC XX.
  6580         88  VALID-AM-ID                      VALUE 'AM'.
  6581
  6582     12  AM-CONTROL-PRIMARY.
  6583         16  AM-COMPANY-CD                 PIC X.
  6584         16  AM-MSTR-CNTRL.
  6585             20  AM-CONTROL-A.
  6586                 24  AM-CARRIER            PIC X.
  6587                 24  AM-GROUPING.
  6588                     28 AM-GROUPING-PREFIX PIC XXX.
  6589                     28 AM-GROUPING-PRIME  PIC XXX.
  6590                 24  AM-STATE              PIC XX.
  6591                 24  AM-ACCOUNT.
  6592                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 121
* EL050.cbl
  6593                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6594             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6595                                           PIC X(19).
  6596             20  AM-CNTRL-B.
  6597                 24  AM-EXPIRATION-DT      PIC XX.
  6598                 24  FILLER                PIC X(4).
  6599             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6600                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6601
  6602     12  AM-CONTROL-BY-VAR-GRP.
  6603         16  AM-COMPANY-CD-A1              PIC X.
  6604         16  AM-VG-CARRIER                 PIC X.
  6605         16  AM-VG-GROUPING                PIC X(6).
  6606         16  AM-VG-STATE                   PIC XX.
  6607         16  AM-VG-ACCOUNT                 PIC X(10).
  6608         16  AM-VG-DATE.
  6609             20  AM-VG-EXPIRATION-DT       PIC XX.
  6610             20  FILLER                    PIC X(4).
  6611         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6612                                           PIC 9(11)      COMP-3.
  6613     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6614         16  FILLER                        PIC X(10).
  6615         16  AM-VG-KEY3.
  6616             20  AM-VG3-ACCOUNT            PIC X(10).
  6617             20  AM-VG3-EXP-DT             PIC XX.
  6618         16  FILLER                        PIC X(4).
  6619     12  AM-MAINT-INFORMATION.
  6620         16  AM-LAST-MAINT-DT              PIC XX.
  6621         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6622         16  AM-LAST-MAINT-USER            PIC X(4).
  6623         16  FILLER                        PIC XX.
  6624
  6625     12  AM-EFFECTIVE-DT                   PIC XX.
  6626     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6627
  6628     12  AM-PREV-DATES  COMP-3.
  6629         16  AM-PREV-EXP-DT                PIC 9(11).
  6630         16  AM-PREV-EFF-DT                PIC 9(11).
  6631
  6632     12  AM-REPORT-CODE-1                  PIC X(10).
  6633     12  AM-REPORT-CODE-2                  PIC X(10).
  6634
  6635     12  AM-CITY-CODE                      PIC X(4).
  6636     12  AM-COUNTY-PARISH                  PIC X(6).
  6637
  6638     12  AM-NAME                           PIC X(30).
  6639     12  AM-PERSON                         PIC X(30).
  6640     12  AM-ADDRS                          PIC X(30).
  6641     12  AM-CITY.
  6642         16  AM-ADDR-CITY                  PIC X(28).
  6643         16  AM-ADDR-STATE                 PIC XX.
  6644     12  AM-ZIP.
  6645         16  AM-ZIP-PRIME.
  6646             20  AM-ZIP-PRI-1ST            PIC X.
  6647                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6648             20  FILLER                    PIC X(4).
  6649         16  AM-ZIP-PLUS4                  PIC X(4).
  6650     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 122
* EL050.cbl
  6651         16  AM-CAN-POSTAL-1               PIC XXX.
  6652         16  AM-CAN-POSTAL-2               PIC XXX.
  6653         16  FILLER                        PIC XXX.
  6654     12  AM-TEL-NO.
  6655         16  AM-AREA-CODE                  PIC 999.
  6656         16  AM-TEL-PRE                    PIC 999.
  6657         16  AM-TEL-NBR                    PIC 9(4).
  6658     12  AM-TEL-LOC                        PIC X.
  6659         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6660         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6661
  6662     12  AM-COMM-STRUCTURE.
  6663         16  AM-DEFN-1.
  6664             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6665                 24  AM-AGT.
  6666                     28  AM-AGT-PREFIX     PIC X(4).
  6667                     28  AM-AGT-PRIME      PIC X(6).
  6668                 24  AM-COM-TYP            PIC X.
  6669                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6670                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6671                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6672                 24  AM-RECALC-LV-INDIC    PIC X.
  6673                 24  AM-RETRO-LV-INDIC     PIC X.
  6674                 24  AM-GL-CODES           PIC X.
  6675                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6676                 24  FILLER                PIC X(01).
  6677         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6678             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6679                 24  FILLER                PIC X(11).
  6680                 24  AM-L-COMA             PIC XXX.
  6681                 24  AM-J-COMA             PIC XXX.
  6682                 24  AM-A-COMA             PIC XXX.
  6683                 24  FILLER                PIC X(6).
  6684
  6685     12  AM-COMM-CHANGE-STATUS             PIC X.
  6686         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6687
  6688     12  AM-CSR-CODE                       PIC X(4).
  6689
  6690     12  AM-BILLING-STATUS                 PIC X.
  6691         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6692         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6693     12  AM-AUTO-REFUND-SW                 PIC X.
  6694         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6695         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6696     12  AM-GPCD                           PIC 99.
  6697     12  AM-IG                             PIC X.
  6698         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6699         88  AM-HAS-GROUP                     VALUE '2'.
  6700     12  AM-STATUS                         PIC X.
  6701         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6702         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6703         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6704         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6705         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6706         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6707         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6708         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 123
* EL050.cbl
  6709         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6710         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6711     12  AM-REMIT-TO                       PIC 99.
  6712     12  AM-ID-NO                          PIC X(11).
  6713
  6714     12  AM-CAL-TABLE                      PIC XX.
  6715     12  AM-LF-DEVIATION                   PIC XXX.
  6716     12  AM-AH-DEVIATION                   PIC XXX.
  6717     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6718     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6719     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6720     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6721     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6722     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6723
  6724     12  AM-USER-FIELDS.
  6725         16  AM-FLD-1                      PIC XX.
  6726         16  AM-FLD-2                      PIC XX.
  6727         16  AM-FLD-3                      PIC XX.
  6728         16  AM-FLD-4                      PIC XX.
  6729         16  AM-FLD-5                      PIC XX.
  6730
  6731     12  AM-1ST-PROD-DATE.
  6732         16  AM-1ST-PROD-YR                PIC XX.
  6733         16  AM-1ST-PROD-MO                PIC XX.
  6734         16  AM-1ST-PROD-DA                PIC XX.
  6735     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6736     12  AM-CERTS-PURGED-DATE.
  6737         16  AM-PUR-YR                     PIC XX.
  6738         16  AM-PUR-MO                     PIC XX.
  6739         16  AM-PUR-DA                     PIC XX.
  6740     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6741     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6742     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6743     12  AM-INACTIVE-DATE.
  6744         16  AM-INA-MO                     PIC 99.
  6745         16  AM-INA-DA                     PIC 99.
  6746         16  AM-INA-YR                     PIC 99.
  6747     12  AM-AR-HI-CERT-DATE                PIC XX.
  6748
  6749     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6750     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6751
  6752     12  AM-OB-PAYMENT-MODE                PIC X.
  6753         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6754         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6755         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6756         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6757
  6758     12  AM-AH-ONLY-INDICATOR              PIC X.
  6759         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6760         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6761
  6762     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6763
  6764     12  AM-OVER-SHORT.
  6765         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6766         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 124
* EL050.cbl
  6767
  6768     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6769     12  AM-DCC-CLP-STATE                  PIC XX.
  6770
  6771     12  AM-RECALC-COMM                    PIC X.
  6772     12  AM-RECALC-REIN                    PIC X.
  6773
  6774     12  AM-REI-TABLE                      PIC XXX.
  6775     12  AM-REI-ET-LF                      PIC X.
  6776     12  AM-REI-ET-AH                      PIC X.
  6777     12  AM-REI-PE-LF                      PIC X.
  6778     12  AM-REI-PE-AH                      PIC X.
  6779     12  AM-REI-PRT-ST                     PIC X.
  6780     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6781     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6782     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6783     12  AM-REI-GROUP-A                    PIC X(6).
  6784     12  AM-REI-MORT                       PIC X(4).
  6785     12  AM-REI-PRT-OW                     PIC X.
  6786     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6787     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6788     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6789     12  AM-REI-GROUP-B                    PIC X(6).
  6790
  6791     12  AM-TRUST-TYPE                     PIC X(2).
  6792
  6793     12  AM-EMPLOYER-STMT-USED             PIC X.
  6794     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6795
  6796     12  AM-STD-AH-TYPE                    PIC XX.
  6797     12  AM-EARN-METHODS.
  6798         16  AM-EARN-METHOD-R              PIC X.
  6799             88 AM-REF-RL-R78                 VALUE 'R'.
  6800             88 AM-REF-RL-PR                  VALUE 'P'.
  6801             88 AM-REF-RL-MEAN                VALUE 'M'.
  6802             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6803         16  AM-EARN-METHOD-L              PIC X.
  6804             88 AM-REF-LL-R78                 VALUE 'R'.
  6805             88 AM-REF-LL-PR                  VALUE 'P'.
  6806             88 AM-REF-LL-MEAN                VALUE 'M'.
  6807             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6808         16  AM-EARN-METHOD-A              PIC X.
  6809             88 AM-REF-AH-R78                 VALUE 'R'.
  6810             88 AM-REF-AH-PR                  VALUE 'P'.
  6811             88 AM-REF-AH-MEAN                VALUE 'M'.
  6812             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6813             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6814             88 AM-REF-AH-NET                 VALUE 'N'.
  6815
  6816     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6817     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6818     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6819
  6820     12  AM-RET-Y-N                        PIC X.
  6821     12  AM-RET-P-E                        PIC X.
  6822     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6823     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6824     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 125
* EL050.cbl
  6825     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6826         16  AM-POOL-PRIME                 PIC XXX.
  6827         16  AM-POOL-SUB                   PIC XXX.
  6828     12  AM-RETRO-EARNINGS.
  6829         16  AM-RET-EARN-R                 PIC X.
  6830         16  AM-RET-EARN-L                 PIC X.
  6831         16  AM-RET-EARN-A                 PIC X.
  6832     12  AM-RET-ST-TAX-USE                 PIC X.
  6833         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6834         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6835     12  AM-RETRO-BEG-EARNINGS.
  6836         16  AM-RET-BEG-EARN-R             PIC X.
  6837         16  AM-RET-BEG-EARN-L             PIC X.
  6838         16  AM-RET-BEG-EARN-A             PIC X.
  6839     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6840     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6841
  6842     12  AM-USER-SELECT-OPTIONS.
  6843         16  AM-USER-SELECT-1              PIC X(10).
  6844         16  AM-USER-SELECT-2              PIC X(10).
  6845         16  AM-USER-SELECT-3              PIC X(10).
  6846         16  AM-USER-SELECT-4              PIC X(10).
  6847         16  AM-USER-SELECT-5              PIC X(10).
  6848
  6849     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6850
  6851     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6852
  6853     12  AM-RPT045A-SWITCH                 PIC X.
  6854         88  RPT045A-OFF                   VALUE 'N'.
  6855
  6856     12  AM-INSURANCE-LIMITS.
  6857         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6858         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6859
  6860     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6861         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6862
  6863     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6864         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6865         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6866
  6867     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6868
  6869     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6870     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6871     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6872     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6873     12  AM-DCC-UEF-STATE                  PIC XX.
  6874     12  FILLER                            PIC XXX.
  6875     12  AM-REPORT-CODE-3                  PIC X(10).
  6876*    12  FILLER                            PIC X(22).
  6877
  6878     12  AM-RESERVE-DATE.
  6879         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6880         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6881         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6882
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 126
* EL050.cbl
  6883     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6884     12  AM-NOTIFICATION-TYPES.
  6885         16  AM-NOTIF-OF-LETTERS           PIC X.
  6886         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6887         16  AM-NOTIF-OF-REPORTS           PIC X.
  6888         16  AM-NOTIF-OF-STATUS            PIC X.
  6889
  6890     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6891         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6892         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6893         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6894         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6895
  6896     12  AM-BENEFIT-CONTROLS.
  6897         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6898             20  AM-BENEFIT-CODE           PIC XX.
  6899             20  AM-BENEFIT-TYPE           PIC X.
  6900             20  AM-BENEFIT-REVISION       PIC XXX.
  6901             20  AM-BENEFIT-REM-TERM       PIC X.
  6902             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6903             20  FILLER                    PIC XX.
  6904         16  FILLER                        PIC X(80).
  6905
  6906     12  AM-TRANSFER-DATA.
  6907         16  AM-TRANSFERRED-FROM.
  6908             20  AM-TRNFROM-CARRIER        PIC X.
  6909             20  AM-TRNFROM-GROUPING.
  6910                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6911                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6912             20  AM-TRNFROM-STATE          PIC XX.
  6913             20  AM-TRNFROM-ACCOUNT.
  6914                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6915                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6916             20  AM-TRNFROM-DTE            PIC XX.
  6917         16  AM-TRANSFERRED-TO.
  6918             20  AM-TRNTO-CARRIER          PIC X.
  6919             20  AM-TRNTO-GROUPING.
  6920                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6921                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6922             20  AM-TRNTO-STATE            PIC XX.
  6923             20  AM-TRNTO-ACCOUNT.
  6924                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6925                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6926             20  AM-TRNTO-DTE              PIC XX.
  6927         16  FILLER                        PIC X(10).
  6928
  6929     12  AM-SAVED-REMIT-TO                 PIC 99.
  6930
  6931     12  AM-COMM-STRUCTURE-SAVED.
  6932         16  AM-DEFN-1-SAVED.
  6933             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6934                 24  AM-AGT-SV             PIC X(10).
  6935                 24  AM-COM-TYP-SV         PIC X.
  6936                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6937                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6938                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6939                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6940                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 127
* EL050.cbl
  6941                 24  AM-GL-CODES-SV        PIC X.
  6942                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6943                 24  FILLER                PIC X.
  6944         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6945             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6946                 24  FILLER                PIC X(11).
  6947                 24  AM-L-COMA-SV          PIC XXX.
  6948                 24  AM-J-COMA-SV          PIC XXX.
  6949                 24  AM-A-COMA-SV          PIC XXX.
  6950                 24  FILLER                PIC X(6).
  6951
  6952     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6953         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6954            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6955            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6956            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6957
  6958     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6959     12  FILLER                            PIC X(120).
  6960
  6961     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6962         16  AM-CONTROL-NAME               PIC X(30).
  6963         16  AM-EXECUTIVE-ONE.
  6964             20  AM-EXEC1-NAME             PIC X(15).
  6965             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6966                                                          COMP-3.
  6967             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6968                                                          COMP-3.
  6969         16  AM-EXECUTIVE-TWO.
  6970             20  AM-EXEC2-NAME             PIC X(15).
  6971             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6972                                                          COMP-3.
  6973             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6974                                                          COMP-3.
  6975
  6976     12  AM-RETRO-ADDITIONAL-DATA.
  6977         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6978         16  AM-RETRO-PREM-P-E             PIC X.
  6979         16  AM-RETRO-CLMS-P-I             PIC X.
  6980         16  AM-RETRO-RET-BRACKET-LF.
  6981             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6982                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6983                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6984             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6985                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6986                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6987             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6988                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6989                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6990         16  AM-RETRO-RET-BRACKET-AH.
  6991             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6992                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6993                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6994                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6995             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6996                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6997                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6998             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 128
* EL050.cbl
  6999                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7000                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7001
  7002     12  AM-COMMENTS.
  7003         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7004
  7005     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7006         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7007         16  AM-FLI-BILLING-CODE           PIC X.
  7008         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7009         16  AM-FLI-UNITED-IDENT           PIC X.
  7010         16  AM-FLI-INTEREST-LOST-DATA.
  7011             20  AM-FLI-BANK-NO            PIC X(5).
  7012             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7013             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7014             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7015         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7016             20  AM-FLI-AGT                PIC X(9).
  7017             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7018             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7019         16  FILLER                        PIC X(102).
  7020
  7021     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7022         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7023             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7024             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7025             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7026             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7027             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7028         16  FILLER                          PIC X(10).
  7029******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 129
* EL050.cbl
  7031*    COPY ERCREIN.
  7032******************************************************************
  7033*                                                                *
  7034*                            ERCREIN                             *
  7035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7036*                            VMOD=2.010                          *
  7037*                                                                *
  7038*   ONLINE CREDIT SYSTEM                                         *
  7039*                                                                *
  7040*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7041*                                                                *
  7042*   FILE TYPE = VSAM,KSDS                                        *
  7043*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7044*                                                                *
  7045*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7046*       ALTERNATE PATH = NONE                                    *
  7047*                                                                *
  7048*   LOG = NO                                                     *
  7049*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7050*                                                                *
  7051******************************************************************
  7052*                   C H A N G E   L O G
  7053*
  7054* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7055*-----------------------------------------------------------------
  7056*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7057* EFFECTIVE    NUMBER
  7058*-----------------------------------------------------------------
  7059* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7060* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7061******************************************************************
  7062 01  REINSURANCE-RECORD.
  7063     12  RE-RECORD-ID                      PIC XX.
  7064         88  VALID-RE-ID                      VALUE 'RE'.
  7065
  7066     12  RE-CONTROL-PRIMARY.
  7067         16  RE-COMPANY-CD                 PIC X.
  7068         16  RE-KEY.
  7069             20  RE-CODE                   PIC X.
  7070                 88  RE-TABLE-RECORD          VALUE 'A'.
  7071                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7072             20  RE-TABLE                  PIC XXX.
  7073             20  FILLER                    PIC XXX.
  7074         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7075             20  FILLER                    PIC X.
  7076             20  RE-COMPANY.
  7077                 24  RE-COMP-PRIME         PIC XXX.
  7078                 24  RE-COMP-SUB           PIC XXX.
  7079
  7080     12  RE-MAINT-INFORMATION.
  7081         16  RE-LAST-MAINT-DT              PIC XX.
  7082         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7083         16  RE-LAST-MAINT-USER            PIC X(4).
  7084         16  FILLER                        PIC X(10).
  7085
  7086     12  RE-TABLE-DATA.
  7087         16  RE-100-COMP                   PIC 99.
  7088
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 130
* EL050.cbl
  7089         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7090             20  RE-REI-COMP-NO.
  7091                 24  RE-REI-COMP           PIC XXX.
  7092                 24  RE-REI-COMP-SUB       PIC XXX.
  7093             20  RE-LF-QC                  PIC X.
  7094             20  RE-AH-QC                  PIC X.
  7095             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7096             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7097             20  RE-LFAGE-LO               PIC 99.
  7098             20  RE-LFAGE-HI               PIC 99.
  7099             20  RE-AHAGE-LO               PIC 99.
  7100             20  RE-AHAGE-HI               PIC 99.
  7101             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7102             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7103             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7104             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7105             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7106             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7107             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7108             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7109             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7110             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7111             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7112             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7113             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7114             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7115             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7116             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7117             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7118             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7119             20  RE-LF-BEN-CODE            PIC X.
  7120             20  RE-AH-BEN-CODE            PIC X.
  7121             20  RE-INTERACTIVE            PIC X.
  7122             20  RE-REMAINING              PIC X.
  7123             20  RE-LF-RUNOFF-SW           PIC X.
  7124             20  RE-AH-RUNOFF-SW           PIC X.
  7125             20  FILLER                    PIC X(19).
  7126
  7127         16  RE-COMP-INFO-END              PIC X(6).
  7128         16  RE-NSP-ST-CD-LF               PIC XX.
  7129         16  RE-NSP-ST-CD-AH               PIC XX.
  7130         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7131             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7132
  7133         16  FILLER                        PIC X(27).
  7134
  7135     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7136         16  RE-NAME                       PIC X(30).
  7137         16  RE-LF-PE                      PIC X.
  7138         16  RE-AH-PE                      PIC X.
  7139         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7140         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7141         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7142         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7143         16  RE-PRT-ST                     PIC X.
  7144         16  RE-PRT-OW                     PIC X.
  7145         16  RE-MORT-CODE                  PIC X(4).
  7146         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 131
* EL050.cbl
  7147         16  RE-ZERO-LF-FEE                PIC X.
  7148         16  RE-ZERO-AH-FEE                PIC X.
  7149         16  RE-CEDE-NAME                  PIC X(30).
  7150         16  RE-LF-COMM                    PIC X.
  7151         16  RE-AH-COMM                    PIC X.
  7152         16  RE-LF-TAX                     PIC X.
  7153         16  RE-AH-TAX                     PIC X.
  7154         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7155         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7156         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7157
  7158         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7159             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7160
  7161         16  RE-LF-CEDING-FEE-BRACKETS.
  7162             20  RE-LF-FEE-METHOD          PIC X.
  7163                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7164                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7165                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7166                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7167             20  RE-LF-FEE-BASIS           PIC X.
  7168                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7169                 88  RE-LF-NET-CEDED               VALUE '2'.
  7170                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7171                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7172                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7173                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7174                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7175                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7176             20  FILLER                    PIC XXX.
  7177             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7178                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7179                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7180
  7181         16  RE-AH-CEDING-FEE-BRACKETS.
  7182             20  RE-AH-FEE-METHOD          PIC X.
  7183                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7184                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7185                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7186                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7187             20  RE-AH-FEE-BASIS           PIC X.
  7188                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7189                 88  RE-AH-NET-CEDED               VALUE '2'.
  7190                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7191                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7192                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7193                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7194                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7195                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7196             20  FILLER                    PIC XXX.
  7197             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7198                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7199                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7200
  7201         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7202
  7203         16  RE-OLD-CEDING-STMT            PIC X.
  7204
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 132
* EL050.cbl
  7205         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7206         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7207         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7208         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7209         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7210         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7211         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7212         16  RE-MORT-SW                    PIC X.
  7213         16  RE-CEDING-TYPE-FLAG           PIC X.
  7214             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7215             88  RE-CEDED                          VALUE 'C'.
  7216             88  RE-ASSUMED                        VALUE 'A'.
  7217             88  RE-PHANTOM                        VALUE 'P'.
  7218
  7219         16  RE-CEDING-STMT-OPT-A          PIC X.
  7220             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7221         16  RE-CEDING-STMT-OPT-B          PIC X.
  7222             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7223         16  RE-CEDING-STMT-OPT-C          PIC X.
  7224             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7225         16  RE-CEDING-STMT-OPT-D          PIC X.
  7226             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7227         16  RE-CEDING-STMT-OPT-E          PIC X.
  7228             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7229
  7230         16  RE-PRT-CRSV                   PIC X.
  7231
  7232         16  RE-GL-CENTER                  PIC X(4).
  7233
  7234         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7235
  7236         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7237
  7238         16  RE-EARN-STOP-CODE             PIC X.
  7239             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7240             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7241
  7242         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7243             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7244
  7245         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7246         16  FILLER                        PIC X(2281).
  7247
  7248         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7249
  7250******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 133
* EL050.cbl
  7252*    COPY ERCCTBL.
  7253******************************************************************
  7254*                                                                *
  7255*                                                                *
  7256*                            ERCCTBL                             *
  7257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7258*                            VMOD=2.003
  7259*                                                                *
  7260*   ONLINE CREDIT SYSTEM                                         *
  7261*                                                                *
  7262*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7263*                                                                *
  7264*   FILE TYPE = VSAM,KSDS                                        *
  7265*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7266*                                                                *
  7267*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7268*       ALTERNATE PATH = NONE                                    *
  7269*                                                                *
  7270*   LOG = NO                                                     *
  7271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7272*                                                                *
  7273*                                                                *
  7274******************************************************************
  7275
  7276 01  COMM-TABLE-RECORD.
  7277     12  CT-RECORD-ID                      PIC XX.
  7278         88  VALID-CT-ID                      VALUE 'CT'.
  7279
  7280     12  CT-CONTROL-PRIMARY.
  7281         16  CT-COMPANY-CD                 PIC X.
  7282         16  CT-TABLE                      PIC XXX.
  7283         16  CT-CNTRL-2.
  7284             20  CT-BEN-TYPE               PIC X.
  7285             20  CT-BEN-CODE               PIC XX.
  7286
  7287     12  CT-MAINT-INFORMATION.
  7288         16  CT-LAST-MAINT-DT              PIC XX.
  7289         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7290         16  CT-LAST-MAINT-USER            PIC X(4).
  7291         16  FILLER                        PIC X(31).
  7292
  7293     12  CT-LIMITS.
  7294         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7295
  7296         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7297
  7298         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7299
  7300     12  CT-RATES.
  7301         16  CT-RTX          OCCURS 27 TIMES.
  7302             20  CT-RT                     PIC SV9(5)     COMP-3.
  7303             20  CT-RT-R   REDEFINES
  7304                 CT-RT                     PIC XXX.
  7305
  7306     12  FILLER                            PIC  X(42).
  7307
  7308******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 134
* EL050.cbl
  7310*    COPY ERCFORM.
  7311******************************************************************
  7312*                                                                *
  7313*                                                                *
  7314*                            ERCFORM.                            *
  7315*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7316*                            VMOD=2.003                          *
  7317*                                                                *
  7318*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7319*                                                                *
  7320*    FILE TYPE = VSAM,KSDS                                       *
  7321*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7322*                                                                *
  7323*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7324*                                                                *
  7325*    LOG = YES                                                   *
  7326*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7327******************************************************************
  7328 01  FORM-MASTER.
  7329    12  FO-RECORD-ID                 PIC X(02).
  7330        88  VALID-FO-ID                  VALUE 'FO'.
  7331
  7332    12  FO-CONTROL-PRIMARY.
  7333        16  FO-COMPANY-CD            PIC X(01).
  7334        16  FO-STATE                 PIC X(02).
  7335        16  FO-FORM-ID               PIC X(12).
  7336        16  FO-FORM-EXP-DT           PIC X(02).
  7337
  7338    12  FO-POLICY-FORM-DATA.
  7339        16  FO-IND-GRP-CD            PIC X(01).
  7340        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7341        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7342        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7343        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7344        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7345        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7346        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7347        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7348        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7349        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7350        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7351        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7352        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7353        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7354        16  FO-APP-CERT-USE-CD       PIC X(01).
  7355
  7356    12  FILLER                       PIC X(29).
  7357
  7358    12  FO-FORM-PLAN-TABLE.
  7359        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7360            20  FO-PLAN-TYPE         PIC X(01).
  7361            20  FO-PLAN-ID           PIC X(02).
  7362            20  FO-PLAN-TERM         PIC 9(03).
  7363            20  FO-PLAN-REFUND-METHOD
  7364                                     PIC X.
  7365
  7366    12  FILLER                       PIC X(30).
  7367
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 135
* EL050.cbl
  7368    12  FO-COMMENTS-AREA.
  7369        16  FO-COMMENT-LINE-1        PIC X(78).
  7370
  7371    12  FILLER                       PIC X(20).
  7372
  7373    12  FO-MAINT-INFORMATION.
  7374        16  FO-LAST-MAINT-DT         PIC X(02).
  7375        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7376        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 136
* EL050.cbl
  7378*    COPY ELCMSTR.
  7379******************************************************************
  7380*                                                                *
  7381*                            ELCMSTR.                            *
  7382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7383*                            VMOD=2.012                          *
  7384*                                                                *
  7385*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7386*                                                                *
  7387*   FILE TYPE = VSAM,KSDS                                        *
  7388*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7389*                                                                *
  7390*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7391*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7392*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7393*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7394*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7395*                                                 RKP=75,LEN=21  *
  7396*                                                                *
  7397*   **** NOTE ****                                               *
  7398*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7399*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7400*                                                                *
  7401*   LOG = YES                                                    *
  7402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7403******************************************************************
  7404*                   C H A N G E   L O G
  7405*
  7406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7407*-----------------------------------------------------------------
  7408*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7409* EFFECTIVE    NUMBER
  7410*-----------------------------------------------------------------
  7411* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7412* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7413* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7414* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7415* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7416******************************************************************
  7417 01  CLAIM-MASTER.
  7418     12  CL-RECORD-ID                PIC XX.
  7419         88  VALID-CL-ID         VALUE 'CL'.
  7420
  7421     12  CL-CONTROL-PRIMARY.
  7422         16  CL-COMPANY-CD           PIC X.
  7423         16  CL-CARRIER              PIC X.
  7424         16  CL-CLAIM-NO             PIC X(7).
  7425         16  CL-CERT-NO.
  7426             20  CL-CERT-PRIME       PIC X(10).
  7427             20  CL-CERT-SFX         PIC X.
  7428
  7429     12  CL-CONTROL-BY-NAME.
  7430         16  CL-COMPANY-CD-A1        PIC X.
  7431         16  CL-INSURED-LAST-NAME    PIC X(15).
  7432         16  CL-INSURED-NAME.
  7433             20  CL-INSURED-1ST-NAME PIC X(12).
  7434             20  CL-INSURED-MID-INIT PIC X.
  7435
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 137
* EL050.cbl
  7436     12  CL-CONTROL-BY-SSN.
  7437         16  CL-COMPANY-CD-A2        PIC X.
  7438         16  CL-SOC-SEC-NO.
  7439             20  CL-SSN-STATE        PIC XX.
  7440             20  CL-SSN-ACCOUNT      PIC X(6).
  7441             20  CL-SSN-LN3          PIC X(3).
  7442
  7443     12  CL-CONTROL-BY-CERT-NO.
  7444         16  CL-COMPANY-CD-A4        PIC X.
  7445         16  CL-CERT-NO-A4.
  7446             20  CL-CERT-A4-PRIME    PIC X(10).
  7447             20  CL-CERT-A4-SFX      PIC X.
  7448
  7449     12  CL-CONTROL-BY-CCN.
  7450         16  CL-COMPANY-CD-A5        PIC X.
  7451         16  CL-CCN-A5.
  7452             20  CL-CCN.
  7453                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7454                 24  CL-CCN-PRIME-A5 PIC X(12).
  7455             20  CL-CCN-FILLER-A5    PIC X(4).
  7456
  7457     12  CL-INSURED-PROFILE-DATA.
  7458         16  CL-INSURED-BIRTH-DT     PIC XX.
  7459         16  CL-INSURED-SEX-CD       PIC X.
  7460             88  INSURED-IS-MALE        VALUE 'M'.
  7461             88  INSURED-IS-FEMALE      VALUE 'F'.
  7462             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7463         16  CL-INSURED-OCC-CD       PIC X(6).
  7464         16  FILLER                  PIC X(5).
  7465
  7466     12  CL-PROCESSING-INFO.
  7467         16  CL-PROCESSOR-ID         PIC X(4).
  7468         16  CL-CLAIM-STATUS         PIC X.
  7469             88  CLAIM-IS-OPEN          VALUE 'O'.
  7470             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7471         16  CL-CLAIM-TYPE           PIC X.
  7472*            88  AH-CLAIM               VALUE 'A'.
  7473*            88  LIFE-CLAIM             VALUE 'L'.
  7474*            88  PROPERTY-CLAIM         VALUE 'P'.
  7475*            88  IUI-CLAIM              VALUE 'I'.
  7476*            88  GAP-CLAIM              VALUE 'G'.
  7477*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7478         16  CL-CLAIM-PREM-TYPE      PIC X.
  7479             88  SINGLE-PREMIUM         VALUE '1'.
  7480             88  O-B-COVERAGE           VALUE '2'.
  7481             88  OPEN-END-COVERAGE      VALUE '3'.
  7482         16  CL-INCURRED-DT          PIC XX.
  7483         16  CL-REPORTED-DT          PIC XX.
  7484         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7485         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7486         16  CL-LAST-PMT-DT          PIC XX.
  7487         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7488         16  CL-PAID-THRU-DT         PIC XX.
  7489         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7490         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7491         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7492         16  CL-PMT-CALC-METHOD      PIC X.
  7493             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 138
* EL050.cbl
  7494             88  CL-365-DAY-YR          VALUE '2'.
  7495             88  CL-FULL-MONTHS         VALUE '3'.
  7496         16  CL-CAUSE-CD             PIC X(6).
  7497
  7498         16  CL-PRIME-CERT-NO.
  7499             20  CL-PRIME-CERT-PRIME PIC X(10).
  7500             20  CL-PRIME-CERT-SFX   PIC X.
  7501
  7502         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7503             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7504             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7505
  7506         16  CL-MICROFILM-NO         PIC X(10).
  7507         16  FILLER REDEFINES CL-MICROFILM-NO.
  7508             20  CL-BENEFIT-PERIOD   PIC 99.
  7509             20  FILLER              PIC X(8).
  7510         16  CL-PROG-FORM-TYPE       PIC X.
  7511         16  CL-LAST-ADD-ON-DT       PIC XX.
  7512
  7513         16  CL-LAST-REOPEN-DT       PIC XX.
  7514         16  CL-LAST-CLOSE-DT        PIC XX.
  7515         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7516             88  FINAL-PAID             VALUE '1'.
  7517             88  CLAIM-DENIED           VALUE '2'.
  7518             88  AUTO-CLOSE             VALUE '3'.
  7519             88  MANUAL-CLOSE           VALUE '4'.
  7520             88  BENEFITS-CHANGED       VALUE 'C'.
  7521             88  SETUP-ERRORS           VALUE 'E'.
  7522         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7523         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7524         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7525             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7526         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7527         16  FILLER                  PIC X.
  7528
  7529     12  CL-CERTIFICATE-DATA.
  7530         16  CL-CERT-ORIGIN          PIC X.
  7531             88  CERT-WAS-ONLINE        VALUE '1'.
  7532             88  CERT-WAS-CREATED       VALUE '2'.
  7533             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7534         16  CL-CERT-KEY-DATA.
  7535             20  CL-CERT-CARRIER     PIC X.
  7536             20  CL-CERT-GROUPING    PIC X(6).
  7537             20  CL-CERT-STATE       PIC XX.
  7538             20  CL-CERT-ACCOUNT.
  7539                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7540                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7541             20  CL-CERT-EFF-DT      PIC XX.
  7542
  7543     12  CL-STATUS-CONTROLS.
  7544         16  CL-PRIORITY-CD          PIC X.
  7545             88  CONFIDENTIAL-DATA      VALUE '8'.
  7546             88  HIGHEST-PRIORITY       VALUE '9'.
  7547         16  CL-SUPV-ATTN-CD         PIC X.
  7548             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7549             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7550         16  CL-PURGED-DT            PIC XX.
  7551         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 139
* EL050.cbl
  7552         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7553         16  CL-NEXT-RESEND-DT       PIC XX.
  7554         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7555         16  CL-CRITICAL-PERIOD      PIC 99.
  7556*        16  FILLER                  PIC XX.
  7557         16  CL-LAST-MAINT-DT        PIC XX.
  7558         16  CL-LAST-MAINT-USER      PIC X(4).
  7559         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7560         16  CL-LAST-MAINT-TYPE      PIC X.
  7561             88  CLAIM-SET-UP           VALUE ' '.
  7562             88  PAYMENT-MADE           VALUE '1'.
  7563             88  LETTER-SENT            VALUE '2'.
  7564             88  MASTER-WAS-ALTERED     VALUE '3'.
  7565             88  MASTER-WAS-RESTORED    VALUE '4'.
  7566             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7567             88  FILE-CONVERTED         VALUE '6'.
  7568             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7569             88  ERROR-CORRECTION       VALUE 'E'.
  7570         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7571         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7572         16  CL-BENEFICIARY          PIC X(10).
  7573         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7574         16  CL-DENIAL-TYPE          PIC X.
  7575             88  CL-TYPE-DENIAL          VALUE '1'.
  7576             88  CL-TYPE-RESCISSION      VALUE '2'.
  7577             88  CL-TYPE-REFORMATION     VALUE '3'.
  7578             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7579             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7580         16  filler                  pic x(5).
  7581*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7582*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7583*        16  CL-RTW-DT               PIC XX.
  7584
  7585     12  CL-TRAILER-CONTROLS.
  7586         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7587             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7588             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7589             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7590         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7591         16  FILLER                  PIC XX.
  7592         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7593         16  CL-ADDRESS-TRAILER-CNT.
  7594             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7595                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7596             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7597                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7598             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7599                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7600             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7601                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7602             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7603                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7604             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7605                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7606             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7607                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7608
  7609     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 140
* EL050.cbl
  7610         16  CL-CV-REFNO-PRIME       PIC X(18).
  7611         16  CL-CV-REFNO-SFX         PIC XX.
  7612
  7613     12  CL-FILE-LOCATION            PIC X(4).
  7614
  7615     12  CL-PROCESS-ERRORS.
  7616         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7617             88  NO-FATAL-ERRORS        VALUE ZERO.
  7618         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7619             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7620
  7621     12  CL-PRODUCT-CD               PIC X.
  7622
  7623     12  CL-CURRENT-KEY-DATA.
  7624         16  CL-CURRENT-CARRIER      PIC X.
  7625         16  CL-CURRENT-GROUPING     PIC X(6).
  7626         16  CL-CURRENT-STATE        PIC XX.
  7627         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7628
  7629     12  CL-ASSOCIATES               PIC X.
  7630         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7631         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7632         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7633         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7634
  7635     12  CL-ACTIVITY-CODE            PIC 99.
  7636     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7637     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7638
  7639     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7640     12  CL-LAG-REPORT-CODE          PIC 9.
  7641     12  CL-LOAN-TYPE                PIC XX.
  7642     12  CL-LEGAL-STATE              PIC XX.
  7643
  7644     12  CL-YESNOSW                  PIC X.
  7645     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7646         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7647         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7648         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7649     12  cl-insured-type             pic x.
  7650         88  cl-claim-on-primary         value 'P'.
  7651         88  cl-claim-on-co-borrower     value 'C'.
  7652     12  cl-benefit-expiration-dt    PIC XX.
  7653
  7654 01  PLAN-RECORDS.
  7655     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7656     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7657
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 141
* EL050.cbl
  7659 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7660                          ACCOUNT-MASTER REINSURANCE-RECORD
  7661                          COMM-TABLE-RECORD FORM-MASTER
  7662                          CLAIM-MASTER PLAN-RECORDS.
  7663 0000-DFHEXIT SECTION.
  7664     MOVE '9#                    $   ' TO DFHEIV0.
  7665     MOVE 'EL050' TO DFHEIV1.
  7666     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7667
  7668     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7669
  7670
  7671* EXEC CICS  HANDLE CONDITION
  7672*           ERROR    (9300-ABEND)
  7673*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7674*    END-EXEC.
  7675*    MOVE '"$.J                  ! " #00007666' TO DFHEIV0
  7676     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7678     MOVE X'2220233030303037363636' TO DFHEIV0(25:11)
  7679     CALL 'kxdfhei1' USING DFHEIV0
  7680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7681
  7682
  7683 0000-COPY-PROCEDURE-DIV.
  7684*                          COPY ELC50PD.
  7685******************************************************************
  7686*                                                                *
  7687*                            ELC50PD                             *
  7688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7689*                            VMOD=2.188                          *
  7690*                                                                *
  7691******************************************************************
  7692*                   C H A N G E   L O G
  7693*
  7694* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7695*-----------------------------------------------------------------
  7696*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7697* EFFECTIVE    NUMBER
  7698*-----------------------------------------------------------------
  7699* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7700* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7701* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7702*                             2709 AND 2718
  7703* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7704* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7705* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7706* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7707* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7708*                                IS OPEN OR CNC DT < PD THRU
  7709* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7710* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7711* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7712* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7713* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7714* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7715* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7716* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 142
* EL050.cbl
  7717* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7718* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7719* 020906                   PEMA  EXPAND LOAN OFFICER
  7720* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7721* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7722* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7723* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7724* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7725* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7726* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7727* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7728* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7729* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7730* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7731* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7732* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7733* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7734* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7735* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7736* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7737* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7738* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7739* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7740* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7741* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7742* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7743* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7744* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7745*                                UPDATE VIN ON CERT TRAILER
  7746* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7747* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7748* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7749* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7750* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7751* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7752* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7753* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7754* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7755* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7756* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7757* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7758* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7759* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7760* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7761* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7762* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7763* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7764* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7765* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7766* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7767* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7768* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7769* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7770* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7771* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7772* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7773* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7774* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 143
* EL050.cbl
  7775* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7776* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7777* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7778* 032912  CR2011110200001  PEMA  AHL CHANGES
  7779* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7780* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7781* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7782* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7783* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7784* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7785* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7786* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7787* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7788* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7789* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7790* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7791* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7792* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7793* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7794* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7795* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7796* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7797* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7798* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7799* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7800* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7801* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7802* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7803* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7804* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7805* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7806*                                CERT #, ADD 2898 FORCIBLE ERROR
  7807* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7808* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7809* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7810* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7811* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7812* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7813* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7814* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7815* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7816* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7817* 05256   IR2016052400001  PEMA  Correct malformed IF stmt.
  7818* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7819******************************************************************
  7820************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7821******************************************************************
  7822
  7823     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7824
  7825     MOVE SPACES                 TO PB-FATAL-FLAG
  7826                                    PB-FORCE-ER-CD
  7827                                    PB-WARN-ER-CD
  7828                                    PB-OUT-BAL-CD.
  7829
  7830     MOVE SPACE                  TO WS-IG-OVRD-AH
  7831                                    WS-IG-OVRD-LF
  7832                                    WS-IG-OVRD-AM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 144
* EL050.cbl
  7833                                    WS-IG-OVRD
  7834                                    WS-IG-OVRD-AH-PL
  7835                                    WS-IG-OVRD-LF-PL
  7836                                    WS-IG-OVRD-AH-BEN
  7837                                    WS-IG-OVRD-LF-BEN.
  7838
  7839******************************************************************
  7840*************       INITIALIZE COMMON ERRORS       ***************
  7841******************************************************************
  7842
  7843     MOVE +0                     TO PB-NO-OF-ERRORS.
  7844     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7845
  7846******************************************************************
  7847
  7848     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7849     SET JULIAN-TO-BIN           TO TRUE.
  7850*    MOVE 5                      TO DC-OPTION-CODE.
  7851     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7852     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7853
  7854     MOVE ZERO                   TO  SUB4.
  7855
  7856 0040-INITIALIZE-GA-BILL-DT.
  7857
  7858     ADD +1                      TO  SUB4.
  7859
  7860     IF  SUB4 GREATER THAN +5
  7861         GO TO 0050-CHECK-CNTL-FOUND.
  7862
  7863     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7864         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7865
  7866     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7867
  7868 0050-CHECK-CNTL-FOUND.
  7869
  7870     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7871        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7872                                         WS-AH-REM-TERM-CALC
  7873                                         EC-CO-REM-TERM-CALC
  7874        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7875        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7876        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7877                                         WS-TOL-AH-CLAIM
  7878        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7879                                         WS-TOL-AH-PREM
  7880                                         EC-CO-TOL-PREM
  7881        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7882                                         WS-TOL-AH-REFUND
  7883                                         EC-CO-TOL-REFUND
  7884        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7885                                         WS-AH-REFUND-OVS-AMT
  7886                                         EC-CO-OVR-SHT-AMT
  7887        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7888                                         WS-TOL-AH-PREM-PCT
  7889                                         EC-CO-TOL-PREM-PCT
  7890        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 145
* EL050.cbl
  7891                                         WS-TOL-AH-REFUND-PCT
  7892                                         EC-CO-TOL-REFUND-PCT
  7893        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7894                                         WS-AH-REFUND-OVS-PCT
  7895                                         EC-CO-OVR-SHT-PCT
  7896        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7897        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7898        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7899        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7900        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7901        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7902        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7903        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7904        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7905        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7906        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7907        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7908                                         EC-CO-MONTH-END-DT
  7909        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7910          GO TO 0100-READ-ACCT.
  7911
  7912     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7913     MOVE SPACES                 TO CNTL-ACCESS.
  7914     MOVE '1'                    TO CNTL-REC-TYPE.
  7915     MOVE +0                     TO CNTL-SEQ-NO.
  7916
  7917     MOVE '1' TO RC-SW-1.
  7918     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7919     IF NOT CF-COMPANY-MASTER
  7920         MOVE ZEROS             TO WK-CO-TOL-PREM
  7921                                   WK-CO-TOL-CLAIM
  7922                                   WK-CO-TOL-REFUND
  7923                                   WK-REFUND-OVS-AMT
  7924                                   WK-REFUND-OVS-PCT
  7925                                   WK-CO-TOL-PREM-PCT
  7926                                   WK-CO-TOL-REFUND-PCT
  7927                                   WK-DEFAULT-APR
  7928                                   WK-CO-MAX-CAP
  7929        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7930                                   WK-CR-R78-METHOD
  7931                                   WK-CO-REF-REJECT-SW
  7932                                   WK-CO-PREM-REJECT-SW
  7933                                   WK-REM-TRM-CALC-OPTION
  7934                                   WK-BIRTH-DATE-INPUT
  7935                                   WK-JOINT-AGE-INPUT
  7936        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7937        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7938        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7939        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7940          GO TO 0099-COMPANY-NOT-FOUND.
  7941
  7942     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7943        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7944     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7945        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7946     IF CF-CO-TOL-CAP NOT NUMERIC
  7947        MOVE +0                    TO CF-CO-TOL-CAP.
  7948     IF CF-DEFAULT-APR NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 146
* EL050.cbl
  7949        MOVE +0                    TO CF-DEFAULT-APR.
  7950
  7951     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7952     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7953     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7954     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7955     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7956     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7957     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7958     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7959     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7960     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7961     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7962     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7963
  7964     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7965          CF-CO-OVR-SHT-AMT > +0
  7966        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7967
  7968     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7969          CF-CO-OVR-SHT-PCT > +0
  7970        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7971
  7972     IF CF-VALID-REM-TRM-OPTION
  7973         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7974     ELSE
  7975         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7976
  7977     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7978     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7979     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7980     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7981
  7982     GO TO 0050-CHECK-CNTL-FOUND.
  7983
  7984 0099-COMPANY-NOT-FOUND.
  7985
  7986     MOVE ER-2616                TO WS-ERROR.
  7987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7988
  7989 0100-READ-ACCT.
  7990
  7991     MOVE SPACES                 TO DATE-RANGE-SW.
  7992
  7993     IF WK-ACCT-ADDR = ZEROS
  7994        GO TO 0102-ACCT-GETMAIN.
  7995
  7996     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7997     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7998     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7999
  8000     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8001        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8002        GO TO 0105-READ-ACCT
  8003     END-IF
  8004
  8005     IF PB-CARRIER NOT = SPACES
  8006        IF PB-CARRIER NOT = AM-VG-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 147
* EL050.cbl
  8007           GO TO 0105-READ-ACCT.
  8008
  8009     IF PB-STATE NOT = SPACES
  8010        IF PB-STATE NOT = AM-VG-STATE
  8011           GO TO 0105-READ-ACCT.
  8012
  8013     IF PB-GROUPING NOT = SPACES
  8014        IF PB-GROUPING NOT = AM-VG-GROUPING
  8015           GO TO 0105-READ-ACCT.
  8016
  8017     MOVE 'X'                 TO DATE-RANGE-SW.
  8018
  8019     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8020        MOVE 'X'                 TO DATE-RANGE-SW
  8021        GO TO 0105-READ-ACCT.
  8022
  8023     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8024        GO TO 0105-READ-ACCT.
  8025
  8026     GO TO 0180-ACCOUNT-FOUND.
  8027
  8028 0102-ACCT-GETMAIN.
  8029     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8030     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8031
  8032 0105-READ-ACCT.
  8033     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8034     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8035     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8036     MOVE PB-STATE               TO ACCT-STATE.
  8037     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8038     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8039
  8040     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8041
  8042     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8043
  8044 0110-FIND-ACCT-TOLERANCES-LOOP.
  8045     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8046
  8047     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8048        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8049        GO TO 0199-ACCT-NOT-FOUND
  8050     END-IF
  8051     IF PB-CARRIER NOT = SPACES
  8052        IF PB-CARRIER NOT = AM-VG-CARRIER
  8053           GO TO 0199-ACCT-NOT-FOUND.
  8054
  8055     IF PB-STATE NOT = SPACES
  8056        IF PB-STATE NOT = AM-VG-STATE
  8057           GO TO 0199-ACCT-NOT-FOUND.
  8058
  8059     IF PB-GROUPING NOT = SPACES
  8060        IF PB-GROUPING NOT = AM-VG-GROUPING
  8061           GO TO 0199-ACCT-NOT-FOUND.
  8062
  8063     MOVE 'X'                    TO DATE-RANGE-SW.
  8064
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 148
* EL050.cbl
  8065     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8066        MOVE 'X'                 TO DATE-RANGE-SW
  8067        GO TO 0199-ACCT-NOT-FOUND.
  8068
  8069     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8070        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8071
  8072 0180-ACCOUNT-FOUND.
  8073     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8074     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8075     MOVE AM-STATE               TO PB-SV-STATE.
  8076     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8077
  8078     IF AM-CANCEL-FEE  NOT NUMERIC
  8079        MOVE ZEROS TO AM-CANCEL-FEE.
  8080
  8081     IF AM-MAX-MON-BEN NOT NUMERIC
  8082        MOVE ZEROS TO AM-MAX-MON-BEN.
  8083
  8084     IF AM-MAX-TOT-BEN NOT NUMERIC
  8085        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8086
  8087     IF AM-CLP-TOL-PCT NOT NUMERIC
  8088        MOVE +0                  TO AM-CLP-TOL-PCT
  8089     END-IF
  8090     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8091        MOVE +0                  TO AM-SPP-LEASE-COMM
  8092     END-IF
  8093     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8094        MOVE ER-2611             TO   WS-ERROR
  8095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8096
  8097     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8098        MOVE ER-2621             TO   WS-ERROR
  8099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8100
  8101     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8102        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8103        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8104        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8105         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8106
  8107     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8108     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8109     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8110     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8111     IF AM-CLP-TOL-PCT NOT = ZEROS
  8112        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8113     END-IF
  8114     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8115        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8116     END-IF
  8117*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8118*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8119*                                   WS-ADMIN-FEES
  8120*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8121*          (SUB5 > +10)
  8122*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 149
* EL050.cbl
  8123*             AND (AM-A-COM (SUB5) NUMERIC)
  8124*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8125*                + (AM-A-COM (SUB5) * 1000)
  8126*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8127*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8128*                + (AM-A-COM (SUB5) * 1000)
  8129*             END-IF
  8130*             IF AM-COM-TYP (SUB5) = 'N'
  8131*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8132*                + (AM-A-COM (SUB5) * 1000)
  8133*             END-IF
  8134*          END-IF
  8135*       END-PERFORM
  8136*    END-IF
  8137     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8138        AND (PB-ISSUE)
  8139        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8140                                    ws-cred-union-fees
  8141        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8142           (SUB5 > +10)
  8143           MOVE +0 TO WS-WK-RATE
  8144           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8145                                   'O' OR 'S')
  8146              IF (AM-A-COM (SUB5) NUMERIC)
  8147                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8148                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8149              ELSE
  8150                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8151                 IF PB-ISSUE
  8152                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8153                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8154                 ELSE
  8155                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8156                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8157                 END-IF
  8158                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8159                 MOVE ZEROS             TO WS-SUB1
  8160                                           WS-COMMISSION
  8161                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8162                 MOVE '0530'               TO CTBL-SW
  8163                 MOVE ' '                  TO WS-CTBL-READ-SW
  8164                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8165                 IF FIRST-TIME-THROUGH
  8166                    MOVE 'AA'              TO CTBL-BEN-CODE
  8167                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8168                 END-IF
  8169                 IF CTBL-TABLE-FOUND
  8170                    IF PB-ISSUE
  8171                       COMPUTE WS-COMM-CK-AMT =
  8172                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8173                    ELSE
  8174                       COMPUTE WS-COMM-CK-AMT =
  8175                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8176                    END-IF
  8177                    PERFORM 8800-GET-COMP-RATE
  8178                              THRU 8800-EXIT
  8179                 END-IF
  8180              END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 150
* EL050.cbl
  8181              if am-com-typ (sub5) = 'O' or 'S'
  8182                 compute ws-cred-union-fees rounded =
  8183                    ws-cred-union-fees +
  8184                    (pb-i-ah-premium-amt * ws-wk-rate)
  8185              else
  8186                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8187                + (WS-WK-RATE * 1000)
  8188              end-if
  8189           END-IF
  8190        END-PERFORM
  8191     END-IF
  8192     IF PB-COMPANY-ID EQUAL 'CRI'
  8193         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8194
  8195     IF PB-COMPANY-ID EQUAL 'NCL'
  8196         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8197     END-IF
  8198
  8199     GO TO 0200-READ-CERT.
  8200
  8201 0199-ACCT-NOT-FOUND.
  8202
  8203     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8204
  8205     IF DATE-RANGE-SW NOT = SPACES
  8206        MOVE ER-2601             TO WS-ERROR
  8207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8208     ELSE
  8209        MOVE ER-2619             TO WS-ERROR
  8210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8211
  8212     GO TO 9990-RETURN.
  8213
  8214 0200-READ-CERT.
  8215
  8216     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8217     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8218     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8219     MOVE PB-SV-STATE            TO CERT-STATE.
  8220     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8221     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8222     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8223
  8224     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8225
  8226     IF CERT-WAS-NOT-FOUND
  8227        GO TO 0299-CERT-NOT-FOUND.
  8228
  8229     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8230        MOVE ER-2759             TO WS-ERROR
  8231        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8232        GO TO 0298-UNLOCK-RETURN.
  8233
  8234     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8235         MOVE ER-2758            TO WS-ERROR
  8236         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8237         GO TO 0298-UNLOCK-RETURN.
  8238
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 151
* EL050.cbl
  8239     IF PB-ISSUE
  8240        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8241           IF CERT-WAS-CREATED-FOR-CLAIM
  8242              NEXT SENTENCE
  8243            ELSE
  8244              MOVE ER-2626       TO WS-ERROR
  8245              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8246              GO TO 0298-UNLOCK-RETURN.
  8247
  8248     IF NOT PB-CANCELLATION
  8249        GO TO 0300-CONTINUE-EDIT.
  8250
  8251     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8252     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8253     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8254     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8255     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8256     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8257
  8258     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8259     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8260     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8261     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8262     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8263     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8264     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8265     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8266     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8267
  8268     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8269     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8270     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8271     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8272     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8273     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8274     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8275
  8276     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8277     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8278
  8279     MOVE CM-CREDIT-INTERFACE-SW-1
  8280                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8281     MOVE CM-CREDIT-INTERFACE-SW-2
  8282                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8283
  8284     IF CM-O-B-COVERAGE
  8285         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8286
  8287     IF CM-LIVES NOT NUMERIC
  8288         MOVE ZERO                TO CM-LIVES.
  8289
  8290     IF CM-BILLED NOT NUMERIC
  8291         MOVE ZERO                TO CM-BILLED.
  8292
  8293     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8294         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8295         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8296         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 152
* EL050.cbl
  8297         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8298         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8299         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8300         MOVE CM-LIVES             TO PB-CI-LIVES
  8301*The next line causes a problem with my change  I dont think it is
  8302*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8303
  8304     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8305     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8306     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8307     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8308     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8309     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8310
  8311     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8312     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8313     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8314     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8315
  8316     IF CM-LIFE-COMM-PCT NUMERIC
  8317         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8318     ELSE
  8319         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8320
  8321     IF CM-AH-COMM-PCT NUMERIC
  8322         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8323     ELSE
  8324         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8325
  8326     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8327
  8328     IF CM-LOAN-APR       NOT NUMERIC
  8329           MOVE ZERO               TO CM-LOAN-APR.
  8330
  8331     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8332           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8333
  8334     IF CM-LOAN-TERM      NOT NUMERIC
  8335           MOVE ZERO               TO CM-LOAN-TERM.
  8336
  8337     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8338           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8339
  8340     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8341           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8342
  8343     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8344     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8345     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8346     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8347     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8348     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8349     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8350     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8351     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8352     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8353     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8354     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 153
* EL050.cbl
  8355
  8356     IF CM-STATE = CM-SSN-STATE
  8357         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8358
  8359     IF CM-STATE NOT = CM-MEMB-STATE
  8360         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8361
  8362     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8363
  8364     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8365        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8366        IF CM-ADDL-CLP NOT NUMERIC
  8367           MOVE +0               TO CM-ADDL-CLP
  8368        END-IF
  8369        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8370        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8371           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8372        END-IF
  8373     END-IF
  8374     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8375        MOVE +0                  TO WS-ADMIN-FEES
  8376                                    WS-CSO-ADMIN-FEE
  8377                                    WS-COMM-AND-MFEE
  8378                                    WS-1ST-YR-ALLOW
  8379        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8380           (SUB5 > +10)
  8381           MOVE +0 TO WS-WK-RATE
  8382           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8383              IF (AM-A-COM (SUB5) NUMERIC)
  8384                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8385                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8386              ELSE
  8387                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8388                 IF PB-ISSUE
  8389                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8390                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8391                 ELSE
  8392                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8393                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8394                 END-IF
  8395                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8396                 MOVE ZEROS             TO WS-SUB1
  8397                                           WS-COMMISSION
  8398                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8399                 MOVE '0530'               TO CTBL-SW
  8400                 MOVE ' '                  TO WS-CTBL-READ-SW
  8401                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8402                 IF FIRST-TIME-THROUGH
  8403                    MOVE 'AA'              TO CTBL-BEN-CODE
  8404                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8405                 END-IF
  8406                 IF CTBL-TABLE-FOUND
  8407                    IF PB-ISSUE
  8408                       COMPUTE WS-COMM-CK-AMT =
  8409                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8410                    ELSE
  8411                       COMPUTE WS-COMM-CK-AMT =
  8412                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 154
* EL050.cbl
  8413                    END-IF
  8414                    PERFORM 8800-GET-COMP-RATE
  8415                              THRU 8800-EXIT
  8416                 END-IF
  8417              END-IF
  8418              IF AM-COM-TYP (SUB5) = 'I'
  8419                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8420                   + (WS-WK-RATE * 1000)
  8421              END-IF
  8422              IF AM-COM-TYP (SUB5) = 'N'
  8423                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8424                   + (WS-WK-RATE * 1000)
  8425              END-IF
  8426              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8427                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8428                   + (WS-WK-RATE * 1000)
  8429              END-IF
  8430              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8431                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8432                   + (WS-WK-RATE * 1000)
  8433              END-IF
  8434           END-IF
  8435        END-PERFORM
  8436     END-IF
  8437     GO TO 0300-CONTINUE-EDIT.
  8438
  8439 0298-UNLOCK-RETURN.
  8440      PERFORM 9250-UNLOCK-RETURN
  8441      GO TO 9990-RETURN.
  8442
  8443 0299-CERT-NOT-FOUND.
  8444
  8445     MOVE '1'                     TO CERT-STATUS-SW.
  8446
  8447     IF PB-COMPANY-ID = 'UCL'
  8448         IF WS-ERROR = ER-2799
  8449             GO TO 3000-CONTINUE-EDIT.
  8450
  8451     IF NOT PB-CANCELLATION
  8452         GO TO 0300-CONTINUE-EDIT.
  8453
  8454     MOVE ER-2726                  TO  WS-ERROR.
  8455     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8456     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8457     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8458                                    PB-CI-LF-TERM
  8459                                    PB-C-LF-REM-TERM
  8460                                    PB-CI-AH-TERM
  8461                                    PB-C-AH-REM-TERM
  8462                                    PB-CI-LF-BENEFIT-CD
  8463                                    PB-CI-LF-BENEFIT-AMT
  8464                                    PB-CI-LF-ALT-BENEFIT-AMT
  8465                                    PB-CI-LF-PREMIUM-AMT
  8466                                    PB-CI-LF-ALT-PREMIUM-AMT
  8467                                    PB-CI-AH-BENEFIT-CD
  8468                                    PB-CI-AH-BENEFIT-AMT
  8469                                    PB-CI-AH-PREMIUM-AMT
  8470                                    PB-CI-PAY-FREQUENCY
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 155
* EL050.cbl
  8471                                    PB-CI-LOAN-APR
  8472                                    PB-CI-LOAN-TERM
  8473                                    PB-CI-LIFE-COMMISSION
  8474                                    PB-CI-AH-COMMISSION
  8475                                    PB-CI-CURR-SEQ
  8476                                    PB-CI-AH-CANCEL-AMT
  8477                                    PB-CI-LF-CANCEL-AMT
  8478                                    PB-CI-RATE-DEV-PCT-LF
  8479                                    PB-CI-RATE-DEV-PCT-AH
  8480                                    PB-CI-EXTENTION-DAYS
  8481                                    PB-CI-TERM-IN-DAYS
  8482                                    PB-CI-LIVES
  8483                                    PB-CI-LF-CRIT-PER
  8484                                    PB-CI-AH-CRIT-PER
  8485                                    PB-CI-ADDL-CLP
  8486                                    PB-CI-DDF-IU-RATE-UP.
  8487
  8488     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8489                                    PB-CI-AH-SETTLEMENT-DT
  8490                                    PB-CI-DEATH-DT
  8491                                    PB-CI-LF-PRIOR-CANCEL-DT
  8492                                    PB-CI-AH-PRIOR-CANCEL-DT
  8493                                    PB-CI-ENTRY-DT
  8494                                    PB-CI-LF-EXPIRE-DT
  8495                                    PB-CI-AH-EXPIRE-DT
  8496                                    PB-CI-LOAN-1ST-PMT-DT.
  8497
  8498     IF ACCOUNT-MAST-FOUND
  8499        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8500        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8501
  8502
  8503 0300-CONTINUE-EDIT.
  8504
  8505     IF PB-ISSUE
  8506        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8507            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8508
  8509     IF PB-ISSUE
  8510        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8511            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8512
  8513     IF PB-ISSUE
  8514       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8515          (AM-NO-AH-ONLY)
  8516           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8517               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8518                   MOVE ER-2679 TO WS-ERROR
  8519                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8520
  8521     IF PB-ISSUE
  8522        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8523        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8524        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8525     ELSE
  8526        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8527        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8528        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 156
* EL050.cbl
  8529
  8530     MOVE 'N'                    TO PLAN-MASTER-SW
  8531                                    PLAN-MASTER-LIFE-SW
  8532                                    FORM-MASTER-SW
  8533                                    WS-APP-CERT-SW.
  8534
  8535     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8536                                    WS-PL-TOL-LF-REFUND
  8537                                    WS-PL-REF-OVS-AMT
  8538                                    WS-PL-TOL-LF-PREM-PCT
  8539                                    WS-PL-TOL-LF-REFUND-PCT
  8540                                    WS-PL-REF-OVS-PCT
  8541                                    WS-PL-TOL-LF-CLAIM.
  8542
  8543     IF PB-COMPANY-ID = 'NCL'
  8544       IF PB-ISSUE
  8545         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8546             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8547             IF FORM-MASTER-FOUND
  8548                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8549
  8550     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8551        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8552
  8553********************** MON CODE **********************
  8554     IF PB-COMPANY-ID = 'MON'
  8555     IF PB-ISSUE
  8556     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8557        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8558             PB-I-LOAN-APR = ZERO)
  8559               MOVE 14.0         TO PB-I-LOAN-APR.
  8560******************************************************
  8561
  8562     IF PB-COMPANY-ID = 'NCL'
  8563       IF PB-ISSUE
  8564           IF FORM-MASTER-FOUND
  8565             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8566                AM-DISMBR-COVERAGE
  8567                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8568                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8569                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8570                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8571                                           PB-I-LIFE-BENEFIT-CD.
  8572
  8573     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8574
  8575     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8576         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8577         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8578         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8579         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8580         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8581           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8582             GO TO 0301-LIFE-BENEFIT-SEARCH
  8583         ELSE
  8584             NEXT SENTENCE
  8585     ELSE
  8586         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 157
* EL050.cbl
  8587
  8588     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8589     MOVE '4'                    TO CNTL-REC-TYPE.
  8590     MOVE +0                     TO CNTL-SEQ-NO.
  8591     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8592
  8593     MOVE '1' TO RC-SW-2.
  8594     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8595
  8596     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8597        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8598         GO TO 0305-BENEFIT-NOT-FOUND.
  8599
  8600     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8601
  8602 0301-LIFE-BENEFIT-SEARCH.
  8603
  8604     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8605
  8606     IF NO-BENEFIT-FOUND
  8607        GO TO 0305-BENEFIT-NOT-FOUND.
  8608
  8609     IF WS-BEN-CD = '99'
  8610        GO TO 0305-BENEFIT-NOT-FOUND.
  8611
  8612     IF PB-COMPANY-ID = 'NCL'
  8613         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8614             GO TO 0304-LIFE-BENEFIT-FOUND.
  8615
  8616     MOVE +1                     TO SUB5.
  8617     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8618
  8619* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8620* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8621     IF PB-COMPANY-ID = 'DMD'
  8622         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8623
  8624 0302-EDIT-ACCT-LF-BENEFITS.
  8625
  8626     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8627        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8628           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8629                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8630           GO TO 03XX-GET-LIFE-ERPLAN.
  8631
  8632     IF SUB5 LESS THAN +20
  8633        ADD +1                   TO SUB5
  8634        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8635
  8636     MOVE +1                     TO SUB5.
  8637
  8638     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8639        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8640
  8641 0303-EDIT-DMD-EXTRA-BENEFITS.
  8642
  8643     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8644        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 158
* EL050.cbl
  8645           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8646                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8647           GO TO 03XX-GET-LIFE-ERPLAN.
  8648
  8649     IF SUB5 LESS THAN +30
  8650        ADD +1                   TO SUB5
  8651        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8652
  8653     MOVE +1                     TO SUB5.
  8654
  8655 03XX-EDIT-FOR-NINETY-LF.
  8656
  8657***************************************************************
  8658*                                                             *
  8659*    NINETY BENEFIT PLAN TYPES:                               *
  8660*                                                             *
  8661*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8662*      92 = ALL GROUP REDUCING BENEFITS                       *
  8663*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8664*      94 = ALL GROUP LEVEL BENEFITS                          *
  8665*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8666*           BENEFIT CONTROLS.                                 *
  8667*      99 = ALL BENEFITS                                      *
  8668*                                                             *
  8669***************************************************************
  8670
  8671     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8672                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8673
  8674     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8675       AND
  8676        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8677        GO TO 03XX-GET-LIFE-ERPLAN.
  8678
  8679     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8680       AND
  8681        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8682        IF CF-REDUCING (SUB3)
  8683           IF (PB-I-INDV-GRP-OVRD = 'I')
  8684              OR
  8685           ((AM-IG = '1') AND
  8686           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8687              OR
  8688           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8689           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8690           (AM-IG NOT = '2'))
  8691              GO TO 03XX-GET-LIFE-ERPLAN.
  8692
  8693     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8694       AND
  8695        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8696        IF CF-REDUCING (SUB3)
  8697           IF (PB-I-INDV-GRP-OVRD = 'G')
  8698              OR
  8699           ((AM-IG = '2') AND
  8700           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8701              OR
  8702           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 159
* EL050.cbl
  8703           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8704           (AM-IG NOT = '1'))
  8705              GO TO 03XX-GET-LIFE-ERPLAN.
  8706
  8707     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8708       AND
  8709        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8710        IF CF-LEVEL    (SUB3)
  8711           IF (PB-I-INDV-GRP-OVRD = 'I')
  8712              OR
  8713           ((AM-IG = '1') AND
  8714           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8715              OR
  8716           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8717           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8718            (AM-IG NOT = '2'))
  8719              GO TO 03XX-GET-LIFE-ERPLAN.
  8720
  8721     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8722       AND
  8723        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8724        IF CF-LEVEL    (SUB3)
  8725           IF (PB-I-INDV-GRP-OVRD = 'G')
  8726              OR
  8727           ((AM-IG = '2') AND
  8728           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8729              OR
  8730           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8731           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8732           (AM-IG NOT = '1'))
  8733              GO TO 03XX-GET-LIFE-ERPLAN.
  8734
  8735     IF SUB5 LESS THAN +20
  8736        ADD +1                   TO SUB5
  8737        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8738
  8739     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8740
  8741     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8742        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8743
  8744     MOVE +1                     TO SUB5.
  8745
  8746 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8747
  8748     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8749                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8750
  8751     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8752       AND
  8753        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8754        GO TO 03XX-GET-LIFE-ERPLAN.
  8755
  8756     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8757       AND
  8758        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8759        IF CF-REDUCING (SUB3)
  8760           IF (PB-I-INDV-GRP-OVRD = 'I')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 160
* EL050.cbl
  8761              OR
  8762           ((AM-IG = '1') AND
  8763           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8764              OR
  8765           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8766           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8767           (AM-IG NOT = '2'))
  8768              GO TO 03XX-GET-LIFE-ERPLAN.
  8769
  8770     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8771       AND
  8772        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8773        IF CF-REDUCING (SUB3)
  8774           IF (PB-I-INDV-GRP-OVRD = 'G')
  8775              OR
  8776           ((AM-IG = '2') AND
  8777           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8778              OR
  8779           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8780           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8781           (AM-IG NOT = '1'))
  8782              GO TO 03XX-GET-LIFE-ERPLAN.
  8783
  8784     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8785       AND
  8786        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8787        IF CF-LEVEL    (SUB3)
  8788           IF (PB-I-INDV-GRP-OVRD = 'I')
  8789              OR
  8790           ((AM-IG = '1') AND
  8791           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8792              OR
  8793           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8794           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8795            (AM-IG NOT = '2'))
  8796              GO TO 03XX-GET-LIFE-ERPLAN.
  8797
  8798     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8799       AND
  8800        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8801        IF CF-LEVEL    (SUB3)
  8802           IF (PB-I-INDV-GRP-OVRD = 'G')
  8803              OR
  8804           ((AM-IG = '2') AND
  8805           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8806              OR
  8807           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8808           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8809           (AM-IG NOT = '1'))
  8810              GO TO 03XX-GET-LIFE-ERPLAN.
  8811
  8812     IF SUB5 LESS THAN +30
  8813        ADD +1                   TO SUB5
  8814        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8815
  8816     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8817
  8818 03XX-EDIT-FOR-NINETY-LF-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 161
* EL050.cbl
  8819
  8820     MOVE +99                    TO SUB5.
  8821
  8822     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8823        IF PB-ISSUE
  8824           MOVE ER-1924          TO  WS-ERROR
  8825           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8826
  8827     GO TO 0304-LIFE-BENEFIT-FOUND.
  8828
  8829 03XX-GET-LIFE-ERPLAN.
  8830
  8831     IF WK-PLAN-ADDR EQUAL +0
  8832        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8833
  8834     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8835     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8836     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8837     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8838     MOVE 'Y'                    TO PLAN-MASTER-SW
  8839                                    PLAN-MASTER-LIFE-SW.
  8840     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8841
  8842 03XX-ERPLAN-LIFE-GETMAIN.
  8843
  8844     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8845     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8846
  8847 03XX-ERPLAN-LIFE-READ.
  8848
  8849     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8850     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8851     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8852     MOVE PB-SV-STATE            TO PLAN-STATE.
  8853     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8854     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8855     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8856     MOVE WS-SAVE-BENEFIT-REVISION
  8857                                 TO PLAN-REVISION-NO.
  8858
  8859     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8860     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8861
  8862     IF PB-COMPANY-ID = 'NCL'
  8863       IF NOT LF-PLAN-MASTER-FOUND
  8864         IF NOT PB-POLICY-IS-DECLINED  AND
  8865            NOT PB-POLICY-IS-VOIDED
  8866             MOVE  ER-1921         TO  WS-ERROR
  8867             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8868             GO TO 0304-LIFE-BENEFIT-FOUND.
  8869
  8870     IF NOT LF-PLAN-MASTER-FOUND
  8871        GO TO 0304-LIFE-BENEFIT-FOUND.
  8872
  8873 XXXX-CHECK-LF-PLAN-KEY.
  8874
  8875     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8876        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 162
* EL050.cbl
  8877        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8878        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8879        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8880        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8881        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8882        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8883        MOVE 'N'                 TO PLAN-MASTER-SW
  8884          GO TO 03XX-ERPLAN-LIFE-READ.
  8885
  8886     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8887
  8888     IF  PB-CANCELLATION
  8889         GO TO  0303-LF-ACCT-BEN-FOUND.
  8890
  8891     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8892        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8893           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8894           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8895              MOVE ER-2644             TO WS-ERROR
  8896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8897           ELSE
  8898              NEXT SENTENCE
  8899        ELSE
  8900           IF PB-COMPANY-ID NOT = 'NCL'
  8901              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8902                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8903
  8904 0303-LF-ACCT-BEN-FOUND.
  8905
  8906     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8907
  8908     IF PL-DEV-CODE NOT = SPACES
  8909        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8910
  8911     IF PL-DEV-PCT NUMERIC AND
  8912        PL-DEV-PCT NOT = ZEROS
  8913        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8914
  8915     IF PL-TOL-PREM-AMT GREATER THAN +0
  8916        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8917
  8918     IF PL-TOL-REF-AMT GREATER THAN +0
  8919        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8920
  8921     IF PL-TOL-PREM-PCT GREATER THAN +0
  8922        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8923
  8924     IF PL-TOL-REF-PCT GREATER THAN +0
  8925        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8926
  8927     IF PL-TOL-CLM-AMT GREATER THAN +0
  8928        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8929
  8930     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8931                          PL-OVER-SHORT-AMT > +0
  8932        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8933
  8934     IF PL-OVER-SHORT-PCT NUMERIC  AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 163
* EL050.cbl
  8935                          PL-OVER-SHORT-PCT > +0
  8936        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8937
  8938     IF PL-SALES-TAX NUMERIC AND
  8939                          PL-SALES-TAX > +0
  8940         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8941
  8942     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8943        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8944                                    WS-IG-OVRD-AM.
  8945
  8946 0304-LIFE-BENEFIT-FOUND.
  8947
  8948     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8949
  8950     IF PB-ISSUE
  8951        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8952     ELSE
  8953        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8954
  8955     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8956     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8957     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8958     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8959     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8960                                         WS-LF-REFUND-CALC.
  8961     if (ws-lf-earnings-calc = '5')
  8962        and (pb-i-loan-apr = zeros)
  8963        and (benefit-code-chg)
  8964        move +99.9999 to pb-i-loan-apr
  8965     end-if
  8966
  8967     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8968        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8969
  8970     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8971        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8972     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8973
  8974     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8975     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8976     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8977     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8978     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8979     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8980
  8981     IF PB-COMPANY-ID = 'NCL'  AND
  8982        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8983         NEXT SENTENCE
  8984     ELSE
  8985         IF SUB5 NOT GREATER THAN +20
  8986            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8987               MOVE WS-SAVE-BENEFIT-REM-TERM
  8988                                      TO WS-AM-LF-BENE-REM-TERM
  8989                                         EC-BR-LF-REM-TERM-CALC.
  8990
  8991     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8992     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 164
* EL050.cbl
  8993
  8994     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8995
  8996 0305-BENEFIT-NOT-FOUND.
  8997
  8998     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8999     MOVE ER-2604                TO WS-ERROR.
  9000     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9001
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 165
* EL050.cbl
  9003
  9004 0310-FIND-AH-BENEFIT-RECORD.
  9005
  9006     MOVE 'N'                    TO PLAN-MASTER-SW
  9007                                    PLAN-MASTER-AH-SW.
  9008
  9009     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9010                                    WS-PL-TOL-AH-REFUND
  9011                                    WS-AH-PL-REF-OVS-AMT
  9012                                    WS-PL-TOL-AH-PREM-PCT
  9013                                    WS-PL-TOL-AH-REFUND-PCT
  9014                                    WS-AH-PL-REF-OVS-PCT
  9015                                    WS-PL-TOL-AH-CLAIM.
  9016     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9017
  9018
  9019     if pb-issue
  9020        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9021           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9022        end-if
  9023        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9024           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9025           GO TO 0399-BENEFIT-NOT-FOUND
  9026        end-if
  9027     end-if
  9028
  9029     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9030        GO TO 0400-FIND-CARRIER.
  9031
  9032     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9033
  9034     IF WK-AH-BEN-ADDR NOT = ZEROS
  9035         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9036         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9037         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9038         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9039           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9040             GO TO 0311-AH-BENEFIT-SEARCH
  9041         ELSE
  9042             NEXT SENTENCE
  9043     ELSE
  9044         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9045
  9046     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9047     MOVE '5'                    TO CNTL-REC-TYPE.
  9048     MOVE +0                     TO CNTL-SEQ-NO.
  9049     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9050
  9051     MOVE '2' TO RC-SW-2.
  9052     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9053
  9054     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9055        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9056          GO TO 0399-BENEFIT-NOT-FOUND.
  9057
  9058     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9059
  9060 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 166
* EL050.cbl
  9061
  9062     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9063
  9064     IF NO-BENEFIT-FOUND
  9065         GO TO 0399-BENEFIT-NOT-FOUND.
  9066
  9067     IF WS-BEN-CD = '99'
  9068        GO TO 0399-BENEFIT-NOT-FOUND.
  9069
  9070     IF PB-COMPANY-ID  =  'NCL'
  9071         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9072             GO TO 0314-A-H-BENEFIT-FOUND.
  9073
  9074     MOVE +1                     TO SUB5.
  9075     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9076
  9077* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9078* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9079     IF PB-COMPANY-ID = 'DMD'
  9080         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9081
  9082 0312-EDIT-ACCT-AH-BENEFITS.
  9083
  9084     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9085        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9086           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9087                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9088           GO TO 03XX-GET-AH-ERPLAN.
  9089
  9090     IF SUB5 LESS THAN +20
  9091        ADD +1                   TO SUB5
  9092        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9093
  9094     MOVE +1                     TO SUB5.
  9095
  9096     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9097        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9098
  9099 0313-EDIT-DMD-EXTRA-BENEFITS.
  9100
  9101     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9102        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9103           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9104                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9105           GO TO 03XX-GET-AH-ERPLAN.
  9106
  9107     IF SUB5 LESS THAN +30
  9108        ADD +1                   TO SUB5
  9109        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9110
  9111     MOVE +1                     TO SUB5.
  9112
  9113 03XX-EDIT-FOR-NINETY-AH.
  9114
  9115***************************************************************
  9116*                                                             *
  9117*    NINETY BENEFIT PLAN TYPES:                               *
  9118*                                                             *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 167
* EL050.cbl
  9119*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9120*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9121*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9122*           BENEFIT CONTROLS.                                 *
  9123*      99 = ALL BENEFITS.                                     *
  9124*                                                             *
  9125***************************************************************
  9126
  9127     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9128                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9129
  9130     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9131       AND
  9132        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9133        GO TO 03XX-GET-AH-ERPLAN.
  9134
  9135     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9136       AND
  9137        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9138           IF (PB-I-INDV-GRP-OVRD = 'I')
  9139              OR
  9140           ((AM-IG = '1') AND
  9141           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9142              OR
  9143           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9144           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9145           (AM-IG NOT = '2'))
  9146              GO TO 03XX-GET-AH-ERPLAN.
  9147
  9148     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9149       AND
  9150        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9151           IF (PB-I-INDV-GRP-OVRD = 'G')
  9152              OR
  9153           ((AM-IG = '2') AND
  9154           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9155              OR
  9156           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9157           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9158           (AM-IG NOT = '1'))
  9159              GO TO 03XX-GET-AH-ERPLAN.
  9160
  9161     IF SUB5 LESS THAN +20
  9162        ADD +1                   TO SUB5
  9163        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9164
  9165     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9166        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9167
  9168     MOVE +1                    TO SUB5.
  9169
  9170 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9171
  9172     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9173                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9174
  9175     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9176       AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 168
* EL050.cbl
  9177        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9178        GO TO 03XX-GET-AH-ERPLAN.
  9179
  9180     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9181       AND
  9182        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9183           IF (PB-I-INDV-GRP-OVRD = 'I')
  9184              OR
  9185           ((AM-IG = '1') AND
  9186           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9187              OR
  9188           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9189           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9190           (AM-IG NOT = '2'))
  9191              GO TO 03XX-GET-AH-ERPLAN.
  9192
  9193     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9194       AND
  9195        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9196           IF (PB-I-INDV-GRP-OVRD = 'G')
  9197              OR
  9198           ((AM-IG = '2') AND
  9199           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9200              OR
  9201           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9202           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9203           (AM-IG NOT = '1'))
  9204              GO TO 03XX-GET-AH-ERPLAN.
  9205
  9206     IF SUB5 LESS THAN +30
  9207        ADD +1                   TO SUB5
  9208        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9209
  9210 03XX-EDIT-FOR-NINETY-AH-CONT.
  9211
  9212     MOVE +99                    TO SUB5.
  9213
  9214     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9215
  9216     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9217        IF PB-ISSUE
  9218           MOVE ER-1925          TO  WS-ERROR
  9219           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9220
  9221     GO TO 0314-A-H-BENEFIT-FOUND.
  9222
  9223 03XX-GET-AH-ERPLAN.
  9224
  9225     IF WK-PLAN-ADDR EQUAL +0
  9226         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9227
  9228     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9229     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9230     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9231     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9232     MOVE 'Y'                    TO PLAN-MASTER-SW
  9233                                    PLAN-MASTER-AH-SW.
  9234*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 169
* EL050.cbl
  9235     GO TO 03XX-ERPLAN-AH-READ.
  9236
  9237 03XX-ERPLAN-AH-GETMAIN.
  9238
  9239     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9240     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9241
  9242 03XX-ERPLAN-AH-READ.
  9243
  9244     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9245     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9246     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9247     MOVE PB-SV-STATE            TO PLAN-STATE.
  9248     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9249     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9250     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9251     MOVE WS-SAVE-BENEFIT-REVISION
  9252                                 TO PLAN-REVISION-NO.
  9253
  9254     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9255     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9256
  9257     IF PB-COMPANY-ID = 'NCL'
  9258       IF NOT AH-PLAN-MASTER-FOUND
  9259         IF NOT PB-POLICY-IS-DECLINED  AND
  9260            NOT PB-POLICY-IS-VOIDED
  9261             MOVE  ER-1922         TO  WS-ERROR
  9262             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9263             GO TO 0314-A-H-BENEFIT-FOUND.
  9264
  9265     IF NOT AH-PLAN-MASTER-FOUND
  9266        GO TO 0314-A-H-BENEFIT-FOUND.
  9267
  9268 XXXX-CHECK-AH-PLAN-KEY.
  9269
  9270     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9271        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9272        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9273        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9274        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9275        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9276        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9277        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9278        MOVE 'N'                 TO PLAN-MASTER-SW
  9279          GO TO 03XX-ERPLAN-AH-READ.
  9280
  9281     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9282
  9283     IF  PB-CANCELLATION
  9284         GO TO  0313-AH-ACCT-BEN-FOUND.
  9285
  9286     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9287       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9288          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9289          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9290             MOVE ER-2644             TO WS-ERROR
  9291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9292          ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 170
* EL050.cbl
  9293             NEXT SENTENCE
  9294       ELSE
  9295          IF PB-COMPANY-ID NOT = 'NCL'
  9296             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9297                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9298
  9299 0313-AH-ACCT-BEN-FOUND.
  9300
  9301     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9302
  9303     IF PL-DEV-CODE NOT = SPACES
  9304        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9305
  9306     IF PL-DEV-PCT NUMERIC AND
  9307        PL-DEV-PCT NOT = ZEROS
  9308        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9309
  9310     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9311        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9312
  9313     IF PL-TOL-REF-AMT NOT EQUAL +0
  9314        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9315
  9316     IF PL-TOL-PREM-PCT GREATER THAN +0
  9317        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9318
  9319     IF PL-TOL-REF-PCT GREATER THAN +0
  9320        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9321
  9322     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9323        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9324
  9325     IF PL-OVER-SHORT-AMT NUMERIC AND
  9326                          PL-OVER-SHORT-AMT > +0
  9327        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9328
  9329     IF PL-OVER-SHORT-PCT NUMERIC AND
  9330                          PL-OVER-SHORT-PCT > +0
  9331        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9332
  9333     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9334        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9335        IF WS-IG-OVRD-AM EQUAL SPACES
  9336            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9337
  9338 0314-A-H-BENEFIT-FOUND.
  9339
  9340     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9341
  9342     IF PB-ISSUE
  9343        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9344       ELSE
  9345        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9346
  9347     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9348     if cf-maximum-benefits (sub3) numeric
  9349        move cf-maximum-benefits (sub3)
  9350                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 171
* EL050.cbl
  9351     else
  9352        move zeros               to ws-ah-max-bens
  9353     end-if
  9354     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9355     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9356     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9357                                         WS-AH-REFUND-CALC.
  9358
  9359     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9360        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9361
  9362     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9363        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9364     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9365
  9366     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9367     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9368     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9369     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9370     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9371     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9372
  9373     IF PB-COMPANY-ID = 'NCL'  AND
  9374        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9375         NEXT SENTENCE
  9376     ELSE
  9377         IF SUB5 NOT GREATER THAN +20
  9378            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9379                MOVE WS-SAVE-BENEFIT-REM-TERM
  9380                                      TO WS-AM-AH-BENE-REM-TERM
  9381                                         EC-BR-AH-REM-TERM-CALC.
  9382
  9383     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9384     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9385
  9386     GO TO 0400-FIND-CARRIER.
  9387
  9388 0399-BENEFIT-NOT-FOUND.
  9389
  9390     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9391     MOVE ER-2605                TO WS-ERROR.
  9392     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9393
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 172
* EL050.cbl
  9395
  9396 0400-FIND-CARRIER.
  9397
  9398     MOVE PB-SV-CARRIER          TO WS-CARR.
  9399
  9400     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9401     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9402     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9403     MOVE '6'                    TO CNTL-REC-TYPE.
  9404
  9405*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9406     MOVE SPACE                  TO WS-DMD-RATING-SW
  9407                                    EC-BR-DMD-RATING-SW.
  9408
  9409     MOVE '2'                    TO RC-SW-1.
  9410     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9411
  9412     IF NOT CF-CARRIER-MASTER
  9413        GO TO 0400-CARRIER-NOT-FOUND.
  9414
  9415 0400-BUILD-CARR-TOL.
  9416
  9417     IF CF-CR-TOL-PREM NUMERIC AND
  9418        CF-CR-TOL-PREM GREATER THAN +0
  9419        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9420                                    WS-TOL-AH-PREM.
  9421
  9422     IF CF-CR-TOL-REFUND NUMERIC AND
  9423        CF-CR-TOL-REFUND GREATER THAN +0
  9424        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9425                                    WS-TOL-AH-REFUND.
  9426
  9427     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9428        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9429        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9430                                    WS-AH-REFUND-OVS-AMT.
  9431
  9432     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9433        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9434        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9435                                    WS-AH-REFUND-OVS-PCT.
  9436
  9437     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9438        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9439        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9440                                    WS-TOL-AH-PREM-PCT.
  9441
  9442     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9443        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9444        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9445                                     WS-TOL-AH-REFUND-PCT.
  9446
  9447     IF CF-COMPANY-ID EQUAL 'DMD'
  9448         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9449                                    EC-BR-DMD-RATING-SW.
  9450
  9451     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9452     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 173
* EL050.cbl
  9453        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9454     END-IF
  9455     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9456        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9457     END-IF
  9458     IF WS-TOL-CLP-PCT = ZEROS
  9459        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9460     END-IF
  9461
  9462     IF WS-SPP-LEASE-COMM = ZEROS
  9463        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9464     END-IF
  9465     GO TO 0400-FIND-ERPDEF.
  9466
  9467 0400-CARRIER-NOT-FOUND.
  9468
  9469     MOVE ER-2602                TO WS-ERROR.
  9470     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9471
  9472 0400-FIND-ERPDEF.
  9473*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9474     IF (PB-COMPANY-ID = 'DCC')
  9475        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9476        CONTINUE
  9477     ELSE
  9478        GO TO 0400-FIND-ERCOMP
  9479     END-IF
  9480     MOVE ' '                    TO PDEF-MASTER-SW
  9481     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9482     MOVE PB-STATE               TO ERPDEF-STATE
  9483     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9484        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9485     END-IF
  9486     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9487     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9488     IF PB-ISSUE
  9489        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9490     ELSE
  9491        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9492     END-IF
  9493     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9494     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9495     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9496     IF PDEF-MASTER-FOUND
  9497        MOVE 'N'                 TO PDEF-MASTER-SW
  9498        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9499        IF PDEF-MASTER-FOUND
  9500           IF (ERPDEF-KEY-SAVE (1:16) =
  9501                        PD-CONTROL-PRIMARY (1:16))
  9502              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9503              CONTINUE
  9504           ELSE
  9505              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9506              IF (ERPDEF-KEY-SAVE (1:16) =
  9507                        PD-CONTROL-PRIMARY (1:16))
  9508                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9509                 CONTINUE
  9510              ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 174
* EL050.cbl
  9511                 MOVE 'N'        TO PDEF-MASTER-SW
  9512              END-IF
  9513           END-IF
  9514        END-IF
  9515        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9516     END-IF
  9517     IF PDEF-MASTER-FOUND
  9518        IF PD-TRUNCATED = 'Y'
  9519           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9520        END-IF
  9521     END-IF
  9522     .
  9523 0400-FIND-ERCOMP.
  9524     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9525        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9526           (WS-SUB1 > +10)
  9527           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9528                 OR 'A' OR 'N'
  9529              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9530              MOVE PB-CARRIER    TO COMP-CARRIER
  9531              MOVE PB-GROUPING   TO COMP-GROUPING
  9532              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9533              MOVE AM-AGT (WS-SUB1)
  9534                                 TO COMP-FIN-RESP
  9535              MOVE 'G'           TO COMP-TYPE
  9536              PERFORM 8582-READ-COMPENSATION-MASTER
  9537                                 THRU 8582-EXIT
  9538              IF COMP-MASTER-FOUND
  9539                 IF CO-GA-INACTIVE
  9540                    MOVE ER-2763 TO WS-ERROR
  9541                    PERFORM 9900-ERROR-FORMAT
  9542                                 THRU 9900-EXIT
  9543                    MOVE +11     TO WS-SUB1
  9544                 END-IF
  9545                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9546                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9547                    MOVE ER-2788 TO WS-ERROR
  9548                    PERFORM 9900-ERROR-FORMAT
  9549                                 THRU 9900-EXIT
  9550                    MOVE +11     TO WS-SUB1
  9551                 END-IF
  9552              END-IF
  9553           END-IF
  9554        END-PERFORM
  9555     END-IF
  9556     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9557        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9558           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9559                                    WS-CLP-STATE
  9560        ELSE
  9561           MOVE SPACES           TO PB-I-CLP-STATE
  9562                                    WS-CLP-STATE
  9563        END-IF
  9564     END-IF
  9565
  9566     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9567        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9568        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 175
* EL050.cbl
  9569        CONTINUE
  9570     ELSE
  9571        GO TO 0400-FIND-STATE-RECORD
  9572     END-IF
  9573     MOVE SPACES                 TO WS-CLP-STATE
  9574     MOVE +0                     TO WS-BANK-FEE
  9575                                    WS-BANK-LFEE
  9576                                    WS-BANK-NOCHRGB
  9577
  9578     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9579     IF (PB-ISSUE)
  9580        AND (PB-I-BANK-NUMBER NOT =
  9581            SPACES AND ZEROS AND LOW-VALUES)
  9582        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9583     ELSE
  9584        IF (PB-CANCELLATION)
  9585           AND (PB-CI-BANK-NUMBER NOT =
  9586                SPACES AND ZEROS AND LOW-VALUES)
  9587           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9588        END-IF
  9589     END-IF
  9590     IF COMP-FIN-RESP NOT = LOW-VALUES
  9591        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9592        MOVE PB-CARRIER          TO COMP-CARRIER
  9593        MOVE PB-GROUPING         TO COMP-GROUPING
  9594        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9595        MOVE 'B'                 TO COMP-TYPE
  9596        PERFORM 8582-READ-COMPENSATION-MASTER
  9597                                 THRU 8582-EXIT
  9598        IF COMP-MASTER-FOUND
  9599           IF CO-MAX-BANK-FEE NOT NUMERIC
  9600              MOVE +0            TO CO-MAX-BANK-FEE
  9601           END-IF
  9602           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9603              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9604           END-IF
  9605           IF CO-GA-INACTIVE
  9606              MOVE ER-2763       TO WS-ERROR
  9607              PERFORM 9900-ERROR-FORMAT
  9608                                 THRU 9900-EXIT
  9609           END-IF
  9610           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9611              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9612              MOVE ER-2788 TO WS-ERROR
  9613              PERFORM 9900-ERROR-FORMAT
  9614                                 THRU 9900-EXIT
  9615              MOVE +11     TO WS-SUB1
  9616           END-IF
  9617           IF WS-AH-BEN-CATEGORY = 'G'
  9618              MOVE CO-MAX-BANK-FEE
  9619                                 TO WS-BANK-FEE
  9620                                    PB-I-BANK-FEE
  9621           ELSE
  9622              MOVE CO-MAX-BANK-FEE-LEASE
  9623                                 TO WS-BANK-LFEE
  9624                                    PB-I-BANK-FEE
  9625           END-IF
  9626           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 176
* EL050.cbl
  9627              AND (WS-AH-REFUND-CALC = 'G'))
  9628                        OR
  9629              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9630              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9631              CONTINUE
  9632           ELSE
  9633              MOVE ER-2789 TO WS-ERROR
  9634              PERFORM 9900-ERROR-FORMAT
  9635                                 THRU 9900-EXIT
  9636           END-IF
  9637           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9638                                    PB-I-CLP-STATE
  9639           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9640           MOVE CO-CARRIER       TO BXRF-CARRIER
  9641           MOVE CO-GROUPING      TO BXRF-GROUPING
  9642           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9643           MOVE BXRF-MAX-REC-LENGTH
  9644                                 TO BXRF-REC-LENGTH
  9645           PERFORM 8584-READ-BANK-CROSS-REF
  9646                                 THRU 8584-EXIT
  9647           IF BXRF-MASTER-FOUND
  9648              MOVE ' '           TO BANK-ACCT-SW
  9649              MOVE BK-BANK-POINTER-CNT
  9650                                 TO BK-BANK-POINTER-CNT
  9651              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9652                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9653                 OR (BANK-ACCT-FOUND)
  9654                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9655                    AND (BK-AM-EXP-DT (WS-SUB1)
  9656                                 > PB-CERT-EFF-DT)
  9657                    AND (BK-AM-EFF-DT (WS-SUB1)
  9658                                 NOT > PB-CERT-EFF-DT)
  9659                    SET BANK-ACCT-FOUND TO TRUE
  9660                 END-IF
  9661              END-PERFORM
  9662              IF NOT BANK-ACCT-FOUND
  9663                 MOVE ZEROS      TO WS-BANK-FEE
  9664                                    WS-BANK-LFEE
  9665                 MOVE ER-2869    TO WS-ERROR
  9666                 PERFORM 9900-ERROR-FORMAT
  9667                                 THRU 9900-EXIT
  9668              ELSE
  9669                 PERFORM 5000-PROCESS-REPS
  9670                                 THRU 5000-EXIT
  9671                 IF AGENT-MASTER-FOUND
  9672                    MOVE +0      TO WS-BANK-FEE
  9673                                    WS-BANK-LFEE
  9674*                   MOVE AG-SPP-FEES (1)
  9675*                                TO PB-I-BANK-FEE
  9676*                                   WS-BANK-FEE
  9677                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9678                       (WS-SUB1 > +10)
  9679                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9680                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9681                       END-IF
  9682                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9683                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9684                       END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 177
* EL050.cbl
  9685                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9686                          AG-SPP-FEES (WS-SUB1)
  9687                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9688                          AG-SPP-LFEES (WS-SUB1)
  9689                    END-PERFORM
  9690                    IF WS-AH-BEN-CATEGORY = 'G'
  9691                       MOVE WS-BANK-FEE
  9692                                 TO PB-I-BANK-FEE
  9693                    ELSE
  9694                       MOVE WS-BANK-LFEE
  9695                                 TO PB-I-BANK-FEE
  9696                    END-IF
  9697                 END-IF
  9698              END-IF
  9699           END-IF
  9700        ELSE
  9701           MOVE ER-2879          TO WS-ERROR
  9702           PERFORM 9900-ERROR-FORMAT
  9703                                 THRU 9900-EXIT
  9704        END-IF
  9705     ELSE
  9706        MOVE ER-2879             TO WS-ERROR
  9707        PERFORM 9900-ERROR-FORMAT
  9708                                 THRU 9900-EXIT
  9709     END-IF
  9710     IF WS-AH-BEN-CATEGORY = 'G'
  9711        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9712        + WS-BANK-FEE
  9713     ELSE
  9714        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9715        + WS-BANK-LFEE
  9716     END-IF
  9717     .
  9718 0400-FIND-STATE-RECORD.
  9719
  9720     IF WK-STATE-ADDR NOT = ZEROS
  9721         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9722         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9723         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9724         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9725         IF PB-SV-STATE = CF-STATE-CODE
  9726             GO TO 0405-CONTINUE-EDIT
  9727         ELSE
  9728             NEXT SENTENCE
  9729     ELSE
  9730         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9731
  9732     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9733     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9734     MOVE '3'                    TO CNTL-REC-TYPE.
  9735     MOVE +0                     TO CNTL-SEQ-NO.
  9736
  9737     MOVE '3'                    TO RC-SW-2.
  9738     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9739
  9740     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9741        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9742        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 178
* EL050.cbl
  9743        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9744                                    WS-TOL-AH-CLAIM
  9745                                    WS-MINIMUM-REFUND
  9746                                    WS-TOL-LF-PREM
  9747                                    WS-TOL-AH-PREM
  9748                                    WS-TOL-LF-REFUND
  9749                                    WS-TOL-AH-REFUND
  9750                                    EC-ST-TOL-PREM-PCT
  9751                                    WS-TOL-LF-PREM-PCT
  9752                                    WS-TOL-AH-PREM-PCT
  9753                                    EC-ST-TOL-REFUND-PCT
  9754                                    WS-TOL-LF-REFUND-PCT
  9755                                    WS-TOL-AH-REFUND-PCT
  9756                                    EC-ST-TOL-PREM
  9757                                    EC-ST-TOL-REFUND
  9758                                    EC-ST-FST-PMT-DAYS-MAX
  9759                                    WS-FREE-LOOK-PERIOD
  9760                                    WS-ST-LF-PREM-TAX
  9761                                    WS-ST-AH-PREM-TAX-I
  9762                                    WS-ST-AH-PREM-TAX-G
  9763                                    WS-BANK-FEE
  9764                                    WS-BANK-LFEE
  9765                                    WS-TOL-CLP-PCT
  9766                                    WS-SPP-LEASE-COMM
  9767                                    WS-INT-PERIODS
  9768                                    WS-EXTRA-PMTS
  9769        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9770                                    EC-ST-FST-PMT-DAYS-CHG
  9771                                    WS-LF-REM-TERM-CALC
  9772                                    WS-LF-REFUND-CALC
  9773                                    EC-ST-LF-REM-TERM-CALC
  9774                                    EC-ST-LF-REFUND-CALC
  9775                                    WS-AH-REM-TERM-CALC
  9776                                    WS-AH-REFUND-CALC
  9777                                    WS-LF-BEN-CATEGORY
  9778                                    WS-AH-BEN-CATEGORY
  9779                                    WS-CLP-STATE
  9780                                    WS-ST-REFUND-CLAIM-FLAG
  9781                                    WS-ST-CAUSAL-STATE
  9782                                    ws-st-agent-sig-edit
  9783                                    EC-ST-AH-REM-TERM-CALC
  9784                                    EC-ST-AH-REFUND-CALC
  9785          GO TO 0499-STATE-NOT-FOUND.
  9786
  9787     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9788
  9789 0405-CONTINUE-EDIT.
  9790
  9791     if pb-company-id = 'AHL'
  9792        continue
  9793     else
  9794        IF PB-CERT-PRIME NOT NUMERIC
  9795           MOVE ER-2722          TO WS-ERROR
  9796           PERFORM 9900-ERROR-FORMAT
  9797                                 THRU 9900-EXIT
  9798        end-if
  9799     END-IF
  9800*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 179
* EL050.cbl
  9801*       MOVE +0                  TO SUB3
  9802*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9803*       IF SUB3 > +0
  9804*          MOVE ER-2722          TO WS-ERROR
  9805*          PERFORM 9900-ERROR-FORMAT
  9806*                                THRU 9900-EXIT
  9807*       END-IF
  9808*    END-IF
  9809*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9810*       IF PB-CERT-PRIME NOT NUMERIC
  9811*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9812*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9813*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9814*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9815*
  9816*          MOVE ER-2722          TO WS-ERROR
  9817*          PERFORM 9900-ERROR-FORMAT
  9818*                                THRU 9900-EXIT
  9819*       END-IF
  9820*    END-IF
  9821
  9822     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9823
  9824     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9825        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9826                                    WS-TOL-AH-CLAIM.
  9827
  9828     IF CF-ST-REFUND-MIN NOT NUMERIC
  9829        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9830
  9831     IF CF-ST-REFUND-MIN NOT = ZEROS
  9832        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9833
  9834     IF CF-ST-TOL-PREM  NOT = ZEROS
  9835        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9836                                    WS-TOL-AH-PREM
  9837        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9838
  9839     IF CF-ST-TOL-REFUND NOT = ZEROS
  9840        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9841                                    WS-TOL-AH-REFUND
  9842        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9843
  9844     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9845        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9846        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9847                                    WS-AH-REFUND-OVS-AMT
  9848                                    EC-ST-OVR-SHT-AMT.
  9849
  9850     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9851        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9852        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9853                                    WS-TOL-LF-PREM-PCT
  9854                                    WS-TOL-AH-PREM-PCT.
  9855
  9856     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9857        CF-ST-TOL-REF-PCT GREATER THAN +0
  9858        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 180
* EL050.cbl
  9859                                    WS-TOL-LF-REFUND-PCT
  9860                                    WS-TOL-AH-REFUND-PCT.
  9861
  9862     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9863        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9864        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9865                                    WS-AH-REFUND-OVS-PCT
  9866                                    EC-ST-OVR-SHT-PCT.
  9867
  9868     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9869     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9870
  9871     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9872          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9873
  9874     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9875     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9876     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9877
  9878     IF CF-ST-LF-PREM-TAX NUMERIC
  9879        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9880     END-IF
  9881     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9882        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9883     END-IF
  9884     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9885        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9886     END-IF
  9887
  9888     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9889         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9890     END-IF.
  9891
  9892     IF CF-ST-CAUSAL-STATE > SPACES
  9893         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9894     END-IF.
  9895     if cf-st-extra-interest-periods not numeric
  9896        move zeros               to cf-st-extra-interest-periods
  9897     end-if
  9898     if cf-st-extra-payments not numeric
  9899        move zeros               to cf-st-extra-payments
  9900     end-if
  9901
  9902     move cf-st-extra-interest-periods
  9903                                 to ws-int-periods
  9904     move cf-st-extra-payments   to ws-extra-pmts
  9905     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9906     move cf-st-net-only-state   to ws-net-only-state
  9907     IF WS-LF-BENEFIT-CD = ZEROS
  9908        GO TO 0410-CHECK-AH.
  9909
  9910     IF CF-ST-RT-CALC NOT = SPACES
  9911        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9912                                    EC-ST-LF-REM-TERM-CALC
  9913     END-IF
  9914
  9915     IF WS-LF-COVERAGE-TYPE = 'R'
  9916        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 181
* EL050.cbl
  9917           IF CF-ST-RF-LN-CALC > '0'
  9918              MOVE CF-ST-RF-LN-CALC
  9919                                 TO WS-LF-REFUND-CALC
  9920                                    EC-ST-LF-REFUND-CALC
  9921           END-IF
  9922        ELSE
  9923           IF CF-ST-RF-LR-CALC > '0'
  9924              MOVE CF-ST-RF-LR-CALC
  9925                                 TO WS-LF-REFUND-CALC
  9926                                    EC-ST-LF-REFUND-CALC
  9927           END-IF
  9928        END-IF
  9929     ELSE
  9930        IF CF-ST-RF-LL-CALC > '0'
  9931           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9932                                    EC-ST-LF-REFUND-CALC
  9933        END-IF
  9934     END-IF
  9935
  9936     IF CF-ST-RT-CALC NOT = SPACES
  9937        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9938                                    EC-ST-LF-REM-TERM-CALC
  9939     END-IF
  9940
  9941     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9942     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9943
  9944     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9945
  9946     IF NO-BENEFIT-FOUND
  9947        GO TO 0410-CHECK-AH.
  9948
  9949     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9950        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9951                                 TO EC-ST-LF-REM-TERM-CALC
  9952                                    WS-LF-REM-TERM-CALC
  9953     END-IF
  9954
  9955     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9956        MOVE CF-ST-REFUND-CALC (SUB3)
  9957                                 TO WS-LF-REFUND-CALC
  9958                                    EC-ST-LF-REFUND-CALC
  9959     END-IF
  9960*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9961     if cf-st-extra-periods (sub3) not numeric
  9962        move zeros               to cf-st-extra-periods (sub3)
  9963     end-if
  9964     if cf-st-extra-periods (sub3) > zeros
  9965        if ws-lf-ben-category = 'P'
  9966           move cf-st-extra-periods (sub3)
  9967                                 to ws-extra-pmts
  9968        else
  9969           if ws-lf-ben-category = 'I'
  9970              move cf-st-extra-periods (sub3)
  9971                                 to ws-int-periods
  9972           end-if
  9973        end-if
  9974     end-if
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 182
* EL050.cbl
  9975     .
  9976 0410-CHECK-AH.
  9977
  9978     IF WS-AH-BENEFIT-CD = ZEROS
  9979        GO TO 0500-SET-ACCOUNT.
  9980
  9981     IF CF-ST-RT-CALC NOT = SPACES
  9982        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9983                                    EC-ST-AH-REM-TERM-CALC
  9984     END-IF
  9985
  9986     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9987        IF CF-ST-RF-CP-CALC > '0'
  9988           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9989                                    EC-ST-AH-REFUND-CALC
  9990        END-IF
  9991     ELSE
  9992        IF CF-ST-RF-AH-CALC > '0'
  9993           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9994                                    EC-ST-AH-REFUND-CALC
  9995        END-IF
  9996     END-IF
  9997     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9998     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9999
 10000     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10001
 10002     IF NO-BENEFIT-FOUND
 10003        GO TO 0500-SET-ACCOUNT.
 10004
 10005     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10006        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10007                                 TO WS-AH-REM-TERM-CALC
 10008                                    EC-ST-AH-REM-TERM-CALC
 10009     END-IF
 10010
 10011     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10012        MOVE CF-ST-REFUND-CALC (SUB3)
 10013                                 TO WS-AH-REFUND-CALC
 10014                                    EC-ST-AH-REFUND-CALC
 10015     END-IF
 10016
 10017*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10018
 10019     GO TO 0500-SET-ACCOUNT.
 10020
 10021 0499-STATE-NOT-FOUND.
 10022
 10023     MOVE ER-2603                TO WS-ERROR.
 10024     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10025
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 183
* EL050.cbl
 10027
 10028 0500-SET-ACCOUNT.
 10029*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10030     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10031        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10032        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10033        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10034        MOVE '3'                 TO CNTL-REC-TYPE
 10035        MOVE +0                  TO CNTL-SEQ-NO
 10036
 10037        MOVE '3'                 TO RC-SW-2
 10038        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10039
 10040        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10041           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10042           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10043           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10044                                    WS-ST-AH-PREM-TAX-I
 10045                                    WS-ST-AH-PREM-TAX-G
 10046        ELSE
 10047           IF CF-ST-LF-PREM-TAX NUMERIC
 10048              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10049           END-IF
 10050           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10051              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10052           END-IF
 10053           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10054              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10055           END-IF
 10056        END-IF
 10057        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10058     END-IF
 10059*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10060*  FOR DCC ONLY
 10061     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10062
 10063     MOVE ' '                    TO STAT-MASTER-SW
 10064     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10065     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10066     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10067     MOVE PB-STATE               TO ELSTAT-STATE
 10068     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10069        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10070     END-IF
 10071
 10072     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10073     SET BIN-TO-GREG             TO TRUE
 10074     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10075     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10076     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10077
 10078     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10079     IF STAT-MASTER-FOUND
 10080        MOVE 'N'                 TO STAT-MASTER-SW
 10081        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10082        IF STAT-MASTER-FOUND
 10083           IF (ELSTAT-KEY-SAVE (1:12) =
 10084                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 184
* EL050.cbl
 10085              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10086                 MOVE 'F'        TO STAT-MASTER-SW
 10087              ELSE
 10088                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10089                 IF (STAT-MASTER-FOUND)
 10090                    AND (ELSTAT-KEY-SAVE (1:12) =
 10091                        SF-CONTROL-PRIMARY (1:12))
 10092                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10093                    MOVE 'F'     TO STAT-MASTER-SW
 10094                 END-IF
 10095              END-IF
 10096           END-IF
 10097        END-IF
 10098     END-IF
 10099
 10100     IF STAT-MASTER-SW = 'F'
 10101        IF (SF-ST-LF-PREM-TAX NUMERIC)
 10102           and (sf-st-lf-prem-tax > zeros)
 10103           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10104        END-IF
 10105        IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10106           and (sf-st-ah-prem-tax-i > zeros)
 10107           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10108        END-IF
 10109        IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10110           and (sf-st-ah-prem-tax-g > zeros)
 10111           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10112        END-IF
 10113     END-IF
 10114
 10115     END-IF
 10116     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10117        AND (PB-ISSUE)
 10118        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10119        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10120        AND (AM-GPCD = 06)
 10121        MOVE 'Y'                 TO WS-GOOD-HIN
 10122        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10123           MOVE PB-I-VIN         TO WS-WORK-VIN
 10124           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10125              (V1 > 16)
 10126              IF WS-WORK-VIN (V1:1) NUMERIC
 10127                 MOVE WS-WORK-VIN-N (V1)
 10128                                 TO WS-ROW-B-VAL (V1)
 10129              ELSE
 10130                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10131                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10132                    OR (V2 > 26)
 10133                 END-PERFORM
 10134                 IF V2 < 27
 10135                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10136                 ELSE
 10137                    MOVE 'N'     TO WS-GOOD-HIN
 10138                 END-IF
 10139              END-IF
 10140              COMPUTE WS-ROW-D-VAL (V1) =
 10141                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10142              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 185
* EL050.cbl
 10143                 WS-ROW-D-VAL (V1)
 10144           END-PERFORM
 10145           MOVE ZEROS            TO WS-VIN-REMAINDER
 10146           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10147             REMAINDER WS-VIN-REMAINDER
 10148           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10149              CONTINUE
 10150           ELSE
 10151              MOVE 'N'           TO WS-GOOD-HIN
 10152           END-IF
 10153        ELSE
 10154           MOVE 'N'              TO WS-GOOD-HIN
 10155        END-IF
 10156        IF WS-GOOD-HIN NOT = 'Y'
 10157           MOVE ER-3826           TO WS-ERROR
 10158           PERFORM 9900-ERROR-FORMAT
 10159                                 THRU 9900-EXIT
 10160        END-IF
 10161     END-IF
 10162     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10163        AND (PB-ISSUE)
 10164        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10165        AND (AM-GPCD NOT = 06)
 10166        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10167           perform 3400-edit-vin thru 3400-exit
 10168        ELSE
 10169          MOVE ER-3826           TO WS-ERROR
 10170          PERFORM 9900-ERROR-FORMAT
 10171                                 THRU 9900-EXIT
 10172        END-IF
 10173     END-IF
 10174     if (pb-company-id = 'CID')
 10175        and (pb-issue)
 10176        and (pb-i-vin not = spaces and low-values and zeros)
 10177        perform 3400-edit-vin    thru 3400-exit
 10178     end-if
 10179******************************************************************
 10180******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10181******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10182******* METHODS.
 10183******************************************************************
 10184     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10185        IF PB-CANCELLATION
 10186           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10187              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10188                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10189                IF FORM-MASTER-FOUND
 10190                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10191******************************************************************
 10192
 10193     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10194     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10195
 10196     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10197     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10198     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10199     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10200
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 186
* EL050.cbl
 10201
 10202     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10203     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10204     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10205
 10206     IF AM-LF-OB-RATE NOT NUMERIC
 10207         MOVE ZERO               TO AM-LF-OB-RATE.
 10208
 10209     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10210         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10211
 10212     IF AM-AH-OB-RATE NOT NUMERIC
 10213         MOVE ZERO               TO AM-AH-OB-RATE.
 10214
 10215     IF WS-LF-JOINT-INDICATOR = 'J'
 10216         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10217     ELSE
 10218         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10219
 10220     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10221
 10222     IF WS-IG-OVRD-AM  EQUAL SPACE
 10223         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10224
 10225     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10226         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10227                                       WS-IG-OVRD
 10228     ELSE
 10229         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10230             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10231                                       WS-IG-OVRD
 10232         ELSE
 10233             MOVE AM-IG             TO WS-IG-OVRD-AH
 10234                                       WS-IG-OVRD.
 10235
 10236     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10237         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10238                                       WS-IG-OVRD
 10239     ELSE
 10240         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10241             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10242                                       WS-IG-OVRD
 10243         ELSE
 10244             MOVE AM-IG             TO WS-IG-OVRD-LF
 10245                                       WS-IG-OVRD.
 10246
 10247     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10248     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10249     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10250     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10251*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10252     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10253                                              TO 'PRLDSFCTIA'.
 10254
 10255     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10256     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10257     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10258     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 187
* EL050.cbl
 10259
 10260     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10261     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10262     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10263     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10264     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10265     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10266     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10267
 10268     IF WS-ACCT-AH-DEV-PCT > +0
 10269        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10270     ELSE
 10271        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10272
 10273     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10274        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10275     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10276        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10277
 10278        IF AM-EARN-METHOD-L = 'S'
 10279            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10280                                        WS-LF-REFUND-CALC.
 10281
 10282        IF AM-EARN-METHOD-R = 'S'
 10283            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10284                                        WS-LF-REFUND-CALC.
 10285
 10286     IF WS-LF-COVERAGE-TYPE = 'R'
 10287         IF AM-EARN-METHOD-R = 'R'
 10288            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10289                                    WS-LF-REFUND-CALC.
 10290     IF WS-LF-COVERAGE-TYPE = 'R'
 10291         IF AM-EARN-METHOD-R = 'P'
 10292            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10293                                    WS-LF-REFUND-CALC.
 10294     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10295         IF AM-EARN-METHOD-L = 'R'
 10296            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10297                                    WS-LF-REFUND-CALC.
 10298     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10299         IF AM-EARN-METHOD-L = 'P'
 10300            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10301                                    WS-LF-REFUND-CALC.
 10302     IF WS-LF-COVERAGE-TYPE = 'R'
 10303         IF AM-EARN-METHOD-R = 'A'
 10304            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10305                                    WS-LF-REFUND-CALC.
 10306     IF WS-LF-COVERAGE-TYPE = 'R'
 10307         IF AM-EARN-METHOD-R = 'M'
 10308            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10309                                    WS-LF-REFUND-CALC.
 10310     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10311         IF AM-EARN-METHOD-L = 'A'
 10312            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10313                                    WS-LF-REFUND-CALC.
 10314     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10315         IF AM-EARN-METHOD-L = 'M'
 10316            MOVE '8'             TO EC-AM-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 188
* EL050.cbl
 10317                                    WS-LF-REFUND-CALC.
 10318
 10319     IF AM-EARN-METHOD-A = 'R'
 10320        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10321                                    WS-AH-REFUND-CALC.
 10322     IF AM-EARN-METHOD-A = 'P'
 10323        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10324                                    WS-AH-REFUND-CALC.
 10325     IF AM-EARN-METHOD-A = 'C'
 10326        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10327                                    WS-AH-REFUND-CALC.
 10328     IF AM-EARN-METHOD-A = 'A'
 10329        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10330                                    WS-AH-REFUND-CALC.
 10331     IF AM-EARN-METHOD-A = 'M'
 10332        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10333                                    WS-AH-REFUND-CALC.
 10334     IF AM-EARN-METHOD-A = 'N'
 10335        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10336                                    WS-AH-REFUND-CALC.
 10337     IF AM-EARN-METHOD-A = 'S'
 10338        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10339                                    WS-AH-REFUND-CALC.
 10340
 10341     IF AM-TOL-PREM NOT = ZEROS
 10342        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10343                                    WS-TOL-AH-PREM.
 10344
 10345     IF AM-OVR-SHT-AMT NUMERIC AND
 10346                  AM-OVR-SHT-AMT > 0
 10347        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10348                                    EC-AM-LF-OVR-SHT-AMT
 10349                                    WS-AH-REFUND-OVS-AMT
 10350                                    EC-AM-AH-OVR-SHT-AMT.
 10351
 10352     IF AM-OVR-SHT-PCT NUMERIC AND
 10353                    AM-OVR-SHT-PCT > 0
 10354        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10355                                    EC-AM-LF-OVR-SHT-PCT
 10356                                    WS-AH-REFUND-OVS-PCT
 10357                                    EC-AM-AH-OVR-SHT-PCT.
 10358
 10359     IF AM-TOL-REF-PCT NUMERIC AND
 10360                  AM-TOL-REF-PCT > 0
 10361        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10362                                    WS-TOL-AH-REFUND-PCT.
 10363
 10364     IF AM-TOL-REF  NOT = ZEROS  AND
 10365                  AM-TOL-REF NUMERIC
 10366        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10367                                    EC-AM-LF-TOL-REFUND
 10368                                    WS-TOL-AH-REFUND
 10369                                    EC-AM-AH-TOL-REFUND.
 10370
 10371     IF AM-TOL-CLM  NOT = ZEROS
 10372        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10373                                    WS-TOL-AH-CLAIM.
 10374
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 189
* EL050.cbl
 10375     IF AM-CLP-TOL-PCT NOT NUMERIC
 10376        MOVE +0                  TO AM-CLP-TOL-PCT
 10377     END-IF
 10378
 10379     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10380        MOVE +0                  TO AM-SPP-LEASE-COMM
 10381     END-IF
 10382     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10383        MOVE WS-PL-TOL-LF-PREM-PCT
 10384                                 TO WS-TOL-LF-PREM-PCT.
 10385
 10386     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10387        MOVE WS-PL-TOL-AH-PREM-PCT
 10388                                 TO WS-TOL-AH-PREM-PCT.
 10389
 10390     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10391        MOVE WS-PL-TOL-LF-REFUND-PCT
 10392                                 TO WS-TOL-LF-REFUND-PCT.
 10393
 10394     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10395        MOVE WS-PL-TOL-AH-REFUND-PCT
 10396                                 TO WS-TOL-AH-REFUND-PCT.
 10397
 10398     IF WS-PL-REF-OVS-AMT > +0
 10399        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10400
 10401     IF WS-PL-REF-OVS-PCT > +0
 10402        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10403
 10404     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10405        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10406     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10407        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10408     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10409        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10410     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10411        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10412     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10413        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10414     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10415        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10416
 10417     IF WS-AH-PL-REF-OVS-AMT > +0
 10418        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10419
 10420     IF WS-AH-PL-REF-OVS-PCT > +0
 10421        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10422
 10423     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10424     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10425
 10426     IF PB-CANCELLATION
 10427        GO TO 3000-CONTINUE-EDIT.
 10428
 10429     MOVE +1 TO SUB1.
 10430     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10431     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10432
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 190
* EL050.cbl
 10433     IF CF-COMPANY-ID = 'DMD'
 10434       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10435         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10436        ELSE
 10437         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10438
 10439  0525-FIND-ACCT-COMM.
 10440     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10441        NEXT SENTENCE
 10442      ELSE
 10443         ADD +1 TO SUB1
 10444         IF SUB1 LESS +11
 10445            GO TO 0525-FIND-ACCT-COMM
 10446          ELSE
 10447             GO TO 0560-EDIT-CONTINUE.
 10448
 10449     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10450     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10451                                    PB-I-LIFE-COMMISSION.
 10452***  IF PB-COMPANY-ID = 'CRI'
 10453     IF PB-PREM-ACCTNG-ONLY
 10454         GO TO 0560-EDIT-CONTINUE.
 10455
 10456     MOVE '0530' TO CTBL-SW.
 10457     MOVE ' '    TO WS-CTBL-READ-SW.
 10458
 10459
 10460 0530-GET-AH-COMP.
 10461     IF NO-AH-COVERAGE  OR
 10462        NO-AH-BENEFIT-MATCH
 10463           GO TO 0540-NEXT-READ-STEP.
 10464
 10465     IF AM-A-COM (SUB1) NUMERIC
 10466        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10467         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10468         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10469         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10470         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10471     ELSE
 10472          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10473          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10474          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10475          MOVE ZEROS             TO WS-SUB1
 10476                                    WS-COMMISSION
 10477          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10478          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10479          IF WS-COMMISSION > ZEROS
 10480             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10481             GO TO 0540-NEXT-READ-STEP
 10482          END-IF
 10483          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10484          IF CTBL-TABLE-FOUND
 10485             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10486                                        PB-I-AH-TERM
 10487             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10488             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10489             GO TO 0540-NEXT-READ-STEP
 10490          ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 191
* EL050.cbl
 10491             IF FIRST-TIME-THROUGH
 10492                 GO TO 0530-GET-AH-COMP
 10493             ELSE
 10494                 MOVE ER-2609                TO WS-ERROR
 10495                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10496
 10497 0540-NEXT-READ-STEP.
 10498     MOVE '0540' TO CTBL-SW.
 10499     MOVE ' '    TO WS-CTBL-READ-SW.
 10500
 10501 0540-GET-LF-COMP.
 10502     IF NO-LIFE-COVERAGE  OR
 10503        NO-LF-BENEFIT-MATCH
 10504           GO TO 0560-EDIT-CONTINUE.
 10505
 10506     IF WS-LF-JOINT-INDICATOR = 'J'
 10507        IF AM-J-COM (SUB1) NUMERIC
 10508           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10509           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10510           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10511           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10512           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10513        ELSE
 10514           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10515           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10516           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10517           MOVE ZEROS                TO WS-SUB1
 10518                                        WS-COMMISSION
 10519           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10520           IF WS-COMMISSION > ZEROS
 10521              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10522              GO TO 0560-EDIT-CONTINUE
 10523           END-IF
 10524           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10525           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10526           IF CTBL-TABLE-FOUND
 10527              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10528              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10529              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10530              GO TO 0560-EDIT-CONTINUE
 10531           ELSE
 10532              IF FIRST-TIME-THROUGH
 10533                  GO TO 0540-GET-LF-COMP
 10534              ELSE
 10535                  MOVE ER-2609                TO WS-ERROR
 10536                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10537                  GO TO 0560-EDIT-CONTINUE.
 10538
 10539     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10540        IF AM-L-COM (SUB1) NUMERIC
 10541           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10542           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10543           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10544           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10545           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10546        ELSE
 10547           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10548           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 192
* EL050.cbl
 10549           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10550           MOVE ZEROS                TO WS-SUB1
 10551                                        WS-COMMISSION
 10552           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10553           IF WS-COMMISSION IS GREATER THAN ZEROS
 10554              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10555              GO TO 0560-EDIT-CONTINUE
 10556           END-IF
 10557           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10558           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10559           IF CTBL-TABLE-FOUND
 10560              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10561              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10562              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10563              GO TO 0560-EDIT-CONTINUE
 10564           ELSE
 10565              IF FIRST-TIME-THROUGH
 10566                  GO TO 0540-GET-LF-COMP
 10567              ELSE
 10568                  MOVE ER-2609                TO WS-ERROR
 10569                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10570
 10571*    GO TO 0560-EDIT-CONTINUE.
 10572
 10573 0560-EDIT-CONTINUE.
 10574     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10575                                    WS-AH-PMF-COMM
 10576*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10577*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10578     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10579        (SUB1 > +10)
 10580        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10581           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10582           MOVE '0530'           TO CTBL-SW
 10583           MOVE ' '              TO WS-CTBL-READ-SW
 10584           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10585           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10586           MOVE '0540'           TO CTBL-SW
 10587           MOVE ' '              TO WS-CTBL-READ-SW
 10588           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10589        END-IF
 10590     END-PERFORM
 10591     GO TO 0564-EDIT-CONTINUE
 10592     .
 10593 0561-CHECK-AH.
 10594     IF (NO-AH-COVERAGE)
 10595        OR (NO-AH-BENEFIT-MATCH)
 10596        CONTINUE
 10597     ELSE
 10598        IF (AM-A-COM (SUB1) NUMERIC)
 10599           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10600           IF (AM-COM-TYP (SUB1) = 'A')
 10601              AND (WS-AH-PMF-COMM = ZEROS)
 10602              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10603           END-IF
 10604           CONTINUE
 10605        ELSE
 10606           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 193
* EL050.cbl
 10607           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10608           MOVE PB-AH-OVERRIDE-L1
 10609                                 TO CTBL-BEN-TYPE
 10610           MOVE ZEROS            TO WS-SUB1
 10611                                    WS-COMMISSION
 10612           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10613           PERFORM 8300-READ-CTBL-TABLE
 10614                                 THRU 8300-EXIT
 10615           IF CTBL-TABLE-FOUND
 10616              IF (AM-COM-TYP (SUB1) = 'A')
 10617                 AND (WS-AH-PMF-COMM = ZEROS)
 10618                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10619                                        PB-I-AH-TERM
 10620                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10621                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10622              END-IF
 10623              CONTINUE
 10624           ELSE
 10625              IF FIRST-TIME-THROUGH
 10626                 GO TO 0561-CHECK-AH
 10627              ELSE
 10628                 MOVE ER-2609    TO WS-ERROR
 10629                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10630              END-IF
 10631           END-IF
 10632        END-IF
 10633     END-IF
 10634     .
 10635 0561-EXIT.
 10636     EXIT.
 10637 0563-CHECK-LF.
 10638     IF (NO-LIFE-COVERAGE)
 10639        OR (NO-LF-BENEFIT-MATCH)
 10640        CONTINUE
 10641     ELSE
 10642        IF WS-LF-JOINT-INDICATOR = 'J'
 10643           IF AM-J-COM (SUB1) NUMERIC
 10644              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10645              IF (AM-COM-TYP (SUB1) = 'A')
 10646                 AND (WS-LF-PMF-COMM = ZEROS)
 10647                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10648              END-IF
 10649              CONTINUE
 10650           ELSE
 10651              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10652              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10653              MOVE PB-LIFE-OVERRIDE-L1
 10654                                 TO CTBL-BEN-TYPE
 10655              MOVE ZEROS         TO WS-SUB1
 10656                                    WS-COMMISSION
 10657              MOVE AM-J-COMA (SUB1)
 10658                                 TO CTBL-TABLE
 10659              PERFORM 8300-READ-CTBL-TABLE
 10660                                 THRU 8300-EXIT
 10661              IF CTBL-TABLE-FOUND
 10662                 IF (AM-COM-TYP (SUB1) = 'A')
 10663                    AND (WS-LF-PMF-COMM = ZEROS)
 10664                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 194
* EL050.cbl
 10665                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10666                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10667                 END-IF
 10668                 CONTINUE
 10669              ELSE
 10670                 IF FIRST-TIME-THROUGH
 10671                    GO TO 0563-CHECK-LF
 10672                 ELSE
 10673                    MOVE ER-2609 TO WS-ERROR
 10674                    PERFORM 9900-ERROR-FORMAT
 10675                                 THRU 9900-EXIT
 10676*                   GO TO 0560-EDIT-CONTINUE
 10677                 END-IF
 10678              END-IF
 10679           END-IF
 10680        ELSE
 10681           IF AM-L-COM (SUB1) NUMERIC
 10682              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10683              IF (AM-COM-TYP (SUB1) = 'A')
 10684                 AND (WS-LF-PMF-COMM = ZEROS)
 10685                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10686              END-IF
 10687              CONTINUE
 10688           ELSE
 10689              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10690              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10691              MOVE PB-LIFE-OVERRIDE-L1
 10692                                 TO CTBL-BEN-TYPE
 10693              MOVE ZEROS         TO WS-SUB1
 10694                                    WS-COMMISSION
 10695              MOVE AM-L-COMA (SUB1)
 10696                                 TO CTBL-TABLE
 10697              PERFORM 8300-READ-CTBL-TABLE
 10698                                 THRU 8300-EXIT
 10699              IF CTBL-TABLE-FOUND
 10700                 CONTINUE
 10701              ELSE
 10702                 IF FIRST-TIME-THROUGH
 10703                    GO TO 0563-CHECK-LF
 10704                 ELSE
 10705                    MOVE ER-2609 TO WS-ERROR
 10706                    PERFORM 9900-ERROR-FORMAT
 10707                                 THRU 9900-EXIT
 10708                 END-IF
 10709              END-IF
 10710           END-IF
 10711        END-IF
 10712     END-IF
 10713     .
 10714 0563-EXIT.
 10715     EXIT.
 10716 0564-EDIT-CONTINUE.
 10717
 10718     IF  PB-COMPANY-ID EQUAL 'DMD'
 10719         IF PB-I-NUM-BILLED EQUAL ZEROS
 10720            MOVE ER-8148       TO WS-ERROR
 10721            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10722
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 195
* EL050.cbl
 10723*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10724*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10725*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10726*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10727*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10728*         IF NO-CONVERSION-ERROR
 10729*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10730*         ELSE
 10731*             IF PB-COMPANY-ID EQUAL 'HAN'
 10732*                 MOVE ZEROS     TO PB-I-AGE.
 10733     IF PB-I-BIRTHDAY > LOW-VALUES
 10734        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10735        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10736        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10737        PERFORM 8500-DATE-CONVERT
 10738                                 THRU 8500-EXIT
 10739        IF NO-CONVERSION-ERROR
 10740           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10741           IF PB-I-AGE > ZEROS
 10742              IF WS-WORK-AGE NOT = PB-I-AGE
 10743                 MOVE ER-9501    TO WS-ERROR
 10744                 PERFORM 9900-ERROR-FORMAT
 10745                                 THRU 9900-EXIT
 10746              END-IF
 10747           ELSE
 10748              MOVE WS-WORK-AGE   TO PB-I-AGE
 10749           END-IF
 10750        END-IF
 10751     END-IF
 10752     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10753                                   WS-INS-AGE-SET
 10754     IF PB-I-AGE = ZEROS
 10755        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10756           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10757                                   WS-INS-AGE-SET
 10758           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10759
 10760     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10761                                   WS-AH-EDIT-AGE.
 10762
 10763     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10764        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10765        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10766        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10767        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10768        IF NO-CONVERSION-ERROR
 10769           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10770           IF PB-I-JOINT-AGE > 0
 10771              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10772                 MOVE ER-9503    TO WS-ERROR
 10773                 PERFORM 9900-ERROR-FORMAT
 10774                                 THRU 9900-EXIT
 10775              END-IF
 10776           ELSE
 10777              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10778           END-IF
 10779        ELSE
 10780           MOVE ZEROS            TO PB-I-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 196
* EL050.cbl
 10781        END-IF
 10782     END-IF
 10783     IF PB-I-JOINT-AGE NOT NUMERIC
 10784        MOVE ZERO               TO PB-I-JOINT-AGE.
 10785
 10786     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10787                                   WS-JNT-AGE-SET
 10788     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10789        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10790           (WS-AH-JOINT-INDICATOR = 'J')
 10791           IF PB-I-JOINT-AGE = ZEROS
 10792               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10793                                          WS-JNT-AGE-SET
 10794               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10795           END-IF
 10796        END-IF
 10797     END-IF
 10798
 10799     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10800     IF WS-LF-JOINT-INDICATOR = 'J'
 10801        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10802        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10803            IF  PB-I-JOINT-AGE = ZERO
 10804                MOVE ER-2686       TO WS-ERROR
 10805                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10806            ELSE
 10807                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10808                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10809                    IF PB-COMPANY-ID NOT = 'LBL'
 10810                        MOVE ER-2685    TO WS-ERROR
 10811                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10812
 10813     IF WS-AH-JOINT-INDICATOR = 'J'
 10814        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10815            IF  PB-I-JOINT-AGE = ZERO
 10816                MOVE ER-2686       TO WS-ERROR
 10817                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10818            ELSE
 10819                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10820                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10821                                           WS-EDIT-AGE
 10822                    IF PB-COMPANY-ID NOT = 'LBL'
 10823                        MOVE ER-2685    TO WS-ERROR
 10824                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10825
 10826******************************************************************
 10827*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10828******************************************************************
 10829
 10830     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10831        (WS-AH-SPECIAL-CALC-CD = 'O')
 10832        NEXT SENTENCE
 10833     ELSE
 10834        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10835          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10836           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10837            WS-AH-JOINT-INDICATOR = 'J')  AND
 10838           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 197
* EL050.cbl
 10839            MOVE ER-2627             TO WS-ERROR
 10840            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10841
 10842     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10843        (WS-AH-SPECIAL-CALC-CD = 'O')
 10844         NEXT SENTENCE
 10845     ELSE
 10846         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10847            WS-AH-JOINT-INDICATOR = 'J'
 10848             IF PB-I-JOINT-INSURED = SPACES
 10849                 IF PB-COMPANY-ID NOT = 'JAL'
 10850                     MOVE ER-2696    TO WS-ERROR
 10851                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10852
 10853     IF PB-COMPANY-ID NOT = 'BOA'
 10854        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10855           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10856           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10857               PB-I-JOINT-INSURED NOT = SPACES)
 10858                MOVE ER-2691         TO WS-ERROR
 10859                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10860
 10861     IF PB-COMPANY-ID = 'BOA'
 10862        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10863           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10864            IF PB-I-JOINT-AGE NOT = ZEROS
 10865                MOVE ER-2691         TO WS-ERROR
 10866                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10867
 10868     IF PB-COMPANY-ID = 'CRI'
 10869        IF PB-I-SIG-SW = 'J'
 10870           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10871              WS-AH-JOINT-INDICATOR NOT = 'J'
 10872              MOVE ER-2675       TO WS-ERROR
 10873              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10874
 10875     IF PB-COMPANY-ID = 'CRI'
 10876        IF PB-I-SIG-SW = 'S'
 10877           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10878              WS-AH-JOINT-INDICATOR = 'J'
 10879              MOVE ER-2676       TO WS-ERROR
 10880              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10881
 10882     IF PB-COMPANY-ID = 'CVL'
 10883         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10884            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10885              MOVE ER-2783           TO WS-ERROR
 10886              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10887     IF (WS-LF-JOINT-INDICATOR = 'J')
 10888        AND (WS-AH-JOINT-INDICATOR = 'J')
 10889        AND (PB-I-LF-TERM > 120)
 10890        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10891        MOVE ER-2783             TO WS-ERROR
 10892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893     END-IF
 10894     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10895
 10896     IF PB-I-INDV-GRP-OVRD = 'I'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 198
* EL050.cbl
 10897        MOVE ER-2666             TO WS-ERROR
 10898        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10899        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10900
 10901     IF PB-I-INDV-GRP-OVRD = 'G'
 10902        MOVE ER-2666             TO WS-ERROR
 10903        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10904        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10905
 10906     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10907        NEXT SENTENCE
 10908     ELSE
 10909        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10910
 10911     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10912        IF WS-ERROR = ER-2666
 10913           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10914           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10915
 10916     IF PB-COMPANY-ID = 'CID'
 10917        IF PB-STATE = 'UT' OR 'MO'
 10918           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10919                 OR '76' OR '77')
 10920                      OR
 10921               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10922                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10923                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10924                   OR '2K' OR '2L'))
 10925              AND PB-I-INDV-GRP-CD = 'I'
 10926              MOVE ER-2721             TO WS-ERROR
 10927              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10928           END-IF
 10929        END-IF
 10930     END-IF
 10931
 10932     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10933     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10934        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10935     ELSE
 10936        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10937     END-IF
 10938
 10939*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10940*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10941     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10942                                    ACCOUNT-AH-CK-SW.
 10943
 10944     IF PB-REISSUED-CERT       OR
 10945        PB-REIN-ONLY-CERT      OR
 10946        PB-POLICY-IS-DECLINED  OR
 10947        PB-POLICY-IS-VOIDED
 10948*       OR PB-MONTHLY-CERT
 10949         GO TO 3000-CONTINUE-EDIT.
 10950
 10951     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10952        IF WS-EDIT-AGE           > +65
 10953           MOVE ER-2709          TO WS-ERROR
 10954           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 199
* EL050.cbl
 10955                                 THRU 9900-EXIT
 10956        ELSE
 10957           IF WS-EDIT-AGE        > +55
 10958              MOVE ER-2718       TO WS-ERROR
 10959              PERFORM 9900-ERROR-FORMAT
 10960                                 THRU 9900-EXIT
 10961           END-IF
 10962        END-IF
 10963     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10964        IF WS-EDIT-AGE           > +65
 10965           MOVE ER-2709          TO WS-ERROR
 10966           PERFORM 9900-ERROR-FORMAT
 10967                                 THRU 9900-EXIT
 10968        END-IF
 10969     END-IF
 10970     .
 10971
 10972 0565-LIFE-PLAN-LIMIT-EDITS.
 10973
 10974     IF NOT LF-PLAN-MASTER-FOUND
 10975        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10976                                    EC-AM-LF-MAX-TOT-BEN
 10977        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10978
 10979     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10980
 10981     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10982         IF PL-LM-AGE (1) = ZEROS
 10983             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10984
 10985     IF NO-LF-BENEFIT-MATCH          OR
 10986        WS-LF-BENEFIT-CD = ZEROS     OR
 10987        WS-LF-SPECIAL-CALC-CD = 'M'
 10988        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10989
 10990     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10991     MOVE +1                     TO SUB2.
 10992
 10993     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10994        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10995           MOVE +5   TO SUB2
 10996           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10997              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10998              (PL-LM-AGE (SUB2) EQUAL +0)
 10999              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11000              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11001
 11002     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11003
 11004     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11005                               + PB-I-LF-ALT-BENEFIT-AMT.
 11006
 11007 0568-CHECK-LIFE-ATT-AGE.
 11008
 11009     IF PL-ATT-AGE NUMERIC AND
 11010        PL-ATT-AGE > +0
 11011        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11012     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 200
* EL050.cbl
 11013*    IF PL-ATT-AGE NUMERIC AND
 11014*       PL-ATT-AGE > +0
 11015*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11016*       IF PB-I-BIRTHDAY > LOW-VALUES
 11017*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11018*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11019*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11020*          SET BIN-PLUS-ELAPSED  TO TRUE
 11021*          PERFORM 8500-DATE-CONVERT
 11022*                                THRU 8500-EXIT
 11023*          IF NO-CONVERSION-ERROR
 11024*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11025*             MOVE ER-2669       TO WS-ERROR
 11026*             PERFORM 9900-ERROR-FORMAT
 11027*                                THRU 9900-EXIT
 11028*          END-IF
 11029*       ELSE
 11030*          IF WS-ATT-AGE >= PL-ATT-AGE
 11031*             MOVE ER-2669       TO WS-ERROR
 11032*             PERFORM 9900-ERROR-FORMAT
 11033*                                THRU 9900-EXIT
 11034*          END-IF
 11035*       END-IF
 11036*    END-IF
 11037     .
 11038 0570-CHECK-LIFE-LIMITS.
 11039
 11040     IF PB-COMPANY-ID EQUAL 'CRI'
 11041        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11042           IF SUB2 GREATER THAN +4
 11043              MOVE ER-2637 TO WS-ERROR
 11044              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11045              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11046
 11047     IF PB-COMPANY-ID  =  'NCL'
 11048        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11049            SUB2 GREATER THAN +8
 11050             MOVE 'U'         TO PB-BATCH-ENTRY
 11051             MOVE ER-2637     TO WS-ERROR
 11052             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11053             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11054
 11055     IF SUB2 > +8
 11056        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11057           AND (PB-I-SIG-SW = 'Y')
 11058           CONTINUE
 11059        ELSE
 11060           MOVE ER-2637          TO WS-ERROR
 11061           PERFORM 9900-ERROR-FORMAT
 11062                                 THRU 9900-EXIT
 11063        END-IF
 11064        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11065     END-IF
 11066     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11067     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11068     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11069
 11070     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 201
* EL050.cbl
 11071        ADD +1  TO SUB2
 11072        GO TO 0570-CHECK-LIFE-LIMITS.
 11073
 11074     IF PB-COMPANY-ID = 'NCL'
 11075         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11076
 11077     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11078        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11079        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11080           AND (PB-I-SIG-SW = 'Y')
 11081           CONTINUE
 11082        ELSE
 11083           MOVE ER-2637          TO WS-ERROR
 11084           PERFORM 9900-ERROR-FORMAT
 11085                                 THRU 9900-EXIT
 11086        END-IF
 11087     END-IF
 11088     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11089
 11090
 11091 0570-CHECK-NCL-LIFE-LIMITS.
 11092
 11093     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11094        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11095         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11096
 11097     IF APP-CERT-USED
 11098         IF SUB2  LESS THAN  +5
 11099             MOVE +5          TO SUB2
 11100             GO TO 0570-CHECK-LIFE-LIMITS.
 11101
 11102     MOVE ER-2637             TO WS-ERROR.
 11103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11104
 11105     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11106
 11107 0575-CHECK-NCL-SIG-SWITCH.
 11108
 11109     IF NOT APP-CERT-USED
 11110         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11111
 11112     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11113        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11114        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11115        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11116         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11117
 11118     IF SUB2 GREATER THAN +4
 11119         IF PL-LM-AGE (5) = ZEROS  AND
 11120            PL-LM-AGE (6) = ZEROS  AND
 11121            PL-LM-AGE (7) = ZEROS  AND
 11122            PL-LM-AGE (8) = ZEROS
 11123             MOVE  ER-1927        TO WS-ERROR
 11124             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11125             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11126         ELSE
 11127             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11128                 MOVE  ER-1920    TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 202
* EL050.cbl
 11129                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11130
 11131     IF PB-I-SIG-SW  = 'Y'
 11132       IF NOT PB-I-POLICY-ACCEPTED  AND
 11133          NOT PB-I-POLICY-DECLINED
 11134           MOVE 'U'               TO PB-BATCH-ENTRY
 11135           MOVE  ER-1926          TO WS-ERROR
 11136           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11137
 11138
 11139 0580-AH-PLAN-LIMIT-EDITS.
 11140
 11141     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11142        IF PB-I-AH-BENEFIT-AMT > +1250
 11143           MOVE ER-2702          TO WS-ERROR
 11144           PERFORM 9900-ERROR-FORMAT
 11145                                 THRU 9900-EXIT
 11146        END-IF
 11147     END-IF
 11148
 11149     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11150        AND (PB-MONTHLY-CERT)
 11151        IF PB-I-AH-BENEFIT-AMT > +3000
 11152           MOVE ER-2881          TO WS-ERROR
 11153           PERFORM 9900-ERROR-FORMAT
 11154                                 THRU 9900-EXIT
 11155        END-IF
 11156     END-IF
 11157     IF NOT AH-PLAN-MASTER-FOUND
 11158        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11159        GO TO 3000-CONTINUE-EDIT.
 11160
 11161     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11162
 11163     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11164         IF PL-LM-AGE (1) = ZEROS
 11165             GO TO 3000-CONTINUE-EDIT.
 11166
 11167     IF NO-AH-BENEFIT-MATCH          OR
 11168        WS-AH-BENEFIT-CD = ZEROS     OR
 11169        WS-AH-SPECIAL-CALC-CD = 'M'
 11170        GO TO 3000-CONTINUE-EDIT.
 11171
 11172     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11173     MOVE +1                     TO SUB2.
 11174
 11175     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11176        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11177           MOVE +5 TO SUB2
 11178           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11179              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11180              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11181              (PL-LM-AGE (SUB2) EQUAL +0)
 11182              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11183              GO TO 3000-CONTINUE-EDIT.
 11184
 11185     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11186
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 203
* EL050.cbl
 11187 0590-CHECK-AH-ATT-AGE.
 11188
 11189     IF PL-ATT-AGE NUMERIC AND
 11190        PL-ATT-AGE GREATER THAN +0
 11191        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11192     END-IF
 11193*       IF WS-ATT-AGE >= PL-ATT-AGE
 11194*          MOVE ER-3054          TO WS-ERROR
 11195*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11196     .
 11197 0597-CHECK-AH-LIMITS.
 11198
 11199     IF PB-COMPANY-ID EQUAL 'CRI'
 11200        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11201           IF SUB2 GREATER THAN +4
 11202              MOVE ER-2638       TO WS-ERROR
 11203              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11204              GO TO 3000-CONTINUE-EDIT.
 11205
 11206     IF PB-COMPANY-ID  =  'NCL'
 11207        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11208            SUB2 GREATER THAN +8
 11209             MOVE 'U'            TO PB-BATCH-ENTRY
 11210             MOVE ER-2638        TO WS-ERROR
 11211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11212             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11213
 11214     IF SUB2 > +8
 11215        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11216           AND (PB-I-SIG-SW = 'Y')
 11217           CONTINUE
 11218        ELSE
 11219           MOVE ER-2638          TO WS-ERROR
 11220           PERFORM 9900-ERROR-FORMAT
 11221                                 THRU 9900-EXIT
 11222        END-IF
 11223        GO TO 3000-CONTINUE-EDIT
 11224     END-IF
 11225
 11226     IF PB-COMPANY-ID = 'CRI'
 11227        IF WS-ERROR = ER-2638
 11228           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11229
 11230     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11231     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11232     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11233     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11234
 11235     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11236        ADD +1                   TO SUB2
 11237        GO TO 0597-CHECK-AH-LIMITS.
 11238
 11239     IF PB-COMPANY-ID = 'NCL'
 11240         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11241
 11242     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11243        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11244        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 204
* EL050.cbl
 11245                                 > PL-LM-AMT (SUB2))
 11246        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11247           AND (PB-I-SIG-SW = 'Y')
 11248           CONTINUE
 11249        ELSE
 11250           MOVE ER-2638          TO WS-ERROR
 11251           PERFORM 9900-ERROR-FORMAT
 11252                                 THRU 9900-EXIT
 11253        END-IF
 11254     END-IF
 11255
 11256     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11257         IF  WS-ERROR    EQUAL    ER-2638
 11258             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11259                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11260                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11261                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11262                MOVE  ER-1910    TO  WS-ERROR
 11263                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11264
 11265     IF PB-COMPANY-ID = 'CRI'
 11266        IF WS-ERROR = ER-2638
 11267            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11268            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11269            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11270
 11271     GO TO 3000-CONTINUE-EDIT.
 11272
 11273 0597-CHECK-NCL-AH-LIMITS.
 11274
 11275     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11276        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11277        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11278                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11279         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11280
 11281     IF APP-CERT-USED
 11282         IF SUB2  LESS THAN  +5
 11283             MOVE +5             TO SUB2
 11284             GO TO 0597-CHECK-AH-LIMITS.
 11285
 11286     MOVE ER-2638                TO WS-ERROR.
 11287     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11288
 11289     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11290
 11291 0599-CHECK-NCL-SIG-SWITCH.
 11292
 11293     IF NOT APP-CERT-USED
 11294         GO TO 3000-CONTINUE-EDIT.
 11295
 11296     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11297        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11298        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11299        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11300         GO TO 3000-CONTINUE-EDIT.
 11301
 11302     IF SUB2 GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 205
* EL050.cbl
 11303         IF PL-LM-AGE (5) = ZEROS  AND
 11304            PL-LM-AGE (6) = ZEROS  AND
 11305            PL-LM-AGE (7) = ZEROS  AND
 11306            PL-LM-AGE (8) = ZEROS
 11307             MOVE  ER-1927        TO WS-ERROR
 11308             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11309             GO TO 3000-CONTINUE-EDIT
 11310         ELSE
 11311             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11312                 MOVE  ER-1920    TO WS-ERROR
 11313                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11314
 11315     IF PB-I-SIG-SW  = 'Y'
 11316       IF NOT PB-I-POLICY-ACCEPTED  AND
 11317          NOT PB-I-POLICY-DECLINED
 11318           MOVE 'U'               TO PB-BATCH-ENTRY
 11319           MOVE  ER-1926          TO WS-ERROR
 11320           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11321
 11322******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 206
* EL050.cbl
 11324
 11325 3000-CONTINUE-EDIT.
 11326
 11327     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11328     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11329     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11330     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11331     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11332
 11333     IF BROWSE-STARTED
 11334        PERFORM 9990-RETURN THRU 9990-EXIT
 11335        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11336
 11337     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11338        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11339        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11340        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11341*       MOVE 1                   TO DC-OPTION-CODE
 11342        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11343        IF DATE-CONVERSION-ERROR
 11344           MOVE ER-2622          TO WS-ERROR
 11345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11346        ELSE
 11347           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11348              MOVE ER-2623       TO WS-ERROR
 11349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11350           ELSE
 11351              MOVE ER-2622       TO WS-ERROR
 11352              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11353
 11354     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11355     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11356     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11357*    MOVE 1                      TO DC-OPTION-CODE.
 11358     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11359     IF DATE-CONVERSION-ERROR
 11360        GO TO 3005-EDIT-CONTINUE
 11361     ELSE
 11362        IF DC-ELAPSED-DAYS GREATER +180
 11363           MOVE ER-2613          TO WS-ERROR
 11364           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11365        ELSE
 11366           IF DC-ELAPSED-DAYS GREATER +90
 11367              MOVE ER-2612       TO WS-ERROR
 11368              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11369           ELSE
 11370             IF DC-ELAPSED-DAYS GREATER +60
 11371                MOVE ER-2614     TO WS-ERROR
 11372                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11373
 11374 3005-EDIT-CONTINUE.
 11375
 11376     IF PB-CANCELLATION
 11377         GO TO 3700-EDIT-CANCEL.
 11378
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 207
* EL050.cbl
 11380******************************************************************
 11381*                  E D I T   I S S U E                           *
 11382******************************************************************
 11383
 11384 3020-EDIT-ISSUE.
 11385
 11386      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11387      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11388      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11389      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11390      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11391
 11392     IF PB-ISSUE-FORCE
 11393        OR PB-ISSUE-DATE-FORCED
 11394        OR PB-FORCE-OFF
 11395        OR PB-OVERCHARGE-FORCE
 11396        or pb-exceeded-limit-forced
 11397        CONTINUE
 11398     ELSE
 11399        MOVE ER-2670             TO WS-ERROR
 11400        PERFORM 9900-ERROR-FORMAT
 11401                                 THRU 9900-EXIT
 11402     END-IF
 11403     .
 11404 3022-SET-POLICY-STATUS.
 11405
 11406     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11407
 11408     IF (PB-REISSUED-CERT)
 11409             OR
 11410        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11411         AND (PB-MONTHLY-CERT))
 11412         MOVE '5'                TO PB-I-ENTRY-STATUS
 11413         MOVE 'E'                TO PB-BATCH-ENTRY
 11414     END-IF
 11415
 11416     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11417        IF PB-MONTHLY-CERT
 11418           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11419        END-IF
 11420        IF PB-CASH-CERT
 11421           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11422        END-IF
 11423     END-IF
 11424     IF PB-POLICY-IS-DECLINED
 11425         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11426     IF PB-POLICY-IS-VOIDED
 11427         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11428     IF PB-NEEDS-UNDERWRITING
 11429         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11430     IF PB-REIN-ONLY-CERT
 11431         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11432     IF PB-PREM-ACCTNG-ONLY
 11433         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11434
 11435     MOVE SPACE                  TO PB-I-OB-FLAG.
 11436
 11437     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 208
* EL050.cbl
 11438         MOVE ER-2665            TO WS-ERROR
 11439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11440         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11441
 11442     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11443        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11444           MOVE 'Z'             TO PB-I-OB-FLAG.
 11445
 11446     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11447        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11448           MOVE 'Z'             TO PB-I-OB-FLAG.
 11449
 11450     IF ACCOUNT-MAST-FOUND
 11451         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11452         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11453         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11454         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11455         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11456         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11457         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11458     END-IF
 11459
 11460     IF ACCOUNT-MAST-FOUND
 11461        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11462         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11463
 11464     IF (ACCOUNT-MAST-FOUND)
 11465*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11466        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11467        IF PB-REISSUED-CERT
 11468           CONTINUE
 11469        ELSE
 11470           MOVE ER-2608          TO WS-ERROR
 11471           PERFORM 9900-ERROR-FORMAT
 11472                                 THRU 9900-EXIT
 11473         END-IF
 11474     END-IF
 11475
 11476     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11477        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11478        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11479
 11480**********   DMD CUSTOM CODE FOLLOWS  **********
 11481 3024-EDIT-DMD-FIELDS.
 11482     IF PB-COMPANY-ID NOT = 'DMD'
 11483        GO TO 3025-EDIT-REINSURANCE.
 11484
 11485*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11486*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11487*** ERROR IF THEY ARE NOT EQUAL.
 11488
 11489     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11490     SET BIN-TO-GREG               TO TRUE.
 11491     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11492     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11493**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11494
 11495     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 209
* EL050.cbl
 11496     SET BIN-TO-GREG               TO TRUE.
 11497     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11498     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11499**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11500
 11501     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11502        MOVE ER-8116               TO WS-ERROR
 11503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11504
 11505     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11506
 11507     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11508                                      WK-FULL-CERT-NO.
 11509     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11510
 11511     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11512
 11513     IF PB-VALID-LIFE
 11514        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11515     ELSE
 11516        IF PB-VALID-AH
 11517          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11518
 11519
 11520     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11521     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11522     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11523                                      DCUA-UNDRWRTR-CODE
 11524                                      DCUA-UNDRWRTR-GROUP-CODE
 11525                                      DCUA-RETURN-CODE.
 11526
 11527****************************************************************
 11528*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11529***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11530***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11531***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11532***   TO THIS RECORD.                                        ***
 11533****************************************************************
 11534     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11535     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11536     IF DCUA-SUCCESSFUL-PROCESS
 11537        GO TO 3024-EDIT-DL7-CONT.
 11538
 11539     IF DCUA-RETURN-CODE EQUAL '01'
 11540        MOVE ER-8110               TO WS-ERROR
 11541        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11542        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11543        GO TO 3024-EDIT-DL7-CONT.
 11544
 11545     IF DCUA-RETURN-CODE EQUAL '02'
 11546        MOVE ER-8111               TO WS-ERROR
 11547        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11548        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549        GO TO 3024-EDIT-DL7-CONT.
 11550
 11551     IF DCUA-RETURN-CODE EQUAL '03'
 11552        MOVE ER-8074               TO WS-ERROR
 11553        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 210
* EL050.cbl
 11554        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11555        GO TO 3024-EDIT-DL7-CONT.
 11556
 11557     IF DCUA-RETURN-CODE EQUAL '04'
 11558        MOVE ER-8075               TO WS-ERROR
 11559        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL7-CONT.
 11562
 11563     IF DCUA-RETURN-CODE EQUAL '05'
 11564        MOVE ER-8076               TO WS-ERROR
 11565        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11566        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11567        GO TO 3024-EDIT-DL7-CONT.
 11568
 11569     IF DCUA-RETURN-CODE EQUAL '06'
 11570        MOVE ER-8077               TO WS-ERROR
 11571        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11573        GO TO 3024-EDIT-DL7-CONT.
 11574
 11575     IF DCUA-RETURN-CODE EQUAL '07'
 11576        MOVE ER-8078               TO WS-ERROR
 11577        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11579        GO TO 3024-EDIT-DL7-CONT.
 11580
 11581     IF DCUA-RETURN-CODE EQUAL 'E1'
 11582        MOVE ER-8079               TO WS-ERROR
 11583        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11585        GO TO 3024-EDIT-DL7-CONT.
 11586
 11587     IF DCUA-RETURN-CODE EQUAL 'E2'
 11588        MOVE ER-8080               TO WS-ERROR
 11589        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        GO TO 3024-EDIT-DL7-CONT.
 11592
 11593     IF DCUA-RETURN-CODE EQUAL 'E3'
 11594        MOVE ER-8098               TO WS-ERROR
 11595        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11597        GO TO 3024-EDIT-DL7-CONT.
 11598
 11599     IF DCUA-RETURN-CODE EQUAL 'C1'
 11600        MOVE ER-8099               TO WS-ERROR
 11601        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11603        GO TO 3024-EDIT-DL7-CONT.
 11604
 11605     IF DCUA-RETURN-CODE EQUAL 'U1'
 11606        MOVE ER-8109               TO WS-ERROR
 11607        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11608        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609        GO TO 3024-EDIT-DL7-CONT.
 11610
 11611     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 211
* EL050.cbl
 11612        MOVE ER-8112               TO WS-ERROR
 11613        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11615        GO TO 3024-EDIT-DL7-CONT.
 11616
 11617     IF DCUA-RETURN-CODE EQUAL 'N2'
 11618        MOVE ER-8113               TO WS-ERROR
 11619        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL7-CONT.
 11622
 11623     IF DCUA-RETURN-CODE EQUAL 'N3'
 11624        MOVE ER-8114               TO WS-ERROR
 11625        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11626        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11627        GO TO 3024-EDIT-DL7-CONT.
 11628
 11629     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11630     MOVE ER-8097                  TO WS-ERROR.
 11631     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11632     GO TO 3024-EDIT-DL7-CONT.
 11633
 11634 3024-EDIT-DL7-CONT.
 11635
 11636     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11637     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11638     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11639        NEXT SENTENCE
 11640     ELSE
 11641        MOVE ER-9263               TO WS-ERROR
 11642        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11643
 11644******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11645******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11646     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11647        NEXT SENTENCE
 11648     ELSE
 11649        MOVE ER-8039               TO WS-ERROR
 11650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11651
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 212
* EL050.cbl
 11653****************************************************************
 11654*** VALIDATE STATE  : DLO022                                 ***
 11655****************************************************************
 11656     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11657     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11658
 11659     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11660     IF DVSC-SUCCESSFUL-EDIT
 11661        GO TO 3024-EDIT-DL22-CONT.
 11662
 11663     IF DVSC-RETURN-CODE EQUAL '01'
 11664        MOVE ER-8300               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666        GO TO 3024-EDIT-DL22-CONT.
 11667
 11668     IF DVSC-RETURN-CODE EQUAL '02'
 11669        MOVE ER-8301               TO WS-ERROR
 11670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11671        GO TO 3024-EDIT-DL22-CONT.
 11672
 11673     IF DVSC-RETURN-CODE EQUAL '03'
 11674        MOVE ER-8302               TO WS-ERROR
 11675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11676        GO TO 3024-EDIT-DL22-CONT.
 11677
 11678     IF DVSC-RETURN-CODE EQUAL 'N1'
 11679        MOVE ER-8304               TO WS-ERROR
 11680        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11681        GO TO 3024-EDIT-DL22-CONT.
 11682
 11683     MOVE ER-8303                  TO WS-ERROR
 11684     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11685
 11686 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 213
* EL050.cbl
 11688****************************************************************
 11689*** VALIDATE LOAN OFFICER : DLO021                           ***
 11690****************************************************************
 11691
 11692     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11693     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11694     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11695     IF DVLO-SUCCESSFUL-EDIT
 11696        GO TO 3024-EDIT-DL21-CONT.
 11697
 11698     IF DVLO-RETURN-CODE EQUAL '01'
 11699        MOVE ER-8081               TO WS-ERROR
 11700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701        GO TO 3024-EDIT-DL21-CONT.
 11702
 11703     IF DVLO-RETURN-CODE EQUAL '02'
 11704        MOVE ER-8082               TO WS-ERROR
 11705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11706        GO TO 3024-EDIT-DL21-CONT.
 11707
 11708     IF DVLO-RETURN-CODE EQUAL '03'
 11709        MOVE ER-8083               TO WS-ERROR
 11710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11711        GO TO 3024-EDIT-DL21-CONT.
 11712
 11713     IF DVLO-RETURN-CODE EQUAL '04'
 11714        MOVE ER-8084               TO WS-ERROR
 11715        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11716        GO TO 3024-EDIT-DL21-CONT.
 11717
 11718     IF DVLO-RETURN-CODE EQUAL '05'
 11719        MOVE ER-8085               TO WS-ERROR
 11720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11721        GO TO 3024-EDIT-DL21-CONT.
 11722
 11723     MOVE ER-7825                  TO WS-ERROR
 11724     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11725     GO TO 3024-EDIT-DL21-CONT.
 11726
 11727 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 214
* EL050.cbl
 11729
 11730****************************************************************
 11731*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11732****************************************************************
 11733
 11734     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11735     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11736     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11737     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11738     IF DIPF-SUCCESSFUL-EDIT
 11739        GO TO 3024-EDIT-DL02-CONT.
 11740
 11741     IF DIPF-RETURN-CODE EQUAL '01'
 11742        MOVE ER-8086               TO WS-ERROR
 11743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744        GO TO 3024-EDIT-DL02-CONT.
 11745
 11746     IF DIPF-RETURN-CODE EQUAL '02'
 11747        MOVE ER-8087               TO WS-ERROR
 11748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749        GO TO 3024-EDIT-DL02-CONT.
 11750
 11751     IF DIPF-RETURN-CODE EQUAL '03'
 11752        MOVE ER-8088               TO WS-ERROR
 11753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754        GO TO 3024-EDIT-DL02-CONT.
 11755
 11756     MOVE ER-8095                  TO WS-ERROR
 11757     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11758     GO TO 3024-EDIT-DL02-CONT.
 11759
 11760 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 215
* EL050.cbl
 11762
 11763****************************************************************
 11764*** VALIDATE BANK ID : DLO003                                ***
 11765****************************************************************
 11766
 11767     MOVE WK-GREG-CENT           TO WCG-CENT.
 11768     MOVE WK-GREG-YYMM           TO WCG-REST.
 11769     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11770        MOVE ER-8040               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11772
 11773     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11774     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11775     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11776     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11777     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11778     IF DVBI-SUCCESSFUL-EDIT
 11779        GO TO 3024-EDIT-DL03-CONT.
 11780
 11781     IF DVBI-RETURN-CODE EQUAL '01'
 11782        MOVE ER-8089               TO WS-ERROR
 11783        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11784        GO TO 3024-EDIT-DL03-CONT.
 11785
 11786     IF DVBI-RETURN-CODE EQUAL '02'
 11787        MOVE ER-8090               TO WS-ERROR
 11788        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11789        GO TO 3024-EDIT-DL03-CONT.
 11790
 11791     IF DVBI-RETURN-CODE EQUAL '03'
 11792        MOVE ER-8091               TO WS-ERROR
 11793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11794        GO TO 3024-EDIT-DL03-CONT.
 11795
 11796     IF DVBI-RETURN-CODE EQUAL '04'
 11797        MOVE ER-8092               TO WS-ERROR
 11798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799        GO TO 3024-EDIT-DL03-CONT.
 11800
 11801     IF DVBI-RETURN-CODE EQUAL '05'
 11802        MOVE ER-8093               TO WS-ERROR
 11803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804        GO TO 3024-EDIT-DL03-CONT.
 11805
 11806     IF DVBI-RETURN-CODE EQUAL '06'
 11807        MOVE ER-8094               TO WS-ERROR
 11808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11809        GO TO 3024-EDIT-DL03-CONT.
 11810
 11811     MOVE ER-8096                  TO WS-ERROR
 11812     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11813     GO TO 3024-EDIT-DL03-CONT.
 11814
 11815 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 216
* EL050.cbl
 11817
 11818     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11819        NEXT SENTENCE
 11820     ELSE
 11821        MOVE ER-8042               TO WS-ERROR
 11822        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11823
 11824     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11825     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11826     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11827
 11828     IF DMPF-RETURN-CODE = '01'
 11829        MOVE ER-8067               TO WS-ERROR
 11830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831        GO TO 3024-EDIT-DL01-CONT.
 11832
 11833     IF DMPF-RETURN-CODE = '02'
 11834        MOVE ER-8068               TO WS-ERROR
 11835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11836        GO TO 3024-EDIT-DL01-CONT.
 11837
 11838     IF DMPF-RETURN-CODE = '03'
 11839        MOVE ER-8069               TO WS-ERROR
 11840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11841        GO TO 3024-EDIT-DL01-CONT.
 11842
 11843     IF DMPF-RETURN-CODE = 'E1'
 11844        MOVE ER-8070               TO WS-ERROR
 11845        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11846        GO TO 3024-EDIT-DL01-CONT.
 11847
 11848     IF DMPF-RETURN-CODE = 'N1'
 11849        MOVE ER-8071               TO WS-ERROR
 11850        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11851        GO TO 3024-EDIT-DL01-CONT.
 11852
 11853     IF DMPF-RETURN-CODE NOT = 'OK'
 11854        MOVE ER-8072               TO WS-ERROR
 11855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11856
 11857 3024-EDIT-DL01-CONT.
 11858******************************************************************
 11859***  VALIDATES RATE CODES : DLO017                             ***
 11860******************************************************************
 11861
 11862      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11863      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11864      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11865      IF DVRC-SUCCESSFUL-EDIT
 11866        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11867        GO TO 3024-CHECK-VALID-RATE.
 11868
 11869      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11870
 11871      IF DVRC-RETURN-CODE EQUAL '01'
 11872         MOVE ER-7817                   TO WS-ERROR
 11873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11874         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 217
* EL050.cbl
 11875
 11876      IF DVRC-RETURN-CODE EQUAL '02'
 11877         MOVE ER-7818                   TO WS-ERROR
 11878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11879         GO TO 3025-EDIT-REINSURANCE.
 11880
 11881      IF DVRC-RETURN-CODE EQUAL '03'
 11882         MOVE ER-7819                   TO WS-ERROR
 11883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11884         GO TO 3025-EDIT-REINSURANCE.
 11885
 11886       MOVE ER-7820                     TO WS-ERROR.
 11887       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11888       GO TO 3025-EDIT-REINSURANCE.
 11889
 11890******************************************************************
 11891***  GET PREMIUM RATES : DLO011                                ***
 11892******************************************************************
 11893
 11894 3024-CHECK-VALID-RATE.
 11895
 11896     IF VALID-RATE-CODE
 11897        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11898        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11899        MOVE SPACES                TO DPRB-RETURN-CODE
 11900        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11901     ELSE
 11902         GO TO 3025-EDIT-REINSURANCE.
 11903
 11904      IF DPRB-SUCCESSFUL-PROCESS
 11905         IF PB-VALID-LIFE
 11906             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11907             GO TO 3025-EDIT-REINSURANCE
 11908         ELSE
 11909             IF PB-VALID-AH
 11910                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11911                 GO TO 3025-EDIT-REINSURANCE.
 11912
 11913      IF DPRB-RETURN-CODE EQUAL '01'
 11914         MOVE ER-7812                   TO WS-ERROR
 11915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11916         GO TO 3025-EDIT-REINSURANCE.
 11917
 11918      IF DPRB-RETURN-CODE EQUAL '02'
 11919         MOVE ER-7813                   TO WS-ERROR
 11920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11921         GO TO 3025-EDIT-REINSURANCE.
 11922
 11923      IF DPRB-RETURN-CODE EQUAL '03'
 11924         MOVE ER-7814                   TO WS-ERROR
 11925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11926         GO TO 3025-EDIT-REINSURANCE.
 11927
 11928      IF DPRB-RETURN-CODE EQUAL '04'
 11929         IF NOT DPRB-1ST-TIME
 11930            MOVE ER-7815                   TO WS-ERROR
 11931            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11932            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 218
* EL050.cbl
 11933          ELSE
 11934         IF PB-VALID-LIFE
 11935            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11936          ELSE
 11937            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11938         END-IF
 11939         MOVE SPACES                TO DOCC-RETURN-CODE
 11940         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11941         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11942         IF DOCC-RETURN-CODE = 'OK'
 11943             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11944             GO TO 3024-CHECK-VALID-RATE
 11945           ELSE
 11946             MOVE ER-7823               TO WS-ERROR
 11947             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11948             GO TO 3025-EDIT-REINSURANCE.
 11949
 11950       MOVE ER-7816                     TO WS-ERROR.
 11951       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11952       GO TO 3025-EDIT-REINSURANCE.
 11953
 11954**********   DMD CUSTOM CODE ABOVE    **********
 11955
 11956 3025-EDIT-REINSURANCE.
 11957     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11958         GO TO 3027-EDIT-CONTINUE.
 11959
 11960     MOVE LOW-VALUES               TO ERREIN-KEY.
 11961     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11962     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11963                                      REIN-CODE-2
 11964                                      REIN-CODE-3.
 11965     MOVE 'A'                      TO REIN-TYPE.
 11966
 11967     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11968
 11969     MOVE '3026' TO REIN-SW.
 11970     MOVE ' '                   TO WS-REIN-READ-SW.
 11971
 11972     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11973     IF REIN-TABLE-NOT-FOUND
 11974         GO TO 3026-NO-SPEC-TABLE.
 11975
 11976     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11977     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11978                                   WS-NSP-ST-CD-LF.
 11979     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11980                                   WS-NSP-ST-CD-AH.
 11981
 11982     GO TO 3040-EDIT-CONTINUE.
 11983
 11984 3026-NO-SPEC-TABLE.
 11985
 11986     MOVE ER-2664                TO WS-ERROR.
 11987     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11988     GO TO 3040-EDIT-CONTINUE.
 11989
 11990 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 219
* EL050.cbl
 11991
 11992     IF PB-I-REIN-TABLE = SPACES
 11993       GO TO 3040-EDIT-CONTINUE.
 11994
 11995     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11996          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11997          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11998           GO TO 3040-EDIT-CONTINUE.
 11999
 12000     MOVE LOW-VALUES            TO ERREIN-KEY.
 12001     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12002     MOVE 'A'                   TO REIN-TYPE.
 12003     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12004
 12005     MOVE '3028'                TO REIN-SW.
 12006     MOVE ' '                   TO WS-REIN-READ-SW.
 12007
 12008     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12009     IF REIN-TABLE-NOT-FOUND
 12010         GO TO 3028-NO-REIN-TABLE.
 12011
 12012     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12013     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12014                                   WS-NSP-ST-CD-LF.
 12015     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12016                                   WS-NSP-ST-CD-AH.
 12017
 12018     GO TO 3040-EDIT-CONTINUE.
 12019
 12020 3028-NO-REIN-TABLE.
 12021
 12022     MOVE ER-2615                TO WS-ERROR.
 12023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12024     GO TO 3040-EDIT-CONTINUE.
 12025
 12026 3040-EDIT-CONTINUE.
 12027
 12028     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12029         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12030
 12031     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12032         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12033
 12034     IF (NOT PB-REISSUED-CERT)
 12035        AND (NOT PB-MONTHLY-CERT)
 12036        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12037            MOVE '001'           TO PB-I-LF-TERM
 12038            MOVE 'M'             TO PB-I-INSURED-SEX.
 12039
 12040     IF (NOT PB-REISSUED-CERT)
 12041        AND (NOT PB-MONTHLY-CERT)
 12042        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12043            MOVE '001'           TO PB-I-AH-TERM
 12044            MOVE 'M'             TO PB-I-INSURED-SEX.
 12045
 12046 3040-EDIT-1ST-PMT-DT.
 12047     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12048     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 220
* EL050.cbl
 12049         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12050
 12051******************************************************************
 12052*                                                                *
 12053*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12054*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12055*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12056*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12057*                                                                *
 12058******************************************************************
 12059
 12060     IF PB-EFF-DT-PROCESSING
 12061        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12062                                    PB-I-LF-EXPIRE-DT
 12063                                    PB-I-AH-EXPIRE-DT
 12064        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12065        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12066        MOVE ZERO                TO DC-ELAPSED-DAYS
 12067        MOVE +1                  TO DC-ELAPSED-MONTHS
 12068        SET BIN-PLUS-ELAPSED     TO TRUE
 12069*       MOVE 6                   TO DC-OPTION-CODE
 12070        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12071        IF NO-CONVERSION-ERROR
 12072           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12073
 12074******************************************************************
 12075*                                                                *
 12076*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12077*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12078*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12079*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12080*                                                                *
 12081******************************************************************
 12082
 12083     IF PB-EXT-DAYS-PROCESSING
 12084          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12085                                         PB-I-LF-EXPIRE-DT
 12086                                         PB-I-AH-EXPIRE-DT
 12087          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12088          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12089          MOVE +1                     TO DC-ELAPSED-MONTHS
 12090          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12091          SET BIN-PLUS-ELAPSED        TO TRUE
 12092*         MOVE 6                      TO DC-OPTION-CODE
 12093          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12094          IF NO-CONVERSION-ERROR
 12095             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12096
 12097******************************************************************
 12098*                                                                *
 12099*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12100*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12101*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12102*        (EXPIRE DATE - (TERM -1))  *  -1.
 12103*                                                                *
 12104******************************************************************
 12105
 12106     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 221
* EL050.cbl
 12107        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12108           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12109              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12110              MOVE PB-I-AH-TERM      TO WS-TERM
 12111           ELSE
 12112              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12113              MOVE PB-I-LF-TERM      TO WS-TERM
 12114        ELSE
 12115           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12116              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12117              MOVE PB-I-LF-TERM      TO WS-TERM
 12118           ELSE
 12119              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12120              MOVE PB-I-AH-TERM      TO WS-TERM.
 12121
 12122     IF PB-EXPIRE-DT-PROCESSING
 12123        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12124        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12125        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12126        MOVE ZERO                TO DC-ELAPSED-DAYS
 12127                                    DC-ODD-DAYS-OVER
 12128          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12129          SET BIN-PLUS-ELAPSED    TO TRUE
 12130*         MOVE 6                  TO DC-OPTION-CODE
 12131          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12132          IF NO-CONVERSION-ERROR
 12133             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12134
 12135******************************************************************
 12136*                                                                *
 12137*            1ST PAYMENT DATE PROCESSING                         *
 12138*                                                                *
 12139******************************************************************
 12140
 12141     IF PB-1ST-PMT-DT-PROCESSING
 12142        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12143                                    PB-I-AH-EXPIRE-DT
 12144        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12145
 12146     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12147         NEXT SENTENCE
 12148     ELSE
 12149         MOVE ER-2680                 TO WS-ERROR
 12150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12151         GO TO 3060-ORIG-TERM-CHECK.
 12152
 12153     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12154     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12155     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12156*    MOVE 1                      TO DC-OPTION-CODE.
 12157     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12158                                    DC-ELAPSED-DAYS
 12159                                    DC-ODD-DAYS-OVER.
 12160
 12161     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12162
 12163     IF DATE-CONVERSION-ERROR
 12164        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 222
* EL050.cbl
 12165
 12166     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12167     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12168        AND (WS-LF-COVERAGE-TYPE = 'L')
 12169        IF (DC-ELAPSED-MONTHS > 1)
 12170                      OR
 12171           ((DC-ELAPSED-MONTHS = 1)
 12172           AND (DC-ODD-DAYS-OVER > 0))
 12173           MOVE ER-2882          TO WS-ERROR
 12174           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12175        END-IF
 12176     END-IF
 12177     if dc-elapsed-months > 0
 12178        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12179        + dc-odd-days-over
 12180     end-if
 12181     IF PB-EXT-DAYS-PROCESSING
 12182        CONTINUE
 12183     ELSE
 12184        IF DC-ELAPSED-MONTHS = +0
 12185           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12186        ELSE
 12187           IF (WS-LF-EARNINGS-CALC = '4')
 12188              AND (DC-ELAPSED-MONTHS > ZERO)
 12189              AND (DC-ELAPSED-DAYS > ZERO)
 12190              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12191           ELSE
 12192              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12193                                 THRU 6499-EXIT
 12194              MOVE WS-ODD-DAYS-OVER
 12195                                 TO PB-I-EXTENTION-DAYS
 12196           END-IF
 12197        END-IF
 12198     END-IF
 12199******************************************************************
 12200*                                                                *
 12201*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12202*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12203*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12204*            AND ANY ODD DAYS.                                   *
 12205*                                                                *
 12206******************************************************************
 12207
 12208     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12209                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12210     IF WS-LF-EARNINGS-CALC NOT = '4'
 12211        IF DC-ELAPSED-DAYS > ZEROS
 12212           MOVE ER-2681          TO WS-ERROR
 12213           PERFORM 9900-ERROR-FORMAT
 12214                                 THRU 9900-EXIT
 12215        END-IF
 12216     END-IF
 12217
 12218     IF WS-LF-EARNINGS-CALC NOT = '4'
 12219        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12220           MOVE ER-2681          TO WS-ERROR
 12221           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12222
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 223
* EL050.cbl
 12223     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12224        (PB-I-LF-TERM NOT = ZERO) AND
 12225         NOT NO-LIFE-COVERAGE
 12226          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12227          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12228          IF WS-LF-EARNINGS-CALC = '4'
 12229             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12230             PB-I-PAY-FREQUENCY
 12231          END-IF
 12232          MOVE ZERO              TO DC-ELAPSED-DAYS
 12233                                    DC-ODD-DAYS-OVER
 12234          MOVE 1                 TO DC-END-OF-MONTH
 12235          SET BIN-PLUS-ELAPSED        TO TRUE
 12236*         MOVE 6                 TO DC-OPTION-CODE
 12237          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12238          IF NO-CONVERSION-ERROR
 12239             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12240             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12241                (WS-LF-SPECIAL-CALC-CD = 'L')
 12242                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12243                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12244                  MOVE +1             TO DC-ELAPSED-MONTHS
 12245                  SET BIN-PLUS-ELAPSED  TO TRUE
 12246*                 MOVE 6              TO DC-OPTION-CODE
 12247                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12248                  IF NO-CONVERSION-ERROR
 12249                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12250
 12251* okay, i had to move the new att age edit down here because the
 12252* expiration date could get recalculated and i need the exp date
 12253     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12254        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12255        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12256        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12257           AND ZEROS
 12258           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12259           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12260           SET ELAPSED-BETWEEN-BIN TO TRUE
 12261           PERFORM 8500-DATE-CONVERT
 12262                                 THRU 8500-EXIT
 12263           IF NO-CONVERSION-ERROR
 12264              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12265                 MOVE ER-2669       TO WS-ERROR
 12266*                PERFORM 9900-ERROR-FORMAT
 12267*                                THRU 9900-EXIT
 12268              END-IF
 12269           END-IF
 12270        ELSE
 12271           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12272           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12273              MOVE ER-2669       TO WS-ERROR
 12274*             PERFORM 9900-ERROR-FORMAT
 12275*                                THRU 9900-EXIT
 12276           ELSE
 12277              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12278                 MOVE ER-1570    TO WS-ERROR
 12279                 PERFORM 9900-ERROR-FORMAT
 12280                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 224
* EL050.cbl
 12281              END-IF
 12282           END-IF
 12283        END-IF
 12284        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12285           AND ZEROS
 12286           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12287           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12288           SET ELAPSED-BETWEEN-BIN TO TRUE
 12289           PERFORM 8500-DATE-CONVERT
 12290                                 THRU 8500-EXIT
 12291           IF NO-CONVERSION-ERROR
 12292              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12293                 MOVE ER-2669       TO WS-ERROR
 12294*                PERFORM 9900-ERROR-FORMAT
 12295*                                THRU 9900-EXIT
 12296              END-IF
 12297           END-IF
 12298        ELSE
 12299           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12300             (PB-I-LF-TERM / 12)
 12301           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12302              MOVE ER-2669       TO WS-ERROR
 12303*             PERFORM 9900-ERROR-FORMAT
 12304*                                THRU 9900-EXIT
 12305           ELSE
 12306              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12307                 MOVE ER-1571    TO WS-ERROR
 12308                 PERFORM 9900-ERROR-FORMAT
 12309                                 THRU 9900-EXIT
 12310              END-IF
 12311           END-IF
 12312        END-IF
 12313        IF WS-ERROR = ER-2669
 12314           PERFORM 9900-ERROR-FORMAT
 12315                                 THRU 9900-EXIT
 12316        END-IF
 12317     END-IF
 12318     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12319        (PB-I-AH-TERM NOT = ZERO) AND
 12320         NOT NO-AH-COVERAGE
 12321          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12322             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12323             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12324             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12325          ELSE
 12326             IF WS-LF-EARNINGS-CALC = '4'
 12327                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12328                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12329                PB-I-PAY-FREQUENCY
 12330             ELSE
 12331                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12332                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12333             END-IF
 12334          END-IF
 12335          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12336                                         DC-ODD-DAYS-OVER
 12337          MOVE 1                      TO DC-END-OF-MONTH
 12338          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 225
* EL050.cbl
 12339*         MOVE 6                      TO DC-OPTION-CODE
 12340          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12341          IF NO-CONVERSION-ERROR
 12342             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12343     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12344        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12345        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12346        IF PB-I-BIRTHDAY > LOW-VALUES
 12347           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12348           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12349           SET ELAPSED-BETWEEN-BIN TO TRUE
 12350           PERFORM 8500-DATE-CONVERT
 12351                                 THRU 8500-EXIT
 12352           IF NO-CONVERSION-ERROR
 12353              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12354                 MOVE ER-3054       TO WS-ERROR
 12355*                PERFORM 9900-ERROR-FORMAT
 12356*                                THRU 9900-EXIT
 12357              END-IF
 12358           END-IF
 12359        ELSE
 12360           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12361           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12362              MOVE ER-3054       TO WS-ERROR
 12363*             PERFORM 9900-ERROR-FORMAT
 12364*                                THRU 9900-EXIT
 12365           END-IF
 12366        END-IF
 12367        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12368           AND ZEROS
 12369           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12370           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12371           SET ELAPSED-BETWEEN-BIN TO TRUE
 12372           PERFORM 8500-DATE-CONVERT
 12373                                 THRU 8500-EXIT
 12374           IF NO-CONVERSION-ERROR
 12375              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12376                 MOVE ER-3054       TO WS-ERROR
 12377*                PERFORM 9900-ERROR-FORMAT
 12378*                                THRU 9900-EXIT
 12379              END-IF
 12380           END-IF
 12381        ELSE
 12382           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12383             (PB-I-AH-TERM / 12)
 12384           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12385              MOVE ER-3054       TO WS-ERROR
 12386*             PERFORM 9900-ERROR-FORMAT
 12387*                                THRU 9900-EXIT
 12388           END-IF
 12389        END-IF
 12390        IF WS-ERROR = ER-3054
 12391           PERFORM 9900-ERROR-FORMAT
 12392                                 THRU 9900-EXIT
 12393        END-IF
 12394     END-IF
 12395     MOVE SPACE                       TO DC-END-OF-MONTH.
 12396
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 226
* EL050.cbl
 12397     IF PB-COMPANY-ID = 'NCB'
 12398        GO TO 3040-EDIT-EXTENSION-DAYS.
 12399
 12400     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12401       AND
 12402        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12403        NEXT SENTENCE
 12404     ELSE
 12405        GO TO 3040-EDIT-EXTENSION-DAYS.
 12406
 12407     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12408        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12409        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12410     ELSE
 12411        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12412        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12413
 12414     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12415*    MOVE '1'      TO DC-OPTION-CODE
 12416     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12417     IF (NO-CONVERSION-ERROR)
 12418        AND (DC-ELAPSED-MONTHS > +1)
 12419        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12420        MOVE ER-2668   TO WS-ERROR
 12421        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12422
 12423 3040-EDIT-EXTENSION-DAYS.
 12424
 12425     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12426        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12427         GO TO 3050-EDIT-TERM-IN-DAYS
 12428     ELSE
 12429         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12430
 12431     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12432         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12433     ELSE
 12434        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12435           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12436           MOVE ER-2681         TO WS-ERROR
 12437           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12438
 12439     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12440        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12441        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12442         GO TO 3060-ORIG-TERM-CHECK.
 12443
 12444     GO TO 3060-ORIG-TERM-CHECK.
 12445
 12446 3050-EDIT-TERM-IN-DAYS.
 12447
 12448     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12449
 12450     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12451         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12452     ELSE
 12453         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12454            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 227
* EL050.cbl
 12455            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12456
 12457     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12458                                       REMAINDER WS-WORK-TERM.
 12459     IF WS-WORK-TERM GREATER THAN ZERO
 12460         ADD +1 TO PB-I-LF-TERM.
 12461
 12462     IF NOT NO-AH-COVERAGE
 12463         MOVE ER-2684            TO WS-ERROR
 12464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12465
 12466
 12467 3060-ORIG-TERM-CHECK.
 12468
 12469******************************************************************
 12470*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12471******************************************************************
 12472
 12473     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12474        NEXT SENTENCE
 12475     ELSE
 12476        IF NOT NO-LIFE-COVERAGE
 12477           IF PB-I-LF-TERM NUMERIC
 12478              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12479              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12480              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12481                  NEXT SENTENCE
 12482           ELSE
 12483              MOVE ER-2647       TO WS-ERROR
 12484              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12485
 12486     IF NOT NO-AH-COVERAGE
 12487         IF PB-I-AH-TERM NUMERIC
 12488            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12489            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12490            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12491             NEXT SENTENCE
 12492          ELSE
 12493              MOVE ER-2658       TO WS-ERROR
 12494              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12495
 12496     IF PB-COMPANY-ID = 'NCB'
 12497        GO TO 3070-LOAN-TERM-CHECK.
 12498
 12499     IF POLICY-HAS-AH
 12500       AND
 12501        POLICY-HAS-LIFE
 12502       AND
 12503        PB-I-LF-TERM NUMERIC
 12504       AND
 12505        PB-I-AH-TERM NUMERIC
 12506        NEXT SENTENCE
 12507     ELSE
 12508        GO TO 3070-LOAN-TERM-CHECK.
 12509
 12510     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12511     IF WS-TEX-FACT-2 LESS THAN +0
 12512        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 228
* EL050.cbl
 12513
 12514     IF WS-TEX-FACT-2 GREATER THAN +1
 12515        MOVE ER-2668             TO WS-ERROR
 12516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517
 12518 3070-LOAN-TERM-CHECK.
 12519
 12520     IF (WS-LF-BENEFIT-CD = ZERO)
 12521         OR (NO-LF-BENEFIT-MATCH)
 12522            GO TO 3125-EDIT-PMT-FREQ.
 12523*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12524*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12525*          AND 'V' AND 'W' AND 'X'
 12526*          GO TO 3125-EDIT-PMT-FREQ
 12527*       END-IF
 12528*    ELSE
 12529*       IF WS-AH-DCC-TRUNC = 'T'
 12530*          CONTINUE
 12531*       ELSE
 12532*          GO TO 3125-EDIT-PMT-FREQ
 12533*       END-IF
 12534*    END-IF
 12535     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12536                    OR
 12537        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12538        AND (WS-AH-DCC-TRUNC = 'T'))
 12539        CONTINUE
 12540     ELSE
 12541        GO TO 3125-EDIT-PMT-FREQ
 12542     END-IF
 12543     IF PB-I-LOAN-TERM NOT NUMERIC
 12544         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12545
 12546     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12547        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12548*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12549        PB-I-LOAN-TERM NOT GREATER THAN +360
 12550         NEXT SENTENCE
 12551     ELSE
 12552         MOVE ER-2648            TO WS-ERROR
 12553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12554
 12555     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12556        MOVE ER-3058             TO WS-ERROR
 12557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12558     end-if
 12559
 12560     IF WS-STATE-ABBREVIATION = 'NC'
 12561        IF PB-I-LOAN-TERM > +59
 12562           CONTINUE
 12563        ELSE
 12564           MOVE ER-2792          TO WS-ERROR
 12565           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12566        END-IF
 12567     END-IF
 12568
 12569     .
 12570 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 229
* EL050.cbl
 12571     IF (WS-LF-BENEFIT-CD = ZERO)
 12572         OR (NO-LF-BENEFIT-MATCH)
 12573            GO TO 3127-EDIT-LOAN-OFFICER.
 12574     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12575                    OR
 12576        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12577        AND (WS-AH-DCC-TRUNC = 'T'))
 12578                    OR
 12579         (PB-COMPANY-ID = 'AHL')
 12580        CONTINUE
 12581     ELSE
 12582        IF (PB-I-LOAN-TERM > ZEROS)
 12583           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12584           MOVE ER-1575          TO WS-ERROR
 12585           PERFORM 9900-ERROR-FORMAT
 12586                                 THRU 9900-EXIT
 12587        END-IF
 12588     END-IF
 12589     IF WS-LF-EARNINGS-CALC NOT = '4'
 12590         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12591            MOVE ER-2653         TO WS-ERROR
 12592            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593            GO TO 3127-EDIT-LOAN-OFFICER
 12594         ELSE
 12595            GO TO 3127-EDIT-LOAN-OFFICER.
 12596
 12597     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12598         MOVE ER-2655            TO WS-ERROR
 12599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12600         GO TO 3127-EDIT-LOAN-OFFICER.
 12601
 12602     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12603         MOVE ER-2654            TO WS-ERROR
 12604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12605         GO TO 3127-EDIT-LOAN-OFFICER.
 12606
 12607     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12608         GIVING WS-TEX-FACT-2
 12609             REMAINDER WS-TEX-FACT-3.
 12610
 12611*    IF WS-TEX-FACT-3 NOT = ZERO
 12612*       MOVE ER-2654             TO WS-ERROR
 12613*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12614
 12615
 12616 3127-EDIT-LOAN-OFFICER.
 12617
 12618     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12619        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12620           MOVE ER-2690          TO WS-ERROR
 12621           PERFORM 9900-ERROR-FORMAT
 12622                                 THRU 9900-EXIT
 12623        ELSE
 12624           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12625           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12626           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12627           MOVE PB-SV-STATE      TO LOFC-STATE
 12628           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 230
* EL050.cbl
 12629           MOVE PB-I-LOAN-OFFICER
 12630                                 TO LOFC-CODE
 12631           PERFORM 8586-READ-LOAN-OFFICER
 12632                                 THRU 8586-EXIT
 12633           IF (NOT LOFC-MASTER-FOUND)
 12634              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12635              MOVE ER-3006       TO WS-ERROR
 12636              PERFORM 9900-ERROR-FORMAT
 12637                                 THRU 9900-EXIT
 12638           END-IF
 12639        END-IF
 12640     END-IF
 12641     .
 12642 3129-EDIT-APR.
 12643
 12644     IF (WS-LF-BENEFIT-CD = ZERO)
 12645        OR (NO-LF-BENEFIT-MATCH)
 12646        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12647           GO TO 3130-EDIT-AGE
 12648*       ELSE
 12649*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12650*             GO TO 3130-EDIT-AGE
 12651*          END-IF
 12652        END-IF
 12653     END-IF
 12654
 12655     IF (WS-STATE-ABBREVIATION = 'OH')
 12656         AND (PB-I-RATE-CLASS NOT = 'L ')
 12657         AND (PB-I-LF-TERM GREATER THAN 60)
 12658         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12659         GO TO 3129-APR-CONT.
 12660
 12661     IF (WS-STATE-ABBREVIATION = 'RI')
 12662         AND (PB-I-LF-TERM GREATER THAN 60)
 12663         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12664         GO TO 3129-APR-CONT.
 12665
 12666     IF (WS-STATE-ABBREVIATION = 'UT')
 12667         AND (PB-I-LF-TERM GREATER THAN 62)
 12668         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12669         AND (PB-CERT-EFF-DT LESS WS-830901)
 12670         GO TO 3129-APR-CONT.
 12671
 12672     IF PB-COMPANY-ID = 'LAP'
 12673        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12674           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12675              MOVE ER-2656         TO WS-ERROR
 12676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12677              GO TO 3130-EDIT-AGE.
 12678
 12679     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12680        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12681        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12682        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12683        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12684        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12685         GO TO 3130-EDIT-AGE.
 12686
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 231
* EL050.cbl
 12687 3129-APR-CONT.
 12688     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12689         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12690         GO TO 3130-EDIT-AGE.
 12691
 12692     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12693         WS-AH-BENEFIT-CD (1:1) = 'S')
 12694        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12695        AND (PB-I-LOAN-APR = ZERO)
 12696        MOVE ER-2657             TO WS-ERROR
 12697        PERFORM 9900-ERROR-FORMAT
 12698                                 THRU 9900-EXIT
 12699        GO TO 3130-EDIT-AGE
 12700     END-IF
 12701*    IF PB-I-LOAN-APR = ZERO
 12702*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12703*    END-IF
 12704
 12705     if pb-i-loan-apr = +99.9999
 12706        move er-2656             to ws-error
 12707        PERFORM 9900-ERROR-FORMAT
 12708                                 THRU 9900-EXIT
 12709        GO TO 3130-EDIT-AGE
 12710     end-if
 12711*    IF PB-I-LOAN-APR = ZERO
 12712*       MOVE ER-2656             TO WS-ERROR
 12713*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12714*       GO TO 3130-EDIT-AGE.
 12715
 12716*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12717     if pb-i-loan-apr not = +99.9999
 12718        IF PB-I-LOAN-APR > +30.000
 12719           MOVE ER-2657          TO WS-ERROR
 12720           PERFORM 9900-ERROR-FORMAT
 12721                                 THRU 9900-EXIT
 12722        end-if
 12723     end-if
 12724     .
 12725 3130-EDIT-AGE.
 12726
 12727******************************************************************
 12728*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12729******************************************************************
 12730
 12731     IF NOT NO-LIFE-COVERAGE
 12732        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12733           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12734               MOVE ER-2628             TO WS-ERROR
 12735               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12736
 12737     IF NOT NO-AH-COVERAGE
 12738        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12739           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12740               MOVE ER-2628         TO WS-ERROR
 12741               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12742
 12743 3133-SEX-CODE.
 12744     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 232
* EL050.cbl
 12745         IF WS-DEFAULT-SEX = 'M'
 12746             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12747          ELSE
 12748             IF WS-DEFAULT-SEX = 'F'
 12749             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12750
 12751     IF PB-I-INSURED-SEX = '1'
 12752         MOVE 'M' TO PB-I-INSURED-SEX.
 12753
 12754     IF PB-I-INSURED-SEX = '2'
 12755         MOVE 'F' TO PB-I-INSURED-SEX.
 12756
 12757 3134-SIG-SW-EDIT.
 12758     IF PB-I-SIG-SW = SPACE
 12759         MOVE 'N'                TO  PB-I-SIG-SW.
 12760
 12761     IF PB-COMPANY-ID = 'NCL'
 12762         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12763             NEXT SENTENCE
 12764         ELSE
 12765             MOVE ER-1923        TO  WS-ERROR
 12766             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12767     ELSE
 12768     IF PB-COMPANY-ID = 'CRI'
 12769         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12770             NEXT SENTENCE
 12771         ELSE
 12772             MOVE ER-2606        TO  WS-ERROR
 12773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12774     ELSE
 12775     IF PB-COMPANY-ID = 'TMS'
 12776         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12777             NEXT SENTENCE
 12778         ELSE
 12779             MOVE ER-2689        TO  WS-ERROR
 12780             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12781     ELSE
 12782         IF PB-I-SIG-SW = 'Y' OR 'N'
 12783             NEXT SENTENCE
 12784         ELSE
 12785             MOVE ER-2651        TO  WS-ERROR
 12786             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12787
 12788     IF PB-COMPANY-ID = 'FLA'
 12789         IF (WS-EDIT-AGE GREATER 54  OR
 12790             WS-AH-EDIT-AGE GREATER 54)  AND
 12791            PB-I-SIG-SW = 'N'
 12792            MOVE ER-2651         TO  WS-ERROR
 12793            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12794
 12795 3135-NAME-EDIT.
 12796
 12797     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12798        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12799        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12800           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12801                                 TO PB-I-JOINT-FIRST-NAME
 12802        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 233
* EL050.cbl
 12803     END-IF
 12804     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12805        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12806        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12807           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12808                                 TO PB-I-JOINT-LAST-NAME
 12809        END-PERFORM
 12810     END-IF
 12811     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12812        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12813        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12814           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12815                                 TO PB-I-INSURED-FIRST-NAME
 12816        END-PERFORM
 12817     END-IF
 12818     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12819        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12820        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12821           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12822                                 TO PB-I-INSURED-LAST-NAME
 12823        END-PERFORM
 12824     END-IF
 12825     IF PB-I-INSURED-LAST-NAME = SPACES
 12826       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12827       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12828           MOVE ER-2660    TO WS-ERROR
 12829           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12830
 12831 3136-EDIT-SEX.
 12832
 12833******************************************************************
 12834*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12835******************************************************************
 12836
 12837     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12838        (WS-AH-SPECIAL-CALC-CD = 'O')
 12839        NEXT SENTENCE
 12840     ELSE
 12841        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12842           NEXT SENTENCE
 12843        ELSE
 12844           MOVE ER-2629            TO WS-ERROR
 12845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12846
 12847 3137-EDIT-EFF-DATE.
 12848
 12849     IF PB-REISSUED-CERT       OR
 12850        PB-POLICY-IS-DECLINED  OR
 12851        PB-POLICY-IS-VOIDED
 12852         GO TO 3139-EDIT-COVERAGE-CODES.
 12853
 12854     MOVE SPACE                  TO WS-2671-SW
 12855                                    WS-2672-SW.
 12856
 12857     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12858         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12859             MOVE ER-2703        TO WS-ERROR
 12860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 234
* EL050.cbl
 12861             GO TO 3139-EDIT-COVERAGE-CODES.
 12862
 12863     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12864         GO TO 3139-EDIT-COVERAGE-CODES.
 12865
 12866     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12867     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12868*    MOVE '1'                    TO DC-OPTION-CODE.
 12869     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12870     MOVE +0                     TO DC-ELAPSED-MONTHS
 12871                                    DC-ELAPSED-DAYS.
 12872     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12873
 12874     IF DATE-CONVERSION-ERROR
 12875         GO TO 3139-EDIT-COVERAGE-CODES.
 12876
 12877     IF DC-ELAPSED-DAYS GREATER +180
 12878         MOVE ER-2672            TO WS-ERROR
 12879         MOVE 'Y'                TO WS-2672-SW
 12880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12881     END-IF
 12882
 12883     IF WS-ERROR = ER-2671  AND
 12884        PB-COMPANY-ID  = 'LBL'
 12885        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12886        MOVE SPACE               TO WS-2671-SW
 12887        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12888
 12889     IF PB-ISSUE-DATE-FORCED  AND
 12890      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12891         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12892         MOVE ER-2673            TO WS-ERROR
 12893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12894         MOVE SPACE              TO WS-2671-SW
 12895                                    WS-2672-SW.
 12896
 12897     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12898         IF PB-ISSUE-DATE-FORCED
 12899             MOVE ER-2600          TO  WS-ERROR
 12900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12901         ELSE
 12902             MOVE ER-2692          TO  WS-ERROR
 12903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12904
 12905
 12906 3139-EDIT-COVERAGE-CODES.
 12907
 12908     if pb-company-id not = 'AHL'
 12909        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12910           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12911           MOVE ER-2787          TO WS-ERROR
 12912           PERFORM 9900-ERROR-FORMAT
 12913                                 THRU 9900-EXIT
 12914        END-IF
 12915     end-if
 12916     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12917        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12918                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 235
* EL050.cbl
 12919           MOVE ER-2719          TO WS-ERROR
 12920           PERFORM 9900-ERROR-FORMAT
 12921                                 THRU 9900-EXIT
 12922        END-IF
 12923     END-IF
 12924
 12925     IF PB-POLICY-IS-DECLINED  OR
 12926        PB-POLICY-IS-VOIDED
 12927         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12928
 12929     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12930        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12931         MOVE ER-2630                TO WS-ERROR
 12932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12933
 12934     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12935        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12936        PB-I-LF-PREMIUM-AMT = ZERO
 12937         GO TO 3140-CHECK-AH-FOR-ZERO.
 12938
 12939     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12940        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12941        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12942         GO TO 3140-CHECK-AH-FOR-ZERO.
 12943
 12944     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12945        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12946        MOVE ER-2631             TO WS-ERROR
 12947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12948     END-IF
 12949
 12950
 12951******************************************************************
 12952*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12953******************************************************************
 12954
 12955     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12956        NEXT SENTENCE
 12957     ELSE
 12958        IF PB-I-LF-BENEFIT-AMT = ZERO
 12959           MOVE ER-2632             TO WS-ERROR
 12960           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12961
 12962
 12963******************************************************************
 12964*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12965******************************************************************
 12966
 12967     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12968        CONTINUE
 12969     ELSE
 12970        IF PB-I-LF-PREMIUM-AMT = ZERO
 12971           IF (NOT PB-COMP-LF-PREM)
 12972              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12973              and (ws-lf-ben-category not = 'C')
 12974              MOVE ER-2633       TO WS-ERROR
 12975              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12976           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 236
* EL050.cbl
 12977        END-IF
 12978     END-IF
 12979     .
 12980 3140-CHECK-AH-FOR-ZERO.
 12981
 12982     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12983        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12984        PB-I-AH-PREMIUM-AMT = ZERO
 12985         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12986
 12987     IF PB-COMPANY-ID = 'CSL'  AND
 12988        PB-I-AH-BENEFIT-CD = ZERO  AND
 12989        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12990        PB-I-AH-PREMIUM-AMT = ZERO
 12991         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12992
 12993     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12994        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12995        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12996         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12997
 12998     IF PB-I-AH-BENEFIT-CD = ZERO
 12999         MOVE ER-2634            TO WS-ERROR
 13000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13001
 13002******************************************************************
 13003*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13004******************************************************************
 13005
 13006     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13007        NEXT SENTENCE
 13008     ELSE
 13009        IF PB-I-AH-BENEFIT-AMT = ZERO
 13010           MOVE ER-2635             TO WS-ERROR
 13011           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13012
 13013******************************************************************
 13014*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13015******************************************************************
 13016
 13017     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13018        NEXT SENTENCE
 13019     ELSE
 13020        IF PB-I-AH-PREMIUM-AMT = ZERO
 13021            IF NOT PB-COMP-AH-PREM
 13022                MOVE ER-2636    TO WS-ERROR
 13023                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13024
 13025
 13026 3140-EDIT-MAX-AMT-SIZES.
 13027* CUSTOM CODE FOR CLIENT    'DMD'
 13028     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13029                                     WS-RES-MUNI-TAX
 13030                                     PB-I-STATE-TAX
 13031                                     PB-I-MUNI-TAX.
 13032
 13033     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13034
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 237
* EL050.cbl
 13035     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13036        GO TO 3150-RATE-OUTSTAND-BAL.
 13037
 13038     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13039        GO TO 3150-RATE-OUTSTAND-BAL.
 13040
 13041     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13042        GO TO 3150-RATE-OUTSTAND-BAL.
 13043
 13044     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13045                             OR 'RIC')
 13046        GO TO 3150-RATE-OUTSTAND-BAL.
 13047
 13048     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13049        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13050            GO TO 3150-RATE-OUTSTAND-BAL
 13051        ELSE
 13052           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13053               GO TO 3150-RATE-OUTSTAND-BAL.
 13054
 13055     IF NOT PB-NO-MONTHS-SKIPPED
 13056        GO TO 3150-RATE-OUTSTAND-BAL.
 13057
 13058     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13059        GO TO 3150-RATE-OUTSTAND-BAL.
 13060
 13061     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13062        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13063           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13064             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13065           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13066           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13067              MOVE ER-2693     TO WS-ERROR
 13068              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13069              GO TO 3150-RATE-OUTSTAND-BAL
 13070           ELSE
 13071              GO TO 3150-RATE-OUTSTAND-BAL.
 13072
 13073 3150-RATE-OUTSTAND-BAL.
 13074
 13075* DMD RATING TEST
 13076     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13077         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13078         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13079         MOVE ER-2687                 TO WS-ERROR
 13080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13081         MOVE 'B'                     TO PB-I-OB-FLAG
 13082         GO TO 3260-EDIT-CONTINUE.
 13083
 13084     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13085         IF  WS-ERROR    EQUAL    ER-2693
 13086             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13087                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13088                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13089                 MOVE  +0            TO  WS-ERROR.
 13090
 13091     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13092         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 238
* EL050.cbl
 13093             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13094                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13095                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13096                 MOVE  +0            TO  WS-ERROR.
 13097
 13098     IF PLAN-MASTER-AH-SW = 'Y'
 13099        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13100            IF  WS-ERROR    EQUAL    ER-2693
 13101              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13102                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13103                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13104                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13105                 MOVE  ER-1910           TO  WS-ERROR
 13106                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13107
 13108     IF PLAN-MASTER-AH-SW = 'Y'
 13109        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13110            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13111               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13112               MOVE  ER-1910           TO  WS-ERROR
 13113               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13114
 13115     IF PLAN-MASTER-AH-SW = 'Y'
 13116        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13117            IF  WS-ERROR    EQUAL    ER-2693
 13118                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13119                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13120                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13121                 MOVE  +0       TO  WS-ERROR.
 13122
 13123     IF WS-ERROR = ER-2693
 13124        IF PB-COMPANY-ID = 'JAL' AND
 13125           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13126           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13127           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13128
 13129     IF WS-ERROR = ER-2693
 13130        IF PB-COMPANY-ID = 'NCL'  AND
 13131           PB-I-AH-BENEFIT-CD = 'OA'
 13132           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13133           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13134
 13135     IF WS-ERROR = ER-2693
 13136        IF PB-COMPANY-ID = 'CNL' AND
 13137           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13138           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13139           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13140
 13141     IF WS-ERROR = ER-2693
 13142        IF PB-COMPANY-ID = 'HER'
 13143           IF WS-LEVEL
 13144              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13145              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13146
 13147     IF ((LF-BENEFIT-FOUND) AND
 13148         (NOT NO-LIFE-COVERAGE)  AND
 13149         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13150       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 239
* EL050.cbl
 13151             (NOT NO-AH-COVERAGE)    AND
 13152             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13153         NEXT SENTENCE
 13154     ELSE
 13155         GO TO 3215-EDIT-RATES.
 13156
 13157     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13158        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13159           MOVE ER-2674          TO WS-ERROR
 13160           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13161           GO TO 3215-EDIT-RATES.
 13162
 13163     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13164        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13165           MOVE ER-2674          TO WS-ERROR
 13166           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13167           GO TO 3215-EDIT-RATES.
 13168
 13169     MOVE 'B'                    TO PB-I-OB-FLAG.
 13170
 13171     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13172         NEXT SENTENCE
 13173     ELSE
 13174         IF NOT NO-LIFE-COVERAGE
 13175             IF WS-ACCT-LF-OB-RT = ZERO
 13176                MOVE ER-2641    TO WS-ERROR
 13177                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13178
 13179     IF PB-COMPANY-ID = 'CRI'
 13180       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13181         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13182         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13183         IF WS-ERROR = ER-2675
 13184            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13185            MOVE ER-2687              TO WS-ERROR
 13186            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13187         ELSE
 13188            MOVE ER-2687              TO WS-ERROR
 13189            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13190
 13191
 13192     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13193         NEXT SENTENCE
 13194     ELSE
 13195       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13196            NEXT SENTENCE
 13197       ELSE
 13198         IF NOT NO-AH-COVERAGE
 13199             IF WS-ACCT-AH-OB-RT = ZERO
 13200                MOVE ER-2642    TO WS-ERROR
 13201                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13202
 13203     IF PB-COMPANY-ID = 'CRI'
 13204       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13205         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13206         IF WS-ERROR = ER-2676
 13207            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13208            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 240
* EL050.cbl
 13209            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210         ELSE
 13211            MOVE ER-2687              TO WS-ERROR
 13212            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13213
 13214     IF PB-COMPANY-ID NOT = 'GIC'
 13215         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13216            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13217     ELSE
 13218         IF PB-I-LF-PREM-CALC = ZEROS
 13219             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13220                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13221
 13222     IF PB-COMPANY-ID NOT = 'GIC'
 13223         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13224            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13225     ELSE
 13226         IF PB-I-AH-PREM-CALC = ZEROS
 13227             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13228                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13229
 13230     MOVE ZEROS TO PB-I-MORT-CODE.
 13231
 13232     GO TO 3260-EDIT-CONTINUE.
 13233
 13234
 13235 3215-EDIT-RATES.
 13236     IF ACCOUNT-MAST-FOUND
 13237         NEXT SENTENCE
 13238     ELSE
 13239         GO TO 3999-END-EDIT.
 13240
 13241 3220-CHECK-LF-RATES.
 13242
 13243     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13244        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13245        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13246        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13247           AND (NOT WS-LF-CASH))
 13248                           OR
 13249           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13250           AND (NOT WS-AH-CASH)))
 13251                       AND
 13252           (PB-I-ENTRY-STATUS NOT = '5')
 13253           MOVE 'M'              TO PB-BATCH-ENTRY
 13254                                    PB-I-ENTRY-STATUS
 13255        END-IF
 13256     END-IF
 13257     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13258                                    PB-I-AH-PREM-CALC
 13259                                    PB-I-LF-ALT-PREM-CALC
 13260                                    PB-I-LF-ALT-RATE
 13261                                    PB-I-LF-REI-RATE
 13262                                    PB-I-LF-ALT-REI-RATE
 13263                                    PB-I-AH-REI-RATE
 13264                                    PB-I-TOT-FEES-CALC.
 13265
 13266     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 241
* EL050.cbl
 13267        NEXT SENTENCE
 13268     ELSE
 13269        MOVE ZEROS               TO PB-I-LF-RATE
 13270                                    PB-I-AH-RATE.
 13271
 13272     IF PB-I-TOT-FEES NOT NUMERIC
 13273        MOVE ZEROS               TO PB-I-TOT-FEES
 13274     END-IF
 13275     IF PB-I-LIVES NOT NUMERIC
 13276         MOVE ZERO               TO PB-I-LIVES.
 13277
 13278     IF PB-I-NUM-BILLED NOT NUMERIC
 13279         MOVE ZERO               TO PB-I-NUM-BILLED.
 13280
 13281     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13282        MOVE +0                  TO PB-I-LF-PREM-TAX
 13283     END-IF
 13284
 13285     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13286        MOVE +0                  TO PB-I-AH-PREM-TAX
 13287     END-IF
 13288
 13289     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13290        PB-I-PAY-FREQUENCY = ZEROS
 13291            MOVE 12 TO CP-PAY-FREQUENCY
 13292     ELSE
 13293            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13294
 13295     IF PB-I-STATE-TAX NOT NUMERIC
 13296         MOVE ZEROS               TO PB-I-STATE-TAX.
 13297
 13298     IF PB-I-MUNI-TAX NOT NUMERIC
 13299         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13300
 13301     MOVE SPACES                 TO CP-BEN-CATEGORY
 13302     IF PB-COMPANY-ID  = 'CSL'  AND
 13303        PB-I-LF-TERM NOT = ZERO
 13304        COMPUTE WS-PAYMENT-AMT =
 13305             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13306        COMPUTE WS-CSL-AMT1 =
 13307             PB-I-LF-TERM * AM-MAX-MON-BEN
 13308        COMPUTE WS-CSL-AMT2 =
 13309             WS-PAYMENT-AMT * PB-I-LF-TERM
 13310        IF CP-PAY-FREQUENCY NOT = 12
 13311           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13312           MOVE '8' TO WS-CSL-CALC-CD
 13313        ELSE
 13314           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13315              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13316               AM-MAX-TOT-BEN
 13317               MOVE '6' TO WS-CSL-CALC-CD
 13318           ELSE
 13319              IF (WS-CSL-AMT1  GREATER THAN
 13320                 AM-MAX-TOT-BEN) AND
 13321                 (WS-CSL-AMT2  GREATER THAN
 13322                 AM-MAX-TOT-BEN)
 13323                 MOVE '7' TO WS-CSL-CALC-CD
 13324              ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 242
* EL050.cbl
 13325                 MOVE '5' TO WS-CSL-CALC-CD.
 13326
 13327     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13328         NEXT SENTENCE
 13329     ELSE
 13330         GO TO 3300-CHECK-AH-RATES.
 13331
 13332*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13333
 13334     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13335        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13336              OR
 13337           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13338           MOVE ER-2618          TO WS-ERROR
 13339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13340           GO TO 3300-CHECK-AH-RATES.
 13341
 13342     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13343           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13344                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13345
 13346     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13347         MOVE ER-2687             TO WS-ERROR
 13348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13349         MOVE 'Z000'              TO PB-I-MORT-CODE
 13350         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13351         GO TO 3300-CHECK-AH-RATES.
 13352
 13353     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13354        IF PB-I-LIVES = ZERO
 13355           MOVE ER-2688          TO WS-ERROR
 13356           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13357
 13358     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13359
 13360     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13361     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13362     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13363     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13364     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13365     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13366     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13367     MOVE '3'                    TO CP-PROCESS-TYPE.
 13368     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13369     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13370
 13371******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13372     IF PB-COMPANY-ID EQUAL 'CDL'
 13373         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13374            CP-EARN-AS-NET-PAY)
 13375             IF PB-CERT-EFF-DT GREATER  WS-931231
 13376                 MOVE '1'        TO CP-EARNING-METHOD.
 13377*******
 13378
 13379     MOVE PB-SV-STATE            TO CP-STATE.
 13380     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13381     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13382     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 243
* EL050.cbl
 13383     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13384     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13385                                    CP-RATING-BENEFIT-AMT.
 13386     IF CP-STATE-STD-ABBRV = 'OR'
 13387         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13388                                         PB-I-LF-ALT-BENEFIT-AMT.
 13389     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13390     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13391     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13392     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13393     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13394     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13395     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13396     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13397     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13398                                    CP-REMAINING-TERM
 13399                                    CP-LOAN-TERM.
 13400
 13401     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13402         NEXT SENTENCE
 13403     ELSE
 13404         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13405             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13406                                           PB-I-LF-PREMIUM-AMT.
 13407
 13408     IF PB-COMPANY-ID EQUAL 'CSL'
 13409        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13410           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13411                                         PB-I-LF-PREMIUM-AMT.
 13412
 13413     IF PB-COMPANY-ID EQUAL 'NCB'
 13414         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13415            CP-EARN-AS-NET-PAY
 13416             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13417                 PB-I-LF-PREMIUM-AMT.
 13418
 13419     IF (CP-TRUNCATED-LIFE)
 13420        or ((pb-company-id = 'AHL')
 13421           and (pb-i-loan-term > pb-i-lf-term))
 13422        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13423
 13424     IF PB-COMPANY-ID EQUAL 'CRI'
 13425        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13426
 13427     IF CP-TERM-IS-DAYS
 13428         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13429     ELSE
 13430         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13431     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13432        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13433        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13434        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13435        IF WS-LF-BEN-CATEGORY = 'D'
 13436           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13437           MOVE PB-I-LIFE-COMMISSION
 13438                                 TO CP-DCC-ACT-COMM
 13439           MOVE WS-LF-BEN-CATEGORY
 13440                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 244
* EL050.cbl
 13441        END-IF
 13442        IF (CP-BENEFIT-CD (1:1) = 'P')
 13443           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13444           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13445           add pb-i-ah-premium-amt to cp-original-premium
 13446        END-IF
 13447     END-IF
 13448     IF PB-COMPANY-ID = 'CSL'
 13449         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13450         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13451         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13452
 13453     IF PB-COMPANY-ID = 'CSL'
 13454        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13455
 13456     IF (CP-SPECIAL-CALC-CD = 'H')
 13457        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13458         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13459                                    TO CP-ALTERNATE-BENEFIT
 13460         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13461     if (pb-company-id = 'CID')
 13462        and (ws-lf-earnings-calc = '4')
 13463        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13464        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13465        move pb-i-term-type      to cp-pmt-mode
 13466        move pb-i-no-of-payments to cp-no-of-pmts
 13467     end-if
 13468     move ws-net-only-state      to cp-net-only-state
 13469     IF (PB-COMPANY-ID = 'CID')
 13470        AND (WS-LF-EARNINGS-CALC = 'B')
 13471        AND (CP-STATE-STD-ABBRV = 'MN')
 13472        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13473                                 TO CP-ALTERNATE-BENEFIT
 13474        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13475     END-IF
 13476     IF (PB-COMPANY-ID = 'CID')
 13477        AND (WS-LF-EARNINGS-CALC = 'B')
 13478        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13479                                 TO CP-ALTERNATE-BENEFIT
 13480        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13481        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13482*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13483*         pb-i-lf-alt-premium-amt
 13484        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13485        IF WS-LF-BEN-CATEGORY = 'P'
 13486           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13487        ELSE
 13488           IF WS-LF-BEN-CATEGORY = 'I'
 13489              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13490           END-IF
 13491        END-IF
 13492     END-IF
 13493     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13494     MOVE 'R'                   TO CP-RATE-FILE.
 13495     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13496
 13497     IF CP-ERROR-RATE-NOT-FOUND
 13498        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 245
* EL050.cbl
 13499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13500        GO TO 3300-CHECK-AH-RATES.
 13501
 13502     IF PB-COMPANY-ID EQUAL 'CRI'
 13503        IF CP-ERROR-NO-LIMITS-CRI
 13504           IF NOT ACCOUNT-LIFE-CHECKED
 13505              MOVE ER-2607      TO WS-ERROR
 13506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13507
 13508******************************************************************
 13509*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13510*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13511******************************************************************
 13512
 13513* CALC LIFE AGE AT EXPIRATION.
 13514
 13515     COMPUTE WS-AGE-AT-EXPIRE =
 13516          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13517
 13518*    IF PB-STATE = 'CO' OR 'UT'
 13519*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13520*        MOVE 'F'            TO PB-FATAL-FLAG
 13521*        MOVE ER-2709        TO WS-ERROR
 13522*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13523*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13524
 13525*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13526*        MOVE 'X'            TO PB-FATAL-FLAG
 13527*        MOVE ER-2718        TO WS-ERROR
 13528*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13530
 13531* CALC A & H AGE AT EXPIRATION.
 13532
 13533     COMPUTE WS-AGE-AT-EXPIRE =
 13534          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13535
 13536*    IF PB-STATE = 'CO' OR 'UT'
 13537*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13538*        MOVE 'F'            TO PB-FATAL-FLAG
 13539*        MOVE ER-2709        TO WS-ERROR
 13540*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13541*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13542
 13543*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13544*        MOVE 'X'            TO PB-FATAL-FLAG
 13545*        MOVE ER-2718        TO WS-ERROR
 13546*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13547*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13548
 13549     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13550        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13551
 13552     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13553        and (not pb-monthly-cert)
 13554        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13555     end-if
 13556
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 246
* EL050.cbl
 13557     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13558        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13559
 13560     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13561         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13562         MOVE ER-2639        TO WS-ERROR
 13563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13564
 13565
 13566******************************************************************
 13567*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13568******************************************************************
 13569
 13570 PREMIUM-EDITING-IS-BYPASSED.
 13571     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13572        AND (CP-R-MAX-ATT-AGE > +0)
 13573        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13574        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13575           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13576           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13577           MOVE '1'              TO DC-OPTION-CODE
 13578           PERFORM 8500-DATE-CONVERT
 13579                                 THRU 8500-EXIT
 13580           IF NO-CONVERSION-ERROR
 13581              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13582                 MOVE ER-2661       TO WS-ERROR
 13583*                PERFORM 9900-ERROR-FORMAT
 13584*                                THRU 9900-EXIT
 13585              END-IF
 13586           END-IF
 13587        ELSE
 13588           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13589           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13590              MOVE ER-2661       TO WS-ERROR
 13591*             PERFORM 9900-ERROR-FORMAT
 13592*                                THRU 9900-EXIT
 13593           ELSE
 13594              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13595                 MOVE ER-1570    TO WS-ERROR
 13596                 PERFORM 9900-ERROR-FORMAT
 13597                                 THRU 9900-EXIT
 13598              END-IF
 13599           END-IF
 13600        END-IF
 13601        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13602           MOVE PB-I-JOINT-BIRTHDAY
 13603                                 TO DC-BIN-DATE-1
 13604           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13605           MOVE '1'              TO DC-OPTION-CODE
 13606           PERFORM 8500-DATE-CONVERT
 13607                                 THRU 8500-EXIT
 13608           IF NO-CONVERSION-ERROR
 13609              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13610                 MOVE ER-2661       TO WS-ERROR
 13611*                PERFORM 9900-ERROR-FORMAT
 13612*                                THRU 9900-EXIT
 13613              END-IF
 13614           ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 247
* EL050.cbl
 13615              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13616           END-IF
 13617        ELSE
 13618           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13619             (PB-I-LF-TERM / 12)
 13620           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13621              MOVE ER-2661       TO WS-ERROR
 13622*             PERFORM 9900-ERROR-FORMAT
 13623*                                THRU 9900-EXIT
 13624           ELSE
 13625              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13626                 MOVE ER-1571    TO WS-ERROR
 13627                 PERFORM 9900-ERROR-FORMAT
 13628                                 THRU 9900-EXIT
 13629              END-IF
 13630           END-IF
 13631        END-IF
 13632        IF WS-ERROR = ER-2661
 13633           PERFORM 9900-ERROR-FORMAT
 13634                                 THRU 9900-EXIT
 13635        END-IF
 13636     END-IF
 13637*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13638*       MOVE ER-2661             TO WS-ERROR
 13639*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13640
 13641     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13642        MOVE ER-2662             TO WS-ERROR
 13643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13644
 13645     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13646        MOVE ER-2677             TO WS-ERROR
 13647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13648
 13649     IF CP-ERROR-LOAN-TERM
 13650        MOVE ER-2648             TO WS-ERROR
 13651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13652
 13653 3221-CHECK-ERROR-RATE-OPEN.
 13654
 13655     IF CP-ERROR-RATE-FILE-NOTOPEN
 13656         GO TO 3990-FILES-NOT-OPEN.
 13657
 13658     IF PB-COMPANY-ID NOT = 'DMD'
 13659        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13660     END-IF
 13661     .
 13662 3221-CONTINUE.
 13663     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13664                                    WS-DCC-AH-RATE
 13665     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13666        IF WS-LF-BEN-CATEGORY = 'D'
 13667           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13668              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13669        END-IF
 13670     END-IF
 13671     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13672*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 248
* EL050.cbl
 13673     IF (PB-COMPANY-ID = 'CID')
 13674        AND (WS-LF-EARNINGS-CALC = 'B')
 13675        AND (CP-STATE-STD-ABBRV = 'MN')
 13676        AND (PB-CERT-EFF-DT > X'A4FF')
 13677        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13678     END-IF
 13679     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13680
 13681     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13682     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13683        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13684        AND (PB-I-POLICY-IS-MONTHLY)
 13685        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13686        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13687     END-IF
 13688     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13689     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13690     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13691     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13692     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13693        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13694        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13695        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13696        MOVE ER-2786             TO WS-ERROR
 13697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13698     END-IF
 13699
 13700     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13701
 13702******************************************************************
 13703*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13704******************************************************************
 13705     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13706        and ((not pb-monthly-cert)
 13707        or (ws-lf-ben-category = 'C'))
 13708        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13709
 13710     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13711        GO TO 3225-CHECK-ALT-LIFE-RATE
 13712     ELSE
 13713       IF PB-I-LF-RATE = ZERO
 13714          MOVE ER-2641          TO WS-ERROR
 13715          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13716
 13717 3225-CHECK-ALT-LIFE-RATE.
 13718
 13719     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13720        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13721        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13722         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13723
 13724     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13725         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13726             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13727                   OR
 13728              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13729              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13730              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 249
* EL050.cbl
 13731             MOVE ER-2720        TO  WS-ERROR
 13732             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13733             GO TO 3225-RATING-CONT
 13734         ELSE
 13735             GO TO 3225-RATING-CONT.
 13736     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13737        AND (AM-GPCD = 01 OR 06 OR 15)
 13738        MOVE ER-2798             TO WS-ERROR
 13739        PERFORM 9900-ERROR-FORMAT
 13740                                 THRU 9900-EXIT
 13741*       GO TO 3225-RATING-CONT
 13742     END-IF
 13743     if (pb-company-id = 'CID')
 13744        and (ws-lf-earnings-calc = 'B')
 13745        and (ws-lf-ben-category = 'P' or 'I')
 13746        and (ws-net-only-state = 'Y')
 13747        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13748        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13749        go to 3225-rating-cont
 13750     end-if
 13751     IF (PB-COMPANY-ID = 'CID')
 13752        AND (WS-LF-EARNINGS-CALC = 'B')
 13753        AND (CP-STATE-STD-ABBRV = 'MN')
 13754        AND (PB-CERT-EFF-DT > X'A4FF')
 13755        GO TO 3225-RATING-CONT
 13756     END-IF
 13757     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13758        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13759           AND (PB-I-POLICY-IS-MONTHLY)
 13760           GO TO 3225-RATING-CONT
 13761        END-IF
 13762     END-IF
 13763
 13764     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13765        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13766        CP-EARN-AS-REG-BALLOON
 13767        NEXT SENTENCE
 13768     ELSE
 13769        MOVE '2'                 TO CP-EARNING-METHOD.
 13770
 13771 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13772
 13773     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13774
 13775     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13776        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13777        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13778         NEXT SENTENCE
 13779     ELSE
 13780         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13781
 13782     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13783     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13784     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13785                                     CP-RATING-BENEFIT-AMT.
 13786     IF CP-STATE-STD-ABBRV = 'OR'
 13787         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13788                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 250
* EL050.cbl
 13789     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13790        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13791     END-IF
 13792     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13793     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13794     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13795                                    CP-REMAINING-TERM
 13796                                    CP-LOAN-TERM.
 13797     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13798        ADD +1                   TO CP-ORIGINAL-TERM
 13799                                    CP-REMAINING-TERM
 13800                                    CP-LOAN-TERM.
 13801
 13802     MOVE 'R'                   TO CP-RATE-FILE.
 13803     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13804
 13805     IF CP-ERROR-RATE-NOT-FOUND
 13806         MOVE ER-2641            TO WS-ERROR
 13807         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13808         GO TO 3300-CHECK-AH-RATES.
 13809
 13810     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13811     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13812
 13813     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13814         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13815
 13816     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13817                               + PB-I-LF-ALT-BENEFIT-AMT.
 13818
 13819     IF ACCOUNT-LIFE-CHECKED  OR
 13820        PB-POLICY-IS-VOIDED   OR
 13821        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13822        and (not pb-monthly-cert))
 13823        GO TO 3225-CONTINUE.
 13824
 13825     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13826        GO TO 3225-CONTINUE.
 13827
 13828     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13829                             EC-RT-LF-MAX-TOT-BEN
 13830        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13831        MOVE ER-2639       TO WS-ERROR
 13832        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13833
 13834 3225-CONTINUE.
 13835     IF PB-I-LF-ALT-RATE = ZERO
 13836         MOVE ER-2659            TO WS-ERROR
 13837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13838
 13839     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13840        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13841        MOVE ER-2698             TO WS-ERROR
 13842        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13843
 13844 3225-RATING-CONT.
 13845
 13846     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 251
* EL050.cbl
 13847        and (not pb-monthly-cert)
 13848         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13849         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13850         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13851            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13852            CONTINUE
 13853         ELSE
 13854            MOVE ER-2687         TO WS-ERROR
 13855            PERFORM 9900-ERROR-FORMAT
 13856                                 THRU 9900-EXIT
 13857         END-IF
 13858         GO TO 3290-EDIT-LF-REIN-RATE
 13859     END-IF
 13860
 13861* DMD RATING TEST
 13862     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13863         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13864         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13865         MOVE ER-2687                 TO WS-ERROR
 13866         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13867         GO TO 3290-EDIT-LF-REIN-RATE.
 13868
 13869 3230-CLIENT-MORT-CD-SPECIALS.
 13870
 13871     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13872     SET BIN-TO-GREG          TO TRUE.
 13873*    MOVE ' '                 TO DC-OPTION-CODE.
 13874     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13875     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13876
 13877 C-POS-3230-MORT-CD.
 13878     IF PB-COMPANY-ID = 'POS' AND
 13879        PB-SV-CARRIER = '2'
 13880         NEXT SENTENCE
 13881     ELSE
 13882         GO TO C-POS-3240-MORT-CD.
 13883
 13884     IF PB-SV-GROUPING = '030'
 13885        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13886         MOVE '2350' TO PB-I-MORT-CODE
 13887      ELSE
 13888         MOVE '3300' TO PB-I-MORT-CODE.
 13889
 13890
 13891 C-POS-3240-MORT-CD.
 13892     IF PB-COMPANY-ID = 'POS' AND
 13893        PB-SV-CARRIER = '1'
 13894         NEXT SENTENCE
 13895     ELSE
 13896         GO TO 3230-CONTINUE.
 13897
 13898     IF PB-SV-STATE = '45' OR '47'
 13899        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13900         MOVE '5200' TO PB-I-MORT-CODE
 13901     ELSE
 13902         MOVE '8300' TO PB-I-MORT-CODE.
 13903
 13904 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 252
* EL050.cbl
 13905
 13906     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13907        GO TO 3240-CONTINUE
 13908     END-IF
 13909
 13910     IF PB-CERT-EFF-DT > WS-971231
 13911        GO TO 3240-CONTINUE
 13912     END-IF
 13913
 13914     IF LF-BENEFIT-FOUND AND
 13915        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13916         MOVE 'F250'       TO PB-I-MORT-CODE
 13917     ELSE
 13918         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13919             MOVE '7250'   TO PB-I-MORT-CODE
 13920         ELSE
 13921             MOVE '4251'   TO PB-I-MORT-CODE
 13922         END-IF
 13923     END-IF
 13924
 13925     .
 13926 3240-CONTINUE.
 13927
 13928     IF PB-COMPANY-ID NOT = 'GNL'
 13929         GO TO 3256-CONTINUE.
 13930
 13931     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13932         MOVE 'A300' TO PB-I-MORT-CODE
 13933     ELSE
 13934         MOVE '8350' TO PB-I-MORT-CODE.
 13935
 13936 3256-CONTINUE.
 13937     IF PB-COMPANY-ID NOT = 'ABL'
 13938         GO TO 3260-EDIT-CONTINUE.
 13939
 13940     IF PB-I-LF-TERM GREATER THAN 59
 13941         MOVE 'F550' TO PB-I-MORT-CODE
 13942     ELSE
 13943         MOVE 'E550' TO PB-I-MORT-CODE.
 13944
 13945 3260-EDIT-CONTINUE.
 13946     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13947
 13948 3290-EDIT-LF-REIN-RATE.
 13949     IF LF-REIN-NSP-NOT-USED
 13950         GO TO 3290-RATING-CONT.
 13951
 13952     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13953        GO TO 3290-RATING-CONT.
 13954     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13955     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13956     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13957     MOVE '3'                   TO CP-PROCESS-TYPE.
 13958     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13959
 13960******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13961     IF PB-COMPANY-ID EQUAL 'CDL'
 13962         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 253
* EL050.cbl
 13963            CP-EARN-AS-NET-PAY)
 13964             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13965*            MOVE SPACE          TO DC-OPTION-CODE
 13966             SET BIN-TO-GREG     TO TRUE
 13967             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13968***  Y2K PROJ 7744
 13969             IF DC-GREG-DATE-CYMD GREATER 19931231
 13970                 MOVE '1'        TO CP-EARNING-METHOD.
 13971***  Y2K PROJ 7744
 13972*******
 13973
 13974     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13975     MOVE PB-SV-STATE           TO CP-STATE.
 13976     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13977     MOVE ZERO                  TO CP-DEVIATION-CODE
 13978                                   CP-RATE-DEV-PCT.
 13979     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13980     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13981                                   CP-RATING-BENEFIT-AMT.
 13982
 13983************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13984     IF PB-COMPANY-ID EQUAL 'NCB'
 13985         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13986            CP-EARN-AS-NET-PAY
 13987             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13988                 PB-I-LF-PREMIUM-AMT.
 13989************
 13990
 13991     IF CP-STATE-STD-ABBRV = 'OR'
 13992         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13993                                         PB-I-LF-ALT-BENEFIT-AMT.
 13994     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13995     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13996     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13997     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13998     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13999     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14000     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14001     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14002                                   CP-REMAINING-TERM
 14003                                   CP-LOAN-TERM.
 14004     IF CP-TRUNCATED-LIFE
 14005        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14006
 14007     IF CP-TERM-IS-DAYS
 14008         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14009     ELSE
 14010         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14011
 14012     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14013        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14014     END-IF
 14015     IF PB-COMPANY-ID NOT = 'TIC'
 14016          MOVE ZERO          TO CP-CLASS-CODE.
 14017
 14018     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14019
 14020     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 254
* EL050.cbl
 14021     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14022
 14023     IF CP-ERROR-RATE-NOT-FOUND
 14024        IF PB-I-OB
 14025           MOVE ER-2625      TO WS-ERROR
 14026           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14027           GO TO 3299-EDIT-CONTINUE
 14028        ELSE
 14029           MOVE ER-2643      TO WS-ERROR
 14030           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14031           GO TO 3299-EDIT-CONTINUE.
 14032
 14033     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14034
 14035     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14036     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14037
 14038     IF PB-I-LF-REI-RATE = ZERO
 14039         MOVE ER-2643        TO WS-ERROR
 14040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14041
 14042 3290-CHECK-ALT-REIN-RATE.
 14043
 14044     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14045        GO TO 3290-RATING-CONT.
 14046
 14047     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14048     MOVE '2'                    TO CP-EARNING-METHOD.
 14049     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14050     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14051     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14052     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14053                                     CP-RATING-BENEFIT-AMT.
 14054     IF CP-STATE-STD-ABBRV = 'OR'
 14055         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14056                                         PB-I-LF-ALT-BENEFIT-AMT.
 14057     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14058        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14059     END-IF
 14060     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14061     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14062     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14063                                    CP-REMAINING-TERM
 14064                                    CP-LOAN-TERM.
 14065     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14066        ADD +1                   TO CP-ORIGINAL-TERM
 14067                                    CP-REMAINING-TERM
 14068                                    CP-LOAN-TERM.
 14069
 14070     MOVE 'R'                   TO CP-RATE-FILE.
 14071     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14072
 14073     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14074
 14075     IF PB-I-LF-ALT-REI-RATE = ZERO
 14076         MOVE ER-2643            TO WS-ERROR
 14077         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14078
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 255
* EL050.cbl
 14079 3290-RATING-CONT.
 14080
 14081     IF PB-I-OB
 14082*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14083        GO TO 3300-CHECK-AH-RATES.
 14084
 14085 3299-EDIT-CONTINUE.
 14086
 14087     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14088         NEXT SENTENCE
 14089     ELSE
 14090         MOVE ER-2620           TO WS-ERROR
 14091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14092
 14093 3300-CHECK-AH-RATES.
 14094     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14095         NEXT SENTENCE
 14096     ELSE
 14097         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14098
 14099     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14100        and (not pb-monthly-cert))
 14101                  or
 14102        ((CF-COMPANY-ID = 'DMD') AND
 14103                (NO-DMD-RATING))
 14104         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14105            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14106            CONTINUE
 14107         ELSE
 14108            MOVE ER-2687         TO WS-ERROR
 14109            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14110         END-IF
 14111         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14112         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14113     END-IF
 14114
 14115     IF PB-I-OB
 14116        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14117
 14118     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14119         MOVE ER-2687             TO WS-ERROR
 14120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14121         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14122         GO TO 3999-END-EDIT.
 14123
 14124*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14125     if pb-company-id = 'AHL'
 14126        go to 3300-skip-crit-per
 14127     end-if
 14128     if (pb-i-ah-crit-per not = zeros)
 14129        and (ws-ah-special-calc-cd not = 'C')
 14130        MOVE ER-1572             TO WS-ERROR
 14131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14132        go to 3300-skip-crit-per
 14133     END-IF
 14134     if (pb-company-id = 'DCC' or 'VPP')
 14135        and (am-dcc-product-code not = spaces)
 14136        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 256
* EL050.cbl
 14137     end-if
 14138     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14139        IF PB-I-AH-CRIT-PER = ZERO
 14140           move ws-ah-max-bens   to pb-i-ah-crit-per
 14141*          MOVE ER-2618       TO WS-ERROR
 14142*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14143*          GO TO 3999-END-EDIT
 14144        END-IF
 14145     END-IF
 14146     if (ws-ah-special-calc-cd = 'C')
 14147        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14148        MOVE ER-1576             TO WS-ERROR
 14149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14150     end-if
 14151
 14152     .
 14153 3300-skip-crit-per.
 14154     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14155     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14156     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14157     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14158     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14159     MOVE PB-SV-STATE            TO CP-STATE.
 14160     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14161     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14162     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14163*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14164     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14165     MOVE '3'                    TO CP-PROCESS-TYPE.
 14166     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14167     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14168                                    CP-RATING-BENEFIT-AMT.
 14169     IF PB-COMPANY-ID = 'CID'
 14170               OR
 14171        CP-STATE-STD-ABBRV = 'OR'
 14172         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14173                                         PB-I-AH-TERM.
 14174     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14175        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14176           AND (PB-I-POLICY-IS-MONTHLY)
 14177           MOVE PB-I-LF-BENEFIT-AMT
 14178                                 TO CP-NET-BENEFIT-AMT
 14179           move pb-i-ah-premium-amt to cp-original-premium
 14180           add pb-i-lf-premium-amt to cp-original-premium
 14181        END-IF
 14182     END-IF
 14183     MOVE SPACES                 TO CP-BEN-CATEGORY
 14184     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14185        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14186        EVALUATE TRUE
 14187           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14188              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14189              MOVE PB-I-LF-BENEFIT-AMT
 14190                                 TO CP-RATING-BENEFIT-AMT
 14191              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14192           WHEN WS-AH-BEN-CATEGORY = 'G'
 14193              MOVE PB-I-UNPAID-CASH-PRICE
 14194                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 257
* EL050.cbl
 14195           WHEN WS-AH-BEN-CATEGORY = 'D'
 14196              MOVE WS-AH-PMF-COMM
 14197                                 TO CP-DCC-PMF-COMM
 14198              MOVE PB-I-AH-COMMISSION
 14199                                 TO CP-DCC-ACT-COMM
 14200        END-EVALUATE
 14201     END-IF
 14202     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14203     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14204     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14205     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14206     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14207     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14208     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14209                                    CP-REMAINING-TERM
 14210                                    WS-WORK-TERM.
 14211     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14212
 14213     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14214     SET BIN-TO-GREG             TO TRUE.
 14215*    MOVE ' '                    TO DC-OPTION-CODE.
 14216     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14217     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14218
 14219     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14220     IF NOT VALID-SKIP-CODE
 14221         MOVE ER-2683            TO WS-ERROR
 14222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14223         GO TO 3320-RATE-CONTINUE.
 14224
 14225     IF PB-NO-MONTHS-SKIPPED
 14226         GO TO 3320-RATE-CONTINUE.
 14227
 14228     MOVE SPACE TO NUMBER-OF-MONTHS.
 14229
 14230     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14231         MOVE 'S'                TO SK-MO (6).
 14232     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14233         MOVE 'S'                TO SK-MO (7).
 14234     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14235         MOVE 'S'                TO SK-MO (8).
 14236     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14237         MOVE 'S'                TO SK-MO (9).
 14238     IF PB-I-SKIP-CODE = 'A'
 14239         MOVE 'S'                TO SK-MO (10).
 14240
 14241     MOVE 1                      TO SUB2.
 14242     MOVE PB-I-AH-TERM           TO SUB3.
 14243     MOVE WS-MONTH               TO SUB1.
 14244     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14245     GO TO 3320-RATE-CONTINUE.
 14246
 14247 3310-GET-SKIP-MO.
 14248     IF SUB1 = 13
 14249         MOVE 1                  TO SUB1.
 14250
 14251     IF SK-MO (SUB1) = 'S'
 14252         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 258
* EL050.cbl
 14253
 14254     ADD 1 TO SUB2
 14255              SUB1.
 14256
 14257 3320-RATE-CONTINUE.
 14258
 14259     IF WS-WORK-TERM = ZERO
 14260         MOVE 1                  TO WS-WORK-TERM.
 14261
 14262     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14263                                    CP-LOAN-TERM.
 14264
 14265     IF PB-COMPANY-ID EQUAL 'DMD'
 14266         NEXT SENTENCE
 14267     ELSE
 14268         MOVE ZERO               TO PB-I-AH-RATE
 14269                                    PB-I-AH-REI-RATE.
 14270
 14271
 14272     IF PB-COMPANY-ID EQUAL 'CRI'
 14273        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14274
 14275     IF PB-COMPANY-ID = 'CSL'
 14276         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14277         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14278         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14279         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14280
 14281     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14282        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14283           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14284              PB-I-RATE-DEV-PCT-LF
 14285        END-IF
 14286        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14287                                 TO CP-ALTERNATE-BENEFIT
 14288        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14289        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14290        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14291     END-IF
 14292     IF (PB-COMPANY-ID = 'CID')
 14293        AND (WS-LF-EARNINGS-CALC = 'B')
 14294        AND (CP-STATE-STD-ABBRV = 'MN')
 14295        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14296     ELSE
 14297        MOVE ' '                 TO CP-AH-BALLOON-SW
 14298     END-IF
 14299     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14300     MOVE 'R'                   TO CP-RATE-FILE.
 14301     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14302
 14303     IF (CP-ERROR-RATE-NOT-FOUND)
 14304        and (not pb-monthly-cert)
 14305        IF PB-I-OB
 14306           MOVE ER-2624          TO WS-ERROR
 14307           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14308           GO TO 3340-CALCULATE-PREMIUM-AMT
 14309        ELSE
 14310          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 259
* EL050.cbl
 14311              NEXT SENTENCE
 14312          ELSE
 14313           MOVE ER-2642          TO WS-ERROR
 14314           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14315           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14316
 14317     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14318        CP-ERROR-DIV-BY-ZERO
 14319           MOVE ER-3782          TO WS-ERROR
 14320           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14321
 14322     IF PB-COMPANY-ID EQUAL 'CRI'
 14323        IF CP-ERROR-NO-LIMITS-CRI
 14324           IF NOT ACCOUNT-AH-CHECKED
 14325              MOVE ER-2607          TO WS-ERROR
 14326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14327
 14328     IF ACCOUNT-AH-CHECKED
 14329        NEXT SENTENCE
 14330     ELSE
 14331       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14332          MOVE ER-2640           TO WS-ERROR
 14333          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14334
 14335     IF PB-COMPANY-ID = 'CRI'
 14336         IF WS-ERROR = ER-2640
 14337             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14338     IF ACCOUNT-AH-CHECKED
 14339        CONTINUE
 14340     ELSE
 14341        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14342           AND (CP-R-MAX-ATT-AGE > +0)
 14343           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14344           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14345              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14346              MOVE PB-I-AH-EXPIRE-DT
 14347                                 TO DC-BIN-DATE-2
 14348              MOVE '1'           TO DC-OPTION-CODE
 14349              PERFORM 8500-DATE-CONVERT
 14350                                 THRU 8500-EXIT
 14351              IF NO-CONVERSION-ERROR
 14352                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14353                    MOVE ER-2661       TO WS-ERROR
 14354*                   PERFORM 9900-ERROR-FORMAT
 14355*                                THRU 9900-EXIT
 14356                 END-IF
 14357              END-IF
 14358           ELSE
 14359              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14360              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14361                 MOVE ER-2661    TO WS-ERROR
 14362*                PERFORM 9900-ERROR-FORMAT
 14363*                                THRU 9900-EXIT
 14364              ELSE
 14365                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14366                    MOVE ER-1570 TO WS-ERROR
 14367                    PERFORM 9900-ERROR-FORMAT
 14368                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 260
* EL050.cbl
 14369                 END-IF
 14370              END-IF
 14371           END-IF
 14372           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14373              MOVE PB-I-JOINT-BIRTHDAY
 14374                                    TO DC-BIN-DATE-1
 14375              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14376              MOVE '1'              TO DC-OPTION-CODE
 14377              PERFORM 8500-DATE-CONVERT
 14378                                    THRU 8500-EXIT
 14379              IF NO-CONVERSION-ERROR
 14380                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14381                    MOVE ER-2661       TO WS-ERROR
 14382*                   PERFORM 9900-ERROR-FORMAT
 14383*                                   THRU 9900-EXIT
 14384                 END-IF
 14385              END-IF
 14386           ELSE
 14387              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14388                (PB-I-AH-TERM / 12)
 14389              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14390                 MOVE ER-2661       TO WS-ERROR
 14391*                PERFORM 9900-ERROR-FORMAT
 14392*                                   THRU 9900-EXIT
 14393              ELSE
 14394                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14395                    MOVE ER-1571 TO WS-ERROR
 14396                    PERFORM 9900-ERROR-FORMAT
 14397                                 THRU 9900-EXIT
 14398                 END-IF
 14399              END-IF
 14400           END-IF
 14401           IF WS-ERROR = ER-2661
 14402              PERFORM 9900-ERROR-FORMAT
 14403                                    THRU 9900-EXIT
 14404           END-IF
 14405        END-IF
 14406     END-IF
 14407*    IF ACCOUNT-AH-CHECKED
 14408*       NEXT SENTENCE
 14409*    ELSE
 14410*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14411*          MOVE ER-2661          TO WS-ERROR
 14412*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14413
 14414     IF ACCOUNT-AH-CHECKED
 14415        NEXT SENTENCE
 14416     ELSE
 14417        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14418           MOVE ER-2663          TO WS-ERROR
 14419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14420
 14421     IF ACCOUNT-AH-CHECKED OR
 14422        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14423         PB-POLICY-IS-VOIDED
 14424        NEXT SENTENCE
 14425     ELSE
 14426        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 261
* EL050.cbl
 14427           MOVE ER-2667            TO WS-ERROR
 14428           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14429
 14430     IF PB-COMPANY-ID = 'CRI'
 14431         IF WS-ERROR = ER-2667
 14432             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14433
 14434     IF ACCOUNT-AH-CHECKED
 14435        NEXT SENTENCE
 14436     ELSE
 14437        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14438           MOVE ER-2678            TO WS-ERROR
 14439           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14440
 14441     IF CP-ERROR-RATE-FILE-NOTOPEN
 14442         GO TO 3990-FILES-NOT-OPEN.
 14443
 14444 3321-CONTINUE.
 14445     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14446     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14447     IF (PB-COMPANY-ID = 'DCC')
 14448        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14449        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14450                                    PB-I-LF-ALT-PREM-CALC
 14451        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14452        IF WS-AH-BEN-CATEGORY = 'G'
 14453           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14454           + PB-I-ADDL-CLP)
 14455           * (1 + WS-TOL-CLP-PCT)
 14456*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14457        ELSE
 14458           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14459           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14460*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14461        END-IF
 14462        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14463                                 TO PB-I-AH-PREM-CALC
 14464        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14465           MOVE ER-8152          TO WS-ERROR
 14466           PERFORM 9900-ERROR-FORMAT
 14467                                 THRU 9900-EXIT
 14468        ELSE
 14469           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14470                 PB-I-ADDL-CLP)
 14471              MOVE ER-8148       TO WS-ERROR
 14472              PERFORM 9900-ERROR-FORMAT
 14473                                 THRU 9900-EXIT
 14474           END-IF
 14475        END-IF
 14476     END-IF
 14477     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14478        AND (PB-I-POLICY-IS-MONTHLY)
 14479        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14480        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14481        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14482           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14483        END-IF
 14484     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 262
* EL050.cbl
 14485     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14486        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14487        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14488        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14489        MOVE ER-2786             TO WS-ERROR
 14490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14491     END-IF
 14492     MOVE +0                     TO PB-I-AH-CLP
 14493     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14494        evaluate true
 14495           when WS-AH-BEN-CATEGORY = 'D'
 14496              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14497                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14498           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14499              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14500           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14501              compute ws-cred-union-fees rounded =
 14502                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14503                    pb-i-ah-commission)
 14504              COMPUTE PB-I-AH-CLP =
 14505                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14506        end-evaluate
 14507     END-IF
 14508     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14509
 14510     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14511         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14512
 14513     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14514         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14515
 14516     if (ws-ah-special-calc-cd = 'E')
 14517        and (pb-monthly-cert)
 14518        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14519     end-if
 14520     IF PB-COMPANY-ID = 'CRI'
 14521         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14522            PB-I-PAYMENT-AMOUNT = ZERO
 14523             NEXT SENTENCE
 14524         ELSE
 14525             COMPUTE PB-I-AH-PREM-CALC =
 14526                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14527                 (CP-PREMIUM-RATE / 100)
 14528             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14529                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14530                                             PB-I-RATE-DEV-PCT-AH.
 14531
 14532     IF (PB-I-AH-RATE  = ZERO)
 14533        and (not pb-monthly-cert)
 14534       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14535           NEXT SENTENCE
 14536       ELSE
 14537         MOVE ER-2642            TO WS-ERROR
 14538         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14539
 14540     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14541     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14542     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 263
* EL050.cbl
 14543     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14544     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14545     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14546
 14547     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14548        AND (WS-AH-BEN-CATEGORY = 'G')
 14549        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14550        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14551        IF CP-DEVIATION-CODE NOT = '000'
 14552           MOVE '000'            TO CP-DEVIATION-CODE
 14553           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14554           IF NO-CP-ERROR
 14555              COMPUTE PB-I-DDF-IU-RATE-UP =
 14556              PB-I-AH-CLP - CP-CALC-PREMIUM
 14557           ELSE
 14558              MOVE ER-3057        TO WS-ERROR
 14559              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14560           END-IF
 14561        END-IF
 14562     END-IF
 14563     .
 14564 3335-EDIT-AH-REIN-NSP-RATE.
 14565     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14566        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14567              compute ws-cred-union-fees rounded =
 14568                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14569                    pb-i-ah-commission)
 14570              COMPUTE PB-I-AH-CLP =
 14571                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14572        end-if
 14573     END-IF
 14574     IF AH-REIN-NSP-NOT-USED
 14575         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14576
 14577     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14578     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14579         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14580     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14581     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14582     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14583     MOVE PB-SV-STATE            TO CP-STATE.
 14584     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14585     MOVE ZERO                   TO CP-DEVIATION-CODE
 14586                                    CP-RATE-DEV-PCT.
 14587*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14588     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14589     MOVE '3'                    TO CP-PROCESS-TYPE.
 14590     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14591     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14592                                    CP-RATING-BENEFIT-AMT.
 14593     IF CP-STATE-STD-ABBRV = 'OR'
 14594         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14595                                         PB-I-AH-TERM.
 14596     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14597     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14598     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14599     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14600     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 264
* EL050.cbl
 14601     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14602                                    CP-REMAINING-TERM
 14603                                    WS-WORK-TERM.
 14604     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14605     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14606        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14607     END-IF
 14608     IF  PB-COMPANY-ID = 'TIC'
 14609         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14610            MOVE ZERO TO CP-CLASS-CODE.
 14611
 14612     IF PB-COMPANY-ID NOT = 'TIC'
 14613          MOVE ZERO          TO CP-CLASS-CODE.
 14614
 14615     MOVE ZERO               TO CP-DEVIATION-CODE.
 14616
 14617     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14618
 14619     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14620
 14621     MOVE 'R'                   TO CP-RATE-FILE.
 14622     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14623
 14624     IF CP-ERROR-RATE-NOT-FOUND
 14625         MOVE ER-2645        TO WS-ERROR
 14626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14627         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14628
 14629     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14630
 14631     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14632     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14633
 14634     IF PB-I-AH-REI-RATE = ZERO
 14635         MOVE ER-2645        TO WS-ERROR
 14636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14637
 14638
 14639 3340-CALCULATE-PREMIUM-AMT.
 14640
 14641     IF PB-COMPANY-ID = 'NCL'
 14642         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14643             WS-AH-SPECIAL-CALC-CD = 'O')
 14644             GO TO 3999-END-EDIT.
 14645
 14646     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14647                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14648                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14649                         OR 'AHL'
 14650         NEXT SENTENCE
 14651     ELSE
 14652         IF WS-STATE-ABBREVIATION = 'CT'
 14653             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14654                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14655                 COMPUTE PB-I-LF-PREM-CALC =
 14656                                     PB-I-LF-PREM-CALC * .90
 14657                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14658                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 265
* EL050.cbl
 14659                 COMPUTE PB-I-AH-PREM-CALC =
 14660                                     PB-I-AH-PREM-CALC * .90.
 14661
 14662     IF PB-COMP-LF-PREM
 14663        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14664        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14665
 14666     IF PB-COMP-AH-PREM
 14667        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14668
 14669 3340-CHECK-DCC-TOT-FEES.
 14670     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14671        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14672        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14673        AND (PB-I-POLICY-IS-MONTHLY)
 14674        CONTINUE
 14675     ELSE
 14676        GO TO 3340-EDIT-LF-AH-TOL
 14677     END-IF
 14678     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14679     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14680     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14681        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14682           PB-I-RATE-DEV-PCT-LF
 14683     END-IF
 14684     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14685        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14686           PB-I-RATE-DEV-PCT-AH
 14687     END-IF
 14688     MOVE 'N'                    TO CP-BEN-CATEGORY
 14689     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14690
 14691     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14692     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14693     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14694     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14695     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14696     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14697     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14698     MOVE '3'                    TO CP-PROCESS-TYPE.
 14699     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14700     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14701
 14702     MOVE PB-SV-STATE            TO CP-STATE.
 14703     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14704     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14705     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14706     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14707     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14708                                    CP-RATING-BENEFIT-AMT.
 14709     IF CP-STATE-STD-ABBRV = 'OR'
 14710         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14711                                         PB-I-LF-ALT-BENEFIT-AMT.
 14712     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14713     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14714     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14715     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14716     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 266
* EL050.cbl
 14717     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14718     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14719     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14720     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14721                                    CP-REMAINING-TERM
 14722                                    CP-LOAN-TERM.
 14723     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14724        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14725           PB-I-LF-PREMIUM-AMT
 14726     end-if
 14727
 14728     IF CP-TRUNCATED-LIFE
 14729        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14730
 14731     IF CP-TERM-IS-DAYS
 14732         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14733     ELSE
 14734         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14735
 14736     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14737     IF CP-SPECIAL-CALC-CD = 'H'
 14738         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14739                                    TO CP-ALTERNATE-BENEFIT
 14740         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14741     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14742     MOVE 'R'                    TO CP-RATE-FILE
 14743     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14744     IF NOT CP-ERROR-RATE-NOT-FOUND
 14745        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14746        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14747           AND (CP-BENEFIT-CD (1:1) = 'S')
 14748           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14749                                    PB-I-LF-PREMIUM-AMT
 14750        END-IF
 14751     ELSE
 14752        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14753     END-IF
 14754     .
 14755 3340-EDIT-LF-AH-TOL.
 14756
 14757***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14758***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14759***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14760***
 14761     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14762         PB-I-AH-PREMIUM-AMT
 14763          GIVING WS-CALC-WORK.
 14764
 14765     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14766        AND WS-CALC-WORK NOT = ZERO
 14767         MOVE ER-2649            TO WS-ERROR
 14768         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14769
 14770     SUBTRACT PB-I-LF-PREM-CALC
 14771             FROM PB-I-LF-PREMIUM-AMT
 14772                 GIVING WS-UNSIGN-WRK1.
 14773
 14774     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 267
* EL050.cbl
 14775             FROM PB-I-LF-ALT-PREMIUM-AMT
 14776                 GIVING WS-UNSIGN-WRK4.
 14777
 14778     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14779                                + WS-UNSIGN-WRK4.
 14780
 14781     SUBTRACT PB-I-AH-PREM-CALC
 14782             FROM PB-I-AH-PREMIUM-AMT
 14783                 GIVING WS-UNSIGN-WRK2.
 14784
 14785******************************************************************
 14786*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14787******************************************************************
 14788
 14789     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14790         MOVE ZERO TO WS-UNSIGN-WRK1.
 14791
 14792     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14793         MOVE ZERO TO WS-UNSIGN-WRK2.
 14794
 14795     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14796             GIVING WS-UNSIGN-WRK3.
 14797
 14798 3342-CONTINUE.
 14799
 14800     IF (PB-I-LF-RATE = ZERO  AND
 14801         PB-I-AH-RATE = ZERO)
 14802         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14803            WS-AH-SPECIAL-CALC-CD = 'O'
 14804              NEXT SENTENCE
 14805         ELSE
 14806             GO TO 3345-EDIT-CONTINUE.
 14807
 14808     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14809         NEXT SENTENCE
 14810     ELSE
 14811     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14812        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14813           IF (PB-REISSUED-CERT         OR
 14814               PB-POLICY-IS-DECLINED    OR
 14815               PB-POLICY-IS-VOIDED)
 14816              NEXT SENTENCE
 14817           ELSE
 14818              IF WS-PREM-REJECT-SW = SPACE
 14819                 MOVE ER-2652    TO WS-ERROR
 14820                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14821                 GO TO 3344-CHECK-AH
 14822              ELSE
 14823                 MOVE ER-2650    TO WS-ERROR
 14824                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14825                 GO TO 3344-CHECK-AH.
 14826
 14827***
 14828***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14829***
 14830
 14831     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14832         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 268
* EL050.cbl
 14833            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14834             (1 + WS-TOL-LF-PREM-PCT)
 14835         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14836            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14837             (1 - WS-TOL-LF-PREM-PCT)
 14838     ELSE
 14839         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14840         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14841
 14842***
 14843***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14844***
 14845
 14846     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14847         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14848          WS-TOL-LF-PREM.
 14849
 14850     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14851         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14852          WS-TOL-LF-PREM.
 14853
 14854     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14855        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14856
 14857     IF PB-REISSUED-CERT
 14858        or PB-POLICY-IS-DECLINED
 14859        or PB-POLICY-IS-VOIDED
 14860        continue
 14861     ELSE
 14862        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14863              > WS-TOL-LF-HIGH-PREM-AMT)
 14864           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14865              < WS-TOL-LF-LOW-PREM-AMT))
 14866                      or
 14867           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14868              > WS-TOL-LF-HIGH-PREM-PCT)
 14869           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14870              < WS-TOL-LF-LOW-PREM-PCT))
 14871           IF WS-PREM-REJECT-SW = SPACE
 14872              MOVE ER-2652       TO WS-ERROR
 14873              PERFORM 9900-ERROR-FORMAT
 14874                                 THRU 9900-EXIT
 14875           ELSE
 14876              MOVE ER-2650       TO WS-ERROR
 14877              PERFORM 9900-ERROR-FORMAT
 14878                                 THRU 9900-EXIT
 14879           end-if
 14880        end-if
 14881     end-if
 14882
 14883*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14884*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14885*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14886*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14887
 14888     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14889        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14890                      OR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 269
* EL050.cbl
 14891           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14892           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14893           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14894           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14895        END-IF
 14896     END-IF
 14897
 14898     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14899        IF WS-COMP-MAX-CAP GREATER THAN +0
 14900           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14901              IF (PB-REISSUED-CERT         OR
 14902                  PB-POLICY-IS-DECLINED    OR
 14903                  PB-POLICY-IS-VOIDED)
 14904                 NEXT SENTENCE
 14905              ELSE
 14906                  MOVE ER-2646   TO  WS-ERROR
 14907                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14908
 14909 3344-CVL-TOLERANCE-CHECK.
 14910
 14911      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14912          GO TO 3344-CHECK-AH.
 14913
 14914      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14915          GO TO 3344-CHECK-AH.
 14916
 14917      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14918                                     WS-UNSIGN-WRK6.
 14919
 14920      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14921          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14922                                 + PB-I-LF-PREMIUM-AMT
 14923                                 - PB-I-LF-PREM-CALC.
 14924
 14925      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14926          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14927                                 + PB-I-LF-ALT-PREMIUM-AMT
 14928                                 - PB-I-LF-ALT-PREM-CALC.
 14929
 14930      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14931          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14932              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14933                 MOVE ER-2652    TO  WS-ERROR
 14934                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14935              ELSE
 14936                 MOVE ER-2650    TO  WS-ERROR
 14937                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14938
 14939      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14940          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14941              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14942                 MOVE ER-2652    TO  WS-ERROR
 14943                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14944              ELSE
 14945                 MOVE ER-2650    TO  WS-ERROR
 14946                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14947
 14948 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 270
* EL050.cbl
 14949
 14950****************************************************************
 14951***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14952***
 14953
 14954     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14955         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14956             (1 + WS-TOL-AH-PREM-PCT)
 14957         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14958             (1 - WS-TOL-AH-PREM-PCT)
 14959     ELSE
 14960         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14961         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14962
 14963***
 14964***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14965***
 14966
 14967     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14968         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14969
 14970     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14971         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14972
 14973     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14974        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14975
 14976     IF (PB-REISSUED-CERT)
 14977        OR (PB-POLICY-IS-DECLINED)
 14978        OR (PB-POLICY-IS-VOIDED)
 14979        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14980        CONTINUE
 14981     ELSE
 14982        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14983              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14984                          or
 14985           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14986              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14987           IF WS-PREM-REJECT-SW = SPACE
 14988              MOVE ER-3052       TO WS-ERROR
 14989              PERFORM 9900-ERROR-FORMAT
 14990                                 THRU 9900-EXIT
 14991           ELSE
 14992              MOVE ER-3050       TO WS-ERROR
 14993              PERFORM 9900-ERROR-FORMAT
 14994                                 THRU 9900-EXIT
 14995           END-IF
 14996        END-IF
 14997     END-IF
 14998     if (pb-company-id = 'DCC' or 'VPP')
 14999        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15000        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15001        and (pb-i-policy-is-monthly)
 15002        compute ws-tol-ah-high-prem-amt =
 15003           pb-i-tot-fees-calc + ws-tol-ah-prem
 15004        compute ws-tol-ah-low-prem-amt =
 15005           pb-i-tot-fees-calc - ws-tol-ah-prem
 15006        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 271
* EL050.cbl
 15007           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15008              (1 + ws-tol-ah-prem-pct)
 15009           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15010              (1 - ws-tol-ah-prem-pct)
 15011        else
 15012           move +9999999.99      to ws-tol-ah-high-prem-pct
 15013           move +0               to ws-tol-ah-low-prem-pct
 15014        end-if
 15015        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15016            or
 15017           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15018                          or
 15019           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15020           or
 15021           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15022            move er-3049         to ws-error
 15023           perform 9900-error-format
 15024                                 thru 9900-exit
 15025
 15026        end-if
 15027     end-if
 15028     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15029         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15030             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15031             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15032
 15033     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15034        IF WS-COMP-MAX-CAP GREATER THAN +0
 15035           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15036              IF (PB-REISSUED-CERT         OR
 15037                  PB-POLICY-IS-DECLINED    OR
 15038                  PB-POLICY-IS-VOIDED)
 15039                 NEXT SENTENCE
 15040              ELSE
 15041                  MOVE ER-2646   TO  WS-ERROR
 15042                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15043
 15044     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15045        (WS-COMP-MAX-CAP EQUAL +0)
 15046           GO TO 3345-EDIT-CONTINUE.
 15047
 15048     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15049        GREATER THAN WS-COMP-MAX-CAP
 15050           MOVE ER-2646          TO  WS-ERROR
 15051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15052
 15053 3345-EDIT-CONTINUE.
 15054
 15055*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15056*       IF PB-ENTRY-BATCH   NUMERIC
 15057*          IF PB-ISSUE
 15058*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15059*          ELSE
 15060*              IF PB-CANCELLATION
 15061*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15062
 15063*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15064*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 272
* EL050.cbl
 15065*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15066*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15067*        ELSE
 15068*            MOVE  ER-1909            TO  WS-ERROR
 15069*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15070
 15071     IF PB-I-POLICY-ACCEPTED
 15072        IF PB-POLICY-IS-DECLINED  OR
 15073           PB-REISSUED-CERT  OR
 15074           PB-REIN-ONLY-CERT  OR
 15075           PB-POLICY-IS-VOIDED
 15076            MOVE  ER-1891         TO  WS-ERROR
 15077            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15078        ELSE
 15079            MOVE SPACE            TO  PB-BATCH-ENTRY
 15080            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15081
 15082     IF PB-I-POLICY-DECLINED
 15083        IF PB-REISSUED-CERT  OR
 15084           PB-REIN-ONLY-CERT  OR
 15085           PB-POLICY-IS-VOIDED
 15086            MOVE  ER-1906         TO  WS-ERROR
 15087            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15088        ELSE
 15089            MOVE  'D'             TO  PB-BATCH-ENTRY
 15090                                      PB-I-ENTRY-STATUS.
 15091
 15092     IF PB-I-NEEDS-UNDERWRITING
 15093        IF PB-POLICY-IS-DECLINED OR
 15094           PB-REISSUED-CERT  OR
 15095           PB-REIN-ONLY-CERT  OR
 15096           PB-POLICY-IS-VOIDED
 15097            MOVE  ER-1907         TO  WS-ERROR
 15098            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15099        ELSE
 15100            MOVE 'U'              TO  PB-BATCH-ENTRY
 15101                                      PB-I-ENTRY-STATUS.
 15102
 15103     IF PB-NEEDS-UNDERWRITING
 15104        MOVE  ER-1901             TO  WS-ERROR
 15105        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15106     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15107        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15108        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15109        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15110           AND (NOT WS-LF-CASH))
 15111                           OR
 15112           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15113           AND (NOT WS-AH-CASH)))
 15114                       AND
 15115           (PB-I-ENTRY-STATUS NOT = '5')
 15116           MOVE 'M'              TO PB-BATCH-ENTRY
 15117                                    PB-I-ENTRY-STATUS
 15118        END-IF
 15119     END-IF
 15120     move pending-business       to ws-passed-erpndb
 15121     move ' '                    to ws-exceed-limit-yn
 15122                                    ws-9813-sw
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 273
* EL050.cbl
 15123     perform 7780-call-agg       thru 7780-exit
 15124*    display ' el050 exceed ' ws-exceed-limit-yn
 15125     if ws-exceed-limit-yn = 'Y'
 15126        MOVE  ER-9813            TO WS-ERROR
 15127        move 'Y'                 to ws-9813-sw
 15128        PERFORM  9900-ERROR-FORMAT
 15129                                 THRU 9900-EXIT
 15130     end-if
 15131
 15132     if (PB-EXCEEDED-LIMIT-FORCED)
 15133        and (ws-9813-sw = 'Y')
 15134        subtract +1 from PB-NO-OF-ERRORS
 15135        move er-9823             to ws-error
 15136        PERFORM  9900-ERROR-FORMAT
 15137                                 THRU 9900-EXIT
 15138     end-if
 15139     IF  PB-COMPANY-ID NOT = 'NCL'
 15140         GO TO 3999-END-EDIT.
 15141
 15142     IF PB-REISSUED-CERT  OR
 15143        PB-POLICY-IS-DECLINED  OR
 15144        PB-POLICY-IS-VOIDED  OR
 15145        PB-I-OB
 15146         GO TO 3999-END-EDIT.
 15147
 15148     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15149         MOVE  ER-2644            TO  WS-ERROR
 15150         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15151         GO TO 3999-END-EDIT.
 15152
 15153     MOVE 'N'                     TO  FORM-MASTER-SW.
 15154     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15155
 15156     IF NOT FORM-MASTER-FOUND
 15157         GO TO 3999-END-EDIT.
 15158
 15159     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15160                                      FORM-MASTER-AH-SW.
 15161
 15162     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15163         MOVE  +1                 TO SUB6
 15164         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15165
 15166     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15167         MOVE  +1                 TO SUB6
 15168         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15169
 15170     IF LF-FORM-MASTER-FOUND  OR
 15171        AH-FORM-MASTER-FOUND
 15172         GO TO 3360-CHECK-FORM-LIMITS
 15173     ELSE
 15174         GO TO 3999-END-EDIT.
 15175
 15176******************************************************************
 15177*                  3350-GET-ERFORM                               *
 15178*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15179*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15180******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 274
* EL050.cbl
 15181
 15182 3350-GET-ERFORM.
 15183
 15184     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15185         GO TO  3350-ERFORM-GETMAIN.
 15186
 15187     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15188     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15189     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15190     MOVE 'Y'                     TO FORM-MASTER-SW.
 15191
 15192     IF PB-CANCELLATION
 15193         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15194            PB-SV-STATE          EQUAL   FO-STATE       AND
 15195            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15196              GO TO 3350-EXIT
 15197         ELSE
 15198             NEXT SENTENCE
 15199     ELSE
 15200         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15201            PB-SV-STATE          EQUAL   FO-STATE       AND
 15202            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15203              GO TO 3350-EXIT.
 15204
 15205 3350-ERFORM-GETMAIN.
 15206
 15207     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15208     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15209
 15210 3350-ERFORM-READ.
 15211
 15212     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15213     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15214     IF PB-CANCELLATION
 15215         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15216     ELSE
 15217         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15218     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15219
 15220     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15221
 15222     IF FORM-MASTER-FOUND
 15223       IF PB-CANCELLATION
 15224          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15225             PB-SV-STATE          EQUAL   FO-STATE       AND
 15226             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15227              GO  TO 3350-EXIT
 15228          ELSE
 15229              NEXT SENTENCE
 15230       ELSE
 15231          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15232             PB-SV-STATE          EQUAL   FO-STATE       AND
 15233             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15234              GO  TO 3350-EXIT.
 15235
 15236     MOVE  'N'                    TO  FORM-MASTER-SW.
 15237     MOVE  ER-1895                TO  WS-ERROR.
 15238     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 275
* EL050.cbl
 15239
 15240 3350-EXIT.
 15241      EXIT.
 15242
 15243******************************************************************
 15244*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15245*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15246*   VALID FOR THE POLICY FORM USED.                              *
 15247******************************************************************
 15248
 15249 3355-EDIT-FORM-LF-BENEFITS.
 15250
 15251     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15252        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15253         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15254         GO TO   3355-EXIT.
 15255
 15256     IF  SUB6    LESS THAN   +40
 15257         ADD  +1      TO  SUB6
 15258         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15259
 15260     MOVE  ER-1896         TO  WS-ERROR.
 15261     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15262
 15263 3355-EXIT.
 15264      EXIT.
 15265
 15266******************************************************************
 15267*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15268*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15269*   VALID FOR THE POLICY FORM USED.                              *
 15270******************************************************************
 15271
 15272 3356-EDIT-FORM-AH-BENEFITS.
 15273
 15274     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15275        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15276         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15277         GO TO  3356-EXIT.
 15278
 15279      IF  SUB6    LESS THAN     +40
 15280          ADD  +1      TO  SUB6
 15281          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15282
 15283     MOVE  ER-1897         TO  WS-ERROR.
 15284     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15285
 15286 3356-EXIT.
 15287      EXIT.
 15288
 15289******************************************************************
 15290*                  3357-BENEFIT-SEARCH                           *
 15291*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15292*   CANCELLATIONS ONLY.                                          *
 15293******************************************************************
 15294 3357-BENEFIT-SEARCH.
 15295     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15296         MOVE +1                          TO SUB6
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 276
* EL050.cbl
 15297         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15298
 15299     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15300         MOVE +1                          TO SUB6
 15301         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15302
 15303 3357-EXIT.
 15304     EXIT.
 15305
 15306******************************************************************
 15307*                  3358-BENEFIT-LIFE-SEARCH                      *
 15308*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15309*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15310*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15311******************************************************************
 15312 3358-BENEFIT-LIFE-SEARCH.
 15313     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15314       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15315         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15316           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15317              IF FO-PLAN-REFUND-METHOD (SUB6)
 15318                     IS GREATER THAN SPACES
 15319                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15320                                          WS-LF-REFUND-CALC
 15321                 GO TO 3358-EXIT.
 15322
 15323     IF SUB6 LESS THAN +40
 15324         ADD +1                 TO SUB6
 15325         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15326
 15327 3358-EXIT.
 15328     EXIT.
 15329******************************************************************
 15330*                  3359-BENEFIT-AH-SEARCH                        *
 15331*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15332*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15333*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15334******************************************************************
 15335 3359-BENEFIT-AH-SEARCH.
 15336     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15337       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15338         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15339           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15340              IF FO-PLAN-REFUND-METHOD (SUB6)
 15341                      IS GREATER THAN SPACES
 15342                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15343                                          WS-AH-REFUND-CALC
 15344                 GO TO 3359-EXIT.
 15345
 15346     IF SUB6 LESS THAN +40
 15347         ADD +1                 TO SUB6
 15348         GO TO 3359-BENEFIT-AH-SEARCH.
 15349
 15350 3359-EXIT.
 15351     EXIT.
 15352
 15353******************************************************************
 15354*                  3360-CHECK-FORM-LIMITS                        *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 277
* EL050.cbl
 15355*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15356*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15357******************************************************************
 15358
 15359 3360-CHECK-FORM-LIMITS.
 15360
 15361     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15362         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15363
 15364     IF NOT LF-FORM-MASTER-FOUND
 15365         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15366
 15367 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15368
 15369     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15370       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15371        WS-LF-JOINT-INDICATOR = 'J'  AND
 15372        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15373         IF PB-COMPANY-ID = 'NCL'
 15374            MOVE  ER-1911          TO  WS-ERROR
 15375            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15376         ELSE
 15377            MOVE  ER-1892          TO  WS-ERROR
 15378            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15379
 15380 3360-CHECK-FORM-LF-ATT-AGE.
 15381
 15382     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15383
 15384     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15385         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15386         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15387            IF PB-COMPANY-ID = 'NCL'
 15388                MOVE  ER-1913      TO  WS-ERROR
 15389                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15390            ELSE
 15391                MOVE  ER-1894      TO  WS-ERROR
 15392                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15393
 15394 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15395
 15396     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15397         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15398         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15399            IF PB-COMPANY-ID = 'NCL'
 15400                MOVE  ER-1914      TO  WS-ERROR
 15401                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15402            ELSE
 15403                MOVE  ER-1899      TO  WS-ERROR
 15404                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15405
 15406 3360-CHECK-FORM-LF-TERM-BAMT.
 15407
 15408     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15409         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15410         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15411           IF  PB-COMPANY-ID = 'NCL'
 15412               MOVE  ER-1916       TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 278
* EL050.cbl
 15413               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15414           ELSE
 15415               MOVE  ER-1902       TO  WS-ERROR
 15416               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15417
 15418     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15419                                    PB-I-LF-ALT-BENEFIT-AMT.
 15420
 15421     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15422         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15423         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15424             IF  PB-COMPANY-ID = 'NCL'
 15425                 MOVE  ER-1918     TO  WS-ERROR
 15426                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15427             ELSE
 15428                 MOVE  ER-1904     TO  WS-ERROR
 15429                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15430
 15431******************************************************************
 15432*                  3360-CHECK-FORM-AH-LIMITS                     *
 15433*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15434*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15435******************************************************************
 15436
 15437 3360-CHECK-FORM-AH-LIMITS.
 15438
 15439     IF NOT AH-FORM-MASTER-FOUND
 15440         GO TO 3999-END-EDIT.
 15441
 15442 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15443
 15444     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15445       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15446        WS-AH-JOINT-INDICATOR = 'J'  AND
 15447        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15448         IF PB-COMPANY-ID = 'NCL'
 15449            MOVE  ER-1912          TO  WS-ERROR
 15450            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15451         ELSE
 15452            MOVE  ER-1893          TO  WS-ERROR
 15453            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15454
 15455 3360-CHECK-FORM-AH-ATT-AGE.
 15456
 15457     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15458
 15459     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15460         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15461         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15462            IF PB-COMPANY-ID = 'NCL'
 15463                MOVE  ER-1913      TO  WS-ERROR
 15464                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15465            ELSE
 15466                MOVE  ER-1894      TO  WS-ERROR
 15467                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15468
 15469 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15470
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 279
* EL050.cbl
 15471     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15472         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15473         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15474            IF PB-COMPANY-ID = 'NCL'
 15475                MOVE  ER-1915      TO  WS-ERROR
 15476                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15477            ELSE
 15478                MOVE  ER-1900      TO  WS-ERROR
 15479                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15480
 15481 3360-CHECK-FORM-AH-TERM-BAMT.
 15482
 15483     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15484         FO-AH-MAX-TERM    GREATER THAN  +0
 15485         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15486             IF  PB-COMPANY-ID = 'NCL'
 15487                 MOVE  ER-1917     TO  WS-ERROR
 15488                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15489             ELSE
 15490                  MOVE  ER-1903    TO  WS-ERROR
 15491                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15492
 15493     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15494         FO-MAX-AH-AMT    GREATER THAN  +0
 15495         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15496             IF  PB-COMPANY-ID = 'NCL'
 15497                 MOVE  ER-1919     TO  WS-ERROR
 15498                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15499             ELSE
 15500                 MOVE  ER-1905     TO  WS-ERROR
 15501                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15502
 15503     GO TO 3999-END-EDIT.
 15504
 15505******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 280
* EL050.cbl
 15507 3400-edit-vin.
 15508
 15509     MOVE PB-I-VIN               TO WS-WORK-VIN
 15510     MOVE +8                     TO V2
 15511     MOVE ZEROS                  TO WS-VIN-TOTAL
 15512     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15513      (V1 > 17)
 15514        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15515           MOVE ER-3825          TO WS-ERROR
 15516           PERFORM 9900-ERROR-FORMAT
 15517                                 THRU 9900-EXIT
 15518        ELSE
 15519           IF V1 = 8
 15520              MOVE 10            TO V2
 15521           END-IF
 15522           IF V1 = 9
 15523              MOVE 0             TO V2
 15524           END-IF
 15525           IF V1 = 10
 15526              MOVE 9             TO V2
 15527           END-IF
 15528           IF WS-WORK-VIN (V1:1) NUMERIC
 15529              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15530               + (WS-WORK-VIN-N (V1) * V2)
 15531           ELSE
 15532              MOVE WS-WORK-VIN (V1:1)
 15533                            TO WS-HEX-BYTE
 15534              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15535              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15536               + (WS-NUM (V3) * V2)
 15537           END-IF
 15538           COMPUTE V2 = V2 - 1
 15539        END-IF
 15540     END-PERFORM
 15541     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15542     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15543        REMAINDER WS-VIN-REMAINDER
 15544     IF ((WS-WORK-VIN (9:1) = 'X')
 15545        AND (WS-VIN-REMAINDER = 10))
 15546                OR
 15547        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15548        CONTINUE
 15549     ELSE
 15550        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15551           MOVE ER-3826          TO WS-ERROR
 15552           PERFORM 9900-ERROR-FORMAT
 15553                                 THRU 9900-EXIT
 15554        ELSE
 15555           MOVE ER-3827          TO WS-ERROR
 15556           PERFORM 9900-ERROR-FORMAT
 15557                                 THRU 9900-EXIT
 15558        END-IF
 15559     END-IF
 15560
 15561     .
 15562 3400-exit.
 15563     exit.
 15564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 281
* EL050.cbl
 15565*                  E D I T   C A N C E L                         *
 15566******************************************************************
 15567
 15568 3700-EDIT-CANCEL.
 15569     IF PB-COMPANY-ID = 'DMD'
 15570         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15571                                         WS-RES-MUNI-TAX
 15572                                         PB-CI-STATE-TAX
 15573                                         PB-CI-MUNI-TAX
 15574         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15575
 15576*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15577*       IF PB-ENTRY-BATCH  NUMERIC
 15578*          IF PB-CANCELLATION
 15579*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15580*          ELSE
 15581*             IF PB-ISSUE
 15582*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15583
 15584     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15585        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15586     END-IF
 15587*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15588*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15589
 15590     IF CM-ENTRY-STATUS = 'V'
 15591        MOVE ER-2780             TO WS-ERROR
 15592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15593        GO TO 3999-END-EDIT.
 15594
 15595     IF CM-ENTRY-STATUS = 'D'
 15596        MOVE ER-2781             TO WS-ERROR
 15597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15598        GO TO 3999-END-EDIT.
 15599
 15600     IF CM-ENTRY-STATUS = 'U'
 15601        MOVE ER-2782             TO WS-ERROR
 15602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15603
 15604***************************************************************
 15605*                                                             *
 15606*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15607*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15608*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15609*   OF ANOTHER COVERAGE.                                      *
 15610*                                                             *
 15611***************************************************************
 15612
 15613     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15614                                    PB-C-AH-CANCEL-VOID-SW.
 15615
 15616     IF PB-C-LF-CANCEL-AMT = ZERO
 15617        NEXT SENTENCE
 15618     ELSE
 15619        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15620           AND
 15621           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15622               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 282
* EL050.cbl
 15623               MOVE ER-2745           TO WS-ERROR
 15624               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15625
 15626     IF PB-C-AH-CANCEL-AMT = ZERO
 15627        NEXT SENTENCE
 15628     ELSE
 15629        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15630           AND
 15631           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15632               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15633               MOVE ER-2745           TO WS-ERROR
 15634               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15635
 15636     IF WS-LF-EARNINGS-CALC = '4'
 15637        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15638
 15639     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15640     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15641     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15642     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15643     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15644     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15645
 15646     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15647                                      PB-C-AH-REF-CALC.
 15648     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15649
 15650******************************************************************
 15651*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15652*             TO VALIDATE COVERAGE.                              *
 15653******************************************************************
 15654
 15655     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15656        PB-C-LF-CANCEL-AMT = ZEROS
 15657          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15658      ELSE
 15659          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15660
 15661     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15662        PB-C-AH-CANCEL-AMT = ZEROS
 15663          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15664      ELSE
 15665          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15666
 15667     EVALUATE TRUE
 15668         WHEN PB-CANCEL-FORCE             OR
 15669              PB-CANCEL-DATE-FORCED       OR
 15670              PB-FORCE-OFF
 15671                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15672                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15673                  END-IF
 15674         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15675               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15676              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15677                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15678         WHEN OTHER
 15679              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15680                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 283
* EL050.cbl
 15681              ELSE
 15682                 MOVE ER-2749              TO WS-ERROR
 15683              END-IF
 15684              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15685     END-EVALUATE.
 15686
 15687
 15688*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15689*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15690*            MOVE  ER-1909            TO  WS-ERROR
 15691*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15692*        ELSE
 15693*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15694
 15695     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15696     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15697        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15698     ELSE
 15699        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15700     END-IF
 15701     .
 15702 3705-EDIT-CANCEL-DT.
 15703
 15704     IF LF-COVERAGE-CANCELLED
 15705        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15706         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15707         MOVE WS-CURRENT-MONTH-END
 15708                                 TO DC-BIN-DATE-2
 15709         SET ELAPSED-BETWEEN-BIN TO TRUE
 15710*        MOVE 1                  TO DC-OPTION-CODE
 15711         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15712         IF DATE-CONVERSION-ERROR
 15713            NEXT SENTENCE
 15714          ELSE
 15715             IF DC-ELAPSED-DAYS GREATER +180
 15716                IF PB-CANCEL-DATE-FORCED  OR
 15717                   PB-CANCEL-DATE-FORCED-NO-FEE
 15718                      MOVE ER-2751  TO WS-ERROR
 15719                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15720                 ELSE
 15721                   MOVE ER-2752  TO WS-ERROR
 15722                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15723
 15724     IF AH-COVERAGE-CANCELLED
 15725        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15726         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15727         MOVE WS-CURRENT-MONTH-END
 15728                                 TO DC-BIN-DATE-2
 15729         SET ELAPSED-BETWEEN-BIN TO TRUE
 15730*        MOVE 1                  TO DC-OPTION-CODE
 15731         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15732         IF DATE-CONVERSION-ERROR
 15733            NEXT SENTENCE
 15734          ELSE
 15735             IF DC-ELAPSED-DAYS GREATER +180
 15736                IF PB-CANCEL-DATE-FORCED OR
 15737                   PB-CANCEL-DATE-FORCED-NO-FEE
 15738                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 284
* EL050.cbl
 15739                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15740                 ELSE
 15741                   MOVE ER-2752  TO WS-ERROR
 15742                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15743
 15744     IF WS-ERROR = ER-2752
 15745        AND (PB-COMPANY-ID = 'ABL'
 15746         OR  PB-COMPANY-ID = 'FGL'
 15747         OR  PB-COMPANY-ID = 'IST'
 15748         OR  PB-COMPANY-ID = 'JHL'
 15749         OR  PB-COMPANY-ID = 'LAP'
 15750         OR  PB-COMPANY-ID = 'LBL'
 15751         OR  PB-COMPANY-ID = 'NCB'
 15752         OR  PB-COMPANY-ID = 'NLI'
 15753         OR  PB-COMPANY-ID = 'OFI'
 15754         OR  PB-COMPANY-ID = 'PLI'
 15755         OR  PB-COMPANY-ID = 'TAO'
 15756         OR  PB-COMPANY-ID = 'TIC'
 15757         OR  PB-COMPANY-ID = 'HER'
 15758         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15759         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15760            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15761            MOVE ER-2762     TO WS-ERROR
 15762            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15763
 15764     IF LF-COVERAGE-CANCELLED
 15765        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15766        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15767             MOVE ER-2733         TO WS-ERROR
 15768             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15769
 15770     IF AH-COVERAGE-CANCELLED
 15771        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15772        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15773              MOVE ER-2733        TO WS-ERROR
 15774              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15775
 15776     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15777        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15778        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15779           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15780            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15781              IF PB-COMPANY-ID NOT = 'LAP'
 15782               MOVE ER-2704            TO WS-ERROR
 15783               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15784
 15785     IF CERT-WAS-NOT-FOUND
 15786         GO TO 3999-END-EDIT.
 15787
 15788     IF PB-COMPANY-ID EQUAL 'CDC'
 15789        IF LF-COVERAGE-CANCELLED
 15790           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15791            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15792            MOVE PB-C-LF-CANCEL-DT
 15793                                 TO DC-BIN-DATE-2
 15794            SET ELAPSED-BETWEEN-BIN TO TRUE
 15795*           MOVE 1               TO DC-OPTION-CODE
 15796            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 285
* EL050.cbl
 15797            IF DATE-CONVERSION-ERROR
 15798               NEXT SENTENCE
 15799             ELSE
 15800                IF DC-ELAPSED-DAYS GREATER +60
 15801                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15802
 15803     IF PB-COMPANY-ID EQUAL 'CDC'
 15804        IF AH-COVERAGE-CANCELLED
 15805           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15806            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15807            MOVE PB-C-AH-CANCEL-DT
 15808                                 TO DC-BIN-DATE-2
 15809            MOVE +0              TO DC-ELAPSED-DAYS
 15810                                    DC-ELAPSED-MONTHS
 15811            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15812*           MOVE 1               TO DC-OPTION-CODE
 15813            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15814            IF DATE-CONVERSION-ERROR
 15815               NEXT SENTENCE
 15816             ELSE
 15817                IF DC-ELAPSED-DAYS GREATER +60
 15818                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15819
 15820     MOVE +0                     TO DC-ELAPSED-DAYS
 15821                                    DC-ELAPSED-MONTHS.
 15822
 15823     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15824        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15825          MOVE 'Z'                TO PB-CI-OB-FLAG
 15826          MOVE ER-2767            TO WS-ERROR
 15827          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15828          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15829          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15830          GO TO 3775-OVER-REF-CHK
 15831        ELSE
 15832          MOVE ZEROS              TO PB-CI-LIVES
 15833                                     PB-C-LIVES
 15834          IF PB-CI-OB-FLAG NOT = 'B'
 15835             MOVE SPACE           TO PB-CI-OB-FLAG.
 15836
 15837     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15838         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15839     ELSE
 15840         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15841
 15842     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15843        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15844            MOVE ER-2760         TO WS-ERROR
 15845            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15846
 15847     IF LF-COVERAGE-CANCELLED
 15848        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15849         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15850            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15851               MOVE ER-2774       TO WS-ERROR
 15852               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15853
 15854     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 286
* EL050.cbl
 15855        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15856         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15857            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15858               MOVE ER-2775       TO WS-ERROR
 15859               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15860
 15861     IF LF-COVERAGE-CANCELLED
 15862        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15863         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15864            MOVE ER-2776         TO WS-ERROR
 15865            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15866
 15867     IF AH-COVERAGE-CANCELLED
 15868        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15869         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15870            MOVE ER-2777         TO WS-ERROR
 15871            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15872
 15873     IF LF-COVERAGE-CANCELLED
 15874        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15875        if pb-ci-lf-expire-dt = low-values or spaces
 15876           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15877           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15878           MOVE PB-CI-EXTENTION-DAYS
 15879                                 TO DC-ELAPSED-DAYS
 15880           SET BIN-PLUS-ELAPSED  TO TRUE
 15881           PERFORM 8500-DATE-CONVERT
 15882                                 THRU 8500-EXIT
 15883           IF DATE-CONVERSION-ERROR
 15884              move low-values    to dc-bin-date-2
 15885           end-if
 15886        else
 15887           move pb-ci-lf-expire-dt
 15888                                 to dc-bin-date-2
 15889        end-if
 15890        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15891           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15892                             OR  'FIA'
 15893              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15894           ELSE
 15895              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15896              MOVE ER-2731       TO WS-ERROR
 15897              PERFORM 9900-ERROR-FORMAT
 15898                                 THRU 9900-EXIT
 15899           end-if
 15900        end-if
 15901     end-if
 15902*    IF LF-COVERAGE-CANCELLED
 15903*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15904*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15905*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15906*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15907*        SET BIN-PLUS-ELAPSED      TO TRUE
 15908*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15909*        IF DATE-CONVERSION-ERROR
 15910*           NEXT SENTENCE
 15911*         ELSE
 15912*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 287
* EL050.cbl
 15913*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15914*                            OR  'FIA'
 15915*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15916*              ELSE
 15917*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15918*               MOVE ER-2731       TO WS-ERROR
 15919*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15920     .
 15921 3705-EDIT-AH-CANCEL-DT.
 15922     IF AH-COVERAGE-CANCELLED
 15923        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15924        if pb-ci-AH-expire-dt = low-values or spaces
 15925           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15926           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15927           MOVE PB-CI-EXTENTION-DAYS
 15928                                 TO DC-ELAPSED-DAYS
 15929           SET BIN-PLUS-ELAPSED  TO TRUE
 15930           PERFORM 8500-DATE-CONVERT
 15931                                 THRU 8500-EXIT
 15932           IF DATE-CONVERSION-ERROR
 15933              move low-values    to dc-bin-date-2
 15934           end-if
 15935        else
 15936           move pb-ci-ah-expire-dt
 15937                                 to dc-bin-date-2
 15938        end-if
 15939        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15940           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15941                             OR  'FIA'
 15942              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15943           ELSE
 15944              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15945              MOVE ER-2771       TO WS-ERROR
 15946              PERFORM 9900-ERROR-FORMAT
 15947                                 THRU 9900-EXIT
 15948           end-if
 15949        end-if
 15950     end-if
 15951*    IF AH-COVERAGE-CANCELLED
 15952*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15953*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15954*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15955*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15956**       MOVE 6                    TO DC-OPTION-CODE
 15957*        SET BIN-PLUS-ELAPSED      TO TRUE
 15958*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15959*        IF DATE-CONVERSION-ERROR
 15960*           NEXT SENTENCE
 15961*         ELSE
 15962*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15963*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15964*                             OR 'FIA'
 15965*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15966*             ELSE
 15967*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15968*              MOVE ER-2771       TO WS-ERROR
 15969*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15970     .
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 288
* EL050.cbl
 15971 3705-EDIT-CONTINUED.
 15972
 15973*    IF LF-COVERAGE-CANCELLED
 15974*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15975*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15976*            MOVE ER-2727         TO WS-ERROR
 15977*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15978*
 15979*    IF AH-COVERAGE-CANCELLED
 15980*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15981*        IF PB-COMPANY-ID = 'ACE'
 15982*           MOVE ER-2727        TO WS-ERROR
 15983*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15984*        ELSE
 15985*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15986*              MOVE ER-2727     TO WS-ERROR
 15987*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988
 15989     IF PB-COMPANY-ID = 'ACE'
 15990       IF AH-COVERAGE-CANCELLED
 15991         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15992           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15993              MOVE ER-2732      TO WS-ERROR
 15994              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15995
 15996     IF PB-COMPANY-ID      EQUAL   'HER'
 15997        IF WS-ERROR        EQUAL   ER-2727
 15998            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15999            MOVE  ER-2725          TO  WS-ERROR
 16000            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16001
 16002     IF PB-C-CLAIM-CREATED-CANCEL
 16003            MOVE ER-2748         TO WS-ERROR
 16004            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16005
 16006     IF PB-C-LAST-NAME NOT = SPACES
 16007         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16008            MOVE ER-2747         TO WS-ERROR
 16009            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16010
 16011 3710-EDIT-LUMP-SUM-PRIOR.
 16012
 16013     IF AH-COVERAGE-CANCELLED
 16014         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16015             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16016                MOVE ER-2735    TO WS-ERROR
 16017                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16018
 16019     IF LF-COVERAGE-CANCELLED
 16020         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16021             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16022                MOVE ER-2735    TO WS-ERROR
 16023                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16024
 16025 3710-EDIT-PRIOR-DEATH.
 16026
 16027*    IF LF-COVERAGE-CANCELLED
 16028*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 289
* EL050.cbl
 16029*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16030*           (NOT PB-CI-OB)
 16031*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16032*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16033*                   MOVE ER-2732  TO WS-ERROR
 16034*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16035*
 16036*    IF AH-COVERAGE-CANCELLED
 16037*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16038*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16039*           (NOT PB-CI-OB)
 16040*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16041*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16042*                   MOVE ER-2732  TO WS-ERROR
 16043*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16044
 16045     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16046         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16047            (NOT PB-COMP-LF-CANCEL)
 16048             NEXT SENTENCE
 16049         ELSE
 16050           IF PB-C-LF-CANCEL-VOIDED
 16051              NEXT SENTENCE
 16052           ELSE
 16053              MOVE ER-2753      TO WS-ERROR
 16054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16055
 16056     IF CANCEL-FUTURE-DT
 16057         GO TO 3999-END-EDIT.
 16058
 16059 3715-GET-REMAIN-TERM-LF.
 16060
 16061     IF NO-LF-BENEFIT-MATCH  OR
 16062        WS-LF-BENEFIT-CD = ZEROS
 16063        GO TO 3730-GET-AH-REMAIN-TERM.
 16064
 16065     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16066     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16067     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16068     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16069     MOVE PB-SV-STATE            TO CP-STATE.
 16070     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16071     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16072     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16073     MOVE '2'                    TO CP-PROCESS-TYPE.
 16074     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16075     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16076     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16077     IF (PB-COMPANY-ID = 'CID')
 16078        AND (CP-STATE-STD-ABBRV = 'WI')
 16079        MOVE '7'                 TO CP-REM-TERM-METHOD
 16080        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16081     ELSE
 16082        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16083        MOVE WS-REM-TRM-CALC-OPTION
 16084                                 TO CP-REM-TRM-CALC-OPTION
 16085     END-IF
 16086**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 290
* EL050.cbl
 16087     IF (PB-COMPANY-ID = 'CID')
 16088        AND (CP-STATE-STD-ABBRV = 'MO')
 16089        AND (PB-CERT-EFF-DT >= X'9B41')
 16090        AND (PB-CERT-EFF-DT <= X'A2FB')
 16091        MOVE '7'                 TO CP-REM-TERM-METHOD
 16092        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16093     END-IF
 16094     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16095                                    CP-LOAN-TERM.
 16096     IF CP-TRUNCATED-LIFE
 16097        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16098
 16099     IF CP-TERM-IS-DAYS
 16100         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16101     ELSE
 16102         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16103
 16104     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16105
 16106     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16107
 16108     IF LF-COVERAGE-CANCELLED
 16109        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16110        NEXT SENTENCE
 16111      ELSE
 16112          GO TO 3730-GET-AH-REMAIN-TERM.
 16113
 16114 3720-GET-LF-REFUND.
 16115
 16116     IF PB-C-LF-CANCEL-VOIDED
 16117        GO TO 3730-GET-AH-REMAIN-TERM
 16118     end-if
 16119
 16120     IF PB-COMPANY-ID EQUAL 'BOA'
 16121         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16122         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16123         GO TO 3730-GET-AH-REMAIN-TERM.
 16124
 16125     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16126        (WS-AH-SPECIAL-CALC-CD = 'M')
 16127         MOVE ER-2767            TO WS-ERROR
 16128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16129         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16130         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16131         GO TO 3780-UPDATE-CANCEL-CERT.
 16132
 16133*    if (ws-lf-earnings-calc = '6')
 16134*       or (pb-c-lf-refund-override = '6')
 16135*       move cp-remaining-term-1 to cp-remaining-term-2
 16136*    end-if
 16137     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16138
 16139     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16140     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16141     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16142     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16143     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16144     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 291
* EL050.cbl
 16145     IF PB-COMPANY-ID = 'DCC'
 16146        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16147        IF PDEF-MASTER-FOUND
 16148           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16149              (V1 > +8)
 16150              OR (PD-PROD-CODE (V1) = 'L')
 16151           END-PERFORM
 16152           IF V1 < +9
 16153              MOVE PD-MAX-AMT (V1)
 16154                           TO CP-R-MAX-TOT-BEN
 16155                              EC-AM-LF-MAX-TOT-BEN
 16156           END-IF
 16157        ELSE
 16158        MOVE ' '                 TO PDEF-MASTER-SW
 16159        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16160        MOVE PB-STATE            TO ERPDEF-STATE
 16161        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16162           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16163        END-IF
 16164        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16165        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16166        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16167        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16168        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16169        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16170        IF PDEF-MASTER-FOUND
 16171           MOVE 'N'              TO PDEF-MASTER-SW
 16172           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16173           IF PDEF-MASTER-FOUND
 16174              IF (ERPDEF-KEY-SAVE (1:16) =
 16175                           PD-CONTROL-PRIMARY (1:16))
 16176                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16177                 CONTINUE
 16178              ELSE
 16179                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16180                 IF (ERPDEF-KEY-SAVE (1:16) =
 16181                           PD-CONTROL-PRIMARY (1:16))
 16182                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16183                    CONTINUE
 16184                 ELSE
 16185                    MOVE 'N'     TO PDEF-MASTER-SW
 16186                 END-IF
 16187              END-IF
 16188
 16189              IF PDEF-MASTER-FOUND
 16190                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16191                    (V1 > +8)
 16192                    OR (PD-PROD-CODE (V1) = 'L')
 16193                 END-PERFORM
 16194                 IF V1 < +9
 16195                    MOVE PD-MAX-AMT (V1)
 16196                                 TO CP-R-MAX-TOT-BEN
 16197                                    EC-AM-LF-MAX-TOT-BEN
 16198                 END-IF
 16199              END-IF
 16200           END-IF
 16201           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16202        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 292
* EL050.cbl
 16203        END-IF
 16204     END-IF
 16205     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16206
 16207     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16208
 16209     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16210                                    PB-C-LF-REM-TERM.
 16211
 16212     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16213     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16214
 16215     IF PB-COMPANY-ID EQUAL 'FLC'
 16216        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16217           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16218           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16219                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16220                    - CM-LF-ITD-DEATH-AMT
 16221           IF PB-C-LF-REF-CALC LESS THAN +0
 16222              MOVE +0            TO PB-C-LF-REF-CALC
 16223              GO TO 3730-GET-AH-REMAIN-TERM
 16224           ELSE
 16225              GO TO 3730-GET-AH-REMAIN-TERM.
 16226
 16227     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16228                            OR '4' OR '5' OR '6' OR '8'
 16229                            OR '9' OR 'G'
 16230        MOVE PB-C-LF-REFUND-OVERRIDE
 16231                                 TO CP-EARNING-METHOD.
 16232
 16233     if pb-company-id = 'AHL'
 16234        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16235        if cp-class-code = spaces
 16236           move zeros            to cp-class-code
 16237        end-if
 16238     ELSE
 16239        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16240     END-IF
 16241*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16242     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16243     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16244                                    CP-RATING-BENEFIT-AMT.
 16245     IF CP-STATE-STD-ABBRV = 'OR'
 16246         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16247                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16248     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16249     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16250     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16251     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16252     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16253     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16254     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16255     IF WS-DEFAULT-APR NOT NUMERIC
 16256         MOVE ZEROS TO WS-DEFAULT-APR.
 16257****   N O T E   ****
 16258*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16259*      THE OH HARD CODING IN ELCRFNDP
 16260
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 293
* EL050.cbl
 16261     IF PB-COMPANY-ID = 'CID'
 16262        IF CP-STATE-STD-ABBRV = 'OH'
 16263           MOVE WS-LF-EARNINGS-CALC
 16264                                 TO CP-EARNING-METHOD
 16265        END-IF
 16266     END-IF
 16267
 16268****   N O T E   ****
 16269
 16270     IF CP-EARN-AS-NET-PAY
 16271         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16272            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16273                MOVE WS-DEFAULT-APR
 16274                                 TO  CP-LOAN-APR
 16275                MOVE ER-3780     TO  WS-ERROR
 16276                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16277            ELSE
 16278                MOVE ER-3781     TO  WS-ERROR
 16279                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16280*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16281     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16282
 16283     IF CP-REFUND-TYPE-USED NOT = SPACE
 16284         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16285
 16286     IF CP-ERROR-RATE-IS-ZERO OR
 16287        CP-ERROR-RATE-NOT-FOUND
 16288        MOVE ER-2740             TO WS-ERROR
 16289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16290
 16291     IF CP-ERROR-RATE-FILE-NOTOPEN
 16292        MOVE ER-2617             TO WS-ERROR
 16293        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16294
 16295     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16296        AND PB-CI-ENTRY-STATUS = 'M'
 16297        MOVE +0                  TO PB-C-LF-REF-CALC
 16298     ELSE
 16299        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16300     END-IF
 16301
 16302     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16303         GO TO 3730-GET-AH-REMAIN-TERM.
 16304
 16305*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16306*       ADD +1                   TO PB-C-LF-REM-TERM
 16307*                                   CP-REMAINING-TERM
 16308*                                   CP-ORIGINAL-TERM.
 16309
 16310     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16311     MOVE '2'                    TO CP-EARNING-METHOD
 16312                                    CP-RATING-METHOD.
 16313     IF PB-COMPANY-ID = 'CID'
 16314        IF (CP-STATE-STD-ABBRV = 'MN')
 16315           AND (PB-CERT-EFF-DT > X'A4FF')
 16316           AND (WS-LF-EARNINGS-CALC = 'B')
 16317           MOVE '5'              TO CP-EARNING-METHOD
 16318           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 294
* EL050.cbl
 16319        END-IF
 16320     END-IF
 16321     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16322                                        CP-REMAINING-BENEFIT
 16323                                        CP-RATING-BENEFIT-AMT.
 16324     IF CP-STATE-STD-ABBRV = 'OR'
 16325         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16326                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16327     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16328     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16329
 16330     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16331
 16332     IF CP-ERROR-RATE-IS-ZERO OR
 16333        CP-ERROR-RATE-NOT-FOUND
 16334        MOVE ER-2740             TO WS-ERROR
 16335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16336
 16337     IF CP-ERROR-RATE-FILE-NOTOPEN
 16338        MOVE ER-2617             TO WS-ERROR
 16339        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16340
 16341     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16342
 16343******************************************************************
 16344
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 295
* EL050.cbl
 16346 3730-GET-AH-REMAIN-TERM.
 16347     IF NO-AH-BENEFIT-MATCH  OR
 16348        WS-AH-BENEFIT-CD = ZEROS
 16349         GO TO 3770-CHECK-REFUNDS.
 16350
 16351     IF PB-CI-AH-LUMP-SUM-DISAB
 16352         IF  PB-C-AH-CANCEL-AMT = ZERO
 16353            IF NOT PB-COMP-AH-CANCEL
 16354             GO TO 3770-CHECK-REFUNDS.
 16355
 16356     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16357     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16358     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16359     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16360     MOVE PB-SV-STATE            TO CP-STATE.
 16361     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16362     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16363     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16364     MOVE '2'                    TO CP-PROCESS-TYPE.
 16365     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16366     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16367     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16368     IF (PB-COMPANY-ID = 'CID')
 16369        AND (CP-STATE-STD-ABBRV = 'WI')
 16370        MOVE '7'                 TO CP-REM-TERM-METHOD
 16371        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16372     ELSE
 16373        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16374        MOVE WS-REM-TRM-CALC-OPTION
 16375                                 TO CP-REM-TRM-CALC-OPTION
 16376     END-IF
 16377     IF (PB-COMPANY-ID = 'CID')
 16378        AND (CP-STATE-STD-ABBRV = 'MO')
 16379        AND (PB-CERT-EFF-DT >= X'9B41')
 16380        AND (PB-CERT-EFF-DT <= X'A2FB')
 16381        MOVE '7'                 TO CP-REM-TERM-METHOD
 16382        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16383     END-IF
 16384     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16385                                    CP-LOAN-TERM.
 16386     IF NOT CP-TERM-IS-DAYS
 16387         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16388
 16389     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16390
 16391     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16392
 16393     IF AH-COVERAGE-CANCELLED
 16394        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16395        NEXT SENTENCE
 16396      ELSE
 16397         GO TO 3770-CHECK-REFUNDS.
 16398
 16399 3740-GET-AH-REFUND.
 16400
 16401     IF PB-C-AH-CANCEL-VOIDED
 16402        GO TO 3780-UPDATE-CANCEL-CERT
 16403     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 296
* EL050.cbl
 16404
 16405     IF PB-COMPANY-ID = 'BOA'
 16406         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16407         GO TO 3770-CHECK-REFUNDS.
 16408
 16409     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16410*    MOVE ' '                    TO DC-OPTION-CODE
 16411     SET BIN-TO-GREG             TO TRUE
 16412     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16413     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16414                                    PB-C-AH-REM-TERM.
 16415     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16416     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16417
 16418     IF PB-COMPANY-ID EQUAL 'FLC'
 16419        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16420           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16421           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16422                    - CM-AH-ITD-AH-PMT)
 16423           IF PB-C-AH-REF-CALC LESS THAN +0
 16424              MOVE +0            TO PB-C-AH-REF-CALC
 16425              GO TO 3770-CHECK-REFUNDS
 16426           ELSE
 16427              GO TO 3770-CHECK-REFUNDS.
 16428
 16429     IF PB-COMPANY-ID = 'DCC'
 16430        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16431            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16432           MOVE 'S'              TO CP-EARNING-METHOD
 16433        END-IF
 16434     END-IF
 16435     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16436                            OR '4' OR '5' OR '6' OR '8'
 16437                            OR '9' OR 'G' OR 'S'
 16438        MOVE PB-C-AH-REFUND-OVERRIDE
 16439                                 TO CP-EARNING-METHOD.
 16440
 16441     if pb-company-id = 'AHL'
 16442        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16443        if cp-class-code = spaces
 16444           move zeros            to cp-class-code
 16445        end-if
 16446     ELSE
 16447        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16448     END-IF
 16449*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16450     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16451     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16452                                    CP-RATING-BENEFIT-AMT.
 16453     IF CP-STATE-STD-ABBRV = 'OR'
 16454         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16455                                         PB-CI-AH-TERM.
 16456     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16457     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16458     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16459     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16460     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16461     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 297
* EL050.cbl
 16462
 16463     IF CP-STATE-STD-ABBRV = 'OH'
 16464        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16465                                AND 'CID' AND 'DCC' and 'VPP'
 16466                                AND 'AHL')
 16467           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16468              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16469              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16470              MOVE '6' TO CP-EARNING-METHOD
 16471           END-IF
 16472        END-IF
 16473        IF PB-COMPANY-ID = 'CID'
 16474           IF NO-LIFE-COVERAGE
 16475              IF CP-CRITICAL-PERIOD
 16476                 MOVE '2'       TO CP-EARNING-METHOD
 16477              ELSE
 16478                 MOVE '6'       TO CP-EARNING-METHOD
 16479              END-IF
 16480           ELSE
 16481              IF WS-LF-COVERAGE-TYPE = 'L'
 16482                 MOVE '2'       TO CP-EARNING-METHOD
 16483              ELSE
 16484                 IF (PB-CI-LF-TERM > +60) OR
 16485                    (WS-LF-EARNINGS-CALC = '5')
 16486                    IF CP-CRITICAL-PERIOD
 16487                       MOVE '2'  TO CP-EARNING-METHOD
 16488                    ELSE
 16489                       MOVE '6'  TO CP-EARNING-METHOD
 16490                    END-IF
 16491                 ELSE
 16492                    MOVE '1'     TO CP-EARNING-METHOD
 16493                 END-IF
 16494              END-IF
 16495           END-IF
 16496        END-IF
 16497     END-IF
 16498
 16499*    IF CP-STATE-STD-ABBRV = 'VA'
 16500*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16501*          IF CP-ORIGINAL-TERM GREATER 61
 16502*             MOVE '6' TO CP-EARNING-METHOD
 16503*          ELSE
 16504*             MOVE '1' TO CP-EARNING-METHOD.
 16505
 16506     IF WS-DEFAULT-APR NOT NUMERIC
 16507         MOVE ZEROS TO WS-DEFAULT-APR.
 16508     IF CP-EARN-AS-NET-PAY
 16509         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16510            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16511                MOVE WS-DEFAULT-APR
 16512                                 TO  CP-LOAN-APR
 16513                MOVE ER-3780     TO  WS-ERROR
 16514                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16515            ELSE
 16516                MOVE ER-3781     TO  WS-ERROR
 16517                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16518     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16519     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 298
* EL050.cbl
 16520        AND CP-CANCEL-REASON = 'R'
 16521        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16522        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16523     END-IF
 16524     IF PB-COMPANY-ID = 'DCC'
 16525        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16526        AND (CP-EARNING-METHOD = 'D')
 16527        AND (CP-CANCEL-REASON NOT = 'R')
 16528        CONTINUE
 16529     ELSE
 16530        GO TO 3750-CONTINUE
 16531     END-IF
 16532     MOVE ' '                    TO DD-IU-SW
 16533     IF NOT PDEF-MASTER-FOUND
 16534        MOVE ' '                 TO PDEF-MASTER-SW
 16535        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16536        MOVE PB-STATE            TO ERPDEF-STATE
 16537        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16538           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16539        END-IF
 16540        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16541        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16542        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16543        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16544        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16545        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16546        IF PDEF-MASTER-FOUND
 16547           MOVE 'N'              TO PDEF-MASTER-SW
 16548           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16549           IF PDEF-MASTER-FOUND
 16550              IF (ERPDEF-KEY-SAVE (1:16) =
 16551                           PD-CONTROL-PRIMARY (1:16))
 16552                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16553                 CONTINUE
 16554              ELSE
 16555                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16556                 IF (ERPDEF-KEY-SAVE (1:16) =
 16557                           PD-CONTROL-PRIMARY (1:16))
 16558                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16559                    CONTINUE
 16560                 ELSE
 16561                    MOVE ER-2740 TO WS-ERROR
 16562                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16563                    GO TO 3770-CHECK-REFUNDS
 16564                 END-IF
 16565              END-IF
 16566           END-IF
 16567           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16568        END-IF
 16569     END-IF
 16570     IF PDEF-MASTER-FOUND
 16571        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16572           (V1 > +8)
 16573           OR (PD-PROD-CODE (V1) = 'I')
 16574        END-PERFORM
 16575        IF V1 < +9
 16576           SET DD-IU-PRESENT        TO TRUE
 16577        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 299
* EL050.cbl
 16578        IF WS-AH-DCC-TRUNC = 'T'
 16579           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16580        ELSE
 16581           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16582        END-IF
 16583        EVALUATE TRUE
 16584           WHEN WS-TERM > +168
 16585              MOVE 15               TO V1
 16586           WHEN WS-TERM > +156
 16587              MOVE 14               TO V1
 16588           WHEN WS-TERM > +144
 16589              MOVE 13               TO V1
 16590           WHEN WS-TERM > +132
 16591              MOVE 12               TO V1
 16592           WHEN WS-TERM > +120
 16593              MOVE 11               TO V1
 16594           WHEN WS-TERM > +108
 16595              MOVE 10               TO V1
 16596           WHEN WS-TERM > +96
 16597              MOVE 9                TO V1
 16598           WHEN WS-TERM > +84
 16599              MOVE 8                TO V1
 16600           WHEN WS-TERM > +72
 16601              MOVE 7                TO V1
 16602           WHEN WS-TERM > +60
 16603              MOVE 6                TO V1
 16604           WHEN WS-TERM > +48
 16605              MOVE 5                TO V1
 16606           WHEN WS-TERM > +36
 16607              MOVE 4                TO V1
 16608           WHEN WS-TERM > +24
 16609              MOVE 3                TO V1
 16610           WHEN WS-TERM > +12
 16611              MOVE 2                TO V1
 16612           WHEN OTHER
 16613              MOVE 1                TO V1
 16614        END-EVALUATE
 16615
 16616        EVALUATE TRUE
 16617*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16618*             < +13)
 16619*             AND (DD-IU-PRESENT)
 16620*             MOVE 2                TO V2
 16621*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16622*             MOVE 1                TO V2
 16623           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16624              MOVE 2                TO V2
 16625           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16626              MOVE 3                TO V2
 16627           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16628              MOVE 4                TO V2
 16629           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16630              MOVE 5                TO V2
 16631           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16632              MOVE 6                TO V2
 16633           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16634              MOVE 7                TO V2
 16635           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 300
* EL050.cbl
 16636              MOVE 8                TO V2
 16637           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16638              MOVE 9                TO V2
 16639           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16640              MOVE 10               TO V2
 16641           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16642              MOVE 11               TO V2
 16643           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16644              MOVE 12               TO V2
 16645           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16646              MOVE 13               TO V2
 16647           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16648              MOVE 14               TO V2
 16649           WHEN OTHER
 16650              MOVE 15               TO V2
 16651        END-EVALUATE
 16652
 16653        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16654                                 TO CP-DDF-LO-FACT
 16655        MOVE PD-UEP-FACTOR (V1 V2)
 16656                                 TO CP-DDF-HI-FACT
 16657
 16658        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16659        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16660        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16661           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16662        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16663        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16664        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16665           + PD-1ST-YR-ADMIN-ALLOW
 16666
 16667        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16668*       IF PI-CLP-YN = 'Y'
 16669*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16670*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16671*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16672*       END-IF
 16673
 16674        IF DD-IU-PRESENT
 16675           MOVE 'I'              TO CP-EARNING-METHOD
 16676        END-IF
 16677        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16678                                     CP-CLP-RATE-UP
 16679        IF CP-IU-RATE-UP NOT = ZEROS
 16680           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16681              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16682           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16683              / (1 - WS-WORK-FACT)
 16684        END-IF
 16685     END-IF
 16686     .
 16687 3750-CONTINUE.
 16688     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16689
 16690     IF CP-REFUND-TYPE-USED NOT = SPACE
 16691         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16692
 16693     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 301
* EL050.cbl
 16694        CP-ERROR-RATE-NOT-FOUND
 16695        MOVE ER-2740             TO WS-ERROR
 16696        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16697
 16698     IF CP-ERROR-RATE-FILE-NOTOPEN
 16699        MOVE ER-2617             TO WS-ERROR
 16700        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16701     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16702        AND (PB-CI-ENTRY-STATUS = 'M')
 16703        MOVE +0                  TO PB-C-AH-REF-CALC
 16704     ELSE
 16705        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16706     END-IF
 16707     if pb-company-id = 'VPP'
 16708        MOVE cm-ah-clp           to cp-original-premium
 16709        move zeros               to cp-calc-refund
 16710        perform 7600-get-refund  thru 7600-exit
 16711        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16712           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16713        else
 16714           move zeros            to pb-c-ah-rfnd-clp
 16715        end-if
 16716        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16717           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16718           pb-ci-cancel-fee
 16719     end-if
 16720     IF PB-COMPANY-ID = 'DCC'
 16721        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16722        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16723        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16724        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16725        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16726        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16727        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16728        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16729*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16730     END-IF
 16731     .
 16732 3770-CHECK-REFUNDS.
 16733
 16734     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16735        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16736           MOVE ER-2766          TO WS-ERROR
 16737           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16738           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16739           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16740              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16741
 16742     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16743        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16744           MOVE ER-2766          TO WS-ERROR
 16745           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16746           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16747           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16748              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16749
 16750     IF PB-COMP-LF-CANCEL
 16751        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 302
* EL050.cbl
 16752        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16753           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16754              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16755
 16756     IF PB-COMP-AH-CANCEL
 16757        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16758        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16759           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16760              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16761
 16762     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16763             GIVING WS-UNSIGN-WRK1
 16764     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16765             GIVING WS-UNSIGN-WRK2.
 16766
 16767     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16768         MOVE ZERO TO WS-UNSIGN-WRK1.
 16769
 16770     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16771         MOVE ZERO TO WS-UNSIGN-WRK2.
 16772
 16773     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16774
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 303
* EL050.cbl
 16776
 16777 3772-CONTINUE.
 16778
 16779**********************************
 16780*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16781*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16782*** DOUBLES THE TOLERANCE AMOUNT.
 16783***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16784**********************************
 16785     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16786     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16787         IF WS-REF-REJECT-SW = SPACE
 16788             MOVE ER-2754        TO WS-ERROR
 16789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16790           ELSE
 16791             MOVE ER-2736        TO WS-ERROR
 16792             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16793**********************************
 16794
 16795 3773-CONTINUE.
 16796
 16797     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16798        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16799           MOVE ER-2723          TO WS-ERROR
 16800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16801
 16802     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16803        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16804           MOVE ER-2724          TO WS-ERROR
 16805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16806
 16807     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16808         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16809             (1 + WS-LF-REFUND-OVS-PCT)
 16810     ELSE
 16811         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16812
 16813     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16814         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16815             (1 - WS-TOL-LF-REFUND-PCT)
 16816     ELSE
 16817         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16818
 16819     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16820        AND (PB-CI-ENTRY-STATUS = 'M')
 16821        AND (PB-C-LF-CANCEL-AMT > +0)
 16822        MOVE ER-3843             TO WS-ERROR
 16823        PERFORM 9900-ERROR-FORMAT
 16824                                 THRU 9900-EXIT
 16825     END-IF
 16826     EVALUATE TRUE
 16827        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16828           CONTINUE
 16829        WHEN PB-C-LF-CANCEL-AMT = +0
 16830                 AND PB-C-LF-REF-CALC > +0
 16831           CONTINUE
 16832        WHEN WS-LF-REFUND-OVS-AMT = 0
 16833                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 304
* EL050.cbl
 16834           CONTINUE
 16835        WHEN OTHER
 16836           IF WS-TOL-LF-REFUND  = +0
 16837              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16838           END-IF
 16839           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16840                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16841                          (PB-C-LF-CANCEL-AMT))
 16842              CONTINUE
 16843           ELSE
 16844              IF WS-LF-REFUND-OVS-AMT = +0
 16845                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16846              END-IF
 16847              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16848                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16849                                       PB-C-LF-CANCEL-AMT)
 16850                 CONTINUE
 16851              ELSE
 16852                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16853                   MOVE ER-2754   TO  WS-ERROR
 16854                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16855                 ELSE
 16856                    MOVE ER-2736   TO  WS-ERROR
 16857                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16858                 END-IF
 16859              END-IF
 16860           END-IF
 16861     END-EVALUATE.
 16862
 16863     EVALUATE TRUE
 16864        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16865           CONTINUE
 16866        WHEN PB-C-LF-CANCEL-AMT = +0
 16867                 AND PB-C-LF-REF-CALC > +0
 16868           CONTINUE
 16869        WHEN OTHER
 16870           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16871               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16872              CONTINUE
 16873           ELSE
 16874              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16875               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16876                CONTINUE
 16877              ELSE
 16878                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16879                     MOVE ER-2754   TO  WS-ERROR
 16880                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16881                 ELSE
 16882                     MOVE ER-2736   TO  WS-ERROR
 16883                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16884                 END-IF
 16885              END-IF
 16886           END-IF
 16887     END-EVALUATE.
 16888
 16889     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16890         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16891             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 305
* EL050.cbl
 16892     ELSE
 16893         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16894
 16895     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16896         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16897             (1 - WS-TOL-AH-REFUND-PCT)
 16898     ELSE
 16899         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16900
 16901     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16902        AND (PB-CI-ENTRY-STATUS = 'M')
 16903        AND (PB-C-AH-CANCEL-AMT > +0)
 16904        MOVE ER-3843             TO WS-ERROR
 16905        PERFORM 9900-ERROR-FORMAT
 16906                                 THRU 9900-EXIT
 16907     END-IF
 16908     EVALUATE TRUE
 16909        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16910           CONTINUE
 16911*       WHEN PB-C-AH-REF-CALC = +0 AND
 16912*                  PB-C-AH-CANCEL-AMT > +0
 16913        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16914                   PB-C-AH-REF-CALC > +0
 16915           CONTINUE
 16916        WHEN WS-AH-REFUND-OVS-AMT = +0
 16917                AND WS-TOL-AH-REFUND = +0
 16918           CONTINUE
 16919        WHEN OTHER
 16920           IF WS-TOL-AH-REFUND = +0
 16921              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16922           END-IF
 16923           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16924               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16925                                         PB-C-AH-CANCEL-AMT)
 16926              CONTINUE
 16927           ELSE
 16928              IF WS-AH-REFUND-OVS-AMT = +0
 16929                 MOVE +9999999.99 TO
 16930                         WS-AH-REFUND-OVS-AMT
 16931              END-IF
 16932              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16933                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16934                                         PB-C-AH-CANCEL-AMT)
 16935                 CONTINUE
 16936              ELSE
 16937                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16938                    MOVE ER-2754   TO  WS-ERROR
 16939                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16940                 ELSE
 16941                    MOVE ER-2736   TO  WS-ERROR
 16942                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16943                 END-IF
 16944              END-IF
 16945           END-IF
 16946     END-EVALUATE.
 16947
 16948     EVALUATE TRUE
 16949        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 306
* EL050.cbl
 16950           CONTINUE
 16951*       WHEN PB-C-AH-REF-CALC > +0 AND
 16952*                  PB-C-AH-CANCEL-AMT = +0
 16953        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16954                   PB-C-AH-REF-CALC = +0
 16955           CONTINUE
 16956        WHEN OTHER
 16957           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16958               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16959              CONTINUE
 16960           ELSE
 16961              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16962                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16963                 CONTINUE
 16964              ELSE
 16965                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16966                     MOVE ER-2754   TO  WS-ERROR
 16967                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16968                 ELSE
 16969                     MOVE ER-2736   TO  WS-ERROR
 16970                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16971                 END-IF
 16972              END-IF
 16973           END-IF
 16974     END-EVALUATE.
 16975
 16976     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16977        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16978        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16979           AND  PB-C-LF-REF-CALC < +1.00
 16980           AND  PB-C-AH-REF-CALC < +1.00
 16981           CONTINUE
 16982        ELSE
 16983           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16984              AND (PB-CI-ENTRY-STATUS = 'M')
 16985              CONTINUE
 16986           ELSE
 16987              MOVE ER-2741       TO WS-ERROR
 16988              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16989           END-IF
 16990        END-IF
 16991     END-IF
 16992
 16993     IF (PB-C-LF-CANCEL-AMT = ZERO
 16994        AND WS-LF-BENEFIT-CD NOT = ZERO
 16995        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16996        AND PB-C-LF-REF-CALC NOT = ZERO)
 16997        OR
 16998        (PB-C-LF-CANCEL-AMT = ZERO
 16999        AND WS-LF-BENEFIT-CD NOT = ZERO
 17000        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17001             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17002                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17003                NEXT SENTENCE
 17004             ELSE
 17005                MOVE ER-2739        TO WS-ERROR
 17006                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17007
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 307
* EL050.cbl
 17008     IF (PB-C-AH-CANCEL-AMT = ZERO
 17009        AND WS-AH-BENEFIT-CD NOT = ZERO
 17010        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17011        AND PB-C-AH-REF-CALC NOT = ZERO)
 17012        OR
 17013        (PB-C-AH-CANCEL-AMT = ZERO
 17014        AND WS-AH-BENEFIT-CD NOT = ZERO
 17015        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17016             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17017                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17018                NEXT SENTENCE
 17019             ELSE
 17020                MOVE ER-2738        TO WS-ERROR
 17021                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17022
 17023 3775-OVER-REF-CHK.
 17024
 17025     IF PB-CI-ENTRY-STATUS = '5'
 17026        GO TO 3780-UPDATE-CANCEL-CERT.
 17027
 17028     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17029                              PB-CI-LF-ALT-PREMIUM-AMT.
 17030
 17031     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17032        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17033                                 PB-C-LF-REF-CALC
 17034      ELSE
 17035        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17036                                 PB-C-LF-CANCEL-AMT.
 17037
 17038     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17039        MOVE ER-2755             TO WS-ERROR
 17040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17041
 17042     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17043
 17044     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17045        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17046                                 PB-C-AH-REF-CALC
 17047      ELSE
 17048        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17049                                 PB-C-AH-CANCEL-AMT.
 17050
 17051     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17052        MOVE ER-2778             TO WS-ERROR
 17053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17054
 17055     IF PB-CI-OB-FLAG NOT = 'Z'
 17056        NEXT SENTENCE
 17057       ELSE
 17058         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17059            MOVE ER-2757           TO WS-ERROR
 17060            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17061
 17062 3780-UPDATE-CANCEL-CERT.
 17063
 17064     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17065        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 308
* EL050.cbl
 17066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17067
 17068     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17069         MOVE ER-2729              TO WS-ERROR
 17070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17071
 17072     IF PB-CI-LF-BENEFIT-CD = ZERO
 17073         GO TO 3780-UPDATE-CONT-1.
 17074
 17075     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17076         GO TO 3780-UPDATE-CONT-1.
 17077
 17078     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17079       AND
 17080        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17081       AND
 17082        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17083       AND
 17084        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17085            NEXT SENTENCE
 17086       ELSE
 17087        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17088          AND
 17089***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17090***       AND
 17091           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17092            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17093               MOVE ER-2730      TO WS-ERROR
 17094               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17095               GO TO 3999-END-EDIT
 17096            ELSE
 17097               GO TO 3999-END-EDIT
 17098        ELSE
 17099            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17100               MOVE ER-2765           TO WS-ERROR
 17101               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17102               GO TO 3785-CHECK-NH.
 17103*              GO TO 3999-END-EDIT.
 17104
 17105 3780-UPDATE-CONT-1.
 17106     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17107
 17108     IF PB-CI-AH-BENEFIT-CD = ZERO
 17109         GO TO 3780-UPDATE-CONT-2.
 17110
 17111     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17112         GO TO 3780-UPDATE-CONT-2.
 17113
 17114     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17115
 17116     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17117       AND
 17118        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17119       AND
 17120        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17121       AND
 17122        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17123            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 309
* EL050.cbl
 17124       ELSE
 17125        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17126          AND
 17127***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17128***       AND
 17129           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17130           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17131            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17132               MOVE ER-2773      TO WS-ERROR
 17133               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17134               GO TO 3999-END-EDIT
 17135            ELSE
 17136               GO TO 3999-END-EDIT
 17137            END-IF
 17138           ELSE
 17139             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17140                IF MSTR-CERT-NO = W-CL-CERT-NO
 17141                   MOVE ER-2890 TO WS-ERROR
 17142                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17143                   GO TO 3999-END-EDIT
 17144                ELSE
 17145                   MOVE ER-2898 TO WS-ERROR
 17146                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17147                   GO TO 3999-END-EDIT
 17148                END-IF
 17149             ELSE
 17150                GO TO 3785-CHECK-NH
 17151             END-IF
 17152           END-IF
 17153          ELSE
 17154            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17155              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17156                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17157                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17158                      MOVE ER-2890 TO WS-ERROR
 17159                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17160                      GO TO 3999-END-EDIT
 17161                   ELSE
 17162                      MOVE ER-2898 TO WS-ERROR
 17163                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17164                      GO TO 3999-END-EDIT
 17165                   END-IF
 17166                ELSE
 17167                   MOVE ER-2765 TO WS-ERROR
 17168                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17169                   GO TO 3785-CHECK-NH
 17170                END-IF
 17171              ELSE
 17172               MOVE ER-2765      TO WS-ERROR
 17173               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17174               GO TO 3785-CHECK-NH.
 17175*              GO TO 3999-END-EDIT.
 17176
 17177 3780-UPDATE-CONT-2.
 17178
 17179     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17180        AND WS-LF-BENEFIT-CD = ZERO
 17181           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 310
* EL050.cbl
 17182           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17183
 17184     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17185        AND WS-AH-BENEFIT-CD = ZERO
 17186           MOVE ER-2744           TO WS-ERROR
 17187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17188
 17189     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17190        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17191        AND
 17192        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17193         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17194           MOVE ER-2746           TO WS-ERROR
 17195           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17196
 17197     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17198       AND
 17199        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17200             MOVE ER-2737        TO WS-ERROR
 17201             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17202
 17203     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17204       AND
 17205        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17206             MOVE ER-2737        TO WS-ERROR
 17207             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17208
 17209     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17210         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17211             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17212             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17213         ELSE
 17214             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17215                 MOVE ER-2768    TO WS-ERROR
 17216                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17217             ELSE
 17218                 MOVE ER-2756    TO WS-ERROR
 17219                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17220
 17221     IF CERT-PEND-ISSUE-RETURNED
 17222        MOVE ER-2772             TO WS-ERROR
 17223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17224 3785-CHECK-NH.
 17225*    IF PB-STATE NOT = 'NH' and 'TN'
 17226     IF PB-STATE NOT = 'NH'
 17227        GO TO 3999-END-EDIT
 17228     END-IF
 17229
 17230     MOVE ER-2796                TO WS-ERROR
 17231     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17232     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17233        OR (CM-NH-INTERFACE-SW = 'Y')
 17234        MOVE ER-2793             TO WS-ERROR
 17235        PERFORM 9900-ERROR-FORMAT
 17236                                 THRU 9900-EXIT
 17237     END-IF
 17238     MOVE +0                     TO WS-PAYMENT-AMT
 17239     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 311
* EL050.cbl
 17240        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17241               PB-C-AH-CANCEL-DT
 17242           GO TO 3999-END-EDIT
 17243        END-IF
 17244     end-if
 17245***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17246***-_-
 17247***-_-   For TN it's only flat cancels
 17248***-_-
 17249***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17250     if pb-state = 'TN'
 17251        if ((pb-c-lf-cancel-dt <> low-values)
 17252           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17253                      or
 17254           ((pb-c-ah-cancel-dt <> low-values)
 17255           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17256           GO TO 3999-END-EDIT
 17257        END-IF
 17258     end-if
 17259     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17260        GO TO 3999-END-EDIT
 17261     END-IF
 17262***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17263***-_-
 17264***-_-   if cancel date within 15 days of effective date, bypass
 17265***-_-
 17266***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17267     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17268     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17269     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17270        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17271     END-IF
 17272     MOVE '1'                    TO DC-OPTION-CODE
 17273     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17274     IF NO-CONVERSION-ERROR
 17275        and pb-state = 'NH'
 17276        IF DC-ELAPSED-DAYS < +16
 17277           GO TO 3999-END-EDIT
 17278        END-IF
 17279     END-IF
 17280***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17281***-_-
 17282***-_-   if cancel date within 30 days of current date then
 17283***-_-   bypass else subtract 15 days from period
 17284***-_-
 17285***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17286     MOVE +0                     TO DC-ELAPSED-DAYS
 17287     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17288     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17289     MOVE '1'                    TO DC-OPTION-CODE
 17290     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17291     IF NO-CONVERSION-ERROR
 17292        IF DC-ELAPSED-DAYS > +30
 17293           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17294        ELSE
 17295           GO TO 3999-END-EDIT
 17296        END-IF
 17297     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 312
* EL050.cbl
 17298        GO TO 3999-END-EDIT
 17299     END-IF
 17300***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17301***-_-
 17302***-_-   'NH' is 10%, TN is 3.5%
 17303***-_-
 17304***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17305     if pb-state = 'NH'
 17306        move +1.10               to ws-work-rate
 17307     else
 17308        move +1.035              to ws-work-rate
 17309     end-if
 17310     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17311        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17312           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17313     IF WS-PAYMENT-AMT < 600.00
 17314        GO TO 3999-END-EDIT
 17315     END-IF
 17316     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17317
 17318     IF (ERMAIL-FOUND = ' ')
 17319         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17320         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17321        GO TO 3999-END-EDIT
 17322     END-IF
 17323     MOVE ER-2795                TO WS-ERROR
 17324     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17325
 17326     GO TO 3999-END-EDIT.
 17327******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 313
* EL050.cbl
 17329 3990-FILES-NOT-OPEN.
 17330
 17331     MOVE ER-2617                TO WS-ERROR.
 17332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17333     GO TO 9990-RETURN.
 17334
 17335 3999-END-EDIT.
 17336
 17337     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17338
 17339     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17340         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17341         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17342             PERFORM 9250-UNLOCK-RETURN
 17343             GO TO 9990-RETURN
 17344          ELSE
 17345             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17346             GO TO 9990-RETURN.
 17347
 17348     IF PB-CANCELLATION
 17349          GO TO 9990-RETURN.
 17350
 17351     IF CERT-WAS-NOT-FOUND
 17352        MOVE SPACES              TO CERTIFICATE-MASTER.
 17353
 17354     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17355
 17356     IF CERT-WAS-FOUND
 17357         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17358             PERFORM 9250-UNLOCK-RETURN
 17359          ELSE
 17360            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17361      ELSE
 17362         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17363
 17364     if pb-company-id = 'VPP'
 17365        perform 8150-read-elcrtt thru 8150-exit
 17366        if ws-vehicle-odometer numeric
 17367           if ws-vehicle-odometer > 6000
 17368              move er-1583       to ws-error
 17369              PERFORM 9900-ERROR-FORMAT
 17370                                 THRU 9900-EXIT
 17371           end-if
 17372        end-if
 17373     end-if
 17374     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17375        IF ((PB-COMPANY-ID = 'DCC')
 17376           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17377                         or
 17378            (pb-company-id = 'CID' or 'VPP')
 17379            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17380        END-IF
 17381     END-IF.
 17382
 17383     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17384         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17385     END-IF.
 17386     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 314
* EL050.cbl
 17387     perform 8150-read-elcrtt    thru 8150-exit
 17388     if ws-ins-age-defaulted = 'Y'
 17389        move er-1573             to ws-error
 17390        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17391     end-if
 17392
 17393     if ws-jnt-age-defaulted = 'Y'
 17394        move er-1574             to ws-error
 17395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17396     end-if
 17397***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17398***                                                           ****
 17399***  Set an error if the state requires verification of agent ****
 17400***  and agent hasn't verified yet and the status is not =    ****
 17401***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17402***  and the entry date > 09/01/2015.                         ****
 17403***                                                           ****
 17404***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17405     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17406        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17407        and (pb-account (9:2) not = 'OB')
 17408        if (ws-st-agent-sig-edit = 'Y')
 17409           and (am-report-code-1 not = 'CONLEY')
 17410           evaluate true
 17411              when cs-agent-edit-status = 'C'
 17412                 move er-1743    to ws-error
 17413                 perform 9900-error-format
 17414                                 thru 9900-exit
 17415              when cs-agent-edit-status = 'S'
 17416                 move er-1744    to ws-error
 17417                 perform 9900-error-format
 17418                                 thru 9900-exit
 17419              when cs-agent-edit-status = 'M'
 17420                 move er-1745    to ws-error
 17421                 perform 9900-error-format
 17422                                 thru 9900-exit
 17423              when cs-agent-edit-status = 'R'
 17424                 move er-1747    to ws-error
 17425                 perform 9900-error-format
 17426                                 thru 9900-exit
 17427              when cs-agent-edit-status = 'N'
 17428                 move er-1748    to ws-error
 17429                 perform 9900-error-format
 17430                                 thru 9900-exit
 17431              when cs-agent-edit-status <> 'V' and 'U' and
 17432                                           'R' and 'N'
 17433                 move er-1746    to ws-error
 17434                 perform 9900-error-format
 17435                                 thru 9900-exit
 17436           end-evaluate
 17437        end-if
 17438     end-if
 17439     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17440     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17441        AND (WS-NO-SECURE-PAY))
 17442                  OR
 17443        (WS-LF-SPECIAL-CALC-CD = 'O'
 17444        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 315
* EL050.cbl
 17445        SET SKIP-ADDR-EDIT       TO TRUE
 17446     END-IF
 17447     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17448        AND (NOT SKIP-ADDR-EDIT)
 17449        MOVE ER-2963             TO WS-ERROR
 17450        PERFORM 9900-ERROR-FORMAT
 17451                                 THRU 9900-EXIT
 17452        GO TO 9990-RETURN
 17453     END-IF
 17454     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17455     IF ERPNDM-FOUND NOT = 'X'
 17456        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17457           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17458           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17459           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17460           AND (NOT SKIP-ADDR-EDIT)
 17461           MOVE ER-2694          TO WS-ERROR
 17462           PERFORM 9900-ERROR-FORMAT
 17463                                 THRU 9900-EXIT
 17464        END-IF
 17465        MOVE ' '                 TO STATE-RECORD-ERROR
 17466        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17467        MOVE PM-STATE            TO CNTL-ACCESS
 17468        MOVE '3'                 TO CNTL-REC-TYPE
 17469        MOVE +0                  TO CNTL-SEQ-NO
 17470        MOVE '0'                 TO RC-SW-2
 17471        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17472        IF (NO-STATE-RECORD)
 17473           OR (CF-RECORD-TYPE NOT = '3')
 17474           OR (PM-STATE NOT = CF-STATE-CODE)
 17475           IF (PM-STATE = SPACES)
 17476              AND (SKIP-ADDR-EDIT)
 17477              CONTINUE
 17478           ELSE
 17479              MOVE ER-2963       TO WS-ERROR
 17480              PERFORM 9900-ERROR-FORMAT
 17481                                 THRU 9900-EXIT
 17482           END-IF
 17483        END-IF
 17484        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17485           MOVE ER-2883          TO WS-ERROR
 17486           PERFORM 9900-ERROR-FORMAT
 17487                                 THRU 9900-EXIT
 17488        END-IF
 17489        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17490           MOVE ' '                 TO STATE-RECORD-ERROR
 17491           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17492           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17493           MOVE '3'                 TO CNTL-REC-TYPE
 17494           MOVE +0                  TO CNTL-SEQ-NO
 17495           MOVE '0'                 TO RC-SW-2
 17496           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17497           IF NO-STATE-RECORD
 17498              OR (CF-RECORD-TYPE NOT = '3')
 17499              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17500              MOVE ER-2964          TO WS-ERROR
 17501              PERFORM 9900-ERROR-FORMAT
 17502                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 316
* EL050.cbl
 17503           END-IF
 17504        END-IF
 17505     ELSE
 17506        IF NOT SKIP-ADDR-EDIT
 17507           MOVE ER-2393          TO WS-ERROR
 17508           PERFORM 9900-ERROR-FORMAT
 17509                                 THRU 9900-EXIT
 17510        END-IF
 17511     END-IF
 17512
 17513     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17514
 17515     IF (ERMAIL-FOUND = ' ' AND
 17516        ERPNDM-FOUND = ' ')
 17517        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17518           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17519           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17520          OR
 17521           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17522          OR
 17523           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17524           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17525           GO TO 3999-UNLOCK-ERMAIL.
 17526
 17527     IF ERPNDM-FOUND = 'X'
 17528        GO TO 3999-UNLOCK-ERMAIL.
 17529
 17530     IF PM-INSURED-LAST-NAME      = SPACES
 17531        AND PM-INSURED-FIRST-NAME = SPACES
 17532        AND PM-ADDRESS-LINE-1     = SPACES
 17533        AND PM-ADDRESS-LINE-2     = SPACES
 17534        AND PM-CITY-STATE         = SPACES
 17535        AND PM-CRED-BENE-NAME     = SPACES
 17536        AND PM-CRED-BENE-ADDR     = SPACES
 17537        AND PM-CRED-BENE-CTYST    = SPACES
 17538        GO TO 3999-UNLOCK-ERMAIL
 17539     END-IF
 17540
 17541     MOVE SPACES                 TO MAILING-DATA.
 17542
 17543     MOVE 'MA'                   TO MA-RECORD-ID.
 17544     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17545     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17546     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17547     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17548     MOVE PB-SV-STATE            TO MA-STATE.
 17549     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17550     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17551
 17552     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17553     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17554
 17555     IF ERMAIL-FOUND = ' '
 17556        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17557     ELSE
 17558        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17559        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17560        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 317
* EL050.cbl
 17561
 17562     GO TO 9990-RETURN.
 17563
 17564 3999-UNLOCK-ERMAIL.
 17565     IF ERMAIL-FOUND = ' '
 17566        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17567
 17568     GO TO 9990-RETURN.
 17569******************************************************************
 17570
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 318
* EL050.cbl
 17572 4000-UPDATE-CANCELLED-CERT.
 17573     IF CERT-WAS-NOT-FOUND
 17574        GO TO 4299-EXIT.
 17575
 17576*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17577     IF PB-C-NH-INT-ON-REFS > ZEROS
 17578        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17579     END-IF
 17580     IF PB-C-REF-INTERFACE-SW = 'Y'
 17581        MOVE PB-C-REF-INTERFACE-SW
 17582                                 TO CM-NH-INTERFACE-SW
 17583     END-IF
 17584     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17585     IF ERMAIL-FOUND = 'X'
 17586        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17587        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17588        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17589        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17590           MOVE ER-2694          TO WS-ERROR
 17591           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17592     END-IF
 17593
 17594     IF PB-C-POST-CARD-IND = 'Y'
 17595        MOVE +8                  TO SUB
 17596*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17597        IF ERMAIL-FOUND = ' '
 17598           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17599              (SUB > +7)
 17600              OR (MA-MAIL-STATUS (SUB) = '1')
 17601           END-PERFORM
 17602        END-IF
 17603        IF (SUB > +7)
 17604           OR (ERMAIL-FOUND = 'X')
 17605           MOVE ER-3789          TO WS-ERROR
 17606           PERFORM 9900-ERROR-FORMAT
 17607                                 THRU 9900-EXIT
 17608        END-IF
 17609     ELSE
 17610        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17611     END-IF
 17612
 17613     IF ERMAIL-FOUND = ' '
 17614        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17615     END-IF.
 17616
 17617     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17618
 17619     IF PB-CI-OB-FLAG = 'Z'
 17620        GO TO 4150-SUMMARY-CERT-CANCEL.
 17621
 17622     IF PB-C-LF-CANCEL-VOIDED
 17623         PERFORM 4200-REVERSE-LF-CANCEL.
 17624     IF PB-C-AH-CANCEL-VOIDED
 17625         PERFORM 4200-REVERSE-AH-CANCEL.
 17626
 17627 4100-APPLY-LF-CANCEL.
 17628
 17629     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 319
* EL050.cbl
 17630
 17631 4100-CHECK-LF-ERRORS.
 17632
 17633     ADD +1                       TO WS-SUB.
 17634
 17635     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17636        IF LF-COVERAGE-CANCELLED
 17637           GO TO 4100-LF-CANCEL-CONT
 17638        ELSE
 17639           GO TO 4100-UPDATE-LF-COVERAGE.
 17640
 17641     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17642                                   ER-2729 OR
 17643                                   ER-2730 OR
 17644                                   ER-2731 OR
 17645                                   ER-2732 OR
 17646                                   ER-2737 OR
 17647                                   ER-2740 OR
 17648                                   ER-2743 OR
 17649                                   ER-2749 OR
 17650                                   ER-2750 OR
 17651                                   ER-2755 OR
 17652                                   ER-2757 OR
 17653                                   ER-2760 OR
 17654                                   ER-2772 OR
 17655                                   ER-2774 OR
 17656                                   ER-2776 OR
 17657                                   ER-2794
 17658        GO TO 4100-UPDATE-LF-COVERAGE.
 17659
 17660     GO TO 4100-CHECK-LF-ERRORS.
 17661
 17662 4100-UPDATE-LF-COVERAGE.
 17663
 17664     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17665     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17666     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17667        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17668     END-IF
 17669     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17670                                      TO CM-CREDIT-INTERFACE-SW-2.
 17671     IF CM-LF-CANCEL-DT = LOW-VALUE
 17672         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17673
 17674     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17675         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17676                                         CM-LF-STATUS-AT-CANCEL.
 17677
 17678     GO TO 4100-APPLY-AH-CANCEL.
 17679
 17680 4100-LF-CANCEL-CONT.
 17681     IF PB-C-LF-CANCEL-VOIDED
 17682         GO TO 4100-APPLY-AH-CANCEL.
 17683
 17684     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17685         GO TO 4100-APPLY-AH-CANCEL.
 17686
 17687     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 320
* EL050.cbl
 17688        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17689           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17690        ELSE
 17691           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17692
 17693     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17694     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17695
 17696     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17697         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17698
 17699     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17700        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17701         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17702         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17703
 17704     IF PB-RECORD-RETURNED
 17705        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17706      ELSE
 17707        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17708
 17709 4100-APPLY-AH-CANCEL.
 17710
 17711     MOVE +0                      TO WS-SUB.
 17712
 17713 4100-CHECK-AH-ERRORS.
 17714
 17715     ADD +1                       TO WS-SUB.
 17716
 17717     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17718        IF AH-COVERAGE-CANCELLED
 17719           GO TO 4100-AH-CANCEL-CONT
 17720        ELSE
 17721           GO TO 4100-UPDATE-AH-COVERAGE.
 17722
 17723     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17724                                   ER-2729 OR
 17725                                   ER-2732 OR
 17726                                   ER-2737 OR
 17727                                   ER-2740 OR
 17728                                   ER-2744 OR
 17729                                   ER-2749 OR
 17730                                   ER-2750 OR
 17731                                   ER-2755 OR
 17732                                   ER-2757 OR
 17733                                   ER-2760 OR
 17734                                   ER-2771 OR
 17735                                   ER-2772 OR
 17736                                   ER-2773 OR
 17737                                   ER-2775 OR
 17738                                   ER-2777 OR
 17739                                   ER-2778 OR
 17740                                   ER-2794
 17741        GO TO 4100-UPDATE-AH-COVERAGE.
 17742
 17743     GO TO 4100-CHECK-AH-ERRORS.
 17744
 17745 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 321
* EL050.cbl
 17746
 17747     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17748     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17749     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17750     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17751                                      TO CM-CREDIT-INTERFACE-SW-2.
 17752     IF CM-AH-CANCEL-DT = LOW-VALUE
 17753         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17754
 17755     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17756         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17757                                         CM-AH-STATUS-AT-CANCEL.
 17758
 17759     IF LF-COVERAGE-CANCELLED
 17760         IF PB-RECORD-RETURNED
 17761              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17762          ELSE
 17763              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17764
 17765     GO TO 4299-EXIT.
 17766
 17767 4100-AH-CANCEL-CONT.
 17768     IF PB-C-AH-CANCEL-VOIDED
 17769         GO TO 4299-EXIT.
 17770
 17771     if cm-credit-interface-sw-2 = ' '
 17772        if pb-fatal-errors or pb-unforced-errors
 17773           move '4'              to cm-credit-interface-sw-2
 17774        else
 17775           move '1'              to cm-credit-interface-sw-2
 17776        end-if
 17777     end-if
 17778     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17779         GO TO 4299-EXIT.
 17780
 17781     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17782        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17783           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17784        ELSE
 17785           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17786
 17787     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17788     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17789
 17790     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17791         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17792
 17793     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17794         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17795         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17796
 17797     IF PB-RECORD-RETURNED
 17798        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17799      ELSE
 17800        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17801
 17802     GO TO 4299-EXIT.
 17803
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 322
* EL050.cbl
 17804 4150-SUMMARY-CERT-CANCEL.
 17805     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17806
 17807     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17808        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17809                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17810     ELSE
 17811        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17812                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17813
 17814     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17815        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17816                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17817     ELSE
 17818        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17819                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17820
 17821     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17822        NEXT SENTENCE
 17823     ELSE
 17824        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17825
 17826     GO TO 4299-EXIT.
 17827
 17828 4200-REVERSE-LF-CANCEL.
 17829     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17830
 17831     IF CM-LF-CANCEL-APPLIED
 17832        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17833        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17834        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17835
 17836     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17837
 17838     IF PB-RECORD-RETURNED
 17839        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17840       ELSE
 17841        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17842
 17843 4200-REVERSE-LF-EXIT.
 17844       EXIT.
 17845
 17846 4200-REVERSE-AH-CANCEL.
 17847     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17848
 17849     IF CM-AH-CANCEL-APPLIED
 17850        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17851        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17852        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17853
 17854     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17855
 17856     IF PB-RECORD-RETURNED
 17857        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17858       ELSE
 17859        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17860
 17861 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 323
* EL050.cbl
 17862       EXIT.
 17863
 17864 4299-EXIT.
 17865       EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 324
* EL050.cbl
 17867
 17868 4500-UPDATE-NEW-CERT.
 17869     IF CERT-WAS-FOUND
 17870         NEXT SENTENCE
 17871       ELSE
 17872         GO TO 4520-BUILD-NEW-KEY.
 17873
 17874     IF  CLASIC-CREATED-CERT
 17875         GO TO 4999-EXIT.
 17876
 17877     IF  CERT-WAS-CREATED-FOR-CLAIM
 17878         GO TO 4520-BUILD-NEW-KEY.
 17879
 17880     IF CERT-ADDED-BATCH
 17881        IF CM-RECORD-ID = 'CM'
 17882            GO TO 4999-EXIT.
 17883
 17884 4520-BUILD-NEW-KEY.
 17885* BUILD CONTROL PRIMARY
 17886
 17887     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17888                                       CM-COMPANY-CD-A1
 17889                                       CM-COMPANY-CD-A2
 17890                                       CM-COMPANY-CD-A4
 17891                                       CM-COMPANY-CD-A5.
 17892
 17893     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17894     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17895     MOVE PB-SV-STATE               TO CM-STATE.
 17896     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17897     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17898     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17899     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17900
 17901     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17902
 17903     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17904     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17905     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17906     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17907
 17908     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17909        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17910
 17911     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17912         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17913         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17914         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17915         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17916     ELSE
 17917         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17918
 17919     IF PB-COMPANY-ID   EQUAL  'CRI'
 17920         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17921         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17922         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17923         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17924         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 325
* EL050.cbl
 17925
 17926     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17927        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17928         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17929
 17930     IF PB-COMPANY-ID  = 'LBL'
 17931        IF PB-I-JOINT-COVERAGE
 17932            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17933                                           PB-I-MEMBER-NO
 17934            GO TO 4550-CONT-CERT-PROCESS.
 17935
 17936     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17937        NEXT SENTENCE
 17938     ELSE
 17939        GO TO 4540-BUILD-MEMBER-NO.
 17940
 17941******************************************************************
 17942*                                                                *
 17943*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17944*    FOR 'MON'.                                                  *
 17945*                                                                *
 17946******************************************************************
 17947
 17948     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17949     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17950     MOVE +1                     TO WS-SUB1
 17951                                    WS-SUB2.
 17952
 17953 4530-EDIT-MEMB-NAME.
 17954
 17955     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17956        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17957        ADD +1                       TO WS-SUB2.
 17958
 17959     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17960        ADD +1                       TO WS-SUB1
 17961        GO TO 4530-EDIT-MEMB-NAME.
 17962
 17963     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17964     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17965     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17966*    MOVE SPACE                      TO DC-OPTION-CODE.
 17967     SET  BIN-TO-GREG                TO TRUE.
 17968     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17969     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17970
 17971     GO TO 4550-CONT-CERT-PROCESS.
 17972
 17973******************************************************************
 17974*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17975******************************************************************
 17976
 17977 4540-BUILD-MEMBER-NO.
 17978
 17979     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17980         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17981         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17982         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 326
* EL050.cbl
 17983         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17984     ELSE
 17985         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17986
 17987     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17988        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17989         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17990
 17991 4550-CONT-CERT-PROCESS.
 17992
 17993*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17994*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17995*    ELSE
 17996*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17997
 17998     IF CERT-WAS-CREATED-FOR-CLAIM
 17999        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18000        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18001
 18002     IF CERT-AND-CLAIM-ONLINE
 18003        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18004        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18005
 18006     MOVE 'CM'                     TO CM-RECORD-ID.
 18007     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18008
 18009     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18010        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18011        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18012     ELSE
 18013        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18014        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18015
 18016     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18017     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18018     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18019     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18020     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18021     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18022     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18023                                      CM-LF-ITD-CANCEL-AMT
 18024                                      CM-LF-ITD-DEATH-AMT
 18025                                      CM-AH-ITD-AH-PMT
 18026                                      CM-AH-ITD-LUMP-PMT
 18027                                      CM-AH-ITD-CANCEL-AMT
 18028                                      CM-LF-NSP-PREMIUM-AMT
 18029                                      CM-AH-NSP-PREMIUM-AMT.
 18030*                                     CM-CLAIM-DEDUCT-WITHHELD
 18031*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18032     if pb-i-loan-apr = +99.9999
 18033        move zeros                 to cm-loan-apr
 18034     else
 18035        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18036     end-if
 18037     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18038     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18039     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18040     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 327
* EL050.cbl
 18041     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18042     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18043     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18044     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18045     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18046     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18047     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18048
 18049     IF PB-I-LIVES NOT NUMERIC
 18050         MOVE ZERO                 TO PB-I-LIVES.
 18051
 18052     IF PB-I-NUM-BILLED NOT NUMERIC
 18053         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18054
 18055     MOVE PB-I-LIVES               TO CM-LIVES.
 18056     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18057
 18058     IF PB-COMPANY-ID EQUAL  'DMD'
 18059         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18060         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18061
 18062     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18063     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18064     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18065     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18066     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18067     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18068
 18069     IF PB-I-LF-POLICY-FEE NUMERIC
 18070        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18071     ELSE
 18072        MOVE +0                    TO CM-LF-POLICY-FEE.
 18073
 18074     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18075        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18076        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18077     ELSE
 18078        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18079
 18080     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18081     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18082     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18083     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18084     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18085     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18086     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18087     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18088     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18089
 18090     IF PB-I-CANCEL-FEE NUMERIC
 18091        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18092     ELSE
 18093        MOVE +0                  TO CM-CANCEL-FEE
 18094     END-IF
 18095
 18096     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18097        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18098     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 328
* EL050.cbl
 18099        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18100
 18101     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18102     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18103
 18104     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18105                                      CM-LF-DEATH-EXIT-DT
 18106                                      CM-AH-SETTLEMENT-EXIT-DT.
 18107
 18108*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18109*                       'TIH' OR 'OFL' OR 'FLA' OR
 18110*                       'TII' OR 'TMS' OR 'CRI' OR
 18111*                       'NCL'
 18112     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18113
 18114     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18115         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18116            MOVE '2'                TO CM-PREMIUM-TYPE.
 18117
 18118     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18119         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18120            MOVE '2'                TO CM-PREMIUM-TYPE.
 18121
 18122     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18123         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18124     ELSE
 18125         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18126         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18127
 18128     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18129     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18130     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18131     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18132     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18133     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18134     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18135     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18136
 18137     IF PB-NO-MONTHS-SKIPPED
 18138         MOVE SPACE                 TO CM-SKIP-CODE
 18139     ELSE
 18140         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18141
 18142     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18143     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18144                                       CM-LF-STATUS-AT-CANCEL.
 18145
 18146     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18147     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18148                                       CM-AH-STATUS-AT-CANCEL.
 18149
 18150     MOVE '1'                       TO CM-ENTRY-STATUS.
 18151
 18152     IF PB-REISSUED-CERT
 18153        MOVE '5'                    TO CM-ENTRY-STATUS.
 18154
 18155     IF PB-MONTHLY-CERT
 18156        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 329
* EL050.cbl
 18157
 18158     IF PB-CASH-CERT
 18159        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18160
 18161     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18162     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18163     IF PB-POLICY-IS-DECLINED
 18164        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18165
 18166     IF PB-POLICY-IS-VOIDED
 18167        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18168
 18169     IF PB-NEEDS-UNDERWRITING
 18170        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18171
 18172     IF PB-REIN-ONLY-CERT
 18173        MOVE '9'                    TO CM-ENTRY-STATUS.
 18174
 18175     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18176         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18177     ELSE
 18178         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18179
 18180     IF PB-RECORD-RETURNED
 18181        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18182      ELSE
 18183        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18184
 18185     IF PB-I-MAIL-ADDRS-PRESENT
 18186        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18187
 18188     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18189                                       CM-ENTRY-DT.
 18190
 18191 4999-EXIT.
 18192     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 330
* EL050.cbl
 18194
 18195 5000-PROCESS-REPS.
 18196     MOVE ' '                    TO AGTC-MASTER-SW
 18197     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18198     MOVE CO-TYPE                TO AGTC-TYPE
 18199     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18200     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18201     IF (AGTC-MASTER-SW NOT = 'N')
 18202        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18203        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18204        PERFORM 8583-READ-ERAGTC-NEXT
 18205                                 THRU 8583-EXIT
 18206     END-IF
 18207     IF AGTC-MASTER-SW = 'N'
 18208        CONTINUE
 18209     ELSE
 18210        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18211           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18212              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18213              MOVE 'Y'           TO AGTC-MASTER-SW
 18214           END-IF
 18215        END-IF
 18216     END-IF
 18217     .
 18218 5000-EXIT.
 18219     EXIT.
 18220 6370-EDIT-INPUT-LF-CODE.
 18221     move ' ' to ws-benefit-cd-chg-sw
 18222     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18223        MOVE +1                  TO SUB
 18224        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18225        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18226        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18227        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18228        GO TO 6370-SEARCH-LOOP.
 18229
 18230     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18231
 18232     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18233     MOVE SPACES                 TO CNTL-ACCESS.
 18234*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18235     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18236     MOVE +0                     TO CNTL-SEQ-NO.
 18237     MOVE '4' TO RC-SW-2.
 18238     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18239
 18240     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18241        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18242        GO TO 6370-NO-LF-FOUND.
 18243
 18244     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18245     MOVE +1                     TO SUB.
 18246
 18247 6370-SEARCH-LOOP.
 18248     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18249         GO TO 6370-NO-LF-FOUND.
 18250
 18251     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 331
* EL050.cbl
 18252        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18253           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18254           set benefit-code-chg to true
 18255        end-if
 18256        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18257        GO TO 6370-HER-NET-PAY-CHECK.
 18258
 18259     ADD 1   TO SUB.
 18260*    IF SUB GREATER 120
 18261     IF SUB GREATER 200
 18262         GO TO 6370-NO-LF-FOUND.
 18263
 18264     GO TO 6370-SEARCH-LOOP.
 18265
 18266 6370-NO-LF-FOUND.
 18267
 18268     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18269        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18270        set benefit-code-chg to true
 18271     end-if
 18272     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18273
 18274 6370-HER-NET-PAY-CHECK.
 18275
 18276     IF PB-COMPANY-ID = 'CID'
 18277        IF PB-SV-STATE = 'CA' OR 'MN'
 18278           IF PB-I-LF-BENEFIT-CD = '02'
 18279              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18280           ELSE
 18281              IF PB-I-LF-BENEFIT-CD = '04'
 18282                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18283              END-IF
 18284           END-IF
 18285        END-IF
 18286     END-IF
 18287
 18288     IF PB-COMPANY-ID NOT = 'HER'
 18289         GO TO 6370-EXIT.
 18290
 18291     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18292         GO TO 6370-EXIT.
 18293
 18294     IF PB-I-LF-TERM NOT NUMERIC
 18295         MOVE ZEROS              TO PB-I-LF-TERM.
 18296
 18297     IF PB-I-LOAN-TERM NOT NUMERIC
 18298         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18299
 18300     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18301         GO TO 6370-EXIT.
 18302
 18303     IF PB-I-LF-BENEFIT-CD = '33'
 18304         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18305
 18306     IF PB-I-LF-BENEFIT-CD = '34'
 18307         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18308
 18309 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 332
* EL050.cbl
 18310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 333
* EL050.cbl
 18312
 18313 6380-EDIT-INPUT-AH-CODE.
 18314     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18315        MOVE +1                  TO SUB
 18316        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18317        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18318        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18319        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18320        GO TO 6380-SEARCH-LOOP.
 18321
 18322     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18323
 18324     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18325     MOVE SPACES                 TO CNTL-ACCESS.
 18326     MOVE 'A'                    TO CNTL-REC-TYPE.
 18327*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18328     MOVE +0                     TO CNTL-SEQ-NO.
 18329     MOVE '5' TO RC-SW-2.
 18330     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18331
 18332     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18333        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18334        GO TO 6380-NO-AH-FOUND.
 18335
 18336     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18337     MOVE +1 TO SUB.
 18338
 18339 6380-SEARCH-LOOP.
 18340     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18341         GO TO 6380-NO-AH-FOUND.
 18342
 18343     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18344         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18345         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18346
 18347     ADD 1   TO SUB.
 18348     IF SUB GREATER THAN 96
 18349*    IF SUB GREATER THAN 300
 18350         GO TO 6380-NO-AH-FOUND.
 18351
 18352     GO TO 6380-SEARCH-LOOP.
 18353
 18354 6380-NO-AH-FOUND.
 18355
 18356     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18357
 18358     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18359         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18360     ELSE
 18361         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18362
 18363 6380-CSO-AH-ONLY-CHECKS.
 18364
 18365     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18366        NEXT SENTENCE
 18367      ELSE
 18368        GO TO 6380-EXIT.
 18369
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 334
* EL050.cbl
 18370     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18371         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18372
 18373
 18374     GO TO 6380-EXIT
 18375     .
 18376 6380-CSO-LIFE-WITH-AH-CHECKS.
 18377
 18378
 18379     .
 18380 6380-EXIT.
 18381     EXIT.
 18382
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 335
* EL050.cbl
 18384
 18385 6400-COMPUTE-EXTENSION-DAYS.
 18386
 18387******************************************************************
 18388*                                                                *
 18389*                   COMPUTE EXTENSION DAYS                       *
 18390*                                                                *
 18391*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18392*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18393*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18394*    THE EXTENSION DAYS.                                         *
 18395*                                                                *
 18396******************************************************************
 18397
 18398     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18399     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18400
 18401******************************************************************
 18402*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18403*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18404******************************************************************
 18405
 18406     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18407        COMPUTE WS-ODD-DAYS-OVER =
 18408               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18409     ELSE
 18410        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18411
 18412     IF WS-ODD-DAYS-OVER = ZEROS
 18413           GO TO 6499-EXIT
 18414     ELSE
 18415        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18416           IF WS-WDF-MONTH = 02
 18417              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18418              ADD 2       TO  WS-ODD-DAYS-OVER
 18419              GO TO 6499-EXIT
 18420           ELSE
 18421              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18422                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18423                 GO TO 6499-EXIT
 18424               ELSE
 18425                 GO TO 6499-EXIT
 18426        ELSE
 18427           GO TO 6499-EXIT.
 18428
 18429 6412-CHECK-TO-DAY.
 18430
 18431        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18432           IF WS-WDT-DAY = 28
 18433              ADD 2              TO WS-ODD-DAYS-OVER
 18434           ELSE
 18435              IF WS-WDT-DAY = 29
 18436                 ADD 1           TO WS-ODD-DAYS-OVER
 18437              ELSE
 18438                 NEXT SENTENCE
 18439        ELSE
 18440           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18441              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 336
* EL050.cbl
 18442
 18443     GO TO 6499-EXIT.
 18444
 18445
 18446 6415-CHECK-LEAP-YEAR.
 18447
 18448     IF DC-DAYS-IN-MONTH = 29
 18449        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18450
 18451 6415-EXIT.
 18452     EXIT.
 18453
 18454 6499-EXIT.
 18455      EXIT.
 18456
 18457 6500-END.
 18458     EXIT.
 18459
 18460
 18461******************************************************************
 18462************* PROCEDURE DIVISION FOR EL050 ***********************
 18463********************** ELC50PD END *******************************
 18464
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 337
* EL050.cbl
 18466
 18467**START***********************************************************
 18468*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18469*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18470******************************************************************
 18471*
 18472 6600-GET-STATE-MUNICIPAL-TAX.
 18473
 18474     IF PB-COMPANY-ID NOT = 'DMD'
 18475         GO TO 6640-EXIT.
 18476
 18477     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18478     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18479     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18480*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18481*
 18482***  Y2K PROJ 7744
 18483     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18484     SET BIN-TO-GREG          TO TRUE.
 18485     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18486
 18487     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18488
 18489     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18490     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18491
 18492
 18493* EXEC CICS HANDLE CONDITION
 18494*        INVREQ    (6610-START-BROWSE)
 18495*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18496*        NOTFND    (6630-END-OF-FILE)
 18497*    END-EXEC.
 18498*    MOVE '"$8JI                 ! # #00018480' TO DFHEIV0
 18499     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18501     MOVE X'2320233030303138343830' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0
 18503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18504
 18505
 18506 6610-START-BROWSE.
 18507
 18508
 18509* EXEC CICS HANDLE CONDITION
 18510*        NOTFND    (6630-END-OF-FILE)
 18511*        DISABLED  (6630-ERRESS-PROBLEM)
 18512*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18513*        ENDFILE   (6630-END-OF-FILE)
 18514*    END-EXEC.
 18515*    MOVE '"$IcJ''                ! $ #00018488' TO DFHEIV0
 18516     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18518     MOVE X'2420233030303138343838' TO DFHEIV0(25:11)
 18519     CALL 'kxdfhei1' USING DFHEIV0
 18520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18521
 18522
 18523
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 338
* EL050.cbl
 18524* EXEC CICS STARTBR
 18525*        DATASET (FILE-ID-ERRESS)
 18526*        RIDFLD  (WS-ERRESS-KEY)
 18527*        GTEQ
 18528*    END-EXEC.
 18529     MOVE 0
 18530       TO DFHEIV11
 18531*    MOVE '&,         G          &   #00018495' TO DFHEIV0
 18532     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18533     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18534     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 18535     CALL 'kxdfhei1' USING DFHEIV0,
 18536           FILE-ID-ERRESS,
 18537           WS-ERRESS-KEY,
 18538           DFHEIV99,
 18539           DFHEIV11,
 18540           DFHEIV99
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544 6620-READ-NEXT-ERRESS-MASTER.
 18545
 18546
 18547* EXEC CICS HANDLE CONDITION
 18548*        NOTFND    (6630-END-OF-FILE)
 18549*        ENDFILE   (6630-END-OF-FILE)
 18550*        DISABLED  (6630-ERRESS-PROBLEM)
 18551*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18552*    END-EXEC.
 18553*    MOVE '"$I''cJ                ! % #00018503' TO DFHEIV0
 18554     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18556     MOVE X'2520233030303138353033' TO DFHEIV0(25:11)
 18557     CALL 'kxdfhei1' USING DFHEIV0
 18558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18559
 18560
 18561
 18562* EXEC CICS READNEXT
 18563*        DATASET (FILE-ID-ERRESS)
 18564*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18565*        RIDFLD  (WS-ERRESS-KEY)
 18566*    END-EXEC.
 18567     MOVE LENGTH OF
 18568      RESIDENT-STATE-TAX-MASTER
 18569       TO DFHEIV12
 18570     MOVE 0
 18571       TO DFHEIV11
 18572*    MOVE '&.IL                  )   #00018510' TO DFHEIV0
 18573     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18574     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18575     MOVE X'2020233030303138353130' TO DFHEIV0(25:11)
 18576     CALL 'kxdfhei1' USING DFHEIV0,
 18577           FILE-ID-ERRESS,
 18578           RESIDENT-STATE-TAX-MASTER,
 18579           DFHEIV12,
 18580           WS-ERRESS-KEY,
 18581           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 339
* EL050.cbl
 18582           DFHEIV11,
 18583           DFHEIV99,
 18584           DFHEIV99
 18585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18586
 18587
 18588     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18589
 18590* EXEC CICS ENDBR
 18591*            DATASET (FILE-ID-ERRESS)
 18592*       END-EXEC
 18593     MOVE 0
 18594       TO DFHEIV11
 18595*    MOVE '&2                    $   #00018517' TO DFHEIV0
 18596     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18598     MOVE X'2020233030303138353137' TO DFHEIV0(25:11)
 18599     CALL 'kxdfhei1' USING DFHEIV0,
 18600           FILE-ID-ERRESS,
 18601           DFHEIV11,
 18602           DFHEIV99
 18603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18604        GO TO 6630-END-OF-FILE.
 18605
 18606     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18607        NEXT SENTENCE
 18608      ELSE
 18609        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18610
 18611*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18612*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18613*
 18614     MOVE +2                     TO WS-SUB1.
 18615
 18616     IF PB-ISSUE
 18617     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18618        MOVE +1                  TO WS-SUB1.
 18619
 18620     IF PB-CANCELLATION
 18621     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18622        MOVE +1                  TO WS-SUB1.
 18623*
 18624*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18625*
 18626***  Y2K PROJ 7744
 18627     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18628***  Y2K PROJ 7744
 18629
 18630*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18631* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18632* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18633
 18634     ADD 1                    TO WS-YEAR-YY.
 18635
 18636     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18637         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18638                              TO WS-RES-STATE-TAX
 18639         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 340
* EL050.cbl
 18640                              TO WS-RES-MUNI-TAX
 18641     ELSE
 18642         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18643                              TO WS-RES-STATE-TAX
 18644         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18645                              TO WS-RES-MUNI-TAX.
 18646
 18647*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18648
 18649     IF PB-CANCELLATION
 18650         GO TO 6640-CANCEL-TAX.
 18651
 18652     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18653         COMPUTE PB-I-STATE-TAX ROUNDED =
 18654                                   PB-I-LF-PREMIUM-AMT
 18655                                 * WS-RES-STATE-TAX
 18656         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18657                                   PB-I-LF-PREMIUM-AMT
 18658                                 * WS-RES-MUNI-TAX
 18659     ELSE
 18660     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18661         COMPUTE PB-I-STATE-TAX ROUNDED =
 18662                                   PB-I-AH-PREMIUM-AMT
 18663                                 * WS-RES-STATE-TAX
 18664         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18665                                   PB-I-AH-PREMIUM-AMT
 18666                                 * WS-RES-MUNI-TAX.
 18667
 18668
 18669* EXEC CICS ENDBR
 18670*         DATASET (FILE-ID-ERRESS)
 18671*    END-EXEC.
 18672     MOVE 0
 18673       TO DFHEIV11
 18674*    MOVE '&2                    $   #00018584' TO DFHEIV0
 18675     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18677     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 18678     CALL 'kxdfhei1' USING DFHEIV0,
 18679           FILE-ID-ERRESS,
 18680           DFHEIV11,
 18681           DFHEIV99
 18682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18683
 18684
 18685     GO TO 6640-EXIT.
 18686
 18687 6640-CANCEL-TAX.
 18688     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18689
 18690     IF PB-C-LF-CANCEL-AMT > ZEROS
 18691         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18692                                   PB-C-LF-CANCEL-AMT
 18693                                 * WS-RES-STATE-TAX
 18694         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18695                                   PB-C-LF-CANCEL-AMT
 18696                                *  WS-RES-MUNI-TAX
 18697     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 341
* EL050.cbl
 18698     IF PB-C-AH-CANCEL-AMT > ZEROS
 18699         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18700                                   PB-C-AH-CANCEL-AMT
 18701                                 * WS-RES-STATE-TAX
 18702         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18703                                   PB-C-AH-CANCEL-AMT
 18704                                *  WS-RES-MUNI-TAX.
 18705
 18706
 18707* EXEC CICS ENDBR
 18708*         DATASET (FILE-ID-ERRESS)
 18709*    END-EXEC.
 18710     MOVE 0
 18711       TO DFHEIV11
 18712*    MOVE '&2                    $   #00018609' TO DFHEIV0
 18713     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18715     MOVE X'2020233030303138363039' TO DFHEIV0(25:11)
 18716     CALL 'kxdfhei1' USING DFHEIV0,
 18717           FILE-ID-ERRESS,
 18718           DFHEIV11,
 18719           DFHEIV99
 18720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18721
 18722
 18723     GO TO 6640-EXIT.
 18724
 18725 6630-END-OF-FILE.
 18726     MOVE ER-8002              TO WS-ERROR.
 18727     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18728
 18729     GO TO 6640-EXIT.
 18730
 18731 6630-ERRESS-PROBLEM.
 18732     MOVE ER-8044              TO WS-ERROR.
 18733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18734
 18735 6640-EXIT.
 18736     EXIT.
 18737
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 342
* EL050.cbl
 18739 6650-GET-RES-STATE-COMM.
 18740
 18741     IF PB-COMPANY-ID NOT = 'DMD'
 18742         GO TO 6700-COMM-EXIT.
 18743
 18744     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18745     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18746     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18747     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18748     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18749     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18750     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18751
 18752*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18753*
 18754***  Y2K PROJ 7744
 18755     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18756     SET BIN-TO-GREG          TO TRUE.
 18757     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18758
 18759     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18760***  Y2K PROJ 7744
 18761
 18762     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18763
 18764
 18765* EXEC CICS HANDLE CONDITION
 18766*        INVREQ    (6660-START-BROWSE)
 18767*        DISABLED  (6690-ERRESC-PROBLEM)
 18768*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18769*        NOTFND    (6690-END-OF-FILE)
 18770*    END-EXEC.
 18771*    MOVE '"$8cJI                ! & #00018654' TO DFHEIV0
 18772     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18774     MOVE X'2620233030303138363534' TO DFHEIV0(25:11)
 18775     CALL 'kxdfhei1' USING DFHEIV0
 18776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18777
 18778
 18779
 18780* EXEC CICS RESETBR
 18781*        DATASET (FILE-ID-ERRESC)
 18782*        RIDFLD  (WS-ERRESC-KEY)
 18783*    END-EXEC.
 18784     MOVE 0
 18785       TO DFHEIV11
 18786*    MOVE '&4         G          &   #00018661' TO DFHEIV0
 18787     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18789     MOVE X'2020233030303138363631' TO DFHEIV0(25:11)
 18790     CALL 'kxdfhei1' USING DFHEIV0,
 18791           FILE-ID-ERRESC,
 18792           WS-ERRESC-KEY,
 18793           DFHEIV99,
 18794           DFHEIV11,
 18795           DFHEIV99
 18796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 343
* EL050.cbl
 18797
 18798
 18799 6660-START-BROWSE.
 18800
 18801
 18802* EXEC CICS HANDLE CONDITION
 18803*        NOTFND    (6690-END-OF-FILE)
 18804*        DISABLED  (6690-ERRESC-PROBLEM)
 18805*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18806*        ENDFILE   (6690-END-OF-FILE)
 18807*    END-EXEC.
 18808*    MOVE '"$IcJ''                ! '' #00018668' TO DFHEIV0
 18809     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18810     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18811     MOVE X'2720233030303138363638' TO DFHEIV0(25:11)
 18812     CALL 'kxdfhei1' USING DFHEIV0
 18813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18814
 18815
 18816
 18817* EXEC CICS STARTBR
 18818*        DATASET (FILE-ID-ERRESC)
 18819*        RIDFLD  (WS-ERRESC-KEY)
 18820*        GTEQ
 18821*    END-EXEC.
 18822     MOVE 0
 18823       TO DFHEIV11
 18824*    MOVE '&,         G          &   #00018675' TO DFHEIV0
 18825     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18826     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18827     MOVE X'2020233030303138363735' TO DFHEIV0(25:11)
 18828     CALL 'kxdfhei1' USING DFHEIV0,
 18829           FILE-ID-ERRESC,
 18830           WS-ERRESC-KEY,
 18831           DFHEIV99,
 18832           DFHEIV11,
 18833           DFHEIV99
 18834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18835
 18836
 18837     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18838
 18839 6670-READ-NEXT-ERRESC-MASTER.
 18840
 18841
 18842* EXEC CICS HANDLE CONDITION
 18843*        NOTFND    (6690-END-OF-FILE)
 18844*        DISABLED  (6690-ERRESC-PROBLEM)
 18845*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18846*        ENDFILE   (6690-END-OF-FILE)
 18847*    END-EXEC.
 18848*    MOVE '"$IcJ''                ! ( #00018685' TO DFHEIV0
 18849     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18851     MOVE X'2820233030303138363835' TO DFHEIV0(25:11)
 18852     CALL 'kxdfhei1' USING DFHEIV0
 18853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18854
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 344
* EL050.cbl
 18855
 18856
 18857* EXEC CICS READNEXT
 18858*        DATASET (FILE-ID-ERRESC)
 18859*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18860*        RIDFLD  (ERRESC-RECORD-KEY)
 18861*    END-EXEC.
 18862     MOVE LENGTH OF
 18863      ACCOUNT-RESIDENT-ST-COMMISSION
 18864       TO DFHEIV12
 18865     MOVE 0
 18866       TO DFHEIV11
 18867*    MOVE '&.IL                  )   #00018692' TO DFHEIV0
 18868     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18870     MOVE X'2020233030303138363932' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0,
 18872           FILE-ID-ERRESC,
 18873           ACCOUNT-RESIDENT-ST-COMMISSION,
 18874           DFHEIV12,
 18875           ERRESC-RECORD-KEY,
 18876           DFHEIV99,
 18877           DFHEIV11,
 18878           DFHEIV99,
 18879           DFHEIV99
 18880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18881
 18882
 18883     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18884        NEXT SENTENCE
 18885     ELSE
 18886
 18887* EXEC CICS ENDBR
 18888*            DATASET (FILE-ID-ERRESC)
 18889*       END-EXEC
 18890     MOVE 0
 18891       TO DFHEIV11
 18892*    MOVE '&2                    $   #00018701' TO DFHEIV0
 18893     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18894     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18895     MOVE X'2020233030303138373031' TO DFHEIV0(25:11)
 18896     CALL 'kxdfhei1' USING DFHEIV0,
 18897           FILE-ID-ERRESC,
 18898           DFHEIV11,
 18899           DFHEIV99
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18901        GO TO 6690-END-OF-FILE.
 18902
 18903     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18904
 18905* EXEC CICS ENDBR
 18906*            DATASET (FILE-ID-ERRESC)
 18907*       END-EXEC
 18908     MOVE 0
 18909       TO DFHEIV11
 18910*    MOVE '&2                    $   #00018707' TO DFHEIV0
 18911     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18912     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 345
* EL050.cbl
 18913     MOVE X'2020233030303138373037' TO DFHEIV0(25:11)
 18914     CALL 'kxdfhei1' USING DFHEIV0,
 18915           FILE-ID-ERRESC,
 18916           DFHEIV11,
 18917           DFHEIV99
 18918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18919        GO TO 6690-END-OF-FILE.
 18920
 18921     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18922        NEXT SENTENCE
 18923      ELSE
 18924        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18925
 18926* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18927*
 18928     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18929
 18930     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18931
 18932     IF WS-SUB1 > ZERO
 18933         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18934             PERFORM 6680-SET-COMMISSION
 18935         ELSE
 18936             PERFORM 6680-SET-TABLE-CODE.
 18937
 18938
 18939* EXEC CICS ENDBR
 18940*         DATASET (FILE-ID-ERRESC)
 18941*    END-EXEC.
 18942     MOVE 0
 18943       TO DFHEIV11
 18944*    MOVE '&2                    $   #00018729' TO DFHEIV0
 18945     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18947     MOVE X'2020233030303138373239' TO DFHEIV0(25:11)
 18948     CALL 'kxdfhei1' USING DFHEIV0,
 18949           FILE-ID-ERRESC,
 18950           DFHEIV11,
 18951           DFHEIV99
 18952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18953
 18954
 18955     GO TO 6700-COMM-EXIT.
 18956
 18957 6680-SET-TABLE-CODE.
 18958     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18959        MOVE ZEROS             TO WS-SUB1
 18960     ELSE
 18961* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18962* TO COMPUTE AH COMMISSION.
 18963        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18964        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18965        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18966        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18967        PERFORM 6680-READ-CTBL-TABLE
 18968        IF WS-CTBL-READ-SW NOT = 'Y'
 18969           MOVE ZEROS          TO WS-SUB1.
 18970
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 346
* EL050.cbl
 18971 6680-READ-CTBL-TABLE.
 18972*
 18973* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18974* TO COMPUTE LIFE COMMISSION
 18975
 18976     IF CTBL-SW = '0540'
 18977        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18978        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18979        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18980
 18981     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18982
 18983     IF CTBL-TABLE-FOUND
 18984        IF CTBL-SW = '0530'
 18985             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18986                                    * PB-I-AH-TERM
 18987             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18988             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18989        ELSE
 18990             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18991             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18992             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18993     ELSE
 18994        IF FIRST-TIME-THROUGH
 18995            GO TO 6680-READ-CTBL-TABLE
 18996        ELSE
 18997            MOVE ZEROS         TO WS-SUB1.
 18998
 18999 6680-SET-COMMISSION.
 19000     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19001           MOVE ZEROS          TO WS-SUB1
 19002       ELSE
 19003           MOVE RESC-COMMISSION-PER (WS-SUB)
 19004                               TO WS-COMMISSION
 19005           IF CTBL-SW = '0530'
 19006               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19007           ELSE
 19008               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19009
 19010 6680-SEARCH-CATEGORY.
 19011     ADD +1                   TO WS-SUB.
 19012     IF WS-SUB > +12
 19013         GO TO 6680-EXIT.
 19014
 19015     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19016          MOVE WS-SUB         TO WS-SUB1
 19017          GO TO 6680-EXIT.
 19018
 19019     GO TO 6680-SEARCH-CATEGORY.
 19020
 19021 6680-EXIT.
 19022     EXIT.
 19023
 19024 6690-END-OF-FILE.
 19025     GO TO 6700-COMM-EXIT.
 19026
 19027 6690-ERRESC-PROBLEM.
 19028      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 347
* EL050.cbl
 19029      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19030
 19031      GO TO 6700-COMM-EXIT.
 19032
 19033 6700-COMM-EXIT.
 19034     EXIT.
 19035
 19036 7000-GET-RATE.
 19037
 19038* EXEC CICS LINK
 19039*        PROGRAM    ('ELRATE')
 19040*        COMMAREA   (CALCULATION-PASS-AREA)
 19041*        LENGTH     (CP-COMM-LENGTH)
 19042*    END-EXEC.
 19043     MOVE 'ELRATE' TO DFHEIV1
 19044*    MOVE '."C                   (   #00018815' TO DFHEIV0
 19045     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19047     MOVE X'2020233030303138383135' TO DFHEIV0(25:11)
 19048     CALL 'kxdfhei1' USING DFHEIV0,
 19049           DFHEIV1,
 19050           CALCULATION-PASS-AREA,
 19051           CP-COMM-LENGTH,
 19052           DFHEIV99,
 19053           DFHEIV99,
 19054           DFHEIV99,
 19055           DFHEIV99
 19056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19057
 19058
 19059 7000-EXIT.
 19060     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 348
* EL050.cbl
 19062 7100-FIND-BENEFIT-IN-STATE.
 19063     MOVE 'N'                    TO BEN-SEARCH-SW.
 19064
 19065     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19066         VARYING SUB3 FROM 1 BY 1 UNTIL
 19067            ((SUB3 GREATER 50) OR
 19068              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19069               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19070
 19071     IF SUB3 NOT = 51
 19072         MOVE 'Y'                TO BEN-SEARCH-SW.
 19073
 19074     GO TO 7199-EXIT.
 19075
 19076 7100-BENEFIT-DUMMY.
 19077
 19078 7100-DUMMY-EXIT.
 19079     EXIT.
 19080
 19081 7199-EXIT.
 19082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 349
* EL050.cbl
 19084 7200-FIND-BENEFIT.
 19085     MOVE 'N'                    TO BEN-SEARCH-SW.
 19086
 19087     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19088         VARYING SUB3 FROM 1 BY 1 UNTIL
 19089            ((SUB3 GREATER 8) OR
 19090            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19091
 19092     IF SUB3 NOT = 9
 19093         MOVE 'Y'                TO BEN-SEARCH-SW.
 19094
 19095     GO TO 7200-EXIT.
 19096
 19097 7200-BENEFIT-DUMMY.
 19098
 19099 7200-DUMMY-EXIT.
 19100     EXIT.
 19101
 19102 7200-EXIT.
 19103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 350
* EL050.cbl
 19105 7250-LOOK-FOR-RESCINDED-CLAIM.
 19106     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19107                                    W-CL-COMP-CD.
 19108     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19109                                    W-CL-CERT-NO.
 19110
 19111
 19112* EXEC CICS HANDLE CONDITION
 19113*        NOTFND  (7250-CONTINUE)
 19114*        ENDFILE (7250-CONTINUE)
 19115*    END-EXEC.
 19116*    MOVE '"$I''                  ! ) #00018873' TO DFHEIV0
 19117     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19119     MOVE X'2920233030303138383733' TO DFHEIV0(25:11)
 19120     CALL 'kxdfhei1' USING DFHEIV0
 19121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19122
 19123
 19124
 19125* EXEC CICS IGNORE CONDITION
 19126*        DUPKEY
 19127*    END-EXEC.
 19128*    MOVE '"*$                   !   #00018878' TO DFHEIV0
 19129     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19131     MOVE X'2020233030303138383738' TO DFHEIV0(25:11)
 19132     CALL 'kxdfhei1' USING DFHEIV0
 19133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19134
 19135
 19136
 19137* EXEC CICS STARTBR
 19138*        DATASET   (CLMS-ID)
 19139*        RIDFLD    (ELMSTR-KEY)
 19140*        GENERIC   EQUAL
 19141*        KEYLENGTH (ELMSTR-LENGTH)
 19142*    END-EXEC.
 19143     MOVE 0
 19144       TO DFHEIV11
 19145*    MOVE '&,   KG    E          &   #00018882' TO DFHEIV0
 19146     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19148     MOVE X'2020233030303138383832' TO DFHEIV0(25:11)
 19149     CALL 'kxdfhei1' USING DFHEIV0,
 19150           CLMS-ID,
 19151           ELMSTR-KEY,
 19152           ELMSTR-LENGTH,
 19153           DFHEIV11,
 19154           DFHEIV99
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158     MOVE 'Y'                    TO W-BROWSE-SW.
 19159
 19160 7250-NEXT-CLAIM.
 19161
 19162
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 351
* EL050.cbl
 19163* EXEC CICS READNEXT
 19164*        DATASET   (CLMS-ID)
 19165*        RIDFLD    (ELMSTR-KEY)
 19166*        SET       (ADDRESS OF CLAIM-MASTER)
 19167*    END-EXEC.
 19168     MOVE 0
 19169       TO DFHEIV11
 19170*    MOVE '&.S                   )   #00018893' TO DFHEIV0
 19171     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19172     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19173     MOVE X'2020233030303138383933' TO DFHEIV0(25:11)
 19174     CALL 'kxdfhei1' USING DFHEIV0,
 19175           CLMS-ID,
 19176           DFHEIV20,
 19177           DFHEIV99,
 19178           ELMSTR-KEY,
 19179           DFHEIV99,
 19180           DFHEIV11,
 19181           DFHEIV99,
 19182           DFHEIV99
 19183     SET ADDRESS OF CLAIM-MASTER TO
 19184         DFHEIV20
 19185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19186
 19187
 19188     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19189        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19190         GO TO 7250-CONTINUE
 19191     END-IF.
 19192
 19193     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19194        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19195        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19196        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19197        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19198         GO TO 7250-NEXT-CLAIM
 19199     END-IF.
 19200
 19201     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19202        OR (CL-CLAIM-TYPE = 'I')
 19203        OR (CL-CLAIM-TYPE = 'G')
 19204        OR (CL-CLAIM-TYPE = 'F')
 19205          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19206              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19207              GO TO 7250-CONTINUE
 19208          END-IF
 19209     END-IF.
 19210
 19211     GO TO 7250-NEXT-CLAIM.
 19212
 19213 7250-CONTINUE.
 19214
 19215     IF W-BROWSE-SW = 'Y'
 19216
 19217* EXEC CICS ENDBR
 19218*            DATASET   (CLMS-ID)
 19219*        END-EXEC
 19220     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 352
* EL050.cbl
 19221       TO DFHEIV11
 19222*    MOVE '&2                    $   #00018927' TO DFHEIV0
 19223     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19224     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19225     MOVE X'2020233030303138393237' TO DFHEIV0(25:11)
 19226     CALL 'kxdfhei1' USING DFHEIV0,
 19227           CLMS-ID,
 19228           DFHEIV11,
 19229           DFHEIV99
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19231         MOVE 'N' TO W-BROWSE-SW
 19232     END-IF.
 19233
 19234 7250-EXIT.
 19235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 353
* EL050.cbl
 19237 7300-CHECK-FOR-OPEN-CLMS.
 19238
 19239*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19240*    MOVE SPACES                 TO CNTL-ACCESS.
 19241*    MOVE '1'                    TO CNTL-REC-TYPE.
 19242*    MOVE +0                     TO CNTL-SEQ-NO.
 19243
 19244*    MOVE '3'                    TO RC-SW-1.
 19245*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19246
 19247*    IF NOT CF-COMPANY-MASTER
 19248*         PERFORM 0099-COMPANY-NOT-FOUND
 19249*         GO TO 7300-EXIT.
 19250
 19251     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19252                                    W-CL-COMP-CD.
 19253     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19254                                    W-CL-CERT-NO.
 19255
 19256
 19257* EXEC CICS HANDLE CONDITION
 19258*        NOTFND  (7300-CONTINUE)
 19259*        ENDFILE (7300-CONTINUE)
 19260*    END-EXEC.
 19261*    MOVE '"$I''                  ! * #00018955' TO DFHEIV0
 19262     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19264     MOVE X'2A20233030303138393535' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269
 19270* EXEC CICS IGNORE CONDITION
 19271*        DUPKEY
 19272*    END-EXEC.
 19273*    MOVE '"*$                   !   #00018960' TO DFHEIV0
 19274     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19276     MOVE X'2020233030303138393630' TO DFHEIV0(25:11)
 19277     CALL 'kxdfhei1' USING DFHEIV0
 19278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19279
 19280
 19281
 19282* EXEC CICS STARTBR
 19283*        DATASET   (CLMS-ID)
 19284*        RIDFLD    (ELMSTR-KEY)
 19285*        GENERIC   EQUAL
 19286*        KEYLENGTH (ELMSTR-LENGTH)
 19287*    END-EXEC.
 19288     MOVE 0
 19289       TO DFHEIV11
 19290*    MOVE '&,   KG    E          &   #00018964' TO DFHEIV0
 19291     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19292     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303138393634' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 354
* EL050.cbl
 19295           CLMS-ID,
 19296           ELMSTR-KEY,
 19297           ELMSTR-LENGTH,
 19298           DFHEIV11,
 19299           DFHEIV99
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303     MOVE 'Y'                    TO W-BROWSE-SW.
 19304
 19305 7300-NEXT-CLAIM.
 19306
 19307
 19308* EXEC CICS READNEXT
 19309*        DATASET   (CLMS-ID)
 19310*        RIDFLD    (ELMSTR-KEY)
 19311*        SET       (ADDRESS OF CLAIM-MASTER)
 19312*    END-EXEC.
 19313     MOVE 0
 19314       TO DFHEIV11
 19315*    MOVE '&.S                   )   #00018975' TO DFHEIV0
 19316     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19317     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19318     MOVE X'2020233030303138393735' TO DFHEIV0(25:11)
 19319     CALL 'kxdfhei1' USING DFHEIV0,
 19320           CLMS-ID,
 19321           DFHEIV20,
 19322           DFHEIV99,
 19323           ELMSTR-KEY,
 19324           DFHEIV99,
 19325           DFHEIV11,
 19326           DFHEIV99,
 19327           DFHEIV99
 19328     SET ADDRESS OF CLAIM-MASTER TO
 19329         DFHEIV20
 19330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19331
 19332
 19333     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19334        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19335         GO TO 7300-CONTINUE.
 19336
 19337     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19338        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19339        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19340        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19341        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19342         GO TO 7300-NEXT-CLAIM.
 19343
 19344*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19345     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19346        OR (CL-CLAIM-TYPE = 'I')
 19347        OR (CL-CLAIM-TYPE = 'G')
 19348        OR (CL-CLAIM-TYPE = 'F')
 19349        IF CLAIM-IS-OPEN
 19350           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19351             AND PB-C-AH-CANCEL-DT > SPACES
 19352              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 355
* EL050.cbl
 19353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19354           END-IF
 19355           EVALUATE TRUE
 19356             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19357                 MOVE ER-2884      TO WS-ERROR
 19358             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19359                 MOVE ER-2887      TO WS-ERROR
 19360             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19361                 MOVE ER-2886      TO WS-ERROR
 19362             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19363                 MOVE ER-2888      TO WS-ERROR
 19364             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19365                 MOVE ER-2885      TO WS-ERROR
 19366             WHEN OTHER
 19367                 MOVE ER-2768      TO WS-ERROR
 19368           END-EVALUATE
 19369           IF PB-C-AH-CANCEL-VOIDED OR
 19370              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19371                NOT AH-COVERAGE-CANCELLED)
 19372               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19373               MOVE ER-2768      TO WS-ERROR
 19374           END-IF
 19375           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19376           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19377              PB-FORCE-CODE NOT EQUAL '8'
 19378               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19379           END-IF
 19380           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19381           GO TO 7300-NEXT-CLAIM
 19382        ELSE
 19383           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19384*****THIS IS A RESCISSION OR REFORMATION
 19385              IF AH-COVERAGE-CANCELLED
 19386                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19387                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19388                    MOVE 1                   TO DC-ELAPSED-DAYS
 19389                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19390                    SET BIN-PLUS-ELAPSED     TO TRUE
 19391                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19392                    IF NO-CONVERSION-ERROR
 19393                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19394                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19395                          MOVE ER-2897 TO WS-ERROR
 19396                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19397                          GO TO 7300-NEXT-CLAIM
 19398                       END-IF
 19399                    END-IF
 19400                 ELSE
 19401                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19402                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19403                         MOVE ER-2890 TO WS-ERROR
 19404                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19405                         GO TO 7300-NEXT-CLAIM
 19406                      ELSE
 19407                         MOVE ER-2898 TO WS-ERROR
 19408                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19409                         GO TO 7300-NEXT-CLAIM
 19410                      END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 356
* EL050.cbl
 19411                   END-IF
 19412                 END-IF
 19413              END-IF
 19414           ELSE
 19415              IF CL-DENIAL-TYPE = '1'  AND
 19416                 CL-TOTAL-PAID-AMT = 0
 19417                    GO TO 7300-NEXT-CLAIM
 19418              END-IF
 19419              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19420               AND PB-C-AH-CANCEL-DT > SPACES
 19421                 MOVE ER-2756        TO WS-ERROR
 19422                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19423                 GO TO 7300-NEXT-CLAIM
 19424              END-IF
 19425           END-IF
 19426        END-IF
 19427     ELSE
 19428*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19429        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19430           IF (CLAIM-IS-OPEN)
 19431              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19432                 <> zeros
 19433              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19434                 <> zeros)
 19435              MOVE ER-2889      TO WS-ERROR
 19436              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19437              GO TO 7300-NEXT-CLAIM
 19438           ELSE
 19439              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19440*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19441                 IF (LF-COVERAGE-CANCELLED AND
 19442                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19443                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19444                         MOVE ER-2890 TO WS-ERROR
 19445                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19446                         GO TO 7300-NEXT-CLAIM
 19447                      ELSE
 19448                         MOVE ER-2898 TO WS-ERROR
 19449                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19450                         GO TO 7300-NEXT-CLAIM
 19451                      END-IF
 19452                 END-IF
 19453              ELSE
 19454                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19455                    and (CL-TOTAL-PAID-AMT = 0)
 19456                    GO TO 7300-NEXT-CLAIM
 19457                 END-IF
 19458                 IF (
 19459                      (AH-COVERAGE-CANCELLED)
 19460                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19461                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19462                      and (pb-ci-ah-cancel-amt +
 19463                         pb-c-ah-cancel-amt) <> zeros
 19464                    )
 19465                               OR
 19466                    (
 19467                      (LF-COVERAGE-CANCELLED)
 19468                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 357
* EL050.cbl
 19469                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19470                      and (pb-ci-lf-cancel-amt +
 19471                         pb-c-lf-cancel-amt) <> zeros
 19472                    )
 19473                       MOVE ER-2965 TO WS-ERROR
 19474                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19475                       GO TO 7300-NEXT-CLAIM
 19476                 END-IF
 19477                 IF LF-COVERAGE-CANCELLED
 19478                  IF CL-TOTAL-PAID-AMT > 0
 19479                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19480                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19481                        MOVE ER-2891 TO WS-ERROR
 19482                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19483                        GO TO 7300-NEXT-CLAIM
 19484                      END-IF
 19485                    ELSE
 19486****only show this error if cert num matches exactly
 19487                      IF PB-CERT-NO = CL-CERT-NO
 19488                         MOVE ER-2892 TO WS-ERROR
 19489                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19490                         GO TO 7300-NEXT-CLAIM
 19491                      END-IF
 19492                    END-IF
 19493                  END-IF
 19494                 END-IF
 19495              END-IF
 19496           END-IF
 19497        END-IF
 19498     END-IF
 19499
 19500     GO TO 7300-NEXT-CLAIM.
 19501
 19502 7300-CONTINUE.
 19503
 19504     IF W-BROWSE-SW = 'Y'
 19505
 19506* EXEC CICS ENDBR
 19507*            DATASET   (CLMS-ID)
 19508*        END-EXEC.
 19509     MOVE 0
 19510       TO DFHEIV11
 19511*    MOVE '&2                    $   #00019153' TO DFHEIV0
 19512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19514     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0,
 19516           CLMS-ID,
 19517           DFHEIV11,
 19518           DFHEIV99
 19519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19520
 19521
 19522 7300-EXIT.
 19523     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 358
* EL050.cbl
 19525
 19526 7400-GET-REMAIN-TERM.
 19527
 19528* EXEC CICS LINK
 19529*        PROGRAM    ('ELRTRM')
 19530*        COMMAREA   (CALCULATION-PASS-AREA)
 19531*        LENGTH     (CP-COMM-LENGTH)
 19532*    END-EXEC.
 19533     MOVE 'ELRTRM' TO DFHEIV1
 19534*    MOVE '."C                   (   #00019162' TO DFHEIV0
 19535     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19537     MOVE X'2020233030303139313632' TO DFHEIV0(25:11)
 19538     CALL 'kxdfhei1' USING DFHEIV0,
 19539           DFHEIV1,
 19540           CALCULATION-PASS-AREA,
 19541           CP-COMM-LENGTH,
 19542           DFHEIV99,
 19543           DFHEIV99,
 19544           DFHEIV99,
 19545           DFHEIV99
 19546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19547
 19548
 19549 7400-EXIT.
 19550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 359
* EL050.cbl
 19552
 19553 7500-GET-REMAIN-AMOUNT.
 19554
 19555* EXEC CICS LINK
 19556*        PROGRAM    ('ELRAMT')
 19557*        COMMAREA   (CALCULATION-PASS-AREA)
 19558*        LENGTH     (CP-COMM-LENGTH)
 19559*    END-EXEC.
 19560     MOVE 'ELRAMT' TO DFHEIV1
 19561*    MOVE '."C                   (   #00019173' TO DFHEIV0
 19562     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19564     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0,
 19566           DFHEIV1,
 19567           CALCULATION-PASS-AREA,
 19568           CP-COMM-LENGTH,
 19569           DFHEIV99,
 19570           DFHEIV99,
 19571           DFHEIV99,
 19572           DFHEIV99
 19573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19574
 19575
 19576 7500-EXIT.
 19577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 360
* EL050.cbl
 19579
 19580 7600-GET-REFUND.
 19581
 19582* EXEC CICS LINK
 19583*        PROGRAM    ('ELRFND')
 19584*        COMMAREA   (CALCULATION-PASS-AREA)
 19585*        LENGTH     (CP-COMM-LENGTH)
 19586*    END-EXEC.
 19587     MOVE 'ELRFND' TO DFHEIV1
 19588*    MOVE '."C                   (   #00019184' TO DFHEIV0
 19589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19591     MOVE X'2020233030303139313834' TO DFHEIV0(25:11)
 19592     CALL 'kxdfhei1' USING DFHEIV0,
 19593           DFHEIV1,
 19594           CALCULATION-PASS-AREA,
 19595           CP-COMM-LENGTH,
 19596           DFHEIV99,
 19597           DFHEIV99,
 19598           DFHEIV99,
 19599           DFHEIV99
 19600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19601
 19602
 19603 7600-EXIT.
 19604     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 361
* EL050.cbl
 19606 7700-CALL-DL1.
 19607
 19608* EXEC CICS LINK
 19609*        PROGRAM    ('DLO001')
 19610*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19611*        LENGTH     (DLO001-COMM-LENGTH)
 19612*    END-EXEC.
 19613     MOVE 'DLO001' TO DFHEIV1
 19614*    MOVE '."C                   (   #00019194' TO DFHEIV0
 19615     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19617     MOVE X'2020233030303139313934' TO DFHEIV0(25:11)
 19618     CALL 'kxdfhei1' USING DFHEIV0,
 19619           DFHEIV1,
 19620           WS-DLO-MASTER-POLICY-FORM,
 19621           DLO001-COMM-LENGTH,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV99,
 19625           DFHEIV99
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629 7700-EXIT.
 19630     EXIT.
 19631
 19632 7710-CALL-DL2.
 19633
 19634* EXEC CICS LINK
 19635*        PROGRAM    ('DLO002')
 19636*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19637*        LENGTH     (DLO002-COMM-LENGTH)
 19638*    END-EXEC.
 19639     MOVE 'DLO002' TO DFHEIV1
 19640*    MOVE '."C                   (   #00019204' TO DFHEIV0
 19641     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303139323034' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           DFHEIV1,
 19646           WS-DLO-INTERNAL-POLICY-FORM,
 19647           DLO002-COMM-LENGTH,
 19648           DFHEIV99,
 19649           DFHEIV99,
 19650           DFHEIV99,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655 7710-EXIT.
 19656     EXIT.
 19657
 19658 7720-CALL-DL3.
 19659
 19660* EXEC CICS LINK
 19661*        PROGRAM    ('DLO003')
 19662*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19663*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 362
* EL050.cbl
 19664*    END-EXEC.
 19665     MOVE 'DLO003' TO DFHEIV1
 19666*    MOVE '."C                   (   #00019214' TO DFHEIV0
 19667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19669     MOVE X'2020233030303139323134' TO DFHEIV0(25:11)
 19670     CALL 'kxdfhei1' USING DFHEIV0,
 19671           DFHEIV1,
 19672           WS-DLO-VALID-BANK-ID,
 19673           DLO003-COMM-LENGTH,
 19674           DFHEIV99,
 19675           DFHEIV99,
 19676           DFHEIV99,
 19677           DFHEIV99
 19678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19679
 19680
 19681 7720-EXIT.
 19682     EXIT.
 19683
 19684 7730-CALL-DL7.
 19685
 19686* EXEC CICS LINK
 19687*        PROGRAM    ('DLO007')
 19688*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19689*        LENGTH     (DLO007-COMM-LENGTH)
 19690*    END-EXEC.
 19691     MOVE 'DLO007' TO DFHEIV1
 19692*    MOVE '."C                   (   #00019224' TO DFHEIV0
 19693     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303139323234' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           DFHEIV1,
 19698           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19699           DLO007-COMM-LENGTH,
 19700           DFHEIV99,
 19701           DFHEIV99,
 19702           DFHEIV99,
 19703           DFHEIV99
 19704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19705
 19706
 19707 7730-EXIT.
 19708     EXIT.
 19709
 19710 7740-CALL-DL11.
 19711
 19712* EXEC CICS LINK
 19713*        PROGRAM    ('DLO011')
 19714*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19715*        LENGTH     (DLO011-COMM-LENGTH)
 19716*    END-EXEC.
 19717     MOVE 'DLO011' TO DFHEIV1
 19718*    MOVE '."C                   (   #00019234' TO DFHEIV0
 19719     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19721     MOVE X'2020233030303139323334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 363
* EL050.cbl
 19722     CALL 'kxdfhei1' USING DFHEIV0,
 19723           DFHEIV1,
 19724           WS-DLO-PREM-RATES-BEN-TYPE,
 19725           DLO011-COMM-LENGTH,
 19726           DFHEIV99,
 19727           DFHEIV99,
 19728           DFHEIV99,
 19729           DFHEIV99
 19730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19731
 19732
 19733 7740-EXIT.
 19734     EXIT.
 19735
 19736 7750-CALL-DL17.
 19737
 19738* EXEC CICS LINK
 19739*        PROGRAM    ('DLO017')
 19740*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19741*        LENGTH     (DLO017-COMM-LENGTH)
 19742*    END-EXEC.
 19743     MOVE 'DLO017' TO DFHEIV1
 19744*    MOVE '."C                   (   #00019244' TO DFHEIV0
 19745     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19746     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19747     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 19748     CALL 'kxdfhei1' USING DFHEIV0,
 19749           DFHEIV1,
 19750           WS-DLO-VALID-RATE-CODE,
 19751           DLO017-COMM-LENGTH,
 19752           DFHEIV99,
 19753           DFHEIV99,
 19754           DFHEIV99,
 19755           DFHEIV99
 19756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19757
 19758
 19759 7750-EXIT.
 19760     EXIT.
 19761
 19762 7755-CALL-DL19.
 19763
 19764* EXEC CICS LINK
 19765*        PROGRAM    ('DLO019')
 19766*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19767*        LENGTH     (DLO019-COMM-LENGTH)
 19768*    END-EXEC.
 19769     MOVE 'DLO019' TO DFHEIV1
 19770*    MOVE '."C                   (   #00019254' TO DFHEIV0
 19771     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19773     MOVE X'2020233030303139323534' TO DFHEIV0(25:11)
 19774     CALL 'kxdfhei1' USING DFHEIV0,
 19775           DFHEIV1,
 19776           WS-DLO-ORIG-COV-CAT,
 19777           DLO019-COMM-LENGTH,
 19778           DFHEIV99,
 19779           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 364
* EL050.cbl
 19780           DFHEIV99,
 19781           DFHEIV99
 19782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19783
 19784
 19785 7755-EXIT.
 19786     EXIT.
 19787
 19788 7760-CALL-DL21.
 19789
 19790* EXEC CICS LINK
 19791*        PROGRAM    ('DLO021')
 19792*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19793*        LENGTH     (DLO021-COMM-LENGTH)
 19794*    END-EXEC.
 19795     MOVE 'DLO021' TO DFHEIV1
 19796*    MOVE '."C                   (   #00019264' TO DFHEIV0
 19797     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303139323634' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
 19801           DFHEIV1,
 19802           WS-DLO-VALID-LOAN-OFFICER,
 19803           DLO021-COMM-LENGTH,
 19804           DFHEIV99,
 19805           DFHEIV99,
 19806           DFHEIV99,
 19807           DFHEIV99
 19808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19809
 19810
 19811 7760-EXIT.
 19812     EXIT.
 19813
 19814 7770-CALL-DL22.
 19815
 19816* EXEC CICS LINK
 19817*        PROGRAM    ('DLO022')
 19818*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19819*        LENGTH     (DLO022-COMM-LENGTH)
 19820*    END-EXEC.
 19821     MOVE 'DLO022' TO DFHEIV1
 19822*    MOVE '."C                   (   #00019274' TO DFHEIV0
 19823     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19825     MOVE X'2020233030303139323734' TO DFHEIV0(25:11)
 19826     CALL 'kxdfhei1' USING DFHEIV0,
 19827           DFHEIV1,
 19828           WS-DLO-VALID-STATE-CODE,
 19829           DLO022-COMM-LENGTH,
 19830           DFHEIV99,
 19831           DFHEIV99,
 19832           DFHEIV99,
 19833           DFHEIV99
 19834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19835
 19836
 19837 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 365
* EL050.cbl
 19838     EXIT.
 19839
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 366
* EL050.cbl
 19841
 19842 7780-CALL-AGG.
 19843
 19844* EXEC CICS LINK
 19845*        PROGRAM    ('ELAGGO')
 19846*        COMMAREA   (WS-PASS-to-pemaggo)
 19847*        LENGTH     (ws-passed-key-LENGTH)
 19848*    END-EXEC.
 19849     MOVE 'ELAGGO' TO DFHEIV1
 19850*    MOVE '."C                   (   #00019286' TO DFHEIV0
 19851     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19852     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19853     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 19854     CALL 'kxdfhei1' USING DFHEIV0,
 19855           DFHEIV1,
 19856           WS-PASS-to-pemaggo,
 19857           ws-passed-key-LENGTH,
 19858           DFHEIV99,
 19859           DFHEIV99,
 19860           DFHEIV99,
 19861           DFHEIV99
 19862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19863
 19864 7780-EXIT.
 19865     EXIT.
 19866 7800-REWRITE-CERT.
 19867******************************************************************
 19868*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19869*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19870******************************************************************
 19871
 19872     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19873        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19874        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19875        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19876
 19877* EXEC CICS REWRITE
 19878*                  DATASET (CERT-ID)
 19879*                  FROM    (CERTIFICATE-MASTER)
 19880*              END-EXEC
 19881     MOVE LENGTH OF
 19882      CERTIFICATE-MASTER
 19883       TO DFHEIV11
 19884*    MOVE '&& L                  %   #00019303' TO DFHEIV0
 19885     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19887     MOVE X'2020233030303139333033' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0,
 19889           CERT-ID,
 19890           CERTIFICATE-MASTER,
 19891           DFHEIV11,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19894        GO TO 7800-EXIT.
 19895
 19896       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19897       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19898
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 367
* EL050.cbl
 19899 7800-EXIT.
 19900      EXIT.
 19901
 19902 7900-DELETE-CERT.
 19903
 19904* EXEC CICS DELETE
 19905*        DATASET (CERT-ID)
 19906*    END-EXEC.
 19907*    MOVE '&(                    &   #00019316' TO DFHEIV0
 19908     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19910     MOVE X'2020233030303139333136' TO DFHEIV0(25:11)
 19911     CALL 'kxdfhei1' USING DFHEIV0,
 19912           CERT-ID,
 19913           DFHEIV99,
 19914           DFHEIV99,
 19915           DFHEIV99,
 19916           DFHEIV99
 19917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19918
 19919
 19920 7900-EXIT.
 19921     EXIT.
 19922
 19923 8000-WRITE-CERT.
 19924
 19925* EXEC CICS HANDLE CONDITION
 19926*        DUPKEY    (8000-FREE-MAIN)
 19927*    END-EXEC.
 19928*    MOVE '"$$                   ! + #00019324' TO DFHEIV0
 19929     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19931     MOVE X'2B20233030303139333234' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935
 19936
 19937* EXEC CICS WRITE
 19938*        DATASET     (CERT-ID)
 19939*        FROM        (CERTIFICATE-MASTER)
 19940*        RIDFLD      (ELCERT-KEY)
 19941*    END-EXEC.
 19942     MOVE LENGTH OF
 19943      CERTIFICATE-MASTER
 19944       TO DFHEIV11
 19945*    MOVE '&$ L                  ''   #00019328' TO DFHEIV0
 19946     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303139333238' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           CERT-ID,
 19951           CERTIFICATE-MASTER,
 19952           DFHEIV11,
 19953           ELCERT-KEY,
 19954           DFHEIV99,
 19955           DFHEIV99
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 368
* EL050.cbl
 19957
 19958
 19959 8000-FREE-MAIN.
 19960
 19961 8000-EXIT.
 19962      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 369
* EL050.cbl
 19964
 19965 8100-READ-ERPNDM.
 19966
 19967* EXEC CICS HANDLE CONDITION
 19968*         NOTFND     (8100-NOTFND)
 19969*         ENDFILE    (8100-NOTFND)
 19970*    END-EXEC.
 19971*    MOVE '"$I''                  ! , #00019341' TO DFHEIV0
 19972     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19974     MOVE X'2C20233030303139333431' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979     MOVE SPACES                 TO ERPNDM-FOUND.
 19980     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19981
 19982
 19983* EXEC CICS READ
 19984*         DATASET   (FILE-ERPNDM)
 19985*         RIDFLD    (PM-CONTROL-PRIMARY)
 19986*         INTO      (PENDING-MAILING-DATA)
 19987*    END-EXEC.
 19988     MOVE LENGTH OF
 19989      PENDING-MAILING-DATA
 19990       TO DFHEIV11
 19991*    MOVE '&"IL       E          (   #00019349' TO DFHEIV0
 19992     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19993     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19994     MOVE X'2020233030303139333439' TO DFHEIV0(25:11)
 19995     CALL 'kxdfhei1' USING DFHEIV0,
 19996           FILE-ERPNDM,
 19997           PENDING-MAILING-DATA,
 19998           DFHEIV11,
 19999           PM-CONTROL-PRIMARY,
 20000           DFHEIV99,
 20001           DFHEIV99,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006     GO TO 8100-EXIT.
 20007
 20008 8100-NOTFND.
 20009
 20010     MOVE 'X'                    TO ERPNDM-FOUND.
 20011     MOVE ER-2694                TO WS-ERROR.
 20012     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20013     MOVE ER-2883                TO WS-ERROR
 20014     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20015     .
 20016 8100-EXIT.
 20017     EXIT.
 20018
 20019 8110-READ-ERMAIL.
 20020
 20021* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 370
* EL050.cbl
 20022*         NOTFND     (8110-NOTFND)
 20023*         ENDFILE    (8110-NOTFND)
 20024*    END-EXEC.
 20025*    MOVE '"$I''                  ! - #00019369' TO DFHEIV0
 20026     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20028     MOVE X'2D20233030303139333639' TO DFHEIV0(25:11)
 20029     CALL 'kxdfhei1' USING DFHEIV0
 20030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20031
 20032
 20033     MOVE SPACES                 TO ERMAIL-FOUND.
 20034     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20035     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20036     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20037     MOVE PB-SV-STATE            TO MA-STATE.
 20038
 20039
 20040* EXEC CICS READ
 20041*         UPDATE
 20042*         DATASET   (FILE-ERMAIL)
 20043*         RIDFLD    (MA-CONTROL-PRIMARY)
 20044*         INTO      (MAILING-DATA)
 20045*    END-EXEC.
 20046     MOVE LENGTH OF
 20047      MAILING-DATA
 20048       TO DFHEIV11
 20049*    MOVE '&"IL       EU         (   #00019380' TO DFHEIV0
 20050     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20051     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20052     MOVE X'2020233030303139333830' TO DFHEIV0(25:11)
 20053     CALL 'kxdfhei1' USING DFHEIV0,
 20054           FILE-ERMAIL,
 20055           MAILING-DATA,
 20056           DFHEIV11,
 20057           MA-CONTROL-PRIMARY,
 20058           DFHEIV99,
 20059           DFHEIV99,
 20060           DFHEIV99
 20061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20062
 20063
 20064     GO TO 8110-EXIT.
 20065
 20066 8110-NOTFND.
 20067     MOVE 'X'                    TO ERMAIL-FOUND.
 20068
 20069 8110-EXIT.
 20070     EXIT.
 20071
 20072 8120-REWRITE-ERMAIL.
 20073
 20074* EXEC CICS REWRITE
 20075*         DATASET    (FILE-ERMAIL)
 20076*         FROM       (MAILING-DATA)
 20077*    END-EXEC.
 20078     MOVE LENGTH OF
 20079      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 371
* EL050.cbl
 20080       TO DFHEIV11
 20081*    MOVE '&& L                  %   #00019396' TO DFHEIV0
 20082     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20083     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20084     MOVE X'2020233030303139333936' TO DFHEIV0(25:11)
 20085     CALL 'kxdfhei1' USING DFHEIV0,
 20086           FILE-ERMAIL,
 20087           MAILING-DATA,
 20088           DFHEIV11,
 20089           DFHEIV99
 20090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20091
 20092
 20093 8120-EXIT.
 20094     EXIT.
 20095
 20096 8130-WRITE-ERMAIL.
 20097
 20098* EXEC CICS HANDLE CONDITION
 20099*         DUPKEY   (8130-EXIT)
 20100*    END-EXEC.
 20101*    MOVE '"$$                   ! . #00019405' TO DFHEIV0
 20102     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20104     MOVE X'2E20233030303139343035' TO DFHEIV0(25:11)
 20105     CALL 'kxdfhei1' USING DFHEIV0
 20106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20107
 20108
 20109
 20110* EXEC CICS WRITE
 20111*         DATASET     (FILE-ERMAIL)
 20112*         RIDFLD      (MA-CONTROL-PRIMARY)
 20113*         FROM        (MAILING-DATA)
 20114*    END-EXEC.
 20115     MOVE LENGTH OF
 20116      MAILING-DATA
 20117       TO DFHEIV11
 20118*    MOVE '&$ L                  ''   #00019409' TO DFHEIV0
 20119     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303139343039' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           FILE-ERMAIL,
 20124           MAILING-DATA,
 20125           DFHEIV11,
 20126           MA-CONTROL-PRIMARY,
 20127           DFHEIV99,
 20128           DFHEIV99
 20129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20130
 20131
 20132 8130-EXIT.
 20133     EXIT.
 20134
 20135 8140-UNLOCK-ERMAIL.
 20136
 20137* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 372
* EL050.cbl
 20138*         DATASET   (FILE-ERMAIL)
 20139*    END-EXEC.
 20140*    MOVE '&*                    #   #00019419' TO DFHEIV0
 20141     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20142     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20143     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 20144     CALL 'kxdfhei1' USING DFHEIV0,
 20145           FILE-ERMAIL,
 20146           DFHEIV99
 20147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20148
 20149
 20150 8140-EXIT.
 20151     EXIT.
 20152
 20153 8150-read-elcrtt.
 20154
 20155
 20156* EXEC CICS HANDLE CONDITION
 20157*        NOTFND   (8150-exit)
 20158*    END-EXEC
 20159*    MOVE '"$I                   ! / #00019428' TO DFHEIV0
 20160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20162     MOVE X'2F20233030303139343238' TO DFHEIV0(25:11)
 20163     CALL 'kxdfhei1' USING DFHEIV0
 20164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20165
 20166     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20167     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20168
 20169
 20170* EXEC CICS READ
 20171*        DATASET  (CRTT-ID)
 20172*        RIDFLD   (WS-ELCRTT-KEY)
 20173*        INTO     (CERTIFICATE-TRAILERS)
 20174*    END-EXEC
 20175     MOVE LENGTH OF
 20176      CERTIFICATE-TRAILERS
 20177       TO DFHEIV11
 20178*    MOVE '&"IL       E          (   #00019435' TO DFHEIV0
 20179     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20181     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
 20182     CALL 'kxdfhei1' USING DFHEIV0,
 20183           CRTT-ID,
 20184           CERTIFICATE-TRAILERS,
 20185           DFHEIV11,
 20186           WS-ELCRTT-KEY,
 20187           DFHEIV99,
 20188           DFHEIV99,
 20189           DFHEIV99
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20191
 20192     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20193     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20194     move cs-vehicle-odometer    to ws-vehicle-odometer
 20195
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 373
* EL050.cbl
 20196     .
 20197 8150-exit.
 20198     exit.
 20199 8180-UPDATE-VIN-NUMBER.
 20200
 20201* EXEC CICS HANDLE CONDITION
 20202*        NOTFND   (8180-NOTFND)
 20203*    END-EXEC.
 20204*    MOVE '"$I                   ! 0 #00019449' TO DFHEIV0
 20205     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20207     MOVE X'3020233030303139343439' TO DFHEIV0(25:11)
 20208     CALL 'kxdfhei1' USING DFHEIV0
 20209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20210
 20211
 20212     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20213     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20214
 20215
 20216* EXEC CICS READ
 20217*        UPDATE
 20218*        DATASET  (CRTT-ID)
 20219*        RIDFLD   (WS-ELCRTT-KEY)
 20220*        INTO     (CERTIFICATE-TRAILERS)
 20221*    END-EXEC.
 20222     MOVE LENGTH OF
 20223      CERTIFICATE-TRAILERS
 20224       TO DFHEIV11
 20225*    MOVE '&"IL       EU         (   #00019456' TO DFHEIV0
 20226     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20227     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20228     MOVE X'2020233030303139343536' TO DFHEIV0(25:11)
 20229     CALL 'kxdfhei1' USING DFHEIV0,
 20230           CRTT-ID,
 20231           CERTIFICATE-TRAILERS,
 20232           DFHEIV11,
 20233           WS-ELCRTT-KEY,
 20234           DFHEIV99,
 20235           DFHEIV99,
 20236           DFHEIV99
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20238
 20239
 20240     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20241         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20242
 20243* EXEC CICS REWRITE
 20244*           DATASET  (CRTT-ID)
 20245*           FROM     (CERTIFICATE-TRAILERS)
 20246*        END-EXEC
 20247     MOVE LENGTH OF
 20248      CERTIFICATE-TRAILERS
 20249       TO DFHEIV11
 20250*    MOVE '&& L                  %   #00019465' TO DFHEIV0
 20251     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20252     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20253     MOVE X'2020233030303139343635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 374
* EL050.cbl
 20254     CALL 'kxdfhei1' USING DFHEIV0,
 20255           CRTT-ID,
 20256           CERTIFICATE-TRAILERS,
 20257           DFHEIV11,
 20258           DFHEIV99
 20259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20260     ELSE
 20261
 20262* EXEC CICS UNLOCK
 20263*          DATASET  (CRTT-ID)
 20264*       END-EXEC
 20265*    MOVE '&*                    #   #00019470' TO DFHEIV0
 20266     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20267     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20268     MOVE X'2020233030303139343730' TO DFHEIV0(25:11)
 20269     CALL 'kxdfhei1' USING DFHEIV0,
 20270           CRTT-ID,
 20271           DFHEIV99
 20272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20273     END-IF.
 20274
 20275     GO TO 8180-EXIT.
 20276
 20277 8180-NOTFND.
 20278
 20279     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20280     MOVE 'CS'         TO CS-RECORD-ID.
 20281     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20282     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20283     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20284     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20285
 20286* EXEC CICS WRITE
 20287*       DATASET  (CRTT-ID)
 20288*       RIDFLD   (WS-ELCRTT-KEY)
 20289*       FROM     (CERTIFICATE-TRAILERS)
 20290*    END-EXEC.
 20291     MOVE LENGTH OF
 20292      CERTIFICATE-TRAILERS
 20293       TO DFHEIV11
 20294*    MOVE '&$ L                  ''   #00019485' TO DFHEIV0
 20295     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20296     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20297     MOVE X'2020233030303139343835' TO DFHEIV0(25:11)
 20298     CALL 'kxdfhei1' USING DFHEIV0,
 20299           CRTT-ID,
 20300           CERTIFICATE-TRAILERS,
 20301           DFHEIV11,
 20302           WS-ELCRTT-KEY,
 20303           DFHEIV99,
 20304           DFHEIV99
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308 8180-EXIT.
 20309     EXIT.
 20310
 20311 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 375
* EL050.cbl
 20312
 20313* EXEC CICS HANDLE CONDITION
 20314*        NOTFND   (8190-NOTFND)
 20315*    END-EXEC.
 20316*    MOVE '"$I                   ! 1 #00019495' TO DFHEIV0
 20317     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20319     MOVE X'3120233030303139343935' TO DFHEIV0(25:11)
 20320     CALL 'kxdfhei1' USING DFHEIV0
 20321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20322
 20323
 20324     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20325     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20326
 20327
 20328* EXEC CICS READ
 20329*        UPDATE
 20330*        DATASET  (CRTT-ID)
 20331*        RIDFLD   (WS-ELCRTT-KEY)
 20332*        INTO     (CERTIFICATE-TRAILERS)
 20333*    END-EXEC.
 20334     MOVE LENGTH OF
 20335      CERTIFICATE-TRAILERS
 20336       TO DFHEIV11
 20337*    MOVE '&"IL       EU         (   #00019502' TO DFHEIV0
 20338     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20339     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20340     MOVE X'2020233030303139353032' TO DFHEIV0(25:11)
 20341     CALL 'kxdfhei1' USING DFHEIV0,
 20342           CRTT-ID,
 20343           CERTIFICATE-TRAILERS,
 20344           DFHEIV11,
 20345           WS-ELCRTT-KEY,
 20346           DFHEIV99,
 20347           DFHEIV99,
 20348           DFHEIV99
 20349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20350
 20351
 20352     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20353
 20354* EXEC CICS REWRITE
 20355*       DATASET  (CRTT-ID)
 20356*       FROM     (CERTIFICATE-TRAILERS)
 20357*    END-EXEC.
 20358     MOVE LENGTH OF
 20359      CERTIFICATE-TRAILERS
 20360       TO DFHEIV11
 20361*    MOVE '&& L                  %   #00019510' TO DFHEIV0
 20362     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20364     MOVE X'2020233030303139353130' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0,
 20366           CRTT-ID,
 20367           CERTIFICATE-TRAILERS,
 20368           DFHEIV11,
 20369           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 376
* EL050.cbl
 20370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20371
 20372
 20373     GO TO 8190-EXIT.
 20374
 20375 8190-NOTFND.
 20376
 20377     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20378     MOVE 'CS'         TO CS-RECORD-ID.
 20379     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20380     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20381     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20382     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20383
 20384* EXEC CICS WRITE
 20385*       DATASET  (CRTT-ID)
 20386*       RIDFLD   (WS-ELCRTT-KEY)
 20387*       FROM     (CERTIFICATE-TRAILERS)
 20388*    END-EXEC.
 20389     MOVE LENGTH OF
 20390      CERTIFICATE-TRAILERS
 20391       TO DFHEIV11
 20392*    MOVE '&$ L                  ''   #00019525' TO DFHEIV0
 20393     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20394     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20395     MOVE X'2020233030303139353235' TO DFHEIV0(25:11)
 20396     CALL 'kxdfhei1' USING DFHEIV0,
 20397           CRTT-ID,
 20398           CERTIFICATE-TRAILERS,
 20399           DFHEIV11,
 20400           WS-ELCRTT-KEY,
 20401           DFHEIV99,
 20402           DFHEIV99
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406 8190-EXIT.
 20407     EXIT.
 20408
 20409 8195-UPDATE-AGE-FLAGS.
 20410
 20411* EXEC CICS HANDLE CONDITION
 20412*        NOTFND   (8195-NOTFND)
 20413*    END-EXEC.
 20414*    MOVE '"$I                   ! 2 #00019535' TO DFHEIV0
 20415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20417     MOVE X'3220233030303139353335' TO DFHEIV0(25:11)
 20418     CALL 'kxdfhei1' USING DFHEIV0
 20419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20420
 20421
 20422     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20423     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20424
 20425
 20426* EXEC CICS READ
 20427*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 377
* EL050.cbl
 20428*        DATASET  (CRTT-ID)
 20429*        RIDFLD   (WS-ELCRTT-KEY)
 20430*        INTO     (CERTIFICATE-TRAILERS)
 20431*    END-EXEC.
 20432     MOVE LENGTH OF
 20433      CERTIFICATE-TRAILERS
 20434       TO DFHEIV11
 20435*    MOVE '&"IL       EU         (   #00019542' TO DFHEIV0
 20436     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20437     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20438     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 20439     CALL 'kxdfhei1' USING DFHEIV0,
 20440           CRTT-ID,
 20441           CERTIFICATE-TRAILERS,
 20442           DFHEIV11,
 20443           WS-ELCRTT-KEY,
 20444           DFHEIV99,
 20445           DFHEIV99,
 20446           DFHEIV99
 20447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20448
 20449
 20450     IF WS-INS-AGE-SET = 'Y'
 20451        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20452     END-IF
 20453     IF WS-JNT-AGE-SET = 'Y'
 20454        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20455     END-IF
 20456
 20457
 20458* EXEC CICS REWRITE
 20459*       DATASET  (CRTT-ID)
 20460*       FROM     (CERTIFICATE-TRAILERS)
 20461*    END-EXEC.
 20462     MOVE LENGTH OF
 20463      CERTIFICATE-TRAILERS
 20464       TO DFHEIV11
 20465*    MOVE '&& L                  %   #00019556' TO DFHEIV0
 20466     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20467     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20468     MOVE X'2020233030303139353536' TO DFHEIV0(25:11)
 20469     CALL 'kxdfhei1' USING DFHEIV0,
 20470           CRTT-ID,
 20471           CERTIFICATE-TRAILERS,
 20472           DFHEIV11,
 20473           DFHEIV99
 20474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20475
 20476
 20477     GO TO 8195-EXIT.
 20478
 20479 8195-NOTFND.
 20480
 20481     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20482     MOVE 'CS'         TO CS-RECORD-ID.
 20483     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20484     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20485     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 378
* EL050.cbl
 20486     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20487     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20488
 20489* EXEC CICS WRITE
 20490*       DATASET  (CRTT-ID)
 20491*       RIDFLD   (WS-ELCRTT-KEY)
 20492*       FROM     (CERTIFICATE-TRAILERS)
 20493*    END-EXEC.
 20494     MOVE LENGTH OF
 20495      CERTIFICATE-TRAILERS
 20496       TO DFHEIV11
 20497*    MOVE '&$ L                  ''   #00019572' TO DFHEIV0
 20498     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20500     MOVE X'2020233030303139353732' TO DFHEIV0(25:11)
 20501     CALL 'kxdfhei1' USING DFHEIV0,
 20502           CRTT-ID,
 20503           CERTIFICATE-TRAILERS,
 20504           DFHEIV11,
 20505           WS-ELCRTT-KEY,
 20506           DFHEIV99,
 20507           DFHEIV99
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511 8195-EXIT.
 20512     EXIT.
 20513
 20514 8200-READ-REIN-TABLE.
 20515
 20516* EXEC CICS HANDLE CONDITION
 20517*         NOTFND   (8200-NOTFND)
 20518*    END-EXEC.
 20519*    MOVE '"$I                   ! 3 #00019582' TO DFHEIV0
 20520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20522     MOVE X'3320233030303139353832' TO DFHEIV0(25:11)
 20523     CALL 'kxdfhei1' USING DFHEIV0
 20524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20525
 20526
 20527
 20528* EXEC CICS READ
 20529*        DATASET     (REIN-ID)
 20530*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20531*        RIDFLD      (ERREIN-KEY)
 20532*    END-EXEC.
 20533*    MOVE '&"S        E          (   #00019586' TO DFHEIV0
 20534     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20536     MOVE X'2020233030303139353836' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0,
 20538           REIN-ID,
 20539           DFHEIV20,
 20540           DFHEIV99,
 20541           ERREIN-KEY,
 20542           DFHEIV99,
 20543           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 379
* EL050.cbl
 20544           DFHEIV99
 20545     SET ADDRESS OF REINSURANCE-RECORD TO
 20546         DFHEIV20
 20547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20548
 20549
 20550     GO TO 8200-EXIT.
 20551
 20552 8200-NOTFND.
 20553     MOVE 'N'             TO WS-REIN-READ-SW.
 20554
 20555 8200-EXIT.
 20556      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 380
* EL050.cbl
 20558
 20559 8300-READ-CTBL-TABLE.
 20560
 20561* EXEC CICS HANDLE CONDITION
 20562*        NOTFND    (8300-NOTFND)
 20563*        DISABLED  (8300-ERRESS-PROBLEM)
 20564*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20565*        ENDFILE   (8300-NOTFND)
 20566*    END-EXEC.
 20567*    MOVE '"$IcJ''                ! 4 #00019602' TO DFHEIV0
 20568     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20570     MOVE X'3420233030303139363032' TO DFHEIV0(25:11)
 20571     CALL 'kxdfhei1' USING DFHEIV0
 20572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20573
 20574
 20575
 20576* EXEC CICS READ
 20577*        DATASET     (CTBL-ID)
 20578*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20579*        RIDFLD      (ERCTBL-KEY)
 20580*    END-EXEC.
 20581*    MOVE '&"S        E          (   #00019609' TO DFHEIV0
 20582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20584     MOVE X'2020233030303139363039' TO DFHEIV0(25:11)
 20585     CALL 'kxdfhei1' USING DFHEIV0,
 20586           CTBL-ID,
 20587           DFHEIV20,
 20588           DFHEIV99,
 20589           ERCTBL-KEY,
 20590           DFHEIV99,
 20591           DFHEIV99,
 20592           DFHEIV99
 20593     SET ADDRESS OF COMM-TABLE-RECORD TO
 20594         DFHEIV20
 20595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20596
 20597
 20598     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20599
 20600     GO TO 8300-EXIT.
 20601
 20602 8300-NOTFND.
 20603
 20604     IF CTBL-SW = '0530'
 20605         MOVE 'AA'                     TO WS-AH-COMP-CD
 20606         MOVE '0550'                   TO CTBL-SW
 20607         MOVE '1'                      TO WS-CTBL-READ-SW
 20608         GO TO 8300-EXIT.
 20609
 20610     IF CTBL-SW = '0540'
 20611         MOVE 'AA'                     TO WS-LF-COMP-CD
 20612         MOVE '0550'                   TO CTBL-SW
 20613         MOVE '1'                      TO WS-CTBL-READ-SW
 20614         GO TO 8300-EXIT.
 20615
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 381
* EL050.cbl
 20616     IF CTBL-SW = '0550'
 20617         MOVE '2'                      TO WS-CTBL-READ-SW
 20618         GO TO 8300-EXIT.
 20619
 20620     GO TO 8300-EXIT.
 20621
 20622 8300-ERRESS-PROBLEM.
 20623
 20624      MOVE ER-8050              TO WS-ERROR.
 20625      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20626
 20627     GO TO 8300-EXIT.
 20628
 20629 8300-EXIT.
 20630      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 382
* EL050.cbl
 20632
 20633
 20634 8400-GETMAIN-ERFORM.
 20635
 20636
 20637* EXEC CICS   GETMAIN
 20638*        LENGTH  (500)
 20639*        SET     (ADDRESS OF FORM-MASTER)
 20640*    END-EXEC.
 20641     MOVE 500
 20642       TO DFHEIV11
 20643*    MOVE '," L                  $   #00019653' TO DFHEIV0
 20644     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20646     MOVE X'2020233030303139363533' TO DFHEIV0(25:11)
 20647     CALL 'kxdfhei1' USING DFHEIV0,
 20648           DFHEIV20,
 20649           DFHEIV11,
 20650           DFHEIV99
 20651     SET ADDRESS OF FORM-MASTER TO
 20652         DFHEIV20
 20653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20654
 20655
 20656     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20657
 20658 8400-EXIT.
 20659      EXIT.
 20660
 20661 8450-READ-FORM-MASTER.
 20662
 20663
 20664* EXEC CICS  HANDLE CONDITION
 20665*        NOTFND   (8450-FORM-NOT-FOUND)
 20666*        ENDFILE  (8450-FORM-NOT-FOUND)
 20667*    END-EXEC.
 20668*    MOVE '"$I''                  ! 5 #00019665' TO DFHEIV0
 20669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20671     MOVE X'3520233030303139363635' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20674
 20675
 20676
 20677* EXEC CICS   READ
 20678*        DATASET   (FORM-ID)
 20679*        RIDFLD    (ERFORM-KEY)
 20680*        INTO      (FORM-MASTER)
 20681*        GTEQ
 20682*    END-EXEC.
 20683     MOVE LENGTH OF
 20684      FORM-MASTER
 20685       TO DFHEIV11
 20686*    MOVE '&"IL       G          (   #00019670' TO DFHEIV0
 20687     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20689     MOVE X'2020233030303139363730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 383
* EL050.cbl
 20690     CALL 'kxdfhei1' USING DFHEIV0,
 20691           FORM-ID,
 20692           FORM-MASTER,
 20693           DFHEIV11,
 20694           ERFORM-KEY,
 20695           DFHEIV99,
 20696           DFHEIV99,
 20697           DFHEIV99
 20698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20699
 20700
 20701     MOVE  'Y'           TO  FORM-MASTER-SW.
 20702
 20703     GO TO  8450-EXIT.
 20704
 20705 8450-FORM-NOT-FOUND.
 20706
 20707     MOVE  'N'           TO  FORM-MASTER-SW.
 20708
 20709 8450-EXIT.
 20710      EXIT.
 20711
 20712 8500-DATE-CONVERT.
 20713
 20714* EXEC CICS LINK
 20715*        PROGRAM    ('ELDATCV')
 20716*        COMMAREA   (DATE-CONVERSION-DATA)
 20717*        LENGTH     (DC-COMM-LENGTH)
 20718*    END-EXEC.
 20719     MOVE 'ELDATCV' TO DFHEIV1
 20720*    MOVE '."C                   (   #00019689' TO DFHEIV0
 20721     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20723     MOVE X'2020233030303139363839' TO DFHEIV0(25:11)
 20724     CALL 'kxdfhei1' USING DFHEIV0,
 20725           DFHEIV1,
 20726           DATE-CONVERSION-DATA,
 20727           DC-COMM-LENGTH,
 20728           DFHEIV99,
 20729           DFHEIV99,
 20730           DFHEIV99,
 20731           DFHEIV99
 20732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20733
 20734
 20735 8500-EXIT.
 20736     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 384
* EL050.cbl
 20738
 20739 8555-RELOAD-CONTROL-FILE.
 20740     CONTINUE.
 20741
 20742 8555-EXIT.
 20743     EXIT.
 20744
 20745 8557-GETMAIN-ERPLAN.
 20746
 20747
 20748* EXEC CICS GETMAIN
 20749*        LENGTH    (840)
 20750*        SET       (ADDRESS OF PLAN-RECORDS)
 20751*    END-EXEC.
 20752     MOVE 840
 20753       TO DFHEIV11
 20754*    MOVE '," L                  $   #00019707' TO DFHEIV0
 20755     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20757     MOVE X'2020233030303139373037' TO DFHEIV0(25:11)
 20758     CALL 'kxdfhei1' USING DFHEIV0,
 20759           DFHEIV20,
 20760           DFHEIV11,
 20761           DFHEIV99
 20762     SET ADDRESS OF PLAN-RECORDS TO
 20763         DFHEIV20
 20764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20765
 20766
 20767     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20768
 20769 8557-EXIT.
 20770     EXIT.
 20771
 20772 8560-GETMAIN.
 20773
 20774* EXEC CICS GETMAIN
 20775*        LENGTH    (2000)
 20776*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20777*    END-EXEC.
 20778     MOVE 2000
 20779       TO DFHEIV11
 20780*    MOVE '," L                  $   #00019718' TO DFHEIV0
 20781     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20783     MOVE X'2020233030303139373138' TO DFHEIV0(25:11)
 20784     CALL 'kxdfhei1' USING DFHEIV0,
 20785           DFHEIV20,
 20786           DFHEIV11,
 20787           DFHEIV99
 20788     SET ADDRESS OF ACCOUNT-MASTER TO
 20789         DFHEIV20
 20790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20791
 20792
 20793     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20794
 20795 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 385
* EL050.cbl
 20796     EXIT.
 20797
 20798 8570-START-ACCOUNT-MASTER.
 20799
 20800* EXEC CICS HANDLE CONDITION
 20801*        NOTFND    (0199-ACCT-NOT-FOUND)
 20802*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20803*    END-EXEC.
 20804*    MOVE '"$I''                  ! 6 #00019729' TO DFHEIV0
 20805     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20807     MOVE X'3620233030303139373239' TO DFHEIV0(25:11)
 20808     CALL 'kxdfhei1' USING DFHEIV0
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812
 20813* EXEC CICS STARTBR
 20814*        DATASET    (ACCT-ID)
 20815*        RIDFLD     (ERACCT-KEY)
 20816*        GTEQ
 20817*    END-EXEC.
 20818     MOVE 0
 20819       TO DFHEIV11
 20820*    MOVE '&,         G          &   #00019734' TO DFHEIV0
 20821     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20823     MOVE X'2020233030303139373334' TO DFHEIV0(25:11)
 20824     CALL 'kxdfhei1' USING DFHEIV0,
 20825           ACCT-ID,
 20826           ERACCT-KEY,
 20827           DFHEIV99,
 20828           DFHEIV11,
 20829           DFHEIV99
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833 8570-EXIT.
 20834     EXIT.
 20835
 20836 8580-READ-ACCOUNT-MASTER.
 20837
 20838* EXEC CICS HANDLE CONDITION
 20839*        NOTFND    (0199-ACCT-NOT-FOUND)
 20840*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20841*    END-EXEC.
 20842*    MOVE '"$I''                  ! 7 #00019744' TO DFHEIV0
 20843     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20845     MOVE X'3720233030303139373434' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0
 20847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20848
 20849
 20850
 20851* EXEC CICS READNEXT
 20852*        DATASET     (ACCT-ID)
 20853*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 386
* EL050.cbl
 20854*        RIDFLD      (ERACCT-KEY)
 20855*    END-EXEC.
 20856     MOVE LENGTH OF
 20857      ACCOUNT-MASTER
 20858       TO DFHEIV12
 20859     MOVE 0
 20860       TO DFHEIV11
 20861*    MOVE '&.IL                  )   #00019749' TO DFHEIV0
 20862     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20863     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20864     MOVE X'2020233030303139373439' TO DFHEIV0(25:11)
 20865     CALL 'kxdfhei1' USING DFHEIV0,
 20866           ACCT-ID,
 20867           ACCOUNT-MASTER,
 20868           DFHEIV12,
 20869           ERACCT-KEY,
 20870           DFHEIV99,
 20871           DFHEIV11,
 20872           DFHEIV99,
 20873           DFHEIV99
 20874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20875
 20876
 20877 8580-EXIT.
 20878     EXIT.
 20879
 20880 8582-READ-COMPENSATION-MASTER.
 20881
 20882* EXEC CICS HANDLE CONDITION
 20883*        NOTFND    (8582-COMP-NOT-FOUND)
 20884*        ENDFILE   (8582-COMP-NOT-FOUND)
 20885*    END-EXEC.
 20886*    MOVE '"$I''                  ! 8 #00019759' TO DFHEIV0
 20887     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20889     MOVE X'3820233030303139373539' TO DFHEIV0(25:11)
 20890     CALL 'kxdfhei1' USING DFHEIV0
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894
 20895* EXEC CICS READ
 20896*        DATASET     (COMP-ID)
 20897*        INTO        (COMPENSATION-MASTER)
 20898*        RIDFLD      (ERCOMP-KEY)
 20899*    END-EXEC.
 20900     MOVE LENGTH OF
 20901      COMPENSATION-MASTER
 20902       TO DFHEIV11
 20903*    MOVE '&"IL       E          (   #00019764' TO DFHEIV0
 20904     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20906     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
 20907     CALL 'kxdfhei1' USING DFHEIV0,
 20908           COMP-ID,
 20909           COMPENSATION-MASTER,
 20910           DFHEIV11,
 20911           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 387
* EL050.cbl
 20912           DFHEIV99,
 20913           DFHEIV99,
 20914           DFHEIV99
 20915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20916
 20917
 20918     MOVE 'Y'                    TO COMP-MASTER-SW
 20919
 20920     GO TO 8582-EXIT
 20921     .
 20922 8582-COMP-NOT-FOUND.
 20923
 20924     MOVE 'N'                    TO COMP-MASTER-SW.
 20925
 20926 8582-EXIT.
 20927     EXIT.
 20928
 20929 8583-READ-ERAGTC.
 20930
 20931* EXEC CICS HANDLE CONDITION
 20932*        NOTFND    (8583-AGTC-NOT-FOUND)
 20933*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20934*    END-EXEC.
 20935*    MOVE '"$I''                  ! 9 #00019782' TO DFHEIV0
 20936     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20938     MOVE X'3920233030303139373832' TO DFHEIV0(25:11)
 20939     CALL 'kxdfhei1' USING DFHEIV0
 20940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20941
 20942
 20943
 20944* EXEC CICS STARTBR
 20945*        DATASET    (AGTC-ID)
 20946*        RIDFLD     (ERAGTC-KEY)
 20947*        GTEQ
 20948*    END-EXEC.
 20949     MOVE 0
 20950       TO DFHEIV11
 20951*    MOVE '&,         G          &   #00019787' TO DFHEIV0
 20952     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20953     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20954     MOVE X'2020233030303139373837' TO DFHEIV0(25:11)
 20955     CALL 'kxdfhei1' USING DFHEIV0,
 20956           AGTC-ID,
 20957           ERAGTC-KEY,
 20958           DFHEIV99,
 20959           DFHEIV11,
 20960           DFHEIV99
 20961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20962
 20963
 20964 8583-READ-ERAGTC-NEXT.
 20965
 20966* EXEC CICS READNEXT
 20967*        DATASET     (AGTC-ID)
 20968*        INTO        (AGENT-COMMISSIONS)
 20969*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 388
* EL050.cbl
 20970*    END-EXEC.
 20971     MOVE LENGTH OF
 20972      AGENT-COMMISSIONS
 20973       TO DFHEIV12
 20974     MOVE 0
 20975       TO DFHEIV11
 20976*    MOVE '&.IL                  )   #00019794' TO DFHEIV0
 20977     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20978     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20979     MOVE X'2020233030303139373934' TO DFHEIV0(25:11)
 20980     CALL 'kxdfhei1' USING DFHEIV0,
 20981           AGTC-ID,
 20982           AGENT-COMMISSIONS,
 20983           DFHEIV12,
 20984           ERAGTC-KEY,
 20985           DFHEIV99,
 20986           DFHEIV11,
 20987           DFHEIV99,
 20988           DFHEIV99
 20989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20990
 20991
 20992*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20993
 20994     GO TO 8583-EXIT
 20995     .
 20996 8583-AGTC-NOT-FOUND.
 20997
 20998     MOVE 'N'                    TO AGTC-MASTER-SW.
 20999
 21000 8583-EXIT.
 21001     EXIT.
 21002
 21003 8584-READ-BANK-CROSS-REF.
 21004
 21005* EXEC CICS HANDLE CONDITION
 21006*        NOTFND    (8584-BXRF-NOT-FOUND)
 21007*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21008*    END-EXEC.
 21009*    MOVE '"$I''                  ! : #00019812' TO DFHEIV0
 21010     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21012     MOVE X'3A20233030303139383132' TO DFHEIV0(25:11)
 21013     CALL 'kxdfhei1' USING DFHEIV0
 21014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21015
 21016
 21017
 21018* EXEC CICS READ
 21019*        DATASET     (BXRF-ID)
 21020*        INTO        (BANK-CROSS-REFERENCE)
 21021*        RIDFLD      (ERBXRF-KEY)
 21022*        LENGTH      (BXRF-REC-LENGTH)
 21023*    END-EXEC.
 21024*    MOVE '&"IL       E          (   #00019817' TO DFHEIV0
 21025     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21027     MOVE X'2020233030303139383137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 389
* EL050.cbl
 21028     CALL 'kxdfhei1' USING DFHEIV0,
 21029           BXRF-ID,
 21030           BANK-CROSS-REFERENCE,
 21031           BXRF-REC-LENGTH,
 21032           ERBXRF-KEY,
 21033           DFHEIV99,
 21034           DFHEIV99,
 21035           DFHEIV99
 21036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21037
 21038
 21039     MOVE 'Y'                    TO BXRF-MASTER-SW
 21040
 21041     GO TO 8584-EXIT
 21042     .
 21043 8584-BXRF-NOT-FOUND.
 21044
 21045     MOVE 'N'                    TO BXRF-MASTER-SW.
 21046
 21047 8584-EXIT.
 21048     EXIT.
 21049
 21050 8585-READ-PLAN-MASTER.
 21051
 21052
 21053* EXEC CICS HANDLE CONDITION
 21054*        NOTFND    (8585-PLAN-NOT-FOUND)
 21055*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21056*    END-EXEC.
 21057*    MOVE '"$I''                  ! ; #00019837' TO DFHEIV0
 21058     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21060     MOVE X'3B20233030303139383337' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0
 21062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21063
 21064
 21065
 21066* EXEC CICS READ
 21067*        DATASET     (PLAN-ID)
 21068*        INTO        (PLAN-MASTER)
 21069*        RIDFLD      (ERPLAN-KEY)
 21070*    END-EXEC.
 21071     MOVE LENGTH OF
 21072      PLAN-MASTER
 21073       TO DFHEIV11
 21074*    MOVE '&"IL       E          (   #00019842' TO DFHEIV0
 21075     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21077     MOVE X'2020233030303139383432' TO DFHEIV0(25:11)
 21078     CALL 'kxdfhei1' USING DFHEIV0,
 21079           PLAN-ID,
 21080           PLAN-MASTER,
 21081           DFHEIV11,
 21082           ERPLAN-KEY,
 21083           DFHEIV99,
 21084           DFHEIV99,
 21085           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 390
* EL050.cbl
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21090
 21091     GO TO 8585-EXIT.
 21092
 21093 8585-PLAN-NOT-FOUND.
 21094
 21095     MOVE 'N'                    TO PLAN-MASTER-SW.
 21096
 21097 8585-EXIT.
 21098     EXIT.
 21099
 21100 8586-READ-LOAN-OFFICER.
 21101
 21102* EXEC CICS READ
 21103*        DATASET     (LOFC-ID)
 21104*        INTO        (LOAN-OFFICER-MASTER)
 21105*        RIDFLD      (ERLOFC-KEY)
 21106*        RESP        (WS-RESPONSE)
 21107*    END-EXEC
 21108     MOVE LENGTH OF
 21109      LOAN-OFFICER-MASTER
 21110       TO DFHEIV11
 21111*    MOVE '&"IL       E          (  N#00019860' TO DFHEIV0
 21112     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21114     MOVE X'204E233030303139383630' TO DFHEIV0(25:11)
 21115     CALL 'kxdfhei1' USING DFHEIV0,
 21116           LOFC-ID,
 21117           LOAN-OFFICER-MASTER,
 21118           DFHEIV11,
 21119           ERLOFC-KEY,
 21120           DFHEIV99,
 21121           DFHEIV99,
 21122           DFHEIV99
 21123     MOVE EIBRESP  TO WS-RESPONSE
 21124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21125
 21126     IF WS-RESP-NORMAL
 21127        MOVE 'Y'                 TO LOFC-MASTER-SW
 21128     ELSE
 21129        MOVE 'N'                 TO LOFC-MASTER-SW
 21130     END-IF
 21131     .
 21132 8586-EXIT.
 21133     EXIT.
 21134 8587-START-ERPDEF.
 21135
 21136* EXEC CICS STARTBR
 21137*       DATASET   (PDEF-ID)
 21138*       RIDFLD    (ERPDEF-KEY)
 21139*       GTEQ
 21140*       RESP      (WS-RESPONSE)
 21141*    END-EXEC
 21142     MOVE 0
 21143       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 391
* EL050.cbl
 21144*    MOVE '&,         G          &  N#00019876' TO DFHEIV0
 21145     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21146     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21147     MOVE X'204E233030303139383736' TO DFHEIV0(25:11)
 21148     CALL 'kxdfhei1' USING DFHEIV0,
 21149           PDEF-ID,
 21150           ERPDEF-KEY,
 21151           DFHEIV99,
 21152           DFHEIV11,
 21153           DFHEIV99
 21154     MOVE EIBRESP  TO WS-RESPONSE
 21155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21156     IF WS-RESP-NORMAL
 21157        MOVE 'Y'                 TO PDEF-MASTER-SW
 21158     ELSE
 21159        MOVE 'N'                 TO PDEF-MASTER-SW
 21160     END-IF
 21161     .
 21162 8587-EXIT.
 21163     EXIT.
 21164 8588-READ-ERPDEF.
 21165
 21166* EXEC CICS READNEXT
 21167*       DATASET   (PDEF-ID)
 21168*       RIDFLD    (ERPDEF-KEY)
 21169*       INTO      (PRODUCT-MASTER)
 21170*       RESP      (WS-RESPONSE)
 21171*    END-EXEC
 21172     MOVE LENGTH OF
 21173      PRODUCT-MASTER
 21174       TO DFHEIV12
 21175     MOVE 0
 21176       TO DFHEIV11
 21177*    MOVE '&.IL                  )  N#00019891' TO DFHEIV0
 21178     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21179     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21180     MOVE X'204E233030303139383931' TO DFHEIV0(25:11)
 21181     CALL 'kxdfhei1' USING DFHEIV0,
 21182           PDEF-ID,
 21183           PRODUCT-MASTER,
 21184           DFHEIV12,
 21185           ERPDEF-KEY,
 21186           DFHEIV99,
 21187           DFHEIV11,
 21188           DFHEIV99,
 21189           DFHEIV99
 21190     MOVE EIBRESP  TO WS-RESPONSE
 21191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21192     IF WS-RESP-NORMAL
 21193        MOVE 'Y'                 TO PDEF-MASTER-SW
 21194     ELSE
 21195        MOVE 'N'                 TO PDEF-MASTER-SW
 21196     END-IF
 21197     .
 21198 8588-EXIT.
 21199     EXIT.
 21200 8589-ENDBR-ERPDEF.
 21201
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 392
* EL050.cbl
 21202* EXEC CICS ENDBR
 21203*       DATASET   (PDEF-ID)
 21204*    END-EXEC
 21205     MOVE 0
 21206       TO DFHEIV11
 21207*    MOVE '&2                    $   #00019906' TO DFHEIV0
 21208     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21209     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21210     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 21211     CALL 'kxdfhei1' USING DFHEIV0,
 21212           PDEF-ID,
 21213           DFHEIV11,
 21214           DFHEIV99
 21215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21216     .
 21217 8589-EXIT.
 21218     EXIT.
 21219 8590-READ-CERT-MASTER.
 21220     IF PB-COMPANY-ID = 'UCL'
 21221         GO TO 8690-READ-CERT-MASTER-UCL.
 21222
 21223
 21224* EXEC CICS HANDLE CONDITION
 21225*         NOTFND    (0299-CERT-NOT-FOUND)
 21226*    END-EXEC.
 21227*    MOVE '"$I                   ! < #00019916' TO DFHEIV0
 21228     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21230     MOVE X'3C20233030303139393136' TO DFHEIV0(25:11)
 21231     CALL 'kxdfhei1' USING DFHEIV0
 21232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21233
 21234
 21235
 21236* EXEC CICS READ
 21237*        DATASET     (CERT-ID)
 21238*        INTO        (CERTIFICATE-MASTER)
 21239*        RIDFLD      (ELCERT-KEY)
 21240*        UPDATE
 21241*    END-EXEC.
 21242     MOVE LENGTH OF
 21243      CERTIFICATE-MASTER
 21244       TO DFHEIV11
 21245*    MOVE '&"IL       EU         (   #00019920' TO DFHEIV0
 21246     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21247     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21248     MOVE X'2020233030303139393230' TO DFHEIV0(25:11)
 21249     CALL 'kxdfhei1' USING DFHEIV0,
 21250           CERT-ID,
 21251           CERTIFICATE-MASTER,
 21252           DFHEIV11,
 21253           ELCERT-KEY,
 21254           DFHEIV99,
 21255           DFHEIV99,
 21256           DFHEIV99
 21257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21258
 21259
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 393
* EL050.cbl
 21260 8590-EXIT.
 21261     EXIT.
 21262
 21263 8690-READ-CERT-MASTER-UCL.
 21264
 21265* EXEC CICS HANDLE CONDITION
 21266*         NOTFND    (8700-READ-CERT-MASTER)
 21267*    END-EXEC.
 21268*    MOVE '"$I                   ! = #00019931' TO DFHEIV0
 21269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21271     MOVE X'3D20233030303139393331' TO DFHEIV0(25:11)
 21272     CALL 'kxdfhei1' USING DFHEIV0
 21273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21274
 21275
 21276 8690-READ-CERT-CONT.
 21277
 21278* EXEC CICS READ
 21279*        DATASET     (CERT-ID)
 21280*        INTO        (CERTIFICATE-MASTER)
 21281*        RIDFLD      (ELCERT-KEY)
 21282*        UPDATE
 21283*    END-EXEC.
 21284     MOVE LENGTH OF
 21285      CERTIFICATE-MASTER
 21286       TO DFHEIV11
 21287*    MOVE '&"IL       EU         (   #00019936' TO DFHEIV0
 21288     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21290     MOVE X'2020233030303139393336' TO DFHEIV0(25:11)
 21291     CALL 'kxdfhei1' USING DFHEIV0,
 21292           CERT-ID,
 21293           CERTIFICATE-MASTER,
 21294           DFHEIV11,
 21295           ELCERT-KEY,
 21296           DFHEIV99,
 21297           DFHEIV99,
 21298           DFHEIV99
 21299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21300
 21301
 21302     GO TO 8590-EXIT.
 21303
 21304 8700-READ-CERT-MASTER.
 21305     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21306     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21307
 21308* EXEC CICS HANDLE CONDITION
 21309*         DUPKEY    (8720-COMP-ACCOUNTS)
 21310*         ENDFILE   (8730-END-BROWSE)
 21311*         NOTFND    (8740-NOT-FOUND)
 21312*    END-EXEC.
 21313*    MOVE '"$$''I                 ! > #00019948' TO DFHEIV0
 21314     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21316     MOVE X'3E20233030303139393438' TO DFHEIV0(25:11)
 21317     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 394
* EL050.cbl
 21318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21319
 21320
 21321
 21322* EXEC CICS STARTBR
 21323*        DATASET     ('ELCERT5')
 21324*        RIDFLD      (ELCERT2-KEY)
 21325*        EQUAL
 21326*    END-EXEC.
 21327     MOVE 'ELCERT5' TO DFHEIV1
 21328     MOVE 0
 21329       TO DFHEIV11
 21330*    MOVE '&,         E          &   #00019954' TO DFHEIV0
 21331     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21332     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21333     MOVE X'2020233030303139393534' TO DFHEIV0(25:11)
 21334     CALL 'kxdfhei1' USING DFHEIV0,
 21335           DFHEIV1,
 21336           ELCERT2-KEY,
 21337           DFHEIV99,
 21338           DFHEIV11,
 21339           DFHEIV99
 21340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21341
 21342
 21343 8710-READ-NEXT.
 21344
 21345* EXEC CICS READNEXT
 21346*        DATASET     ('ELCERT5')
 21347*        INTO        (CERTIFICATE-MASTER)
 21348*        RIDFLD      (ELCERT2-KEY)
 21349*    END-EXEC.
 21350     MOVE LENGTH OF
 21351      CERTIFICATE-MASTER
 21352       TO DFHEIV12
 21353     MOVE 'ELCERT5' TO DFHEIV1
 21354     MOVE 0
 21355       TO DFHEIV11
 21356*    MOVE '&.IL                  )   #00019961' TO DFHEIV0
 21357     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21359     MOVE X'2020233030303139393631' TO DFHEIV0(25:11)
 21360     CALL 'kxdfhei1' USING DFHEIV0,
 21361           DFHEIV1,
 21362           CERTIFICATE-MASTER,
 21363           DFHEIV12,
 21364           ELCERT2-KEY,
 21365           DFHEIV99,
 21366           DFHEIV11,
 21367           DFHEIV99,
 21368           DFHEIV99
 21369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21370
 21371
 21372 8720-COMP-ACCOUNTS.
 21373
 21374* EXEC CICS ENTER
 21375*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 395
* EL050.cbl
 21376*         FROM (PB-C-LAST-NAME)
 21377*    END-EXEC.
 21378     MOVE 001
 21379       TO DFHEIV11
 21380*    MOVE ':$F                   %   #00019968' TO DFHEIV0
 21381     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21382     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21383     MOVE X'2020233030303139393638' TO DFHEIV0(25:11)
 21384     CALL 'kxdfhei1' USING DFHEIV0,
 21385           DFHEIV11,
 21386           PB-C-LAST-NAME,
 21387           DFHEIV99,
 21388           DFHEIV99
 21389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21390
 21391
 21392
 21393* EXEC CICS ENTER
 21394*         TRACEID (002)
 21395*         FROM (CM-INSURED-LAST-NAME)
 21396*    END-EXEC.
 21397     MOVE 002
 21398       TO DFHEIV11
 21399*    MOVE ':$F                   %   #00019973' TO DFHEIV0
 21400     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21401     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21402     MOVE X'2020233030303139393733' TO DFHEIV0(25:11)
 21403     CALL 'kxdfhei1' USING DFHEIV0,
 21404           DFHEIV11,
 21405           CM-INSURED-LAST-NAME,
 21406           DFHEIV99,
 21407           DFHEIV99
 21408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21409
 21410
 21411     IF PB-CERT-NO NOT = CM-CERT-NO
 21412         GO TO 8730-END-BROWSE.
 21413
 21414     IF PB-ACCOUNT = CM-ACCOUNT
 21415         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21416             MOVE ER-2799        TO WS-ERROR
 21417             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21418             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21419             GO TO 8730-END-BROWSE.
 21420
 21421     GO TO 8710-READ-NEXT.
 21422
 21423 8730-END-BROWSE.
 21424
 21425* EXEC CICS ENDBR
 21426*         DATASET    ('ELCERT5')
 21427*    END-EXEC.
 21428     MOVE 'ELCERT5' TO DFHEIV1
 21429     MOVE 0
 21430       TO DFHEIV11
 21431*    MOVE '&2                    $   #00019991' TO DFHEIV0
 21432     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 396
* EL050.cbl
 21434     MOVE X'2020233030303139393931' TO DFHEIV0(25:11)
 21435     CALL 'kxdfhei1' USING DFHEIV0,
 21436           DFHEIV1,
 21437           DFHEIV11,
 21438           DFHEIV99
 21439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21440
 21441
 21442 8740-NOT-FOUND.
 21443     GO TO 0299-CERT-NOT-FOUND.
 21444
 21445 8750-START-ELSTAT.
 21446
 21447* EXEC CICS STARTBR
 21448*       DATASET   (STAT-ID)
 21449*       RIDFLD    (ELSTAT-KEY)
 21450*       GTEQ
 21451*       RESP      (WS-RESPONSE)
 21452*    END-EXEC
 21453     MOVE 0
 21454       TO DFHEIV11
 21455*    MOVE '&,         G          &  N#00019999' TO DFHEIV0
 21456     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21458     MOVE X'204E233030303139393939' TO DFHEIV0(25:11)
 21459     CALL 'kxdfhei1' USING DFHEIV0,
 21460           STAT-ID,
 21461           ELSTAT-KEY,
 21462           DFHEIV99,
 21463           DFHEIV11,
 21464           DFHEIV99
 21465     MOVE EIBRESP  TO WS-RESPONSE
 21466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21467     IF WS-RESP-NORMAL
 21468        MOVE 'Y'                 TO STAT-MASTER-SW
 21469     ELSE
 21470        MOVE 'N'                 TO STAT-MASTER-SW
 21471     END-IF
 21472     .
 21473 8750-EXIT.
 21474     EXIT.
 21475 8752-READ-ELSTAT.
 21476
 21477* EXEC CICS READNEXT
 21478*       DATASET   (STAT-ID)
 21479*       RIDFLD    (ELSTAT-KEY)
 21480*       INTO      (STATE-FILE)
 21481*       RESP      (WS-RESPONSE)
 21482*    END-EXEC
 21483     MOVE LENGTH OF
 21484      STATE-FILE
 21485       TO DFHEIV12
 21486     MOVE 0
 21487       TO DFHEIV11
 21488*    MOVE '&.IL                  )  N#00020014' TO DFHEIV0
 21489     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21491     MOVE X'204E233030303230303134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 397
* EL050.cbl
 21492     CALL 'kxdfhei1' USING DFHEIV0,
 21493           STAT-ID,
 21494           STATE-FILE,
 21495           DFHEIV12,
 21496           ELSTAT-KEY,
 21497           DFHEIV99,
 21498           DFHEIV11,
 21499           DFHEIV99,
 21500           DFHEIV99
 21501     MOVE EIBRESP  TO WS-RESPONSE
 21502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21503     IF WS-RESP-NORMAL
 21504        MOVE 'Y'                 TO STAT-MASTER-SW
 21505     ELSE
 21506        MOVE 'N'                 TO STAT-MASTER-SW
 21507     END-IF
 21508     .
 21509 8752-EXIT.
 21510     EXIT.
 21511 8800-GET-COMP-RATE.
 21512     MOVE +1 TO IB.
 21513     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21514         ADD +9 TO IB
 21515         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21516             ADD +9 TO IB
 21517             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21518                MOVE ZEROS       TO WS-WK-RATE
 21519                GO TO 8800-EXIT.
 21520
 21521     IF PB-I-AGE GREATER CT-AGE (1)
 21522         ADD +3 TO IB
 21523         IF PB-I-AGE GREATER CT-AGE (2)
 21524             ADD +3 TO IB
 21525             IF PB-I-AGE GREATER CT-AGE (3)
 21526                MOVE ZEROS       TO WS-WK-RATE
 21527                GO TO 8800-EXIT.
 21528
 21529     IF WS-WORK-TERM GREATER CT-TRM (1)
 21530         ADD +1 TO IB
 21531         IF WS-WORK-TERM GREATER CT-TRM (2)
 21532             ADD +1 TO IB
 21533             IF WS-WORK-TERM GREATER CT-TRM (3)
 21534                MOVE ZEROS       TO WS-WK-RATE
 21535                GO TO 8800-EXIT.
 21536
 21537     IF CT-RT (IB) NOT NUMERIC
 21538         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21539         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21540         GO TO 8800-GET-COMP-RATE.
 21541
 21542     MOVE CT-RT (IB) TO WS-WK-RATE.
 21543
 21544 8800-EXIT.
 21545     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 398
* EL050.cbl
 21547 8900-ADDRESS-FILE.
 21548     IF ERACCT-FILE-ADDRESSED
 21549         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21550         GO TO 8900-ADDRESS-EXIT.
 21551
 21552     IF ELCNTL-FILE-ADDRESSED
 21553         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21554         GO TO 8900-ADDRESS-EXIT.
 21555
 21556     IF ERPLAN-FILE-ADDRESSED
 21557         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21558         GO TO 8900-ADDRESS-EXIT.
 21559
 21560     IF ERFORM-FILE-ADDRESSED
 21561         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21562         GO TO 8900-ADDRESS-EXIT.
 21563
 21564 8900-ADDRESS-EXIT.
 21565     EXIT.
 21566
 21567 9000-READ-CONTROL.
 21568
 21569* EXEC CICS HANDLE CONDITION
 21570*        NOTFND    (9000-NOTFND)
 21571*    END-EXEC.
 21572*    MOVE '"$I                   ! ? #00020085' TO DFHEIV0
 21573     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21575     MOVE X'3F20233030303230303835' TO DFHEIV0(25:11)
 21576     CALL 'kxdfhei1' USING DFHEIV0
 21577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21578
 21579
 21580
 21581* EXEC CICS READ
 21582*        DATASET     (CNTL-ID)
 21583*        SET         (ADDRESS OF CONTROL-FILE)
 21584*        RIDFLD      (ELCNTL-KEY)
 21585*        GTEQ
 21586*    END-EXEC.
 21587*    MOVE '&"S        G          (   #00020089' TO DFHEIV0
 21588     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21589     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21590     MOVE X'2020233030303230303839' TO DFHEIV0(25:11)
 21591     CALL 'kxdfhei1' USING DFHEIV0,
 21592           CNTL-ID,
 21593           DFHEIV20,
 21594           DFHEIV99,
 21595           ELCNTL-KEY,
 21596           DFHEIV99,
 21597           DFHEIV99,
 21598           DFHEIV99
 21599     SET ADDRESS OF CONTROL-FILE TO
 21600         DFHEIV20
 21601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21602
 21603
 21604     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 399
* EL050.cbl
 21605
 21606 9000-NOTFND.
 21607     IF RC-SW-1 = '1'
 21608        MOVE ER-2616              TO WS-ERROR
 21609        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21610        GO TO 9000-EXIT.
 21611
 21612     IF RC-SW-1 = '2'
 21613        MOVE ER-2602              TO WS-ERROR
 21614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21615
 21616 9000-EXIT.
 21617      EXIT.
 21618
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 400
* EL050.cbl
 21620 9100-READ-CONTROL.
 21621
 21622* EXEC CICS HANDLE CONDITION
 21623*        NOTFND  (9100-NOTFND)
 21624*        ENDFILE (9100-NOTFND)
 21625*    END-EXEC.
 21626*    MOVE '"$I''                  ! @ #00020113' TO DFHEIV0
 21627     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21629     MOVE X'4020233030303230313133' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0
 21631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21632
 21633
 21634
 21635* EXEC CICS READ
 21636*        DATASET     (CNTL-ID)
 21637*        INTO        (CONTROL-FILE)
 21638*        RIDFLD      (ELCNTL-KEY)
 21639*        GTEQ
 21640*    END-EXEC.
 21641     MOVE LENGTH OF
 21642      CONTROL-FILE
 21643       TO DFHEIV11
 21644*    MOVE '&"IL       G          (   #00020118' TO DFHEIV0
 21645     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21646     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21647     MOVE X'2020233030303230313138' TO DFHEIV0(25:11)
 21648     CALL 'kxdfhei1' USING DFHEIV0,
 21649           CNTL-ID,
 21650           CONTROL-FILE,
 21651           DFHEIV11,
 21652           ELCNTL-KEY,
 21653           DFHEIV99,
 21654           DFHEIV99,
 21655           DFHEIV99
 21656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21657
 21658
 21659     GO TO 9100-EXIT.
 21660
 21661 9100-NOTFND.
 21662     IF RC-SW-2 = '0'
 21663        MOVE '1'                  TO STATE-RECORD-ERROR
 21664        GO TO 9100-EXIT
 21665     END-IF
 21666     IF RC-SW-2 = '1'
 21667        MOVE '1'                  TO LF-BENEFIT-ERROR
 21668        MOVE ER-2604              TO WS-ERROR
 21669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21670        GO TO 9100-EXIT.
 21671
 21672     IF RC-SW-2 = '2'
 21673        MOVE '1'                  TO AH-BENEFIT-ERROR
 21674        MOVE ER-2605              TO WS-ERROR
 21675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21676        GO TO 9100-EXIT.
 21677
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 401
* EL050.cbl
 21678     IF RC-SW-2 = '3'
 21679         MOVE ER-2603           TO WS-ERROR
 21680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21681         GO TO 9100-EXIT.
 21682
 21683     IF RC-SW-2 = '4'
 21684         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21685         GO TO 9100-EXIT.
 21686
 21687     IF RC-SW-2 = '5'
 21688         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21689         IF WS-AH-INPUT-CD-1 = SPACE
 21690             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21691         ELSE
 21692             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21693
 21694 9100-EXIT.
 21695      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 402
* EL050.cbl
 21697 9200-CONTROL-GETMAIN.
 21698
 21699* EXEC CICS GETMAIN
 21700*         LENGTH   (750)
 21701*         SET      (ADDRESS OF CONTROL-FILE)
 21702*    END-EXEC.
 21703     MOVE 750
 21704       TO DFHEIV11
 21705*    MOVE '," L                  $   #00020164' TO DFHEIV0
 21706     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21707     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21708     MOVE X'2020233030303230313634' TO DFHEIV0(25:11)
 21709     CALL 'kxdfhei1' USING DFHEIV0,
 21710           DFHEIV20,
 21711           DFHEIV11,
 21712           DFHEIV99
 21713     SET ADDRESS OF CONTROL-FILE TO
 21714         DFHEIV20
 21715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21716
 21717
 21718     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21719
 21720 9200-EXIT.
 21721     EXIT.
 21722
 21723 9250-UNLOCK-RETURN.
 21724
 21725* EXEC CICS UNLOCK
 21726*        DATASET   (CERT-ID)
 21727*    END-EXEC.
 21728*    MOVE '&*                    #   #00020175' TO DFHEIV0
 21729     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21730     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21731     MOVE X'2020233030303230313735' TO DFHEIV0(25:11)
 21732     CALL 'kxdfhei1' USING DFHEIV0,
 21733           CERT-ID,
 21734           DFHEIV99
 21735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21736
 21737
 21738 9300-ABEND.
 21739     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21740
 21741
 21742* EXEC CICS LINK
 21743*        PROGRAM   ('EL004')
 21744*        COMMAREA  (WS-ERROR-LINE)
 21745*        LENGTH    (72)
 21746*    END-EXEC.
 21747     MOVE 'EL004' TO DFHEIV1
 21748     MOVE 72
 21749       TO DFHEIV11
 21750*    MOVE '."C                   (   #00020182' TO DFHEIV0
 21751     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21753     MOVE X'2020233030303230313832' TO DFHEIV0(25:11)
 21754     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 403
* EL050.cbl
 21755           DFHEIV1,
 21756           WS-ERROR-LINE,
 21757           DFHEIV11,
 21758           DFHEIV99,
 21759           DFHEIV99,
 21760           DFHEIV99,
 21761           DFHEIV99
 21762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21763
 21764
 21765     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21766
 21767
 21768* EXEC CICS ABEND
 21769*        ABCODE ('EL50')
 21770*    END-EXEC.
 21771     MOVE 'EL50' TO DFHEIV5
 21772*    MOVE '.,A                   "   #00020190' TO DFHEIV0
 21773     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21774     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21775     MOVE X'2020233030303230313930' TO DFHEIV0(25:11)
 21776     CALL 'kxdfhei1' USING DFHEIV0,
 21777           DFHEIV5
 21778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21779
 21780
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 404
* EL050.cbl
 21782
 21783******************************************************************
 21784*                                                                *
 21785*            E R R O R   F O R M A T   R O U T I N E             *
 21786*                                                                *
 21787******************************************************************
 21788
 21789 9900-ERROR-FORMAT.
 21790
 21791     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21792                    PB-COMMON-ERROR (2) OR
 21793                    PB-COMMON-ERROR (3) OR
 21794                    PB-COMMON-ERROR (4) OR
 21795                    PB-COMMON-ERROR (5) OR
 21796                    PB-COMMON-ERROR (6) OR
 21797                    PB-COMMON-ERROR (7) OR
 21798                    PB-COMMON-ERROR (8) OR
 21799                    PB-COMMON-ERROR (9) OR
 21800                    PB-COMMON-ERROR (10)
 21801        GO TO 9900-EXIT.
 21802
 21803     IF PB-NO-OF-ERRORS = +10
 21804        GO TO 9900-EXIT.
 21805
 21806     ADD +1  TO PB-NO-OF-ERRORS.
 21807     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21808                                       (PB-NO-OF-ERRORS).
 21809 9900-EXIT.
 21810     EXIT.
 21811
 21812 9990-RETURN.
 21813     IF BROWSE-STARTED
 21814
 21815* EXEC CICS ENDBR
 21816*            DATASET  (ACCT-ID)
 21817*       END-EXEC.
 21818     MOVE 0
 21819       TO DFHEIV11
 21820*    MOVE '&2                    $   #00020227' TO DFHEIV0
 21821     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21822     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21823     MOVE X'2020233030303230323237' TO DFHEIV0(25:11)
 21824     CALL 'kxdfhei1' USING DFHEIV0,
 21825           ACCT-ID,
 21826           DFHEIV11,
 21827           DFHEIV99
 21828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21829
 21830
 21831 9990-EXIT.
 21832     EXIT.
 21833
 21834
 21835****Check for CRTO record, add one if not found.
 21836 9991-CHECK-FOR-ELCRTO.
 21837
 21838* EXEC CICS HANDLE CONDITION
 21839*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 405
* EL050.cbl
 21840*         ENDFILE (9991-CRTO-NOT-FOUND)
 21841*     END-EXEC.
 21842*    MOVE '"$I''                  ! A #00020237' TO DFHEIV0
 21843     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21845     MOVE X'4120233030303230323337' TO DFHEIV0(25:11)
 21846     CALL 'kxdfhei1' USING DFHEIV0
 21847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21848
 21849     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21850     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21851     MOVE +0                     TO ELCRTO-SEQ-NO
 21852
 21853
 21854* EXEC CICS READ
 21855*       DATASET   ('ELCRTO')
 21856*       INTO      (ORIGINAL-CERTIFICATE)
 21857*       RIDFLD    (ELCRTO-KEY)
 21858*       GTEQ
 21859*       RESP      (WS-RESPONSE)
 21860*    END-EXEC
 21861     MOVE LENGTH OF
 21862      ORIGINAL-CERTIFICATE
 21863       TO DFHEIV11
 21864     MOVE 'ELCRTO' TO DFHEIV1
 21865*    MOVE '&"IL       G          (  N#00020245' TO DFHEIV0
 21866     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21868     MOVE X'204E233030303230323435' TO DFHEIV0(25:11)
 21869     CALL 'kxdfhei1' USING DFHEIV0,
 21870           DFHEIV1,
 21871           ORIGINAL-CERTIFICATE,
 21872           DFHEIV11,
 21873           ELCRTO-KEY,
 21874           DFHEIV99,
 21875           DFHEIV99,
 21876           DFHEIV99
 21877     MOVE EIBRESP  TO WS-RESPONSE
 21878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21879
 21880     IF WS-RESP-NORMAL
 21881        AND (OC-CONTROL-PRIMARY (1:33) =
 21882                 PB-CONTROL-BY-ACCOUNT (1:33))
 21883        AND (OC-RECORD-TYPE =  'I')
 21884           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21885               GO TO 9991-CHECK-INDICATORS
 21886           ELSE
 21887               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21888               GO TO 9991-CRTO-ADD-REC
 21889           END-IF
 21890     END-IF.
 21891
 21892 9991-CRTO-NOT-FOUND.
 21893
 21894     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21895     MOVE 'OC'                TO OC-RECORD-ID
 21896     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21897                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 406
* EL050.cbl
 21898     MOVE +4096               TO OC-KEY-SEQ-NO.
 21899
 21900 9991-CRTO-ADD-REC.
 21901
 21902     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21903     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21904     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21905     MOVE 'I'                 TO OC-RECORD-TYPE
 21906     IF PB-ISSUE
 21907         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21908         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21909         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21910         MOVE PB-I-AGE               TO OC-INS-AGE
 21911         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21912         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21913         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21914         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21915         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21916         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21917         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21918         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21919         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21920         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21921         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21922         IF PB-I-JOINT-COMMISSION > +0
 21923             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21924         ELSE
 21925             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21926         END-IF
 21927         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21928         MOVE +0                     TO OC-LF-CANCEL-AMT
 21929                                        OC-LF-ITD-CANCEL-AMT
 21930         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21931         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21932         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21933         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21934         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21935         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21936         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21937         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21938         MOVE +0                     TO OC-AH-CANCEL-AMT
 21939                                        OC-AH-ITD-CANCEL-AMT
 21940         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21941         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21942         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21943     ELSE
 21944         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21945         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21946         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21947         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21948         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21949         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21950         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21951         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21952         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21953          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21954             MOVE SPACES             TO OC-LF-BENCD
 21955             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 407
* EL050.cbl
 21956                                        OC-LF-BEN-AMT
 21957                                        OC-LF-PRM-AMT
 21958                                        OC-LF-ALT-BEN-AMT
 21959                                        OC-LF-ALT-PRM-AMT
 21960                                        OC-LF-COMM-PCT
 21961                                        OC-LF-CANCEL-AMT
 21962             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21963             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21964         ELSE
 21965             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21966             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21967             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21968             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21969             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21970             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21971             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21972             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21973             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21974             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21975         END-IF
 21976         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21977         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21978          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21979             MOVE SPACES             TO OC-AH-BENCD
 21980             MOVE ZEROS              TO OC-AH-TERM
 21981                                        OC-AH-BEN-AMT
 21982                                        OC-AH-PRM-AMT
 21983                                        OC-AH-COMM-PCT
 21984                                        OC-AH-CANCEL-AMT
 21985                                        OC-AH-CP
 21986             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21987             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21988         ELSE
 21989             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21990             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21991             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21992             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21993             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21994             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21995             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21996             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21997             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21998         END-IF
 21999         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22000         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22001         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22002         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22003     END-IF
 22004     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22005
 22006     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22007
 22008
 22009* EXEC CICS READ
 22010*         DATASET   (FILE-ERMAIL)
 22011*         RIDFLD    (MA-CONTROL-PRIMARY)
 22012*         INTO      (MAILING-DATA)
 22013*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 408
* EL050.cbl
 22014*    END-EXEC
 22015     MOVE LENGTH OF
 22016      MAILING-DATA
 22017       TO DFHEIV11
 22018*    MOVE '&"IL       E          (  N#00020381' TO DFHEIV0
 22019     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22020     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22021     MOVE X'204E233030303230333831' TO DFHEIV0(25:11)
 22022     CALL 'kxdfhei1' USING DFHEIV0,
 22023           FILE-ERMAIL,
 22024           MAILING-DATA,
 22025           DFHEIV11,
 22026           MA-CONTROL-PRIMARY,
 22027           DFHEIV99,
 22028           DFHEIV99,
 22029           DFHEIV99
 22030     MOVE EIBRESP  TO WS-RESPONSE
 22031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22032
 22033     IF WS-RESP-NORMAL
 22034         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22035     END-IF.
 22036
 22037     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22038     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22039
 22040
 22041* EXEC CICS READ
 22042*         DATASET  (CRTT-ID)
 22043*         RIDFLD   (WS-ELCRTT-KEY)
 22044*         INTO     (CERTIFICATE-TRAILERS)
 22045*         RESP     (WS-RESPONSE)
 22046*    END-EXEC
 22047     MOVE LENGTH OF
 22048      CERTIFICATE-TRAILERS
 22049       TO DFHEIV11
 22050*    MOVE '&"IL       E          (  N#00020395' TO DFHEIV0
 22051     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22053     MOVE X'204E233030303230333935' TO DFHEIV0(25:11)
 22054     CALL 'kxdfhei1' USING DFHEIV0,
 22055           CRTT-ID,
 22056           CERTIFICATE-TRAILERS,
 22057           DFHEIV11,
 22058           WS-ELCRTT-KEY,
 22059           DFHEIV99,
 22060           DFHEIV99,
 22061           DFHEIV99
 22062     MOVE EIBRESP  TO WS-RESPONSE
 22063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22064
 22065     IF WS-RESP-NORMAL
 22066         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22067         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22068     END-IF.
 22069
 22070
 22071* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 409
* EL050.cbl
 22072*       DATASET   ('ELCRTO')
 22073*       FROM      (ORIGINAL-CERTIFICATE)
 22074*       RIDFLD    (OC-CONTROL-PRIMARY)
 22075*       RESP      (WS-RESPONSE)
 22076*    END-EXEC.
 22077     MOVE LENGTH OF
 22078      ORIGINAL-CERTIFICATE
 22079       TO DFHEIV11
 22080     MOVE 'ELCRTO' TO DFHEIV1
 22081*    MOVE '&$ L                  ''  N#00020407' TO DFHEIV0
 22082     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22083     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22084     MOVE X'204E233030303230343037' TO DFHEIV0(25:11)
 22085     CALL 'kxdfhei1' USING DFHEIV0,
 22086           DFHEIV1,
 22087           ORIGINAL-CERTIFICATE,
 22088           DFHEIV11,
 22089           OC-CONTROL-PRIMARY,
 22090           DFHEIV99,
 22091           DFHEIV99
 22092     MOVE EIBRESP  TO WS-RESPONSE
 22093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22094
 22095
 22096     GO TO 9991-EXIT.
 22097
 22098 9991-CHECK-INDICATORS.
 22099
 22100     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22101         GO TO 9991-EXIT
 22102     END-IF.
 22103
 22104     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22105         GO TO 9991-EXIT
 22106     END-IF.
 22107
 22108
 22109* EXEC CICS READ
 22110*       DATASET   ('ELCRTO')
 22111*       INTO      (ORIGINAL-CERTIFICATE)
 22112*       RIDFLD    (OC-CONTROL-PRIMARY)
 22113*       UPDATE
 22114*       RESP      (WS-RESPONSE)
 22115*    END-EXEC
 22116     MOVE LENGTH OF
 22117      ORIGINAL-CERTIFICATE
 22118       TO DFHEIV11
 22119     MOVE 'ELCRTO' TO DFHEIV1
 22120*    MOVE '&"IL       EU         (  N#00020426' TO DFHEIV0
 22121     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22123     MOVE X'204E233030303230343236' TO DFHEIV0(25:11)
 22124     CALL 'kxdfhei1' USING DFHEIV0,
 22125           DFHEIV1,
 22126           ORIGINAL-CERTIFICATE,
 22127           DFHEIV11,
 22128           OC-CONTROL-PRIMARY,
 22129           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 410
* EL050.cbl
 22130           DFHEIV99,
 22131           DFHEIV99
 22132     MOVE EIBRESP  TO WS-RESPONSE
 22133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22134     IF WS-RESP-NORMAL
 22135        IF PB-ISSUE
 22136          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22137          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22138          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22139          MOVE PB-I-AGE               TO OC-INS-AGE
 22140          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22141          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22142          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22143          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22144          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22145          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22146          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22147          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22148          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22149          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22150          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22151          IF PB-I-JOINT-COMMISSION > +0
 22152              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22153          ELSE
 22154              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22155          END-IF
 22156          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22157          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22158          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22159          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22160          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22161          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22162          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22163          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22164          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22165
 22166          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22167
 22168* EXEC CICS READ
 22169*             DATASET   (FILE-ERMAIL)
 22170*             RIDFLD    (MA-CONTROL-PRIMARY)
 22171*             INTO      (MAILING-DATA)
 22172*             RESP      (WS-RESPONSE)
 22173*         END-EXEC
 22174     MOVE LENGTH OF
 22175      MAILING-DATA
 22176       TO DFHEIV11
 22177*    MOVE '&"IL       E          (  N#00020466' TO DFHEIV0
 22178     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'204E233030303230343636' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           FILE-ERMAIL,
 22183           MAILING-DATA,
 22184           DFHEIV11,
 22185           MA-CONTROL-PRIMARY,
 22186           DFHEIV99,
 22187           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 411
* EL050.cbl
 22188           DFHEIV99
 22189     MOVE EIBRESP  TO WS-RESPONSE
 22190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22191          IF WS-RESP-NORMAL
 22192             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22193          END-IF
 22194
 22195          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22196          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22197
 22198* EXEC CICS READ
 22199*             DATASET  (CRTT-ID)
 22200*             RIDFLD   (WS-ELCRTT-KEY)
 22201*             INTO     (CERTIFICATE-TRAILERS)
 22202*             RESP     (WS-RESPONSE)
 22203*         END-EXEC
 22204     MOVE LENGTH OF
 22205      CERTIFICATE-TRAILERS
 22206       TO DFHEIV11
 22207*    MOVE '&"IL       E          (  N#00020478' TO DFHEIV0
 22208     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22210     MOVE X'204E233030303230343738' TO DFHEIV0(25:11)
 22211     CALL 'kxdfhei1' USING DFHEIV0,
 22212           CRTT-ID,
 22213           CERTIFICATE-TRAILERS,
 22214           DFHEIV11,
 22215           WS-ELCRTT-KEY,
 22216           DFHEIV99,
 22217           DFHEIV99,
 22218           DFHEIV99
 22219     MOVE EIBRESP  TO WS-RESPONSE
 22220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22221          IF WS-RESP-NORMAL
 22222             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22223                               OC-INS-AGE-DEFAULT-FLAG
 22224             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22225                               OC-JNT-AGE-DEFAULT-FLAG
 22226          END-IF
 22227
 22228        ELSE
 22229          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22230             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22231             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22232             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22233          END-IF
 22234          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22235             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22236             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22237             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22238          END-IF
 22239          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22240        END-IF
 22241
 22242* EXEC CICS REWRITE
 22243*          DATASET   ('ELCRTO')
 22244*          FROM      (ORIGINAL-CERTIFICATE)
 22245*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 412
* EL050.cbl
 22246*       END-EXEC
 22247     MOVE LENGTH OF
 22248      ORIGINAL-CERTIFICATE
 22249       TO DFHEIV11
 22250     MOVE 'ELCRTO' TO DFHEIV1
 22251*    MOVE '&& L                  %  N#00020504' TO DFHEIV0
 22252     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22253     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22254     MOVE X'204E233030303230353034' TO DFHEIV0(25:11)
 22255     CALL 'kxdfhei1' USING DFHEIV0,
 22256           DFHEIV1,
 22257           ORIGINAL-CERTIFICATE,
 22258           DFHEIV11,
 22259           DFHEIV99
 22260     MOVE EIBRESP  TO WS-RESPONSE
 22261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22262     END-IF.
 22263
 22264 9991-EXIT.
 22265     EXIT.
 22266
 22267
 22268 9999-RETURN.
 22269     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22270
 22271
 22272* EXEC CICS RETURN
 22273*    END-EXEC.
 22274*    MOVE '.(                    ''   #00020518' TO DFHEIV0
 22275     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22277     MOVE X'2020233030303230353138' TO DFHEIV0(25:11)
 22278     CALL 'kxdfhei1' USING DFHEIV0,
 22279           DFHEIV99,
 22280           DFHEIV99,
 22281           DFHEIV99,
 22282           DFHEIV99,
 22283           DFHEIV99,
 22284           DFHEIV99
 22285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22286
 22287
 22288
 22289* GOBACK.
 22290     MOVE '9%                    "   ' TO DFHEIV0
 22291     MOVE 'EL050' TO DFHEIV1
 22292     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22293     GOBACK.
 22294
 22295 9999-DFHBACK SECTION.
 22296     MOVE '9%                    "   ' TO DFHEIV0
 22297     MOVE 'EL050' TO DFHEIV1
 22298     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22299     GOBACK.
 22300 9999-DFHEXIT.
 22301     IF DFHEIGDJ EQUAL 0001
 22302         NEXT SENTENCE
 22303     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 413
* EL050.cbl
 22304         GO TO 9300-ABEND,
 22305               3990-FILES-NOT-OPEN
 22306         DEPENDING ON DFHEIGDI
 22307     ELSE IF DFHEIGDJ EQUAL 3
 22308         GO TO 6610-START-BROWSE,
 22309               6630-ERRESS-PROBLEM,
 22310               6630-END-OF-FILE
 22311         DEPENDING ON DFHEIGDI
 22312     ELSE IF DFHEIGDJ EQUAL 4
 22313         GO TO 6630-END-OF-FILE,
 22314               6630-ERRESS-PROBLEM,
 22315               6630-ERRESS-PROBLEM,
 22316               6630-END-OF-FILE
 22317         DEPENDING ON DFHEIGDI
 22318     ELSE IF DFHEIGDJ EQUAL 5
 22319         GO TO 6630-END-OF-FILE,
 22320               6630-END-OF-FILE,
 22321               6630-ERRESS-PROBLEM,
 22322               6630-ERRESS-PROBLEM
 22323         DEPENDING ON DFHEIGDI
 22324     ELSE IF DFHEIGDJ EQUAL 6
 22325         GO TO 6660-START-BROWSE,
 22326               6690-ERRESC-PROBLEM,
 22327               6690-ERRESC-PROBLEM,
 22328               6690-END-OF-FILE
 22329         DEPENDING ON DFHEIGDI
 22330     ELSE IF DFHEIGDJ EQUAL 7
 22331         GO TO 6690-END-OF-FILE,
 22332               6690-ERRESC-PROBLEM,
 22333               6690-ERRESC-PROBLEM,
 22334               6690-END-OF-FILE
 22335         DEPENDING ON DFHEIGDI
 22336     ELSE IF DFHEIGDJ EQUAL 8
 22337         GO TO 6690-END-OF-FILE,
 22338               6690-ERRESC-PROBLEM,
 22339               6690-ERRESC-PROBLEM,
 22340               6690-END-OF-FILE
 22341         DEPENDING ON DFHEIGDI
 22342     ELSE IF DFHEIGDJ EQUAL 9
 22343         GO TO 7250-CONTINUE,
 22344               7250-CONTINUE
 22345         DEPENDING ON DFHEIGDI
 22346     ELSE IF DFHEIGDJ EQUAL 10
 22347         GO TO 7300-CONTINUE,
 22348               7300-CONTINUE
 22349         DEPENDING ON DFHEIGDI
 22350     ELSE IF DFHEIGDJ EQUAL 11
 22351         GO TO 8000-FREE-MAIN
 22352         DEPENDING ON DFHEIGDI
 22353     ELSE IF DFHEIGDJ EQUAL 12
 22354         GO TO 8100-NOTFND,
 22355               8100-NOTFND
 22356         DEPENDING ON DFHEIGDI
 22357     ELSE IF DFHEIGDJ EQUAL 13
 22358         GO TO 8110-NOTFND,
 22359               8110-NOTFND
 22360         DEPENDING ON DFHEIGDI
 22361     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 414
* EL050.cbl
 22362         GO TO 8130-EXIT
 22363         DEPENDING ON DFHEIGDI
 22364     ELSE IF DFHEIGDJ EQUAL 15
 22365         GO TO 8150-exit
 22366         DEPENDING ON DFHEIGDI
 22367     ELSE IF DFHEIGDJ EQUAL 16
 22368         GO TO 8180-NOTFND
 22369         DEPENDING ON DFHEIGDI
 22370     ELSE IF DFHEIGDJ EQUAL 17
 22371         GO TO 8190-NOTFND
 22372         DEPENDING ON DFHEIGDI
 22373     ELSE IF DFHEIGDJ EQUAL 18
 22374         GO TO 8195-NOTFND
 22375         DEPENDING ON DFHEIGDI
 22376     ELSE IF DFHEIGDJ EQUAL 19
 22377         GO TO 8200-NOTFND
 22378         DEPENDING ON DFHEIGDI
 22379     ELSE IF DFHEIGDJ EQUAL 20
 22380         GO TO 8300-NOTFND,
 22381               8300-ERRESS-PROBLEM,
 22382               8300-ERRESS-PROBLEM,
 22383               8300-NOTFND
 22384         DEPENDING ON DFHEIGDI
 22385     ELSE IF DFHEIGDJ EQUAL 21
 22386         GO TO 8450-FORM-NOT-FOUND,
 22387               8450-FORM-NOT-FOUND
 22388         DEPENDING ON DFHEIGDI
 22389     ELSE IF DFHEIGDJ EQUAL 22
 22390         GO TO 0199-ACCT-NOT-FOUND,
 22391               0199-ACCT-NOT-FOUND
 22392         DEPENDING ON DFHEIGDI
 22393     ELSE IF DFHEIGDJ EQUAL 23
 22394         GO TO 0199-ACCT-NOT-FOUND,
 22395               0199-ACCT-NOT-FOUND
 22396         DEPENDING ON DFHEIGDI
 22397     ELSE IF DFHEIGDJ EQUAL 24
 22398         GO TO 8582-COMP-NOT-FOUND,
 22399               8582-COMP-NOT-FOUND
 22400         DEPENDING ON DFHEIGDI
 22401     ELSE IF DFHEIGDJ EQUAL 25
 22402         GO TO 8583-AGTC-NOT-FOUND,
 22403               8583-AGTC-NOT-FOUND
 22404         DEPENDING ON DFHEIGDI
 22405     ELSE IF DFHEIGDJ EQUAL 26
 22406         GO TO 8584-BXRF-NOT-FOUND,
 22407               8584-BXRF-NOT-FOUND
 22408         DEPENDING ON DFHEIGDI
 22409     ELSE IF DFHEIGDJ EQUAL 27
 22410         GO TO 8585-PLAN-NOT-FOUND,
 22411               8585-PLAN-NOT-FOUND
 22412         DEPENDING ON DFHEIGDI
 22413     ELSE IF DFHEIGDJ EQUAL 28
 22414         GO TO 0299-CERT-NOT-FOUND
 22415         DEPENDING ON DFHEIGDI
 22416     ELSE IF DFHEIGDJ EQUAL 29
 22417         GO TO 8700-READ-CERT-MASTER
 22418         DEPENDING ON DFHEIGDI
 22419     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:50 Page 415
* EL050.cbl
 22420         GO TO 8720-COMP-ACCOUNTS,
 22421               8730-END-BROWSE,
 22422               8740-NOT-FOUND
 22423         DEPENDING ON DFHEIGDI
 22424     ELSE IF DFHEIGDJ EQUAL 31
 22425         GO TO 9000-NOTFND
 22426         DEPENDING ON DFHEIGDI
 22427     ELSE IF DFHEIGDJ EQUAL 32
 22428         GO TO 9100-NOTFND,
 22429               9100-NOTFND
 22430         DEPENDING ON DFHEIGDI
 22431     ELSE IF DFHEIGDJ EQUAL 33
 22432         GO TO 9991-CRTO-NOT-FOUND,
 22433               9991-CRTO-NOT-FOUND
 22434         DEPENDING ON DFHEIGDI.
 22435     MOVE '9%                    "   ' TO DFHEIV0
 22436     MOVE 'EL050' TO DFHEIV1
 22437     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22438     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40704     Code:       91573
