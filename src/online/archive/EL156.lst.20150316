* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57******************************************************************
    58
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   3
* EL156.cbl
    60 ENVIRONMENT DIVISION.
    61
    62 DATA DIVISION.
    63
    64 WORKING-STORAGE SECTION.
    65 01  DFH-START PIC X(04).
    66
    67 77  FILLER  PIC X(32)  VALUE '********************************'.
    68 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    69 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    70 77  WS-SSN  PIC X(9) VALUE ZEROS.
    71 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    72 77  C0                          PIC S999 COMP-3 VALUE +0.
    73 77  C1                          PIC S999 COMP-3 VALUE +0.
    74 77  C2                          PIC S999 COMP-3 VALUE +0.
    75 77  C3                          PIC S999 COMP-3 VALUE +0.
    76 77  s1                          PIC S999 COMP-3 VALUE +0.
    77 77  s2                          pic s999 comp-3 value +0.
    78 77  P1                          PIC S999 COMP-3 VALUE +0.
    79 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    81 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    82 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    83 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    84 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    85 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    86 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    87 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    88 77  ws-max-bens                 pic s999 comp-3 value +0.
    89 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    90 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    91 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    92 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    93 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    94 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    95
    96*    COPY ELCSCTM.
    97******************************************************************
    98*                                                                *
    99*                                                                *
   100*                            ELCSCTM                             *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   104*                                                                *
   105******************************************************************
   106 01  SECURITY-MESSAGE.
   107     12  FILLER                          PIC X(30)
   108            VALUE '** LOGIC SECURITY VIOLATION -'.
   109     12  SM-READ                         PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' PGM='.
   112     12  SM-PGM                          PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' OPR='.
   115     12  SM-PROCESSOR-ID                 PIC X(4).
   116     12  FILLER                          PIC X(6)
   117            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   4
* EL156.cbl
   118     12  SM-TERMID                       PIC X(4).
   119     12  FILLER                          PIC XX   VALUE SPACE.
   120     12  SM-JUL-DATE                     PIC 9(5).
   121     12  FILLER                          PIC X    VALUE SPACE.
   122     12  SM-TIME                         PIC 99.99.
   123
   124
   125*    COPY ELCSCRTY.
   126******************************************************************
   127*                                                                *
   128*                                                                *
   129*                            ELCSCRTY                            *
   130*                            VMOD=2.001                          *
   131*                                                                *
   132*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   133*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   134*        SAVED IN PI-SECURITY-ADDRESS.                           *
   135*                                                                *
   136******************************************************************
   137 01  SECURITY-CONTROL.
   138     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   139     12  FILLER                       PIC XX    VALUE 'SC'.
   140     12  SC-CREDIT-CODES.
   141         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   142             20  SC-CREDIT-DISPLAY    PIC X.
   143             20  SC-CREDIT-UPDATE     PIC X.
   144     12  SC-CLAIMS-CODES.
   145         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   146             20  SC-CLAIMS-DISPLAY    PIC X.
   147             20  SC-CLAIMS-UPDATE     PIC X.
   148
   149 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   150 01  WS-DATE-AREA.
   151     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   152     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   153     12  SAVE-DATE-CCYYMMDD.
   154         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   155         16  SAVE-DATE-YMD.
   156             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   157             20  FILLER              PIC X(04)   VALUE SPACES.
   158
   159 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   160 01  STANDARD-AREAS.
   161     12  WS-RESPONSE         PIC S9(8)   COMP.
   162         88  WS-RESP-NORMAL              VALUE +00.
   163         88  WS-RESP-ERROR               VALUE +01.
   164         88  WS-RESP-NOTFND              VALUE +13.
   165         88  WS-RESP-DUPREC              VALUE +14.
   166         88  WS-RESP-ENDFILE             VALUE +20.
   167     12  PMT-HEAD-A.
   168         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   169         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   170         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   171-        '     RESERVES  TYPE    AMOUNT'.
   172     12  PMT-HEAD-B.
   173         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   174         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   175         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   5
* EL156.cbl
   176     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   177     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   178     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   179     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   180     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   181     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   182     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   183     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   184     12  PGM-NAME            PIC X(8).
   185     12  TIME-IN             PIC S9(7).
   186     12  TIME-OUT-R  REDEFINES TIME-IN.
   187         16  FILLER          PIC X.
   188         16  TIME-OUT        PIC 99V99.
   189         16  FILLER          PIC XX.
   190     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   191     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   192     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   193     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   194     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   195     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   196     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   197     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   198     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   199     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   200     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   201     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   202     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   203     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   204     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   205     12  WS-BLANK            PIC X       VALUE ' '.
   206
   207 01  MISC-WORK-AREAS.
   208     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   209     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   210     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   211     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   212     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   213     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   214     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   215     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   216     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   217     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   218     12  W-CALLED-NAME           PIC X(08).
   219     12  W-EOB-CODES.
   220         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   221             20  W-EOB-CODE      PIC XXX.
   222             20  W-EOB-FILLER    PIC X.
   223     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   224     12  W-NAME-LAST             PIC X(15).
   225     12  W-NAME-FIRST            PIC X(15).
   226     12  W-NAME-MIDDLE.
   227         16  FILLER              PIC X.
   228         16  W-NAME-MIDDLE-2     PIC X.
   229         16  FILLER              PIC X(13).
   230     12  W-DMD-CHECK-NO.
   231         16  W-DMD-CHECK-NO-1    PIC X(4).
   232         16  W-DMD-CHECK-NO-2    PIC X.
   233         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   6
* EL156.cbl
   234
   235     12  WS-COMPUTE-FROM-DT  PIC XX.
   236     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   237     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   238     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   239     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   240     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   241     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   242         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   243         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   244     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   245         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   246     12  WS-UPDATE-SW        PIC X VALUE ' '.
   247     12  WS-GROUPING.
   248         16  WS-GROUP-1      PIC X VALUE SPACES.
   249         16  FILLER          PIC X(05) VALUE SPACES.
   250     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   251     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   252     12  WS-WORK-STATE-ACCT.
   253         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   254         16  FILLER          PIC X       VALUE '/'.
   255         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   256     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   257     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   258     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   259     12  QID.
   260         16  QID-TERM        PIC X(4)    VALUE SPACES.
   261         16  FILLER          PIC X(4)    VALUE '156A'.
   262     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   263     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   264     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   265     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   266     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   267     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   268     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   269     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   270     12  WS-STATUS           PIC X       VALUE SPACES.
   271     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   272     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   273     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   274     12  ws-extended-exp-dt  pic xx      value low-values.
   275     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   276     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   277     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   278     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   279     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   280     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   281     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   282     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   283     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   284     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   285     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   286     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   287     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   288     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   289     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   290     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   291     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   7
* EL156.cbl
   292     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   293     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   294     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   295     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   296     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   297     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   298     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   299     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   300     12  WORK-DATE-FROM.
   301         16  WDF-MONTH       PIC 99        VALUE ZERO.
   302         16  WDF-DAY         PIC 99        VALUE ZERO.
   303         16  WDF-YEAR        PIC 99        VALUE ZERO.
   304     12  WORK-DATE-THRU.
   305         16  WDT-MONTH       PIC 99        VALUE ZERO.
   306         16  WDT-DAY         PIC 99        VALUE ZERO.
   307         16  WDT-YEAR        PIC 99        VALUE ZERO.
   308     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   309     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   310     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   311     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   312     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   313     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   314     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   315     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   316     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   317     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   318     12  WS-PY-WK REDEFINES WS-PY-WORK.
   319         16  WS-PY-NUM       PIC S9(7)V99.
   320         16  WS-PY-SIGN      PIC X.
   321     12  WS-DY-WORK          PIC S9(5).
   322     12  WS-DY-WK REDEFINES WS-DY-WORK.
   323         16  WS-DY-NUM       PIC S9(4).
   324         16  WS-DY-SIGN      PIC X.
   325     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   326         88  COMP-REC-FOUND              VALUE 'Y'.
   327     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   328         88  BENEFIT-FOUND       VALUE 'Y'.
   329         88  NO-BENEFIT-FOUND    VALUE 'N'.
   330     12  WS-TERMS.
   331         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   332         16  FILLER          PIC X       VALUE '/'.
   333         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   334         16  WST-REM-DAYS-GRP.
   335             20  WST-SLASH   PIC X       VALUE '/'.
   336             20  WST-REM-DAYS
   337                             PIC --9.
   338     12  WS-ACCESS.
   339         16  FILLER          PIC XX      VALUE SPACES.
   340         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   341     12  WS-STATE-ACCESS.
   342         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   343         16  FILLER          PIC XX      VALUE SPACES.
   344     12  WS-CARR-ACCESS.
   345         16  FILLER          PIC X(3)    VALUE SPACES.
   346         16  WS-CARR         PIC X       VALUE SPACES.
   347     12  DATE-WORK.
   348         16  FILLER          PIC XX      VALUE SPACES.
   349         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   8
* EL156.cbl
   350     12  WS-SAVE-INPUT.
   351         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   352         16  WS-PAYEE        PIC XX      VALUE SPACE.
   353         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   354         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   355         16  WS-OFFLINE      PIC X       VALUE SPACE.
   356         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   357         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   358         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   359         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   360         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   361         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   362         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   363         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   364         16  WS-ETYPE        PIC X       VALUE SPACE.
   365         16  WS-CASH         PIC X       VALUE SPACE.
   366         16  WS-GROUPED      PIC X       VALUE SPACE.
   367         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   368         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   369         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   370         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   371         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   372         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   373         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   374         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   375     12  LAST-ERROR-LINE.
   376         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   377         16  FILLER              PIC X(30)
   378             VALUE ' FATAL ERRORS ENCOUNTERED'.
   379         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   380         16  FILLER              PIC X(28)
   381             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   382     12  WS-CHECK-AREA.
   383         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   384         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   385     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   386     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   387         16  FILLER              PIC XX.
   388         16  WS-A-CHECK-NUM-5    PIC 9(5).
   389     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   390         16  FILLER              PIC X.
   391         16  WS-A-CHECK-NUM-6    PIC 9(6).
   392     12  OPTION-1-SAVE-AREA.
   393         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   394         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   395     12  WS-WORK-ZIP.
   396         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   397         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   398     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   399                                 PIC 9(9).
   400     12  WS-FLI-PMTNOTE.
   401         16  WS-PMTOPTION        PIC XX.
   402         16  WS-DOCNAME          PIC X(28).
   403         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   404             20  WS-AMOUNT       PIC X(8).
   405             20  FILLER          PIC X(20).
   406         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   407             20  WS-NUM-AMT      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page   9
* EL156.cbl
   408             20  FILLER          PIC X(20).
   409
   410     12  WS-HAN-PMTNOTE.
   411         16  WS-HAN-PMT-CODE     PIC X.
   412         16  WS-HAN-PMT-NOTE     PIC X(39).
   413
   414     12  WS-NCL-PMT-OPTION       PIC XX.
   415         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   416
   417     12  WS-CLAIM-SEQUENCE.
   418         16  FILLER              PIC X VALUE '('.
   419         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   420         16  FILLER              PIC X(04) VALUE ' OF '.
   421         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   422         16  FILLER              PIC X VALUE ')'.
   423
   424     12  WS-REFUND-AMT           PIC Z(7).99.
   425     12  WS-CALC-INT             PIC S9(7)V99.
   426     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   427
   428     12  SUB                     PIC 99 VALUE ZEROS.
   429
   430     12  WS-BOANOTE1.
   431         16  WS-BOANOTE1-DESC    PIC X(11).
   432         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   433         16  FILLER              PIC X(17).
   434     12  WS-BOANOTE2.
   435         16  WS-BOANOTE2-DESC    PIC X(11).
   436         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   437         16  FILLER              PIC X(17).
   438
   439     12  WS-NCLNOTE1.
   440         16  WS-NCLNOTE1-DESC    PIC X(11).
   441         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   442         16  FILLER              PIC X(17).
   443     12  WS-NCLNOTE2.
   444         16  WS-NCLNOTE2-DESC    PIC X(11).
   445         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   446         16  FILLER              PIC X(17).
   447
   448     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   449     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   450     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   451     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   452     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   453     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   454     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   455     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   456     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   457     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   458
   459     12  WS-AIG-WORK-AREAS.
   460         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   461             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   462         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   463             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   464         16  WS-FROM-DATE-MDY.
   465             20  WS-FROM-MO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  10
* EL156.cbl
   466             20  WS-FROM-DA      PIC 99.
   467             20  WS-FROM-YR      PIC 99.
   468         16  WS-TEMP-DATE-MDY.
   469             20  WS-TEMP-MO      PIC 99.
   470             20  WS-TEMP-DA      PIC 99.
   471             20  WS-TEMP-YR      PIC 99.
   472         16  WS-BIN-FROM-DT      PIC XX.
   473         16  WS-TEMP-INC-MDY.
   474             20  WS-TEMP-INC-MO  PIC 99.
   475             20  WS-TEMP-INC-DA  PIC 99.
   476             20  WS-TEMP-INC-YR  PIC 99.
   477         16  WS-PMT-DUE-MDY.
   478             20  WS-PMT-DUE-MO   PIC 99.
   479             20  WS-PMT-DUE-DA   PIC 99.
   480             20  WS-PMT-DUE-YR   PIC 99.
   481         16  WS-PMT-DUE-DT       PIC XX.
   482         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   483         16  WS-RETRO-ELIM-DT    PIC XX.
   484         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   485             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   486         16  WS-SAVE-DUE-DA      PIC 99.
   487         16  WS-CDAYS            PIC S9(05).
   488         16  WS-DAYS-OFF         PIC S9(05).
   489         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   490             88  ELIM-SATISFIED            VALUE 'Y'.
   491         16  WS-AIG-CHECKNO.
   492             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   493             20  WS-A-CHECKNO-3-7.
   494                 24  FILLER              PIC X(3)    VALUE SPACES.
   495                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   496                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   497         16  WS-AIG-GROUPING.
   498             20  WS-A-BENE               PIC XXX.
   499             20  FILLER                  PIC XXX.
   500         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   501             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   502             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   503         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   504                 VALUE 'UNEMPLOYMENT PAYMENT'.
   505         16  WS-CHK-THRU-DT              PIC XX.
   506         16  WS-HOLD-BIN-DATE-1          PIC XX.
   507
   508 01  MISC-CSO-AREA.
   509     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   510     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   511     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   512         88  APPROVAL-NEEDED                        VALUE 'Y'.
   513     12  WS-APPROV-NOTE                  PIC X(43)
   514         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   515     12  WS-3550-APPROV-NOTE             PIC X(43)
   516         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   517     12  WS-REAUDIT-NOTE                 PIC X(43)
   518         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   519     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   520     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   521     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   522     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   523     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  11
* EL156.cbl
   524     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   525     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   526         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   527     12  WS-PAYEE-CITY-STATE     PIC X(30).
   528     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   529         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   530     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   531     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   532     12  WS-WORK-NAME            PIC X(30).
   533     12  FILLER  REDEFINES WS-WORK-NAME.
   534         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   535     12  WS-INSURED-NAME         PIC X(30).
   536     12  FILLER  REDEFINES WS-INSURED-NAME.
   537         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   538     12  WS-PAYEE-NAME           PIC X(30).
   539     12  FILLER  REDEFINES WS-PAYEE-NAME.
   540         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   541
   542 01  ERROR-MESSAGES.
   543     12  ER-0000                 PIC X(4)  VALUE '0000'.
   544     12  ER-0004                 PIC X(4)  VALUE '0004'.
   545     12  ER-0008                 PIC X(4)  VALUE '0008'.
   546     12  ER-0019                 PIC X(4)  VALUE '0019'.
   547     12  ER-0029                 PIC X(4)  VALUE '0029'.
   548     12  ER-0042                 PIC X(4)  VALUE '0042'.
   549     12  ER-0070                 PIC X(4)  VALUE '0070'.
   550     12  ER-0130                 PIC X(4)  VALUE '0130'.
   551     12  ER-0149                 PIC X(4)  VALUE '0149'.
   552     12  ER-0154                 PIC X(4)  VALUE '0154'.
   553     12  ER-0168                 PIC X(4)  VALUE '0168'.
   554     12  ER-0169                 PIC X(4)  VALUE '0169'.
   555     12  ER-0172                 PIC X(4)  VALUE '0174'.
   556     12  ER-0198                 PIC X(4)  VALUE '0198'.
   557     12  ER-0204                 PIC X(4)  VALUE '0204'.
   558     12  ER-0206                 PIC X(4)  VALUE '0206'.
   559     12  ER-0252                 PIC X(4)  VALUE '0252'.
   560     12  ER-0254                 PIC X(4)  VALUE '0254'.
   561     12  ER-0282                 PIC X(4)  VALUE '0282'.
   562     12  ER-0283                 PIC X(4)  VALUE '0283'.
   563     12  ER-0294                 PIC X(4)  VALUE '0294'.
   564     12  ER-0338                 PIC X(4)  VALUE '0338'.
   565     12  ER-0419                 PIC X(4)  VALUE '0419'.
   566     12  ER-0420                 PIC X(4)  VALUE '0420'.
   567     12  ER-0421                 PIC X(4)  VALUE '0421'.
   568     12  ER-0422                 PIC X(4)  VALUE '0422'.
   569     12  ER-0433                 PIC X(4)  VALUE '0433'.
   570     12  ER-0436                 PIC X(4)  VALUE '0436'.
   571     12  ER-0437                 PIC X(4)  VALUE '0437'.
   572     12  ER-0438                 PIC X(4)  VALUE '0438'.
   573     12  ER-0439                 PIC X(4)  VALUE '0439'.
   574     12  ER-0440                 PIC X(4)  VALUE '0440'.
   575     12  ER-0441                 PIC X(4)  VALUE '0441'.
   576     12  ER-0442                 PIC X(4)  VALUE '0442'.
   577     12  ER-0443                 PIC X(4)  VALUE '0443'.
   578     12  ER-0444                 PIC X(4)  VALUE '0444'.
   579     12  ER-0445                 PIC X(4)  VALUE '0445'.
   580     12  ER-0446                 PIC X(4)  VALUE '0446'.
   581     12  ER-0447                 PIC X(4)  VALUE '0447'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  12
* EL156.cbl
   582     12  ER-0448                 PIC X(4)  VALUE '0448'.
   583     12  ER-0449                 PIC X(4)  VALUE '0449'.
   584     12  ER-0452                 PIC X(4)  VALUE '0452'.
   585     12  ER-0458                 PIC X(4)  VALUE '0458'.
   586     12  ER-0459                 PIC X(4)  VALUE '0459'.
   587     12  ER-0460                 PIC X(4)  VALUE '0460'.
   588     12  ER-0461                 PIC X(4)  VALUE '0461'.
   589     12  ER-0462                 PIC X(4)  VALUE '0462'.
   590     12  ER-0463                 PIC X(4)  VALUE '0463'.
   591     12  ER-0464                 PIC X(4)  VALUE '0464'.
   592     12  ER-0465                 PIC X(4)  VALUE '0465'.
   593     12  ER-0466                 PIC X(4)  VALUE '0466'.
   594     12  ER-0467                 PIC X(4)  VALUE '0467'.
   595     12  ER-0468                 PIC X(4)  VALUE '0468'.
   596     12  ER-0469                 PIC X(4)  VALUE '0469'.
   597     12  ER-0473                 PIC X(4)  VALUE '0473'.
   598     12  ER-0474                 PIC X(4)  VALUE '0474'.
   599     12  ER-0475                 PIC X(4)  VALUE '0475'.
   600     12  ER-0476                 PIC X(4)  VALUE '0476'.
   601     12  ER-0477                 PIC X(4)  VALUE '0477'.
   602     12  ER-0478                 PIC X(4)  VALUE '0478'.
   603     12  ER-0479                 PIC X(4)  VALUE '0479'.
   604     12  ER-0481                 PIC X(4)  VALUE '0481'.
   605     12  ER-0491                 PIC X(4)  VALUE '0491'.
   606     12  ER-0492                 PIC X(4)  VALUE '0492'.
   607     12  ER-0493                 PIC X(4)  VALUE '0493'.
   608     12  ER-0494                 PIC X(4)  VALUE '0494'.
   609     12  ER-0495                 PIC X(4)  VALUE '0495'.
   610     12  ER-0499                 PIC X(4)  VALUE '0499'.
   611     12  ER-0500                 PIC X(4)  VALUE '0500'.
   612     12  ER-0501                 PIC X(4)  VALUE '0501'.
   613     12  ER-0502                 PIC X(4)  VALUE '0502'.
   614     12  ER-0508                 PIC X(4)  VALUE '0508'.
   615     12  ER-0513                 PIC X(4)  VALUE '0513'.
   616     12  ER-0518                 PIC X(4)  VALUE '0518'.
   617     12  ER-0524                 PIC X(4)  VALUE '0524'.
   618     12  ER-0525                 PIC X(4)  VALUE '0525'.
   619     12  ER-0526                 PIC X(4)  VALUE '0526'.
   620     12  ER-0530                 PIC X(4)  VALUE '0530'.
   621     12  ER-0540                 PIC X(4)  VALUE '0540'.
   622     12  ER-0541                 PIC X(4)  VALUE '0541'.
   623     12  ER-0542                 PIC X(4)  VALUE '0542'.
   624     12  ER-0543                 PIC X(4)  VALUE '0543'.
   625     12  ER-0545                 PIC X(4)  VALUE '0545'.
   626     12  ER-0552                 PIC X(4)  VALUE '0552'.
   627     12  ER-0555                 PIC X(4)  VALUE '0555'.
   628     12  ER-0556                 PIC X(4)  VALUE '0556'.
   629     12  ER-0557                 PIC X(4)  VALUE '0557'.
   630     12  ER-0572                 PIC X(4)  VALUE '0572'.
   631     12  ER-0573                 PIC X(4)  VALUE '0573'.
   632     12  ER-0594                 PIC X(4)  VALUE '0594'.
   633     12  ER-0616                 PIC X(4)  VALUE '0616'.
   634     12  ER-0617                 PIC X(4)  VALUE '0617'.
   635     12  ER-0618                 PIC X(4)  VALUE '0618'.
   636     12  ER-0657                 PIC X(4)  VALUE '0657'.
   637     12  ER-0658                 PIC X(4)  VALUE '0658'.
   638     12  ER-0699                 PIC X(4)  VALUE '0699'.
   639     12  ER-0730                 PIC X(4)  VALUE '0730'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  13
* EL156.cbl
   640     12  ER-0737                 PIC X(4)  VALUE '0737'.
   641     12  ER-0760                 PIC X(4)  VALUE '0760'.
   642     12  ER-0768                 PIC X(4)  VALUE '0768'.
   643     12  ER-0769                 PIC X(4)  VALUE '0769'.
   644     12  ER-0770                 PIC X(4)  VALUE '0770'.
   645     12  ER-0802                 PIC X(4)  VALUE '0802'.
   646     12  ER-0803                 PIC X(4)  VALUE '0803'.
   647     12  ER-0819                 PIC X(4)  VALUE '0819'.
   648     12  ER-0834                 PIC X(4)  VALUE '0834'.
   649     12  ER-0836                 PIC X(4)  VALUE '0836'.
   650     12  ER-0844                 PIC X(4)  VALUE '0844'.
   651     12  ER-0845                 PIC X(4)  VALUE '0845'.
   652     12  ER-0846                 PIC X(4)  VALUE '0846'.
   653     12  ER-0849                 PIC X(4)  VALUE '0849'.
   654     12  ER-0851                 PIC X(4)  VALUE '0851'.
   655     12  ER-0872                 PIC X(4)  VALUE '0872'.
   656     12  ER-0873                 PIC X(4)  VALUE '0873'.
   657     12  ER-0874                 PIC X(4)  VALUE '0874'.
   658     12  ER-0879                 PIC X(4)  VALUE '0879'.
   659     12  ER-0919                 PIC X(4)  VALUE '0919'.
   660     12  ER-0921                 PIC X(4)  VALUE '0921'.
   661     12  ER-0923                 PIC X(4)  VALUE '0923'.
   662     12  ER-0925                 PIC X(4)  VALUE '0925'.
   663     12  ER-0944                 PIC X(4)  VALUE '0944'.
   664     12  ER-0945                 PIC X(4)  VALUE '0945'.
   665     12  ER-0946                 PIC X(4)  VALUE '0946'.
   666     12  ER-0947                 PIC X(4)  VALUE '0947'.
   667     12  ER-0948                 PIC X(4)  VALUE '0948'.
   668     12  ER-0949                 PIC X(4)  VALUE '0949'.
   669     12  ER-0950                 PIC X(4)  VALUE '0950'.
   670     12  ER-0951                 PIC X(4)  VALUE '0951'.
   671     12  ER-0954                 PIC X(4)  VALUE '0954'.
   672     12  ER-0956                 PIC X(4)  VALUE '0956'.
   673     12  ER-0967                 PIC X(4)  VALUE '0967'.
   674     12  ER-0968                 PIC X(4)  VALUE '0968'.
   675     12  ER-0974                 PIC X(4)  VALUE '0974'.
   676     12  ER-0975                 PIC X(4)  VALUE '0975'.
   677     12  ER-1561                 PIC X(4)  VALUE '1561'.
   678     12  ER-1566                 PIC X(4)  VALUE '1566'.
   679     12  ER-1567                 PIC X(4)  VALUE '1567'.
   680     12  ER-1569                 PIC X(4)  VALUE '1569'.
   681     12  er-1657                 pic x(4)  value '1657'.
   682     12  er-1658                 pic x(4)  value '1658'.
   683     12  er-1667                 pic x(4)  value '1667'.
   684     12  er-1670                 pic x(4)  value '1670'.
   685     12  er-1671                 pic x(4)  value '1671'.
   686     12  er-1672                 pic x(4)  value '1672'.
   687     12  er-1673                 pic x(4)  value '1673'.
   688     12  er-1674                 pic x(4)  value '1674'.
   689     12  er-1677                 pic x(4)  value '1677'.
   690     12  ER-1775                 PIC X(4)  VALUE '1775'.
   691     12  ER-1880                 PIC X(4)  VALUE '1880'.
   692     12  ER-2044                 PIC X(4)  VALUE '2044'.
   693     12  ER-3140                 PIC X(4)  VALUE '3140'.
   694     12  ER-3141                 PIC X(4)  VALUE '3141'.
   695     12  ER-3255                 PIC X(4)  VALUE '3255'.
   696     12  ER-3516                 PIC X(4)  VALUE '3516'.
   697     12  ER-3527                 PIC X(4)  VALUE '3527'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  14
* EL156.cbl
   698     12  ER-3528                 PIC X(4)  VALUE '3528'.
   699     12  ER-3529                 PIC X(4)  VALUE '3529'.
   700     12  ER-3530                 PIC X(4)  VALUE '3530'.
   701     12  ER-3531                 PIC X(4)  VALUE '3531'.
   702     12  ER-3532                 PIC X(4)  VALUE '3532'.
   703     12  ER-3533                 PIC X(4)  VALUE '3533'.
   704     12  ER-3534                 PIC X(4)  VALUE '3534'.
   705     12  ER-3535                 PIC X(4)  VALUE '3535'.
   706     12  ER-3536                 PIC X(4)  VALUE '3536'.
   707     12  ER-3537                 PIC X(4)  VALUE '3537'.
   708     12  ER-3538                 PIC X(4)  VALUE '3538'.
   709     12  ER-3539                 PIC X(4)  VALUE '3539'.
   710     12  ER-3540                 PIC X(4)  VALUE '3540'.
   711     12  ER-3541                 PIC X(4)  VALUE '3541'.
   712     12  ER-3542                 PIC X(4)  VALUE '3542'.
   713     12  ER-3543                 PIC X(4)  VALUE '3543'.
   714     12  ER-3546                 PIC X(4)  VALUE '3546'.
   715     12  ER-3549                 PIC X(4)  VALUE '3549'.
   716     12  ER-3818                 PIC X(4)  VALUE '3818'.
   717     12  ER-7540                 PIC X(4)  VALUE '7540'.
   718     12  ER-7576                 PIC X(4)  VALUE '7576'.
   719     12  ER-7579                 PIC X(4)  VALUE '7579'.
   720     12  ER-7580                 PIC X(4)  VALUE '7580'.
   721     12  ER-7583                 PIC X(4)  VALUE '7583'.
   722     12  ER-7830                 PIC X(4)  VALUE '7830'.
   723     12  ER-7831                 PIC X(4)  VALUE '7831'.
   724     12  ER-7832                 PIC X(4)  VALUE '7832'.
   725     12  ER-7833                 PIC X(4)  VALUE '7833'.
   726     12  ER-7834                 PIC X(4)  VALUE '7834'.
   727     12  ER-7835                 PIC X(4)  VALUE '7835'.
   728     12  ER-7836                 PIC X(4)  VALUE '7836'.
   729     12  ER-7837                 PIC X(4)  VALUE '7837'.
   730     12  ER-7838                 PIC X(4)  VALUE '7838'.
   731     12  ER-7841                 PIC X(4)  VALUE '7841'.
   732     12  ER-7844                 PIC X(4)  VALUE '7844'.
   733     12  ER-7845                 PIC X(4)  VALUE '7845'.
   734     12  ER-8000                 PIC X(4)  VALUE '8000'.
   735     12  ER-8051                 PIC X(4)  VALUE '8051'.
   736     12  ER-8052                 PIC X(4)  VALUE '8052'.
   737     12  ER-8053                 PIC X(4)  VALUE '8053'.
   738     12  ER-8054                 PIC X(4)  VALUE '8054'.
   739     12  ER-8055                 PIC X(4)  VALUE '8055'.
   740     12  ER-8056                 PIC X(4)  VALUE '8056'.
   741     12  ER-8057                 PIC X(4)  VALUE '8057'.
   742     12  ER-8058                 PIC X(4)  VALUE '8058'.
   743     12  ER-8059                 PIC X(4)  VALUE '8059'.
   744     12  ER-8060                 PIC X(4)  VALUE '8060'.
   745     12  ER-8061                 PIC X(4)  VALUE '8061'.
   746     12  ER-8062                 PIC X(4)  VALUE '8062'.
   747     12  ER-8063                 PIC X(4)  VALUE '8063'.
   748     12  ER-8064                 PIC X(4)  VALUE '8064'.
   749     12  ER-8065                 PIC X(4)  VALUE '8065'.
   750     12  ER-8066                 PIC X(4)  VALUE '8066'.
   751     12  ER-8146                 PIC X(4)  VALUE '8146'.
   752     12  ER-8147                 PIC X(4)  VALUE '8147'.
   753     12  ER-8152                 PIC X(4)  VALUE '8152'.
   754     12  ER-8153                 PIC X(4)  VALUE '8153'.
   755     12  ER-8154                 PIC X(4)  VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  15
* EL156.cbl
   756     12  ER-8155                 PIC X(4)  VALUE '8155'.
   757     12  ER-8310                 PIC X(4)  VALUE '8310'.
   758     12  ER-8311                 PIC X(4)  VALUE '8311'.
   759     12  ER-8312                 PIC X(4)  VALUE '8312'.
   760     12  ER-8313                 PIC X(4)  VALUE '8313'.
   761     12  ER-8314                 PIC X(4)  VALUE '8314'.
   762     12  ER-8315                 PIC X(4)  VALUE '8315'.
   763     12  ER-8316                 PIC X(4)  VALUE '8316'.
   764     12  ER-8317                 PIC X(4)  VALUE '8317'.
   765
   766 01  CSO-WORK-FIELDS.
   767     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   768       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   769
   770     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   771     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   772         88  CERT-NOTE-ADDED           VALUE 'Y'.
   773     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   774         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   775     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   776
   777     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   778
   779 01  SC-NP6-CERT-NOTE.
   780     12  FILLER                  PIC X(12)
   781               VALUE 'REM BENEFIT '.
   782     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   783     12  SC-NP6-COMM             PIC X(8)
   784               VALUE ' + 6 MO '.
   785     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   786     12  FILLER                  PIC X(12)
   787               VALUE ' = AMT PAID '.
   788     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   789
   790 01  SC-NP6-ORIG-NOTE.
   791     12  FILLER                  PIC X(63)  VALUE
   792         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   793 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   794     88  PDEF-FOUND                   VALUE 'Y'.
   795 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   796     88  ACCT-FOUND                   VALUE 'Y'.
   797 01  CTBL-KEY-SAVE               PIC X(5).
   798 01  CTBL-KEY.
   799     05  CTBL-COMPANY-CD         PIC X.
   800     05  CTBL-TABLE              PIC XXX.
   801     05  CTBL-BEN-TYPE           PIC X.
   802     05  CTBL-BEN-CODE           PIC XX.
   803 01  ERPDEF-KEY-SAVE             PIC X(18).
   804 01  ERPDEF-KEY.
   805     12  ERPDEF-COMPANY-CD       PIC X.
   806     12  ERPDEF-STATE            PIC XX.
   807     12  ERPDEF-PROD-CD          PIC XXX.
   808     12  F                       PIC X(7).
   809     12  ERPDEF-BEN-TYPE         PIC X.
   810     12  ERPDEF-BEN-CODE         PIC XX.
   811     12  ERPDEF-EXP-DT           PIC XX.
   812 01  ELCRTT-KEY.
   813     05  CTRLR-COMP-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  16
* EL156.cbl
   814     05  CTRLR-CARRIER       PIC X.
   815     05  CTRLR-GROUPING      PIC X(6).
   816     05  CTRLR-STATE         PIC X(2).
   817     05  CTRLR-ACCOUNT       PIC X(10).
   818     05  CTRLR-EFF-DT        PIC XX.
   819     05  CTRLR-CERT-NO       PIC X(11).
   820     05  CTRLR-REC-TYPE      PIC X.
   821 01  ACCESS-KEYS.
   822     12  ELARCH-KEY.
   823         16  ARCH-CO             PIC X.
   824         16  ARCH-NUMBER         PIC S9(08) COMP.
   825         16  ARCH-REC-TYPE       PIC X.
   826         16  ARCH-SEQ            PIC S9(04) COMP.
   827     12  ELMSTR-KEY.
   828         16  MSTR-COMP-CD        PIC X.
   829         16  MSTR-CARRIER        PIC X.
   830         16  MSTR-CLAIM-NO       PIC X(7).
   831         16  MSTR-CERT-NO        PIC X(11).
   832     12  ELCNTL-KEY.
   833         16  CNTL-COMP-ID        PIC X(3).
   834         16  CNTL-REC-TYPE       PIC X.
   835         16  CNTL-ACCESS         PIC X(4).
   836         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   837     12  ELCERT-KEY.
   838         16  CERT-COMP-CD        PIC X.
   839         16  CERT-CARRIER        PIC X.
   840         16  CERT-GROUPING       PIC X(6).
   841         16  CERT-STATE          PIC XX.
   842         16  CERT-ACCOUNT        PIC X(10).
   843         16  CERT-EFF-DT         PIC XX.
   844         16  CERT-CERT-NO        PIC X(11).
   845     12  ELTRLR-KEY.
   846         16  TRLR-COMP-CD        PIC X.
   847         16  TRLR-CARRIER        PIC X.
   848         16  TRLR-CLAIM-NO       PIC X(7).
   849         16  TRLR-CERT-NO        PIC X(11).
   850         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   851     12  ELACTQ-KEY.
   852         16  ACTQ-COMP-CD        PIC X.
   853         16  ACTQ-CARRIER        PIC X.
   854         16  ACTQ-CLAIM-NO       PIC X(7).
   855         16  ACTQ-CERT-NO        PIC X(11).
   856     12  W-NOTE-KEY.
   857         16  W-NOTE-COMP-CD      PIC X.
   858         16  W-NOTE-CERT-KEY.
   859             20  W-NOTE-CARRIER  PIC X.
   860             20  W-NOTE-GROUPING PIC X(6).
   861             20  W-NOTE-STATE    PIC XX.
   862             20  W-NOTE-ACCOUNT  PIC X(10).
   863             20  W-NOTE-EFF-DT   PIC XX.
   864             20  W-NOTE-CERT-NO  PIC X(11).
   865     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   866     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   867     12  ERACCT-KEY.
   868         16  ERACCT-PARTIAL-KEY.
   869             20  ACCT-COMP-CD    PIC X.
   870             20  ACCT-CARRIER    PIC X.
   871             20  ACCT-GROUPING   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  17
* EL156.cbl
   872             20  ACCT-STATE      PIC XX.
   873             20  ACCT-ACCOUNT    PIC X(10).
   874         16  ACCT-EXP-DT         PIC XX.
   875         16  FILLER              PIC X(4) VALUE SPACES.
   876     12  ELCHKQ-KEY.
   877         16  CHKQ-COMP-CD        PIC X.
   878         16  CHKQ-CONTROL        PIC S9(8) COMP.
   879         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   880     12  ELBENE-KEY.
   881         16  BENE-COMP-CD         PIC X.
   882         16  BENE-RECORD-TYPE     PIC X.
   883         16  BENE-NUMBER          PIC X(10).
   884     12  ERCOMP-KEY.
   885         16  COMP-COMP-CD        PIC X.
   886         16  COMP-CARRIER        PIC X.
   887         16  COMP-GROUP          PIC X(06).
   888         16  COMP-FIN-RESP       PIC X(10).
   889         16  COMP-ACCOUNT        PIC X(10).
   890         16  COMP-TYPE           PIC X.
   891
   892     12  DLO035-KEY.
   893         16  DL35-PROCESS-TYPE   PIC X.
   894         16  DL35-CREDIT-CARD    PIC X(20).
   895         16  DL35-BEN-TYPE       PIC XX.
   896         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   897         16  DL35-RETURN-CODE    PIC XX.
   898
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  18
* EL156.cbl
   900*    COPY ELCDATE.
   901******************************************************************
   902*                                                                *
   903*                                                                *
   904*                            ELCDATE.                            *
   905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   906*                            VMOD=2.003
   907*                                                                *
   908*                                                                *
   909*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   910*                 LENGTH = 200                                   *
   911******************************************************************
   912
   913 01  DATE-CONVERSION-DATA.
   914     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   915     12  DC-OPTION-CODE                PIC X.
   916         88  BIN-TO-GREG                VALUE ' '.
   917         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   918         88  EDIT-GREG-TO-BIN           VALUE '2'.
   919         88  YMD-GREG-TO-BIN            VALUE '3'.
   920         88  MDY-GREG-TO-BIN            VALUE '4'.
   921         88  JULIAN-TO-BIN              VALUE '5'.
   922         88  BIN-PLUS-ELAPSED           VALUE '6'.
   923         88  FIND-CENTURY               VALUE '7'.
   924         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   925         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   926         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   927         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   928         88  JULIAN-TO-BIN-3            VALUE 'C'.
   929         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   930         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   931         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   932         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   933         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   934         88  CHECK-LEAP-YEAR            VALUE 'H'.
   935         88  BIN-3-TO-GREG              VALUE 'I'.
   936         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   937         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   938         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   939         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   940         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   941         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   942         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   943         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   944         88  THREE-CHARACTER-BIN
   945                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   946         88  GREGORIAN-TO-BIN
   947                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   948         88  BIN-TO-GREGORIAN
   949                  VALUES ' ' '1' 'I' '8' 'G'.
   950         88  JULIAN-TO-BINARY
   951                  VALUES '5' 'C' 'E' 'F'.
   952     12  DC-ERROR-CODE                 PIC X.
   953         88  NO-CONVERSION-ERROR        VALUE ' '.
   954         88  DATE-CONVERSION-ERROR
   955                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   956         88  DATE-IS-ZERO               VALUE '1'.
   957         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  19
* EL156.cbl
   958         88  DATE-IS-INVALID            VALUE '3'.
   959         88  DATE1-GREATER-DATE2        VALUE '4'.
   960         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   961         88  DATE-INVALID-OPTION        VALUE '9'.
   962         88  INVALID-CENTURY            VALUE 'A'.
   963         88  ONLY-CENTURY               VALUE 'B'.
   964         88  ONLY-LEAP-YEAR             VALUE 'C'.
   965         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   966     12  DC-END-OF-MONTH               PIC X.
   967         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   968     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   969         88  USE-NORMAL-PROCESS         VALUE ' '.
   970         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   971         88  ADJUST-UP-100-YRS          VALUE '2'.
   972     12  FILLER                        PIC X.
   973     12  DC-CONVERSION-DATES.
   974         16  DC-BIN-DATE-1             PIC XX.
   975         16  DC-BIN-DATE-2             PIC XX.
   976         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   977         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   978                       DC-GREG-DATE-1-EDIT.
   979             20  DC-EDIT1-MONTH        PIC 99.
   980             20  SLASH1-1              PIC X.
   981             20  DC-EDIT1-DAY          PIC 99.
   982             20  SLASH1-2              PIC X.
   983             20  DC-EDIT1-YEAR         PIC 99.
   984         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   985         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   986                     DC-GREG-DATE-2-EDIT.
   987             20  DC-EDIT2-MONTH        PIC 99.
   988             20  SLASH2-1              PIC X.
   989             20  DC-EDIT2-DAY          PIC 99.
   990             20  SLASH2-2              PIC X.
   991             20  DC-EDIT2-YEAR         PIC 99.
   992         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   993         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   994                     DC-GREG-DATE-1-YMD.
   995             20  DC-YMD-YEAR           PIC 99.
   996             20  DC-YMD-MONTH          PIC 99.
   997             20  DC-YMD-DAY            PIC 99.
   998         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   999         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1000                      DC-GREG-DATE-1-MDY.
  1001             20  DC-MDY-MONTH          PIC 99.
  1002             20  DC-MDY-DAY            PIC 99.
  1003             20  DC-MDY-YEAR           PIC 99.
  1004         16  DC-GREG-DATE-1-ALPHA.
  1005             20  DC-ALPHA-MONTH        PIC X(10).
  1006             20  DC-ALPHA-DAY          PIC 99.
  1007             20  FILLER                PIC XX.
  1008             20  DC-ALPHA-CENTURY.
  1009                 24 DC-ALPHA-CEN-N     PIC 99.
  1010             20  DC-ALPHA-YEAR         PIC 99.
  1011         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1012         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1013         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1014         16  DC-JULIAN-DATE            PIC 9(05).
  1015         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  20
* EL156.cbl
  1016                                       PIC 9(05).
  1017         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1018             20  DC-JULIAN-YEAR        PIC 99.
  1019             20  DC-JULIAN-DAYS        PIC 999.
  1020         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1021         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1022         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1023     12  DATE-CONVERSION-VARIBLES.
  1024         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1025         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1026             20  FILLER                PIC 9(3).
  1027             20  HOLD-CEN-1-CCYY.
  1028                 24  HOLD-CEN-1-CC     PIC 99.
  1029                 24  HOLD-CEN-1-YY     PIC 99.
  1030             20  HOLD-CEN-1-MO         PIC 99.
  1031             20  HOLD-CEN-1-DA         PIC 99.
  1032         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1033             20  HOLD-CEN-1-R-MO       PIC 99.
  1034             20  HOLD-CEN-1-R-DA       PIC 99.
  1035             20  HOLD-CEN-1-R-CCYY.
  1036                 24  HOLD-CEN-1-R-CC   PIC 99.
  1037                 24  HOLD-CEN-1-R-YY   PIC 99.
  1038             20  FILLER                PIC 9(3).
  1039         16  HOLD-CENTURY-1-X.
  1040             20  FILLER                PIC X(3)  VALUE SPACES.
  1041             20  HOLD-CEN-1-X-CCYY.
  1042                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1043                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1044             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1045             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1046         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1047             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1048             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1049             20  HOLD-CEN-1-R-X-CCYY.
  1050                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1051                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1052             20  FILLER                PIC XXX.
  1053         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1054         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1055         16  DC-JULIAN-DATE-1          PIC 9(07).
  1056         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1057             20  DC-JULIAN-1-CCYY.
  1058                 24  DC-JULIAN-1-CC    PIC 99.
  1059                 24  DC-JULIAN-1-YR    PIC 99.
  1060             20  DC-JULIAN-DA-1        PIC 999.
  1061         16  DC-JULIAN-DATE-2          PIC 9(07).
  1062         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1063             20  DC-JULIAN-2-CCYY.
  1064                 24  DC-JULIAN-2-CC    PIC 99.
  1065                 24  DC-JULIAN-2-YR    PIC 99.
  1066             20  DC-JULIAN-DA-2        PIC 999.
  1067         16  DC-GREG-DATE-A-EDIT.
  1068             20  DC-EDITA-MONTH        PIC 99.
  1069             20  SLASHA-1              PIC X VALUE '/'.
  1070             20  DC-EDITA-DAY          PIC 99.
  1071             20  SLASHA-2              PIC X VALUE '/'.
  1072             20  DC-EDITA-CCYY.
  1073                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  21
* EL156.cbl
  1074                 24  DC-EDITA-YEAR     PIC 99.
  1075         16  DC-GREG-DATE-B-EDIT.
  1076             20  DC-EDITB-MONTH        PIC 99.
  1077             20  SLASHB-1              PIC X VALUE '/'.
  1078             20  DC-EDITB-DAY          PIC 99.
  1079             20  SLASHB-2              PIC X VALUE '/'.
  1080             20  DC-EDITB-CCYY.
  1081                 24  DC-EDITB-CENT     PIC 99.
  1082                 24  DC-EDITB-YEAR     PIC 99.
  1083         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1084         16  DC-GREG-DATE-CYMD-R REDEFINES
  1085                              DC-GREG-DATE-CYMD.
  1086             20  DC-CYMD-CEN           PIC 99.
  1087             20  DC-CYMD-YEAR          PIC 99.
  1088             20  DC-CYMD-MONTH         PIC 99.
  1089             20  DC-CYMD-DAY           PIC 99.
  1090         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1091         16  DC-GREG-DATE-MDCY-R REDEFINES
  1092                              DC-GREG-DATE-MDCY.
  1093             20  DC-MDCY-MONTH         PIC 99.
  1094             20  DC-MDCY-DAY           PIC 99.
  1095             20  DC-MDCY-CEN           PIC 99.
  1096             20  DC-MDCY-YEAR          PIC 99.
  1097    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1098        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1099    12  DC-EL310-DATE                  PIC X(21).
  1100    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  22
* EL156.cbl
  1102*    COPY ELCLOGOF.
  1103******************************************************************
  1104*                                                                *
  1105*                                                                *
  1106*                            ELCLOGOF.                           *
  1107*                            VMOD=2.001                          *
  1108*                                                                *
  1109*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1110*                                                                *
  1111******************************************************************
  1112 01  CLASIC-LOGOFF.
  1113     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1114     12  LOGOFF-TEXT.
  1115         16  FILLER          PIC X(5)    VALUE SPACES.
  1116         16  LOGOFF-MSG.
  1117             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1118             20  FILLER      PIC X       VALUE SPACES.
  1119             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1120         16  FILLER          PIC X(80)
  1121           VALUE '* YOU ARE NOW LOGGED OFF'.
  1122         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1123         16  FILLER          PIC X       VALUE QUOTE.
  1124         16  LOGOFF-SYS-MSG  PIC X(17)
  1125           VALUE 'S CLAS-IC SYSTEM '.
  1126     12  TEXT-MESSAGES.
  1127         16  UNACCESS-MSG    PIC X(29)
  1128             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1129         16  PGMIDERR-MSG    PIC X(17)
  1130             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  23
* EL156.cbl
  1132*    COPY ELCCALC.
  1133******************************************************************
  1134*                                                                *
  1135*                           ELCCALC.                            *
  1136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1137*                            VMOD=2.025                          *
  1138*                                                                *
  1139*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1140*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1141*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1142*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1143*                                                                *
  1144*  PASSED TO ELRTRM                                              *
  1145*  -----------------                                             *
  1146*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1147*  ORIGINAL TERM                                                 *
  1148*  BEGINNING DATE                                                *
  1149*  ENDING DATE                                                   *
  1150*  COMPANY I.D.                                                  *
  1151*  ACCOUNT MASTER USER FIELD                                     *
  1152*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1153*  FREE LOOK DAYS                                                *
  1154*                                                                *
  1155*  RETURNED FROM ELRTRM                                          *
  1156*  ---------------------                                         *
  1157*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1158*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1159*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1160*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1161*----------------------------------------------------------------*
  1162*  PASSED TO ELRAMT                                              *
  1163*  ----------------                                              *
  1164*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1165*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1166*  ORIGINAL AMOUNT                                               *
  1167*  ALTERNATE BENEFIT (BALLON)                                    *
  1168*  A.P.R. - NET PAY ONLY                                         *
  1169*  METHOD
  1170*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1171*  COMPANY I.D.                                                  *
  1172*  BENEFIT TYPE                                                  *
  1173*                                                                *
  1174*  RETURNED FROM ELRAMT                                          *
  1175*  --------------------                                          *
  1176*  REMAINING AMOUNT 1 - CURRENT                                  *
  1177*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1178*  REMAINING AMOUNT FACTOR
  1179*----------------------------------------------------------------*
  1180*  PASSED TO ELRESV                                              *
  1181*  -----------------                                             *
  1182*  CERTIFICATE EFFECTIVE DATE                                    *
  1183*  VALUATION DATE                                                *
  1184*  PAID THRU DATE                                                *
  1185*  BENEFIT                                                       *
  1186*  INCURRED DATE                                                 *
  1187*  REPORTED DATE                                                 *
  1188*  ISSUE AGE                                                     *
  1189*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  24
* EL156.cbl
  1190*  CDT PERCENT                                                   *
  1191*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1192* *CLAIM TYPE (LIFE, A/H)                                        *
  1193* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1194* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1195*                                                                *
  1196*  RETURNED FROM ELRESV                                          *
  1197*  --------------------                                          *
  1198*  CDT TABLE USED                                                *
  1199*  CDT FACTOR USED                                               *
  1200*  PAY TO CURRENT RESERVE                                        *
  1201*  I.B.N.R. - A/H ONLY                                           *
  1202*  FUTURE (ACCRUED) AH ONLY                                      *
  1203*----------------------------------------------------------------*
  1204*  PASSED TO ELRATE                                              *
  1205*  ----------------                                              *
  1206*  CERT ISSUE DATE                                               *
  1207*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1208*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1209*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1210*  STATE CODE (CLIENT DEFINED)                                   *
  1211*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1212*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1213*  DEVIATION CODE                                                *
  1214*  ISSUE AGE                                                     *
  1215*  ORIGINAL BENEFIT AMOUNT                                       *
  1216*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1217*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1218*  BENEFIT KIND (LIFE OR A/H)                                    *
  1219*  A.P.R.                                                        *
  1220*  METHOD
  1221*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1222*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1223*  COMPANY I.D. (3 CHARACTER)                                    *
  1224*  BENEFIT CODE                                                  *
  1225*  BENEFIT OVERRIDE CODE                                         *
  1226*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1227*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1228*  JOINT INDICATOR (CSL ONLY)                                    *
  1229*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1230*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1231*                                                                *
  1232*  RETURNED FROM ELRATE                                          *
  1233*  --------------------                                          *
  1234*  CALCULATED PREMIUM                                            *
  1235*  PREMIUM RATE                                                  *
  1236*  MORTALITY CODE                                                *
  1237*  MAX ATTAINED AGE                                              *
  1238*  MAX AGE                                                       *
  1239*  MAX TERM                                                      *
  1240*  MAX MONTHLY BENEFIT                                           *
  1241*  MAX TOTAL BENIFIT                                             *
  1242*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1243*----------------------------------------------------------------*
  1244*  PASSED TO ELRFND                                              *
  1245*  ----------------                                              *
  1246*  CERT ISSUE DATE                                               *
  1247*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  25
* EL156.cbl
  1248*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1249*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1250*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1251*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1252*  STATE CODE (CLIENT DEFINED)                                   *
  1253*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1254*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1255*  DEVIATION CODE                                                *
  1256*  ISSUE AGE                                                     *
  1257*  ORIGINAL BENEFIT AMOUNT                                       *
  1258*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1259*  PROCESS TYPE (CANCEL)                                         *
  1260*  BENEFIT KIND (LIFE OR A/H)                                    *
  1261*  A.P.R.                                                        *
  1262*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1263*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1264*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1265*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1266*  COMPANY I.D. (3 CHARACTER)                                    *
  1267*  BENEFIT CODE                                                  *
  1268*  BENEFIT OVERRIDE CODE                                         *
  1269*                                                                *
  1270*  RETURNED FROM ELRFND                                          *
  1271*  --------------------                                          *
  1272*  CALCULATED REFUND                                             *
  1273*----------------------------------------------------------------*
  1274*  PASSED TO ELEARN                                              *
  1275*  ----------------                                              *
  1276*  CERT ISSUE DATE                                               *
  1277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1278*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1279*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1280*  STATE CODE (CLIENT DEFINED)                                   *
  1281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1283*  DEVIATION CODE                                                *
  1284*  ISSUE AGE                                                     *
  1285*  ORIGINAL BENEFIT AMOUNT                                       *
  1286*  BENEFIT KIND (LIFE OR A/H)                                    *
  1287*  A.P.R.                                                        *
  1288*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1289*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1290*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1291*  COMPANY I.D. (3 CHARACTER)                                    *
  1292*  BENEFIT CODE                                                  *
  1293*  BENEFIT OVERRIDE CODE                                         *
  1294*                                                                *
  1295*  RETURNED FROM ELEARN                                          *
  1296*  --------------------                                          *
  1297*  INDICATED  EARNINGS                                           *
  1298*----------------------------------------------------------------*
  1299*                 LENGTH = 450                                   *
  1300*                                                                *
  1301******************************************************************
  1302******************************************************************
  1303*                   C H A N G E   L O G
  1304*
  1305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  26
* EL156.cbl
  1306*-----------------------------------------------------------------
  1307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1308* EFFECTIVE    NUMBER
  1309*-----------------------------------------------------------------
  1310* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1311* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1312* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1313* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1314* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1315* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1316* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1317* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1318* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1319******************************************************************
  1320
  1321 01  CALCULATION-PASS-AREA.
  1322     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1323                                     COMP.
  1324
  1325     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1326       88  NO-CP-ERROR                             VALUE ZERO.
  1327       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1328                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1329       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1330       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1331       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1332       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1333       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1334       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1335       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1336       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1337       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1338       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1339       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1340       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1341       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1342       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1343       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1344       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1345       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1346
  1347     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1348       88  NO-CP-ERROR-2                           VALUE ZERO.
  1349***********************  INPUT AREAS ****************************
  1350
  1351     12  CP-CALCULATION-AREA.
  1352         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1353         16  CP-CERT-EFF-DT        PIC XX.
  1354         16  CP-VALUATION-DT       PIC XX.
  1355         16  CP-PAID-THRU-DT       PIC XX.
  1356         16  CP-BENEFIT-TYPE       PIC X.
  1357           88  CP-AH                               VALUE 'A' 'D'
  1358                                                   'I' 'U'.
  1359           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1360           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1361         16  CP-INCURRED-DT        PIC XX.
  1362         16  CP-REPORTED-DT        PIC XX.
  1363         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  27
* EL156.cbl
  1364         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1365         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1366                                     COMP-3.
  1367         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1368                                     COMP-3.
  1369         16  CP-CDT-METHOD         PIC X.
  1370           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1371           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1372           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1373         16  CP-CLAIM-TYPE         PIC X.
  1374           88  CP-AH-CLAIM                         VALUE 'A'.
  1375           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1376         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-REM-TERM-METHOD    PIC X.
  1391           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1392           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1393           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1394           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1395           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1396           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1397           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1398         16  CP-EARNING-METHOD     PIC X.
  1399           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1400           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1401           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1402           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1403           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1404           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1405           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1406           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1407           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1408           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1409           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1410           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1411           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1412           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1413         16  CP-PROCESS-TYPE       PIC X.
  1414           88  CP-CLAIM                            VALUE '1'.
  1415           88  CP-CANCEL                           VALUE '2'.
  1416           88  CP-ISSUE                            VALUE '3'.
  1417         16  CP-SPECIAL-CALC-CD    PIC X.
  1418           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1419           88  CP-1-MTH-INTEREST               VALUE ' '.
  1420           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1421           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  28
* EL156.cbl
  1422           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1423           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1424           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1425           88  CP-FARM-PLAN                    VALUE 'F'.
  1426           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1427           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1428           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1429           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1430           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1431           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1432           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1433           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1434           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1435           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1436                                                     'W' 'X'.
  1437           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1438           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1439           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1440           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1441           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1442           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1443           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1444           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1445           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1446           88  CP-CSL-METH-1                   VALUE '5'.
  1447           88  CP-CSL-METH-2                   VALUE '6'.
  1448           88  CP-CSL-METH-3                   VALUE '7'.
  1449           88  CP-CSL-METH-4                   VALUE '8'.
  1450
  1451         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1452                                     COMP-3.
  1453         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1454         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1455         16  CP-STATE              PIC XX          VALUE SPACE.
  1456         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1457         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1458           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1459               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1460         16  CP-R78-OPTION         PIC X.
  1461           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1462           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1463
  1464         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1465         16  CP-IBNR-RESERVE-SW    PIC X.
  1466         16  CP-CLAIM-STATUS       PIC X.
  1467         16  CP-RATE-FILE          PIC X.
  1468         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1469                                     COMP-3.
  1470
  1471         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1472         16  CP-AH-OVERRIDE-CODE   PIC X.
  1473
  1474         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1475                                     COMP-3.
  1476         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1477                                   PIC S9(5)V99 COMP-3.
  1478         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1479                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  29
* EL156.cbl
  1480         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1481                                     COMP-3.
  1482         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1483                                     COMP-3.
  1484         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1485                                  PIC S9(7)V99 COMP-3.
  1486
  1487         16  CP-PAID-FROM-DATE     PIC X(02).
  1488         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1489         16  CP-EXT-DAYS-CALC      PIC X.
  1490           88  CP-EXT-NO-CHG                   VALUE ' '.
  1491           88  CP-EXT-CHG-LF                   VALUE '1'.
  1492           88  CP-EXT-CHG-AH                   VALUE '2'.
  1493           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1494         16  CP-DOMICILE-STATE     PIC XX.
  1495         16  CP-CARRIER            PIC X.
  1496         16  CP-REIN-FLAG          PIC X.
  1497         16  CP-REM-TRM-CALC-OPTION PIC X.
  1498           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1499                      '2' '3' '4' '5'.
  1500           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1501           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1502           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1503           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1504           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1505           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1506           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1507           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1508         16  CP-SIG-SWITCH         PIC X.
  1509         16  CP-RATING-METHOD      PIC X.
  1510           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1511           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1512           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1513           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1514           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1515           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1516           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1517           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1518           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1519         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1520                                     COMP-3.
  1521         16  CP-BEN-CATEGORY       PIC X.
  1522         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1523         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1524                                   PIC S99V9(5) COMP-3.
  1525         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1526         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1527                                   PIC S99V9(5) COMP-3.
  1528         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1529         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1530         16  CP-EXPIRE-DT          PIC XX.
  1531         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1532         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1533         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1534         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1535         16  CP-DDF-SPEC-CALC      PIC X.
  1536             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1537             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  30
* EL156.cbl
  1538         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1539         16  CP-CANCEL-REASON      PIC X.
  1540         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1541         16  CP-PMT-MODE           PIC X.
  1542         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1543         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1544         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1545         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1546         16  FILLER                PIC X.
  1547
  1548***************    OUTPUT FROM ELRESV   ************************
  1549
  1550         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1551
  1552         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1553                                     COMP-3.
  1554         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1555                                     COMP-3.
  1556         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1559                                     COMP-3.
  1560         16  FILLER                PIC X(09).
  1561***************    OUTPUT FROM ELRTRM   *************************
  1562
  1563         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1564                                     COMP-3.
  1565         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1570                                     COMP-3.
  1571         16  FILLER                PIC X(12).
  1572
  1573***************    OUTPUT FROM ELRAMT   *************************
  1574
  1575         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  FILLER                PIC X(12).
  1580
  1581***************    OUTPUT FROM ELRATE   *************************
  1582
  1583         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1584                                     COMP-3.
  1585         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1586                                     COMP-3.
  1587         16  CP-MORTALITY-CODE     PIC X(4).
  1588         16  CP-RATE-EDIT-FLAG     PIC X.
  1589             88  CP-RATES-NEED-APR                  VALUE '1'.
  1590         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1591                                     COMP-3.
  1592         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1593         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1594         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1595                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  31
* EL156.cbl
  1596         16  FILLER                PIC X(07).
  1597
  1598***************    OUTPUT FROM ELRFND   *************************
  1599
  1600         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1601                                     COMP-3.
  1602         16  CP-REFUND-TYPE-USED   PIC X.
  1603           88  CP-R-AS-R78                         VALUE '1'.
  1604           88  CP-R-AS-PRORATA                     VALUE '2'.
  1605           88  CP-R-AS-CALIF                       VALUE '3'.
  1606           88  CP-R-AS-TEXAS                       VALUE '4'.
  1607           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1608           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1609           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1610           88  CP-R-AS-MEAN                        VALUE '8'.
  1611           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1612           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1613           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1614           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1615           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1616           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1617         16  FILLER                PIC X(12).
  1618
  1619***************    OUTPUT FROM ELEARN   *************************
  1620
  1621         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-EARNING-TYPE-USED  PIC X.
  1634           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1635           88  CP-E-AS-R78                         VALUE '1'.
  1636           88  CP-E-AS-PRORATA                     VALUE '2'.
  1637           88  CP-E-AS-TEXAS                       VALUE '4'.
  1638           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1639           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1640           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1641           88  CP-E-AS-MEAN                        VALUE '8'.
  1642           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1643         16  FILLER                PIC X(12).
  1644
  1645***************    OUTPUT FROM ELPMNT   *************************
  1646
  1647         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1648                                     COMP-3.
  1649         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1650                                     COMP-3.
  1651         16  FILLER                PIC X(12).
  1652
  1653***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  32
* EL156.cbl
  1654         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1655                                     COMP-3.
  1656         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1657                                     COMP-3.
  1658         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1667             88  OPEN-RATE-FILE                   VALUE 'O'.
  1668             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1669             88  IO-ERROR                         VALUE 'E'.
  1670
  1671         16  CP-FIRST-PAY-DATE     PIC XX.
  1672
  1673         16  CP-JOINT-INDICATOR    PIC X.
  1674
  1675         16  CP-RESERVE-REMAINING-TERM
  1676                                   PIC S9(4)V9    VALUE ZERO
  1677                                     COMP-3.
  1678
  1679         16  CP-INSURED-BIRTH-DT   PIC XX.
  1680
  1681         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1682                                     COMP-3.
  1683
  1684         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1685                                     COMP-3.
  1686
  1687         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1688                                     COMP-3.
  1689
  1690         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1691                                     COMP-3.
  1692
  1693         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1694                                     COMP-3.
  1695
  1696         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1697                                     COMP-3.
  1698
  1699         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1700                                     COMP-3.
  1701
  1702         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1703             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1704
  1705         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1706                                     COMP-3.
  1707         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1708                                     COMP-3.
  1709         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1710         16  FILLER                PIC X(15).
  1711******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  33
* EL156.cbl
  1712*    COPY ELCICALC.
  1713******************************************************************
  1714*                                                                *
  1715*                           ELCCICALC.                           *
  1716*                            VMOD=2.001                          *
  1717*                                                                *
  1718*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1719*                 CALCULATION MODULE                             *
  1720*                                                                *
  1721*  PASSED TO ELCLMI                                              *
  1722*  -----------------                                             *
  1723*  STATE                                                         *
  1724*  PRODUCT                                                       *
  1725*  COVERAGE                                                      *
  1726*  EFFECTIVE DATE                                                *
  1727*  INCURRED DATE                                                 *
  1728*  ESTABLISHED DATE                                              *
  1729*  LAST PAID DATE                                                *
  1730*  REPORTED DATE                                                 *
  1731*  CLAIM PAYMENT AMOUNT                                          *
  1732*                                                                *
  1733*  RETURNED FROM ELRTRM                                          *
  1734*  ---------------------                                         *
  1735*  RETURN CODE                                                   *
  1736*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1737*  CLAIM INTEREST AMOUNT                                         *
  1738*----------------------------------------------------------------*
  1739*----------------------------------------------------------------*
  1740*                 LENGTH = 100                                   *
  1741*                                                                *
  1742******************************************************************
  1743******************************************************************
  1744*                   C H A N G E   L O G
  1745*
  1746* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1747*-----------------------------------------------------------------
  1748*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1749* EFFECTIVE    NUMBER
  1750*-----------------------------------------------------------------
  1751* 120905    2004040700004  PEMA  NEW COPYBOOK
  1752* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1753******************************************************************
  1754
  1755 01  CLAIM-INT-PASS-AREA.
  1756     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1757                                     COMP.
  1758
  1759     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1760       88  NO-CI-ERROR                             VALUE ZERO.
  1761       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1762       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1763       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1764       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1765       88  CP-AMT-LT-5000                          VALUE '4'.
  1766       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1767       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1768       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1769       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  34
* EL156.cbl
  1770***********************  INPUT AREAS ****************************
  1771
  1772     12  CP-CALCULATION-AREA.
  1773         16  CP-COMPANY-CD         PIC X.
  1774         16  CP-STATE              PIC XX.
  1775         16  CP-PRODUCT            PIC XX.
  1776         16  CP-COVERAGE           PIC XX.
  1777         16  CP-INC-DT             PIC XX.
  1778         16  CP-EST-DT             PIC XX.
  1779         16  CP-LSTPD-DT           PIC XX.
  1780         16  CP-RPT-DT             PIC XX.
  1781         16  CP-PRF-DT             PIC XX.
  1782         16  CP-EFF-DT             PIC XX.
  1783         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1784         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1785         16  FILLER                PIC X(37).
  1786
  1787***************    OUTPUT FROM ELCLMI   ************************
  1788
  1789         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1790
  1791         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1792         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1793         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1794         16  FILLER                PIC X(19).
  1795******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  35
* EL156.cbl
  1797*    COPY ELCATTR.
  1798******************************************************************
  1799*                                                                *
  1800*                            ELCATTR.                            *
  1801*                            VMOD=2.001                          *
  1802*                                                                *
  1803*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1804*                                                                *
  1805*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1806*                                                                *
  1807*                   POS 1   P=PROTECTED                          *
  1808*                           U=UNPROTECTED                        *
  1809*                           S=ASKIP                              *
  1810*                   POS 2   A=ALPHA/NUMERIC                      *
  1811*                           N=NUMERIC                            *
  1812*                   POS 3   N=NORMAL                             *
  1813*                           B=BRIGHT                             *
  1814*                           D=DARK                               *
  1815*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1816*                           OF=MODIFIED DATA TAG OFF             *
  1817*                                                                *
  1818*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1819******************************************************************
  1820 01  ATTRIBUTE-LIST.
  1821     12  AL-PABOF            PIC X       VALUE 'Y'.
  1822     12  AL-PABON            PIC X       VALUE 'Z'.
  1823     12  AL-PADOF            PIC X       VALUE '%'.
  1824     12  AL-PADON            PIC X       VALUE '_'.
  1825     12  AL-PANOF            PIC X       VALUE '-'.
  1826     12  AL-PANON            PIC X       VALUE '/'.
  1827     12  AL-SABOF            PIC X       VALUE '8'.
  1828     12  AL-SABON            PIC X       VALUE '9'.
  1829     12  AL-SADOF            PIC X       VALUE '@'.
  1830     12  AL-SADON            PIC X       VALUE QUOTE.
  1831     12  AL-SANOF            PIC X       VALUE '0'.
  1832     12  AL-SANON            PIC X       VALUE '1'.
  1833     12  AL-UABOF            PIC X       VALUE 'H'.
  1834     12  AL-UABON            PIC X       VALUE 'I'.
  1835     12  AL-UADOF            PIC X       VALUE '<'.
  1836     12  AL-UADON            PIC X       VALUE '('.
  1837     12  AL-UANOF            PIC X       VALUE ' '.
  1838     12  AL-UANON            PIC X       VALUE 'A'.
  1839     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1840     12  AL-UNBON            PIC X       VALUE 'R'.
  1841     12  AL-UNDOF            PIC X       VALUE '*'.
  1842     12  AL-UNDON            PIC X       VALUE ')'.
  1843     12  AL-UNNOF            PIC X       VALUE '&'.
  1844     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  36
* EL156.cbl
  1846*    COPY ELCEMIB.
  1847******************************************************************
  1848*                                                                *
  1849*                                                                *
  1850*                            ELCEMIB.                            *
  1851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1852*                            VMOD=2.005                          *
  1853*                                                                *
  1854*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1855*                                                                *
  1856******************************************************************
  1857 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1858     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1859     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1860     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1861     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1862     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1863     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1864     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1865     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1866     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1867         88  EMI-NO-ERRORS                    VALUE '1'.
  1868         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1869         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1870     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1871         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1872     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1873         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1874         88  EMI-AREA1-FULL                   VALUE '2'.
  1875     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1876         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1877         88  EMI-AREA2-FULL                   VALUE '2'.
  1878     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1879         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1880         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1881         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1882         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1883         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1884     12  EMI-ERROR-LINES.
  1885         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1886         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1887         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1888         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1889             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1890                 24  EMI-ERR-NUM         PIC X(4).
  1891                 24  EMI-FILLER          PIC X.
  1892                 24  EMI-SEV             PIC X.
  1893                 24  FILLER              PIC X.
  1894             20  FILLER                  PIC X(02).
  1895     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1896         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1897             20  EMI-ERROR-NUMBER    PIC X(4).
  1898             20  EMI-FILL            PIC X.
  1899             20  EMI-SEVERITY        PIC X.
  1900             20  FILLER              PIC X.
  1901             20  EMI-ERROR-TEXT.
  1902                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1903                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  37
* EL156.cbl
  1904     12  EMI-SEVERITY-SAVE           PIC X.
  1905         88  EMI-NOTE                    VALUE 'N'.
  1906         88  EMI-WARNING                 VALUE 'W'.
  1907         88  EMI-FORCABLE                VALUE 'F'.
  1908         88  EMI-FATAL                   VALUE 'X'.
  1909     12  EMI-MESSAGE-FLAG            PIC X.
  1910         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1911         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1912     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1913     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1914         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1915         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1916         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1917     12  emi-claim-no                pic x(7).
  1918     12  emi-claim-type              pic x(6).
  1919     12  FILLER                      PIC X(124)  VALUE SPACES.
  1920     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1921     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1922     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1923     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  38
* EL156.cbl
  1925*    COPY ELCLNKLT.
  1926******************************************************************
  1927*                                                                *
  1928*                                                                *
  1929*                           ELCLNKLT                             *
  1930*                            VMOD=2.003                          *
  1931*                                                                *
  1932*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1933*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1934*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1935*                                                                *
  1936*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1937*   COMPLETING THE REQUIRED FIELDS.                              *
  1938*                                                                *
  1939*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1940*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1941*                              9999 INDICATES AN UNKNOWN ABEND   *
  1942*                                   WAS DETECTED.                *
  1943*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1944*                              CODES FOUND IN THE ERROR FILE.    *
  1945******************************************************************
  1946 01  W-1523-LINKDATA.
  1947     12  W-1523-COMMON-PI-DATA.
  1948         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1949         16  FILLER              PIC  X(67).
  1950         16  W-1523-COMPANY-CD   PIC  X(01).
  1951         16  FILLER              PIC  X(10).
  1952         16  W-1523-CONTROL-IN-PROGRESS.
  1953             20  W-1523-CARRIER  PIC  X(01).
  1954             20  W-1523-GROUPING PIC  X(06).
  1955             20  W-1523-STATE    PIC  X(02).
  1956             20  W-1523-ACCOUNT  PIC  X(10).
  1957             20  W-1523-CLAIM-CERT-GRP.
  1958                 24  W-1523-CLAIM-NO
  1959                                 PIC  X(07).
  1960                 24  W-1523-CERT-NO.
  1961                     28  W-1523-CERT-PRIME
  1962                                 PIC  X(10).
  1963                     28  W-1523-CERT-SFX
  1964                                 PIC  X(01).
  1965                 24  W-1523-CERT-EFF-DT
  1966                                 PIC  X(02).
  1967         16  FILLER              PIC X(265).
  1968
  1969     12  W-1523-WORK-AREA.
  1970         16  W-1523-FORM-NUMBER  PIC  X(04).
  1971         16  W-1523-NUMBER-COPIES
  1972                                 PIC  9(01).
  1973         16  W-1523-ADDR-TYPE    PIC  X(02).
  1974         16  W-1523-FOLLOW-UP-DATE
  1975                                 PIC  X(02).
  1976         16  W-1523-RESEND-DATE  PIC  X(02).
  1977         16  W-1523-ERROR-CODE   PIC  9(04).
  1978             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1979             88  W-1523-FATAL-ERROR
  1980                                    VALUES  0006 0013 0042
  1981                                            0154 0168 0169
  1982                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  39
* EL156.cbl
  1983                                            0179 0186 0281
  1984                                            0332 2055 3697
  1985                                            3698 3699 3770
  1986                                            3771 3772 7675
  1987                                            9106 9808 9883
  1988                                            9887.
  1989             88  W-1523-STOP-ERRORS
  1990                                    VALUES  0013 0042 0154
  1991                                            0168 0169 0172
  1992                                            0281 0332 2055
  1993                                            3698 3699 7675
  1994                                            9106 9808 9883
  1995                                            9999.
  1996         16  W-1523-REASON       PIC  X(70).
  1997         16  W-1523-ARCHIVE-NUMBER
  1998                                 PIC  9(08).
  1999     12  W-1523-POINTER-AREA.
  2000         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2001         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2002         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2003         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2004         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  40
* EL156.cbl
  2006*    COPY ELCNWA.
  2007*****************************************************************
  2008*                                                               *
  2009*                                                               *
  2010*                            ELCNWA.                            *
  2011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2012*                            VMOD=2.003                         *
  2013*                                                               *
  2014*            M O V E   N A M E   W O R K   A R E A.             *
  2015*                                                               *
  2016*****************************************************************.
  2017
  2018 01  WS-NAME-WORK-AREA.
  2019     05  WS-INSURED-LAST-NAME        PIC X(15).
  2020     05  WS-INSURED-1ST-NAME         PIC X(12).
  2021     05  WS-INSURED-MID-INIT         PIC X.
  2022
  2023     05  WS-NAME-WORK.
  2024         10  WS-NW                   PIC X
  2025             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2026
  2027     05  WS-NAME-WORK2.
  2028         10  WS-NW2                  PIC X
  2029             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2030                                        NWA-INDEX0.
  2031
  2032     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2033                                     COMP-3.
  2034
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  41
* EL156.cbl
  2036*    COPY ELCDMO.
  2037******************************************************************
  2038*                                                                *
  2039*                                                                *
  2040*                            ELCDMO.                             *
  2041*                            VMOD=2.004                          *
  2042*                                                                *
  2043*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2044*        COMMUNICATION AREA                                      *
  2045*   FILE TYPE = NA                                               *
  2046*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2047*                                                                *
  2048******************************************************************
  2049 01  DMO-COMMUNICATION-AREA.
  2050     12  DM-RECORD-TYPE                  PIC  X(02).
  2051             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2052             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2053             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2054     12  DM-DIST-CODE                    PIC  X(04).
  2055     12  DM-MAIL-CODE                    PIC  X(05).
  2056     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2057     12  DM-INSURED-NAME                 PIC  X(30).
  2058     12  DM-CLAIM-NO                     PIC  X(07).
  2059     12  DM-CLAIM-TYPE                   PIC  X.
  2060
  2061     12  DM-STATUS-DATA-AREA.
  2062         16  DM-CLAIM-STATUS             PIC  X.
  2063             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2064             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2065             88  DM-CLOSED                        VALUE '3'.
  2066             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2067             88  DM-DEFAULT                       VALUE '9'.
  2068         16  DM-STATUS-DATE              PIC  X(08).
  2069******YYYYMMDD
  2070         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2071             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2072             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2073             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2074             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2075             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2076             88  DM-RE-OPENED                     VALUE 'R'.
  2077             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2078             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2079             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2080         16  DM-STAT-CARRIER             PIC X.
  2081
  2082     12  DM-DRAFT-DATA-AREA.
  2083         16  DM-PAYMENT-TYPE             PIC  X.
  2084             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2085         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2086         16  DM-PAYMENT-DATE             PIC  X(08).
  2087******YYYYMMDD
  2088         16  DM-CERT-NO                  PIC  X(11).
  2089         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2090         16  DM-CARRIER                  PIC  X.
  2091
  2092     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  42
* EL156.cbl
  2094*    COPY ELCDMDCD.
  2095******************************************************************
  2096*                                                                *
  2097*                                                                *
  2098*                            ELCDMDCD.                           *
  2099*                            VMOD=2.001                          *
  2100*                                                                *
  2101*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2102*       COMMUNICATIONS AREA                                      *
  2103*                                                                *
  2104******************************************************************
  2105 01  CD-COMMUNICATION-AREA.
  2106     12  CD-SYSTEM-ID            PIC  X(02).
  2107         88 CD-CLAIMS                      VALUE 'CL'.
  2108         88 CD-CREDIT                      VALUE 'CR'.
  2109     12  CD-RECORD-TYPE          PIC  X(02).
  2110         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2111         88 CD-EOB-CODE                    VALUE 'EO'.
  2112         88 CD-ICD9-CODE                   VALUE 'I9'.
  2113         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2114         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2115         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2116         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2117         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2118     12  CD-RECORD-KEY           PIC  X(06).
  2119         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2120     12  CD-RETURN-CODE          PIC  X(02).
  2121     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2122     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2123     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2124     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  43
* EL156.cbl
  2126*    COPY ELCDCTB.
  2127******************************************************************
  2128*                                                                *
  2129*                                                                *
  2130*                            ELCDCTB.                            *
  2131*                            VMOD=2.002                          *
  2132*                                                                *
  2133*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2134*       COMMUNICATIONS AREA                                      *
  2135*                                                                *
  2136******************************************************************
  2137 01  DCT-COMMUNICATION-AREA.
  2138     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2139     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2140     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2141     12  DCT-PRODUCT-CODE         PIC  X(02).
  2142     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2143     12  DCT-RETURN-CODE          PIC  X(02).
  2144     12  DCT-MAIL-CODE            PIC  X(05).
  2145     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2146     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  44
* EL156.cbl
  2148 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2149 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2150 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2151 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  45
* EL156.cbl
  2153*    COPY ELCINTF.
  2154******************************************************************
  2155*                                                                *
  2156*                                                                *
  2157*                            ELCINTF.                            *
  2158*                            VMOD=2.017                          *
  2159*                                                                *
  2160*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2161*                                                                *
  2162*       LENGTH = 1024                                            *
  2163*                                                                *
  2164******************************************************************
  2165*                   C H A N G E   L O G
  2166*
  2167* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2168*-----------------------------------------------------------------
  2169*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2170* EFFECTIVE    NUMBER
  2171*-----------------------------------------------------------------
  2172* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2173******************************************************************
  2174 01  PROGRAM-INTERFACE-BLOCK.
  2175     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2176     12  PI-CALLING-PROGRAM              PIC X(8).
  2177     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2178     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2181     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2182     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2183     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2184     12  PI-COMPANY-ID                   PIC XXX.
  2185     12  PI-COMPANY-CD                   PIC X.
  2186
  2187     12  PI-COMPANY-PASSWORD             PIC X(8).
  2188
  2189     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2190
  2191     12  PI-CONTROL-IN-PROGRESS.
  2192         16  PI-CARRIER                  PIC X.
  2193         16  PI-GROUPING                 PIC X(6).
  2194         16  PI-STATE                    PIC XX.
  2195         16  PI-ACCOUNT                  PIC X(10).
  2196         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2197                                         PIC X(10).
  2198         16  PI-CLAIM-CERT-GRP.
  2199             20  PI-CLAIM-NO             PIC X(7).
  2200             20  PI-CERT-NO.
  2201                 25  PI-CERT-PRIME       PIC X(10).
  2202                 25  PI-CERT-SFX         PIC X.
  2203             20  PI-CERT-EFF-DT          PIC XX.
  2204         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2205             20  PI-PLAN-CODE            PIC X(2).
  2206             20  PI-REVISION-NUMBER      PIC X(3).
  2207             20  PI-PLAN-EFF-DT          PIC X(2).
  2208             20  PI-PLAN-EXP-DT          PIC X(2).
  2209             20  FILLER                  PIC X(11).
  2210         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  46
* EL156.cbl
  2211             20  PI-OE-REFERENCE-1.
  2212                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2213                 25  PI-OE-REF-1-SUFF    PIC XX.
  2214
  2215     12  PI-SESSION-IN-PROGRESS          PIC X.
  2216         88  CLAIM-SESSION                   VALUE '1'.
  2217         88  CREDIT-SESSION                  VALUE '2'.
  2218         88  WARRANTY-SESSION                VALUE '3'.
  2219         88  MORTGAGE-SESSION                VALUE '4'.
  2220         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2221
  2222
  2223*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2224
  2225     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2226     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2227
  2228     12  PI-CREDIT-USER                  PIC X.
  2229         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2230         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2231
  2232     12  PI-CLAIM-USER                   PIC X.
  2233         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2234         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2235
  2236     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2237         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2238         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2239         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2240         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2241         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2242
  2243     12  PI-PROCESSOR-ID                 PIC X(4).
  2244
  2245     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2246
  2247     12  PI-MEMBER-CAPTION               PIC X(10).
  2248
  2249     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2250         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2251
  2252     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2253     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2254     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2255     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2256
  2257     12  PI-AH-OVERRIDE-L1               PIC X.
  2258     12  PI-AH-OVERRIDE-L2               PIC XX.
  2259     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2260     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2261
  2262     12  PI-NEW-SYSTEM                   PIC X(2).
  2263
  2264     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2265     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2266         88  PI-USES-PAID-TO                 VALUE '1'.
  2267     12  PI-CRDTCRD-SYSTEM.
  2268         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  47
* EL156.cbl
  2269             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2270             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2271         16  PI-CC-MONTH-END-DT          PIC XX.
  2272     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2273
  2274     12  PI-OE-REFERENCE-2.
  2275         16  PI-OE-REF-2-PRIME           PIC X(10).
  2276         16  PI-OE-REF-2-SUFF            PIC X.
  2277
  2278     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2279
  2280     12  PI-LANGUAGE-TYPE                PIC X.
  2281             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2282             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2283             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2284
  2285     12  PI-POLICY-LINKAGE-IND           PIC X.
  2286         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2287         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2288                                                   LOW-VALUES.
  2289
  2290     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2291     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2292         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2293         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2294
  2295     12  PI-PROCESSOR-CSR-IND            PIC X.
  2296         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2297         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2298
  2299     12  FILLER                          PIC X(3).
  2300
  2301     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2302
  2303     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2304         PI-SYSTEM-LEVEL.
  2305
  2306         16  PI-ENTRY-CODES.
  2307             20  PI-ENTRY-CD-1           PIC X.
  2308             20  PI-ENTRY-CD-2           PIC X.
  2309
  2310         16  PI-RETURN-CODES.
  2311             20  PI-RETURN-CD-1          PIC X.
  2312             20  PI-RETURN-CD-2          PIC X.
  2313
  2314         16  PI-UPDATE-STATUS-SAVE.
  2315             20  PI-UPDATE-BY            PIC X(4).
  2316             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2317
  2318         16  PI-LOWER-CASE-LETTERS       PIC X.
  2319             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2320
  2321*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2322*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2323*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2324
  2325         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2326             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  48
* EL156.cbl
  2327             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2328             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2329             88  ACCNT-CNTL                  VALUE '3'.
  2330             88  CARR-ACCNT-CNTL             VALUE '4'.
  2331
  2332         16  PI-PROCESSOR-CAP-LIST.
  2333             20  PI-SYSTEM-CONTROLS.
  2334                24 PI-SYSTEM-DISPLAY     PIC X.
  2335                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2336                24 PI-SYSTEM-MODIFY      PIC X.
  2337                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2338             20  FILLER                  PIC XX.
  2339             20  PI-DISPLAY-CAP          PIC X.
  2340                 88  DISPLAY-CAP             VALUE 'Y'.
  2341             20  PI-MODIFY-CAP           PIC X.
  2342                 88  MODIFY-CAP              VALUE 'Y'.
  2343             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2344                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2345             20  PI-FORCE-CAP            PIC X.
  2346                 88  FORCE-CAP               VALUE 'Y'.
  2347
  2348         16  PI-PROGRAM-CONTROLS.
  2349             20  PI-PGM-PRINT-OPT        PIC X.
  2350             20  PI-PGM-FORMAT-OPT       PIC X.
  2351             20  PI-PGM-PROCESS-OPT      PIC X.
  2352             20  PI-PGM-TOTALS-OPT       PIC X.
  2353
  2354         16  PI-HELP-INTERFACE.
  2355             20  PI-LAST-ERROR-NO        PIC X(4).
  2356             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2357
  2358         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2359             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2360
  2361         16  PI-CR-CONTROL-IN-PROGRESS.
  2362             20  PI-CR-CARRIER           PIC X.
  2363             20  PI-CR-GROUPING          PIC X(6).
  2364             20  PI-CR-STATE             PIC XX.
  2365             20  PI-CR-ACCOUNT           PIC X(10).
  2366             20  PI-CR-FIN-RESP          PIC X(10).
  2367             20  PI-CR-TYPE              PIC X.
  2368
  2369         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2370
  2371         16  PI-CR-MONTH-END-DT          PIC XX.
  2372
  2373         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2374             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2375             88  PI-ZERO-CARRIER             VALUE '1'.
  2376             88  PI-ZERO-GROUPING            VALUE '2'.
  2377             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2378
  2379         16  PI-CARRIER-SECURITY         PIC X.
  2380             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2381
  2382         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2383             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2384             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  49
* EL156.cbl
  2385
  2386         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2387             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2388                                         INDEXED BY PI-ACCESS-NDX
  2389                                         PIC X.
  2390
  2391         16  PI-GA-BILLING-CONTROL       PIC X.
  2392             88  PI-GA-BILLING               VALUE '1'.
  2393
  2394         16  PI-MAIL-PROCESSING          PIC X.
  2395             88  PI-MAIL-YES                 VALUE 'Y'.
  2396
  2397         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2398
  2399         16  PI-AR-SYSTEM.
  2400             20  PI-AR-PROCESSING-CNTL   PIC X.
  2401                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2402             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2403             20  PI-AR-MONTH-END-DT      PIC XX.
  2404
  2405         16  PI-MP-SYSTEM.
  2406             20  PI-MORTGAGE-USER            PIC X.
  2407                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2408                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2409             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2410                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2411                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2412                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2413                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2414                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2415             20  PI-MP-MONTH-END-DT          PIC XX.
  2416             20  PI-MP-REFERENCE-NO.
  2417                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2418                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2419
  2420         16  PI-LABEL-CONTROL            PIC X(01).
  2421             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2422             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2423
  2424         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2425             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2426
  2427         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2428             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2429             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2430
  2431         16  FILLER                      PIC X(14).
  2432
  2433     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2434******************************************************************
  2435     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2436         16  PI-SAVE-FORM        PIC X(12).
  2437         16  PI-ACCT-KEY         PIC X(26).
  2438         16  PI-PAYEE-NAME       PIC X(30).
  2439         16  PI-DAILY-RATE       PIC S9(3)V99.
  2440         16  PI-MONTH-END-SAVE   PIC XX.
  2441         16  PI-BENEFIT-SAVE.
  2442             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  50
* EL156.cbl
  2443             20  PI-BEN-TYPE     PIC X.
  2444         16  PI-MANUAL-SW        PIC 9.
  2445         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2446         16  PI-PASS-SW          PIC X.
  2447         16  PI-PFKEY-USED       PIC X.
  2448         16  PI-CK-ASSIGN        PIC X.
  2449         16  PI-FATAL-COUNT      PIC 99.
  2450         16  PI-FORCE-COUNT      PIC 99.
  2451         16  PI-SAVE-INPUT.
  2452             20  PI-PMTTYPE      PIC X.
  2453             20  PI-PAYEE.
  2454                 24  PI-PAYEE-TYPE PIC X.
  2455                 24  PI-PAYEE-SEQ  PIC X.
  2456                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2457                   PI-PAYEE-SEQ    PIC S9.
  2458             20  PI-PMTNOTE1     PIC X(60).
  2459             20  PI-PMTNOTE2     PIC X(60).
  2460             20  PI-OFFLINE      PIC X.
  2461             20  PI-ECHECKNO     PIC X(7).
  2462             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2463                 28  PI-ECHECKNO-N     PIC X.
  2464                 28  PI-ECHECKNO-6     PIC X(6).
  2465             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2466                 24  PI-ECHECKNO-CR    PIC XX.
  2467                 24  PI-ECHECKNO-5     PIC X(5).
  2468             20  PI-HOLDTIL      PIC 9(6).
  2469             20  PI-EPYFROM      PIC 9(6).
  2470             20  PI-EPYTHRU      PIC 9(6).
  2471             20  PI-EDAYS        PIC S9(5).
  2472             20  PI-EPYAMT       PIC S9(7)V99.
  2473             20  PI-ERESV        PIC S9(7)V99.
  2474             20  PI-EEXPENS      PIC 9(6)V99.
  2475             20  PI-ETYPE        PIC X.
  2476             20  PI-CASH         PIC X.
  2477             20  PI-GROUPED      PIC X.
  2478             20  PI-INT-RATE     PIC S99V9(5).
  2479             20  PI-AIGFROM      PIC 9(6).
  2480             20  PI-LOAN-NO      PIC X(20).
  2481             20  PI-PROOF-DATE   PIC 9(6).
  2482             20  PI-PRINT-EOB-YN PIC X.
  2483             20  PI-PRINT-CLM-FRM-YN PIC X.
  2484             20  PI-PRINT-SURVEY-YN PIC X.
  2485             20  PI-SPECIAL-RELEASE-YN PIC X.
  2486         16  PI-SAVE-COMPUTED.
  2487             20  PI-CCHECKNO     PIC X(7).
  2488             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2489                 28  PI-CCHECKNO-N     PIC X.
  2490                 28  PI-CCHECKNO-6     PIC X(6).
  2491             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2492                 24  PI-CCHECKNO-CR    PIC XX.
  2493                 24  PI-CCHECKNO-5     PIC X(5).
  2494             20  PI-CPYFROM      PIC XX.
  2495             20  PI-CPYTHRU      PIC XX.
  2496             20  PI-CDAYS        PIC S9(5).
  2497             20  PI-CPYAMT       PIC S9(7)V99.
  2498             20  PI-CRESV        PIC 9(6)V99.
  2499             20  PI-CEXPENS      PIC 9(6)V99.
  2500             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  51
* EL156.cbl
  2501                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2502                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2503                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2504         16  PI-PREV-CLMNO       PIC X(7).
  2505         16  PI-LF-COVERAGE-TYPE PIC X.
  2506         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2507         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2508         16  PI-PROVISIONAL-IND  PIC X.
  2509             88 PI-PROV-PMT      VALUE 'P'.
  2510         16  PI-PREV-TRLR-KEY    PIC X(22).
  2511         16  PI-SPLIT-PMT-SW     PIC X.
  2512         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2513         16  PI-ACTIVITY-CODE    PIC 99.
  2514         16  PI-RESET-SW         PIC X.
  2515         16  PI-SPECIAL-BEN-SW   PIC X.
  2516             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2517         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2518         16  PI-EXP-DT           PIC XX.
  2519         16  PI-LOAN-DUE-DAY     PIC 99.
  2520         16  PI-3RD-PARTY-SW     PIC X.
  2521         16  PI-LOAN-UPDATE-SW   PIC X.
  2522
  2523         16  PI-DMD-DATA.
  2524             20  PI-SV-CERT-KEY       PIC X(21).
  2525             20  PI-SV-CERT-NO        PIC X(11).
  2526             20  PI-SV-BEN            PIC X(10).
  2527             20  PI-SV-CCN            PIC X(16).
  2528             20  PI-INTEREST-PAID-IND PIC X.
  2529                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2530             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2531             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2532             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2533             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2534         16  PI-AT-EOB-CODES.
  2535             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2536         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2537         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2538         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2539         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2540         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2541         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2542         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2543         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2544         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2545         16  PI-LF-BENEFIT-CD         PIC X(2).
  2546         16  PI-EOB-CODES-EXIST PIC X.
  2547         16  PI-SET-NOTE2-MDT   PIC X.
  2548         16  PI-VFY-2ND-BENE          PIC X.
  2549         16  PI-CLM-TYPE              PIC X.
  2550         16  PI-APPROVAL-LEVEL        PIC X.
  2551         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2552         16  PI-REAUDIT-NEEDED        PIC X.
  2553         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2554         16  PI-AH-BENEFIT-CD         PIC XX.
  2555         16  pi-ah-term               pic s999 comp-3.
  2556         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2557         16  pi-max-ext               pic 999.
  2558         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  52
* EL156.cbl
  2559         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2560         16  PI-JOINT-COV-IND         PIC X.
  2561             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2562             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2563         16  PI-JOINT-INSURED-IND     PIC X.
  2564             88  PI-JOINT-INSURED        VALUE 'Y'.
  2565             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2566*00781          16  FILLER                   PIC X(176).
  2567*052506         16  FILLER                   PIC X(161).
  2568*031808         16  FILLER                   PIC X(154).
  2569*091808         16  FILLER                   PIC X(152).
  2570*041710         16  FILLER                   PIC X(94).
  2571         16  FILLER                   PIC X(67).
  2572
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  53
* EL156.cbl
  2574*    COPY ELCJPFX.
  2575******************************************************************
  2576*                                                                *
  2577*                                                                *
  2578*                            ELCJPFX.                            *
  2579*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2580*                            VMOD=2.002                          *
  2581*                                                                *
  2582*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2583*                                                                *
  2584*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2585*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2586*        ELCNTL - CONTROL FILE                                   *
  2587*        ELMSTR - CLAIM MASTERS                                  *
  2588*        ELTRLR - ACTIVITY TRAILERS                              *
  2589*        ELCHKQ - CHECK QUE                                      *
  2590******************************************************************
  2591 01  JOURNAL-RECORD.
  2592     12  jp-date                     pic s9(5) comp-3.
  2593     12  jp-time                     pic s9(7) comp-3.
  2594     12  JP-USER-ID                  PIC X(4).
  2595     12  JP-FILE-ID                  PIC X(8).
  2596     12  JP-PROGRAM-ID               PIC X(8).
  2597     12  JP-RECORD-TYPE              PIC X.
  2598         88 JP-ADD              VALUE 'A'.
  2599         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2600         88 JP-AFTER-CHANGE     VALUE 'C'.
  2601         88 JP-DELETE           VALUE 'D'.
  2602         88 JP-GENERIC-DELETE   VALUE 'G'.
  2603         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2604         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2605     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2606     12  JP-RECORD-AREA
  2607
  2608
  2609                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  54
* EL156.cbl
  2611*    COPY ELCAID.
  2612******************************************************************
  2613*                                                                *
  2614*                            ELCAID.                             *
  2615*                            VMOD=2.001                          *
  2616*                                                                *
  2617*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2618*                                                                *
  2619*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2620*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2621******************************************************************
  2622
  2623 01  DFHAID.
  2624   02  DFHNULL   PIC  X  VALUE  ' '.
  2625   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2626   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2627   02  DFHPEN    PIC  X  VALUE  '='.
  2628   02  DFHOPID   PIC  X  VALUE  'W'.
  2629   02  DFHPA1    PIC  X  VALUE  '%'.
  2630   02  DFHPA2    PIC  X  VALUE  '>'.
  2631   02  DFHPA3    PIC  X  VALUE  ','.
  2632   02  DFHPF1    PIC  X  VALUE  '1'.
  2633   02  DFHPF2    PIC  X  VALUE  '2'.
  2634   02  DFHPF3    PIC  X  VALUE  '3'.
  2635   02  DFHPF4    PIC  X  VALUE  '4'.
  2636   02  DFHPF5    PIC  X  VALUE  '5'.
  2637   02  DFHPF6    PIC  X  VALUE  '6'.
  2638   02  DFHPF7    PIC  X  VALUE  '7'.
  2639   02  DFHPF8    PIC  X  VALUE  '8'.
  2640   02  DFHPF9    PIC  X  VALUE  '9'.
  2641   02  DFHPF10   PIC  X  VALUE  ':'.
  2642   02  DFHPF11   PIC  X  VALUE  '#'.
  2643   02  DFHPF12   PIC  X  VALUE  '@'.
  2644   02  DFHPF13   PIC  X  VALUE  'A'.
  2645   02  DFHPF14   PIC  X  VALUE  'B'.
  2646   02  DFHPF15   PIC  X  VALUE  'C'.
  2647   02  DFHPF16   PIC  X  VALUE  'D'.
  2648   02  DFHPF17   PIC  X  VALUE  'E'.
  2649   02  DFHPF18   PIC  X  VALUE  'F'.
  2650   02  DFHPF19   PIC  X  VALUE  'G'.
  2651   02  DFHPF20   PIC  X  VALUE  'H'.
  2652   02  DFHPF21   PIC  X  VALUE  'I'.
  2653*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2654   02  DFHPF22   PIC  X  VALUE  '['.
  2655   02  DFHPF23   PIC  X  VALUE  '.'.
  2656   02  DFHPF24   PIC  X  VALUE  '<'.
  2657   02  DFHMSRE   PIC  X  VALUE  'X'.
  2658   02  DFHSTRF   PIC  X  VALUE  'h'.
  2659   02  DFHTRIG   PIC  X  VALUE  '"'.
  2660 01  FILLER    REDEFINES DFHAID.
  2661     12  FILLER              PIC X(8).
  2662     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  55
* EL156.cbl
  2664*    COPY EL156S.
  2665 01  EL156AI.
  2666     05  FILLER            PIC  X(0012).
  2667*    -------------------------------
  2668     05  RUNDTEAL PIC S9(0004) COMP.
  2669     05  RUNDTEAF PIC  X(0001).
  2670     05  FILLER REDEFINES RUNDTEAF.
  2671         10  RUNDTEAA PIC  X(0001).
  2672     05  RUNDTEAI PIC  X(0008).
  2673*    -------------------------------
  2674     05  RUNTIMAL PIC S9(0004) COMP.
  2675     05  RUNTIMAF PIC  X(0001).
  2676     05  FILLER REDEFINES RUNTIMAF.
  2677         10  RUNTIMAA PIC  X(0001).
  2678     05  RUNTIMAI PIC  X(0005).
  2679*    -------------------------------
  2680     05  SEQUL PIC S9(0004) COMP.
  2681     05  SEQUF PIC  X(0001).
  2682     05  FILLER REDEFINES SEQUF.
  2683         10  SEQUA PIC  X(0001).
  2684     05  SEQUI PIC  X(0010).
  2685*    -------------------------------
  2686     05  CLMNOL PIC S9(0004) COMP.
  2687     05  CLMNOF PIC  X(0001).
  2688     05  FILLER REDEFINES CLMNOF.
  2689         10  CLMNOA PIC  X(0001).
  2690     05  CLMNOI PIC  X(0007).
  2691*    -------------------------------
  2692     05  CARRL PIC S9(0004) COMP.
  2693     05  CARRF PIC  X(0001).
  2694     05  FILLER REDEFINES CARRF.
  2695         10  CARRA PIC  X(0001).
  2696     05  CARRI PIC  X(0001).
  2697*    -------------------------------
  2698     05  CERTNOL PIC S9(0004) COMP.
  2699     05  CERTNOF PIC  X(0001).
  2700     05  FILLER REDEFINES CERTNOF.
  2701         10  CERTNOA PIC  X(0001).
  2702     05  CERTNOI PIC  X(0010).
  2703*    -------------------------------
  2704     05  SUFXL PIC S9(0004) COMP.
  2705     05  SUFXF PIC  X(0001).
  2706     05  FILLER REDEFINES SUFXF.
  2707         10  SUFXA PIC  X(0001).
  2708     05  SUFXI PIC  X(0001).
  2709*    -------------------------------
  2710     05  CLMTYPL PIC S9(0004) COMP.
  2711     05  CLMTYPF PIC  X(0001).
  2712     05  FILLER REDEFINES CLMTYPF.
  2713         10  CLMTYPA PIC  X(0001).
  2714     05  CLMTYPI PIC  X(0006).
  2715*    -------------------------------
  2716     05  CLMSTATL PIC S9(0004) COMP.
  2717     05  CLMSTATF PIC  X(0001).
  2718     05  FILLER REDEFINES CLMSTATF.
  2719         10  CLMSTATA PIC  X(0001).
  2720     05  CLMSTATI PIC  X(0006).
  2721*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  56
* EL156.cbl
  2722     05  LSTNMEL PIC S9(0004) COMP.
  2723     05  LSTNMEF PIC  X(0001).
  2724     05  FILLER REDEFINES LSTNMEF.
  2725         10  LSTNMEA PIC  X(0001).
  2726     05  LSTNMEI PIC  X(0015).
  2727*    -------------------------------
  2728     05  FSTNMEL PIC S9(0004) COMP.
  2729     05  FSTNMEF PIC  X(0001).
  2730     05  FILLER REDEFINES FSTNMEF.
  2731         10  FSTNMEA PIC  X(0001).
  2732     05  FSTNMEI PIC  X(0012).
  2733*    -------------------------------
  2734     05  MINITL PIC S9(0004) COMP.
  2735     05  MINITF PIC  X(0001).
  2736     05  FILLER REDEFINES MINITF.
  2737         10  MINITA PIC  X(0001).
  2738     05  MINITI PIC  X(0001).
  2739*    -------------------------------
  2740     05  PRIMHDGL PIC S9(0004) COMP.
  2741     05  PRIMHDGF PIC  X(0001).
  2742     05  FILLER REDEFINES PRIMHDGF.
  2743         10  PRIMHDGA PIC  X(0001).
  2744     05  PRIMHDGI PIC  X(0012).
  2745*    -------------------------------
  2746     05  PCERTNOL PIC S9(0004) COMP.
  2747     05  PCERTNOF PIC  X(0001).
  2748     05  FILLER REDEFINES PCERTNOF.
  2749         10  PCERTNOA PIC  X(0001).
  2750     05  PCERTNOI PIC  X(0010).
  2751*    -------------------------------
  2752     05  PSUFXL PIC S9(0004) COMP.
  2753     05  PSUFXF PIC  X(0001).
  2754     05  FILLER REDEFINES PSUFXF.
  2755         10  PSUFXA PIC  X(0001).
  2756     05  PSUFXI PIC  X(0001).
  2757*    -------------------------------
  2758     05  STATUSL PIC S9(0004) COMP.
  2759     05  STATUSF PIC  X(0001).
  2760     05  FILLER REDEFINES STATUSF.
  2761         10  STATUSA PIC  X(0001).
  2762     05  STATUSI PIC  X(0010).
  2763*    -------------------------------
  2764     05  LOANHL PIC S9(0004) COMP.
  2765     05  LOANHF PIC  X(0001).
  2766     05  FILLER REDEFINES LOANHF.
  2767         10  LOANHA PIC  X(0001).
  2768     05  LOANHI PIC  X(0014).
  2769*    -------------------------------
  2770     05  LOANNOL PIC S9(0004) COMP.
  2771     05  LOANNOF PIC  X(0001).
  2772     05  FILLER REDEFINES LOANNOF.
  2773         10  LOANNOA PIC  X(0001).
  2774     05  LOANNOI PIC  X(0025).
  2775*    -------------------------------
  2776     05  DUEDAYHL PIC S9(0004) COMP.
  2777     05  DUEDAYHF PIC  X(0001).
  2778     05  FILLER REDEFINES DUEDAYHF.
  2779         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  57
* EL156.cbl
  2780     05  DUEDAYHI PIC  X(0008).
  2781*    -------------------------------
  2782     05  DUEDAYL PIC S9(0004) COMP.
  2783     05  DUEDAYF PIC  X(0001).
  2784     05  FILLER REDEFINES DUEDAYF.
  2785         10  DUEDAYA PIC  X(0001).
  2786     05  DUEDAYI PIC  X(0002).
  2787*    -------------------------------
  2788     05  ZINTHL PIC S9(0004) COMP.
  2789     05  ZINTHF PIC  X(0001).
  2790     05  FILLER REDEFINES ZINTHF.
  2791         10  ZINTHA PIC  X(0001).
  2792     05  ZINTHI PIC  X(0009).
  2793*    -------------------------------
  2794     05  ZINTL PIC S9(0004) COMP.
  2795     05  ZINTF PIC  X(0001).
  2796     05  FILLER REDEFINES ZINTF.
  2797         10  ZINTA PIC  X(0001).
  2798     05  ZINTI PIC  99V99999.
  2799*    -------------------------------
  2800     05  PTHRHDGL PIC S9(0004) COMP.
  2801     05  PTHRHDGF PIC  X(0001).
  2802     05  FILLER REDEFINES PTHRHDGF.
  2803         10  PTHRHDGA PIC  X(0001).
  2804     05  PTHRHDGI PIC  X(0014).
  2805*    -------------------------------
  2806     05  PDTHRUL PIC S9(0004) COMP.
  2807     05  PDTHRUF PIC  X(0001).
  2808     05  FILLER REDEFINES PDTHRUF.
  2809         10  PDTHRUA PIC  X(0001).
  2810     05  PDTHRUI PIC  X(0008).
  2811*    -------------------------------
  2812     05  TOTPAIDL PIC S9(0004) COMP.
  2813     05  TOTPAIDF PIC  X(0001).
  2814     05  FILLER REDEFINES TOTPAIDF.
  2815         10  TOTPAIDA PIC  X(0001).
  2816     05  TOTPAIDI PIC  X(0010).
  2817*    -------------------------------
  2818     05  COVERL PIC S9(0004) COMP.
  2819     05  COVERF PIC  X(0001).
  2820     05  FILLER REDEFINES COVERF.
  2821         10  COVERA PIC  X(0001).
  2822     05  COVERI PIC  X(0010).
  2823*    -------------------------------
  2824     05  INCURL PIC S9(0004) COMP.
  2825     05  INCURF PIC  X(0001).
  2826     05  FILLER REDEFINES INCURF.
  2827         10  INCURA PIC  X(0001).
  2828     05  INCURI PIC  X(0008).
  2829*    -------------------------------
  2830     05  LSTDTEL PIC S9(0004) COMP.
  2831     05  LSTDTEF PIC  X(0001).
  2832     05  FILLER REDEFINES LSTDTEF.
  2833         10  LSTDTEA PIC  X(0001).
  2834     05  LSTDTEI PIC  X(0008).
  2835*    -------------------------------
  2836     05  CRTSTATL PIC S9(0004) COMP.
  2837     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  58
* EL156.cbl
  2838     05  FILLER REDEFINES CRTSTATF.
  2839         10  CRTSTATA PIC  X(0001).
  2840     05  CRTSTATI PIC  X(0010).
  2841*    -------------------------------
  2842     05  EFFECTL PIC S9(0004) COMP.
  2843     05  EFFECTF PIC  X(0001).
  2844     05  FILLER REDEFINES EFFECTF.
  2845         10  EFFECTA PIC  X(0001).
  2846     05  EFFECTI PIC  X(0008).
  2847*    -------------------------------
  2848     05  TERMSL PIC S9(0004) COMP.
  2849     05  TERMSF PIC  X(0001).
  2850     05  FILLER REDEFINES TERMSF.
  2851         10  TERMSA PIC  X(0001).
  2852     05  TERMSI PIC  X(0011).
  2853*    -------------------------------
  2854     05  STACCTL PIC S9(0004) COMP.
  2855     05  STACCTF PIC  X(0001).
  2856     05  FILLER REDEFINES STACCTF.
  2857         10  STACCTA PIC  X(0001).
  2858     05  STACCTI PIC  X(0013).
  2859*    -------------------------------
  2860     05  EXPDTEHL PIC S9(0004) COMP.
  2861     05  EXPDTEHF PIC  X(0001).
  2862     05  FILLER REDEFINES EXPDTEHF.
  2863         10  EXPDTEHA PIC  X(0001).
  2864     05  EXPDTEHI PIC  X(0014).
  2865*    -------------------------------
  2866     05  EXPDTEL PIC S9(0004) COMP.
  2867     05  EXPDTEF PIC  X(0001).
  2868     05  FILLER REDEFINES EXPDTEF.
  2869         10  EXPDTEA PIC  X(0001).
  2870     05  EXPDTEI PIC  X(0008).
  2871*    -------------------------------
  2872     05  BENECAPL PIC S9(0004) COMP.
  2873     05  BENECAPF PIC  X(0001).
  2874     05  FILLER REDEFINES BENECAPF.
  2875         10  BENECAPA PIC  X(0001).
  2876     05  BENECAPI PIC  X(0013).
  2877*    -------------------------------
  2878     05  BENEL PIC S9(0004) COMP.
  2879     05  BENEF PIC  X(0001).
  2880     05  FILLER REDEFINES BENEF.
  2881         10  BENEA PIC  X(0001).
  2882     05  BENEI PIC  X(0009).
  2883*    -------------------------------
  2884     05  FORMTYPL PIC S9(0004) COMP.
  2885     05  FORMTYPF PIC  X(0001).
  2886     05  FILLER REDEFINES FORMTYPF.
  2887         10  FORMTYPA PIC  X(0001).
  2888     05  FORMTYPI PIC  X(0001).
  2889*    -------------------------------
  2890     05  PMTTYPEL PIC S9(0004) COMP.
  2891     05  PMTTYPEF PIC  X(0001).
  2892     05  FILLER REDEFINES PMTTYPEF.
  2893         10  PMTTYPEA PIC  X(0001).
  2894     05  PMTTYPEI PIC  X(0001).
  2895*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  59
* EL156.cbl
  2896     05  PAYEEL PIC S9(0004) COMP.
  2897     05  PAYEEF PIC  X(0001).
  2898     05  FILLER REDEFINES PAYEEF.
  2899         10  PAYEEA PIC  X(0001).
  2900     05  PAYEEI PIC  X(0002).
  2901*    -------------------------------
  2902     05  CHECKNOL PIC S9(0004) COMP.
  2903     05  CHECKNOF PIC  X(0001).
  2904     05  FILLER REDEFINES CHECKNOF.
  2905         10  CHECKNOA PIC  X(0001).
  2906     05  CHECKNOI PIC  X(0007).
  2907*    -------------------------------
  2908     05  OFFLINEL PIC S9(0004) COMP.
  2909     05  OFFLINEF PIC  X(0001).
  2910     05  FILLER REDEFINES OFFLINEF.
  2911         10  OFFLINEA PIC  X(0001).
  2912     05  OFFLINEI PIC  X(0001).
  2913*    -------------------------------
  2914     05  HOLDTILL PIC S9(0004) COMP.
  2915     05  HOLDTILF PIC  X(0001).
  2916     05  FILLER REDEFINES HOLDTILF.
  2917         10  HOLDTILA PIC  X(0001).
  2918     05  HOLDTILI PIC  X(0008).
  2919*    -------------------------------
  2920     05  NOTE1L PIC S9(0004) COMP.
  2921     05  NOTE1F PIC  X(0001).
  2922     05  FILLER REDEFINES NOTE1F.
  2923         10  NOTE1A PIC  X(0001).
  2924     05  NOTE1I PIC  X(0060).
  2925*    -------------------------------
  2926     05  NOTE2L PIC S9(0004) COMP.
  2927     05  NOTE2F PIC  X(0001).
  2928     05  FILLER REDEFINES NOTE2F.
  2929         10  NOTE2A PIC  X(0001).
  2930     05  NOTE2I PIC  X(0060).
  2931*    -------------------------------
  2932     05  EOBYNL PIC S9(0004) COMP.
  2933     05  EOBYNF PIC  X(0001).
  2934     05  FILLER REDEFINES EOBYNF.
  2935         10  EOBYNA PIC  X(0001).
  2936     05  EOBYNI PIC  X(0001).
  2937*    -------------------------------
  2938     05  CLMFMYNL PIC S9(0004) COMP.
  2939     05  CLMFMYNF PIC  X(0001).
  2940     05  FILLER REDEFINES CLMFMYNF.
  2941         10  CLMFMYNA PIC  X(0001).
  2942     05  CLMFMYNI PIC  X(0001).
  2943*    -------------------------------
  2944     05  SURVYYNL PIC S9(0004) COMP.
  2945     05  SURVYYNF PIC  X(0001).
  2946     05  FILLER REDEFINES SURVYYNF.
  2947         10  SURVYYNA PIC  X(0001).
  2948     05  SURVYYNI PIC  X(0001).
  2949*    -------------------------------
  2950     05  SPRELYNL PIC S9(0004) COMP.
  2951     05  SPRELYNF PIC  X(0001).
  2952     05  FILLER REDEFINES SPRELYNF.
  2953         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  60
* EL156.cbl
  2954     05  SPRELYNI PIC  X(0001).
  2955*    -------------------------------
  2956     05  PINTHL PIC S9(0004) COMP.
  2957     05  PINTHF PIC  X(0001).
  2958     05  FILLER REDEFINES PINTHF.
  2959         10  PINTHA PIC  X(0001).
  2960     05  PINTHI PIC  X(0004).
  2961*    -------------------------------
  2962     05  PINTL PIC S9(0004) COMP.
  2963     05  PINTF PIC  X(0001).
  2964     05  FILLER REDEFINES PINTF.
  2965         10  PINTA PIC  X(0001).
  2966     05  PINTI PIC  X(0008).
  2967*    -------------------------------
  2968     05  PROOFDTL PIC S9(0004) COMP.
  2969     05  PROOFDTF PIC  X(0001).
  2970     05  FILLER REDEFINES PROOFDTF.
  2971         10  PROOFDTA PIC  X(0001).
  2972     05  PROOFDTI PIC  X(0008).
  2973*    -------------------------------
  2974     05  AIGFRMHL PIC S9(0004) COMP.
  2975     05  AIGFRMHF PIC  X(0001).
  2976     05  FILLER REDEFINES AIGFRMHF.
  2977         10  AIGFRMHA PIC  X(0001).
  2978     05  AIGFRMHI PIC  X(0012).
  2979*    -------------------------------
  2980     05  AIGFROML PIC S9(0004) COMP.
  2981     05  AIGFROMF PIC  X(0001).
  2982     05  FILLER REDEFINES AIGFROMF.
  2983         10  AIGFROMA PIC  X(0001).
  2984     05  AIGFROMI PIC  X(0008).
  2985*    -------------------------------
  2986     05  PMTHDGAL PIC S9(0004) COMP.
  2987     05  PMTHDGAF PIC  X(0001).
  2988     05  FILLER REDEFINES PMTHDGAF.
  2989         10  PMTHDGAA PIC  X(0001).
  2990     05  PMTHDGAI PIC  X(0066).
  2991*    -------------------------------
  2992     05  EPYFROML PIC S9(0004) COMP.
  2993     05  EPYFROMF PIC  X(0001).
  2994     05  FILLER REDEFINES EPYFROMF.
  2995         10  EPYFROMA PIC  X(0001).
  2996     05  EPYFROMI PIC  X(0008).
  2997*    -------------------------------
  2998     05  EPYTHRUL PIC S9(0004) COMP.
  2999     05  EPYTHRUF PIC  X(0001).
  3000     05  FILLER REDEFINES EPYTHRUF.
  3001         10  EPYTHRUA PIC  X(0001).
  3002     05  EPYTHRUI PIC  X(0008).
  3003*    -------------------------------
  3004     05  EDAYSL PIC S9(0004) COMP.
  3005     05  EDAYSF PIC  X(0001).
  3006     05  FILLER REDEFINES EDAYSF.
  3007         10  EDAYSA PIC  X(0001).
  3008     05  EDAYSI PIC  S9(6).
  3009*    -------------------------------
  3010     05  EPYAMTL PIC S9(0004) COMP.
  3011     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  61
* EL156.cbl
  3012     05  FILLER REDEFINES EPYAMTF.
  3013         10  EPYAMTA PIC  X(0001).
  3014     05  EPYAMTI PIC  S9(8)V99.
  3015*    -------------------------------
  3016     05  ERESVL PIC S9(0004) COMP.
  3017     05  ERESVF PIC  X(0001).
  3018     05  FILLER REDEFINES ERESVF.
  3019         10  ERESVA PIC  X(0001).
  3020     05  ERESVI PIC  S9(7)V99.
  3021*    -------------------------------
  3022     05  ETYPEL PIC S9(0004) COMP.
  3023     05  ETYPEF PIC  X(0001).
  3024     05  FILLER REDEFINES ETYPEF.
  3025         10  ETYPEA PIC  X(0001).
  3026     05  ETYPEI PIC  X(0001).
  3027*    -------------------------------
  3028     05  EEXPENSL PIC S9(0004) COMP.
  3029     05  EEXPENSF PIC  X(0001).
  3030     05  FILLER REDEFINES EEXPENSF.
  3031         10  EEXPENSA PIC  X(0001).
  3032     05  EEXPENSI PIC  9(6)V99.
  3033*    -------------------------------
  3034     05  CPYFROML PIC S9(0004) COMP.
  3035     05  CPYFROMF PIC  X(0001).
  3036     05  FILLER REDEFINES CPYFROMF.
  3037         10  CPYFROMA PIC  X(0001).
  3038     05  CPYFROMI PIC  X(0008).
  3039*    -------------------------------
  3040     05  CPYTHRUL PIC S9(0004) COMP.
  3041     05  CPYTHRUF PIC  X(0001).
  3042     05  FILLER REDEFINES CPYTHRUF.
  3043         10  CPYTHRUA PIC  X(0001).
  3044     05  CPYTHRUI PIC  X(0008).
  3045*    -------------------------------
  3046     05  CDAYSL PIC S9(0004) COMP.
  3047     05  CDAYSF PIC  X(0001).
  3048     05  FILLER REDEFINES CDAYSF.
  3049         10  CDAYSA PIC  X(0001).
  3050     05  CDAYSI PIC  9(6).
  3051*    -------------------------------
  3052     05  CPYAMTL PIC S9(0004) COMP.
  3053     05  CPYAMTF PIC  X(0001).
  3054     05  FILLER REDEFINES CPYAMTF.
  3055         10  CPYAMTA PIC  X(0001).
  3056     05  CPYAMTI PIC  S9(8)V99.
  3057*    -------------------------------
  3058     05  CRESVL PIC S9(0004) COMP.
  3059     05  CRESVF PIC  X(0001).
  3060     05  FILLER REDEFINES CRESVF.
  3061         10  CRESVA PIC  X(0001).
  3062     05  CRESVI PIC  9(6)V99.
  3063*    -------------------------------
  3064     05  CEXPENSL PIC S9(0004) COMP.
  3065     05  CEXPENSF PIC  X(0001).
  3066     05  FILLER REDEFINES CEXPENSF.
  3067         10  CEXPENSA PIC  X(0001).
  3068     05  CEXPENSI PIC  9(6)V99.
  3069*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  62
* EL156.cbl
  3070     05  ERRMSG0L PIC S9(0004) COMP.
  3071     05  ERRMSG0F PIC  X(0001).
  3072     05  FILLER REDEFINES ERRMSG0F.
  3073         10  ERRMSG0A PIC  X(0001).
  3074     05  ERRMSG0I PIC  X(0072).
  3075*    -------------------------------
  3076     05  ERRMSG1L PIC S9(0004) COMP.
  3077     05  ERRMSG1F PIC  X(0001).
  3078     05  FILLER REDEFINES ERRMSG1F.
  3079         10  ERRMSG1A PIC  X(0001).
  3080     05  ERRMSG1I PIC  X(0072).
  3081*    -------------------------------
  3082     05  ERRMSG2L PIC S9(0004) COMP.
  3083     05  ERRMSG2F PIC  X(0001).
  3084     05  FILLER REDEFINES ERRMSG2F.
  3085         10  ERRMSG2A PIC  X(0001).
  3086     05  ERRMSG2I PIC  X(0072).
  3087*    -------------------------------
  3088     05  ENTERPFL PIC S9(0004) COMP.
  3089     05  ENTERPFF PIC  X(0001).
  3090     05  FILLER REDEFINES ENTERPFF.
  3091         10  ENTERPFA PIC  X(0001).
  3092     05  ENTERPFI PIC  99.
  3093*    -------------------------------
  3094     05  PF6TITL PIC S9(0004) COMP.
  3095     05  PF6TITF PIC  X(0001).
  3096     05  FILLER REDEFINES PF6TITF.
  3097         10  PF6TITA PIC  X(0001).
  3098     05  PF6TITI PIC  X(0016).
  3099 01  EL156AO REDEFINES EL156AI.
  3100     05  FILLER            PIC  X(0012).
  3101*    -------------------------------
  3102     05  FILLER            PIC  X(0003).
  3103     05  RUNDTEAO PIC  X(0008).
  3104*    -------------------------------
  3105     05  FILLER            PIC  X(0003).
  3106     05  RUNTIMAO PIC  99.99.
  3107*    -------------------------------
  3108     05  FILLER            PIC  X(0003).
  3109     05  SEQUO PIC  X(0010).
  3110*    -------------------------------
  3111     05  FILLER            PIC  X(0003).
  3112     05  CLMNOO PIC  X(0007).
  3113*    -------------------------------
  3114     05  FILLER            PIC  X(0003).
  3115     05  CARRO PIC  X(0001).
  3116*    -------------------------------
  3117     05  FILLER            PIC  X(0003).
  3118     05  CERTNOO PIC  X(0010).
  3119*    -------------------------------
  3120     05  FILLER            PIC  X(0003).
  3121     05  SUFXO PIC  X(0001).
  3122*    -------------------------------
  3123     05  FILLER            PIC  X(0003).
  3124     05  CLMTYPO PIC  X(0006).
  3125*    -------------------------------
  3126     05  FILLER            PIC  X(0003).
  3127     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  63
* EL156.cbl
  3128*    -------------------------------
  3129     05  FILLER            PIC  X(0003).
  3130     05  LSTNMEO PIC  X(0015).
  3131*    -------------------------------
  3132     05  FILLER            PIC  X(0003).
  3133     05  FSTNMEO PIC  X(0012).
  3134*    -------------------------------
  3135     05  FILLER            PIC  X(0003).
  3136     05  MINITO PIC  X(0001).
  3137*    -------------------------------
  3138     05  FILLER            PIC  X(0003).
  3139     05  PRIMHDGO PIC  X(0012).
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  PCERTNOO PIC  X(0010).
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  PSUFXO PIC  X(0001).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  STATUSO PIC  X(0010).
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  LOANHO PIC  X(0014).
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  LOANNOO PIC  X(0025).
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  DUEDAYHO PIC  X(0008).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  DUEDAYO PIC  X(0002).
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  ZINTHO PIC  X(0009).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  ZINTO PIC  9.99999.
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  PTHRHDGO PIC  X(0014).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  PDTHRUO PIC  X(0008).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  TOTPAIDO PIC  Z(6).99-.
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  COVERO PIC  X(0010).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  INCURO PIC  X(0008).
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  LSTDTEO PIC  X(0008).
  3185*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  64
* EL156.cbl
  3186     05  FILLER            PIC  X(0003).
  3187     05  CRTSTATO PIC  X(0010).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  EFFECTO PIC  X(0008).
  3191*    -------------------------------
  3192     05  FILLER            PIC  X(0003).
  3193     05  TERMSO PIC  X(0011).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  STACCTO PIC  X(0013).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  EXPDTEHO PIC  X(0014).
  3200*    -------------------------------
  3201     05  FILLER            PIC  X(0003).
  3202     05  EXPDTEO PIC  X(0008).
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  BENECAPO PIC  X(0013).
  3206*    -------------------------------
  3207     05  FILLER            PIC  X(0003).
  3208     05  BENEO PIC  Z(6).99.
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  FORMTYPO PIC  X(0001).
  3212*    -------------------------------
  3213     05  FILLER            PIC  X(0003).
  3214     05  PMTTYPEO PIC  X(0001).
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  PAYEEO PIC  X(0002).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  CHECKNOO PIC  X(0007).
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  OFFLINEO PIC  X(0001).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  HOLDTILO PIC  99B99B99.
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  NOTE1O PIC  X(0060).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  NOTE2O PIC  X(0060).
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  EOBYNO PIC  X(0001).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
  3238     05  CLMFMYNO PIC  X(0001).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  SURVYYNO PIC  X(0001).
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  65
* EL156.cbl
  3244     05  SPRELYNO PIC  X(0001).
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  PINTHO PIC  X(0004).
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
  3250     05  PINTO PIC  Z,ZZ9.99.
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  PROOFDTO PIC  99B99B99.
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  AIGFRMHO PIC  X(0012).
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
  3259     05  AIGFROMO PIC  99B99B99.
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  PMTHDGAO PIC  X(0066).
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
  3265     05  EPYFROMO PIC  99B99B99.
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  EPYTHRUO PIC  99B99B99.
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
  3271     05  EDAYSO PIC  Z(4)9-.
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  EPYAMTO PIC  Z(6).99-.
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  ERESVO PIC  Z(5).99-.
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  ETYPEO PIC  X(0001).
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  EEXPENSO PIC  Z(5).99.
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  CPYFROMO PIC  99B99B99.
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  CPYTHRUO PIC  99B99B99.
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  CDAYSO PIC  Z(4)9-.
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  CPYAMTO PIC  Z(6).99-.
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  CRESVO PIC  Z(5).99.
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  66
* EL156.cbl
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  ERRMSG0O PIC  X(0072).
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  ERRMSG1O PIC  X(0072).
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  ERRMSG2O PIC  X(0072).
  3311*    -------------------------------
  3312     05  FILLER            PIC  X(0003).
  3313     05  ENTERPFO PIC  X(0002).
  3314*    -------------------------------
  3315     05  FILLER            PIC  X(0003).
  3316     05  PF6TITO PIC  X(0016).
  3317*    -------------------------------
  3318 01  EL156BI REDEFINES EL156AI.
  3319     05  FILLER            PIC  X(0012).
  3320*    -------------------------------
  3321     05  RUNDTEBL PIC S9(0004) COMP.
  3322     05  RUNDTEBF PIC  X(0001).
  3323     05  FILLER REDEFINES RUNDTEBF.
  3324         10  RUNDTEBA PIC  X(0001).
  3325     05  RUNDTEBI PIC  X(0008).
  3326*    -------------------------------
  3327     05  RUNTIMBL PIC S9(0004) COMP.
  3328     05  RUNTIMBF PIC  X(0001).
  3329     05  FILLER REDEFINES RUNTIMBF.
  3330         10  RUNTIMBA PIC  X(0001).
  3331     05  RUNTIMBI PIC  X(0005).
  3332*    -------------------------------
  3333     05  PAYDTBL PIC S9(0004) COMP.
  3334     05  PAYDTBF PIC  X(0001).
  3335     05  FILLER REDEFINES PAYDTBF.
  3336         10  PAYDTBA PIC  X(0001).
  3337     05  PAYDTBI PIC  X(0008).
  3338*    -------------------------------
  3339     05  PAYTYPBL PIC S9(0004) COMP.
  3340     05  PAYTYPBF PIC  X(0001).
  3341     05  FILLER REDEFINES PAYTYPBF.
  3342         10  PAYTYPBA PIC  X(0001).
  3343     05  PAYTYPBI PIC  X(0015).
  3344*    -------------------------------
  3345     05  PAYAMTBL PIC S9(0004) COMP.
  3346     05  PAYAMTBF PIC  X(0001).
  3347     05  FILLER REDEFINES PAYAMTBF.
  3348         10  PAYAMTBA PIC  X(0001).
  3349     05  PAYAMTBI PIC  X(0011).
  3350*    -------------------------------
  3351     05  LOANHBL PIC S9(0004) COMP.
  3352     05  LOANHBF PIC  X(0001).
  3353     05  FILLER REDEFINES LOANHBF.
  3354         10  LOANHBA PIC  X(0001).
  3355     05  LOANHBI PIC  X(0012).
  3356*    -------------------------------
  3357     05  LOANNBL PIC S9(0004) COMP.
  3358     05  LOANNBF PIC  X(0001).
  3359     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  67
* EL156.cbl
  3360         10  LOANNBA PIC  X(0001).
  3361     05  LOANNBI PIC  X(0025).
  3362*    -------------------------------
  3363     05  CKNUMHDL PIC S9(0004) COMP.
  3364     05  CKNUMHDF PIC  X(0001).
  3365     05  FILLER REDEFINES CKNUMHDF.
  3366         10  CKNUMHDA PIC  X(0001).
  3367     05  CKNUMHDI PIC  X(0012).
  3368*    -------------------------------
  3369     05  CKNUMBL PIC S9(0004) COMP.
  3370     05  CKNUMBF PIC  X(0001).
  3371     05  FILLER REDEFINES CKNUMBF.
  3372         10  CKNUMBA PIC  X(0001).
  3373     05  CKNUMBI PIC  X(0007).
  3374*    -------------------------------
  3375     05  AGTHDGL PIC S9(0004) COMP.
  3376     05  AGTHDGF PIC  X(0001).
  3377     05  FILLER REDEFINES AGTHDGF.
  3378         10  AGTHDGA PIC  X(0001).
  3379     05  AGTHDGI PIC  X(0016).
  3380*    -------------------------------
  3381     05  NAMEBL PIC S9(0004) COMP.
  3382     05  NAMEBF PIC  X(0001).
  3383     05  FILLER REDEFINES NAMEBF.
  3384         10  NAMEBA PIC  X(0001).
  3385     05  NAMEBI PIC  X(0030).
  3386*    -------------------------------
  3387     05  NAMEB2L PIC S9(0004) COMP.
  3388     05  NAMEB2F PIC  X(0001).
  3389     05  FILLER REDEFINES NAMEB2F.
  3390         10  NAMEB2A PIC  X(0001).
  3391     05  NAMEB2I PIC  X(0030).
  3392*    -------------------------------
  3393     05  ADDR1BL PIC S9(0004) COMP.
  3394     05  ADDR1BF PIC  X(0001).
  3395     05  FILLER REDEFINES ADDR1BF.
  3396         10  ADDR1BA PIC  X(0001).
  3397     05  ADDR1BI PIC  X(0030).
  3398*    -------------------------------
  3399     05  ADDR1B2L PIC S9(0004) COMP.
  3400     05  ADDR1B2F PIC  X(0001).
  3401     05  FILLER REDEFINES ADDR1B2F.
  3402         10  ADDR1B2A PIC  X(0001).
  3403     05  ADDR1B2I PIC  X(0030).
  3404*    -------------------------------
  3405     05  ADDR2BL PIC S9(0004) COMP.
  3406     05  ADDR2BF PIC  X(0001).
  3407     05  FILLER REDEFINES ADDR2BF.
  3408         10  ADDR2BA PIC  X(0001).
  3409     05  ADDR2BI PIC  X(0030).
  3410*    -------------------------------
  3411     05  ADDR2B2L PIC S9(0004) COMP.
  3412     05  ADDR2B2F PIC  X(0001).
  3413     05  FILLER REDEFINES ADDR2B2F.
  3414         10  ADDR2B2A PIC  X(0001).
  3415     05  ADDR2B2I PIC  X(0030).
  3416*    -------------------------------
  3417     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  68
* EL156.cbl
  3418     05  CITYSTBF PIC  X(0001).
  3419     05  FILLER REDEFINES CITYSTBF.
  3420         10  CITYSTBA PIC  X(0001).
  3421     05  CITYSTBI PIC  X(0030).
  3422*    -------------------------------
  3423     05  CITYST2L PIC S9(0004) COMP.
  3424     05  CITYST2F PIC  X(0001).
  3425     05  FILLER REDEFINES CITYST2F.
  3426         10  CITYST2A PIC  X(0001).
  3427     05  CITYST2I PIC  X(0030).
  3428*    -------------------------------
  3429     05  ZIPBL PIC S9(0004) COMP.
  3430     05  ZIPBF PIC  X(0001).
  3431     05  FILLER REDEFINES ZIPBF.
  3432         10  ZIPBA PIC  X(0001).
  3433     05  ZIPBI PIC  X(0009).
  3434*    -------------------------------
  3435     05  ZIPB2L PIC S9(0004) COMP.
  3436     05  ZIPB2F PIC  X(0001).
  3437     05  FILLER REDEFINES ZIPB2F.
  3438         10  ZIPB2A PIC  X(0001).
  3439     05  ZIPB2I PIC  X(0009).
  3440*    -------------------------------
  3441     05  INTHDBL PIC S9(0004) COMP.
  3442     05  INTHDBF PIC  X(0001).
  3443     05  FILLER REDEFINES INTHDBF.
  3444         10  INTHDBA PIC  X(0001).
  3445     05  INTHDBI PIC  X(0012).
  3446*    -------------------------------
  3447     05  INTAMTBL PIC S9(0004) COMP.
  3448     05  INTAMTBF PIC  X(0001).
  3449     05  FILLER REDEFINES INTAMTBF.
  3450         10  INTAMTBA PIC  X(0001).
  3451     05  INTAMTBI PIC  X(0011).
  3452*    -------------------------------
  3453     05  PMTHDGBL PIC S9(0004) COMP.
  3454     05  PMTHDGBF PIC  X(0001).
  3455     05  FILLER REDEFINES PMTHDGBF.
  3456         10  PMTHDGBA PIC  X(0001).
  3457     05  PMTHDGBI PIC  X(0034).
  3458*    -------------------------------
  3459     05  CLMNOBL PIC S9(0004) COMP.
  3460     05  CLMNOBF PIC  X(0001).
  3461     05  FILLER REDEFINES CLMNOBF.
  3462         10  CLMNOBA PIC  X(0001).
  3463     05  CLMNOBI PIC  X(0007).
  3464*    -------------------------------
  3465     05  CARRBL PIC S9(0004) COMP.
  3466     05  CARRBF PIC  X(0001).
  3467     05  FILLER REDEFINES CARRBF.
  3468         10  CARRBA PIC  X(0001).
  3469     05  CARRBI PIC  X(0001).
  3470*    -------------------------------
  3471     05  CERTNOBL PIC S9(0004) COMP.
  3472     05  CERTNOBF PIC  X(0001).
  3473     05  FILLER REDEFINES CERTNOBF.
  3474         10  CERTNOBA PIC  X(0001).
  3475     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  69
* EL156.cbl
  3476*    -------------------------------
  3477     05  SUFXBL PIC S9(0004) COMP.
  3478     05  SUFXBF PIC  X(0001).
  3479     05  FILLER REDEFINES SUFXBF.
  3480         10  SUFXBA PIC  X(0001).
  3481     05  SUFXBI PIC  X(0001).
  3482*    -------------------------------
  3483     05  CLMTYPBL PIC S9(0004) COMP.
  3484     05  CLMTYPBF PIC  X(0001).
  3485     05  FILLER REDEFINES CLMTYPBF.
  3486         10  CLMTYPBA PIC  X(0001).
  3487     05  CLMTYPBI PIC  X(0006).
  3488*    -------------------------------
  3489     05  INCURBL PIC S9(0004) COMP.
  3490     05  INCURBF PIC  X(0001).
  3491     05  FILLER REDEFINES INCURBF.
  3492         10  INCURBA PIC  X(0001).
  3493     05  INCURBI PIC  X(0008).
  3494*    -------------------------------
  3495     05  PYFROMBL PIC S9(0004) COMP.
  3496     05  PYFROMBF PIC  X(0001).
  3497     05  FILLER REDEFINES PYFROMBF.
  3498         10  PYFROMBA PIC  X(0001).
  3499     05  PYFROMBI PIC  X(0008).
  3500*    -------------------------------
  3501     05  PYTHRUBL PIC S9(0004) COMP.
  3502     05  PYTHRUBF PIC  X(0001).
  3503     05  FILLER REDEFINES PYTHRUBF.
  3504         10  PYTHRUBA PIC  X(0001).
  3505     05  PYTHRUBI PIC  X(0008).
  3506*    -------------------------------
  3507     05  DAYSBL PIC S9(0004) COMP.
  3508     05  DAYSBF PIC  X(0001).
  3509     05  FILLER REDEFINES DAYSBF.
  3510         10  DAYSBA PIC  X(0001).
  3511     05  DAYSBI PIC  X(0005).
  3512*    -------------------------------
  3513     05  BYBL PIC S9(0004) COMP.
  3514     05  BYBF PIC  X(0001).
  3515     05  FILLER REDEFINES BYBF.
  3516         10  BYBA PIC  X(0001).
  3517     05  BYBI PIC  X(0004).
  3518*    -------------------------------
  3519     05  PROOFDBL PIC S9(0004) COMP.
  3520     05  PROOFDBF PIC  X(0001).
  3521     05  FILLER REDEFINES PROOFDBF.
  3522         10  PROOFDBA PIC  X(0001).
  3523     05  PROOFDBI PIC  X(0008).
  3524*    -------------------------------
  3525     05  ACCTBL PIC S9(0004) COMP.
  3526     05  ACCTBF PIC  X(0001).
  3527     05  FILLER REDEFINES ACCTBF.
  3528         10  ACCTBA PIC  X(0001).
  3529     05  ACCTBI PIC  X(0010).
  3530*    -------------------------------
  3531     05  STATEBL PIC S9(0004) COMP.
  3532     05  STATEBF PIC  X(0001).
  3533     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  70
* EL156.cbl
  3534         10  STATEBA PIC  X(0001).
  3535     05  STATEBI PIC  X(0002).
  3536*    -------------------------------
  3537     05  GROUPBL PIC S9(0004) COMP.
  3538     05  GROUPBF PIC  X(0001).
  3539     05  FILLER REDEFINES GROUPBF.
  3540         10  GROUPBA PIC  X(0001).
  3541     05  GROUPBI PIC  X(0006).
  3542*    -------------------------------
  3543     05  ACARRBL PIC S9(0004) COMP.
  3544     05  ACARRBF PIC  X(0001).
  3545     05  FILLER REDEFINES ACARRBF.
  3546         10  ACARRBA PIC  X(0001).
  3547     05  ACARRBI PIC  X(0001).
  3548*    -------------------------------
  3549     05  ACCTNMBL PIC S9(0004) COMP.
  3550     05  ACCTNMBF PIC  X(0001).
  3551     05  FILLER REDEFINES ACCTNMBF.
  3552         10  ACCTNMBA PIC  X(0001).
  3553     05  ACCTNMBI PIC  X(0030).
  3554*    -------------------------------
  3555     05  UNDISBL PIC S9(0004) COMP.
  3556     05  UNDISBF PIC  X(0001).
  3557     05  FILLER REDEFINES UNDISBF.
  3558         10  UNDISBA PIC  X(0001).
  3559     05  UNDISBI PIC  X(0010).
  3560*    -------------------------------
  3561     05  RATEBL PIC S9(0004) COMP.
  3562     05  RATEBF PIC  X(0001).
  3563     05  FILLER REDEFINES RATEBF.
  3564         10  RATEBA PIC  X(0001).
  3565     05  RATEBI PIC  X(0006).
  3566*    -------------------------------
  3567     05  ERMSG1BL PIC S9(0004) COMP.
  3568     05  ERMSG1BF PIC  X(0001).
  3569     05  FILLER REDEFINES ERMSG1BF.
  3570         10  ERMSG1BA PIC  X(0001).
  3571     05  ERMSG1BI PIC  X(0072).
  3572*    -------------------------------
  3573     05  ENTPFBL PIC S9(0004) COMP.
  3574     05  ENTPFBF PIC  X(0001).
  3575     05  FILLER REDEFINES ENTPFBF.
  3576         10  ENTPFBA PIC  X(0001).
  3577     05  ENTPFBI PIC  99.
  3578 01  EL156BO REDEFINES EL156AI.
  3579     05  FILLER            PIC  X(0012).
  3580*    -------------------------------
  3581     05  FILLER            PIC  X(0003).
  3582     05  RUNDTEBO PIC  X(0008).
  3583*    -------------------------------
  3584     05  FILLER            PIC  X(0003).
  3585     05  RUNTIMBO PIC  99.99.
  3586*    -------------------------------
  3587     05  FILLER            PIC  X(0003).
  3588     05  PAYDTBO PIC  99B99B99.
  3589*    -------------------------------
  3590     05  FILLER            PIC  X(0003).
  3591     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  71
* EL156.cbl
  3592*    -------------------------------
  3593     05  FILLER            PIC  X(0003).
  3594     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3595*    -------------------------------
  3596     05  FILLER            PIC  X(0003).
  3597     05  LOANHBO PIC  X(0012).
  3598*    -------------------------------
  3599     05  FILLER            PIC  X(0003).
  3600     05  LOANNBO PIC  X(0025).
  3601*    -------------------------------
  3602     05  FILLER            PIC  X(0003).
  3603     05  CKNUMHDO PIC  X(0012).
  3604*    -------------------------------
  3605     05  FILLER            PIC  X(0003).
  3606     05  CKNUMBO PIC  X(0007).
  3607*    -------------------------------
  3608     05  FILLER            PIC  X(0003).
  3609     05  AGTHDGO PIC  X(0016).
  3610*    -------------------------------
  3611     05  FILLER            PIC  X(0003).
  3612     05  NAMEBO PIC  X(0030).
  3613*    -------------------------------
  3614     05  FILLER            PIC  X(0003).
  3615     05  NAMEB2O PIC  X(0030).
  3616*    -------------------------------
  3617     05  FILLER            PIC  X(0003).
  3618     05  ADDR1BO PIC  X(0030).
  3619*    -------------------------------
  3620     05  FILLER            PIC  X(0003).
  3621     05  ADDR1B2O PIC  X(0030).
  3622*    -------------------------------
  3623     05  FILLER            PIC  X(0003).
  3624     05  ADDR2BO PIC  X(0030).
  3625*    -------------------------------
  3626     05  FILLER            PIC  X(0003).
  3627     05  ADDR2B2O PIC  X(0030).
  3628*    -------------------------------
  3629     05  FILLER            PIC  X(0003).
  3630     05  CITYSTBO PIC  X(0030).
  3631*    -------------------------------
  3632     05  FILLER            PIC  X(0003).
  3633     05  CITYST2O PIC  X(0030).
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  ZIPBO PIC  ZZZZ99999.
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  ZIPB2O PIC  ZZZZZZZZZ.
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  INTHDBO PIC  X(0012).
  3643*    -------------------------------
  3644     05  FILLER            PIC  X(0003).
  3645     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  PMTHDGBO PIC  X(0034).
  3649*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  72
* EL156.cbl
  3650     05  FILLER            PIC  X(0003).
  3651     05  CLMNOBO PIC  X(0007).
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  CARRBO PIC  X(0001).
  3655*    -------------------------------
  3656     05  FILLER            PIC  X(0003).
  3657     05  CERTNOBO PIC  X(0010).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  SUFXBO PIC  X(0001).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  CLMTYPBO PIC  X(0006).
  3664*    -------------------------------
  3665     05  FILLER            PIC  X(0003).
  3666     05  INCURBO PIC  X(0008).
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  PYFROMBO PIC  99B99B99.
  3670*    -------------------------------
  3671     05  FILLER            PIC  X(0003).
  3672     05  PYTHRUBO PIC  99B99B99.
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  DAYSBO PIC  X(0005).
  3676*    -------------------------------
  3677     05  FILLER            PIC  X(0003).
  3678     05  BYBO PIC  X(0004).
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  PROOFDBO PIC  99B99B99.
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  ACCTBO PIC  X(0010).
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  STATEBO PIC  X(0002).
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  GROUPBO PIC  X(0006).
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  ACARRBO PIC  X(0001).
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  ACCTNMBO PIC  X(0030).
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  UNDISBO PIC  ZZZ,Z99.99.
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
  3702     05  RATEBO PIC  ZZZ.99.
  3703*    -------------------------------
  3704     05  FILLER            PIC  X(0003).
  3705     05  ERMSG1BO PIC  X(0072).
  3706*    -------------------------------
  3707     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  73
* EL156.cbl
  3708     05  ENTPFBO PIC  X(0002).
  3709*    -------------------------------
  3710****************************************************************
  3711*
  3712* Copyright (c) 2007 by Clerity Solutions, Inc.
  3713* All rights reserved.
  3714*
  3715****************************************************************
  3716 01  DFHEIV.
  3717   02  DFHEIV0               PIC X(35).
  3718   02  DFHEIV1               PIC X(08).
  3719   02  DFHEIV2               PIC X(08).
  3720   02  DFHEIV3               PIC X(08).
  3721   02  DFHEIV4               PIC X(06).
  3722   02  DFHEIV5               PIC X(04).
  3723   02  DFHEIV6               PIC X(04).
  3724   02  DFHEIV7               PIC X(02).
  3725   02  DFHEIV8               PIC X(02).
  3726   02  DFHEIV9               PIC X(01).
  3727   02  DFHEIV10              PIC S9(7) COMP-3.
  3728   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3729   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3730   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3731   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3732   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3733   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3734   02  DFHEIV17              PIC X(04).
  3735   02  DFHEIV18              PIC X(04).
  3736   02  DFHEIV19              PIC X(04).
  3737   02  DFHEIV20              USAGE IS POINTER.
  3738   02  DFHEIV21              USAGE IS POINTER.
  3739   02  DFHEIV22              USAGE IS POINTER.
  3740   02  DFHEIV23              USAGE IS POINTER.
  3741   02  DFHEIV24              USAGE IS POINTER.
  3742   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3743   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3744   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3745   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3746   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3747   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3748   02  FILLER                PIC X(02).
  3749   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3750   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3751   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3752   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3753   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3754 LINKAGE  SECTION.
  3755*****************************************************************
  3756*                                                               *
  3757* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3758* All rights reserved.                                          *
  3759*                                                               *
  3760*****************************************************************
  3761 01  dfheiblk.
  3762     02  eibtime          pic s9(7) comp-3.
  3763     02  eibdate          pic s9(7) comp-3.
  3764     02  eibtrnid         pic x(4).
  3765     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  74
* EL156.cbl
  3766     02  eibtrmid         pic x(4).
  3767     02  dfheigdi         pic s9(4) comp.
  3768     02  eibcposn         pic s9(4) comp.
  3769     02  eibcalen         pic s9(4) comp.
  3770     02  eibaid           pic x(1).
  3771     02  eibfiller1       pic x(1).
  3772     02  eibfn            pic x(2).
  3773     02  eibfiller2       pic x(2).
  3774     02  eibrcode         pic x(6).
  3775     02  eibfiller3       pic x(2).
  3776     02  eibds            pic x(8).
  3777     02  eibreqid         pic x(8).
  3778     02  eibrsrce         pic x(8).
  3779     02  eibsync          pic x(1).
  3780     02  eibfree          pic x(1).
  3781     02  eibrecv          pic x(1).
  3782     02  eibsend          pic x(1).
  3783     02  eibatt           pic x(1).
  3784     02  eibeoc           pic x(1).
  3785     02  eibfmh           pic x(1).
  3786     02  eibcompl         pic x(1).
  3787     02  eibsig           pic x(1).
  3788     02  eibconf          pic x(1).
  3789     02  eiberr           pic x(1).
  3790     02  eibrldbk         pic x(1).
  3791     02  eiberrcd         pic x(4).
  3792     02  eibsynrb         pic x(1).
  3793     02  eibnodat         pic x(1).
  3794     02  eibfiller5       pic x(2).
  3795     02  eibresp          pic 9(09) comp.
  3796     02  eibresp2         pic 9(09) comp.
  3797     02  dfheigdj         pic s9(4) comp.
  3798     02  dfheigdk         pic s9(4) comp.
  3799 01  DFHCOMMAREA             PIC X(1024).
  3800
  3801*    COPY ELCMSTR.
  3802******************************************************************
  3803*                                                                *
  3804*                            ELCMSTR.                            *
  3805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3806*                            VMOD=2.012                          *
  3807*                                                                *
  3808*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3809*                                                                *
  3810*   FILE TYPE = VSAM,KSDS                                        *
  3811*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3812*                                                                *
  3813*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3814*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3815*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3816*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3817*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3818*                                                 RKP=75,LEN=21  *
  3819*                                                                *
  3820*   **** NOTE ****                                               *
  3821*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3822*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3823*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  75
* EL156.cbl
  3824*   LOG = YES                                                    *
  3825*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3826******************************************************************
  3827*                   C H A N G E   L O G
  3828*
  3829* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3830*-----------------------------------------------------------------
  3831*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3832* EFFECTIVE    NUMBER
  3833*-----------------------------------------------------------------
  3834* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3835* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3836* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3837* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3838* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3839******************************************************************
  3840 01  CLAIM-MASTER.
  3841     12  CL-RECORD-ID                PIC XX.
  3842         88  VALID-CL-ID         VALUE 'CL'.
  3843
  3844     12  CL-CONTROL-PRIMARY.
  3845         16  CL-COMPANY-CD           PIC X.
  3846         16  CL-CARRIER              PIC X.
  3847         16  CL-CLAIM-NO             PIC X(7).
  3848         16  CL-CERT-NO.
  3849             20  CL-CERT-PRIME       PIC X(10).
  3850             20  CL-CERT-SFX         PIC X.
  3851
  3852     12  CL-CONTROL-BY-NAME.
  3853         16  CL-COMPANY-CD-A1        PIC X.
  3854         16  CL-INSURED-LAST-NAME    PIC X(15).
  3855         16  CL-INSURED-NAME.
  3856             20  CL-INSURED-1ST-NAME PIC X(12).
  3857             20  CL-INSURED-MID-INIT PIC X.
  3858
  3859     12  CL-CONTROL-BY-SSN.
  3860         16  CL-COMPANY-CD-A2        PIC X.
  3861         16  CL-SOC-SEC-NO.
  3862             20  CL-SSN-STATE        PIC XX.
  3863             20  CL-SSN-ACCOUNT      PIC X(6).
  3864             20  CL-SSN-LN3          PIC X(3).
  3865
  3866     12  CL-CONTROL-BY-CERT-NO.
  3867         16  CL-COMPANY-CD-A4        PIC X.
  3868         16  CL-CERT-NO-A4.
  3869             20  CL-CERT-A4-PRIME    PIC X(10).
  3870             20  CL-CERT-A4-SFX      PIC X.
  3871
  3872     12  CL-CONTROL-BY-CCN.
  3873         16  CL-COMPANY-CD-A5        PIC X.
  3874         16  CL-CCN-A5.
  3875             20  CL-CCN.
  3876                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3877                 24  CL-CCN-PRIME-A5 PIC X(12).
  3878             20  CL-CCN-FILLER-A5    PIC X(4).
  3879
  3880     12  CL-INSURED-PROFILE-DATA.
  3881         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  76
* EL156.cbl
  3882         16  CL-INSURED-SEX-CD       PIC X.
  3883             88  INSURED-IS-MALE        VALUE 'M'.
  3884             88  INSURED-IS-FEMALE      VALUE 'F'.
  3885             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3886         16  CL-INSURED-OCC-CD       PIC X(6).
  3887         16  FILLER                  PIC X(5).
  3888
  3889     12  CL-PROCESSING-INFO.
  3890         16  CL-PROCESSOR-ID         PIC X(4).
  3891         16  CL-CLAIM-STATUS         PIC X.
  3892             88  CLAIM-IS-OPEN          VALUE 'O'.
  3893             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3894         16  CL-CLAIM-TYPE           PIC X.
  3895*            88  AH-CLAIM               VALUE 'A'.
  3896*            88  LIFE-CLAIM             VALUE 'L'.
  3897*            88  PROPERTY-CLAIM         VALUE 'P'.
  3898*            88  IUI-CLAIM              VALUE 'I'.
  3899*            88  GAP-CLAIM              VALUE 'G'.
  3900*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3901         16  CL-CLAIM-PREM-TYPE      PIC X.
  3902             88  SINGLE-PREMIUM         VALUE '1'.
  3903             88  O-B-COVERAGE           VALUE '2'.
  3904             88  OPEN-END-COVERAGE      VALUE '3'.
  3905         16  CL-INCURRED-DT          PIC XX.
  3906         16  CL-REPORTED-DT          PIC XX.
  3907         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3908         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3909         16  CL-LAST-PMT-DT          PIC XX.
  3910         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3911         16  CL-PAID-THRU-DT         PIC XX.
  3912         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3913         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3914         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3915         16  CL-PMT-CALC-METHOD      PIC X.
  3916             88  CL-360-DAY-YR          VALUE '1'.
  3917             88  CL-365-DAY-YR          VALUE '2'.
  3918             88  CL-FULL-MONTHS         VALUE '3'.
  3919         16  CL-CAUSE-CD             PIC X(6).
  3920
  3921         16  CL-PRIME-CERT-NO.
  3922             20  CL-PRIME-CERT-PRIME PIC X(10).
  3923             20  CL-PRIME-CERT-SFX   PIC X.
  3924
  3925         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3926             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3927             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3928
  3929         16  CL-MICROFILM-NO         PIC X(10).
  3930         16  FILLER REDEFINES CL-MICROFILM-NO.
  3931             20  CL-BENEFIT-PERIOD   PIC 99.
  3932             20  FILLER              PIC X(8).
  3933         16  CL-PROG-FORM-TYPE       PIC X.
  3934         16  CL-LAST-ADD-ON-DT       PIC XX.
  3935
  3936         16  CL-LAST-REOPEN-DT       PIC XX.
  3937         16  CL-LAST-CLOSE-DT        PIC XX.
  3938         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3939             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  77
* EL156.cbl
  3940             88  CLAIM-DENIED           VALUE '2'.
  3941             88  AUTO-CLOSE             VALUE '3'.
  3942             88  MANUAL-CLOSE           VALUE '4'.
  3943             88  BENEFITS-CHANGED       VALUE 'C'.
  3944             88  SETUP-ERRORS           VALUE 'E'.
  3945         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3946         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3947         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3948             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3949         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3950         16  FILLER                  PIC X.
  3951
  3952     12  CL-CERTIFICATE-DATA.
  3953         16  CL-CERT-ORIGIN          PIC X.
  3954             88  CERT-WAS-ONLINE        VALUE '1'.
  3955             88  CERT-WAS-CREATED       VALUE '2'.
  3956             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3957         16  CL-CERT-KEY-DATA.
  3958             20  CL-CERT-CARRIER     PIC X.
  3959             20  CL-CERT-GROUPING    PIC X(6).
  3960             20  CL-CERT-STATE       PIC XX.
  3961             20  CL-CERT-ACCOUNT.
  3962                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3963                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3964             20  CL-CERT-EFF-DT      PIC XX.
  3965
  3966     12  CL-STATUS-CONTROLS.
  3967         16  CL-PRIORITY-CD          PIC X.
  3968             88  CONFIDENTIAL-DATA      VALUE '8'.
  3969             88  HIGHEST-PRIORITY       VALUE '9'.
  3970         16  CL-SUPV-ATTN-CD         PIC X.
  3971             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3972             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3973         16  CL-PURGED-DT            PIC XX.
  3974         16  CL-RESTORED-DT          PIC XX.
  3975         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3976         16  CL-NEXT-RESEND-DT       PIC XX.
  3977         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3978         16  CL-CRITICAL-PERIOD      PIC 99.
  3979*        16  FILLER                  PIC XX.
  3980         16  CL-LAST-MAINT-DT        PIC XX.
  3981         16  CL-LAST-MAINT-USER      PIC X(4).
  3982         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3983         16  CL-LAST-MAINT-TYPE      PIC X.
  3984             88  CLAIM-SET-UP           VALUE ' '.
  3985             88  PAYMENT-MADE           VALUE '1'.
  3986             88  LETTER-SENT            VALUE '2'.
  3987             88  MASTER-WAS-ALTERED     VALUE '3'.
  3988             88  MASTER-WAS-RESTORED    VALUE '4'.
  3989             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3990             88  FILE-CONVERTED         VALUE '6'.
  3991             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3992             88  ERROR-CORRECTION       VALUE 'E'.
  3993         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3994         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3995         16  CL-BENEFICIARY          PIC X(10).
  3996         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3997         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  78
* EL156.cbl
  3998             88  CL-TYPE-DENIAL          VALUE '1'.
  3999             88  CL-TYPE-RESCISSION      VALUE '2'.
  4000             88  CL-TYPE-REFORMATION     VALUE '3'.
  4001             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4002             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4003         16  filler                  pic x(5).
  4004*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4005*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4006*        16  CL-RTW-DT               PIC XX.
  4007
  4008     12  CL-TRAILER-CONTROLS.
  4009         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4010             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4011             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4012             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4013         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4014         16  FILLER                  PIC XX.
  4015         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4016         16  CL-ADDRESS-TRAILER-CNT.
  4017             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4018                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4019             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4020                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4021             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4022                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4023             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4024                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4025             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4026                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4027             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4028                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4029             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4030                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4031
  4032     12  CL-CV-REFERENCE-NO.
  4033         16  CL-CV-REFNO-PRIME       PIC X(18).
  4034         16  CL-CV-REFNO-SFX         PIC XX.
  4035
  4036     12  CL-FILE-LOCATION            PIC X(4).
  4037
  4038     12  CL-PROCESS-ERRORS.
  4039         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4040             88  NO-FATAL-ERRORS        VALUE ZERO.
  4041         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4042             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4043
  4044     12  CL-PRODUCT-CD               PIC X.
  4045
  4046     12  CL-CURRENT-KEY-DATA.
  4047         16  CL-CURRENT-CARRIER      PIC X.
  4048         16  CL-CURRENT-GROUPING     PIC X(6).
  4049         16  CL-CURRENT-STATE        PIC XX.
  4050         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4051
  4052     12  CL-ASSOCIATES               PIC X.
  4053         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4054         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4055         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  79
* EL156.cbl
  4056         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4057
  4058     12  CL-ACTIVITY-CODE            PIC 99.
  4059     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4060     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4061
  4062     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4063     12  CL-LAG-REPORT-CODE          PIC 9.
  4064     12  CL-LOAN-TYPE                PIC XX.
  4065     12  CL-LEGAL-STATE              PIC XX.
  4066
  4067     12  CL-YESNOSW                  PIC X.
  4068     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4069         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4070         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4071         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4072     12  cl-insured-type             pic x.
  4073         88  cl-claim-on-primary         value 'P'.
  4074         88  cl-claim-on-co-borrower     value 'C'.
  4075     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  80
* EL156.cbl
  4077*    COPY ELCCNTL.
  4078******************************************************************
  4079*                                                                *
  4080*                                                                *
  4081*                            ELCCNTL.                            *
  4082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4083*                            VMOD=2.059                          *
  4084*                                                                *
  4085*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4086*                                                                *
  4087*   FILE TYPE = VSAM,KSDS                                        *
  4088*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4089*                                                                *
  4090*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4091*       ALTERNATE INDEX = NONE                                   *
  4092*                                                                *
  4093*   LOG = YES                                                    *
  4094*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4095******************************************************************
  4096*                   C H A N G E   L O G
  4097*
  4098* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4099*-----------------------------------------------------------------
  4100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4101* EFFECTIVE    NUMBER
  4102*-----------------------------------------------------------------
  4103* 082503                   PEMA  ADD BENEFIT GROUP
  4104* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4105* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4106* 092705    2005050300006  PEMA  ADD SPP LEASES
  4107* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4108* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4109* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4110* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4111* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4112* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4113* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4114* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4115* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4116* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4117******************************************************************
  4118*
  4119 01  CONTROL-FILE.
  4120     12  CF-RECORD-ID                       PIC XX.
  4121         88  VALID-CF-ID                        VALUE 'CF'.
  4122
  4123     12  CF-CONTROL-PRIMARY.
  4124         16  CF-COMPANY-ID                  PIC XXX.
  4125         16  CF-RECORD-TYPE                 PIC X.
  4126             88  CF-COMPANY-MASTER              VALUE '1'.
  4127             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4128             88  CF-STATE-MASTER                VALUE '3'.
  4129             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4130             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4131             88  CF-CARRIER-MASTER              VALUE '6'.
  4132             88  CF-MORTALITY-MASTER            VALUE '7'.
  4133             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4134             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  81
* EL156.cbl
  4135             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4136             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4137             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4138             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4139             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4140             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4141             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4142             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4143             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4144         16  CF-ACCESS-CD-GENL              PIC X(4).
  4145         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4146             20  CF-PROCESSOR               PIC X(4).
  4147         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4148             20  CF-STATE-CODE              PIC XX.
  4149             20  FILLER                     PIC XX.
  4150         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4151             20  FILLER                     PIC XX.
  4152             20  CF-HI-BEN-IN-REC           PIC XX.
  4153         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4154             20  FILLER                     PIC XXX.
  4155             20  CF-CARRIER-CNTL            PIC X.
  4156         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4157             20  FILLER                     PIC XX.
  4158             20  CF-HI-TYPE-IN-REC          PIC 99.
  4159         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4160             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4161                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4162             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4163             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4164         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4165             20  FILLER                     PIC X.
  4166             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4167         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4168             20  FILLER                     PIC XX.
  4169             20  CF-MORTGAGE-PLAN           PIC XX.
  4170         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4171
  4172     12  CF-LAST-MAINT-DT                   PIC XX.
  4173     12  CF-LAST-MAINT-BY                   PIC X(4).
  4174     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4175
  4176     12  CF-RECORD-BODY                     PIC X(728).
  4177
  4178
  4179****************************************************************
  4180*             COMPANY MASTER RECORD                            *
  4181****************************************************************
  4182
  4183     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4184         16  CF-COMPANY-ADDRESS.
  4185             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4186             20  CF-CL-IN-CARE-OF           PIC X(30).
  4187             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4188             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4189             20  CF-CL-CITY-STATE           PIC X(30).
  4190             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4191             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4192         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  82
* EL156.cbl
  4193         16  CF-COMPANY-PASSWORD            PIC X(8).
  4194         16  CF-SECURITY-OPTION             PIC X.
  4195             88  ALL-SECURITY                   VALUE '1'.
  4196             88  COMPANY-VERIFY                 VALUE '2'.
  4197             88  PROCESSOR-VERIFY               VALUE '3'.
  4198             88  NO-SECURITY                    VALUE '4'.
  4199             88  ALL-BUT-TERM                   VALUE '5'.
  4200         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4201             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4202         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4203             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4204         16  CF-INFORCE-LOCATION            PIC X.
  4205             88  CERTS-ARE-ONLINE               VALUE '1'.
  4206             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4207             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4208         16  CF-LOWER-CASE-LETTERS          PIC X.
  4209         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4210             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4211             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4212             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4213             88  CF-ACCNT-CNTL                  VALUE '3'.
  4214             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4215
  4216         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4217         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4218
  4219         16  CF-LGX-CREDIT-USER             PIC X.
  4220             88  CO-IS-NOT-USER                 VALUE 'N'.
  4221             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4222
  4223         16 CF-CREDIT-CALC-CODES.
  4224             20  CF-CR-REM-TERM-CALC PIC X.
  4225               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4226               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4227               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4228               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4229               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4230               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4231               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4232             20  CF-CR-R78-METHOD           PIC X.
  4233               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4234               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4235
  4236         16  CF-CLAIM-CONTROL-COUNTS.
  4237             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4238                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4239
  4240             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4241                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4242
  4243             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4244                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4245
  4246             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4247                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4248
  4249         16  CF-CURRENT-MONTH-END           PIC XX.
  4250
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  83
* EL156.cbl
  4251         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4252             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4253             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4254             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4255             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4256                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4257                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4258             20  CF-CO-PREM-REJECT-SW       PIC X.
  4259                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4260                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4261             20  CF-CO-REF-REJECT-SW        PIC X.
  4262                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4263                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4264
  4265         16  CF-CO-REPORTING-DT             PIC XX.
  4266         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4267         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4268           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4269           88  CF-CO-MONTH-END                  VALUE '1'.
  4270
  4271         16  CF-LGX-CLAIM-USER              PIC X.
  4272             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4273             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4274
  4275         16  CF-CREDIT-EDIT-CONTROLS.
  4276             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4277             20  CF-MIN-AGE                 PIC 99.
  4278             20  CF-DEFAULT-AGE             PIC 99.
  4279             20  CF-MIN-TERM                PIC S999      COMP-3.
  4280             20  CF-MAX-TERM                PIC S999      COMP-3.
  4281             20  CF-DEFAULT-SEX             PIC X.
  4282             20  CF-JOINT-AGE-INPUT         PIC X.
  4283                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4284             20  CF-BIRTH-DATE-INPUT        PIC X.
  4285                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4286             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4287                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4288                 88  CF-ZERO-CARRIER            VALUE '1'.
  4289                 88  CF-ZERO-GROUPING           VALUE '2'.
  4290                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4291             20  CF-EDIT-SW                 PIC X.
  4292                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4293             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4294             20  CF-CR-PR-METHOD            PIC X.
  4295               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4296               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4297             20  FILLER                     PIC X.
  4298
  4299         16  CF-CREDIT-MISC-CONTROLS.
  4300             20  CF-REIN-TABLE-SW           PIC X.
  4301                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4302             20  CF-COMP-TABLE-SW           PIC X.
  4303                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4304             20  CF-EXPERIENCE-RETENTION-AGE
  4305                                            PIC S9        COMP-3.
  4306             20  CF-CONVERSION-DT           PIC XX.
  4307             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4308             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  84
* EL156.cbl
  4309                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4310                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4311
  4312             20  CF-CR-CHECK-NO-CONTROL.
  4313                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4314                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4315                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4316                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4317                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4318                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4319
  4320                 24  CF-CR-CHECK-COUNT       REDEFINES
  4321                     CF-CR-CHECK-COUNTER      PIC X(4).
  4322
  4323                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4324                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4325
  4326                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4327                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4328                 24  CF-MAIL-PROCESSING       PIC X.
  4329                     88  MAIL-PROCESSING          VALUE 'Y'.
  4330
  4331         16  CF-MISC-SYSTEM-CONTROL.
  4332             20  CF-SYSTEM-C                 PIC X.
  4333                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4334             20  CF-SYSTEM-D                 PIC X.
  4335                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4336             20  CF-SOC-SEC-NO-SW            PIC X.
  4337                 88  SOC-SEC-NO-USED             VALUE '1'.
  4338             20  CF-MEMBER-NO-SW             PIC X.
  4339                 88  MEMBER-NO-USED              VALUE '1'.
  4340             20  CF-TAX-ID-NUMBER            PIC X(11).
  4341             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4342             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4343                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4344                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4345                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4346                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4347             20  CF-SYSTEM-E                 PIC X.
  4348                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4349
  4350         16  CF-LGX-LIFE-USER               PIC X.
  4351             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4352             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4353
  4354         16  CF-CR-MONTH-END-DT             PIC XX.
  4355
  4356         16  CF-FILE-MAINT-DATES.
  4357             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4358                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4359             20  CF-LAST-BATCH       REDEFINES
  4360                 CF-LAST-BATCH-NO               PIC X(4).
  4361             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4362             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4363             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4364             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4365             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4366             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  85
* EL156.cbl
  4367             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4368             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4369             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4370             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4371
  4372         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4373         16  FILLER                         PIC X.
  4374
  4375         16  CF-ALT-MORT-CODE               PIC X(4).
  4376         16  CF-MEMBER-CAPTION              PIC X(10).
  4377
  4378         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4379             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4380             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4381             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4382             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4383             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4384
  4385         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4386
  4387         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4388         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4389         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4390         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4391
  4392         16  CF-AH-OVERRIDE-L1              PIC X.
  4393         16  CF-AH-OVERRIDE-L2              PIC XX.
  4394         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4395         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4396
  4397         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4398         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4399
  4400         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4401         16  CF-AR-LAST-EL860-DT            PIC XX.
  4402         16  CF-MP-MONTH-END-DT             PIC XX.
  4403
  4404         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4405         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4406             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4407
  4408         16  CF-AR-MONTH-END-DT             PIC XX.
  4409
  4410         16  CF-CRDTCRD-USER                PIC X.
  4411             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4412             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4413
  4414         16  CF-CC-MONTH-END-DT             PIC XX.
  4415
  4416         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4417
  4418         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4419             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4420             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4421             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4422         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4423         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4424         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  86
* EL156.cbl
  4425         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4426             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4427             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4428         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4429         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4430         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4431             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4432         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4433
  4434         16  CF-CL-ZIP-CODE.
  4435             20  CF-CL-ZIP-PRIME.
  4436                 24  CF-CL-ZIP-1ST          PIC X.
  4437                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4438                 24  FILLER                 PIC X(4).
  4439             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4440         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4441             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4442             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4443             20  FILLER                     PIC XXX.
  4444
  4445         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4446         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4447         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4448         16  CF-CO-OPTION-START-DATE        PIC XX.
  4449         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4450           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4451                                                      '3' '4'.
  4452           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4453           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4454           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4455           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4456           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4457           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4458
  4459         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4460
  4461         16  CF-PAYMENT-APPROVAL-LEVELS.
  4462             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4463             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4464             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4465             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4466             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4467             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4468
  4469         16  CF-END-USER-REPORTING-USER     PIC X.
  4470             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4471             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4472
  4473         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4474             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4475             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4476
  4477         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4478
  4479         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4480         16  FILLER                         PIC X.
  4481
  4482         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  87
* EL156.cbl
  4483             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4484             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4485             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4486
  4487         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4488
  4489         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4490             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4491             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4492
  4493         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4494             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4495             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4496
  4497         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4498
  4499         16  CF-CO-ACH-ID-CODE              PIC  X.
  4500             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4501             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4502             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4503         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4504         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4505         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4506         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4507         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4508         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4509         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4510         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4511         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4512                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4513         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4514                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4515
  4516         16  CF-CO-OVER-SHORT.
  4517             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4518             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4519
  4520*         16  FILLER                         PIC X(102).
  4521         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4522             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4523             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4524
  4525         16  CF-AH-APPROVAL-DAYS.
  4526             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4527             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4528             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4529             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4530
  4531         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4532
  4533         16  CF-APPROV-LEV-5.
  4534             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4535             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4536             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4537
  4538         16  FILLER                         PIC X(68).
  4539****************************************************************
  4540*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  88
* EL156.cbl
  4541****************************************************************
  4542
  4543     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4544         16  CF-PROCESSOR-NAME              PIC X(30).
  4545         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4546         16  CF-PROCESSOR-TITLE             PIC X(26).
  4547         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4548                 88  MESSAGE-YES                VALUE 'Y'.
  4549                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4550
  4551*****************************************************
  4552****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4553****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4554****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4555****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4556*****************************************************
  4557
  4558         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4559             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4560             20  CF-APPLICATION-FORCE       PIC X.
  4561             20  CF-INDIVIDUAL-APP.
  4562                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4563                     28  CF-BROWSE-APP      PIC X.
  4564                     28  CF-UPDATE-APP      PIC X.
  4565
  4566         16  CF-CURRENT-TERM-ON             PIC X(4).
  4567         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4568             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4569             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4570             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4571             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4572             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4573             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4574             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4575         16  CF-PROCESSOR-CARRIER           PIC X.
  4576             88  NO-CARRIER-SECURITY            VALUE ' '.
  4577         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4578             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4579         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4580             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4581         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4582             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4583
  4584         16  CF-PROC-SYS-ACCESS-SW.
  4585             20  CF-PROC-CREDIT-CLAIMS-SW.
  4586                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4587                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4588                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4589                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4590             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4591                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4592                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4593             20  CF-PROC-LIFE-GNRLDGR-SW.
  4594                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4595                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4596                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4597                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4598             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  89
* EL156.cbl
  4599                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4600                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4601         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4602             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4603             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4604         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4605
  4606         16  CF-APPROVAL-LEVEL                  PIC X.
  4607             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4608             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4609             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4610             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4611             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4612
  4613         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4614
  4615         16  CF-LANGUAGE-TYPE                   PIC X.
  4616             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4617             88  CF-LANG-IS-FR                      VALUE 'F'.
  4618
  4619         16  CF-CSR-IND                         PIC X.
  4620         16  FILLER                             PIC X(239).
  4621
  4622****************************************************************
  4623*             PROCESSOR/REMINDERS RECORD                       *
  4624****************************************************************
  4625
  4626     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4627         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4628             20  CF-START-REMIND-DT         PIC XX.
  4629             20  CF-END-REMIND-DT           PIC XX.
  4630             20  CF-REMINDER-TEXT           PIC X(50).
  4631         16  FILLER                         PIC X(296).
  4632
  4633
  4634****************************************************************
  4635*             STATE MASTER RECORD                              *
  4636****************************************************************
  4637
  4638     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4639         16  CF-STATE-ABBREVIATION          PIC XX.
  4640         16  CF-STATE-NAME                  PIC X(25).
  4641         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4642         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4643             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4644             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4645             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4646             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4647                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4648                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4649             20  CF-ST-PREM-REJECT-SW       PIC X.
  4650                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4651                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4652             20  CF-ST-REF-REJECT-SW        PIC X.
  4653                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4654                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4655         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4656         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  90
* EL156.cbl
  4657         16  CF-ST-REFUND-RULES.
  4658             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4659             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4660             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4661         16  CF-ST-FST-PMT-EXTENSION.
  4662             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4663             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4664                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4665                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4666                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4667                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4668         16  CF-ST-STATE-CALL.
  4669             20  CF-ST-CALL-UNEARNED        PIC X.
  4670             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4671             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4672         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4673             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4674             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4675         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4676         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4677         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4678         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4679         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4680         16  FILLER                         PIC X.
  4681         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4682             20  CF-ST-BENEFIT-CD           PIC XX.
  4683             20  CF-ST-BENEFIT-KIND         PIC X.
  4684                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4685                 88  CF-ST-AH-KIND              VALUE 'A'.
  4686             20  CF-ST-REM-TERM-CALC        PIC X.
  4687                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4688                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4689                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4690                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4691                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4692                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4693                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4694                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4695
  4696             20  CF-ST-REFUND-CALC          PIC X.
  4697                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4698                 88  ST-REFD-BY-R78             VALUE '1'.
  4699                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4700                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4701                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4702                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4703                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4704                 88  ST-REFD-UTAH               VALUE '7'.
  4705                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4706                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4707                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4708
  4709             20  CF-ST-EARNING-CALC         PIC X.
  4710                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4711                 88  ST-EARN-BY-R78             VALUE '1'.
  4712                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4713                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4714                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  91
* EL156.cbl
  4715                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4716                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4717                 88  ST-EARN-MEAN               VALUE '8'.
  4718                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4719
  4720             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4721                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4722                 88  ST-OVRD-BY-R78             VALUE '1'.
  4723                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4724                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4725                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4726                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4727                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4728                 88  ST-OVRD-MEAN               VALUE '8'.
  4729                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4730             20  FILLER                     PIC X.
  4731
  4732         16  CF-ST-COMMISSION-CAPS.
  4733             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4734             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4735             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4736             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4737         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4738                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4739
  4740         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4741
  4742         16  CF-ST-STATUTORY-INTEREST.
  4743             20  CF-ST-STAT-DATE-FROM       PIC X.
  4744                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4745                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4746             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4747             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4748             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4749             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4750             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4751
  4752         16  CF-ST-OVER-SHORT.
  4753             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4754             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4755
  4756         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4757
  4758         16  CF-ST-RT-CALC                  PIC X.
  4759
  4760         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4761         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4762         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4763         16  CF-ST-RF-LR-CALC               PIC X.
  4764         16  CF-ST-RF-LL-CALC               PIC X.
  4765         16  CF-ST-RF-LN-CALC               PIC X.
  4766         16  CF-ST-RF-AH-CALC               PIC X.
  4767         16  CF-ST-RF-CP-CALC               PIC X.
  4768*        16  FILLER                         PIC X(206).
  4769*CIDMOD         16  FILLER                         PIC X(192).
  4770         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4771             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4772         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  92
* EL156.cbl
  4773         16  CF-ST-VFY-2ND-BENE             PIC X.
  4774         16  CF-ST-CAUSAL-STATE             PIC X.
  4775         16  FILLER                         PIC X(185).
  4776
  4777****************************************************************
  4778*             BENEFIT MASTER RECORD                            *
  4779****************************************************************
  4780
  4781     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4782         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4783             20  CF-BENEFIT-CODE            PIC XX.
  4784             20  CF-BENEFIT-NUMERIC  REDEFINES
  4785                 CF-BENEFIT-CODE            PIC XX.
  4786             20  CF-BENEFIT-ALPHA           PIC XXX.
  4787             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4788             20  CF-BENEFIT-COMMENT         PIC X(10).
  4789
  4790             20  CF-LF-COVERAGE-TYPE        PIC X.
  4791                 88  CF-REDUCING                VALUE 'R'.
  4792                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4793
  4794             20  CF-SPECIAL-CALC-CD         PIC X.
  4795                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4796                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4797                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4798                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4799                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4800                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4801                 88  CF-FARM-PLAN               VALUE 'F'.
  4802                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4803                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4804                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4805                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4806                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4807                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4808                 88  CF-PRUDENTIAL              VALUE 'P'.
  4809                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4810                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4811                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4812                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4813                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4814                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4815
  4816             20  CF-JOINT-INDICATOR         PIC X.
  4817                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4818
  4819*            20  FILLER                     PIC X(12).
  4820             20  cf-maximum-benefits        pic s999 comp-3.
  4821             20  FILLER                     PIC X(09).
  4822             20  CF-BENEFIT-CATEGORY        PIC X.
  4823             20  CF-LOAN-TYPE               PIC X(8).
  4824
  4825             20  CF-CO-REM-TERM-CALC        PIC X.
  4826                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4827                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4828                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4829                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4830                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  93
* EL156.cbl
  4831
  4832             20  CF-CO-EARNINGS-CALC        PIC X.
  4833                 88  CO-EARN-BY-R78             VALUE '1'.
  4834                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4835                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4836                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4837                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4838                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4839                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4840                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4841
  4842             20  CF-CO-REFUND-CALC          PIC X.
  4843                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4844                 88  CO-REFD-BY-R78             VALUE '1'.
  4845                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4846                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4847                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4848                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4849                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4850                 88  CO-REFD-MEAN               VALUE '8'.
  4851                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4852                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4853                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4854
  4855             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4856                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4857                 88  CO-OVRD-BY-R78             VALUE '1'.
  4858                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4859                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4860                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4861                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4862                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4863                 88  CO-OVRD-MEAN               VALUE '8'.
  4864                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4865
  4866             20  CF-CO-BEN-I-G-CD           PIC X.
  4867                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4868                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4869                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4870
  4871         16  FILLER                         PIC X(304).
  4872
  4873
  4874****************************************************************
  4875*             CARRIER MASTER RECORD                            *
  4876****************************************************************
  4877
  4878     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4879         16  CF-ADDRESS-DATA.
  4880             20  CF-MAIL-TO-NAME            PIC X(30).
  4881             20  CF-IN-CARE-OF              PIC X(30).
  4882             20  CF-ADDRESS-LINE-1          PIC X(30).
  4883             20  CF-ADDRESS-LINE-2          PIC X(30).
  4884             20  CF-CITY-STATE              PIC X(30).
  4885             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4886             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4887
  4888         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  94
* EL156.cbl
  4889             20  CF-CLAIM-NO-METHOD         PIC X.
  4890                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4891                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4892                 88  CLAIM-NO-SEQ               VALUE '3'.
  4893                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4894             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4895                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4896                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4897                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4898
  4899         16  CF-CHECK-NO-CONTROL.
  4900             20  CF-CHECK-NO-METHOD         PIC X.
  4901                 88  CHECK-NO-MANUAL            VALUE '1'.
  4902                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4903                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4904                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4905             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4906                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4907
  4908         16  CF-DOMICILE-STATE              PIC XX.
  4909
  4910         16  CF-EXPENSE-CONTROLS.
  4911             20  CF-EXPENSE-METHOD          PIC X.
  4912                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4913                 88  DOLLARS-PER-PMT            VALUE '2'.
  4914                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4915                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4916             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4917             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4918
  4919         16  CF-CORRESPONDENCE-CONTROL.
  4920             20  CF-LETTER-RESEND-OPT       PIC X.
  4921                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4922                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4923             20  FILLER                     PIC X(4).
  4924
  4925         16  CF-RESERVE-CONTROLS.
  4926             20  CF-MANUAL-SW               PIC X.
  4927                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4928             20  CF-FUTURE-SW               PIC X.
  4929                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4930             20  CF-PTC-SW                  PIC X.
  4931                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4932             20  CF-IBNR-SW                 PIC X.
  4933                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4934             20  CF-PTC-LF-SW               PIC X.
  4935                 88  CF-LF-PTC-USED             VALUE '1'.
  4936             20  CF-CDT-ACCESS-METHOD       PIC X.
  4937                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4938                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4939                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4940             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4941
  4942         16  CF-CLAIM-CALC-METHOD           PIC X.
  4943             88  360-PLUS-MONTHS                VALUE '1'.
  4944             88  365-PLUS-MONTHS                VALUE '2'.
  4945             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4946             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  95
* EL156.cbl
  4947             88  365-DAILY                      VALUE '5'.
  4948
  4949         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4950         16  FILLER                         PIC X(11).
  4951
  4952         16  CF-LIMIT-AMOUNTS.
  4953             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4954             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4955             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4956             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4957             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4958             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4959             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4960             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4961             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4962             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4963
  4964         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4965         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4966         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4967
  4968         16  CF-ZIP-CODE.
  4969             20  CF-ZIP-PRIME.
  4970                 24  CF-ZIP-1ST             PIC X.
  4971                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4972                 24  FILLER                 PIC X(4).
  4973             20  CF-ZIP-PLUS4               PIC X(4).
  4974         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4975             20  CF-CAN-POSTAL-1            PIC XXX.
  4976             20  CF-CAN-POSTAL-2            PIC XXX.
  4977             20  FILLER                     PIC XXX.
  4978
  4979         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4980         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4981         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4982
  4983         16  CF-RATING-SWITCH               PIC X.
  4984             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4985             88  CF-NO-RATING                   VALUE 'N'.
  4986
  4987         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4988
  4989         16  CF-CARRIER-OVER-SHORT.
  4990             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4991             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4992
  4993         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4994         16  CF-SECPAY-SWITCH               PIC X.
  4995             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4996             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4997         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4998         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4999         16  FILLER                         PIC X(444).
  5000*        16  FILLER                         PIC X(452).
  5001
  5002
  5003****************************************************************
  5004*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  96
* EL156.cbl
  5005****************************************************************
  5006
  5007     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5008         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5009                                INDEXED BY CF-MORT-NDX.
  5010             20  CF-MORT-TABLE              PIC X(5).
  5011             20  CF-MORT-TABLE-TYPE         PIC X.
  5012                 88  CF-MORT-JOINT              VALUE 'J'.
  5013                 88  CF-MORT-SINGLE             VALUE 'S'.
  5014                 88  CF-MORT-COMBINED           VALUE 'C'.
  5015                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5016                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5017             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5018             20  CF-MORT-AGE-METHOD         PIC XX.
  5019                 88  CF-AGE-LAST                VALUE 'AL'.
  5020                 88  CF-AGE-NEAR                VALUE 'AN'.
  5021             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5022             20  CF-MORT-ADJUSTMENT-DIRECTION
  5023                                            PIC X.
  5024                 88  CF-MINUS                   VALUE '-'.
  5025                 88  CF-PLUS                    VALUE '+'.
  5026             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5027             20  CF-MORT-JOINT-CODE         PIC X.
  5028                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5029             20  CF-MORT-PC-Q               PIC X.
  5030                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5031             20  CF-MORT-TABLE-CODE         PIC X(4).
  5032             20  CF-MORT-COMMENTS           PIC X(15).
  5033             20  FILLER                     PIC X(14).
  5034
  5035         16  FILLER                         PIC X(251).
  5036
  5037
  5038****************************************************************
  5039*             BUSSINESS TYPE MASTER RECORD                     *
  5040****************************************************************
  5041
  5042     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5043* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5044* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5045* AND RECORD 05 IS TYPES 81-99
  5046         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5047             20  CF-BUSINESS-TITLE          PIC  X(19).
  5048             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5049                                            PIC S9V9(4) COMP-3.
  5050             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5051             20  FILLER                     PIC  X.
  5052         16  FILLER                         PIC  X(248).
  5053
  5054
  5055****************************************************************
  5056*             TERMINAL MASTER RECORD                           *
  5057****************************************************************
  5058
  5059     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5060
  5061         16  CF-COMPANY-TERMINALS.
  5062             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  97
* EL156.cbl
  5063                                  PIC X(4).
  5064         16  FILLER               PIC X(248).
  5065
  5066
  5067****************************************************************
  5068*             LIFE EDIT MASTER RECORD                          *
  5069****************************************************************
  5070
  5071     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5072         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5073             20  CF-LIFE-CODE-IN            PIC XX.
  5074             20  CF-LIFE-CODE-OUT           PIC XX.
  5075         16  FILLER                         PIC X(248).
  5076
  5077
  5078****************************************************************
  5079*             AH EDIT MASTER RECORD                            *
  5080****************************************************************
  5081
  5082     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5083         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5084             20  CF-AH-CODE-IN              PIC XXX.
  5085             20  CF-AH-CODE-OUT             PIC XX.
  5086         16  FILLER                         PIC X(248).
  5087
  5088
  5089****************************************************************
  5090*             CREDIBILITY TABLES                               *
  5091****************************************************************
  5092
  5093     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5094         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5095                             INDEXED BY CF-CRDB-NDX.
  5096             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5097             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5098             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5099         16  FILLER                         PIC  X(332).
  5100
  5101
  5102****************************************************************
  5103*             REPORT CUSTOMIZATION RECORD                      *
  5104****************************************************************
  5105
  5106     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5107         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5108             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5109             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5110             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5111**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5112****       A T-TRANSFER.                                   ****
  5113             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5114
  5115         16  FILLER                         PIC XX.
  5116
  5117         16  CF-CARRIER-CNTL-OPT.
  5118             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5119                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5120                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  98
* EL156.cbl
  5121             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5122                                            PIC X.
  5123         16  CF-GROUP-CNTL-OPT.
  5124             20  CF-GROUP-OPT-SEQ           PIC 9.
  5125                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5126                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5127             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5128                                            PIC X(6).
  5129         16  CF-STATE-CNTL-OPT.
  5130             20  CF-STATE-OPT-SEQ           PIC 9.
  5131                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5132                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5133             20  CF-STATE-SELECT OCCURS 3 TIMES
  5134                                            PIC XX.
  5135         16  CF-ACCOUNT-CNTL-OPT.
  5136             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5137                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5138                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5139             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5140                                            PIC X(10).
  5141         16  CF-BUS-TYP-CNTL-OPT.
  5142             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5143                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5144                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5145             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5146                                            PIC XX.
  5147         16  CF-LF-TYP-CNTL-OPT.
  5148             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5149                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5150                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5151             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5152                                            PIC XX.
  5153         16  CF-AH-TYP-CNTL-OPT.
  5154             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5155                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5156                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5157             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5158                                            PIC XX.
  5159         16  CF-REPTCD1-CNTL-OPT.
  5160             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5161                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5162                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5163             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5164                                            PIC X(10).
  5165         16  CF-REPTCD2-CNTL-OPT.
  5166             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5167                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5168                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5169             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5170                                            PIC X(10).
  5171         16  CF-USER1-CNTL-OPT.
  5172             20  CF-USER1-OPT-SEQ           PIC 9.
  5173                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5174                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5175             20  CF-USER1-SELECT OCCURS 3 TIMES
  5176                                            PIC X(10).
  5177         16  CF-USER2-CNTL-OPT.
  5178             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page  99
* EL156.cbl
  5179                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5180                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5181             20  CF-USER2-SELECT OCCURS 3 TIMES
  5182                                            PIC X(10).
  5183         16  CF-USER3-CNTL-OPT.
  5184             20  CF-USER3-OPT-SEQ           PIC 9.
  5185                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5186                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5187             20  CF-USER3-SELECT OCCURS 3 TIMES
  5188                                            PIC X(10).
  5189         16  CF-USER4-CNTL-OPT.
  5190             20  CF-USER4-OPT-SEQ           PIC 9.
  5191                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5192                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5193             20  CF-USER4-SELECT OCCURS 3 TIMES
  5194                                            PIC X(10).
  5195         16  CF-USER5-CNTL-OPT.
  5196             20  CF-USER5-OPT-SEQ           PIC 9.
  5197                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5198                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5199             20  CF-USER5-SELECT OCCURS 3 TIMES
  5200                                            PIC X(10).
  5201         16  CF-REINS-CNTL-OPT.
  5202             20  CF-REINS-OPT-SEQ           PIC 9.
  5203                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5204                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5205             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5206                 24  CF-REINS-PRIME         PIC XXX.
  5207                 24  CF-REINS-SUB           PIC XXX.
  5208
  5209         16  CF-AGENT-CNTL-OPT.
  5210             20  CF-AGENT-OPT-SEQ           PIC 9.
  5211                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5212                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5213             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5214                                            PIC X(10).
  5215
  5216         16  FILLER                         PIC X(43).
  5217
  5218         16  CF-LOSS-RATIO-SELECT.
  5219             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5220             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5221         16  CF-ENTRY-DATE-SELECT.
  5222             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5223             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5224         16  CF-EFFECTIVE-DATE-SELECT.
  5225             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5226             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5227
  5228         16  CF-EXCEPTION-LIST-IND          PIC X.
  5229             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5230
  5231         16  FILLER                         PIC X(318).
  5232
  5233****************************************************************
  5234*                  EXCEPTION REPORTING RECORD                  *
  5235****************************************************************
  5236
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 100
* EL156.cbl
  5237     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5238         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5239             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5240
  5241         16  CF-COMBINED-LIFE-AH-OPT.
  5242             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5243             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5244             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5245             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5246
  5247         16  CF-LIFE-OPT.
  5248             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5249             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5250             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5251             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5252             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5253             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5254             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5255             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5256             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5257             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5258
  5259         16  CF-AH-OPT.
  5260             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5261             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5262             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5263             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5264             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5265             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5266             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5267             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5268             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5269             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5270
  5271         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5272             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5273             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5274             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5275
  5276         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5277
  5278         16  FILLER                         PIC X(673).
  5279
  5280
  5281****************************************************************
  5282*             MORTGAGE SYSTEM PLAN RECORD                      *
  5283****************************************************************
  5284
  5285     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5286         16  CF-PLAN-TYPE                   PIC X.
  5287             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5288             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5289             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5290         16  CF-PLAN-ABBREV                 PIC XXX.
  5291         16  CF-PLAN-DESCRIPT               PIC X(10).
  5292         16  CF-PLAN-NOTES                  PIC X(20).
  5293         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5294         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 101
* EL156.cbl
  5295             20  CF-PLAN-TERM-DATA.
  5296                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5297                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5298             20  CF-PLAN-AGE-DATA.
  5299                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5300                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5301                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5302             20  CF-PLAN-BENEFIT-DATA.
  5303                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5304                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5305                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5306                                            PIC S9(7)V99  COMP-3.
  5307         16  CF-PLAN-POLICY-FORMS.
  5308             20  CF-POLICY-FORM             PIC X(12).
  5309             20  CF-MASTER-APPLICATION      PIC X(12).
  5310             20  CF-MASTER-POLICY           PIC X(12).
  5311         16  CF-PLAN-RATING.
  5312             20  CF-RATE-CODE               PIC X(5).
  5313             20  CF-SEX-RATING              PIC X.
  5314                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5315                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5316             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5317             20  CF-SUB-STD-TYPE            PIC X.
  5318                 88  CF-PCT-OF-PREM            VALUE '1'.
  5319                 88  CF-PCT-OF-BENE            VALUE '2'.
  5320         16  CF-PLAN-PREM-TOLERANCES.
  5321             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5322             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5323         16  CF-PLAN-PYMT-TOLERANCES.
  5324             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5325             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5326         16  CF-PLAN-MISC-DATA.
  5327             20  FILLER                     PIC X.
  5328             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5329             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5330         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5331         16  CF-PLAN-IND-GRP                PIC X.
  5332             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5333                                                     '1'.
  5334             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5335                                                     '2'.
  5336         16  CF-MIB-SEARCH-SW               PIC X.
  5337             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5338             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5339             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5340             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5341         16  CF-ALPHA-SEARCH-SW             PIC X.
  5342             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5343             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5344             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5345             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5346             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5347             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5348             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5349             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5350             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5351             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5352                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 102
* EL156.cbl
  5353                                                     'X' 'Y' 'Z'.
  5354         16  CF-EFF-DT-RULE-SW              PIC X.
  5355             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5356             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5357             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5358             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5359             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5360         16  FILLER                         PIC X(4).
  5361         16  CF-HEALTH-QUESTIONS            PIC X.
  5362             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5363         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5364         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5365         16  CF-PLAN-SNGL-JNT               PIC X.
  5366             88  CF-COMBINED-PLAN              VALUE 'C'.
  5367             88  CF-JNT-PLAN                   VALUE 'J'.
  5368             88  CF-SNGL-PLAN                  VALUE 'S'.
  5369         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5370         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5371         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5372         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5373         16  CF-RERATE-CNTL                 PIC  X.
  5374             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5375             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5376             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5377             88  CF-AUTO-RECALC                 VALUE '4'.
  5378         16  CF-BENEFIT-TYPE                PIC  X.
  5379             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5380             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5381         16  CF-POLICY-FEE                  PIC S999V99
  5382                                                    COMP-3.
  5383         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5384         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5385         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5386         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5387         16  FILLER                         PIC  X(32).
  5388         16  CF-TERMINATION-FORM            PIC  X(04).
  5389         16  FILLER                         PIC  X(08).
  5390         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5391                                                       COMP-3.
  5392         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5393         16  CF-ISSUE-LETTER                PIC  X(4).
  5394         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5395         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5396             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5397             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5398         16  CF-MP-REFUND-CALC              PIC X.
  5399             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5400             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5401             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5402             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5403             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5404             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5405             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5406             88  CF-MP-REFD-MEAN                VALUE '8'.
  5407         16  CF-ALT-RATE-CODE               PIC  X(5).
  5408
  5409
  5410         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 103
* EL156.cbl
  5411****************************************************************
  5412*             MORTGAGE COMPANY MASTER RECORD                   *
  5413****************************************************************
  5414
  5415     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5416         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5417         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5418             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5419             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5420             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5421             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5422             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5423
  5424         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5425         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5426         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5427         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5428         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5429
  5430         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5431             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5432         16  CF-MP-RECON-USE-IND            PIC X(1).
  5433             88  CF-MP-USE-RECON             VALUE 'Y'.
  5434         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5435             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5436         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5437             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5438             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5439         16  FILLER                         PIC X(1).
  5440         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5441             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5442         16  CF-MORTG-MIB-VERSION           PIC X.
  5443             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5444             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5445             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5446         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5447             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5448                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5449             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5450                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5451             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5452                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5453             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5454                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5455             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5456                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5457             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5458                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5459         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5460         16  FILLER                         PIC X(7).
  5461         16  CF-MORTG-DESTINATION-SYMBOL.
  5462             20  CF-MORTG-MIB-COMM          PIC X(5).
  5463             20  CF-MORTG-MIB-TERM          PIC X(5).
  5464         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5465             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5466         16  FILLER                         PIC X(03).
  5467         16  CF-MP-CHECK-NO-CONTROL.
  5468             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 104
* EL156.cbl
  5469                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5470                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5471                                                ' ' LOW-VALUES.
  5472                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5473                                               VALUE '3'.
  5474         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5475         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5476         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5477             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5478                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5479             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5480                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5481             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5482                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5483             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5484                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5485             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5486                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5487             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5488                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5489         16  CF-MORTG-BILLING-AREA.
  5490             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5491                                            PIC X.
  5492         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5493         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5494         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5495         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5496             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5497             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5498         16  FILLER                         PIC X.
  5499         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5500             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5501             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5502         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5503         16  FILLER                         PIC X(8).
  5504         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5505         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5506         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5507         16  CF-ACH-COMPANY-ID.
  5508             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5509                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5510                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5511                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5512             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5513         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5514             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5515         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5516             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5517             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5518         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5519         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5520         16  FILLER                         PIC X(536).
  5521
  5522****************************************************************
  5523*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5524****************************************************************
  5525
  5526     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 105
* EL156.cbl
  5527         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5528             20  CF-FEMALE-HEIGHT.
  5529                 24  CF-FEMALE-FT           PIC 99.
  5530                 24  CF-FEMALE-IN           PIC 99.
  5531             20  CF-FEMALE-MIN-WT           PIC 999.
  5532             20  CF-FEMALE-MAX-WT           PIC 999.
  5533         16  FILLER                         PIC X(428).
  5534
  5535     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5536         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5537             20  CF-MALE-HEIGHT.
  5538                 24  CF-MALE-FT             PIC 99.
  5539                 24  CF-MALE-IN             PIC 99.
  5540             20  CF-MALE-MIN-WT             PIC 999.
  5541             20  CF-MALE-MAX-WT             PIC 999.
  5542         16  FILLER                         PIC X(428).
  5543******************************************************************
  5544*             AUTOMATIC ACTIVITY RECORD                          *
  5545******************************************************************
  5546     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5547         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5548             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5549             20  CF-SYS-LETTER-ID           PIC X(04).
  5550             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5551             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5552             20  CF-SYS-RESET-SW            PIC X(01).
  5553             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5554             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5555
  5556         16  FILLER                         PIC X(50).
  5557
  5558         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5559             20  CF-USER-ACTIVE-SW          PIC X(01).
  5560             20  CF-USER-LETTER-ID          PIC X(04).
  5561             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5562             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5563             20  CF-USER-RESET-SW           PIC X(01).
  5564             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5565             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5566             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5567
  5568         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 106
* EL156.cbl
  5570*    COPY ELCCERT.
  5571******************************************************************
  5572*                                                                *
  5573*                            ELCCERT.                            *
  5574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5575*                            VMOD=2.013                          *
  5576*                                                                *
  5577*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5578*                                                                *
  5579*   FILE TYPE = VSAM,KSDS                                        *
  5580*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5581*                                                                *
  5582*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5583*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5584*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5585*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5586*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5587*                                                                *
  5588*   LOG = YES                                                    *
  5589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5590******************************************************************
  5591*                   C H A N G E   L O G
  5592*
  5593* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5594*-----------------------------------------------------------------
  5595*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5596* EFFECTIVE    NUMBER
  5597*-----------------------------------------------------------------
  5598* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5599* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5600* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5601* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5602* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5603* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5604* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5605* 032612  CR2011110200001  PEMA  AHL CHANGES
  5606* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5607******************************************************************
  5608
  5609 01  CERTIFICATE-MASTER.
  5610     12  CM-RECORD-ID                      PIC XX.
  5611         88  VALID-CM-ID                      VALUE 'CM'.
  5612
  5613     12  CM-CONTROL-PRIMARY.
  5614         16  CM-COMPANY-CD                 PIC X.
  5615         16  CM-CARRIER                    PIC X.
  5616         16  CM-GROUPING.
  5617             20  CM-GROUPING-PREFIX        PIC X(3).
  5618             20  CM-GROUPING-PRIME         PIC X(3).
  5619         16  CM-STATE                      PIC XX.
  5620         16  CM-ACCOUNT.
  5621             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5622             20  CM-ACCOUNT-PRIME          PIC X(6).
  5623         16  CM-CERT-EFF-DT                PIC XX.
  5624         16  CM-CERT-NO.
  5625             20  CM-CERT-PRIME             PIC X(10).
  5626             20  CM-CERT-SFX               PIC X.
  5627
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 107
* EL156.cbl
  5628     12  CM-CONTROL-BY-NAME.
  5629         16  CM-COMPANY-CD-A1              PIC X.
  5630         16  CM-INSURED-LAST-NAME          PIC X(15).
  5631         16  CM-INSURED-INITIALS.
  5632             20  CM-INSURED-INITIAL1       PIC X.
  5633             20  CM-INSURED-INITIAL2       PIC X.
  5634
  5635     12  CM-CONTROL-BY-SSN.
  5636         16  CM-COMPANY-CD-A2              PIC X.
  5637         16  CM-SOC-SEC-NO.
  5638             20  CM-SSN-STATE              PIC XX.
  5639             20  CM-SSN-ACCOUNT            PIC X(6).
  5640             20  CM-SSN-LN3.
  5641                 25  CM-INSURED-INITIALS-A2.
  5642                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5643                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5644                 25 CM-PART-LAST-NAME-A2         PIC X.
  5645
  5646     12  CM-CONTROL-BY-CERT-NO.
  5647         16  CM-COMPANY-CD-A4              PIC X.
  5648         16  CM-CERT-NO-A4                 PIC X(11).
  5649
  5650     12  CM-CONTROL-BY-MEMB.
  5651         16  CM-COMPANY-CD-A5              PIC X.
  5652         16  CM-MEMBER-NO.
  5653             20  CM-MEMB-STATE             PIC XX.
  5654             20  CM-MEMB-ACCOUNT           PIC X(6).
  5655             20  CM-MEMB-LN4.
  5656                 25  CM-INSURED-INITIALS-A5.
  5657                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5658                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5659                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5660
  5661     12  CM-INSURED-PROFILE-DATA.
  5662         16  CM-INSURED-FIRST-NAME.
  5663             20  CM-INSURED-1ST-INIT       PIC X.
  5664             20  FILLER                    PIC X(9).
  5665         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5666         16  CM-INSURED-SEX                PIC X.
  5667             88  CM-SEX-MALE                  VALUE 'M'.
  5668             88  CM-SEX-FEMAL                 VALUE 'F'.
  5669         16  CM-INSURED-JOINT-AGE          PIC 99.
  5670         16  CM-JOINT-INSURED-NAME.
  5671             20  CM-JT-LAST-NAME           PIC X(15).
  5672             20  CM-JT-FIRST-NAME.
  5673                 24  CM-JT-1ST-INIT        PIC X.
  5674                 24  FILLER                PIC X(9).
  5675             20  CM-JT-INITIAL             PIC X.
  5676
  5677     12  CM-LIFE-DATA.
  5678         16  CM-LF-BENEFIT-CD              PIC XX.
  5679         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5680         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5681         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5682         16  CM-LF-DEV-CODE                PIC XXX.
  5683         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5684         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5685         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 108
* EL156.cbl
  5686         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5687         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5688         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5689         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5690         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5691         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5692         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5693         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5694         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5695         16  cm-temp-epiq                  pic xx.
  5696             88  EPIQ-CLASS                  value 'EQ'.
  5697*        16  FILLER                        PIC XX.
  5698
  5699     12  CM-AH-DATA.
  5700         16  CM-AH-BENEFIT-CD              PIC XX.
  5701         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5702         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5703         16  CM-AH-DEV-CODE                PIC XXX.
  5704         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5705         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5706         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5707         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5708         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5709         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5710         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5711         16  CM-AH-PAID-THRU-DT            PIC XX.
  5712             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5713         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5714         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5715         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5716         16  FILLER                        PIC X.
  5717
  5718     12  CM-LOAN-INFORMATION.
  5719         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5720         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5721                                           PIC S9(5)V99  COMP-3.
  5722         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5723         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5724         16  CM-PAY-FREQUENCY              PIC S99.
  5725         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5726         16  CM-RATE-CLASS                 PIC XX.
  5727         16  CM-BENEFICIARY                PIC X(25).
  5728         16  CM-POLICY-FORM-NO             PIC X(12).
  5729         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5730         16  CM-LAST-ADD-ON-DT             PIC XX.
  5731         16  CM-DEDUCTIBLE-AMOUNTS.
  5732             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5733             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5734         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5735             20  CM-RESIDENT-STATE         PIC XX.
  5736             20  CM-RATE-CODE              PIC X(4).
  5737             20  FILLER                    PIC XX.
  5738         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5739             20  CM-LOAN-OFFICER           PIC X(5).
  5740             20  FILLER                    PIC XXX.
  5741         16  CM-CSR-CODE                   PIC XXX.
  5742         16  CM-UNDERWRITING-CODE          PIC X.
  5743             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 109
* EL156.cbl
  5744         16  CM-POST-CARD-IND              PIC X.
  5745         16  CM-NH-INTERFACE-SW            PIC X.
  5746         16  CM-PREMIUM-TYPE               PIC X.
  5747             88  CM-SING-PRM                  VALUE '1'.
  5748             88  CM-O-B-COVERAGE              VALUE '2'.
  5749             88  CM-OPEN-END                  VALUE '3'.
  5750         16  CM-IND-GRP-TYPE               PIC X.
  5751             88  CM-INDIVIDUAL                VALUE 'I'.
  5752             88  CM-GROUP                     VALUE 'G'.
  5753         16  CM-SKIP-CODE                  PIC X.
  5754             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5755             88  SKIP-JULY                    VALUE '1'.
  5756             88  SKIP-AUGUST                  VALUE '2'.
  5757             88  SKIP-SEPTEMBER               VALUE '3'.
  5758             88  SKIP-JULY-AUG                VALUE '4'.
  5759             88  SKIP-AUG-SEPT                VALUE '5'.
  5760             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5761             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5762             88  SKIP-JUNE                    VALUE '8'.
  5763             88  SKIP-JUNE-JULY               VALUE '9'.
  5764             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5765             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5766         16  CM-PAYMENT-MODE               PIC X.
  5767             88  PAY-MONTHLY                  VALUE SPACE.
  5768             88  PAY-WEEKLY                   VALUE '1'.
  5769             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5770             88  PAY-BI-WEEKLY                VALUE '3'.
  5771             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5772         16  CM-LOAN-NUMBER                PIC X(8).
  5773         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5774         16  CM-OLD-LOF                    PIC XXX.
  5775*        16  CM-LOAN-OFFICER               PIC XXX.
  5776         16  CM-REIN-TABLE                 PIC XXX.
  5777         16  CM-SPECIAL-REIN-CODE          PIC X.
  5778         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5779         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5780         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5781
  5782     12  CM-STATUS-DATA.
  5783         16  CM-ENTRY-STATUS               PIC X.
  5784         16  CM-ENTRY-DT                   PIC XX.
  5785
  5786         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5787         16  CM-LF-CANCEL-DT               PIC XX.
  5788         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5789
  5790         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5791         16  CM-LF-DEATH-DT                PIC XX.
  5792         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5793
  5794         16  CM-LF-CURRENT-STATUS          PIC X.
  5795             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5796                                                'M' '4' '5' '9'.
  5797             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5798             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5799             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5800             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5801             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 110
* EL156.cbl
  5802             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5803             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5804             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5805             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5806             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5807             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5808             88  CM-LF-DECLINED               VALUE 'D'.
  5809             88  CM-LF-VOIDED                 VALUE 'V'.
  5810
  5811         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5812         16  CM-AH-CANCEL-DT               PIC XX.
  5813         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5814
  5815         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5816         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5817         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5818
  5819         16  CM-AH-CURRENT-STATUS          PIC X.
  5820             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5821                                                'M' '4' '5' '9'.
  5822             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5823             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5824             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5825             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5826             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5827             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5828             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5829             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5830             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5831             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5832             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5833             88  CM-AH-DECLINED               VALUE 'D'.
  5834             88  CM-AH-VOIDED                 VALUE 'V'.
  5835
  5836         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5837             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5838             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5839             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5840         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5841
  5842         16  CM-ENTRY-BATCH                PIC X(6).
  5843         16  CM-LF-EXIT-BATCH              PIC X(6).
  5844         16  CM-AH-EXIT-BATCH              PIC X(6).
  5845         16  CM-LAST-MONTH-END             PIC XX.
  5846
  5847     12  CM-NOTE-SW                        PIC X.
  5848         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5849         88  CERT-NOTES-PRESENT               VALUE '1'.
  5850         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5851         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5852         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5853         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5854         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5855         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5856     12  CM-COMP-EXCP-SW                   PIC X.
  5857         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5858         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5859     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 111
* EL156.cbl
  5860         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5861         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5862
  5863*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5864     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5865     12  FILLER                            PIC X.
  5866
  5867*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5868     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5869     12  FILLER                            PIC X.
  5870*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5871     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5872
  5873     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5874         88  CERT-ADDED-BATCH                 VALUE ' '.
  5875         88  CERT-ADDED-ONLINE                VALUE '1'.
  5876         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5877         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5878         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5879     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5880         88  CERT-AS-LOADED                   VALUE ' '.
  5881         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5882         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5883         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5884         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5885         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5886         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5887         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5888
  5889     12  CM-ACCOUNT-COMM-PCTS.
  5890         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5891         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5892
  5893     12  CM-USER-FIELD                     PIC X.
  5894     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5895     12  CM-CLP-STATE                      PIC XX.
  5896     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5897     12  CM-USER-RESERVED                  PIC XXX.
  5898     12  FILLER REDEFINES CM-USER-RESERVED.
  5899         16  CM-AH-CLASS-CD                PIC XX.
  5900         16  F                             PIC X.
  5901******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 112
* EL156.cbl
  5903*    COPY ELCTRLR.
  5904******************************************************************
  5905*                                                                *
  5906*                            ELCTRLR.                            *
  5907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5908*                            VMOD=2.014                          *
  5909*                                                                *
  5910*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5911*                                                                *
  5912*   FILE TYPE = VSAM,KSDS                                        *
  5913*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5914*                                                                *
  5915*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5916*       ALTERNATE INDEX = NONE                                   *
  5917*                                                                *
  5918*   LOG = YES                                                    *
  5919*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5920******************************************************************
  5921*                   C H A N G E   L O G
  5922*
  5923* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5924*-----------------------------------------------------------------
  5925*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5926* EFFECTIVE    NUMBER
  5927*-----------------------------------------------------------------
  5928* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5929* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5930* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5931* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5932* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5933* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5934* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5935* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5936* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5937* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5938* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5939* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5940* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5941* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5942* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5943* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5944* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5945* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5946* 040814    2014030500002  AJRA  ADD ICD CODES
  5947* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5948******************************************************************
  5949 01  ACTIVITY-TRAILERS.
  5950     12  AT-RECORD-ID                    PIC XX.
  5951         88  VALID-AT-ID                       VALUE 'AT'.
  5952
  5953     12  AT-CONTROL-PRIMARY.
  5954         16  AT-COMPANY-CD               PIC X.
  5955         16  AT-CARRIER                  PIC X.
  5956         16  AT-CLAIM-NO                 PIC X(7).
  5957         16  AT-CERT-NO.
  5958             20  AT-CERT-PRIME           PIC X(10).
  5959             20  AT-CERT-SFX             PIC X.
  5960         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 113
* EL156.cbl
  5961             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5962             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5963             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5964             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5965             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5966             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5967             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5968             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5969             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5970             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5971             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5972             88  AT-BENEFICIARY-TRL           VALUE +91.
  5973             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5974             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5975             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5976             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5977
  5978     12  AT-TRAILER-TYPE                 PIC X.
  5979         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5980         88  PAYMENT-TR                       VALUE '2'.
  5981         88  AUTO-PAY-TR                      VALUE '3'.
  5982         88  CORRESPONDENCE-TR                VALUE '4'.
  5983         88  ADDRESS-TR                       VALUE '5'.
  5984         88  GENERAL-INFO-TR                  VALUE '6'.
  5985         88  AUTO-PROMPT-TR                   VALUE '7'.
  5986         88  DENIAL-TR                        VALUE '8'.
  5987         88  INCURRED-CHG-TR                  VALUE '9'.
  5988         88  FORM-CONTROL-TR                  VALUE 'A'.
  5989
  5990     12  AT-RECORDED-DT                  PIC XX.
  5991     12  AT-RECORDED-BY                  PIC X(4).
  5992     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5993
  5994     12  AT-TRAILER-BODY                 PIC X(165).
  5995
  5996     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5997         16  AT-RESERVE-CONTROLS.
  5998             20  AT-MANUAL-SW            PIC X.
  5999                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6000             20  AT-FUTURE-SW            PIC X.
  6001                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6002             20  AT-PTC-SW               PIC X.
  6003                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6004             20  AT-IBNR-SW              PIC X.
  6005                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6006             20  AT-PTC-LF-SW            PIC X.
  6007                 88  AT-LF-PTC-USED          VALUE '1'.
  6008             20  AT-CDT-ACCESS-METHOD    PIC X.
  6009                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6010                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6011                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6012             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6013         16  AT-LAST-COMPUTED-DT         PIC XX.
  6014         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6015         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6016         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6017         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6018         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 114
* EL156.cbl
  6019         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6020         16  AT-EXPENSE-CONTROLS.
  6021             20  AT-EXPENSE-METHOD       PIC X.
  6022                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6023                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6024                 88  PERCENT-OF-PMT           VALUE '3'.
  6025                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6026             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6027             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6028         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6029         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6030
  6031         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6032         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6033
  6034*        16  FILLER                      PIC X(53).
  6035         16  FILLER                      PIC X(47).
  6036
  6037         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6038         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6039
  6040         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6041             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6042             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6043*                    C = CLOSED
  6044*                    O = OPEN
  6045             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6046*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6047
  6048     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6049         16  AT-PAYMENT-TYPE             PIC X.
  6050             88  PARTIAL-PAYMENT                VALUE '1'.
  6051             88  FINAL-PAYMENT                  VALUE '2'.
  6052             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6053             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6054             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6055             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6056             88  VOIDED-PAYMENT                 VALUE '9'.
  6057             88  TRANSFER                       VALUE 'T'.
  6058             88  LIFE-INTEREST                  VALUE 'I'.
  6059
  6060         16  AT-CLAIM-TYPE               PIC X.
  6061             88  PAID-FOR-AH                    VALUE 'A'.
  6062             88  PAID-FOR-LIFE                  VALUE 'L'.
  6063             88  PAID-FOR-IUI                   VALUE 'I'.
  6064             88  PAID-FOR-GAP                   VALUE 'G'.
  6065             88  PAID-FOR-FAM                   VALUE 'F'.
  6066         16  AT-CLAIM-PREM-TYPE          PIC X.
  6067             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6068             88  AT-O-B-COVERAGE                VALUE '2'.
  6069             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6070         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6071         16  AT-CHECK-NO                 PIC X(7).
  6072         16  AT-PAID-FROM-DT             PIC XX.
  6073         16  AT-PAID-THRU-DT             PIC XX.
  6074         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6075         16  FILLER                      PIC X.
  6076         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 115
* EL156.cbl
  6077         16  AT-PAYMENT-ORIGIN           PIC X.
  6078             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6079             88  ONLINE-AUTO-PMT                VALUE '2'.
  6080             88  OFFLINE-PMT                    VALUE '3'.
  6081         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6082         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6083         16  AT-VOID-DATA.
  6084             20  AT-VOID-DT              PIC XX.
  6085*00144       20  AT-VOID-REASON          PIC X(30).
  6086             20  AT-VOID-REASON          PIC X(26).
  6087         16  AT-PMT-APPROVED-BY          PIC X(04).
  6088         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6089         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6090         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6091                                         PIC S99V9(5)  COMP-3.
  6092         16  AT-CREDIT-INTERFACE.
  6093             20  AT-PMT-SELECT-DT        PIC XX.
  6094                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6095             20  AT-PMT-ACCEPT-DT        PIC XX.
  6096                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6097             20  AT-VOID-SELECT-DT       PIC XX.
  6098                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6099             20  AT-VOID-ACCEPT-DT       PIC XX.
  6100                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6101
  6102         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6103                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6104                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6105         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6106
  6107         16  AT-FORCE-CONTROL            PIC X.
  6108             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6109         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6110         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6111         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6112         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6113         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6114         16  AT-BENEFIT-TYPE             PIC X.
  6115
  6116         16  AT-EXPENSE-TYPE             PIC X.
  6117         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6118
  6119         16  AT-PAYEE-TYPE-CD.
  6120             20  AT-PAYEE-TYPE           PIC X.
  6121                 88  INSURED-PAID           VALUE 'I'.
  6122                 88  BENEFICIARY-PAID       VALUE 'B'.
  6123                 88  ACCOUNT-PAID           VALUE 'A'.
  6124                 88  OTHER-1-PAID           VALUE 'O'.
  6125                 88  OTHER-2-PAID           VALUE 'Q'.
  6126                 88  DOCTOR-PAID            VALUE 'P'.
  6127                 88  EMPLOYER-PAID          VALUE 'E'.
  6128             20  AT-PAYEE-SEQ            PIC X.
  6129
  6130         16  AT-CASH-PAYMENT             PIC X.
  6131         16  AT-GROUPED-PAYMENT          PIC X.
  6132         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6133         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6134         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 116
* EL156.cbl
  6135         16  AT-VOID-TYPE                PIC X.
  6136             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6137             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6138         16  AT-AIG-UNEMP-IND            PIC X.
  6139             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6140         16  AT-ASSOCIATES               PIC X.
  6141             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6142             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6143
  6144         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6145         16  AT-CV-PMT-CODE              PIC X.
  6146             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6147             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6148             88  FULL-ADD-PAYMENT           VALUE '3'.
  6149             88  HALF-ADD-PAYMENT           VALUE '4'.
  6150             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6151             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6152             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6153             88  ADDL-PAYMENT               VALUE '8'.
  6154
  6155         16  AT-EOB-CODE1                PIC XXX.
  6156         16  AT-EOB-CODE2                PIC XXX.
  6157         16  AT-EOB-CODE3                PIC XXX.
  6158         16  FILLER REDEFINES AT-EOB-CODE3.
  6159             20  AT-PRINT-CLM-FORM       PIC X.
  6160             20  AT-PRINT-SURVEY         PIC X.
  6161             20  AT-SPECIAL-RELEASE      PIC X.
  6162         16  AT-EOB-CODE4                PIC XXX.
  6163         16  FILLER REDEFINES AT-EOB-CODE4.
  6164             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6165             20  FILLER                  PIC X.
  6166         16  AT-EOB-CODE5                PIC XXX.
  6167         16  FILLER REDEFINES AT-EOB-CODE5.
  6168             20  AT-PMT-PROOF-DT         PIC XX.
  6169             20  FILLER                  PIC X.
  6170
  6171         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6172             88  AT-PRINT-EOB            VALUE 'Y'.
  6173
  6174         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6175         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6176
  6177     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6178         16  AT-SCHEDULE-START-DT        PIC XX.
  6179         16  AT-SCHEDULE-END-DT          PIC XX.
  6180         16  AT-TERMINATED-DT            PIC XX.
  6181         16  AT-LAST-PMT-TYPE            PIC X.
  6182             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6183             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6184         16  AT-FIRST-PMT-DATA.
  6185             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6186             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6187             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6188         16  AT-REGULAR-PMT-DATA.
  6189             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6190             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6191             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6192         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 117
* EL156.cbl
  6193             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6194                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6195                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6196                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6197                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6198                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6199             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6200         16  AT-AUTO-PAY-DAY             PIC 99.
  6201         16  AT-AUTO-CASH                PIC X.
  6202             88  AT-CASH                      VALUE 'Y'.
  6203             88  AT-NON-CASH                  VALUE 'N'.
  6204*        16  FILLER                      PIC X(129).
  6205         16  AT-AUTO-END-LETTER          PIC X(4).
  6206         16  FILLER                      PIC X(125).
  6207
  6208         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6209         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6210
  6211     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6212         16  AT-LETTER-SENT-DT           PIC XX.
  6213         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6214         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6215         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6216         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6217         16  AT-LETTER-ORIGIN            PIC X.
  6218             88  ONLINE-CREATION              VALUE '1' '3'.
  6219             88  OFFLINE-CREATION             VALUE '2' '4'.
  6220             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6221             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6222         16  AT-STD-LETTER-FORM          PIC X(4).
  6223         16  AT-REASON-TEXT              PIC X(70).
  6224         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6225         16  AT-ADDRESEE-TYPE            PIC X.
  6226              88  INSURED-ADDRESEE            VALUE 'I'.
  6227              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6228              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6229              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6230              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6231              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6232              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6233         16  AT-ADDRESSEE-NAME           PIC X(30).
  6234         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6235         16  AT-RESEND-PRINT-DATE        PIC XX.
  6236         16  AT-CORR-SOL-UNSOL           PIC X.
  6237         16  AT-LETTER-PURGED-DT         PIC XX.
  6238*
  6239*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6240*
  6241         16  AT-CSO-REDEFINITION.
  6242             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6243             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6244             20  AT-LETTER-TO-BENE       PIC X(1).
  6245             20  AT-STOP-LETTER-DT       PIC X(2).
  6246             20  FILLER                  PIC X(19).
  6247*             20  FILLER                  PIC X(27).
  6248             20  AT-CSO-LETTER-STATUS    PIC X.
  6249                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6250                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 118
* EL156.cbl
  6251                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6252             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6253             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6254*
  6255*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6256*
  6257*        16  FILLER                      PIC X(26).
  6258*
  6259*        16  AT-DMD-BSR-CODE             PIC X.
  6260*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6261*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6262*
  6263*        16  AT-DMD-LETTER-STATUS        PIC X.
  6264*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6265*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6266*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6267*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6268*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6269
  6270         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6271         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6272
  6273     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6274         16  AT-ADDRESS-TYPE             PIC X.
  6275             88  INSURED-ADDRESS               VALUE 'I'.
  6276             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6277             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6278             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6279             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6280             88  OTHER-ADDRESS-1               VALUE 'O'.
  6281             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6282         16  AT-MAIL-TO-NAME             PIC X(30).
  6283         16  AT-ADDRESS-LINE-1           PIC X(30).
  6284         16  AT-ADDRESS-LINE-2           PIC X(30).
  6285         16  AT-CITY-STATE.
  6286             20  AT-CITY                 PIC X(28).
  6287             20  AT-STATE                PIC XX.
  6288         16  AT-ZIP.
  6289             20  AT-ZIP-CODE.
  6290                 24  AT-ZIP-1ST          PIC X.
  6291                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6292                 24  FILLER              PIC X(4).
  6293             20  AT-ZIP-PLUS4            PIC X(4).
  6294         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6295             20  AT-CAN-POSTAL-1         PIC XXX.
  6296             20  AT-CAN-POSTAL-2         PIC XXX.
  6297             20  FILLER                  PIC XXX.
  6298         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6299*         16  FILLER                      PIC X(23).
  6300         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6301         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6302         16  FILLER                      PIC X(13).
  6303         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6304         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6305
  6306     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6307         16  AT-INFO-LINE-1              PIC X(60).
  6308         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 119
* EL156.cbl
  6309             20  AT-NOTE-ERROR-NO OCCURS 15
  6310                                         PIC X(4).
  6311         16  AT-INFO-LINE-2              PIC X(60).
  6312         16  FILLER REDEFINES AT-INFO-LINE-2.
  6313             20  AT-ICD-CODE-1           PIC X(8).
  6314             20  AT-ICD-CODE-2           PIC X(8).
  6315             20  FILLER                  PIC X(44).
  6316         16  AT-INFO-TRAILER-TYPE        PIC X.
  6317             88  AT-ERRORS-NOTE          VALUE 'E'.
  6318             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6319             88  AT-CALL-NOTE            VALUE 'C'.
  6320             88  AT-MAINT-NOTE           VALUE 'M'.
  6321             88  AT-CERT-CHANGE          VALUE 'X'.
  6322             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6323             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6324             88  AT-CERT-CANCELLED       VALUE 'T'.
  6325         16  AT-CALL-TYPE                PIC X.
  6326             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6327             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6328         16  AT-NOTE-CONTINUATION        PIC X.
  6329             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6330         16  AT-EOB-CODES-EXIST          PIC X.
  6331             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6332         16  FILLER                      PIC X(35).
  6333         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6334         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6335
  6336     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6337         16  AT-PROMPT-LINE-1            PIC X(60).
  6338         16  AT-PROMPT-LINE-2            PIC X(60).
  6339         16  AT-PROMPT-START-DT          PIC XX.
  6340         16  AT-PROMPT-END-DT            PIC XX.
  6341         16  FILLER                      PIC X(35).
  6342         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6343         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6344
  6345     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6346         16  AT-DENIAL-INFO-1            PIC X(60).
  6347         16  AT-DENIAL-INFO-2            PIC X(60).
  6348         16  AT-DENIAL-DT                PIC XX.
  6349         16  AT-RETRACTION-DT            PIC XX.
  6350         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6351*         16  FILLER                      PIC X(31).
  6352         16  AT-DENIAL-PROOF-DT          PIC XX.
  6353         16  FILLER                      PIC X(29).
  6354         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6355         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6356
  6357     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6358         16  AT-OLD-INCURRED-DT          PIC XX.
  6359         16  AT-OLD-REPORTED-DT          PIC XX.
  6360         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6361         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6362         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6363         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6364         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6365         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6366         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 120
* EL156.cbl
  6367         16  AT-OLD-DIAG-CODE            PIC X(6).
  6368         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6369         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6370         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6371         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6372         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6373         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6374         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6375         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6376         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6377         16  FILLER                      PIC X(9).
  6378         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6379
  6380     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6381         16  AT-FORM-SEND-ON-DT          PIC XX.
  6382         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6383         16  AT-FORM-RE-SEND-DT          PIC XX.
  6384         16  AT-FORM-ANSWERED-DT         PIC XX.
  6385         16  AT-FORM-PRINTED-DT          PIC XX.
  6386         16  AT-FORM-REPRINT-DT          PIC XX.
  6387         16  AT-FORM-TYPE                PIC X.
  6388             88  INITIAL-FORM                  VALUE '1'.
  6389             88  PROGRESS-FORM                 VALUE '2'.
  6390         16  AT-INSTRUCT-LN-1            PIC X(28).
  6391         16  AT-INSTRUCT-LN-2            PIC X(28).
  6392         16  AT-INSTRUCT-LN-3            PIC X(28).
  6393         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6394         16  AT-FORM-ADDRESS             PIC X.
  6395             88  FORM-TO-INSURED              VALUE 'I'.
  6396             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6397             88  FORM-TO-OTHER-1              VALUE 'O'.
  6398             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6399         16  AT-RELATED-1.
  6400             20 AT-REL-CARR-1            PIC X.
  6401             20 AT-REL-CLAIM-1           PIC X(7).
  6402             20 AT-REL-CERT-1            PIC X(11).
  6403         16  AT-RELATED-2.
  6404             20 AT-REL-CARR-2            PIC X.
  6405             20 AT-REL-CLAIM-2           PIC X(7).
  6406             20 AT-REL-CERT-2            PIC X(11).
  6407         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6408         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6409         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6410         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6411         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6412         16  AT-STOP-FORM-DT             PIC X(2).
  6413
  6414         16  FILLER                      PIC X(09).
  6415         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6416         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6417******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 121
* EL156.cbl
  6419*    COPY ELCACTQ.
  6420******************************************************************
  6421*                                                                *
  6422*                            ELCACTQ.                            *
  6423*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6424*                            VMOD=2.004                          *
  6425*                                                                *
  6426*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6427*                                                                *
  6428*   FILE TYPE = VSAM,KSDS                                        *
  6429*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6430*                                                                *
  6431*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6432*       ALTERNATE INDEX = NONE                                   *
  6433*                                                                *
  6434*   LOG = YES                                                    *
  6435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6436*                                                                *
  6437*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6438******************************************************************
  6439
  6440 01  ACTIVITY-QUE.
  6441     12  AQ-RECORD-ID                PIC XX.
  6442         88  VALID-AQ-ID                VALUE 'AQ'.
  6443
  6444     12  AQ-CONTROL-PRIMARY.
  6445         16  AQ-COMPANY-CD           PIC X.
  6446         16  AQ-CARRIER              PIC X.
  6447         16  AQ-CLAIM-NO             PIC X(7).
  6448         16  AQ-CERT-NO.
  6449             20  AQ-CERT-PRIME       PIC X(10).
  6450             20  AQ-CERT-SFX         PIC X.
  6451
  6452     12  AQ-PENDING-ACTIVITY-FLAGS.
  6453         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6454         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6455             88  PENDING-PAYMENTS       VALUE '1'.
  6456         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6457             88  PENDING-FULL-PRINT     VALUE '1'.
  6458             88  PENDING-PART-PRINT     VALUE '2'.
  6459         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6460             88  PENDING-LETTERS        VALUE '1'.
  6461         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6462             88  PENDING-RESTORE        VALUE 'C'.
  6463             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6464
  6465     12  FILLER                      PIC X(20).
  6466
  6467     12  AQ-RESEND-DATE              PIC XX.
  6468     12  AQ-FOLLOWUP-DATE            PIC XX.
  6469     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6470     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6471     12  AQ-AUTO-LETTER              PIC X(4).
  6472     12  FILLER                      PIC XX.
  6473     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6474*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 122
* EL156.cbl
  6476*    COPY ERCACCT.
  6477******************************************************************
  6478*                                                                *
  6479*                                                                *
  6480*                            ERCACCT                             *
  6481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6482*                            VMOD=2.031                          *
  6483*                                                                *
  6484*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6485*                                                                *
  6486*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6487*   VSAM ACCOUNT MASTER FILES.                                   *
  6488*                                                                *
  6489*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6490*                                                                *
  6491*   FILE TYPE = VSAM,KSDS                                        *
  6492*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6493*                                                                *
  6494*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6495*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6496*                                                                *
  6497*   LOG = NO                                                     *
  6498*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6499*                                                                *
  6500*                                                                *
  6501******************************************************************
  6502*                   C H A N G E   L O G
  6503*
  6504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6505*-----------------------------------------------------------------
  6506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6507* EFFECTIVE    NUMBER
  6508*-----------------------------------------------------------------
  6509* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6510* 092705    2005050300006  PEMA  ADD SPP LEASES
  6511* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6512* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6513* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6514* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6515* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6516******************************************************************
  6517
  6518 01  ACCOUNT-MASTER.
  6519     12  AM-RECORD-ID                      PIC XX.
  6520         88  VALID-AM-ID                      VALUE 'AM'.
  6521
  6522     12  AM-CONTROL-PRIMARY.
  6523         16  AM-COMPANY-CD                 PIC X.
  6524         16  AM-MSTR-CNTRL.
  6525             20  AM-CONTROL-A.
  6526                 24  AM-CARRIER            PIC X.
  6527                 24  AM-GROUPING.
  6528                     28 AM-GROUPING-PREFIX PIC XXX.
  6529                     28 AM-GROUPING-PRIME  PIC XXX.
  6530                 24  AM-STATE              PIC XX.
  6531                 24  AM-ACCOUNT.
  6532                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6533                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 123
* EL156.cbl
  6534             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6535                                           PIC X(19).
  6536             20  AM-CNTRL-B.
  6537                 24  AM-EXPIRATION-DT      PIC XX.
  6538                 24  FILLER                PIC X(4).
  6539             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6540                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6541
  6542     12  AM-CONTROL-BY-VAR-GRP.
  6543         16  AM-COMPANY-CD-A1              PIC X.
  6544         16  AM-VG-CARRIER                 PIC X.
  6545         16  AM-VG-GROUPING                PIC X(6).
  6546         16  AM-VG-STATE                   PIC XX.
  6547         16  AM-VG-ACCOUNT                 PIC X(10).
  6548         16  AM-VG-DATE.
  6549             20  AM-VG-EXPIRATION-DT       PIC XX.
  6550             20  FILLER                    PIC X(4).
  6551         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6552                                           PIC 9(11)      COMP-3.
  6553     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6554         16  FILLER                        PIC X(10).
  6555         16  AM-VG-KEY3.
  6556             20  AM-VG3-ACCOUNT            PIC X(10).
  6557             20  AM-VG3-EXP-DT             PIC XX.
  6558         16  FILLER                        PIC X(4).
  6559     12  AM-MAINT-INFORMATION.
  6560         16  AM-LAST-MAINT-DT              PIC XX.
  6561         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6562         16  AM-LAST-MAINT-USER            PIC X(4).
  6563         16  FILLER                        PIC XX.
  6564
  6565     12  AM-EFFECTIVE-DT                   PIC XX.
  6566     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6567
  6568     12  AM-PREV-DATES  COMP-3.
  6569         16  AM-PREV-EXP-DT                PIC 9(11).
  6570         16  AM-PREV-EFF-DT                PIC 9(11).
  6571
  6572     12  AM-REPORT-CODE-1                  PIC X(10).
  6573     12  AM-REPORT-CODE-2                  PIC X(10).
  6574
  6575     12  AM-CITY-CODE                      PIC X(4).
  6576     12  AM-COUNTY-PARISH                  PIC X(6).
  6577
  6578     12  AM-NAME                           PIC X(30).
  6579     12  AM-PERSON                         PIC X(30).
  6580     12  AM-ADDRS                          PIC X(30).
  6581     12  AM-CITY.
  6582         16  AM-ADDR-CITY                  PIC X(28).
  6583         16  AM-ADDR-STATE                 PIC XX.
  6584     12  AM-ZIP.
  6585         16  AM-ZIP-PRIME.
  6586             20  AM-ZIP-PRI-1ST            PIC X.
  6587                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6588             20  FILLER                    PIC X(4).
  6589         16  AM-ZIP-PLUS4                  PIC X(4).
  6590     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6591         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 124
* EL156.cbl
  6592         16  AM-CAN-POSTAL-2               PIC XXX.
  6593         16  FILLER                        PIC XXX.
  6594     12  AM-TEL-NO.
  6595         16  AM-AREA-CODE                  PIC 999.
  6596         16  AM-TEL-PRE                    PIC 999.
  6597         16  AM-TEL-NBR                    PIC 9(4).
  6598     12  AM-TEL-LOC                        PIC X.
  6599         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6600         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6601
  6602     12  AM-COMM-STRUCTURE.
  6603         16  AM-DEFN-1.
  6604             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6605                 24  AM-AGT.
  6606                     28  AM-AGT-PREFIX     PIC X(4).
  6607                     28  AM-AGT-PRIME      PIC X(6).
  6608                 24  AM-COM-TYP            PIC X.
  6609                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6610                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6611                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6612                 24  AM-RECALC-LV-INDIC    PIC X.
  6613                 24  AM-RETRO-LV-INDIC     PIC X.
  6614                 24  AM-GL-CODES           PIC X.
  6615                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6616                 24  FILLER                PIC X(01).
  6617         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6618             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6619                 24  FILLER                PIC X(11).
  6620                 24  AM-L-COMA             PIC XXX.
  6621                 24  AM-J-COMA             PIC XXX.
  6622                 24  AM-A-COMA             PIC XXX.
  6623                 24  FILLER                PIC X(6).
  6624
  6625     12  AM-COMM-CHANGE-STATUS             PIC X.
  6626         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6627
  6628     12  AM-CSR-CODE                       PIC X(4).
  6629
  6630     12  AM-BILLING-STATUS                 PIC X.
  6631         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6632         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6633     12  AM-AUTO-REFUND-SW                 PIC X.
  6634         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6635         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6636     12  AM-GPCD                           PIC 99.
  6637     12  AM-IG                             PIC X.
  6638         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6639         88  AM-HAS-GROUP                     VALUE '2'.
  6640     12  AM-STATUS                         PIC X.
  6641         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6642         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6643         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6644         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6645         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6646         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6647     12  AM-REMIT-TO                       PIC 99.
  6648     12  AM-ID-NO                          PIC X(11).
  6649
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 125
* EL156.cbl
  6650     12  AM-CAL-TABLE                      PIC XX.
  6651     12  AM-LF-DEVIATION                   PIC XXX.
  6652     12  AM-AH-DEVIATION                   PIC XXX.
  6653     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6654     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6655     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6656     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6657     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6658     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6659
  6660     12  AM-USER-FIELDS.
  6661         16  AM-FLD-1                      PIC XX.
  6662         16  AM-FLD-2                      PIC XX.
  6663         16  AM-FLD-3                      PIC XX.
  6664         16  AM-FLD-4                      PIC XX.
  6665         16  AM-FLD-5                      PIC XX.
  6666
  6667     12  AM-1ST-PROD-DATE.
  6668         16  AM-1ST-PROD-YR                PIC XX.
  6669         16  AM-1ST-PROD-MO                PIC XX.
  6670         16  AM-1ST-PROD-DA                PIC XX.
  6671     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6672     12  AM-CERTS-PURGED-DATE.
  6673         16  AM-PUR-YR                     PIC XX.
  6674         16  AM-PUR-MO                     PIC XX.
  6675         16  AM-PUR-DA                     PIC XX.
  6676     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6677     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6678     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6679     12  AM-INACTIVE-DATE.
  6680         16  AM-INA-MO                     PIC 99.
  6681         16  AM-INA-DA                     PIC 99.
  6682         16  AM-INA-YR                     PIC 99.
  6683     12  AM-AR-HI-CERT-DATE                PIC XX.
  6684
  6685     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6686     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6687
  6688     12  AM-OB-PAYMENT-MODE                PIC X.
  6689         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6690         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6691         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6692         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6693
  6694     12  AM-AH-ONLY-INDICATOR              PIC X.
  6695         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6696         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6697
  6698     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6699
  6700     12  AM-OVER-SHORT.
  6701         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6702         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6703
  6704     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6705     12  AM-DCC-CLP-STATE                  PIC XX.
  6706
  6707     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 126
* EL156.cbl
  6708     12  AM-RECALC-REIN                    PIC X.
  6709
  6710     12  AM-REI-TABLE                      PIC XXX.
  6711     12  AM-REI-ET-LF                      PIC X.
  6712     12  AM-REI-ET-AH                      PIC X.
  6713     12  AM-REI-PE-LF                      PIC X.
  6714     12  AM-REI-PE-AH                      PIC X.
  6715     12  AM-REI-PRT-ST                     PIC X.
  6716     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6717     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6718     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6719     12  AM-REI-GROUP-A                    PIC X(6).
  6720     12  AM-REI-MORT                       PIC X(4).
  6721     12  AM-REI-PRT-OW                     PIC X.
  6722     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6723     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6724     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6725     12  AM-REI-GROUP-B                    PIC X(6).
  6726
  6727     12  AM-TRUST-TYPE                     PIC X(2).
  6728
  6729     12  AM-EMPLOYER-STMT-USED             PIC X.
  6730     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6731
  6732     12  AM-STD-AH-TYPE                    PIC XX.
  6733     12  AM-EARN-METHODS.
  6734         16  AM-EARN-METHOD-R              PIC X.
  6735             88 AM-REF-RL-R78                 VALUE 'R'.
  6736             88 AM-REF-RL-PR                  VALUE 'P'.
  6737             88 AM-REF-RL-MEAN                VALUE 'M'.
  6738             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6739         16  AM-EARN-METHOD-L              PIC X.
  6740             88 AM-REF-LL-R78                 VALUE 'R'.
  6741             88 AM-REF-LL-PR                  VALUE 'P'.
  6742             88 AM-REF-LL-MEAN                VALUE 'M'.
  6743             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6744         16  AM-EARN-METHOD-A              PIC X.
  6745             88 AM-REF-AH-R78                 VALUE 'R'.
  6746             88 AM-REF-AH-PR                  VALUE 'P'.
  6747             88 AM-REF-AH-MEAN                VALUE 'M'.
  6748             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6749             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6750             88 AM-REF-AH-NET                 VALUE 'N'.
  6751
  6752     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6753     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6754     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6755
  6756     12  AM-RET-Y-N                        PIC X.
  6757     12  AM-RET-P-E                        PIC X.
  6758     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6759     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6760     12  AM-RET-GRP                        PIC X(6).
  6761     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6762         16  AM-POOL-PRIME                 PIC XXX.
  6763         16  AM-POOL-SUB                   PIC XXX.
  6764     12  AM-RETRO-EARNINGS.
  6765         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 127
* EL156.cbl
  6766         16  AM-RET-EARN-L                 PIC X.
  6767         16  AM-RET-EARN-A                 PIC X.
  6768     12  AM-RET-ST-TAX-USE                 PIC X.
  6769         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6770         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6771     12  AM-RETRO-BEG-EARNINGS.
  6772         16  AM-RET-BEG-EARN-R             PIC X.
  6773         16  AM-RET-BEG-EARN-L             PIC X.
  6774         16  AM-RET-BEG-EARN-A             PIC X.
  6775     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6776     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6777
  6778     12  AM-USER-SELECT-OPTIONS.
  6779         16  AM-USER-SELECT-1              PIC X(10).
  6780         16  AM-USER-SELECT-2              PIC X(10).
  6781         16  AM-USER-SELECT-3              PIC X(10).
  6782         16  AM-USER-SELECT-4              PIC X(10).
  6783         16  AM-USER-SELECT-5              PIC X(10).
  6784
  6785     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6786
  6787     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6788
  6789     12  AM-RPT045A-SWITCH                 PIC X.
  6790         88  RPT045A-OFF                   VALUE 'N'.
  6791
  6792     12  AM-INSURANCE-LIMITS.
  6793         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6794         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6795
  6796     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6797         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6798
  6799     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6800         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6801         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6802
  6803     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6804
  6805     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6806     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6807     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6808     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6809     12  AM-DCC-UEF-STATE                  PIC XX.
  6810     12  FILLER                            PIC XXX.
  6811     12  AM-REPORT-CODE-3                  PIC X(10).
  6812*    12  FILLER                            PIC X(22).
  6813
  6814     12  AM-RESERVE-DATE.
  6815         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6816         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6817         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6818
  6819     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6820     12  AM-NOTIFICATION-TYPES.
  6821         16  AM-NOTIF-OF-LETTERS           PIC X.
  6822         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6823         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 128
* EL156.cbl
  6824         16  AM-NOTIF-OF-STATUS            PIC X.
  6825
  6826     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6827         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6828         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6829         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6830         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6831
  6832     12  AM-BENEFIT-CONTROLS.
  6833         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6834             20  AM-BENEFIT-CODE           PIC XX.
  6835             20  AM-BENEFIT-TYPE           PIC X.
  6836             20  AM-BENEFIT-REVISION       PIC XXX.
  6837             20  AM-BENEFIT-REM-TERM       PIC X.
  6838             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6839             20  FILLER                    PIC XX.
  6840         16  FILLER                        PIC X(80).
  6841
  6842     12  AM-TRANSFER-DATA.
  6843         16  AM-TRANSFERRED-FROM.
  6844             20  AM-TRNFROM-CARRIER        PIC X.
  6845             20  AM-TRNFROM-GROUPING.
  6846                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6847                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6848             20  AM-TRNFROM-STATE          PIC XX.
  6849             20  AM-TRNFROM-ACCOUNT.
  6850                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6851                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6852             20  AM-TRNFROM-DTE            PIC XX.
  6853         16  AM-TRANSFERRED-TO.
  6854             20  AM-TRNTO-CARRIER          PIC X.
  6855             20  AM-TRNTO-GROUPING.
  6856                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6857                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6858             20  AM-TRNTO-STATE            PIC XX.
  6859             20  AM-TRNTO-ACCOUNT.
  6860                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6861                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6862             20  AM-TRNTO-DTE              PIC XX.
  6863         16  FILLER                        PIC X(10).
  6864
  6865     12  AM-SAVED-REMIT-TO                 PIC 99.
  6866
  6867     12  AM-COMM-STRUCTURE-SAVED.
  6868         16  AM-DEFN-1-SAVED.
  6869             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6870                 24  AM-AGT-SV             PIC X(10).
  6871                 24  AM-COM-TYP-SV         PIC X.
  6872                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6873                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6874                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6875                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6876                 24  FILLER                PIC X.
  6877                 24  AM-GL-CODES-SV        PIC X.
  6878                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6879                 24  FILLER                PIC X.
  6880         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6881             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 129
* EL156.cbl
  6882                 24  FILLER                PIC X(11).
  6883                 24  AM-L-COMA-SV          PIC XXX.
  6884                 24  AM-J-COMA-SV          PIC XXX.
  6885                 24  AM-A-COMA-SV          PIC XXX.
  6886                 24  FILLER                PIC X(6).
  6887
  6888     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6889         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6890            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6891            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6892            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6893
  6894     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6895     12  FILLER                            PIC X(120).
  6896
  6897     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6898         16  AM-CONTROL-NAME               PIC X(30).
  6899         16  AM-EXECUTIVE-ONE.
  6900             20  AM-EXEC1-NAME             PIC X(15).
  6901             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6902                                                          COMP-3.
  6903             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6904                                                          COMP-3.
  6905         16  AM-EXECUTIVE-TWO.
  6906             20  AM-EXEC2-NAME             PIC X(15).
  6907             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6908                                                          COMP-3.
  6909             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6910                                                          COMP-3.
  6911
  6912     12  AM-RETRO-ADDITIONAL-DATA.
  6913         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6914         16  AM-RETRO-PREM-P-E             PIC X.
  6915         16  AM-RETRO-CLMS-P-I             PIC X.
  6916         16  AM-RETRO-RET-BRACKET-LF.
  6917             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6918                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6919                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6920             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6921                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6922                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6923             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6924                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6925                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6926         16  AM-RETRO-RET-BRACKET-AH.
  6927             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6928                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6929                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6930                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6931             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6932                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6933                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6934             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6935                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6936                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6937
  6938     12  AM-COMMENTS.
  6939         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 130
* EL156.cbl
  6940
  6941     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6942         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6943         16  AM-FLI-BILLING-CODE           PIC X.
  6944         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6945         16  AM-FLI-UNITED-IDENT           PIC X.
  6946         16  AM-FLI-INTEREST-LOST-DATA.
  6947             20  AM-FLI-BANK-NO            PIC X(5).
  6948             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6949             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6950             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6951         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6952             20  AM-FLI-AGT                PIC X(9).
  6953             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6954             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6955         16  FILLER                        PIC X(102).
  6956
  6957     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6958         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6959             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6960             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6961             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6962             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6963             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6964         16  FILLER                          PIC X(10).
  6965******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 131
* EL156.cbl
  6967*    COPY ELCCHKQ.
  6968******************************************************************
  6969*                                                                *
  6970*                                                                *
  6971*                            ELCCHKQ.                            *
  6972*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6973*                            VMOD=2.007                          *
  6974*                                                                *
  6975*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6976*                                                                *
  6977*   FILE TYPE = VSAM,KSDS                                        *
  6978*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6979*                                                                *
  6980*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6981*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6982*                                                                *
  6983*   LOG = YES                                                    *
  6984*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6985******************************************************************
  6986 01  CHECK-QUE.
  6987     12  CQ-RECORD-ID                PIC XX.
  6988         88  VALID-CQ-ID         VALUE 'CQ'.
  6989
  6990     12  CQ-CONTROL-PRIMARY.
  6991         16  CQ-COMPANY-CD           PIC X.
  6992         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6993         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6994
  6995     12  CQ-CONTROL-BY-PAYEE.
  6996         16  CQ-CONTROL-BY-NUMBER.
  6997             20  CQ-COMPANY-CD-A1     PIC X.
  6998             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6999         16  CQ-PAYEE-CARRIER        PIC X.
  7000         16  CQ-PAYEE-GROUPING       PIC X(6).
  7001         16  CQ-PAYEE-STATE          PIC XX.
  7002         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7003         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7004
  7005     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7006         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7007         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7008         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7009         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7010         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7011         16  FILLER                  PIC X(3).
  7012
  7013     12  CQ-ENTRY-TYPE               PIC X.
  7014             88  CHECK-ON-QUE           VALUE 'Q'.
  7015             88  ALIGNMENT-CHECK        VALUE 'A'.
  7016             88  SPOILED-CHECK          VALUE 'S'.
  7017             88  PAYMENT-ABORTED        VALUE 'X'.
  7018
  7019     12  CQ-CLAIM-MAST-CNTL.
  7020         16  CQ-CARRIER              PIC X.
  7021         16  CQ-CLAIM-NO             PIC X(7).
  7022         16  CQ-CERT-NO.
  7023             20  CQ-CERT-PRIME       PIC X(10).
  7024             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 132
* EL156.cbl
  7025         16  CQ-CLAIM-TYPE           PIC X.
  7026             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7027             88  CQ-AH-CLAIM            VALUE 'A'.
  7028         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7029             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7030             88  CQ-O-B-COVERAGE        VALUE '2'.
  7031             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7032
  7033     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7034     12  CQ-CHECK-NUMBER             PIC X(7).
  7035     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7036     12  CQ-PAYMENT-TYPE             PIC X.
  7037             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7038             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7039             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7040             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7041             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7042             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7043             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7044             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7045     12  CQ-VOID-INDICATOR           PIC X.
  7046             88  CHECK-IS-STOPPED          VALUE 'S'.
  7047             88  CHECK-IS-VOID             VALUE 'V'.
  7048     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7049     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7050     12  CQ-CHECK-BY-USER            PIC X(4).
  7051     12  CQ-PRE-NUMBERING-SW         PIC X.
  7052       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7053       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7054
  7055     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7056     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7057     12  CQ-LEDGER-FLAG              PIC X(01).
  7058     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7059     12  CQ-LAST-UPDATED-DT          PIC XX.
  7060     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7061     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7062
  7063     12  FILLER                      PIC X(04).
  7064
  7065******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 133
* EL156.cbl
  7067*    COPY ELCBENE.
  7068******************************************************************
  7069*                                                                *
  7070*                            ELCBENE.                            *
  7071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7072*                            VMOD=2.006                          *
  7073*                                                                *
  7074*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7075*                                                                *
  7076*   FILE TYPE = VSAM,KSDS                                        *
  7077*   RECORD SIZE = 500   RECFORM = FIX                            *
  7078*                                                                *
  7079*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7080*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7081*                                                                *
  7082*   LOG = YES                                                    *
  7083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7084*                                                                *
  7085*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7086******************************************************************
  7087
  7088 01  BENEFICIARY-MASTER.
  7089     12  BE-RECORD-ID                PIC XX.
  7090         88  VALID-BE-ID                VALUE 'BE'.
  7091
  7092     12  BE-CONTROL-PRIMARY.
  7093         16  BE-COMPANY-CD           PIC X.
  7094         16  BE-RECORD-TYPE          PIC X.
  7095             88  BENEFICIARY-RECORD  VALUE 'B'.
  7096             88  ADJUSTOR-RECORD     VALUE 'A'.
  7097         16  BE-BENEFICIARY          PIC X(10).
  7098     12  BE-CONTROL-BY-NAME.
  7099         16  BE-COMPANY-CD-A1        PIC X.
  7100         16  BE-RECORD-TYPE-A1       PIC X.
  7101         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7102         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7103
  7104     12  BE-LAST-MAINT-DT            PIC XX.
  7105     12  BE-LAST-MAINT-BY            PIC X(4).
  7106     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7107
  7108     12  BE-ADDRESS-DATA.
  7109         16  BE-MAIL-TO-NAME         PIC X(30).
  7110         16  BE-ADDRESS-LINE-1       PIC X(30).
  7111         16  BE-ADDRESS-LINE-2       PIC X(30).
  7112         16  BE-ADDRESS-LINE-3       PIC X(30).
  7113         16  BE-CITY-STATE.
  7114             20  BE-CITY             PIC X(28).
  7115             20  BE-STATE            PIC XX.
  7116         16  BE-ZIP-CODE.
  7117             20  BE-ZIP-PRIME.
  7118                 24  BE-ZIP-1ST      PIC X.
  7119                     88  BE-CANADIAN-POST-CODE
  7120                                         VALUE 'A' THRU 'Z'.
  7121                 24  FILLER          PIC X(4).
  7122             20  BE-ZIP-PLUS4        PIC X(4).
  7123         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7124             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 134
* EL156.cbl
  7125             20  BE-CAN-POSTAL-2     PIC XXX.
  7126             20  FILLER              PIC XXX.
  7127         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7128         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7129
  7130******************************************************************
  7131*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7132*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7133******************************************************************
  7134     12  BE-CARRIER                  PIC X.
  7135
  7136     12  BE-ADDRESS-DATA2.
  7137         16  BE-MAIL-TO-NAME2        PIC X(30).
  7138         16  BE-ADDRESS-LINE-12      PIC X(30).
  7139         16  BE-ADDRESS-LINE-22      PIC X(30).
  7140         16  BE-ADDRESS-LINE-32      PIC X(30).
  7141         16  BE-CITY-STATE2.
  7142             20  BE-CITY2            PIC X(28).
  7143             20  BE-STATE2           PIC XX.
  7144         16  BE-ZIP-CODE2.
  7145             20  BE-ZIP-PRIME2.
  7146                 24  BE-ZIP-1ST2     PIC X.
  7147                     88  BE-CANADIAN-POST-CODE2
  7148                                         VALUE 'A' THRU 'Z'.
  7149                 24  FILLER          PIC X(4).
  7150             20  BE-ZIP-PLUS42       PIC X(4).
  7151         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7152             20  BE-CAN-POSTAL-12    PIC XXX.
  7153             20  BE-CAN-POSTAL-22    PIC XXX.
  7154             20  FILLER              PIC XXX.
  7155         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7156         16  BE-BILLING-STMT-DATA.
  7157             20  BE-BSR              PIC X.
  7158                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7159                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7160             20  BE-BSR-FROM         PIC X(30).
  7161             20  BE-BSR-DEPT         PIC X(30).
  7162             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7163             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7164             20  BE-OUTPUT-TYPE      PIC X.
  7165                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7166                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7167
  7168     12  FILLER                      PIC X(28).
  7169******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 135
* EL156.cbl
  7171*    COPY ELCARCH.
  7172******************************************************************
  7173*                                                                *
  7174*                            ELCARCH.                            *
  7175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7176*                            VMOD=2.007                          *
  7177*                                                                *
  7178*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7179*                                                                *
  7180*   FILE TYPE = VSAM,KSDS                                        *
  7181*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7182*                                                                *
  7183*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7184*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7185*                                                                *
  7186*   LOG = NO                                                     *
  7187*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7188*                                                                *
  7189*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7190******************************************************************
  7191 01  LETTER-ARCHIVE.
  7192     12  LA-RECORD-ID                PIC XX.
  7193         88  VALID-LA-ID                VALUE 'LA'.
  7194
  7195     12  LA-CONTROL-PRIMARY.
  7196         16  LA-COMPANY-CD           PIC X.
  7197         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7198         16  LA-RECORD-TYPE          PIC X.
  7199             88  LA-HEADER-DATA         VALUE '1'.
  7200             88  LA-ADDRESS-DATA        VALUE '2'.
  7201             88  LA-TEXT-DATA           VALUE '3'.
  7202             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7203         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7204
  7205     12  LA-CONTROL-BY-TYPE.
  7206         16  LA-COMPANY-CD-A1        PIC X.
  7207         16  LA-RECORD-TYPE-A1       PIC X.
  7208         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7209         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7210
  7211     12  LA-TEXT-RECORD.
  7212         16  LA-SKIP-CONTROL         PIC XX.
  7213             88  NO-LINES-SKIPPED       VALUE SPACES.
  7214             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7215         16  LA-TEXT-LINE            PIC X(70).
  7216
  7217     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7218         16  FILLER                  PIC XX.
  7219         16  LA-ADDRESS-LINE         PIC X(30).
  7220         16  FILLER                  PIC X(40).
  7221
  7222     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7223         16  FILLER                  PIC XX.
  7224         16  LA-CARRIER              PIC X.
  7225         16  LA-CLAIM-NO             PIC X(7).
  7226         16  LA-CERT-NO.
  7227             20  LA-CERT-PRIME       PIC X(10).
  7228             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 136
* EL156.cbl
  7229         16  LA-NO-OF-COPIES         PIC S9.
  7230         16  LA-RESEND-DATE          PIC XX.
  7231         16  LA-PROCESSOR-CD         PIC X(4).
  7232         16  LA-CREATION-DT          PIC XX.
  7233         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7234         16  LA-RESEND-PRINT-DATE    PIC XX.
  7235         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7236         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7237*
  7238* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7239*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7240*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7241*   I        20  LA-DMD-RES-ST           PIC XX.
  7242*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7243*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7244*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7245*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7246*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7247*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7248*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7249*   I        20  LA-DMD-UND-CODE         PIC XX.
  7250*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7251*   V    16  FILLER                  PIC X(15).
  7252* -----
  7253*
  7254* REINSERTED  CSO  MODS
  7255*
  7256         16  FILLER.
  7257             20  FILLER                  PIC X(29).
  7258             20  LA-CSO-LETTER-STATUS    PIC X.
  7259                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7260                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7261                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7262             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7263             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7264*
  7265
  7266     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7267         16  FILLER                  PIC XX.
  7268         16  LA4-CARRIER             PIC X.
  7269         16  LA4-CLAIM-NO            PIC X(7).
  7270         16  LA4-CERT-NO.
  7271             20  LA4-CERT-PRIME      PIC X(10).
  7272             20  LA4-CERT-SFX        PIC X.
  7273         16  LA4-NO-OF-COPIES        PIC S9.
  7274         16  LA4-RESEND-DATE         PIC XX.
  7275         16  LA4-PROCESSOR-CD        PIC X(4).
  7276         16  LA4-CREATION-DT         PIC XX.
  7277         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7278         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7279         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7280         16  LA4-FORM-TYPE           PIC X.
  7281             88  LA4-INITIAL-FORM    VALUE '1'.
  7282             88  LA4-PROGRESS-FORM   VALUE '2'.
  7283         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7284         16  LA4-STATE               PIC X(02).
  7285         16  FILLER                  PIC X(31).
  7286******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 137
* EL156.cbl
  7288*    COPY ELCDAR.
  7289******************************************************************
  7290*                                                                *
  7291*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7292*   FILE TYPE = VSAM,KSDS                                        *
  7293*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7294*   BASE CLUSTER = DLYACTV                                       *
  7295*   LOG = YES                                                    *
  7296*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7297*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7298*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7299*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7300*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7301*               BY PROGRAM "LGINFCE".                            *
  7302*                                                                *
  7303******************************************************************
  7304 01  DAILY-ACTIVITY-RECORD.
  7305     05  DA-KEY.
  7306         10  DA-COMP-CD          PIC X.
  7307         10  DA-CARRIER          PIC X.
  7308         10  DA-CLAIM-NO         PIC X(7).
  7309         10  DA-CERT-NO.
  7310             15  DA-CERT-PRIME   PIC X(10).
  7311             15  DA-CERT-SFX     PIC X.
  7312     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7313     05  DA-RECORD-TYPE          PIC X.
  7314     05  FILLER                  PIC X(2).
  7315******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 138
* EL156.cbl
  7317*    COPY ERCCOMP.
  7318******************************************************************
  7319*                                                                *
  7320*                                                                *
  7321*                            ERCCOMP                             *
  7322*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7323*                            VMOD=2.019                          *
  7324*                                                                *
  7325*   ONLINE CREDIT SYSTEM                                         *
  7326*                                                                *
  7327*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7328*                                                                *
  7329*   FILE TYPE = VSAM,KSDS                                        *
  7330*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7331*                                                                *
  7332*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7333*       ALTERNATE PATH = NONE                                    *
  7334*                                                                *
  7335*   LOG = NO                                                     *
  7336*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7337*                                                                *
  7338******************************************************************
  7339*                   C H A N G E   L O G
  7340*
  7341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7342*-----------------------------------------------------------------
  7343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7344* EFFECTIVE    NUMBER
  7345*-----------------------------------------------------------------
  7346* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7347* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7348* 092205    2005050300006  PEMA  ADD LEASE FEE
  7349* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7350* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7351* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7352* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7353* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7354* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7355******************************************************************
  7356
  7357 01  COMPENSATION-MASTER.
  7358     12  CO-RECORD-ID                          PIC XX.
  7359         88  VALID-CO-ID                          VALUE 'CO'.
  7360
  7361     12  CO-CONTROL-PRIMARY.
  7362         16  CO-COMPANY-CD                     PIC X.
  7363         16  CO-CONTROL.
  7364             20  CO-CTL-1.
  7365                 24  CO-CARR-GROUP.
  7366                     28  CO-CARRIER            PIC X.
  7367                     28  CO-GROUPING.
  7368                         32  CO-GROUP-PREFIX   PIC XXX.
  7369                         32  CO-GROUP-PRIME    PIC XXX.
  7370                 24  CO-RESP-NO.
  7371                     28  CO-RESP-PREFIX        PIC X(4).
  7372                     28  CO-RESP-PRIME         PIC X(6).
  7373             20  CO-CTL-2.
  7374                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 139
* EL156.cbl
  7375                     28  CO-ACCT-PREFIX        PIC X(4).
  7376                     28  CO-ACCT-PRIME         PIC X(6).
  7377         16  CO-TYPE                           PIC X.
  7378             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7379             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7380             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7381
  7382     12  CO-MAINT-INFORMATION.
  7383         16  CO-LAST-MAINT-DT                  PIC XX.
  7384         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7385         16  CO-LAST-MAINT-USER                PIC X(4).
  7386     12  FILLER                                PIC XX.
  7387     12  CO-STMT-TYPE                          PIC XXX.
  7388     12  CO-COMP-TYPE                          PIC X.
  7389         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7390     12  CO-STMT-OWNER                         PIC X(4).
  7391     12  CO-BALANCE-CONTROL                    PIC X.
  7392         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7393         88  CO-NO-BALANCE                        VALUE 'N'.
  7394
  7395     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7396         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7397         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7398         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7399
  7400     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7401         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7402         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7403
  7404     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7405     12  CO-GA-DIRECT-DEP                      PIC X.
  7406     12  CO-FUTURE-SPACE                       PIC X.
  7407         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7408
  7409     12  CO-ACCT-NAME                          PIC X(30).
  7410     12  CO-MAIL-NAME                          PIC X(30).
  7411     12  CO-ADDR-1                             PIC X(30).
  7412     12  CO-ADDR-2                             PIC X(30).
  7413     12  CO-ADDR-3.
  7414         16  CO-ADDR-CITY                      PIC X(27).
  7415         16  CO-ADDR-STATE                     PIC XX.
  7416     12  CO-CSO-1099                           PIC X.
  7417     12  CO-ZIP.
  7418         16  CO-ZIP-PRIME.
  7419             20  CO-ZIP-PRI-1ST                PIC X.
  7420                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7421             20  FILLER                        PIC X(4).
  7422         16  CO-ZIP-PLUS4                      PIC X(4).
  7423     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7424         16  CO-CAN-POSTAL-1                   PIC XXX.
  7425         16  CO-CAN-POSTAL-2                   PIC XXX.
  7426         16  FILLER                            PIC XXX.
  7427     12  CO-SOC-SEC                            PIC X(13).
  7428     12  CO-TELEPHONE.
  7429         16  CO-AREA-CODE                      PIC XXX.
  7430         16  CO-PREFIX                         PIC XXX.
  7431         16  CO-PHONE                          PIC X(4).
  7432
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 140
* EL156.cbl
  7433     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7434
  7435     12  CO-AR-BAL-LEVEL                       PIC X.
  7436         88  CO-AR-REF-LVL                        VALUE '1'.
  7437         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7438         88  CO-AR-BILL-LVL                       VALUE '2'.
  7439         88  CO-AR-AGT-LVL                        VALUE '3'.
  7440         88  CO-AR-FR-LVL                         VALUE '4'.
  7441
  7442     12  CO-AR-NORMAL-PRINT                    PIC X.
  7443         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7444         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7445
  7446     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7447
  7448     12  CO-AR-REPORTING                       PIC X.
  7449         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7450         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7451
  7452     12  CO-AR-PULL-CHECK                      PIC X.
  7453         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7454         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7455
  7456     12  CO-AR-BALANCE-PRINT                   PIC X.
  7457         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7458
  7459     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7460         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7461         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7462         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7463
  7464     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7465
  7466     12  CO-USER-CODE                          PIC X.
  7467     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7468
  7469******************************************************************
  7470*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7471*    THE LAST MONTH END RUN.
  7472******************************************************************
  7473
  7474     12  CO-LAST-ACTIVITY-DATE.
  7475         16  CO-ACT-YEAR                       PIC 99.
  7476         16  CO-ACT-MONTH                      PIC 99.
  7477         16  CO-ACT-DAY                        PIC 99.
  7478
  7479     12  CO-LAST-STMT-DT.
  7480         16  CO-LAST-STMT-YEAR                 PIC 99.
  7481         16  CO-LAST-STMT-MONTH                PIC 99.
  7482         16  CO-LAST-STMT-DAY                  PIC 99.
  7483
  7484     12  CO-MO-END-TOTALS.
  7485         16  CO-MONTHLY-TOTALS.
  7486             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7487             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7488             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7489             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7490             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 141
* EL156.cbl
  7491
  7492         16  CO-AGING-TOTALS.
  7493             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7494             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7495             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7496             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7497
  7498         16  CO-YTD-TOTALS.
  7499             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7500             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7501
  7502         16  CO-OVER-UNDER-TOTALS.
  7503             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7504             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7505
  7506     12  CO-MISCELLANEOUS-TOTALS.
  7507         16  CO-FICA-TOTALS.
  7508             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7509             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7510
  7511         16  CO-CLAIM-TOTALS.
  7512             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7513             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7514
  7515******************************************************************
  7516*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7517*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7518******************************************************************
  7519
  7520     12  CO-CURRENT-TOTALS.
  7521         16  CO-CURRENT-LAST-STMT-DT.
  7522             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7523             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7524             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7525
  7526         16  CO-CURRENT-MONTHLY-TOTALS.
  7527             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7528             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7529             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7530             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7531             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7532
  7533         16  CO-CURRENT-AGING-TOTALS.
  7534             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7535             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7536             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7537             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7538
  7539         16  CO-CURRENT-YTD-TOTALS.
  7540             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7541             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7542
  7543     12  CO-PAID-COMM-TOTALS.
  7544         16  CO-YTD-PAID-COMMS.
  7545             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7546             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7547
  7548     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 142
* EL156.cbl
  7549         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7550         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7551
  7552     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7553         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7554         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7555         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7556         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7557         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7558         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7559         88  CO-FINAL-LETTER                  VALUE 'F'.
  7560         88  CO-RECONCILING                   VALUE 'R'.
  7561         88  CO-PHONE-CALL                    VALUE 'P'.
  7562         88  CO-LEGAL                         VALUE 'L'.
  7563         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7564         88  CO-WRITE-OFF                     VALUE 'W'.
  7565         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7566
  7567     12  CO-CSR-CODE                       PIC X(4).
  7568
  7569     12  CO-GA-STATUS-INFO.
  7570         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7571         16  CO-GA-TERMINATION-DT          PIC XX.
  7572         16  CO-GA-STATUS-CODE             PIC X.
  7573             88  CO-GA-ACTIVE                 VALUE 'A'.
  7574             88  CO-GA-INACTIVE               VALUE 'I'.
  7575             88  CO-GA-PENDING                VALUE 'P'.
  7576         16  CO-GA-COMMENTS.
  7577             20  CO-GA-COMMENT-1           PIC X(40).
  7578             20  CO-GA-COMMENT-2           PIC X(40).
  7579             20  CO-GA-COMMENT-3           PIC X(40).
  7580             20  CO-GA-COMMENT-4           PIC X(40).
  7581
  7582     12  CO-RPTCD2                         PIC X(10).
  7583     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7584         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7585         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7586
  7587     12  CO-TYPE-AGENT                     PIC X(01).
  7588         88  CO-CORPORATION                   VALUE 'C'.
  7589         88  CO-PARTNERSHIP                   VALUE 'P'.
  7590         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7591         88  CO-TRUST                         VALUE 'T'.
  7592         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7593
  7594     12  CO-FAXNO.
  7595         16  CO-FAX-AREA-CODE                  PIC XXX.
  7596         16  CO-FAX-PREFIX                     PIC XXX.
  7597         16  CO-FAX-PHONE                      PIC X(4).
  7598
  7599     12  CO-BANK-INFORMATION.
  7600         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7601         16  CO-BANK-TRANSIT-NON REDEFINES
  7602             CO-BANK-TRANSIT-NO                PIC 9(8).
  7603
  7604         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7605     12  CO-MISC-DEDUCT-INFO REDEFINES
  7606                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 143
* EL156.cbl
  7607         16  CO-MD-GL-ACCT                     PIC X(10).
  7608         16  CO-MD-DIV                         PIC XX.
  7609         16  CO-MD-CENTER                      PIC X(4).
  7610         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7611         16  CO-CREATE-AP-CHECK                PIC X.
  7612         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7613         16  FILLER                            PIC XXX.
  7614     12  CO-ACH-STATUS                         PIC X.
  7615         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7616         88  CO-ACH-PENDING                        VALUE 'P'.
  7617
  7618     12  CO-BILL-SW                            PIC X.
  7619     12  CO-CONTROL-NAME                       PIC X(30).
  7620     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7621     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7622     12  CO-CLP-STATE                          PIC XX.
  7623     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7624     12  CO-SPP-REFUND-EDIT                    PIC X.
  7625
  7626******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 144
* EL156.cbl
  7628*    COPY ERCDMDNT.
  7629******************************************************************
  7630*                                                                *
  7631*                            ERCDMDNT                            *
  7632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7633*                            VMOD=2.005                          *
  7634*                                                                *
  7635*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7636*                                                                *
  7637*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7638*                                                                *
  7639*        FILE TYPE= VSAM,KSDS                                    *
  7640*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7641*                                                                *
  7642*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7643*                                                                *
  7644*        LOG = YES                                               *
  7645*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7646*                                                                *
  7647******************************************************************
  7648
  7649 01  CERTIFICATE-NOTE.
  7650     12  CN-RECORD-ID                     PIC  XX.
  7651         88  VALID-CN-ID                      VALUE 'CN'.
  7652
  7653     12  CN-CONTROL-PRIMARY.
  7654         16  CN-COMPANY-CD                PIC X.
  7655         16  CN-CERT-KEY.
  7656             20  CN-CARRIER               PIC X.
  7657             20  CN-GROUPING.
  7658                 24  CN-GROUPING-PREFIX   PIC XXX.
  7659                 24  CN-GROUPING-PRIME    PIC XXX.
  7660             20  CN-STATE                 PIC XX.
  7661             20  CN-ACCOUNT.
  7662                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7663                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7664             20  CN-CERT-EFF-DT           PIC XX.
  7665             20  CN-CERT-NO.
  7666                 24  CN-CERT-PRIME        PIC X(10).
  7667                 24  CN-CERT-SFX          PIC X.
  7668
  7669     12  CN-BILLING-START-LINE-NO         PIC 99.
  7670     12  CN-BILLING-END-LINE-NO           PIC 99.
  7671
  7672     12  CN-LINES.
  7673         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7674
  7675     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7676         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7677         16  CN-CSI-GENERAL-DATA-AREA.
  7678             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7679
  7680         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7681             CN-CSI-GENERAL-DATA-AREA.
  7682             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7683             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7684             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7685             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 145
* EL156.cbl
  7686             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7687             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7688             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7689             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7690             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7691             20  FILLER                       PIC XX.
  7692             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7693             20  FILLER                       PIC X(38).
  7694
  7695         16  CN-CSI-PRODUCT-DATA-AREA.
  7696             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7697
  7698         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7699             CN-CSI-PRODUCT-DATA-AREA.
  7700             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7701             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7702             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7703             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7704             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7705             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7706             20  FILLER                   PIC XX.
  7707             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7708             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7709             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7710             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7711             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7712             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7713             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7714             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7715             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7716             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7717             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7718             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7719             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7720             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7721             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7722             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7723             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7724             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7725             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7726             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7727             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7728             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7729             20  FILLER                   PIC X(25).
  7730
  7731         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7732             CN-CSI-CREDIT-CARD-DATA.
  7733             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7734             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7735             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7736             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7737             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7738             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7739             20  FILLER                   PIC XX.
  7740             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7741             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7742             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7743             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 146
* EL156.cbl
  7744             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7745             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7746             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7747             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7748             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7749             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7750             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7751             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7752             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7753             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7754             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7755             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7756             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7757             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7758             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7759             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7760             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7761             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7762             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7763             20  FILLER                   PIC X(17).
  7764
  7765         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7766             CN-CSI-FAMILY-LEAVE-DATA.
  7767             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7768             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7769             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7770             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7771             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7772             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7773             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7774             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7775             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7776             20  CN-CSI-SL-INT-ON-PROCEEDS
  7777                                          PIC S9(5)V99  COMP-3.
  7778             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7779             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7780             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7781             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7782             20  CN-CSI-SL-POLICY-BENEFITS
  7783                                          PIC S9(5)V99  COMP-3.
  7784             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7785             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7786             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7787             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7788             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7789             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7790             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7791             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7792             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7793             20  CN-CSI-SL-STATE-NOT      PIC X.
  7794             20  FILLER                   PIC XX.
  7795
  7796         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7797             CN-CSI-SENIOR-LIFE-DATA.
  7798             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7799             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7800             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7801                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 147
* EL156.cbl
  7802             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7803             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7804             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7805             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7806             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7807             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7808             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7809             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7810             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7811             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7812             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7813             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7814             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7815             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7816             20  CN-CSI-PP-REPAIR         PIC X.
  7817             20  CN-CSI-PP-REPLACE        PIC X.
  7818             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7819             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7820             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7821             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7822             20  FILLER                   PIC X(5).
  7823
  7824         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7825             CN-CSI-PURCH-PROP-DATA.
  7826             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7827             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7828             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7829             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7830             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7831             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7832             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7833             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7834             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7835             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7836             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7837             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7838             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7839             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7840             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7841             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7842             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7843             20  CN-CSI-EW-REPLACE        PIC X.
  7844             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7845             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7846             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7847             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7848             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7849             20  FILLER                   PIC X(4).
  7850
  7851     12  CN-LAST-MAINT-DT                 PIC XX.
  7852     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7853     12  CN-LAST-MAINT-USER               PIC X(4).
  7854     12  FILLER                           PIC X(6).
  7855
  7856******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 148
* EL156.cbl
  7858*    COPY ERCCNOT.
  7859******************************************************************
  7860*                                                                *
  7861*                            ERCCNOT                             *
  7862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7863*                            VMOD=2.003                          *
  7864*                                                                *
  7865*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7866*                                                                *
  7867*        FILE TYPE= VSAM,KSDS                                    *
  7868*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7869*                                                                *
  7870*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7871*                                                                *
  7872*        LOG = YES                                               *
  7873*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7874*                                                                *
  7875******************************************************************
  7876*                   C H A N G E   L O G
  7877*
  7878* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7879*-----------------------------------------------------------------
  7880*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7881* EFFECTIVE    NUMBER
  7882*-----------------------------------------------------------------
  7883* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7884******************************************************************
  7885
  7886 01  CERT-NOTE-FILE.
  7887     12  CZ-RECORD-ID                PIC  XX.
  7888         88  VALID-CZ-ID                  VALUE 'CZ'.
  7889
  7890     12  CZ-CONTROL-PRIMARY.
  7891         16  CZ-COMPANY-CD           PIC X.
  7892         16  CZ-CARRIER              PIC X.
  7893         16  CZ-GROUPING.
  7894             20 CZ-GROUPING-PREFIX   PIC XXX.
  7895             20 CZ-GROUPING-PRIME    PIC XXX.
  7896         16  CZ-STATE                PIC XX.
  7897         16  CZ-ACCOUNT.
  7898             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7899             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7900         16  CZ-CERT-EFF-DT          PIC XX.
  7901         16  CZ-CERT-NO.
  7902             20  CZ-CERT-PRIME       PIC X(10).
  7903             20  CZ-CERT-SFX         PIC X.
  7904         16  CZ-RECORD-TYPE          PIC X.
  7905             88  CERT-NOTE           VALUE '1'.
  7906             88  CLAIM-CERT-NOTE     VALUE '2'.
  7907         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7908
  7909     12  CZ-LAST-MAINT-DT            PIC XX.
  7910     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7911     12  CZ-LAST-MAINT-USER          PIC X(4).
  7912
  7913     12  CZ-NOTE-INFORMATION.
  7914         16  CZ-NOTE                 PIC X(63).
  7915         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 149
* EL156.cbl
  7916******************************************************************
  7917*                            COPY ERCPDEF.
  7918******************************************************************
  7919*                                                                *
  7920*                                                                *
  7921*                            ERCPDEF.                            *
  7922*                                                                *
  7923*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7924*                                                                *
  7925*    FILE TYPE = VSAM,KSDS                                       *
  7926*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7927*                                                                *
  7928*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7929*                                                                *
  7930*    LOG = YES                                                   *
  7931*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7932******************************************************************
  7933*                   C H A N G E   L O G
  7934*
  7935* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7936*-----------------------------------------------------------------
  7937*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7938* EFFECTIVE    NUMBER
  7939*-----------------------------------------------------------------
  7940* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7941* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7942* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7943******************************************************************
  7944 01  PRODUCT-MASTER.
  7945    12  PD-RECORD-ID                 PIC X(02).
  7946        88  VALID-PD-ID                  VALUE 'PD'.
  7947    12  PD-CONTROL-PRIMARY.
  7948        16  PD-COMPANY-CD            PIC X.
  7949        16  PD-STATE                 PIC XX.
  7950        16  PD-PRODUCT-CD            PIC XXX.
  7951        16  PD-FILLER                PIC X(7).
  7952        16  PD-BEN-TYPE              PIC X.
  7953        16  PD-BEN-CODE              PIC XX.
  7954        16  PD-PROD-EXP-DT           PIC XX.
  7955    12  FILLER                       PIC X(50).
  7956    12  PD-PRODUCT-DATA OCCURS 8.
  7957        16  PD-PROD-CODE             PIC X.
  7958            88  PD-PROD-LIFE           VALUE 'L'.
  7959            88  PD-PROD-PROP           VALUE 'P'.
  7960            88  PD-PROD-AH             VALUE 'A'.
  7961            88  PD-PROD-IU             VALUE 'I'.
  7962            88  PD-PROD-GAP            VALUE 'G'.
  7963            88  PD-PROD-FAML           VALUE 'F'.
  7964        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7965        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7966        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7967        16  PD-MAX-TERM              PIC S999        COMP-3.
  7968        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7969        16  FILLER                   PIC X.
  7970        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7971        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7972        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7973        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 150
* EL156.cbl
  7974        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7975        16  PD-REC-CRIT-PERIOD       PIC 99.
  7976        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7977            20  PD-RECURRING-YN      PIC X.
  7978            20  FILLER               PIC X.
  7979        16  PD-RTW-MOS               PIC 99.
  7980        16  PD-MAX-EXTENSION         PIC 99.
  7981        16  pd-ben-pct               pic sv999 comp-3.
  7982*       16  FILLER                   PIC XX.
  7983    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7984    12  PD-TERM-LIMITS OCCURS 15.
  7985        16  PD-LOW-TERM              PIC S999        COMP-3.
  7986        16  PD-HI-TERM               PIC S999        COMP-3.
  7987*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7988    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7989        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7990        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7991    12  PD-EARN-FACTORS.
  7992        16  FILLER OCCURS 15.
  7993            20  FILLER OCCURS 15.
  7994                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7995    12  PD-PRODUCT-DESC              PIC X(80).
  7996    12  PD-TRUNCATED                 PIC X.
  7997    12  FILLER                       PIC X(59).
  7998    12  PD-MAINT-INFORMATION.
  7999        16  PD-LAST-MAINT-DT         PIC X(02).
  8000        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8001        16  PD-LAST-MAINT-BY         PIC X(04).
  8002*                            COPY ELCCRTT.
  8003******************************************************************
  8004*                                                                *
  8005*                            ELCCRTT.                            *
  8006*                                                                *
  8007*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8008*                                                                *
  8009*   FILE TYPE = VSAM,KSDS                                        *
  8010*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8011*                                                                *
  8012*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8013*                                                                *
  8014*   LOG = YES                                                    *
  8015*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8016******************************************************************
  8017*                   C H A N G E   L O G
  8018*
  8019* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8020*-----------------------------------------------------------------
  8021*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8022* EFFECTIVE    NUMBER
  8023*-----------------------------------------------------------------
  8024* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8025* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8026* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8027* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8028* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8029* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8030* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8031******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 151
* EL156.cbl
  8032
  8033 01  CERTIFICATE-TRAILERS.
  8034     12  CS-RECORD-ID                      PIC XX.
  8035         88  VALID-CS-ID                      VALUE 'CS'.
  8036
  8037     12  CS-CONTROL-PRIMARY.
  8038         16  CS-COMPANY-CD                 PIC X.
  8039         16  CS-CARRIER                    PIC X.
  8040         16  CS-GROUPING                   PIC X(6).
  8041         16  CS-STATE                      PIC XX.
  8042         16  CS-ACCOUNT                    PIC X(10).
  8043         16  CS-CERT-EFF-DT                PIC XX.
  8044         16  CS-CERT-NO.
  8045             20  CS-CERT-PRIME             PIC X(10).
  8046             20  CS-CERT-SFX               PIC X.
  8047         16  CS-TRAILER-TYPE               PIC X.
  8048             88  COMM-TRLR           VALUE 'A'.
  8049             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8050             88  CERT-DATA-TRLR      VALUE 'C'.
  8051
  8052     12  CS-DATA-AREA                      PIC X(516).
  8053
  8054     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8055         16  CS-BANK-COMMISSION-AREA.
  8056             20  CS-BANK-COMMS       OCCURS 10.
  8057                 24  CS-AGT                PIC X(10).
  8058                 24  CS-COM-TYP            PIC X.
  8059                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8060                 24  CS-RECALC-LV-INDIC    PIC X.
  8061                 24  FILLER                PIC X(10).
  8062         16  FILLER                        PIC X(256).
  8063
  8064     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8065****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8066         16  CS-MB-CLAIM-DATA OCCURS 24.
  8067             20  CS-CLAIM-NO               PIC X(7).
  8068             20  CS-CLAIM-TYPE             PIC X.
  8069                 88  CS-AH-CLM               VALUE 'A'.
  8070                 88  CS-IU-CLM               VALUE 'I'.
  8071                 88  CS-GP-CLM               VALUE 'G'.
  8072                 88  CS-LF-CLM               VALUE 'L'.
  8073                 88  CS-PR-CLM               VALUE 'P'.
  8074                 88  CS-FL-CLM               VALUE 'F'.
  8075             20  CS-INSURED-TYPE           PIC X.
  8076                 88  CS-PRIM-INSURED          VALUE 'P'.
  8077                 88  CS-CO-BORROWER           VALUE 'C'.
  8078             20  CS-BENEFIT-PERIOD         PIC 99.
  8079             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8080             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8081             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8082         16  FILLER                        PIC X(12).
  8083     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8084         16  CS-VIN-NUMBER                 PIC X(17).
  8085         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8086         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8087         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8088         16  FILLER                        PIC X(496).
  8089 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 152
* EL156.cbl
  8090                          CONTROL-FILE CERTIFICATE-MASTER
  8091                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8092                          ACCOUNT-MASTER CHECK-QUE
  8093                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8094                          DAILY-ACTIVITY-RECORD
  8095                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8096                          CERT-NOTE-FILE PRODUCT-MASTER
  8097                          CERTIFICATE-TRAILERS.
  8098 0000-DFHEXIT SECTION.
  8099     MOVE '9#                    $   ' TO DFHEIV0.
  8100     MOVE 'EL156' TO DFHEIV1.
  8101     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8102
  8103     IF EIBCALEN = 0
  8104         GO TO 8800-UNAUTHORIZED-ACCESS.
  8105
  8106     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8107     MOVE EIBTRMID               TO QID-TERM.
  8108     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8109     MOVE '2'                    TO EMI-SWITCH2.
  8110     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8111     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8112
  8113     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8114     MOVE '5'                    TO DC-OPTION-CODE.
  8115     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8116     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8117                                    SAVE-BIN-DATE.
  8118     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8119     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8120
  8121     IF SAVE-DATE-YY > 70
  8122         MOVE 19                 TO SAVE-DATE-CC
  8123     ELSE
  8124         MOVE 20                 TO SAVE-DATE-CC.
  8125
  8126     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8127         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8128     END-IF.
  8129
  8130     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8131        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8132     ELSE
  8133        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8134     END-IF
  8135
  8136     IF PI-PRINT-CLM-FRM-YN = 'N'
  8137         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8138     ELSE
  8139         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8140     END-IF
  8141
  8142     IF PI-PRINT-SURVEY-YN = 'N'
  8143         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8144     ELSE
  8145         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8146     END-IF
  8147
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 153
* EL156.cbl
  8148     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8149         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8150     ELSE
  8151         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8152     END-IF
  8153
  8154* EXEC CICS HANDLE CONDITION
  8155*        NOTOPEN   (9990-ABEND)
  8156*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8157*        MAPFAIL   (0400-FIRST-TIME)
  8158*        DUPREC    (6180-DUPREC)
  8159*        ERROR     (9990-ABEND)
  8160*    END-EXEC.
  8161*    MOVE '"$JL?%.               ! " #00008149' TO DFHEIV0
  8162     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8163     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8164     MOVE X'2220233030303038313439' TO DFHEIV0(25:11)
  8165     CALL 'kxdfhei1' USING DFHEIV0
  8166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8167
  8168
  8169     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8170         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8171
  8172     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8173         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8174             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8175             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8176             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8177             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8178             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8179             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8180             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8181             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8182             MOVE LOW-VALUES           TO EL156AI
  8183             MOVE 'Y'                  TO FIRST-ENTRY
  8184         ELSE
  8185             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8186             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8187             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8188             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8189             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8190             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8191             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8192             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8193
  8194     IF RETURNED-FROM NOT = SPACES
  8195        IF (RETURNED-FROM = 'EL614')
  8196           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8197           IF WS-SAVED-EOB-CODES NOT = SPACES
  8198              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8199           ELSE
  8200              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8201           END-IF
  8202        END-IF
  8203         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8204            MOVE 'Y'             TO FIRST-ENTRY
  8205            IF RETURNED-FROM = 'EL614'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 154
* EL156.cbl
  8206               AND (PI-PASS-SW NOT = 'C')
  8207               IF WS-SAVED-EOB-CODES NOT = SPACES
  8208                  MOVE WS-SAVED-EOB-CODES
  8209                                 TO PI-PMTNOTE2
  8210                                    WS-PMTNOTE2
  8211                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8212               ELSE
  8213                  MOVE SPACES    TO PI-PMTNOTE2
  8214                                    WS-PMTNOTE2
  8215                                    PI-EOB-CODES-EXIST
  8216               END-IF
  8217            END-IF
  8218            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8219            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8220            IF RETURNED-FROM = 'EL614'
  8221               GO TO 1000-EDIT-DATA
  8222            END-IF
  8223            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8224               (PAYEEI   = LOW-VALUES OR SPACES)
  8225               GO TO 8100-SEND-INITIAL-MAP
  8226            ELSE
  8227               GO TO 1000-EDIT-DATA.
  8228
  8229     IF EIBTRNID NOT = TRANS-ID
  8230         GO TO 0400-FIRST-TIME.
  8231
  8232     IF EIBAID = DFHCLEAR
  8233        IF PI-PASS-SW = 'C'
  8234           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8235           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8236           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8237           MOVE 'Y'            TO RETURNED-FROM-B
  8238           GO TO 1000-EDIT-DATA
  8239        ELSE
  8240           GO TO 9400-CLEAR.
  8241
  8242     IF PI-PASS-SW = 'C'
  8243         MOVE MAP-NAMEB          TO MAP-NAME
  8244         IF EIBAID = DFHPF1 OR DFHPF13
  8245             GO TO 5000-UPDATE
  8246           ELSE
  8247             IF EIBAID NOT = DFHENTER
  8248                 MOVE LOW-VALUES TO EL156BI
  8249                 MOVE MAP-NAMEB  TO MAP-NAME
  8250                 MOVE ER-0029    TO EMI-ERROR
  8251                 MOVE -1         TO  ENTPFBL
  8252                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8253                 GO TO 8200-SEND-DATAONLY.
  8254
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 155
* EL156.cbl
  8256 0200-RECEIVE.
  8257     MOVE LOW-VALUES             TO EL156AI.
  8258     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8259         MOVE ER-0008            TO EMI-ERROR
  8260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8261         IF PI-PASS-SW = 'C'
  8262             MOVE -1             TO ENTPFBL
  8263             GO TO 8200-SEND-DATAONLY
  8264         ELSE
  8265             MOVE -1             TO PMTTYPEL
  8266             GO TO 8200-SEND-DATAONLY.
  8267
  8268     IF PI-COMPANY-ID = 'DMD'
  8269         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8270
  8271     IF PI-PASS-SW = 'C'
  8272         MOVE MAP-NAMEB          TO MAP-NAME.
  8273
  8274
  8275* EXEC CICS RECEIVE
  8276*        MAP   (MAP-NAME)
  8277*        MAPSET(MAPSET-NAME)
  8278*        ASIS
  8279*        INTO  (EL156AI)
  8280*    END-EXEC.
  8281     MOVE LENGTH OF
  8282      EL156AI
  8283       TO DFHEIV11
  8284*    MOVE '8"TAI  L              ''   #00008262' TO DFHEIV0
  8285     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8286     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8287     MOVE X'2020233030303038323632' TO DFHEIV0(25:11)
  8288     CALL 'kxdfhei1' USING DFHEIV0,
  8289           MAP-NAME,
  8290           EL156AI,
  8291           DFHEIV11,
  8292           MAPSET-NAME,
  8293           DFHEIV99,
  8294           DFHEIV99
  8295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8296
  8297
  8298     IF PI-PASS-SW NOT = 'C'
  8299         GO TO 0250-MAPA.
  8300
  8301     IF ENTPFBL NOT > ZERO
  8302         MOVE MAP-NAMEB          TO MAP-NAME
  8303         MOVE ER-0029            TO EMI-ERROR
  8304         MOVE -1                 TO  ENTPFBL
  8305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8306         GO TO 8200-SEND-DATAONLY.
  8307
  8308     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8309         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8310       ELSE
  8311         MOVE MAP-NAMEB           TO MAP-NAME
  8312         MOVE ER-0029             TO EMI-ERROR
  8313         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 156
* EL156.cbl
  8314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8315         GO TO 8200-SEND-DATAONLY.
  8316
  8317     IF EIBAID = DFHPF1 OR DFHPF13
  8318         IF MODIFY-CAP
  8319            GO TO 5000-UPDATE
  8320          ELSE
  8321            MOVE 'UPDATE'           TO SM-READ
  8322            PERFORM 9995-SECURITY-VIOLATION
  8323            MOVE MAP-NAMEB          TO MAP-NAME
  8324            MOVE ER-0070            TO EMI-ERROR
  8325            MOVE -1                 TO  ENTPFBL
  8326            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327            GO TO 8200-SEND-DATAONLY.
  8328
  8329 0250-MAPA.
  8330     IF ENTERPFL = 0
  8331         GO TO 0300-CHECK-PFKEYS.
  8332
  8333     IF EIBAID NOT = DFHENTER
  8334         MOVE ER-0004            TO EMI-ERROR
  8335         GO TO 0320-INPUT-ERROR.
  8336
  8337     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8338         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8339     ELSE
  8340         MOVE ER-0029            TO EMI-ERROR
  8341         GO TO 0320-INPUT-ERROR.
  8342
  8343 0300-CHECK-PFKEYS.
  8344     IF EIBAID = DFHPF7 OR DFHPF8
  8345         GO TO 8820-PF7-8.
  8346
  8347     IF EIBAID = DFHPF23
  8348         GO TO 8810-PF23.
  8349
  8350     IF EIBAID = DFHPF24
  8351         GO TO 9200-RETURN-MAIN-MENU.
  8352
  8353     IF EIBAID = DFHPF12
  8354         GO TO 9500-PF12.
  8355
  8356     IF EIBAID = DFHPF1
  8357        IF PI-PASS-SW = 'A' OR 'B'
  8358          GO TO 0330-BROWSE-FORWARD.
  8359
  8360     IF EIBAID = DFHPF2
  8361        IF PI-PASS-SW = 'A' OR 'B'
  8362          GO TO 0350-BROWSE-BACKWARD.
  8363
  8364     IF EIBAID = DFHPF6
  8365        IF PI-EOB-CODES-EXIST = 'Y'
  8366           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8367        ELSE
  8368           MOVE SPACES              TO WS-PMTNOTE2
  8369        END-IF
  8370         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8371         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 157
* EL156.cbl
  8372            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8373         END-IF
  8374         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8375         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8376             MOVE 'EL614'        TO PGM-NAME
  8377             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8378             GO TO 9300-XCTL
  8379         ELSE
  8380             MOVE XCTL-157       TO PGM-NAME
  8381             GO TO 9300-XCTL.
  8382
  8383     IF EIBAID = DFHPF9
  8384        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8385        MOVE XCTL-141            TO PGM-NAME
  8386        GO TO 9300-XCTL.
  8387
  8388     IF EIBAID = DFHPF10
  8389        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8390        MOVE XCTL-155            TO PGM-NAME
  8391        GO TO 9300-XCTL.
  8392
  8393     MOVE SPACES                 TO ERRMSG0O
  8394                                    ERRMSG1O
  8395                                    ERRMSG2O.
  8396
  8397     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8398         IF PI-PASS-SW NOT = 'B'
  8399             MOVE ER-0422        TO EMI-ERROR
  8400             GO TO 0320-INPUT-ERROR
  8401           ELSE
  8402             GO TO 0700-TEST-FOR-CHANGES.
  8403
  8404     IF EIBAID = DFHPF11
  8405        IF PI-PASS-SW = 'C'
  8406           MOVE ER-0029          TO EMI-ERROR
  8407           GO TO 0320-INPUT-ERROR.
  8408
  8409     IF EIBAID = DFHENTER OR DFHPF11
  8410        NEXT SENTENCE
  8411     ELSE
  8412        MOVE ER-0029             TO EMI-ERROR
  8413        GO TO 0320-INPUT-ERROR.
  8414
  8415     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8416
  8417     if pi-epyfrom not = zeros
  8418        if pi-epyfrom not = ws-epyfrom
  8419           move zeros        to ws-edays
  8420        end-if
  8421     end-if
  8422
  8423     if pi-epythru not = zeros
  8424        if pi-epythru not = ws-epythru
  8425           move zeros        to ws-edays
  8426        end-if
  8427     end-if
  8428
  8429     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 158
* EL156.cbl
  8430         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8431         GO TO 1000-EDIT-DATA
  8432     ELSE
  8433         IF PI-FATAL-COUNT NOT = 0 OR
  8434            PI-FORCE-COUNT NOT = 0
  8435             GO TO 1000-EDIT-DATA
  8436         ELSE
  8437             GO TO 2000-EDIT-DONE.
  8438
  8439 0320-INPUT-ERROR.
  8440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8441
  8442     IF ENTERPFL = 0
  8443         MOVE -1                 TO PMTTYPEL
  8444     ELSE
  8445         MOVE AL-UNBON           TO ENTERPFA
  8446         MOVE -1                 TO ENTERPFL.
  8447
  8448     GO TO 8200-SEND-DATAONLY.
  8449
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 159
* EL156.cbl
  8451 0330-BROWSE-FORWARD.
  8452
  8453     MOVE CLMNOI            TO PI-CLAIM-NO.
  8454     MOVE CARRI             TO PI-CARRIER.
  8455     MOVE CERTNOI           TO PI-CERT-PRIME.
  8456     MOVE SUFXI             TO PI-CERT-SFX.
  8457
  8458     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8459     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8460     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8461     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8462
  8463     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8464
  8465
  8466* EXEC CICS HANDLE CONDITION
  8467*         NOTFND   (0380-CLAIM-END-FILE)
  8468*         ENDFILE  (0380-CLAIM-END-FILE)
  8469*    END-EXEC.
  8470*    MOVE '"$I''                  ! # #00008436' TO DFHEIV0
  8471     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8473     MOVE X'2320233030303038343336' TO DFHEIV0(25:11)
  8474     CALL 'kxdfhei1' USING DFHEIV0
  8475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8476
  8477
  8478
  8479* EXEC CICS STARTBR
  8480*         DATASET    ('ELMSTR')
  8481*         RIDFLD     (ELMSTR-KEY)
  8482*         GTEQ
  8483*    END-EXEC.
  8484     MOVE 'ELMSTR' TO DFHEIV1
  8485     MOVE 0
  8486       TO DFHEIV11
  8487*    MOVE '&,         G          &   #00008441' TO DFHEIV0
  8488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8490     MOVE X'2020233030303038343431' TO DFHEIV0(25:11)
  8491     CALL 'kxdfhei1' USING DFHEIV0,
  8492           DFHEIV1,
  8493           ELMSTR-KEY,
  8494           DFHEIV99,
  8495           DFHEIV11,
  8496           DFHEIV99
  8497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8498
  8499
  8500     MOVE 'Y' TO WS-BROWSE-START-SW.
  8501
  8502 0335-READNEXT.
  8503
  8504
  8505* EXEC CICS READNEXT
  8506*         DATASET    ('ELMSTR')
  8507*         RIDFLD     (ELMSTR-KEY)
  8508*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 160
* EL156.cbl
  8509*    END-EXEC.
  8510     MOVE 'ELMSTR' TO DFHEIV1
  8511     MOVE 0
  8512       TO DFHEIV11
  8513*    MOVE '&.S                   )   #00008451' TO DFHEIV0
  8514     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8515     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8516     MOVE X'2020233030303038343531' TO DFHEIV0(25:11)
  8517     CALL 'kxdfhei1' USING DFHEIV0,
  8518           DFHEIV1,
  8519           DFHEIV20,
  8520           DFHEIV99,
  8521           ELMSTR-KEY,
  8522           DFHEIV99,
  8523           DFHEIV11,
  8524           DFHEIV99,
  8525           DFHEIV99
  8526     SET ADDRESS OF CLAIM-MASTER TO
  8527         DFHEIV20
  8528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8529
  8530
  8531     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8532        GO TO 0380-CLAIM-END-FILE.
  8533
  8534     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8535        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8536        GO TO 0335-READNEXT.
  8537
  8538     IF PI-COMPANY-ID = 'CRI'
  8539         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8540            GO TO 0380-CLAIM-END-FILE.
  8541
  8542     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8543         GO TO 0335-READNEXT.
  8544
  8545     IF PI-CARRIER-SECURITY > SPACES
  8546         IF CL-CARRIER = PI-CARRIER-SECURITY
  8547             NEXT SENTENCE
  8548         ELSE
  8549             GO TO 0335-READNEXT.
  8550
  8551     IF PI-ACCOUNT-SECURITY > SPACES
  8552         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8553             NEXT SENTENCE
  8554         ELSE
  8555             GO TO 0335-READNEXT.
  8556
  8557     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8558     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8559     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8560
  8561     GO TO 0400-FIRST-TIME.
  8562
  8563 0350-BROWSE-BACKWARD.
  8564
  8565     MOVE CLMNOI            TO PI-CLAIM-NO
  8566                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 161
* EL156.cbl
  8567     MOVE CARRI             TO PI-CARRIER.
  8568     MOVE CERTNOI           TO PI-CERT-PRIME.
  8569     MOVE SUFXI             TO PI-CERT-SFX.
  8570
  8571     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8572
  8573     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8574     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8575     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8576
  8577
  8578* EXEC CICS HANDLE CONDITION
  8579*         NOTFND   (0380-CLAIM-END-FILE)
  8580*         ENDFILE  (0380-CLAIM-END-FILE)
  8581*    END-EXEC.
  8582*    MOVE '"$I''                  ! $ #00008503' TO DFHEIV0
  8583     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8585     MOVE X'2420233030303038353033' TO DFHEIV0(25:11)
  8586     CALL 'kxdfhei1' USING DFHEIV0
  8587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8588
  8589
  8590
  8591* EXEC CICS STARTBR
  8592*         DATASET    ('ELMSTR')
  8593*         RIDFLD     (ELMSTR-KEY)
  8594*         GTEQ
  8595*    END-EXEC.
  8596     MOVE 'ELMSTR' TO DFHEIV1
  8597     MOVE 0
  8598       TO DFHEIV11
  8599*    MOVE '&,         G          &   #00008508' TO DFHEIV0
  8600     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303038353038' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           DFHEIV1,
  8605           ELMSTR-KEY,
  8606           DFHEIV99,
  8607           DFHEIV11,
  8608           DFHEIV99
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8610
  8611
  8612     MOVE 'Y' TO WS-BROWSE-START-SW.
  8613
  8614
  8615* EXEC CICS READNEXT
  8616*         DATASET    ('ELMSTR')
  8617*         RIDFLD     (ELMSTR-KEY)
  8618*         SET        (ADDRESS OF CLAIM-MASTER)
  8619*    END-EXEC.
  8620     MOVE 'ELMSTR' TO DFHEIV1
  8621     MOVE 0
  8622       TO DFHEIV11
  8623*    MOVE '&.S                   )   #00008516' TO DFHEIV0
  8624     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 162
* EL156.cbl
  8625     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8626     MOVE X'2020233030303038353136' TO DFHEIV0(25:11)
  8627     CALL 'kxdfhei1' USING DFHEIV0,
  8628           DFHEIV1,
  8629           DFHEIV20,
  8630           DFHEIV99,
  8631           ELMSTR-KEY,
  8632           DFHEIV99,
  8633           DFHEIV11,
  8634           DFHEIV99,
  8635           DFHEIV99
  8636     SET ADDRESS OF CLAIM-MASTER TO
  8637         DFHEIV20
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8639
  8640
  8641
  8642* EXEC CICS READPREV
  8643*         DATASET    ('ELMSTR')
  8644*         RIDFLD     (ELMSTR-KEY)
  8645*         SET        (ADDRESS OF CLAIM-MASTER)
  8646*    END-EXEC.
  8647     MOVE 'ELMSTR' TO DFHEIV1
  8648     MOVE 0
  8649       TO DFHEIV11
  8650*    MOVE '&0S                   )   #00008522' TO DFHEIV0
  8651     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8652     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8653     MOVE X'2020233030303038353232' TO DFHEIV0(25:11)
  8654     CALL 'kxdfhei1' USING DFHEIV0,
  8655           DFHEIV1,
  8656           DFHEIV20,
  8657           DFHEIV99,
  8658           ELMSTR-KEY,
  8659           DFHEIV99,
  8660           DFHEIV11,
  8661           DFHEIV99,
  8662           DFHEIV99
  8663     SET ADDRESS OF CLAIM-MASTER TO
  8664         DFHEIV20
  8665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8666
  8667
  8668 0360-BROWSE-BACKWARD.
  8669
  8670
  8671* EXEC CICS READPREV
  8672*         DATASET    ('ELMSTR')
  8673*         RIDFLD     (ELMSTR-KEY)
  8674*         SET        (ADDRESS OF CLAIM-MASTER)
  8675*    END-EXEC.
  8676     MOVE 'ELMSTR' TO DFHEIV1
  8677     MOVE 0
  8678       TO DFHEIV11
  8679*    MOVE '&0S                   )   #00008530' TO DFHEIV0
  8680     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8682     MOVE X'2020233030303038353330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 163
* EL156.cbl
  8683     CALL 'kxdfhei1' USING DFHEIV0,
  8684           DFHEIV1,
  8685           DFHEIV20,
  8686           DFHEIV99,
  8687           ELMSTR-KEY,
  8688           DFHEIV99,
  8689           DFHEIV11,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     SET ADDRESS OF CLAIM-MASTER TO
  8693         DFHEIV20
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8695
  8696
  8697     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8698        GO TO 0380-CLAIM-END-FILE.
  8699
  8700     IF PI-COMPANY-ID = 'CRI'
  8701         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8702            GO TO 0380-CLAIM-END-FILE.
  8703
  8704     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8705         GO TO 0360-BROWSE-BACKWARD.
  8706
  8707     IF PI-CARRIER-SECURITY > SPACES
  8708         IF CL-CARRIER = PI-CARRIER-SECURITY
  8709             NEXT SENTENCE
  8710         ELSE
  8711             GO TO 0360-BROWSE-BACKWARD.
  8712
  8713     IF PI-ACCOUNT-SECURITY > SPACES
  8714         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8715             NEXT SENTENCE
  8716         ELSE
  8717             GO TO 0360-BROWSE-BACKWARD.
  8718
  8719     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8720     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8721     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8722
  8723     GO TO 0400-FIRST-TIME.
  8724
  8725 0380-CLAIM-END-FILE.
  8726
  8727     MOVE ER-0130     TO EMI-ERROR.
  8728     MOVE -1          TO CLMNOL.
  8729     MOVE AL-UABON    TO CARRA
  8730                         CLMNOA
  8731                         CERTNOA
  8732                         SUFXA.
  8733
  8734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8735
  8736     GO TO 8200-SEND-DATAONLY.
  8737
  8738 0400-FIRST-TIME.
  8739
  8740     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 164
* EL156.cbl
  8741        MOVE 'N'         TO WS-BROWSE-START-SW
  8742
  8743* EXEC CICS ENDBR
  8744*            DATASET    ('ELMSTR')
  8745*       END-EXEC.
  8746     MOVE 'ELMSTR' TO DFHEIV1
  8747     MOVE 0
  8748       TO DFHEIV11
  8749*    MOVE '&2                    $   #00008581' TO DFHEIV0
  8750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8752     MOVE X'2020233030303038353831' TO DFHEIV0(25:11)
  8753     CALL 'kxdfhei1' USING DFHEIV0,
  8754           DFHEIV1,
  8755           DFHEIV11,
  8756           DFHEIV99
  8757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8758
  8759
  8760     IF PI-PROCESSOR-ID = 'LGXX'
  8761         NEXT SENTENCE
  8762     ELSE
  8763
  8764* EXEC CICS READQ TS
  8765*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8766*            INTO    (SECURITY-CONTROL)
  8767*            LENGTH  (SC-COMM-LENGTH)
  8768*            ITEM    (SC-ITEM)
  8769*        END-EXEC
  8770*    MOVE '*$II   L              ''   #00008588' TO DFHEIV0
  8771     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8772     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8773     MOVE X'2020233030303038353838' TO DFHEIV0(25:11)
  8774     CALL 'kxdfhei1' USING DFHEIV0,
  8775           PI-SECURITY-TEMP-STORE-ID,
  8776           SECURITY-CONTROL,
  8777           SC-COMM-LENGTH,
  8778           SC-ITEM,
  8779           DFHEIV99,
  8780           DFHEIV99
  8781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8782         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8783         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8784
  8785     MOVE LOW-VALUES             TO EL156AI.
  8786     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8787     MOVE 'Y'                    TO FIRST-ENTRY.
  8788     GO TO 7000-SHOW-CLAIM.
  8789
  8790 0500-CREATE-TEMP-STORAGE.
  8791     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8792
  8793
  8794* EXEC CICS WRITEQ TS
  8795*        QUEUE (QID)
  8796*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8797*        LENGTH(PI-COMM-LENGTH)
  8798*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 165
* EL156.cbl
  8799*    MOVE '*"                    ''   #00008605' TO DFHEIV0
  8800     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8802     MOVE X'2020233030303038363035' TO DFHEIV0(25:11)
  8803     CALL 'kxdfhei1' USING DFHEIV0,
  8804           QID,
  8805           PROGRAM-INTERFACE-BLOCK,
  8806           PI-COMM-LENGTH,
  8807           DFHEIV99,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8811
  8812
  8813
  8814* EXEC CICS WRITEQ TS
  8815*        QUEUE (QID)
  8816*        FROM  (EL156AI)
  8817*        LENGTH(MAP-LENGTH)
  8818*    END-EXEC.
  8819*    MOVE '*"                    ''   #00008611' TO DFHEIV0
  8820     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8822     MOVE X'2020233030303038363131' TO DFHEIV0(25:11)
  8823     CALL 'kxdfhei1' USING DFHEIV0,
  8824           QID,
  8825           EL156AI,
  8826           MAP-LENGTH,
  8827           DFHEIV99,
  8828           DFHEIV99,
  8829           DFHEIV99
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8831
  8832
  8833 0599-EXIT.
  8834      EXIT.
  8835
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 166
* EL156.cbl
  8837 0600-RECOVER-TEMP-STORAGE.
  8838
  8839* EXEC CICS READQ TS
  8840*        QUEUE (QID)
  8841*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8842*        LENGTH(PI-COMM-LENGTH)
  8843*    END-EXEC.
  8844*    MOVE '*$I    L              ''   #00008622' TO DFHEIV0
  8845     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8846     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8847     MOVE X'2020233030303038363232' TO DFHEIV0(25:11)
  8848     CALL 'kxdfhei1' USING DFHEIV0,
  8849           QID,
  8850           PROGRAM-INTERFACE-BLOCK,
  8851           PI-COMM-LENGTH,
  8852           DFHEIV99,
  8853           DFHEIV99,
  8854           DFHEIV99
  8855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8856
  8857
  8858
  8859* EXEC CICS READQ TS
  8860*        QUEUE (QID)
  8861*        INTO  (EL156AI)
  8862*        LENGTH(MAP-LENGTH)
  8863*    END-EXEC.
  8864*    MOVE '*$I    L              ''   #00008628' TO DFHEIV0
  8865     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8867     MOVE X'2020233030303038363238' TO DFHEIV0(25:11)
  8868     CALL 'kxdfhei1' USING DFHEIV0,
  8869           QID,
  8870           EL156AI,
  8871           MAP-LENGTH,
  8872           DFHEIV99,
  8873           DFHEIV99,
  8874           DFHEIV99
  8875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8876
  8877
  8878     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8879
  8880     IF PMTTYPEI NOT = LOW-VALUES
  8881         MOVE AL-UANON           TO PMTTYPEA.
  8882
  8883     IF PAYEEI NOT = LOW-VALUES
  8884         MOVE AL-UANON           TO PAYEEA.
  8885
  8886     IF NOTE1I NOT = LOW-VALUES
  8887         MOVE AL-UANON           TO NOTE1A.
  8888
  8889     IF (RETURNED-FROM = 'EL614')
  8890        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8891     END-IF
  8892*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8893*       AND (PI-EOB-CODES-EXIST = 'Y')
  8894*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 167
* EL156.cbl
  8895*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8896     IF PI-SET-NOTE2-MDT = 'Y'
  8897         MOVE AL-SANON           TO NOTE2A
  8898     END-IF
  8899
  8900     IF OFFLINEI NOT = LOW-VALUES
  8901         MOVE AL-UANON           TO OFFLINEA.
  8902
  8903*    IF GROUPEDI NOT = LOW-VALUES
  8904*        MOVE AL-UANON           TO GROUPEDA.
  8905
  8906*    IF CASHI NOT = LOW-VALUES
  8907*        MOVE AL-UANON           TO CASHA.
  8908
  8909     IF CHECKNOI NOT = LOW-VALUES
  8910         MOVE AL-UANON           TO CHECKNOA.
  8911
  8912     IF HOLDTILI NOT = LOW-VALUES
  8913         MOVE AL-UANON           TO HOLDTILA.
  8914
  8915     IF EPYFROMI NOT = LOW-VALUES
  8916         MOVE AL-UANON           TO EPYFROMA.
  8917
  8918     IF AIGFROMI NOT = LOW-VALUES
  8919         MOVE AL-UANON           TO AIGFROMA.
  8920
  8921     IF EPYTHRUI NOT = LOW-VALUES
  8922         MOVE AL-UANON           TO EPYTHRUA.
  8923
  8924     IF EDAYSI NOT = LOW-VALUES
  8925         MOVE AL-UNNON           TO EDAYSA.
  8926
  8927     IF EPYAMTL NOT = +0
  8928         MOVE AL-UNNON           TO EPYAMTA.
  8929
  8930     IF ERESVL NOT = +0
  8931         MOVE AL-UNNON           TO ERESVA.
  8932
  8933     IF EEXPENSL NOT = +0
  8934         MOVE AL-UNNON           TO EEXPENSA.
  8935
  8936     IF ETYPEI NOT = LOW-VALUES
  8937         MOVE AL-UNNON           TO ETYPEA.
  8938
  8939     IF PROOFDTI NOT = 0
  8940         MOVE AL-UNNON           TO PROOFDTA.
  8941
  8942     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8943        MOVE AL-UANON            TO EOBYNA
  8944     END-IF
  8945     IF CLMFMYNI = 'Y' OR 'N'
  8946        MOVE AL-UANON            TO CLMFMYNA
  8947     END-IF
  8948
  8949     IF SURVYYNI = 'Y' OR 'N'
  8950        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8951           MOVE AL-UANON         TO SURVYYNA
  8952        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 168
* EL156.cbl
  8953     END-IF
  8954
  8955     IF SPRELYNI = 'Y' OR 'N'
  8956        MOVE AL-UANON            TO SPRELYNA
  8957     END-IF
  8958
  8959     .
  8960 0699-EXIT.
  8961      EXIT.
  8962
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 169
* EL156.cbl
  8964 0700-TEST-FOR-CHANGES.
  8965     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8966         MOVE ER-0433            TO EMI-ERROR
  8967         GO TO 0750-FUNCTION-ERROR.
  8968
  8969     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8970
  8971     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8972         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8973         MOVE 'A'                TO PI-PASS-SW
  8974         GO TO 1000-EDIT-DATA.
  8975
  8976     IF PI-FATAL-COUNT NOT = 0
  8977         MOVE ER-0499            TO EMI-ERROR
  8978         GO TO 0750-FUNCTION-ERROR.
  8979
  8980     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8981         MOVE ER-0500            TO EMI-ERROR
  8982         GO TO 0750-FUNCTION-ERROR.
  8983
  8984     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8985        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8986           MOVE ER-0542          TO EMI-ERROR
  8987           MOVE -1               TO EPYAMTL
  8988           GO TO 0750-FUNCTION-ERROR.
  8989
  8990     IF PI-OFFLINE = 'Y'  OR
  8991        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8992        MOVE EIBAID              TO PI-PFKEY-USED
  8993        GO TO 5000-UPDATE.
  8994
  8995     GO TO 6000-BUILD-SCREEN-B.
  8996
  8997 0750-FUNCTION-ERROR.
  8998     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8999
  9000     IF ENTERPFL > 0
  9001         MOVE -1                 TO ENTERPFL
  9002         MOVE AL-UNBON           TO ENTERPFA
  9003         GO TO 8200-SEND-DATAONLY
  9004     ELSE
  9005         MOVE -1                 TO ENTERPFL
  9006         MOVE AL-UNNOF           TO ENTERPFA
  9007         GO TO 8200-SEND-DATAONLY.
  9008
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 170
* EL156.cbl
  9010 0800-DELETE-TS.
  9011
  9012* EXEC CICS HANDLE CONDITION
  9013*        QIDERR(0800-EXIT)
  9014*    END-EXEC.
  9015*    MOVE '"$N                   ! % #00008767' TO DFHEIV0
  9016     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9018     MOVE X'2520233030303038373637' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0
  9020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9021
  9022
  9023
  9024* EXEC CICS DELETEQ TS
  9025*        QUEUE(QID)
  9026*    END-EXEC.
  9027*    MOVE '*&                    #   #00008771' TO DFHEIV0
  9028     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9029     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9030     MOVE X'2020233030303038373731' TO DFHEIV0(25:11)
  9031     CALL 'kxdfhei1' USING DFHEIV0,
  9032           QID,
  9033           DFHEIV99
  9034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9035
  9036
  9037 0800-EXIT.
  9038      EXIT.
  9039 0900-GET-DDF-LIMITS.
  9040
  9041     if cm-clp-state = zeros or spaces or low-values
  9042        move cm-state            to cm-clp-state
  9043     end-if
  9044     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9045     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9046     MOVE cm-clp-state           TO ERPDEF-STATE
  9047     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9048     evaluate true
  9049        when (cl-claim-type = 'L' or 'P')
  9050           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9051             and 'CU')
  9052           move 'L'              to erpdef-ben-type
  9053           move pi-lf-benefit-cd to erpdef-ben-code
  9054        when (cl-claim-type not = 'L' and 'P')
  9055           and (pi-ah-benefit-cd not = '00' and '  ')
  9056           move 'A'              to erpdef-ben-type
  9057           move pi-ah-benefit-cd to erpdef-ben-code
  9058        when (cl-claim-type not = 'L' and 'P')
  9059           and (pi-ah-benefit-cd = '00' or '  ')
  9060           move 'L'              to erpdef-ben-type
  9061           move pi-lf-benefit-cd to erpdef-ben-code
  9062        when (cl-claim-type = 'L' or 'P')
  9063           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9064           move 'A'              to erpdef-ben-type
  9065           move pi-ah-benefit-cd to erpdef-ben-code
  9066        when other
  9067           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 171
* EL156.cbl
  9068           move pi-ah-benefit-cd to erpdef-ben-code
  9069     end-evaluate
  9070*    if (cl-claim-type = 'L' or 'P')
  9071*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9072*          and 'CU')
  9073*       move 'L'                 to erpdef-ben-type
  9074*       move pi-lf-benefit-cd    to erpdef-ben-code
  9075*    else
  9076*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9077*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9078*    end-if
  9079     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9080
  9081     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9082
  9083
  9084* EXEC CICS STARTBR
  9085*        DATASET  ('ERPDEF')
  9086*        RIDFLD   (ERPDEF-KEY)
  9087*        GTEQ
  9088*        RESP     (WS-RESPONSE)
  9089*    END-EXEC
  9090     MOVE 'ERPDEF' TO DFHEIV1
  9091     MOVE 0
  9092       TO DFHEIV11
  9093*    MOVE '&,         G          &  N#00008821' TO DFHEIV0
  9094     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9096     MOVE X'204E233030303038383231' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           DFHEIV1,
  9099           ERPDEF-KEY,
  9100           DFHEIV99,
  9101           DFHEIV11,
  9102           DFHEIV99
  9103     MOVE EIBRESP  TO WS-RESPONSE
  9104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9105
  9106     IF NOT WS-RESP-NORMAL
  9107        GO TO 0900-EXIT
  9108     END-IF
  9109
  9110     .
  9111 0900-READNEXT.
  9112
  9113
  9114* EXEC CICS READNEXT
  9115*       DATASET  ('ERPDEF')
  9116*       SET      (ADDRESS OF PRODUCT-MASTER)
  9117*       RIDFLD   (ERPDEF-KEY)
  9118*       RESP     (WS-RESPONSE)
  9119*    END-EXEC
  9120     MOVE 'ERPDEF' TO DFHEIV1
  9121     MOVE 0
  9122       TO DFHEIV11
  9123*    MOVE '&.S                   )  N#00008835' TO DFHEIV0
  9124     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9125     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 172
* EL156.cbl
  9126     MOVE X'204E233030303038383335' TO DFHEIV0(25:11)
  9127     CALL 'kxdfhei1' USING DFHEIV0,
  9128           DFHEIV1,
  9129           DFHEIV20,
  9130           DFHEIV99,
  9131           ERPDEF-KEY,
  9132           DFHEIV99,
  9133           DFHEIV11,
  9134           DFHEIV99,
  9135           DFHEIV99
  9136     SET ADDRESS OF PRODUCT-MASTER TO
  9137         DFHEIV20
  9138     MOVE EIBRESP  TO WS-RESPONSE
  9139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9140
  9141     IF NOT WS-RESP-NORMAL
  9142        GO TO 0900-ENDBR
  9143     END-IF
  9144
  9145     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9146        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9147           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9148        ELSE
  9149           GO TO 0900-READNEXT
  9150        END-IF
  9151     ELSE
  9152        GO TO 0900-ENDBR
  9153     END-IF
  9154
  9155     IF CM-LOAN-TERM = ZEROS
  9156        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9157     END-IF
  9158
  9159     .
  9160 0900-ENDBR.
  9161
  9162
  9163* EXEC CICS ENDBR
  9164*       DATASET  ('ERPDEF')
  9165*    END-EXEC
  9166     MOVE 'ERPDEF' TO DFHEIV1
  9167     MOVE 0
  9168       TO DFHEIV11
  9169*    MOVE '&2                    $   #00008863' TO DFHEIV0
  9170     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9172     MOVE X'2020233030303038383633' TO DFHEIV0(25:11)
  9173     CALL 'kxdfhei1' USING DFHEIV0,
  9174           DFHEIV1,
  9175           DFHEIV11,
  9176           DFHEIV99
  9177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9178
  9179     .
  9180 0900-EXIT.
  9181     EXIT.
  9182 1000-EDIT-DATA.
  9183
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 173
* EL156.cbl
  9184     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9185         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9186         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9187
  9188     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9189
  9190     IF NOT MODIFY-CAP
  9191         MOVE ER-0070            TO EMI-ERROR
  9192         MOVE -1                 TO PMTTYPEL
  9193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9194         GO TO 2000-EDIT-DONE.
  9195
  9196     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9197                         '5' AND '6'
  9198         MOVE ER-0420            TO EMI-ERROR
  9199         MOVE -1                 TO PMTTYPEL
  9200         MOVE AL-UABON           TO PMTTYPEA
  9201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9202     ELSE
  9203         MOVE AL-UANON           TO PMTTYPEA.
  9204
  9205*    IF PI-OFFLINE = 'Y'
  9206*       IF PI-GROUPED = 'Y'
  9207*          MOVE ER-1880         TO EMI-ERROR
  9208*          MOVE -1              TO GROUPEDL
  9209*          MOVE AL-UABON        TO GROUPEDA
  9210*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9211*
  9212*    IF GROUPEDL > +0
  9213*       IF PI-GROUPED = 'Y' OR 'N'
  9214*          MOVE AL-UANON TO GROUPEDA
  9215*       ELSE
  9216*          MOVE ER-3140            TO EMI-ERROR
  9217*          MOVE -1                 TO GROUPEDL
  9218*          MOVE AL-UABON           TO GROUPEDA
  9219*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9220*
  9221*    IF CASHL > +0
  9222*       IF PI-CASH = 'Y' OR 'N'
  9223*          MOVE AL-UANON           TO CASHA
  9224*       ELSE
  9225*          MOVE ER-3141            TO EMI-ERROR
  9226*          MOVE -1                 TO CASHL
  9227*          MOVE AL-UABON           TO CASHA
  9228*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9229
  9230     IF LOANNOL > +0
  9231         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9232
  9233 1000-EDIT-PAYEE.
  9234
  9235     IF PI-PAYEE-SEQ NOT NUMERIC
  9236         MOVE ER-0294            TO  EMI-ERROR
  9237         MOVE -1                 TO  PAYEEL
  9238         MOVE AL-UABON           TO  PAYEEA
  9239         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9240         GO TO 1000-CONT-EDIT.
  9241
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 174
* EL156.cbl
  9242     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9243                         'E' OR 'O' OR 'Q'
  9244         NEXT SENTENCE
  9245     ELSE
  9246         MOVE ER-0294            TO  EMI-ERROR
  9247         MOVE -1                 TO  PAYEEL
  9248         MOVE AL-UABON           TO  PAYEEA
  9249         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9250         GO TO 1000-CONT-EDIT.
  9251
  9252     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9253        (PI-PAYEE-SEQ NOT < '1' AND
  9254         PI-PAYEE-SEQ NOT > '9'))
  9255      OR
  9256        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9257         (PI-PAYEE-SEQ NOT > '9'))
  9258         MOVE AL-UANON            TO PAYEEA
  9259     ELSE
  9260         MOVE ER-0294            TO EMI-ERROR
  9261         MOVE -1                 TO PAYEEL
  9262         MOVE AL-UABON           TO PAYEEA
  9263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9264
  9265     IF PI-COMPANY-ID = 'DMD'
  9266         IF PI-PAYEE-TYPE = 'B' AND
  9267            PI-PAYEE-SEQ NOT = '0'
  9268               MOVE ER-7841            TO EMI-ERROR
  9269               MOVE -1                 TO PAYEEL
  9270               MOVE AL-UABON           TO PAYEEA
  9271               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9272
  9273     IF PI-COMPANY-ID = 'JHL'
  9274         IF PI-PAYEE = 'B0'
  9275             NEXT SENTENCE
  9276           ELSE
  9277
  9278* EXEC CICS HANDLE CONDITION
  9279*            ENDFILE(1950-NOT-FOUND)
  9280*            NOTFND (1950-NOT-FOUND)
  9281*        END-EXEC
  9282*    MOVE '"$''I                  ! & #00008965' TO DFHEIV0
  9283     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9285     MOVE X'2620233030303038393635' TO DFHEIV0(25:11)
  9286     CALL 'kxdfhei1' USING DFHEIV0
  9287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9288         MOVE 'N'                    TO FOUND-TOL-SW
  9289         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9290         MOVE '2'                    TO CNTL-REC-TYPE
  9291         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9292         MOVE +0                     TO CNTL-SEQ-NO
  9293         MOVE 'PROC'                 TO FILE-SWITCH
  9294         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9295         IF PI-PAYEE = 'I1' AND
  9296            APPROVAL-LEVEL-2
  9297             NEXT SENTENCE
  9298           ELSE
  9299         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 175
* EL156.cbl
  9300             MOVE ER-3546        TO EMI-ERROR
  9301             MOVE -1             TO PAYEEL
  9302             MOVE AL-UABON       TO PAYEEA
  9303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9304
  9305     IF PI-PAYEE-TYPE = 'E'
  9306        IF PI-PMTTYPE = '5' OR '6'
  9307            NEXT SENTENCE
  9308        ELSE
  9309            MOVE ER-3539            TO EMI-ERROR
  9310            MOVE -1                 TO PAYEEL
  9311            MOVE AL-UABON           TO PAYEEA
  9312            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9313
  9314 1000-CONT-EDIT.
  9315
  9316     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9317        IF PI-EPYAMT NOT NEGATIVE
  9318            MOVE ER-0421         TO EMI-ERROR
  9319            MOVE -1              TO OFFLINEL
  9320            MOVE AL-UABON        TO OFFLINEA
  9321            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9322        ELSE
  9323            MOVE AL-UANON        TO OFFLINEA.
  9324
  9325     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9326        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9327           CONTINUE
  9328        ELSE
  9329           IF PI-PRINT-EOB-YN = 'S' AND
  9330              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9331                CONTINUE
  9332           ELSE
  9333              MOVE ER-1561       TO EMI-ERROR
  9334              MOVE -1            TO EOBYNL
  9335              MOVE AL-UABON      TO EOBYNA
  9336              PERFORM 9900-ERROR-FORMAT
  9337                                 THRU 9900-EXIT
  9338           END-IF
  9339        END-IF
  9340
  9341        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9342            MOVE ER-1566        TO EMI-ERROR
  9343            MOVE -1             TO CLMFMYNL
  9344            MOVE AL-UABON       TO CLMFMYNA
  9345            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9346        END-IF
  9347
  9348        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9349            MOVE ER-1567        TO EMI-ERROR
  9350            MOVE -1             TO SURVYYNL
  9351            MOVE AL-UABON       TO SURVYYNA
  9352            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9353        END-IF
  9354
  9355        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9356            MOVE ER-1569        TO EMI-ERROR
  9357            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 176
* EL156.cbl
  9358            MOVE AL-UABON       TO SPRELYNA
  9359            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360        END-IF
  9361
  9362     END-IF
  9363     IF PI-EPYAMT IS NEGATIVE
  9364         IF PI-OFFLINE NOT = 'Y'
  9365             MOVE ER-0836        TO  EMI-ERROR
  9366             MOVE -1             TO  OFFLINEL
  9367             MOVE AL-UABON       TO  OFFLINEA
  9368             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9369
  9370     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9371        MOVE ER-0872             TO EMI-ERROR
  9372        MOVE -1                  TO PROOFDTL
  9373        MOVE AL-UABON            TO PROOFDTA
  9374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375     ELSE
  9376        MOVE '4'                TO DC-OPTION-CODE
  9377        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9378        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9379        IF DATE-CONVERSION-ERROR
  9380            MOVE ER-0873        TO EMI-ERROR
  9381            MOVE -1                  TO PROOFDTL
  9382            MOVE AL-UABON            TO PROOFDTA
  9383            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9384        ELSE
  9385            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9386            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9387                MOVE ER-0873    TO EMI-ERROR
  9388                MOVE -1                  TO PROOFDTL
  9389                MOVE AL-UABON            TO PROOFDTA
  9390                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9391            END-IF
  9392        END-IF
  9393     END-IF.
  9394
  9395     IF PI-COMPANY-ID = 'DMD'
  9396        IF NOTE1L NOT = ZEROS
  9397            MOVE ER-7844        TO  EMI-ERROR
  9398            MOVE -1             TO  NOTE1L
  9399            MOVE AL-UABON       TO  NOTE1A
  9400            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9401
  9402     IF PI-COMPANY-ID = 'DMD'
  9403        IF NOTE2L NOT = ZEROS
  9404          GO TO 1004-DMD-EOB-CHECKS.
  9405
  9406     IF NOTE1L NOT > +0
  9407         GO TO 1005-CHECK-ERRORS.
  9408
  9409     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9410         GO TO 1005-CHECK-ERRORS.
  9411
  9412     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9413         GO TO 1003-HAN-PMT-NOTES.
  9414
  9415     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 177
* EL156.cbl
  9416
  9417     IF WS-PMTOPTION NUMERIC
  9418        IF WS-PMTOPTION > '00' AND < '17'
  9419           NEXT SENTENCE
  9420        ELSE
  9421           MOVE ER-0618          TO EMI-ERROR
  9422           MOVE -1               TO NOTE1L
  9423           MOVE AL-UABON         TO NOTE1A
  9424           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425     ELSE
  9426        GO TO 1005-CHECK-ERRORS.
  9427
  9428     IF WS-PMTOPTION = '05' AND
  9429        WS-DOCNAME = SPACES
  9430          MOVE ER-0616             TO EMI-ERROR
  9431          MOVE -1                  TO NOTE1L
  9432          MOVE AL-UABON            TO NOTE1A
  9433          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9434
  9435     IF WS-PMTOPTION = '15' OR '16'
  9436
  9437* EXEC CICS BIF DEEDIT
  9438*            FIELD (WS-AMOUNT)
  9439*            LENGTH(08)
  9440*        END-EXEC
  9441     MOVE 08
  9442       TO DFHEIV11
  9443*    MOVE '@"L                   #   #00009117' TO DFHEIV0
  9444     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9445     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9446     MOVE X'2020233030303039313137' TO DFHEIV0(25:11)
  9447     CALL 'kxdfhei1' USING DFHEIV0,
  9448           WS-AMOUNT,
  9449           DFHEIV11
  9450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9451        IF (WS-NUM-AMT = ZEROS) OR
  9452           (WS-AMOUNT NOT NUMERIC)
  9453           MOVE ER-0617          TO EMI-ERROR
  9454           MOVE -1               TO NOTE1L
  9455           MOVE AL-UABON         TO NOTE1A
  9456           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9457
  9458     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9459
  9460     GO TO 1005-CHECK-ERRORS.
  9461
  9462 1003-HAN-PMT-NOTES.
  9463
  9464     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9465
  9466     IF WS-HAN-PMT-CODE = SPACE
  9467         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9468     ELSE
  9469     IF WS-HAN-PMT-CODE = 'A'
  9470         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9471                                 TO WS-HAN-PMT-NOTE
  9472     ELSE
  9473     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 178
* EL156.cbl
  9474         MOVE ':FINAL PAYMENT / DECEASED'
  9475                                 TO WS-HAN-PMT-NOTE
  9476     ELSE
  9477     IF WS-HAN-PMT-CODE = 'C'
  9478         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9479                                 TO WS-HAN-PMT-NOTE
  9480     ELSE
  9481     IF WS-HAN-PMT-CODE = 'D'
  9482         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9483                                 TO WS-HAN-PMT-NOTE
  9484     ELSE
  9485     IF WS-HAN-PMT-CODE = 'E'
  9486         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9487                                 TO WS-HAN-PMT-NOTE
  9488     ELSE
  9489     IF WS-HAN-PMT-CODE = 'F'
  9490         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9491                                 TO WS-HAN-PMT-NOTE
  9492     ELSE
  9493     IF WS-HAN-PMT-CODE = 'P'
  9494         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9495
  9496     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9497     GO TO 1005-CHECK-ERRORS.
  9498
  9499 1004-DMD-EOB-CHECKS.
  9500
  9501     INITIALIZE PI-AT-EOB-CODES.
  9502
  9503     IF NOTE2I (20:21) > SPACES
  9504         MOVE ER-7845          TO EMI-ERROR
  9505         MOVE -1               TO NOTE2L
  9506         MOVE AL-UABON         TO NOTE2A
  9507         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9508         GO TO 1005-CHECK-ERRORS
  9509      ELSE
  9510         MOVE NOTE2I             TO W-EOB-CODES.
  9511
  9512     MOVE +1                     TO W-EOB-NDX.
  9513
  9514 1004-CHECK-EACH-EOB.
  9515
  9516     IF W-EOB-NDX > +5
  9517             OR
  9518        W-EOB-CODE (W-EOB-NDX) = SPACES
  9519         GO TO 1004-CHECK-DUP-EOB.
  9520
  9521     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9522         MOVE ER-0956            TO EMI-ERROR
  9523         MOVE -1                 TO NOTE2L
  9524         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9525         GO TO 1005-CHECK-ERRORS.
  9526
  9527     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9528     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9529     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9530     MOVE 'DLO023'               TO PGM-NAME.
  9531
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 179
* EL156.cbl
  9532
  9533* EXEC CICS LINK
  9534*        PROGRAM    (PGM-NAME)
  9535*        COMMAREA   (CD-COMMUNICATION-AREA)
  9536*        LENGTH     (CD-RCRD-LENGTH)
  9537*    END-EXEC.
  9538*    MOVE '."C                   (   #00009202' TO DFHEIV0
  9539     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9541     MOVE X'2020233030303039323032' TO DFHEIV0(25:11)
  9542     CALL 'kxdfhei1' USING DFHEIV0,
  9543           PGM-NAME,
  9544           CD-COMMUNICATION-AREA,
  9545           CD-RCRD-LENGTH,
  9546           DFHEIV99,
  9547           DFHEIV99,
  9548           DFHEIV99,
  9549           DFHEIV99
  9550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9551
  9552
  9553     IF CD-RETURN-CODE = 'OK'
  9554         GO TO 1004-CONT.
  9555
  9556     MOVE -1                     TO NOTE2L.
  9557
  9558     IF CD-RETURN-CODE = '01'
  9559         MOVE ER-8310            TO EMI-ERROR
  9560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9561         GO TO 1005-CHECK-ERRORS.
  9562
  9563     IF CD-RETURN-CODE = '02'
  9564         MOVE ER-8311            TO EMI-ERROR
  9565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9566         GO TO 1005-CHECK-ERRORS.
  9567
  9568     IF CD-RETURN-CODE = '03'
  9569         MOVE ER-8312            TO EMI-ERROR
  9570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9571         GO TO 1005-CHECK-ERRORS.
  9572
  9573     IF CD-RETURN-CODE = '04'
  9574         MOVE ER-8313            TO EMI-ERROR
  9575         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9576         GO TO 1005-CHECK-ERRORS.
  9577
  9578     IF CD-RETURN-CODE = '05'
  9579         MOVE ER-8314            TO EMI-ERROR
  9580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9581         GO TO 1005-CHECK-ERRORS.
  9582
  9583     IF CD-RETURN-CODE = '06'
  9584         MOVE ER-8315            TO EMI-ERROR
  9585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9586         GO TO 1005-CHECK-ERRORS.
  9587
  9588     IF CD-RETURN-CODE = 'E1'
  9589         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 180
* EL156.cbl
  9590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9591         GO TO 1005-CHECK-ERRORS.
  9592
  9593     IF CD-RETURN-CODE = 'N1'
  9594         MOVE ER-8317            TO EMI-ERROR
  9595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9596         GO TO 1005-CHECK-ERRORS.
  9597
  9598 1004-CONT.
  9599     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9600
  9601     ADD +1 TO W-EOB-NDX.
  9602     GO TO 1004-CHECK-EACH-EOB.
  9603
  9604 1004-CHECK-DUP-EOB.
  9605     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9606         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9607                               PI-AT-EOB-CODE (3) OR
  9608                               PI-AT-EOB-CODE (4) OR
  9609                               PI-AT-EOB-CODE (5)))
  9610                  OR
  9611        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9612         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9613                               PI-AT-EOB-CODE (4) OR
  9614                               PI-AT-EOB-CODE (5)))
  9615                  OR
  9616        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9617         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9618                               PI-AT-EOB-CODE (5)))
  9619                  OR
  9620        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9621         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9622            MOVE ER-8000            TO EMI-ERROR
  9623            MOVE AL-UABON           TO NOTE2A
  9624            MOVE -1                 TO NOTE2L
  9625            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9626            GO TO 1005-CHECK-ERRORS.
  9627
  9628 1005-CHECK-ERRORS.
  9629*    IF PI-COMPANY-ID NOT = 'DMD'
  9630        GO TO 1006-CHECK-ERRORS.
  9631
  9632*********  DMD CODE START ******************
  9633*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9634*       GO TO 1006-CHECK-ERRORS.
  9635*
  9636*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9637*
  9638*    COMPUTE W-PAYMENT-TOTAL
  9639*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9640*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9641*               AND
  9642*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9643*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9644*          MOVE ER-0967    TO EMI-ERROR
  9645*          MOVE -1         TO PMTTYPEL
  9646*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647*
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 181
* EL156.cbl
  9648*    GO TO 1006-CHECK-ERRORS.
  9649*********  DMD CODE END ******************
  9650
  9651 1006-CHECK-ERRORS.
  9652     IF NOT EMI-NO-ERRORS
  9653        GO TO 2000-EDIT-DONE.
  9654
  9655
  9656* EXEC CICS HANDLE CONDITION
  9657*        NOTFND(1950-NOT-FOUND)
  9658*    END-EXEC.
  9659*    MOVE '"$I                   ! '' #00009310' TO DFHEIV0
  9660     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9662     MOVE X'2720233030303039333130' TO DFHEIV0(25:11)
  9663     CALL 'kxdfhei1' USING DFHEIV0
  9664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9665
  9666
  9667     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9668     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9669     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9670     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9671     MOVE 'MSTR'                 TO FILE-SWITCH.
  9672
  9673     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9674
  9675     IF PI-COMPANY-ID = 'DMD'
  9676         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9677
  9678     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9679        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9680           MOVE ER-0873    TO EMI-ERROR
  9681           MOVE -1                  TO PROOFDTL
  9682           MOVE AL-UABON            TO PROOFDTA
  9683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9684        END-IF
  9685     END-IF
  9686     if cl-benefit-period = zeros
  9687        move er-1667             to emi-error
  9688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9689     end-if
  9690     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9691     MOVE +95                    TO TRLR-SEQ-NO
  9692
  9693* EXEC CICS READ
  9694*       DATASET  ('ELTRLR')
  9695*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9696*       RIDFLD   (ELTRLR-KEY)
  9697*       RESP     (WS-RESPONSE)
  9698*    END-EXEC
  9699     MOVE 'ELTRLR' TO DFHEIV1
  9700*    MOVE '&"S        E          (  N#00009339' TO DFHEIV0
  9701     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9703     MOVE X'204E233030303039333339' TO DFHEIV0(25:11)
  9704     CALL 'kxdfhei1' USING DFHEIV0,
  9705           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 182
* EL156.cbl
  9706           DFHEIV20,
  9707           DFHEIV99,
  9708           ELTRLR-KEY,
  9709           DFHEIV99,
  9710           DFHEIV99,
  9711           DFHEIV99
  9712     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9713         DFHEIV20
  9714     MOVE EIBRESP  TO WS-RESPONSE
  9715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9716
  9717     if ws-resp-normal
  9718        perform varying s1 from +1 by +1 until
  9719           at-note-error-no (s1) = spaces
  9720           if at-note-error-no (s1) = '1662'
  9721              continue
  9722           else
  9723              move at-note-error-no (s1)
  9724                                 to emi-error
  9725              if at-note-error-no (s1) = '1653'
  9726                 evaluate true
  9727                    when cl-claim-type = 'L'
  9728                       move '  LF  '
  9729                                 to emi-claim-type
  9730                    when cl-claim-type = 'I'
  9731                       move '  IU  '
  9732                                 to emi-claim-type
  9733                    when cl-claim-type = 'A'
  9734                       move '  AH  '
  9735                                 to emi-claim-type
  9736                    when other
  9737                       move ' FMLA '
  9738                                 to emi-claim-type
  9739                 end-evaluate
  9740              end-if
  9741              PERFORM 9900-ERROR-FORMAT
  9742                                 THRU 9900-EXIT
  9743           end-if
  9744        end-perform
  9745     end-if
  9746     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9747         IF PI-PMTTYPE = '5' OR '6'
  9748             NEXT SENTENCE
  9749         ELSE
  9750             MOVE ER-0555             TO EMI-ERROR
  9751             MOVE -1                  TO PMTTYPEL
  9752             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9753
  9754     IF CL-LAST-CLOSE-REASON = '2'
  9755         IF CL-CLAIM-STATUS = 'C'
  9756             MOVE ER-0760        TO  EMI-ERROR
  9757             MOVE -1             TO  PMTTYPEL
  9758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9759
  9760     IF PI-ACTIVITY-CODE = 9
  9761         MOVE ER-3538            TO  EMI-ERROR
  9762         MOVE -1                 TO  PMTTYPEL
  9763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 183
* EL156.cbl
  9764
  9765     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9766         GO TO 1008-READ-CERT.
  9767**********************AIG LOGIC STARTS *********************
  9768     IF CL-CERT-PRIME = 'INCOMPLETE'
  9769         MOVE ER-3540            TO  EMI-ERROR
  9770         MOVE -1                 TO  PMTTYPEL
  9771         MOVE AL-UABON           TO  PMTTYPEA
  9772         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9773         GO TO 2000-EDIT-DONE.
  9774
  9775     IF PI-PMTTYPE = '4'
  9776         IF PI-EPYAMT IS NEGATIVE
  9777             IF PI-ECHECKNO-CR = 'CR'
  9778                 NEXT SENTENCE
  9779             ELSE
  9780                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9781
  9782     IF PI-PMTTYPE = '4'
  9783         IF PI-ECHECKNO-CR = 'CR'
  9784             IF PI-EPYAMT IS NEGATIVE
  9785                 NEXT SENTENCE
  9786             ELSE
  9787                 MOVE ER-0834    TO  EMI-ERROR
  9788                 MOVE -1         TO  EPYAMTL
  9789                 MOVE AL-UNBON   TO  EPYAMTA
  9790                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9791
  9792     IF PI-PMTTYPE = '4'
  9793         IF PI-EPYAMT IS NEGATIVE
  9794             IF PI-OFFLINE = 'Y'
  9795                 NEXT SENTENCE
  9796             ELSE
  9797                 MOVE 'Y'        TO  PI-OFFLINE
  9798                                     WS-OFFLINE
  9799                                     OFFLINEO
  9800                 MOVE AL-UANON   TO  OFFLINEA.
  9801
  9802*    IF PI-PMTTYPE = '4'
  9803*        IF PI-EPYAMT IS NEGATIVE
  9804*            IF PI-CASH = 'Y'
  9805*                NEXT SENTENCE
  9806*            ELSE
  9807*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9808*                MOVE AL-UANON   TO  CASHA
  9809*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9810*
  9811*    IF PI-CASH NOT = 'Y' AND 'N'
  9812*         IF PI-OFFLINE = 'Y'  AND
  9813*            PI-ECHECKNO-CR = 'CR'
  9814*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9815*              MOVE AL-UANON     TO  CASHA
  9816*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9817*
  9818*    IF PI-CASH NOT = 'Y' AND 'N'
  9819*        IF PI-PMTTYPE = '5' OR '6'
  9820*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9821*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 184
* EL156.cbl
  9822*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9823*
  9824*    IF PI-CASH NOT = 'Y' AND 'N'
  9825*       IF CL-ASSOCIATES = 'N' OR 'A'
  9826*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9827*           MOVE AL-UANON        TO  CASHA
  9828*       ELSE
  9829*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9830*           MOVE AL-UANON        TO  CASHA.
  9831*
  9832*    IF PI-PMTTYPE = '5' OR '6'
  9833*        IF PI-CASH = 'N'
  9834*            MOVE ER-0819        TO  EMI-ERROR
  9835*            MOVE AL-UANON       TO  CASHA
  9836*            MOVE -1             TO  CASHL
  9837*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9838*
  9839*    IF CL-ASSOCIATES = 'N' OR 'A'
  9840*       IF CASHI = 'N'
  9841*        MOVE ER-3537            TO  EMI-ERROR
  9842*        MOVE AL-UANON           TO  CASHA
  9843*        MOVE -1                 TO  CASHL
  9844*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9845
  9846 1007-DEFAULT-AIG-CHECKNO.
  9847
  9848     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9849         MOVE ER-3532            TO  EMI-ERROR
  9850         MOVE -1                 TO  PMTTYPEL
  9851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9852**********************AIG LOGIC ENDS ***********************
  9853
  9854 1008-READ-CERT.
  9855
  9856     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9857     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9858     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9859     MOVE CL-CERT-STATE          TO CERT-STATE.
  9860     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9861     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9862     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9863     MOVE 'CERT'                 TO FILE-SWITCH.
  9864
  9865     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9866
  9867     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9868        MOVE CM-LF-LOAN-EXPIRE-DT
  9869                                 TO WS-EXP-DT PI-EXP-DT
  9870                                    ws-extended-exp-dt
  9871     ELSE
  9872        MOVE CM-AH-LOAN-EXPIRE-DT
  9873                                 TO WS-EXP-DT PI-EXP-DT
  9874                                    ws-extended-exp-dt
  9875     end-if
  9876     if pi-dcc-product-code not = spaces
  9877        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9878        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9879        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 185
* EL156.cbl
  9880                                 THRU 0900-EXIT
  9881        IF PDEF-FOUND
  9882           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9883              (P1 > +8)
  9884              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9885           END-PERFORM
  9886           IF P1 < +9
  9887              MOVE '6'           TO DC-OPTION-CODE
  9888              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9889              MOVE PD-MAX-EXTENSION (P1)
  9890                                 TO DC-ELAPSED-MONTHS
  9891              PERFORM 9700-LINK-DATE-CONVERT
  9892                                 THRU 9700-EXIT
  9893              if no-conversion-error
  9894                 move dc-bin-date-2 to ws-extended-exp-dt
  9895              end-if
  9896           else
  9897              move er-1674       to emi-error
  9898              PERFORM 9900-ERROR-FORMAT
  9899                                 THRU 9900-EXIT
  9900           end-if
  9901        end-if
  9902     end-if
  9903*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9904*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9905
  9906     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9907         MOVE ER-0458            TO EMI-ERROR
  9908         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9909
  9910     IF (CL-INCURRED-DT > WS-EXP-DT)
  9911        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9912        MOVE ER-1677             TO EMI-ERROR
  9913        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9914     END-IF
  9915     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9916     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9917         MOVE ER-0459            TO EMI-ERROR
  9918         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9919
  9920     IF CL-REPORTED-DT = LOW-VALUES
  9921        MOVE ER-0530             TO EMI-ERROR
  9922        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9923
  9924     IF PI-COMPANY-ID = 'NCL'
  9925        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9926            MOVE ER-0770            TO EMI-ERROR
  9927            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9928
  9929     IF PI-COMPANY-ID = 'NCL'
  9930        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9931            MOVE ER-0737            TO EMI-ERROR
  9932            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9933
  9934     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9935         MOVE ER-0768            TO  EMI-ERROR
  9936         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9937
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 186
* EL156.cbl
  9938     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9939         MOVE ER-0769            TO  EMI-ERROR
  9940         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9941
  9942     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9943         GO TO 1020-DO-LIFE-EDITS
  9944     ELSE
  9945         GO TO 1030-DO-AH-EDITS.
  9946
  9947 1010-GENERAL-ERROR.
  9948     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9949
  9950     IF EMI-MESSAGE-FORMATTED
  9951         MOVE -1                 TO PMTTYPEL.
  9952
  9953 1010-EXIT.
  9954     EXIT.
  9955
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 187
* EL156.cbl
  9957 1020-DO-LIFE-EDITS.
  9958     IF CM-LF-BENEFIT-CD = '00'
  9959         IF PI-PMTTYPE = '5' OR '6'
  9960             MOVE ER-0658        TO EMI-ERROR
  9961             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9962         ELSE
  9963            if (pi-company-id = 'DCC')
  9964               and (pi-dcc-product-code not = spaces)
  9965               continue
  9966            else
  9967               MOVE ER-1775      TO EMI-ERROR
  9968               PERFORM 1040-PMTTYPE-ERROR
  9969                                 THRU 1040-EXIT
  9970            end-if
  9971         end-if
  9972     end-if
  9973
  9974     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9975     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9976         MOVE ER-0460            TO EMI-ERROR
  9977         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9978
  9979     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9980     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9981     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9982     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9983     MOVE '4'                    TO  CNTL-REC-TYPE.
  9984     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9985     MOVE 'BENE'                 TO  FILE-SWITCH.
  9986     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9987     IF NO-BENEFIT-FOUND
  9988         GO TO 1950-NOT-FOUND.
  9989
  9990     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9991
  9992     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9993         IF PI-PMTTYPE = '4'
  9994             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9995                PI-LF-COVERAGE-TYPE = 'P'
  9996                 NEXT SENTENCE
  9997             ELSE
  9998                 MOVE ER-0461        TO EMI-ERROR
  9999                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10000         ELSE
 10001            NEXT SENTENCE
 10002     ELSE
 10003         IF PI-PMTTYPE = '2'
 10004            IF NOT CM-O-B-COVERAGE
 10005              AND CM-LF-CURRENT-STATUS = '7'
 10006                MOVE ER-0462     TO EMI-ERROR
 10007                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10008
 10009     IF PI-PMTTYPE = '2'
 10010         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10011            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10012             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10013             MOVE ER-0730            TO  EMI-ERROR
 10014             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 188
* EL156.cbl
 10015             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10016
 10017     IF PI-PMTTYPE = '2'
 10018         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10019            PI-LF-COVERAGE-TYPE = 'P'
 10020             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10021                 MOVE ER-0462    TO  EMI-ERROR
 10022                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10023
 10024     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10025       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10026         MOVE ER-0466            TO EMI-ERROR
 10027         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10028
 10029     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10030         IF PI-PMTTYPE = '3'
 10031             MOVE 0436           TO EMI-ERROR
 10032             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10033             GO TO 1045-EDIT-PAYEE-ADDR
 10034         ELSE
 10035             GO TO 1045-EDIT-PAYEE-ADDR.
 10036
 10037     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10038        PI-LF-COVERAGE-TYPE = 'P'
 10039         IF PI-PMTTYPE = '3'
 10040             MOVE ER-0436          TO  EMI-ERROR
 10041             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10042         ELSE
 10043             NEXT SENTENCE
 10044     ELSE
 10045         IF PI-PMTTYPE = '1' OR '3'
 10046             MOVE ER-0436            TO EMI-ERROR
 10047             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10048*
 10049     IF PI-COMPANY-ID = 'CID' AND
 10050        CL-CERT-STATE = 'SC'  AND
 10051        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10052           MOVE ER-0879    TO  EMI-ERROR
 10053           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10054           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10055     END-IF.
 10056     IF PI-COMPANY-ID = 'AHL'
 10057        evaluate true
 10058           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10059              MOVE ER-0879       TO  EMI-ERROR
 10060              PERFORM 1040-PMTTYPE-ERROR
 10061                                 THRU 1040-EXIT
 10062              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10063           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10064                 '6D' OR '6H' OR '6R'
 10065              MOVE ER-0879       TO  EMI-ERROR
 10066              PERFORM 1040-PMTTYPE-ERROR
 10067                                 THRU 1040-EXIT
 10068              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10069           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10070              MOVE ER-0879       TO  EMI-ERROR
 10071              PERFORM 1040-PMTTYPE-ERROR
 10072                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 189
* EL156.cbl
 10073              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10074        end-evaluate
 10075     END-IF
 10076     GO TO 1045-EDIT-PAYEE-ADDR.
 10077
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 190
* EL156.cbl
 10079 1030-DO-AH-EDITS.
 10080     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10081     IF CM-AH-BENEFIT-CD = '00'
 10082         IF PI-PMTTYPE = '5' OR '6'
 10083             MOVE ER-0658        TO EMI-ERROR
 10084             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10085         ELSE
 10086             MOVE ER-1775        TO EMI-ERROR
 10087             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10088
 10089     IF CL-TOTAL-PAID-AMT = ZEROS
 10090         IF PI-PMTTYPE = '4'
 10091             MOVE ER-0438        TO EMI-ERROR
 10092             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10093
 10094     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10095         IF PI-PMTTYPE = '3'
 10096             MOVE ER-0463        TO EMI-ERROR
 10097             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10098         ELSE
 10099             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10100              AND CM-LF-CURRENT-STATUS = '7'
 10101                 MOVE ER-0465    TO EMI-ERROR
 10102                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10103
 10104     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10105         IF PI-PMTTYPE = '3'
 10106             MOVE ER-0464        TO EMI-ERROR
 10107             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10108         ELSE
 10109             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10110                 MOVE ER-0469    TO EMI-ERROR
 10111                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10112
 10113     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10114         IF PI-PMTTYPE = '3'
 10115             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10116                 MOVE ER-0467    TO EMI-ERROR
 10117                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10118             ELSE
 10119                 NEXT SENTENCE
 10120         ELSE
 10121             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10122                 MOVE ER-0468    TO EMI-ERROR
 10123                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10124
 10125     GO TO 1045-EDIT-PAYEE-ADDR.
 10126
 10127 1040-PMTTYPE-ERROR.
 10128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10129
 10130     IF EMI-MESSAGE-FORMATTED
 10131         MOVE -1                 TO PMTTYPEL
 10132         MOVE AL-UABON           TO PMTTYPEA.
 10133
 10134 1040-EXIT.
 10135     EXIT.
 10136
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 191
* EL156.cbl
 10138 1045-EDIT-PAYEE-ADDR.
 10139
 10140     IF PI-OFFLINE = 'N' AND
 10141        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10142           < PI-PAYEE-SEQ-NUM)
 10143        OR
 10144         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10145         (PI-PAYEE-TYPE = 'B')                 AND
 10146         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10147        OR
 10148         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10149           < PI-PAYEE-SEQ-NUM)
 10150        OR
 10151         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10152           < PI-PAYEE-SEQ-NUM)
 10153        OR
 10154         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10155           < PI-PAYEE-SEQ-NUM)
 10156        OR
 10157         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10158           < PI-PAYEE-SEQ-NUM)
 10159        OR
 10160         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10161           < PI-PAYEE-SEQ-NUM))
 10162             MOVE ER-0437        TO EMI-ERROR
 10163             MOVE -1             TO PAYEEL
 10164             MOVE AL-UABON       TO PAYEEA
 10165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10166
 10167     IF PI-OFFLINE    = 'N' AND
 10168        PI-PAYEE-TYPE = 'B' AND
 10169        PI-PAYEE-SEQ  = '0'
 10170         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10171         IF BENE-FOUND-SW = 'N'
 10172             MOVE ER-0437        TO EMI-ERROR
 10173             MOVE -1             TO PAYEEL
 10174             MOVE AL-UABON       TO PAYEEA
 10175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10176
 10177     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10178        IF PI-OFFLINE    = 'N'  AND
 10179           PI-PAYEE-TYPE = 'B'  AND
 10180           PI-PAYEE-SEQ  = '9'
 10181             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10182             IF BENE-FOUND-SW = 'N'
 10183                MOVE ER-0437        TO EMI-ERROR
 10184                MOVE -1             TO PAYEEL
 10185                MOVE AL-UABON       TO PAYEEA
 10186                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10187
 10188*    IF PI-COMPANY-ID = 'CRI'
 10189*        IF CL-CLAIM-TYPE = 'L'
 10190*            MOVE 'N'                TO  WS-GROUPED
 10191*                                        PI-GROUPED
 10192*                                        GROUPEDI
 10193*            MOVE AL-UANON           TO  GROUPEDA
 10194*            GO TO 1050-EDIT-CHECK-NO
 10195*        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 192
* EL156.cbl
 10196*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10197*            IF WS-GROUP-1 = 'C'
 10198*                NEXT SENTENCE
 10199*            ELSE
 10200*                MOVE 'N'            TO  WS-GROUPED
 10201*                                        PI-GROUPED
 10202*                                        GROUPEDI
 10203*                MOVE AL-UANON       TO  GROUPEDA
 10204*                GO TO 1050-EDIT-CHECK-NO.
 10205
 10206*     IF PI-GROUPED = 'Y'
 10207*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10208*           NEXT SENTENCE
 10209*        ELSE
 10210*           MOVE ER-0437        TO EMI-ERROR
 10211*           MOVE -1             TO PAYEEL
 10212**02180            MOVE AL-UABON       TO PAYEEA
 10213*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10214*
 10215*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10216*        (PI-GROUPED    = ' ')
 10217*        NEXT SENTENCE
 10218*     ELSE
 10219*
 10220     GO TO 1050-EDIT-CHECK-NO.
 10221*     IF PI-COMPANY-ID = 'CRI'
 10222*        MOVE 'N'           TO GROUPEDI
 10223*                              PI-GROUPED
 10224*                              WS-GROUPED
 10225*        MOVE AL-UANON      TO GROUPEDA.
 10226*
 10227*     IF PI-COMPANY-ID = 'CRI'
 10228*        IF PI-PAYEE-TYPE = 'B'
 10229*           IF BENE-FOUND-SW = 'Y'
 10230*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10231*                 MOVE 'Y'           TO GROUPEDI
 10232*                                       PI-GROUPED
 10233*                                       WS-GROUPED
 10234*                 MOVE AL-UANON      TO GROUPEDA
 10235*              ELSE
 10236*                 NEXT SENTENCE
 10237*           ELSE
 10238*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10239*              IF BENE-FOUND-SW = 'Y'
 10240*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10241*                    MOVE 'Y'      TO GROUPEDI
 10242*                                     PI-GROUPED
 10243*                                     WS-GROUPED
 10244*                    MOVE AL-UANON TO GROUPEDA.
 10245*
 10246
 10247     IF PI-COMPANY-ID NOT = 'CRI'
 10248        GO TO 1050-EDIT-CHECK-NO.
 10249
 10250*************** CRI CODE START ******************
 10251     IF PI-PAYEE-TYPE NOT = 'A'
 10252        GO TO 1050-EDIT-CHECK-NO.
 10253
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 193
* EL156.cbl
 10254     MOVE LOW-VALUES             TO ERACCT-KEY.
 10255     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10256     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10257     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10258     MOVE PI-STATE               TO ACCT-STATE.
 10259     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10260     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10261     MOVE 'ACCT'                 TO FILE-SWITCH.
 10262
 10263     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10264     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10265
 10266
 10267* EXEC CICS HANDLE CONDITION
 10268*         NOTFND   (1950-NOT-FOUND)
 10269*         ENDFILE  (1950-NOT-FOUND)
 10270*    END-EXEC.
 10271*    MOVE '"$I''                  ! ( #00009895' TO DFHEIV0
 10272     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10274     MOVE X'2820233030303039383935' TO DFHEIV0(25:11)
 10275     CALL 'kxdfhei1' USING DFHEIV0
 10276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10277
 10278
 10279
 10280* EXEC CICS STARTBR
 10281*         DATASET   ('ERACCT')
 10282*         RIDFLD    (ERACCT-KEY)
 10283*         GTEQ
 10284*    END-EXEC.
 10285     MOVE 'ERACCT' TO DFHEIV1
 10286     MOVE 0
 10287       TO DFHEIV11
 10288*    MOVE '&,         G          &   #00009900' TO DFHEIV0
 10289     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10291     MOVE X'2020233030303039393030' TO DFHEIV0(25:11)
 10292     CALL 'kxdfhei1' USING DFHEIV0,
 10293           DFHEIV1,
 10294           ERACCT-KEY,
 10295           DFHEIV99,
 10296           DFHEIV11,
 10297           DFHEIV99
 10298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10299
 10300
 10301 1046-READNEXT-ERACCT.
 10302
 10303
 10304* EXEC CICS READNEXT
 10305*         DATASET   ('ERACCT')
 10306*         RIDFLD    (ERACCT-KEY)
 10307*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10308*    END-EXEC.
 10309     MOVE 'ERACCT' TO DFHEIV1
 10310     MOVE 0
 10311       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 194
* EL156.cbl
 10312*    MOVE '&.S                   )   #00009908' TO DFHEIV0
 10313     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10314     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10315     MOVE X'2020233030303039393038' TO DFHEIV0(25:11)
 10316     CALL 'kxdfhei1' USING DFHEIV0,
 10317           DFHEIV1,
 10318           DFHEIV20,
 10319           DFHEIV99,
 10320           ERACCT-KEY,
 10321           DFHEIV99,
 10322           DFHEIV11,
 10323           DFHEIV99,
 10324           DFHEIV99
 10325     SET ADDRESS OF ACCOUNT-MASTER TO
 10326         DFHEIV20
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10331        IF WS-ERACCT-HOLD-RECORD = SPACES
 10332           GO TO 1950-NOT-FOUND
 10333        ELSE
 10334           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10335           GO TO 1048-CONTINUE.
 10336
 10337     IF ACCT-EXP-DT = HIGH-VALUES
 10338        NEXT SENTENCE
 10339     ELSE
 10340        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10341        GO TO 1046-READNEXT-ERACCT.
 10342
 10343 1048-CONTINUE.
 10344
 10345*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10346*       MOVE 'Y'                 TO GROUPEDI
 10347*                                   PI-GROUPED
 10348*                                   WS-GROUPED
 10349*       MOVE AL-UANON            TO GROUPEDA.
 10350*************** CRI CODE END ******************
 10351
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 195
* EL156.cbl
 10353 1050-EDIT-CHECK-NO.
 10354
 10355     IF PI-OFFLINE = 'Y'
 10356         IF PI-ECHECKNO = SPACES
 10357              MOVE ER-0439        TO EMI-ERROR
 10358              GO TO 1090-CHECK-NO-ERROR
 10359           ELSE
 10360*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10361*           IF PI-ECHECKNO-N = 'N' AND
 10362*              PI-CASH       = 'Y'
 10363*                MOVE ER-3535        TO EMI-ERROR
 10364*                GO TO 1090-CHECK-NO-ERROR
 10365*             ELSE
 10366*                MOVE AL-UANON    TO CHECKNOA
 10367*                GO TO 1100-EDIT-HOLDTIL
 10368*         ELSE
 10369            MOVE AL-UANON    TO CHECKNOA
 10370            GO TO 1100-EDIT-HOLDTIL.
 10371
 10372     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10373     MOVE '6'                    TO CNTL-REC-TYPE.
 10374
 10375     IF CONTROL-IS-ACTUAL-CARRIER
 10376         MOVE PI-CARRIER         TO WS-CARR
 10377     ELSE
 10378         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10379
 10380     IF PI-COMPANY-ID = 'FIA'
 10381         MOVE PI-CARRIER         TO WS-CARR.
 10382
 10383     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10384     MOVE 0                      TO CNTL-SEQ-NO.
 10385     MOVE 'CARR'                 TO FILE-SWITCH.
 10386
 10387     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10388
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 196
* EL156.cbl
 10390     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10391         GO TO 1051-EDIT-CHECKNO-CONT.
 10392
 10393**********************AIG LOGIC STARTS**********************
 10394     IF PI-ECHECKNO = SPACES
 10395         IF CHECK-NO-MANUAL
 10396             MOVE ER-0441        TO EMI-ERROR
 10397             GO TO 1090-CHECK-NO-ERROR
 10398         ELSE
 10399             MOVE AL-UANOF       TO CHECKNOA
 10400             GO TO 1100-EDIT-HOLDTIL.
 10401
 10402     IF PI-ECHECKNO NOT = SPACES
 10403         IF CHECK-NO-MANUAL
 10404             MOVE AL-UANON       TO CHECKNOA
 10405             GO TO 1100-EDIT-HOLDTIL.
 10406
 10407     IF PI-ECHECKNO-CR = 'CR'
 10408        IF PI-OFFLINE = 'Y'
 10409            MOVE AL-UANON       TO CHECKNOA
 10410            GO TO 1100-EDIT-HOLDTIL
 10411        ELSE
 10412            MOVE ER-3534        TO EMI-ERROR
 10413            GO TO 1090-CHECK-NO-ERROR.
 10414
 10415     IF PI-ECHECKNO-N = 'N'
 10416        IF PI-CASH = 'N'
 10417            MOVE AL-UANON       TO CHECKNOA
 10418            GO TO 1100-EDIT-HOLDTIL
 10419        ELSE
 10420            MOVE ER-3535          TO EMI-ERROR
 10421            GO TO 1090-CHECK-NO-ERROR.
 10422
 10423     MOVE ER-0442        TO EMI-ERROR
 10424     GO TO 1090-CHECK-NO-ERROR.
 10425**********************AIG LOGIC ENDS************************
 10426
 10427 1051-EDIT-CHECKNO-CONT.
 10428
 10429     IF PI-COMPANY-ID = 'DMD'
 10430        IF PI-ECHECKNO NOT = SPACES
 10431           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10432              MOVE ER-0442        TO EMI-ERROR
 10433              GO TO 1090-CHECK-NO-ERROR
 10434            ELSE
 10435              GO TO 1100-EDIT-HOLDTIL
 10436          ELSE
 10437           GO TO 1100-EDIT-HOLDTIL.
 10438
 10439     IF PI-ECHECKNO = SPACES
 10440         IF CHECK-NO-MANUAL
 10441             MOVE ER-0441        TO EMI-ERROR
 10442             GO TO 1090-CHECK-NO-ERROR
 10443         ELSE
 10444             MOVE AL-UANOF       TO CHECKNOA
 10445             GO TO 1100-EDIT-HOLDTIL
 10446     ELSE
 10447         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 197
* EL156.cbl
 10448             MOVE AL-UANON       TO CHECKNOA
 10449             GO TO 1100-EDIT-HOLDTIL
 10450         ELSE
 10451             MOVE ER-0442        TO EMI-ERROR
 10452             GO TO 1090-CHECK-NO-ERROR.
 10453
 10454 1090-CHECK-NO-ERROR.
 10455     MOVE -1                     TO CHECKNOL.
 10456     MOVE AL-UABON               TO CHECKNOA.
 10457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10458
 10459     GO TO 2000-EDIT-DONE.
 10460
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 198
* EL156.cbl
 10462 1100-EDIT-HOLDTIL.
 10463     MOVE AL-UANON               TO HOLDTILA.
 10464
 10465     IF PI-HOLDTIL = ZEROS
 10466        IF PI-OFFLINE = 'Y'
 10467           MOVE ER-0572          TO EMI-ERROR
 10468           GO TO 1105-HOLDTIL-ERROR
 10469        ELSE
 10470           GO TO 1110-EDIT-PAID-FROM.
 10471
 10472     MOVE '4'                    TO DC-OPTION-CODE.
 10473     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10474     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10475
 10476     IF DATE-CONVERSION-ERROR
 10477         MOVE ER-0446            TO EMI-ERROR
 10478         GO TO 1105-HOLDTIL-ERROR
 10479     END-IF
 10480     IF PI-OFFLINE = 'Y'
 10481        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10482           MOVE ER-0446            TO EMI-ERROR
 10483           GO TO 1105-HOLDTIL-ERROR
 10484        END-IF
 10485     END-IF
 10486
 10487     IF PI-OFFLINE = 'Y'
 10488        GO TO 1110-EDIT-PAID-FROM.
 10489
 10490     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10491     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10492     MOVE '1'                    TO DC-OPTION-CODE.
 10493     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10494
 10495     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10496         MOVE ER-0447            TO EMI-ERROR
 10497         GO TO 1105-HOLDTIL-ERROR.
 10498
 10499     GO TO 1110-EDIT-PAID-FROM.
 10500
 10501 1105-HOLDTIL-ERROR.
 10502     MOVE -1                     TO HOLDTILL.
 10503     MOVE AL-UNBON               TO HOLDTILA.
 10504     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10505
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 199
* EL156.cbl
 10507 1110-EDIT-PAID-FROM.
 10508     MOVE AL-UANON               TO EPYFROMA.
 10509
 10510     IF PI-EPYFROM = ZEROS
 10511         GO TO 1120-CALCULATE-PAID-FROM.
 10512
 10513     IF PI-PMTTYPE = '5' OR '6'
 10514         MOVE ER-0448            TO EMI-ERROR
 10515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10516         MOVE AL-UNBON           TO EPYFROMA
 10517         MOVE -1                 TO EPYFROML
 10518         GO TO 1150-EDIT-PAID-THRU.
 10519
 10520     MOVE '4'                    TO DC-OPTION-CODE.
 10521     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10522     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10523
 10524     IF DATE-CONVERSION-ERROR
 10525         MOVE ER-0449            TO EMI-ERROR
 10526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10527         MOVE AL-UNBON           TO EPYFROMA
 10528         MOVE -1                 TO EPYFROML
 10529     ELSE
 10530         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10531
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 200
* EL156.cbl
 10533 1120-CALCULATE-PAID-FROM.
 10534     IF PI-PMTTYPE = '5' OR '6'
 10535         GO TO 1150-EDIT-PAID-THRU.
 10536
 10537*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10538*       IF PI-PMTTYPE = '4'
 10539*         GO TO 1150-EDIT-PAID-THRU.
 10540
 10541     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10542         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10543         MOVE ' '                TO DC-OPTION-CODE
 10544         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10545         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10546         GO TO 1145-TEST-PAID-FROM.
 10547
 10548     IF PI-PMTTYPE = '4'
 10549        GO TO 1150-EDIT-PAID-THRU.
 10550
 10551     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10552     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10553     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10554     MOVE '5'                    TO CNTL-REC-TYPE.
 10555     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10556     MOVE 'BENE'                 TO FILE-SWITCH.
 10557
 10558     IF WS-BEN-CD = ZEROS
 10559         GO TO 1950-NOT-FOUND.
 10560
 10561     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10562
 10563     IF NO-BENEFIT-FOUND
 10564         GO TO 1950-NOT-FOUND.
 10565
 10566     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10567     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10568
 10569     IF PI-BEN-DAYS NOT NUMERIC
 10570        MOVE ZEROS               TO PI-BEN-DAYS.
 10571
 10572     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10573
 10574     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10575        (CL-TOTAL-PAID-AMT > ZEROS)
 10576         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10577         MOVE '6'                 TO DC-OPTION-CODE
 10578         MOVE +0                  TO DC-ELAPSED-MONTHS
 10579         MOVE +1                  TO DC-ELAPSED-DAYS
 10580         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10581         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10582         GO TO 1145-TEST-PAID-FROM.
 10583
 10584******************************************************************
 10585****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10586****** SPECIAL ENTERED DATE.
 10587******************************************************************
 10588
 10589     IF PI-AIGFROM = ZEROS
 10590         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 201
* EL156.cbl
 10591
 10592     MOVE AL-UANON TO AIGFROMA.
 10593
 10594     MOVE '4'                    TO DC-OPTION-CODE.
 10595     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10596     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10597
 10598     IF DATE-CONVERSION-ERROR
 10599         MOVE ER-0449            TO EMI-ERROR
 10600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10601         MOVE AL-UNBON           TO AIGFROMA
 10602         MOVE -1                 TO AIGFROML
 10603         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10604     ELSE
 10605         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10606         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10607
 10608     GO TO 1140-CONTINUE-PAID-FROM.
 10609
 10610 1130-CONTINUE-PAID-FROM.
 10611
 10612     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10613        (CL-TOTAL-PAID-AMT = ZEROS)
 10614           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10615
 10616 1140-CONTINUE-PAID-FROM.
 10617
 10618     IF PI-BEN-TYPE = 'R'
 10619         IF PI-BEN-DAYS = ZEROS
 10620             NEXT SENTENCE
 10621         ELSE
 10622         IF PI-COMPANY-ID NOT = 'DMD'
 10623             SUBTRACT 1 FROM PI-BEN-DAYS.
 10624
 10625     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10626
 10627     IF PI-COMPANY-ID = 'DMD'
 10628         MOVE -1                 TO DC-ELAPSED-DAYS
 10629         MOVE +0                 TO DC-ELAPSED-MONTHS
 10630         MOVE '6'                TO DC-OPTION-CODE
 10631         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10632         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10633         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10634                               REMAINDER DC-ELAPSED-DAYS
 10635      ELSE
 10636         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10637         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10638
 10639     MOVE '6'                    TO DC-OPTION-CODE.
 10640     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10641     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10642
 10643     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10644
 10645     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10646         MOVE ER-0541            TO EMI-ERROR
 10647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10648         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 202
* EL156.cbl
 10649         MOVE AL-UNBON           TO EPYFROMA.
 10650
 10651     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10652        (PI-BENEFIT-SAVE = '60E')
 10653        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10654           (CL-TOTAL-PAID-AMT = ZEROS)
 10655             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10656             MOVE 30                  TO DC-ELAPSED-DAYS
 10657             MOVE +0                  TO DC-ELAPSED-MONTHS
 10658             MOVE '6'                 TO DC-OPTION-CODE
 10659             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10660
 10661     IF PI-BEN-TYPE = 'R'
 10662         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10663     ELSE
 10664         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10665         IF WS-SV-EPYFROM = LOW-VALUES
 10666            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10667
 10668     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10669         IF WS-USE-AIG-PAYFROM   OR
 10670            WS-AIG-RECALC-PAYFROM
 10671              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10672                                      DC-BIN-DATE-1
 10673              MOVE ' '            TO  DC-OPTION-CODE
 10674              MOVE +0             TO  DC-ELAPSED-MONTHS
 10675                                      DC-ELAPSED-DAYS
 10676              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10677              IF NO-CONVERSION-ERROR
 10678                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10679
 10680     IF PI-CPYFROM < CL-INCURRED-DT
 10681        MOVE -1                  TO EPYFROML
 10682        MOVE ER-3542             TO EMI-ERROR
 10683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10684
 10685     IF CM-ENTRY-DT < CL-INCURRED-DT
 10686        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10687        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10688        MOVE +0                     TO DC-ELAPSED-DAYS
 10689        MOVE +0                     TO DC-ELAPSED-MONTHS
 10690        MOVE '1'                    TO DC-OPTION-CODE
 10691        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10692        ELSE
 10693        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10694
 10695     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10696         NEXT SENTENCE
 10697     ELSE
 10698         IF DC-ELAPSED-MONTHS < 2
 10699             MOVE ER-3255        TO EMI-ERROR
 10700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10701
 10702 1145-TEST-PAID-FROM.
 10703     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10704         GO TO 1150-EDIT-PAID-THRU.
 10705
 10706     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 203
* EL156.cbl
 10707         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10708         MOVE ' '                TO DC-OPTION-CODE
 10709         MOVE +0                 TO DC-ELAPSED-MONTHS
 10710                                    DC-ELAPSED-DAYS
 10711         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10712         IF NO-CONVERSION-ERROR
 10713             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10714         ELSE
 10715             MOVE SPACES             TO EMI-DATE-FIELD.
 10716
 10717     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10718         IF CL-TOTAL-PAID-AMT = ZEROS
 10719             MOVE ER-3543            TO EMI-ERROR
 10720             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10722             IF EMI-MESSAGE-FORMATTED
 10723                MOVE -1             TO EPYFROML
 10724                MOVE AL-UNBON       TO EPYFROMA
 10725             ELSE
 10726                NEXT SENTENCE
 10727         ELSE
 10728             MOVE ER-0452            TO EMI-ERROR
 10729             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10731             IF EMI-MESSAGE-FORMATTED
 10732                MOVE -1             TO EPYFROML
 10733                MOVE AL-UNBON       TO EPYFROMA.
 10734
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 204
* EL156.cbl
 10736 1150-EDIT-PAID-THRU.
 10737
 10738     MOVE AL-UANON               TO EPYTHRUA.
 10739
 10740     IF PI-EPYTHRU = ZEROS
 10741         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10742             GO TO 1200-EDIT-FIND-TOLERANCES
 10743         ELSE
 10744            IF (PI-PMTTYPE = '3') OR
 10745               (PI-PMTTYPE = '2' AND
 10746                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10747               GO TO 1152-CHECK-TYPE
 10748            ELSE
 10749               MOVE ER-0473      TO EMI-ERROR
 10750               GO TO 1170-PAID-THRU-FATAL-ERROR
 10751     ELSE
 10752         IF PI-PMTTYPE = '5' OR '6'
 10753             MOVE ER-0474        TO EMI-ERROR
 10754             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10755
 10756     MOVE '4'                    TO DC-OPTION-CODE.
 10757     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10758     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10759
 10760     IF DATE-CONVERSION-ERROR
 10761         MOVE ER-0475            TO EMI-ERROR
 10762         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10763
 10764     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10765
 10766     IF PI-COMPANY-ID = 'DMD'
 10767         IF PI-PMTTYPE NOT = '2'
 10768                 AND
 10769            WS-EXP-DT > WS-SV-EPYTHRU
 10770             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10771             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10772             MOVE '1'              TO DC-OPTION-CODE
 10773             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10774             IF DATE-CONVERSION-ERROR
 10775                 MOVE ER-0944      TO EMI-ERROR
 10776                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10777             ELSE
 10778                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10779                    DC-ELAPSED-DAYS   = 1
 10780                     MOVE ER-0945  TO EMI-ERROR
 10781                     MOVE -1       TO EPYTHRUL
 10782                     MOVE AL-UABON TO EPYTHRUA
 10783                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10784
 10785     IF PI-PMTTYPE = '4'
 10786         NEXT SENTENCE
 10787     ELSE
 10788         IF WS-SV-EPYTHRU = WS-EXP-DT
 10789             IF PI-PMTTYPE NOT = '2' AND '3'
 10790                 MOVE ER-3541    TO EMI-ERROR
 10791                 MOVE -1         TO PMTTYPEL
 10792                 MOVE AL-UABON   TO PMTTYPEA
 10793                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 205
* EL156.cbl
 10794
 10795     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10796         MOVE ER-0501            TO EMI-ERROR
 10797         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10798
 10799     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10800        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10801*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10802*              MOVE ER-0540         TO EMI-ERROR
 10803*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10804*              MOVE -1              TO EPYTHRUL
 10805*              MOVE AL-UNBON        TO EPYTHRUA
 10806*          ELSE
 10807*          IF PI-COMPANY-ID = 'DMD'
 10808*              MOVE ER-7540         TO EMI-ERROR
 10809*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10810*              MOVE -1              TO EPYTHRUL
 10811*              MOVE AL-UNBON        TO EPYTHRUA
 10812*          ELSE
 10813               IF PI-PMTTYPE NOT = '2' AND '3'
 10814                  IF PI-COMPANY-ID = '???'
 10815                      MOVE ER-7540  TO EMI-ERROR
 10816                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10817                      MOVE -1       TO EPYTHRUL
 10818                      MOVE AL-UNBON TO EPYTHRUA
 10819                  ELSE
 10820                      MOVE ER-0540  TO EMI-ERROR
 10821                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10822                      MOVE -1       TO EPYTHRUL
 10823                      MOVE AL-UNBON TO EPYTHRUA.
 10824
 10825     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10826            OR
 10827        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10828         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10829            OR
 10830        (PI-CPYFROM NOT = LOW-VALUES AND
 10831         PI-CPYFROM < CL-PAID-THRU-DT)
 10832        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10833
 10834 1152-CHECK-TYPE.
 10835     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10836        OR (PI-PMTTYPE = '5' OR '6')
 10837         GO TO 1160-EDIT-PAID-THRU-AH.
 10838
 10839 1155-EDIT-PAID-THRU-LIFE.
 10840     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10841     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10842     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10843     MOVE '4'                    TO CNTL-REC-TYPE.
 10844     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10845     MOVE 'BENE'                 TO FILE-SWITCH.
 10846
 10847     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10848
 10849     IF NO-BENEFIT-FOUND
 10850         GO TO 1950-NOT-FOUND.
 10851
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 206
* EL156.cbl
 10852     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10853
 10854     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10855
 10856     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10857        PI-LF-COVERAGE-TYPE = 'P'
 10858         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10859         GO TO 1200-EDIT-FIND-TOLERANCES.
 10860
 10861     IF PI-EPYTHRU = ZEROS
 10862        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10863
 10864     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10865         MOVE ER-0476            TO EMI-ERROR
 10866         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10867
 10868     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10869*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10870     move cl-critical-period    to dc-elapsed-months
 10871     MOVE +0                    TO DC-ELAPSED-DAYS.
 10872     MOVE '6'                   TO DC-OPTION-CODE.
 10873     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10874
 10875     IF (NO-CONVERSION-ERROR AND
 10876         WS-SPECIAL-CALC-CD = 'C')
 10877        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10878            MOVE ER-0657 TO EMI-ERROR
 10879            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10880
 10881     IF PI-COMPANY-ID = 'NCL'
 10882         IF WS-SPECIAL-CALC-CD = 'C' AND
 10883            cl-critical-period = zeros
 10884*           CM-LF-CRITICAL-PERIOD = +0
 10885             MOVE ER-0844       TO EMI-ERROR
 10886             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10887
 10888     GO TO 1200-EDIT-FIND-TOLERANCES.
 10889
 10890 1160-EDIT-PAID-THRU-AH.
 10891     IF PI-EPYTHRU = ZEROS
 10892        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10893                                    WS-SV-EPYTHRU
 10894     ELSE
 10895        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10896
 10897     IF WS-SV-EPYTHRU < PI-CPYFROM
 10898         MOVE ER-0508            TO EMI-ERROR
 10899         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10900
 10901     perform 7975-read-acct      thru 7975-exit
 10902     move zeros                  to pi-max-ext
 10903     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10904        PERFORM 0900-GET-DDF-LIMITS
 10905                                 THRU 0900-EXIT
 10906        IF PDEF-FOUND
 10907           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10908              (P1 > +8)
 10909              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 207
* EL156.cbl
 10910           END-PERFORM
 10911           IF P1 < +9
 10912              MOVE PD-MAX-extension (P1)
 10913                                 TO pi-max-ext
 10914           else
 10915              move er-1674       to emi-error
 10916              PERFORM 9900-ERROR-FORMAT
 10917                                 THRU 9900-EXIT
 10918           END-IF
 10919        else
 10920           move er-1672          to emi-error
 10921           PERFORM 9900-ERROR-FORMAT
 10922                                 THRU 9900-EXIT
 10923        END-IF
 10924     end-if
 10925     move spaces                 to pi-max-ext-used
 10926     IF PI-PMTTYPE = '3'
 10927        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10928        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10929           MOVE ER-0477          TO EMI-ERROR
 10930           PERFORM 1165-PAID-THRU-ERROR
 10931                                 THRU 1165-EXIT
 10932        ELSE
 10933           continue
 10934        end-if
 10935     ELSE
 10936        IF WS-SV-EPYTHRU > WS-EXP-DT
 10937           move ws-exp-dt        to dc-bin-date-1
 10938           move ws-sv-epythru    to dc-bin-date-2
 10939           MOVE '1'              TO DC-OPTION-CODE
 10940           MOVE +0               TO DC-ELAPSED-DAYS
 10941                                    DC-ELAPSED-MONTHS
 10942           PERFORM 9700-LINK-DATE-CONVERT
 10943                                 THRU 9700-EXIT
 10944           if no-conversion-error
 10945              if dc-elapsed-days > zeros
 10946                 add +1 to dc-elapsed-months
 10947              end-if
 10948              if dc-elapsed-months > pi-max-ext
 10949                 MOVE ER-0557    TO EMI-ERROR
 10950                 PERFORM 1165-PAID-THRU-ERROR
 10951                                 THRU 1165-EXIT
 10952              else
 10953                 move 'Y'        to pi-max-ext-used
 10954                 move er-1670    to emi-error
 10955                 perform 9900-error-format
 10956                                 thru 9900-exit
 10957              end-if
 10958           end-if
 10959        end-if
 10960     end-if
 10961
 10962     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10963         PI-PMTTYPE NOT = '3'
 10964         MOVE ER-0541        TO EMI-ERROR
 10965         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10966
 10967     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 208
* EL156.cbl
 10968        (PI-PMTTYPE NOT = '3')
 10969         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10970             MOVE ER-0478        TO EMI-ERROR
 10971             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10972
 10973     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10974        (PI-PMTTYPE NOT = '4')
 10975         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10976             MOVE ER-0479        TO EMI-ERROR
 10977             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10978
 10979     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10980         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10981             MOVE ER-0545        TO EMI-ERROR
 10982             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10983
 10984     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10985         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10986             MOVE ER-0481        TO EMI-ERROR
 10987             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10988
 10989*    IF PI-COMPANY-ID = 'NCL'
 10990*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10991*           CM-AH-CRITICAL-PERIOD = +0
 10992*            MOVE ER-0844        TO  EMI-ERROR
 10993*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10994
 10995*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10996     if (cl-critical-period = zeros)
 10997        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10998          GO TO 1200-EDIT-FIND-TOLERANCES.
 10999
 11000     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11001     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11002     MOVE '1'        TO DC-OPTION-CODE.
 11003     MOVE +0         TO DC-ELAPSED-DAYS
 11004                        DC-ELAPSED-MONTHS.
 11005     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11006
 11007*    IF NO-CONVERSION-ERROR
 11008*       COMPUTE ws-benefits-paid =
 11009*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11010*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11011*           MOVE ER-0657 TO EMI-ERROR
 11012*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11013
 11014     GO TO 1200-EDIT-FIND-TOLERANCES.
 11015
 11016 1165-PAID-THRU-ERROR.
 11017     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11018
 11019     IF EMI-MESSAGE-FORMATTED
 11020         MOVE -1                 TO EPYTHRUL
 11021         MOVE AL-UNBON           TO EPYTHRUA.
 11022
 11023 1165-EXIT.
 11024     EXIT.
 11025
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 209
* EL156.cbl
 11026 1166-CHECK-ALL-TRLRS.
 11027
 11028     IF PI-PMTTYPE = '4'
 11029        GO TO 1166-TRLR-EXIT.
 11030
 11031     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11032
 11033     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11034        WS-SV-EPYFROM = LOW-VALUES
 11035          GO TO 1166-END-CHECK.
 11036
 11037
 11038* EXEC CICS HANDLE CONDITION
 11039*        ENDFILE   (1166-END-CHECK)
 11040*        NOTFND    (1166-END-CHECK)
 11041*    END-EXEC.
 11042*    MOVE '"$''I                  ! ) #00010621' TO DFHEIV0
 11043     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11045     MOVE X'2920233030303130363231' TO DFHEIV0(25:11)
 11046     CALL 'kxdfhei1' USING DFHEIV0
 11047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11048
 11049
 11050     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11051     MOVE +100                   TO TRLR-SEQ-NO.
 11052
 11053
 11054* EXEC CICS STARTBR
 11055*         DATASET    ('ELTRLR')
 11056*         RIDFLD     (ELTRLR-KEY)
 11057*         GTEQ
 11058*    END-EXEC.
 11059     MOVE 'ELTRLR' TO DFHEIV1
 11060     MOVE 0
 11061       TO DFHEIV11
 11062*    MOVE '&,         G          &   #00010629' TO DFHEIV0
 11063     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11064     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11065     MOVE X'2020233030303130363239' TO DFHEIV0(25:11)
 11066     CALL 'kxdfhei1' USING DFHEIV0,
 11067           DFHEIV1,
 11068           ELTRLR-KEY,
 11069           DFHEIV99,
 11070           DFHEIV11,
 11071           DFHEIV99
 11072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11073
 11074
 11075     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11076
 11077 1166-READ-TRLR-NEXT.
 11078
 11079
 11080* EXEC CICS READNEXT
 11081*         DATASET    ('ELTRLR')
 11082*         RIDFLD     (ELTRLR-KEY)
 11083*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 210
* EL156.cbl
 11084*    END-EXEC.
 11085     MOVE 'ELTRLR' TO DFHEIV1
 11086     MOVE 0
 11087       TO DFHEIV11
 11088*    MOVE '&.S                   )   #00010639' TO DFHEIV0
 11089     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11090     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11091     MOVE X'2020233030303130363339' TO DFHEIV0(25:11)
 11092     CALL 'kxdfhei1' USING DFHEIV0,
 11093           DFHEIV1,
 11094           DFHEIV20,
 11095           DFHEIV99,
 11096           ELTRLR-KEY,
 11097           DFHEIV99,
 11098           DFHEIV11,
 11099           DFHEIV99,
 11100           DFHEIV99
 11101     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11102         DFHEIV20
 11103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11104
 11105
 11106     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11107        TRLR-CARRIER  = MSTR-CARRIER  AND
 11108        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11109        TRLR-CERT-NO  = MSTR-CERT-NO
 11110          NEXT SENTENCE
 11111      ELSE
 11112          GO TO 1166-END-CHECK.
 11113
 11114* **  BYPASS ALL NON-PAYMENT TRAILERS
 11115
 11116     IF AT-TRAILER-TYPE = '2'
 11117        NEXT SENTENCE
 11118     ELSE
 11119        GO TO 1166-READ-TRLR-NEXT.
 11120
 11121* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11122
 11123     IF AT-PAYMENT-TYPE = '1' OR '2'
 11124        NEXT SENTENCE
 11125     ELSE
 11126        GO TO 1166-READ-TRLR-NEXT.
 11127
 11128* **  BYPASS ALL VOID PAYMENTS
 11129
 11130     IF AT-VOID-DT NOT = LOW-VALUES
 11131        GO TO 1166-READ-TRLR-NEXT.
 11132
 11133     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11134        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11135          GO TO 1166-READ-TRLR-NEXT.
 11136
 11137     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11138         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11139            OR
 11140        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11141         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 211
* EL156.cbl
 11142        NEXT SENTENCE
 11143     ELSE
 11144         IF CL-TOTAL-PAID-AMT > ZEROS
 11145             MOVE ER-0502            TO EMI-ERROR
 11146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11147             MOVE -1                 TO EPYTHRUL
 11148             MOVE AL-UNBON           TO EPYTHRUA.
 11149
 11150     GO TO 1166-READ-TRLR-NEXT.
 11151
 11152 1166-END-CHECK.
 11153
 11154     IF WS-BROWSE-TRLR-SW = 'Y'
 11155
 11156* EXEC CICS ENDBR
 11157*            DATASET   ('ELTRLR')
 11158*       END-EXEC.
 11159     MOVE 'ELTRLR' TO DFHEIV1
 11160     MOVE 0
 11161       TO DFHEIV11
 11162*    MOVE '&2                    $   #00010694' TO DFHEIV0
 11163     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11164     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11165     MOVE X'2020233030303130363934' TO DFHEIV0(25:11)
 11166     CALL 'kxdfhei1' USING DFHEIV0,
 11167           DFHEIV1,
 11168           DFHEIV11,
 11169           DFHEIV99
 11170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11171
 11172
 11173     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11174
 11175 1166-TRLR-EXIT.
 11176     EXIT.
 11177
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 212
* EL156.cbl
 11179 1170-PAID-THRU-FATAL-ERROR.
 11180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11181
 11182     MOVE -1                     TO EPYTHRUL.
 11183     MOVE AL-UNBON               TO EPYTHRUA.
 11184
 11185 1200-EDIT-FIND-TOLERANCES.
 11186
 11187* EXEC CICS HANDLE CONDITION
 11188*        ENDFILE(1950-NOT-FOUND)
 11189*        NOTFND (1950-NOT-FOUND)
 11190*    END-EXEC.
 11191*    MOVE '"$''I                  ! * #00010711' TO DFHEIV0
 11192     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11194     MOVE X'2A20233030303130373131' TO DFHEIV0(25:11)
 11195     CALL 'kxdfhei1' USING DFHEIV0
 11196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11197
 11198
 11199     IF PI-PROCESSOR-ID = 'LGXX'
 11200        GO TO 1240-FIND-ACCT-TOLERANCES.
 11201
 11202     MOVE 'N'                    TO FOUND-TOL-SW.
 11203     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11204     MOVE '2'                    TO CNTL-REC-TYPE.
 11205     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11206     MOVE +0                     TO CNTL-SEQ-NO.
 11207     MOVE 'PROC'                 TO FILE-SWITCH.
 11208
 11209     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11210
 11211     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11212     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11213                                    PI-MAX-PMT-TOL.
 11214     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11215
 11216     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11217         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11218
 11219     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11220     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11221                                    PI-MAX-LF-PMT-TOL.
 11222
 11223     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11224         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11225
 11226     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11227                                    PI-MAX-EXP-PMT.
 11228
 11229 1240-FIND-ACCT-TOLERANCES.
 11230
 11231     IF WS-PMT-TOL NOT = +0
 11232         MOVE 'Y'                TO FOUND-TOL-SW.
 11233
 11234     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11235         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11236         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 213
* EL156.cbl
 11237         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11238         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11239         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11240         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11241     ELSE
 11242         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11243         MOVE PI-CARRIER             TO ACCT-CARRIER
 11244         MOVE PI-GROUPING            TO ACCT-GROUPING
 11245         MOVE PI-STATE               TO ACCT-STATE
 11246         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11247         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11248
 11249     MOVE 'ACCT'                 TO FILE-SWITCH.
 11250
 11251     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11252     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11253
 11254
 11255* EXEC CICS HANDLE CONDITION
 11256*         NOTFND   (1950-NOT-FOUND)
 11257*         ENDFILE  (1950-NOT-FOUND)
 11258*    END-EXEC.
 11259*    MOVE '"$I''                  ! + #00010771' TO DFHEIV0
 11260     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11261     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11262     MOVE X'2B20233030303130373731' TO DFHEIV0(25:11)
 11263     CALL 'kxdfhei1' USING DFHEIV0
 11264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11265
 11266
 11267
 11268* EXEC CICS STARTBR
 11269*        DATASET('ERACCT')
 11270*        RIDFLD (ERACCT-KEY)
 11271*        GTEQ
 11272*    END-EXEC.
 11273     MOVE 'ERACCT' TO DFHEIV1
 11274     MOVE 0
 11275       TO DFHEIV11
 11276*    MOVE '&,         G          &   #00010776' TO DFHEIV0
 11277     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11279     MOVE X'2020233030303130373736' TO DFHEIV0(25:11)
 11280     CALL 'kxdfhei1' USING DFHEIV0,
 11281           DFHEIV1,
 11282           ERACCT-KEY,
 11283           DFHEIV99,
 11284           DFHEIV11,
 11285           DFHEIV99
 11286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11287
 11288
 11289 1245-FIND-ACCT-TOLERANCES-LOOP.
 11290
 11291
 11292* EXEC CICS READNEXT
 11293*        DATASET('ERACCT')
 11294*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 214
* EL156.cbl
 11295*        RIDFLD (ERACCT-KEY)
 11296*    END-EXEC.
 11297     MOVE 'ERACCT' TO DFHEIV1
 11298     MOVE 0
 11299       TO DFHEIV11
 11300*    MOVE '&.S                   )   #00010784' TO DFHEIV0
 11301     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11302     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11303     MOVE X'2020233030303130373834' TO DFHEIV0(25:11)
 11304     CALL 'kxdfhei1' USING DFHEIV0,
 11305           DFHEIV1,
 11306           DFHEIV20,
 11307           DFHEIV99,
 11308           ERACCT-KEY,
 11309           DFHEIV99,
 11310           DFHEIV11,
 11311           DFHEIV99,
 11312           DFHEIV99
 11313     SET ADDRESS OF ACCOUNT-MASTER TO
 11314         DFHEIV20
 11315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11316
 11317
 11318     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11319        IF WS-ERACCT-HOLD-RECORD = SPACES
 11320           GO TO 1950-NOT-FOUND
 11321        ELSE
 11322           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11323           GO TO 1250-CONTINUE.
 11324
 11325     IF ACCT-EXP-DT = HIGH-VALUES
 11326        NEXT SENTENCE
 11327     ELSE
 11328        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11329        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11330
 11331 1250-CONTINUE.
 11332
 11333     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11334
 11335     IF FOUND-TOL-SW = 'N'
 11336         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11337
 11338********* 1260-FIND-STATE-TOLERANCES.
 11339
 11340     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11341     MOVE PI-STATE               TO WS-ST-ACCESS.
 11342     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11343     MOVE '3'                    TO CNTL-REC-TYPE.
 11344     MOVE +0                     TO CNTL-SEQ-NO.
 11345     MOVE 'STAT'                 TO FILE-SWITCH.
 11346
 11347     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11348
 11349     IF WS-PMT-TOL = +0
 11350         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11351
 11352     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 215
* EL156.cbl
 11353     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11354     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11355     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11356     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11357
 11358****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11359****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11360     IF PI-PAYEE-TYPE <> 'B'
 11361           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11362     END-IF.
 11363
 11364     IF PI-PMTTYPE      = '2'  AND
 11365        PI-SPLIT-PMT-SW = 'Y'  AND
 11366        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11367          MOVE ER-3530                TO EMI-ERROR
 11368          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11369
 11370********* 1280-FIND-BENEFIT-TOLERANCES.
 11371
 11372     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11373        OR (PI-PMTTYPE = '5' OR '6')
 11374         GO TO 1300-FIND-CARR-TOLERANCES.
 11375
 11376     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11377     MOVE '4'                    TO CNTL-REC-TYPE.
 11378     MOVE +0                     TO CNTL-SEQ-NO.
 11379     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11380     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11381     MOVE 'BENE'                 TO FILE-SWITCH.
 11382
 11383     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11384
 11385     IF NO-BENEFIT-FOUND
 11386         GO TO 1950-NOT-FOUND.
 11387
 11388     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11389     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11390     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11391
 11392
 11393* EXEC CICS HANDLE CONDITION
 11394*        NOTFND(1950-NOT-FOUND)
 11395*    END-EXEC.
 11396*    MOVE '"$I                   ! , #00010864' TO DFHEIV0
 11397     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11399     MOVE X'2C20233030303130383634' TO DFHEIV0(25:11)
 11400     CALL 'kxdfhei1' USING DFHEIV0
 11401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11402
 11403
 11404 1300-FIND-CARR-TOLERANCES.
 11405     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11406     MOVE '6'                    TO CNTL-REC-TYPE.
 11407
 11408     IF CONTROL-IS-ACTUAL-CARRIER
 11409         MOVE PI-CARRIER               TO WS-CARR
 11410     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 216
* EL156.cbl
 11411         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11412
 11413     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11414     MOVE +0                     TO CNTL-SEQ-NO.
 11415     MOVE 'CARR'                 TO FILE-SWITCH.
 11416
 11417     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11418
 11419     IF WS-DAYS-TOL = +0
 11420         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11421
 11422     IF WS-PMT-TOL = +0
 11423         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11424
 11425     IF WS-MAX-DAYS-TOL = +0
 11426         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11427
 11428     IF WS-MAX-PMT-TOL = +0
 11429         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11430                                    PI-MAX-PMT-TOL.
 11431
 11432     IF WS-MAX-LF-PMT-TOL = +0
 11433        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11434                                    PI-MAX-LF-PMT-TOL.
 11435
 11436     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11437
 11438********* 1320-FIND-COMP-TOLERANCES.
 11439
 11440     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11441     MOVE '1'                    TO CNTL-REC-TYPE.
 11442     MOVE SPACES                 TO CNTL-ACCESS.
 11443     MOVE +0                     TO CNTL-SEQ-NO.
 11444     MOVE 'COMP'                 TO FILE-SWITCH.
 11445
 11446     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11447
 11448     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11449     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11450
 11451     IF WS-PMT-TOL NOT = +0
 11452        IF WS-TOL-SEVERITY NOT = ' '
 11453         GO TO 1360-EDIT-DAYS.
 11454
 11455     IF WS-PMT-TOL = +0
 11456         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11457
 11458     IF WS-TOL-SEVERITY = ' '
 11459         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11460
 11461 1360-EDIT-DAYS.
 11462     IF PI-PMTTYPE NOT = '4'
 11463        IF PI-EDAYS NEGATIVE OR
 11464           PI-EPYAMT NEGATIVE
 11465          MOVE ER-0513             TO EMI-ERROR
 11466          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467          MOVE -1                  TO PMTTYPEL.
 11468
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 217
* EL156.cbl
 11469     IF PI-PMTTYPE = '5' OR '6'
 11470        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11471
 11472     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11473        IF PI-PMTTYPE = '4'
 11474          MOVE PI-EDAYS          TO PI-CDAYS.
 11475
 11476     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11477         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11478
 11479     IF PI-PMTTYPE = '4'
 11480        MOVE PI-EDAYS            TO PI-CDAYS
 11481        GO TO 1400-EDIT-PAYMENT.
 11482
 11483     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11484        GO TO 1500-EDIT-EXPENSES.
 11485
 11486*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11487*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11488*          CM-AH-BENEFIT-CD = '23'              AND
 11489*          CL-CERT-STATE    = '04'              AND
 11490*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11491*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11492*            GO TO 1362-CHECK-MAX-DAYS.
 11493
 11494     IF PI-EDAYS = ZEROS
 11495*        IF PI-COMPANY-ID = 'DMD'
 11496*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11497*            MOVE -1             TO DC-ELAPSED-DAYS
 11498*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11499*            MOVE '6'            TO DC-OPTION-CODE
 11500*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11501*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11502*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11503*            MOVE '1'            TO DC-OPTION-CODE
 11504*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11505*            IF NO-CONVERSION-ERROR
 11506*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11507*                                 + DC-ODD-DAYS-OVER
 11508*               MOVE 6           TO EDAYSL
 11509*               MOVE AL-UNNON    TO EDAYSA
 11510*            ELSE
 11511*                NEXT SENTENCE
 11512*       ELSE
 11513            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11514            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11515            MOVE '1'             TO DC-OPTION-CODE
 11516            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11517            IF NO-CONVERSION-ERROR
 11518                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11519                ADD 1                 TO PI-EDAYS
 11520                MOVE AL-UNNON         TO EDAYSA.
 11521
 11522*    IF PI-COMPANY-ID = 'DMD'
 11523*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11524*        MOVE -1                 TO DC-ELAPSED-DAYS
 11525*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11526*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 218
* EL156.cbl
 11527*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11528*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11529*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11530*        MOVE '1'                TO DC-OPTION-CODE
 11531*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11532*    ELSE
 11533         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11534         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11535         MOVE '1'                TO DC-OPTION-CODE.
 11536         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11537
 11538     IF NO-CONVERSION-ERROR
 11539        IF PI-COMPANY-ID = 'DMD'
 11540            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11541                             + DC-ODD-DAYS-OVER
 11542        ELSE
 11543            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11544            ADD 1                TO PI-CDAYS.
 11545
 11546     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11547        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11548        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11549
 11550     IF PI-EDAYS NOT NUMERIC
 11551         MOVE ER-0491            TO EMI-ERROR
 11552         GO TO 1370-DAYS-ERROR.
 11553
 11554     IF CL-NO-OF-PMTS-MADE = 0
 11555        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11556        AND CL-CERT-STATE = 'MI'
 11557        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11558            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11559     END-IF.
 11560
 11561 1362-CHECK-MAX-DAYS.
 11562
 11563     IF WS-MAX-DAYS-TOL = +999
 11564         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11565
 11566     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11567         IF PI-EDAYS = ZEROS
 11568             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11569         ELSE
 11570             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11571
 11572     IF WS-MAX-DAYS-TOL NOT = ZERO
 11573        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11574           PI-CDAYS > WS-MAX-DAYS-TOL
 11575             MOVE ER-0492          TO EMI-ERROR
 11576             GO TO 1370-DAYS-ERROR.
 11577
 11578 1365-SKIP-MAX-DAYS-EDIT.
 11579     IF PI-EDAYS = ZEROS
 11580        GO TO 1400-EDIT-PAYMENT.
 11581
 11582     IF WS-DAYS-TOL NOT = ZERO
 11583        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11584           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 219
* EL156.cbl
 11585                MOVE ER-0493     TO EMI-ERROR
 11586                GO TO 1370-DAYS-ERROR.
 11587
 11588     GO TO 1400-EDIT-PAYMENT.
 11589
 11590 1370-DAYS-ERROR.
 11591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11592
 11593     IF EMI-MESSAGE-FORMATTED
 11594         MOVE -1                 TO EDAYSL
 11595         MOVE AL-UABON           TO EDAYSA.
 11596
 11597     GO TO 1400-EDIT-PAYMENT.
 11598
 11599 1380-EDIT-EXPENSE-PMT-AMT.
 11600     IF PI-PMTTYPE = '5' OR '6'
 11601         NEXT SENTENCE
 11602     ELSE
 11603         GO TO 1400-EDIT-PAYMENT.
 11604
 11605     IF WS-MAX-EXP-PMT NOT = ZEROS
 11606        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11607            MOVE ER-3529            TO EMI-ERROR
 11608            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11609
 11610     GO TO 1500-EDIT-EXPENSES.
 11611
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 220
* EL156.cbl
 11613
 11614 1390-CHECK-PAYMENT-DAYS.
 11615
 11616     IF PI-EDAYS = 0
 11617         MOVE PI-CDAYS TO WS-PD-DAYS
 11618     ELSE
 11619         MOVE PI-EDAYS TO WS-PD-DAYS
 11620     END-IF.
 11621
 11622     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11623         IF WS-PD-DAYS = 14
 11624            GO TO 1390-EXIT
 11625         END-IF
 11626     END-IF.
 11627
 11628     IF PI-COMPANY-ID = 'AHL'  AND
 11629        CM-AH-BENEFIT-CD = '1K'
 11630         IF WS-PD-DAYS = 14
 11631            GO TO 1390-EXIT
 11632         END-IF
 11633     END-IF.
 11634
 11635     IF WS-PD-DAYS < 30
 11636         MOVE ER-3549              TO EMI-ERROR
 11637         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11638     END-IF.
 11639
 11640 1390-EXIT.
 11641      EXIT.
 11642
 11643 1400-EDIT-PAYMENT.
 11644*    IF PI-COMPANY-ID = 'DMD'
 11645*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11646*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11647
 11648     IF PI-COMPANY-ID = 'DCC'
 11649        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11650        MOVE PI-CARRIER          TO ACCT-CARRIER
 11651        MOVE PI-GROUPING         TO ACCT-GROUPING
 11652        MOVE PI-STATE            TO ACCT-STATE
 11653        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11654        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11655        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11656        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11657
 11658
 11659* EXEC CICS READ
 11660*          DATASET ('ERACCT')
 11661*          RIDFLD  (ERACCT-KEY)
 11662*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11663*          GTEQ
 11664*          resp    (WS-RESPONSE)
 11665*       END-EXEC
 11666     MOVE 'ERACCT' TO DFHEIV1
 11667*    MOVE '&"S        G          (  N#00011122' TO DFHEIV0
 11668     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11670     MOVE X'204E233030303131313232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 221
* EL156.cbl
 11671     CALL 'kxdfhei1' USING DFHEIV0,
 11672           DFHEIV1,
 11673           DFHEIV20,
 11674           DFHEIV99,
 11675           ERACCT-KEY,
 11676           DFHEIV99,
 11677           DFHEIV99,
 11678           DFHEIV99
 11679     SET ADDRESS OF ACCOUNT-MASTER TO
 11680         DFHEIV20
 11681     MOVE EIBRESP  TO WS-RESPONSE
 11682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11683        IF WS-RESP-NORMAL
 11684           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11685           and pi-cert-eff-dt < am-expiration-dt
 11686           and pi-cert-eff-dt >= am-effective-dt
 11687           move am-dcc-product-code to pi-dcc-product-code
 11688        else
 11689           move spaces           to pi-dcc-product-code
 11690        end-if
 11691        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11692           PERFORM 0900-GET-DDF-LIMITS
 11693                                 THRU 0900-EXIT
 11694           IF PDEF-FOUND
 11695              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11696                 (P1 > +8)
 11697                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11698              END-PERFORM
 11699              IF P1 < +9
 11700                 if pd-ben-pct (p1) not numeric
 11701                    move zeros   to pd-ben-pct (p1)
 11702                 end-if
 11703                 if pd-ben-pct (p1) = zeros
 11704                    move +1      to ws-work-ben-pct
 11705                 else
 11706                    move pd-ben-pct (p1)
 11707                                 to ws-work-ben-pct
 11708                 end-if
 11709                 compute cm-ah-benefit-amt =
 11710                    cm-ah-benefit-amt * ws-work-ben-pct
 11711                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11712                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11713                 end-if
 11714              else
 11715                 move er-1674    to emi-error
 11716                 PERFORM 9900-ERROR-FORMAT
 11717                                 THRU 9900-EXIT
 11718              END-IF
 11719           else
 11720              move er-1672       to emi-error
 11721              PERFORM 9900-ERROR-FORMAT
 11722                                 THRU 9900-EXIT
 11723           END-IF
 11724        end-if
 11725     END-IF
 11726     IF PI-PMTTYPE NOT = '4'
 11727        GO TO 1405-CALC-PAYMENT.
 11728
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 222
* EL156.cbl
 11729     IF PI-EDAYS NOT NUMERIC
 11730         MOVE PI-EPYAMT           TO PI-CPYAMT
 11731         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11732         GO TO 1430-CHECK-AH-TOLERANCE.
 11733
 11734*    IF PI-COMPANY-ID = 'FIA'
 11735*       IF CERT-ACCOUNT = '0000011043'
 11736*        COMPUTE PI-DAILY-RATE ROUNDED =
 11737*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11738*        COMPUTE PI-CPYAMT ROUNDED =
 11739*                          PI-DAILY-RATE * PI-EDAYS
 11740*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11741*        GO TO 1430-CHECK-AH-TOLERANCE.
 11742
 11743     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11744         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11745         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11746         GO TO 1420-CHECK-AIG-BENEFIT.
 11747
 11748     IF WS-CALC-METHOD = '2' OR  '5'
 11749         COMPUTE PI-DAILY-RATE ROUNDED =
 11750                        (CM-AH-BENEFIT-AMT * 12) / 365
 11751         COMPUTE PI-CPYAMT ROUNDED =
 11752                           PI-DAILY-RATE * PI-EDAYS
 11753        GO TO 1420-CHECK-AIG-BENEFIT.
 11754
 11755     IF WS-CALC-METHOD = '3'
 11756         COMPUTE PI-DAILY-RATE =
 11757                         (CM-AH-BENEFIT-AMT * 12) / 365
 11758         COMPUTE PI-CPYAMT ROUNDED =
 11759                           PI-DAILY-RATE * PI-EDAYS
 11760        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 223
* EL156.cbl
 11762*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11763
 11764****************************************************************
 11765****************************************************************
 11766*                  CALCULATED FROM      PAYMENT      PAYMENT
 11767*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11768* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11769*1-01-83  1-15-83    0    15     15        15           15
 11770*1-01-83  1-30-83    0    30     30        30           30
 11771*1-01-83  1-31-83    1     0     31        30           30
 11772*1-01-83  2-01-83    1     1     32        31           31
 11773*1-01-83  2-15-83    1    15     46        45           45
 11774*1-01-83  2-28-83    2     0     59        60           60
 11775*1-01-83  3-01-83    2     1     60        61           61
 11776*1-01-83  3-31-83    3     0     90        90           90
 11777*1-15-83  1-31-83    0    17     17        17           16
 11778*1-15-83  2-01-83    0    18     18        18           17
 11779*1-15-83  2-28-83    1    14     45        44           46
 11780*1-21-83  3-09-83    1    20     48        50           49
 11781*2-05-83  3-06-83    1     2     30        32           32
 11782*2-05-83  3-23-83    1    19     47        49           49
 11783*2-15-83  2-28-83    0    14     14        14           16
 11784*2-15-83  3-01-83    0    15     15        15           17
 11785*2-21-83  3-19-83    0    27     27        27           29
 11786*2-21-83  3-20-83    1     0     28        30           30
 11787*2-21-83  4-10-83    1    18     49        30           50
 11788*2-21-83  5-19-83    2    27     88        87           89
 11789*2-21-83  5-22-83    3     2     91        92           92
 11790*3-21-83  5-19-83    1    30     60        60           59
 11791****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 224
* EL156.cbl
 11793 1405-CALC-PAYMENT.
 11794     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11795     MOVE ' '                    TO DC-OPTION-CODE.
 11796     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11797     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11798     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11799
 11800     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11801     MOVE ' '                    TO DC-OPTION-CODE.
 11802     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11803     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11804     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11805
 11806     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11807     MOVE -1                     TO DC-ELAPSED-DAYS.
 11808     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11809     MOVE '6'                    TO DC-OPTION-CODE.
 11810     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11811     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11812
 11813     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11814     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11815     MOVE '1'                    TO DC-OPTION-CODE.
 11816     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11817
 11818     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11819     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11820     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11821
 11822******************************************************************
 11823*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11824*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11825*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11826******************************************************************
 11827
 11828     IF WS-CALC-METHOD = '1'           AND
 11829        DC-ELAPSED-MONTHS > ZERO AND
 11830        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11831        WDF-DAY > WDT-DAY
 11832          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11833          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11834          MOVE -1                  TO DC-ELAPSED-MONTHS
 11835          MOVE '6'                 TO DC-OPTION-CODE
 11836          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11837          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11838          COMPUTE WS-SAVE-ODD-DAYS =
 11839          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11840          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11841
 11842     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11843     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11844     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11845
 11846     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11847     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11848
 11849*    IF PI-COMPANY-ID = 'FIA'
 11850*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 225
* EL156.cbl
 11851*        COMPUTE PI-DAILY-RATE ROUNDED =
 11852*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11853*        COMPUTE PI-CPYAMT ROUNDED =
 11854*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11855*        GO TO 1420-CHECK-AIG-BENEFIT.
 11856
 11857*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11858*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11859*          CM-AH-BENEFIT-CD = '23'               AND
 11860*          CL-CERT-STATE    = '04'               AND
 11861*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11862*            COMPUTE WS-DAILY-RATE ROUNDED =
 11863*                               CM-AH-BENEFIT-AMT / 30
 11864*            COMPUTE PI-CPYAMT ROUNDED =
 11865*                               (WS-DAILY-RATE * PI-CDAYS)
 11866*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11867*            GO TO 1420-CHECK-AIG-BENEFIT.
 11868
 11869     IF WS-CALC-METHOD = '1'
 11870         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11871         COMPUTE PI-CPYAMT ROUNDED =
 11872             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11873             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11874         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11875         GO TO 1420-CHECK-AIG-BENEFIT.
 11876
 11877     IF WS-CALC-METHOD = '2'
 11878         COMPUTE PI-DAILY-RATE ROUNDED =
 11879                          (CM-AH-BENEFIT-AMT * 12) / 365
 11880         COMPUTE PI-CPYAMT ROUNDED =
 11881             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11882             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11883         GO TO 1420-CHECK-AIG-BENEFIT.
 11884
 11885     IF WS-CALC-METHOD = '4'
 11886         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11887         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11888         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11889         COMPUTE PI-CPYAMT ROUNDED =
 11890                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11891         GO TO 1420-CHECK-AIG-BENEFIT.
 11892
 11893     IF WS-CALC-METHOD = '5'
 11894         COMPUTE PI-DAILY-RATE ROUNDED =
 11895                            (CM-AH-BENEFIT-AMT * 12) / 365
 11896         COMPUTE PI-CPYAMT ROUNDED =
 11897                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11898         GO TO 1420-CHECK-AIG-BENEFIT.
 11899
 11900     IF WS-CALC-METHOD NOT = '3'
 11901        GO TO 1410-CHECK-PAYMENT.
 11902
 11903******   CALCULATION METHOD  3  ROUTINE
 11904     COMPUTE PI-DAILY-RATE =
 11905                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11906
 11907******CHECK TO SEE IF WITHIN SAME MONTH
 11908     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 226
* EL156.cbl
 11909        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11910                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11911         GO TO 1420-CHECK-AIG-BENEFIT.
 11912
 11913******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11914     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11915             SAVE-ODD-DAYS-OVER = ZEROS
 11916      COMPUTE PI-CPYAMT  ROUNDED =
 11917                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11918      GO TO 1420-CHECK-AIG-BENEFIT.
 11919
 11920******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11921******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11922     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11923        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11924        IF WDF-MONTH > 12
 11925           ADD 1                 TO WDF-YEAR
 11926           SUBTRACT 12         FROM WDF-MONTH.
 11927
 11928******CONVERT THE NEW FROM MONTH TO BINARY
 11929     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11930        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11931        MOVE '4'              TO DC-OPTION-CODE
 11932        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11933        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11934
 11935     IF WDF-MONTH = WDT-MONTH AND
 11936        WDF-YEAR  = WDT-YEAR
 11937          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11938                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11939                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11940        ELSE
 11941          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11942          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11943          COMPUTE PI-CPYAMT ROUNDED =
 11944       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11945       +
 11946       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11947       +
 11948       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11949
 11950     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 227
* EL156.cbl
 11952 1410-CHECK-PAYMENT.
 11953******PAYMENT OPTION 6
 11954******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11955     IF SAVE-ELAPSED-MONTHS > ZERO
 11956        IF SAVE-ODD-DAYS-OVER = ZEROS
 11957           GO TO 1412-CHECK-TO-DAY
 11958        ELSE
 11959           IF WDF-DAY > WDT-DAY
 11960              IF WDF-MONTH = 02
 11961                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11962                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11963                  GO TO 1412-CHECK-TO-DAY
 11964              ELSE
 11965                  IF FROM-DAYS-IN-MONTH = 31
 11966                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11967                     GO TO 1412-CHECK-TO-DAY
 11968                  ELSE
 11969                     GO TO 1412-CHECK-TO-DAY
 11970           ELSE
 11971               GO TO 1412-CHECK-TO-DAY.
 11972
 11973     IF WDF-MONTH NOT = WDT-MONTH
 11974        IF WDF-MONTH = 02
 11975           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11976           IF WDF-DAY = 29
 11977              ADD 1              TO SAVE-ODD-DAYS-OVER
 11978           ELSE
 11979              ADD 2              TO SAVE-ODD-DAYS-OVER
 11980        ELSE
 11981           IF FROM-DAYS-IN-MONTH = 31
 11982              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11983
 11984 1412-CHECK-TO-DAY.
 11985        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11986           IF WDT-DAY = 28
 11987              ADD 2              TO SAVE-ODD-DAYS-OVER
 11988           ELSE
 11989              IF WDT-DAY = 29
 11990                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11991              ELSE
 11992                 NEXT SENTENCE
 11993        ELSE
 11994           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11995              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11996
 11997     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11998     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11999     COMPUTE PI-CPYAMT ROUNDED =
 12000         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12001         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12002
 12003     GO TO 1420-CHECK-AIG-BENEFIT.
 12004
 12005 1415-CHECK-LEAP-YEAR.
 12006     IF FROM-DAYS-IN-MONTH = 29
 12007        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12008
 12009 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 228
* EL156.cbl
 12010     EXIT.
 12011
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 229
* EL156.cbl
 12013 1420-CHECK-AIG-BENEFIT.
 12014
 12015     IF WS-SPECIAL-CALC-CD = 'Q'
 12016         GO TO 1425-CHECK-WHOLE-MONTH.
 12017
 12018*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12019*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12020*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12021*       (PI-PMTTYPE = '1' OR '2')
 12022*        NEXT SENTENCE
 12023*    ELSE
 12024         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12025         GO TO 1430-CHECK-AH-TOLERANCE.
 12026
 12027******************AIG LOGIC STARTS**********************
 12028*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12029*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12030*    MOVE ER-3533      TO EMI-ERROR.
 12031*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12032*    GO TO 1430-CHECK-AH-TOLERANCE.
 12033******************AIG LOGIC ENDS************************
 12034
 12035 1425-CHECK-WHOLE-MONTH.
 12036******************************************************************
 12037****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12038****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12039****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12040****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12041****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12042****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12043****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12044****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12045****          PAID * MONTHLY BENEFIT.                         ****
 12046******************************************************************
 12047
 12048     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12049
 12050     IF CL-NO-OF-PMTS-MADE > +0
 12051         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12052
 12053     IF PI-CDAYS < WS-BEN-DAYS
 12054         GO TO 1430-CHECK-AH-TOLERANCE.
 12055
 12056     IF PI-CDAYS = WS-BEN-DAYS
 12057         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12058         GO TO 1430-CHECK-AH-TOLERANCE.
 12059
 12060*    IF PI-COMPANY-ID = 'ACM'
 12061*       NEXT SENTENCE
 12062*    ELSE
 12063        GO TO 1425-NOT-ACM-W15C.
 12064
 12065*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12066*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12067*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12068*    MOVE '6'                    TO  DC-OPTION-CODE.
 12069*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12070*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 230
* EL156.cbl
 12071*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12072*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12073*       MOVE '1'                 TO  DC-OPTION-CODE
 12074*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12075*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12076*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12077*       IF NO-CONVERSION-ERROR
 12078*          IF (DC-ELAPSED-MONTHS > +0) OR
 12079*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12080*             NEXT SENTENCE
 12081*          ELSE
 12082*             MOVE +0            TO  PI-CPYAMT
 12083*             MOVE ER-0846       TO  EMI-ERROR
 12084*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12085*             GO TO 1430-CHECK-AH-TOLERANCE
 12086*       ELSE
 12087*           MOVE ER-0846         TO  EMI-ERROR
 12088*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12089*           GO TO 1430-CHECK-AH-TOLERANCE.
 12090*
 12091*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12092*       ADD +1 TO DC-ELAPSED-MONTHS.
 12093*
 12094*    COMPUTE PI-CPYAMT ROUNDED =
 12095*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12096*
 12097*    GO TO 1430-CHECK-AH-TOLERANCE.
 12098
 12099 1425-NOT-ACM-W15C.
 12100
 12101     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12102     MOVE '6'                        TO  DC-OPTION-CODE.
 12103     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12104     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12105
 12106     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12107     IF NO-CONVERSION-ERROR
 12108         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12109     ELSE
 12110         MOVE ER-0846                TO  EMI-ERROR
 12111         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12112         GO TO 1430-CHECK-AH-TOLERANCE.
 12113
 12114     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12115     MOVE '1'                        TO  DC-OPTION-CODE.
 12116     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12117     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12118     IF NO-CONVERSION-ERROR
 12119         IF DC-ODD-DAYS-OVER = +0
 12120             NEXT SENTENCE
 12121         ELSE
 12122             MOVE ER-0846            TO  EMI-ERROR
 12123             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12124             GO TO 1430-CHECK-AH-TOLERANCE
 12125     ELSE
 12126         MOVE ER-0846                TO  EMI-ERROR
 12127         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12128         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 231
* EL156.cbl
 12129
 12130     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12131         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12132
 12133     GO TO 1430-CHECK-AH-TOLERANCE.
 12134
 12135 1425-CONT-WHOLE-MONTH-PMTS.
 12136******************************************************************
 12137****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12138****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12139****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12140******************************************************************
 12141
 12142     IF PI-COMPANY-ID = 'ACM'
 12143        NEXT SENTENCE
 12144     ELSE
 12145        IF DC-ODD-DAYS-OVER = +0
 12146            NEXT SENTENCE
 12147        ELSE
 12148            MOVE ER-0845            TO  EMI-ERROR
 12149            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12150            GO TO 1430-CHECK-AH-TOLERANCE.
 12151
 12152     COMPUTE PI-CPYAMT ROUNDED =
 12153                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12154
 12155 1430-CHECK-AH-TOLERANCE.
 12156     IF PI-PMT-APPR-SW = 'G'
 12157         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12158
 12159*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12160*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12161*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12162*
 12163*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12164*      IF WDF-MONTH = 02
 12165*        IF SAVE-ELAPSED-MONTHS = 0
 12166*          NEXT SENTENCE
 12167*        ELSE
 12168*          IF SAVE-ODD-DAYS-OVER > 0
 12169*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12170*            COMPUTE WS-PMT-MOS ROUNDED =
 12171*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12172*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12173*                                     WS-PMT-MOS
 12174*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12175*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12176*          ELSE
 12177*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12178*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12179*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12180*                                     WS-PMT-MOS.
 12181
 12182     IF WS-MAX-PMT-TOL NOT = ZERO
 12183        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12184           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12185            MOVE ER-0494         TO  EMI-ERROR
 12186            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 232
* EL156.cbl
 12187            GO TO 1500-EDIT-EXPENSES.
 12188
 12189 1430-CONT-CHECK-AH-TOLERANCE.
 12190
 12191     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12192        GO TO 1500-EDIT-EXPENSES.
 12193
 12194     IF CM-O-B-COVERAGE
 12195        GO TO 1500-EDIT-EXPENSES.
 12196
 12197     IF PI-COMPANY-ID = 'NCL'
 12198       IF FOUND-TOL-SW = 'Y'
 12199         IF WS-PMT-TOL NOT = ZERO
 12200           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12201              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12202                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12203                  IF WS-NCL-PMT-OPTION = SPACES
 12204                      MOVE ER-0699 TO EMI-ERROR
 12205                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12206                  ELSE
 12207                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12208                      NEXT SENTENCE
 12209                  ELSE
 12210                  IF NOT WS-VALID-NCL-OPTION
 12211                      MOVE ER-0699 TO EMI-ERROR
 12212                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12213
 12214     IF WS-PMT-TOL NOT = ZERO
 12215        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12216           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12217           MOVE ER-0495          TO EMI-ERROR
 12218           PERFORM 1490-PAYMENT-ERROR
 12219                                 THRU 1490-EXIT
 12220        end-if
 12221     end-if
 12222
 12223     GO TO 1500-EDIT-EXPENSES.
 12224
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 233
* EL156.cbl
 12226 1440-COMPUTE-LIFE-REMAINING.
 12227
 12228     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12229        IF PI-PMTTYPE = '4'
 12230          MOVE PI-EPYAMT TO PI-CPYAMT
 12231          GO TO 1460-TEST-TYPE.
 12232
 12233     IF WS-LF-COVERAGE-TYPE = 'L'
 12234        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12235                          - CL-TOTAL-PAID-AMT
 12236        GO TO 1450-CHECK-MAX.
 12237
 12238     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12239        PI-LF-COVERAGE-TYPE = 'P'
 12240          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12241                              CM-LF-ITD-DEATH-AMT
 12242          GO TO 1450-CHECK-MAX.
 12243
 12244     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12245     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12246     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12247     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12248     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12249     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12250     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12251     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12252     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12253
 12254     PERFORM 9800-LINK-REM-TERM.
 12255
 12256     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12257     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12258     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12259     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12260     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12261     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12262     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12263     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12264     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12265     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12266     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12267     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12268     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12269     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12270     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12271     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12272     IF PI-COMPANY-ID = 'DCC'
 12273        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12274        MOVE PI-CARRIER          TO ACCT-CARRIER
 12275        MOVE PI-GROUPING         TO ACCT-GROUPING
 12276        MOVE PI-STATE            TO ACCT-STATE
 12277        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12278        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12279        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12280        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12281
 12282
 12283* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 234
* EL156.cbl
 12284*          DATASET ('ERACCT')
 12285*          RIDFLD  (ERACCT-KEY)
 12286*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12287*          GTEQ
 12288*          resp    (WS-RESPONSE)
 12289*       END-EXEC
 12290     MOVE 'ERACCT' TO DFHEIV1
 12291*    MOVE '&"S        G          (  N#00011728' TO DFHEIV0
 12292     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12293     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12294     MOVE X'204E233030303131373238' TO DFHEIV0(25:11)
 12295     CALL 'kxdfhei1' USING DFHEIV0,
 12296           DFHEIV1,
 12297           DFHEIV20,
 12298           DFHEIV99,
 12299           ERACCT-KEY,
 12300           DFHEIV99,
 12301           DFHEIV99,
 12302           DFHEIV99
 12303     SET ADDRESS OF ACCOUNT-MASTER TO
 12304         DFHEIV20
 12305     MOVE EIBRESP  TO WS-RESPONSE
 12306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12307        IF WS-RESP-NORMAL
 12308           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12309           and (pi-cert-eff-dt < am-expiration-dt)
 12310           and (pi-cert-eff-dt >= am-effective-dt)
 12311           move am-dcc-product-code to pi-dcc-product-code
 12312        else
 12313           move spaces           to pi-dcc-product-code
 12314        end-if
 12315        if pi-dcc-product-code not = spaces
 12316           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12317           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12318           PERFORM 0900-GET-DDF-limits
 12319                                 THRU 0900-EXIT
 12320           IF PDEF-FOUND
 12321              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12322                 (P1 > +8)
 12323                 OR (PD-PROD-CODE (P1) = 'L')
 12324              END-PERFORM
 12325              IF P1 < +9
 12326                 MOVE PD-MAX-AMT (P1)
 12327                                 TO CP-R-MAX-TOT-BEN
 12328              else
 12329                 move er-1674    to emi-error
 12330                 PERFORM 9900-ERROR-FORMAT
 12331                                 THRU 9900-EXIT
 12332              END-IF
 12333           else
 12334              move er-1672       to emi-error
 12335              PERFORM 9900-ERROR-FORMAT
 12336                                 THRU 9900-EXIT
 12337           END-IF
 12338        end-if
 12339     END-IF
 12340
 12341* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 235
* EL156.cbl
 12342*       PROGRAM  (LINK-REMAMT)
 12343*       COMMAREA (CALCULATION-PASS-AREA)
 12344*       LENGTH   (CP-COMM-LENGTH)
 12345*    END-EXEC.
 12346*    MOVE '."C                   (   #00011768' TO DFHEIV0
 12347     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12349     MOVE X'2020233030303131373638' TO DFHEIV0(25:11)
 12350     CALL 'kxdfhei1' USING DFHEIV0,
 12351           LINK-REMAMT,
 12352           CALCULATION-PASS-AREA,
 12353           CP-COMM-LENGTH,
 12354           DFHEIV99,
 12355           DFHEIV99,
 12356           DFHEIV99,
 12357           DFHEIV99
 12358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12359
 12360
 12361     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12362
 12363     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12364     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12365
 12366     IF PI-COMPANY-ID = 'BOA' AND
 12367        PI-PMTTYPE    = '2'   AND
 12368        PI-OFFLINE    = 'N'
 12369           GO TO 1441-COMPUTE-BOA-INTEREST.
 12370
 12371     IF PI-COMPANY-ID = 'NCL' AND
 12372        PI-PMTTYPE    = '2'   AND
 12373        PI-OFFLINE    = 'N'
 12374          GO TO 1442-COMPUTE-NCL-INTEREST
 12375       ELSE
 12376          GO TO 1445-CONTINUE.
 12377
 12378 1441-COMPUTE-BOA-INTEREST.
 12379     MOVE +0             TO WS-CALC-INT.
 12380
 12381     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12382     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12383     MOVE +0             TO DC-ELAPSED-MONTHS
 12384                            DC-ELAPSED-DAYS.
 12385     MOVE '1'            TO DC-OPTION-CODE.
 12386     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12387     IF NO-CONVERSION-ERROR
 12388         NEXT SENTENCE
 12389     ELSE
 12390         GO TO 1445-CONTINUE.
 12391
 12392     IF (PI-INT-RATE NOT > ZEROS)  AND
 12393        (DC-ELAPSED-DAYS > +30)
 12394         MOVE ER-3531            TO EMI-ERROR
 12395         MOVE -1                 TO PINTL
 12396         MOVE AL-UNBON           TO PINTA
 12397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12398
 12399     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 236
* EL156.cbl
 12400         GO TO 1445-CONTINUE.
 12401
 12402     IF (PI-INT-RATE NOT > ZEROS)  OR
 12403        (DC-ELAPSED-DAYS NOT > +30)
 12404         MOVE PI-EPYAMT TO PI-CPYAMT
 12405         GO TO 1441-FORMAT-NOTE.
 12406
 12407     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12408                                 *  PI-INT-RATE
 12409                                 *  DC-ELAPSED-DAYS
 12410                                 /  365
 12411                                 /  100.
 12412
 12413     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12414
 12415 1441-FORMAT-NOTE.
 12416
 12417     MOVE SPACES        TO WS-BOANOTE1.
 12418     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12419     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12420     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12421     MOVE AL-UANON      TO NOTE1A.
 12422
 12423     IF WS-CALC-INT > ZEROS
 12424         MOVE SPACES        TO WS-BOANOTE2
 12425         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12426         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12427         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12428         MOVE AL-UANON      TO NOTE2A.
 12429
 12430     GO TO 1445-CONTINUE.
 12431
 12432 1442-COMPUTE-NCL-INTEREST.
 12433     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12434     MOVE PI-STATE               TO WS-ST-ACCESS.
 12435     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12436     MOVE '3'                    TO CNTL-REC-TYPE.
 12437     MOVE +0                     TO CNTL-SEQ-NO.
 12438     MOVE 'STAT'                 TO FILE-SWITCH.
 12439
 12440     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12441
 12442     MOVE +0                 TO WS-CALC-INT.
 12443
 12444     IF ST-STAT-FROM-INCURRED
 12445         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12446       ELSE
 12447     IF ST-STAT-FROM-REPORTED
 12448         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12449       ELSE
 12450         GO TO 1445-CONTINUE.
 12451
 12452     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12453     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12454     MOVE +0                 TO DC-ELAPSED-MONTHS
 12455                                DC-ELAPSED-DAYS.
 12456     MOVE '1'                TO DC-OPTION-CODE.
 12457     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 237
* EL156.cbl
 12458     IF NO-CONVERSION-ERROR
 12459         NEXT SENTENCE
 12460     ELSE
 12461         GO TO 1445-CONTINUE.
 12462
 12463     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12464        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12465         GO TO 1445-CONTINUE.
 12466
 12467     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12468                                 *  CF-ST-STAT-INTEREST.
 12469
 12470     MOVE SPACES              TO WS-NCLNOTE1.
 12471     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12472     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12473     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12474                                 PI-PMTNOTE1
 12475                                 NOTE1I.
 12476     MOVE AL-UANON            TO NOTE1A.
 12477
 12478     IF WS-CALC-INT > ZEROS
 12479         MOVE SPACES          TO WS-NCLNOTE2
 12480         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12481         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12482         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12483                                 PI-PMTNOTE2
 12484                                 NOTE2I
 12485         MOVE AL-UANON        TO NOTE2A.
 12486
 12487     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12488
 12489 1445-CONTINUE.
 12490
 12491     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12492        GO TO 1460-TEST-TYPE.
 12493
 12494     IF CM-O-B-COVERAGE
 12495        GO TO 1460-TEST-TYPE.
 12496
 12497     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12498         GO TO 1450-CHECK-MAX.
 12499
 12500     if (pi-company-id = 'DCC')
 12501        and (pdef-found)
 12502        if pi-epyamt > pd-max-amt (p1)
 12503           move er-1657          to emi-error
 12504           perform 1490-payment-error
 12505                                 thru 1490-exit
 12506           go to 1460-test-type
 12507        end-if
 12508     else
 12509        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12510           > PI-EPYAMT)
 12511                         OR
 12512           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12513           < PI-EPYAMT)
 12514           MOVE ER-0594          TO EMI-ERROR
 12515           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 238
* EL156.cbl
 12516                                 THRU 1490-EXIT
 12517           GO TO 1460-TEST-TYPE
 12518        end-if
 12519     end-if
 12520     .
 12521 1450-CHECK-MAX.
 12522
 12523     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12524        PI-LF-COVERAGE-TYPE = 'P'
 12525         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12526                                   CM-LF-ITD-DEATH-AMT
 12527     ELSE
 12528         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12529                                   CL-TOTAL-PAID-AMT.
 12530
 12531     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12532          MOVE ER-0543           TO EMI-ERROR
 12533          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12534
 12535 1460-TEST-TYPE.
 12536
 12537     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12538        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12539           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12540                                   CM-LF-ALT-BENEFIT-AMT -
 12541                                   CL-TOTAL-PAID-AMT
 12542           IF PI-EPYAMT > WS-LF-BEN-AMT
 12543               MOVE ER-0543      TO EMI-ERROR
 12544               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12545           END-IF
 12546        END-IF
 12547     END-IF
 12548
 12549     IF PI-PMT-APPR-SW = 'G'
 12550       NEXT SENTENCE
 12551     ELSE
 12552       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12553         IF PI-EPYAMT = ZERO
 12554             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12555                 MOVE ER-0494    TO  EMI-ERROR
 12556                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12557                 GO TO 1500-EDIT-EXPENSES
 12558             ELSE
 12559                 NEXT SENTENCE
 12560         ELSE
 12561             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12562                 MOVE ER-0494    TO  EMI-ERROR
 12563                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12564                 GO TO 1500-EDIT-EXPENSES.
 12565
 12566     IF PI-PMTTYPE NOT = '2' OR
 12567        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12568         GO TO 1500-EDIT-EXPENSES.
 12569
 12570     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12571     MOVE ER-0526                TO EMI-ERROR.
 12572     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12573
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 239
* EL156.cbl
 12574     IF EMI-ERROR-NUMBER (1) = '0526'
 12575        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12576
 12577     IF EMI-ERROR-NUMBER (2) = '0526'
 12578        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12579
 12580     GO TO 1500-EDIT-EXPENSES.
 12581
 12582 1490-PAYMENT-ERROR.
 12583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12584
 12585     IF EMI-MESSAGE-FORMATTED
 12586         MOVE -1                 TO EPYAMTL
 12587         MOVE AL-UNBON           TO EPYAMTA.
 12588
 12589 1490-EXIT.
 12590      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 240
* EL156.cbl
 12592 1500-EDIT-EXPENSES.
 12593     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12594         GO TO 1500-SKIP-ERROR-0556.
 12595
 12596 1500-CONTINUE-ON.
 12597
 12598     IF CM-O-B-COVERAGE
 12599        MOVE ER-0556             TO EMI-ERROR
 12600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12601
 12602 1500-SKIP-ERROR-0556.
 12603     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12604        IF PI-EEXPENS NOT = ZEROS
 12605           MOVE ER-0524          TO EMI-ERROR
 12606           GO TO 1590-EXPENSE-ERROR
 12607        ELSE
 12608           GO TO 1600-EDIT-RESERVES.
 12609
 12610     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12611     MOVE '6'                    TO CNTL-REC-TYPE.
 12612
 12613     IF CONTROL-IS-ACTUAL-CARRIER
 12614         MOVE PI-CARRIER         TO WS-CARR
 12615     ELSE
 12616         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12617
 12618     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12619     MOVE +0                     TO CNTL-SEQ-NO.
 12620     MOVE 'CARR'                 TO FILE-SWITCH.
 12621
 12622     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12623
 12624     IF EXPENSE-CALC-MANUAL
 12625        GO TO 1600-EDIT-RESERVES.
 12626
 12627     IF DOLLARS-PER-PMT
 12628        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12629        GO TO 1600-EDIT-RESERVES.
 12630
 12631     IF DOLLARS-PER-MONTH AND
 12632        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12633       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12634       GO TO 1600-EDIT-RESERVES.
 12635
 12636     IF PERCENT-OF-PAYMENT
 12637        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12638
 12639     GO TO 1600-EDIT-RESERVES.
 12640
 12641 1590-EXPENSE-ERROR.
 12642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12643
 12644     IF EMI-MESSAGE-FORMATTED
 12645        MOVE -1                  TO EEXPENSL
 12646        MOVE AL-UNBON            TO EEXPENSA.
 12647
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 241
* EL156.cbl
 12649 1600-EDIT-RESERVES.
 12650     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12651        IF PI-ERESV = ZEROS
 12652           GO TO 1700-EDIT-EXPENSE-TYPE
 12653        ELSE
 12654           MOVE ER-0525          TO EMI-ERROR
 12655           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12656           GO TO 1700-EDIT-EXPENSE-TYPE.
 12657
 12658     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12659     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12660     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12661
 12662     IF NOT AT-MANUAL-RESERVES-USED
 12663        IF PI-ERESV NOT = ZEROS
 12664           MOVE ER-0518          TO EMI-ERROR
 12665           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12666
 12667     IF AT-MANUAL-RESERVES-USED
 12668        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12669        GO TO 1700-EDIT-EXPENSE-TYPE.
 12670
 12671     IF AT-FUTURE-RESERVES-USED
 12672        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12673
 12674     IF AT-FUTURE-RESERVES-USED
 12675        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12676
 12677     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12678        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12679
 12680     IF AT-IBNR-RESERVES-USED
 12681        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12682
 12683     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12684     GO TO 1700-EDIT-EXPENSE-TYPE.
 12685
 12686 1690-RESERVE-ERROR.
 12687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12688
 12689     IF EMI-MESSAGE-FORMATTED
 12690        MOVE AL-UNBON            TO ERESVA
 12691        MOVE -1                  TO ERESVL.
 12692
 12693 1690-EXIT.
 12694      EXIT.
 12695
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 242
* EL156.cbl
 12697 1700-EDIT-EXPENSE-TYPE.
 12698     IF PI-PMTTYPE NOT = '5' AND '6'
 12699        GO TO 2000-EDIT-DONE.
 12700
 12701     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12702                   '6' OR '7' OR '8' OR '9'
 12703        GO TO 2000-EDIT-DONE.
 12704
 12705 1705-EXPENSE-ERROR.
 12706     MOVE ER-0573                TO EMI-ERROR.
 12707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12708
 12709     IF EMI-MESSAGE-FORMATTED
 12710        MOVE AL-UABON            TO ETYPEA
 12711        MOVE -1                  TO ETYPEL.
 12712
 12713     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 243
* EL156.cbl
 12715 1950-NOT-FOUND.
 12716     IF FILE-SWITCH = 'MSTR'
 12717        MOVE ER-0204             TO EMI-ERROR.
 12718
 12719     IF FILE-SWITCH = 'CARR'
 12720        MOVE ER-0252             TO EMI-ERROR.
 12721
 12722     IF FILE-SWITCH = 'COMP'
 12723        MOVE ER-0254             TO EMI-ERROR.
 12724
 12725     IF FILE-SWITCH = 'STAT'
 12726        MOVE ER-0149             TO EMI-ERROR.
 12727
 12728     IF FILE-SWITCH = 'PROC'
 12729        MOVE ER-0019             TO EMI-ERROR.
 12730
 12731     IF FILE-SWITCH = 'ACCT'
 12732        MOVE ER-0198             TO EMI-ERROR.
 12733
 12734     IF FILE-SWITCH = 'BENE'
 12735        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12736           MOVE ER-0282          TO EMI-ERROR
 12737        ELSE
 12738           MOVE ER-0283          TO EMI-ERROR.
 12739
 12740     MOVE -1                     TO PMTTYPEL.
 12741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12742
 12743     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12744                                     WS-FORCE-CTR.
 12745
 12746     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12747                                     WS-FATAL-CTR.
 12748
 12749     GO TO 8200-SEND-DATAONLY.
 12750
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 244
* EL156.cbl
 12752 2000-EDIT-DONE.
 12753*********************
 12754     perform 2210-dcc-max-benes thru 2210-exit
 12755     if pi-company-id not = 'DCC'
 12756        IF (WS-SPECIAL-CALC-CD = 'C')
 12757           and (cl-critical-period > 0)
 12758           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12759              IF PI-EPYAMT > ZEROS
 12760                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12761                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12762              ELSE
 12763                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12764                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12765              END-IF
 12766              if ws-benefits-paid > cl-critical-period
 12767                 MOVE ER-0657          TO EMI-ERROR
 12768                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12769              END-IF
 12770           END-IF
 12771        END-IF
 12772     end-if
 12773     IF PI-HOLDTIL NOT = ZEROS
 12774        MOVE PI-HOLDTIL          TO HOLDTILO
 12775        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12776
 12777     IF PI-EPYFROM NOT = ZEROS
 12778        MOVE PI-EPYFROM          TO EPYFROMO
 12779        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12780
 12781     IF PI-EPYTHRU NOT = ZEROS
 12782        MOVE PI-EPYTHRU            TO EPYTHRUO
 12783        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12784        IF PI-USES-PAID-TO
 12785           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12786           MOVE '4'                TO DC-OPTION-CODE
 12787           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12788           IF NO-CONVERSION-ERROR
 12789              MOVE +1              TO DC-ELAPSED-DAYS
 12790              MOVE +0              TO DC-ELAPSED-MONTHS
 12791              MOVE '6'             TO DC-OPTION-CODE
 12792              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12793              IF NO-CONVERSION-ERROR
 12794                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12795
 12796     MOVE PI-EDAYS               TO EDAYSO.
 12797
 12798     IF PI-AIGFROM NOT = ZEROS
 12799        MOVE PI-AIGFROM          TO AIGFROMO
 12800        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12801
 12802     MOVE PI-EPYAMT              TO EPYAMTO.
 12803     MOVE PI-ERESV               TO ERESVO.
 12804     MOVE PI-EEXPENS             TO EEXPENSO.
 12805
 12806     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12807     MOVE SPACES                 TO DC-OPTION-CODE.
 12808     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12809
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 245
* EL156.cbl
 12810     IF DATE-CONVERSION-ERROR
 12811        MOVE SPACES              TO CPYFROMI
 12812     ELSE
 12813        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12814        IF PI-EPYFROM = ZEROS
 12815           MOVE AL-UANON             TO EPYFROMA
 12816           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12817           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12818
 12819     IF PI-USES-PAID-TO
 12820        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12821        MOVE +1                            TO DC-ELAPSED-DAYS
 12822        MOVE +0                            TO DC-ELAPSED-MONTHS
 12823        MOVE '6'                           TO DC-OPTION-CODE
 12824        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12825        IF NO-CONVERSION-ERROR
 12826           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12827           IF PI-EPYTHRU = ZEROS
 12828              MOVE AL-UANON                TO EPYTHRUA
 12829              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12830              MOVE ' '                     TO DC-OPTION-CODE
 12831              MOVE +0                      TO DC-ELAPSED-DAYS
 12832                                              DC-ELAPSED-MONTHS
 12833              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12834              IF NO-CONVERSION-ERROR
 12835                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12836                  GO TO 2001-CONTINUE
 12837              ELSE
 12838                  GO TO 2001-CONTINUE
 12839           ELSE
 12840              GO TO 2001-CONTINUE.
 12841
 12842     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12843     MOVE SPACES                 TO DC-OPTION-CODE.
 12844     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12845
 12846     IF DATE-CONVERSION-ERROR
 12847        MOVE SPACES              TO CPYTHRUI
 12848     ELSE
 12849        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12850        IF PI-EPYTHRU = ZEROS
 12851           MOVE AL-UANON TO EPYTHRUA
 12852           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12853           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12854
 12855 2001-CONTINUE.
 12856
 12857     MOVE PI-CDAYS               TO CDAYSO.
 12858
 12859     IF PI-EDAYS = ZEROS
 12860        MOVE AL-UNNON TO EDAYSA
 12861        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12862
 12863     MOVE PI-CPYAMT              TO CPYAMTO.
 12864
 12865     IF PI-EPYAMT = ZEROS
 12866        MOVE AL-UNNON            TO EPYAMTA
 12867        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 246
* EL156.cbl
 12868
 12869     MOVE PI-CRESV               TO CRESVO.
 12870     MOVE PI-CEXPENS             TO CEXPENSO.
 12871
 12872     IF PI-EEXPENS = ZEROS
 12873        MOVE AL-UNNON TO EEXPENSA
 12874        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12875
 12876     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12877        AND (CL-CLAIM-TYPE = 'L')
 12878        AND (PI-OFFLINE NOT EQUAL 'Y')
 12879        IF PI-PMTTYPE = '2' OR '4'
 12880           PERFORM 2200-CALC-INTEREST
 12881                                 THRU 2200-EXIT
 12882        END-IF
 12883     END-IF
 12884     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12885     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12886     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12887
 12888     IF EMI-FATAL-CTR = ZEROS
 12889        MOVE 'B'                 TO PI-PASS-SW.
 12890
 12891     IF NOT EMI-MESSAGE-FORMATTED
 12892         MOVE -1                 TO EPYFROML
 12893     ELSE
 12894         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12895            EMI-ERROR-NUMBER (2) = SPACES
 12896             MOVE -1             TO EPYFROML.
 12897
 12898     GO TO 8200-SEND-DATAONLY.
 12899
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 247
* EL156.cbl
 12901 2200-CALC-INTEREST.
 12902     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12903        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12904        MOVE '4'                 TO DC-OPTION-CODE
 12905        PERFORM 9700-LINK-DATE-CONVERT
 12906        IF DATE-CONVERSION-ERROR
 12907            MOVE LOW-VALUES      TO CP-PRF-DT
 12908        ELSE
 12909           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12910        END-IF
 12911     END-IF
 12912     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12913        IN CLAIM-INT-PASS-AREA
 12914     MOVE CL-CERT-STATE          TO CP-STATE
 12915        IN CLAIM-INT-PASS-AREA
 12916     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12917     MOVE 'LF'                   TO CP-COVERAGE
 12918     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12919     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12920     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12921     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12922     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12923     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12924
 12925* EXEC CICS LINK
 12926*       PROGRAM   ('ELCLMI')
 12927*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12928*       LENGTH    (CP-CLAIM-LENGTH)
 12929*    END-EXEC
 12930     MOVE 'ELCLMI' TO DFHEIV1
 12931*    MOVE '."C                   (   #00012337' TO DFHEIV0
 12932     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12934     MOVE X'2020233030303132333337' TO DFHEIV0(25:11)
 12935     CALL 'kxdfhei1' USING DFHEIV0,
 12936           DFHEIV1,
 12937           CLAIM-INT-PASS-AREA,
 12938           CP-CLAIM-LENGTH,
 12939           DFHEIV99,
 12940           DFHEIV99,
 12941           DFHEIV99,
 12942           DFHEIV99
 12943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12944     MOVE AL-PANOF               TO PINTHA
 12945                                    PINTA
 12946     IF NO-CI-ERROR
 12947        MOVE CP-CLM-INT-AMT      TO PINTO
 12948                                    PI-INT-AMT
 12949        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12950        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12951        MOVE AL-PANOF            TO PINTHA
 12952                                    PINTA
 12953     ELSE
 12954        IF CI-RETURN-CODE = '8'
 12955           MOVE ER-3818          TO EMI-ERROR
 12956           MOVE -1               TO ZINTL
 12957           PERFORM 9900-ERROR-FORMAT
 12958                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 248
* EL156.cbl
 12959           GO TO 2200-EXIT
 12960        ELSE
 12961           MOVE ZEROS            TO PINTO
 12962                                    PI-INT-AMT
 12963                                    PI-INT-DAYS
 12964                                    PI-INT-RATE-USED
 12965        END-IF
 12966     END-IF
 12967     IF PI-INT-AMT NOT = ZEROS
 12968        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12969           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12970           CONTINUE
 12971        ELSE
 12972           MOVE CL-SOC-SEC-NO (1:3)
 12973                                 TO WS-SSN (1:3)
 12974           MOVE CL-SOC-SEC-NO (5:2)
 12975                                 TO WS-SSN (4:2)
 12976           MOVE CL-SOC-SEC-NO (8:4)
 12977                                 TO WS-SSN (6:4)
 12978           IF (WS-SSN NUMERIC)
 12979              AND (WS-SSN NOT = ZEROS)
 12980              CONTINUE
 12981           ELSE
 12982              MOVE ER-2044       TO EMI-ERROR
 12983              PERFORM 9900-ERROR-FORMAT
 12984                                 THRU 9900-EXIT
 12985           END-IF
 12986        END-IF
 12987        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12988        MOVE +51                 TO TRLR-SEQ-NO
 12989
 12990* EXEC CICS READ
 12991*          DATASET  ('ELTRLR')
 12992*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12993*          RIDFLD   (ELTRLR-KEY)
 12994*          RESP     (WS-RESPONSE)
 12995*       END-EXEC
 12996     MOVE 'ELTRLR' TO DFHEIV1
 12997*    MOVE '&"S        E          (  N#00012387' TO DFHEIV0
 12998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13000     MOVE X'204E233030303132333837' TO DFHEIV0(25:11)
 13001     CALL 'kxdfhei1' USING DFHEIV0,
 13002           DFHEIV1,
 13003           DFHEIV20,
 13004           DFHEIV99,
 13005           ELTRLR-KEY,
 13006           DFHEIV99,
 13007           DFHEIV99,
 13008           DFHEIV99
 13009     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13010         DFHEIV20
 13011     MOVE EIBRESP  TO WS-RESPONSE
 13012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13013        IF (NOT WS-RESP-NORMAL)
 13014                    OR
 13015           ((WS-RESP-NORMAL)
 13016           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 249
* EL156.cbl
 13017           OR (AT-CITY-STATE = SPACES)))
 13018           MOVE ER-0874          TO EMI-ERROR
 13019           PERFORM 9900-ERROR-FORMAT
 13020                                 THRU 9900-EXIT
 13021        END-IF
 13022     END-IF
 13023     .
 13024 2200-EXIT.
 13025     EXIT.
 13026 2210-dcc-max-benes.
 13027
 13028     move pi-ah-term             to ws-max-bens
 13029     if cl-critical-period not = zeros and spaces
 13030        move cl-critical-period  to ws-max-bens
 13031     end-if
 13032     move cm-ah-benefit-amt      to ws-monthly-benefit
 13033     if pdef-found
 13034        and (pd-max-amt (p1) not = zeros)
 13035        if pd-ben-pct (p1) not numeric
 13036           move zeros            to pd-ben-pct (p1)
 13037        end-if
 13038        if pd-ben-pct (p1) = zeros
 13039           move +1               to ws-work-ben-pct
 13040        else
 13041           move pd-ben-pct (p1)  to ws-work-ben-pct
 13042        end-if
 13043*       compute ws-monthly-benefit =
 13044*          ws-monthly-benefit * ws-work-ben-pct
 13045*       if ws-monthly-benefit > pd-max-amt (p1)
 13046*          move pd-max-amt (p1) to ws-monthly-benefit
 13047*       end-if
 13048     end-if
 13049
 13050     move cl-cert-key-data       to elcrtt-key (2:21)
 13051     move cl-company-cd          to ctrlr-comp-cd
 13052     move cl-cert-no             to ctrlr-cert-no
 13053     move 'B'                    to ctrlr-rec-type
 13054
 13055
 13056* EXEC CICS READ
 13057*       DATASET  ('ELCRTT')
 13058*       set      (address of CERTIFICATE-TRAILERS)
 13059*       RIDFLD   (ELCRTT-KEY)
 13060*       RESP     (WS-RESPONSE)
 13061*    END-EXEC
 13062     MOVE 'ELCRTT' TO DFHEIV1
 13063*    MOVE '&"S        E          (  N#00012435' TO DFHEIV0
 13064     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13065     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13066     MOVE X'204E233030303132343335' TO DFHEIV0(25:11)
 13067     CALL 'kxdfhei1' USING DFHEIV0,
 13068           DFHEIV1,
 13069           DFHEIV20,
 13070           DFHEIV99,
 13071           ELCRTT-KEY,
 13072           DFHEIV99,
 13073           DFHEIV99,
 13074           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 250
* EL156.cbl
 13075     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13076         DFHEIV20
 13077     MOVE EIBRESP  TO WS-RESPONSE
 13078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13079     IF not WS-RESP-NORMAL
 13080        go to 2210-exit
 13081     end-if
 13082
 13083*    if instypei = 'P'
 13084*       move +1 to s1
 13085*    else
 13086*       MOVE +2 to s1
 13087*    end-if
 13088
 13089*    move +1 to s1
 13090*    evaluate cl-claim-type
 13091*       when 'A'
 13092*          move +1 to s2
 13093*       when 'I'
 13094*          move +2 to s2
 13095*       when 'G'
 13096*          move +3 to s2
 13097*       when 'L'
 13098*          move +4 to s2
 13099*       when 'P'
 13100*          move +5 to s2
 13101*    end-evaluate
 13102
 13103     move zeros                  to ws-prev-days-paid
 13104                                    ws-benefits-paid
 13105                                    ws-prev-amt-paid
 13106     perform varying s1 from +1 by +1 until
 13107        (s1 > +24)
 13108        or (cs-claim-type (s1) = spaces)
 13109        if pi-company-id not = 'DCC'
 13110           if cs-claim-type (s1) = cl-claim-type
 13111              compute ws-prev-days-paid =
 13112                 ws-prev-days-paid + cs-days-paid (s1)
 13113              compute ws-prev-amt-paid =
 13114                 ws-prev-amt-paid + cs-total-paid (s1)
 13115           end-if
 13116        else
 13117           if (cs-claim-type (s1) = cl-claim-type)
 13118              and (cs-benefit-period (s1) = cl-benefit-period)
 13119              and (cs-insured-type (s1) = cl-insured-type)
 13120              compute ws-prev-days-paid =
 13121                 ws-prev-days-paid + cs-days-paid (s1)
 13122              compute ws-prev-amt-paid =
 13123                 ws-prev-amt-paid + cs-total-paid (s1)
 13124           end-if
 13125        end-if
 13126     end-perform
 13127     if pi-epyamt > zeros
 13128        compute ws-benefits-paid =
 13129           (ws-prev-amt-paid + pi-epyamt)
 13130           / ws-monthly-benefit
 13131     else
 13132        compute ws-benefits-paid =
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 251
* EL156.cbl
 13133           (ws-prev-amt-paid + pi-cpyamt)
 13134           / ws-monthly-benefit
 13135     end-if
 13136     if pi-company-id = 'DCC'
 13137     if cl-claim-type not = 'L' and 'P'
 13138        if ws-benefits-paid > ws-max-bens
 13139           move er-1658          to emi-error
 13140           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13141        end-if
 13142     end-if
 13143     end-if
 13144*     if s1 < +25
 13145*        if pi-epyamt > zeros
 13146*           compute ws-benefits-paid =
 13147*              (cs-total-paid (s1) + PI-EPYAMT)
 13148*              / ws-monthly-benefit
 13149*        else
 13150*           compute ws-benefits-paid =
 13151*              (cs-total-paid (s1) + PI-CPYAMT)
 13152*              / ws-monthly-benefit
 13153*        end-if
 13154
 13155*       if ws-benefits-paid > pd-crit-period (p1)
 13156*        if ws-benefits-paid > ws-max-bens
 13157*           move er-1658          to emi-error
 13158*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13159*        end-if
 13160*     end-if
 13161     .
 13162 2210-exit.
 13163     exit.
 13164
 13165 2220-update-elcrtt.
 13166
 13167
 13168* EXEC CICS GETMAIN
 13169*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13170*       LENGTH   (ELCRTT-LENGTH)
 13171*       INITIMG  (GETMAIN-SPACE)
 13172*    END-EXEC
 13173*    MOVE ',"IL                  $   #00012529' TO DFHEIV0
 13174     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13176     MOVE X'2020233030303132353239' TO DFHEIV0(25:11)
 13177     CALL 'kxdfhei1' USING DFHEIV0,
 13178           DFHEIV20,
 13179           ELCRTT-LENGTH,
 13180           GETMAIN-SPACE
 13181     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13182         DFHEIV20
 13183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13184
 13185     move cl-cert-key-data       to elcrtt-key (2:21)
 13186     move cl-company-cd          to ctrlr-comp-cd
 13187     move cl-cert-no             to ctrlr-cert-no
 13188     move 'B'                    to ctrlr-rec-type
 13189
 13190
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 252
* EL156.cbl
 13191* EXEC CICS READ
 13192*       UPDATE
 13193*       DATASET  (ELCRTT-DSID)
 13194*       into     (CERTIFICATE-TRAILERS)
 13195*       RIDFLD   (ELCRTT-KEY)
 13196*       RESP     (WS-RESPONSE)
 13197*    END-EXEC
 13198     MOVE LENGTH OF
 13199      CERTIFICATE-TRAILERS
 13200       TO DFHEIV11
 13201*    MOVE '&"IL       EU         (  N#00012540' TO DFHEIV0
 13202     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13203     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13204     MOVE X'204E233030303132353430' TO DFHEIV0(25:11)
 13205     CALL 'kxdfhei1' USING DFHEIV0,
 13206           ELCRTT-DSID,
 13207           CERTIFICATE-TRAILERS,
 13208           DFHEIV11,
 13209           ELCRTT-KEY,
 13210           DFHEIV99,
 13211           DFHEIV99,
 13212           DFHEIV99
 13213     MOVE EIBRESP  TO WS-RESPONSE
 13214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13215
 13216     IF WS-RESP-NORMAL
 13217        perform 2225-upd-crt-trlr thru 2225-exit
 13218
 13219* EXEC CICS REWRITE
 13220*          DATASET  (ELCRTT-DSID)
 13221*          from     (CERTIFICATE-TRAILERS)
 13222*          RESP     (WS-RESPONSE)
 13223*       END-EXEC
 13224     MOVE LENGTH OF
 13225      CERTIFICATE-TRAILERS
 13226       TO DFHEIV11
 13227*    MOVE '&& L                  %  N#00012550' TO DFHEIV0
 13228     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13229     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13230     MOVE X'204E233030303132353530' TO DFHEIV0(25:11)
 13231     CALL 'kxdfhei1' USING DFHEIV0,
 13232           ELCRTT-DSID,
 13233           CERTIFICATE-TRAILERS,
 13234           DFHEIV11,
 13235           DFHEIV99
 13236     MOVE EIBRESP  TO WS-RESPONSE
 13237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13238     else
 13239        if ws-resp-notfnd
 13240           move 'CS'             to certificate-trailers
 13241           move cl-company-cd    to cs-company-cd
 13242           move cl-cert-key-data to cs-control-primary (2:21)
 13243           move cl-cert-no       to cs-cert-no
 13244           move 'B'              to cs-trailer-type
 13245           perform varying s1 from +1 by +1 until s1 > +24
 13246              move zeros         to cs-benefit-period (s1)
 13247                                    cs-days-paid (s1)
 13248                                    cs-total-paid (s1)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 253
* EL156.cbl
 13249                                    cs-remaining-bens (s1)
 13250           end-perform
 13251           perform 2225-upd-crt-trlr
 13252                                 thru 2225-exit
 13253
 13254* EXEC CICS WRITE
 13255*             DATASET  (ELCRTT-DSID)
 13256*             from     (CERTIFICATE-TRAILERS)
 13257*             RIDFLD   (cs-control-primary)
 13258*             RESP     (WS-RESPONSE)
 13259*          END-EXEC
 13260     MOVE LENGTH OF
 13261      CERTIFICATE-TRAILERS
 13262       TO DFHEIV11
 13263*    MOVE '&$ L                  ''  N#00012570' TO DFHEIV0
 13264     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13265     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13266     MOVE X'204E233030303132353730' TO DFHEIV0(25:11)
 13267     CALL 'kxdfhei1' USING DFHEIV0,
 13268           ELCRTT-DSID,
 13269           CERTIFICATE-TRAILERS,
 13270           DFHEIV11,
 13271           cs-control-primary,
 13272           DFHEIV99,
 13273           DFHEIV99
 13274     MOVE EIBRESP  TO WS-RESPONSE
 13275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13276        end-if
 13277     END-IF
 13278
 13279     .
 13280 2220-exit.
 13281     exit.
 13282
 13283 2225-upd-crt-trlr.
 13284
 13285*    if instypei = 'P'
 13286*       move +1 to s1
 13287*    else
 13288*       MOVE +2 to s1
 13289*    end-if
 13290
 13291*    move +1 to s1
 13292*    evaluate cl-claim-type
 13293*       when 'A'
 13294*          move +1 to s2
 13295*       when 'I'
 13296*          move +2 to s2
 13297*       when 'G'
 13298*          move +3 to s2
 13299*       when 'L'
 13300*          move +4 to s2
 13301*       when 'P'
 13302*          move +5 to s2
 13303*    end-evaluate
 13304     perform varying s1 from +1 by +1 until
 13305        (s1 > +24)
 13306        or (cl-claim-no = cs-claim-no (s1))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 254
* EL156.cbl
 13307     end-perform
 13308     if s1 < +25
 13309        compute cs-total-paid (s1) =
 13310           cs-total-paid (s1) + at-amount-paid
 13311        compute cs-days-paid (s1) =
 13312           cs-days-paid (s1) +  at-days-in-period
 13313*       compute cs-remaining-bens (s1) =
 13314*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13315        perform 2230-accum-bens-paid thru 2230-exit
 13316     end-if
 13317
 13318     .
 13319 2225-exit.
 13320     exit.
 13321 2230-accum-bens-paid.
 13322     if cl-claim-type not = 'L' and 'P'
 13323        move pi-ah-term          to ws-max-bens
 13324        if cl-critical-period not = zeros and spaces
 13325           move cl-critical-period
 13326                                 to ws-max-bens
 13327        end-if
 13328     else
 13329        move 01                  to ws-max-bens
 13330     end-if
 13331     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13332     perform varying s2 from +1 by +1 until
 13333        (s2 > +24)
 13334        or (cs-claim-no (s2) = spaces)
 13335        if pi-company-id not = 'DCC'
 13336           if cs-claim-type (s2) = cl-claim-type
 13337              compute ws-tot-days-paid =
 13338                 ws-tot-days-paid + cs-days-paid (s2)
 13339              compute ws-tot-amt-paid =
 13340                 ws-tot-amt-paid + cs-total-paid (s2)
 13341           end-if
 13342        else
 13343           if (cs-benefit-period (s2) = cl-benefit-period)
 13344              and (cs-claim-type (s2) = cl-claim-type)
 13345              and (cs-insured-type (s2) = cl-insured-type)
 13346              compute ws-tot-days-paid =
 13347                 ws-tot-days-paid + cs-days-paid (s2)
 13348              compute ws-tot-amt-paid =
 13349                 ws-tot-amt-paid + cs-total-paid (s2)
 13350           end-if
 13351        end-if
 13352     end-perform
 13353     if cl-claim-type = 'L' and 'P'
 13354        if ws-tot-amt-paid > zeros
 13355           move zeros            to cs-remaining-bens (s1)
 13356        else
 13357           move 01               to cs-remaining-bens (s1)
 13358        end-if
 13359     else
 13360        compute ws-pd-bens rounded =
 13361           ws-tot-amt-paid / pi-ah-benefit-amt
 13362        compute cs-remaining-bens (s1) =
 13363           ws-max-bens - ws-pd-bens
 13364        if cs-remaining-bens (s1) < zeros
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 255
* EL156.cbl
 13365           move zeros            to cs-remaining-bens (s1)
 13366        end-if
 13367     end-if
 13368     .
 13369 2230-exit.
 13370     exit.
 13371 3000-MOVE-INPUT-TO-SAVE-AREA.
 13372     IF PMTTYPEL > 0
 13373         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13374
 13375     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13376
 13377     IF WS-PMTTYPE = '9'
 13378         MOVE 'P'                TO PI-PROVISIONAL-IND
 13379         MOVE '1'                TO WS-PMTTYPE.
 13380
 13381     IF PAYEEL > 0
 13382         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13383         MOVE PAYEEI             TO WS-PAYEE.
 13384
 13385     IF NOTE1L > +0
 13386         MOVE NOTE1I             TO WS-PMTNOTE1
 13387                                    WS-FLI-PMTNOTE
 13388                                    WS-HAN-PMTNOTE.
 13389
 13390     IF NOTE2L > +0
 13391         MOVE NOTE2I             TO WS-PMTNOTE2.
 13392
 13393     IF OFFLINEL > 0
 13394         MOVE OFFLINEI           TO WS-OFFLINE.
 13395
 13396     IF PROOFDTL > 0
 13397         MOVE PROOFDTI            TO DATE-WORK
 13398         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13399         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13400         MOVE '4'                 TO DC-OPTION-CODE
 13401         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13402         IF NO-CONVERSION-ERROR
 13403            MOVE NUM-WORK         TO PROOFDTO
 13404            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13405            MOVE NUM-WORK         TO WS-PROOF-DATE
 13406         ELSE
 13407            MOVE ZEROS            TO WS-PROOF-DATE
 13408         END-IF
 13409     END-IF.
 13410
 13411     IF EOBYNL > +0
 13412         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13413         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13414     END-IF
 13415
 13416     IF CLMFMYNL > +0
 13417         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13418         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13419     END-IF
 13420
 13421     IF SURVYYNL > +0
 13422         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 256
* EL156.cbl
 13423         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13424     END-IF
 13425
 13426     IF SPRELYNL > +0
 13427         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13428         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13429     END-IF
 13430*    IF GROUPEDL > +0
 13431*        MOVE GROUPEDI           TO WS-GROUPED.
 13432*
 13433*    IF CASHL > +0
 13434*       MOVE CASHI               TO WS-CASH.
 13435     IF LOANNOL > +0
 13436         MOVE LOANNOI            TO WS-LOAN-NO.
 13437
 13438     IF CHECKNOL > 0
 13439         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13440
 13441     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13442         IF WS-AIG-CREDIT-ENTERED
 13443             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13444             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13445             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13446             MOVE AL-UANON         TO CHECKNOA.
 13447
 13448     IF HOLDTILL > 0
 13449         MOVE HOLDTILI           TO DATE-WORK
 13450         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13451         MOVE NUM-WORK           TO WS-HOLDTIL.
 13452
 13453     IF ZINTL > +0
 13454
 13455* EXEC CICS BIF DEEDIT
 13456*           FIELD   (ZINTI)
 13457*           LENGTH  (07)
 13458*       END-EXEC
 13459     MOVE 07
 13460       TO DFHEIV11
 13461*    MOVE '@"L                   #   #00012754' TO DFHEIV0
 13462     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13463     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13464     MOVE X'2020233030303132373534' TO DFHEIV0(25:11)
 13465     CALL 'kxdfhei1' USING DFHEIV0,
 13466           ZINTI,
 13467           DFHEIV11
 13468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13469        IF ZINTI NOT NUMERIC
 13470           MOVE ER-0419          TO EMI-ERROR
 13471           PERFORM 9900-ERROR-FORMAT
 13472           MOVE AL-UABON         TO ZINTA
 13473           MOVE -1               TO ZINTL
 13474        ELSE
 13475           MOVE ZINTI            TO CP-INT-RATE
 13476                                    WS-INT-RATE
 13477           MOVE CP-INT-RATE      TO ZINTO
 13478           MOVE AL-UNNON         TO ZINTA
 13479        END-IF
 13480     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 257
* EL156.cbl
 13481        MOVE ZEROS               TO CP-INT-RATE
 13482     END-IF
 13483     IF EPYFROML > 0
 13484         MOVE EPYFROMI           TO DATE-WORK
 13485         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13486         MOVE NUM-WORK           TO WS-EPYFROM.
 13487
 13488     IF AIGFROML > 0
 13489         MOVE AIGFROMI           TO DATE-WORK
 13490         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13491         MOVE NUM-WORK           TO WS-AIGFROM
 13492     ELSE
 13493         IF (AIGFROMI = LOW-VALUES) AND
 13494            (PI-AIGFROM NOT = ZEROS)
 13495              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13496
 13497     IF EPYTHRUL > +0
 13498        MOVE EPYTHRUI           TO DATE-WORK
 13499        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13500        MOVE NUM-WORK           TO WS-EPYTHRU
 13501        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13502        MOVE '4'                TO DC-OPTION-CODE
 13503        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13504        IF NO-CONVERSION-ERROR
 13505           IF PI-USES-PAID-TO
 13506              MOVE '6'                TO DC-OPTION-CODE
 13507              MOVE -1                 TO DC-ELAPSED-DAYS
 13508              MOVE +0                 TO DC-ELAPSED-MONTHS
 13509              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13510              IF NO-CONVERSION-ERROR
 13511                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13512                 MOVE ' '             TO DC-OPTION-CODE
 13513                 MOVE +0              TO DC-ELAPSED-DAYS
 13514                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13515              IF NO-CONVERSION-ERROR
 13516                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13517
 13518*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13519*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13520     IF EDAYSL > 0
 13521
 13522* EXEC CICS BIF DEEDIT
 13523*            FIELD(EDAYSI)
 13524*            LENGTH(6)
 13525*        END-EXEC
 13526     MOVE 6
 13527       TO DFHEIV11
 13528*    MOVE '@"L                   #   #00012810' TO DFHEIV0
 13529     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13530     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13531     MOVE X'2020233030303132383130' TO DFHEIV0(25:11)
 13532     CALL 'kxdfhei1' USING DFHEIV0,
 13533           EDAYSI,
 13534           DFHEIV11
 13535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13536         MOVE EDAYSI             TO WS-DY-WORK
 13537         IF WS-DY-SIGN = SPACES
 13538            MOVE WS-DY-NUM       TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 258
* EL156.cbl
 13539            ADD 0                TO WS-EDAYS
 13540         ELSE
 13541            MOVE EDAYSI          TO WS-EDAYS
 13542            ADD 0                TO WS-EDAYS.
 13543
 13544*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13545*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13546     IF EPYAMTL > 0
 13547
 13548* EXEC CICS BIF DEEDIT
 13549*            FIELD(EPYAMTI)
 13550*            LENGTH(10)
 13551*        END-EXEC
 13552     MOVE 10
 13553       TO DFHEIV11
 13554*    MOVE '@"L                   #   #00012825' TO DFHEIV0
 13555     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13556     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13557     MOVE X'2020233030303132383235' TO DFHEIV0(25:11)
 13558     CALL 'kxdfhei1' USING DFHEIV0,
 13559           EPYAMTI,
 13560           DFHEIV11
 13561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13562         MOVE EPYAMTI            TO WS-PY-WORK
 13563         IF WS-PY-SIGN = SPACES
 13564            MOVE WS-PY-NUM       TO WS-EPYAMT
 13565            ADD 0                TO WS-EPYAMT
 13566         ELSE
 13567            MOVE EPYAMTI         TO WS-EPYAMT
 13568            ADD 0                TO WS-EPYAMT.
 13569
 13570     IF ERESVL > 0
 13571
 13572* EXEC CICS BIF DEEDIT
 13573*            FIELD(ERESVI)
 13574*            LENGTH(9)
 13575*        END-EXEC
 13576     MOVE 9
 13577       TO DFHEIV11
 13578*    MOVE '@"L                   #   #00012838' TO DFHEIV0
 13579     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13580     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13581     MOVE X'2020233030303132383338' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0,
 13583           ERESVI,
 13584           DFHEIV11
 13585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13586         MOVE ERESVI TO WS-ERESV.
 13587
 13588     IF EEXPENSL > 0
 13589
 13590* EXEC CICS BIF DEEDIT
 13591*            FIELD(EEXPENSI)
 13592*            LENGTH(8)
 13593*        END-EXEC
 13594     MOVE 8
 13595       TO DFHEIV11
 13596*    MOVE '@"L                   #   #00012845' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 259
* EL156.cbl
 13597     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13598     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13599     MOVE X'2020233030303132383435' TO DFHEIV0(25:11)
 13600     CALL 'kxdfhei1' USING DFHEIV0,
 13601           EEXPENSI,
 13602           DFHEIV11
 13603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13604         MOVE EEXPENSI           TO WS-EEXPENS.
 13605
 13606     IF ETYPEL > ZEROS
 13607         MOVE ETYPEI             TO WS-ETYPE.
 13608
 13609     IF PI-COMPANY-ID = 'BOA'
 13610        IF PINTL > ZEROS
 13611
 13612* EXEC CICS BIF DEEDIT
 13613*            FIELD (PINTI)
 13614*            LENGTH(05)
 13615*          END-EXEC
 13616     MOVE 05
 13617       TO DFHEIV11
 13618*    MOVE '@"L                   #   #00012856' TO DFHEIV0
 13619     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13621     MOVE X'2020233030303132383536' TO DFHEIV0(25:11)
 13622     CALL 'kxdfhei1' USING DFHEIV0,
 13623           PINTI,
 13624           DFHEIV11
 13625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13626           IF PINTI NUMERIC
 13627               MOVE AL-UNNON     TO PINTA
 13628               MOVE PINTI        TO WS-INT-RATE
 13629               MOVE WS-INT-RATE  TO PINTO.
 13630
 13631 3000-EXIT.
 13632     EXIT.
 13633
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 260
* EL156.cbl
 13635 3050-REBUILD-ENTERED.
 13636
 13637     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13638
 13639     IF PI-PROV-PMT
 13640         MOVE '9'           TO PMTTYPEO
 13641     ELSE
 13642         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13643
 13644     MOVE PI-PAYEE          TO PAYEEO.
 13645     MOVE PI-PMTNOTE1       TO NOTE1O.
 13646     MOVE PI-PMTNOTE2       TO NOTE2O.
 13647     MOVE PI-OFFLINE        TO OFFLINEO.
 13648     IF PI-PROOF-DATE NOT = ZEROS
 13649         MOVE PI-PROOF-DATE TO PROOFDTO
 13650         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13651     END-IF.
 13652*    MOVE PI-GROUPED        TO GROUPEDO.
 13653
 13654*    MOVE PI-CASH           TO CASHO.
 13655
 13656     IF PI-INT-RATE > ZEROS
 13657         MOVE PI-INT-RATE   TO PINTO.
 13658
 13659     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13660        IF PI-INT-AMT > ZEROS
 13661           MOVE PI-INT-AMT       TO PINTO
 13662           MOVE AL-PANOF         TO PINTA
 13663                                    PINTHA
 13664        END-IF
 13665     END-IF
 13666     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13667     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13668     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13669     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13670     IF PI-HOLDTIL NOT = ZEROS
 13671        MOVE PI-HOLDTIL          TO HOLDTILO
 13672        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13673
 13674     IF PI-EPYFROM NOT = ZEROS
 13675        MOVE PI-EPYFROM          TO EPYFROMO
 13676        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13677
 13678     IF PI-AIGFROM NOT = ZEROS
 13679        MOVE PI-AIGFROM          TO AIGFROMO
 13680        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13681
 13682     IF PI-EPYTHRU NOT = ZEROS
 13683        MOVE PI-EPYTHRU          TO EPYTHRUO
 13684        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13685        IF PI-USES-PAID-TO
 13686           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13687           MOVE '4'                TO DC-OPTION-CODE
 13688           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13689           IF NO-CONVERSION-ERROR
 13690              MOVE +1 TO DC-ELAPSED-DAYS
 13691              MOVE +0 TO DC-ELAPSED-MONTHS
 13692              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 261
* EL156.cbl
 13693              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13694              IF NO-CONVERSION-ERROR
 13695                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13696
 13697     IF PI-EDAYS NOT = ZEROS
 13698        MOVE PI-EDAYS TO EDAYSO.
 13699
 13700     IF PI-EPYAMT NOT = ZEROS
 13701        MOVE PI-EPYAMT TO EPYAMTO.
 13702
 13703     IF PI-ERESV NOT = ZEROS
 13704        MOVE PI-ERESV TO ERESVO.
 13705
 13706     IF PI-EEXPENS NOT = ZEROS
 13707        MOVE PI-EEXPENS TO EEXPENSO.
 13708
 13709     MOVE PI-ETYPE TO ETYPEO.
 13710
 13711     IF PI-ECHECKNO NOT = SPACES
 13712        MOVE PI-ECHECKNO         TO CHECKNOO
 13713     ELSE
 13714        MOVE PI-CCHECKNO         TO CHECKNOO.
 13715
 13716     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13717     MOVE SPACES                 TO DC-OPTION-CODE.
 13718     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13719
 13720     IF DATE-CONVERSION-ERROR
 13721        MOVE SPACES              TO CPYFROMI
 13722     ELSE
 13723        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13724
 13725     IF PI-USES-PAID-TO
 13726        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13727        MOVE +1                  TO DC-ELAPSED-DAYS
 13728        MOVE +0                  TO DC-ELAPSED-MONTHS
 13729        MOVE '6'                 TO DC-OPTION-CODE
 13730        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13731        IF NO-CONVERSION-ERROR
 13732           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13733           GO TO 3051-CONTINUE.
 13734
 13735     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13736     MOVE SPACES                 TO DC-OPTION-CODE.
 13737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13738
 13739     IF DATE-CONVERSION-ERROR
 13740        MOVE SPACES              TO CPYTHRUI
 13741     ELSE
 13742        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13743
 13744 3051-CONTINUE.
 13745
 13746     IF PI-CDAYS NOT = ZEROS
 13747        MOVE PI-CDAYS TO CDAYSO.
 13748
 13749     IF PI-CPYAMT NOT = ZEROS
 13750        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 262
* EL156.cbl
 13751
 13752     IF PI-CRESV NOT = ZEROS
 13753        MOVE PI-CRESV TO CRESVO.
 13754
 13755     IF PI-CEXPENS NOT = ZEROS
 13756        MOVE PI-CEXPENS TO CEXPENSO.
 13757
 13758 3059-EXIT.
 13759     EXIT.
 13760
 13761 3100-DEEDIT-DATE.
 13762
 13763* EXEC CICS BIF DEEDIT
 13764*        FIELD(DATE-WORK)
 13765*        LENGTH(8)
 13766*    END-EXEC.
 13767     MOVE 8
 13768       TO DFHEIV11
 13769*    MOVE '@"L                   #   #00012996' TO DFHEIV0
 13770     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13771     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13772     MOVE X'2020233030303132393936' TO DFHEIV0(25:11)
 13773     CALL 'kxdfhei1' USING DFHEIV0,
 13774           DATE-WORK,
 13775           DFHEIV11
 13776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13777
 13778
 13779 3100-EXIT.
 13780     EXIT.
 13781
 13782 3200-CALC-AIG-DAYS.
 13783
 13784     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13785
 13786     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13787     MOVE ' '                    TO DC-OPTION-CODE.
 13788     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13789     IF NO-CONVERSION-ERROR
 13790         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13791     ELSE
 13792         GO TO 3290-ERROR.
 13793
 13794     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13795         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13796                                WS-BIN-FROM-DT
 13797     ELSE
 13798         IF CL-TOTAL-PAID-AMT > ZEROS
 13799             IF WS-SV-EPYFROM = LOW-VALUES
 13800                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13801                                        WS-BIN-FROM-DT
 13802             ELSE
 13803                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13804                                        WS-BIN-FROM-DT
 13805         ELSE
 13806             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13807                                        WS-BIN-FROM-DT.
 13808
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 263
* EL156.cbl
 13809 3210-CONTINUE.
 13810
 13811     MOVE ' '                    TO DC-OPTION-CODE.
 13812     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13813     IF DATE-CONVERSION-ERROR
 13814         GO TO 3290-ERROR.
 13815
 13816     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13817
 13818     IF PI-LOAN-DUE-DAY = 31
 13819         MOVE 30              TO WS-PMT-DUE-DA
 13820                                 WS-SAVE-DUE-DA
 13821     ELSE
 13822         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13823                                 WS-SAVE-DUE-DA.
 13824
 13825     IF (PI-LOAN-DUE-DAY > 28) AND
 13826        (WS-PMT-DUE-MO = 2)
 13827         MOVE 'Y'                TO WS-DUE-DAY-SW
 13828         MOVE 28                 TO WS-PMT-DUE-DA.
 13829
 13830     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13831     MOVE '4'                    TO DC-OPTION-CODE.
 13832     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13833     IF NO-CONVERSION-ERROR
 13834         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13835     ELSE
 13836         GO TO 3290-ERROR.
 13837
 13838*--------------------------------------------------------------*
 13839*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13840*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13841*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13842*                                                              *
 13843*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13844*             INCURRED DATE      - 04/15/91                    *
 13845*             PMT DUE DATE       - 04/03/91                    *
 13846*             PMT DUE DATE       - 05/03/91                    *
 13847*--------------------------------------------------------------*
 13848
 13849     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13850        (WS-SV-AIGFROM = LOW-VALUES)
 13851         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13852            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13853             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13854             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13855             IF NO-CONVERSION-ERROR
 13856                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13857                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13858             ELSE
 13859                 GO TO 3290-ERROR.
 13860
 13861     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13862        (WS-SV-AIGFROM = LOW-VALUES)
 13863         GO TO 3205-CONT-CALC-PMT.
 13864
 13865     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13866     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 264
* EL156.cbl
 13867     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13868     IF NO-CONVERSION-ERROR
 13869         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13870     ELSE
 13871         GO TO 3290-ERROR.
 13872
 13873     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13874        (WS-PMT-DUE-DA < WS-FROM-DA)
 13875          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13876          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13877          IF NO-CONVERSION-ERROR
 13878              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13879              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13880          ELSE
 13881              GO TO 3290-ERROR.
 13882
 13883 3205-CONT-CALC-PMT.
 13884
 13885*--------------------------------------------------------------*
 13886*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13887*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13888*--------------------------------------------------------------*
 13889
 13890     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13891        PI-PMTTYPE = '2'
 13892          NEXT SENTENCE
 13893     ELSE
 13894        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13895           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13896             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13897             MOVE ER-3527            TO EMI-ERROR
 13898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13899             MOVE -1                 TO EPYTHRUL
 13900             MOVE AL-UNBON           TO EPYTHRUA
 13901                                        EPYFROMA
 13902             GO TO 3299-EXIT.
 13903
 13904*--------------------------------------------------------------*
 13905*    CALCULATE RETRO ELIMINATION DATE                          *
 13906*--------------------------------------------------------------*
 13907
 13908     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13909         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13910     ELSE
 13911         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13912
 13913     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13914     MOVE +0             TO DC-ELAPSED-MONTHS.
 13915     MOVE '6'            TO DC-OPTION-CODE.
 13916     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13917     IF NO-CONVERSION-ERROR
 13918         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13919     ELSE
 13920         GO TO 3290-ERROR.
 13921
 13922 3210-CHECK-PMT-DATE.
 13923
 13924*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 265
* EL156.cbl
 13925*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13926*    THE ENTERED PAY FROM DATE                                 *
 13927*--------------------------------------------------------------*
 13928
 13929     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13930         NEXT SENTENCE
 13931     ELSE
 13932         GO TO 3220-COMPUTE-DAYS.
 13933
 13934     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13935     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13936     IF NO-CONVERSION-ERROR
 13937         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13938         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13939         GO TO 3210-CHECK-PMT-DATE
 13940     ELSE
 13941         GO TO 3290-ERROR.
 13942
 13943 3220-COMPUTE-DAYS.
 13944
 13945     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13946     MOVE ZEROS         TO WS-CDAYS.
 13947     MOVE 'N'           TO WS-ELIMINATION-SW.
 13948
 13949*--------------------------------------------------------------*
 13950*    COMPUTE CALIFORNIA DUE DAYS                               *
 13951*--------------------------------------------------------------*
 13952
 13953     IF CL-TOTAL-PAID-AMT > ZEROS
 13954         MOVE 'Y' TO WS-ELIMINATION-SW
 13955         GO TO 3240-FIRST-PMT-DUE
 13956     ELSE
 13957        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13958            NEXT SENTENCE
 13959        ELSE
 13960            GO TO 3240-FIRST-PMT-DUE.
 13961
 13962 3230-NEXT-PMT-DUE.
 13963
 13964     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13965     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13966     IF NO-CONVERSION-ERROR
 13967         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13968         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13969     ELSE
 13970         GO TO 3290-ERROR.
 13971
 13972 3240-FIRST-PMT-DUE.
 13973
 13974     IF CL-TOTAL-PAID-AMT > ZEROS
 13975         NEXT SENTENCE
 13976     ELSE
 13977        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13978            GO TO 3230-NEXT-PMT-DUE.
 13979
 13980     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13981         GO TO 3250-VERIFY-ELIMINATION.
 13982
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 266
* EL156.cbl
 13983     ADD +30 TO WS-CDAYS.
 13984     MOVE 'Y' TO WS-ELIMINATION-SW.
 13985     GO TO 3230-NEXT-PMT-DUE.
 13986
 13987 3250-VERIFY-ELIMINATION.
 13988
 13989     IF ELIM-SATISFIED
 13990         GO TO 3260-END-CALC.
 13991
 13992     IF PI-PMTTYPE = '1'
 13993         MOVE ZEROS TO WS-CDAYS
 13994         GO TO 3260-END-CALC.
 13995
 13996     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13997         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13998     ELSE
 13999         IF CL-TOTAL-PAID-AMT > ZEROS
 14000             IF WS-SV-EPYFROM = LOW-VALUES
 14001                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14002             ELSE
 14003                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14004         ELSE
 14005             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14006
 14007     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14008     MOVE '1'                    TO DC-OPTION-CODE.
 14009     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14010     IF NO-CONVERSION-ERROR
 14011         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14012     ELSE
 14013         GO TO 3290-ERROR.
 14014
 14015     IF CL-TOTAL-PAID-AMT > ZEROS
 14016         MOVE WS-DAYS-OFF TO WS-CDAYS
 14017     ELSE
 14018         IF PI-BEN-DAYS > WS-DAYS-OFF
 14019             MOVE ZEROS TO WS-CDAYS
 14020         ELSE
 14021             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14022
 14023 3260-END-CALC.
 14024
 14025     MOVE WS-CDAYS TO PI-CDAYS.
 14026
 14027     IF PI-EDAYS = ZEROS
 14028         MOVE PI-CDAYS TO PI-EDAYS
 14029         MOVE AL-UNNON TO EDAYSA.
 14030
 14031     GO TO 3299-EXIT.
 14032
 14033 3290-ERROR.
 14034
 14035     MOVE ER-3528            TO EMI-ERROR.
 14036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14037     MOVE -1                 TO CDAYSL.
 14038     MOVE AL-UNBON           TO CDAYSA.
 14039
 14040 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 267
* EL156.cbl
 14041     EXIT.
 14042
 14043 3300-BUMP-DATE.
 14044
 14045     IF WS-RESTORE-DUE-DAY
 14046         MOVE 'N'              TO WS-DUE-DAY-SW
 14047         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14048         ADD 1                 TO WS-PMT-DUE-MO
 14049         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14050         MOVE '4'              TO DC-OPTION-CODE
 14051         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14052         IF NO-CONVERSION-ERROR
 14053             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14054             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14055             GO TO 3399-EXIT
 14056         ELSE
 14057             MOVE '9'          TO DC-ERROR-CODE
 14058             GO TO 3399-EXIT.
 14059
 14060     IF (WS-PMT-DUE-MO = 1) AND
 14061        (WS-SAVE-DUE-DA > 28)
 14062           MOVE 'Y' TO WS-DUE-DAY-SW.
 14063
 14064     MOVE +0                 TO DC-ELAPSED-DAYS.
 14065     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14066     MOVE '6'                TO DC-OPTION-CODE.
 14067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14068
 14069 3399-EXIT.
 14070     EXIT.
 14071
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 268
* EL156.cbl
 14073 3400-COMPUTE-EXPIRY.
 14074
 14075     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14076     MOVE +0                    TO DC-ELAPSED-DAYS
 14077                                   DC-ODD-DAYS-OVER.
 14078     MOVE '1'                   TO DC-END-OF-MONTH.
 14079     MOVE '6'                   TO DC-OPTION-CODE.
 14080
 14081     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14082         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14083     ELSE
 14084         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14085
 14086     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14087     IF NO-CONVERSION-ERROR
 14088         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14089     ELSE
 14090         GO TO 3390-CONTINUE.
 14091
 14092     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14093         GO TO 3390-CONTINUE.
 14094
 14095     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14096     MOVE '4'                    TO CNTL-REC-TYPE.
 14097     MOVE +0                     TO CNTL-SEQ-NO.
 14098     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14099     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14100     MOVE 'BENE'                 TO FILE-SWITCH.
 14101
 14102     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14103
 14104     IF NO-BENEFIT-FOUND
 14105         GO TO 3390-CONTINUE.
 14106
 14107     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14108        IF (PI-OFFLINE = 'Y') OR
 14109           (PI-PMTTYPE = '7')
 14110           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14111                                     THRU 9870-EXIT
 14112           IF ERROR-ON-OUTPUT
 14113             MOVE -1                 TO ENTERPFL
 14114             MOVE AL-UANON           TO ENTERPFA
 14115             MOVE MAP-NAMEA          TO MAP-NAME
 14116             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14117             GO TO 8200-SEND-DATAONLY.
 14118
 14119     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14120        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14121        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14122          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14123          MOVE +0        TO DC-ELAPSED-DAYS
 14124          MOVE +1        TO DC-ELAPSED-MONTHS
 14125          MOVE 6         TO DC-OPTION-CODE
 14126          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14127          IF NO-CONVERSION-ERROR
 14128              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14129
 14130 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 269
* EL156.cbl
 14131
 14132      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14133         MOVE CM-AH-LOAN-EXPIRE-DT
 14134                                 TO DC-BIN-DATE-1
 14135      ELSE
 14136         MOVE CM-LF-LOAN-EXPIRE-DT
 14137                                 TO DC-BIN-DATE-1
 14138      END-IF
 14139
 14140      MOVE ' '                    TO DC-OPTION-CODE.
 14141      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14142      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14143      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14144
 14145 3499-EXIT.
 14146     EXIT.
 14147
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 270
* EL156.cbl
 14149
 14150 3600-CHECK-VERIFICATION.
 14151
 14152     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14153
 14154     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14155
 14156     IF PI-PAYEE-TYPE = 'I'
 14157        GO TO 3600-READ-TRAILER.
 14158
 14159     IF PI-PAYEE-TYPE = 'B'
 14160        ADD +10                  TO TRLR-SEQ-NO
 14161        GO TO 3600-READ-TRAILER.
 14162
 14163     IF PI-PAYEE-TYPE = 'A'
 14164        ADD +20                  TO TRLR-SEQ-NO
 14165        GO TO 3600-READ-TRAILER.
 14166
 14167     IF PI-PAYEE-TYPE = 'O'
 14168        ADD +50                  TO TRLR-SEQ-NO
 14169        GO TO 3600-READ-TRAILER.
 14170
 14171     IF PI-PAYEE-TYPE = 'Q'
 14172        ADD +60                  TO TRLR-SEQ-NO
 14173        GO TO 3600-READ-TRAILER.
 14174
 14175     IF PI-PAYEE-TYPE = 'P'
 14176        ADD +30                  TO TRLR-SEQ-NO
 14177        GO TO 3600-READ-TRAILER.
 14178
 14179     IF PI-PAYEE-TYPE = 'E'
 14180        ADD +40                  TO TRLR-SEQ-NO.
 14181
 14182 3600-READ-TRAILER.
 14183
 14184
 14185* EXEC CICS HANDLE CONDITION
 14186*         NOTFND(3600-CONTINUE)
 14187*    END-EXEC.
 14188*    MOVE '"$I                   ! - #00013406' TO DFHEIV0
 14189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14191     MOVE X'2D20233030303133343036' TO DFHEIV0(25:11)
 14192     CALL 'kxdfhei1' USING DFHEIV0
 14193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14194
 14195
 14196     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14197
 14198 3600-CONTINUE.
 14199
 14200     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14201         GO TO 3600-AH-VERIFY
 14202     END-IF.
 14203
 14204     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14205       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14206         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 271
* EL156.cbl
 14207           MOVE ER-7576            TO EMI-ERROR
 14208           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14209           MOVE -1                 TO PAYEEL
 14210           MOVE AL-UABON           TO PAYEEA
 14211           GO TO 3600-EXIT
 14212         END-IF
 14213       END-IF
 14214     END-IF.
 14215
 14216     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14217     MOVE 1 TO WS-SUB2
 14218     MOVE SPACES TO WS-PAYEE-NAME
 14219     PERFORM VARYING WS-SUB FROM 1 BY 1
 14220             UNTIL WS-SUB > 30
 14221         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14222            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14223                 WS-PAYEE-NAME-X (WS-SUB2)
 14224            ADD +1 TO WS-SUB2
 14225         END-IF
 14226     END-PERFORM.
 14227
 14228     STRING CL-INSURED-1ST-NAME
 14229            CL-INSURED-MID-INIT
 14230            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14231     MOVE 1 TO WS-SUB2
 14232     MOVE SPACES TO WS-INSURED-NAME
 14233     PERFORM VARYING WS-SUB FROM 1 BY 1
 14234             UNTIL WS-SUB > 30
 14235         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14236            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14237                 WS-INSURED-NAME-X (WS-SUB2)
 14238            ADD +1 TO WS-SUB2
 14239         END-IF
 14240     END-PERFORM.
 14241
 14242     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14243        MOVE ER-7579            TO EMI-ERROR
 14244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14245        MOVE -1                 TO PAYEEL
 14246        MOVE AL-UABON           TO PAYEEA
 14247     END-IF.
 14248
 14249     IF PI-PMTTYPE = '4'  AND
 14250        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14251        PI-PAYEE-TYPE <> 'I'
 14252          MOVE ER-7580          TO EMI-ERROR
 14253          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14254          MOVE -1               TO PAYEEL
 14255          MOVE AL-UABON         TO PAYEEA
 14256     END-IF.
 14257
 14258     GO TO 3600-EXIT.
 14259
 14260 3600-AH-VERIFY.
 14261
 14262     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14263        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14264           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 272
* EL156.cbl
 14265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266           MOVE -1                 TO PAYEEL
 14267           MOVE AL-UABON           TO PAYEEA
 14268        END-IF
 14269     END-IF.
 14270
 14271
 14272 3600-EXIT.
 14273     EXIT.
 14274
 14275 5000-UPDATE.
 14276
 14277     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14278
 14279     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14280
 14281     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14282        PI-OFFLINE = 'Y'
 14283        NEXT SENTENCE
 14284     ELSE
 14285        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14286
 14287*    IF PI-COMPANY-ID = 'CRI'
 14288*       IF PI-PMTTYPE = '1' OR  '2'
 14289*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14290*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14291*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14292
 14293*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14294*       IF PI-PMTTYPE = '1'
 14295*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14296*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14297
 14298     IF PI-PMTTYPE      = '2' AND
 14299        PI-SPLIT-PMT-SW = 'Y' AND
 14300        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14301          MOVE ER-3530                TO EMI-ERROR
 14302          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14303
 14304     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14305        AND (CL-CLAIM-TYPE = 'L')
 14306        IF PI-PMTTYPE = '2' OR '4'
 14307           IF PI-INT-AMT NOT = ZEROS
 14308              PERFORM 7110-BUILD-PMT-TRLR
 14309                                 THRU 7130-EXIT
 14310           ELSE
 14311              IF PI-PMTTYPE = '2'
 14312                 PERFORM 7140-BUILD-NOTE-TRLR
 14313                                 THRU 7170-EXIT
 14314              END-IF
 14315           END-IF
 14316        END-IF
 14317     END-IF
 14318*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14319*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14320*            MOVE 'N'                 TO  WS-LETTER-SW.
 14321
 14322*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 273
* EL156.cbl
 14323*        IF CL-NO-OF-PMTS-MADE = +1
 14324*                OR
 14325*           PI-PMTTYPE = '2'
 14326*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14327
 14328     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14329
 14330*    IF PI-COMPANY-ID = 'DMD'
 14331*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14332*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14333
 14334
 14335* EXEC CICS REWRITE
 14336*         DATASET('ELMSTR')
 14337*         FROM(CLAIM-MASTER)
 14338*     END-EXEC.
 14339     MOVE LENGTH OF
 14340      CLAIM-MASTER
 14341       TO DFHEIV11
 14342     MOVE 'ELMSTR' TO DFHEIV1
 14343*    MOVE '&& L                  %   #00013548' TO DFHEIV0
 14344     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14345     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14346     MOVE X'2020233030303133353438' TO DFHEIV0(25:11)
 14347     CALL 'kxdfhei1' USING DFHEIV0,
 14348           DFHEIV1,
 14349           CLAIM-MASTER,
 14350           DFHEIV11,
 14351           DFHEIV99
 14352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14353
 14354
 14355     IF WS-LETTER-SW = 'N'
 14356         GO TO 5000-END-UPDATE.
 14357
 14358 5000-GENERATE-AUTO-LETTER.
 14359
 14360
 14361* EXEC CICS LINK
 14362*        PROGRAM    (LINK-1523)
 14363*        COMMAREA   (W-1523-LINKDATA)
 14364*        LENGTH     (W-1523-COMM-LENGTH)
 14365*    END-EXEC.
 14366*    MOVE '."C                   (   #00013558' TO DFHEIV0
 14367     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14369     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 14370     CALL 'kxdfhei1' USING DFHEIV0,
 14371           LINK-1523,
 14372           W-1523-LINKDATA,
 14373           W-1523-COMM-LENGTH,
 14374           DFHEIV99,
 14375           DFHEIV99,
 14376           DFHEIV99,
 14377           DFHEIV99
 14378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14379
 14380
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 274
* EL156.cbl
 14381     IF W-1523-FATAL-ERROR
 14382         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14383         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14384         MOVE ER-0802                TO  EMI-ERROR
 14385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14386
 14387     IF W-1523-ERROR-CODE = 0191
 14388         MOVE ER-0803                TO  EMI-ERROR
 14389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14390
 14391     IF PI-COMPANY-ID      = 'HAN' AND
 14392        PI-PMTTYPE         = '1'   AND
 14393        PI-3RD-PARTY-SW    = 'Y'   AND
 14394        W-1523-FORM-NUMBER = 'EOB1'
 14395           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14396           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14397           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14398           GO TO 5000-GENERATE-AUTO-LETTER.
 14399
 14400 5000-END-UPDATE.
 14401
 14402     MOVE ER-0000                TO EMI-ERROR.
 14403     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14404     GO TO 7000-SHOW-CLAIM.
 14405
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 275
* EL156.cbl
 14407 5000-MOVE-NAME.
 14408     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14409     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14410     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14411
 14412 5000-EXIT.
 14413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 276
* EL156.cbl
 14415 5300-CREATE-DMO.
 14416
 14417     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14418     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14419     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14420
 14421
 14422* EXEC CICS HANDLE CONDITION
 14423*         NOTFND   (5300-NOTE-NOT-FOUND)
 14424*    END-EXEC.
 14425*    MOVE '"$I                   ! . #00013604' TO DFHEIV0
 14426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14428     MOVE X'2E20233030303133363034' TO DFHEIV0(25:11)
 14429     CALL 'kxdfhei1' USING DFHEIV0
 14430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14431
 14432
 14433
 14434* EXEC CICS READ
 14435*         DATASET('ERNOTE')
 14436*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14437*         RIDFLD (W-NOTE-KEY)
 14438*    END-EXEC.
 14439     MOVE 'ERNOTE' TO DFHEIV1
 14440*    MOVE '&"S        E          (   #00013608' TO DFHEIV0
 14441     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14443     MOVE X'2020233030303133363038' TO DFHEIV0(25:11)
 14444     CALL 'kxdfhei1' USING DFHEIV0,
 14445           DFHEIV1,
 14446           DFHEIV20,
 14447           DFHEIV99,
 14448           W-NOTE-KEY,
 14449           DFHEIV99,
 14450           DFHEIV99,
 14451           DFHEIV99
 14452     SET ADDRESS OF CERTIFICATE-NOTE TO
 14453         DFHEIV20
 14454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14455
 14456
 14457     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14458     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14459     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14460
 14461     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14462         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14463     ELSE
 14464         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14465
 14466     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14467     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14468     MOVE 'DLO006'               TO PGM-NAME.
 14469
 14470
 14471* EXEC CICS LINK
 14472*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 277
* EL156.cbl
 14473*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14474*        LENGTH     (DCT-RCRD-LENGTH)
 14475*    END-EXEC.
 14476*    MOVE '."C                   (   #00013627' TO DFHEIV0
 14477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14479     MOVE X'2020233030303133363237' TO DFHEIV0(25:11)
 14480     CALL 'kxdfhei1' USING DFHEIV0,
 14481           PGM-NAME,
 14482           DCT-COMMUNICATION-AREA,
 14483           DCT-RCRD-LENGTH,
 14484           DFHEIV99,
 14485           DFHEIV99,
 14486           DFHEIV99,
 14487           DFHEIV99
 14488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14489
 14490
 14491     IF DCT-RETURN-CODE = 'OK'
 14492         GO TO 5300-CONT.
 14493
 14494     IF DCT-RETURN-CODE = '01' OR '02'
 14495         GO TO 5300-EXIT.
 14496
 14497     IF DCT-RETURN-CODE = '03'
 14498         MOVE ER-0951            TO EMI-ERROR
 14499         GO TO 5300-BAD-EXIT.
 14500
 14501     IF DCT-RETURN-CODE = '04'
 14502         MOVE ER-0946            TO EMI-ERROR
 14503         GO TO 5300-BAD-EXIT.
 14504
 14505     IF DCT-RETURN-CODE = '05'
 14506         MOVE ER-0947            TO EMI-ERROR
 14507         GO TO 5300-BAD-EXIT.
 14508
 14509     IF DCT-RETURN-CODE = '06'
 14510         MOVE ER-0921            TO EMI-ERROR
 14511         GO TO 5300-BAD-EXIT.
 14512
 14513     IF DCT-RETURN-CODE = '07'
 14514         MOVE ER-0849            TO EMI-ERROR
 14515         GO TO 5300-BAD-EXIT.
 14516
 14517     IF DCT-RETURN-CODE = '08'
 14518         MOVE ER-0948            TO EMI-ERROR
 14519         GO TO 5300-BAD-EXIT.
 14520
 14521     IF DCT-RETURN-CODE = 'N1'
 14522         MOVE ER-0950            TO EMI-ERROR
 14523         GO TO 5300-BAD-EXIT.
 14524
 14525     IF DCT-RETURN-CODE = 'E1'
 14526         MOVE ER-0974            TO EMI-ERROR
 14527         GO TO 5300-BAD-EXIT.
 14528
 14529     IF DCT-RETURN-CODE = 'E2'
 14530         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 278
* EL156.cbl
 14531         GO TO 5300-BAD-EXIT.
 14532
 14533     IF DCT-RETURN-CODE NOT = 'OK'
 14534         MOVE ER-0949            TO EMI-ERROR
 14535         GO TO 5300-BAD-EXIT.
 14536
 14537 5300-CONT.
 14538
 14539     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14540     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14541     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14542     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14543     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14544     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14545     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14546     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14547
 14548     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14549     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14550     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14551     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14552     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14553
 14554     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14555
 14556     IF PI-PMTTYPE = '2'
 14557         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14558         MOVE '4'                TO DM-CLAIM-STATUS
 14559     ELSE
 14560         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14561         MOVE '2'                TO DM-CLAIM-STATUS.
 14562
 14563     MOVE 'DLO025'               TO PGM-NAME.
 14564
 14565
 14566* EXEC CICS LINK
 14567*        PROGRAM    (PGM-NAME)
 14568*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14569*        LENGTH     (DM-DMO-LENGTH)
 14570*    END-EXEC.
 14571*    MOVE '."C                   (   #00013707' TO DFHEIV0
 14572     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14573     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14574     MOVE X'2020233030303133373037' TO DFHEIV0(25:11)
 14575     CALL 'kxdfhei1' USING DFHEIV0,
 14576           PGM-NAME,
 14577           DMO-COMMUNICATION-AREA,
 14578           DM-DMO-LENGTH,
 14579           DFHEIV99,
 14580           DFHEIV99,
 14581           DFHEIV99,
 14582           DFHEIV99
 14583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14584
 14585
 14586     IF DM-RETURN-CODE = 'OK'
 14587         GO TO 5300-EXIT.
 14588
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 279
* EL156.cbl
 14589     IF DM-RETURN-CODE = '01'
 14590         MOVE ER-8051            TO EMI-ERROR
 14591         GO TO 5300-BAD-EXIT.
 14592
 14593     IF DM-RETURN-CODE = '02'
 14594         MOVE ER-8052            TO EMI-ERROR
 14595         GO TO 5300-BAD-EXIT.
 14596
 14597     IF DM-RETURN-CODE = '03'
 14598         MOVE ER-8053            TO EMI-ERROR
 14599         GO TO 5300-BAD-EXIT.
 14600
 14601     IF DM-RETURN-CODE = '04'
 14602         MOVE ER-8054            TO EMI-ERROR
 14603         GO TO 5300-BAD-EXIT.
 14604
 14605     IF DM-RETURN-CODE = '05'
 14606         MOVE ER-8055            TO EMI-ERROR
 14607         GO TO 5300-BAD-EXIT.
 14608
 14609     IF DM-RETURN-CODE = '06'
 14610         MOVE ER-8056            TO EMI-ERROR
 14611         GO TO 5300-BAD-EXIT.
 14612
 14613     IF DM-RETURN-CODE = '07'
 14614         MOVE ER-8057            TO EMI-ERROR
 14615         GO TO 5300-BAD-EXIT.
 14616
 14617     IF DM-RETURN-CODE = '08'
 14618         MOVE ER-8058            TO EMI-ERROR
 14619         GO TO 5300-BAD-EXIT.
 14620
 14621     IF DM-RETURN-CODE = '09'
 14622         MOVE ER-8059            TO EMI-ERROR
 14623         GO TO 5300-BAD-EXIT.
 14624
 14625     IF DM-RETURN-CODE = '10'
 14626         MOVE ER-8060            TO EMI-ERROR
 14627         GO TO 5300-BAD-EXIT.
 14628
 14629     IF DM-RETURN-CODE = '11'
 14630         MOVE ER-8061            TO EMI-ERROR
 14631         GO TO 5300-BAD-EXIT.
 14632
 14633     IF DM-RETURN-CODE = '12'
 14634         MOVE ER-8062            TO EMI-ERROR
 14635         GO TO 5300-BAD-EXIT.
 14636
 14637     IF DM-RETURN-CODE = '13'
 14638         MOVE ER-8063            TO EMI-ERROR
 14639         GO TO 5300-BAD-EXIT.
 14640
 14641     IF DM-RETURN-CODE = '14'
 14642         MOVE ER-8064            TO EMI-ERROR
 14643         GO TO 5300-BAD-EXIT.
 14644
 14645     IF DM-RETURN-CODE = '15'
 14646         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 280
* EL156.cbl
 14647         GO TO 5300-BAD-EXIT.
 14648
 14649     IF DM-RETURN-CODE = '16'
 14650         MOVE ER-8154            TO EMI-ERROR
 14651         GO TO 5300-BAD-EXIT.
 14652
 14653     IF DM-RETURN-CODE = '17'
 14654         MOVE ER-8155            TO EMI-ERROR
 14655         GO TO 5300-BAD-EXIT.
 14656
 14657     IF DM-RETURN-CODE = 'N1'
 14658         MOVE ER-8152            TO EMI-ERROR
 14659         GO TO 5300-BAD-EXIT.
 14660
 14661     IF DM-RETURN-CODE = 'E1'
 14662         MOVE ER-8153            TO EMI-ERROR
 14663         GO TO 5300-BAD-EXIT.
 14664
 14665     MOVE ER-8066            TO EMI-ERROR.
 14666     GO TO 5300-BAD-EXIT.
 14667
 14668 5300-NOTE-NOT-FOUND.
 14669
 14670     MOVE ER-0954                TO EMI-ERROR.
 14671     GO TO 5300-BAD-EXIT.
 14672
 14673 5300-BAD-EXIT.
 14674
 14675* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14676*    MOVE '6"R                   !   #00013801' TO DFHEIV0
 14677     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14679     MOVE X'2020233030303133383031' TO DFHEIV0(25:11)
 14680     CALL 'kxdfhei1' USING DFHEIV0
 14681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14682
 14683     IF MAP-NAME = 'EL156A'
 14684         MOVE -1             TO ENTERPFL
 14685       ELSE
 14686         MOVE LOW-VALUES     TO EL156BI
 14687         MOVE -1             TO ENTPFBL.
 14688
 14689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14690     GO TO 8200-SEND-DATAONLY.
 14691
 14692 5300-EXIT.
 14693     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 281
* EL156.cbl
 14695 5350-FORMAT-LAST-NAME-1ST.
 14696*****************************************************************
 14697*             M O V E   N A M E   R O U T I N E                 *
 14698*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14699*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14700*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14701*                  FIELD                   VALUE                *
 14702*           W-NAME-LAST    (CL15)      SMITH                    *
 14703*           W-NAME-FIRST   (CL15)      JOHN                     *
 14704*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14705*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14706*     CONTAIN                                                   *
 14707*                SMITH, JOHN ALLEN                              *
 14708*     OR                                                        *
 14709*                SMITH, JOHN A.                                 *
 14710*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14711*     COPYBOOK, ELCNWA.                                         *
 14712*****************************************************************.
 14713
 14714     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14715     MOVE ZERO                   TO  WS-NAME-SW.
 14716     SET NWA-INDEX               TO +1.
 14717
 14718     IF W-NAME-LAST   = SPACES AND
 14719        W-NAME-MIDDLE = SPACES
 14720         MOVE +1                 TO WS-NAME-SW.
 14721
 14722     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14723     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14724
 14725     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14726     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14727
 14728     SET NWA-INDEX UP BY +1.
 14729
 14730     IF W-NAME-MIDDLE NOT = SPACES
 14731         IF W-NAME-MIDDLE-2 = SPACES
 14732             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14733             SET NWA-INDEX UP BY +1
 14734             MOVE '.'            TO WS-NW (NWA-INDEX)
 14735             SET NWA-INDEX UP BY +2
 14736         ELSE
 14737             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14738             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14739
 14740 5350-EXIT.
 14741     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 282
* EL156.cbl
 14743 5360-MOVE-NAME.
 14744
 14745     IF WS-NAME-SW > +1
 14746         GO TO 5360-EXIT.
 14747
 14748     IF WS-NAME-WORK2 = SPACES
 14749         GO TO 5360-EXIT.
 14750
 14751     SET NWA-INDEX2            TO +1.
 14752     SET NWA-INDEX3            TO +2.
 14753
 14754 5360-MOVE-NAME-CYCLE.
 14755
 14756     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14757
 14758     IF NWA-INDEX < +30
 14759         SET NWA-INDEX UP BY +1
 14760     ELSE
 14761         ADD +2                TO  WS-NAME-SW
 14762         GO TO 5360-EXIT.
 14763
 14764     IF NWA-INDEX2 < +20
 14765         SET NWA-INDEX3 UP BY +1
 14766         SET NWA-INDEX2 UP BY +1.
 14767
 14768     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14769        WS-NW2 (NWA-INDEX3) = SPACES
 14770         IF WS-NAME-SW = ZERO
 14771             MOVE ','            TO  WS-NW (NWA-INDEX)
 14772             SET NWA-INDEX UP BY +2
 14773             MOVE +1             TO  WS-NAME-SW
 14774             GO TO 5360-EXIT
 14775         ELSE
 14776             GO TO 5360-EXIT.
 14777
 14778     GO TO 5360-MOVE-NAME-CYCLE.
 14779
 14780 5360-EXIT.
 14781     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 283
* EL156.cbl
 14783 6000-BUILD-SCREEN-B.
 14784     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14785     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14786     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14787     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14788
 14789     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14790
 14791 6050-BUILD-SCREEN.
 14792     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14793     MOVE LOW-VALUES             TO EL156BI.
 14794     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14795
 14796     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14797
 14798     IF PI-PAYEE-TYPE = 'I'
 14799        GO TO 6060-READ-TRAILER.
 14800
 14801     IF PI-PAYEE-TYPE = 'B'
 14802        ADD +10                  TO TRLR-SEQ-NO
 14803        GO TO 6060-READ-TRAILER.
 14804
 14805     IF PI-PAYEE-TYPE = 'A'
 14806        ADD +20                  TO TRLR-SEQ-NO
 14807        GO TO 6060-READ-TRAILER.
 14808
 14809     IF PI-PAYEE-TYPE = 'O'
 14810        ADD +50                  TO TRLR-SEQ-NO
 14811        GO TO 6060-READ-TRAILER.
 14812
 14813     IF PI-PAYEE-TYPE = 'Q'
 14814        ADD +60                  TO TRLR-SEQ-NO
 14815        GO TO 6060-READ-TRAILER.
 14816
 14817     IF PI-PAYEE-TYPE = 'P'
 14818        ADD +30                  TO TRLR-SEQ-NO
 14819        GO TO 6060-READ-TRAILER.
 14820
 14821     IF PI-PAYEE-TYPE = 'E'
 14822        ADD +40                  TO TRLR-SEQ-NO.
 14823
 14824 6060-READ-TRAILER.
 14825
 14826     IF PI-PAYEE-TYPE    = 'A' AND
 14827        PI-PAYEE-SEQ-NUM = 0
 14828          GO TO 6061-READ-ACCOUNT.
 14829
 14830     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14831        (PI-PAYEE-TYPE    = 'B')             AND
 14832        (PI-PAYEE-SEQ-NUM = 9)
 14833          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14834          IF BENE-FOUND-SW = 'N'
 14835            GO TO 6065-NOT-FOUND
 14836          ELSE
 14837            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14838            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14839            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14840*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 284
* EL156.cbl
 14841            STRING BE-CITY ' ' BE-STATE
 14842               DELIMITED BY '  ' INTO CITYSTBO
 14843            END-STRING
 14844            MOVE BE-ZIP-CODE       TO ZIPBO
 14845            GO TO 6061-READ-ACCOUNT.
 14846
 14847     IF PI-PAYEE-TYPE    = 'B' AND
 14848        PI-PAYEE-SEQ-NUM = 0
 14849          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14850          IF BENE-FOUND-SW = 'N'
 14851            GO TO 6065-NOT-FOUND
 14852          ELSE
 14853            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14854            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14855            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14856*           MOVE BE-CITY-STATE     TO CITYSTBO
 14857            STRING BE-CITY ' ' BE-STATE
 14858               DELIMITED BY '  ' INTO CITYSTBO
 14859            END-STRING
 14860            MOVE BE-ZIP-CODE       TO ZIPBO
 14861            GO TO 6061-READ-ACCOUNT.
 14862
 14863
 14864* EXEC CICS HANDLE CONDITION
 14865*         NOTFND(6065-NOT-FOUND)
 14866*     END-EXEC.
 14867*    MOVE '"$I                   ! / #00013982' TO DFHEIV0
 14868     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14870     MOVE X'2F20233030303133393832' TO DFHEIV0(25:11)
 14871     CALL 'kxdfhei1' USING DFHEIV0
 14872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14873
 14874
 14875     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14876
 14877     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14878     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14879     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14880     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14881*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14882     STRING AT-CITY ' ' AT-STATE
 14883        DELIMITED BY '  ' INTO CITYSTBO
 14884     END-STRING
 14885     MOVE AT-ZIP-CODE            TO ZIPBO.
 14886
 14887 6061-READ-ACCOUNT.
 14888
 14889* EXEC CICS HANDLE CONDITION
 14890*         NOTFND(6068-ACCT-NOT-FND)
 14891*     END-EXEC.
 14892*    MOVE '"$I                   ! 0 #00013999' TO DFHEIV0
 14893     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14895     MOVE X'3020233030303133393939' TO DFHEIV0(25:11)
 14896     CALL 'kxdfhei1' USING DFHEIV0
 14897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14898
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 285
* EL156.cbl
 14899
 14900
 14901* EXEC CICS READ
 14902*         DATASET('ERACCT')
 14903*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14904*         RIDFLD (PI-ACCT-KEY)
 14905*     END-EXEC.
 14906     MOVE 'ERACCT' TO DFHEIV1
 14907*    MOVE '&"S        E          (   #00014003' TO DFHEIV0
 14908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14910     MOVE X'2020233030303134303033' TO DFHEIV0(25:11)
 14911     CALL 'kxdfhei1' USING DFHEIV0,
 14912           DFHEIV1,
 14913           DFHEIV20,
 14914           DFHEIV99,
 14915           PI-ACCT-KEY,
 14916           DFHEIV99,
 14917           DFHEIV99,
 14918           DFHEIV99
 14919     SET ADDRESS OF ACCOUNT-MASTER TO
 14920         DFHEIV20
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
 14923
 14924     MOVE AM-CARRIER             TO ACARRBO.
 14925     MOVE AM-GROUPING            TO GROUPBO.
 14926     MOVE AM-STATE               TO STATEBO.
 14927     MOVE AM-ACCOUNT             TO ACCTBO.
 14928     MOVE AM-NAME                TO ACCTNMBO.
 14929
 14930     IF PI-PAYEE-TYPE = 'A' AND
 14931        PI-PAYEE-SEQ-NUM = 0
 14932          MOVE AM-NAME             TO NAMEBO
 14933                                      PI-PAYEE-NAME
 14934          MOVE AM-ADDRS            TO ADDR1BO
 14935          MOVE SPACES              TO ADDR2BO
 14936*         MOVE AM-CITY             TO CITYSTBO
 14937          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14938             DELIMITED BY '  ' INTO CITYSTBO
 14939          END-STRING
 14940          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14941          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14942          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14943          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14944
 14945     IF CITYSTBO EQUAL SPACES
 14946         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14947         GO TO 6070-FORMAT-DATA
 14948     END-IF.
 14949
 14950     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14951     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14952     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14953     PERFORM VARYING WS-SUB FROM 30 BY -1
 14954          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14955        IF WS-END-SUB = 0  AND
 14956           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 286
* EL156.cbl
 14957              OR LOW-VALUES  OR '.')
 14958            CONTINUE
 14959        ELSE
 14960            IF WS-END-SUB = 0
 14961                MOVE WS-SUB TO WS-END-SUB
 14962            ELSE
 14963                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14964                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14965                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14966                END-IF
 14967            END-IF
 14968        END-IF
 14969        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14970            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14971            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14972        END-IF
 14973     END-PERFORM.
 14974
 14975     IF WS-BEG-SUB > 0
 14976         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14977         IF WS-STATE-LENGTH = 2
 14978             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14979                  TO PI-CHECK-STATE-FOR-AK
 14980         ELSE
 14981             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14982                'ALASKA'
 14983                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14984             ELSE
 14985                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14986             END-IF
 14987         END-IF
 14988     ELSE
 14989         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14990     END-IF.
 14991
 14992     GO TO 6070-FORMAT-DATA.
 14993
 14994 6065-NOT-FOUND.
 14995     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14996     GO TO 6061-READ-ACCOUNT.
 14997
 14998 6068-ACCT-NOT-FND.
 14999     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15000
 15001 6070-FORMAT-DATA.
 15002     IF PI-HOLDTIL = ZEROS
 15003        MOVE SAVE-DATE           TO PAYDTBI
 15004       ELSE
 15005        MOVE PI-HOLDTIL          TO PAYDTBO
 15006        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15007
 15008     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15009     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15010
 15011     IF EIBAID = DFHPF3 OR DFHPF4
 15012        NEXT SENTENCE
 15013     ELSE
 15014       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 287
* EL156.cbl
 15015
 15016     MOVE PI-EPYFROM          TO PYFROMBO.
 15017     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15018
 15019     IF NOT PI-USES-PAID-TO
 15020        MOVE PI-EPYTHRU          TO PYTHRUBO
 15021        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15022     ELSE
 15023        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15024        MOVE '4'              TO DC-OPTION-CODE
 15025        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15026        IF NO-CONVERSION-ERROR
 15027           MOVE +1            TO DC-ELAPSED-DAYS
 15028           MOVE +0            TO DC-ELAPSED-MONTHS
 15029           MOVE '6'           TO DC-OPTION-CODE
 15030           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15031           IF NO-CONVERSION-ERROR
 15032              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15033
 15034     MOVE PI-EDAYS            TO DAYSBO.
 15035     MOVE PI-EPYAMT           TO PAYAMTBO.
 15036     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15037        IF PI-INT-AMT > ZEROS
 15038           MOVE PI-INT-AMT       TO INTAMTBO
 15039        END-IF
 15040     END-IF
 15041     GO TO 6072-SET-TYPE.
 15042
 15043 6071-CONTINUE.
 15044
 15045     IF PI-CPYFROM NOT = LOW-VALUES
 15046        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15047        MOVE SPACES              TO DC-OPTION-CODE
 15048        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15049        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15050
 15051     IF PI-CPYTHRU NOT = LOW-VALUES
 15052        IF NOT PI-USES-PAID-TO
 15053           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15054           MOVE SPACES             TO DC-OPTION-CODE
 15055           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15056           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15057        ELSE
 15058           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15059           MOVE '6'                TO DC-OPTION-CODE
 15060           MOVE +1                 TO DC-ELAPSED-DAYS
 15061           MOVE +0                 TO DC-ELAPSED-MONTHS
 15062           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15063           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15064
 15065     MOVE PI-CDAYS               TO DAYSBO.
 15066     MOVE PI-CPYAMT              TO PAYAMTBO.
 15067     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15068        IF PI-INT-AMT > ZEROS
 15069           MOVE PI-INT-AMT       TO INTAMTBO
 15070        END-IF
 15071     END-IF
 15072     .
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 288
* EL156.cbl
 15073 6072-SET-TYPE.
 15074     IF PI-PMTTYPE = '1'
 15075        MOVE 'PARTIAL'           TO PAYTYPBO.
 15076
 15077     IF PI-PMTTYPE = '2'
 15078        MOVE 'FINAL'             TO PAYTYPBO.
 15079
 15080     IF PI-PMTTYPE = '3'
 15081        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15082
 15083     IF PI-PMTTYPE = '4'
 15084        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15085
 15086     IF PI-PMTTYPE = '5'
 15087        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15088
 15089     IF PI-PMTTYPE = '6'
 15090        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15091
 15092     IF PI-PROV-PMT
 15093        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15094
 15095     IF PI-ECHECKNO NOT = SPACES
 15096        MOVE PI-ECHECKNO         TO CKNUMBO
 15097     ELSE
 15098        MOVE PI-CCHECKNO         TO CKNUMBO.
 15099
 15100     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15101        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15102        MOVE +91                 TO  TRLR-SEQ-NO
 15103
 15104* EXEC CICS READ
 15105*           DATASET  ('ELTRLR')
 15106*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15107*           RIDFLD   (ELTRLR-KEY)
 15108*           RESP     (WS-RESPONSE)
 15109*       END-EXEC
 15110     MOVE 'ELTRLR' TO DFHEIV1
 15111*    MOVE '&"S        E          (  N#00014188' TO DFHEIV0
 15112     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15113     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15114     MOVE X'204E233030303134313838' TO DFHEIV0(25:11)
 15115     CALL 'kxdfhei1' USING DFHEIV0,
 15116           DFHEIV1,
 15117           DFHEIV20,
 15118           DFHEIV99,
 15119           ELTRLR-KEY,
 15120           DFHEIV99,
 15121           DFHEIV99,
 15122           DFHEIV99
 15123     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15124         DFHEIV20
 15125     MOVE EIBRESP  TO WS-RESPONSE
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15127
 15128        IF WS-RESP-NORMAL
 15129           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15130        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 289
* EL156.cbl
 15131           MOVE SPACES           TO  LOANNBO
 15132        END-IF
 15133     END-IF
 15134
 15135*       MOVE PI-LOAN-NO          TO LOANNBO
 15136
 15137     IF CKNUMBO = SPACES
 15138         MOVE SPACES             TO CKNUMHDO.
 15139
 15140     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15141     MOVE CL-CARRIER             TO CARRBO.
 15142     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15143     MOVE CL-CERT-SFX            TO SUFXBO.
 15144
 15145     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15146        EVALUATE CL-CLAIM-TYPE
 15147           WHEN 'I'
 15148              MOVE '  IU  '      TO CLMTYPBO
 15149           WHEN 'G'
 15150              MOVE ' GAP  '      TO CLMTYPBO
 15151           WHEN 'F'
 15152              MOVE ' FMLA '      TO CLMTYPBO
 15153           WHEN OTHER
 15154              MOVE PI-AH-OVERRIDE-L6
 15155                                 TO CLMTYPBO
 15156        END-EVALUATE
 15157        MOVE ZEROS               TO UNDISBO
 15158*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15159        IF PI-PMTTYPE = '5' OR '6'
 15160           GO TO 6073-GET-NOTIFY-DATA
 15161        ELSE
 15162           MOVE PI-DAILY-RATE    TO RATEBO
 15163           GO TO 6073-GET-NOTIFY-DATA.
 15164
 15165     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15166
 15167     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15168        MOVE ZEROS               TO UNDISBO
 15169     ELSE
 15170        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15171
 15172 6073-GET-NOTIFY-DATA.
 15173
 15174     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15175
 15176     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15177         MOVE SPACES             TO  NAMEB2O
 15178                                     ADDR1B2O
 15179                                     ADDR2B2O
 15180                                     CITYST2O
 15181                                     AGTHDGO
 15182         MOVE ZEROS              TO  ZIPB2O
 15183         GO TO 6080-SET-INCURRED.
 15184
 15185     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15186     MOVE +29                    TO  TRLR-SEQ-NO.
 15187
 15188
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 290
* EL156.cbl
 15189* EXEC CICS HANDLE CONDITION
 15190*        NOTFND   (6074-GET-COMP-DATA)
 15191*    END-EXEC.
 15192*    MOVE '"$I                   ! 1 #00014255' TO DFHEIV0
 15193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15195     MOVE X'3120233030303134323535' TO DFHEIV0(25:11)
 15196     CALL 'kxdfhei1' USING DFHEIV0
 15197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15198
 15199
 15200     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15201
 15202     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15203     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15204     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15205*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15206     STRING AT-CITY ' ' AT-STATE
 15207        DELIMITED BY '  ' INTO CITYST2O
 15208     END-STRING
 15209     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15210     GO TO 6080-SET-INCURRED.
 15211
 15212 6074-GET-COMP-DATA.
 15213
 15214     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15215         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15216
 15217     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15218         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15219                                         ADDR1B2O
 15220                                         ADDR2B2O
 15221                                         CITYST2O
 15222         MOVE ZEROS                  TO  ZIPB2O
 15223         GO TO 6080-SET-INCURRED.
 15224
 15225     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15226     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15227     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15228     MOVE AM-GROUPING            TO  COMP-GROUP.
 15229     MOVE 'A'                    TO  COMP-TYPE.
 15230     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15231                                 TO  COMP-FIN-RESP.
 15232
 15233     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15234         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15235                                       'G' OR 'B' or 'S'
 15236             MOVE 'G'            TO  COMP-TYPE
 15237             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15238         ELSE
 15239             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15240                                 TO  COMP-ACCOUNT
 15241     ELSE
 15242         MOVE 'G'                TO  COMP-TYPE
 15243         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15244
 15245     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15246
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 291
* EL156.cbl
 15247     IF COMP-REC-FOUND
 15248         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15249         MOVE CO-ADDR-1          TO  ADDR1B2O
 15250         MOVE CO-ADDR-2          TO  ADDR2B2O
 15251*        MOVE CO-ADDR-3          TO  CITYST2O
 15252         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15253            DELIMITED BY '  ' INTO CITYST2O
 15254         END-STRING
 15255         MOVE CO-ZIP             TO  ZIPB2O
 15256     ELSE
 15257         MOVE 'NO COMP ADDRESS AVAILABLE'
 15258                                 TO  NAMEB2O
 15259                                     ADDR1B2O
 15260                                     ADDR2B2O
 15261                                     CITYST2O
 15262         MOVE ZEROS               TO ZIPB2O.
 15263
 15264 6080-SET-INCURRED.
 15265     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15266     MOVE SPACES                 TO DC-OPTION-CODE.
 15267     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15268     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15269     MOVE PI-PROCESSOR-ID        TO BYBO.
 15270     MOVE MAP-NAMEB              TO MAP-NAME.
 15271     MOVE 'C'                    TO PI-PASS-SW.
 15272     MOVE EIBAID                 TO PI-PFKEY-USED.
 15273     MOVE -1                     TO ENTPFBL.
 15274     GO TO 8100-SEND-INITIAL-MAP.
 15275
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 292
* EL156.cbl
 15277 6100-BUILD-PAYMENT-TRAILER.
 15278
 15279     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15280       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15281         GO TO 6105-STATE-CHECK-NUMBER
 15282     END-IF.
 15283
 15284     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15285     MOVE '6'                    TO CNTL-REC-TYPE.
 15286
 15287     IF CONTROL-IS-ACTUAL-CARRIER
 15288         MOVE PI-CARRIER         TO WS-CARR
 15289     ELSE
 15290         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15291
 15292     IF PI-COMPANY-ID = 'FIA'
 15293         MOVE PI-CARRIER         TO  WS-CARR.
 15294
 15295     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15296     MOVE 0                      TO CNTL-SEQ-NO.
 15297     MOVE 'CARR'                 TO FILE-SWITCH.
 15298
 15299     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15300
 15301     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15302         IF PI-OFFLINE     = 'Y' AND
 15303            PI-ECHECKNO-CR = 'CR'
 15304              GO TO 6110-READ-CONTROL
 15305         ELSE
 15306            IF PI-CASH = 'N'
 15307                GO TO 6110-READ-CONTROL.
 15308
 15309     IF CHECK-NO-MANUAL    OR
 15310        CHECK-NO-AT-PRINT  OR
 15311        PI-OFFLINE = 'Y'
 15312          GO TO 6130-BUILD-TRAILER.
 15313
 15314     IF PI-COMPANY-ID = 'FIA'
 15315         NEXT SENTENCE
 15316     ELSE
 15317         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15318             GO TO 6110-READ-CONTROL.
 15319
 15320     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15321
 15322     IF CHECK-CNT-RESET-VALUE
 15323        MOVE +1                  TO CF-CHECK-COUNTER
 15324     ELSE
 15325        ADD +1                   TO CF-CHECK-COUNTER.
 15326
 15327     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15328
 15329     IF CHECK-NO-CARR-SEQ
 15330        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15331
 15332     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15333
 15334     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 293
* EL156.cbl
 15335     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15336        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15337         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15338         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15339            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15340         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15341                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15342     END-IF.
 15343
 15344     GO TO 6120-REWRITE.
 15345
 15346 6105-STATE-CHECK-NUMBER.
 15347     IF CHECK-NO-MANUAL    OR
 15348        CHECK-NO-AT-PRINT  OR
 15349        PI-OFFLINE = 'Y'
 15350           GO TO 6130-BUILD-TRAILER
 15351     END-IF.
 15352
 15353     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15354     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15355     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15356     MOVE '3'                TO CNTL-REC-TYPE.
 15357     MOVE +0                 TO CNTL-SEQ-NO.
 15358     MOVE 'STAT'             TO FILE-SWITCH.
 15359     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15360
 15361     IF CF-ST-CHECK-CNT-RESET
 15362         MOVE +1             TO CF-ST-CHECK-COUNTER
 15363     ELSE
 15364         ADD +1              TO CF-ST-CHECK-COUNTER
 15365     END-IF.
 15366
 15367     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15368     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15369     GO TO 6120-REWRITE.
 15370
 15371 6110-READ-CONTROL.
 15372     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15373     MOVE '1'                    TO CNTL-REC-TYPE.
 15374     MOVE SPACES                 TO CNTL-ACCESS.
 15375     MOVE 0                      TO CNTL-SEQ-NO.
 15376
 15377     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15378
 15379     IF CO-CHECK-COUNT-RESET
 15380        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15381     ELSE
 15382        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15383
 15384     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15385
 15386     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15387         IF PI-OFFLINE     = 'Y'  AND
 15388            PI-ECHECKNO-CR = 'CR'
 15389              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15390              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15391              MOVE AL-UANON           TO CHECKNOA
 15392              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 294
* EL156.cbl
 15393         ELSE
 15394         IF PI-CASH = 'N'
 15395             MOVE 'N'                TO PI-ECHECKNO-N
 15396             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15397             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15398             MOVE AL-UANON           TO CHECKNOA
 15399             GO TO 6120-REWRITE.
 15400
 15401     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15402
 15403 6120-REWRITE.
 15404
 15405* EXEC CICS REWRITE
 15406*         DATASET('ELCNTL')
 15407*         FROM(CONTROL-FILE)
 15408*     END-EXEC.
 15409     MOVE LENGTH OF
 15410      CONTROL-FILE
 15411       TO DFHEIV11
 15412     MOVE 'ELCNTL' TO DFHEIV1
 15413*    MOVE '&& L                  %   #00014463' TO DFHEIV0
 15414     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15415     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15416     MOVE X'2020233030303134343633' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0,
 15418           DFHEIV1,
 15419           CONTROL-FILE,
 15420           DFHEIV11,
 15421           DFHEIV99
 15422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15423
 15424
 15425     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15426
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 295
* EL156.cbl
 15428 6130-BUILD-TRAILER.
 15429
 15430
 15431* EXEC CICS GETMAIN
 15432*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15433*         LENGTH    (200)
 15434*         INITIMG   (GETMAIN-SPACE)
 15435*     END-EXEC.
 15436     MOVE 200
 15437       TO DFHEIV11
 15438*    MOVE ',"IL                  $   #00014473' TO DFHEIV0
 15439     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15441     MOVE X'2020233030303134343733' TO DFHEIV0(25:11)
 15442     CALL 'kxdfhei1' USING DFHEIV0,
 15443           DFHEIV20,
 15444           DFHEIV11,
 15445           GETMAIN-SPACE
 15446     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15447         DFHEIV20
 15448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15449
 15450
 15451     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15452                                    AT-PREV-PAID-THRU-DT.
 15453     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15454     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15455     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15456     MOVE 'AT'                   TO AT-RECORD-ID.
 15457     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15458
 15459     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15460        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15461           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15462     ELSE
 15463           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15464           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15465
 15466     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15467         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15468             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15469             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15470           ELSE
 15471             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15472             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15473
 15474     MOVE '2'                    TO AT-TRAILER-TYPE.
 15475     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15476                                    AT-PAYMENT-LAST-MAINT-DT.
 15477     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15478                                    AT-PAYMENT-LAST-UPDATED-BY.
 15479     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15480     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15481     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15482     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15483
 15484     IF PI-PMT-APPROVED
 15485        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 296
* EL156.cbl
 15486           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15487
 15488     IF PI-PFKEY-USED = DFHPF5
 15489        GO TO 6140-PF5-ENTERED.
 15490
 15491     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15492     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15493
 15494     IF PI-AIG-SPECIAL-BENEFIT
 15495         IF WS-1ST-SPECIAL-PMT
 15496             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15497             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15498                                        AT-AMOUNT-PAID
 15499         ELSE
 15500             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15501
 15502     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15503
 15504     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15505     MOVE '4'                    TO DC-OPTION-CODE.
 15506     PERFORM 9700-LINK-DATE-CONVERT.
 15507
 15508     IF DATE-CONVERSION-ERROR
 15509        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15510     ELSE
 15511        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15512
 15513     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15514     MOVE '4'                    TO DC-OPTION-CODE.
 15515     PERFORM 9700-LINK-DATE-CONVERT.
 15516
 15517     IF DATE-CONVERSION-ERROR
 15518        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15519     ELSE
 15520        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15521
 15522     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15523     GO TO 6150-FINISH-MOVE.
 15524
 15525 6140-PF5-ENTERED.
 15526     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15527     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15528
 15529     IF PI-AIG-SPECIAL-BENEFIT
 15530         IF WS-1ST-SPECIAL-PMT
 15531             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15532             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15533                                        AT-AMOUNT-PAID
 15534         ELSE
 15535             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15536
 15537     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15538     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15539     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15540
 15541 6150-FINISH-MOVE.
 15542
 15543     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 297
* EL156.cbl
 15544         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15545     ELSE
 15546         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15547
 15548     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15549     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15550
 15551*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15552*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15553
 15554     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15555         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15556
 15557     IF PI-OFFLINE = 'N'
 15558        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15559        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15560     ELSE
 15561        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15562        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15563
 15564     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15565
 15566     IF WS-2ND-SPECIAL-PMT
 15567         MOVE 'Y'                TO AT-CASH-PAYMENT
 15568         MOVE SPACES             TO AT-CHECK-NO
 15569         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15570         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15571         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15572         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15573
 15574     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15575                                    AT-TO-BE-WRITTEN-DT.
 15576
 15577     IF PI-HOLDTIL NOT = ZEROS
 15578        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15579        MOVE '4'                 TO DC-OPTION-CODE
 15580        PERFORM 9700-LINK-DATE-CONVERT
 15581        IF PI-OFFLINE = 'N'
 15582           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15583        ELSE
 15584           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15585
 15586     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15587     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15588                                    AT-CHECK-QUE-SEQUENCE.
 15589
 15590     IF PI-PFKEY-USED = DFHPF4
 15591        MOVE '1'                 TO AT-FORCE-CONTROL.
 15592
 15593     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15594        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15595        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15596        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15597
 15598     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15599                                    AT-VOID-SELECT-DT
 15600                                    AT-VOID-ACCEPT-DT
 15601                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 298
* EL156.cbl
 15602     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15603        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15604        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15605        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15606        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15607     ELSE
 15608        MOVE ZEROS               TO AT-DAILY-RATE
 15609                                    AT-ELIMINATION-DAYS
 15610        MOVE SPACES              TO AT-BENEFIT-TYPE
 15611     END-IF
 15612     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15613     MOVE '4'                    TO DC-OPTION-CODE.
 15614     PERFORM 9700-LINK-DATE-CONVERT.
 15615     IF DATE-CONVERSION-ERROR
 15616         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15617     ELSE
 15618         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15619     END-IF.
 15620     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15621     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15622     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15623     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15624     IF (PI-REAUDIT-NEEDED = 'Y')
 15625        or (pi-max-ext-used = 'Y')
 15626        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15627         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15628         MOVE 'Y' TO WS-NEED-APPROVAL
 15629         GO TO 6170-WRITE
 15630     END-IF.
 15631*******************************************************
 15632     IF NOT PI-PMT-GRADUATED
 15633         GO TO 6170-WRITE.
 15634
 15635     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15636     MOVE '1'                    TO CNTL-REC-TYPE.
 15637     MOVE SPACES                 TO CNTL-ACCESS.
 15638     MOVE +0                     TO CNTL-SEQ-NO.
 15639     MOVE 'COMP'                 TO FILE-SWITCH.
 15640
 15641     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15642
 15643     IF PAID-FOR-LIFE
 15644         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15645             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15646                                     WS-PMT-APPROVAL-SW
 15647             GO TO 6170-WRITE.
 15648
 15649*05999      IF PAID-FOR-AH
 15650     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15651         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15652             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15653                                     WS-PMT-APPROVAL-SW
 15654             GO TO 6170-WRITE.
 15655
 15656     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15657
 15658******A&H Limits are set as a monthly payment.  Calculate the mont
 15659******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 299
* EL156.cbl
 15660     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15661        PI-SAVE-ODD-DAYS-OVER > 0
 15662           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15663                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15664           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15665                                  WS-CALC-PMT-MONTHS
 15666     ELSE
 15667           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15668     END-IF.
 15669*06007      IF ((PAID-FOR-AH) AND
 15670     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15671*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15672        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15673              OR
 15674        ((PAID-FOR-LIFE) AND
 15675        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15676            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15677       ELSE
 15678*06014      IF ((PAID-FOR-AH)  AND
 15679         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15680*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15681           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15682              OR
 15683        ((PAID-FOR-LIFE) AND
 15684        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15685            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15686         ELSE
 15687*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15688           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15689               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15690              OR
 15691          ((PAID-FOR-LIFE) AND
 15692          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15693            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15694       ELSE
 15695           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15696               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15697              OR
 15698          ((PAID-FOR-LIFE) AND
 15699          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15700            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15701       ELSE
 15702            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15703
 15704     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15705        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15706        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15707            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15708        END-IF
 15709     ELSE
 15710     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15711        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15712        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15713            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15714        END-IF
 15715     ELSE
 15716     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15717        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 300
* EL156.cbl
 15718        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15719            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15720        END-IF
 15721     ELSE
 15722     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15723        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15724        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15725            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15726        END-IF
 15727     ELSE
 15728     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15729            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15730
 15731     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15732
 15733     IF NOT PI-PMT-GRADUATED
 15734         GO TO 6170-WRITE.
 15735
 15736
 15737* EXEC CICS HANDLE CONDITION
 15738*        NOTFND   (6170-WRITE)
 15739*    END-EXEC.
 15740*    MOVE '"$I                   ! 2 #00014764' TO DFHEIV0
 15741     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15742     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15743     MOVE X'3220233030303134373634' TO DFHEIV0(25:11)
 15744     CALL 'kxdfhei1' USING DFHEIV0
 15745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15746
 15747
 15748     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15749     MOVE '2'                    TO CNTL-REC-TYPE.
 15750     MOVE +0                     TO CNTL-SEQ-NO.
 15751     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15752
 15753
 15754* EXEC CICS READ
 15755*         DATASET  ('ELCNTL')
 15756*         SET      (ADDRESS OF CONTROL-FILE)
 15757*         RIDFLD   (ELCNTL-KEY)
 15758*    END-EXEC.
 15759     MOVE 'ELCNTL' TO DFHEIV1
 15760*    MOVE '&"S        E          (   #00014773' TO DFHEIV0
 15761     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15763     MOVE X'2020233030303134373733' TO DFHEIV0(25:11)
 15764     CALL 'kxdfhei1' USING DFHEIV0,
 15765           DFHEIV1,
 15766           DFHEIV20,
 15767           DFHEIV99,
 15768           ELCNTL-KEY,
 15769           DFHEIV99,
 15770           DFHEIV99,
 15771           DFHEIV99
 15772     SET ADDRESS OF CONTROL-FILE TO
 15773         DFHEIV20
 15774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15775
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 301
* EL156.cbl
 15776
 15777     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15778
 15779     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15780                         OR '4' OR '5'
 15781         NEXT SENTENCE
 15782     ELSE
 15783         MOVE 'Y' TO WS-NEED-APPROVAL
 15784         GO TO 6170-WRITE.
 15785
 15786     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15787         MOVE 'Y' TO WS-NEED-APPROVAL
 15788         IF WS-APPROVAL-LEVEL = '1'
 15789             MOVE '2'        TO  AT-APPROVED-LEVEL
 15790                            WS-SAVE-APPROVED-LEVEL
 15791             GO TO 6170-WRITE
 15792         ELSE
 15793             IF WS-APPROVAL-LEVEL = '2'
 15794                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15795                                WS-SAVE-APPROVED-LEVEL
 15796                 GO TO 6170-WRITE
 15797             ELSE IF WS-APPROVAL-LEVEL = '3'
 15798                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15799                                WS-SAVE-APPROVED-LEVEL
 15800                 GO TO 6170-WRITE
 15801             ELSE IF WS-APPROVAL-LEVEL = '4'
 15802                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15803                                WS-SAVE-APPROVED-LEVEL
 15804                 GO TO 6170-WRITE.
 15805
 15806     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15807                             WS-PMT-APPROVAL-SW.
 15808     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15809                             AT-APPROVAL-LEVEL-REQD.
 15810
 15811*******************************************************
 15812
 15813 6170-WRITE.
 15814
 15815     if pi-company-id = 'DCC'
 15816        PERFORM 0900-GET-DDF-limits
 15817                                 THRU 0900-EXIT
 15818     end-if
 15819     perform 2220-update-elcrtt  thru 2220-exit
 15820     IF PI-COMPANY-ID = 'DMD'
 15821        IF PI-AT-EOB-CODES NOT = SPACES
 15822           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15823           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15824           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15825           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15826           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15827
 15828
 15829* EXEC CICS HANDLE CONDITION
 15830*        DUPREC    (6180-DUPREC)
 15831*    END-EXEC.
 15832*    MOVE '"$%                   ! 3 #00014830' TO DFHEIV0
 15833     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 302
* EL156.cbl
 15834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15835     MOVE X'3320233030303134383330' TO DFHEIV0(25:11)
 15836     CALL 'kxdfhei1' USING DFHEIV0
 15837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15838
 15839
 15840
 15841* EXEC CICS WRITE
 15842*         DATASET       ('ELTRLR')
 15843*         FROM          (ACTIVITY-TRAILERS)
 15844*         RIDFLD        (AT-CONTROL-PRIMARY)
 15845*     END-EXEC.
 15846     MOVE LENGTH OF
 15847      ACTIVITY-TRAILERS
 15848       TO DFHEIV11
 15849     MOVE 'ELTRLR' TO DFHEIV1
 15850*    MOVE '&$ L                  ''   #00014834' TO DFHEIV0
 15851     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15853     MOVE X'2020233030303134383334' TO DFHEIV0(25:11)
 15854     CALL 'kxdfhei1' USING DFHEIV0,
 15855           DFHEIV1,
 15856           ACTIVITY-TRAILERS,
 15857           DFHEIV11,
 15858           AT-CONTROL-PRIMARY,
 15859           DFHEIV99,
 15860           DFHEIV99
 15861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15862
 15863
 15864     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15865        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15866*06088           GO TO 6199-EXIT.
 15867           GO TO 6176-APPROVAL-NOTE.
 15868
 15869
 15870* EXEC CICS GETMAIN
 15871*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15872*         LENGTH    (200)
 15873*         INITIMG   (GETMAIN-SPACE)
 15874*     END-EXEC.
 15875     MOVE 200
 15876       TO DFHEIV11
 15877*    MOVE ',"IL                  $   #00014845' TO DFHEIV0
 15878     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15880     MOVE X'2020233030303134383435' TO DFHEIV0(25:11)
 15881     CALL 'kxdfhei1' USING DFHEIV0,
 15882           DFHEIV20,
 15883           DFHEIV11,
 15884           GETMAIN-SPACE
 15885     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15886         DFHEIV20
 15887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15888
 15889
 15890     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15891
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 303
* EL156.cbl
 15892     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15893     MOVE 'AT'                   TO AT-RECORD-ID.
 15894     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15895     MOVE '6'                    TO AT-TRAILER-TYPE.
 15896     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15897                                    AT-GEN-INFO-LAST-MAINT-DT
 15898     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15899                                    AT-GEN-INFO-LAST-UPDATED-BY
 15900     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15901
 15902     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15903     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15904     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15905
 15906     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15907
 15908 6175-WRITE.
 15909
 15910
 15911* EXEC CICS HANDLE CONDITION
 15912*        DUPREC    (6190-DUPREC)
 15913*    END-EXEC.
 15914*    MOVE '"$%                   ! 4 #00014871' TO DFHEIV0
 15915     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15917     MOVE X'3420233030303134383731' TO DFHEIV0(25:11)
 15918     CALL 'kxdfhei1' USING DFHEIV0
 15919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15920
 15921
 15922
 15923* EXEC CICS WRITE
 15924*         DATASET     ('ELTRLR')
 15925*         FROM        (ACTIVITY-TRAILERS)
 15926*         RIDFLD      (AT-CONTROL-PRIMARY)
 15927*     END-EXEC.
 15928     MOVE LENGTH OF
 15929      ACTIVITY-TRAILERS
 15930       TO DFHEIV11
 15931     MOVE 'ELTRLR' TO DFHEIV1
 15932*    MOVE '&$ L                  ''   #00014875' TO DFHEIV0
 15933     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15934     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15935     MOVE X'2020233030303134383735' TO DFHEIV0(25:11)
 15936     CALL 'kxdfhei1' USING DFHEIV0,
 15937           DFHEIV1,
 15938           ACTIVITY-TRAILERS,
 15939           DFHEIV11,
 15940           AT-CONTROL-PRIMARY,
 15941           DFHEIV99,
 15942           DFHEIV99
 15943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15944
 15945
 15946 6176-APPROVAL-NOTE.
 15947
 15948     IF NOT APPROVAL-NEEDED
 15949         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 304
* EL156.cbl
 15950
 15951
 15952* EXEC CICS GETMAIN
 15953*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15954*        LENGTH    (200)
 15955*        INITIMG   (GETMAIN-SPACE)
 15956*    END-EXEC.
 15957     MOVE 200
 15958       TO DFHEIV11
 15959*    MOVE ',"IL                  $   #00014886' TO DFHEIV0
 15960     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15961     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15962     MOVE X'2020233030303134383836' TO DFHEIV0(25:11)
 15963     CALL 'kxdfhei1' USING DFHEIV0,
 15964           DFHEIV20,
 15965           DFHEIV11,
 15966           GETMAIN-SPACE
 15967     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15968         DFHEIV20
 15969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15970
 15971
 15972     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15973
 15974     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15975     MOVE 'AT'               TO AT-RECORD-ID
 15976     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15977     MOVE '6'                TO AT-TRAILER-TYPE
 15978     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15979                                AT-GEN-INFO-LAST-MAINT-DT
 15980     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15981                                AT-GEN-INFO-LAST-UPDATED-BY
 15982     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15983
 15984     IF PI-REAUDIT-NEEDED = 'Y'
 15985         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15986     ELSE
 15987         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15988     END-IF
 15989     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15990         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15991     END-IF
 15992     MOVE SPACES             TO AT-INFO-LINE-2
 15993
 15994     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15995 6177-WRITE.
 15996
 15997
 15998* EXEC CICS HANDLE CONDITION
 15999*        DUPREC    (6185-DUPREC)
 16000*    END-EXEC.
 16001*    MOVE '"$%                   ! 5 #00014917' TO DFHEIV0
 16002     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16004     MOVE X'3520233030303134393137' TO DFHEIV0(25:11)
 16005     CALL 'kxdfhei1' USING DFHEIV0
 16006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16007
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 305
* EL156.cbl
 16008
 16009
 16010* EXEC CICS WRITE
 16011*         DATASET     ('ELTRLR')
 16012*         FROM        (ACTIVITY-TRAILERS)
 16013*         RIDFLD      (AT-CONTROL-PRIMARY)
 16014*     END-EXEC.
 16015     MOVE LENGTH OF
 16016      ACTIVITY-TRAILERS
 16017       TO DFHEIV11
 16018     MOVE 'ELTRLR' TO DFHEIV1
 16019*    MOVE '&$ L                  ''   #00014921' TO DFHEIV0
 16020     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16022     MOVE X'2020233030303134393231' TO DFHEIV0(25:11)
 16023     CALL 'kxdfhei1' USING DFHEIV0,
 16024           DFHEIV1,
 16025           ACTIVITY-TRAILERS,
 16026           DFHEIV11,
 16027           AT-CONTROL-PRIMARY,
 16028           DFHEIV99,
 16029           DFHEIV99
 16030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16031
 16032
 16033
 16034     GO TO 6199-EXIT.
 16035
 16036 6180-DUPREC.
 16037
 16038     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16039     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16040     GO TO 6170-WRITE.
 16041
 16042 6185-DUPREC.
 16043     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16044     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16045     GO TO 6177-WRITE.
 16046
 16047 6190-DUPREC.
 16048     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16049     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16050     GO TO 6175-WRITE.
 16051
 16052 6199-EXIT.
 16053      EXIT.
 16054
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 306
* EL156.cbl
 16056 6200-UPDATE-CLAIM-MSTR.
 16057     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16058     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16059     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16060     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16061
 16062     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16063
 16064     MOVE ZEROS                  TO W-INTEREST.
 16065
 16066     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16067        IF (PI-OFFLINE = 'Y') OR
 16068           (PI-PMTTYPE = '7')
 16069           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16070                                 THRU 9870-EXIT
 16071        END-IF
 16072     END-IF
 16073     IF NOT ERROR-ON-OUTPUT
 16074        CONTINUE
 16075     ELSE
 16076
 16077* EXEC CICS REWRITE
 16078*          DATASET('ELMSTR')
 16079*          FROM(CLAIM-MASTER)
 16080*       END-EXEC
 16081     MOVE LENGTH OF
 16082      CLAIM-MASTER
 16083       TO DFHEIV11
 16084     MOVE 'ELMSTR' TO DFHEIV1
 16085*    MOVE '&& L                  %   #00014970' TO DFHEIV0
 16086     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16087     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16088     MOVE X'2020233030303134393730' TO DFHEIV0(25:11)
 16089     CALL 'kxdfhei1' USING DFHEIV0,
 16090           DFHEIV1,
 16091           CLAIM-MASTER,
 16092           DFHEIV11,
 16093           DFHEIV99
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16095
 16096        MOVE -1                  TO ENTPFBL
 16097        MOVE AL-UANON            TO ENTPFBA
 16098        MOVE MAP-NAMEB           TO MAP-NAME
 16099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16100        GO TO 8200-SEND-DATAONLY
 16101     END-IF
 16102
 16103     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16104
 16105     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16106
 16107     IF PI-AIG-SPECIAL-BENEFIT
 16108         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16109
 16110     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16111
 16112     IF PI-SPECIAL-BEN-SW = 'Y'
 16113         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 307
* EL156.cbl
 16114         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16115
 16116     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16117         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16118     ELSE
 16119         IF PI-PMTTYPE NOT = '4'
 16120            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16121
 16122     IF PI-PMTTYPE = '5' OR '6'
 16123        GO TO  6250-SET-MAINT.
 16124
 16125     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16126                                         CL-LAG-REPORT-CODE.
 16127
 16128     IF CL-ACTIVITY-CODE = 09
 16129         GO TO 6200-CONT-UPDATE.
 16130
 16131     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16132         IF CL-ACTIVITY-CODE = 11
 16133             GO TO 6200-CONT-UPDATE.
 16134
 16135     IF WS-ACT-REC-FOUND-SW = 'N'
 16136         GO TO 6200-CONT-UPDATE.
 16137
 16138     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16139         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16140         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16141         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16142
 16143     IF WS-UPDATE-SW = 'Y'
 16144         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16145                                         CL-NEXT-FOLLOWUP-DT.
 16146
 16147 6200-CONT-UPDATE.
 16148
 16149     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16150       IF CLAIM-IS-CLOSED
 16151         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16152           IF WS-OPEN-CLOSE-SW = '2'
 16153             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16154                                        CL-LAST-CLOSE-DT.
 16155
 16156     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16157        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16158        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16159
 16160     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16161        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16162        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16163        MOVE 'C'                 TO CL-CLAIM-STATUS
 16164        IF PI-PMTTYPE = '2'
 16165           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16166              or 'F')
 16167           CONTINUE
 16168        ELSE
 16169           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16170        END-IF
 16171     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 308
* EL156.cbl
 16172        IF PI-PMTTYPE = '2' OR '3'
 16173           IF PI-PMTTYPE = '2' AND
 16174              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16175                 or 'F')
 16176              CONTINUE
 16177           ELSE
 16178              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16179           END-IF
 16180        END-IF
 16181     END-IF
 16182
 16183     IF PI-PMTTYPE = '4'
 16184        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16185
 16186     IF PI-COMPANY-ID = 'CVL'
 16187         IF PI-LOAN-UPDATE-SW = 'Y'
 16188             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16189             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16190             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16191             MOVE CL-CERT-STATE      TO  CERT-STATE
 16192             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16193             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16194             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16195             MOVE 'CERT'             TO  FILE-SWITCH
 16196             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16197             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16198             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16199
 16200     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16201        GO TO 6220-USE-COMPUTED.
 16202
 16203     IF (PI-PMTTYPE = '4')  AND
 16204        (PI-EPYAMT < ZEROS)
 16205          COMPUTE CL-NO-OF-DAYS-PAID =
 16206                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16207          IF CL-NO-OF-DAYS-PAID < +0
 16208              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16209          ELSE
 16210              NEXT SENTENCE
 16211     ELSE
 16212          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16213
 16214     IF PI-PROCESSOR-ID = 'FIX '
 16215        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16216           NEXT SENTENCE
 16217        ELSE
 16218           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16219     ELSE
 16220        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16221
 16222     IF PI-PMTTYPE = '4'
 16223        GO TO 6250-SET-MAINT.
 16224
 16225     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16226
 16227     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16228     MOVE '4'                    TO DC-OPTION-CODE.
 16229     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 309
* EL156.cbl
 16230     IF DATE-CONVERSION-ERROR
 16231        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16232     ELSE
 16233        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16234           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16235           IF PI-AIG-SPECIAL-BENEFIT
 16236               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16237           ELSE
 16238               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16239
 16240     GO TO 6250-SET-MAINT.
 16241
 16242 6220-USE-COMPUTED.
 16243
 16244     IF (PI-PMTTYPE = '4')  AND
 16245        (PI-CPYAMT < ZEROS)
 16246          COMPUTE CL-NO-OF-DAYS-PAID =
 16247                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16248          IF CL-NO-OF-DAYS-PAID < +0
 16249              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16250          ELSE
 16251              NEXT SENTENCE
 16252     ELSE
 16253          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16254
 16255     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16256
 16257     IF PI-PMTTYPE = '4'
 16258        GO TO 6250-SET-MAINT.
 16259
 16260     IF PI-AIG-SPECIAL-BENEFIT
 16261         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16262     ELSE
 16263         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16264
 16265     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16266
 16267     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16268        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16269
 16270 6250-SET-MAINT.
 16271     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16272
 16273     IF PI-PROCESSOR-ID = 'FIX '
 16274        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16275           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16276        ELSE
 16277           NEXT SENTENCE
 16278     ELSE
 16279        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16280
 16281     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16282     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16283     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16284
 16285 6299-EXIT.
 16286      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 310
* EL156.cbl
 16288 6300-UPDATE-CERT.
 16289
 16290*  ADD CERTNOTE FOR SC NP+6
 16291     IF PI-COMPANY-ID = 'CID' AND
 16292       (PI-PMTTYPE = '2' OR '3') AND
 16293        CL-CERT-STATE = 'SC'  AND
 16294        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16295           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16296     END-IF.
 16297
 16298     IF PI-COMPANY-ID = 'AHL' AND
 16299       (PI-PMTTYPE = '2' OR '3') AND
 16300        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16301           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16302           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16303     END-IF.
 16304
 16305     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16306     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16307     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16308     MOVE CL-CERT-STATE    TO CERT-STATE.
 16309     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16310     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16311     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16312     MOVE 'CERT'           TO FILE-SWITCH.
 16313
 16314     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16315
 16316     IF CERT-NOTE-ADDED
 16317        IF CM-NOTE-SW = ' '
 16318           MOVE '4'             TO CM-NOTE-SW
 16319        ELSE
 16320           IF CM-NOTE-SW = '1'
 16321               MOVE '5'           TO CM-NOTE-SW
 16322           ELSE
 16323              IF CM-NOTE-SW = '2'
 16324                 MOVE '6'         TO CM-NOTE-SW
 16325              ELSE
 16326                 IF CM-NOTE-SW = '3'
 16327                    MOVE '7'      TO CM-NOTE-SW
 16328                 END-IF
 16329              END-IF
 16330           END-IF
 16331        END-IF
 16332     END-IF.
 16333
 16334     IF PI-COMPANY-ID = 'CVL'
 16335         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16336         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16337
 16338     IF PI-PMTTYPE NOT = '4'
 16339        GO TO 6340-UPDATE-CERT.
 16340
 16341     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16342        IF PI-PFKEY-USED = DFHPF5
 16343           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16344        ELSE
 16345           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 311
* EL156.cbl
 16346
 16347*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16348*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16349*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16350*               PI-LF-COVERAGE-TYPE = 'P'
 16351*                GO TO 6350-REWRITE-CERT.
 16352
 16353     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16354       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16355          PI-LF-COVERAGE-TYPE = 'P'
 16356           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16357                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16358                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16359                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16360                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16361                GO TO 6350-REWRITE-CERT
 16362            ELSE
 16363                GO TO 6350-REWRITE-CERT.
 16364
 16365     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16366         GO TO 6350-REWRITE-CERT.
 16367
 16368     IF NOT CM-AH-LUMP-SUM-DISAB
 16369        GO TO 6380-UNLOCK-CERT.
 16370
 16371     IF PI-PFKEY-USED = DFHPF5
 16372        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16373                                    CM-AH-ITD-AH-PMT
 16374        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16375        GO TO 6350-REWRITE-CERT
 16376     ELSE
 16377        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16378                                    CM-AH-ITD-AH-PMT
 16379        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16380        GO TO 6350-REWRITE-CERT.
 16381
 16382 6340-UPDATE-CERT.
 16383
 16384     IF CL-CLAIM-TYPE = 'L'
 16385         IF PI-PFKEY-USED = DFHPF5
 16386             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16387         ELSE
 16388             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16389
 16390     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16391         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16392             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16393                PI-LF-COVERAGE-TYPE = 'P'
 16394                 GO TO 6350-REWRITE-CERT.
 16395
 16396     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16397       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16398          PI-LF-COVERAGE-TYPE = 'P'
 16399           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16400                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16401                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16402                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16403                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 312
* EL156.cbl
 16404                GO TO 6350-REWRITE-CERT.
 16405
 16406     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16407         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16408            PI-LF-COVERAGE-TYPE NOT = 'P'
 16409             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16410             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16411             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16412             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16413             GO TO 6350-REWRITE-CERT.
 16414
 16415     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16416         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16417         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16418         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16419         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16420         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16421         IF PI-PFKEY-USED = DFHPF5
 16422             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16423                                        CM-AH-ITD-AH-PMT
 16424             GO TO 6350-REWRITE-CERT
 16425         ELSE
 16426             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16427                                        CM-AH-ITD-AH-PMT
 16428             GO TO 6350-REWRITE-CERT.
 16429
 16430 6350-REWRITE-CERT.
 16431
 16432
 16433* EXEC CICS REWRITE
 16434*         DATASET  ('ELCERT')
 16435*         FROM(CERTIFICATE-MASTER)
 16436*     END-EXEC.
 16437     MOVE LENGTH OF
 16438      CERTIFICATE-MASTER
 16439       TO DFHEIV11
 16440     MOVE 'ELCERT' TO DFHEIV1
 16441*    MOVE '&& L                  %   #00015311' TO DFHEIV0
 16442     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16443     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16444     MOVE X'2020233030303135333131' TO DFHEIV0(25:11)
 16445     CALL 'kxdfhei1' USING DFHEIV0,
 16446           DFHEIV1,
 16447           CERTIFICATE-MASTER,
 16448           DFHEIV11,
 16449           DFHEIV99
 16450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16451
 16452
 16453     GO TO 6399-EXIT.
 16454
 16455 6380-UNLOCK-CERT.
 16456
 16457* EXEC CICS UNLOCK
 16458*         DATASET  ('ELCERT')
 16459*     END-EXEC.
 16460     MOVE 'ELCERT' TO DFHEIV1
 16461*    MOVE '&*                    #   #00015319' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 313
* EL156.cbl
 16462     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16463     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16464     MOVE X'2020233030303135333139' TO DFHEIV0(25:11)
 16465     CALL 'kxdfhei1' USING DFHEIV0,
 16466           DFHEIV1,
 16467           DFHEIV99
 16468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16469
 16470
 16471 6399-EXIT.
 16472      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 314
* EL156.cbl
 16474 6400-UPDATE-ZERO-TRAILER.
 16475     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16476     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16477
 16478     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16479
 16480     IF PI-EPYAMT NOT = ZEROS
 16481         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16482     ELSE
 16483         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16484
 16485     IF PI-ERESV NOT = ZEROS
 16486        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16487
 16488     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16489        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16490
 16491     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16492        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16493     ELSE
 16494        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16495
 16496     IF PI-PMTTYPE = '5'
 16497        IF PI-EPYAMT = ZEROS
 16498           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16499        ELSE
 16500           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16501
 16502     IF PI-PMTTYPE = '6'
 16503        IF PI-EPYAMT = ZEROS
 16504           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16505        ELSE
 16506           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16507
 16508 6420-CHECK-OPEN-CLOSE.
 16509     IF PI-PMTTYPE = '5' OR '6'
 16510        GO TO 6450-REWRITE.
 16511
 16512     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16513         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16514             IF CLAIM-IS-CLOSED
 16515                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16516                 MOVE 1          TO  SUB-1
 16517                 GO TO 6440-AIG-LOOP.
 16518
 16519     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16520        GO TO 6450-REWRITE.
 16521
 16522     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16523        GO TO 6450-REWRITE.
 16524
 16525     MOVE 1                      TO SUB-1.
 16526
 16527 6430-LOOP.
 16528     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16529        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16530        IF PI-PMTTYPE = '1' OR '4'
 16531           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 315
* EL156.cbl
 16532           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16533           GO TO 6450-REWRITE
 16534        ELSE
 16535           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16536           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16537           GO TO 6450-REWRITE.
 16538
 16539     IF SUB-1 = 6
 16540      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16541      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16542      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16543      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16544      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16545      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16546      GO TO 6430-LOOP.
 16547
 16548     ADD 1                       TO SUB-1.
 16549     GO TO 6430-LOOP.
 16550
 16551
 16552 6440-AIG-LOOP.
 16553
 16554     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16555       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16556       IF WS-OPEN-CLOSE-SW = '1'
 16557         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16558         IF PI-PMTTYPE = '2'
 16559           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16560           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16561         ELSE
 16562           IF PI-PMTTYPE = '3'
 16563             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16564             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16565           ELSE
 16566             IF PI-PMTTYPE = '4'
 16567               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16568               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16569             ELSE
 16570               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16571               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16572       ELSE
 16573         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16574         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16575         GO TO 6450-REWRITE.
 16576
 16577     IF SUB-1 = 6
 16578      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16579      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16580      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16581      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16582      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16583      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16584      GO TO 6440-AIG-LOOP.
 16585
 16586     ADD 1                       TO SUB-1.
 16587     GO TO 6440-AIG-LOOP.
 16588
 16589 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 316
* EL156.cbl
 16590     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16591     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16592     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16593
 16594     IF PI-COMPANY-ID = 'DMD'
 16595         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16596         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16597         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16598         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16599         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16600
 16601
 16602* EXEC CICS REWRITE
 16603*         DATASET  ('ELTRLR')
 16604*         FROM     (ACTIVITY-TRAILERS)
 16605*     END-EXEC.
 16606     MOVE LENGTH OF
 16607      ACTIVITY-TRAILERS
 16608       TO DFHEIV11
 16609     MOVE 'ELTRLR' TO DFHEIV1
 16610*    MOVE '&& L                  %   #00015453' TO DFHEIV0
 16611     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16612     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16613     MOVE X'2020233030303135343533' TO DFHEIV0(25:11)
 16614     CALL 'kxdfhei1' USING DFHEIV0,
 16615           DFHEIV1,
 16616           ACTIVITY-TRAILERS,
 16617           DFHEIV11,
 16618           DFHEIV99
 16619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16620
 16621
 16622 6499-EXIT.
 16623      EXIT.
 16624
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 317
* EL156.cbl
 16626 6500-READ-DLO035.
 16627     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16628     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16629     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16630     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16631
 16632
 16633* EXEC CICS LINK
 16634*        PROGRAM    ('DLO035')
 16635*        COMMAREA   (DLO035-KEY)
 16636*        LENGTH     (DL35-LENGTH)
 16637*    END-EXEC.
 16638     MOVE 'DLO035' TO DFHEIV1
 16639*    MOVE '."C                   (   #00015468' TO DFHEIV0
 16640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16642     MOVE X'2020233030303135343638' TO DFHEIV0(25:11)
 16643     CALL 'kxdfhei1' USING DFHEIV0,
 16644           DFHEIV1,
 16645           DLO035-KEY,
 16646           DL35-LENGTH,
 16647           DFHEIV99,
 16648           DFHEIV99,
 16649           DFHEIV99,
 16650           DFHEIV99
 16651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16652
 16653
 16654     IF DL35-RETURN-CODE = 'OK'
 16655         GO TO 6500-EXIT.
 16656
 16657     IF DL35-RETURN-CODE = '01'
 16658         MOVE ER-7830            TO EMI-ERROR
 16659         GO TO 6500-BAD-EXIT.
 16660
 16661     IF DL35-RETURN-CODE = '02'
 16662         MOVE ER-7831            TO EMI-ERROR
 16663         GO TO 6500-BAD-EXIT.
 16664
 16665     IF DL35-RETURN-CODE = '03'
 16666         MOVE ER-7832            TO EMI-ERROR
 16667         GO TO 6500-BAD-EXIT.
 16668
 16669     IF DL35-RETURN-CODE = '04'
 16670         MOVE ER-7833            TO EMI-ERROR
 16671         GO TO 6500-BAD-EXIT.
 16672
 16673     IF DL35-RETURN-CODE = '05'
 16674         MOVE ER-7834            TO EMI-ERROR
 16675         GO TO 6500-BAD-EXIT.
 16676
 16677     IF DL35-RETURN-CODE = '06'
 16678         MOVE ER-7835            TO EMI-ERROR
 16679         GO TO 6500-BAD-EXIT.
 16680
 16681     IF DL35-RETURN-CODE = '07'
 16682         MOVE ER-7836            TO EMI-ERROR
 16683         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 318
* EL156.cbl
 16684
 16685     IF DL35-RETURN-CODE = 'E1'
 16686         MOVE ER-7837            TO EMI-ERROR
 16687         GO TO 6500-BAD-EXIT.
 16688
 16689     IF DL35-RETURN-CODE NOT = 'OK'
 16690         MOVE ER-7838            TO EMI-ERROR
 16691         GO TO 6500-BAD-EXIT.
 16692
 16693 6500-EXIT.
 16694      EXIT.
 16695
 16696 6500-BAD-EXIT.
 16697
 16698* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16699*    MOVE '6"R                   !   #00015517' TO DFHEIV0
 16700     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16702     MOVE X'2020233030303135353137' TO DFHEIV0(25:11)
 16703     CALL 'kxdfhei1' USING DFHEIV0
 16704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16705
 16706     MOVE -1                 TO PMTTYPEL.
 16707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16708     GO TO 8200-SEND-DATAONLY.
 16709
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 319
* EL156.cbl
 16711 6600-UPDATE-DLO035.
 16712     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16713     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16714     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16715     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16716
 16717
 16718* EXEC CICS LINK
 16719*        PROGRAM    ('DLO035')
 16720*        COMMAREA   (DLO035-KEY)
 16721*        LENGTH     (DL35-LENGTH)
 16722*    END-EXEC.
 16723     MOVE 'DLO035' TO DFHEIV1
 16724*    MOVE '."C                   (   #00015529' TO DFHEIV0
 16725     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16727     MOVE X'2020233030303135353239' TO DFHEIV0(25:11)
 16728     CALL 'kxdfhei1' USING DFHEIV0,
 16729           DFHEIV1,
 16730           DLO035-KEY,
 16731           DL35-LENGTH,
 16732           DFHEIV99,
 16733           DFHEIV99,
 16734           DFHEIV99,
 16735           DFHEIV99
 16736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16737
 16738
 16739     IF DL35-RETURN-CODE = 'OK'
 16740         GO TO 6600-EXIT.
 16741
 16742     IF DL35-RETURN-CODE = '01'
 16743         MOVE ER-7830            TO EMI-ERROR
 16744         GO TO 6500-BAD-EXIT.
 16745
 16746     IF DL35-RETURN-CODE = '02'
 16747         MOVE ER-7831            TO EMI-ERROR
 16748         GO TO 6500-BAD-EXIT.
 16749
 16750     IF DL35-RETURN-CODE = '03'
 16751         MOVE ER-7832            TO EMI-ERROR
 16752         GO TO 6500-BAD-EXIT.
 16753
 16754     IF DL35-RETURN-CODE = '04'
 16755         MOVE ER-7833            TO EMI-ERROR
 16756         GO TO 6500-BAD-EXIT.
 16757
 16758     IF DL35-RETURN-CODE = '05'
 16759         MOVE ER-7834            TO EMI-ERROR
 16760         GO TO 6500-BAD-EXIT.
 16761
 16762     IF DL35-RETURN-CODE = '06'
 16763         MOVE ER-7835            TO EMI-ERROR
 16764         GO TO 6500-BAD-EXIT.
 16765
 16766     IF DL35-RETURN-CODE = '07'
 16767         MOVE ER-7836            TO EMI-ERROR
 16768         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 320
* EL156.cbl
 16769
 16770     IF DL35-RETURN-CODE = 'E1'
 16771         MOVE ER-7837            TO EMI-ERROR
 16772         GO TO 6500-BAD-EXIT.
 16773
 16774     IF DL35-RETURN-CODE NOT = 'OK'
 16775         MOVE ER-7838            TO EMI-ERROR
 16776         GO TO 6500-BAD-EXIT.
 16777
 16778 6600-EXIT.
 16779      EXIT.
 16780
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 321
* EL156.cbl
 16782 6700-UPDATE-ACTQ.
 16783***************************************************************
 16784*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16785*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16786*    ONE ALREADY THERE.                                       *
 16787***************************************************************
 16788
 16789
 16790* EXEC CICS HANDLE CONDITION
 16791*         NOTFND(6720-BUILD-NEW-RECORD)
 16792*     END-EXEC.
 16793*    MOVE '"$I                   ! 6 #00015585' TO DFHEIV0
 16794     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16795     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16796     MOVE X'3620233030303135353835' TO DFHEIV0(25:11)
 16797     CALL 'kxdfhei1' USING DFHEIV0
 16798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16799
 16800
 16801
 16802* EXEC CICS READ
 16803*         DATASET('ELACTQ')
 16804*         RIDFLD (ELMSTR-KEY)
 16805*         SET    (ADDRESS OF ACTIVITY-QUE)
 16806*         UPDATE
 16807*     END-EXEC.
 16808     MOVE 'ELACTQ' TO DFHEIV1
 16809*    MOVE '&"S        EU         (   #00015589' TO DFHEIV0
 16810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16812     MOVE X'2020233030303135353839' TO DFHEIV0(25:11)
 16813     CALL 'kxdfhei1' USING DFHEIV0,
 16814           DFHEIV1,
 16815           DFHEIV20,
 16816           DFHEIV99,
 16817           ELMSTR-KEY,
 16818           DFHEIV99,
 16819           DFHEIV99,
 16820           DFHEIV99
 16821     SET ADDRESS OF ACTIVITY-QUE TO
 16822         DFHEIV20
 16823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16824
 16825
 16826     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16827
 16828     IF PI-AIG-SPECIAL-BENEFIT AND
 16829        PI-CASH = 'Y'
 16830         ADD 2                   TO AQ-PAYMENT-COUNTER
 16831     ELSE
 16832         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16833
 16834     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16835         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16836
 16837     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16838
 16839     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 322
* EL156.cbl
 16840         IF WS-PMT-APPROVAL-SW = 'A'
 16841             NEXT SENTENCE
 16842         ELSE
 16843            IF PI-AIG-SPECIAL-BENEFIT AND
 16844               PI-CASH = 'Y'
 16845                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16846                                     WS-PMT-UNAPPROVED-CNT
 16847            ELSE
 16848                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16849                                     WS-PMT-UNAPPROVED-CNT
 16850     ELSE
 16851         IF PI-PMT-APPR-SW = 'Y'
 16852            IF PI-AIG-SPECIAL-BENEFIT AND
 16853               PI-CASH = 'Y'
 16854                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16855                                     WS-PMT-UNAPPROVED-CNT
 16856            ELSE
 16857                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16858                                     WS-PMT-UNAPPROVED-CNT.
 16859
 16860     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16861         MOVE ER-3536 TO EMI-ERROR
 16862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16863
 16864     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16865
 16866
 16867* EXEC CICS REWRITE
 16868*         DATASET('ELACTQ')
 16869*         FROM   (ACTIVITY-QUE)
 16870*     END-EXEC.
 16871     MOVE LENGTH OF
 16872      ACTIVITY-QUE
 16873       TO DFHEIV11
 16874     MOVE 'ELACTQ' TO DFHEIV1
 16875*    MOVE '&& L                  %   #00015636' TO DFHEIV0
 16876     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16877     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16878     MOVE X'2020233030303135363336' TO DFHEIV0(25:11)
 16879     CALL 'kxdfhei1' USING DFHEIV0,
 16880           DFHEIV1,
 16881           ACTIVITY-QUE,
 16882           DFHEIV11,
 16883           DFHEIV99
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16885
 16886
 16887     GO TO 6799-EXIT.
 16888
 16889 6720-BUILD-NEW-RECORD.
 16890
 16891* EXEC CICS GETMAIN
 16892*         SET    (ADDRESS OF ACTIVITY-QUE)
 16893*         LENGTH (60)
 16894*         INITIMG(GETMAIN-SPACE)
 16895*     END-EXEC.
 16896     MOVE 60
 16897       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 323
* EL156.cbl
 16898*    MOVE ',"IL                  $   #00015644' TO DFHEIV0
 16899     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16901     MOVE X'2020233030303135363434' TO DFHEIV0(25:11)
 16902     CALL 'kxdfhei1' USING DFHEIV0,
 16903           DFHEIV20,
 16904           DFHEIV11,
 16905           GETMAIN-SPACE
 16906     SET ADDRESS OF ACTIVITY-QUE TO
 16907         DFHEIV20
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16912
 16913     IF PI-AIG-SPECIAL-BENEFIT AND
 16914        PI-CASH = 'Y'
 16915         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16916     ELSE
 16917         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16918
 16919     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16920     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16921     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16922     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16923                                    AQ-FOLLOWUP-DATE.
 16924     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16925     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16926
 16927     IF PI-PMT-GRADUATED
 16928         IF WS-PMT-APPROVAL-SW = 'A'
 16929             NEXT SENTENCE
 16930         ELSE
 16931            IF PI-AIG-SPECIAL-BENEFIT AND
 16932               PI-CASH = 'Y'
 16933                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16934            ELSE
 16935                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16936     ELSE
 16937         IF PI-PMT-APPR-SW = 'Y'
 16938            IF PI-AIG-SPECIAL-BENEFIT AND
 16939               PI-CASH = 'Y'
 16940                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16941            ELSE
 16942                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16943
 16944     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16945         MOVE ER-3536 TO EMI-ERROR
 16946         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16947
 16948
 16949* EXEC CICS WRITE
 16950*         DATASET('ELACTQ')
 16951*         RIDFLD (ELMSTR-KEY)
 16952*         FROM   (ACTIVITY-QUE)
 16953*     END-EXEC.
 16954     MOVE LENGTH OF
 16955      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 324
* EL156.cbl
 16956       TO DFHEIV11
 16957     MOVE 'ELACTQ' TO DFHEIV1
 16958*    MOVE '&$ L                  ''   #00015687' TO DFHEIV0
 16959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16961     MOVE X'2020233030303135363837' TO DFHEIV0(25:11)
 16962     CALL 'kxdfhei1' USING DFHEIV0,
 16963           DFHEIV1,
 16964           ACTIVITY-QUE,
 16965           DFHEIV11,
 16966           ELMSTR-KEY,
 16967           DFHEIV99,
 16968           DFHEIV99
 16969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16970
 16971
 16972 6799-EXIT.
 16973      EXIT.
 16974
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 325
* EL156.cbl
 16976 6800-BUILD-FORM-TRAILER.
 16977
 16978
 16979* EXEC CICS GETMAIN
 16980*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16981*         LENGTH   (200)
 16982*         INITIMG  (GETMAIN-SPACE)
 16983*    END-EXEC.
 16984     MOVE 200
 16985       TO DFHEIV11
 16986*    MOVE ',"IL                  $   #00015699' TO DFHEIV0
 16987     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16988     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16989     MOVE X'2020233030303135363939' TO DFHEIV0(25:11)
 16990     CALL 'kxdfhei1' USING DFHEIV0,
 16991           DFHEIV20,
 16992           DFHEIV11,
 16993           GETMAIN-SPACE
 16994     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16995         DFHEIV20
 16996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16997
 16998
 16999     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17000
 17001     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17002     MOVE 'AT'                   TO AT-RECORD-ID.
 17003     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17004
 17005     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17006     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17007                                    AT-FORM-LAST-MAINT-DT
 17008                                    AT-FORM-SEND-ON-DT.
 17009     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17010                                    AT-FORM-LAST-UPDATED-BY.
 17011     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17012     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17013     MOVE '6'                    TO DC-OPTION-CODE.
 17014     MOVE +29                    TO DC-ELAPSED-DAYS.
 17015     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17016     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17017     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17018
 17019     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17020         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17021
 17022     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17023                                    AT-FORM-RE-SEND-DT
 17024                                    AT-EMP-FORM-ANSWERED-DT
 17025                                    AT-PHY-FORM-ANSWERED-DT
 17026                                    AT-EMP-FORM-SEND-ON-DT
 17027                                    AT-PHY-FORM-SEND-ON-DT
 17028                                    AT-FORM-PRINTED-DT
 17029                                    AT-FORM-REPRINT-DT.
 17030     MOVE '2'                    TO AT-FORM-TYPE.
 17031
 17032     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17033     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 326
* EL156.cbl
 17034
 17035     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17036         NEXT SENTENCE
 17037     ELSE
 17038         IF CL-PROG-FORM-TYPE NOT = 'S'
 17039            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17040
 17041
 17042* EXEC CICS WRITE
 17043*         DATASET  ('ELTRLR')
 17044*         FROM     (ACTIVITY-TRAILERS)
 17045*         RIDFLD   (AT-CONTROL-PRIMARY)
 17046*     END-EXEC.
 17047     MOVE LENGTH OF
 17048      ACTIVITY-TRAILERS
 17049       TO DFHEIV11
 17050     MOVE 'ELTRLR' TO DFHEIV1
 17051*    MOVE '&$ L                  ''   #00015747' TO DFHEIV0
 17052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17054     MOVE X'2020233030303135373437' TO DFHEIV0(25:11)
 17055     CALL 'kxdfhei1' USING DFHEIV0,
 17056           DFHEIV1,
 17057           ACTIVITY-TRAILERS,
 17058           DFHEIV11,
 17059           AT-CONTROL-PRIMARY,
 17060           DFHEIV99,
 17061           DFHEIV99
 17062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17063
 17064
 17065 6899-EXIT.
 17066      EXIT.
 17067
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 327
* EL156.cbl
 17069 6900-BUILD-ARCHIVE-HEADER.
 17070
 17071     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17072     MOVE '1'                    TO CNTL-REC-TYPE.
 17073     MOVE +0                     TO CNTL-SEQ-NO.
 17074     MOVE SPACES                 TO CNTL-ACCESS.
 17075
 17076
 17077* EXEC CICS READ
 17078*         DATASET  ('ELCNTL')
 17079*         SET      (ADDRESS OF CONTROL-FILE)
 17080*         RIDFLD   (ELCNTL-KEY)
 17081*         UPDATE
 17082*    END-EXEC.
 17083     MOVE 'ELCNTL' TO DFHEIV1
 17084*    MOVE '&"S        EU         (   #00015764' TO DFHEIV0
 17085     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17086     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17087     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 17088     CALL 'kxdfhei1' USING DFHEIV0,
 17089           DFHEIV1,
 17090           DFHEIV20,
 17091           DFHEIV99,
 17092           ELCNTL-KEY,
 17093           DFHEIV99,
 17094           DFHEIV99,
 17095           DFHEIV99
 17096     SET ADDRESS OF CONTROL-FILE TO
 17097         DFHEIV20
 17098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17099
 17100
 17101     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17102     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17103
 17104
 17105* EXEC CICS REWRITE
 17106*         FROM     (CONTROL-FILE)
 17107*         DATASET  ('ELCNTL')
 17108*    END-EXEC.
 17109     MOVE LENGTH OF
 17110      CONTROL-FILE
 17111       TO DFHEIV11
 17112     MOVE 'ELCNTL' TO DFHEIV1
 17113*    MOVE '&& L                  %   #00015774' TO DFHEIV0
 17114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17116     MOVE X'2020233030303135373734' TO DFHEIV0(25:11)
 17117     CALL 'kxdfhei1' USING DFHEIV0,
 17118           DFHEIV1,
 17119           CONTROL-FILE,
 17120           DFHEIV11,
 17121           DFHEIV99
 17122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17123
 17124
 17125
 17126* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 328
* EL156.cbl
 17127*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17128*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17129*    END-EXEC.
 17130*    MOVE '"$$%                  ! 7 #00015779' TO DFHEIV0
 17131     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17133     MOVE X'3720233030303135373739' TO DFHEIV0(25:11)
 17134     CALL 'kxdfhei1' USING DFHEIV0
 17135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17136
 17137
 17138
 17139* EXEC CICS GETMAIN
 17140*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17141*         LENGTH  (ELARCH-LENGTH)
 17142*         INITIMG (GETMAIN-SPACE)
 17143*    END-EXEC.
 17144*    MOVE ',"IL                  $   #00015784' TO DFHEIV0
 17145     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17147     MOVE X'2020233030303135373834' TO DFHEIV0(25:11)
 17148     CALL 'kxdfhei1' USING DFHEIV0,
 17149           DFHEIV20,
 17150           ELARCH-LENGTH,
 17151           GETMAIN-SPACE
 17152     SET ADDRESS OF LETTER-ARCHIVE TO
 17153         DFHEIV20
 17154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17155
 17156
 17157     MOVE 'LA'                   TO LA-RECORD-ID.
 17158     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17159                                    LA-ARCHIVE-NO-A1.
 17160     MOVE '4'                    TO LA-RECORD-TYPE
 17161                                    LA-RECORD-TYPE-A1.
 17162     MOVE +0                     TO LA-LINE-SEQ-NO
 17163                                    LA-LINE-SEQ-NO-A1.
 17164     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17165                                    LA-COMPANY-CD-A1.
 17166     MOVE CL-CARRIER             TO LA4-CARRIER.
 17167     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17168     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17169     MOVE CL-CERT-STATE          TO LA4-STATE.
 17170     MOVE +0                     TO LA4-NO-OF-COPIES.
 17171     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17172     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17173     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17174                                    LA4-INITIAL-PRINT-DATE
 17175                                    LA4-RESEND-PRINT-DATE
 17176                                    LA4-FORM-REM-PRINT-DT.
 17177     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17178     MOVE '2'                    TO LA4-FORM-TYPE.
 17179
 17180
 17181* EXEC CICS WRITE
 17182*         DATASET  ('ELARCH')
 17183*         FROM     (LETTER-ARCHIVE)
 17184*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 329
* EL156.cbl
 17185*    END-EXEC.
 17186     MOVE LENGTH OF
 17187      LETTER-ARCHIVE
 17188       TO DFHEIV11
 17189     MOVE 'ELARCH' TO DFHEIV1
 17190*    MOVE '&$ L                  ''   #00015813' TO DFHEIV0
 17191     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17192     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17193     MOVE X'2020233030303135383133' TO DFHEIV0(25:11)
 17194     CALL 'kxdfhei1' USING DFHEIV0,
 17195           DFHEIV1,
 17196           LETTER-ARCHIVE,
 17197           DFHEIV11,
 17198           LA-CONTROL-PRIMARY,
 17199           DFHEIV99,
 17200           DFHEIV99
 17201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17202
 17203
 17204 6999-EXIT.
 17205      EXIT.
 17206
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 330
* EL156.cbl
 17208 7000-SHOW-CLAIM.
 17209     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17210     MOVE 'A'                    TO PI-PASS-SW.
 17211     MOVE LOW-VALUES             TO PI-CPYFROM
 17212                                    PI-MONTH-END-SAVE
 17213                                    PI-CPYTHRU.
 17214
 17215     MOVE ZEROS                  TO PI-FATAL-COUNT
 17216                                    PI-DAILY-RATE
 17217                                    PI-BEN-DAYS
 17218                                    PI-MANUAL-SW
 17219                                    PI-SAVE-CURSOR
 17220                                    PI-FORCE-COUNT
 17221                                    PI-HOLDTIL
 17222                                    PI-EPYFROM
 17223                                    PI-EPYTHRU
 17224                                    PI-EDAYS
 17225                                    PI-EPYAMT
 17226                                    PI-ERESV
 17227                                    PI-EEXPENS
 17228                                    PI-CDAYS
 17229                                    PI-CPYAMT
 17230                                    PI-CRESV
 17231                                    PI-CEXPENS
 17232                                    PI-INT-RATE
 17233                                    PI-AIGFROM.
 17234     MOVE ZEROS                  TO PI-PROOF-DATE.
 17235     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17236                                    PI-REM-BEN-AMT
 17237                                    PI-MO-BEN-AMT
 17238                                    pi-ah-term.
 17239
 17240     MOVE LOW-VALUES             TO EL156AI.
 17241     MOVE MAP-NAMEA              TO MAP-NAME.
 17242
 17243* EXEC CICS HANDLE CONDITION
 17244*        NOTFND   (7010-BUILD-MAP)
 17245*    END-EXEC.
 17246*    MOVE '"$I                   ! 8 #00015857' TO DFHEIV0
 17247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17249     MOVE X'3820233030303135383537' TO DFHEIV0(25:11)
 17250     CALL 'kxdfhei1' USING DFHEIV0
 17251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17252
 17253
 17254     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17255     MOVE '2'                    TO CNTL-REC-TYPE.
 17256     MOVE +0                     TO CNTL-SEQ-NO.
 17257     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17258
 17259
 17260* EXEC CICS READ
 17261*         DATASET  ('ELCNTL')
 17262*         SET      (ADDRESS OF CONTROL-FILE)
 17263*         RIDFLD   (ELCNTL-KEY)
 17264*    END-EXEC.
 17265     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 331
* EL156.cbl
 17266*    MOVE '&"S        E          (   #00015866' TO DFHEIV0
 17267     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17268     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17269     MOVE X'2020233030303135383636' TO DFHEIV0(25:11)
 17270     CALL 'kxdfhei1' USING DFHEIV0,
 17271           DFHEIV1,
 17272           DFHEIV20,
 17273           DFHEIV99,
 17274           ELCNTL-KEY,
 17275           DFHEIV99,
 17276           DFHEIV99,
 17277           DFHEIV99
 17278     SET ADDRESS OF CONTROL-FILE TO
 17279         DFHEIV20
 17280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17281
 17282
 17283     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17284
 17285     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17286         MOVE AL-UANON      TO SURVYYNA
 17287     END-IF.
 17288
 17289
 17290     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17291     MOVE '1'                    TO CNTL-REC-TYPE.
 17292     MOVE SPACES                 TO CNTL-ACCESS.
 17293     MOVE +0                     TO CNTL-SEQ-NO.
 17294
 17295
 17296* EXEC CICS READ
 17297*         DATASET  ('ELCNTL')
 17298*         SET      (ADDRESS OF CONTROL-FILE)
 17299*         RIDFLD   (ELCNTL-KEY)
 17300*    END-EXEC.
 17301     MOVE 'ELCNTL' TO DFHEIV1
 17302*    MOVE '&"S        E          (   #00015884' TO DFHEIV0
 17303     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17304     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17305     MOVE X'2020233030303135383834' TO DFHEIV0(25:11)
 17306     CALL 'kxdfhei1' USING DFHEIV0,
 17307           DFHEIV1,
 17308           DFHEIV20,
 17309           DFHEIV99,
 17310           ELCNTL-KEY,
 17311           DFHEIV99,
 17312           DFHEIV99,
 17313           DFHEIV99
 17314     SET ADDRESS OF CONTROL-FILE TO
 17315         DFHEIV20
 17316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17317
 17318
 17319     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17320
 17321 7010-BUILD-MAP.
 17322
 17323
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 332
* EL156.cbl
 17324* EXEC CICS HANDLE CONDITION
 17325*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17326*    END-EXEC.
 17327*    MOVE '"$I                   ! 9 #00015894' TO DFHEIV0
 17328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17330     MOVE X'3920233030303135383934' TO DFHEIV0(25:11)
 17331     CALL 'kxdfhei1' USING DFHEIV0
 17332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17333
 17334
 17335     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17336     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17337     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17338     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17339     MOVE 'MSTR'                 TO FILE-SWITCH.
 17340
 17341     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17342
 17343     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17344     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17345     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17346     MOVE CL-CCN                 TO PI-SV-CCN.
 17347
 17348     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17349     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17350     MOVE CL-CLAIM-NO            TO CLMNOO.
 17351     MOVE CL-CARRIER             TO CARRO.
 17352     MOVE CL-CERT-PRIME          TO CERTNOO.
 17353     MOVE CL-CERT-SFX            TO SUFXO.
 17354
 17355     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17356        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17357        CONTINUE
 17358     ELSE
 17359        MOVE AL-SADOF            TO ZINTHA
 17360                                    ZINTA
 17361                                    PINTHA
 17362                                    PINTA
 17363     END-IF
 17364     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17365     EVALUATE TRUE
 17366     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17367         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17368     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17369         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17370
 17371     WHEN CL-CLAIM-TYPE = 'I'
 17372         MOVE '  IU  '           TO CLMTYPO
 17373     WHEN CL-CLAIM-TYPE = 'G'
 17374         MOVE ' GAP  '           TO CLMTYPO
 17375     WHEN CL-CLAIM-TYPE = 'F'
 17376         MOVE ' FMLA '           TO CLMTYPO
 17377     END-EVALUATE.
 17378     IF CLAIM-IS-OPEN
 17379         MOVE ' OPEN'            TO CLMSTATO
 17380     ELSE
 17381         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 333
* EL156.cbl
 17382
 17383     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17384
 17385     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17386         MOVE SPACES             TO  PCERTNOO
 17387                                     PSUFXO
 17388                                     PRIMHDGO
 17389                                     SEQUO
 17390         MOVE AL-SADOF           TO  PCERTNOA
 17391                                     PSUFXA
 17392                                     PRIMHDGA
 17393                                     SEQUA
 17394     ELSE
 17395         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17396         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17397         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17398         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17399         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17400         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17401         MOVE AL-SANON               TO  PCERTNOA
 17402                                         PSUFXA
 17403                                         PRIMHDGA
 17404         MOVE AL-SABON               TO  SEQUA.
 17405
 17406     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17407
 17408     IF CL-NO-OF-PMTS-MADE = 0 AND
 17409        CL-TOTAL-PAID-AMT = 0
 17410         NEXT SENTENCE
 17411     ELSE
 17412         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17413             IF NOT PI-USES-PAID-TO
 17414                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17415                 MOVE ' '                 TO DC-OPTION-CODE
 17416                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17417                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17418             ELSE
 17419                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17420                 MOVE '6'                 TO DC-OPTION-CODE
 17421                 MOVE +1                  TO DC-ELAPSED-DAYS
 17422                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17423                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17424                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17425
 17426     IF MAP-NAME = 'EL156A'
 17427        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17428           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17429             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17430           end-if
 17431        end-if
 17432     end-if
 17433     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17434         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17435         MOVE ' '                TO DC-OPTION-CODE
 17436         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17437         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17438
 17439     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 334
* EL156.cbl
 17440         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17441         MOVE ' '                TO DC-OPTION-CODE
 17442         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17443         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17444
 17445     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17446
 17447     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17448         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17449         MOVE ' '                TO DC-OPTION-CODE
 17450         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17451         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17452
 17453     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17454         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17455         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17456     ELSE
 17457         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17458         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17459
 17460     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17461     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17462     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17463     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17464                                    PI-GROUPING.
 17465     MOVE CL-CERT-STATE          TO CERT-STATE
 17466                                    PI-STATE.
 17467     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17468                                    PI-ACCOUNT.
 17469     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17470     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17471     MOVE 'CERT'                 TO FILE-SWITCH.
 17472
 17473     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17474     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17475        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17476        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17477            MOVE 'N' TO PI-JOINT-INSURED-IND
 17478     ELSE
 17479            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17480     END-IF.
 17481
 17482     perform 7975-read-acct      thru 7975-exit
 17483     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17484     MOVE PI-STATE               TO WS-ST-ACCESS.
 17485     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17486     MOVE '3'                    TO CNTL-REC-TYPE.
 17487     MOVE +0                     TO CNTL-SEQ-NO.
 17488     MOVE 'STAT'                 TO FILE-SWITCH.
 17489
 17490     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17491
 17492     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17493     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17494
 17495     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17496        GO TO 7020-BYPASS-BENEFIT.
 17497
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 335
* EL156.cbl
 17498     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17499     MOVE '4'                    TO CNTL-REC-TYPE.
 17500     MOVE +0                     TO CNTL-SEQ-NO.
 17501     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17502     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17503     MOVE 'BENE'                 TO FILE-SWITCH.
 17504
 17505     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17506
 17507     IF NO-BENEFIT-FOUND
 17508        GO TO 7020-BYPASS-BENEFIT.
 17509
 17510     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17511     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17512     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17513
 17514 7020-BYPASS-BENEFIT.
 17515
 17516*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17517*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17518*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17519
 17520     move zeros                  to PI-MAX-BENEFIT-AMT
 17521     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17522     move cm-ah-orig-term        to pi-ah-term
 17523     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17524     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17525          'G' and 'F'
 17526         GO TO 7021-GO-TO-LIFE.
 17527
 17528     IF (PI-COMPANY-ID = 'DCC')
 17529        and (acct-found)
 17530        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17531        PERFORM 0900-GET-DDF-limits
 17532                                 THRU 0900-EXIT
 17533        IF PDEF-FOUND
 17534           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17535              (P1 > +8)
 17536              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17537           END-PERFORM
 17538           IF P1 < +9
 17539              if pd-ben-pct (p1) not numeric
 17540                 move zeros      to pd-ben-pct (p1)
 17541              end-if
 17542              if pd-ben-pct (p1) = zeros
 17543                 move +1         to ws-work-ben-pct
 17544              else
 17545                 move pd-ben-pct (p1)
 17546                                 to ws-work-ben-pct
 17547              end-if
 17548              compute cm-ah-benefit-amt =
 17549                 cm-ah-benefit-amt * ws-work-ben-pct
 17550              move pd-max-amt (p1) to pi-max-benefit-amt
 17551           END-IF
 17552        END-IF
 17553     end-if
 17554     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17555     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 336
* EL156.cbl
 17556     if (pi-max-benefit-amt not = zeros)
 17557        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17558        move pi-max-benefit-amt  to beneo
 17559     else
 17560        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17561     end-if
 17562     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17563     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17564                                    CP-ORIGINAL-TERM.
 17565     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17566
 17567*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17568*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17569*    ELSE
 17570         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17571
 17572     MOVE ' '                    TO DC-OPTION-CODE.
 17573     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17574     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17575
 17576     IF PI-COMPANY-ID = 'DMD'
 17577         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17578         GO TO 7023-BYPASS-REMAINING-TERM.
 17579
 17580     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17581     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17582     GO TO 7022-AROUND-LIFE.
 17583
 17584 7021-GO-TO-LIFE.
 17585
 17586     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17587     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17588     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17589                                    CP-ORIGINAL-TERM.
 17590     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17591     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17592     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17593     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17594
 17595     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17596         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17597     ELSE
 17598         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17599
 17600     MOVE ' '                    TO DC-OPTION-CODE.
 17601     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17602     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17603
 17604 7022-AROUND-LIFE.
 17605
 17606     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17607     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17608     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17609     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17610     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17611     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17612     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17613
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 337
* EL156.cbl
 17614     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17615
 17616     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17617        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17618           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17619
 17620     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17621        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17622           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17623
 17624 7023-BYPASS-REMAINING-TERM.
 17625     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17626       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17627          MOVE ZEROS                  TO BENEO
 17628       ELSE
 17629          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17630          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17631          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17632          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17633          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17634          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17635          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17636          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17637          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17638          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17639          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17640          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17641          IF (PI-COMPANY-ID = 'DCC')
 17642             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17643             PERFORM 0900-GET-DDF-limits
 17644                                 THRU 0900-EXIT
 17645             IF PDEF-FOUND
 17646                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17647                   (P1 > +8)
 17648                   OR (PD-PROD-CODE (P1) = 'L')
 17649                END-PERFORM
 17650                IF P1 < +9
 17651                   MOVE PD-MAX-AMT (P1)
 17652                                 TO CP-R-MAX-TOT-BEN
 17653                END-IF
 17654             END-IF
 17655          END-IF
 17656
 17657* EXEC CICS LINK
 17658*            PROGRAM  (LINK-REMAMT)
 17659*            COMMAREA (CALCULATION-PASS-AREA)
 17660*            LENGTH   (CP-COMM-LENGTH)
 17661*         END-EXEC
 17662*    MOVE '."C                   (   #00016219' TO DFHEIV0
 17663     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17665     MOVE X'2020233030303136323139' TO DFHEIV0(25:11)
 17666     CALL 'kxdfhei1' USING DFHEIV0,
 17667           LINK-REMAMT,
 17668           CALCULATION-PASS-AREA,
 17669           CP-COMM-LENGTH,
 17670           DFHEIV99,
 17671           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 338
* EL156.cbl
 17672           DFHEIV99,
 17673           DFHEIV99
 17674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17675          MOVE CP-REMAINING-AMT       TO BENEO
 17676       end-if
 17677     end-if
 17678     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17679     MOVE +95                    TO TRLR-SEQ-NO
 17680
 17681* EXEC CICS READ
 17682*       DATASET  ('ELTRLR')
 17683*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17684*       RIDFLD   (ELTRLR-KEY)
 17685*       RESP     (WS-RESPONSE)
 17686*    END-EXEC
 17687     MOVE 'ELTRLR' TO DFHEIV1
 17688*    MOVE '&"S        E          (  N#00016229' TO DFHEIV0
 17689     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17691     MOVE X'204E233030303136323239' TO DFHEIV0(25:11)
 17692     CALL 'kxdfhei1' USING DFHEIV0,
 17693           DFHEIV1,
 17694           DFHEIV20,
 17695           DFHEIV99,
 17696           ELTRLR-KEY,
 17697           DFHEIV99,
 17698           DFHEIV99,
 17699           DFHEIV99
 17700     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17701         DFHEIV20
 17702     MOVE EIBRESP  TO WS-RESPONSE
 17703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17704
 17705     if ws-resp-normal
 17706        perform varying s1 from +1 by +1 until
 17707           at-note-error-no (s1) = spaces
 17708           move at-note-error-no (s1)
 17709                                 to emi-error
 17710           if at-note-error-no (s1) = '1653'
 17711              evaluate true
 17712                 when cl-claim-type = 'L'
 17713                    move '  LF  '
 17714                                 to emi-claim-type
 17715                 when cl-claim-type = 'I'
 17716                    move '  IU  '
 17717                                 to emi-claim-type
 17718                 when cl-claim-type = 'F'
 17719                    move ' FMLA '
 17720                                 to emi-claim-type
 17721                 when other
 17722                    move '  AH  '
 17723                                 to emi-claim-type
 17724              end-evaluate
 17725           end-if
 17726           PERFORM 9900-ERROR-FORMAT
 17727                                 THRU 9900-EXIT
 17728        end-perform
 17729     end-if
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 339
* EL156.cbl
 17730     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17731         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17732            WS-LF-COVERAGE-TYPE = 'P'
 17733             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17734                                        CM-LF-ITD-DEATH-AMT
 17735             MOVE WS-REMAINING-AMT  TO  BENEO.
 17736
 17737     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17738     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17739     MOVE WS-TERMS               TO TERMSO.
 17740
 17741     IF WS-STATUS = '6' OR '7' OR '8'
 17742         MOVE AL-SABOF           TO CRTSTATA.
 17743
 17744     IF WS-STATUS = '1' OR '4'
 17745        IF CP-REMAINING-TERM-3 = ZEROS
 17746           MOVE 'EXPIRED'        TO CRTSTATO
 17747        ELSE
 17748           MOVE 'ACTIVE  '       TO CRTSTATO.
 17749
 17750     IF WS-STATUS = '2'
 17751         MOVE 'PEND    '         TO CRTSTATO.
 17752
 17753     IF WS-STATUS = '3'
 17754         MOVE 'RESTORE '         TO CRTSTATO.
 17755
 17756     IF WS-STATUS = '5'
 17757         MOVE 'REISSUE '         TO CRTSTATO.
 17758
 17759     IF WS-STATUS = '6'
 17760         MOVE 'LMP DIS'          TO CRTSTATO.
 17761
 17762     IF WS-STATUS = '7'
 17763         MOVE 'DEATH'            TO CRTSTATO.
 17764
 17765     IF WS-STATUS = '8'
 17766         MOVE 'CANCEL'           TO CRTSTATO.
 17767
 17768     IF WS-STATUS = '9'
 17769         MOVE 'RE-ONLY '         TO CRTSTATO.
 17770
 17771     IF WS-STATUS = 'V'
 17772         MOVE 'VOID  '           TO CRTSTATO.
 17773
 17774     IF WS-STATUS = 'D'
 17775         MOVE 'DECLINE '         TO CRTSTATO.
 17776
 17777     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17778         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17779         MOVE '5'                TO CNTL-REC-TYPE
 17780     ELSE
 17781         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17782         MOVE '4'                TO CNTL-REC-TYPE.
 17783
 17784     MOVE '** NONE **'           TO COVERO.
 17785     MOVE AL-SABON               TO COVERA.
 17786
 17787     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 340
* EL156.cbl
 17788         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17789             MOVE CM-BENEFICIARY TO LOANNOO
 17790             MOVE AL-UANON       TO LOANNOA.
 17791
 17792     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17793        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17794        MOVE +91                 TO  TRLR-SEQ-NO
 17795
 17796* EXEC CICS READ
 17797*           DATASET  ('ELTRLR')
 17798*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17799*           RIDFLD   (ELTRLR-KEY)
 17800*           RESP     (WS-RESPONSE)
 17801*       END-EXEC
 17802     MOVE 'ELTRLR' TO DFHEIV1
 17803*    MOVE '&"S        E          (  N#00016326' TO DFHEIV0
 17804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17806     MOVE X'204E233030303136333236' TO DFHEIV0(25:11)
 17807     CALL 'kxdfhei1' USING DFHEIV0,
 17808           DFHEIV1,
 17809           DFHEIV20,
 17810           DFHEIV99,
 17811           ELTRLR-KEY,
 17812           DFHEIV99,
 17813           DFHEIV99,
 17814           DFHEIV99
 17815     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17816         DFHEIV20
 17817     MOVE EIBRESP  TO WS-RESPONSE
 17818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17819
 17820        IF WS-RESP-NORMAL
 17821           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17822        ELSE
 17823           MOVE SPACES           TO  LOANNOO
 17824        END-IF
 17825*052506
 17826*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17827*052506
 17828     END-IF
 17829
 17830     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17831        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17832
 17833     IF WS-BEN-CD = ZEROS
 17834         GO TO 7050-SHOW-CONTINUE.
 17835
 17836     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17837     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17838     MOVE +0                     TO CNTL-SEQ-NO.
 17839     MOVE 'BENE'                 TO FILE-SWITCH.
 17840
 17841     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17842
 17843     IF BENEFIT-FOUND
 17844         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17845         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 341
* EL156.cbl
 17846         MOVE AL-SANON                    TO COVERA.
 17847
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 342
* EL156.cbl
 17849 7050-SHOW-CONTINUE.
 17850
 17851     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17852        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17853            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17854     END-IF
 17855
 17856     IF PI-COMPANY-ID = 'DMD'
 17857         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17858
 17859     MOVE -1                     TO PMTTYPEL.
 17860     GO TO 8100-SEND-INITIAL-MAP.
 17861
 17862 7100-SHOW-RECORD-NOT-FOUND.
 17863     IF FILE-SWITCH = 'MSTR'
 17864         MOVE ER-0204            TO EMI-ERROR.
 17865
 17866     IF FILE-SWITCH = 'CERT'
 17867         MOVE ER-0206            TO EMI-ERROR.
 17868
 17869     IF FILE-SWITCH = 'STAT'
 17870         MOVE ER-0149            TO EMI-ERROR.
 17871
 17872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17873
 17874     MOVE -1                     TO PMTTYPEL.
 17875     GO TO 8100-SEND-INITIAL-MAP
 17876
 17877     .
 17878 7110-BUILD-PMT-TRLR.
 17879     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17880     MOVE +51                    TO TRLR-SEQ-NO
 17881
 17882* EXEC CICS READ
 17883*        DATASET  ('ELTRLR')
 17884*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17885*        RIDFLD   (ELTRLR-KEY)
 17886*        RESP     (WS-RESPONSE)
 17887*    END-EXEC
 17888     MOVE 'ELTRLR' TO DFHEIV1
 17889*    MOVE '&"S        E          (  N#00016394' TO DFHEIV0
 17890     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17891     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17892     MOVE X'204E233030303136333934' TO DFHEIV0(25:11)
 17893     CALL 'kxdfhei1' USING DFHEIV0,
 17894           DFHEIV1,
 17895           DFHEIV20,
 17896           DFHEIV99,
 17897           ELTRLR-KEY,
 17898           DFHEIV99,
 17899           DFHEIV99,
 17900           DFHEIV99
 17901     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17902         DFHEIV20
 17903     MOVE EIBRESP  TO WS-RESPONSE
 17904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17905     IF WS-RESP-NORMAL
 17906        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 343
* EL156.cbl
 17907     END-IF
 17908     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17909
 17910* EXEC CICS GETMAIN
 17911*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17912*         LENGTH    (200)
 17913*         INITIMG   (GETMAIN-SPACE)
 17914*     END-EXEC
 17915     MOVE 200
 17916       TO DFHEIV11
 17917*    MOVE ',"IL                  $   #00016404' TO DFHEIV0
 17918     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17919     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17920     MOVE X'2020233030303136343034' TO DFHEIV0(25:11)
 17921     CALL 'kxdfhei1' USING DFHEIV0,
 17922           DFHEIV20,
 17923           DFHEIV11,
 17924           GETMAIN-SPACE
 17925     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17926         DFHEIV20
 17927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17928     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17929                                    AT-PREV-PAID-THRU-DT
 17930     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17931     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17932     MOVE 'AT'                   TO AT-RECORD-ID
 17933     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17934     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17935     MOVE '2'                    TO AT-TRAILER-TYPE
 17936     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17937                                    AT-PAYMENT-LAST-MAINT-DT
 17938     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17939                                    AT-PAYMENT-LAST-UPDATED-BY
 17940     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17941     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17942     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17943     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17944     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17945     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17946     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17947     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17948     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17949     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17950     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17951     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17952     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17953     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17954     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17955     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17956                                    AT-TO-BE-WRITTEN-DT
 17957     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17958                                    AT-CHECK-QUE-SEQUENCE
 17959                                    AT-ADDL-RESERVE
 17960     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17961                                    AT-VOID-SELECT-DT
 17962                                    AT-VOID-ACCEPT-DT
 17963                                    AT-VOID-DT
 17964                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 344
* EL156.cbl
 17965                                    AT-INT-PMT-SELECT-DT
 17966     MOVE ZEROS                  TO AT-DAILY-RATE
 17967                                    AT-ELIMINATION-DAYS
 17968     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17969*    EXEC CICS HANDLE CONDITION
 17970*        DUPREC    (7120-DUPREC)
 17971*    END-EXEC
 17972     .
 17973 7115-WRITE-INT-TRLR.
 17974
 17975* EXEC CICS WRITE
 17976*         DATASET       ('ELTRLR')
 17977*         FROM          (ACTIVITY-TRAILERS)
 17978*         RIDFLD        (AT-CONTROL-PRIMARY)
 17979*         RESP          (WS-RESPONSE)
 17980*     END-EXEC
 17981     MOVE LENGTH OF
 17982      ACTIVITY-TRAILERS
 17983       TO DFHEIV11
 17984     MOVE 'ELTRLR' TO DFHEIV1
 17985*    MOVE '&$ L                  ''  N#00016455' TO DFHEIV0
 17986     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17988     MOVE X'204E233030303136343535' TO DFHEIV0(25:11)
 17989     CALL 'kxdfhei1' USING DFHEIV0,
 17990           DFHEIV1,
 17991           ACTIVITY-TRAILERS,
 17992           DFHEIV11,
 17993           AT-CONTROL-PRIMARY,
 17994           DFHEIV99,
 17995           DFHEIV99
 17996     MOVE EIBRESP  TO WS-RESPONSE
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17998      IF WS-RESP-DUPREC
 17999         GO TO 7120-DUPREC
 18000      END-IF
 18001     GO TO 7130-EXIT
 18002     .
 18003 7120-DUPREC.
 18004     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18005     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18006     GO TO 7115-WRITE-INT-TRLR
 18007     .
 18008 7130-EXIT.
 18009      EXIT.
 18010 7140-BUILD-NOTE-TRLR.
 18011
 18012
 18013* EXEC CICS GETMAIN
 18014*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18015*         LENGTH    (200)
 18016*         INITIMG   (GETMAIN-SPACE)
 18017*     END-EXEC
 18018     MOVE 200
 18019       TO DFHEIV11
 18020*    MOVE ',"IL                  $   #00016475' TO DFHEIV0
 18021     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 345
* EL156.cbl
 18023     MOVE X'2020233030303136343735' TO DFHEIV0(25:11)
 18024     CALL 'kxdfhei1' USING DFHEIV0,
 18025           DFHEIV20,
 18026           DFHEIV11,
 18027           GETMAIN-SPACE
 18028     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18029         DFHEIV20
 18030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18031     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18032     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18033     MOVE 'AT'                   TO AT-RECORD-ID
 18034     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18035     MOVE '6'                    TO AT-TRAILER-TYPE
 18036     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18037                                    AT-GEN-INFO-LAST-MAINT-DT
 18038     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18039                                    AT-GEN-INFO-LAST-UPDATED-BY
 18040     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18041     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18042     .
 18043 7150-WRITE.
 18044
 18045* EXEC CICS HANDLE CONDITION
 18046*        DUPREC    (7160-DUPREC)
 18047*    END-EXEC
 18048*    MOVE '"$%                   ! : #00016493' TO DFHEIV0
 18049     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18051     MOVE X'3A20233030303136343933' TO DFHEIV0(25:11)
 18052     CALL 'kxdfhei1' USING DFHEIV0
 18053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18054
 18055* EXEC CICS WRITE
 18056*         DATASET     ('ELTRLR')
 18057*         FROM        (ACTIVITY-TRAILERS)
 18058*         RIDFLD      (AT-CONTROL-PRIMARY)
 18059*         RESP        (WS-RESPONSE)
 18060*     END-EXEC
 18061     MOVE LENGTH OF
 18062      ACTIVITY-TRAILERS
 18063       TO DFHEIV11
 18064     MOVE 'ELTRLR' TO DFHEIV1
 18065*    MOVE '&$ L                  ''  N#00016496' TO DFHEIV0
 18066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18068     MOVE X'204E233030303136343936' TO DFHEIV0(25:11)
 18069     CALL 'kxdfhei1' USING DFHEIV0,
 18070           DFHEIV1,
 18071           ACTIVITY-TRAILERS,
 18072           DFHEIV11,
 18073           AT-CONTROL-PRIMARY,
 18074           DFHEIV99,
 18075           DFHEIV99
 18076     MOVE EIBRESP  TO WS-RESPONSE
 18077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18078      IF WS-RESP-DUPREC
 18079         GO TO 7160-DUPREC
 18080      END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 346
* EL156.cbl
 18081     GO TO 7170-EXIT
 18082     .
 18083 7160-DUPREC.
 18084     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18085     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18086     GO TO 7150-WRITE
 18087     .
 18088 7170-EXIT.
 18089      EXIT.
 18090
 18091 7180-ADD-CERT-NOTE.
 18092*ADD CERT NOTE FOR SC NP+6
 18093
 18094
 18095* EXEC CICS GETMAIN
 18096*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18097*         LENGTH    (150)
 18098*         INITIMG   (GETMAIN-SPACE)
 18099*     END-EXEC.
 18100     MOVE 150
 18101       TO DFHEIV11
 18102*    MOVE ',"IL                  $   #00016518' TO DFHEIV0
 18103     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18104     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18105     MOVE X'2020233030303136353138' TO DFHEIV0(25:11)
 18106     CALL 'kxdfhei1' USING DFHEIV0,
 18107           DFHEIV20,
 18108           DFHEIV11,
 18109           GETMAIN-SPACE
 18110     SET ADDRESS OF CERT-NOTE-FILE TO
 18111         DFHEIV20
 18112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18113
 18114
 18115     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18116     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18117     MOVE +1                     TO WRK-NOTE-SEQ.
 18118     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18119     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18120     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18121     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18122     MOVE CL-CERT-STATE          TO CZ-STATE.
 18123     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18124     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18125     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18126     MOVE '2'                    TO CZ-RECORD-TYPE.
 18127     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18128     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18129     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18130     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18131     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18132     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18133     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18134     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18135     IF PI-COMPANY-ID = 'AHL'
 18136        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18137           CONTINUE
 18138        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 347
* EL156.cbl
 18139           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18140              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18141           ELSE
 18142              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18143           END-IF
 18144        END-IF
 18145     END-IF
 18146     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18147     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18148
 18149 7181-WRITE.
 18150
 18151
 18152* EXEC CICS WRITE
 18153*         DATASET     ('ERCNOT')
 18154*         FROM        (CERT-NOTE-FILE)
 18155*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18156*         RESP        (WS-RESPONSE)
 18157*    END-EXEC.
 18158     MOVE LENGTH OF
 18159      CERT-NOTE-FILE
 18160       TO DFHEIV11
 18161     MOVE 'ERCNOT' TO DFHEIV1
 18162*    MOVE '&$ L                  ''  N#00016560' TO DFHEIV0
 18163     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18164     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18165     MOVE X'204E233030303136353630' TO DFHEIV0(25:11)
 18166     CALL 'kxdfhei1' USING DFHEIV0,
 18167           DFHEIV1,
 18168           CERT-NOTE-FILE,
 18169           DFHEIV11,
 18170           CZ-CONTROL-PRIMARY,
 18171           DFHEIV99,
 18172           DFHEIV99
 18173     MOVE EIBRESP  TO WS-RESPONSE
 18174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18175
 18176
 18177     IF WS-RESP-DUPREC
 18178         GO TO 7182-DUPREC
 18179     END-IF.
 18180
 18181     SET CERT-NOTE-ADDED TO TRUE.
 18182
 18183     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18184         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18185     END-IF.
 18186
 18187     GO TO 7189-EXIT.
 18188
 18189 7182-DUPREC.
 18190
 18191     ADD +1                      TO  WRK-NOTE-SEQ.
 18192     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18193     GO TO 7181-WRITE.
 18194
 18195 7189-EXIT.
 18196      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 348
* EL156.cbl
 18197
 18198 7190-ADD-ORIG-NOTE.
 18199
 18200
 18201* EXEC CICS GETMAIN
 18202*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18203*         LENGTH    (150)
 18204*         INITIMG   (GETMAIN-SPACE)
 18205*     END-EXEC.
 18206     MOVE 150
 18207       TO DFHEIV11
 18208*    MOVE ',"IL                  $   #00016590' TO DFHEIV0
 18209     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18211     MOVE X'2020233030303136353930' TO DFHEIV0(25:11)
 18212     CALL 'kxdfhei1' USING DFHEIV0,
 18213           DFHEIV20,
 18214           DFHEIV11,
 18215           GETMAIN-SPACE
 18216     SET ADDRESS OF CERT-NOTE-FILE TO
 18217         DFHEIV20
 18218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18219
 18220
 18221     ADD +1                      TO WRK-NOTE-SEQ.
 18222     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18223     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18224     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18225     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18226     MOVE CL-CERT-STATE          TO CZ-STATE.
 18227     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18228     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18229     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18230     MOVE '2'                    TO CZ-RECORD-TYPE.
 18231     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18232     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18233     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18234     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18235     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18236     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18237
 18238 7191-WRITE.
 18239
 18240
 18241* EXEC CICS WRITE
 18242*         DATASET     ('ERCNOT')
 18243*         FROM        (CERT-NOTE-FILE)
 18244*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18245*         RESP        (WS-RESPONSE)
 18246*    END-EXEC.
 18247     MOVE LENGTH OF
 18248      CERT-NOTE-FILE
 18249       TO DFHEIV11
 18250     MOVE 'ERCNOT' TO DFHEIV1
 18251*    MOVE '&$ L                  ''  N#00016615' TO DFHEIV0
 18252     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18254     MOVE X'204E233030303136363135' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 349
* EL156.cbl
 18255     CALL 'kxdfhei1' USING DFHEIV0,
 18256           DFHEIV1,
 18257           CERT-NOTE-FILE,
 18258           DFHEIV11,
 18259           CZ-CONTROL-PRIMARY,
 18260           DFHEIV99,
 18261           DFHEIV99
 18262     MOVE EIBRESP  TO WS-RESPONSE
 18263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18264
 18265
 18266     IF WS-RESP-DUPREC
 18267         GO TO 7192-DUPREC
 18268     END-IF.
 18269
 18270     GO TO 7199-EXIT.
 18271
 18272 7192-DUPREC.
 18273
 18274     ADD +1                      TO  WRK-NOTE-SEQ.
 18275     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18276     GO TO 7191-WRITE.
 18277
 18278 7199-EXIT.
 18279      EXIT.
 18280 7200-FIND-BENEFIT.
 18281     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18282
 18283
 18284* EXEC CICS HANDLE CONDITION
 18285*        ENDFILE(7200-EXIT)
 18286*        NOTFND(7200-EXIT)
 18287*    END-EXEC.
 18288*    MOVE '"$''I                  ! ; #00016639' TO DFHEIV0
 18289     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18291     MOVE X'3B20233030303136363339' TO DFHEIV0(25:11)
 18292     CALL 'kxdfhei1' USING DFHEIV0
 18293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18294
 18295
 18296
 18297* EXEC CICS READ
 18298*        DATASET('ELCNTL')
 18299*        SET(ADDRESS OF CONTROL-FILE)
 18300*        RIDFLD(ELCNTL-KEY)
 18301*        GTEQ
 18302*    END-EXEC.
 18303     MOVE 'ELCNTL' TO DFHEIV1
 18304*    MOVE '&"S        G          (   #00016644' TO DFHEIV0
 18305     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18307     MOVE X'2020233030303136363434' TO DFHEIV0(25:11)
 18308     CALL 'kxdfhei1' USING DFHEIV0,
 18309           DFHEIV1,
 18310           DFHEIV20,
 18311           DFHEIV99,
 18312           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 350
* EL156.cbl
 18313           DFHEIV99,
 18314           DFHEIV99,
 18315           DFHEIV99
 18316     SET ADDRESS OF CONTROL-FILE TO
 18317         DFHEIV20
 18318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18319
 18320
 18321     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18322        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18323           GO TO 7200-EXIT.
 18324
 18325     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18326         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18327            ((SUB-1 > 8) OR
 18328            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18329
 18330     IF SUB-1 NOT = 9
 18331         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18332
 18333     GO TO 7200-EXIT.
 18334
 18335 7200-BENEFIT-DUMMY.
 18336
 18337 7200-DUMMY-EXIT.
 18338     EXIT.
 18339
 18340 7200-EXIT.
 18341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 351
* EL156.cbl
 18343*052506
 18344*052506 7250-FIND-LETTER-TRLR.
 18345*052506     EXEC CICS HANDLE CONDITION
 18346*052506         ENDFILE  (7250-END)
 18347*052506         NOTFND   (7250-END)
 18348*052506     END-EXEC.
 18349*052506
 18350*052506     EXEC CICS STARTBR
 18351*052506         DATASET   ('ELTRLR')
 18352*052506         RIDFLD    (ELTRLR-KEY)
 18353*052506         GTEQ
 18354*052506     END-EXEC.
 18355*052506
 18356*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18357*052506
 18358*052506 7250-FIND-LOOP.
 18359*052506     EXEC CICS READNEXT
 18360*052506         DATASET   ('ELTRLR')
 18361*052506         RIDFLD    (ELTRLR-KEY)
 18362*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18363*052506     END-EXEC.
 18364*052506
 18365*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18366*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18367*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18368*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18369*052506        GO TO 7250-END
 18370*052506     END-IF.
 18371*052506
 18372*052506     IF AT-TRAILER-TYPE NOT = '4'
 18373*052506         GO TO 7250-FIND-LOOP
 18374*052506     END-IF.
 18375*052506
 18376*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18377*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18378*052506     END-IF.
 18379*052506
 18380*052506     GO TO 7250-FIND-LOOP.
 18381*052506
 18382*052506 7250-END.
 18383*052506
 18384*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18385*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18386*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18387*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18388*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18389*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18390*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18391*052506     END-IF.
 18392*052506
 18393*052506     EXEC CICS ENDBR
 18394*052506          DATASET    ('ELTRLR')
 18395*052506     END-EXEC.
 18396*052506
 18397*052506 7250-EXIT.
 18398*052506     EXIT.
 18399*052506     EJECT
 18400*052506
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 352
* EL156.cbl
 18401 7300-CHECK-AUTO-ACTIVITY.
 18402
 18403     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18404         NEXT SENTENCE
 18405     ELSE
 18406         GO TO 7399-EXIT.
 18407
 18408     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18409
 18410     IF WS-ACT-REC-FOUND-SW = 'N'
 18411         GO TO 7399-EXIT.
 18412
 18413     IF PI-ACTIVITY-CODE = 09
 18414         GO TO 7300-CONT-AUTO-ACTIVITY.
 18415
 18416     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18417        (PI-ACTIVITY-CODE = 11)
 18418         GO TO 7300-CONT-AUTO-ACTIVITY.
 18419
 18420     IF PI-PROVISIONAL-IND = 'P'
 18421         IF PI-PMTTYPE = '1'
 18422             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18423                 MOVE 'N'    TO  PI-RESET-SW
 18424                 GO TO 7399-EXIT.
 18425
 18426     IF PI-PMTTYPE = '1'
 18427         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18428             MOVE 'N'        TO  PI-RESET-SW
 18429             GO TO 7399-EXIT.
 18430
 18431     IF PI-PMTTYPE = '2' OR '3'
 18432         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18433             MOVE 'N'        TO  PI-RESET-SW
 18434             GO TO 7399-EXIT.
 18435
 18436     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18437         IF PI-PROVISIONAL-IND = 'P'
 18438             NEXT SENTENCE
 18439         ELSE
 18440             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18441
 18442 7300-CONT-AUTO-ACTIVITY.
 18443
 18444     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18445         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18446         MOVE '4'            TO DC-OPTION-CODE
 18447         MOVE +0             TO DC-ELAPSED-DAYS
 18448                                DC-ELAPSED-MONTHS
 18449         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18450         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18451         IF PI-USES-PAID-TO
 18452             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18453             IF NO-CONVERSION-ERROR
 18454                 MOVE +1     TO DC-ELAPSED-DAYS
 18455                 MOVE +0     TO DC-ELAPSED-MONTHS
 18456                 MOVE '6'    TO DC-OPTION-CODE
 18457                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18458                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 353
* EL156.cbl
 18459                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18460
 18461     IF PI-PFKEY-USED = DFHPF5
 18462         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18463         IF PI-USES-PAID-TO
 18464             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18465             MOVE +1                  TO DC-ELAPSED-DAYS
 18466             MOVE +0                  TO DC-ELAPSED-MONTHS
 18467             MOVE '6'                 TO DC-OPTION-CODE
 18468             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18469             IF NO-CONVERSION-ERROR
 18470                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18471
 18472     IF WS-CHK-THRU-DT < PI-EXP-DT
 18473         NEXT SENTENCE
 18474     ELSE
 18475         MOVE 03                     TO  WS-ACTIVITY-CODE
 18476         GO TO 7390-PROCESS-ACTIVITY.
 18477
 18478     IF PI-PROV-PMT
 18479         MOVE 09                     TO  WS-ACTIVITY-CODE
 18480     ELSE
 18481        IF PI-PMTTYPE = '1'
 18482            MOVE 02                  TO  WS-ACTIVITY-CODE
 18483        ELSE
 18484        IF PI-PMTTYPE = '2' OR '3'
 18485            MOVE 07                  TO  WS-ACTIVITY-CODE
 18486        ELSE
 18487        IF PI-PMTTYPE = '4'
 18488            MOVE 00                  TO  WS-ACTIVITY-CODE
 18489        ELSE
 18490            MOVE 'N'                 TO  PI-RESET-SW
 18491            GO TO 7399-EXIT.
 18492
 18493 7390-PROCESS-ACTIVITY.
 18494
 18495     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18496
 18497 7399-EXIT.
 18498     EXIT.
 18499
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 354
* EL156.cbl
 18501 7400-CHECK-AUTO-ACTIVITY.
 18502
 18503
 18504* EXEC CICS HANDLE CONDITION
 18505*        NOTFND   (7400-NOT-FOUND)
 18506*    END-EXEC.
 18507*    MOVE '"$I                   ! < #00016833' TO DFHEIV0
 18508     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18510     MOVE X'3C20233030303136383333' TO DFHEIV0(25:11)
 18511     CALL 'kxdfhei1' USING DFHEIV0
 18512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18513
 18514
 18515     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18516     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18517     MOVE SPACES                 TO  CNTL-ACCESS.
 18518     MOVE +0                     TO  CNTL-SEQ-NO.
 18519
 18520
 18521* EXEC CICS READ
 18522*        DATASET   ('ELCNTL')
 18523*        RIDFLD    (ELCNTL-KEY)
 18524*        SET       (ADDRESS OF CONTROL-FILE)
 18525*    END-EXEC.
 18526     MOVE 'ELCNTL' TO DFHEIV1
 18527*    MOVE '&"S        E          (   #00016842' TO DFHEIV0
 18528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18530     MOVE X'2020233030303136383432' TO DFHEIV0(25:11)
 18531     CALL 'kxdfhei1' USING DFHEIV0,
 18532           DFHEIV1,
 18533           DFHEIV20,
 18534           DFHEIV99,
 18535           ELCNTL-KEY,
 18536           DFHEIV99,
 18537           DFHEIV99,
 18538           DFHEIV99
 18539     SET ADDRESS OF CONTROL-FILE TO
 18540         DFHEIV20
 18541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18542
 18543
 18544     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18545     GO TO 7400-EXIT.
 18546
 18547 7400-NOT-FOUND.
 18548     MOVE 'N'                        TO  PI-RESET-SW
 18549                                         WS-LETTER-SW
 18550                                         WS-ACT-REC-FOUND-SW.
 18551
 18552     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18553
 18554 7400-EXIT.
 18555     EXIT.
 18556
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 355
* EL156.cbl
 18558 7450-FORMAT-AUTO-LETTER.
 18559
 18560     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18561         MOVE 'Y'                    TO PI-RESET-SW
 18562         GO TO 7450-CONTINUE-PROCESS.
 18563
 18564     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18565
 18566     IF SUB > 9
 18567         SUBTRACT 9 FROM SUB
 18568         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18569     ELSE
 18570         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18571
 18572 7450-CONTINUE-PROCESS.
 18573
 18574     IF WS-ACTIVITY-CODE = ZEROS
 18575         MOVE 'N'                    TO  WS-LETTER-SW
 18576         GO TO 7450-EXIT.
 18577
 18578     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18579
 18580     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18581         MOVE 'N'                    TO  PI-RESET-SW
 18582                                         WS-LETTER-SW
 18583         GO TO 7450-EXIT.
 18584
 18585     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18586         MOVE 'N'                    TO  WS-LETTER-SW
 18587         GO TO 7450-EXIT.
 18588
 18589     MOVE 'Y'                        TO  WS-LETTER-SW.
 18590     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18591     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18592
 18593     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18594
 18595     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18596         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18597         MOVE '6'                    TO  DC-OPTION-CODE
 18598         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18599         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18600         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18601         IF NO-CONVERSION-ERROR
 18602             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18603         ELSE
 18604              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18605
 18606     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18607         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18608         MOVE '6'                    TO  DC-OPTION-CODE
 18609         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18610         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18611         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18612         IF NO-CONVERSION-ERROR
 18613             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18614         ELSE
 18615             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 356
* EL156.cbl
 18616
 18617 7450-EXIT.
 18618     EXIT.
 18619
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 357
* EL156.cbl
 18621 7500-RESET-AUTO-ACTIVITY.
 18622
 18623     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18624     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18625     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18626     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18627     MOVE +100                   TO  TRLR-SEQ-NO.
 18628
 18629 7500-STARTBR-TRLR.
 18630
 18631
 18632* EXEC CICS HANDLE CONDITION
 18633*        ENDFILE  (7590-END)
 18634*        NOTFND   (7590-END)
 18635*    END-EXEC.
 18636*    MOVE '"$''I                  ! = #00016935' TO DFHEIV0
 18637     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18639     MOVE X'3D20233030303136393335' TO DFHEIV0(25:11)
 18640     CALL 'kxdfhei1' USING DFHEIV0
 18641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18642
 18643
 18644
 18645* EXEC CICS STARTBR
 18646*        DATASET   ('ELTRLR')
 18647*        RIDFLD    (ELTRLR-KEY)
 18648*        GTEQ
 18649*    END-EXEC.
 18650     MOVE 'ELTRLR' TO DFHEIV1
 18651     MOVE 0
 18652       TO DFHEIV11
 18653*    MOVE '&,         G          &   #00016940' TO DFHEIV0
 18654     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18655     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18656     MOVE X'2020233030303136393430' TO DFHEIV0(25:11)
 18657     CALL 'kxdfhei1' USING DFHEIV0,
 18658           DFHEIV1,
 18659           ELTRLR-KEY,
 18660           DFHEIV99,
 18661           DFHEIV11,
 18662           DFHEIV99
 18663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18664
 18665
 18666     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18667
 18668 7500-READ-NEXT.
 18669
 18670
 18671* EXEC CICS READNEXT
 18672*        DATASET   ('ELTRLR')
 18673*        RIDFLD    (ELTRLR-KEY)
 18674*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18675*    END-EXEC.
 18676     MOVE 'ELTRLR' TO DFHEIV1
 18677     MOVE 0
 18678       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 358
* EL156.cbl
 18679*    MOVE '&.S                   )   #00016950' TO DFHEIV0
 18680     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18681     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18682     MOVE X'2020233030303136393530' TO DFHEIV0(25:11)
 18683     CALL 'kxdfhei1' USING DFHEIV0,
 18684           DFHEIV1,
 18685           DFHEIV20,
 18686           DFHEIV99,
 18687           ELTRLR-KEY,
 18688           DFHEIV99,
 18689           DFHEIV11,
 18690           DFHEIV99,
 18691           DFHEIV99
 18692     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18693         DFHEIV20
 18694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18695
 18696
 18697     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18698        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18699        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18700        PI-CERT-NO    NOT = TRLR-CERT-NO
 18701         GO TO 7590-END.
 18702
 18703     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18704         GO TO 7500-READ-NEXT.
 18705
 18706     IF AT-TRAILER-TYPE NOT = '4'
 18707         GO TO 7500-READ-NEXT.
 18708
 18709     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18710         GO TO 7500-READ-NEXT.
 18711
 18712     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18713        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18714         GO TO 7500-READ-NEXT.
 18715
 18716     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18717        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18718        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18719         GO TO 7500-READ-NEXT.
 18720
 18721     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18722                         AND
 18723        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18724                         AND
 18725        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18726            GO TO 7500-READ-NEXT.
 18727
 18728     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18729
 18730
 18731* EXEC CICS ENDBR
 18732*        DATASET   ('ELTRLR')
 18733*    END-EXEC.
 18734     MOVE 'ELTRLR' TO DFHEIV1
 18735     MOVE 0
 18736       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 359
* EL156.cbl
 18737*    MOVE '&2                    $   #00016989' TO DFHEIV0
 18738     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18739     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18740     MOVE X'2020233030303136393839' TO DFHEIV0(25:11)
 18741     CALL 'kxdfhei1' USING DFHEIV0,
 18742           DFHEIV1,
 18743           DFHEIV11,
 18744           DFHEIV99
 18745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18746
 18747
 18748     MOVE 'N'                        TO  WS-BROWSE-SW.
 18749
 18750
 18751* EXEC CICS READ
 18752*        DATASET   ('ELTRLR')
 18753*        RIDFLD    (ELTRLR-KEY)
 18754*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18755*        UPDATE
 18756*    END-EXEC.
 18757     MOVE 'ELTRLR' TO DFHEIV1
 18758*    MOVE '&"S        EU         (   #00016995' TO DFHEIV0
 18759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18760     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18761     MOVE X'2020233030303136393935' TO DFHEIV0(25:11)
 18762     CALL 'kxdfhei1' USING DFHEIV0,
 18763           DFHEIV1,
 18764           DFHEIV20,
 18765           DFHEIV99,
 18766           ELTRLR-KEY,
 18767           DFHEIV99,
 18768           DFHEIV99,
 18769           DFHEIV99
 18770     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18771         DFHEIV20
 18772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18773
 18774
 18775     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18776
 18777     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18778         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18779     ELSE
 18780         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18781             NEXT SENTENCE
 18782         ELSE
 18783             GO TO 7500-REWRITE-TRLR.
 18784
 18785     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18786
 18787     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18788     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18789     MOVE '1'                        TO  ARCH-REC-TYPE.
 18790     MOVE +0                         TO  ARCH-SEQ.
 18791
 18792     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18793
 18794 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 360
* EL156.cbl
 18795
 18796
 18797* EXEC CICS REWRITE
 18798*        DATASET   ('ELTRLR')
 18799*        FROM      (ACTIVITY-TRAILERS)
 18800*    END-EXEC.
 18801     MOVE LENGTH OF
 18802      ACTIVITY-TRAILERS
 18803       TO DFHEIV11
 18804     MOVE 'ELTRLR' TO DFHEIV1
 18805*    MOVE '&& L                  %   #00017023' TO DFHEIV0
 18806     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18807     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18808     MOVE X'2020233030303137303233' TO DFHEIV0(25:11)
 18809     CALL 'kxdfhei1' USING DFHEIV0,
 18810           DFHEIV1,
 18811           ACTIVITY-TRAILERS,
 18812           DFHEIV11,
 18813           DFHEIV99
 18814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18815
 18816
 18817     GO TO 7500-STARTBR-TRLR.
 18818
 18819 7590-END.
 18820
 18821     IF WS-BROWSE-SW = 'Y'
 18822         MOVE 'N'                    TO  WS-BROWSE-SW
 18823
 18824* EXEC CICS ENDBR
 18825*            DATASET   ('ELTRLR')
 18826*        END-EXEC.
 18827     MOVE 'ELTRLR' TO DFHEIV1
 18828     MOVE 0
 18829       TO DFHEIV11
 18830*    MOVE '&2                    $   #00017034' TO DFHEIV0
 18831     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18832     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18833     MOVE X'2020233030303137303334' TO DFHEIV0(25:11)
 18834     CALL 'kxdfhei1' USING DFHEIV0,
 18835           DFHEIV1,
 18836           DFHEIV11,
 18837           DFHEIV99
 18838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18839
 18840
 18841 7599-EXIT.
 18842     EXIT.
 18843
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 361
* EL156.cbl
 18845 7600-READ-ARCH-UPDATE.
 18846
 18847
 18848* EXEC CICS HANDLE CONDITION
 18849*        NOTFND   (7699-EXIT)
 18850*    END-EXEC.
 18851*    MOVE '"$I                   ! > #00017044' TO DFHEIV0
 18852     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18853     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18854     MOVE X'3E20233030303137303434' TO DFHEIV0(25:11)
 18855     CALL 'kxdfhei1' USING DFHEIV0
 18856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18857
 18858
 18859
 18860* EXEC CICS READ
 18861*        DATASET   ('ELARCH')
 18862*        RIDFLD    (ELARCH-KEY)
 18863*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18864*        UPDATE
 18865*    END-EXEC.
 18866     MOVE 'ELARCH' TO DFHEIV1
 18867*    MOVE '&"S        EU         (   #00017048' TO DFHEIV0
 18868     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18869     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18870     MOVE X'2020233030303137303438' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0,
 18872           DFHEIV1,
 18873           DFHEIV20,
 18874           DFHEIV99,
 18875           ELARCH-KEY,
 18876           DFHEIV99,
 18877           DFHEIV99,
 18878           DFHEIV99
 18879     SET ADDRESS OF LETTER-ARCHIVE TO
 18880         DFHEIV20
 18881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18882
 18883
 18884     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18885
 18886
 18887* EXEC CICS REWRITE
 18888*        DATASET   ('ELARCH')
 18889*        FROM      (LETTER-ARCHIVE)
 18890*    END-EXEC.
 18891     MOVE LENGTH OF
 18892      LETTER-ARCHIVE
 18893       TO DFHEIV11
 18894     MOVE 'ELARCH' TO DFHEIV1
 18895*    MOVE '&& L                  %   #00017057' TO DFHEIV0
 18896     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303137303537' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0,
 18900           DFHEIV1,
 18901           LETTER-ARCHIVE,
 18902           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 362
* EL156.cbl
 18903           DFHEIV99
 18904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18905
 18906
 18907 7699-EXIT.
 18908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 363
* EL156.cbl
 18910 7700-GET-DCT.
 18911
 18912     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18913     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18914     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18915     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18916                                    PI-MAX-BENEFIT-AMT
 18917                                    PI-MAX-BENEFIT-PYMT
 18918                                    PI-MIN-PAYMENT-AMT
 18919                                    PI-TIME-OF-LOSS-BAL.
 18920
 18921
 18922* EXEC CICS HANDLE CONDITION
 18923*         NOTFND (5300-NOTE-NOT-FOUND)
 18924*     END-EXEC.
 18925*    MOVE '"$I                   ! ? #00017076' TO DFHEIV0
 18926     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18928     MOVE X'3F20233030303137303736' TO DFHEIV0(25:11)
 18929     CALL 'kxdfhei1' USING DFHEIV0
 18930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18931
 18932
 18933
 18934* EXEC CICS READ
 18935*         DATASET('ERNOTE')
 18936*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18937*         RIDFLD (W-NOTE-KEY)
 18938*     END-EXEC.
 18939     MOVE 'ERNOTE' TO DFHEIV1
 18940*    MOVE '&"S        E          (   #00017080' TO DFHEIV0
 18941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18943     MOVE X'2020233030303137303830' TO DFHEIV0(25:11)
 18944     CALL 'kxdfhei1' USING DFHEIV0,
 18945           DFHEIV1,
 18946           DFHEIV20,
 18947           DFHEIV99,
 18948           W-NOTE-KEY,
 18949           DFHEIV99,
 18950           DFHEIV99,
 18951           DFHEIV99
 18952     SET ADDRESS OF CERTIFICATE-NOTE TO
 18953         DFHEIV20
 18954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18955
 18956
 18957     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18958     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18959     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18960     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18961     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18962
 18963     IF PI-PAYEE-TYPE NOT = 'B'
 18964         GO TO 7700-EXIT.
 18965
 18966     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18967     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 364
* EL156.cbl
 18968     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18969
 18970     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18971         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18972     ELSE
 18973         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18974
 18975     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18976     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18977     MOVE 'DLO006'               TO PGM-NAME.
 18978
 18979
 18980* EXEC CICS LINK
 18981*        PROGRAM    (PGM-NAME)
 18982*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18983*        LENGTH     (DCT-RCRD-LENGTH)
 18984*    END-EXEC.
 18985*    MOVE '."C                   (   #00017108' TO DFHEIV0
 18986     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18988     MOVE X'2020233030303137313038' TO DFHEIV0(25:11)
 18989     CALL 'kxdfhei1' USING DFHEIV0,
 18990           PGM-NAME,
 18991           DCT-COMMUNICATION-AREA,
 18992           DCT-RCRD-LENGTH,
 18993           DFHEIV99,
 18994           DFHEIV99,
 18995           DFHEIV99,
 18996           DFHEIV99
 18997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18998
 18999
 19000     IF DCT-RETURN-CODE = 'OK'
 19001         GO TO 7700-CONT.
 19002
 19003     IF DCT-RETURN-CODE = '01' OR '02'
 19004         GO TO 7700-SET-TO-YES.
 19005
 19006     IF DCT-RETURN-CODE = '03'
 19007
 19008* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19009*    MOVE '6"R                   !   #00017121' TO DFHEIV0
 19010     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19012     MOVE X'2020233030303137313231' TO DFHEIV0(25:11)
 19013     CALL 'kxdfhei1' USING DFHEIV0
 19014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19015         MOVE ER-0951            TO EMI-ERROR
 19016         MOVE -1                 TO PMTTYPEL
 19017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19018         GO TO 8200-SEND-DATAONLY.
 19019
 19020     IF DCT-RETURN-CODE = '04'
 19021
 19022* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19023*    MOVE '6"R                   !   #00017128' TO DFHEIV0
 19024     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 365
* EL156.cbl
 19026     MOVE X'2020233030303137313238' TO DFHEIV0(25:11)
 19027     CALL 'kxdfhei1' USING DFHEIV0
 19028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19029         MOVE ER-0946            TO EMI-ERROR
 19030         MOVE -1                 TO PMTTYPEL
 19031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19032         GO TO 8200-SEND-DATAONLY.
 19033
 19034     IF DCT-RETURN-CODE = '05'
 19035
 19036* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19037*    MOVE '6"R                   !   #00017135' TO DFHEIV0
 19038     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19039     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19040     MOVE X'2020233030303137313335' TO DFHEIV0(25:11)
 19041     CALL 'kxdfhei1' USING DFHEIV0
 19042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19043         MOVE ER-0947            TO EMI-ERROR
 19044         MOVE -1                 TO PMTTYPEL
 19045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19046         GO TO 8200-SEND-DATAONLY.
 19047
 19048     IF DCT-RETURN-CODE = '06'
 19049
 19050* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19051*    MOVE '6"R                   !   #00017142' TO DFHEIV0
 19052     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19054     MOVE X'2020233030303137313432' TO DFHEIV0(25:11)
 19055     CALL 'kxdfhei1' USING DFHEIV0
 19056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19057         MOVE ER-0921            TO EMI-ERROR
 19058         MOVE -1                 TO PMTTYPEL
 19059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19060         GO TO 8200-SEND-DATAONLY.
 19061
 19062     IF DCT-RETURN-CODE = '07'
 19063
 19064* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19065*    MOVE '6"R                   !   #00017149' TO DFHEIV0
 19066     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19068     MOVE X'2020233030303137313439' TO DFHEIV0(25:11)
 19069     CALL 'kxdfhei1' USING DFHEIV0
 19070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19071         MOVE ER-0919            TO EMI-ERROR
 19072         MOVE -1                 TO PMTTYPEL
 19073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19074         GO TO 8200-SEND-DATAONLY.
 19075
 19076     IF DCT-RETURN-CODE = '08'
 19077
 19078* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19079*    MOVE '6"R                   !   #00017156' TO DFHEIV0
 19080     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19082     MOVE X'2020233030303137313536' TO DFHEIV0(25:11)
 19083     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 366
* EL156.cbl
 19084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19085         MOVE ER-0948            TO EMI-ERROR
 19086         MOVE -1                 TO PMTTYPEL
 19087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19088         GO TO 8200-SEND-DATAONLY.
 19089
 19090     IF DCT-RETURN-CODE = 'N1'
 19091
 19092* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19093*    MOVE '6"R                   !   #00017163' TO DFHEIV0
 19094     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19096     MOVE X'2020233030303137313633' TO DFHEIV0(25:11)
 19097     CALL 'kxdfhei1' USING DFHEIV0
 19098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19099         MOVE ER-0950            TO EMI-ERROR
 19100         MOVE -1                 TO PMTTYPEL
 19101         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19102         GO TO 8200-SEND-DATAONLY.
 19103
 19104     IF DCT-RETURN-CODE = 'E1'
 19105
 19106* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19107*    MOVE '6"R                   !   #00017170' TO DFHEIV0
 19108     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19110     MOVE X'2020233030303137313730' TO DFHEIV0(25:11)
 19111     CALL 'kxdfhei1' USING DFHEIV0
 19112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19113         MOVE ER-0974            TO EMI-ERROR
 19114         MOVE -1                 TO PMTTYPEL
 19115         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19116         GO TO 8200-SEND-DATAONLY.
 19117
 19118     IF DCT-RETURN-CODE = 'E2'
 19119
 19120* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19121*    MOVE '6"R                   !   #00017177' TO DFHEIV0
 19122     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19124     MOVE X'2020233030303137313737' TO DFHEIV0(25:11)
 19125     CALL 'kxdfhei1' USING DFHEIV0
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19127         MOVE ER-0975            TO EMI-ERROR
 19128         MOVE -1                 TO PMTTYPEL
 19129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19130         GO TO 8200-SEND-DATAONLY.
 19131
 19132     IF DCT-RETURN-CODE NOT = 'OK'
 19133
 19134* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19135*    MOVE '6"R                   !   #00017184' TO DFHEIV0
 19136     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19137     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19138     MOVE X'2020233030303137313834' TO DFHEIV0(25:11)
 19139     CALL 'kxdfhei1' USING DFHEIV0
 19140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19141         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 367
* EL156.cbl
 19142         MOVE -1                 TO PMTTYPEL
 19143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19144         GO TO 8200-SEND-DATAONLY.
 19145
 19146 7700-CONT.
 19147
 19148*    MOVE 'N'                    TO CASHO.
 19149*    MOVE +1                     TO CASHL.
 19150*    MOVE AL-UANON               TO CASHA.
 19151
 19152     IF PI-OFFLINE = 'Y'
 19153         GO TO 7700-EXIT.
 19154
 19155     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19156     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19157     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19158     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19159     MOVE +7                     TO CHECKNOL.
 19160     MOVE AL-UANON               TO CHECKNOA.
 19161     GO TO 7700-EXIT.
 19162
 19163 7700-SET-TO-YES.
 19164
 19165*    MOVE 'Y'                    TO CASHO.
 19166*    MOVE +1                     TO CASHL.
 19167*    MOVE AL-UANON               TO CASHA.
 19168
 19169 7700-EXIT.
 19170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 368
* EL156.cbl
 19172 7800-READ-COMP-MSTR.
 19173
 19174
 19175* EXEC CICS HANDLE CONDITION
 19176*        NOTFND   (7800-COMP-NOTFND)
 19177*    END-EXEC.
 19178*    MOVE '"$I                   ! @ #00017218' TO DFHEIV0
 19179     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19181     MOVE X'4020233030303137323138' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0
 19183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19184
 19185
 19186
 19187* EXEC CICS READ
 19188*        DATASET   ('ERCOMP')
 19189*        RIDFLD    (ERCOMP-KEY)
 19190*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19191*    END-EXEC.
 19192     MOVE 'ERCOMP' TO DFHEIV1
 19193*    MOVE '&"S        E          (   #00017222' TO DFHEIV0
 19194     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19195     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19196     MOVE X'2020233030303137323232' TO DFHEIV0(25:11)
 19197     CALL 'kxdfhei1' USING DFHEIV0,
 19198           DFHEIV1,
 19199           DFHEIV20,
 19200           DFHEIV99,
 19201           ERCOMP-KEY,
 19202           DFHEIV99,
 19203           DFHEIV99,
 19204           DFHEIV99
 19205     SET ADDRESS OF COMPENSATION-MASTER TO
 19206         DFHEIV20
 19207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19208
 19209
 19210     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19211     GO TO 7800-COMP-EXIT.
 19212
 19213 7800-COMP-NOTFND.
 19214     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19215
 19216 7800-COMP-EXIT.
 19217     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 369
* EL156.cbl
 19219 7900-READ-CLAIM.
 19220
 19221* EXEC CICS READ
 19222*        DATASET  ('ELMSTR')
 19223*        SET      (ADDRESS OF CLAIM-MASTER)
 19224*        RIDFLD   (ELMSTR-KEY)
 19225*    END-EXEC.
 19226     MOVE 'ELMSTR' TO DFHEIV1
 19227*    MOVE '&"S        E          (   #00017238' TO DFHEIV0
 19228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137323338' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           DFHEIV20,
 19234           DFHEIV99,
 19235           ELMSTR-KEY,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     SET ADDRESS OF CLAIM-MASTER TO
 19240         DFHEIV20
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244 7900-EXIT.
 19245      EXIT.
 19246
 19247 7910-READ-CLAIM-UPDATE.
 19248
 19249* EXEC CICS READ
 19250*        DATASET  ('ELMSTR')
 19251*        SET      (ADDRESS OF CLAIM-MASTER)
 19252*        RIDFLD   (ELMSTR-KEY)
 19253*        UPDATE
 19254*    END-EXEC.
 19255     MOVE 'ELMSTR' TO DFHEIV1
 19256*    MOVE '&"S        EU         (   #00017248' TO DFHEIV0
 19257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303137323438' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           DFHEIV1,
 19262           DFHEIV20,
 19263           DFHEIV99,
 19264           ELMSTR-KEY,
 19265           DFHEIV99,
 19266           DFHEIV99,
 19267           DFHEIV99
 19268     SET ADDRESS OF CLAIM-MASTER TO
 19269         DFHEIV20
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273 7910-EXIT.
 19274      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 370
* EL156.cbl
 19276 7920-READ-BENE.
 19277     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19278     MOVE 'B'                TO BENE-RECORD-TYPE.
 19279     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19280
 19281     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19282        IF PI-PAYEE-TYPE    = 'B' AND
 19283           PI-PAYEE-SEQ-NUM = 9
 19284             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19285             MOVE WS-A-BENE           TO BENE-NUMBER.
 19286
 19287
 19288* EXEC CICS HANDLE CONDITION
 19289*        NOTFND   (7920-NOT-FOUND)
 19290*    END-EXEC.
 19291*    MOVE '"$I                   ! A #00017269' TO DFHEIV0
 19292     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19294     MOVE X'4120233030303137323639' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0
 19296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19297
 19298
 19299
 19300* EXEC CICS READ
 19301*        DATASET  ('ELBENE')
 19302*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19303*        RIDFLD   (ELBENE-KEY)
 19304*    END-EXEC.
 19305     MOVE 'ELBENE' TO DFHEIV1
 19306*    MOVE '&"S        E          (   #00017273' TO DFHEIV0
 19307     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303137323733' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           DFHEIV1,
 19312           DFHEIV20,
 19313           DFHEIV99,
 19314           ELBENE-KEY,
 19315           DFHEIV99,
 19316           DFHEIV99,
 19317           DFHEIV99
 19318     SET ADDRESS OF BENEFICIARY-MASTER TO
 19319         DFHEIV20
 19320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19321
 19322
 19323     MOVE 'Y' TO BENE-FOUND-SW.
 19324     GO TO 7920-EXIT.
 19325
 19326 7920-NOT-FOUND.
 19327     MOVE 'N'                    TO BENE-FOUND-SW.
 19328
 19329 7920-EXIT.
 19330      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 371
* EL156.cbl
 19332 7930-READ-CONTROL.
 19333
 19334* EXEC CICS READ
 19335*        DATASET  ('ELCNTL')
 19336*        SET      (ADDRESS OF CONTROL-FILE)
 19337*        RIDFLD   (ELCNTL-KEY)
 19338*    END-EXEC.
 19339     MOVE 'ELCNTL' TO DFHEIV1
 19340*    MOVE '&"S        E          (   #00017289' TO DFHEIV0
 19341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19343     MOVE X'2020233030303137323839' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0,
 19345           DFHEIV1,
 19346           DFHEIV20,
 19347           DFHEIV99,
 19348           ELCNTL-KEY,
 19349           DFHEIV99,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     SET ADDRESS OF CONTROL-FILE TO
 19353         DFHEIV20
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357 7930-EXIT.
 19358      EXIT.
 19359
 19360 7940-READ-CONTROL-UPDATE.
 19361
 19362* EXEC CICS READ
 19363*        DATASET  ('ELCNTL')
 19364*        SET      (ADDRESS OF CONTROL-FILE)
 19365*        RIDFLD   (ELCNTL-KEY)
 19366*        UPDATE
 19367*    END-EXEC.
 19368     MOVE 'ELCNTL' TO DFHEIV1
 19369*    MOVE '&"S        EU         (   #00017299' TO DFHEIV0
 19370     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19371     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19372     MOVE X'2020233030303137323939' TO DFHEIV0(25:11)
 19373     CALL 'kxdfhei1' USING DFHEIV0,
 19374           DFHEIV1,
 19375           DFHEIV20,
 19376           DFHEIV99,
 19377           ELCNTL-KEY,
 19378           DFHEIV99,
 19379           DFHEIV99,
 19380           DFHEIV99
 19381     SET ADDRESS OF CONTROL-FILE TO
 19382         DFHEIV20
 19383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19384
 19385
 19386 7940-EXIT.
 19387      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 372
* EL156.cbl
 19389 7950-READ-TRAILER.
 19390
 19391* EXEC CICS READ
 19392*        DATASET  ('ELTRLR')
 19393*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19394*        RIDFLD   (ELTRLR-KEY)
 19395*    END-EXEC.
 19396     MOVE 'ELTRLR' TO DFHEIV1
 19397*    MOVE '&"S        E          (   #00017310' TO DFHEIV0
 19398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19400     MOVE X'2020233030303137333130' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0,
 19402           DFHEIV1,
 19403           DFHEIV20,
 19404           DFHEIV99,
 19405           ELTRLR-KEY,
 19406           DFHEIV99,
 19407           DFHEIV99,
 19408           DFHEIV99
 19409     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19410         DFHEIV20
 19411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19412
 19413
 19414 7950-EXIT.
 19415      EXIT.
 19416
 19417 7960-READ-TRAILER-UPDATE.
 19418
 19419* EXEC CICS READ
 19420*        DATASET  ('ELTRLR')
 19421*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19422*        RIDFLD   (ELTRLR-KEY)
 19423*        UPDATE
 19424*    END-EXEC.
 19425     MOVE 'ELTRLR' TO DFHEIV1
 19426*    MOVE '&"S        EU         (   #00017320' TO DFHEIV0
 19427     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19428     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19429     MOVE X'2020233030303137333230' TO DFHEIV0(25:11)
 19430     CALL 'kxdfhei1' USING DFHEIV0,
 19431           DFHEIV1,
 19432           DFHEIV20,
 19433           DFHEIV99,
 19434           ELTRLR-KEY,
 19435           DFHEIV99,
 19436           DFHEIV99,
 19437           DFHEIV99
 19438     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19439         DFHEIV20
 19440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19441
 19442
 19443 7960-EXIT.
 19444      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 373
* EL156.cbl
 19446 7970-READ-CERT.
 19447
 19448* EXEC CICS READ
 19449*        DATASET  ('ELCERT')
 19450*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19451*        RIDFLD   (ELCERT-KEY)
 19452*    END-EXEC.
 19453     MOVE 'ELCERT' TO DFHEIV1
 19454*    MOVE '&"S        E          (   #00017331' TO DFHEIV0
 19455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19457     MOVE X'2020233030303137333331' TO DFHEIV0(25:11)
 19458     CALL 'kxdfhei1' USING DFHEIV0,
 19459           DFHEIV1,
 19460           DFHEIV20,
 19461           DFHEIV99,
 19462           ELCERT-KEY,
 19463           DFHEIV99,
 19464           DFHEIV99,
 19465           DFHEIV99
 19466     SET ADDRESS OF CERTIFICATE-MASTER TO
 19467         DFHEIV20
 19468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19469
 19470
 19471 7970-EXIT.
 19472      EXIT.
 19473 7975-read-acct.
 19474
 19475     move spaces              to WS-ACCT-RECORD-SW
 19476                                 pi-dcc-product-code
 19477
 19478     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19479     MOVE PI-CARRIER          TO ACCT-CARRIER
 19480     MOVE PI-GROUPING         TO ACCT-GROUPING
 19481     MOVE PI-STATE            TO ACCT-STATE
 19482     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19483     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19484     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19485     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19486
 19487
 19488* EXEC CICS READ
 19489*       DATASET ('ERACCT')
 19490*       RIDFLD  (ERACCT-KEY)
 19491*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19492*       GTEQ
 19493*       resp    (WS-RESPONSE)
 19494*    END-EXEC
 19495     MOVE 'ERACCT' TO DFHEIV1
 19496*    MOVE '&"S        G          (  N#00017353' TO DFHEIV0
 19497     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19499     MOVE X'204E233030303137333533' TO DFHEIV0(25:11)
 19500     CALL 'kxdfhei1' USING DFHEIV0,
 19501           DFHEIV1,
 19502           DFHEIV20,
 19503           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 374
* EL156.cbl
 19504           ERACCT-KEY,
 19505           DFHEIV99,
 19506           DFHEIV99,
 19507           DFHEIV99
 19508     SET ADDRESS OF ACCOUNT-MASTER TO
 19509         DFHEIV20
 19510     MOVE EIBRESP  TO WS-RESPONSE
 19511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19512     IF WS-RESP-NORMAL
 19513        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19514        and pi-cert-eff-dt < am-expiration-dt
 19515        and pi-cert-eff-dt >= am-effective-dt
 19516        move am-dcc-product-code to pi-dcc-product-code
 19517        set acct-found to true
 19518     end-if
 19519
 19520     .
 19521 7975-exit.
 19522     exit.
 19523 7980-READ-CERT-UPDATE.
 19524
 19525* EXEC CICS READ
 19526*        DATASET  ('ELCERT')
 19527*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19528*        RIDFLD   (ELCERT-KEY)
 19529*        UPDATE
 19530*    END-EXEC.
 19531     MOVE 'ELCERT' TO DFHEIV1
 19532*    MOVE '&"S        EU         (   #00017372' TO DFHEIV0
 19533     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19534     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19535     MOVE X'2020233030303137333732' TO DFHEIV0(25:11)
 19536     CALL 'kxdfhei1' USING DFHEIV0,
 19537           DFHEIV1,
 19538           DFHEIV20,
 19539           DFHEIV99,
 19540           ELCERT-KEY,
 19541           DFHEIV99,
 19542           DFHEIV99,
 19543           DFHEIV99
 19544     SET ADDRESS OF CERTIFICATE-MASTER TO
 19545         DFHEIV20
 19546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19547
 19548
 19549 7980-EXIT.
 19550      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 375
* EL156.cbl
 19552 8000-LOAD-ERROR-MESSAGES.
 19553     IF PI-PASS-SW = 'C'
 19554        MOVE EMI-LINE1           TO ERMSG1BO
 19555     ELSE
 19556        MOVE EMI-LINE1           TO ERRMSG1O
 19557        MOVE EMI-LINE2           TO ERRMSG2O.
 19558
 19559 8000-EXIT.
 19560     EXIT.
 19561
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 376
* EL156.cbl
 19563
 19564 8010-DMD-ERROR-CHECKS.
 19565     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19566
 19567     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19568         GO TO 8051-ISSUE-ERROR.
 19569
 19570     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19571     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19572     MOVE '3'                    TO DC-OPTION-CODE.
 19573     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19574     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19575         GO TO 8051-ISSUE-ERROR.
 19576
 19577     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19578       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19579                           OR
 19580          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19581           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19582             MOVE ER-0851         TO EMI-ERROR
 19583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19584       END-IF
 19585       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19586             MOVE ER-8147         TO EMI-ERROR
 19587             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19588
 19589     GO TO 8090-EXIT.
 19590
 19591 8051-ISSUE-ERROR.
 19592     MOVE ER-8146            TO EMI-ERROR.
 19593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19594     GO TO 8090-EXIT.
 19595
 19596 8090-EXIT.
 19597      EXIT.
 19598
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 377
* EL156.cbl
 19600 8100-SEND-INITIAL-MAP.
 19601
 19602     MOVE SAVE-DATE              TO RUNDTEAO.
 19603     MOVE EIBTIME                TO TIME-IN.
 19604     MOVE TIME-OUT               TO RUNTIMAO.
 19605     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19606
 19607     IF MAP-NAME = 'EL156A'
 19608        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19609           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19610        END-IF
 19611     END-IF
 19612*    IF MAP-NAME = 'EL156A'
 19613*       IF PI-COMPANY-ID = 'CRI'
 19614*          NEXT SENTENCE
 19615*       ELSE
 19616*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19617
 19618     IF MAP-NAME = 'EL156A'
 19619        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19620           NEXT SENTENCE
 19621        ELSE
 19622           MOVE AL-SADOF TO  PINTA    PINTHA.
 19623
 19624     IF MAP-NAME = 'EL156A'
 19625        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19626            NEXT SENTENCE
 19627        ELSE
 19628           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19629
 19630*    IF MAP-NAME = 'EL156A'
 19631*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19632*          NEXT SENTENCE
 19633*       ELSE
 19634*          MOVE AL-SADOF TO CASHHA CASHA.
 19635
 19636     IF MAP-NAME = 'EL156A'
 19637        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19638           NEXT SENTENCE
 19639        ELSE
 19640           MOVE AL-SADOF        TO  LOANHA
 19641                                    LOANNOA.
 19642
 19643     IF MAP-NAME = 'EL156A'
 19644        MOVE -1                 TO  ENTERPFL
 19645        IF PI-USES-PAID-TO
 19646           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19647           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19648           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19649        ELSE
 19650           NEXT SENTENCE
 19651     ELSE
 19652        IF MAP-NAME = 'EL156B'
 19653           IF PI-USES-PAID-TO
 19654              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19655              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19656
 19657
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 378
* EL156.cbl
 19658* EXEC CICS SEND
 19659*        MAP   (MAP-NAME)
 19660*        MAPSET(MAPSET-NAME)
 19661*        FROM  (EL156AI)
 19662*        ERASE
 19663*        CURSOR
 19664*    END-EXEC.
 19665     MOVE LENGTH OF
 19666      EL156AI
 19667       TO DFHEIV12
 19668     MOVE -1
 19669       TO DFHEIV11
 19670*    MOVE '8$     CT  E    H L F ,   #00017487' TO DFHEIV0
 19671     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19672     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19673     MOVE X'2020233030303137343837' TO DFHEIV0(25:11)
 19674     CALL 'kxdfhei1' USING DFHEIV0,
 19675           MAP-NAME,
 19676           EL156AI,
 19677           DFHEIV12,
 19678           MAPSET-NAME,
 19679           DFHEIV99,
 19680           DFHEIV99,
 19681           DFHEIV99,
 19682           DFHEIV11,
 19683           DFHEIV99,
 19684           DFHEIV99,
 19685           DFHEIV99
 19686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19687
 19688
 19689     GO TO 9100-RETURN-TRAN.
 19690
 19691 8200-SEND-DATAONLY.
 19692
 19693     IF FIRST-ENTRY = 'Y'
 19694         GO TO 8100-SEND-INITIAL-MAP.
 19695
 19696     IF RETURNED-FROM-B = 'Y'
 19697         GO TO 8100-SEND-INITIAL-MAP.
 19698
 19699     MOVE SAVE-DATE              TO RUNDTEAO.
 19700     MOVE EIBTIME                TO TIME-IN.
 19701     MOVE TIME-OUT               TO RUNTIMAO.
 19702
 19703     IF EIBAID = DFHPF11
 19704        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19705        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19706        MOVE 'EL001   '          TO RETURNED-FROM
 19707        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19708        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19709        GO TO 8100-SEND-INITIAL-MAP.
 19710
 19711     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19712
 19713     IF MAP-NAME =  'EL156A'
 19714        MOVE -1                 TO  ENTERPFL
 19715        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 379
* EL156.cbl
 19716           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19717           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19718           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19719        ELSE
 19720           NEXT SENTENCE
 19721     ELSE
 19722        IF MAP-NAME = 'EL156B'
 19723           IF PI-USES-PAID-TO
 19724              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19725              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19726
 19727     IF MAP-NAME =  'EL156A'
 19728        IF PI-COMPANY-ID = 'BOA'
 19729            IF PI-INT-RATE NUMERIC
 19730                MOVE PI-INT-RATE TO PINTO.
 19731     IF MAP-NAME = 'EL156A'
 19732        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19733           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19734*          MOVE 'Y'              TO EOBYNO
 19735        END-IF
 19736     END-IF
 19737
 19738
 19739* EXEC CICS SEND
 19740*        MAP   (MAP-NAME)
 19741*        MAPSET(MAPSET-NAME)
 19742*        FROM  (EL156AI)
 19743*        DATAONLY
 19744*        CURSOR
 19745*    END-EXEC.
 19746     MOVE LENGTH OF
 19747      EL156AI
 19748       TO DFHEIV12
 19749     MOVE -1
 19750       TO DFHEIV11
 19751*    MOVE '8$D    CT       H L F ,   #00017544' TO DFHEIV0
 19752     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19753     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19754     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 19755     CALL 'kxdfhei1' USING DFHEIV0,
 19756           MAP-NAME,
 19757           EL156AI,
 19758           DFHEIV12,
 19759           MAPSET-NAME,
 19760           DFHEIV99,
 19761           DFHEIV99,
 19762           DFHEIV99,
 19763           DFHEIV11,
 19764           DFHEIV99,
 19765           DFHEIV99,
 19766           DFHEIV99
 19767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19768
 19769
 19770     GO TO 9100-RETURN-TRAN.
 19771
 19772 8300-SEND-TEXT.
 19773
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 380
* EL156.cbl
 19774* EXEC CICS SEND TEXT
 19775*        FROM(LOGOFF-TEXT)
 19776*        LENGTH(LOGOFF-LENGTH)
 19777*        ERASE
 19778*        FREEKB
 19779*    END-EXEC.
 19780*    MOVE '8&      T  E F  H   F -   #00017555' TO DFHEIV0
 19781     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19782     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19783     MOVE X'2020233030303137353535' TO DFHEIV0(25:11)
 19784     CALL 'kxdfhei1' USING DFHEIV0,
 19785           LOGOFF-TEXT,
 19786           LOGOFF-LENGTH,
 19787           DFHEIV99,
 19788           DFHEIV99,
 19789           DFHEIV99,
 19790           DFHEIV99,
 19791           DFHEIV99,
 19792           DFHEIV99,
 19793           DFHEIV99,
 19794           DFHEIV99,
 19795           DFHEIV99,
 19796           DFHEIV99
 19797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19798
 19799
 19800
 19801* EXEC CICS RETURN
 19802*    END-EXEC.
 19803*    MOVE '.(                    ''   #00017562' TO DFHEIV0
 19804     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19806     MOVE X'2020233030303137353632' TO DFHEIV0(25:11)
 19807     CALL 'kxdfhei1' USING DFHEIV0,
 19808           DFHEIV99,
 19809           DFHEIV99,
 19810           DFHEIV99,
 19811           DFHEIV99,
 19812           DFHEIV99,
 19813           DFHEIV99
 19814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19815
 19816
 19817 8500-FILE-NOTOPEN.
 19818     IF FILE-SWITCH = 'MSTR'
 19819         MOVE ER-0154            TO EMI-ERROR.
 19820     IF FILE-SWITCH = 'TRLR'
 19821         MOVE ER-0172            TO EMI-ERROR.
 19822     IF FILE-SWITCH = 'CERT'
 19823         MOVE ER-0169            TO EMI-ERROR.
 19824     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19825                      'PROC' OR 'STAT'
 19826         MOVE ER-0042            TO EMI-ERROR.
 19827     IF FILE-SWITCH = 'ACTQ'
 19828         MOVE ER-0338            TO EMI-ERROR.
 19829     IF FILE-SWITCH = 'ACCT'
 19830         MOVE ER-0168            TO EMI-ERROR.
 19831
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 381
* EL156.cbl
 19832     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19833     MOVE -1                     TO PMTTYPEL.
 19834
 19835     IF FIRST-ENTRY = 'Y'
 19836         GO TO 8100-SEND-INITIAL-MAP.
 19837
 19838     GO TO 8200-SEND-DATAONLY.
 19839
 19840 8600-PGRM-NOT-FOUND.
 19841
 19842     MOVE ER-0923                TO EMI-ERROR.
 19843     MOVE -1                     TO ENTPFBL.
 19844     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19845
 19846     IF FIRST-ENTRY = 'Y'
 19847         GO TO 8100-SEND-INITIAL-MAP
 19848     ELSE
 19849         GO TO 8200-SEND-DATAONLY.
 19850
 19851 8800-UNAUTHORIZED-ACCESS.
 19852     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19853     GO TO 8300-SEND-TEXT.
 19854
 19855 8810-PF23.
 19856     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19857     MOVE XCTL-005               TO PGM-NAME.
 19858     GO TO 9300-XCTL.
 19859
 19860 8820-PF7-8.
 19861     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19862     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19863                                    PI-SAVED-PROGRAM-2
 19864                                    PI-SAVED-PROGRAM-3
 19865                                    PI-SAVED-PROGRAM-4
 19866                                    PI-SAVED-PROGRAM-5
 19867                                    PI-SAVED-PROGRAM-6
 19868                                    PI-RETURN-TO-PROGRAM.
 19869     IF EIBAID = DFHPF8
 19870        MOVE XCTL-132            TO PGM-NAME
 19871     ELSE
 19872        MOVE XCTL-130            TO PGM-NAME.
 19873
 19874     GO TO 9300-XCTL.
 19875
 19876 9100-RETURN-TRAN.
 19877     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19878     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19879
 19880
 19881* EXEC CICS RETURN
 19882*        TRANSID(TRANS-ID)
 19883*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19884*        LENGTH(PI-COMM-LENGTH)
 19885*    END-EXEC.
 19886*    MOVE '.(CT                  ''   #00017628' TO DFHEIV0
 19887     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19889     MOVE X'2020233030303137363238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 382
* EL156.cbl
 19890     CALL 'kxdfhei1' USING DFHEIV0,
 19891           TRANS-ID,
 19892           PROGRAM-INTERFACE-BLOCK,
 19893           PI-COMM-LENGTH,
 19894           DFHEIV99,
 19895           DFHEIV99,
 19896           DFHEIV99
 19897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19898
 19899
 19900 9200-RETURN-MAIN-MENU.
 19901     MOVE XCTL-126               TO PGM-NAME.
 19902     GO TO 9300-XCTL.
 19903
 19904 9300-XCTL.
 19905
 19906* EXEC CICS XCTL
 19907*        PROGRAM(PGM-NAME)
 19908*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19909*        LENGTH(PI-COMM-LENGTH)
 19910*    END-EXEC.
 19911*    MOVE '.$C                   %   #00017639' TO DFHEIV0
 19912     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19913     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19914     MOVE X'2020233030303137363339' TO DFHEIV0(25:11)
 19915     CALL 'kxdfhei1' USING DFHEIV0,
 19916           PGM-NAME,
 19917           PROGRAM-INTERFACE-BLOCK,
 19918           PI-COMM-LENGTH,
 19919           DFHEIV99
 19920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19921
 19922
 19923 9400-CLEAR.
 19924     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19925     GO TO 9300-XCTL.
 19926
 19927 9500-PF12.
 19928     MOVE XCTL-010               TO PGM-NAME.
 19929     GO TO 9300-XCTL.
 19930
 19931 9700-LINK-DATE-CONVERT.
 19932     MOVE LINK-ELDATCV           TO PGM-NAME.
 19933
 19934* EXEC CICS LINK
 19935*        PROGRAM   (PGM-NAME)
 19936*        COMMAREA  (DATE-CONVERSION-DATA)
 19937*        LENGTH    (DC-COMM-LENGTH)
 19938*    END-EXEC.
 19939*    MOVE '."C                   (   #00017655' TO DFHEIV0
 19940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19942     MOVE X'2020233030303137363535' TO DFHEIV0(25:11)
 19943     CALL 'kxdfhei1' USING DFHEIV0,
 19944           PGM-NAME,
 19945           DATE-CONVERSION-DATA,
 19946           DC-COMM-LENGTH,
 19947           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 383
* EL156.cbl
 19948           DFHEIV99,
 19949           DFHEIV99,
 19950           DFHEIV99
 19951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19952
 19953
 19954 9700-EXIT.
 19955     EXIT.
 19956
 19957 9800-LINK-REM-TERM.
 19958     MOVE LINK-REMTERM TO PGM-NAME.
 19959
 19960
 19961* EXEC CICS LINK
 19962*        PROGRAM   (PGM-NAME)
 19963*        COMMAREA  (CALCULATION-PASS-AREA)
 19964*        LENGTH    (CP-COMM-LENGTH)
 19965*    END-EXEC.
 19966*    MOVE '."C                   (   #00017667' TO DFHEIV0
 19967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19969     MOVE X'2020233030303137363637' TO DFHEIV0(25:11)
 19970     CALL 'kxdfhei1' USING DFHEIV0,
 19971           PGM-NAME,
 19972           CALCULATION-PASS-AREA,
 19973           CP-COMM-LENGTH,
 19974           DFHEIV99,
 19975           DFHEIV99,
 19976           DFHEIV99,
 19977           DFHEIV99
 19978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19979
 19980
 19981 9800-EXIT.
 19982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 384
* EL156.cbl
 19984 9830-DMD-REMAINING-TERM.
 19985
 19986     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19987         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19988
 19989     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19990                              CM-PMT-EXTENSION-DAYS.
 19991
 19992     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19993                                  CL-NO-OF-DAYS-PAID.
 19994
 19995     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19996         GIVING W-REM REMAINDER W-REM-DAYS.
 19997
 19998     MOVE W-REM                  TO WST-REM.
 19999
 20000     IF W-REM-DAYS > ZEROS
 20001         MOVE '/'                TO WST-SLASH
 20002         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20003     ELSE
 20004         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20005
 20006 9830-EXIT.
 20007     EXIT.
 20008
 20009 9870-OUTPUT-ACTIVITY-RECORD.
 20010
 20011
 20012* EXEC CICS GETMAIN
 20013*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20014*         LENGTH(25)
 20015*         INITIMG(WS-BLANK)
 20016*    END-EXEC.
 20017     MOVE 25
 20018       TO DFHEIV11
 20019*    MOVE ',"IL                  $   #00017703' TO DFHEIV0
 20020     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20022     MOVE X'2020233030303137373033' TO DFHEIV0(25:11)
 20023     CALL 'kxdfhei1' USING DFHEIV0,
 20024           DFHEIV20,
 20025           DFHEIV11,
 20026           WS-BLANK
 20027     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20028         DFHEIV20
 20029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20030
 20031
 20032     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20033     MOVE ELMSTR-KEY             TO DA-KEY.
 20034     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20035
 20036     IF PI-PMTTYPE EQUAL '7'
 20037         MOVE 'V'                TO DA-RECORD-TYPE
 20038     ELSE
 20039         MOVE 'P'                TO DA-RECORD-TYPE.
 20040
 20041
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 385
* EL156.cbl
 20042* EXEC CICS HANDLE CONDITION
 20043*         NOTOPEN(9870-NOTOPEN)
 20044*         DUPREC(9870-EXIT)
 20045*    END-EXEC.
 20046*    MOVE '"$J%                  ! B #00017718' TO DFHEIV0
 20047     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20049     MOVE X'4220233030303137373138' TO DFHEIV0(25:11)
 20050     CALL 'kxdfhei1' USING DFHEIV0
 20051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20052
 20053
 20054
 20055* EXEC CICS WRITE
 20056*         DATASET('DLYACTV')
 20057*         RIDFLD(DA-KEY)
 20058*         FROM(DAILY-ACTIVITY-RECORD)
 20059*         LENGTH(25)
 20060*    END-EXEC.
 20061     MOVE 'DLYACTV' TO DFHEIV1
 20062     MOVE 25
 20063       TO DFHEIV11
 20064*    MOVE '&$ L                  ''   #00017723' TO DFHEIV0
 20065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20067     MOVE X'2020233030303137373233' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0,
 20069           DFHEIV1,
 20070           DAILY-ACTIVITY-RECORD,
 20071           DFHEIV11,
 20072           DA-KEY,
 20073           DFHEIV99,
 20074           DFHEIV99
 20075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20076
 20077     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20078     GO TO 9870-EXIT.
 20079
 20080 9870-NOTOPEN.
 20081
 20082     MOVE '2955'                 TO EMI-ERROR.
 20083     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20084
 20085 9870-EXIT.
 20086     EXIT.
 20087
 20088 9900-ERROR-FORMAT.
 20089
 20090     IF EMI-ERROR = ER-0923
 20091         MOVE PGM-NAME           TO W-CALLED-NAME.
 20092
 20093     MOVE LINK-001      TO PGM-NAME.
 20094     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20095
 20096
 20097* EXEC CICS LINK
 20098*        PROGRAM (PGM-NAME)
 20099*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 386
* EL156.cbl
 20100*        LENGTH  (EMI-COMM-LENGTH)
 20101*    END-EXEC.
 20102*    MOVE '."C                   (   #00017748' TO DFHEIV0
 20103     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20104     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20105     MOVE X'2020233030303137373438' TO DFHEIV0(25:11)
 20106     CALL 'kxdfhei1' USING DFHEIV0,
 20107           PGM-NAME,
 20108           ERROR-MESSAGE-INTERFACE-BLOCK,
 20109           EMI-COMM-LENGTH,
 20110           DFHEIV99,
 20111           DFHEIV99,
 20112           DFHEIV99,
 20113           DFHEIV99
 20114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20115
 20116
 20117     IF EMI-ERROR = ER-0923
 20118         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20119
 20120 9900-EXIT.
 20121     EXIT.
 20122
 20123 9990-ABEND.
 20124     MOVE LINK-004               TO PGM-NAME.
 20125     MOVE DFHEIBLK               TO EMI-LINE1.
 20126
 20127* EXEC CICS LINK
 20128*        PROGRAM   (PGM-NAME)
 20129*        COMMAREA  (EMI-LINE1)
 20130*        LENGTH    (64)
 20131*    END-EXEC.
 20132     MOVE 64
 20133       TO DFHEIV11
 20134*    MOVE '."C                   (   #00017763' TO DFHEIV0
 20135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20137     MOVE X'2020233030303137373633' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0,
 20139           PGM-NAME,
 20140           EMI-LINE1,
 20141           DFHEIV11,
 20142           DFHEIV99,
 20143           DFHEIV99,
 20144           DFHEIV99,
 20145           DFHEIV99
 20146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20147
 20148
 20149     MOVE 'EL156A'               TO  MAP-NAME.
 20150     MOVE LOW-VALUES             TO  EL156AO.
 20151     GO TO 8100-SEND-INITIAL-MAP.
 20152
 20153 9995-SECURITY-VIOLATION.
 20154*    COPY ELCSCTP.
 20155******************************************************************
 20156*                                                                *
 20157*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 387
* EL156.cbl
 20158*                            VMOD=2.001                          *
 20159*                                                                *
 20160*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20161******************************************************************
 20162
 20163
 20164     MOVE EIBDATE          TO SM-JUL-DATE.
 20165     MOVE EIBTRMID         TO SM-TERMID.
 20166     MOVE THIS-PGM         TO SM-PGM.
 20167     MOVE EIBTIME          TO TIME-IN.
 20168     MOVE TIME-OUT         TO SM-TIME.
 20169     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20170
 20171
 20172* EXEC CICS LINK
 20173*         PROGRAM  ('EL003')
 20174*         COMMAREA (SECURITY-MESSAGE)
 20175*         LENGTH   (80)
 20176*    END-EXEC.
 20177     MOVE 'EL003' TO DFHEIV1
 20178     MOVE 80
 20179       TO DFHEIV11
 20180*    MOVE '."C                   (   #00017791' TO DFHEIV0
 20181     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20183     MOVE X'2020233030303137373931' TO DFHEIV0(25:11)
 20184     CALL 'kxdfhei1' USING DFHEIV0,
 20185           DFHEIV1,
 20186           SECURITY-MESSAGE,
 20187           DFHEIV11,
 20188           DFHEIV99,
 20189           DFHEIV99,
 20190           DFHEIV99,
 20191           DFHEIV99
 20192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20193
 20194
 20195******************************************************************
 20196
 20197
 20198
 20199 9999-DFHBACK SECTION.
 20200     MOVE '9%                    "   ' TO DFHEIV0
 20201     MOVE 'EL156' TO DFHEIV1
 20202     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20203     GOBACK.
 20204 9999-DFHEXIT.
 20205     IF DFHEIGDJ EQUAL 0001
 20206         NEXT SENTENCE
 20207     ELSE IF DFHEIGDJ EQUAL 2
 20208         GO TO 9990-ABEND,
 20209               8600-PGRM-NOT-FOUND,
 20210               0400-FIRST-TIME,
 20211               6180-DUPREC,
 20212               9990-ABEND
 20213         DEPENDING ON DFHEIGDI
 20214     ELSE IF DFHEIGDJ EQUAL 3
 20215         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 388
* EL156.cbl
 20216               0380-CLAIM-END-FILE
 20217         DEPENDING ON DFHEIGDI
 20218     ELSE IF DFHEIGDJ EQUAL 4
 20219         GO TO 0380-CLAIM-END-FILE,
 20220               0380-CLAIM-END-FILE
 20221         DEPENDING ON DFHEIGDI
 20222     ELSE IF DFHEIGDJ EQUAL 5
 20223         GO TO 0800-EXIT
 20224         DEPENDING ON DFHEIGDI
 20225     ELSE IF DFHEIGDJ EQUAL 6
 20226         GO TO 1950-NOT-FOUND,
 20227               1950-NOT-FOUND
 20228         DEPENDING ON DFHEIGDI
 20229     ELSE IF DFHEIGDJ EQUAL 7
 20230         GO TO 1950-NOT-FOUND
 20231         DEPENDING ON DFHEIGDI
 20232     ELSE IF DFHEIGDJ EQUAL 8
 20233         GO TO 1950-NOT-FOUND,
 20234               1950-NOT-FOUND
 20235         DEPENDING ON DFHEIGDI
 20236     ELSE IF DFHEIGDJ EQUAL 9
 20237         GO TO 1166-END-CHECK,
 20238               1166-END-CHECK
 20239         DEPENDING ON DFHEIGDI
 20240     ELSE IF DFHEIGDJ EQUAL 10
 20241         GO TO 1950-NOT-FOUND,
 20242               1950-NOT-FOUND
 20243         DEPENDING ON DFHEIGDI
 20244     ELSE IF DFHEIGDJ EQUAL 11
 20245         GO TO 1950-NOT-FOUND,
 20246               1950-NOT-FOUND
 20247         DEPENDING ON DFHEIGDI
 20248     ELSE IF DFHEIGDJ EQUAL 12
 20249         GO TO 1950-NOT-FOUND
 20250         DEPENDING ON DFHEIGDI
 20251     ELSE IF DFHEIGDJ EQUAL 13
 20252         GO TO 3600-CONTINUE
 20253         DEPENDING ON DFHEIGDI
 20254     ELSE IF DFHEIGDJ EQUAL 14
 20255         GO TO 5300-NOTE-NOT-FOUND
 20256         DEPENDING ON DFHEIGDI
 20257     ELSE IF DFHEIGDJ EQUAL 15
 20258         GO TO 6065-NOT-FOUND
 20259         DEPENDING ON DFHEIGDI
 20260     ELSE IF DFHEIGDJ EQUAL 16
 20261         GO TO 6068-ACCT-NOT-FND
 20262         DEPENDING ON DFHEIGDI
 20263     ELSE IF DFHEIGDJ EQUAL 17
 20264         GO TO 6074-GET-COMP-DATA
 20265         DEPENDING ON DFHEIGDI
 20266     ELSE IF DFHEIGDJ EQUAL 18
 20267         GO TO 6170-WRITE
 20268         DEPENDING ON DFHEIGDI
 20269     ELSE IF DFHEIGDJ EQUAL 19
 20270         GO TO 6180-DUPREC
 20271         DEPENDING ON DFHEIGDI
 20272     ELSE IF DFHEIGDJ EQUAL 20
 20273         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:23 Page 389
* EL156.cbl
 20274         DEPENDING ON DFHEIGDI
 20275     ELSE IF DFHEIGDJ EQUAL 21
 20276         GO TO 6185-DUPREC
 20277         DEPENDING ON DFHEIGDI
 20278     ELSE IF DFHEIGDJ EQUAL 22
 20279         GO TO 6720-BUILD-NEW-RECORD
 20280         DEPENDING ON DFHEIGDI
 20281     ELSE IF DFHEIGDJ EQUAL 23
 20282         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20283               6900-BUILD-ARCHIVE-HEADER
 20284         DEPENDING ON DFHEIGDI
 20285     ELSE IF DFHEIGDJ EQUAL 24
 20286         GO TO 7010-BUILD-MAP
 20287         DEPENDING ON DFHEIGDI
 20288     ELSE IF DFHEIGDJ EQUAL 25
 20289         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20290         DEPENDING ON DFHEIGDI
 20291     ELSE IF DFHEIGDJ EQUAL 26
 20292         GO TO 7160-DUPREC
 20293         DEPENDING ON DFHEIGDI
 20294     ELSE IF DFHEIGDJ EQUAL 27
 20295         GO TO 7200-EXIT,
 20296               7200-EXIT
 20297         DEPENDING ON DFHEIGDI
 20298     ELSE IF DFHEIGDJ EQUAL 28
 20299         GO TO 7400-NOT-FOUND
 20300         DEPENDING ON DFHEIGDI
 20301     ELSE IF DFHEIGDJ EQUAL 29
 20302         GO TO 7590-END,
 20303               7590-END
 20304         DEPENDING ON DFHEIGDI
 20305     ELSE IF DFHEIGDJ EQUAL 30
 20306         GO TO 7699-EXIT
 20307         DEPENDING ON DFHEIGDI
 20308     ELSE IF DFHEIGDJ EQUAL 31
 20309         GO TO 5300-NOTE-NOT-FOUND
 20310         DEPENDING ON DFHEIGDI
 20311     ELSE IF DFHEIGDJ EQUAL 32
 20312         GO TO 7800-COMP-NOTFND
 20313         DEPENDING ON DFHEIGDI
 20314     ELSE IF DFHEIGDJ EQUAL 33
 20315         GO TO 7920-NOT-FOUND
 20316         DEPENDING ON DFHEIGDI
 20317     ELSE IF DFHEIGDJ EQUAL 34
 20318         GO TO 9870-NOTOPEN,
 20319               9870-EXIT
 20320         DEPENDING ON DFHEIGDI.
 20321     MOVE '9%                    "   ' TO DFHEIV0
 20322     MOVE 'EL156' TO DFHEIV1
 20323     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20324     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12188     Code:       75471
