* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    60* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
    61******************************************************************
    62
    63 ENVIRONMENT DIVISION.
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   3
* EL6501.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    69 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    70                                   USAGE POINTER.
    71 77  FILLER  PIC X(32)  VALUE '********************************'.
    72 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    73 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    74 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    75     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    76 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    77     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    78 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    79 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    80 01  WS-DEGUG-AREA.
    81     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    82     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    83     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    84     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    85     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    86     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    87     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    88     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    89 01  S1                          PIC S999   VALUE +0    COMP.
    90 01  WS-WORK-FIELD.
    91     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    92 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    93 01  WS-DATE-AREA.
    94     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    95     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    96
    97***DMD CUSTOM CODE *****START
    98     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    99     12  WS-DMD-AGENT            PIC X(10).
   100     12  WS-YYYYMMDD             PIC X(8).
   101     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   102                                 PIC 9(8).
   103***DMD CUSTOM CODE *****END
   104
   105 01  WS-ACCOUNT-NUM-AREA.
   106     12  WS-ACCOUNT-FILLER       PIC X(06).
   107     12  WS-ACCT-BRANCH-CD       PIC X(04).
   108
   109 01  WS-NAME-AREA.
   110     12  WS-NAME-1-4             PIC X(04).
   111     12  WS-NAME-FILLER          PIC X(26).
   112
   113 01  STANDARD-AREAS.
   114     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   115         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   116     12  WS-RESPONSE             PIC S9(8)   COMP.
   117         88  RESP-NORMAL                  VALUE +00.
   118         88  RESP-NOTFND                  VALUE +13.
   119         88  RESP-DUPREC                  VALUE +14.
   120         88  RESP-DUPKEY                  VALUE +15.
   121         88  RESP-NOTOPEN                 VALUE +19.
   122         88  RESP-ENDFILE                 VALUE +20.
   123
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   4
* EL6501.cbl
   124     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   125     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   126     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   127     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   128     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   129     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   130     12  PGM-NAME                PIC X(8).
   131     12  TIME-IN                 PIC S9(7).
   132     12  TIME-OUT-R REDEFINES TIME-IN.
   133         16  FILLER              PIC X.
   134         16  TIME-OUT            PIC 99V99.
   135         16  FILLER              PIC XX.
   136     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   137     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   138     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   139     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   140     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   141     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   142     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   143     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   144     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   145     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   146     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   147     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   148     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   149     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   150     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   151     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   152     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   153     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   154     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   155     12  FILE-ID                 PIC X(8).
   156     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   157     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   158     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   159     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   160     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   161     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   162     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   163     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   164     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   165     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   166     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   167     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   168     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   169     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   170     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   171     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   172     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   173     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   174     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   175     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   176     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   177*                                copy ERCGXRF.
   178******************************************************************
   179*                                                                *
   180*                                                                *
   181*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   5
* EL6501.cbl
   182*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   183*                            VMOD=2.002                          *
   184*                                                                *
   185*   ONLINE CREDIT SYSTEM                                         *
   186*                                                                *
   187*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   188*                                                                *
   189*   FILE TYPE = VSAM,KSDS                                        *
   190*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   191*                                                                *
   192*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   193*       ALTERNATE PATH = NONE                                    *
   194*                                                                *
   195*   LOG = NO                                                     *
   196*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   197*                                                                *
   198******************************************************************
   199
   200 01  AGENT-CROSS-REFERENCE.
   201     12  GX-RECORD-ID                PIC XX.
   202         88  VALID-GX-ID             VALUE 'GX'.
   203
   204     12  GX-CONTROL-PRIMARY.
   205         16  GX-COMPANY-CD           PIC X.
   206         16  GX-CARRIER              PIC X.
   207         16  GX-GROUPING             PIC X(6).
   208         16  GX-AGENT-NO             PIC X(10).
   209
   210     12  GX-MAINT-INFORMATION.
   211         16  GX-LAST-MAINT-DT        PIC XX.
   212         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   213         16  GX-LAST-MAINT-USER      PIC X(4).
   214         16  FILLER                  PIC X(9).
   215
   216     12  FILLER                      PIC X(37).
   217
   218     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   219
   220     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   221                            DEPENDING ON GX-AGENT-POINTER-CNT.
   222         16  GX-AM-CARRIER           PIC X.
   223         16  GX-AM-GROUPING          PIC X(6).
   224         16  GX-AM-STATE             PIC XX.
   225         16  GX-AM-ACCOUNT           PIC X(10).
   226         16  GX-AM-EXPIRATION-DT     PIC XX.
   227         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   228         16  GX-LAST-BILL-DT         PIC XX.
   229         16  GX-AM-EFF-DT            PIC XX.
   230         16  FILLER                  PIC X(4).
   231
   232******************************************************************
   233 01  ERPDEF-KEY-SAVE             PIC X(18).
   234 01  ERPDEF-KEY.
   235     12  ERPDEF-COMPANY-CD       PIC X.
   236     12  ERPDEF-STATE            PIC XX.
   237     12  ERPDEF-PROD-CD          PIC XXX.
   238     12  F                       PIC X(7).
   239     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   6
* EL6501.cbl
   240     12  ERPDEF-BEN-CODE         PIC XX.
   241     12  ERPDEF-EXP-DT           PIC XX.
   242 01  WORK-AREAS-AND-SWITCHES.
   243     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   244     12  filler redefines ws-comp-cd-dis.
   245         16  filler              pic x.
   246         16  ws-comp-cd          pic x.
   247     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   248     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   249     12  WS-ST-COMMISSION-CAPS.
   250         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   251         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   252         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   253         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   254     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   255     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   256         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   257
   258     12  COMMISSION-ACCUMS.
   259         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   260         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   261         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   262         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   263
   264     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   265     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   266     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   267     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   268     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   269     12  CURRENT-SAVE            PIC 9(8).
   270     12  BIN-CURRENT-SAVE        PIC XX.
   271     12  CYMD-CURRENT-SAVE       PIC 9(8).
   272     12  SUB                     PIC 99.
   273     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   274     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   275     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   276         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   277
   278     12  WS-EDIT-BEN-CODE        PIC XX.
   279         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   280                                          '90' THRU '99'.
   281
   282     12  WS-KEY-SAVE.
   283           18  WS-ACCT-CCGSA-KEY.
   284             20  WS-ACCT-CO             PIC X.
   285             20  WS-ACCT-CARRIER        PIC X.
   286             20  WS-ACCT-GROUPING       PIC X(6).
   287             20  WS-ACCT-STATE          PIC XX.
   288             20  WS-ACCT-ACCOUNT        PIC X(10).
   289           18  WS-ACCT-EXP-DT           PIC XX.
   290           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   291
   292     12  DEEDIT-FIELD                   PIC X(15).
   293     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   294     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   295     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   296     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   297     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   7
* EL6501.cbl
   298
   299     12  ELCNTL-KEY.
   300         16  CNTL-COMP-ID        PIC XXX.
   301         16  CNTL-REC-TYPE       PIC X.
   302         16  CNTL-ACCESS.
   303             20  FILLER          PIC X(4).
   304         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   305             20  FILLER          PIC XX.
   306             20  CNTL-BUS-TYPE   PIC XX.
   307         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   308             20  FILLER          PIC XX.
   309             20  CNTL-BEN-TYPE   PIC XX.
   310         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   311
   312     12  REIN-KEY.
   313         16  REIN-COMP-CD        PIC X.
   314         16  REIN-CODE           PIC X.
   315         16  REIN-TABLE          PIC X(3).
   316         16  FILLER              PIC X(3).
   317
   318     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   319     12  COMM-KEY.
   320         16  COMM-COMP-CD        PIC X.
   321         16  COMM-TABLE          PIC XXX.
   322         16  COMM-LF-AH          PIC X.
   323         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   324
   325     12  RQST-KEY.
   326         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   327         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   328
   329     12  RQST3-KEY.
   330         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   331         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   332         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   333         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   334         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   335         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   336         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   337
   338     12  SAVE-RQST3-KEY.
   339         16  FILLER              PIC X     VALUE SPACES.
   340         16  FILLER              PIC X     VALUE SPACES.
   341         16  FILLER              PIC X(6)  VALUE SPACES.
   342         16  FILLER              PIC X(10) VALUE SPACES.
   343         16  FILLER              PIC X(10) VALUE SPACES.
   344         16  FILLER              PIC X(12) VALUE SPACES.
   345         16  FILLER              PIC X(6)  VALUE SPACES.
   346
   347     12  COMP-KEY.
   348         16  COMP-COMPANY-CD     PIC X.
   349         16  COMP-CARRIER        PIC X.
   350         16  COMP-GROUPING       PIC X(6).
   351         16  COMP-RESP-NO        PIC X(10).
   352         16  COMP-ACCOUNT        PIC X(10).
   353         16  COMP-TYPE           PIC X.
   354
   355     12  WS-AXRF-KEY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   8
* EL6501.cbl
   356         16  WS-AXRF-COMPANY-CD  PIC X.
   357         16  WS-AXRF-CARRIER     PIC X.
   358         16  WS-AXRF-GROUPING    PIC X(6).
   359         16  WS-AXRF-AGENT-NO    PIC X(10).
   360
   361     12  GX-AM-CONTROL-PRIMARY.
   362         16  GX-AM-COMPANY-CD    PIC X.
   363         16  GX-REST-OF-KEY      PIC X(20).
   364
   365     12  QID.
   366         16  QID-TERM            PIC X(4).
   367         16  FILLER              PIC X(4)    VALUE '6501'.
   368
   369     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   370         88  BROWSE-STARTED         VALUE 'Y'.
   371     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   372         88  FIRST-TIME             VALUE 'Y'.
   373
   374     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   375     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   376     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   377     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   378     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   379     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   380     12  GETMAIN-SW              PIC X       VALUE SPACES.
   381     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   382         88  GETMAIN-ACQUIRED                VALUE 'X'.
   383
   384     12  ER-0000                 PIC X(4)    VALUE '0000'.
   385     12  ER-0002                 PIC X(4)    VALUE '0002'.
   386     12  ER-0004                 PIC X(4)    VALUE '0004'.
   387     12  ER-0008                 PIC X(4)    VALUE '0008'.
   388     12  ER-0023                 PIC X(4)    VALUE '0023'.
   389     12  ER-0029                 PIC X(4)    VALUE '0029'.
   390     12  ER-0033                 PIC X(4)    VALUE '0033'.
   391     12  ER-0144                 PIC X(4)    VALUE '0144'.
   392     12  ER-0070                 PIC X(4)    VALUE '0070'.
   393     12  ER-0250                 PIC X(4)    VALUE '0250'.
   394     12  ER-0348                 PIC X(4)    VALUE '0348'.
   395     12  ER-0454                 PIC X(4)    VALUE '0454'.
   396     12  ER-0625                 PIC X(4)    VALUE '0625'.
   397     12  ER-0759                 PIC X(4)    VALUE '0759'.
   398     12  ER-0788                 PIC X(4)    VALUE '0788'.
   399     12  ER-0852                 PIC X(4)    VALUE '0852'.
   400     12  ER-0899                 PIC X(4)    VALUE '0899'.
   401     12  ER-1778                 PIC X(4)    VALUE '1778'.
   402     12  ER-1817                 PIC X(4)    VALUE '1817'.
   403     12  ER-1883                 PIC X(4)    VALUE '1883'.
   404     12  ER-1884                 PIC X(4)    VALUE '1884'.
   405     12  ER-1885                 PIC X(4)    VALUE '1885'.
   406     12  ER-1886                 PIC X(4)    VALUE '1886'.
   407     12  ER-1887                 PIC X(4)    VALUE '1887'.
   408     12  ER-2045                 PIC X(4)    VALUE '2045'.
   409     12  ER-2071                 PIC X(4)    VALUE '2071'.
   410     12  ER-2131                 PIC X(4)    VALUE '2131'.
   411*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   412     12  ER-2151                 PIC X(4)    VALUE '2151'.
   413     12  ER-2152                 PIC X(4)    VALUE '2152'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page   9
* EL6501.cbl
   414     12  ER-2153                 PIC X(4)    VALUE '2153'.
   415     12  ER-2154                 PIC X(4)    VALUE '2154'.
   416     12  ER-2155                 PIC X(4)    VALUE '2155'.
   417     12  ER-2156                 PIC X(4)    VALUE '2156'.
   418     12  ER-2157                 PIC X(4)    VALUE '2157'.
   419     12  ER-2158                 PIC X(4)    VALUE '2158'.
   420     12  ER-2159                 PIC X(4)    VALUE '2159'.
   421     12  ER-2160                 PIC X(4)    VALUE '2160'.
   422     12  ER-2165                 PIC X(4)    VALUE '2165'.
   423     12  ER-2168                 PIC X(4)    VALUE '2168'.
   424     12  ER-2169                 PIC X(4)    VALUE '2169'.
   425     12  ER-2170                 PIC X(4)    VALUE '2170'.
   426     12  ER-2172                 PIC X(4)    VALUE '2172'.
   427     12  ER-2173                 PIC X(4)    VALUE '2173'.
   428     12  ER-2174                 PIC X(4)    VALUE '2174'.
   429     12  ER-2175                 PIC X(4)    VALUE '2175'.
   430     12  ER-2176                 PIC X(4)    VALUE '2176'.
   431     12  ER-2177                 PIC X(4)    VALUE '2177'.
   432     12  ER-2178                 PIC X(4)    VALUE '2178'.
   433     12  ER-2179                 PIC X(4)    VALUE '2179'.
   434     12  ER-2180                 PIC X(4)    VALUE '2180'.
   435     12  ER-2181                 PIC X(4)    VALUE '2181'.
   436     12  ER-2182                 PIC X(4)    VALUE '2182'.
   437     12  ER-2183                 PIC X(4)    VALUE '2183'.
   438     12  ER-2189                 PIC X(4)    VALUE '2189'.
   439     12  ER-2572                 PIC X(4)    VALUE '2572'.
   440     12  ER-2615                 PIC X(4)    VALUE '2615'.
   441     12  ER-2949                 PIC X(4)    VALUE '2949'.
   442     12  ER-2970                 PIC X(4)    VALUE '2970'.
   443     12  ER-4009                 PIC X(4)    VALUE '4009'.
   444     12  ER-4010                 PIC X(4)    VALUE '4010'.
   445     12  ER-4011                 PIC X(4)    VALUE '4011'.
   446     12  ER-4012                 PIC X(4)    VALUE '4012'.
   447     12  ER-7717                 PIC X(4)    VALUE '7717'.
   448     12  er-8156                 pic x(4)    value '8156'.
   449     12  ER-9999                 PIC X(4)    VALUE '9999'.
   450     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   451
   452     12  WSS-LINE-LIAB-LIMITS.
   453         16  WSS-LF-LIMITS.
   454             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   455             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   456             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   457                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   458                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   459                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   460         16  WSS-AH-LIMITS.
   461             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   462             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   463             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   464                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   465                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   466                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   467                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   468
   469     12  WSS-COMM-STRUCTURE.
   470         16  WSS-DEFN-1.
   471             20  WSS-AGT-COMMS.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  10
* EL6501.cbl
   472                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   473                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   474                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   475                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   476                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   477                 24  FILLER      PIC X(6)     VALUE SPACES.
   478
   479     12  WS-PHONE.
   480         16  WS-PH1              PIC XXX.
   481         16  WS-PH2              PIC XXX.
   482         16  WS-PH3              PIC XXXX.
   483     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   484
   485     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   486     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   487     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   488     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   489     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   490     12  WS-BUS-TYPE             PIC 99.
   491     12  WS-BUS-ENTRY            PIC 99.
   492     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   493     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   494     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   495     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   496     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   497     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   498     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   499         88  COMMISSION-ERROR    VALUE 1.
   500     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   501     12  AGENT-FIND              PIC X        VALUE SPACES.
   502         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   503         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   504         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   505
   506     12  WS-ZIP-CODE.
   507         16  WS-ZIP-1            PIC X.
   508             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   509         16  WS-ZIP-2-3          PIC XX.
   510         16  WS-ZIP-4            PIC X.
   511         16  WS-ZIP-5            PIC X.
   512         16  WS-ZIP-6            PIC X.
   513         16  FILLER              PIC X(4).
   514     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   515         16  WS-ZIP-AM-1-CODE    PIC X(5).
   516         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   517         16  FILLER              PIC X.
   518     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   519         16  WS-ZIP-AM-2-CODE    PIC X(5).
   520         16  WS-ZIP-AM-2-DASH    PIC X.
   521         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   522     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   523         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   524         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   525         16  FILLER              PIC X(4).
   526     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   527         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   528         16  FILLER              PIC X.
   529         16  WS-ZIP-CAN-2-POST2  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  11
* EL6501.cbl
   530         16  FILLER              PIC XXX.
   531     12  WS-SOC-SEC-WORK.
   532         16  WS-SS-TYPE          PIC X.
   533         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  12
* EL6501.cbl
   535*    COPY ELCSCTM.
   536******************************************************************
   537*                                                                *
   538*                                                                *
   539*                            ELCSCTM                             *
   540*                            VMOD=2.001                          *
   541*                                                                *
   542*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   543*                                                                *
   544******************************************************************
   545 01  SECURITY-MESSAGE.
   546     12  FILLER                          PIC X(30)
   547            VALUE '** LOGIC SECURITY VIOLATION -'.
   548     12  SM-READ                         PIC X(6).
   549     12  FILLER                          PIC X(5)
   550            VALUE ' PGM='.
   551     12  SM-PGM                          PIC X(6).
   552     12  FILLER                          PIC X(5)
   553            VALUE ' OPR='.
   554     12  SM-PROCESSOR-ID                 PIC X(4).
   555     12  FILLER                          PIC X(6)
   556            VALUE ' TERM='.
   557     12  SM-TERMID                       PIC X(4).
   558     12  FILLER                          PIC XX   VALUE SPACE.
   559     12  SM-JUL-DATE                     PIC 9(5).
   560     12  FILLER                          PIC X    VALUE SPACE.
   561     12  SM-TIME                         PIC 99.99.
   562
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  13
* EL6501.cbl
   564*    COPY ELCSCRTY.
   565******************************************************************
   566*                                                                *
   567*                                                                *
   568*                            ELCSCRTY                            *
   569*                            VMOD=2.001                          *
   570*                                                                *
   571*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   572*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   573*        SAVED IN PI-SECURITY-ADDRESS.                           *
   574*                                                                *
   575******************************************************************
   576 01  SECURITY-CONTROL.
   577     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   578     12  FILLER                       PIC XX    VALUE 'SC'.
   579     12  SC-CREDIT-CODES.
   580         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   581             20  SC-CREDIT-DISPLAY    PIC X.
   582             20  SC-CREDIT-UPDATE     PIC X.
   583     12  SC-CLAIMS-CODES.
   584         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   585             20  SC-CLAIMS-DISPLAY    PIC X.
   586             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  14
* EL6501.cbl
   588*    COPY ELCLOGOF.
   589******************************************************************
   590*                                                                *
   591*                                                                *
   592*                            ELCLOGOF.                           *
   593*                            VMOD=2.001                          *
   594*                                                                *
   595*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   596*                                                                *
   597******************************************************************
   598 01  CLASIC-LOGOFF.
   599     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   600     12  LOGOFF-TEXT.
   601         16  FILLER          PIC X(5)    VALUE SPACES.
   602         16  LOGOFF-MSG.
   603             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   604             20  FILLER      PIC X       VALUE SPACES.
   605             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   606         16  FILLER          PIC X(80)
   607           VALUE '* YOU ARE NOW LOGGED OFF'.
   608         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   609         16  FILLER          PIC X       VALUE QUOTE.
   610         16  LOGOFF-SYS-MSG  PIC X(17)
   611           VALUE 'S CLAS-IC SYSTEM '.
   612     12  TEXT-MESSAGES.
   613         16  UNACCESS-MSG    PIC X(29)
   614             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   615         16  PGMIDERR-MSG    PIC X(17)
   616             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  15
* EL6501.cbl
   618*    COPY ELCDATE.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ELCDATE.                            *
   623*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   624*                            VMOD=2.003
   625*                                                                *
   626*                                                                *
   627*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   628*                 LENGTH = 200                                   *
   629******************************************************************
   630
   631 01  DATE-CONVERSION-DATA.
   632     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   633     12  DC-OPTION-CODE                PIC X.
   634         88  BIN-TO-GREG                VALUE ' '.
   635         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   636         88  EDIT-GREG-TO-BIN           VALUE '2'.
   637         88  YMD-GREG-TO-BIN            VALUE '3'.
   638         88  MDY-GREG-TO-BIN            VALUE '4'.
   639         88  JULIAN-TO-BIN              VALUE '5'.
   640         88  BIN-PLUS-ELAPSED           VALUE '6'.
   641         88  FIND-CENTURY               VALUE '7'.
   642         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   643         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   644         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   645         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   646         88  JULIAN-TO-BIN-3            VALUE 'C'.
   647         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   648         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   649         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   650         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   651         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   652         88  CHECK-LEAP-YEAR            VALUE 'H'.
   653         88  BIN-3-TO-GREG              VALUE 'I'.
   654         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   655         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   656         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   657         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   658         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   659         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   660         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   661         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   662         88  THREE-CHARACTER-BIN
   663                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   664         88  GREGORIAN-TO-BIN
   665                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   666         88  BIN-TO-GREGORIAN
   667                  VALUES ' ' '1' 'I' '8' 'G'.
   668         88  JULIAN-TO-BINARY
   669                  VALUES '5' 'C' 'E' 'F'.
   670     12  DC-ERROR-CODE                 PIC X.
   671         88  NO-CONVERSION-ERROR        VALUE ' '.
   672         88  DATE-CONVERSION-ERROR
   673                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   674         88  DATE-IS-ZERO               VALUE '1'.
   675         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  16
* EL6501.cbl
   676         88  DATE-IS-INVALID            VALUE '3'.
   677         88  DATE1-GREATER-DATE2        VALUE '4'.
   678         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   679         88  DATE-INVALID-OPTION        VALUE '9'.
   680         88  INVALID-CENTURY            VALUE 'A'.
   681         88  ONLY-CENTURY               VALUE 'B'.
   682         88  ONLY-LEAP-YEAR             VALUE 'C'.
   683         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   684     12  DC-END-OF-MONTH               PIC X.
   685         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   686     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   687         88  USE-NORMAL-PROCESS         VALUE ' '.
   688         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   689         88  ADJUST-UP-100-YRS          VALUE '2'.
   690     12  FILLER                        PIC X.
   691     12  DC-CONVERSION-DATES.
   692         16  DC-BIN-DATE-1             PIC XX.
   693         16  DC-BIN-DATE-2             PIC XX.
   694         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   695         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   696                       DC-GREG-DATE-1-EDIT.
   697             20  DC-EDIT1-MONTH        PIC 99.
   698             20  SLASH1-1              PIC X.
   699             20  DC-EDIT1-DAY          PIC 99.
   700             20  SLASH1-2              PIC X.
   701             20  DC-EDIT1-YEAR         PIC 99.
   702         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   703         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   704                     DC-GREG-DATE-2-EDIT.
   705             20  DC-EDIT2-MONTH        PIC 99.
   706             20  SLASH2-1              PIC X.
   707             20  DC-EDIT2-DAY          PIC 99.
   708             20  SLASH2-2              PIC X.
   709             20  DC-EDIT2-YEAR         PIC 99.
   710         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   711         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   712                     DC-GREG-DATE-1-YMD.
   713             20  DC-YMD-YEAR           PIC 99.
   714             20  DC-YMD-MONTH          PIC 99.
   715             20  DC-YMD-DAY            PIC 99.
   716         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   717         16  DC-GREG-DATE-1-MDY-R REDEFINES
   718                      DC-GREG-DATE-1-MDY.
   719             20  DC-MDY-MONTH          PIC 99.
   720             20  DC-MDY-DAY            PIC 99.
   721             20  DC-MDY-YEAR           PIC 99.
   722         16  DC-GREG-DATE-1-ALPHA.
   723             20  DC-ALPHA-MONTH        PIC X(10).
   724             20  DC-ALPHA-DAY          PIC 99.
   725             20  FILLER                PIC XX.
   726             20  DC-ALPHA-CENTURY.
   727                 24 DC-ALPHA-CEN-N     PIC 99.
   728             20  DC-ALPHA-YEAR         PIC 99.
   729         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   730         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   731         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   732         16  DC-JULIAN-DATE            PIC 9(05).
   733         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  17
* EL6501.cbl
   734                                       PIC 9(05).
   735         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   736             20  DC-JULIAN-YEAR        PIC 99.
   737             20  DC-JULIAN-DAYS        PIC 999.
   738         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   739         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   740         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   741     12  DATE-CONVERSION-VARIBLES.
   742         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   743         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   744             20  FILLER                PIC 9(3).
   745             20  HOLD-CEN-1-CCYY.
   746                 24  HOLD-CEN-1-CC     PIC 99.
   747                 24  HOLD-CEN-1-YY     PIC 99.
   748             20  HOLD-CEN-1-MO         PIC 99.
   749             20  HOLD-CEN-1-DA         PIC 99.
   750         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   751             20  HOLD-CEN-1-R-MO       PIC 99.
   752             20  HOLD-CEN-1-R-DA       PIC 99.
   753             20  HOLD-CEN-1-R-CCYY.
   754                 24  HOLD-CEN-1-R-CC   PIC 99.
   755                 24  HOLD-CEN-1-R-YY   PIC 99.
   756             20  FILLER                PIC 9(3).
   757         16  HOLD-CENTURY-1-X.
   758             20  FILLER                PIC X(3)  VALUE SPACES.
   759             20  HOLD-CEN-1-X-CCYY.
   760                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   761                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   762             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   763             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   764         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   765             20  HOLD-CEN-1-R-X-MO     PIC XX.
   766             20  HOLD-CEN-1-R-X-DA     PIC XX.
   767             20  HOLD-CEN-1-R-X-CCYY.
   768                 24  HOLD-CEN-1-R-X-CC PIC XX.
   769                 24  HOLD-CEN-1-R-X-YY PIC XX.
   770             20  FILLER                PIC XXX.
   771         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   772         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   773         16  DC-JULIAN-DATE-1          PIC 9(07).
   774         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   775             20  DC-JULIAN-1-CCYY.
   776                 24  DC-JULIAN-1-CC    PIC 99.
   777                 24  DC-JULIAN-1-YR    PIC 99.
   778             20  DC-JULIAN-DA-1        PIC 999.
   779         16  DC-JULIAN-DATE-2          PIC 9(07).
   780         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   781             20  DC-JULIAN-2-CCYY.
   782                 24  DC-JULIAN-2-CC    PIC 99.
   783                 24  DC-JULIAN-2-YR    PIC 99.
   784             20  DC-JULIAN-DA-2        PIC 999.
   785         16  DC-GREG-DATE-A-EDIT.
   786             20  DC-EDITA-MONTH        PIC 99.
   787             20  SLASHA-1              PIC X VALUE '/'.
   788             20  DC-EDITA-DAY          PIC 99.
   789             20  SLASHA-2              PIC X VALUE '/'.
   790             20  DC-EDITA-CCYY.
   791                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  18
* EL6501.cbl
   792                 24  DC-EDITA-YEAR     PIC 99.
   793         16  DC-GREG-DATE-B-EDIT.
   794             20  DC-EDITB-MONTH        PIC 99.
   795             20  SLASHB-1              PIC X VALUE '/'.
   796             20  DC-EDITB-DAY          PIC 99.
   797             20  SLASHB-2              PIC X VALUE '/'.
   798             20  DC-EDITB-CCYY.
   799                 24  DC-EDITB-CENT     PIC 99.
   800                 24  DC-EDITB-YEAR     PIC 99.
   801         16  DC-GREG-DATE-CYMD         PIC 9(08).
   802         16  DC-GREG-DATE-CYMD-R REDEFINES
   803                              DC-GREG-DATE-CYMD.
   804             20  DC-CYMD-CEN           PIC 99.
   805             20  DC-CYMD-YEAR          PIC 99.
   806             20  DC-CYMD-MONTH         PIC 99.
   807             20  DC-CYMD-DAY           PIC 99.
   808         16  DC-GREG-DATE-MDCY         PIC 9(08).
   809         16  DC-GREG-DATE-MDCY-R REDEFINES
   810                              DC-GREG-DATE-MDCY.
   811             20  DC-MDCY-MONTH         PIC 99.
   812             20  DC-MDCY-DAY           PIC 99.
   813             20  DC-MDCY-CEN           PIC 99.
   814             20  DC-MDCY-YEAR          PIC 99.
   815    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   816        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   817    12  DC-EL310-DATE                  PIC X(21).
   818    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  19
* EL6501.cbl
   820*    COPY ELCATTR.
   821******************************************************************
   822*                                                                *
   823*                            ELCATTR.                            *
   824*                            VMOD=2.001                          *
   825*                                                                *
   826*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   827*                                                                *
   828*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   829*                                                                *
   830*                   POS 1   P=PROTECTED                          *
   831*                           U=UNPROTECTED                        *
   832*                           S=ASKIP                              *
   833*                   POS 2   A=ALPHA/NUMERIC                      *
   834*                           N=NUMERIC                            *
   835*                   POS 3   N=NORMAL                             *
   836*                           B=BRIGHT                             *
   837*                           D=DARK                               *
   838*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   839*                           OF=MODIFIED DATA TAG OFF             *
   840*                                                                *
   841*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   842******************************************************************
   843 01  ATTRIBUTE-LIST.
   844     12  AL-PABOF            PIC X       VALUE 'Y'.
   845     12  AL-PABON            PIC X       VALUE 'Z'.
   846     12  AL-PADOF            PIC X       VALUE '%'.
   847     12  AL-PADON            PIC X       VALUE '_'.
   848     12  AL-PANOF            PIC X       VALUE '-'.
   849     12  AL-PANON            PIC X       VALUE '/'.
   850     12  AL-SABOF            PIC X       VALUE '8'.
   851     12  AL-SABON            PIC X       VALUE '9'.
   852     12  AL-SADOF            PIC X       VALUE '@'.
   853     12  AL-SADON            PIC X       VALUE QUOTE.
   854     12  AL-SANOF            PIC X       VALUE '0'.
   855     12  AL-SANON            PIC X       VALUE '1'.
   856     12  AL-UABOF            PIC X       VALUE 'H'.
   857     12  AL-UABON            PIC X       VALUE 'I'.
   858     12  AL-UADOF            PIC X       VALUE '<'.
   859     12  AL-UADON            PIC X       VALUE '('.
   860     12  AL-UANOF            PIC X       VALUE ' '.
   861     12  AL-UANON            PIC X       VALUE 'A'.
   862     12  AL-UNBOF            PIC X       VALUE 'Q'.
   863     12  AL-UNBON            PIC X       VALUE 'R'.
   864     12  AL-UNDOF            PIC X       VALUE '*'.
   865     12  AL-UNDON            PIC X       VALUE ')'.
   866     12  AL-UNNOF            PIC X       VALUE '&'.
   867     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  20
* EL6501.cbl
   869*    COPY ELCEMIB.
   870******************************************************************
   871*                                                                *
   872*                                                                *
   873*                            ELCEMIB.                            *
   874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   875*                            VMOD=2.005                          *
   876*                                                                *
   877*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   878*                                                                *
   879******************************************************************
   880 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   881     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   882     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   883     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   884     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   885     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   886     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   887     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   888     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   889     12  EMI-SWITCH1             PIC X        VALUE '1'.
   890         88  EMI-NO-ERRORS                    VALUE '1'.
   891         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   892         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   893     12  EMI-SWITCH2             PIC X        VALUE '1'.
   894         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   895     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   896         88  EMI-AREA1-EMPTY                  VALUE '1'.
   897         88  EMI-AREA1-FULL                   VALUE '2'.
   898     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   899         88  EMI-AREA2-EMPTY                  VALUE '1'.
   900         88  EMI-AREA2-FULL                   VALUE '2'.
   901     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   902         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   903         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   904         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   905         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   906         88  EMI-BYPASS-FATALS                VALUE 'X'.
   907     12  EMI-ERROR-LINES.
   908         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   909         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   910         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   911         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   912             20  EMI-ERR-CODES OCCURS 10 TIMES.
   913                 24  EMI-ERR-NUM         PIC X(4).
   914                 24  EMI-FILLER          PIC X.
   915                 24  EMI-SEV             PIC X.
   916                 24  FILLER              PIC X.
   917             20  FILLER                  PIC X(02).
   918     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   919         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   920             20  EMI-ERROR-NUMBER    PIC X(4).
   921             20  EMI-FILL            PIC X.
   922             20  EMI-SEVERITY        PIC X.
   923             20  FILLER              PIC X.
   924             20  EMI-ERROR-TEXT.
   925                 24  EMI-TEXT-VARIABLE   PIC X(10).
   926                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  21
* EL6501.cbl
   927     12  EMI-SEVERITY-SAVE           PIC X.
   928         88  EMI-NOTE                    VALUE 'N'.
   929         88  EMI-WARNING                 VALUE 'W'.
   930         88  EMI-FORCABLE                VALUE 'F'.
   931         88  EMI-FATAL                   VALUE 'X'.
   932     12  EMI-MESSAGE-FLAG            PIC X.
   933         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   934         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   935     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   936     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   937         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   938         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   939         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   940     12  emi-claim-no                pic x(7).
   941     12  emi-claim-type              pic x(6).
   942     12  FILLER                      PIC X(124)  VALUE SPACES.
   943     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   944     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   945     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   946     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  22
* EL6501.cbl
   948*    COPY ELCINTF.
   949******************************************************************
   950*                                                                *
   951*                                                                *
   952*                            ELCINTF.                            *
   953*                            VMOD=2.017                          *
   954*                                                                *
   955*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   956*                                                                *
   957*       LENGTH = 1024                                            *
   958*                                                                *
   959******************************************************************
   960*                   C H A N G E   L O G
   961*
   962* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   963*-----------------------------------------------------------------
   964*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   965* EFFECTIVE    NUMBER
   966*-----------------------------------------------------------------
   967* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   968******************************************************************
   969 01  PROGRAM-INTERFACE-BLOCK.
   970     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   971     12  PI-CALLING-PROGRAM              PIC X(8).
   972     12  PI-SAVED-PROGRAM-1              PIC X(8).
   973     12  PI-SAVED-PROGRAM-2              PIC X(8).
   974     12  PI-SAVED-PROGRAM-3              PIC X(8).
   975     12  PI-SAVED-PROGRAM-4              PIC X(8).
   976     12  PI-SAVED-PROGRAM-5              PIC X(8).
   977     12  PI-SAVED-PROGRAM-6              PIC X(8).
   978     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   979     12  PI-COMPANY-ID                   PIC XXX.
   980     12  PI-COMPANY-CD                   PIC X.
   981
   982     12  PI-COMPANY-PASSWORD             PIC X(8).
   983
   984     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   985
   986     12  PI-CONTROL-IN-PROGRESS.
   987         16  PI-CARRIER                  PIC X.
   988         16  PI-GROUPING                 PIC X(6).
   989         16  PI-STATE                    PIC XX.
   990         16  PI-ACCOUNT                  PIC X(10).
   991         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   992                                         PIC X(10).
   993         16  PI-CLAIM-CERT-GRP.
   994             20  PI-CLAIM-NO             PIC X(7).
   995             20  PI-CERT-NO.
   996                 25  PI-CERT-PRIME       PIC X(10).
   997                 25  PI-CERT-SFX         PIC X.
   998             20  PI-CERT-EFF-DT          PIC XX.
   999         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1000             20  PI-PLAN-CODE            PIC X(2).
  1001             20  PI-REVISION-NUMBER      PIC X(3).
  1002             20  PI-PLAN-EFF-DT          PIC X(2).
  1003             20  PI-PLAN-EXP-DT          PIC X(2).
  1004             20  FILLER                  PIC X(11).
  1005         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  23
* EL6501.cbl
  1006             20  PI-OE-REFERENCE-1.
  1007                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1008                 25  PI-OE-REF-1-SUFF    PIC XX.
  1009
  1010     12  PI-SESSION-IN-PROGRESS          PIC X.
  1011         88  CLAIM-SESSION                   VALUE '1'.
  1012         88  CREDIT-SESSION                  VALUE '2'.
  1013         88  WARRANTY-SESSION                VALUE '3'.
  1014         88  MORTGAGE-SESSION                VALUE '4'.
  1015         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1016
  1017
  1018*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1019
  1020     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1021     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1022
  1023     12  PI-CREDIT-USER                  PIC X.
  1024         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1025         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1026
  1027     12  PI-CLAIM-USER                   PIC X.
  1028         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1029         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1030
  1031     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1032         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1033         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1034         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1035         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1036         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1037
  1038     12  PI-PROCESSOR-ID                 PIC X(4).
  1039
  1040     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1041
  1042     12  PI-MEMBER-CAPTION               PIC X(10).
  1043
  1044     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1045         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1046
  1047     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1048     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1049     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1050     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1051
  1052     12  PI-AH-OVERRIDE-L1               PIC X.
  1053     12  PI-AH-OVERRIDE-L2               PIC XX.
  1054     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1055     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1056
  1057     12  PI-NEW-SYSTEM                   PIC X(2).
  1058
  1059     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1060     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1061         88  PI-USES-PAID-TO                 VALUE '1'.
  1062     12  PI-CRDTCRD-SYSTEM.
  1063         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  24
* EL6501.cbl
  1064             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1065             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1066         16  PI-CC-MONTH-END-DT          PIC XX.
  1067     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1068
  1069     12  PI-OE-REFERENCE-2.
  1070         16  PI-OE-REF-2-PRIME           PIC X(10).
  1071         16  PI-OE-REF-2-SUFF            PIC X.
  1072
  1073     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1074
  1075     12  PI-LANGUAGE-TYPE                PIC X.
  1076             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1077             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1078             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1079
  1080     12  PI-POLICY-LINKAGE-IND           PIC X.
  1081         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1082         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1083                                                   LOW-VALUES.
  1084
  1085     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1086     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1087         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1088         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1089
  1090     12  PI-PROCESSOR-CSR-IND            PIC X.
  1091         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1092         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1093
  1094     12  FILLER                          PIC X(3).
  1095
  1096     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1097
  1098     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1099         PI-SYSTEM-LEVEL.
  1100
  1101         16  PI-ENTRY-CODES.
  1102             20  PI-ENTRY-CD-1           PIC X.
  1103             20  PI-ENTRY-CD-2           PIC X.
  1104
  1105         16  PI-RETURN-CODES.
  1106             20  PI-RETURN-CD-1          PIC X.
  1107             20  PI-RETURN-CD-2          PIC X.
  1108
  1109         16  PI-UPDATE-STATUS-SAVE.
  1110             20  PI-UPDATE-BY            PIC X(4).
  1111             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1112
  1113         16  PI-LOWER-CASE-LETTERS       PIC X.
  1114             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1115
  1116*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1117*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1118*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1119
  1120         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1121             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  25
* EL6501.cbl
  1122             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1123             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1124             88  ACCNT-CNTL                  VALUE '3'.
  1125             88  CARR-ACCNT-CNTL             VALUE '4'.
  1126
  1127         16  PI-PROCESSOR-CAP-LIST.
  1128             20  PI-SYSTEM-CONTROLS.
  1129                24 PI-SYSTEM-DISPLAY     PIC X.
  1130                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1131                24 PI-SYSTEM-MODIFY      PIC X.
  1132                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1133             20  FILLER                  PIC XX.
  1134             20  PI-DISPLAY-CAP          PIC X.
  1135                 88  DISPLAY-CAP             VALUE 'Y'.
  1136             20  PI-MODIFY-CAP           PIC X.
  1137                 88  MODIFY-CAP              VALUE 'Y'.
  1138             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1139                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1140             20  PI-FORCE-CAP            PIC X.
  1141                 88  FORCE-CAP               VALUE 'Y'.
  1142
  1143         16  PI-PROGRAM-CONTROLS.
  1144             20  PI-PGM-PRINT-OPT        PIC X.
  1145             20  PI-PGM-FORMAT-OPT       PIC X.
  1146             20  PI-PGM-PROCESS-OPT      PIC X.
  1147             20  PI-PGM-TOTALS-OPT       PIC X.
  1148
  1149         16  PI-HELP-INTERFACE.
  1150             20  PI-LAST-ERROR-NO        PIC X(4).
  1151             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1152
  1153         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1154             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1155
  1156         16  PI-CR-CONTROL-IN-PROGRESS.
  1157             20  PI-CR-CARRIER           PIC X.
  1158             20  PI-CR-GROUPING          PIC X(6).
  1159             20  PI-CR-STATE             PIC XX.
  1160             20  PI-CR-ACCOUNT           PIC X(10).
  1161             20  PI-CR-FIN-RESP          PIC X(10).
  1162             20  PI-CR-TYPE              PIC X.
  1163
  1164         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1165
  1166         16  PI-CR-MONTH-END-DT          PIC XX.
  1167
  1168         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1169             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1170             88  PI-ZERO-CARRIER             VALUE '1'.
  1171             88  PI-ZERO-GROUPING            VALUE '2'.
  1172             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1173
  1174         16  PI-CARRIER-SECURITY         PIC X.
  1175             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1176
  1177         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1178             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1179             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  26
* EL6501.cbl
  1180
  1181         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1182             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1183                                         INDEXED BY PI-ACCESS-NDX
  1184                                         PIC X.
  1185
  1186         16  PI-GA-BILLING-CONTROL       PIC X.
  1187             88  PI-GA-BILLING               VALUE '1'.
  1188
  1189         16  PI-MAIL-PROCESSING          PIC X.
  1190             88  PI-MAIL-YES                 VALUE 'Y'.
  1191
  1192         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1193
  1194         16  PI-AR-SYSTEM.
  1195             20  PI-AR-PROCESSING-CNTL   PIC X.
  1196                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1197             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1198             20  PI-AR-MONTH-END-DT      PIC XX.
  1199
  1200         16  PI-MP-SYSTEM.
  1201             20  PI-MORTGAGE-USER            PIC X.
  1202                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1203                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1204             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1205                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1206                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1207                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1208                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1209                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1210             20  PI-MP-MONTH-END-DT          PIC XX.
  1211             20  PI-MP-REFERENCE-NO.
  1212                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1213                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1214
  1215         16  PI-LABEL-CONTROL            PIC X(01).
  1216             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1217             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1218
  1219         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1220             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1221
  1222         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1223             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1224             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1225
  1226         16  FILLER                      PIC X(14).
  1227
  1228     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1229******************************************************************
  1230*    COPY ELC650PI.
  1231******************************************************************
  1232*
  1233*                            ELC650PI.
  1234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1235*                            VMOD=2.007
  1236*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1237*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  27
* EL6501.cbl
  1238* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1239*
  1240******************************************************************
  1241
  1242     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1243         16  PI-MAINT                   PIC X.
  1244         16  PI-PREV-ACCOUNT            PIC X(20).
  1245         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1246         16  PI-ACCT-KEY.
  1247             20  PI-ACCT-CCGSA-KEY.
  1248                 24  PI-ACCT-CO             PIC X.
  1249                 24  PI-ACCT-CARRIER        PIC X.
  1250                 24  PI-ACCT-GROUPING       PIC X(6).
  1251                 24  PI-ACCT-STATE          PIC XX.
  1252                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1253             20  PI-ACCT-EXP-DT           PIC XX.
  1254             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1255         16  PI-ACCT-ID                 PIC X(8).
  1256         16  PI-PLAN-KEY.
  1257             20  PI-PLAN-ACCT-KEY.
  1258                 24  PI-PLAN-COMPANY-CD PIC X.
  1259                 24  PI-PLAN-CARRIER    PIC X.
  1260                 24  PI-PLAN-GROUP      PIC X(6).
  1261                 24  PI-PLAN-STATE      PIC X(2).
  1262                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1263             20  PI-PLAN-BEN-TYPE       PIC X.
  1264             20  PI-PLAN-BEN            PIC XX.
  1265             20  PI-PLAN-REVISION       PIC X(3).
  1266         16  PI-WS-STATE                PIC XX.
  1267         16  PI-WS-CLASS                PIC XX.
  1268         16  PI-WS-DEV                  PIC X(3).
  1269         16  PI-WS-TYPE                 PIC X.
  1270         16  PI-WS-PLAN                 PIC XX.
  1271
  1272         16  PI-ERPNDB-ALT-KEY.
  1273             20  PI-PB-COMPANY-CD-A1    PIC X.
  1274             20  PI-PB-CARRIER          PIC X.
  1275             20  PI-PB-GROUPING         PIC X(6).
  1276             20  PI-PB-STATE            PIC XX.
  1277             20  PI-PB-ACCOUNT          PIC X(10).
  1278             20  PI-PB-CERT-EFF-DT      PIC XX.
  1279             20  PI-PB-CERT-NO          PIC X(10).
  1280             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1281             20  PI-PB-RECORD-TYPE      PIC X.
  1282
  1283         16  PI-DATE-RANGE-TABLE.
  1284             20  PI-TABLE-ENT OCCURS 32 TIMES
  1285                            INDEXED BY T-INDEX.
  1286                 24  PI-BIN-EFF-DT          PIC XX.
  1287                 24  PI-BIN-EXP-DT          PIC XX.
  1288                 24  PI-BIN-MAINT-DT        PIC XX.
  1289                 24  PI-BIN-LO-CERT         PIC XX.
  1290                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1291                 24  PI-BIN-HI-CERT         PIC XX.
  1292         16  PI-PAGE-NUMBER             PIC S9.
  1293             88  PI-FST-PAGE               VALUE +1.
  1294             88  PI-2ND-PAGE               VALUE +2.
  1295             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  28
* EL6501.cbl
  1296             88  PI-LST-PAGE               VALUE +4.
  1297         16  PI-TOTAL-LINES             PIC S99.
  1298         16  PI-LINE-SELECTED    PIC S9.
  1299***  Y2K PROJ 7744
  1300         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1301         16  BIN-EFFCHG-SAVE     PIC XX.
  1302         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1303***  Y2K PROJ 7744
  1304         16  BIN-EXPCHG-SAVE     PIC XX.
  1305         16  PI-RECORD-ADDED-SW  PIC X.
  1306             88  PI-RECORD-ADDED            VALUE '1'.
  1307             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1308         16  PI-ACCNAME          PIC X(30).
  1309         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1310         16  PI-SV-MAINT         PIC X.
  1311         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1312         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1313         16  PI-UPDATE-SW        PIC X.
  1314             88  PI-CHANGES-MADE             VALUE '1'.
  1315         16  PI-NOTE-TYPE        PIC X.
  1316             88  PI-ACCT-NOTE                VALUE '1'.
  1317         16  PI-DMD-FILE-SW      PIC X.
  1318             88  END-OF-FILE                 VALUE 'E'.
  1319             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1320             88  FIRST-OCCURS                VALUE 'F'.
  1321         16  PI-DMD-OCCURS       PIC S999.
  1322         16  PI-DMD-SCREEN       PIC X.
  1323             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1324             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1325             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1326         16  PI-NAMEFLG          PIC X.
  1327         16  PI-EL650-DEL-SW     PIC X.
  1328         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1329         16  PI-DCC-PROD-CODE    PIC XXX.
  1330         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  29
* EL6501.cbl
  1332
  1333*    COPY ELCJPFX.
  1334******************************************************************
  1335*                                                                *
  1336*                                                                *
  1337*                            ELCJPFX.                            *
  1338*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1339*                            VMOD=2.002                          *
  1340*                                                                *
  1341*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1342*                                                                *
  1343*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1344*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1345*        ELCNTL - CONTROL FILE                                   *
  1346*        ELMSTR - CLAIM MASTERS                                  *
  1347*        ELTRLR - ACTIVITY TRAILERS                              *
  1348*        ELCHKQ - CHECK QUE                                      *
  1349******************************************************************
  1350 01  JOURNAL-RECORD.
  1351     12  jp-date                     pic s9(5) comp-3.
  1352     12  jp-time                     pic s9(7) comp-3.
  1353     12  JP-USER-ID                  PIC X(4).
  1354     12  JP-FILE-ID                  PIC X(8).
  1355     12  JP-PROGRAM-ID               PIC X(8).
  1356     12  JP-RECORD-TYPE              PIC X.
  1357         88 JP-ADD              VALUE 'A'.
  1358         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1359         88 JP-AFTER-CHANGE     VALUE 'C'.
  1360         88 JP-DELETE           VALUE 'D'.
  1361         88 JP-GENERIC-DELETE   VALUE 'G'.
  1362         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1363         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1364     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1365     12  JP-RECORD-AREA
  1366
  1367
  1368         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  30
* EL6501.cbl
  1370*    COPY ELCAID.
  1371******************************************************************
  1372*                                                                *
  1373*                            ELCAID.                             *
  1374*                            VMOD=2.001                          *
  1375*                                                                *
  1376*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1377*                                                                *
  1378*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1379*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1380******************************************************************
  1381
  1382 01  DFHAID.
  1383   02  DFHNULL   PIC  X  VALUE  ' '.
  1384   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1385   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1386   02  DFHPEN    PIC  X  VALUE  '='.
  1387   02  DFHOPID   PIC  X  VALUE  'W'.
  1388   02  DFHPA1    PIC  X  VALUE  '%'.
  1389   02  DFHPA2    PIC  X  VALUE  '>'.
  1390   02  DFHPA3    PIC  X  VALUE  ','.
  1391   02  DFHPF1    PIC  X  VALUE  '1'.
  1392   02  DFHPF2    PIC  X  VALUE  '2'.
  1393   02  DFHPF3    PIC  X  VALUE  '3'.
  1394   02  DFHPF4    PIC  X  VALUE  '4'.
  1395   02  DFHPF5    PIC  X  VALUE  '5'.
  1396   02  DFHPF6    PIC  X  VALUE  '6'.
  1397   02  DFHPF7    PIC  X  VALUE  '7'.
  1398   02  DFHPF8    PIC  X  VALUE  '8'.
  1399   02  DFHPF9    PIC  X  VALUE  '9'.
  1400   02  DFHPF10   PIC  X  VALUE  ':'.
  1401   02  DFHPF11   PIC  X  VALUE  '#'.
  1402   02  DFHPF12   PIC  X  VALUE  '@'.
  1403   02  DFHPF13   PIC  X  VALUE  'A'.
  1404   02  DFHPF14   PIC  X  VALUE  'B'.
  1405   02  DFHPF15   PIC  X  VALUE  'C'.
  1406   02  DFHPF16   PIC  X  VALUE  'D'.
  1407   02  DFHPF17   PIC  X  VALUE  'E'.
  1408   02  DFHPF18   PIC  X  VALUE  'F'.
  1409   02  DFHPF19   PIC  X  VALUE  'G'.
  1410   02  DFHPF20   PIC  X  VALUE  'H'.
  1411   02  DFHPF21   PIC  X  VALUE  'I'.
  1412*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1413   02  DFHPF22   PIC  X  VALUE  '['.
  1414   02  DFHPF23   PIC  X  VALUE  '.'.
  1415   02  DFHPF24   PIC  X  VALUE  '<'.
  1416   02  DFHMSRE   PIC  X  VALUE  'X'.
  1417   02  DFHSTRF   PIC  X  VALUE  'h'.
  1418   02  DFHTRIG   PIC  X  VALUE  '"'.
  1419 01  FILLER    REDEFINES DFHAID.
  1420     12  FILLER                  PIC X(8).
  1421     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  31
* EL6501.cbl
  1423*    COPY EL6501S.
  1424 01  EL6501AI.
  1425     05  FILLER            PIC  X(0012).
  1426*    -------------------------------
  1427     05  DATEL PIC S9(0004) COMP.
  1428     05  DATEF PIC  X(0001).
  1429     05  FILLER REDEFINES DATEF.
  1430         10  DATEA PIC  X(0001).
  1431     05  DATEI PIC  X(0008).
  1432*    -------------------------------
  1433     05  TIMEL PIC S9(0004) COMP.
  1434     05  TIMEF PIC  X(0001).
  1435     05  FILLER REDEFINES TIMEF.
  1436         10  TIMEA PIC  X(0001).
  1437     05  TIMEI PIC  X(0005).
  1438*    -------------------------------
  1439     05  CMPNYIDL PIC S9(0004) COMP.
  1440     05  CMPNYIDF PIC  X(0001).
  1441     05  FILLER REDEFINES CMPNYIDF.
  1442         10  CMPNYIDA PIC  X(0001).
  1443     05  CMPNYIDI PIC  X(0003).
  1444*    -------------------------------
  1445     05  USERIDL PIC S9(0004) COMP.
  1446     05  USERIDF PIC  X(0001).
  1447     05  FILLER REDEFINES USERIDF.
  1448         10  USERIDA PIC  X(0001).
  1449     05  USERIDI PIC  X(0004).
  1450*    -------------------------------
  1451     05  MAINTL PIC S9(0004) COMP.
  1452     05  MAINTF PIC  X(0001).
  1453     05  FILLER REDEFINES MAINTF.
  1454         10  MAINTA PIC  X(0001).
  1455     05  MAINTI PIC  X(0001).
  1456*    -------------------------------
  1457     05  CARRL PIC S9(0004) COMP.
  1458     05  CARRF PIC  X(0001).
  1459     05  FILLER REDEFINES CARRF.
  1460         10  CARRA PIC  X(0001).
  1461     05  CARRI PIC  X(0001).
  1462*    -------------------------------
  1463     05  GROUPINL PIC S9(0004) COMP.
  1464     05  GROUPINF PIC  X(0001).
  1465     05  FILLER REDEFINES GROUPINF.
  1466         10  GROUPINA PIC  X(0001).
  1467     05  GROUPINI PIC  X(0006).
  1468*    -------------------------------
  1469     05  STATEL PIC S9(0004) COMP.
  1470     05  STATEF PIC  X(0001).
  1471     05  FILLER REDEFINES STATEF.
  1472         10  STATEA PIC  X(0001).
  1473     05  STATEI PIC  X(0002).
  1474*    -------------------------------
  1475     05  ACCOUNTL PIC S9(0004) COMP.
  1476     05  ACCOUNTF PIC  X(0001).
  1477     05  FILLER REDEFINES ACCOUNTF.
  1478         10  ACCOUNTA PIC  X(0001).
  1479     05  ACCOUNTI PIC  X(0010).
  1480*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  32
* EL6501.cbl
  1481     05  EFFDTEL PIC S9(0004) COMP.
  1482     05  EFFDTEF PIC  X(0001).
  1483     05  FILLER REDEFINES EFFDTEF.
  1484         10  EFFDTEA PIC  X(0001).
  1485     05  EFFDTEI PIC  X(0008).
  1486*    -------------------------------
  1487     05  EXPDTEL PIC S9(0004) COMP.
  1488     05  EXPDTEF PIC  X(0001).
  1489     05  FILLER REDEFINES EXPDTEF.
  1490         10  EXPDTEA PIC  X(0001).
  1491     05  EXPDTEI PIC  X(0008).
  1492*    -------------------------------
  1493     05  MAINTBYL PIC S9(0004) COMP.
  1494     05  MAINTBYF PIC  X(0001).
  1495     05  FILLER REDEFINES MAINTBYF.
  1496         10  MAINTBYA PIC  X(0001).
  1497     05  MAINTBYI PIC  X(0004).
  1498*    -------------------------------
  1499     05  PCONTL PIC S9(0004) COMP.
  1500     05  PCONTF PIC  X(0001).
  1501     05  FILLER REDEFINES PCONTF.
  1502         10  PCONTA PIC  X(0001).
  1503     05  PCONTI PIC  X(0030).
  1504*    -------------------------------
  1505     05  CSRL PIC S9(0004) COMP.
  1506     05  CSRF PIC  X(0001).
  1507     05  FILLER REDEFINES CSRF.
  1508         10  CSRA PIC  X(0001).
  1509     05  CSRI PIC  X(0004).
  1510*    -------------------------------
  1511     05  PDSPLYL PIC S9(0004) COMP.
  1512     05  PDSPLYF PIC  X(0001).
  1513     05  FILLER REDEFINES PDSPLYF.
  1514         10  PDSPLYA PIC  X(0001).
  1515     05  PDSPLYI PIC  X(0006).
  1516*    -------------------------------
  1517     05  PEFFDTEL PIC S9(0004) COMP.
  1518     05  PEFFDTEF PIC  X(0001).
  1519     05  FILLER REDEFINES PEFFDTEF.
  1520         10  PEFFDTEA PIC  X(0001).
  1521     05  PEFFDTEI PIC  X(0008).
  1522*    -------------------------------
  1523     05  PEXPDTEL PIC S9(0004) COMP.
  1524     05  PEXPDTEF PIC  X(0001).
  1525     05  FILLER REDEFINES PEXPDTEF.
  1526         10  PEXPDTEA PIC  X(0001).
  1527     05  PEXPDTEI PIC  X(0008).
  1528*    -------------------------------
  1529     05  NAMEL PIC S9(0004) COMP.
  1530     05  NAMEF PIC  X(0001).
  1531     05  FILLER REDEFINES NAMEF.
  1532         10  NAMEA PIC  X(0001).
  1533     05  NAMEI PIC  X(0030).
  1534*    -------------------------------
  1535     05  TAXNOL PIC S9(0004) COMP.
  1536     05  TAXNOF PIC  X(0001).
  1537     05  FILLER REDEFINES TAXNOF.
  1538         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  33
* EL6501.cbl
  1539     05  TAXNOI PIC  X(0011).
  1540*    -------------------------------
  1541     05  STATUSL PIC S9(0004) COMP.
  1542     05  STATUSF PIC  X(0001).
  1543     05  FILLER REDEFINES STATUSF.
  1544         10  STATUSA PIC  X(0001).
  1545     05  STATUSI PIC  X(0001).
  1546*    -------------------------------
  1547     05  INCAREL PIC S9(0004) COMP.
  1548     05  INCAREF PIC  X(0001).
  1549     05  FILLER REDEFINES INCAREF.
  1550         10  INCAREA PIC  X(0001).
  1551     05  INCAREI PIC  X(0030).
  1552*    -------------------------------
  1553     05  PHONEL PIC S9(0004) COMP.
  1554     05  PHONEF PIC  X(0001).
  1555     05  FILLER REDEFINES PHONEF.
  1556         10  PHONEA PIC  X(0001).
  1557     05  PHONEI PIC  X(0012).
  1558*    -------------------------------
  1559     05  INDGRPL PIC S9(0004) COMP.
  1560     05  INDGRPF PIC  X(0001).
  1561     05  FILLER REDEFINES INDGRPF.
  1562         10  INDGRPA PIC  X(0001).
  1563     05  INDGRPI PIC  X(0001).
  1564*    -------------------------------
  1565     05  ADDR1L PIC S9(0004) COMP.
  1566     05  ADDR1F PIC  X(0001).
  1567     05  FILLER REDEFINES ADDR1F.
  1568         10  ADDR1A PIC  X(0001).
  1569     05  ADDR1I PIC  X(0030).
  1570*    -------------------------------
  1571     05  CONTRL PIC S9(0004) COMP.
  1572     05  CONTRF PIC  X(0001).
  1573     05  FILLER REDEFINES CONTRF.
  1574         10  CONTRA PIC  X(0001).
  1575     05  CONTRI PIC  X(0008).
  1576*    -------------------------------
  1577     05  TYPEL PIC S9(0004) COMP.
  1578     05  TYPEF PIC  X(0001).
  1579     05  FILLER REDEFINES TYPEF.
  1580         10  TYPEA PIC  X(0001).
  1581     05  TYPEI PIC  99.
  1582*    -------------------------------
  1583     05  ACITYL PIC S9(0004) COMP.
  1584     05  ACITYF PIC  X(0001).
  1585     05  FILLER REDEFINES ACITYF.
  1586         10  ACITYA PIC  X(0001).
  1587     05  ACITYI PIC  X(0028).
  1588*    -------------------------------
  1589     05  ASTATEL PIC S9(0004) COMP.
  1590     05  ASTATEF PIC  X(0001).
  1591     05  FILLER REDEFINES ASTATEF.
  1592         10  ASTATEA PIC  X(0001).
  1593     05  ASTATEI PIC  X(0002).
  1594*    -------------------------------
  1595     05  PRODATEL PIC S9(0004) COMP.
  1596     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  34
* EL6501.cbl
  1597     05  FILLER REDEFINES PRODATEF.
  1598         10  PRODATEA PIC  X(0001).
  1599     05  PRODATEI PIC  X(0008).
  1600*    -------------------------------
  1601     05  STDBENL PIC S9(0004) COMP.
  1602     05  STDBENF PIC  X(0001).
  1603     05  FILLER REDEFINES STDBENF.
  1604         10  STDBENA PIC  X(0001).
  1605     05  STDBENI PIC  X(0002).
  1606*    -------------------------------
  1607     05  ZIPL PIC S9(0004) COMP.
  1608     05  ZIPF PIC  X(0001).
  1609     05  FILLER REDEFINES ZIPF.
  1610         10  ZIPA PIC  X(0001).
  1611     05  ZIPI PIC  X(0010).
  1612*    -------------------------------
  1613     05  CTPLABLL PIC S9(0004) COMP.
  1614     05  CTPLABLF PIC  X(0001).
  1615     05  FILLER REDEFINES CTPLABLF.
  1616         10  CTPLABLA PIC  X(0001).
  1617     05  CTPLABLI PIC  X(0010).
  1618*    -------------------------------
  1619     05  CLPTOLPL PIC S9(0004) COMP.
  1620     05  CLPTOLPF PIC  X(0001).
  1621     05  FILLER REDEFINES CLPTOLPF.
  1622         10  CLPTOLPA PIC  X(0001).
  1623     05  CLPTOLPI PIC  S9(02)V9999.
  1624*    -------------------------------
  1625     05  RETROCDL PIC S9(0004) COMP.
  1626     05  RETROCDF PIC  X(0001).
  1627     05  FILLER REDEFINES RETROCDF.
  1628         10  RETROCDA PIC  X(0001).
  1629     05  RETROCDI PIC  X(0003).
  1630*    -------------------------------
  1631     05  BILLCDL PIC S9(0004) COMP.
  1632     05  BILLCDF PIC  X(0001).
  1633     05  FILLER REDEFINES BILLCDF.
  1634         10  BILLCDA PIC  X(0001).
  1635     05  BILLCDI PIC  X(0003).
  1636*    -------------------------------
  1637     05  LCLABLL PIC S9(0004) COMP.
  1638     05  LCLABLF PIC  X(0001).
  1639     05  FILLER REDEFINES LCLABLF.
  1640         10  LCLABLA PIC  X(0001).
  1641     05  LCLABLI PIC  X(0011).
  1642*    -------------------------------
  1643     05  LCOMML PIC S9(0004) COMP.
  1644     05  LCOMMF PIC  X(0001).
  1645     05  FILLER REDEFINES LCOMMF.
  1646         10  LCOMMA PIC  X(0001).
  1647     05  LCOMMI PIC  S9(6)V9(2).
  1648*    -------------------------------
  1649     05  MAXFEEHL PIC S9(0004) COMP.
  1650     05  MAXFEEHF PIC  X(0001).
  1651     05  FILLER REDEFINES MAXFEEHF.
  1652         10  MAXFEEHA PIC  X(0001).
  1653     05  MAXFEEHI PIC  X(0013).
  1654*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  35
* EL6501.cbl
  1655     05  MAXMFEEL PIC S9(0004) COMP.
  1656     05  MAXMFEEF PIC  X(0001).
  1657     05  FILLER REDEFINES MAXMFEEF.
  1658         10  MAXMFEEA PIC  X(0001).
  1659     05  MAXMFEEI PIC  X(0005).
  1660*    -------------------------------
  1661     05  CLPSTHL PIC S9(0004) COMP.
  1662     05  CLPSTHF PIC  X(0001).
  1663     05  FILLER REDEFINES CLPSTHF.
  1664         10  CLPSTHA PIC  X(0001).
  1665     05  CLPSTHI PIC  X(0010).
  1666*    -------------------------------
  1667     05  CLPSTL PIC S9(0004) COMP.
  1668     05  CLPSTF PIC  X(0001).
  1669     05  FILLER REDEFINES CLPSTF.
  1670         10  CLPSTA PIC  X(0001).
  1671     05  CLPSTI PIC  X(0002).
  1672*    -------------------------------
  1673     05  PRODCDHL PIC S9(0004) COMP.
  1674     05  PRODCDHF PIC  X(0001).
  1675     05  FILLER REDEFINES PRODCDHF.
  1676         10  PRODCDHA PIC  X(0001).
  1677     05  PRODCDHI PIC  X(0012).
  1678*    -------------------------------
  1679     05  PRODCDL PIC S9(0004) COMP.
  1680     05  PRODCDF PIC  X(0001).
  1681     05  FILLER REDEFINES PRODCDF.
  1682         10  PRODCDA PIC  X(0001).
  1683     05  PRODCDI PIC  X(0003).
  1684*    -------------------------------
  1685     05  REMITL PIC S9(0004) COMP.
  1686     05  REMITF PIC  X(0001).
  1687     05  FILLER REDEFINES REMITF.
  1688         10  REMITA PIC  X(0001).
  1689     05  REMITI PIC  99.
  1690*    -------------------------------
  1691     05  COMMCALL PIC S9(0004) COMP.
  1692     05  COMMCALF PIC  X(0001).
  1693     05  FILLER REDEFINES COMMCALF.
  1694         10  COMMCALA PIC  X(0001).
  1695     05  COMMCALI PIC  X(0001).
  1696*    -------------------------------
  1697     05  REINTABL PIC S9(0004) COMP.
  1698     05  REINTABF PIC  X(0001).
  1699     05  FILLER REDEFINES REINTABF.
  1700         10  REINTABA PIC  X(0001).
  1701     05  REINTABI PIC  X(0003).
  1702*    -------------------------------
  1703     05  REINCALL PIC S9(0004) COMP.
  1704     05  REINCALF PIC  X(0001).
  1705     05  FILLER REDEFINES REINCALF.
  1706         10  REINCALA PIC  X(0001).
  1707     05  REINCALI PIC  X(0001).
  1708*    -------------------------------
  1709     05  AHHEADL PIC S9(0004) COMP.
  1710     05  AHHEADF PIC  X(0001).
  1711     05  FILLER REDEFINES AHHEADF.
  1712         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  36
* EL6501.cbl
  1713     05  AHHEADI PIC  X(0006).
  1714*    -------------------------------
  1715     05  AGNT1L PIC S9(0004) COMP.
  1716     05  AGNT1F PIC  X(0001).
  1717     05  FILLER REDEFINES AGNT1F.
  1718         10  AGNT1A PIC  X(0001).
  1719     05  AGNT1I PIC  X(0010).
  1720*    -------------------------------
  1721     05  TYPE1L PIC S9(0004) COMP.
  1722     05  TYPE1F PIC  X(0001).
  1723     05  FILLER REDEFINES TYPE1F.
  1724         10  TYPE1A PIC  X(0001).
  1725     05  TYPE1I PIC  X(0001).
  1726*    -------------------------------
  1727     05  SINRT1L PIC S9(0004) COMP.
  1728     05  SINRT1F PIC  X(0001).
  1729     05  FILLER REDEFINES SINRT1F.
  1730         10  SINRT1A PIC  X(0001).
  1731     05  SINRT1I PIC  X(0006).
  1732*    -------------------------------
  1733     05  JNTRT1L PIC S9(0004) COMP.
  1734     05  JNTRT1F PIC  X(0001).
  1735     05  FILLER REDEFINES JNTRT1F.
  1736         10  JNTRT1A PIC  X(0001).
  1737     05  JNTRT1I PIC  X(0006).
  1738*    -------------------------------
  1739     05  AHRT1L PIC S9(0004) COMP.
  1740     05  AHRT1F PIC  X(0001).
  1741     05  FILLER REDEFINES AHRT1F.
  1742         10  AHRT1A PIC  X(0001).
  1743     05  AHRT1I PIC  X(0006).
  1744*    -------------------------------
  1745     05  RECAL1L PIC S9(0004) COMP.
  1746     05  RECAL1F PIC  X(0001).
  1747     05  FILLER REDEFINES RECAL1F.
  1748         10  RECAL1A PIC  X(0001).
  1749     05  RECAL1I PIC  X(0001).
  1750*    -------------------------------
  1751     05  COMM1L PIC S9(0004) COMP.
  1752     05  COMM1F PIC  X(0001).
  1753     05  FILLER REDEFINES COMM1F.
  1754         10  COMM1A PIC  X(0001).
  1755     05  COMM1I PIC  X(0001).
  1756*    -------------------------------
  1757     05  CHGBK1L PIC S9(0004) COMP.
  1758     05  CHGBK1F PIC  X(0001).
  1759     05  FILLER REDEFINES CHGBK1F.
  1760         10  CHGBK1A PIC  X(0001).
  1761     05  CHGBK1I PIC  X(0002).
  1762*    -------------------------------
  1763     05  GLCDE1L PIC S9(0004) COMP.
  1764     05  GLCDE1F PIC  X(0001).
  1765     05  FILLER REDEFINES GLCDE1F.
  1766         10  GLCDE1A PIC  X(0001).
  1767     05  GLCDE1I PIC  X(0001).
  1768*    -------------------------------
  1769     05  AGNT2L PIC S9(0004) COMP.
  1770     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  37
* EL6501.cbl
  1771     05  FILLER REDEFINES AGNT2F.
  1772         10  AGNT2A PIC  X(0001).
  1773     05  AGNT2I PIC  X(0010).
  1774*    -------------------------------
  1775     05  TYPE2L PIC S9(0004) COMP.
  1776     05  TYPE2F PIC  X(0001).
  1777     05  FILLER REDEFINES TYPE2F.
  1778         10  TYPE2A PIC  X(0001).
  1779     05  TYPE2I PIC  X(0001).
  1780*    -------------------------------
  1781     05  SINRT2L PIC S9(0004) COMP.
  1782     05  SINRT2F PIC  X(0001).
  1783     05  FILLER REDEFINES SINRT2F.
  1784         10  SINRT2A PIC  X(0001).
  1785     05  SINRT2I PIC  X(0006).
  1786*    -------------------------------
  1787     05  JNTRT2L PIC S9(0004) COMP.
  1788     05  JNTRT2F PIC  X(0001).
  1789     05  FILLER REDEFINES JNTRT2F.
  1790         10  JNTRT2A PIC  X(0001).
  1791     05  JNTRT2I PIC  X(0006).
  1792*    -------------------------------
  1793     05  AHRT2L PIC S9(0004) COMP.
  1794     05  AHRT2F PIC  X(0001).
  1795     05  FILLER REDEFINES AHRT2F.
  1796         10  AHRT2A PIC  X(0001).
  1797     05  AHRT2I PIC  X(0006).
  1798*    -------------------------------
  1799     05  RECAL2L PIC S9(0004) COMP.
  1800     05  RECAL2F PIC  X(0001).
  1801     05  FILLER REDEFINES RECAL2F.
  1802         10  RECAL2A PIC  X(0001).
  1803     05  RECAL2I PIC  X(0001).
  1804*    -------------------------------
  1805     05  COMM2L PIC S9(0004) COMP.
  1806     05  COMM2F PIC  X(0001).
  1807     05  FILLER REDEFINES COMM2F.
  1808         10  COMM2A PIC  X(0001).
  1809     05  COMM2I PIC  X(0001).
  1810*    -------------------------------
  1811     05  CHGBK2L PIC S9(0004) COMP.
  1812     05  CHGBK2F PIC  X(0001).
  1813     05  FILLER REDEFINES CHGBK2F.
  1814         10  CHGBK2A PIC  X(0001).
  1815     05  CHGBK2I PIC  X(0002).
  1816*    -------------------------------
  1817     05  GLCDE2L PIC S9(0004) COMP.
  1818     05  GLCDE2F PIC  X(0001).
  1819     05  FILLER REDEFINES GLCDE2F.
  1820         10  GLCDE2A PIC  X(0001).
  1821     05  GLCDE2I PIC  X(0001).
  1822*    -------------------------------
  1823     05  AGNT3L PIC S9(0004) COMP.
  1824     05  AGNT3F PIC  X(0001).
  1825     05  FILLER REDEFINES AGNT3F.
  1826         10  AGNT3A PIC  X(0001).
  1827     05  AGNT3I PIC  X(0010).
  1828*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  38
* EL6501.cbl
  1829     05  TYPE3L PIC S9(0004) COMP.
  1830     05  TYPE3F PIC  X(0001).
  1831     05  FILLER REDEFINES TYPE3F.
  1832         10  TYPE3A PIC  X(0001).
  1833     05  TYPE3I PIC  X(0001).
  1834*    -------------------------------
  1835     05  SINRT3L PIC S9(0004) COMP.
  1836     05  SINRT3F PIC  X(0001).
  1837     05  FILLER REDEFINES SINRT3F.
  1838         10  SINRT3A PIC  X(0001).
  1839     05  SINRT3I PIC  X(0006).
  1840*    -------------------------------
  1841     05  JNTRT3L PIC S9(0004) COMP.
  1842     05  JNTRT3F PIC  X(0001).
  1843     05  FILLER REDEFINES JNTRT3F.
  1844         10  JNTRT3A PIC  X(0001).
  1845     05  JNTRT3I PIC  X(0006).
  1846*    -------------------------------
  1847     05  AHRT3L PIC S9(0004) COMP.
  1848     05  AHRT3F PIC  X(0001).
  1849     05  FILLER REDEFINES AHRT3F.
  1850         10  AHRT3A PIC  X(0001).
  1851     05  AHRT3I PIC  X(0006).
  1852*    -------------------------------
  1853     05  RECAL3L PIC S9(0004) COMP.
  1854     05  RECAL3F PIC  X(0001).
  1855     05  FILLER REDEFINES RECAL3F.
  1856         10  RECAL3A PIC  X(0001).
  1857     05  RECAL3I PIC  X(0001).
  1858*    -------------------------------
  1859     05  COMM3L PIC S9(0004) COMP.
  1860     05  COMM3F PIC  X(0001).
  1861     05  FILLER REDEFINES COMM3F.
  1862         10  COMM3A PIC  X(0001).
  1863     05  COMM3I PIC  X(0001).
  1864*    -------------------------------
  1865     05  CHGBK3L PIC S9(0004) COMP.
  1866     05  CHGBK3F PIC  X(0001).
  1867     05  FILLER REDEFINES CHGBK3F.
  1868         10  CHGBK3A PIC  X(0001).
  1869     05  CHGBK3I PIC  X(0002).
  1870*    -------------------------------
  1871     05  GLCDE3L PIC S9(0004) COMP.
  1872     05  GLCDE3F PIC  X(0001).
  1873     05  FILLER REDEFINES GLCDE3F.
  1874         10  GLCDE3A PIC  X(0001).
  1875     05  GLCDE3I PIC  X(0001).
  1876*    -------------------------------
  1877     05  AGNT4L PIC S9(0004) COMP.
  1878     05  AGNT4F PIC  X(0001).
  1879     05  FILLER REDEFINES AGNT4F.
  1880         10  AGNT4A PIC  X(0001).
  1881     05  AGNT4I PIC  X(0010).
  1882*    -------------------------------
  1883     05  TYPE4L PIC S9(0004) COMP.
  1884     05  TYPE4F PIC  X(0001).
  1885     05  FILLER REDEFINES TYPE4F.
  1886         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  39
* EL6501.cbl
  1887     05  TYPE4I PIC  X(0001).
  1888*    -------------------------------
  1889     05  SINRT4L PIC S9(0004) COMP.
  1890     05  SINRT4F PIC  X(0001).
  1891     05  FILLER REDEFINES SINRT4F.
  1892         10  SINRT4A PIC  X(0001).
  1893     05  SINRT4I PIC  X(0006).
  1894*    -------------------------------
  1895     05  JNTRT4L PIC S9(0004) COMP.
  1896     05  JNTRT4F PIC  X(0001).
  1897     05  FILLER REDEFINES JNTRT4F.
  1898         10  JNTRT4A PIC  X(0001).
  1899     05  JNTRT4I PIC  X(0006).
  1900*    -------------------------------
  1901     05  AHRT4L PIC S9(0004) COMP.
  1902     05  AHRT4F PIC  X(0001).
  1903     05  FILLER REDEFINES AHRT4F.
  1904         10  AHRT4A PIC  X(0001).
  1905     05  AHRT4I PIC  X(0006).
  1906*    -------------------------------
  1907     05  RECAL4L PIC S9(0004) COMP.
  1908     05  RECAL4F PIC  X(0001).
  1909     05  FILLER REDEFINES RECAL4F.
  1910         10  RECAL4A PIC  X(0001).
  1911     05  RECAL4I PIC  X(0001).
  1912*    -------------------------------
  1913     05  COMM4L PIC S9(0004) COMP.
  1914     05  COMM4F PIC  X(0001).
  1915     05  FILLER REDEFINES COMM4F.
  1916         10  COMM4A PIC  X(0001).
  1917     05  COMM4I PIC  X(0001).
  1918*    -------------------------------
  1919     05  CHGBK4L PIC S9(0004) COMP.
  1920     05  CHGBK4F PIC  X(0001).
  1921     05  FILLER REDEFINES CHGBK4F.
  1922         10  CHGBK4A PIC  X(0001).
  1923     05  CHGBK4I PIC  X(0002).
  1924*    -------------------------------
  1925     05  GLCDE4L PIC S9(0004) COMP.
  1926     05  GLCDE4F PIC  X(0001).
  1927     05  FILLER REDEFINES GLCDE4F.
  1928         10  GLCDE4A PIC  X(0001).
  1929     05  GLCDE4I PIC  X(0001).
  1930*    -------------------------------
  1931     05  AGNT5L PIC S9(0004) COMP.
  1932     05  AGNT5F PIC  X(0001).
  1933     05  FILLER REDEFINES AGNT5F.
  1934         10  AGNT5A PIC  X(0001).
  1935     05  AGNT5I PIC  X(0010).
  1936*    -------------------------------
  1937     05  TYPE5L PIC S9(0004) COMP.
  1938     05  TYPE5F PIC  X(0001).
  1939     05  FILLER REDEFINES TYPE5F.
  1940         10  TYPE5A PIC  X(0001).
  1941     05  TYPE5I PIC  X(0001).
  1942*    -------------------------------
  1943     05  SINRT5L PIC S9(0004) COMP.
  1944     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  40
* EL6501.cbl
  1945     05  FILLER REDEFINES SINRT5F.
  1946         10  SINRT5A PIC  X(0001).
  1947     05  SINRT5I PIC  X(0006).
  1948*    -------------------------------
  1949     05  JNTRT5L PIC S9(0004) COMP.
  1950     05  JNTRT5F PIC  X(0001).
  1951     05  FILLER REDEFINES JNTRT5F.
  1952         10  JNTRT5A PIC  X(0001).
  1953     05  JNTRT5I PIC  X(0006).
  1954*    -------------------------------
  1955     05  AHRT5L PIC S9(0004) COMP.
  1956     05  AHRT5F PIC  X(0001).
  1957     05  FILLER REDEFINES AHRT5F.
  1958         10  AHRT5A PIC  X(0001).
  1959     05  AHRT5I PIC  X(0006).
  1960*    -------------------------------
  1961     05  RECAL5L PIC S9(0004) COMP.
  1962     05  RECAL5F PIC  X(0001).
  1963     05  FILLER REDEFINES RECAL5F.
  1964         10  RECAL5A PIC  X(0001).
  1965     05  RECAL5I PIC  X(0001).
  1966*    -------------------------------
  1967     05  COMM5L PIC S9(0004) COMP.
  1968     05  COMM5F PIC  X(0001).
  1969     05  FILLER REDEFINES COMM5F.
  1970         10  COMM5A PIC  X(0001).
  1971     05  COMM5I PIC  X(0001).
  1972*    -------------------------------
  1973     05  CHGBK5L PIC S9(0004) COMP.
  1974     05  CHGBK5F PIC  X(0001).
  1975     05  FILLER REDEFINES CHGBK5F.
  1976         10  CHGBK5A PIC  X(0001).
  1977     05  CHGBK5I PIC  X(0002).
  1978*    -------------------------------
  1979     05  GLCDE5L PIC S9(0004) COMP.
  1980     05  GLCDE5F PIC  X(0001).
  1981     05  FILLER REDEFINES GLCDE5F.
  1982         10  GLCDE5A PIC  X(0001).
  1983     05  GLCDE5I PIC  X(0001).
  1984*    -------------------------------
  1985     05  AGNT6L PIC S9(0004) COMP.
  1986     05  AGNT6F PIC  X(0001).
  1987     05  FILLER REDEFINES AGNT6F.
  1988         10  AGNT6A PIC  X(0001).
  1989     05  AGNT6I PIC  X(0010).
  1990*    -------------------------------
  1991     05  TYPE6L PIC S9(0004) COMP.
  1992     05  TYPE6F PIC  X(0001).
  1993     05  FILLER REDEFINES TYPE6F.
  1994         10  TYPE6A PIC  X(0001).
  1995     05  TYPE6I PIC  X(0001).
  1996*    -------------------------------
  1997     05  SINRT6L PIC S9(0004) COMP.
  1998     05  SINRT6F PIC  X(0001).
  1999     05  FILLER REDEFINES SINRT6F.
  2000         10  SINRT6A PIC  X(0001).
  2001     05  SINRT6I PIC  X(0006).
  2002*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  41
* EL6501.cbl
  2003     05  JNTRT6L PIC S9(0004) COMP.
  2004     05  JNTRT6F PIC  X(0001).
  2005     05  FILLER REDEFINES JNTRT6F.
  2006         10  JNTRT6A PIC  X(0001).
  2007     05  JNTRT6I PIC  X(0006).
  2008*    -------------------------------
  2009     05  AHRT6L PIC S9(0004) COMP.
  2010     05  AHRT6F PIC  X(0001).
  2011     05  FILLER REDEFINES AHRT6F.
  2012         10  AHRT6A PIC  X(0001).
  2013     05  AHRT6I PIC  X(0006).
  2014*    -------------------------------
  2015     05  RECAL6L PIC S9(0004) COMP.
  2016     05  RECAL6F PIC  X(0001).
  2017     05  FILLER REDEFINES RECAL6F.
  2018         10  RECAL6A PIC  X(0001).
  2019     05  RECAL6I PIC  X(0001).
  2020*    -------------------------------
  2021     05  COMM6L PIC S9(0004) COMP.
  2022     05  COMM6F PIC  X(0001).
  2023     05  FILLER REDEFINES COMM6F.
  2024         10  COMM6A PIC  X(0001).
  2025     05  COMM6I PIC  X(0001).
  2026*    -------------------------------
  2027     05  CHGBK6L PIC S9(0004) COMP.
  2028     05  CHGBK6F PIC  X(0001).
  2029     05  FILLER REDEFINES CHGBK6F.
  2030         10  CHGBK6A PIC  X(0001).
  2031     05  CHGBK6I PIC  X(0002).
  2032*    -------------------------------
  2033     05  GLCDE6L PIC S9(0004) COMP.
  2034     05  GLCDE6F PIC  X(0001).
  2035     05  FILLER REDEFINES GLCDE6F.
  2036         10  GLCDE6A PIC  X(0001).
  2037     05  GLCDE6I PIC  X(0001).
  2038*    -------------------------------
  2039     05  AGNT7L PIC S9(0004) COMP.
  2040     05  AGNT7F PIC  X(0001).
  2041     05  FILLER REDEFINES AGNT7F.
  2042         10  AGNT7A PIC  X(0001).
  2043     05  AGNT7I PIC  X(0010).
  2044*    -------------------------------
  2045     05  TYPE7L PIC S9(0004) COMP.
  2046     05  TYPE7F PIC  X(0001).
  2047     05  FILLER REDEFINES TYPE7F.
  2048         10  TYPE7A PIC  X(0001).
  2049     05  TYPE7I PIC  X(0001).
  2050*    -------------------------------
  2051     05  SINRT7L PIC S9(0004) COMP.
  2052     05  SINRT7F PIC  X(0001).
  2053     05  FILLER REDEFINES SINRT7F.
  2054         10  SINRT7A PIC  X(0001).
  2055     05  SINRT7I PIC  X(0006).
  2056*    -------------------------------
  2057     05  JNTRT7L PIC S9(0004) COMP.
  2058     05  JNTRT7F PIC  X(0001).
  2059     05  FILLER REDEFINES JNTRT7F.
  2060         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  42
* EL6501.cbl
  2061     05  JNTRT7I PIC  X(0006).
  2062*    -------------------------------
  2063     05  AHRT7L PIC S9(0004) COMP.
  2064     05  AHRT7F PIC  X(0001).
  2065     05  FILLER REDEFINES AHRT7F.
  2066         10  AHRT7A PIC  X(0001).
  2067     05  AHRT7I PIC  X(0006).
  2068*    -------------------------------
  2069     05  RECAL7L PIC S9(0004) COMP.
  2070     05  RECAL7F PIC  X(0001).
  2071     05  FILLER REDEFINES RECAL7F.
  2072         10  RECAL7A PIC  X(0001).
  2073     05  RECAL7I PIC  X(0001).
  2074*    -------------------------------
  2075     05  COMM7L PIC S9(0004) COMP.
  2076     05  COMM7F PIC  X(0001).
  2077     05  FILLER REDEFINES COMM7F.
  2078         10  COMM7A PIC  X(0001).
  2079     05  COMM7I PIC  X(0001).
  2080*    -------------------------------
  2081     05  CHGBK7L PIC S9(0004) COMP.
  2082     05  CHGBK7F PIC  X(0001).
  2083     05  FILLER REDEFINES CHGBK7F.
  2084         10  CHGBK7A PIC  X(0001).
  2085     05  CHGBK7I PIC  X(0002).
  2086*    -------------------------------
  2087     05  GLCDE7L PIC S9(0004) COMP.
  2088     05  GLCDE7F PIC  X(0001).
  2089     05  FILLER REDEFINES GLCDE7F.
  2090         10  GLCDE7A PIC  X(0001).
  2091     05  GLCDE7I PIC  X(0001).
  2092*    -------------------------------
  2093     05  AGNT8L PIC S9(0004) COMP.
  2094     05  AGNT8F PIC  X(0001).
  2095     05  FILLER REDEFINES AGNT8F.
  2096         10  AGNT8A PIC  X(0001).
  2097     05  AGNT8I PIC  X(0010).
  2098*    -------------------------------
  2099     05  TYPE8L PIC S9(0004) COMP.
  2100     05  TYPE8F PIC  X(0001).
  2101     05  FILLER REDEFINES TYPE8F.
  2102         10  TYPE8A PIC  X(0001).
  2103     05  TYPE8I PIC  X(0001).
  2104*    -------------------------------
  2105     05  SINRT8L PIC S9(0004) COMP.
  2106     05  SINRT8F PIC  X(0001).
  2107     05  FILLER REDEFINES SINRT8F.
  2108         10  SINRT8A PIC  X(0001).
  2109     05  SINRT8I PIC  X(0006).
  2110*    -------------------------------
  2111     05  JNTRT8L PIC S9(0004) COMP.
  2112     05  JNTRT8F PIC  X(0001).
  2113     05  FILLER REDEFINES JNTRT8F.
  2114         10  JNTRT8A PIC  X(0001).
  2115     05  JNTRT8I PIC  X(0006).
  2116*    -------------------------------
  2117     05  AHRT8L PIC S9(0004) COMP.
  2118     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  43
* EL6501.cbl
  2119     05  FILLER REDEFINES AHRT8F.
  2120         10  AHRT8A PIC  X(0001).
  2121     05  AHRT8I PIC  X(0006).
  2122*    -------------------------------
  2123     05  RECAL8L PIC S9(0004) COMP.
  2124     05  RECAL8F PIC  X(0001).
  2125     05  FILLER REDEFINES RECAL8F.
  2126         10  RECAL8A PIC  X(0001).
  2127     05  RECAL8I PIC  X(0001).
  2128*    -------------------------------
  2129     05  COMM8L PIC S9(0004) COMP.
  2130     05  COMM8F PIC  X(0001).
  2131     05  FILLER REDEFINES COMM8F.
  2132         10  COMM8A PIC  X(0001).
  2133     05  COMM8I PIC  X(0001).
  2134*    -------------------------------
  2135     05  CHGBK8L PIC S9(0004) COMP.
  2136     05  CHGBK8F PIC  X(0001).
  2137     05  FILLER REDEFINES CHGBK8F.
  2138         10  CHGBK8A PIC  X(0001).
  2139     05  CHGBK8I PIC  X(0002).
  2140*    -------------------------------
  2141     05  GLCDE8L PIC S9(0004) COMP.
  2142     05  GLCDE8F PIC  X(0001).
  2143     05  FILLER REDEFINES GLCDE8F.
  2144         10  GLCDE8A PIC  X(0001).
  2145     05  GLCDE8I PIC  X(0001).
  2146*    -------------------------------
  2147     05  AGNT9L PIC S9(0004) COMP.
  2148     05  AGNT9F PIC  X(0001).
  2149     05  FILLER REDEFINES AGNT9F.
  2150         10  AGNT9A PIC  X(0001).
  2151     05  AGNT9I PIC  X(0010).
  2152*    -------------------------------
  2153     05  TYPE9L PIC S9(0004) COMP.
  2154     05  TYPE9F PIC  X(0001).
  2155     05  FILLER REDEFINES TYPE9F.
  2156         10  TYPE9A PIC  X(0001).
  2157     05  TYPE9I PIC  X(0001).
  2158*    -------------------------------
  2159     05  SINRT9L PIC S9(0004) COMP.
  2160     05  SINRT9F PIC  X(0001).
  2161     05  FILLER REDEFINES SINRT9F.
  2162         10  SINRT9A PIC  X(0001).
  2163     05  SINRT9I PIC  X(0006).
  2164*    -------------------------------
  2165     05  JNTRT9L PIC S9(0004) COMP.
  2166     05  JNTRT9F PIC  X(0001).
  2167     05  FILLER REDEFINES JNTRT9F.
  2168         10  JNTRT9A PIC  X(0001).
  2169     05  JNTRT9I PIC  X(0006).
  2170*    -------------------------------
  2171     05  AHRT9L PIC S9(0004) COMP.
  2172     05  AHRT9F PIC  X(0001).
  2173     05  FILLER REDEFINES AHRT9F.
  2174         10  AHRT9A PIC  X(0001).
  2175     05  AHRT9I PIC  X(0006).
  2176*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  44
* EL6501.cbl
  2177     05  RECAL9L PIC S9(0004) COMP.
  2178     05  RECAL9F PIC  X(0001).
  2179     05  FILLER REDEFINES RECAL9F.
  2180         10  RECAL9A PIC  X(0001).
  2181     05  RECAL9I PIC  X(0001).
  2182*    -------------------------------
  2183     05  COMM9L PIC S9(0004) COMP.
  2184     05  COMM9F PIC  X(0001).
  2185     05  FILLER REDEFINES COMM9F.
  2186         10  COMM9A PIC  X(0001).
  2187     05  COMM9I PIC  X(0001).
  2188*    -------------------------------
  2189     05  CHGBK9L PIC S9(0004) COMP.
  2190     05  CHGBK9F PIC  X(0001).
  2191     05  FILLER REDEFINES CHGBK9F.
  2192         10  CHGBK9A PIC  X(0001).
  2193     05  CHGBK9I PIC  X(0002).
  2194*    -------------------------------
  2195     05  GLCDE9L PIC S9(0004) COMP.
  2196     05  GLCDE9F PIC  X(0001).
  2197     05  FILLER REDEFINES GLCDE9F.
  2198         10  GLCDE9A PIC  X(0001).
  2199     05  GLCDE9I PIC  X(0001).
  2200*    -------------------------------
  2201     05  AGNT10L PIC S9(0004) COMP.
  2202     05  AGNT10F PIC  X(0001).
  2203     05  FILLER REDEFINES AGNT10F.
  2204         10  AGNT10A PIC  X(0001).
  2205     05  AGNT10I PIC  X(0010).
  2206*    -------------------------------
  2207     05  TYPE10L PIC S9(0004) COMP.
  2208     05  TYPE10F PIC  X(0001).
  2209     05  FILLER REDEFINES TYPE10F.
  2210         10  TYPE10A PIC  X(0001).
  2211     05  TYPE10I PIC  X(0001).
  2212*    -------------------------------
  2213     05  SINRT10L PIC S9(0004) COMP.
  2214     05  SINRT10F PIC  X(0001).
  2215     05  FILLER REDEFINES SINRT10F.
  2216         10  SINRT10A PIC  X(0001).
  2217     05  SINRT10I PIC  X(0006).
  2218*    -------------------------------
  2219     05  JNTRT10L PIC S9(0004) COMP.
  2220     05  JNTRT10F PIC  X(0001).
  2221     05  FILLER REDEFINES JNTRT10F.
  2222         10  JNTRT10A PIC  X(0001).
  2223     05  JNTRT10I PIC  X(0006).
  2224*    -------------------------------
  2225     05  AHRT10L PIC S9(0004) COMP.
  2226     05  AHRT10F PIC  X(0001).
  2227     05  FILLER REDEFINES AHRT10F.
  2228         10  AHRT10A PIC  X(0001).
  2229     05  AHRT10I PIC  X(0006).
  2230*    -------------------------------
  2231     05  RECAL10L PIC S9(0004) COMP.
  2232     05  RECAL10F PIC  X(0001).
  2233     05  FILLER REDEFINES RECAL10F.
  2234         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  45
* EL6501.cbl
  2235     05  RECAL10I PIC  X(0001).
  2236*    -------------------------------
  2237     05  COMM10L PIC S9(0004) COMP.
  2238     05  COMM10F PIC  X(0001).
  2239     05  FILLER REDEFINES COMM10F.
  2240         10  COMM10A PIC  X(0001).
  2241     05  COMM10I PIC  X(0001).
  2242*    -------------------------------
  2243     05  CHGBK10L PIC S9(0004) COMP.
  2244     05  CHGBK10F PIC  X(0001).
  2245     05  FILLER REDEFINES CHGBK10F.
  2246         10  CHGBK10A PIC  X(0001).
  2247     05  CHGBK10I PIC  X(0002).
  2248*    -------------------------------
  2249     05  GLCDE10L PIC S9(0004) COMP.
  2250     05  GLCDE10F PIC  X(0001).
  2251     05  FILLER REDEFINES GLCDE10F.
  2252         10  GLCDE10A PIC  X(0001).
  2253     05  GLCDE10I PIC  X(0001).
  2254*    -------------------------------
  2255     05  ERRMSG1L PIC S9(0004) COMP.
  2256     05  ERRMSG1F PIC  X(0001).
  2257     05  FILLER REDEFINES ERRMSG1F.
  2258         10  ERRMSG1A PIC  X(0001).
  2259     05  ERRMSG1I PIC  X(0075).
  2260*    -------------------------------
  2261     05  PFENTERL PIC S9(0004) COMP.
  2262     05  PFENTERF PIC  X(0001).
  2263     05  FILLER REDEFINES PFENTERF.
  2264         10  PFENTERA PIC  X(0001).
  2265     05  PFENTERI PIC  9(2).
  2266*    -------------------------------
  2267     05  PF1PF2L PIC S9(0004) COMP.
  2268     05  PF1PF2F PIC  X(0001).
  2269     05  FILLER REDEFINES PF1PF2F.
  2270         10  PF1PF2A PIC  X(0001).
  2271     05  PF1PF2I PIC  X(0035).
  2272 01  EL6501AO REDEFINES EL6501AI.
  2273     05  FILLER            PIC  X(0012).
  2274*    -------------------------------
  2275     05  FILLER            PIC  X(0003).
  2276     05  DATEO PIC  X(0008).
  2277*    -------------------------------
  2278     05  FILLER            PIC  X(0003).
  2279     05  TIMEO PIC  99.99.
  2280*    -------------------------------
  2281     05  FILLER            PIC  X(0003).
  2282     05  CMPNYIDO PIC  X(0003).
  2283*    -------------------------------
  2284     05  FILLER            PIC  X(0003).
  2285     05  USERIDO PIC  X(0004).
  2286*    -------------------------------
  2287     05  FILLER            PIC  X(0003).
  2288     05  MAINTO PIC  X(0001).
  2289*    -------------------------------
  2290     05  FILLER            PIC  X(0003).
  2291     05  CARRO PIC  X(0001).
  2292*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  46
* EL6501.cbl
  2293     05  FILLER            PIC  X(0003).
  2294     05  GROUPINO PIC  X(0006).
  2295*    -------------------------------
  2296     05  FILLER            PIC  X(0003).
  2297     05  STATEO PIC  X(0002).
  2298*    -------------------------------
  2299     05  FILLER            PIC  X(0003).
  2300     05  ACCOUNTO PIC  X(0010).
  2301*    -------------------------------
  2302     05  FILLER            PIC  X(0003).
  2303     05  EFFDTEO PIC  X(0008).
  2304*    -------------------------------
  2305     05  FILLER            PIC  X(0003).
  2306     05  EXPDTEO PIC  99B99B99.
  2307*    -------------------------------
  2308     05  FILLER            PIC  X(0003).
  2309     05  MAINTBYO PIC  X(0004).
  2310*    -------------------------------
  2311     05  FILLER            PIC  X(0003).
  2312     05  PCONTO PIC  X(0030).
  2313*    -------------------------------
  2314     05  FILLER            PIC  X(0003).
  2315     05  CSRO PIC  X(0004).
  2316*    -------------------------------
  2317     05  FILLER            PIC  X(0003).
  2318     05  PDSPLYO PIC  X(0006).
  2319*    -------------------------------
  2320     05  FILLER            PIC  X(0003).
  2321     05  PEFFDTEO PIC  X(0008).
  2322*    -------------------------------
  2323     05  FILLER            PIC  X(0003).
  2324     05  PEXPDTEO PIC  X(0008).
  2325*    -------------------------------
  2326     05  FILLER            PIC  X(0003).
  2327     05  NAMEO PIC  X(0030).
  2328*    -------------------------------
  2329     05  FILLER            PIC  X(0003).
  2330     05  TAXNOO PIC  X(0011).
  2331*    -------------------------------
  2332     05  FILLER            PIC  X(0003).
  2333     05  STATUSO PIC  X(0001).
  2334*    -------------------------------
  2335     05  FILLER            PIC  X(0003).
  2336     05  INCAREO PIC  X(0030).
  2337*    -------------------------------
  2338     05  FILLER            PIC  X(0003).
  2339     05  PHONEO PIC  999B999B9999.
  2340*    -------------------------------
  2341     05  FILLER            PIC  X(0003).
  2342     05  INDGRPO PIC  X(0001).
  2343*    -------------------------------
  2344     05  FILLER            PIC  X(0003).
  2345     05  ADDR1O PIC  X(0030).
  2346*    -------------------------------
  2347     05  FILLER            PIC  X(0003).
  2348     05  CONTRO PIC  X(0008).
  2349*    -------------------------------
  2350     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  47
* EL6501.cbl
  2351     05  TYPEO PIC  X(0002).
  2352*    -------------------------------
  2353     05  FILLER            PIC  X(0003).
  2354     05  ACITYO PIC  X(0028).
  2355*    -------------------------------
  2356     05  FILLER            PIC  X(0003).
  2357     05  ASTATEO PIC  X(0002).
  2358*    -------------------------------
  2359     05  FILLER            PIC  X(0003).
  2360     05  PRODATEO PIC  X(0008).
  2361*    -------------------------------
  2362     05  FILLER            PIC  X(0003).
  2363     05  STDBENO PIC  X(0002).
  2364*    -------------------------------
  2365     05  FILLER            PIC  X(0003).
  2366     05  ZIPO PIC  X(0010).
  2367*    -------------------------------
  2368     05  FILLER            PIC  X(0003).
  2369     05  CTPLABLO PIC  X(0010).
  2370*    -------------------------------
  2371     05  FILLER            PIC  X(0003).
  2372     05  CLPTOLPO PIC  Z.9999.
  2373*    -------------------------------
  2374     05  FILLER            PIC  X(0003).
  2375     05  RETROCDO PIC  X(0003).
  2376*    -------------------------------
  2377     05  FILLER            PIC  X(0003).
  2378     05  BILLCDO PIC  X(0003).
  2379*    -------------------------------
  2380     05  FILLER            PIC  X(0003).
  2381     05  LCLABLO PIC  X(0011).
  2382*    -------------------------------
  2383     05  FILLER            PIC  X(0003).
  2384     05  LCOMMO PIC  ZZ99.99-.
  2385*    -------------------------------
  2386     05  FILLER            PIC  X(0003).
  2387     05  MAXFEEHO PIC  X(0013).
  2388*    -------------------------------
  2389     05  FILLER            PIC  X(0003).
  2390     05  MAXMFEEO PIC  Z,Z99.
  2391*    -------------------------------
  2392     05  FILLER            PIC  X(0003).
  2393     05  CLPSTHO PIC  X(0010).
  2394*    -------------------------------
  2395     05  FILLER            PIC  X(0003).
  2396     05  CLPSTO PIC  X(0002).
  2397*    -------------------------------
  2398     05  FILLER            PIC  X(0003).
  2399     05  PRODCDHO PIC  X(0012).
  2400*    -------------------------------
  2401     05  FILLER            PIC  X(0003).
  2402     05  PRODCDO PIC  X(0003).
  2403*    -------------------------------
  2404     05  FILLER            PIC  X(0003).
  2405     05  REMITO PIC  X(0002).
  2406*    -------------------------------
  2407     05  FILLER            PIC  X(0003).
  2408     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  48
* EL6501.cbl
  2409*    -------------------------------
  2410     05  FILLER            PIC  X(0003).
  2411     05  REINTABO PIC  X(0003).
  2412*    -------------------------------
  2413     05  FILLER            PIC  X(0003).
  2414     05  REINCALO PIC  X(0001).
  2415*    -------------------------------
  2416     05  FILLER            PIC  X(0003).
  2417     05  AHHEADO PIC  X(0006).
  2418*    -------------------------------
  2419     05  FILLER            PIC  X(0003).
  2420     05  AGNT1O PIC  X(0010).
  2421*    -------------------------------
  2422     05  FILLER            PIC  X(0003).
  2423     05  TYPE1O PIC  X(0001).
  2424*    -------------------------------
  2425     05  FILLER            PIC  X(0003).
  2426     05  SINRT1O PIC  X(0006).
  2427*    -------------------------------
  2428     05  FILLER            PIC  X(0003).
  2429     05  JNTRT1O PIC  X(0006).
  2430*    -------------------------------
  2431     05  FILLER            PIC  X(0003).
  2432     05  AHRT1O PIC  X(0006).
  2433*    -------------------------------
  2434     05  FILLER            PIC  X(0003).
  2435     05  RECAL1O PIC  X(0001).
  2436*    -------------------------------
  2437     05  FILLER            PIC  X(0003).
  2438     05  COMM1O PIC  X(0001).
  2439*    -------------------------------
  2440     05  FILLER            PIC  X(0003).
  2441     05  CHGBK1O PIC  X(0002).
  2442*    -------------------------------
  2443     05  FILLER            PIC  X(0003).
  2444     05  GLCDE1O PIC  X(0001).
  2445*    -------------------------------
  2446     05  FILLER            PIC  X(0003).
  2447     05  AGNT2O PIC  X(0010).
  2448*    -------------------------------
  2449     05  FILLER            PIC  X(0003).
  2450     05  TYPE2O PIC  X(0001).
  2451*    -------------------------------
  2452     05  FILLER            PIC  X(0003).
  2453     05  SINRT2O PIC  X(0006).
  2454*    -------------------------------
  2455     05  FILLER            PIC  X(0003).
  2456     05  JNTRT2O PIC  X(0006).
  2457*    -------------------------------
  2458     05  FILLER            PIC  X(0003).
  2459     05  AHRT2O PIC  X(0006).
  2460*    -------------------------------
  2461     05  FILLER            PIC  X(0003).
  2462     05  RECAL2O PIC  X(0001).
  2463*    -------------------------------
  2464     05  FILLER            PIC  X(0003).
  2465     05  COMM2O PIC  X(0001).
  2466*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  49
* EL6501.cbl
  2467     05  FILLER            PIC  X(0003).
  2468     05  CHGBK2O PIC  X(0002).
  2469*    -------------------------------
  2470     05  FILLER            PIC  X(0003).
  2471     05  GLCDE2O PIC  X(0001).
  2472*    -------------------------------
  2473     05  FILLER            PIC  X(0003).
  2474     05  AGNT3O PIC  X(0010).
  2475*    -------------------------------
  2476     05  FILLER            PIC  X(0003).
  2477     05  TYPE3O PIC  X(0001).
  2478*    -------------------------------
  2479     05  FILLER            PIC  X(0003).
  2480     05  SINRT3O PIC  X(0006).
  2481*    -------------------------------
  2482     05  FILLER            PIC  X(0003).
  2483     05  JNTRT3O PIC  X(0006).
  2484*    -------------------------------
  2485     05  FILLER            PIC  X(0003).
  2486     05  AHRT3O PIC  X(0006).
  2487*    -------------------------------
  2488     05  FILLER            PIC  X(0003).
  2489     05  RECAL3O PIC  X(0001).
  2490*    -------------------------------
  2491     05  FILLER            PIC  X(0003).
  2492     05  COMM3O PIC  X(0001).
  2493*    -------------------------------
  2494     05  FILLER            PIC  X(0003).
  2495     05  CHGBK3O PIC  X(0002).
  2496*    -------------------------------
  2497     05  FILLER            PIC  X(0003).
  2498     05  GLCDE3O PIC  X(0001).
  2499*    -------------------------------
  2500     05  FILLER            PIC  X(0003).
  2501     05  AGNT4O PIC  X(0010).
  2502*    -------------------------------
  2503     05  FILLER            PIC  X(0003).
  2504     05  TYPE4O PIC  X(0001).
  2505*    -------------------------------
  2506     05  FILLER            PIC  X(0003).
  2507     05  SINRT4O PIC  X(0006).
  2508*    -------------------------------
  2509     05  FILLER            PIC  X(0003).
  2510     05  JNTRT4O PIC  X(0006).
  2511*    -------------------------------
  2512     05  FILLER            PIC  X(0003).
  2513     05  AHRT4O PIC  X(0006).
  2514*    -------------------------------
  2515     05  FILLER            PIC  X(0003).
  2516     05  RECAL4O PIC  X(0001).
  2517*    -------------------------------
  2518     05  FILLER            PIC  X(0003).
  2519     05  COMM4O PIC  X(0001).
  2520*    -------------------------------
  2521     05  FILLER            PIC  X(0003).
  2522     05  CHGBK4O PIC  X(0002).
  2523*    -------------------------------
  2524     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  50
* EL6501.cbl
  2525     05  GLCDE4O PIC  X(0001).
  2526*    -------------------------------
  2527     05  FILLER            PIC  X(0003).
  2528     05  AGNT5O PIC  X(0010).
  2529*    -------------------------------
  2530     05  FILLER            PIC  X(0003).
  2531     05  TYPE5O PIC  X(0001).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  SINRT5O PIC  X(0006).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  JNTRT5O PIC  X(0006).
  2538*    -------------------------------
  2539     05  FILLER            PIC  X(0003).
  2540     05  AHRT5O PIC  X(0006).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  RECAL5O PIC  X(0001).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  COMM5O PIC  X(0001).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  CHGBK5O PIC  X(0002).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  GLCDE5O PIC  X(0001).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  AGNT6O PIC  X(0010).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  TYPE6O PIC  X(0001).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  SINRT6O PIC  X(0006).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  JNTRT6O PIC  X(0006).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  AHRT6O PIC  X(0006).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  RECAL6O PIC  X(0001).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  COMM6O PIC  X(0001).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  CHGBK6O PIC  X(0002).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  GLCDE6O PIC  X(0001).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  51
* EL6501.cbl
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  TYPE7O PIC  X(0001).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  SINRT7O PIC  X(0006).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  JNTRT7O PIC  X(0006).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  AHRT7O PIC  X(0006).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
  2597     05  RECAL7O PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  COMM7O PIC  X(0001).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  CHGBK7O PIC  X(0002).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  GLCDE7O PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  AGNT8O PIC  X(0010).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  TYPE8O PIC  X(0001).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  SINRT8O PIC  X(0006).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  JNTRT8O PIC  X(0006).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  AHRT8O PIC  X(0006).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  RECAL8O PIC  X(0001).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  COMM8O PIC  X(0001).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  CHGBK8O PIC  X(0002).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  GLCDE8O PIC  X(0001).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  AGNT9O PIC  X(0010).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  TYPE9O PIC  X(0001).
  2640*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  52
* EL6501.cbl
  2641     05  FILLER            PIC  X(0003).
  2642     05  SINRT9O PIC  X(0006).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  JNTRT9O PIC  X(0006).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  AHRT9O PIC  X(0006).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  RECAL9O PIC  X(0001).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  COMM9O PIC  X(0001).
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  CHGBK9O PIC  X(0002).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  GLCDE9O PIC  X(0001).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  AGNT10O PIC  X(0010).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  TYPE10O PIC  X(0001).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  SINRT10O PIC  X(0006).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  JNTRT10O PIC  X(0006).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  AHRT10O PIC  X(0006).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  RECAL10O PIC  X(0001).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  COMM10O PIC  X(0001).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  CHGBK10O PIC  X(0002).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  GLCDE10O PIC  X(0001).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  ERRMSG1O PIC  X(0075).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  PFENTERO PIC  X(0002).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  PF1PF2O PIC  X(0035).
  2697*    -------------------------------
  2698 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  53
* EL6501.cbl
  2699*    12  FILLER                  PIC X(518).
  2700*    12  FILLER                  PIC X(543).
  2701     12  FILLER                  PIC X(546).
  2702     12  MAP-AGENT-AREA.
  2703         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2704             20  AGENTL          PIC S9(4) COMP.
  2705             20  AGENTA          PIC X.
  2706             20  AGENT           PIC X(10).
  2707             20  ATYPEL          PIC S9(4) COMP.
  2708             20  ATYPEA          PIC X.
  2709             20  ATYPE           PIC X.
  2710             20  SINGLEL         PIC S9(4) COMP.
  2711             20  SINGLEA         PIC X.
  2712             20  SINGLE-COMM-T   PIC X(6).
  2713             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2714                 24  SINGLE-COMM-R PIC V9(5).
  2715                 24  SINGLE-DASH   PIC X.
  2716             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2717                                 PIC V9(5)-.
  2718             20  JOINTL          PIC S9(4) COMP.
  2719             20  JOINTA          PIC X.
  2720             20  JOINT-COMM-T    PIC X(6).
  2721             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2722                 24  JOINT-COMM-R PIC V9(5).
  2723                 24  JOINT-DASH   PIC X.
  2724             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2725                                 PIC V9(5)-.
  2726             20  A-HL            PIC S9(4) COMP.
  2727             20  A-HA            PIC X.
  2728             20  A-H-COMM-T      PIC X(6).
  2729             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2730                 24  A-H-COMM-R  PIC V9(5).
  2731                 24  A-H-DASH    PIC X.
  2732             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2733                                 PIC V9(5)-.
  2734             20  RECALL          PIC S9(4) COMP.
  2735             20  RECALA          PIC X.
  2736             20  RECAL           PIC X.
  2737             20  RCOMML          PIC S9(4) COMP.
  2738             20  RCOMMA          PIC X.
  2739             20  RCOMM           PIC X.
  2740             20  CHGBCKL         PIC S9(4) COMP.
  2741             20  CHGBCKA         PIC X.
  2742             20  CHGBCK          PIC X(02).
  2743             20  GLCODEL         PIC S9(4) COMP.
  2744             20  GLCODEA         PIC X.
  2745             20  GLCODE          PIC X.
  2746****************************************************************
  2747*
  2748* Copyright (c) 2007 by Clerity Solutions, Inc.
  2749* All rights reserved.
  2750*
  2751****************************************************************
  2752 01  DFHEIV.
  2753   02  DFHEIV0               PIC X(35).
  2754   02  DFHEIV1               PIC X(08).
  2755   02  DFHEIV2               PIC X(08).
  2756   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  54
* EL6501.cbl
  2757   02  DFHEIV4               PIC X(06).
  2758   02  DFHEIV5               PIC X(04).
  2759   02  DFHEIV6               PIC X(04).
  2760   02  DFHEIV7               PIC X(02).
  2761   02  DFHEIV8               PIC X(02).
  2762   02  DFHEIV9               PIC X(01).
  2763   02  DFHEIV10              PIC S9(7) COMP-3.
  2764   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2765   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2766   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2767   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2768   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2769   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2770   02  DFHEIV17              PIC X(04).
  2771   02  DFHEIV18              PIC X(04).
  2772   02  DFHEIV19              PIC X(04).
  2773   02  DFHEIV20              USAGE IS POINTER.
  2774   02  DFHEIV21              USAGE IS POINTER.
  2775   02  DFHEIV22              USAGE IS POINTER.
  2776   02  DFHEIV23              USAGE IS POINTER.
  2777   02  DFHEIV24              USAGE IS POINTER.
  2778   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2779   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2780   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2781   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2782   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2783   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2784   02  FILLER                PIC X(02).
  2785   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2786   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2787   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2788   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2789   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2790 LINKAGE  SECTION.
  2791*****************************************************************
  2792*                                                               *
  2793* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2794* All rights reserved.                                          *
  2795*                                                               *
  2796*****************************************************************
  2797 01  dfheiblk.
  2798     02  eibtime          pic s9(7) comp-3.
  2799     02  eibdate          pic s9(7) comp-3.
  2800     02  eibtrnid         pic x(4).
  2801     02  eibtaskn         pic s9(7) comp-3.
  2802     02  eibtrmid         pic x(4).
  2803     02  dfheigdi         pic s9(4) comp.
  2804     02  eibcposn         pic s9(4) comp.
  2805     02  eibcalen         pic s9(4) comp.
  2806     02  eibaid           pic x(1).
  2807     02  eibfiller1       pic x(1).
  2808     02  eibfn            pic x(2).
  2809     02  eibfiller2       pic x(2).
  2810     02  eibrcode         pic x(6).
  2811     02  eibfiller3       pic x(2).
  2812     02  eibds            pic x(8).
  2813     02  eibreqid         pic x(8).
  2814     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  55
* EL6501.cbl
  2815     02  eibsync          pic x(1).
  2816     02  eibfree          pic x(1).
  2817     02  eibrecv          pic x(1).
  2818     02  eibsend          pic x(1).
  2819     02  eibatt           pic x(1).
  2820     02  eibeoc           pic x(1).
  2821     02  eibfmh           pic x(1).
  2822     02  eibcompl         pic x(1).
  2823     02  eibsig           pic x(1).
  2824     02  eibconf          pic x(1).
  2825     02  eiberr           pic x(1).
  2826     02  eibrldbk         pic x(1).
  2827     02  eiberrcd         pic x(4).
  2828     02  eibsynrb         pic x(1).
  2829     02  eibnodat         pic x(1).
  2830     02  eibfiller5       pic x(2).
  2831     02  eibresp          pic 9(09) comp.
  2832     02  eibresp2         pic 9(09) comp.
  2833     02  dfheigdj         pic s9(4) comp.
  2834     02  dfheigdk         pic s9(4) comp.
  2835 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  56
* EL6501.cbl
  2837*01 PARMLIST .
  2838*    02  FILLER                  PIC S9(8)   COMP.
  2839*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2840*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2841*    02  REIN-POINTER            PIC S9(8)   COMP.
  2842*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2843*    02  COMM-POINTER            PIC S9(8)   COMP.
  2844*    02  COMP-POINTER            PIC S9(8)   COMP.
  2845*    02  NAME-POINTER            PIC S9(8)   COMP.
  2846*    02  RQST-POINTER            PIC S9(8)   COMP.
  2847*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2848*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2849*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2850*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2851*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2852*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2853*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2854*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2855*    COPY ERCACCT.
  2856******************************************************************
  2857*                                                                *
  2858*                                                                *
  2859*                            ERCACCT                             *
  2860*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2861*                            VMOD=2.031                          *
  2862*                                                                *
  2863*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2864*                                                                *
  2865*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2866*   VSAM ACCOUNT MASTER FILES.                                   *
  2867*                                                                *
  2868*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2869*                                                                *
  2870*   FILE TYPE = VSAM,KSDS                                        *
  2871*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2872*                                                                *
  2873*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2874*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2875*                                                                *
  2876*   LOG = NO                                                     *
  2877*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2878*                                                                *
  2879*                                                                *
  2880******************************************************************
  2881*                   C H A N G E   L O G
  2882*
  2883* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2884*-----------------------------------------------------------------
  2885*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2886* EFFECTIVE    NUMBER
  2887*-----------------------------------------------------------------
  2888* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2889* 092705    2005050300006  PEMA  ADD SPP LEASES
  2890* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2891* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2892* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2893* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2894* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  57
* EL6501.cbl
  2895* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2896******************************************************************
  2897
  2898 01  ACCOUNT-MASTER.
  2899     12  AM-RECORD-ID                      PIC XX.
  2900         88  VALID-AM-ID                      VALUE 'AM'.
  2901
  2902     12  AM-CONTROL-PRIMARY.
  2903         16  AM-COMPANY-CD                 PIC X.
  2904         16  AM-MSTR-CNTRL.
  2905             20  AM-CONTROL-A.
  2906                 24  AM-CARRIER            PIC X.
  2907                 24  AM-GROUPING.
  2908                     28 AM-GROUPING-PREFIX PIC XXX.
  2909                     28 AM-GROUPING-PRIME  PIC XXX.
  2910                 24  AM-STATE              PIC XX.
  2911                 24  AM-ACCOUNT.
  2912                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2913                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2914             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2915                                           PIC X(19).
  2916             20  AM-CNTRL-B.
  2917                 24  AM-EXPIRATION-DT      PIC XX.
  2918                 24  FILLER                PIC X(4).
  2919             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2920                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2921
  2922     12  AM-CONTROL-BY-VAR-GRP.
  2923         16  AM-COMPANY-CD-A1              PIC X.
  2924         16  AM-VG-CARRIER                 PIC X.
  2925         16  AM-VG-GROUPING                PIC X(6).
  2926         16  AM-VG-STATE                   PIC XX.
  2927         16  AM-VG-ACCOUNT                 PIC X(10).
  2928         16  AM-VG-DATE.
  2929             20  AM-VG-EXPIRATION-DT       PIC XX.
  2930             20  FILLER                    PIC X(4).
  2931         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2932                                           PIC 9(11)      COMP-3.
  2933     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2934         16  FILLER                        PIC X(10).
  2935         16  AM-VG-KEY3.
  2936             20  AM-VG3-ACCOUNT            PIC X(10).
  2937             20  AM-VG3-EXP-DT             PIC XX.
  2938         16  FILLER                        PIC X(4).
  2939     12  AM-MAINT-INFORMATION.
  2940         16  AM-LAST-MAINT-DT              PIC XX.
  2941         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2942         16  AM-LAST-MAINT-USER            PIC X(4).
  2943         16  FILLER                        PIC XX.
  2944
  2945     12  AM-EFFECTIVE-DT                   PIC XX.
  2946     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2947
  2948     12  AM-PREV-DATES  COMP-3.
  2949         16  AM-PREV-EXP-DT                PIC 9(11).
  2950         16  AM-PREV-EFF-DT                PIC 9(11).
  2951
  2952     12  AM-REPORT-CODE-1                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  58
* EL6501.cbl
  2953     12  AM-REPORT-CODE-2                  PIC X(10).
  2954
  2955     12  AM-CITY-CODE                      PIC X(4).
  2956     12  AM-COUNTY-PARISH                  PIC X(6).
  2957
  2958     12  AM-NAME                           PIC X(30).
  2959     12  AM-PERSON                         PIC X(30).
  2960     12  AM-ADDRS                          PIC X(30).
  2961     12  AM-CITY.
  2962         16  AM-ADDR-CITY                  PIC X(28).
  2963         16  AM-ADDR-STATE                 PIC XX.
  2964     12  AM-ZIP.
  2965         16  AM-ZIP-PRIME.
  2966             20  AM-ZIP-PRI-1ST            PIC X.
  2967                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2968             20  FILLER                    PIC X(4).
  2969         16  AM-ZIP-PLUS4                  PIC X(4).
  2970     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2971         16  AM-CAN-POSTAL-1               PIC XXX.
  2972         16  AM-CAN-POSTAL-2               PIC XXX.
  2973         16  FILLER                        PIC XXX.
  2974     12  AM-TEL-NO.
  2975         16  AM-AREA-CODE                  PIC 999.
  2976         16  AM-TEL-PRE                    PIC 999.
  2977         16  AM-TEL-NBR                    PIC 9(4).
  2978     12  AM-TEL-LOC                        PIC X.
  2979         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2980         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2981
  2982     12  AM-COMM-STRUCTURE.
  2983         16  AM-DEFN-1.
  2984             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2985                 24  AM-AGT.
  2986                     28  AM-AGT-PREFIX     PIC X(4).
  2987                     28  AM-AGT-PRIME      PIC X(6).
  2988                 24  AM-COM-TYP            PIC X.
  2989                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2990                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2991                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2992                 24  AM-RECALC-LV-INDIC    PIC X.
  2993                 24  AM-RETRO-LV-INDIC     PIC X.
  2994                 24  AM-GL-CODES           PIC X.
  2995                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2996                 24  FILLER                PIC X(01).
  2997         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2998             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2999                 24  FILLER                PIC X(11).
  3000                 24  AM-L-COMA             PIC XXX.
  3001                 24  AM-J-COMA             PIC XXX.
  3002                 24  AM-A-COMA             PIC XXX.
  3003                 24  FILLER                PIC X(6).
  3004
  3005     12  AM-COMM-CHANGE-STATUS             PIC X.
  3006         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3007
  3008     12  AM-CSR-CODE                       PIC X(4).
  3009
  3010     12  AM-BILLING-STATUS                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  59
* EL6501.cbl
  3011         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3012         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3013     12  AM-AUTO-REFUND-SW                 PIC X.
  3014         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3015         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3016     12  AM-GPCD                           PIC 99.
  3017     12  AM-IG                             PIC X.
  3018         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3019         88  AM-HAS-GROUP                     VALUE '2'.
  3020     12  AM-STATUS                         PIC X.
  3021         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3022         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3023         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3024         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3025         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3026         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3027         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3028         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3029         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3030         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3031     12  AM-REMIT-TO                       PIC 99.
  3032     12  AM-ID-NO                          PIC X(11).
  3033
  3034     12  AM-CAL-TABLE                      PIC XX.
  3035     12  AM-LF-DEVIATION                   PIC XXX.
  3036     12  AM-AH-DEVIATION                   PIC XXX.
  3037     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3038     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3039     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3040     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3041     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3042     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3043
  3044     12  AM-USER-FIELDS.
  3045         16  AM-FLD-1                      PIC XX.
  3046         16  AM-FLD-2                      PIC XX.
  3047         16  AM-FLD-3                      PIC XX.
  3048         16  AM-FLD-4                      PIC XX.
  3049         16  AM-FLD-5                      PIC XX.
  3050
  3051     12  AM-1ST-PROD-DATE.
  3052         16  AM-1ST-PROD-YR                PIC XX.
  3053         16  AM-1ST-PROD-MO                PIC XX.
  3054         16  AM-1ST-PROD-DA                PIC XX.
  3055     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3056     12  AM-CERTS-PURGED-DATE.
  3057         16  AM-PUR-YR                     PIC XX.
  3058         16  AM-PUR-MO                     PIC XX.
  3059         16  AM-PUR-DA                     PIC XX.
  3060     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3061     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3062     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3063     12  AM-INACTIVE-DATE.
  3064         16  AM-INA-MO                     PIC 99.
  3065         16  AM-INA-DA                     PIC 99.
  3066         16  AM-INA-YR                     PIC 99.
  3067     12  AM-AR-HI-CERT-DATE                PIC XX.
  3068
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  60
* EL6501.cbl
  3069     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3070     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3071
  3072     12  AM-OB-PAYMENT-MODE                PIC X.
  3073         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3074         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3075         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3076         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3077
  3078     12  AM-AH-ONLY-INDICATOR              PIC X.
  3079         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3080         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3081
  3082     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3083
  3084     12  AM-OVER-SHORT.
  3085         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3086         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3087
  3088     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3089     12  AM-DCC-CLP-STATE                  PIC XX.
  3090
  3091     12  AM-RECALC-COMM                    PIC X.
  3092     12  AM-RECALC-REIN                    PIC X.
  3093
  3094     12  AM-REI-TABLE                      PIC XXX.
  3095     12  AM-REI-ET-LF                      PIC X.
  3096     12  AM-REI-ET-AH                      PIC X.
  3097     12  AM-REI-PE-LF                      PIC X.
  3098     12  AM-REI-PE-AH                      PIC X.
  3099     12  AM-REI-PRT-ST                     PIC X.
  3100     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3101     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3102     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3103     12  AM-REI-GROUP-A                    PIC X(6).
  3104     12  AM-REI-MORT                       PIC X(4).
  3105     12  AM-REI-PRT-OW                     PIC X.
  3106     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3107     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3108     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3109     12  AM-REI-GROUP-B                    PIC X(6).
  3110
  3111     12  AM-TRUST-TYPE                     PIC X(2).
  3112
  3113     12  AM-EMPLOYER-STMT-USED             PIC X.
  3114     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3115
  3116     12  AM-STD-AH-TYPE                    PIC XX.
  3117     12  AM-EARN-METHODS.
  3118         16  AM-EARN-METHOD-R              PIC X.
  3119             88 AM-REF-RL-R78                 VALUE 'R'.
  3120             88 AM-REF-RL-PR                  VALUE 'P'.
  3121             88 AM-REF-RL-MEAN                VALUE 'M'.
  3122             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3123         16  AM-EARN-METHOD-L              PIC X.
  3124             88 AM-REF-LL-R78                 VALUE 'R'.
  3125             88 AM-REF-LL-PR                  VALUE 'P'.
  3126             88 AM-REF-LL-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  61
* EL6501.cbl
  3127             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3128         16  AM-EARN-METHOD-A              PIC X.
  3129             88 AM-REF-AH-R78                 VALUE 'R'.
  3130             88 AM-REF-AH-PR                  VALUE 'P'.
  3131             88 AM-REF-AH-MEAN                VALUE 'M'.
  3132             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3133             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3134             88 AM-REF-AH-NET                 VALUE 'N'.
  3135
  3136     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3137     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3138     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3139
  3140     12  AM-RET-Y-N                        PIC X.
  3141     12  AM-RET-P-E                        PIC X.
  3142     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3143     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3144     12  AM-RET-GRP                        PIC X(6).
  3145     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3146         16  AM-POOL-PRIME                 PIC XXX.
  3147         16  AM-POOL-SUB                   PIC XXX.
  3148     12  AM-RETRO-EARNINGS.
  3149         16  AM-RET-EARN-R                 PIC X.
  3150         16  AM-RET-EARN-L                 PIC X.
  3151         16  AM-RET-EARN-A                 PIC X.
  3152     12  AM-RET-ST-TAX-USE                 PIC X.
  3153         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3154         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3155     12  AM-RETRO-BEG-EARNINGS.
  3156         16  AM-RET-BEG-EARN-R             PIC X.
  3157         16  AM-RET-BEG-EARN-L             PIC X.
  3158         16  AM-RET-BEG-EARN-A             PIC X.
  3159     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3160     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3161
  3162     12  AM-USER-SELECT-OPTIONS.
  3163         16  AM-USER-SELECT-1              PIC X(10).
  3164         16  AM-USER-SELECT-2              PIC X(10).
  3165         16  AM-USER-SELECT-3              PIC X(10).
  3166         16  AM-USER-SELECT-4              PIC X(10).
  3167         16  AM-USER-SELECT-5              PIC X(10).
  3168
  3169     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3170
  3171     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3172
  3173     12  AM-RPT045A-SWITCH                 PIC X.
  3174         88  RPT045A-OFF                   VALUE 'N'.
  3175
  3176     12  AM-INSURANCE-LIMITS.
  3177         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3178         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3179
  3180     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3181         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3182
  3183     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3184         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  62
* EL6501.cbl
  3185         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3186
  3187     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3188
  3189     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3190     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3191     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3192     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3193     12  AM-DCC-UEF-STATE                  PIC XX.
  3194     12  FILLER                            PIC XXX.
  3195     12  AM-REPORT-CODE-3                  PIC X(10).
  3196*    12  FILLER                            PIC X(22).
  3197
  3198     12  AM-RESERVE-DATE.
  3199         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3200         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3201         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3202
  3203     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3204     12  AM-NOTIFICATION-TYPES.
  3205         16  AM-NOTIF-OF-LETTERS           PIC X.
  3206         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3207         16  AM-NOTIF-OF-REPORTS           PIC X.
  3208         16  AM-NOTIF-OF-STATUS            PIC X.
  3209
  3210     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3211         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3212         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3213         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3214         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3215
  3216     12  AM-BENEFIT-CONTROLS.
  3217         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3218             20  AM-BENEFIT-CODE           PIC XX.
  3219             20  AM-BENEFIT-TYPE           PIC X.
  3220             20  AM-BENEFIT-REVISION       PIC XXX.
  3221             20  AM-BENEFIT-REM-TERM       PIC X.
  3222             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3223             20  FILLER                    PIC XX.
  3224         16  FILLER                        PIC X(80).
  3225
  3226     12  AM-TRANSFER-DATA.
  3227         16  AM-TRANSFERRED-FROM.
  3228             20  AM-TRNFROM-CARRIER        PIC X.
  3229             20  AM-TRNFROM-GROUPING.
  3230                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3231                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3232             20  AM-TRNFROM-STATE          PIC XX.
  3233             20  AM-TRNFROM-ACCOUNT.
  3234                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3235                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3236             20  AM-TRNFROM-DTE            PIC XX.
  3237         16  AM-TRANSFERRED-TO.
  3238             20  AM-TRNTO-CARRIER          PIC X.
  3239             20  AM-TRNTO-GROUPING.
  3240                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3241                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3242             20  AM-TRNTO-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  63
* EL6501.cbl
  3243             20  AM-TRNTO-ACCOUNT.
  3244                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3245                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3246             20  AM-TRNTO-DTE              PIC XX.
  3247         16  FILLER                        PIC X(10).
  3248
  3249     12  AM-SAVED-REMIT-TO                 PIC 99.
  3250
  3251     12  AM-COMM-STRUCTURE-SAVED.
  3252         16  AM-DEFN-1-SAVED.
  3253             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3254                 24  AM-AGT-SV             PIC X(10).
  3255                 24  AM-COM-TYP-SV         PIC X.
  3256                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3257                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3258                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3259                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3260                 24  FILLER                PIC X.
  3261                 24  AM-GL-CODES-SV        PIC X.
  3262                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3263                 24  FILLER                PIC X.
  3264         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3265             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3266                 24  FILLER                PIC X(11).
  3267                 24  AM-L-COMA-SV          PIC XXX.
  3268                 24  AM-J-COMA-SV          PIC XXX.
  3269                 24  AM-A-COMA-SV          PIC XXX.
  3270                 24  FILLER                PIC X(6).
  3271
  3272     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3273         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3274            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3275            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3276            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3277
  3278     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3279     12  FILLER                            PIC X(120).
  3280
  3281     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3282         16  AM-CONTROL-NAME               PIC X(30).
  3283         16  AM-EXECUTIVE-ONE.
  3284             20  AM-EXEC1-NAME             PIC X(15).
  3285             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3286                                                          COMP-3.
  3287             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3288                                                          COMP-3.
  3289         16  AM-EXECUTIVE-TWO.
  3290             20  AM-EXEC2-NAME             PIC X(15).
  3291             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3292                                                          COMP-3.
  3293             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3294                                                          COMP-3.
  3295
  3296     12  AM-RETRO-ADDITIONAL-DATA.
  3297         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3298         16  AM-RETRO-PREM-P-E             PIC X.
  3299         16  AM-RETRO-CLMS-P-I             PIC X.
  3300         16  AM-RETRO-RET-BRACKET-LF.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  64
* EL6501.cbl
  3301             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3302                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3303                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3304             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3305                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3306                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3307             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3308                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3309                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3310         16  AM-RETRO-RET-BRACKET-AH.
  3311             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3312                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3313                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3314                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3315             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3316                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3317                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3318             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3319                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3320                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3321
  3322     12  AM-COMMENTS.
  3323         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3324
  3325     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3326         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3327         16  AM-FLI-BILLING-CODE           PIC X.
  3328         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3329         16  AM-FLI-UNITED-IDENT           PIC X.
  3330         16  AM-FLI-INTEREST-LOST-DATA.
  3331             20  AM-FLI-BANK-NO            PIC X(5).
  3332             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3333             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3334             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3335         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3336             20  AM-FLI-AGT                PIC X(9).
  3337             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3338             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3339         16  FILLER                        PIC X(102).
  3340
  3341     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3342         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3343             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3344             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3345             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3346             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3347             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3348         16  FILLER                          PIC X(10).
  3349******************************************************************
  3350*    copy ERCPDEF.
  3351******************************************************************
  3352*                                                                *
  3353*                                                                *
  3354*                            ERCPDEF.                            *
  3355*                                                                *
  3356*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3357*                                                                *
  3358*    FILE TYPE = VSAM,KSDS                                       *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  65
* EL6501.cbl
  3359*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3360*                                                                *
  3361*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3362*                                                                *
  3363*    LOG = YES                                                   *
  3364*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3365******************************************************************
  3366*                   C H A N G E   L O G
  3367*
  3368* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3369*-----------------------------------------------------------------
  3370*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3371* EFFECTIVE    NUMBER
  3372*-----------------------------------------------------------------
  3373* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3374* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3375* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3376******************************************************************
  3377 01  PRODUCT-MASTER.
  3378    12  PD-RECORD-ID                 PIC X(02).
  3379        88  VALID-PD-ID                  VALUE 'PD'.
  3380    12  PD-CONTROL-PRIMARY.
  3381        16  PD-COMPANY-CD            PIC X.
  3382        16  PD-STATE                 PIC XX.
  3383        16  PD-PRODUCT-CD            PIC XXX.
  3384        16  PD-FILLER                PIC X(7).
  3385        16  PD-BEN-TYPE              PIC X.
  3386        16  PD-BEN-CODE              PIC XX.
  3387        16  PD-PROD-EXP-DT           PIC XX.
  3388    12  FILLER                       PIC X(50).
  3389    12  PD-PRODUCT-DATA OCCURS 8.
  3390        16  PD-PROD-CODE             PIC X.
  3391            88  PD-PROD-LIFE           VALUE 'L'.
  3392            88  PD-PROD-PROP           VALUE 'P'.
  3393            88  PD-PROD-AH             VALUE 'A'.
  3394            88  PD-PROD-IU             VALUE 'I'.
  3395            88  PD-PROD-GAP            VALUE 'G'.
  3396            88  PD-PROD-FAML           VALUE 'F'.
  3397        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3398        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3399        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3400        16  PD-MAX-TERM              PIC S999        COMP-3.
  3401        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3402        16  FILLER                   PIC X.
  3403        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3404        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3405        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3406        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3407        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3408        16  PD-REC-CRIT-PERIOD       PIC 99.
  3409        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3410            20  PD-RECURRING-YN      PIC X.
  3411            20  FILLER               PIC X.
  3412        16  PD-RTW-MOS               PIC 99.
  3413        16  PD-MAX-EXTENSION         PIC 99.
  3414        16  pd-ben-pct               pic sv999 comp-3.
  3415*       16  FILLER                   PIC XX.
  3416    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  66
* EL6501.cbl
  3417    12  PD-TERM-LIMITS OCCURS 15.
  3418        16  PD-LOW-TERM              PIC S999        COMP-3.
  3419        16  PD-HI-TERM               PIC S999        COMP-3.
  3420*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3421    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3422        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3423        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3424    12  PD-EARN-FACTORS.
  3425        16  FILLER OCCURS 15.
  3426            20  FILLER OCCURS 15.
  3427                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3428    12  PD-PRODUCT-DESC              PIC X(80).
  3429    12  PD-TRUNCATED                 PIC X.
  3430    12  FILLER                       PIC X(59).
  3431    12  PD-MAINT-INFORMATION.
  3432        16  PD-LAST-MAINT-DT         PIC X(02).
  3433        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3434        16  PD-LAST-MAINT-BY         PIC X(04).
  3435*    COPY ELCCNTL.
  3436******************************************************************
  3437*                                                                *
  3438*                                                                *
  3439*                            ELCCNTL.                            *
  3440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3441*                            VMOD=2.059                          *
  3442*                                                                *
  3443*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3444*                                                                *
  3445*   FILE TYPE = VSAM,KSDS                                        *
  3446*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3447*                                                                *
  3448*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3449*       ALTERNATE INDEX = NONE                                   *
  3450*                                                                *
  3451*   LOG = YES                                                    *
  3452*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3453******************************************************************
  3454*                   C H A N G E   L O G
  3455*
  3456* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3457*-----------------------------------------------------------------
  3458*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3459* EFFECTIVE    NUMBER
  3460*-----------------------------------------------------------------
  3461* 082503                   PEMA  ADD BENEFIT GROUP
  3462* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3463* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3464* 092705    2005050300006  PEMA  ADD SPP LEASES
  3465* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3466* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3467* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3468* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3469* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3470* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3471* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3472* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3473* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3474* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  67
* EL6501.cbl
  3475******************************************************************
  3476*
  3477 01  CONTROL-FILE.
  3478     12  CF-RECORD-ID                       PIC XX.
  3479         88  VALID-CF-ID                        VALUE 'CF'.
  3480
  3481     12  CF-CONTROL-PRIMARY.
  3482         16  CF-COMPANY-ID                  PIC XXX.
  3483         16  CF-RECORD-TYPE                 PIC X.
  3484             88  CF-COMPANY-MASTER              VALUE '1'.
  3485             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3486             88  CF-STATE-MASTER                VALUE '3'.
  3487             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3488             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3489             88  CF-CARRIER-MASTER              VALUE '6'.
  3490             88  CF-MORTALITY-MASTER            VALUE '7'.
  3491             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3492             88  CF-TERMINAL-MASTER             VALUE '9'.
  3493             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3494             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3495             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3496             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3497             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3498             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3499             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3500             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3501             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3502         16  CF-ACCESS-CD-GENL              PIC X(4).
  3503         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3504             20  CF-PROCESSOR               PIC X(4).
  3505         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3506             20  CF-STATE-CODE              PIC XX.
  3507             20  FILLER                     PIC XX.
  3508         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3509             20  FILLER                     PIC XX.
  3510             20  CF-HI-BEN-IN-REC           PIC XX.
  3511         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3512             20  FILLER                     PIC XXX.
  3513             20  CF-CARRIER-CNTL            PIC X.
  3514         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3515             20  FILLER                     PIC XX.
  3516             20  CF-HI-TYPE-IN-REC          PIC 99.
  3517         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3518             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3519                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3520             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3521             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3522         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3523             20  FILLER                     PIC X.
  3524             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3525         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3526             20  FILLER                     PIC XX.
  3527             20  CF-MORTGAGE-PLAN           PIC XX.
  3528         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3529
  3530     12  CF-LAST-MAINT-DT                   PIC XX.
  3531     12  CF-LAST-MAINT-BY                   PIC X(4).
  3532     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  68
* EL6501.cbl
  3533
  3534     12  CF-RECORD-BODY                     PIC X(728).
  3535
  3536
  3537****************************************************************
  3538*             COMPANY MASTER RECORD                            *
  3539****************************************************************
  3540
  3541     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3542         16  CF-COMPANY-ADDRESS.
  3543             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3544             20  CF-CL-IN-CARE-OF           PIC X(30).
  3545             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3546             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3547             20  CF-CL-CITY-STATE           PIC X(30).
  3548             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3549             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3550         16  CF-COMPANY-CD                  PIC X.
  3551         16  CF-COMPANY-PASSWORD            PIC X(8).
  3552         16  CF-SECURITY-OPTION             PIC X.
  3553             88  ALL-SECURITY                   VALUE '1'.
  3554             88  COMPANY-VERIFY                 VALUE '2'.
  3555             88  PROCESSOR-VERIFY               VALUE '3'.
  3556             88  NO-SECURITY                    VALUE '4'.
  3557             88  ALL-BUT-TERM                   VALUE '5'.
  3558         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3559             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3560         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3561             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3562         16  CF-INFORCE-LOCATION            PIC X.
  3563             88  CERTS-ARE-ONLINE               VALUE '1'.
  3564             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3565             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3566         16  CF-LOWER-CASE-LETTERS          PIC X.
  3567         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3568             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3569             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3570             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3571             88  CF-ACCNT-CNTL                  VALUE '3'.
  3572             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3573
  3574         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3575         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3576
  3577         16  CF-LGX-CREDIT-USER             PIC X.
  3578             88  CO-IS-NOT-USER                 VALUE 'N'.
  3579             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3580
  3581         16 CF-CREDIT-CALC-CODES.
  3582             20  CF-CR-REM-TERM-CALC PIC X.
  3583               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3584               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3585               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3586               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3587               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3588               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3589               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3590             20  CF-CR-R78-METHOD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  69
* EL6501.cbl
  3591               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3592               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3593
  3594         16  CF-CLAIM-CONTROL-COUNTS.
  3595             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3596                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3597
  3598             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3599                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3600
  3601             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3602                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3603
  3604             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3605                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3606
  3607         16  CF-CURRENT-MONTH-END           PIC XX.
  3608
  3609         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3610             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3611             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3612             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3613             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3614                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3615                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3616             20  CF-CO-PREM-REJECT-SW       PIC X.
  3617                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3618                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3619             20  CF-CO-REF-REJECT-SW        PIC X.
  3620                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3621                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3622
  3623         16  CF-CO-REPORTING-DT             PIC XX.
  3624         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3625         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3626           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3627           88  CF-CO-MONTH-END                  VALUE '1'.
  3628
  3629         16  CF-LGX-CLAIM-USER              PIC X.
  3630             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3631             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3632
  3633         16  CF-CREDIT-EDIT-CONTROLS.
  3634             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3635             20  CF-MIN-AGE                 PIC 99.
  3636             20  CF-DEFAULT-AGE             PIC 99.
  3637             20  CF-MIN-TERM                PIC S999      COMP-3.
  3638             20  CF-MAX-TERM                PIC S999      COMP-3.
  3639             20  CF-DEFAULT-SEX             PIC X.
  3640             20  CF-JOINT-AGE-INPUT         PIC X.
  3641                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3642             20  CF-BIRTH-DATE-INPUT        PIC X.
  3643                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3644             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3645                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3646                 88  CF-ZERO-CARRIER            VALUE '1'.
  3647                 88  CF-ZERO-GROUPING           VALUE '2'.
  3648                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  70
* EL6501.cbl
  3649             20  CF-EDIT-SW                 PIC X.
  3650                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3651             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3652             20  CF-CR-PR-METHOD            PIC X.
  3653               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3654               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3655             20  FILLER                     PIC X.
  3656
  3657         16  CF-CREDIT-MISC-CONTROLS.
  3658             20  CF-REIN-TABLE-SW           PIC X.
  3659                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3660             20  CF-COMP-TABLE-SW           PIC X.
  3661                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3662             20  CF-EXPERIENCE-RETENTION-AGE
  3663                                            PIC S9        COMP-3.
  3664             20  CF-CONVERSION-DT           PIC XX.
  3665             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3666             20  CF-RUN-FREQUENCY-SW        PIC X.
  3667                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3668                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3669
  3670             20  CF-CR-CHECK-NO-CONTROL.
  3671                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3672                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3673                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3674                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3675                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3676                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3677
  3678                 24  CF-CR-CHECK-COUNT       REDEFINES
  3679                     CF-CR-CHECK-COUNTER      PIC X(4).
  3680
  3681                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3682                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3683
  3684                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3685                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3686                 24  CF-MAIL-PROCESSING       PIC X.
  3687                     88  MAIL-PROCESSING          VALUE 'Y'.
  3688
  3689         16  CF-MISC-SYSTEM-CONTROL.
  3690             20  CF-SYSTEM-C                 PIC X.
  3691                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3692             20  CF-SYSTEM-D                 PIC X.
  3693                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3694             20  CF-SOC-SEC-NO-SW            PIC X.
  3695                 88  SOC-SEC-NO-USED             VALUE '1'.
  3696             20  CF-MEMBER-NO-SW             PIC X.
  3697                 88  MEMBER-NO-USED              VALUE '1'.
  3698             20  CF-TAX-ID-NUMBER            PIC X(11).
  3699             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3700             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3701                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3702                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3703                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3704                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3705             20  CF-SYSTEM-E                 PIC X.
  3706                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  71
* EL6501.cbl
  3707
  3708         16  CF-LGX-LIFE-USER               PIC X.
  3709             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3710             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3711
  3712         16  CF-CR-MONTH-END-DT             PIC XX.
  3713
  3714         16  CF-FILE-MAINT-DATES.
  3715             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3716                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3717             20  CF-LAST-BATCH       REDEFINES
  3718                 CF-LAST-BATCH-NO               PIC X(4).
  3719             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3720             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3721             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3722             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3723             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3724             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3725             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3726             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3727             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3728             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3729
  3730         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3731         16  FILLER                         PIC X.
  3732
  3733         16  CF-ALT-MORT-CODE               PIC X(4).
  3734         16  CF-MEMBER-CAPTION              PIC X(10).
  3735
  3736         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3737             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3738             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3739             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3740             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3741             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3742
  3743         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3744
  3745         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3746         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3747         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3748         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3749
  3750         16  CF-AH-OVERRIDE-L1              PIC X.
  3751         16  CF-AH-OVERRIDE-L2              PIC XX.
  3752         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3753         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3754
  3755         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3756         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3757
  3758         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3759         16  CF-AR-LAST-EL860-DT            PIC XX.
  3760         16  CF-MP-MONTH-END-DT             PIC XX.
  3761
  3762         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3763         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3764             88  CF-CLAIM-PAID-TO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  72
* EL6501.cbl
  3765
  3766         16  CF-AR-MONTH-END-DT             PIC XX.
  3767
  3768         16  CF-CRDTCRD-USER                PIC X.
  3769             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3770             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3771
  3772         16  CF-CC-MONTH-END-DT             PIC XX.
  3773
  3774         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3775
  3776         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3777             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3778             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3779             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3780         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3781         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3782         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3783         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3784             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3785             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3786         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3787         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3788         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3789             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3790         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3791
  3792         16  CF-CL-ZIP-CODE.
  3793             20  CF-CL-ZIP-PRIME.
  3794                 24  CF-CL-ZIP-1ST          PIC X.
  3795                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3796                 24  FILLER                 PIC X(4).
  3797             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3798         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3799             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3800             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3801             20  FILLER                     PIC XXX.
  3802
  3803         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3804         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3805         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3806         16  CF-CO-OPTION-START-DATE        PIC XX.
  3807         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3808           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3809                                                      '3' '4'.
  3810           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3811           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3812           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3813           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3814           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3815           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3816
  3817         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3818
  3819         16  CF-PAYMENT-APPROVAL-LEVELS.
  3820             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3821             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3822             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  73
* EL6501.cbl
  3823             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3824             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3825             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3826
  3827         16  CF-END-USER-REPORTING-USER     PIC X.
  3828             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3829             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3830
  3831         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3832             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3833             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3834
  3835         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3836
  3837         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3838         16  FILLER                         PIC X.
  3839
  3840         16  CF-CREDIT-ARCHIVE-CNTL.
  3841             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3842             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3843             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3844
  3845         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3846
  3847         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3848             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3849             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3850
  3851         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3852             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3853             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3854
  3855         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3856
  3857         16  CF-CO-ACH-ID-CODE              PIC  X.
  3858             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3859             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3860             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3861         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3862         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3863         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3864         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3865         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3866         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3867         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3868         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3869         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3870                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3871         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3872                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3873
  3874         16  CF-CO-OVER-SHORT.
  3875             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3876             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3877
  3878*         16  FILLER                         PIC X(102).
  3879         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3880             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  74
* EL6501.cbl
  3881             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3882
  3883         16  CF-AH-APPROVAL-DAYS.
  3884             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3885             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3886             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3887             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3888
  3889         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3890
  3891         16  CF-APPROV-LEV-5.
  3892             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3893             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3894             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3895
  3896         16  FILLER                         PIC X(68).
  3897****************************************************************
  3898*             PROCESSOR/USER RECORD                            *
  3899****************************************************************
  3900
  3901     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3902         16  CF-PROCESSOR-NAME              PIC X(30).
  3903         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3904         16  CF-PROCESSOR-TITLE             PIC X(26).
  3905         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3906                 88  MESSAGE-YES                VALUE 'Y'.
  3907                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3908
  3909*****************************************************
  3910****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3911****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3912****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3913****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3914*****************************************************
  3915
  3916         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3917             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3918             20  CF-APPLICATION-FORCE       PIC X.
  3919             20  CF-INDIVIDUAL-APP.
  3920                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3921                     28  CF-BROWSE-APP      PIC X.
  3922                     28  CF-UPDATE-APP      PIC X.
  3923
  3924         16  CF-CURRENT-TERM-ON             PIC X(4).
  3925         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3926             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3927             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3928             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3929             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3930             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3931             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3932             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3933         16  CF-PROCESSOR-CARRIER           PIC X.
  3934             88  NO-CARRIER-SECURITY            VALUE ' '.
  3935         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3936             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3937         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3938             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  75
* EL6501.cbl
  3939         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3940             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3941
  3942         16  CF-PROC-SYS-ACCESS-SW.
  3943             20  CF-PROC-CREDIT-CLAIMS-SW.
  3944                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3945                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3946                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3947                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3948             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3949                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3950                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3951             20  CF-PROC-LIFE-GNRLDGR-SW.
  3952                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3953                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3954                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3955                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3956             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3957                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3958                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3959         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3960             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3961             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3962         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3963
  3964         16  CF-APPROVAL-LEVEL                  PIC X.
  3965             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3966             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3967             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3968             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3969             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3970
  3971         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3972
  3973         16  CF-LANGUAGE-TYPE                   PIC X.
  3974             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3975             88  CF-LANG-IS-FR                      VALUE 'F'.
  3976
  3977         16  CF-CSR-IND                         PIC X.
  3978         16  FILLER                             PIC X(239).
  3979
  3980****************************************************************
  3981*             PROCESSOR/REMINDERS RECORD                       *
  3982****************************************************************
  3983
  3984     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3985         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3986             20  CF-START-REMIND-DT         PIC XX.
  3987             20  CF-END-REMIND-DT           PIC XX.
  3988             20  CF-REMINDER-TEXT           PIC X(50).
  3989         16  FILLER                         PIC X(296).
  3990
  3991
  3992****************************************************************
  3993*             STATE MASTER RECORD                              *
  3994****************************************************************
  3995
  3996     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  76
* EL6501.cbl
  3997         16  CF-STATE-ABBREVIATION          PIC XX.
  3998         16  CF-STATE-NAME                  PIC X(25).
  3999         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4000         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4001             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4002             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4003             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4004             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4005                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4006                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4007             20  CF-ST-PREM-REJECT-SW       PIC X.
  4008                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4009                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4010             20  CF-ST-REF-REJECT-SW        PIC X.
  4011                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4012                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4013         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4014         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4015         16  CF-ST-REFUND-RULES.
  4016             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4017             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4018             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4019         16  CF-ST-FST-PMT-EXTENSION.
  4020             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4021             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4022                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4023                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4024                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4025                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4026         16  CF-ST-STATE-CALL.
  4027             20  CF-ST-CALL-UNEARNED        PIC X.
  4028             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4029             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4030         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4031             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4032             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4033         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4034         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4035         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4036         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4037         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4038         16  FILLER                         PIC X.
  4039         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4040             20  CF-ST-BENEFIT-CD           PIC XX.
  4041             20  CF-ST-BENEFIT-KIND         PIC X.
  4042                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4043                 88  CF-ST-AH-KIND              VALUE 'A'.
  4044             20  CF-ST-REM-TERM-CALC        PIC X.
  4045                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4046                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4047                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4048                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4049                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4050                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4051                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4052                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4053
  4054             20  CF-ST-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  77
* EL6501.cbl
  4055                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4056                 88  ST-REFD-BY-R78             VALUE '1'.
  4057                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4058                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4059                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4060                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4061                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4062                 88  ST-REFD-UTAH               VALUE '7'.
  4063                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4064                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4065                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4066
  4067             20  CF-ST-EARNING-CALC         PIC X.
  4068                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4069                 88  ST-EARN-BY-R78             VALUE '1'.
  4070                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4071                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4072                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4073                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4074                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4075                 88  ST-EARN-MEAN               VALUE '8'.
  4076                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4077
  4078             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4079                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4080                 88  ST-OVRD-BY-R78             VALUE '1'.
  4081                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4082                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4083                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4084                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4085                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4086                 88  ST-OVRD-MEAN               VALUE '8'.
  4087                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4088             20  cf-st-extra-periods        pic 9.
  4089*            20  FILLER                     PIC X.
  4090
  4091         16  CF-ST-COMMISSION-CAPS.
  4092             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4093             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4094             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4095             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4096         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4097                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4098
  4099         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4100
  4101         16  CF-ST-STATUTORY-INTEREST.
  4102             20  CF-ST-STAT-DATE-FROM       PIC X.
  4103                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4104                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4105             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4106             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4107             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4108             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4109             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4110
  4111         16  CF-ST-OVER-SHORT.
  4112             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  78
* EL6501.cbl
  4113             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4114
  4115         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4116
  4117         16  CF-ST-RT-CALC                  PIC X.
  4118
  4119         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4120         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4121         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4122         16  CF-ST-RF-LR-CALC               PIC X.
  4123         16  CF-ST-RF-LL-CALC               PIC X.
  4124         16  CF-ST-RF-LN-CALC               PIC X.
  4125         16  CF-ST-RF-AH-CALC               PIC X.
  4126         16  CF-ST-RF-CP-CALC               PIC X.
  4127*        16  FILLER                         PIC X(206).
  4128*CIDMOD         16  FILLER                         PIC X(192).
  4129         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4130             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4131         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4132         16  CF-ST-VFY-2ND-BENE             PIC X.
  4133         16  CF-ST-CAUSAL-STATE             PIC X.
  4134         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4135         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4136         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4137             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4138         16  CF-ST-NET-ONLY-STATE           PIC X.
  4139             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4140         16  FILLER                         PIC X(181).
  4141
  4142****************************************************************
  4143*             BENEFIT MASTER RECORD                            *
  4144****************************************************************
  4145
  4146     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4147         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4148             20  CF-BENEFIT-CODE            PIC XX.
  4149             20  CF-BENEFIT-NUMERIC  REDEFINES
  4150                 CF-BENEFIT-CODE            PIC XX.
  4151             20  CF-BENEFIT-ALPHA           PIC XXX.
  4152             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4153             20  CF-BENEFIT-COMMENT         PIC X(10).
  4154
  4155             20  CF-LF-COVERAGE-TYPE        PIC X.
  4156                 88  CF-REDUCING                VALUE 'R'.
  4157                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4158
  4159             20  CF-SPECIAL-CALC-CD         PIC X.
  4160                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4161                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4162                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4163                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4164                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4165                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4166                 88  CF-FARM-PLAN               VALUE 'F'.
  4167                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4168                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4169                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4170                 88  CF-4-MTH-INTEREST          VALUE 'K'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  79
* EL6501.cbl
  4171                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4172                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4173                 88  CF-PRUDENTIAL              VALUE 'P'.
  4174                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4175                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4176                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4177                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4178                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4179                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4180
  4181             20  CF-JOINT-INDICATOR         PIC X.
  4182                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4183
  4184*            20  FILLER                     PIC X(12).
  4185             20  cf-maximum-benefits        pic s999 comp-3.
  4186             20  FILLER                     PIC X(09).
  4187             20  CF-BENEFIT-CATEGORY        PIC X.
  4188             20  CF-LOAN-TYPE               PIC X(8).
  4189
  4190             20  CF-CO-REM-TERM-CALC        PIC X.
  4191                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4192                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4193                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4194                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4195                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4196
  4197             20  CF-CO-EARNINGS-CALC        PIC X.
  4198                 88  CO-EARN-BY-R78             VALUE '1'.
  4199                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4200                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4201                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4202                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4203                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4204                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4205                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4206
  4207             20  CF-CO-REFUND-CALC          PIC X.
  4208                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4209                 88  CO-REFD-BY-R78             VALUE '1'.
  4210                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4211                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4212                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4213                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4214                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4215                 88  CO-REFD-MEAN               VALUE '8'.
  4216                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4217                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4218                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4219
  4220             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4221                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4222                 88  CO-OVRD-BY-R78             VALUE '1'.
  4223                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4224                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4225                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4226                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4227                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4228                 88  CO-OVRD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  80
* EL6501.cbl
  4229                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4230
  4231             20  CF-CO-BEN-I-G-CD           PIC X.
  4232                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4233                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4234                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4235
  4236         16  FILLER                         PIC X(304).
  4237
  4238
  4239****************************************************************
  4240*             CARRIER MASTER RECORD                            *
  4241****************************************************************
  4242
  4243     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4244         16  CF-ADDRESS-DATA.
  4245             20  CF-MAIL-TO-NAME            PIC X(30).
  4246             20  CF-IN-CARE-OF              PIC X(30).
  4247             20  CF-ADDRESS-LINE-1          PIC X(30).
  4248             20  CF-ADDRESS-LINE-2          PIC X(30).
  4249             20  CF-CITY-STATE              PIC X(30).
  4250             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4251             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4252
  4253         16  CF-CLAIM-NO-CONTROL.
  4254             20  CF-CLAIM-NO-METHOD         PIC X.
  4255                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4256                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4257                 88  CLAIM-NO-SEQ               VALUE '3'.
  4258                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4259             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4260                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4261                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4262                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4263
  4264         16  CF-CHECK-NO-CONTROL.
  4265             20  CF-CHECK-NO-METHOD         PIC X.
  4266                 88  CHECK-NO-MANUAL            VALUE '1'.
  4267                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4268                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4269                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4270             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4271                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4272
  4273         16  CF-DOMICILE-STATE              PIC XX.
  4274
  4275         16  CF-EXPENSE-CONTROLS.
  4276             20  CF-EXPENSE-METHOD          PIC X.
  4277                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4278                 88  DOLLARS-PER-PMT            VALUE '2'.
  4279                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4280                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4281             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4282             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4283
  4284         16  CF-CORRESPONDENCE-CONTROL.
  4285             20  CF-LETTER-RESEND-OPT       PIC X.
  4286                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  81
* EL6501.cbl
  4287                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4288             20  FILLER                     PIC X(4).
  4289
  4290         16  CF-RESERVE-CONTROLS.
  4291             20  CF-MANUAL-SW               PIC X.
  4292                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4293             20  CF-FUTURE-SW               PIC X.
  4294                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4295             20  CF-PTC-SW                  PIC X.
  4296                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4297             20  CF-IBNR-SW                 PIC X.
  4298                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4299             20  CF-PTC-LF-SW               PIC X.
  4300                 88  CF-LF-PTC-USED             VALUE '1'.
  4301             20  CF-CDT-ACCESS-METHOD       PIC X.
  4302                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4303                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4304                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4305             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4306
  4307         16  CF-CLAIM-CALC-METHOD           PIC X.
  4308             88  360-PLUS-MONTHS                VALUE '1'.
  4309             88  365-PLUS-MONTHS                VALUE '2'.
  4310             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4311             88  360-DAILY                      VALUE '4'.
  4312             88  365-DAILY                      VALUE '5'.
  4313
  4314         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4315         16  FILLER                         PIC X(11).
  4316
  4317         16  CF-LIMIT-AMOUNTS.
  4318             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4319             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4320             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4321             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4322             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4323             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4324             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4325             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4326             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4327             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4328
  4329         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4330         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4331         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4332
  4333         16  CF-ZIP-CODE.
  4334             20  CF-ZIP-PRIME.
  4335                 24  CF-ZIP-1ST             PIC X.
  4336                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4337                 24  FILLER                 PIC X(4).
  4338             20  CF-ZIP-PLUS4               PIC X(4).
  4339         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4340             20  CF-CAN-POSTAL-1            PIC XXX.
  4341             20  CF-CAN-POSTAL-2            PIC XXX.
  4342             20  FILLER                     PIC XXX.
  4343
  4344         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  82
* EL6501.cbl
  4345         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4346         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4347
  4348         16  CF-RATING-SWITCH               PIC X.
  4349             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4350             88  CF-NO-RATING                   VALUE 'N'.
  4351
  4352         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4353
  4354         16  CF-CARRIER-OVER-SHORT.
  4355             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4356             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4357
  4358         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4359         16  CF-SECPAY-SWITCH               PIC X.
  4360             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4361             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4362         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4363         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4364         16  FILLER                         PIC X(444).
  4365*        16  FILLER                         PIC X(452).
  4366
  4367
  4368****************************************************************
  4369*             MORTALITY MASTER RECORD                          *
  4370****************************************************************
  4371
  4372     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4373         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4374                                INDEXED BY CF-MORT-NDX.
  4375             20  CF-MORT-TABLE              PIC X(5).
  4376             20  CF-MORT-TABLE-TYPE         PIC X.
  4377                 88  CF-MORT-JOINT              VALUE 'J'.
  4378                 88  CF-MORT-SINGLE             VALUE 'S'.
  4379                 88  CF-MORT-COMBINED           VALUE 'C'.
  4380                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4381                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4382             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4383             20  CF-MORT-AGE-METHOD         PIC XX.
  4384                 88  CF-AGE-LAST                VALUE 'AL'.
  4385                 88  CF-AGE-NEAR                VALUE 'AN'.
  4386             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4387             20  CF-MORT-ADJUSTMENT-DIRECTION
  4388                                            PIC X.
  4389                 88  CF-MINUS                   VALUE '-'.
  4390                 88  CF-PLUS                    VALUE '+'.
  4391             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4392             20  CF-MORT-JOINT-CODE         PIC X.
  4393                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4394             20  CF-MORT-PC-Q               PIC X.
  4395                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4396             20  CF-MORT-TABLE-CODE         PIC X(4).
  4397             20  CF-MORT-COMMENTS           PIC X(15).
  4398             20  FILLER                     PIC X(14).
  4399
  4400         16  FILLER                         PIC X(251).
  4401
  4402
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  83
* EL6501.cbl
  4403****************************************************************
  4404*             BUSSINESS TYPE MASTER RECORD                     *
  4405****************************************************************
  4406
  4407     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4408* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4409* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4410* AND RECORD 05 IS TYPES 81-99
  4411         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4412             20  CF-BUSINESS-TITLE          PIC  X(19).
  4413             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4414                                            PIC S9V9(4) COMP-3.
  4415             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4416             20  FILLER                     PIC  X.
  4417         16  FILLER                         PIC  X(248).
  4418
  4419
  4420****************************************************************
  4421*             TERMINAL MASTER RECORD                           *
  4422****************************************************************
  4423
  4424     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4425
  4426         16  CF-COMPANY-TERMINALS.
  4427             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4428                                  PIC X(4).
  4429         16  FILLER               PIC X(248).
  4430
  4431
  4432****************************************************************
  4433*             LIFE EDIT MASTER RECORD                          *
  4434****************************************************************
  4435
  4436     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4437         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4438             20  CF-LIFE-CODE-IN            PIC XX.
  4439             20  CF-LIFE-CODE-OUT           PIC XX.
  4440         16  FILLER                         PIC X(248).
  4441
  4442
  4443****************************************************************
  4444*             AH EDIT MASTER RECORD                            *
  4445****************************************************************
  4446
  4447     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4448         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4449             20  CF-AH-CODE-IN              PIC XXX.
  4450             20  CF-AH-CODE-OUT             PIC XX.
  4451         16  FILLER                         PIC X(248).
  4452
  4453
  4454****************************************************************
  4455*             CREDIBILITY TABLES                               *
  4456****************************************************************
  4457
  4458     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4459         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4460                             INDEXED BY CF-CRDB-NDX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  84
* EL6501.cbl
  4461             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4462             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4463             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4464         16  FILLER                         PIC  X(332).
  4465
  4466
  4467****************************************************************
  4468*             REPORT CUSTOMIZATION RECORD                      *
  4469****************************************************************
  4470
  4471     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4472         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4473             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4474             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4475             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4476**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4477****       A T-TRANSFER.                                   ****
  4478             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4479
  4480         16  FILLER                         PIC XX.
  4481
  4482         16  CF-CARRIER-CNTL-OPT.
  4483             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4484                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4485                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4486             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4487                                            PIC X.
  4488         16  CF-GROUP-CNTL-OPT.
  4489             20  CF-GROUP-OPT-SEQ           PIC 9.
  4490                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4491                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4492             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4493                                            PIC X(6).
  4494         16  CF-STATE-CNTL-OPT.
  4495             20  CF-STATE-OPT-SEQ           PIC 9.
  4496                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4497                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4498             20  CF-STATE-SELECT OCCURS 3 TIMES
  4499                                            PIC XX.
  4500         16  CF-ACCOUNT-CNTL-OPT.
  4501             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4502                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4503                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4504             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4505                                            PIC X(10).
  4506         16  CF-BUS-TYP-CNTL-OPT.
  4507             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4508                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4509                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4510             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4511                                            PIC XX.
  4512         16  CF-LF-TYP-CNTL-OPT.
  4513             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4514                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4515                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4516             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4517                                            PIC XX.
  4518         16  CF-AH-TYP-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  85
* EL6501.cbl
  4519             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4520                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4521                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4522             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4523                                            PIC XX.
  4524         16  CF-REPTCD1-CNTL-OPT.
  4525             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4526                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4527                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4528             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4529                                            PIC X(10).
  4530         16  CF-REPTCD2-CNTL-OPT.
  4531             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4532                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4533                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4534             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4535                                            PIC X(10).
  4536         16  CF-USER1-CNTL-OPT.
  4537             20  CF-USER1-OPT-SEQ           PIC 9.
  4538                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4539                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4540             20  CF-USER1-SELECT OCCURS 3 TIMES
  4541                                            PIC X(10).
  4542         16  CF-USER2-CNTL-OPT.
  4543             20  CF-USER2-OPT-SEQ           PIC 9.
  4544                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4545                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4546             20  CF-USER2-SELECT OCCURS 3 TIMES
  4547                                            PIC X(10).
  4548         16  CF-USER3-CNTL-OPT.
  4549             20  CF-USER3-OPT-SEQ           PIC 9.
  4550                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4551                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4552             20  CF-USER3-SELECT OCCURS 3 TIMES
  4553                                            PIC X(10).
  4554         16  CF-USER4-CNTL-OPT.
  4555             20  CF-USER4-OPT-SEQ           PIC 9.
  4556                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4557                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4558             20  CF-USER4-SELECT OCCURS 3 TIMES
  4559                                            PIC X(10).
  4560         16  CF-USER5-CNTL-OPT.
  4561             20  CF-USER5-OPT-SEQ           PIC 9.
  4562                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4563                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4564             20  CF-USER5-SELECT OCCURS 3 TIMES
  4565                                            PIC X(10).
  4566         16  CF-REINS-CNTL-OPT.
  4567             20  CF-REINS-OPT-SEQ           PIC 9.
  4568                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4569                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4570             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4571                 24  CF-REINS-PRIME         PIC XXX.
  4572                 24  CF-REINS-SUB           PIC XXX.
  4573
  4574         16  CF-AGENT-CNTL-OPT.
  4575             20  CF-AGENT-OPT-SEQ           PIC 9.
  4576                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  86
* EL6501.cbl
  4577                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4578             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4579                                            PIC X(10).
  4580
  4581         16  FILLER                         PIC X(43).
  4582
  4583         16  CF-LOSS-RATIO-SELECT.
  4584             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4585             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4586         16  CF-ENTRY-DATE-SELECT.
  4587             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4588             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4589         16  CF-EFFECTIVE-DATE-SELECT.
  4590             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4591             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4592
  4593         16  CF-EXCEPTION-LIST-IND          PIC X.
  4594             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4595
  4596         16  FILLER                         PIC X(318).
  4597
  4598****************************************************************
  4599*                  EXCEPTION REPORTING RECORD                  *
  4600****************************************************************
  4601
  4602     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4603         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4604             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4605
  4606         16  CF-COMBINED-LIFE-AH-OPT.
  4607             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4608             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4609             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4610             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4611
  4612         16  CF-LIFE-OPT.
  4613             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4614             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4615             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4616             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4617             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4618             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4619             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4620             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4621             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4622             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4623
  4624         16  CF-AH-OPT.
  4625             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4626             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4627             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4628             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4629             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4630             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4631             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4632             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4633             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4634             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  87
* EL6501.cbl
  4635
  4636         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4637             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4638             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4639             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4640
  4641         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4642
  4643         16  FILLER                         PIC X(673).
  4644
  4645
  4646****************************************************************
  4647*             MORTGAGE SYSTEM PLAN RECORD                      *
  4648****************************************************************
  4649
  4650     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4651         16  CF-PLAN-TYPE                   PIC X.
  4652             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4653             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4654             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4655         16  CF-PLAN-ABBREV                 PIC XXX.
  4656         16  CF-PLAN-DESCRIPT               PIC X(10).
  4657         16  CF-PLAN-NOTES                  PIC X(20).
  4658         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4659         16  CF-PLAN-UNDERWRITING.
  4660             20  CF-PLAN-TERM-DATA.
  4661                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4662                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4663             20  CF-PLAN-AGE-DATA.
  4664                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4665                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4666                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4667             20  CF-PLAN-BENEFIT-DATA.
  4668                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4669                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4670                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4671                                            PIC S9(7)V99  COMP-3.
  4672         16  CF-PLAN-POLICY-FORMS.
  4673             20  CF-POLICY-FORM             PIC X(12).
  4674             20  CF-MASTER-APPLICATION      PIC X(12).
  4675             20  CF-MASTER-POLICY           PIC X(12).
  4676         16  CF-PLAN-RATING.
  4677             20  CF-RATE-CODE               PIC X(5).
  4678             20  CF-SEX-RATING              PIC X.
  4679                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4680                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4681             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4682             20  CF-SUB-STD-TYPE            PIC X.
  4683                 88  CF-PCT-OF-PREM            VALUE '1'.
  4684                 88  CF-PCT-OF-BENE            VALUE '2'.
  4685         16  CF-PLAN-PREM-TOLERANCES.
  4686             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4687             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4688         16  CF-PLAN-PYMT-TOLERANCES.
  4689             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4690             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4691         16  CF-PLAN-MISC-DATA.
  4692             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  88
* EL6501.cbl
  4693             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4694             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4695         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4696         16  CF-PLAN-IND-GRP                PIC X.
  4697             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4698                                                     '1'.
  4699             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4700                                                     '2'.
  4701         16  CF-MIB-SEARCH-SW               PIC X.
  4702             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4703             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4704             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4705             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4706         16  CF-ALPHA-SEARCH-SW             PIC X.
  4707             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4708             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4709             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4710             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4711             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4712             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4713             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4714             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4715             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4716             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4717                                                     'A' 'B' 'C'
  4718                                                     'X' 'Y' 'Z'.
  4719         16  CF-EFF-DT-RULE-SW              PIC X.
  4720             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4721             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4722             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4723             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4724             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4725         16  FILLER                         PIC X(4).
  4726         16  CF-HEALTH-QUESTIONS            PIC X.
  4727             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4728         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4729         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4730         16  CF-PLAN-SNGL-JNT               PIC X.
  4731             88  CF-COMBINED-PLAN              VALUE 'C'.
  4732             88  CF-JNT-PLAN                   VALUE 'J'.
  4733             88  CF-SNGL-PLAN                  VALUE 'S'.
  4734         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4735         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4736         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4737         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4738         16  CF-RERATE-CNTL                 PIC  X.
  4739             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4740             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4741             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4742             88  CF-AUTO-RECALC                 VALUE '4'.
  4743         16  CF-BENEFIT-TYPE                PIC  X.
  4744             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4745             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4746         16  CF-POLICY-FEE                  PIC S999V99
  4747                                                    COMP-3.
  4748         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4749         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4750         16  CF-3RD-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  89
* EL6501.cbl
  4751         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4752         16  FILLER                         PIC  X(32).
  4753         16  CF-TERMINATION-FORM            PIC  X(04).
  4754         16  FILLER                         PIC  X(08).
  4755         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4756                                                       COMP-3.
  4757         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4758         16  CF-ISSUE-LETTER                PIC  X(4).
  4759         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4760         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4761             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4762             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4763         16  CF-MP-REFUND-CALC              PIC X.
  4764             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4765             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4766             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4767             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4768             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4769             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4770             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4771             88  CF-MP-REFD-MEAN                VALUE '8'.
  4772         16  CF-ALT-RATE-CODE               PIC  X(5).
  4773
  4774
  4775         16  FILLER                         PIC X(498).
  4776****************************************************************
  4777*             MORTGAGE COMPANY MASTER RECORD                   *
  4778****************************************************************
  4779
  4780     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4781         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4782         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4783             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4784             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4785             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4786             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4787             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4788
  4789         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4790         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4791         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4792         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4793         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4794
  4795         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4796             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4797         16  CF-MP-RECON-USE-IND            PIC X(1).
  4798             88  CF-MP-USE-RECON             VALUE 'Y'.
  4799         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4800             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4801         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4802             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4803             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4804         16  FILLER                         PIC X(1).
  4805         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4806             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4807         16  CF-MORTG-MIB-VERSION           PIC X.
  4808             88  CF-MORTG-MIB-BATCH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  90
* EL6501.cbl
  4809             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4810             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4811         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4812             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4813                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4814             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4815                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4816             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4817                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4818             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4819                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4820             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4821                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4822             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4823                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4824         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4825         16  FILLER                         PIC X(7).
  4826         16  CF-MORTG-DESTINATION-SYMBOL.
  4827             20  CF-MORTG-MIB-COMM          PIC X(5).
  4828             20  CF-MORTG-MIB-TERM          PIC X(5).
  4829         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4830             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4831         16  FILLER                         PIC X(03).
  4832         16  CF-MP-CHECK-NO-CONTROL.
  4833             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4834                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4835                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4836                                                ' ' LOW-VALUES.
  4837                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4838                                               VALUE '3'.
  4839         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4840         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4841         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4842             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4843                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4844             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4845                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4846             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4847                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4848             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4849                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4850             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4851                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4852             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4853                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4854         16  CF-MORTG-BILLING-AREA.
  4855             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4856                                            PIC X.
  4857         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4858         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4859         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4860         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4861             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4862             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4863         16  FILLER                         PIC X.
  4864         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4865             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4866             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  91
* EL6501.cbl
  4867         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4868         16  FILLER                         PIC X(8).
  4869         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4870         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4871         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4872         16  CF-ACH-COMPANY-ID.
  4873             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4874                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4875                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4876                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4877             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4878         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4879             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4880         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4881             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4882             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4883         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4884         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4885         16  FILLER                         PIC X(536).
  4886
  4887****************************************************************
  4888*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4889****************************************************************
  4890
  4891     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4892         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4893             20  CF-FEMALE-HEIGHT.
  4894                 24  CF-FEMALE-FT           PIC 99.
  4895                 24  CF-FEMALE-IN           PIC 99.
  4896             20  CF-FEMALE-MIN-WT           PIC 999.
  4897             20  CF-FEMALE-MAX-WT           PIC 999.
  4898         16  FILLER                         PIC X(428).
  4899
  4900     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4901         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4902             20  CF-MALE-HEIGHT.
  4903                 24  CF-MALE-FT             PIC 99.
  4904                 24  CF-MALE-IN             PIC 99.
  4905             20  CF-MALE-MIN-WT             PIC 999.
  4906             20  CF-MALE-MAX-WT             PIC 999.
  4907         16  FILLER                         PIC X(428).
  4908******************************************************************
  4909*             AUTOMATIC ACTIVITY RECORD                          *
  4910******************************************************************
  4911     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4912         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4913             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4914             20  CF-SYS-LETTER-ID           PIC X(04).
  4915             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4916             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4917             20  CF-SYS-RESET-SW            PIC X(01).
  4918             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4919             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4920
  4921         16  FILLER                         PIC X(50).
  4922
  4923         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4924             20  CF-USER-ACTIVE-SW          PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  92
* EL6501.cbl
  4925             20  CF-USER-LETTER-ID          PIC X(04).
  4926             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4927             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4928             20  CF-USER-RESET-SW           PIC X(01).
  4929             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4930             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4931             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4932
  4933         16  FILLER                         PIC X(246).
  4934*    COPY ERCREIN.
  4935******************************************************************
  4936*                                                                *
  4937*                            ERCREIN                             *
  4938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4939*                            VMOD=2.010                          *
  4940*                                                                *
  4941*   ONLINE CREDIT SYSTEM                                         *
  4942*                                                                *
  4943*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4944*                                                                *
  4945*   FILE TYPE = VSAM,KSDS                                        *
  4946*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4947*                                                                *
  4948*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4949*       ALTERNATE PATH = NONE                                    *
  4950*                                                                *
  4951*   LOG = NO                                                     *
  4952*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4953*                                                                *
  4954******************************************************************
  4955*                   C H A N G E   L O G
  4956*
  4957* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4958*-----------------------------------------------------------------
  4959*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4960* EFFECTIVE    NUMBER
  4961*-----------------------------------------------------------------
  4962* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4963* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4964******************************************************************
  4965 01  REINSURANCE-RECORD.
  4966     12  RE-RECORD-ID                      PIC XX.
  4967         88  VALID-RE-ID                      VALUE 'RE'.
  4968
  4969     12  RE-CONTROL-PRIMARY.
  4970         16  RE-COMPANY-CD                 PIC X.
  4971         16  RE-KEY.
  4972             20  RE-CODE                   PIC X.
  4973                 88  RE-TABLE-RECORD          VALUE 'A'.
  4974                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4975             20  RE-TABLE                  PIC XXX.
  4976             20  FILLER                    PIC XXX.
  4977         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4978             20  FILLER                    PIC X.
  4979             20  RE-COMPANY.
  4980                 24  RE-COMP-PRIME         PIC XXX.
  4981                 24  RE-COMP-SUB           PIC XXX.
  4982
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  93
* EL6501.cbl
  4983     12  RE-MAINT-INFORMATION.
  4984         16  RE-LAST-MAINT-DT              PIC XX.
  4985         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4986         16  RE-LAST-MAINT-USER            PIC X(4).
  4987         16  FILLER                        PIC X(10).
  4988
  4989     12  RE-TABLE-DATA.
  4990         16  RE-100-COMP                   PIC 99.
  4991
  4992         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4993             20  RE-REI-COMP-NO.
  4994                 24  RE-REI-COMP           PIC XXX.
  4995                 24  RE-REI-COMP-SUB       PIC XXX.
  4996             20  RE-LF-QC                  PIC X.
  4997             20  RE-AH-QC                  PIC X.
  4998             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4999             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  5000             20  RE-LFAGE-LO               PIC 99.
  5001             20  RE-LFAGE-HI               PIC 99.
  5002             20  RE-AHAGE-LO               PIC 99.
  5003             20  RE-AHAGE-HI               PIC 99.
  5004             20  RE-LFTRM-LO               PIC S999       COMP-3.
  5005             20  RE-LFTRM-HI               PIC S999       COMP-3.
  5006             20  RE-AHTRM-LO               PIC S999       COMP-3.
  5007             20  RE-AHTRM-HI               PIC S999       COMP-3.
  5008             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  5009             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  5010             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  5011             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  5012             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  5013             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  5014             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  5015             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5016             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5017             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5018             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5019             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5020             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5021             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5022             20  RE-LF-BEN-CODE            PIC X.
  5023             20  RE-AH-BEN-CODE            PIC X.
  5024             20  RE-INTERACTIVE            PIC X.
  5025             20  RE-REMAINING              PIC X.
  5026             20  RE-LF-RUNOFF-SW           PIC X.
  5027             20  RE-AH-RUNOFF-SW           PIC X.
  5028             20  FILLER                    PIC X(19).
  5029
  5030         16  RE-COMP-INFO-END              PIC X(6).
  5031         16  RE-NSP-ST-CD-LF               PIC XX.
  5032         16  RE-NSP-ST-CD-AH               PIC XX.
  5033         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5034             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5035
  5036         16  FILLER                        PIC X(27).
  5037
  5038     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5039         16  RE-NAME                       PIC X(30).
  5040         16  RE-LF-PE                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  94
* EL6501.cbl
  5041         16  RE-AH-PE                      PIC X.
  5042         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5043         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5044         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5045         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  5046         16  RE-PRT-ST                     PIC X.
  5047         16  RE-PRT-OW                     PIC X.
  5048         16  RE-MORT-CODE                  PIC X(4).
  5049         16  RE-CLAIM-CODE                 PIC X.
  5050         16  RE-ZERO-LF-FEE                PIC X.
  5051         16  RE-ZERO-AH-FEE                PIC X.
  5052         16  RE-CEDE-NAME                  PIC X(30).
  5053         16  RE-LF-COMM                    PIC X.
  5054         16  RE-AH-COMM                    PIC X.
  5055         16  RE-LF-TAX                     PIC X.
  5056         16  RE-AH-TAX                     PIC X.
  5057         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5058         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5059         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5060
  5061         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5062             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5063
  5064         16  RE-LF-CEDING-FEE-BRACKETS.
  5065             20  RE-LF-FEE-METHOD          PIC X.
  5066                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5067                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5068                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5069                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5070             20  RE-LF-FEE-BASIS           PIC X.
  5071                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5072                 88  RE-LF-NET-CEDED               VALUE '2'.
  5073                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5074                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5075                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5076                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5077                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5078                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5079             20  FILLER                    PIC XXX.
  5080             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5081                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5082                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5083
  5084         16  RE-AH-CEDING-FEE-BRACKETS.
  5085             20  RE-AH-FEE-METHOD          PIC X.
  5086                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5087                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5088                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5089                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5090             20  RE-AH-FEE-BASIS           PIC X.
  5091                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5092                 88  RE-AH-NET-CEDED               VALUE '2'.
  5093                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5094                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5095                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5096                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5097                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5098                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  95
* EL6501.cbl
  5099             20  FILLER                    PIC XXX.
  5100             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5101                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5102                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5103
  5104         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5105
  5106         16  RE-OLD-CEDING-STMT            PIC X.
  5107
  5108         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5109         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5110         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5111         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5112         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5113         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5114         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5115         16  RE-MORT-SW                    PIC X.
  5116         16  RE-CEDING-TYPE-FLAG           PIC X.
  5117             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5118             88  RE-CEDED                          VALUE 'C'.
  5119             88  RE-ASSUMED                        VALUE 'A'.
  5120             88  RE-PHANTOM                        VALUE 'P'.
  5121
  5122         16  RE-CEDING-STMT-OPT-A          PIC X.
  5123             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5124         16  RE-CEDING-STMT-OPT-B          PIC X.
  5125             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5126         16  RE-CEDING-STMT-OPT-C          PIC X.
  5127             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5128         16  RE-CEDING-STMT-OPT-D          PIC X.
  5129             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5130         16  RE-CEDING-STMT-OPT-E          PIC X.
  5131             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5132
  5133         16  RE-PRT-CRSV                   PIC X.
  5134
  5135         16  RE-GL-CENTER                  PIC X(4).
  5136
  5137         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5138
  5139         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5140
  5141         16  RE-EARN-STOP-CODE             PIC X.
  5142             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5143             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5144
  5145         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5146             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5147
  5148         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5149         16  FILLER                        PIC X(2281).
  5150
  5151         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5152
  5153******************************************************************
  5154*    COPY ERCCTBL.
  5155******************************************************************
  5156*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  96
* EL6501.cbl
  5157*                                                                *
  5158*                            ERCCTBL                             *
  5159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5160*                            VMOD=2.003
  5161*                                                                *
  5162*   ONLINE CREDIT SYSTEM                                         *
  5163*                                                                *
  5164*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5165*                                                                *
  5166*   FILE TYPE = VSAM,KSDS                                        *
  5167*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5168*                                                                *
  5169*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5170*       ALTERNATE PATH = NONE                                    *
  5171*                                                                *
  5172*   LOG = NO                                                     *
  5173*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5174*                                                                *
  5175*                                                                *
  5176******************************************************************
  5177
  5178 01  COMM-TABLE-RECORD.
  5179     12  CT-RECORD-ID                      PIC XX.
  5180         88  VALID-CT-ID                      VALUE 'CT'.
  5181
  5182     12  CT-CONTROL-PRIMARY.
  5183         16  CT-COMPANY-CD                 PIC X.
  5184         16  CT-TABLE                      PIC XXX.
  5185         16  CT-CNTRL-2.
  5186             20  CT-BEN-TYPE               PIC X.
  5187             20  CT-BEN-CODE               PIC XX.
  5188
  5189     12  CT-MAINT-INFORMATION.
  5190         16  CT-LAST-MAINT-DT              PIC XX.
  5191         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5192         16  CT-LAST-MAINT-USER            PIC X(4).
  5193         16  FILLER                        PIC X(31).
  5194
  5195     12  CT-LIMITS.
  5196         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5197
  5198         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5199
  5200         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5201
  5202     12  CT-RATES.
  5203         16  CT-RTX          OCCURS 27 TIMES.
  5204             20  CT-RT                     PIC SV9(5)     COMP-3.
  5205             20  CT-RT-R   REDEFINES
  5206                 CT-RT                     PIC XXX.
  5207
  5208     12  FILLER                            PIC  X(42).
  5209
  5210******************************************************************
  5211*                                COPY ERCACNT.
  5212******************************************************************
  5213*                                                                *
  5214*                                                                *
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  97
* EL6501.cbl
  5215*                            ERCACNT.                            *
  5216*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5217*                            VMOD=2.002                          *
  5218*                                                                *
  5219*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
  5220*                                                                *
  5221*   FILE TYPE = VSAM,KSDS                                        *
  5222*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5223*                                                                *
  5224*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5225*       ALTERNATE INDEX = NONE                                   *
  5226*                                                                *
  5227*                                                                *
  5228*   LOG = YES                                                    *
  5229*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5230******************************************************************
  5231*                   C H A N G E   L O G
  5232*
  5233* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5234*-----------------------------------------------------------------
  5235*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5236* EFFECTIVE    NUMBER
  5237*-----------------------------------------------------------------
  5238* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5239*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5240******************************************************************
  5241 01  NOTE-FILE.
  5242     12  NT-FILE-ID                  PIC XX.
  5243         88  VALID-NOTE-ID              VALUE 'NT'.
  5244
  5245     12  NT-CONTROL-PRIMARY.
  5246         16  NT-COMPANY-CD           PIC X.
  5247         16  NT-ACCT-NOTE-KEY.
  5248             18  NT-CARRIER              PIC X.
  5249             18  NT-GROUPING             PIC X(06).
  5250             18  NT-STATE                PIC XX.
  5251             18  NT-ACCOUNT              PIC X(10).
  5252         16  NT-RECORD-TYPE          PIC X.
  5253              88  ACCT-NOTE          VALUE '1'.
  5254              88  ACCT-BRANCH-LOC    VALUE '2'.
  5255              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5256         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5257
  5258     12  NT-LAST-MAINT-DT            PIC XX.
  5259     12  NT-LAST-MAINT-BY            PIC X(4).
  5260     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5261
  5262*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5263*     SEQUENCE NUMBERS
  5264     12  NT-NOTE-INFORMATION.
  5265         16  NT-NOTE-LINE            PIC X(60).
  5266         16  FILLER                  PIC X(25).
  5267*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5268     12  NT-LOCATION-INFORMATION REDEFINES
  5269                         NT-NOTE-INFORMATION.
  5270         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5271         16  FILLER                  PIC X(25).
  5272*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  98
* EL6501.cbl
  5273*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5274*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5275*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5276*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5277*     SEQUENCE NUMBER 5 IS ADDR LINE 3
  5278*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5279     12  NT-SHIPPING-INFORMATION REDEFINES
  5280                         NT-NOTE-INFORMATION.
  5281         16  NT-SHIPPING-LINE        PIC X(60).
  5282         16  NT-SHIP-STATE           PIC XX.
  5283         16  NT-SHIP-ZIP             PIC X(10).
  5284         16  FILLER                  PIC X(13).
  5285*****************************************************************
  5286
  5287 01  COMMISSION-WORK-AREA.
  5288     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5289         10  WK-AM-AGT           PIC X(10).
  5290         10  WK-AM-TYPE          PIC X.
  5291         10  WK-FILLER           PIC X(13).
  5292         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page  99
* EL6501.cbl
  5294*    COPY ERCCOMP.
  5295******************************************************************
  5296*                                                                *
  5297*                                                                *
  5298*                            ERCCOMP                             *
  5299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5300*                            VMOD=2.019                          *
  5301*                                                                *
  5302*   ONLINE CREDIT SYSTEM                                         *
  5303*                                                                *
  5304*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5305*                                                                *
  5306*   FILE TYPE = VSAM,KSDS                                        *
  5307*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5308*                                                                *
  5309*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5310*       ALTERNATE PATH = NONE                                    *
  5311*                                                                *
  5312*   LOG = NO                                                     *
  5313*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5314*                                                                *
  5315******************************************************************
  5316*                   C H A N G E   L O G
  5317*
  5318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5319*-----------------------------------------------------------------
  5320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5321* EFFECTIVE    NUMBER
  5322*-----------------------------------------------------------------
  5323* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5324* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5325* 092205    2005050300006  PEMA  ADD LEASE FEE
  5326* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5327* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5328* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5329* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5330* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5331* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5332******************************************************************
  5333
  5334 01  COMPENSATION-MASTER.
  5335     12  CO-RECORD-ID                          PIC XX.
  5336         88  VALID-CO-ID                          VALUE 'CO'.
  5337
  5338     12  CO-CONTROL-PRIMARY.
  5339         16  CO-COMPANY-CD                     PIC X.
  5340         16  CO-CONTROL.
  5341             20  CO-CTL-1.
  5342                 24  CO-CARR-GROUP.
  5343                     28  CO-CARRIER            PIC X.
  5344                     28  CO-GROUPING.
  5345                         32  CO-GROUP-PREFIX   PIC XXX.
  5346                         32  CO-GROUP-PRIME    PIC XXX.
  5347                 24  CO-RESP-NO.
  5348                     28  CO-RESP-PREFIX        PIC X(4).
  5349                     28  CO-RESP-PRIME         PIC X(6).
  5350             20  CO-CTL-2.
  5351                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 100
* EL6501.cbl
  5352                     28  CO-ACCT-PREFIX        PIC X(4).
  5353                     28  CO-ACCT-PRIME         PIC X(6).
  5354         16  CO-TYPE                           PIC X.
  5355             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5356             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5357             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5358
  5359     12  CO-MAINT-INFORMATION.
  5360         16  CO-LAST-MAINT-DT                  PIC XX.
  5361         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5362         16  CO-LAST-MAINT-USER                PIC X(4).
  5363     12  FILLER                                PIC XX.
  5364     12  CO-STMT-TYPE                          PIC XXX.
  5365     12  CO-COMP-TYPE                          PIC X.
  5366         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5367     12  CO-STMT-OWNER                         PIC X(4).
  5368     12  CO-BALANCE-CONTROL                    PIC X.
  5369         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5370         88  CO-NO-BALANCE                        VALUE 'N'.
  5371
  5372     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5373         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5374         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5375         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5376
  5377     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5378         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5379         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5380
  5381     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5382     12  CO-GA-DIRECT-DEP                      PIC X.
  5383     12  CO-FUTURE-SPACE                       PIC X.
  5384         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5385
  5386     12  CO-ACCT-NAME                          PIC X(30).
  5387     12  CO-MAIL-NAME                          PIC X(30).
  5388     12  CO-ADDR-1                             PIC X(30).
  5389     12  CO-ADDR-2                             PIC X(30).
  5390     12  CO-ADDR-3.
  5391         16  CO-ADDR-CITY                      PIC X(27).
  5392         16  CO-ADDR-STATE                     PIC XX.
  5393     12  CO-CSO-1099                           PIC X.
  5394     12  CO-ZIP.
  5395         16  CO-ZIP-PRIME.
  5396             20  CO-ZIP-PRI-1ST                PIC X.
  5397                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5398             20  FILLER                        PIC X(4).
  5399         16  CO-ZIP-PLUS4                      PIC X(4).
  5400     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5401         16  CO-CAN-POSTAL-1                   PIC XXX.
  5402         16  CO-CAN-POSTAL-2                   PIC XXX.
  5403         16  FILLER                            PIC XXX.
  5404     12  CO-SOC-SEC                            PIC X(13).
  5405     12  CO-TELEPHONE.
  5406         16  CO-AREA-CODE                      PIC XXX.
  5407         16  CO-PREFIX                         PIC XXX.
  5408         16  CO-PHONE                          PIC X(4).
  5409
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 101
* EL6501.cbl
  5410     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5411
  5412     12  CO-AR-BAL-LEVEL                       PIC X.
  5413         88  CO-AR-REF-LVL                        VALUE '1'.
  5414         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5415         88  CO-AR-BILL-LVL                       VALUE '2'.
  5416         88  CO-AR-AGT-LVL                        VALUE '3'.
  5417         88  CO-AR-FR-LVL                         VALUE '4'.
  5418
  5419     12  CO-AR-NORMAL-PRINT                    PIC X.
  5420         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5421         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5422
  5423     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5424
  5425     12  CO-AR-REPORTING                       PIC X.
  5426         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5427         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5428
  5429     12  CO-AR-PULL-CHECK                      PIC X.
  5430         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5431         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5432
  5433     12  CO-AR-BALANCE-PRINT                   PIC X.
  5434         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5435
  5436     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5437         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5438         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5439         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5440
  5441     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5442
  5443     12  CO-USER-CODE                          PIC X.
  5444     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5445
  5446******************************************************************
  5447*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5448*    THE LAST MONTH END RUN.
  5449******************************************************************
  5450
  5451     12  CO-LAST-ACTIVITY-DATE.
  5452         16  CO-ACT-YEAR                       PIC 99.
  5453         16  CO-ACT-MONTH                      PIC 99.
  5454         16  CO-ACT-DAY                        PIC 99.
  5455
  5456     12  CO-LAST-STMT-DT.
  5457         16  CO-LAST-STMT-YEAR                 PIC 99.
  5458         16  CO-LAST-STMT-MONTH                PIC 99.
  5459         16  CO-LAST-STMT-DAY                  PIC 99.
  5460
  5461     12  CO-MO-END-TOTALS.
  5462         16  CO-MONTHLY-TOTALS.
  5463             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5464             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5465             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5466             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5467             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 102
* EL6501.cbl
  5468
  5469         16  CO-AGING-TOTALS.
  5470             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5471             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5472             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5473             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5474
  5475         16  CO-YTD-TOTALS.
  5476             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5477             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5478
  5479         16  CO-OVER-UNDER-TOTALS.
  5480             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5481             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5482
  5483     12  CO-MISCELLANEOUS-TOTALS.
  5484         16  CO-FICA-TOTALS.
  5485             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5486             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5487
  5488         16  CO-CLAIM-TOTALS.
  5489             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5490             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5491
  5492******************************************************************
  5493*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5494*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5495******************************************************************
  5496
  5497     12  CO-CURRENT-TOTALS.
  5498         16  CO-CURRENT-LAST-STMT-DT.
  5499             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5500             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5501             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5502
  5503         16  CO-CURRENT-MONTHLY-TOTALS.
  5504             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5505             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5506             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5507             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5508             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5509
  5510         16  CO-CURRENT-AGING-TOTALS.
  5511             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5512             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5513             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5514             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5515
  5516         16  CO-CURRENT-YTD-TOTALS.
  5517             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5518             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5519
  5520     12  CO-PAID-COMM-TOTALS.
  5521         16  CO-YTD-PAID-COMMS.
  5522             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5523             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5524
  5525     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 103
* EL6501.cbl
  5526         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5527         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5528
  5529     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5530         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5531         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5532         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5533         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5534         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5535         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5536         88  CO-FINAL-LETTER                  VALUE 'F'.
  5537         88  CO-RECONCILING                   VALUE 'R'.
  5538         88  CO-PHONE-CALL                    VALUE 'P'.
  5539         88  CO-LEGAL                         VALUE 'L'.
  5540         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5541         88  CO-WRITE-OFF                     VALUE 'W'.
  5542         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5543
  5544     12  CO-CSR-CODE                       PIC X(4).
  5545
  5546     12  CO-GA-STATUS-INFO.
  5547         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5548         16  CO-GA-TERMINATION-DT          PIC XX.
  5549         16  CO-GA-STATUS-CODE             PIC X.
  5550             88  CO-GA-ACTIVE                 VALUE 'A'.
  5551             88  CO-GA-INACTIVE               VALUE 'I'.
  5552             88  CO-GA-PENDING                VALUE 'P'.
  5553         16  CO-GA-COMMENTS.
  5554             20  CO-GA-COMMENT-1           PIC X(40).
  5555             20  CO-GA-COMMENT-2           PIC X(40).
  5556             20  CO-GA-COMMENT-3           PIC X(40).
  5557             20  CO-GA-COMMENT-4           PIC X(40).
  5558
  5559     12  CO-RPTCD2                         PIC X(10).
  5560     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5561         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5562         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5563
  5564     12  CO-TYPE-AGENT                     PIC X(01).
  5565         88  CO-CORPORATION                   VALUE 'C'.
  5566         88  CO-PARTNERSHIP                   VALUE 'P'.
  5567         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5568         88  CO-TRUST                         VALUE 'T'.
  5569         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5570
  5571     12  CO-FAXNO.
  5572         16  CO-FAX-AREA-CODE                  PIC XXX.
  5573         16  CO-FAX-PREFIX                     PIC XXX.
  5574         16  CO-FAX-PHONE                      PIC X(4).
  5575
  5576     12  CO-BANK-INFORMATION.
  5577         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5578         16  CO-BANK-TRANSIT-NON REDEFINES
  5579             CO-BANK-TRANSIT-NO                PIC 9(8).
  5580
  5581         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5582     12  CO-MISC-DEDUCT-INFO REDEFINES
  5583                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 104
* EL6501.cbl
  5584         16  CO-MD-GL-ACCT                     PIC X(10).
  5585         16  CO-MD-DIV                         PIC XX.
  5586         16  CO-MD-CENTER                      PIC X(4).
  5587         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5588         16  CO-CREATE-AP-CHECK                PIC X.
  5589         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5590         16  FILLER                            PIC XXX.
  5591     12  CO-ACH-STATUS                         PIC X.
  5592         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5593         88  CO-ACH-PENDING                        VALUE 'P'.
  5594
  5595     12  CO-BILL-SW                            PIC X.
  5596     12  CO-CONTROL-NAME                       PIC X(30).
  5597     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5598     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5599     12  CO-CLP-STATE                          PIC XX.
  5600     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5601     12  CO-SPP-REFUND-EDIT                    PIC X.
  5602
  5603******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 105
* EL6501.cbl
  5605*    COPY ERCNAME.
  5606******************************************************************
  5607*                                                                *
  5608*                                                                *
  5609*                            ERCNAME                             *
  5610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5611*                            VMOD=2.003                          *
  5612*                                                                *
  5613*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5614*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5615*                                                                *
  5616*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5617*                                                                *
  5618*   FILE TYPE = VSAM,KSDS                                        *
  5619*   RECORD SIZE = 160   RECFORM = FIX                            *
  5620*                                                                *
  5621*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5622*                                                                *
  5623*   LOG = NO                                                     *
  5624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5625*                                                                *
  5626*                                                                *
  5627******************************************************************
  5628
  5629 01  NAME-LOOKUP-MASTER.
  5630     12  NL-RECORD-ID                PIC  X(02).
  5631         88  VALID-NL-ID                         VALUE 'NL'.
  5632
  5633     12  NL-RECORD-KEY.
  5634         16  NL-CONTROL-PRIMARY.
  5635             20  NL-COMPANY-CD       PIC  X(01).
  5636             20  NL-NAME             PIC  X(30).
  5637             20  NL-RECORD-TYPE      PIC  X(01).
  5638                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5639                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5640                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5641
  5642         16  NL-ACCOUNT-MASTER.
  5643             20  NL-AM-COMPANY-CD    PIC  X(01).
  5644             20  NL-AM-CARRIER       PIC  X(01).
  5645             20  NL-AM-GROUPING      PIC  X(06).
  5646             20  NL-AM-STATE         PIC  X(02).
  5647             20  NL-AM-ACCOUNT       PIC  X(10).
  5648             20  FILLER              PIC  X(09).
  5649
  5650         16  NL-COMPENSATION-MASTER
  5651                                 REDEFINES  NL-ACCOUNT-MASTER.
  5652             20  NL-CO-COMPANY-CD    PIC  X(01).
  5653             20  NL-CO-CARRIER       PIC  X(01).
  5654             20  NL-CO-GROUPING      PIC  X(06).
  5655             20  NL-CO-RESP-NO       PIC  X(10).
  5656             20  NL-CO-ACCOUNT       PIC  X(10).
  5657             20  NL-CO-TYPE          PIC  X(01).
  5658
  5659         16  NL-REINSURANCE-RECORD
  5660                                 REDEFINES  NL-ACCOUNT-MASTER.
  5661             20  NL-RE-COMPANY-CD    PIC  X(01).
  5662             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 106
* EL6501.cbl
  5663             20  NL-RE-COMPANY.
  5664                 24  NL-RE-COMP      PIC  X(03).
  5665                 24  NL-RE-CO-SUB    PIC  X(03).
  5666             20  NL-RE-TABLE         PIC  X(03).
  5667             20  FILLER              PIC  X(18).
  5668
  5669     12  NL-MAINT-INFORMATION.
  5670         16  NL-LAST-MAINT-DT        PIC  X(02).
  5671         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5672         16  NL-LAST-MAINT-USER      PIC  X(04).
  5673         16  FILLER                  PIC  X(10).
  5674
  5675     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5676         16  NL-RE-LEVEL             PIC  9(02).
  5677
  5678     12  NL-CITY                     PIC  X(15).
  5679     12  NL-ST                       PIC  XX.
  5680
  5681******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 107
* EL6501.cbl
  5683*    COPY ERCRQST.
  5684******************************************************************
  5685*                                                                *
  5686*                                                                *
  5687*                            ERCRQST.                            *
  5688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5689*                            VMOD=2.002                          *
  5690*                                                                *
  5691*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5692*                                                                *
  5693*   FILE TYPE = VSAM,KSDS                                        *
  5694*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5695*                                                                *
  5696*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5697*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5698*                                   ACCOUNT, REF, BATCH)         *
  5699*                                                RKP=9, LEN=38   *
  5700*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5701*                                   ACCOUNT, REF, BATCH)         *
  5702*                                                RKP=47, LEN=46  *
  5703*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5704*                                   BATCH)                       *
  5705*                                                RKP=93, LEN=24  *
  5706*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5707*                                   REF, BATCH)                  *
  5708*                                                RKP=117, LEN=35 *
  5709*   LOG = NO                                                     *
  5710*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5711******************************************************************
  5712
  5713 01  AR-REQUEST-RECORD.
  5714     12  RQ-RECORD-ID                     PIC XX.
  5715         88  VALID-RQ-ID                        VALUE 'RQ'.
  5716
  5717     12  RQ-CONTROL-PRIMARY.
  5718         16  RQ-COMPANY-CD                PIC X.
  5719         16  RQ-ENTRY-BATCH               PIC X(6).
  5720
  5721     12  RQ-CONTROL-BY-ACCT-REF.
  5722         16  RQ-COMPANY-CD-A1             PIC X.
  5723         16  RQ-CARRIER-A1                PIC X.
  5724         16  RQ-GROUPING-A1               PIC X(6).
  5725         16  RQ-STATE-A1                  PIC XX.
  5726         16  RQ-ACCOUNT-A1                PIC X(10).
  5727         16  RQ-REFERENCE-A1              PIC X(12).
  5728         16  RQ-BATCH-A1                  PIC X(6).
  5729
  5730     12  RQ-CONTROL-BY-FIN-RESP.
  5731         16  RQ-COMPANY-CD-A2             PIC X.
  5732         16  RQ-CARRIER-A2                PIC X.
  5733         16  RQ-GROUPING-A2               PIC X(6).
  5734         16  RQ-FIN-RESP-A2               PIC X(10).
  5735         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5736         16  RQ-REFERENCE-A2              PIC X(12).
  5737         16  RQ-BATCH-A2                  PIC X(6).
  5738
  5739     12  RQ-CONTROL-BY-ACCT-AGENT.
  5740         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 108
* EL6501.cbl
  5741         16  RQ-CARRIER-A3                PIC X.
  5742         16  RQ-GROUPING-A3               PIC X(6).
  5743         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5744         16  RQ-BATCH-A3                  PIC X(6).
  5745
  5746     12  RQ-CONTROL-BY-SUMMARY.
  5747         16  RQ-COMPANY-CD-A4             PIC X.
  5748         16  RQ-SUMMARY-CODE              PIC X(6).
  5749         16  RQ-ACCOUNT-A4                PIC X(10).
  5750         16  RQ-REFERENCE-A4              PIC X(12).
  5751         16  RQ-BATCH-A4                  PIC X(6).
  5752
  5753     12  RQ-REQUEST-METHOD                PIC X.
  5754         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5755         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5756         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5757         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5758     12  FILLER                           PIC X.
  5759     12  RQ-STATUS                        PIC X.
  5760         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5761         88  RQ-RESUBMIT                      VALUE 'R'.
  5762     12  RQ-PROCESSOR-ID                  PIC X(4).
  5763     12  RQ-ENTRY-DT                      PIC XX.
  5764     12  RQ-MO-END-DT                     PIC XX.
  5765     12  RQ-REQUEST-DT                    PIC XX.
  5766     12  RQ-STMT-DT                       PIC XX.
  5767     12  RQ-REVERSAL-DT                   PIC XX.
  5768     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5769     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5770
  5771     12  FILLER                           PIC X(27).
  5772
  5773******************************************************************
  5774
  5775*EJECT
  5776*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 109
* EL6501.cbl
  5778 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5779                          PRODUCT-MASTER CONTROL-FILE
  5780                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5781                          NOTE-FILE COMMISSION-WORK-AREA
  5782                          COMPENSATION-MASTER
  5783                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5784 0000-DFHEXIT SECTION.
  5785     MOVE '9#                    $   ' TO DFHEIV0.
  5786     MOVE 'EL6501' TO DFHEIV1.
  5787     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5788     MOVE EIBTRMID              TO QID-TERM.
  5789
  5790     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5791     MOVE '5'                   TO DC-OPTION-CODE.
  5792     PERFORM 9700-DATE-LINK.
  5793     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5794     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5795
  5796***  Y2K PROJ 7744
  5797     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5798                                    CURRENT-SAVE
  5799     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5800                                    CURRENT-SAVE(1:2)
  5801***  Y2K PROJ 7744
  5802
  5803     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5804     IF EIBCALEN = 0
  5805         GO TO 8800-UNAUTHORIZED-ACCESS.
  5806
  5807     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5808     MOVE LOW-VALUES             TO EL6501AI.
  5809
  5810
  5811* EXEC CICS HANDLE CONDITION
  5812*        PGMIDERR  (9600-PGMID-ERROR)
  5813*        ERROR     (9990-ABEND)
  5814*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5815*    END-EXEC.
  5816*    MOVE '"$L.N                 ! " #00005806' TO DFHEIV0
  5817     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5819     MOVE X'2220233030303035383036' TO DFHEIV0(25:11)
  5820     CALL 'kxdfhei1' USING DFHEIV0
  5821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5822
  5823
  5824     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5825         IF PI-CALLING-PROGRAM = XCTL-650
  5826             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5827             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5828             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5829             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5830             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5831             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5832             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5833             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5834             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5835             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 110
* EL6501.cbl
  5836         ELSE
  5837             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5838             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5839             GO TO 0600-DISPLAY-RECORD.
  5840
  5841     IF EIBAID = DFHCLEAR
  5842         GO TO 9400-CLEAR.
  5843
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 111
* EL6501.cbl
  5845 0200-RECEIVE.
  5846     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5847         MOVE ER-0008            TO EMI-ERROR
  5848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5849         MOVE -1                 TO PFENTERL
  5850         GO TO 8200-SEND-DATAONLY.
  5851
  5852
  5853* EXEC CICS RECEIVE
  5854*        MAP      (MAP-NAME)
  5855*        MAPSET   (MAPSET-NAME)
  5856*        INTO     (EL6501AI)
  5857*    END-EXEC.
  5858     MOVE LENGTH OF
  5859      EL6501AI
  5860       TO DFHEIV11
  5861*    MOVE '8"T I  L              ''   #00005840' TO DFHEIV0
  5862     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5864     MOVE X'2020233030303035383430' TO DFHEIV0(25:11)
  5865     CALL 'kxdfhei1' USING DFHEIV0,
  5866           MAP-NAME,
  5867           EL6501AI,
  5868           DFHEIV11,
  5869           MAPSET-NAME,
  5870           DFHEIV99,
  5871           DFHEIV99
  5872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5873
  5874
  5875     IF PFENTERL = 0
  5876         GO TO 0300-CHECK-PFKEYS.
  5877     IF EIBAID NOT = DFHENTER
  5878         MOVE ER-0004            TO EMI-ERROR
  5879         GO TO 0320-INPUT-ERROR.
  5880     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5881         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5882     ELSE
  5883         MOVE ER-0029            TO EMI-ERROR
  5884         GO TO 0320-INPUT-ERROR.
  5885
  5886 0300-CHECK-PFKEYS.
  5887     IF EIBAID = DFHPF23
  5888         GO TO 8810-PF23.
  5889     IF EIBAID = DFHPF24
  5890         GO TO 9200-RETURN-MAIN-MENU.
  5891     IF EIBAID = DFHPF12
  5892         GO TO 9500-PF12.
  5893
  5894* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5895*             MASTER(ERRESC)
  5896*
  5897*    IF  EIBAID = DFHPF10
  5898*        IF PI-COMPANY-ID = 'DMD'
  5899*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5900*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5901*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5902*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 112
* EL6501.cbl
  5903*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5904*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5905*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5906*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5907*           MOVE XCTL-608           TO PGM-NAME
  5908*                                      PI-RETURN-TO-PROGRAM
  5909*                                      PI-CALLING-PROGRAM
  5910*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5911*           GO TO 9300-XCTL.
  5912
  5913     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5914                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5915                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5916         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5917             MOVE ER-0029        TO  EMI-ERROR
  5918             GO TO 0320-INPUT-ERROR
  5919         ELSE
  5920             GO TO 0800-CHECK-MAINT.
  5921
  5922     IF EIBAID = DFHENTER
  5923         GO TO 0330-EDIT-DATA.
  5924
  5925     MOVE ER-0029                TO EMI-ERROR.
  5926
  5927 0320-INPUT-ERROR.
  5928     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5929     MOVE AL-UNBON               TO PFENTERA.
  5930     MOVE -1                     TO PFENTERL.
  5931     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 113
* EL6501.cbl
  5933 0330-EDIT-DATA.
  5934     IF MAINTI  = 'S'
  5935        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5936        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5937        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5938        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5939        MOVE -1                  TO MAINTL
  5940        GO TO 8100-SEND-INITIAL-MAP.
  5941
  5942     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5943     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5944
  5945     IF EMI-ERROR NOT = ZEROS
  5946         MOVE -1                 TO MAINTL
  5947         GO TO 8200-SEND-DATAONLY.
  5948
  5949     IF NOT MODIFY-CAP
  5950         MOVE 'UPDATE'           TO SM-READ
  5951         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5952         MOVE ER-0070            TO EMI-ERROR
  5953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5954         GO TO 8100-SEND-INITIAL-MAP.
  5955
  5956     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5957
  5958     IF MAINTI = 'A'
  5959        GO TO 1000-ADD-A-RECORD.
  5960
  5961     IF MAINTI = 'C'
  5962        IF PI-SV-MAINT  =  'L'
  5963            MOVE -1             TO MAINTL
  5964            MOVE AL-UABON       TO MAINTA
  5965            MOVE ER-0899        TO EMI-ERROR
  5966            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5967            GO TO 8200-SEND-DATAONLY
  5968        ELSE
  5969            GO TO 2000-CHANGE-A-RECORD.
  5970
  5971     IF MAINTI = 'L'
  5972        MOVE 'L'                TO PI-SV-MAINT
  5973        GO TO 3000-CHANGE-ALL-RECORDS.
  5974
  5975     MOVE ER-0023                TO EMI-ERROR.
  5976     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5977     MOVE -1                     TO MAINTL.
  5978     MOVE AL-UABON               TO MAINTA.
  5979     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 114
* EL6501.cbl
  5981 0500-CHECK-MAINT-TYPE.
  5982     IF PI-MAINT = 'A'
  5983        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5984        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5985        MOVE -1                  TO NAMEL
  5986        GO TO 8100-SEND-INITIAL-MAP.
  5987
  5988 0600-DISPLAY-RECORD.
  5989     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5990     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5991     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5992     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5993
  5994     IF PI-MAINT = 'A'
  5995        MOVE -1                  TO NAMEL
  5996     ELSE
  5997        MOVE -1                  TO MAINTL.
  5998
  5999     GO TO 8100-SEND-INITIAL-MAP.
  6000
  6001 0700-FORMAT-KEYDATA.
  6002     MOVE PI-MAINT               TO MAINTI.
  6003
  6004     IF PI-MAINT = 'A'
  6005        MOVE AL-PANON            TO MAINTA
  6006        SET T-INDEX TO 1
  6007     ELSE
  6008        SET T-INDEX              TO PI-LINE-SELECTED
  6009        MOVE AL-UANON            TO MAINTA.
  6010
  6011     IF PI-2ND-PAGE
  6012         SET T-INDEX UP BY 8
  6013     ELSE
  6014     IF PI-3RD-PAGE
  6015         SET T-INDEX UP BY 16
  6016     ELSE
  6017     IF PI-LST-PAGE
  6018         SET T-INDEX UP BY 24.
  6019
  6020     MOVE PI-ACCT-CARRIER        TO CARRI.
  6021     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6022     MOVE PI-ACCT-STATE          TO STATEI.
  6023     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6024
  6025     IF PI-ACCT-EXP-DT = LOW-VALUES
  6026        MOVE SPACES              TO EXPDTEI
  6027     ELSE
  6028        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6029           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6030           MOVE SPACE               TO DC-OPTION-CODE
  6031           PERFORM 9700-DATE-LINK
  6032           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6033        ELSE
  6034           MOVE 999999              TO EXPDTEO
  6035           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6036
  6037***DMD CUSTOM CODE *****START
  6038     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 115
* EL6501.cbl
  6039     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6040     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6041     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6042        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6043     ELSE
  6044        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6045***DMD CUSTOM CODE *****END
  6046
  6047     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6048     MOVE SPACE                   TO DC-OPTION-CODE.
  6049     PERFORM 9700-DATE-LINK.
  6050     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6051
  6052 0700-EXIT.
  6053      EXIT.
  6054
  6055 0800-CHECK-MAINT.
  6056     IF PI-MAINT = 'A'
  6057        IF PI-RECORD-NOT-CREATED
  6058           MOVE ER-2071          TO EMI-ERROR
  6059           MOVE  -1              TO NAMEL
  6060           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6061           GO TO 8200-SEND-DATAONLY.
  6062
  6063     IF  EIBAID = DFHPF1
  6064             AND
  6065         CREDIT-SESSION
  6066         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6067         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6068         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6069         MOVE PI-ACCT-STATE      TO PI-STATE
  6070         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6071         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6072         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6073         MOVE XCTL-689           TO PGM-NAME
  6074         GO TO 9300-XCTL.
  6075
  6076     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6077         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6078         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6079         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6080         MOVE PI-ACCT-STATE      TO PI-STATE
  6081         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6082         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6083         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6084         MOVE XCTL-690           TO PGM-NAME
  6085         GO TO 9300-XCTL
  6086     END-IF.
  6087
  6088     IF EIBAID = DFHPF3
  6089             AND
  6090         CREDIT-SESSION
  6091         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6092         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6093         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6094         MOVE PI-ACCT-STATE      TO PI-STATE
  6095         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6096         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 116
* EL6501.cbl
  6097         MOVE XCTL-653           TO PGM-NAME
  6098         GO TO 9300-XCTL.
  6099
  6100     IF EIBAID = DFHPF4
  6101         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6102         MOVE XCTL-652           TO PGM-NAME
  6103         GO TO 9300-XCTL.
  6104
  6105     IF EIBAID = DFHPF5
  6106         MOVE XCTL-6502          TO PGM-NAME
  6107         GO TO 9300-XCTL.
  6108
  6109     IF EIBAID = DFHPF7
  6110         MOVE XCTL-6504          TO PGM-NAME
  6111         GO TO 9300-XCTL.
  6112
  6113     IF EIBAID = DFHPF8
  6114         MOVE XCTL-6506          TO PGM-NAME
  6115         GO TO 9300-XCTL.
  6116
  6117     IF EIBAID = DFHPF9
  6118        MOVE XCTL-6505           TO PGM-NAME
  6119        GO TO 9300-XCTL.
  6120
  6121     IF EIBAID = DFHPF10
  6122        IF PI-COMPANY-ID = 'DMD'
  6123           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6124           MOVE XCTL-608         TO PGM-NAME
  6125           GO TO 9300-XCTL.
  6126
  6127     MOVE ER-0029                TO EMI-ERROR.
  6128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6129     MOVE AL-UNBON               TO PFENTERA.
  6130     MOVE -1                     TO PFENTERL.
  6131     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 117
* EL6501.cbl
  6133 1000-ADD-A-RECORD.
  6134     IF PI-MAINT = 'A'
  6135        PERFORM 4000-EDITS THRU 4900-EXIT
  6136     ELSE
  6137        MOVE ER-2180             TO EMI-ERROR
  6138        MOVE -1                  TO MAINTL
  6139        MOVE AL-UABON            TO MAINTA
  6140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6141
  6142     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6143        EMI-FATAL-CTR    GREATER ZERO
  6144         GO TO 8200-SEND-DATAONLY.
  6145
  6146
  6147* EXEC CICS GETMAIN
  6148*         LENGTH   (ACCT-REC-LEN)
  6149*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6150*         INITIMG  (GETMAIN-SPACE)
  6151*    END-EXEC.
  6152*    MOVE ',"IL                  $   #00006117' TO DFHEIV0
  6153     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6155     MOVE X'2020233030303036313137' TO DFHEIV0(25:11)
  6156     CALL 'kxdfhei1' USING DFHEIV0,
  6157           DFHEIV20,
  6158           ACCT-REC-LEN,
  6159           GETMAIN-SPACE
  6160     SET ADDRESS OF ACCOUNT-MASTER TO
  6161         DFHEIV20
  6162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6163
  6164
  6165     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6166                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6167                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6168                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6169                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6170                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6171
  6172     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6173                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6174                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6175                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6176                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6177                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6178                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6179                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6180
  6181     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6182                                    AM-AGT-COMMS (2)
  6183                                    AM-AGT-COMMS (3)
  6184                                    AM-AGT-COMMS (4)
  6185                                    AM-AGT-COMMS (5)
  6186                                    AM-AGT-COMMS (6)
  6187                                    AM-AGT-COMMS (7)
  6188                                    AM-AGT-COMMS (8)
  6189                                    AM-AGT-COMMS (9)
  6190                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 118
* EL6501.cbl
  6191
  6192     IF PI-COMPANY-ID = 'FLI'
  6193         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6194                                    AM-FLI-BANK-1ST-6-PREM
  6195                                    AM-FLI-BANK-CAP-AMT
  6196                                    AM-FLI-AGT-SHARE-PCT (1)
  6197                                    AM-FLI-AGT-SHARE-PCT (2)
  6198                                    AM-FLI-AGT-SHARE-PCT (3)
  6199                                    AM-FLI-AGT-SHARE-PCT (4)
  6200                                    AM-FLI-AGT-SHARE-PCT (5)
  6201                                    AM-FLI-AGT-SHARE-PCT (6)
  6202                                    AM-FLI-AGT-SHARE-PCT (7)
  6203                                    AM-FLI-AGT-SHARE-PCT (8)
  6204                                    AM-FLI-AGT-SHARE-PCT (9)
  6205                                    AM-FLI-AGT-SHARE-PCT (10).
  6206
  6207     MOVE ZEROS                  TO AM-GPCD
  6208                                    AM-LF-RET
  6209                                    AM-AH-RET
  6210                                    AM-LF-OB-RATE
  6211                                    AM-LF-OB-RATE-JNT
  6212                                    AM-AH-OB-RATE
  6213                                    AM-AH-OB-RATE-JNT
  6214                                    AM-REI-FEE-LF
  6215                                    AM-REI-FEE-AH
  6216                                    AM-REI-LF-TAX
  6217                                    AM-REI-PR-PCT
  6218                                    AM-REI-78-PCT
  6219                                    AM-REI-AH-TAX
  6220                                    AM-TOL-PREM
  6221                                    AM-TOL-REF
  6222                                    AM-CLP-TOL-PCT
  6223                                    AM-TOL-CLM
  6224                                    AM-CERTS-PURGED-DATE
  6225                                    AM-HI-CERT-DATE
  6226                                    AM-LO-CERT-DATE
  6227                                    AM-1ST-PROD-DATE
  6228                                    AM-GPCD
  6229                                    AM-CAL-TABLE
  6230                                    AM-LF-DEVIATION
  6231                                    AM-LF-DEVIATION-PCT
  6232                                    AM-AH-DEVIATION
  6233                                    AM-AH-DEVIATION-PCT
  6234                                    AM-ANNIVERSARY-DATE
  6235                                    AM-TEL-NO
  6236                                    AM-ENTRY-DATE
  6237                                    AM-INACTIVE-DATE
  6238                                    AM-RET-MIN-LOSS-L
  6239                                    AM-RET-MIN-LOSS-A
  6240                                    AM-LF-RPT021-EXP-PCT
  6241                                    AM-AH-RPT021-EXP-PCT
  6242                                    AM-MAX-MON-BEN
  6243                                    AM-MAX-TOT-BEN
  6244                                    AM-DCC-MAX-MARKETING-FEE
  6245                                    AM-SPP-LEASE-COMM
  6246                                    AM-RETRO-QUALIFY-LIMIT
  6247                                    AM-RETRO-RET-PCT-LF (1)
  6248                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 119
* EL6501.cbl
  6249                                    AM-RETRO-RET-PCT-LF (3)
  6250                                    AM-RETRO-RET-THRU-LF (1)
  6251                                    AM-RETRO-RET-THRU-LF (2)
  6252                                    AM-RETRO-RET-THRU-LF (3)
  6253                                    AM-RETRO-RET-PCT-AH (1)
  6254                                    AM-RETRO-RET-PCT-AH (2)
  6255                                    AM-RETRO-RET-PCT-AH (3)
  6256                                    AM-RETRO-RET-THRU-AH (1)
  6257                                    AM-RETRO-RET-THRU-AH (2)
  6258                                    AM-RETRO-RET-THRU-AH (3).
  6259
  6260     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6261        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6262     END-IF
  6263     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6264                                    AM-AR-HI-CERT-DATE.
  6265
  6266     MOVE 'AM'                   TO AM-RECORD-ID.
  6267     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6268                                    AM-CONTROL-BY-VAR-GRP.
  6269
  6270     IF ST-ACCNT-CNTL
  6271        MOVE SPACES              TO AM-VG-CARRIER
  6272                                    AM-VG-GROUPING.
  6273     IF CARR-ST-ACCNT-CNTL
  6274        MOVE SPACES              TO AM-VG-GROUPING.
  6275
  6276     IF ACCNT-CNTL
  6277        MOVE SPACES              TO AM-VG-CARRIER
  6278                                    AM-VG-STATE
  6279                                    AM-VG-GROUPING.
  6280
  6281     IF CARR-ACCNT-CNTL
  6282        MOVE SPACES              TO AM-VG-STATE
  6283                                    AM-VG-GROUPING.
  6284
  6285     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6286     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6287     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6288
  6289     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6290     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6291     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6292
  6293     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6294
  6295     IF PI-COMPANY-ID = 'NCL'
  6296         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6297
  6298     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6299        EMI-FATAL-CTR    GREATER ZERO
  6300         GO TO 8200-SEND-DATAONLY.
  6301
  6302     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6303        IF CLPSTL <= ZEROS
  6304           MOVE ER-0144          TO  EMI-ERROR
  6305           MOVE -1               TO  CLPSTL
  6306           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 120
* EL6501.cbl
  6307           PERFORM 9900-ERROR-FORMAT
  6308                                 THRU  9900-EXIT
  6309           GO TO 8200-SEND-DATAONLY
  6310        END-IF
  6311     END-IF
  6312     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6313     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6314
  6315     MOVE +1 TO AXRF-SUB
  6316                COMM-WORK-SUB.
  6317
  6318     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6319     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6320
  6321     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6322
  6323     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6324         NEXT SENTENCE
  6325     ELSE
  6326         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6327
  6328
  6329* EXEC CICS WRITE
  6330*        FROM      (ACCOUNT-MASTER)
  6331*        RIDFLD    (AM-CONTROL-PRIMARY)
  6332*        DATASET   (ACCT-FILE-ID)
  6333*    END-EXEC.
  6334     MOVE LENGTH OF
  6335      ACCOUNT-MASTER
  6336       TO DFHEIV11
  6337*    MOVE '&$ L                  ''   #00006286' TO DFHEIV0
  6338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6340     MOVE X'2020233030303036323836' TO DFHEIV0(25:11)
  6341     CALL 'kxdfhei1' USING DFHEIV0,
  6342           ACCT-FILE-ID,
  6343           ACCOUNT-MASTER,
  6344           DFHEIV11,
  6345           AM-CONTROL-PRIMARY,
  6346           DFHEIV99,
  6347           DFHEIV99
  6348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6349
  6350
  6351     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6352
  6353     MOVE PI-MAINT               TO PI-SV-MAINT.
  6354     MOVE 'C'                    TO PI-MAINT.
  6355     MOVE LOW-VALUES             TO EL6501AI.
  6356
  6357     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6358     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6359     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6360
  6361     IF PI-COMPANY-ID = 'NCL'
  6362         MOVE ER-4011            TO EMI-ERROR
  6363      ELSE
  6364         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 121
* EL6501.cbl
  6365
  6366     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6367
  6368     MOVE -1                     TO MAINTL.
  6369     MOVE AL-UANON               TO MAINTA.
  6370     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6371     GO TO 8100-SEND-INITIAL-MAP.
  6372
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 122
* EL6501.cbl
  6374 1500-ADD-COMP.
  6375
  6376* EXEC CICS GETMAIN
  6377*         LENGTH   (COMP-REC-LEN)
  6378*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6379*         INITIMG  (GETMAIN-SPACE)
  6380*    END-EXEC.
  6381*    MOVE ',"IL                  $   #00006316' TO DFHEIV0
  6382     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6384     MOVE X'2020233030303036333136' TO DFHEIV0(25:11)
  6385     CALL 'kxdfhei1' USING DFHEIV0,
  6386           DFHEIV20,
  6387           COMP-REC-LEN,
  6388           GETMAIN-SPACE
  6389     SET ADDRESS OF COMPENSATION-MASTER TO
  6390         DFHEIV20
  6391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6392
  6393
  6394     MOVE SPACES                 TO COMPENSATION-MASTER.
  6395     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6396                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6397                   CO-OV30         CO-OV60      CO-OV90
  6398                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6399                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6400                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6401                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6402                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6403                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6404                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6405                   CO-CURRENT-CUR-PMT
  6406                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6407                   CO-ACT-YEAR        CO-ACT-MONTH
  6408                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6409                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6410                   CO-CURRENT-LAST-STMT-YEAR
  6411                   CO-CURRENT-LAST-STMT-MONTH
  6412                   CO-CURRENT-LAST-STMT-DAY
  6413                   CO-YTD-PAID-COM
  6414                   CO-YTD-PAID-OV
  6415                   co-ov120 co-current-ov120
  6416
  6417     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6418     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6419     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6420     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6421     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6422
  6423     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6424         MOVE ZEROS              TO CO-CARRIER
  6425     ELSE
  6426         MOVE AM-CARRIER         TO CO-CARRIER.
  6427
  6428     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6429         MOVE ZEROS              TO CO-GROUPING
  6430     ELSE
  6431         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 123
* EL6501.cbl
  6432
  6433     MOVE 'CO'                   TO CO-RECORD-ID
  6434     MOVE 'A'                    TO CO-TYPE.
  6435     MOVE AM-NAME                TO CO-ACCT-NAME.
  6436     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6437     MOVE AM-ADDRS               TO CO-ADDR-1.
  6438*    MOVE AM-CITY                TO CO-ADDR-3.
  6439     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6440     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6441     MOVE AM-ZIP                 TO CO-ZIP.
  6442     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6443     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6444
  6445     IF PI-COMPANY-ID = 'NCL'
  6446         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6447         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6448                         'X' OR 'I'
  6449             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6450             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6451         ELSE
  6452             MOVE SPACE          TO  CO-TYPE-AGENT
  6453             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6454     ELSE
  6455         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6456
  6457     IF AM-REMIT-TO NOT = ZERO
  6458         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6459       ELSE
  6460         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6461
  6462     MOVE +0                      TO AGT-SUB.
  6463
  6464     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6465
  6466     IF VALID-AGT-SW = 'Y'
  6467         NEXT SENTENCE
  6468     ELSE
  6469         GO TO 1500-EXIT.
  6470
  6471     IF CO-RESP-NO = CO-ACCOUNT
  6472         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6473     ELSE
  6474         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6475
  6476     IF PI-AR-PROCESSING
  6477        MOVE 'G'                   TO CO-AR-REPORTING
  6478        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6479        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6480        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6481
  6482     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6483        MOVE 'N'                   TO CO-AR-REPORTING.
  6484
  6485     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6486        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6487
  6488     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6489
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 124
* EL6501.cbl
  6490
  6491* EXEC CICS HANDLE CONDITION
  6492*         DUPREC   (1500-EXIT)
  6493*    END-EXEC.
  6494*    MOVE '"$%                   ! # #00006418' TO DFHEIV0
  6495     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6497     MOVE X'2320233030303036343138' TO DFHEIV0(25:11)
  6498     CALL 'kxdfhei1' USING DFHEIV0
  6499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6500
  6501
  6502
  6503* EXEC CICS WRITE
  6504*        FROM      (COMPENSATION-MASTER)
  6505*        RIDFLD    (CO-CONTROL-PRIMARY)
  6506*        DATASET   (COMP-FILE-ID)
  6507*    END-EXEC.
  6508     MOVE LENGTH OF
  6509      COMPENSATION-MASTER
  6510       TO DFHEIV11
  6511*    MOVE '&$ L                  ''   #00006422' TO DFHEIV0
  6512     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6513     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6514     MOVE X'2020233030303036343232' TO DFHEIV0(25:11)
  6515     CALL 'kxdfhei1' USING DFHEIV0,
  6516           COMP-FILE-ID,
  6517           COMPENSATION-MASTER,
  6518           DFHEIV11,
  6519           CO-CONTROL-PRIMARY,
  6520           DFHEIV99,
  6521           DFHEIV99
  6522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6523
  6524
  6525 1500-EXIT.
  6526      EXIT.
  6527
  6528 1600-FIND-C-AGT.
  6529     ADD 1 TO  AGT-SUB.
  6530     IF AGT-SUB GREATER 10
  6531         MOVE 'N'                TO  VALID-AGT-SW
  6532         GO TO 1600-EXIT.
  6533
  6534************************************************************
  6535**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6536************************************************************
  6537
  6538     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6539         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6540         MOVE 'Y'                TO  VALID-AGT-SW
  6541         GO TO 1600-EXIT
  6542     ELSE
  6543         GO TO 1600-FIND-C-AGT.
  6544
  6545 1600-EXIT.
  6546     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 125
* EL6501.cbl
  6548 1700-CHANGE-COMP.
  6549     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6550     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6551
  6552     IF PI-ZERO-CARRIER
  6553       OR PI-ZERO-CAR-GROUP
  6554         MOVE ZEROS              TO COMP-CARRIER
  6555     ELSE
  6556         MOVE AM-CARRIER         TO COMP-CARRIER.
  6557
  6558     IF PI-ZERO-GROUPING
  6559       OR PI-ZERO-CAR-GROUP
  6560         MOVE ZEROS              TO COMP-GROUPING
  6561     ELSE
  6562         MOVE AM-GROUPING        TO COMP-GROUPING.
  6563
  6564     IF AM-REMIT-TO NOT = ZERO
  6565         MOVE AM-AGT (AM-REMIT-TO)
  6566                                 TO COMP-RESP-NO
  6567     ELSE
  6568         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6569
  6570     MOVE ZERO                   TO AGT-SUB.
  6571
  6572     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6573
  6574     IF VALID-AGT-SW = 'Y'
  6575         NEXT SENTENCE
  6576     ELSE
  6577         GO TO 1799-EXIT.
  6578
  6579     MOVE 'A'                    TO COMP-TYPE.
  6580
  6581
  6582* EXEC CICS HANDLE CONDITION
  6583*         ENDFILE     (1799-EXIT)
  6584*         NOTFND      (1799-EXIT)
  6585*    END-EXEC.
  6586*    MOVE '"$''I                  ! $ #00006484' TO DFHEIV0
  6587     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6589     MOVE X'2420233030303036343834' TO DFHEIV0(25:11)
  6590     CALL 'kxdfhei1' USING DFHEIV0
  6591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6592
  6593
  6594
  6595* EXEC CICS READ
  6596*        UPDATE
  6597*        DATASET   (COMP-FILE-ID)
  6598*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6599*        RIDFLD    (COMP-KEY)
  6600*    END-EXEC.
  6601*    MOVE '&"S        EU         (   #00006489' TO DFHEIV0
  6602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6604     MOVE X'2020233030303036343839' TO DFHEIV0(25:11)
  6605     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 126
* EL6501.cbl
  6606           COMP-FILE-ID,
  6607           DFHEIV20,
  6608           DFHEIV99,
  6609           COMP-KEY,
  6610           DFHEIV99,
  6611           DFHEIV99,
  6612           DFHEIV99
  6613     SET ADDRESS OF COMPENSATION-MASTER TO
  6614         DFHEIV20
  6615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6616
  6617
  6618     IF (ON-LAST-DATE-RANGE)
  6619        IF NAMEL GREATER ZEROS
  6620           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6621           MOVE AM-NAME          TO CO-ACCT-NAME
  6622        END-IF
  6623        IF INCAREL GREATER ZEROS
  6624           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6625           MOVE AM-PERSON        TO CO-MAIL-NAME
  6626        END-IF
  6627        IF ADDR1L GREATER ZEROS
  6628           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6629           MOVE AM-ADDRS         TO CO-ADDR-1
  6630        END-IF
  6631        IF ACITYL  GREATER ZEROS
  6632           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6633           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6634        END-IF
  6635        IF ASTATEL  GREATER ZEROS
  6636           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6637           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6638        END-IF
  6639        IF ZIPL GREATER ZEROS
  6640           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6641           MOVE AM-ZIP           TO CO-ZIP
  6642        END-IF
  6643        IF CSRL GREATER ZEROS
  6644           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6645           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6646        END-IF
  6647        IF PHONEL GREATER ZEROS
  6648           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6649           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6650        END-IF
  6651        IF TAXNOL GREATER ZEROS
  6652           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6653           MOVE AM-ID-NO         TO CO-SOC-SEC
  6654        END-IF
  6655        IF AUTO-CANCEL-ACCOUNT
  6656           IF CO-BILL-SW = ' '
  6657              MOVE 'B'           TO CO-BILL-SW
  6658              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6659           END-IF
  6660        END-IF
  6661     END-IF
  6662
  6663     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 127
* EL6501.cbl
  6664         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6665         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6666     END-IF
  6667
  6668     IF CHANGE-WAS-MADE
  6669         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6670         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6671         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6672
  6673     IF NAMEL GREATER THAN ZERO
  6674         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6675
  6676
  6677* EXEC CICS REWRITE
  6678*        FROM      (COMPENSATION-MASTER)
  6679*        DATASET   (COMP-FILE-ID)
  6680*    END-EXEC.
  6681     MOVE LENGTH OF
  6682      COMPENSATION-MASTER
  6683       TO DFHEIV11
  6684*    MOVE '&& L                  %   #00006554' TO DFHEIV0
  6685     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6687     MOVE X'2020233030303036353534' TO DFHEIV0(25:11)
  6688     CALL 'kxdfhei1' USING DFHEIV0,
  6689           COMP-FILE-ID,
  6690           COMPENSATION-MASTER,
  6691           DFHEIV11,
  6692           DFHEIV99
  6693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6694
  6695
  6696 1799-EXIT.
  6697     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 128
* EL6501.cbl
  6699 1800-FIND-C-AGT.
  6700     ADD 1                       TO  AGT-SUB.
  6701
  6702     IF AGT-SUB GREATER 10
  6703         MOVE 'N'                TO  VALID-AGT-SW
  6704         GO TO 1899-EXIT.
  6705
  6706************************************************************
  6707**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6708************************************************************
  6709
  6710     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6711         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6712         MOVE 'Y'                TO  VALID-AGT-SW
  6713         GO TO 1899-EXIT
  6714     ELSE
  6715         GO TO 1800-FIND-C-AGT.
  6716
  6717 1899-EXIT.
  6718     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 129
* EL6501.cbl
  6720 2000-CHANGE-A-RECORD.
  6721     PERFORM 4000-EDITS THRU 4900-EXIT.
  6722
  6723     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6724        EMI-FATAL-CTR    GREATER ZERO
  6725         GO TO 8200-SEND-DATAONLY.
  6726
  6727
  6728* EXEC CICS READ
  6729*        UPDATE
  6730*        DATASET   (ACCT-FILE-ID)
  6731*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6732*        RIDFLD    (PI-ACCT-KEY)
  6733*    END-EXEC.
  6734*    MOVE '&"S        EU         (   #00006590' TO DFHEIV0
  6735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6736     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6737     MOVE X'2020233030303036353930' TO DFHEIV0(25:11)
  6738     CALL 'kxdfhei1' USING DFHEIV0,
  6739           ACCT-FILE-ID,
  6740           DFHEIV20,
  6741           DFHEIV99,
  6742           PI-ACCT-KEY,
  6743           DFHEIV99,
  6744           DFHEIV99,
  6745           DFHEIV99
  6746     SET ADDRESS OF ACCOUNT-MASTER TO
  6747         DFHEIV20
  6748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6749
  6750
  6751     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6752
  6753     IF NOT PI-AR-PROCESSING
  6754        GO TO 2075-PROCESS-CHANGE.
  6755
  6756     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6757     MOVE +0                     TO SUB1.
  6758
  6759 2075-PROCESS-CHANGE.
  6760     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6761
  6762     IF PI-AR-PROCESSING
  6763        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6764
  6765     IF PI-COMPANY-ID = 'DMD'
  6766     IF AM-ANNIVERSARY-DATE = ZEROS
  6767           MOVE ER-0852             TO EMI-ERROR
  6768           MOVE -1                  TO CONTRL
  6769           MOVE AL-UABON            TO CONTRA
  6770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6771
  6772     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6773        EMI-FATAL-CTR    GREATER ZERO
  6774         GO TO 8200-SEND-DATAONLY.
  6775
  6776     MOVE +1                     TO AXRF-SUB
  6777                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 130
* EL6501.cbl
  6778     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6779
  6780     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6781     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6782     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6783
  6784     IF ((PI-FST-PAGE)
  6785        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6786                      OR
  6787        ((PI-2ND-PAGE)
  6788        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6789                      OR
  6790        ((PI-3RD-PAGE)
  6791        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6792                      OR
  6793        ((PI-LST-PAGE)
  6794        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6795        SET ON-LAST-DATE-RANGE   TO TRUE
  6796     END-IF
  6797     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6798         NEXT SENTENCE
  6799     ELSE
  6800         IF (ON-LAST-DATE-RANGE)
  6801                          OR
  6802            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6803             (PCONTL > ZERO))
  6804             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6805
  6806     IF NAMEL GREATER THAN ZERO
  6807         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6808
  6809
  6810* EXEC CICS REWRITE
  6811*        FROM      (ACCOUNT-MASTER)
  6812*        DATASET   (ACCT-FILE-ID)
  6813*    END-EXEC.
  6814     MOVE LENGTH OF
  6815      ACCOUNT-MASTER
  6816       TO DFHEIV11
  6817*    MOVE '&& L                  %   #00006655' TO DFHEIV0
  6818     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6819     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6820     MOVE X'2020233030303036363535' TO DFHEIV0(25:11)
  6821     CALL 'kxdfhei1' USING DFHEIV0,
  6822           ACCT-FILE-ID,
  6823           ACCOUNT-MASTER,
  6824           DFHEIV11,
  6825           DFHEIV99
  6826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6827
  6828
  6829     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6830
  6831     IF CSRL GREATER ZEROS
  6832         GO TO 3500-CHANGE-ALL-CSR.
  6833
  6834     MOVE ER-0000                TO EMI-ERROR.
  6835     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 131
* EL6501.cbl
  6836     MOVE LOW-VALUES             TO EL6501AI.
  6837
  6838     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6839     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6840     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6841
  6842     MOVE ER-0000                TO EMI-ERROR.
  6843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6844
  6845     MOVE -1                     TO MAINTL.
  6846     MOVE AL-UANON               TO MAINTA.
  6847     GO TO 8100-SEND-INITIAL-MAP.
  6848
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 132
* EL6501.cbl
  6850 2100-ADD-ACCOUNT-NAME.
  6851
  6852* EXEC CICS HANDLE CONDITION
  6853*         DUPREC   (2100-EXIT)
  6854*    END-EXEC.
  6855*    MOVE '"$%                   ! % #00006682' TO DFHEIV0
  6856     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6858     MOVE X'2520233030303036363832' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0
  6860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6861
  6862
  6863
  6864* EXEC CICS GETMAIN
  6865*         LENGTH   (NAME-REC-LEN)
  6866*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6867*         INITIMG  (GETMAIN-SPACE)
  6868*    END-EXEC.
  6869*    MOVE ',"IL                  $   #00006686' TO DFHEIV0
  6870     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6871     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6872     MOVE X'2020233030303036363836' TO DFHEIV0(25:11)
  6873     CALL 'kxdfhei1' USING DFHEIV0,
  6874           DFHEIV20,
  6875           NAME-REC-LEN,
  6876           GETMAIN-SPACE
  6877     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6878         DFHEIV20
  6879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6880
  6881
  6882     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6883     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6884     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6885     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6886     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6887     MOVE AM-NAME                TO  NL-NAME.
  6888     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6889        MOVE NL-NAME (5:26)      TO NL-NAME
  6890     END-IF
  6891     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6892     MOVE AM-ADDR-STATE          TO  NL-ST.
  6893     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6894     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6895     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6896     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6897     MOVE AM-STATE               TO  NL-AM-STATE.
  6898     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6899
  6900
  6901* EXEC CICS WRITE
  6902*        FROM      (NAME-LOOKUP-MASTER)
  6903*        RIDFLD    (NL-CONTROL-PRIMARY)
  6904*        DATASET   (NAME-FILE-ID)
  6905*    END-EXEC.
  6906     MOVE LENGTH OF
  6907      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 133
* EL6501.cbl
  6908       TO DFHEIV11
  6909*    MOVE '&$ L                  ''   #00006710' TO DFHEIV0
  6910     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6911     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6912     MOVE X'2020233030303036373130' TO DFHEIV0(25:11)
  6913     CALL 'kxdfhei1' USING DFHEIV0,
  6914           NAME-FILE-ID,
  6915           NAME-LOOKUP-MASTER,
  6916           DFHEIV11,
  6917           NL-CONTROL-PRIMARY,
  6918           DFHEIV99,
  6919           DFHEIV99
  6920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6921
  6922
  6923 2100-EXIT.
  6924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 134
* EL6501.cbl
  6926 2200-ADD-COMPENSATION-NAME.
  6927
  6928* EXEC CICS HANDLE CONDITION
  6929*         DUPREC   (2200-EXIT)
  6930*    END-EXEC.
  6931*    MOVE '"$%                   ! & #00006720' TO DFHEIV0
  6932     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6934     MOVE X'2620233030303036373230' TO DFHEIV0(25:11)
  6935     CALL 'kxdfhei1' USING DFHEIV0
  6936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6937
  6938
  6939
  6940* EXEC CICS GETMAIN
  6941*         LENGTH   (NAME-REC-LEN)
  6942*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6943*         INITIMG  (GETMAIN-SPACE)
  6944*    END-EXEC.
  6945*    MOVE ',"IL                  $   #00006724' TO DFHEIV0
  6946     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6947     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6948     MOVE X'2020233030303036373234' TO DFHEIV0(25:11)
  6949     CALL 'kxdfhei1' USING DFHEIV0,
  6950           DFHEIV20,
  6951           NAME-REC-LEN,
  6952           GETMAIN-SPACE
  6953     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6954         DFHEIV20
  6955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6956
  6957
  6958     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6959     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6960     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6961     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6962     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6963     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6964     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6965        MOVE NL-NAME (5:26)      TO NL-NAME
  6966     END-IF
  6967     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6968     MOVE CO-ADDR-STATE          TO  NL-ST
  6969     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6970     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6971     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6972     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6973     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6974     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6975     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6976
  6977
  6978* EXEC CICS WRITE
  6979*        FROM      (NAME-LOOKUP-MASTER)
  6980*        RIDFLD    (NL-CONTROL-PRIMARY)
  6981*        DATASET   (NAME-FILE-ID)
  6982*    END-EXEC.
  6983     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 135
* EL6501.cbl
  6984      NAME-LOOKUP-MASTER
  6985       TO DFHEIV11
  6986*    MOVE '&$ L                  ''   #00006749' TO DFHEIV0
  6987     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6989     MOVE X'2020233030303036373439' TO DFHEIV0(25:11)
  6990     CALL 'kxdfhei1' USING DFHEIV0,
  6991           NAME-FILE-ID,
  6992           NAME-LOOKUP-MASTER,
  6993           DFHEIV11,
  6994           NL-CONTROL-PRIMARY,
  6995           DFHEIV99,
  6996           DFHEIV99
  6997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6998
  6999
  7000 2200-EXIT.
  7001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 136
* EL6501.cbl
  7003 3000-CHANGE-ALL-RECORDS.
  7004     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  7005     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7006
  7007
  7008* EXEC CICS HANDLE CONDITION
  7009*         ENDFILE     (3030-END-FILE)
  7010*    END-EXEC.
  7011*    MOVE '"$''                   ! '' #00006762' TO DFHEIV0
  7012     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7014     MOVE X'2720233030303036373632' TO DFHEIV0(25:11)
  7015     CALL 'kxdfhei1' USING DFHEIV0
  7016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7017
  7018
  7019     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7020
  7021 3010-READ-NEXT.
  7022     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7023
  7024     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7025        GO TO 3030-END-FILE.
  7026
  7027
  7028* EXEC CICS ENDBR
  7029*        DATASET   (ACCT-FILE-ID)
  7030*    END-EXEC.
  7031     MOVE 0
  7032       TO DFHEIV11
  7033*    MOVE '&2                    $   #00006774' TO DFHEIV0
  7034     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7035     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7036     MOVE X'2020233030303036373734' TO DFHEIV0(25:11)
  7037     CALL 'kxdfhei1' USING DFHEIV0,
  7038           ACCT-FILE-ID,
  7039           DFHEIV11,
  7040           DFHEIV99
  7041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7042
  7043     ADD +1                      TO WS-CHANGE-ALL-CNT
  7044
  7045* EXEC CICS READ
  7046*        UPDATE
  7047*        DATASET   (ACCT-FILE-ID)
  7048*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7049*        RIDFLD    (WS-KEY-SAVE)
  7050*    END-EXEC.
  7051*    MOVE '&"S        EU         (   #00006778' TO DFHEIV0
  7052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7053     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7054     MOVE X'2020233030303036373738' TO DFHEIV0(25:11)
  7055     CALL 'kxdfhei1' USING DFHEIV0,
  7056           ACCT-FILE-ID,
  7057           DFHEIV20,
  7058           DFHEIV99,
  7059           WS-KEY-SAVE,
  7060           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 137
* EL6501.cbl
  7061           DFHEIV99,
  7062           DFHEIV99
  7063     SET ADDRESS OF ACCOUNT-MASTER TO
  7064         DFHEIV20
  7065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7066
  7067
  7068     IF NAMEL    GREATER THAN ZERO  OR
  7069        INCAREL  GREATER THAN ZERO  OR
  7070        ADDR1L   GREATER THAN ZERO  OR
  7071        ACITYL   GREATER THAN ZERO  OR
  7072        ASTATEL  GREATER THAN ZERO  OR
  7073        ZIPL     GREATER THAN ZERO  OR
  7074        CLPTOLPL GREATER THAN ZERO  OR
  7075        PHONEL   GREATER THAN ZERO
  7076         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7077
  7078     IF STATUSL > ZERO
  7079        EVALUATE TRUE
  7080           WHEN STATUSI = 'A'
  7081              MOVE '0'           TO AM-STATUS
  7082           WHEN STATUSI = 'I'
  7083              MOVE '1'           TO AM-STATUS
  7084           WHEN (STATUSI = 'C')
  7085              AND (AM-STATUS NOT = '3' AND 'C')
  7086              MOVE '3'           TO AM-STATUS
  7087              SET AUTO-CANCEL-ACCOUNT
  7088                                 TO TRUE
  7089           WHEN (STATUSI = 'C')
  7090              MOVE '3'           TO AM-STATUS
  7091           WHEN STATUSI = 'F'
  7092              MOVE '4'           TO AM-STATUS
  7093           WHEN STATUSI = 'S'
  7094              MOVE '5'           TO AM-STATUS
  7095           WHEN STATUSI = 'D'
  7096              MOVE '6'           TO AM-STATUS
  7097           WHEN STATUSI = 'L'
  7098              MOVE '7'           TO AM-STATUS
  7099           WHEN STATUSI = 'R'
  7100              MOVE '8'           TO AM-STATUS
  7101           WHEN STATUSI = 'P'
  7102              MOVE '9'           TO AM-STATUS
  7103           WHEN OTHER
  7104              MOVE -1            TO STATUSL
  7105              MOVE AL-UABON      TO STATUSA
  7106              MOVE ER-2153       TO EMI-ERROR
  7107              PERFORM 9900-ERROR-FORMAT
  7108                                 THRU 9900-EXIT
  7109        END-EVALUATE
  7110     END-IF
  7111*    IF STATUSL > ZERO
  7112*       IF STATUSI = 'A'
  7113*          MOVE '0'              TO AM-STATUS
  7114*       ELSE
  7115*          IF STATUSI = 'I'
  7116*             MOVE '1'           TO AM-STATUS
  7117*          ELSE
  7118*             IF STATUSI = 'C'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 138
* EL6501.cbl
  7119*                IF AM-STATUS NOT = '3' AND 'C'
  7120*                   SET AUTO-CANCEL-ACCOUNT
  7121*                                TO TRUE
  7122*                END-IF
  7123*                MOVE '3'        TO AM-STATUS
  7124*             ELSE
  7125*                IF STATUSI = 'F'
  7126*                   MOVE '4'     TO AM-STATUS
  7127*                ELSE
  7128*                   MOVE -1         TO STATUSL
  7129*                   MOVE AL-UABON   TO STATUSA
  7130*                   MOVE ER-2153    TO EMI-ERROR
  7131*                   PERFORM 9900-ERROR-FORMAT
  7132*                                THRU 9900-EXIT
  7133*                END-IF
  7134*             END-IF
  7135*          END-IF
  7136*       END-IF
  7137*    END-IF
  7138
  7139     IF CSRL GREATER ZERO
  7140        MOVE CSRI                TO AM-CSR-CODE.
  7141     IF NAMEL GREATER THAN ZERO
  7142        MOVE NAMEI               TO AM-NAME.
  7143     IF PCONTL GREATER THAN ZERO
  7144        MOVE PCONTI              TO AM-CONTROL-NAME
  7145     END-IF
  7146     IF INCAREL GREATER ZEROS
  7147        MOVE INCAREI             TO AM-PERSON.
  7148     IF ADDR1L GREATER ZEROS
  7149        MOVE ADDR1I              TO AM-ADDRS.
  7150     IF ACITYL GREATER ZEROS
  7151        MOVE ACITYI             TO AM-ADDR-CITY.
  7152     IF ASTATEL GREATER ZEROS
  7153        MOVE ASTATEI            TO AM-ADDR-STATE.
  7154     IF ZIPL NOT GREATER ZEROS
  7155         GO TO 3015-CONT-CHANGING.
  7156
  7157     MOVE ZIPI                   TO WS-ZIP-CODE.
  7158
  7159     IF WS-CANADIAN-ZIP
  7160         IF WS-ZIP-4 = SPACE  OR  '-'
  7161             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7162             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7163         ELSE
  7164             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7165             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7166     ELSE
  7167         IF WS-ZIP-6 = SPACE  OR  '-'
  7168             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7169             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7170         ELSE
  7171             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7172             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7173
  7174 3015-CONT-CHANGING.
  7175
  7176     IF CLPTOLPL GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 139
* EL6501.cbl
  7177
  7178* EXEC CICS BIF
  7179*            DEEDIT
  7180*            FIELD    (CLPTOLPI)
  7181*            LENGTH   (6)
  7182*        END-EXEC
  7183     MOVE 6
  7184       TO DFHEIV11
  7185*    MOVE '@"L                   #   #00006894' TO DFHEIV0
  7186     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7187     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7188     MOVE X'2020233030303036383934' TO DFHEIV0(25:11)
  7189     CALL 'kxdfhei1' USING DFHEIV0,
  7190           CLPTOLPI,
  7191           DFHEIV11
  7192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7193         IF CLPTOLPI NUMERIC
  7194             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7195         ELSE
  7196             MOVE -1                  TO CLPTOLPL
  7197             MOVE AL-UNBON            TO CLPTOLPA
  7198             MOVE ER-1778             TO EMI-ERROR
  7199             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7200         END-IF
  7201     END-IF
  7202
  7203     IF LCOMML > ZEROS
  7204
  7205* EXEC CICS BIF
  7206*            DEEDIT
  7207*            FIELD    (LCOMMI)
  7208*            LENGTH   (8)
  7209*        END-EXEC
  7210     MOVE 8
  7211       TO DFHEIV11
  7212*    MOVE '@"L                   #   #00006910' TO DFHEIV0
  7213     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7214     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7215     MOVE X'2020233030303036393130' TO DFHEIV0(25:11)
  7216     CALL 'kxdfhei1' USING DFHEIV0,
  7217           LCOMMI,
  7218           DFHEIV11
  7219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7220         IF LCOMMI NUMERIC
  7221            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7222         ELSE
  7223            MOVE -1              TO LCOMML
  7224            MOVE AL-UNBON        TO LCOMMA
  7225            MOVE ER-1778         TO EMI-ERROR
  7226            PERFORM 9900-ERROR-FORMAT
  7227                                 THRU 9900-EXIT
  7228         END-IF
  7229     END-IF
  7230
  7231     IF PHONEL GREATER ZEROS
  7232        MOVE PHONEI              TO DEEDIT-FIELD
  7233        PERFORM 8600-DEEDIT
  7234        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 140
* EL6501.cbl
  7235        MOVE WS-PH1              TO AM-AREA-CODE
  7236        MOVE WS-PH2              TO AM-TEL-PRE
  7237        MOVE WS-PH3              TO AM-TEL-NBR.
  7238
  7239*    IF PSILFFL GREATER +0
  7240*       MOVE PSILFFI             TO DEEDIT-FIELD
  7241*       PERFORM 8600-DEEDIT
  7242*       IF DEEDIT-FIELD NUMERIC
  7243*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7244*
  7245*    IF PSIAHFL GREATER +0
  7246*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7247*       PERFORM 8600-DEEDIT
  7248*       IF DEEDIT-FIELD NUMERIC
  7249*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7250
  7251     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7252     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7253     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7254
  7255     IF ((PI-FST-PAGE)
  7256        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7257                      OR
  7258        ((PI-2ND-PAGE)
  7259        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7260                      OR
  7261        ((PI-3RD-PAGE)
  7262        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7263                      OR
  7264        ((PI-LST-PAGE)
  7265        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7266        SET ON-LAST-DATE-RANGE   TO TRUE
  7267     END-IF
  7268*    IF ((PI-FST-PAGE)
  7269*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7270*                     OR
  7271*       ((PI-2ND-PAGE)
  7272*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7273*                     OR
  7274*       ((PI-3RD-PAGE)
  7275*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7276*                     OR
  7277*       ((PI-LST-PAGE)
  7278*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7279*       SET ON-LAST-DATE-RANGE   TO TRUE
  7280*    END-IF
  7281     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7282     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7283     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7284*    EXEC CICS DELAY
  7285*       INTERVAL (WS-DELAY-INT)
  7286*    END-EXEC
  7287     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7288        CONTINUE
  7289     ELSE
  7290        IF (ON-LAST-DATE-RANGE)
  7291                   OR
  7292           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 141
* EL6501.cbl
  7293           (PCONTL > ZERO))
  7294           PERFORM 1700-CHANGE-COMP
  7295                                 THRU 1799-EXIT
  7296        END-IF
  7297     END-IF
  7298
  7299     IF NAMEL GREATER THAN ZERO
  7300         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  7301
  7302
  7303* EXEC CICS REWRITE
  7304*        FROM      (ACCOUNT-MASTER)
  7305*        DATASET   (ACCT-FILE-ID)
  7306*    END-EXEC.
  7307     MOVE LENGTH OF
  7308      ACCOUNT-MASTER
  7309       TO DFHEIV11
  7310*    MOVE '&& L                  %   #00006997' TO DFHEIV0
  7311     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7312     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7313     MOVE X'2020233030303036393937' TO DFHEIV0(25:11)
  7314     CALL 'kxdfhei1' USING DFHEIV0,
  7315           ACCT-FILE-ID,
  7316           ACCOUNT-MASTER,
  7317           DFHEIV11,
  7318           DFHEIV99
  7319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7320
  7321
  7322     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7323     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7324
  7325     GO TO 3010-READ-NEXT.
  7326
  7327 3030-END-FILE.
  7328     IF BROWSE-STARTED
  7329        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7330
  7331     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7332
  7333     IF AUTO-CANCEL-ACCOUNT
  7334
  7335* EXEC CICS GETMAIN
  7336*          LENGTH   (ERACNT-REC-LEN)
  7337*          SET      (ADDRESS OF NOTE-FILE)
  7338*          INITIMG  (GETMAIN-SPACE)
  7339*          RESP     (WS-RESPONSE)
  7340*       END-EXEC
  7341*    MOVE ',"IL                  $  N#00007014' TO DFHEIV0
  7342     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7343     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7344     MOVE X'204E233030303037303134' TO DFHEIV0(25:11)
  7345     CALL 'kxdfhei1' USING DFHEIV0,
  7346           DFHEIV20,
  7347           ERACNT-REC-LEN,
  7348           GETMAIN-SPACE
  7349     SET ADDRESS OF NOTE-FILE TO
  7350         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 142
* EL6501.cbl
  7351     MOVE EIBRESP  TO WS-RESPONSE
  7352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7353        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7354        MOVE '1'                 TO NT-RECORD-TYPE
  7355        MOVE +1                  TO NT-LINE-SEQUENCE
  7356        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7357        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7358        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
  7359        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7360                                 TO NT-NOTE-LINE
  7361        PERFORM WITH TEST AFTER UNTIL
  7362           (NOT RESP-DUPKEY)
  7363           AND (NOT RESP-DUPREC)
  7364
  7365* EXEC CICS WRITE
  7366*             FROM      (NOTE-FILE)
  7367*             RIDFLD    (NT-CONTROL-PRIMARY)
  7368*             DATASET   (ERACNT-FILE-ID)
  7369*             RESP      (WS-RESPONSE)
  7370*          END-EXEC
  7371     MOVE LENGTH OF
  7372      NOTE-FILE
  7373       TO DFHEIV11
  7374*    MOVE '&$ L                  ''  N#00007031' TO DFHEIV0
  7375     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7376     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7377     MOVE X'204E233030303037303331' TO DFHEIV0(25:11)
  7378     CALL 'kxdfhei1' USING DFHEIV0,
  7379           ERACNT-FILE-ID,
  7380           NOTE-FILE,
  7381           DFHEIV11,
  7382           NT-CONTROL-PRIMARY,
  7383           DFHEIV99,
  7384           DFHEIV99
  7385     MOVE EIBRESP  TO WS-RESPONSE
  7386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7387           IF RESP-DUPKEY OR RESP-DUPREC
  7388              ADD +1             TO NT-LINE-SEQUENCE
  7389           END-IF
  7390        END-PERFORM
  7391     END-IF
  7392     IF NOT EMI-NO-ERRORS
  7393         GO TO 8200-SEND-DATAONLY.
  7394
  7395     MOVE -1                     TO NAMEL.
  7396     MOVE ER-0000                TO EMI-ERROR.
  7397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7398     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 143
* EL6501.cbl
  7400 3500-CHANGE-ALL-CSR.
  7401     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7402     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7403                                    WS-ACCT-REST-OF-EXP.
  7404
  7405
  7406* EXEC CICS HANDLE CONDITION
  7407*         ENDFILE     (3530-END-FILE)
  7408*    END-EXEC.
  7409*    MOVE '"$''                   ! ( #00007055' TO DFHEIV0
  7410     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7412     MOVE X'2820233030303037303535' TO DFHEIV0(25:11)
  7413     CALL 'kxdfhei1' USING DFHEIV0
  7414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7415
  7416
  7417     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7418
  7419 3510-READ-NEXT.
  7420     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7421
  7422     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7423        GO TO 3530-END-FILE.
  7424
  7425
  7426* EXEC CICS ENDBR
  7427*        DATASET   (ACCT-FILE-ID)
  7428*    END-EXEC.
  7429     MOVE 0
  7430       TO DFHEIV11
  7431*    MOVE '&2                    $   #00007067' TO DFHEIV0
  7432     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7433     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7434     MOVE X'2020233030303037303637' TO DFHEIV0(25:11)
  7435     CALL 'kxdfhei1' USING DFHEIV0,
  7436           ACCT-FILE-ID,
  7437           DFHEIV11,
  7438           DFHEIV99
  7439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7440
  7441
  7442
  7443* EXEC CICS READ
  7444*        UPDATE
  7445*        DATASET   (ACCT-FILE-ID)
  7446*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7447*        RIDFLD    (WS-KEY-SAVE)
  7448*    END-EXEC.
  7449*    MOVE '&"S        EU         (   #00007071' TO DFHEIV0
  7450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7451     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7452     MOVE X'2020233030303037303731' TO DFHEIV0(25:11)
  7453     CALL 'kxdfhei1' USING DFHEIV0,
  7454           ACCT-FILE-ID,
  7455           DFHEIV20,
  7456           DFHEIV99,
  7457           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 144
* EL6501.cbl
  7458           DFHEIV99,
  7459           DFHEIV99,
  7460           DFHEIV99
  7461     SET ADDRESS OF ACCOUNT-MASTER TO
  7462         DFHEIV20
  7463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7464
  7465
  7466     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7467     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7468     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7469
  7470     MOVE CSRI                   TO AM-CSR-CODE.
  7471
  7472
  7473* EXEC CICS REWRITE
  7474*        FROM      (ACCOUNT-MASTER)
  7475*        DATASET   (ACCT-FILE-ID)
  7476*    END-EXEC.
  7477     MOVE LENGTH OF
  7478      ACCOUNT-MASTER
  7479       TO DFHEIV11
  7480*    MOVE '&& L                  %   #00007084' TO DFHEIV0
  7481     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7482     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7483     MOVE X'2020233030303037303834' TO DFHEIV0(25:11)
  7484     CALL 'kxdfhei1' USING DFHEIV0,
  7485           ACCT-FILE-ID,
  7486           ACCOUNT-MASTER,
  7487           DFHEIV11,
  7488           DFHEIV99
  7489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7490
  7491
  7492     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7493     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7494
  7495     GO TO 3510-READ-NEXT.
  7496
  7497 3530-END-FILE.
  7498     IF BROWSE-STARTED
  7499        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7500
  7501     MOVE ER-4009                TO EMI-ERROR.
  7502     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7503     MOVE LOW-VALUES             TO EL6501AI.
  7504
  7505     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7506     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7507     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7508
  7509     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7510
  7511     MOVE -1                     TO MAINTL.
  7512     MOVE AL-UANON               TO MAINTA.
  7513     GO TO 8100-SEND-INITIAL-MAP.
  7514
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 145
* EL6501.cbl
  7516 4000-EDITS.
  7517     IF PI-COMPANY-ID = 'NCL'
  7518      IF MAINTI = 'A' OR 'C'
  7519        IF CSRL GREATER ZEROS
  7520            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7521          ELSE
  7522            IF MAINTI = 'A'
  7523                MOVE ER-1883         TO EMI-ERROR
  7524                MOVE -1              TO CSRL
  7525                MOVE AL-UABON        TO CSRA
  7526                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7527
  7528     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7529        IF NAMEL NOT GREATER ZEROS
  7530           IF MAINTI = 'C'
  7531              GO TO 4070-CHECK-STATUS
  7532           ELSE
  7533              MOVE -1               TO  NAMEL
  7534              MOVE AL-UABON         TO  NAMEA
  7535              MOVE ER-2045          TO  EMI-ERROR
  7536              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7537        ELSE
  7538            GO TO 4065-CHECK-ASSOCIATES.
  7539
  7540     IF TYPEL NOT GREATER ZEROS
  7541        IF MAINTI = 'C'
  7542           GO TO 4050-CONTINUE
  7543        ELSE
  7544           GO TO 4020-BUS-TYPE-ERROR.
  7545
  7546     IF TYPEI NOT NUMERIC
  7547        GO TO 4020-BUS-TYPE-ERROR
  7548     ELSE
  7549        IF TYPEI LESS 1 OR GREATER 99
  7550           GO TO 4020-BUS-TYPE-ERROR.
  7551
  7552     MOVE SPACES                 TO ELCNTL-KEY.
  7553
  7554     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7555     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7556     MOVE '8'                    TO CNTL-REC-TYPE.
  7557     MOVE +0                     TO CNTL-SEQ-NO.
  7558
  7559
  7560* EXEC CICS HANDLE CONDITION
  7561*        NOTFND   (4020-BUS-TYPE-ERROR)
  7562*    END-EXEC.
  7563*    MOVE '"$I                   ! ) #00007156' TO DFHEIV0
  7564     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7565     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7566     MOVE X'2920233030303037313536' TO DFHEIV0(25:11)
  7567     CALL 'kxdfhei1' USING DFHEIV0
  7568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7569
  7570
  7571
  7572* EXEC CICS READ
  7573*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 146
* EL6501.cbl
  7574*        DATASET   (CNTL-FILE-ID)
  7575*        SET       (ADDRESS OF CONTROL-FILE)
  7576*        RIDFLD    (ELCNTL-KEY)
  7577*    END-EXEC.
  7578*    MOVE '&"S        G          (   #00007160' TO DFHEIV0
  7579     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7581     MOVE X'2020233030303037313630' TO DFHEIV0(25:11)
  7582     CALL 'kxdfhei1' USING DFHEIV0,
  7583           CNTL-FILE-ID,
  7584           DFHEIV20,
  7585           DFHEIV99,
  7586           ELCNTL-KEY,
  7587           DFHEIV99,
  7588           DFHEIV99,
  7589           DFHEIV99
  7590     SET ADDRESS OF CONTROL-FILE TO
  7591         DFHEIV20
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595     IF TYPEI LESS 21
  7596        MOVE TYPEI               TO WS-BUS-ENTRY
  7597     ELSE
  7598        DIVIDE TYPEI BY 20
  7599            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7600        IF WS-BUS-ENTRY = ZEROS
  7601           MOVE 20               TO WS-BUS-ENTRY.
  7602
  7603     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7604        GO TO 4050-CONTINUE.
  7605
  7606 4020-BUS-TYPE-ERROR.
  7607     MOVE -1                     TO TYPEL.
  7608     MOVE AL-UNBON               TO TYPEA.
  7609     MOVE ER-2178                TO EMI-ERROR.
  7610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7611
  7612 4050-CONTINUE.
  7613     IF ASTATEL > 0
  7614        MOVE SPACES                 TO  ELCNTL-KEY
  7615        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7616        MOVE '3'                    TO  CNTL-REC-TYPE
  7617        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7618        MOVE +0                     TO  CNTL-SEQ-NO
  7619
  7620* EXEC CICS  READ
  7621*           DATASET  ('ELCNTL')
  7622*           SET      (ADDRESS OF CONTROL-FILE)
  7623*           RIDFLD   (ELCNTL-KEY)
  7624*           RESP     (WS-RESPONSE)
  7625*       END-EXEC
  7626     MOVE 'ELCNTL' TO DFHEIV1
  7627*    MOVE '&"S        E          (  N#00007191' TO DFHEIV0
  7628     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7630     MOVE X'204E233030303037313931' TO DFHEIV0(25:11)
  7631     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 147
* EL6501.cbl
  7632           DFHEIV1,
  7633           DFHEIV20,
  7634           DFHEIV99,
  7635           ELCNTL-KEY,
  7636           DFHEIV99,
  7637           DFHEIV99,
  7638           DFHEIV99
  7639     SET ADDRESS OF CONTROL-FILE TO
  7640         DFHEIV20
  7641     MOVE EIBRESP  TO WS-RESPONSE
  7642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7643        IF NOT RESP-NORMAL
  7644           MOVE ER-0144                TO  EMI-ERROR
  7645           MOVE -1                     TO  ASTATEL
  7646           MOVE AL-UABON               TO  ASTATEA
  7647           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7648        END-IF
  7649     ELSE
  7650        IF MAINTI = 'A'
  7651           MOVE ER-0144                TO  EMI-ERROR
  7652           MOVE -1                     TO  ASTATEL
  7653           MOVE AL-UABON               TO  ASTATEA
  7654           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7655        END-IF
  7656     END-IF
  7657     IF INDGRPL NOT GREATER ZEROS
  7658        IF MAINTI = 'C'
  7659           GO TO 4070-CHECK-STATUS
  7660        ELSE
  7661           GO TO 4060-IG-ERROR.
  7662
  7663     IF INDGRPI = 'I' OR 'G'
  7664        GO TO 4070-CHECK-STATUS.
  7665
  7666 4060-IG-ERROR.
  7667     MOVE -1                     TO INDGRPL.
  7668     MOVE AL-UABON               TO INDGRPA.
  7669     MOVE ER-2152                TO EMI-ERROR.
  7670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7671
  7672 4065-CHECK-ASSOCIATES.
  7673     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7674        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7675        MOVE  NAMEI              TO  WS-NAME-AREA
  7676     ELSE
  7677        GO TO 4070-CHECK-STATUS.
  7678
  7679     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7680        NEXT SENTENCE
  7681     ELSE
  7682        MOVE -1                  TO  NAMEL
  7683        MOVE AL-UABON            TO  NAMEA
  7684        MOVE ER-0788             TO  EMI-ERROR
  7685        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7686
  7687 4070-CHECK-STATUS.
  7688     IF STATUSL NOT GREATER ZEROS
  7689        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 148
* EL6501.cbl
  7690           GO TO 4090-CHECK-STD-AH-TYPE
  7691        ELSE
  7692           MOVE 'A'              TO STATUSI
  7693           MOVE AL-UANON         TO STATUSA
  7694           GO TO 4090-CHECK-STD-AH-TYPE.
  7695
  7696*    IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7697     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S' OR 'D' OR 'L'
  7698                      OR 'R' OR 'P'
  7699        GO TO 4090-CHECK-STD-AH-TYPE.
  7700
  7701 4080-STATUS-ERROR.
  7702     MOVE -1                     TO STATUSL.
  7703     MOVE AL-UABON               TO STATUSA.
  7704     MOVE ER-2153                TO EMI-ERROR.
  7705     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7706
  7707 4090-CHECK-STD-AH-TYPE.
  7708
  7709     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7710         GO TO 4900-EXIT.
  7711
  7712     IF STDBENL NOT GREATER ZEROS
  7713        IF MAINTI = 'C'
  7714*          GO TO 4110-CHECK-REMIT
  7715           GO TO 4100-CHECK-CLPTOLP
  7716        ELSE
  7717           MOVE ZEROS            TO STDBENI
  7718           MOVE AL-UANON         TO STDBENA
  7719*          GO TO 4110-CHECK-REMIT.
  7720           GO TO 4100-CHECK-CLPTOLP.
  7721
  7722     IF STDBENI = SPACES
  7723         MOVE ZEROS               TO STDBENI.
  7724     IF STDBENI = ZEROS
  7725*        GO TO 4110-CHECK-REMIT.
  7726         GO TO 4100-CHECK-CLPTOLP.
  7727
  7728     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7729     IF INVALID-BENEFIT-CODE
  7730        GO TO 4099-STD-BEN-ERROR.
  7731
  7732     MOVE SPACES                 TO ELCNTL-KEY.
  7733
  7734     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7735     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7736     MOVE '5'                    TO CNTL-REC-TYPE.
  7737     MOVE +0                     TO CNTL-SEQ-NO.
  7738
  7739
  7740* EXEC CICS HANDLE CONDITION
  7741*        NOTFND   (4099-STD-BEN-ERROR)
  7742*    END-EXEC.
  7743*    MOVE '"$I                   ! * #00007293' TO DFHEIV0
  7744     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7745     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7746     MOVE X'2A20233030303037323933' TO DFHEIV0(25:11)
  7747     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 149
* EL6501.cbl
  7748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7749
  7750
  7751
  7752* EXEC CICS READ
  7753*        GTEQ
  7754*        DATASET   (CNTL-FILE-ID)
  7755*        SET       (ADDRESS OF CONTROL-FILE)
  7756*        RIDFLD    (ELCNTL-KEY)
  7757*    END-EXEC.
  7758*    MOVE '&"S        G          (   #00007297' TO DFHEIV0
  7759     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7761     MOVE X'2020233030303037323937' TO DFHEIV0(25:11)
  7762     CALL 'kxdfhei1' USING DFHEIV0,
  7763           CNTL-FILE-ID,
  7764           DFHEIV20,
  7765           DFHEIV99,
  7766           ELCNTL-KEY,
  7767           DFHEIV99,
  7768           DFHEIV99,
  7769           DFHEIV99
  7770     SET ADDRESS OF CONTROL-FILE TO
  7771         DFHEIV20
  7772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7773
  7774
  7775     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7776        CNTL-REC-TYPE = CF-RECORD-TYPE
  7777         MOVE 1                  TO SUB
  7778     ELSE
  7779         GO TO 4099-STD-BEN-ERROR.
  7780
  7781 4095-CHECK-BEN-TYPE.
  7782     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7783*       GO TO 4110-CHECK-REMIT.
  7784        GO TO 4100-CHECK-CLPTOLP.
  7785
  7786     IF SUB LESS 8
  7787         ADD 1 TO SUB
  7788         GO TO 4095-CHECK-BEN-TYPE.
  7789
  7790 4099-STD-BEN-ERROR.
  7791     MOVE -1                     TO STDBENL.
  7792     MOVE AL-UABON               TO STDBENA.
  7793     MOVE ER-0250                TO EMI-ERROR.
  7794     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7795
  7796 4100-CHECK-CLPTOLP.
  7797
  7798     IF CLPTOLPL > ZERO
  7799
  7800* EXEC CICS BIF
  7801*            DEEDIT
  7802*            FIELD    (CLPTOLPI)
  7803*            LENGTH   (6)
  7804*        END-EXEC
  7805     MOVE 6
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 150
* EL6501.cbl
  7806       TO DFHEIV11
  7807*    MOVE '@"L                   #   #00007328' TO DFHEIV0
  7808     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7809     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7810     MOVE X'2020233030303037333238' TO DFHEIV0(25:11)
  7811     CALL 'kxdfhei1' USING DFHEIV0,
  7812           CLPTOLPI,
  7813           DFHEIV11
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7815         IF CLPTOLPI NOT NUMERIC
  7816             MOVE ER-1778        TO EMI-ERROR
  7817             MOVE -1             TO CLPTOLPL
  7818             MOVE AL-UNBON       TO CLPTOLPA
  7819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7820         END-IF
  7821     END-IF.
  7822     IF LCOMML > ZERO
  7823
  7824* EXEC CICS BIF
  7825*            DEEDIT
  7826*            FIELD    (LCOMMI)
  7827*            LENGTH   (8)
  7828*        END-EXEC
  7829     MOVE 8
  7830       TO DFHEIV11
  7831*    MOVE '@"L                   #   #00007341' TO DFHEIV0
  7832     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7833     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7834     MOVE X'2020233030303037333431' TO DFHEIV0(25:11)
  7835     CALL 'kxdfhei1' USING DFHEIV0,
  7836           LCOMMI,
  7837           DFHEIV11
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7839         IF LCOMMI NOT NUMERIC
  7840             MOVE ER-1778        TO EMI-ERROR
  7841             MOVE -1             TO LCOMML
  7842             MOVE AL-UNBON       TO LCOMMA
  7843             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7844         END-IF
  7845     END-IF
  7846     IF MAXMFEEL > ZEROS
  7847
  7848* EXEC CICS BIF DEEDIT
  7849*          FIELD   (MAXMFEEI)
  7850*          LENGTH  (5)
  7851*       END-EXEC
  7852     MOVE 5
  7853       TO DFHEIV11
  7854*    MOVE '@"L                   #   #00007354' TO DFHEIV0
  7855     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7856     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7857     MOVE X'2020233030303037333534' TO DFHEIV0(25:11)
  7858     CALL 'kxdfhei1' USING DFHEIV0,
  7859           MAXMFEEI,
  7860           DFHEIV11
  7861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7862        IF MAXMFEEI NUMERIC
  7863           MOVE MAXMFEEI         TO WS-WORK-FIELD
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 151
* EL6501.cbl
  7864           MOVE WS-WORK-NUM      TO MAXMFEEO
  7865        ELSE
  7866           MOVE -1               TO MAXMFEEL
  7867           MOVE AL-UABON         TO MAXMFEEA
  7868           MOVE ER-7717          TO EMI-ERROR
  7869           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7870        END-IF
  7871     END-IF
  7872     IF (CLPSTL > 0)
  7873         MOVE AL-UANON           TO CLPSTA
  7874        IF (CLPSTI NOT = SPACES)
  7875           MOVE SPACES           TO ELCNTL-KEY
  7876           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7877           MOVE '3'              TO CNTL-REC-TYPE
  7878           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7879           MOVE +0               TO CNTL-SEQ-NO
  7880
  7881* EXEC CICS  READ
  7882*              DATASET  ('ELCNTL')
  7883*              SET      (ADDRESS OF CONTROL-FILE)
  7884*              RIDFLD   (ELCNTL-KEY)
  7885*              RESP     (WS-RESPONSE)
  7886*          END-EXEC
  7887     MOVE 'ELCNTL' TO DFHEIV1
  7888*    MOVE '&"S        E          (  N#00007376' TO DFHEIV0
  7889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7891     MOVE X'204E233030303037333736' TO DFHEIV0(25:11)
  7892     CALL 'kxdfhei1' USING DFHEIV0,
  7893           DFHEIV1,
  7894           DFHEIV20,
  7895           DFHEIV99,
  7896           ELCNTL-KEY,
  7897           DFHEIV99,
  7898           DFHEIV99,
  7899           DFHEIV99
  7900     SET ADDRESS OF CONTROL-FILE TO
  7901         DFHEIV20
  7902     MOVE EIBRESP  TO WS-RESPONSE
  7903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7904           IF NOT RESP-NORMAL
  7905              MOVE ER-0144       TO EMI-ERROR
  7906              MOVE -1            TO CLPSTL
  7907              MOVE AL-UABON      TO CLPSTA
  7908              PERFORM 9900-ERROR-FORMAT
  7909                                 THRU  9900-EXIT
  7910           END-IF
  7911        ELSE
  7912           MOVE ER-0144          TO EMI-ERROR
  7913           MOVE -1               TO CLPSTL
  7914           MOVE AL-UABON         TO CLPSTA
  7915           PERFORM 9900-ERROR-FORMAT
  7916                                 THRU  9900-EXIT
  7917        END-IF
  7918     END-IF
  7919     IF (PRODCDL > ZEROS)
  7920        and (emi-error not = er-0144)
  7921        if prodcdi = spaces
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 152
* EL6501.cbl
  7922           continue
  7923        else
  7924           move low-values       to erpdef-key
  7925           move pi-company-cd    to erpdef-company-cd
  7926           move clpsti           to erpdef-state
  7927           move prodcdi          to erpdef-prod-cd
  7928           move erpdef-key       to erpdef-key-save
  7929
  7930* exec cics read
  7931*             dataset ('ERPDEF')
  7932*             set     (address of product-master)
  7933*             ridfld  (erpdef-key)
  7934*             length  (6)
  7935*             gteq
  7936*             resp    (ws-response)
  7937*          end-exec
  7938     MOVE 'ERPDEF' TO DFHEIV1
  7939*    MOVE '&"S        G          (  N#00007407' TO DFHEIV0
  7940     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7942     MOVE X'204E233030303037343037' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0,
  7944           DFHEIV1,
  7945           DFHEIV20,
  7946           DFHEIV99,
  7947           erpdef-key,
  7948           DFHEIV99,
  7949           DFHEIV99,
  7950           DFHEIV99
  7951     SET ADDRESS OF product-master TO
  7952         DFHEIV20
  7953     MOVE EIBRESP  TO ws-response
  7954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7955           if (resp-normal)
  7956              and (pd-control-primary (1:6) =
  7957                           erpdef-key-save (1:6))
  7958              continue
  7959           else
  7960              move er-8156       to emi-error
  7961              MOVE -1            TO PRODCDL
  7962              MOVE AL-UABON      TO PRODCDA
  7963              PERFORM 9900-ERROR-FORMAT
  7964                                 THRU  9900-EXIT
  7965           end-if
  7966        end-if
  7967     end-if
  7968     .
  7969 4110-CHECK-REMIT.
  7970     IF REMITL NOT GREATER ZEROS
  7971        MOVE 1                   TO REMITI
  7972        MOVE AL-UNNON            TO REMITA
  7973        GO TO 4120-REMIT-ERROR.
  7974
  7975     IF (REMITI NOT NUMERIC)  OR
  7976        (REMITI LESS 1 OR GREATER 10)
  7977           GO TO 4120-REMIT-ERROR.
  7978
  7979 4115-CHECK-AGENT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 153
* EL6501.cbl
  7980     SET M-INDEX                 TO REMITI.
  7981
  7982     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7983        MOVE ER-2156             TO EMI-ERROR
  7984        GO TO 4120-R-ERROR.
  7985
  7986     GO TO 4130-CHECK-CONTRACT.
  7987
  7988 4120-REMIT-ERROR.
  7989     MOVE ER-2155                TO EMI-ERROR.
  7990
  7991 4120-R-ERROR.
  7992     MOVE -1                     TO REMITL.
  7993     MOVE AL-UABON               TO REMITA.
  7994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7995
  7996 4130-CHECK-CONTRACT.
  7997     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7998        MOVE CONTRI                TO DEEDIT-FIELD
  7999        PERFORM 8600-DEEDIT
  8000        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8001        MOVE '4'                    TO DC-OPTION-CODE
  8002        PERFORM 9700-DATE-LINK
  8003        IF DATE-CONVERSION-ERROR
  8004           MOVE ER-2157             TO EMI-ERROR
  8005           MOVE -1                  TO CONTRL
  8006           MOVE AL-UABON            TO CONTRA
  8007           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8008        ELSE
  8009***  Y2K PROJ 7744
  8010           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  8011           MOVE AL-UANON            TO CONTRA
  8012           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  8013           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  8014        END-IF
  8015     END-IF.
  8016***  Y2K PROJ 7744
  8017
  8018     IF PI-COMPANY-ID = 'DMD'
  8019       IF PI-MAINT = 'A'
  8020        IF CONTRL = ZERO
  8021           MOVE ER-0852             TO EMI-ERROR
  8022           MOVE -1                  TO CONTRL
  8023           MOVE AL-UABON            TO CONTRA
  8024           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8025
  8026*4131-CHECK-PSI-FACTOR.
  8027*    IF PSILFFL GREATER +0
  8028*       MOVE PSILFFI             TO DEEDIT-FIELD
  8029*       PERFORM 8600-DEEDIT
  8030*       IF DEEDIT-FIELD NUMERIC
  8031*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8032*                                   PSILFFO
  8033*       ELSE
  8034*          MOVE ER-9999          TO EMI-ERROR
  8035*          MOVE -1               TO PSILFFL
  8036*          MOVE AL-UABON         TO PSILFFA
  8037*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 154
* EL6501.cbl
  8038*
  8039*    IF PSIAHFL GREATER +0
  8040*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8041*       PERFORM 8600-DEEDIT
  8042*       IF DEEDIT-FIELD NUMERIC
  8043*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8044*                                   PSIAHFO
  8045*       ELSE
  8046*          MOVE ER-9999          TO EMI-ERROR
  8047*          MOVE -1               TO PSIAHFL
  8048*          MOVE AL-UABON         TO PSIAHFA
  8049*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8050
  8051 4135-CHECK-PREVIOUS-DATES.
  8052     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8053        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8054        PERFORM 8600-DEEDIT
  8055        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8056        MOVE '4'                    TO DC-OPTION-CODE
  8057        PERFORM 9700-DATE-LINK
  8058        IF DATE-CONVERSION-ERROR
  8059           MOVE ER-0348             TO EMI-ERROR
  8060           MOVE -1                  TO PEFFDTEL
  8061           MOVE AL-UABON            TO PEFFDTEA
  8062           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8063        ELSE
  8064***  Y2K PROJ 7744
  8065           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8066           MOVE AL-UANON            TO PEFFDTEA
  8067           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8068           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8069        END-IF
  8070     END-IF.
  8071
  8072     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8073        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8074        PERFORM 8600-DEEDIT
  8075        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8076           MOVE '99/99/99'             TO PEXPDTEO
  8077           MOVE 99999999999            TO WS-PEXP-DT
  8078           MOVE AL-UANON               TO PEXPDTEA
  8079        ELSE
  8080           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8081           MOVE '4'                    TO DC-OPTION-CODE
  8082           PERFORM 9700-DATE-LINK
  8083           IF DATE-CONVERSION-ERROR
  8084              MOVE ER-0454             TO EMI-ERROR
  8085              MOVE -1                  TO PEXPDTEL
  8086              MOVE AL-UABON            TO PEXPDTEA
  8087              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8088           ELSE
  8089              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8090              MOVE AL-UANON            TO PEXPDTEA
  8091              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8092              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8093           END-IF
  8094        END-IF
  8095     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 155
* EL6501.cbl
  8096***  Y2K PROJ 7744
  8097
  8098     IF COMMCALL NOT GREATER ZEROS
  8099         GO TO 4150-CHECK-REINCAL.
  8100
  8101     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8102         (EFFCHG-SAVE LESS 841101)       AND
  8103         (COMMCALI = 'Y' OR '1')         AND
  8104         (NOT MODIFY-CAP)
  8105           MOVE -1               TO COMMCALL
  8106           MOVE AL-UABON         TO COMMCALA
  8107           MOVE ER-2189          TO EMI-ERROR
  8108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8109
  8110     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8111         GO TO 4150-CHECK-REINCAL.
  8112
  8113 4140-COMMCAL-ERROR.
  8114     MOVE -1                     TO COMMCALL.
  8115     MOVE AL-UABON               TO COMMCALA.
  8116     MOVE ER-2158                TO EMI-ERROR.
  8117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8118
  8119 4150-CHECK-REINCAL.
  8120     IF REINCALL NOT GREATER ZEROS
  8121         GO TO 4170-CHECK-REINTAB.
  8122
  8123     IF REINCALI = 'Y' OR 'N'
  8124        GO TO 4170-CHECK-REINTAB.
  8125
  8126 4160-REINCAL-ERROR.
  8127     MOVE -1                     TO REINCALL.
  8128     MOVE AL-UABON               TO REINCALA.
  8129     MOVE ER-2179                TO EMI-ERROR.
  8130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8131
  8132 4170-CHECK-REINTAB.
  8133     IF REINTABL NOT GREATER ZEROS
  8134        IF PI-COMPANY-ID = 'NCL' AND
  8135           MAINTI = 'A'
  8136                MOVE ER-4010         TO EMI-ERROR
  8137                MOVE -1              TO REINTABL
  8138                MOVE AL-UABON        TO REINTABA
  8139                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8140
  8141     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8142         GO TO 4410-CHECK-AGENTS.
  8143     IF PI-COMPANY-ID = 'CID'
  8144        IF PI-ACCT-STATE = 'KY'
  8145           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8146              MOVE -1            TO REINTABL
  8147              MOVE AL-UABON      TO REINTABA
  8148              MOVE ER-2159       TO EMI-ERROR
  8149              PERFORM 9900-ERROR-FORMAT
  8150                                 THRU 9900-EXIT
  8151           END-IF
  8152        END-IF
  8153     END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 156
* EL6501.cbl
  8154     MOVE LOW-VALUES             TO REIN-KEY.
  8155
  8156     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8157     MOVE 'A'                    TO REIN-CODE.
  8158     MOVE REINTABI               TO REIN-TABLE.
  8159
  8160
  8161* EXEC CICS HANDLE CONDITION
  8162*        NOTFND   (4180-REIN-ERROR)
  8163*    END-EXEC.
  8164*    MOVE '"$I                   ! + #00007620' TO DFHEIV0
  8165     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8167     MOVE X'2B20233030303037363230' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0
  8169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8170
  8171
  8172
  8173* EXEC CICS READ
  8174*        DATASET   (REIN-FILE-ID)
  8175*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8176*        RIDFLD    (REIN-KEY)
  8177*    END-EXEC.
  8178*    MOVE '&"S        E          (   #00007624' TO DFHEIV0
  8179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8181     MOVE X'2020233030303037363234' TO DFHEIV0(25:11)
  8182     CALL 'kxdfhei1' USING DFHEIV0,
  8183           REIN-FILE-ID,
  8184           DFHEIV20,
  8185           DFHEIV99,
  8186           REIN-KEY,
  8187           DFHEIV99,
  8188           DFHEIV99,
  8189           DFHEIV99
  8190     SET ADDRESS OF REINSURANCE-RECORD TO
  8191         DFHEIV20
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8193
  8194
  8195     GO TO 4410-CHECK-AGENTS.
  8196
  8197 4180-REIN-ERROR.
  8198     MOVE -1                     TO REINTABL.
  8199     MOVE AL-UABON               TO REINTABA.
  8200     MOVE ER-2615                TO EMI-ERROR.
  8201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8202
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 157
* EL6501.cbl
  8204 4410-CHECK-AGENTS.
  8205     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8206     SET M-INDEX TO 1.
  8207
  8208     IF PI-COMPANY-ID = 'NCL'
  8209       IF AGENTL (M-INDEX) GREATER ZEROS
  8210         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8211
  8212 4420-LOOP.
  8213     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8214        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8215            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8216           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8217           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8218           A-HL    (M-INDEX) GREATER ZEROS  OR
  8219           RECALL  (M-INDEX) GREATER ZEROS  OR
  8220           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8221           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8222           GLCODEL (M-INDEX) GREATER ZEROS
  8223           MOVE ER-2172          TO EMI-ERROR
  8224           MOVE -1               TO AGENTL (M-INDEX)
  8225           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8226           GO TO 4450-BUMP-INDEX
  8227        ELSE
  8228           GO TO 4450-BUMP-INDEX.
  8229
  8230     IF AGENT (M-INDEX) = ZEROS
  8231         MOVE ER-2970            TO  EMI-ERROR
  8232         MOVE -1                 TO  AGENTL (M-INDEX)
  8233         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8235         GO TO 4450-BUMP-INDEX.
  8236
  8237     IF ATYPEL (M-INDEX) = ZEROS
  8238        MOVE -1                  TO ATYPEL (M-INDEX)
  8239        MOVE ER-2173             TO EMI-ERROR
  8240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8241        GO TO 4430-CHECK-SINGLE.
  8242
  8243     IF ATYPE (M-INDEX) = 'C'
  8244        ADD 1                    TO WS-ACCOUNT-CTR-C
  8245       ELSE
  8246        IF ATYPE (M-INDEX) = 'R'
  8247           ADD 1                 TO WS-ACCOUNT-CTR-R
  8248          ELSE
  8249           IF ATYPE (M-INDEX) = 'D'
  8250              ADD 1                 TO WS-ACCOUNT-CTR-D
  8251             ELSE
  8252              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8253                                OR 'B' OR 'I' OR 'K' OR 'L'
  8254                                OR 'J' OR 'M' OR 'A' OR 'N'
  8255                                OR 'S'
  8256                 NEXT SENTENCE
  8257                ELSE
  8258                 IF ATYPE (M-INDEX) = SPACES
  8259                    NEXT SENTENCE
  8260                   ELSE
  8261                    MOVE ER-2175       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 158
* EL6501.cbl
  8262                    MOVE -1            TO ATYPEL (M-INDEX)
  8263                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8264                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8265
  8266 4430-CHECK-SINGLE.
  8267     IF SINGLEL (M-INDEX) GREATER ZEROS
  8268        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8269           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8270           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8271           MOVE LOW-VALUES                 TO COMM-FILLER
  8272           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8273           IF COMMISSION-ERROR
  8274              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8275              MOVE -1            TO SINGLEL (M-INDEX)
  8276           ELSE
  8277            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8278              MOVE -1            TO MAINTL
  8279              MOVE ER-1884       TO EMI-ERROR
  8280              PERFORM 9900-ERROR-FORMAT
  8281                                 THRU 9900-EXIT
  8282            END-IF
  8283           END-IF
  8284        END-IF
  8285     END-IF
  8286
  8287     IF JOINTL (M-INDEX) GREATER ZEROS
  8288        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8289           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8290           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8291           MOVE LOW-VALUES                 TO COMM-FILLER
  8292           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8293           IF COMMISSION-ERROR
  8294              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8295              MOVE -1            TO JOINTL (M-INDEX)
  8296           ELSE
  8297            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8298              MOVE -1            TO MAINTL
  8299              MOVE ER-1885       TO EMI-ERROR
  8300              PERFORM 9900-ERROR-FORMAT
  8301                                 THRU 9900-EXIT
  8302            END-IF
  8303           END-IF
  8304        END-IF
  8305     END-IF
  8306
  8307     IF A-HL (M-INDEX) GREATER ZEROS
  8308        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8309           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8310           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8311           MOVE LOW-VALUES                 TO COMM-FILLER
  8312           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8313           IF COMMISSION-ERROR
  8314              MOVE AL-UABON      TO A-HA (M-INDEX)
  8315              MOVE -1            TO A-HL (M-INDEX)
  8316           ELSE
  8317            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8318              MOVE -1            TO MAINTL
  8319              MOVE ER-1886       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 159
* EL6501.cbl
  8320              PERFORM 9900-ERROR-FORMAT
  8321                                 THRU 9900-EXIT
  8322            END-IF
  8323           END-IF
  8324        END-IF
  8325     END-IF
  8326
  8327     IF RECALL (M-INDEX) GREATER ZEROS
  8328         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8329             MOVE AL-UANON       TO RECALA (M-INDEX)
  8330         ELSE
  8331             MOVE -1             TO RECALL (M-INDEX)
  8332             MOVE AL-UABON       TO RECALA (M-INDEX)
  8333             MOVE ER-2158        TO EMI-ERROR
  8334             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8335
  8336     IF RCOMML (M-INDEX) GREATER ZEROS
  8337         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8338             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8339         ELSE
  8340             MOVE -1             TO RCOMML (M-INDEX)
  8341             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8342             MOVE ER-0625        TO EMI-ERROR
  8343             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8344
  8345     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8346         IF  CHGBCK (M-INDEX)    NUMERIC
  8347             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8348         ELSE
  8349             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8350             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8351             MOVE  ER-0759         TO  EMI-ERROR
  8352             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8353
  8354     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8355         IF  GLCODE (M-INDEX)    NUMERIC
  8356             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8357         ELSE
  8358             MOVE  -1              TO  GLCODEL (M-INDEX)
  8359             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8360             MOVE  ER-0759         TO  EMI-ERROR
  8361             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8362
  8363     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8364        AND 'J'
  8365         GO TO 4450-BUMP-INDEX.
  8366
  8367     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8368         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8369
  8370     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8371         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8372
  8373     IF A-H-COMM-R (M-INDEX) NUMERIC
  8374        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8375     END-IF
  8376     .
  8377 4450-BUMP-INDEX.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 160
* EL6501.cbl
  8378     SET M-INDEX UP BY 1.
  8379
  8380     IF M-INDEX NOT = 11
  8381        GO TO 4420-LOOP.
  8382
  8383     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8384        WS-ACCOUNT-CTR-D = ZEROS AND
  8385        WS-ACCOUNT-CTR-R = ZEROS
  8386          MOVE ER-2177             TO EMI-ERROR
  8387          MOVE -1                  TO AGENTL (1)
  8388          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8389          GO TO 4900-EXIT.
  8390
  8391     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8392         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8393        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8394         WS-ACCOUNT-CTR-D  GREATER 0)
  8395           MOVE ER-2174             TO EMI-ERROR
  8396           MOVE -1                  TO AGENTL (1)
  8397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398           GO TO 4900-EXIT.
  8399
  8400     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8401        WS-ACCOUNT-CTR-R GREATER 1 OR
  8402        WS-ACCOUNT-CTR-D GREATER 1
  8403          MOVE ER-2182             TO EMI-ERROR
  8404          MOVE -1                  TO AGENTL (1)
  8405          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8406          GO TO 4900-EXIT.
  8407
  8408
  8409     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8410         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8411
  8412     IF WS-ST-COMM-CAP-SL = ZEROS
  8413        CONTINUE
  8414     ELSE
  8415      IF SINGLE-COMM-R (1) NUMERIC
  8416        IF (WS-LIMIT-TO-ACCOUNT AND
  8417           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8418                       OR
  8419           (NOT WS-LIMIT-TO-ACCOUNT AND
  8420           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8421           MOVE -1               TO MAINTL
  8422           MOVE ER-1884          TO EMI-ERROR
  8423           PERFORM 9900-ERROR-FORMAT
  8424                                 THRU 9900-EXIT
  8425        END-IF
  8426*     ELSE
  8427*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8428*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8429*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8430*       MOVE LOW-VALUES          TO COMM-FILLER
  8431*       PERFORM 6400-READ-COMMISSION
  8432*                                THRU 6459-EXIT
  8433*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8434*          MOVE -1               TO MAINTL
  8435*          MOVE ER-1884          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 161
* EL6501.cbl
  8436*          PERFORM 9900-ERROR-FORMAT
  8437*                                THRU 9900-EXIT
  8438*       END-IF
  8439      END-IF
  8440     END-IF
  8441
  8442     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8443        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8444     END-IF
  8445
  8446     IF WS-ST-COMM-CAP-JL = ZEROS
  8447        CONTINUE
  8448     ELSE
  8449        IF JOINT-COMM-R (1) NUMERIC
  8450           IF (WS-LIMIT-TO-ACCOUNT AND
  8451              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8452                       OR
  8453              (NOT WS-LIMIT-TO-ACCOUNT AND
  8454               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8455               MOVE -1           TO MAINTL
  8456               MOVE ER-1885      TO EMI-ERROR
  8457               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8458           END-IF
  8459*       ELSE
  8460*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8461*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8462*          MOVE PI-LIFE-OVERRIDE-L1
  8463*                                TO COMM-LF-AH
  8464*          MOVE LOW-VALUES       TO COMM-FILLER
  8465*          PERFORM 6400-READ-COMMISSION
  8466*                                THRU 6459-EXIT
  8467*          IF EXCEEDS-STATE-MAX
  8468*             MOVE ER-1885       TO EMI-ERROR
  8469*             PERFORM 9900-ERROR-FORMAT
  8470*                                THRU 9900-EXIT
  8471*          END-IF
  8472        END-IF
  8473     END-IF
  8474
  8475     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8476        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8477     END-IF
  8478
  8479     IF WS-ST-COMM-CAP-SA = ZEROS
  8480        CONTINUE
  8481     ELSE
  8482        IF A-H-COMM-R (1) NUMERIC
  8483           IF (WS-LIMIT-TO-ACCOUNT AND
  8484              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8485                           OR
  8486              (NOT WS-LIMIT-TO-ACCOUNT AND
  8487              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8488              MOVE -1            TO MAINTL
  8489              MOVE ER-1886       TO EMI-ERROR
  8490              PERFORM 9900-ERROR-FORMAT
  8491                                 THRU 9900-EXIT
  8492           END-IF
  8493*       ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 162
* EL6501.cbl
  8494*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8495*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8496*          MOVE PI-AH-OVERRIDE-L1
  8497*                                TO COMM-LF-AH
  8498*          MOVE LOW-VALUES       TO COMM-FILLER
  8499*          PERFORM 6400-READ-COMMISSION
  8500*                                THRU 6459-EXIT
  8501*          IF EXCEEDS-STATE-MAX
  8502*             MOVE ER-1886       TO EMI-ERROR
  8503*             PERFORM 9900-ERROR-FORMAT
  8504*                                THRU 9900-EXIT
  8505*          END-IF
  8506        END-IF
  8507     END-IF
  8508
  8509     IF MAINTI NOT = 'C'
  8510        GO TO 4900-EXIT.
  8511
  8512     IF NOT PI-GA-BILLING
  8513        GO TO 4900-EXIT.
  8514
  8515 4460-CHECK-IF-GA-BILLED.
  8516     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8517
  8518     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8519     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8520     SET M-INDEX TO +1.
  8521     MOVE +1 TO AXRF-SUB.
  8522
  8523 4470-GA-LOOP.
  8524     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8525        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8526        SINGLEL (M-INDEX) GREATER ZERO                OR
  8527        JOINTL  (M-INDEX) GREATER ZERO                OR
  8528        A-HL    (M-INDEX) GREATER ZERO                OR
  8529        RCOMML  (M-INDEX) GREATER ZERO                OR
  8530        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8531        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8532        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8533           MOVE ER-2131   TO EMI-ERROR
  8534           MOVE -1        TO AGENTL (M-INDEX)
  8535           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8536           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8537
  8538     ADD +1 TO AXRF-SUB.
  8539     SET M-INDEX UP BY +1.
  8540
  8541     IF AXRF-SUB NOT = +11
  8542        GO TO 4470-GA-LOOP.
  8543
  8544 4900-EXIT.
  8545      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 163
* EL6501.cbl
  8547 5000-MOVE-TO-RECORD.
  8548
  8549     IF NAMEL   GREATER THAN ZERO  OR
  8550        INCAREL GREATER THAN ZERO  OR
  8551        ADDR1L  GREATER THAN ZERO  OR
  8552        ACITYL  GREATER THAN ZERO  OR
  8553        ASTATEL GREATER THAN ZERO  OR
  8554        ZIPL    GREATER THAN ZERO  OR
  8555        PHONEL  GREATER THAN ZERO  OR
  8556        TAXNOL  GREATER THAN ZERO
  8557         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8558
  8559     IF CSRL GREATER ZEROS
  8560        MOVE CSRI                TO AM-CSR-CODE.
  8561     IF NAMEL GREATER ZEROS
  8562        MOVE NAMEI               TO AM-NAME.
  8563     IF PCONTL GREATER ZEROS
  8564        MOVE PCONTI              TO AM-CONTROL-NAME
  8565     END-IF
  8566     IF INCAREL GREATER ZEROS
  8567        MOVE INCAREI             TO AM-PERSON.
  8568     IF ADDR1L GREATER ZEROS
  8569        MOVE ADDR1I              TO AM-ADDRS.
  8570     IF TAXNOL GREATER ZEROS
  8571        MOVE TAXNOI              TO AM-ID-NO.
  8572     IF PHONEL GREATER ZEROS
  8573        MOVE PHONEI              TO DEEDIT-FIELD
  8574        PERFORM 8600-DEEDIT
  8575        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8576        MOVE WS-PH1              TO AM-AREA-CODE
  8577        MOVE WS-PH2              TO AM-TEL-PRE
  8578        MOVE WS-PH3              TO AM-TEL-NBR.
  8579
  8580     IF ACITYL GREATER ZEROS
  8581        MOVE ACITYI             TO AM-ADDR-CITY.
  8582     IF ASTATEL GREATER ZEROS
  8583        MOVE ASTATEI            TO AM-ADDR-STATE.
  8584
  8585     IF ZIPL NOT GREATER ZEROS
  8586         GO TO 5010-CONT-MOVING.
  8587
  8588     MOVE ZIPI                   TO WS-ZIP-CODE.
  8589
  8590     IF WS-CANADIAN-ZIP
  8591         IF WS-ZIP-4 = SPACE  OR  '-'
  8592             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8593             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8594         ELSE
  8595             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8596             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8597     ELSE
  8598         IF WS-ZIP-6 = SPACE  OR  '-'
  8599             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8600             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8601         ELSE
  8602             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8603             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8604
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 164
* EL6501.cbl
  8605 5010-CONT-MOVING.
  8606     IF TYPEL GREATER ZEROS
  8607        MOVE TYPEI               TO AM-GPCD.
  8608
  8609     IF STDBENL GREATER ZEROS
  8610        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8611
  8612     IF INDGRPL GREATER ZEROS
  8613        MOVE INDGRPI             TO AM-IG
  8614        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8615
  8616     IF STATUSL GREATER ZEROS
  8617        MOVE STATUSI             TO AM-STATUS
  8618*       INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8619        INSPECT AM-STATUS CONVERTING 'PRLDSFCTIA' TO '9876543210'
  8620     END-IF
  8621
  8622     IF CLPTOLPL GREATER ZEROS
  8623        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8624     END-IF.
  8625
  8626     IF PRODCDL > 0
  8627        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8628     END-IF
  8629     IF CLPSTL > 0
  8630        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8631     END-IF
  8632     IF MAXMFEEL > ZEROS
  8633        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8634     END-IF
  8635     IF LCOMML > ZEROS
  8636        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8637     END-IF
  8638
  8639     IF REMITL GREATER ZEROS
  8640        MOVE REMITI              TO AM-REMIT-TO.
  8641     IF CONTRL GREATER ZEROS
  8642        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8643*    IF PSILFFL GREATER +0
  8644*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8645*    IF PSIAHFL GREATER +0
  8646*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8647     IF PEFFDTEL GREATER ZEROS
  8648        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8649     IF PEXPDTEL GREATER ZEROS
  8650        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8651     IF COMMCALL GREATER ZEROS
  8652        MOVE COMMCALI            TO AM-RECALC-COMM
  8653        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8654     ELSE
  8655         IF MAINTI = 'A'
  8656             MOVE 'N'            TO AM-RECALC-COMM.
  8657
  8658     IF REINCALL GREATER ZEROS
  8659        MOVE REINCALI            TO AM-RECALC-REIN
  8660     ELSE
  8661         IF MAINTI = 'A'
  8662             MOVE 'N'            TO AM-RECALC-REIN.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 165
* EL6501.cbl
  8663
  8664     IF REINTABL GREATER ZEROS
  8665        MOVE REINTABI            TO AM-REI-TABLE.
  8666
  8667     IF PI-MAINT = 'A'
  8668        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8669     END-IF
  8670
  8671     MOVE 1                      TO SUB.
  8672     SET M-INDEX                 TO 1.
  8673
  8674
  8675* EXEC CICS
  8676*         ASKTIME
  8677*    END-EXEC.
  8678*    MOVE '0"                    "   #00008109' TO DFHEIV0
  8679     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8680     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8681     MOVE X'2020233030303038313039' TO DFHEIV0(25:11)
  8682     CALL 'kxdfhei1' USING DFHEIV0,
  8683           DFHEIV99
  8684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8685
  8686
  8687 5000-LOOP.
  8688*    IF PI-COMPANY-ID = 'DCC'
  8689*       IF (M-INDEX = +5)
  8690*          AND ((AGENTL (5) > ZEROS)
  8691*              OR (ATYPEL (5) > ZEROS))
  8692*             MOVE ER-3057         TO EMI-ERROR
  8693*             MOVE -1              TO AGENTL (5)
  8694*             MOVE AL-UABON        TO AGENTA (5)
  8695*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8696*             GO TO 5000-EXIT
  8697*       END-IF
  8698*    END-IF
  8699     IF MAINTI = 'C'
  8700        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8701           (COMMCALI NOT = 'Y' AND '1')                    AND
  8702            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8703           ((AM-AGT (SUB) = ZEROS AND
  8704             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8705                                     ZEROS) AND
  8706           (COMMCALI NOT = 'Y' AND '1')  AND
  8707            AM-HI-CERT-DATE NOT = ZEROS)
  8708              MOVE ER-2181         TO EMI-ERROR
  8709              MOVE -1              TO COMMCALL
  8710              MOVE AL-UABON        TO COMMCALA
  8711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8712              GO TO 5000-EXIT.
  8713
  8714     IF MAINTI = 'C'
  8715        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8716             ATYPE (M-INDEX)) AND
  8717           (COMMCALI NOT = 'Y' AND '1') AND
  8718            AM-HI-CERT-DATE NOT = ZEROS)
  8719            OR
  8720           ((AM-COM-TYP (SUB) = SPACES AND
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 166
* EL6501.cbl
  8721             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
  8722           (COMMCALI NOT = 'Y' AND '1')  AND
  8723            AM-HI-CERT-DATE NOT = ZEROS)
  8724              MOVE ER-2181         TO EMI-ERROR
  8725              MOVE -1              TO COMMCALL
  8726              MOVE AL-UABON        TO COMMCALA
  8727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8728              GO TO 5000-EXIT.
  8729
  8730     IF AM-ACCOUNT-BILLED
  8731        IF COMMCALI = 'Y' OR '1'
  8732            MOVE ER-2183         TO EMI-ERROR
  8733            MOVE -1              TO COMMCALL
  8734            MOVE AL-UABON        TO COMMCALA
  8735            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8736            GO TO 5000-EXIT.
  8737
  8738     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8739        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8740        OR
  8741        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8742         ATYPE  (M-INDEX) = SPACES)
  8743           MOVE ZEROS              TO AM-AGT   (SUB)
  8744                                      AM-L-COM (SUB)
  8745                                      AM-J-COM (SUB)
  8746                                      AM-A-COM (SUB)
  8747           MOVE SPACE TO AM-COM-TYP (SUB)
  8748           SET M-INDEX UP BY 1
  8749           ADD 1 TO SUB
  8750           IF SUB = 11
  8751              GO TO 5000-CHECK-MAX-FEES
  8752            ELSE
  8753              GO TO 5000-LOOP.
  8754
  8755     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8756     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8757
  8758     IF SINGLEL (M-INDEX) GREATER ZEROS
  8759        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8760        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8761           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8762          ELSE
  8763           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8764           IF SINGLE-DASH (M-INDEX) = '-'
  8765               MULTIPLY AM-L-COM (SUB) BY -1
  8766                     GIVING AM-L-COM (SUB).
  8767
  8768     IF JOINTL (M-INDEX) GREATER ZEROS
  8769        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8770        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8771           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8772          ELSE
  8773           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8774           IF JOINT-DASH (M-INDEX) = '-'
  8775               MULTIPLY AM-J-COM (SUB) BY -1
  8776                     GIVING AM-J-COM (SUB).
  8777
  8778     IF A-HL (M-INDEX) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 167
* EL6501.cbl
  8779        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8780        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8781           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8782          ELSE
  8783           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8784           IF A-H-DASH (M-INDEX) = '-'
  8785               MULTIPLY AM-A-COM (SUB) BY -1
  8786                     GIVING AM-A-COM (SUB).
  8787
  8788     IF RECALL (M-INDEX) GREATER ZEROS
  8789         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8790
  8791     IF RCOMML (M-INDEX) GREATER ZEROS
  8792         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8793
  8794     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8795         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8796
  8797     IF GLCODEL (M-INDEX) GREATER ZEROS
  8798         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8799
  8800     SET M-INDEX UP BY 1.
  8801     ADD 1 TO SUB.
  8802     IF M-INDEX NOT = 11
  8803        GO TO 5000-LOOP.
  8804
  8805 5000-CHECK-MAX-FEES.
  8806     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8807        MOVE +1                     TO S1
  8808        PERFORM UNTIL S1 > +10
  8809           IF (AM-A-COM (S1) NUMERIC)
  8810              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8811                     AND 'O')
  8812              AND (AM-COM-TYP (S1) = 'J')
  8813                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8814                    + (AM-A-COM (S1) * +1000)
  8815           END-IF
  8816           ADD +1             TO S1
  8817        END-PERFORM
  8818        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8819           MOVE -1               TO MAXMFEEL
  8820           MOVE AL-UABON         TO MAXMFEEA
  8821           MOVE ER-1817          TO EMI-ERROR
  8822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8823        END-IF
  8824     END-IF
  8825     .
  8826 5000-EXIT.
  8827      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 168
* EL6501.cbl
  8829
  8830 5100-WRITE-TS.
  8831     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8832
  8833     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8834         MOVE ZEROS              TO PI-CR-CARRIER
  8835     ELSE
  8836         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8837
  8838     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8839         MOVE ZEROS              TO PI-CR-GROUPING
  8840     ELSE
  8841         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8842
  8843     IF AM-REMIT-TO NOT = ZERO
  8844         MOVE AM-AGT (AM-REMIT-TO)
  8845                                 TO PI-CR-FIN-RESP
  8846       ELSE
  8847         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8848
  8849     MOVE 'A'                    TO PI-CR-TYPE.
  8850 5110-AGT-LOOP.
  8851     ADD 1                       TO  AGT-SUB.
  8852     IF AGT-SUB GREATER 10
  8853         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8854         GO TO 5120-WRITE.
  8855
  8856************************************************************
  8857**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8858************************************************************
  8859
  8860     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8861                  OR 'F' OR 'U'
  8862         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8863         GO TO 5120-WRITE
  8864     ELSE
  8865         GO TO 5110-AGT-LOOP.
  8866
  8867 5120-WRITE.
  8868
  8869* EXEC CICS WRITEQ TS
  8870*         QUEUE    (QID)
  8871*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8872*         LENGTH   (WS-COMM-LENGTH)
  8873*         ITEM     (W-ONE)
  8874*    END-EXEC.
  8875*    MOVE '*" I                  ''   #00008294' TO DFHEIV0
  8876     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8878     MOVE X'2020233030303038323934' TO DFHEIV0(25:11)
  8879     CALL 'kxdfhei1' USING DFHEIV0,
  8880           QID,
  8881           PROGRAM-INTERFACE-BLOCK,
  8882           WS-COMM-LENGTH,
  8883           W-ONE,
  8884           DFHEIV99,
  8885           DFHEIV99
  8886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 169
* EL6501.cbl
  8887
  8888
  8889 5199-EXIT.
  8890     EXIT.
  8891
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 170
* EL6501.cbl
  8893
  8894 5200-RECOVER-TS.
  8895
  8896     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8897                                 XCTL-653 AND
  8898                                 XCTL-689 AND
  8899                                 XCTL-608 AND
  8900                                 XCTL-690
  8901         GO TO 5299-EXIT.
  8902
  8903
  8904* EXEC CICS HANDLE CONDITION
  8905*        QIDERR  (5250-QID-ERROR)
  8906*    END-EXEC.
  8907*    MOVE '"$N                   ! , #00008315' TO DFHEIV0
  8908     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8910     MOVE X'2C20233030303038333135' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0
  8912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8913
  8914
  8915
  8916* EXEC CICS READQ TS
  8917*        QUEUE    (QID)
  8918*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8919*        LENGTH   (WS-COMM-LENGTH)
  8920*        ITEM     (W-ONE)
  8921*    END-EXEC.
  8922*    MOVE '*$II   L              ''   #00008319' TO DFHEIV0
  8923     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8925     MOVE X'2020233030303038333139' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           QID,
  8928           PROGRAM-INTERFACE-BLOCK,
  8929           WS-COMM-LENGTH,
  8930           W-ONE,
  8931           DFHEIV99,
  8932           DFHEIV99
  8933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8934
  8935
  8936 5200-DELETE-TS.
  8937
  8938
  8939* EXEC CICS DELETEQ TS
  8940*        QUEUE    (QID)
  8941*    END-EXEC.
  8942*    MOVE '*&                    #   #00008328' TO DFHEIV0
  8943     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8944     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8945     MOVE X'2020233030303038333238' TO DFHEIV0(25:11)
  8946     CALL 'kxdfhei1' USING DFHEIV0,
  8947           QID,
  8948           DFHEIV99
  8949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8950
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 171
* EL6501.cbl
  8951
  8952     GO TO 5299-EXIT.
  8953
  8954 5250-QID-ERROR.
  8955     MOVE ER-0033                TO  EMI-ERROR.
  8956     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8957
  8958 5299-EXIT.
  8959     EXIT.
  8960
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 172
* EL6501.cbl
  8962
  8963 5300-UPDATE-REQUEST-FILE.
  8964     MOVE +0                     TO SUB1.
  8965
  8966 5300-FIND-ACCOUNT-AGENT.
  8967     ADD +1                      TO SUB1.
  8968
  8969     IF SUB1 GREATER THAN +10
  8970        MOVE ER-2949             TO EMI-ERROR
  8971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8972        MOVE -1                  TO AGENTL (1)
  8973
  8974* EXEC CICS SYNCPOINT ROLLBACK
  8975*       END-EXEC
  8976*    MOVE '6"R                   !   #00008353' TO DFHEIV0
  8977     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8979     MOVE X'2020233030303038333533' TO DFHEIV0(25:11)
  8980     CALL 'kxdfhei1' USING DFHEIV0
  8981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8982        GO TO 8200-SEND-DATAONLY.
  8983
  8984     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8985
  8986************************************************************
  8987**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8988************************************************************
  8989
  8990     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  8991        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8992           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8993
  8994     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8995        GO TO 5325-PROCESS-RQST-FILE.
  8996
  8997     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8998        GO TO 5325-PROCESS-RQST-FILE.
  8999
  9000     GO TO 5399-EXIT.
  9001
  9002 5325-PROCESS-RQST-FILE.
  9003     MOVE LOW-VALUES             TO RQST3-KEY.
  9004     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  9005     MOVE AM-CARRIER             TO RQST3-CARRIER.
  9006     MOVE AM-GROUPING            TO RQST3-GROUPING.
  9007     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  9008     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  9009
  9010
  9011* EXEC CICS HANDLE CONDITION
  9012*        NOTFND(5399-EXIT)
  9013*        ENDFILE(5399-EXIT)
  9014*    END-EXEC.
  9015*    MOVE '"$I''                  ! - #00008383' TO DFHEIV0
  9016     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9018     MOVE X'2D20233030303038333833' TO DFHEIV0(25:11)
  9019     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 173
* EL6501.cbl
  9020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9021
  9022
  9023 5325-PROCESS-REQUEST-FILE.
  9024
  9025* EXEC CICS STARTBR
  9026*         DATASET   (RQST3-FILE-ID)
  9027*         RIDFLD    (RQST3-KEY)
  9028*    END-EXEC.
  9029     MOVE 0
  9030       TO DFHEIV11
  9031*    MOVE '&,         G          &   #00008389' TO DFHEIV0
  9032     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9033     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9034     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  9035     CALL 'kxdfhei1' USING DFHEIV0,
  9036           RQST3-FILE-ID,
  9037           RQST3-KEY,
  9038           DFHEIV99,
  9039           DFHEIV11,
  9040           DFHEIV99
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044 5330-READNEXT-REQUEST.
  9045
  9046* EXEC CICS READNEXT
  9047*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9048*        DATASET(RQST3-FILE-ID)
  9049*        RIDFLD (RQST3-KEY)
  9050*    END-EXEC.
  9051     MOVE 0
  9052       TO DFHEIV11
  9053*    MOVE '&.S                   )   #00008395' TO DFHEIV0
  9054     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9055     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9056     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  9057     CALL 'kxdfhei1' USING DFHEIV0,
  9058           RQST3-FILE-ID,
  9059           DFHEIV20,
  9060           DFHEIV99,
  9061           RQST3-KEY,
  9062           DFHEIV99,
  9063           DFHEIV11,
  9064           DFHEIV99,
  9065           DFHEIV99
  9066     SET ADDRESS OF AR-REQUEST-RECORD TO
  9067         DFHEIV20
  9068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9069
  9070
  9071     IF RQST3-KEY = SAVE-RQST3-KEY
  9072        GO TO 5330-READNEXT-REQUEST.
  9073
  9074     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9075
  9076     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9077        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 174
* EL6501.cbl
  9078
  9079     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9080        GO TO 5350-REQUESTS-FINISHED.
  9081
  9082     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9083        GO TO 5350-REQUESTS-FINISHED.
  9084
  9085     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9086
  9087
  9088* EXEC CICS ENDBR
  9089*        DATASET(RQST3-FILE-ID)
  9090*    END-EXEC.
  9091     MOVE 0
  9092       TO DFHEIV11
  9093*    MOVE '&2                    $   #00008417' TO DFHEIV0
  9094     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9096     MOVE X'2020233030303038343137' TO DFHEIV0(25:11)
  9097     CALL 'kxdfhei1' USING DFHEIV0,
  9098           RQST3-FILE-ID,
  9099           DFHEIV11,
  9100           DFHEIV99
  9101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9102
  9103
  9104
  9105* EXEC CICS READ
  9106*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9107*        DATASET(RQST-FILE-ID)
  9108*        RIDFLD (RQST-KEY)
  9109*        UPDATE
  9110*    END-EXEC.
  9111*    MOVE '&"S        EU         (   #00008421' TO DFHEIV0
  9112     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9113     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9114     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  9115     CALL 'kxdfhei1' USING DFHEIV0,
  9116           RQST-FILE-ID,
  9117           DFHEIV20,
  9118           DFHEIV99,
  9119           RQST-KEY,
  9120           DFHEIV99,
  9121           DFHEIV99,
  9122           DFHEIV99
  9123     SET ADDRESS OF AR-REQUEST-RECORD TO
  9124         DFHEIV20
  9125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9126
  9127
  9128     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9129     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9130
  9131
  9132* EXEC CICS REWRITE
  9133*        DATASET   (RQST-FILE-ID)
  9134*        FROM      (AR-REQUEST-RECORD)
  9135*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 175
* EL6501.cbl
  9136     MOVE LENGTH OF
  9137      AR-REQUEST-RECORD
  9138       TO DFHEIV11
  9139*    MOVE '&& L                  %   #00008431' TO DFHEIV0
  9140     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9141     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9142     MOVE X'2020233030303038343331' TO DFHEIV0(25:11)
  9143     CALL 'kxdfhei1' USING DFHEIV0,
  9144           RQST-FILE-ID,
  9145           AR-REQUEST-RECORD,
  9146           DFHEIV11,
  9147           DFHEIV99
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9149
  9150
  9151     GO TO  5325-PROCESS-REQUEST-FILE.
  9152
  9153 5350-REQUESTS-FINISHED.
  9154
  9155* EXEC CICS ENDBR
  9156*        DATASET(RQST3-FILE-ID)
  9157*    END-EXEC.
  9158     MOVE 0
  9159       TO DFHEIV11
  9160*    MOVE '&2                    $   #00008439' TO DFHEIV0
  9161     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9162     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9163     MOVE X'2020233030303038343339' TO DFHEIV0(25:11)
  9164     CALL 'kxdfhei1' USING DFHEIV0,
  9165           RQST3-FILE-ID,
  9166           DFHEIV11,
  9167           DFHEIV99
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9169
  9170
  9171 5399-EXIT.
  9172     EXIT.
  9173
  9174
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 176
* EL6501.cbl
  9176
  9177 6000-MOVE-TO-SCREEN.
  9178     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9179
  9180     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9181     MOVE AM-NAME                TO NAMEO.
  9182     MOVE AM-CONTROL-NAME        TO PCONTO.
  9183     MOVE AM-CSR-CODE            TO CSRO.
  9184     MOVE AM-PERSON              TO INCAREO.
  9185     MOVE AM-ADDRS               TO ADDR1O.
  9186     MOVE AM-ID-NO               TO TAXNOO.
  9187     MOVE AM-TEL-NO              TO WS-PHONE.
  9188     MOVE WS-PHONE-NUM           TO PHONEO.
  9189     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9190     MOVE AM-ADDR-CITY           TO ACITYO
  9191     MOVE AM-ADDR-STATE          TO ASTATEO
  9192
  9193     MOVE SPACES                 TO WS-ZIP-CODE.
  9194     IF AM-CANADIAN-POST-CODE
  9195         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9196         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9197     ELSE
  9198         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9199         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9200             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9201             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9202
  9203     MOVE WS-ZIP-CODE            TO ZIPO.
  9204
  9205     MOVE AM-GPCD                TO TYPEO.
  9206     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9207
  9208     MOVE AM-IG                  TO INDGRPO.
  9209     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9210
  9211     MOVE AM-STATUS              TO STATUSO.
  9212*    INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9213     INSPECT STATUSO CONVERTING '9876543210' TO 'PRLDSFCTIA'
  9214
  9215     MOVE AM-REMIT-TO            TO REMITO.
  9216
  9217     IF PI-AR-PROCESSING
  9218        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9219           MOVE AL-UNNON         TO REMITA
  9220        ELSE
  9221           MOVE AL-SANON         TO REMITA
  9222     ELSE
  9223        MOVE AL-UNNON            TO REMITA.
  9224
  9225***  Y2K PROJ 7744
  9226     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9227     MOVE '3'                    TO DC-OPTION-CODE.
  9228     PERFORM 9700-DATE-LINK.
  9229     IF DATE-CONVERSION-ERROR
  9230        MOVE SPACES              TO CONTRO
  9231     ELSE
  9232        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9233     END-IF.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 177
* EL6501.cbl
  9234***  Y2K PROJ 7744
  9235
  9236*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9237*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9238
  9239*    IF AM-LF-PSI-FACTOR NUMERIC
  9240*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9241*
  9242*    IF AM-AH-PSI-FACTOR NUMERIC
  9243*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9244
  9245     MOVE AM-RECALC-COMM         TO COMMCALO.
  9246     MOVE AL-UANON               TO COMMCALA.
  9247     MOVE AM-RECALC-REIN         TO REINCALO.
  9248     MOVE AM-REI-TABLE           TO REINTABO.
  9249     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9250     MOVE '3'                    TO DC-OPTION-CODE.
  9251     PERFORM 9700-DATE-LINK.
  9252     IF DATE-CONVERSION-ERROR
  9253        MOVE SPACES              TO PRODATEO
  9254     ELSE
  9255        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9256
  9257     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  9258        IF AM-CLP-TOL-PCT NOT NUMERIC
  9259           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9260        END-IF
  9261        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9262           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9263        END-IF
  9264        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9265        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9266        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9267        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9268        MOVE AL-UANON            TO CLPSTA
  9269        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9270           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9271        END-IF
  9272        MOVE AM-DCC-MAX-MARKETING-FEE
  9273                                 TO MAXMFEEO
  9274     ELSE
  9275        MOVE AL-SADOF            TO CTPLABLA
  9276                                    CLPTOLPA
  9277                                    LCLABLA
  9278                                    LCOMMA
  9279     END-IF
  9280
  9281     IF AM-RET-Y-N = ' '  OR  'N'
  9282         MOVE 'NO '              TO RETROCDO
  9283     ELSE
  9284         MOVE 'YES'              TO RETROCDO.
  9285
  9286     IF AM-ACCOUNT-BILLED
  9287         MOVE 'YES'              TO BILLCDO
  9288     ELSE
  9289         MOVE 'NO '              TO BILLCDO.
  9290
  9291     MOVE AL-UANON               TO RETROCDA.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 178
* EL6501.cbl
  9292     MOVE AL-SANON               TO PRODATEA
  9293                                    BILLCDA.
  9294     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9295     MOVE '3' TO DC-OPTION-CODE.
  9296     PERFORM 9700-DATE-LINK.
  9297     IF DATE-CONVERSION-ERROR
  9298        MOVE SPACES TO PEFFDTEO
  9299     ELSE
  9300        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9301
  9302     IF AM-PREV-EXP-DT NOT = 99999999999
  9303        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9304        MOVE '3' TO DC-OPTION-CODE
  9305        PERFORM 9700-DATE-LINK
  9306        IF DATE-CONVERSION-ERROR
  9307           MOVE SPACES TO PEXPDTEO
  9308        ELSE
  9309           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9310     ELSE
  9311        MOVE '99/99/99' TO PEXPDTEO.
  9312
  9313     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9314        MOVE AL-UANON            TO PEXPDTEA
  9315                                    PEFFDTEA
  9316        MOVE AL-SANOF TO            PDSPLYA.
  9317
  9318     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9319     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9320     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9321
  9322     MOVE 1  TO SUB.
  9323     SET M-INDEX TO 1.
  9324
  9325 6005-LOOP.
  9326     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9327        IF PI-AR-PROCESSING
  9328           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9329              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9330                                   ATYPEA (M-INDEX)
  9331                                   SINGLEA (M-INDEX)
  9332                                   JOINTA (M-INDEX)
  9333                                   A-HA    (M-INDEX)
  9334              GO TO 6010-BUMP-SUB
  9335           ELSE
  9336              GO TO 6010-BUMP-SUB
  9337        ELSE
  9338           GO TO 6010-BUMP-SUB.
  9339
  9340     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9341
  9342***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9343     IF WS-DMD-AGENT = LOW-VALUES
  9344        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9345***DMD ******************************************************
  9346
  9347     IF PI-GA-BILLING
  9348        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9349     MOVE AL-UANON               TO AGENTA (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 179
* EL6501.cbl
  9350
  9351     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9352     IF PI-GA-BILLING
  9353        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9354     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9355
  9356     IF (AM-L-COM (SUB) NOT NUMERIC)
  9357        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9358        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9359     ELSE
  9360        IF AM-L-COM (SUB) NOT = ZEROS
  9361           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9362
  9363     IF (AM-J-COM (SUB) NOT NUMERIC)
  9364        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9365        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9366     ELSE
  9367        IF AM-J-COM (SUB) NOT = ZEROS
  9368           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9369
  9370     IF (AM-A-COM (SUB) NOT NUMERIC)
  9371        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9372        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9373     ELSE
  9374        IF AM-A-COM (SUB) NOT = ZEROS
  9375           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9376
  9377************************************************************
  9378**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9379************************************************************
  9380
  9381     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9382            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9383            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9384         GO TO 6006-CONTINUE.
  9385
  9386     IF (AM-L-COM (SUB) NUMERIC)
  9387        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9388         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9389
  9390     IF (AM-J-COM (SUB) NUMERIC)
  9391        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9392         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9393
  9394     IF (AM-A-COM (SUB) NUMERIC)
  9395        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9396        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9397     END-IF
  9398     .
  9399 6006-CONTINUE.
  9400     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9401         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9402
  9403     IF WS-ST-COMM-CAP-SL = ZEROS
  9404        CONTINUE
  9405     ELSE
  9406        IF (AM-L-COM (SUB) NUMERIC)
  9407           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 180
* EL6501.cbl
  9408           IF (WS-LIMIT-TO-ACCOUNT AND
  9409              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9410                       OR
  9411              (NOT WS-LIMIT-TO-ACCOUNT AND
  9412              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9413              MOVE -1            TO MAINTL
  9414              MOVE ER-1884       TO EMI-ERROR
  9415              PERFORM 9900-ERROR-FORMAT
  9416                                 THRU 9900-EXIT
  9417           END-IF
  9418        ELSE
  9419           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9420           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9421           MOVE PI-LIFE-OVERRIDE-L1
  9422                                 TO COMM-LF-AH
  9423           MOVE LOW-VALUES       TO COMM-FILLER
  9424           PERFORM 6400-READ-COMMISSION
  9425                                 THRU 6459-EXIT
  9426           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9427              MOVE -1            TO MAINTL
  9428              MOVE ER-1884       TO EMI-ERROR
  9429              PERFORM 9900-ERROR-FORMAT
  9430                                 THRU 9900-EXIT
  9431           END-IF
  9432        END-IF
  9433     END-IF
  9434
  9435     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9436         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9437
  9438     IF WS-ST-COMM-CAP-JL = ZEROS
  9439        CONTINUE
  9440     ELSE
  9441        IF (AM-J-COM (SUB) NUMERIC)
  9442           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9443           IF (WS-LIMIT-TO-ACCOUNT AND
  9444              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9445                       OR
  9446              (NOT WS-LIMIT-TO-ACCOUNT AND
  9447              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9448              MOVE -1            TO MAINTL
  9449              MOVE ER-1885       TO EMI-ERROR
  9450              PERFORM 9900-ERROR-FORMAT
  9451                                 THRU 9900-EXIT
  9452           END-IF
  9453        ELSE
  9454           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9455           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9456           MOVE PI-LIFE-OVERRIDE-L1
  9457                                 TO COMM-LF-AH
  9458           MOVE LOW-VALUES       TO COMM-FILLER
  9459           PERFORM 6400-READ-COMMISSION
  9460                                 THRU 6459-EXIT
  9461           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9462              MOVE -1            TO MAINTL
  9463              MOVE ER-1885       TO EMI-ERROR
  9464              PERFORM 9900-ERROR-FORMAT
  9465                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 181
* EL6501.cbl
  9466           END-IF
  9467        END-IF
  9468     END-IF
  9469
  9470     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9471         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9472
  9473     IF WS-ST-COMM-CAP-SA = ZEROS
  9474        CONTINUE
  9475     ELSE
  9476        IF (AM-A-COM (SUB) NUMERIC)
  9477           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9478           IF (WS-LIMIT-TO-ACCOUNT AND
  9479              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9480                       OR
  9481              (NOT WS-LIMIT-TO-ACCOUNT AND
  9482              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9483              MOVE -1            TO MAINTL
  9484              MOVE ER-1886       TO EMI-ERROR
  9485              PERFORM 9900-ERROR-FORMAT
  9486                                 THRU 9900-EXIT
  9487           END-IF
  9488        ELSE
  9489           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9490           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9491           MOVE PI-AH-OVERRIDE-L1
  9492                                 TO COMM-LF-AH
  9493           MOVE LOW-VALUES       TO COMM-FILLER
  9494           PERFORM 6400-READ-COMMISSION
  9495                                 THRU 6459-EXIT
  9496           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9497              MOVE -1            TO MAINTL
  9498              MOVE ER-1886       TO EMI-ERROR
  9499              PERFORM 9900-ERROR-FORMAT
  9500                                 THRU 9900-EXIT
  9501           END-IF
  9502        END-IF
  9503     END-IF
  9504
  9505     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9506         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9507
  9508     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9509         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9510
  9511     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9512        NEXT SENTENCE
  9513     ELSE
  9514        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9515
  9516     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9517         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9518
  9519     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9520         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9521
  9522     IF NOT PI-AR-PROCESSING
  9523        GO TO 6010-BUMP-SUB.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 182
* EL6501.cbl
  9524
  9525     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9526        GO TO 6010-BUMP-SUB.
  9527
  9528     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9529                                   ATYPEA  (M-INDEX)
  9530                                   SINGLEA (M-INDEX)
  9531                                   JOINTA  (M-INDEX)
  9532                                   A-HA    (M-INDEX).
  9533
  9534 6010-BUMP-SUB.
  9535     ADD 1  TO SUB.
  9536     SET M-INDEX UP BY 1.
  9537     IF SUB LESS 11
  9538        GO TO 6005-LOOP.
  9539
  9540 6099-EXIT.
  9541      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 183
* EL6501.cbl
  9543 6300-STARTBR.
  9544
  9545* EXEC CICS STARTBR
  9546*         DATASET   (ACCT-FILE-ID)
  9547*         RIDFLD    (WS-KEY-SAVE)
  9548*    END-EXEC.
  9549     MOVE 0
  9550       TO DFHEIV11
  9551*    MOVE '&,         G          &   #00008816' TO DFHEIV0
  9552     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9554     MOVE X'2020233030303038383136' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0,
  9556           ACCT-FILE-ID,
  9557           WS-KEY-SAVE,
  9558           DFHEIV99,
  9559           DFHEIV11,
  9560           DFHEIV99
  9561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9562
  9563
  9564     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9565
  9566 6300-EXIT.
  9567      EXIT.
  9568
  9569 6310-READNEXT.
  9570
  9571* EXEC CICS READNEXT
  9572*         DATASET    (ACCT-FILE-ID)
  9573*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9574*         RIDFLD     (WS-KEY-SAVE)
  9575*    END-EXEC.
  9576     MOVE 0
  9577       TO DFHEIV11
  9578*    MOVE '&.S                   )   #00008827' TO DFHEIV0
  9579     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9581     MOVE X'2020233030303038383237' TO DFHEIV0(25:11)
  9582     CALL 'kxdfhei1' USING DFHEIV0,
  9583           ACCT-FILE-ID,
  9584           DFHEIV20,
  9585           DFHEIV99,
  9586           WS-KEY-SAVE,
  9587           DFHEIV99,
  9588           DFHEIV11,
  9589           DFHEIV99,
  9590           DFHEIV99
  9591     SET ADDRESS OF ACCOUNT-MASTER TO
  9592         DFHEIV20
  9593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9594
  9595
  9596 6310-EXIT.
  9597      EXIT.
  9598
  9599 6320-ENDBR.
  9600     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 184
* EL6501.cbl
  9601
  9602* EXEC CICS ENDBR
  9603*        DATASET(ACCT-FILE-ID)
  9604*    END-EXEC.
  9605     MOVE 0
  9606       TO DFHEIV11
  9607*    MOVE '&2                    $   #00008838' TO DFHEIV0
  9608     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9609     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9610     MOVE X'2020233030303038383338' TO DFHEIV0(25:11)
  9611     CALL 'kxdfhei1' USING DFHEIV0,
  9612           ACCT-FILE-ID,
  9613           DFHEIV11,
  9614           DFHEIV99
  9615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9616
  9617
  9618 6320-EXIT.
  9619      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 185
* EL6501.cbl
  9621 6400-READ-COMMISSION.
  9622     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9623
  9624* EXEC CICS HANDLE CONDITION
  9625*         NOTFND   (6450-NOT-FOUND)
  9626*    END-EXEC
  9627*    MOVE '"$I                   ! . #00008847' TO DFHEIV0
  9628     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9630     MOVE X'2E20233030303038383437' TO DFHEIV0(25:11)
  9631     CALL 'kxdfhei1' USING DFHEIV0
  9632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9633
  9634
  9635* EXEC CICS READ
  9636*        GTEQ
  9637*        DATASET   (COMM-FILE-ID)
  9638*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9639*        RIDFLD    (COMM-KEY)
  9640*    END-EXEC
  9641*    MOVE '&"S        G          (   #00008851' TO DFHEIV0
  9642     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9644     MOVE X'2020233030303038383531' TO DFHEIV0(25:11)
  9645     CALL 'kxdfhei1' USING DFHEIV0,
  9646           COMM-FILE-ID,
  9647           DFHEIV20,
  9648           DFHEIV99,
  9649           COMM-KEY,
  9650           DFHEIV99,
  9651           DFHEIV99,
  9652           DFHEIV99
  9653     SET ADDRESS OF COMM-TABLE-RECORD TO
  9654         DFHEIV20
  9655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9656
  9657     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9658        CT-TABLE      = COMM-TABLE    AND
  9659        CT-BEN-TYPE   = COMM-LF-AH
  9660        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9661        GO TO 6459-EXIT
  9662     END-IF
  9663     .
  9664 6450-NOT-FOUND.
  9665     MOVE ER-2176                TO EMI-ERROR.
  9666     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9667     MOVE 1  TO WS-COMM-ERROR-SW.
  9668
  9669 6459-EXIT.
  9670      EXIT.
  9671
  9672 6460-CHECK-MAX.
  9673
  9674
  9675* EXEC CICS STARTBR
  9676*         DATASET   (COMM-FILE-ID)
  9677*         RIDFLD    (COMM-KEY)
  9678*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 186
* EL6501.cbl
  9679*    END-EXEC
  9680     MOVE 0
  9681       TO DFHEIV11
  9682*    MOVE '&,         G          &  N#00008875' TO DFHEIV0
  9683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9685     MOVE X'204E233030303038383735' TO DFHEIV0(25:11)
  9686     CALL 'kxdfhei1' USING DFHEIV0,
  9687           COMM-FILE-ID,
  9688           COMM-KEY,
  9689           DFHEIV99,
  9690           DFHEIV11,
  9691           DFHEIV99
  9692     MOVE EIBRESP  TO WS-RESPONSE
  9693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9694
  9695     MOVE SPACES          TO WS-STATE-MAX-SW
  9696
  9697     IF RESP-NORMAL
  9698        MOVE LOW-VALUES          TO COMM-FILLER
  9699        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9700        MOVE ZEROS               TO WS-TABLE-MAX
  9701        PERFORM UNTIL
  9702              (NOT RESP-NORMAL) OR
  9703              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9704
  9705* EXEC CICS READNEXT
  9706*             DATASET   (COMM-FILE-ID)
  9707*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9708*             RIDFLD    (COMM-KEY)
  9709*             RESP      (WS-RESPONSE)
  9710*           END-EXEC
  9711     MOVE 0
  9712       TO DFHEIV11
  9713*    MOVE '&.S                   )  N#00008890' TO DFHEIV0
  9714     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9716     MOVE X'204E233030303038383930' TO DFHEIV0(25:11)
  9717     CALL 'kxdfhei1' USING DFHEIV0,
  9718           COMM-FILE-ID,
  9719           DFHEIV20,
  9720           DFHEIV99,
  9721           COMM-KEY,
  9722           DFHEIV99,
  9723           DFHEIV11,
  9724           DFHEIV99,
  9725           DFHEIV99
  9726     SET ADDRESS OF COMM-TABLE-RECORD TO
  9727         DFHEIV20
  9728     MOVE EIBRESP  TO WS-RESPONSE
  9729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9730            IF (RESP-NORMAL) AND
  9731               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9732               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9733                   (WS-NDX > +27)
  9734                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9735                      MOVE CT-RT (WS-NDX)
  9736                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 187
* EL6501.cbl
  9737                   END-IF
  9738               END-PERFORM
  9739            END-IF
  9740        END-PERFORM
  9741
  9742* EXEC CICS ENDBR
  9743*            DATASET   (COMM-FILE-ID)
  9744*       END-EXEC
  9745     MOVE 0
  9746       TO DFHEIV11
  9747*    MOVE '&2                    $   #00008907' TO DFHEIV0
  9748     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9749     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9750     MOVE X'2020233030303038393037' TO DFHEIV0(25:11)
  9751     CALL 'kxdfhei1' USING DFHEIV0,
  9752           COMM-FILE-ID,
  9753           DFHEIV11,
  9754           DFHEIV99
  9755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9756     END-IF
  9757
  9758     .
  9759 6460-EXIT.
  9760      EXIT.
  9761
  9762
  9763 6500-READ-ACCT.
  9764
  9765* EXEC CICS READ
  9766*        GTEQ
  9767*        DATASET   (ACCT-FILE-ID)
  9768*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9769*        RIDFLD    (PI-ACCT-KEY)
  9770*    END-EXEC.
  9771*    MOVE '&"S        G          (   #00008918' TO DFHEIV0
  9772     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9773     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9774     MOVE X'2020233030303038393138' TO DFHEIV0(25:11)
  9775     CALL 'kxdfhei1' USING DFHEIV0,
  9776           ACCT-FILE-ID,
  9777           DFHEIV20,
  9778           DFHEIV99,
  9779           PI-ACCT-KEY,
  9780           DFHEIV99,
  9781           DFHEIV99,
  9782           DFHEIV99
  9783     SET ADDRESS OF ACCOUNT-MASTER TO
  9784         DFHEIV20
  9785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9786
  9787
  9788 6599-EXIT.
  9789      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 188
* EL6501.cbl
  9791 6600-UPDATE-MAINT-DT.
  9792     MOVE SPACES                 TO ELCNTL-KEY.
  9793
  9794     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9795     MOVE '1'                    TO CNTL-REC-TYPE.
  9796     MOVE +0                     TO CNTL-SEQ-NO.
  9797
  9798
  9799* EXEC CICS HANDLE CONDITION
  9800*        NOTFND   (6699-EXIT)
  9801*    END-EXEC.
  9802*    MOVE '"$I                   ! / #00008935' TO DFHEIV0
  9803     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9805     MOVE X'2F20233030303038393335' TO DFHEIV0(25:11)
  9806     CALL 'kxdfhei1' USING DFHEIV0
  9807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9808
  9809
  9810
  9811* EXEC CICS READ
  9812*        UPDATE
  9813*        DATASET   (CNTL-FILE-ID)
  9814*        SET       (ADDRESS OF CONTROL-FILE)
  9815*        RIDFLD    (ELCNTL-KEY)
  9816*    END-EXEC.
  9817*    MOVE '&"S        EU         (   #00008939' TO DFHEIV0
  9818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9819     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9820     MOVE X'2020233030303038393339' TO DFHEIV0(25:11)
  9821     CALL 'kxdfhei1' USING DFHEIV0,
  9822           CNTL-FILE-ID,
  9823           DFHEIV20,
  9824           DFHEIV99,
  9825           ELCNTL-KEY,
  9826           DFHEIV99,
  9827           DFHEIV99,
  9828           DFHEIV99
  9829     SET ADDRESS OF CONTROL-FILE TO
  9830         DFHEIV20
  9831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9832
  9833
  9834     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9835
  9836
  9837* EXEC CICS REWRITE
  9838*        DATASET   (CNTL-FILE-ID)
  9839*        FROM      (CONTROL-FILE)
  9840*    END-EXEC.
  9841     MOVE LENGTH OF
  9842      CONTROL-FILE
  9843       TO DFHEIV11
  9844*    MOVE '&& L                  %   #00008948' TO DFHEIV0
  9845     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9847     MOVE X'2020233030303038393438' TO DFHEIV0(25:11)
  9848     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 189
* EL6501.cbl
  9849           CNTL-FILE-ID,
  9850           CONTROL-FILE,
  9851           DFHEIV11,
  9852           DFHEIV99
  9853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9854
  9855
  9856 6699-EXIT.
  9857      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 190
* EL6501.cbl
  9859 6700-BUILD-COMM-WORK.
  9860     IF NOT PI-GA-BILLING
  9861         GO TO 6799-EXIT.
  9862
  9863
  9864* EXEC CICS GETMAIN
  9865*         LENGTH   (260)
  9866*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9867*         INITIMG  (GETMAIN-SPACE)
  9868*     END-EXEC.
  9869     MOVE 260
  9870       TO DFHEIV11
  9871*    MOVE ',"IL                  $   #00008960' TO DFHEIV0
  9872     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303038393630' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           DFHEIV20,
  9877           DFHEIV11,
  9878           GETMAIN-SPACE
  9879     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9880         DFHEIV20
  9881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9882
  9883     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9884
  9885     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9886     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9887     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9888
  9889     IF PI-MAINT = 'A'
  9890         GO TO 6799-EXIT.
  9891
  9892     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9893     MOVE +1                TO AXRF-SUB.
  9894
  9895 6710-AXRF-LOOP.
  9896     MOVE SPACES         TO AGENT-FIND.
  9897     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9898
  9899     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9900
  9901     IF AGENT-FIND = SPACES
  9902        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9903             WK-GA-BILL-DT (AXRF-SUB)
  9904     ELSE
  9905        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9906
  9907     ADD +1 TO AXRF-SUB.
  9908
  9909     IF AXRF-SUB NOT = +11
  9910        GO TO 6710-AXRF-LOOP.
  9911
  9912 6799-EXIT.
  9913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 191
* EL6501.cbl
  9915 6800-COMPANY-REC-READ.
  9916     MOVE SPACES                 TO ELCNTL-KEY.
  9917     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9918     MOVE '1'                    TO CNTL-REC-TYPE.
  9919     MOVE +0                     TO CNTL-SEQ-NO.
  9920
  9921* EXEC CICS HANDLE CONDITION
  9922*        NOTFND   (6880-NO-COMP)
  9923*    END-EXEC.
  9924*    MOVE '"$I                   ! 0 #00009002' TO DFHEIV0
  9925     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9927     MOVE X'3020233030303039303032' TO DFHEIV0(25:11)
  9928     CALL 'kxdfhei1' USING DFHEIV0
  9929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9930
  9931
  9932
  9933* EXEC CICS READ
  9934*        DATASET   (CNTL-FILE-ID)
  9935*        SET       (ADDRESS OF CONTROL-FILE)
  9936*        RIDFLD    (ELCNTL-KEY)
  9937*    END-EXEC.
  9938*    MOVE '&"S        E          (   #00009006' TO DFHEIV0
  9939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9941     MOVE X'2020233030303039303036' TO DFHEIV0(25:11)
  9942     CALL 'kxdfhei1' USING DFHEIV0,
  9943           CNTL-FILE-ID,
  9944           DFHEIV20,
  9945           DFHEIV99,
  9946           ELCNTL-KEY,
  9947           DFHEIV99,
  9948           DFHEIV99,
  9949           DFHEIV99
  9950     SET ADDRESS OF CONTROL-FILE TO
  9951         DFHEIV20
  9952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9953
  9954
  9955     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9956         MOVE ER-2572               TO EMI-ERROR
  9957         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958
  9959     GO TO 6899-EXIT.
  9960
  9961 6880-NO-COMP.
  9962     MOVE ER-0002                TO EMI-ERROR.
  9963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9964
  9965 6899-EXIT.
  9966     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 192
* EL6501.cbl
  9968 6900-READ-AND-CHECK-AXRF.
  9969     IF NOT PI-GA-BILLING
  9970        GO TO 6999-EXIT.
  9971
  9972     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9973     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9974
  9975 6905-AGENT-LEVEL-LOOP.
  9976     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9977     MOVE SPACES TO AGENT-FIND.
  9978     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9979      OR
  9980        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9981      AND
  9982        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9983                             OR 'B' OR 'I'
  9984                             OR 'K' OR 'L' OR 'J' OR 'M'
  9985                             OR 'S' OR 'A' OR 'N')
  9986                            OR
  9987        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9988                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9989                                  OR 'S' OR 'A' OR 'N'))
  9990            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9991            IF AGENT-RECORD-NOT-FOUND
  9992               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9993           ELSE
  9994            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9995               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9996           ELSE
  9997        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9998              AND 'B' AND 'I' AND 'S'
  9999              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
 10000           (AM-AGT (AXRF-SUB) NOT =
 10001                   WK-AM-AGT (AXRF-SUB))
 10002           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
 10003           GO TO 6910-INC-SUB.
 10004
 10005     MOVE SPACES TO AGENT-FIND.
 10006     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
 10007        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
 10008                               SPACES AND ZEROS)
 10009          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
 10010          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
 10011          PERFORM 6921-READ-AXRF THRU 6929-EXIT
 10012          IF AGENT-FIND = SPACES
 10013              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
 10014
 10015 6910-INC-SUB.
 10016     ADD +1                      TO AXRF-SUB.
 10017     IF AXRF-SUB NOT = +11
 10018        GO TO 6905-AGENT-LEVEL-LOOP.
 10019
 10020     GO TO 6999-EXIT.
 10021
 10022 6920-READ-AXRF-FILE.
 10023*    IF GETMAIN-SW = 'X'
 10024*       GO TO 6920-BUILD-KEY.
 10025*
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 193
* EL6501.cbl
 10026*    EXEC CICS GETMAIN
 10027*         LENGTH   (ERGXRF-REC-LEN)
 10028*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10029*         INITIMG  (GETMAIN-SPACE)
 10030*    END-EXEC.
 10031*
 10032*    MOVE 'X' TO GETMAIN-SW.
 10033
 10034 6920-BUILD-KEY.
 10035     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10036
 10037     IF PI-ZERO-CARRIER
 10038       OR PI-ZERO-CAR-GROUP
 10039         MOVE ZERO               TO WS-AXRF-CARRIER
 10040     ELSE
 10041         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10042
 10043     IF PI-ZERO-GROUPING
 10044       OR PI-ZERO-CAR-GROUP
 10045         MOVE ZEROS              TO WS-AXRF-GROUPING
 10046     ELSE
 10047         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10048
 10049     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10050                                              LOW-VALUES
 10051        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10052     ELSE
 10053     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10054                                              LOW-VALUES
 10055        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10056     ELSE
 10057        MOVE 'X' TO AGENT-FIND
 10058        GO TO 6929-EXIT.
 10059
 10060     MOVE +1 TO GX-AGENT-SUB.
 10061
 10062 6921-READ-AXRF.
 10063
 10064* EXEC CICS HANDLE CONDITION
 10065*         ENDFILE     (6925-NOT-FIND)
 10066*         NOTFND      (6925-NOT-FIND)
 10067*    END-EXEC.
 10068*    MOVE '"$''I                  ! 1 #00009120' TO DFHEIV0
 10069     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10071     MOVE X'3120233030303039313230' TO DFHEIV0(25:11)
 10072     CALL 'kxdfhei1' USING DFHEIV0
 10073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10074
 10075
 10076
 10077* EXEC CICS READ
 10078*        DATASET   (ERGXRF-FILE-ID)
 10079*        LENGTH    (ERGXRF-REC-LEN)
 10080*        INTO      (AGENT-CROSS-REFERENCE)
 10081*        RIDFLD    (WS-AXRF-KEY)
 10082*        EQUAL
 10083*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 194
* EL6501.cbl
 10084*    MOVE '&"IL       E          (   #00009125' TO DFHEIV0
 10085     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10086     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10087     MOVE X'2020233030303039313235' TO DFHEIV0(25:11)
 10088     CALL 'kxdfhei1' USING DFHEIV0,
 10089           ERGXRF-FILE-ID,
 10090           AGENT-CROSS-REFERENCE,
 10091           ERGXRF-REC-LEN,
 10092           WS-AXRF-KEY,
 10093           DFHEIV99,
 10094           DFHEIV99,
 10095           DFHEIV99
 10096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10097
 10098
 10099     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10100
 10101     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10102             FROM +1 BY +1 UNTIL
 10103         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10104         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10105         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10106         AND
 10107         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10108         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10109         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10110         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10111
 10112     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10113        MOVE 'Y' TO AGENT-FIND
 10114        GO TO 6929-EXIT.
 10115
 10116     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10117        MOVE 'Z' TO AGENT-FIND.
 10118
 10119     GO TO 6929-EXIT.
 10120
 10121 6921-FIND-ACCT-LOOP.
 10122***  DUMMY PARAGRAPH  ***
 10123
 10124 6925-NOT-FIND.
 10125     MOVE 'X' TO AGENT-FIND.
 10126
 10127 6929-EXIT.
 10128     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 195
* EL6501.cbl
 10130 6950-ADD-AGENT-RECORD.
 10131     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10132        GO TO 6959-EXIT.
 10133
 10134     MOVE +109                   TO ERGXRF-REC-LEN.
 10135
 10136     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10137     MOVE 'GX'                   TO GX-RECORD-ID.
 10138     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10139
 10140     IF PI-ZERO-CARRIER
 10141       OR PI-ZERO-CAR-GROUP
 10142         MOVE ZERO               TO GX-CARRIER
 10143     ELSE
 10144         MOVE AM-CARRIER         TO GX-CARRIER.
 10145
 10146     IF PI-ZERO-GROUPING
 10147       OR PI-ZERO-CAR-GROUP
 10148         MOVE ZERO               TO GX-GROUPING
 10149     ELSE
 10150         MOVE AM-GROUPING        TO GX-GROUPING.
 10151
 10152     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10153
 10154     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10155     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10156     MOVE AM-STATE               TO GX-AM-STATE (1).
 10157     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10158     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10159     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10160     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10161     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10162
 10163     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10164     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10165     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10166
 10167
 10168* EXEC CICS WRITE
 10169*        FROM      (AGENT-CROSS-REFERENCE)
 10170*        LENGTH    (ERGXRF-REC-LEN)
 10171*        RIDFLD    (GX-CONTROL-PRIMARY)
 10172*        DATASET   (ERGXRF-FILE-ID)
 10173*    END-EXEC.
 10174*    MOVE '&$ L                  ''   #00009201' TO DFHEIV0
 10175     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10177     MOVE X'2020233030303039323031' TO DFHEIV0(25:11)
 10178     CALL 'kxdfhei1' USING DFHEIV0,
 10179           ERGXRF-FILE-ID,
 10180           AGENT-CROSS-REFERENCE,
 10181           ERGXRF-REC-LEN,
 10182           GX-CONTROL-PRIMARY,
 10183           DFHEIV99,
 10184           DFHEIV99
 10185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10186
 10187
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 196
* EL6501.cbl
 10188 6959-EXIT.
 10189      EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 197
* EL6501.cbl
 10191 6970-REWRITE-AGENT-RECORD.
 10192     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10193
 10194
 10195* EXEC CICS READ
 10196*        DATASET   (ERGXRF-FILE-ID)
 10197*        INTO      (AGENT-CROSS-REFERENCE)
 10198*        LENGTH    (ERGXRF-REC-LEN)
 10199*        RIDFLD    (WS-AXRF-KEY)
 10200*        EQUAL
 10201*        UPDATE
 10202*    END-EXEC.
 10203*    MOVE '&"IL       EU         (   #00009214' TO DFHEIV0
 10204     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10206     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
 10207     CALL 'kxdfhei1' USING DFHEIV0,
 10208           ERGXRF-FILE-ID,
 10209           AGENT-CROSS-REFERENCE,
 10210           ERGXRF-REC-LEN,
 10211           WS-AXRF-KEY,
 10212           DFHEIV99,
 10213           DFHEIV99,
 10214           DFHEIV99
 10215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10216
 10217
 10218     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10219
 10220     IF ACCT-LEVEL-DIFFERENT
 10221        GO TO 6975-UPDATE-LEVEL-NO.
 10222
 10223     IF GX-AGENT-POINTER-CNT = +1006
 10224         GO TO 6979-EXIT.
 10225
 10226     MOVE +1 TO FIND-AGENT-SUB1.
 10227
 10228 6972-FIND-REC-LOCATION.
 10229     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10230     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10231
 10232     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10233        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10234        NEXT SENTENCE
 10235     ELSE
 10236        ADD +1 TO FIND-AGENT-SUB1
 10237        GO TO 6972-FIND-REC-LOCATION.
 10238
 10239     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10240                                  FIND-AGENT-SUB3.
 10241     ADD +1 TO FIND-AGENT-SUB3.
 10242
 10243     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10244        NEXT SENTENCE
 10245     ELSE
 10246        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10247        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10248        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 198
* EL6501.cbl
 10249
 10250     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10251     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10252
 10253     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10254     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10255
 10256     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10257     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10258     MOVE AM-EXPIRATION-DT TO
 10259                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10260     MOVE AM-EFFECTIVE-DT  TO
 10261                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10262     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10263     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10264
 10265 6975-UPDATE-LEVEL-NO.
 10266     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10267     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10268     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10269     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10270     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10271     if ergxrf-rec-len > +31264
 10272        move +31264               to ergxrf-rec-len
 10273        move +1006                to gx-agent-pointer-cnt
 10274     end-if
 10275
 10276
 10277* EXEC CICS REWRITE
 10278*        FROM      (AGENT-CROSS-REFERENCE)
 10279*        LENGTH    (ERGXRF-REC-LEN)
 10280*        DATASET   (ERGXRF-FILE-ID)
 10281*    END-EXEC.
 10282*    MOVE '&& L                  %   #00009281' TO DFHEIV0
 10283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039323831' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           ERGXRF-FILE-ID,
 10288           AGENT-CROSS-REFERENCE,
 10289           ERGXRF-REC-LEN,
 10290           DFHEIV99
 10291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10292
 10293
 10294     GO TO 6979-EXIT.
 10295
 10296 6977-BUMP-AXRF-REC.
 10297     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10298          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10299
 10300     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10301
 10302 6979-EXIT.
 10303     EXIT.
 10304
 10305 6999-EXIT.
 10306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 199
* EL6501.cbl
 10308 7000-DELETE-AXRF-REC.
 10309     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10310
 10311
 10312* EXEC CICS HANDLE CONDITION
 10313*         ENDFILE     (7999-EXIT)
 10314*         NOTFND      (7999-EXIT)
 10315*    END-EXEC.
 10316*    MOVE '"$''I                  ! 2 #00009304' TO DFHEIV0
 10317     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10319     MOVE X'3220233030303039333034' TO DFHEIV0(25:11)
 10320     CALL 'kxdfhei1' USING DFHEIV0
 10321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10322
 10323
 10324
 10325* EXEC CICS READ
 10326*        DATASET   (ERGXRF-FILE-ID)
 10327*        INTO      (AGENT-CROSS-REFERENCE)
 10328*        LENGTH    (ERGXRF-REC-LEN)
 10329*        RIDFLD    (WS-AXRF-KEY)
 10330*        EQUAL
 10331*        UPDATE
 10332*    END-EXEC.
 10333*    MOVE '&"IL       EU         (   #00009309' TO DFHEIV0
 10334     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10335     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10336     MOVE X'2020233030303039333039' TO DFHEIV0(25:11)
 10337     CALL 'kxdfhei1' USING DFHEIV0,
 10338           ERGXRF-FILE-ID,
 10339           AGENT-CROSS-REFERENCE,
 10340           ERGXRF-REC-LEN,
 10341           WS-AXRF-KEY,
 10342           DFHEIV99,
 10343           DFHEIV99,
 10344           DFHEIV99
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10346
 10347
 10348     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10349
 10350     IF GX-AGENT-SUB = +0
 10351        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10352        FROM +1 BY +1 UNTIL
 10353         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10354         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10355         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10356         AND
 10357         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10358         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10359         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10360         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10361
 10362     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10363        GO TO 7999-EXIT.
 10364
 10365     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 200
* EL6501.cbl
 10366     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10367                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10368                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10369     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10370     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10371     GO TO 7020-REWRITE-AXRF-RECORD.
 10372
 10373 7010-BUMP-RECORDS.
 10374     ADD +1 TO FIND-AGENT-SUB1.
 10375     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10376          GX-AGENT-POINTER (GX-AGENT-SUB).
 10377
 10378 7020-REWRITE-AXRF-RECORD.
 10379     IF GX-AGENT-POINTER-CNT = +0
 10380
 10381* EXEC CICS DELETE
 10382*            DATASET   (ERGXRF-FILE-ID)
 10383*       END-EXEC
 10384*    MOVE '&(                    &   #00009350' TO DFHEIV0
 10385     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10387     MOVE X'2020233030303039333530' TO DFHEIV0(25:11)
 10388     CALL 'kxdfhei1' USING DFHEIV0,
 10389           ERGXRF-FILE-ID,
 10390           DFHEIV99,
 10391           DFHEIV99,
 10392           DFHEIV99,
 10393           DFHEIV99
 10394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10395     ELSE
 10396        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10397        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10398        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10399        compute ergxrf-rec-len =
 10400            (gx-agent-pointer-cnt * +31) + +78
 10401        if ergxrf-rec-len > +31264
 10402           move +31264               to ergxrf-rec-len
 10403           move +1006                to gx-agent-pointer-cnt
 10404        end-if
 10405
 10406* EXEC CICS REWRITE
 10407*            FROM      (AGENT-CROSS-REFERENCE)
 10408*            LENGTH    (ERGXRF-REC-LEN)
 10409*            DATASET   (ERGXRF-FILE-ID)
 10410*       END-EXEC.
 10411*    MOVE '&& L                  %   #00009363' TO DFHEIV0
 10412     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10413     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10414     MOVE X'2020233030303039333633' TO DFHEIV0(25:11)
 10415     CALL 'kxdfhei1' USING DFHEIV0,
 10416           ERGXRF-FILE-ID,
 10417           AGENT-CROSS-REFERENCE,
 10418           ERGXRF-REC-LEN,
 10419           DFHEIV99
 10420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10421
 10422
 10423 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 201
* EL6501.cbl
 10424     EXIT.
 10425
 10426*************************************
 10427 8000-STATE-REC-READ.
 10428     MOVE SPACES                 TO ELCNTL-KEY.
 10429     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10430     MOVE '3'                    TO CNTL-REC-TYPE.
 10431     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10432     MOVE +0                     TO CNTL-SEQ-NO.
 10433
 10434* EXEC CICS HANDLE CONDITION
 10435*        NOTFND  (8010-EXIT)
 10436*    END-EXEC.
 10437*    MOVE '"$I                   ! 3 #00009379' TO DFHEIV0
 10438     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10440     MOVE X'3320233030303039333739' TO DFHEIV0(25:11)
 10441     CALL 'kxdfhei1' USING DFHEIV0
 10442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10443
 10444
 10445
 10446* EXEC CICS READ
 10447*        DATASET   (CNTL-FILE-ID)
 10448*        SET       (ADDRESS OF CONTROL-FILE)
 10449*        RIDFLD    (ELCNTL-KEY)
 10450*    END-EXEC.
 10451*    MOVE '&"S        E          (   #00009383' TO DFHEIV0
 10452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10454     MOVE X'2020233030303039333833' TO DFHEIV0(25:11)
 10455     CALL 'kxdfhei1' USING DFHEIV0,
 10456           CNTL-FILE-ID,
 10457           DFHEIV20,
 10458           DFHEIV99,
 10459           ELCNTL-KEY,
 10460           DFHEIV99,
 10461           DFHEIV99,
 10462           DFHEIV99
 10463     SET ADDRESS OF CONTROL-FILE TO
 10464         DFHEIV20
 10465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10466
 10467
 10468     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10469     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10470
 10471 8010-EXIT.
 10472      EXIT.
 10473
 10474 8050-USER-REC-READ.
 10475     MOVE SPACES                 TO ELCNTL-KEY.
 10476     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10477     MOVE '2'                    TO CNTL-REC-TYPE.
 10478     MOVE CSRI                   TO CNTL-ACCESS.
 10479     MOVE +0                     TO CNTL-SEQ-NO.
 10480
 10481* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 202
* EL6501.cbl
 10482*        NOTFND  (8055-NOTFND)
 10483*    END-EXEC.
 10484*    MOVE '"$I                   ! 4 #00009401' TO DFHEIV0
 10485     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10487     MOVE X'3420233030303039343031' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0
 10489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10490
 10491
 10492
 10493* EXEC CICS READ
 10494*        DATASET   (CNTL-FILE-ID)
 10495*        SET       (ADDRESS OF CONTROL-FILE)
 10496*        RIDFLD    (ELCNTL-KEY)
 10497*    END-EXEC.
 10498*    MOVE '&"S        E          (   #00009405' TO DFHEIV0
 10499     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10501     MOVE X'2020233030303039343035' TO DFHEIV0(25:11)
 10502     CALL 'kxdfhei1' USING DFHEIV0,
 10503           CNTL-FILE-ID,
 10504           DFHEIV20,
 10505           DFHEIV99,
 10506           ELCNTL-KEY,
 10507           DFHEIV99,
 10508           DFHEIV99,
 10509           DFHEIV99
 10510     SET ADDRESS OF CONTROL-FILE TO
 10511         DFHEIV20
 10512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10513
 10514
 10515     GO TO 8060-EXIT.
 10516
 10517 8055-NOTFND.
 10518     MOVE ER-1883             TO EMI-ERROR.
 10519     MOVE -1                  TO CSRL.
 10520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10521
 10522 8060-EXIT.
 10523      EXIT.
 10524
 10525*************************************
 10526
 10527 8100-SEND-INITIAL-MAP.
 10528     MOVE SAVE-DATE              TO DATEO.
 10529     MOVE EIBTIME                TO TIME-IN.
 10530     MOVE TIME-OUT               TO TIMEO.
 10531     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10532     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10533     MOVE -1                     TO PFENTERL.
 10534     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10535
 10536     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10537
 10538*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10539*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 203
* EL6501.cbl
 10540*    ELSE
 10541*       MOVE AL-SADOF            TO PSIHEADA
 10542*                                   PSILFTA
 10543*                                   PSILFCA
 10544*                                   PSIAHTA
 10545*                                   PSIAHCA
 10546*                                   PSILFFA
 10547*                                   PSIAHFA.
 10548
 10549*    IF PI-COMPANY-ID = 'DMD'
 10550*         MOVE AL-SANOF          TO KEY10A.
 10551
 10552     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10553        CONTINUE
 10554     ELSE
 10555        MOVE AL-SADOF            TO CTPLABLA
 10556                                    CLPTOLPA
 10557                                    LCLABLA
 10558                                    LCOMMA
 10559                                    MAXFEEHA
 10560                                    CLPSTHA
 10561                                    PRODCDHA
 10562     END-IF
 10563     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10564        MOVE -1                  TO CSRL.
 10565
 10566     IF  CLAIM-SESSION
 10567         MOVE SPACES             TO PF1PF2O
 10568         MOVE AL-SANOF           TO PF1PF2A.
 10569
 10570
 10571* EXEC CICS SEND
 10572*        MAP      (MAP-NAME)
 10573*        MAPSET   (MAPSET-NAME)
 10574*        FROM     (EL6501AO)
 10575*        ERASE
 10576*        CURSOR
 10577*    END-EXEC.
 10578     MOVE LENGTH OF
 10579      EL6501AO
 10580       TO DFHEIV12
 10581     MOVE -1
 10582       TO DFHEIV11
 10583*    MOVE '8$     CT  E    H L F ,   #00009466' TO DFHEIV0
 10584     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10585     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10586     MOVE X'2020233030303039343636' TO DFHEIV0(25:11)
 10587     CALL 'kxdfhei1' USING DFHEIV0,
 10588           MAP-NAME,
 10589           EL6501AO,
 10590           DFHEIV12,
 10591           MAPSET-NAME,
 10592           DFHEIV99,
 10593           DFHEIV99,
 10594           DFHEIV99,
 10595           DFHEIV11,
 10596           DFHEIV99,
 10597           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 204
* EL6501.cbl
 10598           DFHEIV99
 10599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10600
 10601
 10602     GO TO 9100-RETURN-TRAN.
 10603
 10604 8200-SEND-DATAONLY.
 10605     MOVE SAVE-DATE              TO DATEO.
 10606     MOVE EIBTIME                TO TIME-IN.
 10607     MOVE TIME-OUT               TO TIMEO.
 10608     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10609     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10610     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10611
 10612     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10613
 10614     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10615        CONTINUE
 10616     ELSE
 10617        MOVE AL-SADOF            TO CTPLABLA
 10618                                    CLPTOLPA
 10619                                    LCLABLA
 10620                                    LCOMMA
 10621                                    MAXFEEHA
 10622                                    CLPSTHA
 10623                                    PRODCDHA
 10624     END-IF
 10625     IF  CLAIM-SESSION
 10626         MOVE SPACES             TO PF1PF2O
 10627         MOVE AL-SANOF           TO PF1PF2A.
 10628
 10629
 10630* EXEC CICS SEND
 10631*        MAP      (MAP-NAME)
 10632*        MAPSET   (MAPSET-NAME)
 10633*        FROM     (EL6501AO)
 10634*        DATAONLY
 10635*        CURSOR
 10636*    END-EXEC.
 10637     MOVE LENGTH OF
 10638      EL6501AO
 10639       TO DFHEIV12
 10640     MOVE -1
 10641       TO DFHEIV11
 10642*    MOVE '8$D    CT       H L F ,   #00009501' TO DFHEIV0
 10643     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10644     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10645     MOVE X'2020233030303039353031' TO DFHEIV0(25:11)
 10646     CALL 'kxdfhei1' USING DFHEIV0,
 10647           MAP-NAME,
 10648           EL6501AO,
 10649           DFHEIV12,
 10650           MAPSET-NAME,
 10651           DFHEIV99,
 10652           DFHEIV99,
 10653           DFHEIV99,
 10654           DFHEIV11,
 10655           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 205
* EL6501.cbl
 10656           DFHEIV99,
 10657           DFHEIV99
 10658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10659
 10660
 10661     GO TO 9100-RETURN-TRAN.
 10662
 10663 8300-SEND-TEXT.
 10664
 10665* EXEC CICS SEND TEXT
 10666*        FROM     (LOGOFF-TEXT)
 10667*        LENGTH   (LOGOFF-LENGTH)
 10668*        ERASE
 10669*        FREEKB
 10670*    END-EXEC.
 10671*    MOVE '8&      T  E F  H   F -   #00009512' TO DFHEIV0
 10672     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10673     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10674     MOVE X'2020233030303039353132' TO DFHEIV0(25:11)
 10675     CALL 'kxdfhei1' USING DFHEIV0,
 10676           LOGOFF-TEXT,
 10677           LOGOFF-LENGTH,
 10678           DFHEIV99,
 10679           DFHEIV99,
 10680           DFHEIV99,
 10681           DFHEIV99,
 10682           DFHEIV99,
 10683           DFHEIV99,
 10684           DFHEIV99,
 10685           DFHEIV99,
 10686           DFHEIV99,
 10687           DFHEIV99
 10688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10689
 10690
 10691
 10692* EXEC CICS RETURN
 10693*    END-EXEC.
 10694*    MOVE '.(                    ''   #00009519' TO DFHEIV0
 10695     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10696     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10697     MOVE X'2020233030303039353139' TO DFHEIV0(25:11)
 10698     CALL 'kxdfhei1' USING DFHEIV0,
 10699           DFHEIV99,
 10700           DFHEIV99,
 10701           DFHEIV99,
 10702           DFHEIV99,
 10703           DFHEIV99,
 10704           DFHEIV99
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708 8600-DEEDIT.
 10709
 10710* EXEC CICS BIF DEEDIT
 10711*         FIELD(DEEDIT-FIELD)
 10712*         LENGTH(15)
 10713*     END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 206
* EL6501.cbl
 10714     MOVE 15
 10715       TO DFHEIV11
 10716*    MOVE '@"L                   #   #00009523' TO DFHEIV0
 10717     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10718     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10719     MOVE X'2020233030303039353233' TO DFHEIV0(25:11)
 10720     CALL 'kxdfhei1' USING DFHEIV0,
 10721           DEEDIT-FIELD,
 10722           DFHEIV11
 10723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10724
 10725
 10726 8800-UNAUTHORIZED-ACCESS.
 10727     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10728     GO TO 8300-SEND-TEXT.
 10729
 10730 8810-PF23.
 10731     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10732     MOVE XCTL-005               TO PGM-NAME.
 10733     GO TO 9300-XCTL.
 10734
 10735 9100-RETURN-TRAN.
 10736     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10737     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10738
 10739* EXEC CICS RETURN
 10740*        TRANSID    (TRANS-ID)
 10741*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10742*        LENGTH     (WS-COMM-LENGTH)
 10743*    END-EXEC.
 10744*    MOVE '.(CT                  ''   #00009540' TO DFHEIV0
 10745     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10747     MOVE X'2020233030303039353430' TO DFHEIV0(25:11)
 10748     CALL 'kxdfhei1' USING DFHEIV0,
 10749           TRANS-ID,
 10750           PROGRAM-INTERFACE-BLOCK,
 10751           WS-COMM-LENGTH,
 10752           DFHEIV99,
 10753           DFHEIV99,
 10754           DFHEIV99
 10755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10756
 10757
 10758 9200-RETURN-MAIN-MENU.
 10759     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10760         MOVE XCTL-126           TO  PGM-NAME
 10761     ELSE
 10762         MOVE XCTL-626           TO  PGM-NAME.
 10763
 10764     GO TO 9300-XCTL.
 10765
 10766 9300-XCTL.
 10767
 10768* EXEC CICS XCTL
 10769*        PROGRAM    (PGM-NAME)
 10770*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10771*        LENGTH     (WS-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 207
* EL6501.cbl
 10772*    END-EXEC.
 10773*    MOVE '.$C                   %   #00009555' TO DFHEIV0
 10774     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10775     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10776     MOVE X'2020233030303039353535' TO DFHEIV0(25:11)
 10777     CALL 'kxdfhei1' USING DFHEIV0,
 10778           PGM-NAME,
 10779           PROGRAM-INTERFACE-BLOCK,
 10780           WS-COMM-LENGTH,
 10781           DFHEIV99
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10783
 10784
 10785 9400-CLEAR.
 10786     IF PI-GA-BILLING
 10787        IF GETMAIN-ACQUIRED
 10788           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10789           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10790
 10791* EXEC CICS FREEMAIN
 10792*               DATA     (COMMISSION-WORK-AREA)
 10793*          END-EXEC.
 10794*    MOVE ',$D                   "   #00009566' TO DFHEIV0
 10795     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10796     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10797     MOVE X'2020233030303039353636' TO DFHEIV0(25:11)
 10798     CALL 'kxdfhei1' USING DFHEIV0,
 10799           COMMISSION-WORK-AREA
 10800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10801
 10802
 10803     MOVE SPACES                 TO PI-SV-MAINT.
 10804     MOVE XCTL-650               TO PGM-NAME.
 10805     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10806     GO TO 9300-XCTL.
 10807
 10808 9500-PF12.
 10809     MOVE XCTL-010               TO PGM-NAME.
 10810     GO TO 9300-XCTL.
 10811
 10812 9600-PGMID-ERROR.
 10813
 10814* EXEC CICS HANDLE CONDITION
 10815*        PGMIDERR    (8300-SEND-TEXT)
 10816*    END-EXEC.
 10817*    MOVE '"$L                   ! 5 #00009580' TO DFHEIV0
 10818     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10820     MOVE X'3520233030303039353830' TO DFHEIV0(25:11)
 10821     CALL 'kxdfhei1' USING DFHEIV0
 10822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10823
 10824
 10825     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10826     MOVE ' '                    TO PI-ENTRY-CD-1.
 10827     MOVE XCTL-005               TO PGM-NAME.
 10828     MOVE PGM-NAME               TO LOGOFF-PGM.
 10829     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 208
* EL6501.cbl
 10830     GO TO 9300-XCTL.
 10831
 10832 9700-DATE-LINK.
 10833     MOVE LINK-ELDATCV           TO PGM-NAME.
 10834
 10835* EXEC CICS LINK
 10836*        PROGRAM    (PGM-NAME)
 10837*        COMMAREA   (DATE-CONVERSION-DATA)
 10838*        LENGTH     (DC-COMM-LENGTH)
 10839*    END-EXEC.
 10840*    MOVE '."C                   (   #00009593' TO DFHEIV0
 10841     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10842     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10843     MOVE X'2020233030303039353933' TO DFHEIV0(25:11)
 10844     CALL 'kxdfhei1' USING DFHEIV0,
 10845           PGM-NAME,
 10846           DATE-CONVERSION-DATA,
 10847           DC-COMM-LENGTH,
 10848           DFHEIV99,
 10849           DFHEIV99,
 10850           DFHEIV99,
 10851           DFHEIV99
 10852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10853
 10854
 10855 9900-ERROR-FORMAT.
 10856     IF NOT EMI-ERRORS-COMPLETE
 10857         MOVE LINK-001           TO PGM-NAME
 10858
 10859* EXEC CICS LINK
 10860*            PROGRAM    (PGM-NAME)
 10861*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10862*            LENGTH     (EMI-COMM-LENGTH)
 10863*        END-EXEC.
 10864*    MOVE '."C                   (   #00009602' TO DFHEIV0
 10865     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10867     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
 10868     CALL 'kxdfhei1' USING DFHEIV0,
 10869           PGM-NAME,
 10870           ERROR-MESSAGE-INTERFACE-BLOCK,
 10871           EMI-COMM-LENGTH,
 10872           DFHEIV99,
 10873           DFHEIV99,
 10874           DFHEIV99,
 10875           DFHEIV99
 10876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10877
 10878
 10879 9900-EXIT.
 10880     EXIT.
 10881
 10882 9990-ABEND.
 10883     MOVE LINK-004               TO PGM-NAME.
 10884     MOVE DFHEIBLK               TO EMI-LINE1.
 10885
 10886* EXEC CICS LINK
 10887*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 209
* EL6501.cbl
 10888*        COMMAREA  (EMI-LINE1)
 10889*        LENGTH    (72)
 10890*    END-EXEC.
 10891     MOVE 72
 10892       TO DFHEIV11
 10893*    MOVE '."C                   (   #00009614' TO DFHEIV0
 10894     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10896     MOVE X'2020233030303039363134' TO DFHEIV0(25:11)
 10897     CALL 'kxdfhei1' USING DFHEIV0,
 10898           PGM-NAME,
 10899           EMI-LINE1,
 10900           DFHEIV11,
 10901           DFHEIV99,
 10902           DFHEIV99,
 10903           DFHEIV99,
 10904           DFHEIV99
 10905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10906
 10907
 10908     MOVE -1                     TO PFENTERL.
 10909     GO TO 8200-SEND-DATAONLY.
 10910
 10911
 10912* GOBACK.
 10913     MOVE '9%                    "   ' TO DFHEIV0
 10914     MOVE 'EL6501' TO DFHEIV1
 10915     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10916     GOBACK.
 10917
 10918 9995-SECURITY-VIOLATION.
 10919*                            COPY ELCSCTP.
 10920******************************************************************
 10921*                                                                *
 10922*                            ELCSCTP                             *
 10923*                            VMOD=2.001                          *
 10924*                                                                *
 10925*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10926******************************************************************
 10927
 10928
 10929     MOVE EIBDATE          TO SM-JUL-DATE.
 10930     MOVE EIBTRMID         TO SM-TERMID.
 10931     MOVE THIS-PGM         TO SM-PGM.
 10932     MOVE EIBTIME          TO TIME-IN.
 10933     MOVE TIME-OUT         TO SM-TIME.
 10934     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10935
 10936
 10937* EXEC CICS LINK
 10938*         PROGRAM  ('EL003')
 10939*         COMMAREA (SECURITY-MESSAGE)
 10940*         LENGTH   (80)
 10941*    END-EXEC.
 10942     MOVE 'EL003' TO DFHEIV1
 10943     MOVE 80
 10944       TO DFHEIV11
 10945*    MOVE '."C                   (   #00009643' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 210
* EL6501.cbl
 10946     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10948     MOVE X'2020233030303039363433' TO DFHEIV0(25:11)
 10949     CALL 'kxdfhei1' USING DFHEIV0,
 10950           DFHEIV1,
 10951           SECURITY-MESSAGE,
 10952           DFHEIV11,
 10953           DFHEIV99,
 10954           DFHEIV99,
 10955           DFHEIV99,
 10956           DFHEIV99
 10957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10958
 10959
 10960******************************************************************
 10961
 10962
 10963 9995-EXIT.
 10964     EXIT.
 10965
 10966 9999-DFHBACK SECTION.
 10967     MOVE '9%                    "   ' TO DFHEIV0
 10968     MOVE 'EL6501' TO DFHEIV1
 10969     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10970     GOBACK.
 10971 9999-DFHEXIT.
 10972     IF DFHEIGDJ EQUAL 0001
 10973         NEXT SENTENCE
 10974     ELSE IF DFHEIGDJ EQUAL 2
 10975         GO TO 9600-PGMID-ERROR,
 10976               9990-ABEND,
 10977               0500-CHECK-MAINT-TYPE
 10978         DEPENDING ON DFHEIGDI
 10979     ELSE IF DFHEIGDJ EQUAL 3
 10980         GO TO 1500-EXIT
 10981         DEPENDING ON DFHEIGDI
 10982     ELSE IF DFHEIGDJ EQUAL 4
 10983         GO TO 1799-EXIT,
 10984               1799-EXIT
 10985         DEPENDING ON DFHEIGDI
 10986     ELSE IF DFHEIGDJ EQUAL 5
 10987         GO TO 2100-EXIT
 10988         DEPENDING ON DFHEIGDI
 10989     ELSE IF DFHEIGDJ EQUAL 6
 10990         GO TO 2200-EXIT
 10991         DEPENDING ON DFHEIGDI
 10992     ELSE IF DFHEIGDJ EQUAL 7
 10993         GO TO 3030-END-FILE
 10994         DEPENDING ON DFHEIGDI
 10995     ELSE IF DFHEIGDJ EQUAL 8
 10996         GO TO 3530-END-FILE
 10997         DEPENDING ON DFHEIGDI
 10998     ELSE IF DFHEIGDJ EQUAL 9
 10999         GO TO 4020-BUS-TYPE-ERROR
 11000         DEPENDING ON DFHEIGDI
 11001     ELSE IF DFHEIGDJ EQUAL 10
 11002         GO TO 4099-STD-BEN-ERROR
 11003         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 24-Mar-16 11:19 Page 211
* EL6501.cbl
 11004     ELSE IF DFHEIGDJ EQUAL 11
 11005         GO TO 4180-REIN-ERROR
 11006         DEPENDING ON DFHEIGDI
 11007     ELSE IF DFHEIGDJ EQUAL 12
 11008         GO TO 5250-QID-ERROR
 11009         DEPENDING ON DFHEIGDI
 11010     ELSE IF DFHEIGDJ EQUAL 13
 11011         GO TO 5399-EXIT,
 11012               5399-EXIT
 11013         DEPENDING ON DFHEIGDI
 11014     ELSE IF DFHEIGDJ EQUAL 14
 11015         GO TO 6450-NOT-FOUND
 11016         DEPENDING ON DFHEIGDI
 11017     ELSE IF DFHEIGDJ EQUAL 15
 11018         GO TO 6699-EXIT
 11019         DEPENDING ON DFHEIGDI
 11020     ELSE IF DFHEIGDJ EQUAL 16
 11021         GO TO 6880-NO-COMP
 11022         DEPENDING ON DFHEIGDI
 11023     ELSE IF DFHEIGDJ EQUAL 17
 11024         GO TO 6925-NOT-FIND,
 11025               6925-NOT-FIND
 11026         DEPENDING ON DFHEIGDI
 11027     ELSE IF DFHEIGDJ EQUAL 18
 11028         GO TO 7999-EXIT,
 11029               7999-EXIT
 11030         DEPENDING ON DFHEIGDI
 11031     ELSE IF DFHEIGDJ EQUAL 19
 11032         GO TO 8010-EXIT
 11033         DEPENDING ON DFHEIGDI
 11034     ELSE IF DFHEIGDJ EQUAL 20
 11035         GO TO 8055-NOTFND
 11036         DEPENDING ON DFHEIGDI
 11037     ELSE IF DFHEIGDJ EQUAL 21
 11038         GO TO 8300-SEND-TEXT
 11039         DEPENDING ON DFHEIGDI.
 11040     MOVE '9%                    "   ' TO DFHEIV0
 11041     MOVE 'EL6501' TO DFHEIV1
 11042     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11043     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39340     Code:       35120
